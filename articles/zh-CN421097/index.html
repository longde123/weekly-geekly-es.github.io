<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ•´ğŸ½ ğŸ‘‹ğŸ¿ ğŸ‘¸ğŸ» UIViewControllersçš„ç»„æˆä»¥åŠå®ƒä»¬ä¹‹é—´çš„å¯¼èˆªï¼ˆä¸ä»…å¦‚æ­¤ï¼‰ ğŸ‘ƒğŸ¼ ğŸ˜‹ ğŸšµğŸ¿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘æƒ³åˆ†äº«æˆ‘ä»¬åœ¨iOSåº”ç”¨ç¨‹åºä¸­å·²ç»æˆåŠŸä½¿ç”¨äº†å‡ å¹´çš„ç»éªŒï¼Œå…¶ä¸­3ä¸ªå½“å‰åœ¨Appstoreä¸­ã€‚ è¿™ç§æ–¹æ³•æ•ˆæœå¾ˆå¥½ï¼Œæˆ‘ä»¬æœ€è¿‘å°†å…¶ä¸å…¶ä½™ä»£ç åˆ†å¼€ï¼Œå¹¶å°†å…¶è®¾è®¡åˆ°ä¸€ä¸ªå•ç‹¬çš„RouteComposeråº“ä¸­ï¼Œå®é™…ä¸Šå°†å¯¹æ­¤è¿›è¡Œè®¨è®ºã€‚ 


 https://github.com/ekazaev/route-...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>UIViewControllersçš„ç»„æˆä»¥åŠå®ƒä»¬ä¹‹é—´çš„å¯¼èˆªï¼ˆä¸ä»…å¦‚æ­¤ï¼‰</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421097/"><p><img src="https://habrastorage.org/webt/x7/yt/ll/x7ytllwqwgvgxy2rvtmdwj3qkia.png"></p><br><p> åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘æƒ³åˆ†äº«æˆ‘ä»¬åœ¨iOSåº”ç”¨ç¨‹åºä¸­å·²ç»æˆåŠŸä½¿ç”¨äº†å‡ å¹´çš„ç»éªŒï¼Œå…¶ä¸­3ä¸ªå½“å‰åœ¨Appstoreä¸­ã€‚ è¿™ç§æ–¹æ³•æ•ˆæœå¾ˆå¥½ï¼Œæˆ‘ä»¬æœ€è¿‘å°†å…¶ä¸å…¶ä½™ä»£ç åˆ†å¼€ï¼Œå¹¶å°†å…¶è®¾è®¡åˆ°ä¸€ä¸ªå•ç‹¬çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">RouteComposer</a>åº“ä¸­ï¼Œå®é™…ä¸Šå°†å¯¹æ­¤è¿›è¡Œè®¨è®ºã€‚ </p><a name="habracut"></a><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://github.com/ekazaev/route-composer</a> </p><br><p> ä½†æ˜¯ï¼Œå¯¹äºåˆå­¦è€…æ¥è¯´ï¼Œè®©æˆ‘ä»¬å°è¯•æ‰¾å‡ºiOSä¸­è§†å›¾æ§åˆ¶å™¨çš„ç»„æˆæ„å‘³ç€ä»€ä¹ˆã€‚ </p><br><p>åœ¨ç»§ç»­è¿›è¡Œè¯´æ˜ä¹‹å‰ï¼Œæˆ‘æé†’æ‚¨ï¼Œåœ¨iOSä¸­ï¼Œå®ƒé€šå¸¸è¢«ç†è§£ä¸ºè§†å›¾æ§åˆ¶å™¨æˆ–<code>UIViewController</code> ã€‚ è¿™æ˜¯ä»æ ‡å‡†<code>UIViewController</code>ç»§æ‰¿çš„ç±»ï¼Œè¯¥æ ‡å‡†<code>UIViewController</code>æ˜¯Appleå»ºè®®ç”¨äºå¼€å‘iOSåº”ç”¨ç¨‹åºçš„åŸºæœ¬MVCæ¨¡å¼æ§åˆ¶å™¨ã€‚ </p><br><p> æ‚¨å¯ä»¥ä½¿ç”¨å…¶ä»–æ¶æ„æ¨¡å¼ï¼Œä¾‹å¦‚MVVMï¼ŒVIPï¼ŒVIPERï¼Œä½†æ˜¯å…¶ä¸­çš„<code>UIViewController</code>å°†ä»¥ä¸€ç§æˆ–å¦ä¸€ç§æ–¹å¼æ¶‰åŠï¼Œè¿™æ„å‘³ç€è¯¥åº“å¯ä»¥ä¸å®ƒä»¬ä¸€èµ·ä½¿ç”¨ã€‚  <code>UIViewController</code>çš„æœ¬è´¨ç”¨äºæ§åˆ¶<code>UIView</code> ï¼Œ <code>UIView</code>é€šå¸¸ä»£è¡¨ä¸€ä¸ªå±å¹•æˆ–å±å¹•çš„é‡è¦éƒ¨åˆ†ï¼Œå¤„ç†æ¥è‡ªå…¶ä¸­çš„äº‹ä»¶å¹¶åœ¨å…¶ä¸­æ˜¾ç¤ºä¸€äº›æ•°æ®ã€‚ </p><br><p><img src="https://habrastorage.org/webt/5v/ia/-3/5via-37-mfc9leww-hwfvcu20eg.png"></p><br><p> æ‰€æœ‰<code>UIViewController</code>å¯ä»¥æœ‰æ¡ä»¶åœ°åˆ†ä¸º<strong>æ™®é€šè§†å›¾æ§åˆ¶å™¨</strong> ï¼ˆè´Ÿè´£åœ¨å±å¹•ä¸Šçš„æŸäº›å¯è§åŒºåŸŸï¼‰å’Œ<strong>å®¹å™¨è§†å›¾æ§åˆ¶å™¨</strong> ï¼ˆé™¤æ˜¾ç¤ºå…¶è‡ªèº«åŠå…¶æŸäº›æ§ä»¶å¤–ï¼Œè¿˜å¯ä»¥ä»¥ä¸€ç§æˆ–å¦ä¸€ç§æ–¹å¼æ˜¾ç¤ºé›†æˆåœ¨å…¶ä¸­çš„å­è§†å›¾æ§åˆ¶å™¨ï¼‰ ã€‚ </p><br><p>  Cocoa Touchéšé™„çš„æ ‡å‡†å®¹å™¨è§†å›¾æ§åˆ¶å™¨åŒ…æ‹¬ï¼š <code>UINavigationConroller</code> ï¼Œ <code>UITabBarController</code> ï¼Œ <code>UISplitController</code> ï¼Œ <code>UIPageController</code>ç­‰ã€‚ æ­¤å¤–ï¼Œç”¨æˆ·å¯ä»¥æŒ‰ç…§Appleæ–‡æ¡£ä¸­æè¿°çš„Cocoa Touchè§„åˆ™åˆ›å»ºè‡ªå·±çš„è‡ªå®šä¹‰å®¹å™¨è§†å›¾æ§åˆ¶å™¨ã€‚ </p><br><p> åœ¨å®¹å™¨è§†å›¾æ§åˆ¶å™¨ä¸­å¼•å…¥æ ‡å‡†è§†å›¾æ§åˆ¶å™¨çš„è¿‡ç¨‹ï¼Œä»¥åŠå°†è§†å›¾æ§åˆ¶å™¨é›†æˆåˆ°æ§åˆ¶å™¨å †æ ˆä¸­çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬å°†åœ¨æœ¬æ–‡ä¸­ç§°ä¹‹ä¸º<strong>ç»„åˆ</strong> ã€‚ </p><br><p> é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆå¯¹äºè§†å›¾æ§åˆ¶å™¨ç»„æˆè€Œè¨€ï¼Œæ ‡å‡†è§£å†³æ–¹æ¡ˆå¯¹æˆ‘ä»¬æ¥è¯´å¹¶ä¸æ˜¯æœ€ä½³é€‰æ‹©ï¼Œæˆ‘ä»¬å¼€å‘äº†ä¸€ä¸ªåº“æ¥ç®€åŒ–æˆ‘ä»¬çš„å·¥ä½œã€‚ </p><br><p> è®©æˆ‘ä»¬ä»¥ä¸€äº›æ ‡å‡†å®¹å™¨è§†å›¾æ§åˆ¶å™¨çš„ç»„æˆä¸ºä¾‹ï¼š </p><br><h3 id="primery-kompozicii-v-standartnyh-konteynerah"> æ ‡å‡†å®¹å™¨ä¸­çš„æˆåˆ†ç¤ºä¾‹ </h3><br><h4 id="uinavigationcontroller"> <code>UINavigationController</code> </h4> <br><p><img src="https://habrastorage.org/webt/zx/fc/su/zxfcsucgp6qusx4kkkfccphmzz0.png"></p><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> tableViewController = <span class="hljs-type"><span class="hljs-type">UITableViewController</span></span>(style: .plain) <span class="hljs-comment"><span class="hljs-comment">//        let navigationController = UINavigationController(rootViewController: tableViewController) // ... //        let detailViewController = UIViewController(nibName: "DetailViewController", bundle: nil) navigationController.pushViewController(detailViewController, animated: true) // ... //     navigationController.popToRootViewController(animated: true)</span></span></code> </pre> <br><h4 id="uitabbarcontroller"> <code>UITabBarController</code> </h4> <br><p><img src="https://habrastorage.org/webt/vi/2t/bx/vi2tbxjzyl9xs_rhrcpbx9p9lp8.png"></p><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> firstViewController = <span class="hljs-type"><span class="hljs-type">UITableViewController</span></span>(style: .plain) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> secondViewController = <span class="hljs-type"><span class="hljs-type">UIViewController</span></span>() <span class="hljs-comment"><span class="hljs-comment">//   let tabBarController = UITabBarController() //         tabBarController.viewControllers = [firstViewController, secondViewController] //        tabBarController.selectedViewController = secondViewController</span></span></code> </pre> <br><h4 id="uisplitviewcontroller"> <code>UISplitViewController</code> </h4> <br><p><img src="https://habrastorage.org/webt/gs/jx/ll/gsjxllx4rm_tjpukwtawibmffsg.png"></p><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> firstViewController = <span class="hljs-type"><span class="hljs-type">UITableViewController</span></span>(style: .plain) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> secondViewController = <span class="hljs-type"><span class="hljs-type">UIViewController</span></span>() <span class="hljs-comment"><span class="hljs-comment">//   let splitViewController = UISplitViewController() //        splitViewController.viewControllers = [firstViewController] //        splitViewController.showDetailViewController(secondViewController, sender: nil)</span></span></code> </pre> <br><h3 id="primery-integracii-kompozicii-vyu-kotrollerov-v-stek"> å †æ ˆä¸Šè§†å›¾æ§åˆ¶å™¨çš„é›†æˆï¼ˆç»„æˆï¼‰ç¤ºä¾‹ </h3><br><h4 id="ustanovka-vyu-kontrolera-rutom"> å®‰è£…è§†å›¾æ§åˆ¶å™¨æ ¹ç›®å½• </h4><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> window: <span class="hljs-type"><span class="hljs-type">UIWindow</span></span> = <span class="hljs-comment"><span class="hljs-comment">//... window.rootViewController = viewController window.makeKeyAndVisible()</span></span></code> </pre> <br><h4 id="modalnaya-prezentaciya-vyu-kontrolera"> è§†å›¾æ§åˆ¶å™¨çš„æ¨¡æ€è¡¨ç¤º </h4><br><pre> <code class="swift hljs">window.rootViewController.present(splitViewController, animated: animated, completion: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>)</code> </pre> <br><h3 id="pochemu-my-reshili-sozdat-biblioteku-dlya-kompozicii"> ä¸ºä»€ä¹ˆæˆ‘ä»¬å†³å®šåˆ›å»ºä¸€ä¸ªåˆæˆåº“ </h3><br><p> ä»ä¸Šé¢çš„ç¤ºä¾‹ä¸­å¯ä»¥çœ‹åˆ°ï¼Œæ²¡æœ‰å°†ä¼ ç»Ÿè§†å›¾æ§åˆ¶å™¨é›†æˆåˆ°å®¹å™¨ä¸­çš„å•ä¸€æ–¹æ³•ï¼Œå°±åƒæ²¡æœ‰æ„å»ºè§†å›¾æ§åˆ¶å™¨å †æ ˆçš„å”¯ä¸€æ–¹æ³•ä¸€æ ·ã€‚ è€Œä¸”ï¼Œå¦‚æœæ‚¨æƒ³ç¨å¾®æ›´æ”¹åº”ç”¨ç¨‹åºçš„å¸ƒå±€æˆ–å¯¼èˆªæ–¹å¼ï¼Œåˆ™éœ€è¦å¯¹åº”ç”¨ç¨‹åºä»£ç è¿›è¡Œé‡å¤§æ›´æ”¹ï¼Œè¿˜éœ€è¦æŒ‡å‘å®¹å™¨å¯¹è±¡çš„é“¾æ¥ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥å°†è§†å›¾æ§åˆ¶å™¨æ’å…¥å…¶ä¸­ï¼Œç­‰ç­‰ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œæ ‡å‡†æ–¹æ³•æœ¬èº«æ„å‘³ç€å¤§é‡å·¥ä½œï¼Œå¹¶ä¸”å­˜åœ¨æŒ‡å‘è§†å›¾æ§åˆ¶å™¨çš„é“¾æ¥ä»¥ç”Ÿæˆå…¶ä»–æ§åˆ¶å™¨çš„åŠ¨ä½œå’Œè¡¨ç¤ºã€‚ </p><br><p> æ‰€æœ‰è¿™äº›éƒ½ä½¿åº”ç”¨ç¨‹åºä¸­çš„å„ç§æ·±å±‚é“¾æ¥æ–¹æ³•ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨é€šç”¨é“¾æ¥ï¼‰æ›´åŠ å¤´ç—›ï¼Œå› ä¸ºæ‚¨å¿…é¡»å›ç­”ä»¥ä¸‹é—®é¢˜ï¼š <em>å¦‚æœå·²ç»æ˜¾ç¤ºäº†æ§åˆ¶å™¨ï¼Œå› ä¸ºç”¨æˆ·å·²ç»å•å‡»äº†é‡ç”ŸåŠ¨ç‰©å›­ä¸­çš„é“¾æ¥ï¼Œå°±éœ€è¦å‘ç”¨æˆ·æ˜¾ç¤ºè¯¥æ§åˆ¶å™¨ï¼Œæˆ–è€…æˆ‘æ­£åœ¨æŸ¥çœ‹è¯¥æ§åˆ¶å™¨å®ƒåº”è¯¥æ˜¾ç¤ºå°šæœªåˆ›å»º</em> ï¼Œè¿«ä½¿æ‚¨æµè§ˆè§†å›¾æ§åˆ¶å™¨æ ‘å¹¶ç¼–å†™ä»£ç ï¼Œæœ‰æ—¶æ‚¨çš„çœ¼ç›å¼€å§‹æµè¡€ï¼Œä»»ä½•iOSå¼€å‘äººå‘˜éƒ½è¯•å›¾éšè—è¯¥ä»£ç ã€‚ æ­¤å¤–ï¼Œä¸åœ¨iOSä¸­ä¸ºæ¯ä¸ªå±å¹•å•ç‹¬æ„å»ºçš„Androidä½“ç³»ç»“æ„ä¸åŒï¼Œä¸ºäº†åœ¨å¯åŠ¨åç«‹å³æ˜¾ç¤ºåº”ç”¨ç¨‹åºçš„æŸäº›éƒ¨åˆ†ï¼Œå¯èƒ½æœ‰å¿…è¦æ„å»ºç›¸å½“å¤§çš„æ§åˆ¶å™¨å †æ ˆï¼Œè¿™äº›æ§åˆ¶å™¨å°†éšè—åœ¨æ‚¨åº”è¦æ±‚æ˜¾ç¤ºçš„æ§åˆ¶å™¨ä¸‹ã€‚ </p><br><p> å½“ç”¨æˆ·å•å‡»æŒ‰é’®æ—¶ï¼Œæˆ–è€…å½“åº”ç”¨ç¨‹åºä»å¦ä¸€ä¸ªåº”ç”¨ç¨‹åº<code>goToProduct(withId: "012345")</code>é€šç”¨é“¾æ¥å¹¶ä¸”ä¸è€ƒè™‘å°†æ­¤è§†å›¾æ§åˆ¶å™¨é›†æˆåˆ°å †æ ˆæ—¶ï¼Œæœ€å¥½è°ƒç”¨è¯¸å¦‚<code>goToAccount()</code> ï¼Œ <code>goToMenu()</code>æˆ–<code>goToProduct(withId: "012345")</code>è¯¥è§†å›¾æ§åˆ¶å™¨çš„åˆ›å»ºè€…å·²ç»æä¾›äº†æ­¤å®ç°ã€‚ </p><br><p> æ­¤å¤–ï¼Œé€šå¸¸ï¼Œæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºç”±ä¸åŒå›¢é˜Ÿå¼€å‘çš„å¤§é‡å±å¹•ç»„æˆï¼Œä¸ºäº†åœ¨å¼€å‘è¿‡ç¨‹ä¸­è¿›å…¥å…¶ä¸­ä¸€ä¸ªå±å¹•ï¼Œæ‚¨éœ€è¦æµè§ˆå¦ä¸€ä¸ªå¯èƒ½å°šæœªåˆ›å»ºçš„å±å¹•ã€‚ åœ¨æˆ‘ä»¬å…¬å¸ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ç§°ä¸º<em>åŸ¹å…»çš¿</em>çš„æ–¹æ³•ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨å¼€å‘æ¨¡å¼ä¸‹ï¼Œå¼€å‘äººå‘˜å’Œæµ‹è¯•äººå‘˜å¯ä»¥è®¿é—®æ‰€æœ‰åº”ç”¨ç¨‹åºå±å¹•çš„åˆ—è¡¨ï¼Œå¹¶ä¸”ä»–å¯ä»¥è½¬åˆ°å…¶ä¸­çš„ä»»ä½•ä¸€ä¸ªï¼ˆå½“ç„¶ï¼Œå…¶ä¸­ä¸€äº›å¯èƒ½éœ€è¦ä¸€äº›è¾“å…¥å‚æ•°ï¼‰ã€‚ </p><br><p><img src="https://habrastorage.org/webt/5l/wx/cv/5lwxcvup0mtdaedrgjsxokbsdti.png"></p><br><p> æ‚¨å¯ä»¥ä¸å®ƒä»¬è¿›è¡Œäº¤äº’å¹¶å•ç‹¬è¿›è¡Œæµ‹è¯•ï¼Œç„¶åå°†å®ƒä»¬ç»„è£…åˆ°æœ€ç»ˆçš„ç”Ÿäº§åº”ç”¨ç¨‹åºä¸­ã€‚ è¿™ç§æ–¹æ³•æå¤§åœ°ä¿ƒè¿›äº†å¼€å‘ï¼Œä½†æ˜¯ï¼Œå¦‚æ‚¨ä»ä¸Šé¢çš„ç¤ºä¾‹ä¸­çœ‹åˆ°çš„é‚£æ ·ï¼Œå½“æ‚¨éœ€è¦åœ¨ä»£ç ä¸­ä¿ç•™å‡ ç§å°†è§†å›¾æ§åˆ¶å™¨é›†æˆåˆ°å †æ ˆä¸­çš„æ–¹å¼æ—¶ï¼Œç»„åˆåœ°ç‹±å°±å¼€å§‹äº†ã€‚ </p><br><p> ä»ç„¶éœ€è¦è¡¥å……çš„æ˜¯ï¼Œä¸€æ—¦æ‚¨çš„è¥é”€å›¢é˜Ÿè¡¨ç¤ºå¸Œæœ›å¯¹å®æ—¶ç”¨æˆ·è¿›è¡ŒA / Bæµ‹è¯•å¹¶æ£€æŸ¥å“ªç§å¯¼èˆªæ–¹æ³•æ•ˆæœæ›´å¥½ï¼Œä¾‹å¦‚é€‰é¡¹å¡æ æˆ–æ±‰å ¡èœå•ï¼Œæ‰€æœ‰è¿™äº›éƒ½å°†ä¹˜ä»¥Nã€‚ </p><br><ul><li><del> è®©æˆ‘ä»¬åˆ‡æ‰è‹çŠå®çš„è…¿ </del> è®©æˆ‘ä»¬å±•ç¤ºä¸€ä¸‹æ ‡ç­¾æ çš„50ï¼…ç”¨æˆ·ï¼Œä»¥åŠå…¶ä»–æ±‰å ¡èœå•ï¼Œç„¶åæˆ‘ä»¬å°†åœ¨ä¸€ä¸ªæœˆå†…å‘Šè¯‰æ‚¨å“ªäº›ç”¨æˆ·çœ‹åˆ°äº†æˆ‘ä»¬çš„æ›´å¤šä¼˜æƒ ï¼Ÿ </li></ul><br><p> æˆ‘å°†å°è¯•å‘Šè¯‰æ‚¨æˆ‘ä»¬å¦‚ä½•è§£å†³è¯¥é—®é¢˜å¹¶å°†å…¶æœ€ç»ˆåˆ†é…ç»™RouteComposeråº“ã€‚ </p><br><h3 id="susanin-route-composer"><del> è‹çŠå® </del> è·¯çº¿ä½œæ›²å®¶ </h3><br><p> åœ¨åˆ†æäº†ç»„åˆå’Œå¯¼èˆªçš„æ‰€æœ‰åœºæ™¯ä¹‹åï¼Œæˆ‘ä»¬å°è¯•å¯¹ä»¥ä¸Šç¤ºä¾‹ä¸­ç»™å‡ºçš„ä»£ç è¿›è¡ŒæŠ½è±¡ï¼Œå¹¶ç¡®å®š<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">RouteComposer</a>åº“<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿è¡Œçš„</a> 3ä¸ªä¸»è¦å®ä½“<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-Factory</a> ï¼Œ <code>Finder</code>å’Œ<code>Action</code> ã€‚ æ­¤å¤–ï¼Œè¯¥åº“åŒ…å«3ä¸ªè¾…åŠ©å®ä½“ï¼Œå®ƒä»¬è´Ÿè´£å¯¼èˆªè¿‡ç¨‹ä¸­å¯èƒ½éœ€è¦çš„ä¸€äº›å¾®è°ƒ<code>RoutingInterceptor</code> ï¼Œ <code>ContextTask</code> ï¼Œ <code>PostRoutingTask</code> ã€‚ æ‰€æœ‰è¿™äº›å®ä½“éƒ½å¿…é¡»æŒ‰ç…§ä¸€ç³»åˆ—ä¾èµ–å…³ç³»è¿›è¡Œé…ç½®ï¼Œå¹¶è½¬ç§»åˆ°<code>Router</code> yï¼ˆå°†å»ºç«‹æ‚¨çš„æ§åˆ¶å™¨å †æ ˆçš„å¯¹è±¡ï¼‰ä¸­ã€‚ </p><br><p> ä½†æ˜¯ï¼Œå…³äºå®ƒä»¬çš„é¡ºåºï¼š </p><br><h4 id="factory"> å·¥å‚å·¥å‚ </h4><br><p> é¡¾åæ€ä¹‰ï¼Œ <code>Factory</code>è´Ÿè´£åˆ›å»ºè§†å›¾æ§åˆ¶å™¨ã€‚ </p><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">protocol</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Factory</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">associatedtype</span></span> <span class="hljs-type"><span class="hljs-type">ViewController</span></span>: <span class="hljs-type"><span class="hljs-type">UIViewController</span></span> <span class="hljs-keyword"><span class="hljs-keyword">associatedtype</span></span> <span class="hljs-type"><span class="hljs-type">Context</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(with context: Context)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">throws</span></span> -&gt; <span class="hljs-type"><span class="hljs-type">ViewController</span></span> }</code> </pre> <br><p> åœ¨è¿™é‡Œï¼Œé‡è¦çš„æ˜¯è¦ä¿ç•™<strong>ä¸Šä¸‹æ–‡</strong>çš„æ¦‚å¿µã€‚ åœ¨åº“ä¸­çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œæˆ‘ä»¬è°ƒç”¨äº†æŸ¥çœ‹å™¨æ‰èƒ½åˆ›å»ºçš„æ‰€æœ‰å†…å®¹ã€‚ ä¾‹å¦‚ï¼Œä¸ºäº†æ˜¾ç¤ºä¸€ä¸ªæ˜¾ç¤ºäº§å“è¯¦ç»†ä¿¡æ¯çš„è§†å›¾æ§åˆ¶å™¨ï¼Œæ‚¨éœ€è¦å°†æŸä¸ªproductIDä¼ é€’ç»™å®ƒï¼Œä¾‹å¦‚ï¼Œä»¥<code>String</code>çš„å½¢å¼ã€‚ ä¸Šä¸‹æ–‡çš„æœ¬è´¨å¯ä»¥æ˜¯ä»»ä½•ä¸œè¥¿ï¼šå¯¹è±¡ï¼Œç»“æ„ï¼Œå—æˆ–å…ƒç»„ã€‚ å¦‚æœæ‚¨çš„æ§åˆ¶å™¨ä¸éœ€è¦ä»»ä½•ä¸œè¥¿æ¥åˆ›å»º-ä¸Šä¸‹æ–‡å¯ä»¥æŒ‡å®šä¸º<code>Any?</code> å¹¶å®‰è£…åœ¨<code>nil</code> ã€‚ </p><br><p> ä¾‹å¦‚ï¼š </p><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductViewControllerFactory</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Factory</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(with productID: UUID)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">throws</span></span> -&gt; <span class="hljs-type"><span class="hljs-type">ProductViewController</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> productViewController = <span class="hljs-type"><span class="hljs-type">ProductViewController</span></span>(nibName: <span class="hljs-string"><span class="hljs-string">"ProductViewController"</span></span>, bundle: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) productViewController.productID = productID <span class="hljs-comment"><span class="hljs-comment">//  ,      `ContextAction`,     return productViewController } }</span></span></code> </pre> <br><p> ä»ä¸Šé¢çš„å®ç°ä¸­å¯ä»¥æ¸…æ¥šåœ°çœ‹å‡ºï¼Œè¯¥å·¥å‚å°†ä»XIBæ–‡ä»¶ä¸­åŠ è½½æ§åˆ¶å™¨æ˜ åƒå¹¶å°†å·²å®‰è£…çš„productIDå®‰è£…åˆ°è¯¥æ˜ åƒä¸­ã€‚ é™¤äº†æ ‡å‡†çš„<code>Factory</code>åè®®ä¹‹å¤–ï¼Œè¯¥åº“è¿˜æä¾›äº†è¯¥åè®®çš„å‡ ç§æ ‡å‡†å®ç°ï¼Œä»è€Œä½¿æ‚¨ä¸å¿…ç¼–å†™æ™®é€šä»£ç ï¼ˆå°¤å…¶æ˜¯ä¸Šé¢çš„ç¤ºä¾‹ï¼‰ã€‚ </p><br><p> æ­¤å¤–ï¼Œæˆ‘å°†é¿å…æä¾›åè®®çš„æè¿°åŠå…¶å®ç°çš„ç¤ºä¾‹ï¼Œå› ä¸ºæ‚¨å¯ä»¥é€šè¿‡ä¸‹è½½åº“éšé™„çš„ç¤ºä¾‹æ¥ç†Ÿæ‚‰å®ƒä»¬çš„è¯¦ç»†ä¿¡æ¯ã€‚ å¯¹äºä¼ ç»Ÿçš„è§†å›¾æ§åˆ¶å™¨å’Œå®¹å™¨ï¼Œå·¥å‚æœ‰å¤šç§å®ç°æ–¹å¼ï¼Œä»¥åŠé…ç½®å®ƒä»¬çš„æ–¹å¼ã€‚ </p><br><h4 id="action"> åŠ¨ä½œç‰‡ </h4><br><p>  <code>Action</code>å®ä½“æè¿°å¦‚ä½•å°†ç”±å·¥å‚æ„å»ºçš„è§†å›¾æ§åˆ¶å™¨é›†æˆåˆ°å †æ ˆä¸­ã€‚ åˆ›å»ºåçš„è§†å›¾æ§åˆ¶å™¨ä¸èƒ½ç®€å•åœ°æŒ‚åœ¨ç©ºä¸­ï¼Œå› æ­¤ï¼Œæ¯ä¸ªå·¥å‚éƒ½åº”åŒ…å«<code>Action</code>å¦‚ä¸Šä¾‹æ‰€ç¤ºï¼‰ã€‚ </p><br><p>  <code>Action</code>çš„æœ€å¸¸è§å®ç°æ˜¯æ§åˆ¶å™¨çš„æ¨¡å¼è¡¨ç¤ºï¼š </p><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PresentModally</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Action</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">perform</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(viewController: UIViewController, on existingController: UIViewController, animated: Bool, completion: @escaping </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(</span></span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">: ActionResult)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> existingController.presentedViewController == <span class="hljs-literal"><span class="hljs-literal">nil</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { completion(.failure(<span class="hljs-string"><span class="hljs-string">"\(existingController) is already presenting a view controller."</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } existingController.present(viewController, animated: animated, completion: { completion(.continueRouting) }) } }</code> </pre> <br><p> è¯¥åº“åŒ…å«å°†è§†å›¾æ§åˆ¶å™¨é›†æˆåˆ°å †æ ˆä¸­çš„å¤§å¤šæ•°æ ‡å‡†æ–¹æ³•çš„å®ç°ï¼Œåœ¨ä½¿ç”¨æŸç§è‡ªå®šä¹‰å®¹å™¨è§†å›¾æ§åˆ¶å™¨æˆ–è¡¨ç¤ºæ–¹æ³•ä¹‹å‰ï¼Œæ‚¨å¯èƒ½ä¸å¿…åˆ›å»ºè‡ªå·±çš„è§†å›¾æ§åˆ¶å™¨ã€‚ ä½†æ˜¯ï¼Œå¦‚æœæ‚¨é˜…è¯»ç¤ºä¾‹ï¼Œåˆ™åˆ›å»ºè‡ªå®šä¹‰åŠ¨ä½œä¸ä¼šå¼•èµ·é—®é¢˜ã€‚ </p><br><h4 id="finder"> æŸ¥æ‰¾å™¨ </h4><br><p>  <code>Finder</code>çš„æœ¬è´¨å›ç­”äº†è·¯ç”±å™¨çš„é—®é¢˜<em>-è¿™æ ·çš„æ§åˆ¶å™¨æ˜¯å¦å·²ç»åˆ›å»ºå¹¶ä¸”å·²ç»åœ¨å †æ ˆä¸­ï¼Ÿ</em>  <em>ä¹Ÿè®¸ä¸éœ€è¦åˆ›å»ºä»»ä½•ä¸œè¥¿ï¼Œè¶³ä»¥æ˜¾ç¤ºå·²ç»å­˜åœ¨çš„å†…å®¹äº†å—ï¼Ÿ</em>  ã€‚ </p><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">protocol</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Finder</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">associatedtype</span></span> <span class="hljs-type"><span class="hljs-type">ViewController</span></span>: <span class="hljs-type"><span class="hljs-type">UIViewController</span></span> <span class="hljs-keyword"><span class="hljs-keyword">associatedtype</span></span> <span class="hljs-type"><span class="hljs-type">Context</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">findViewController</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(with context: Context)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">ViewController?</span></span> }</code> </pre> <br><p> å¦‚æœå­˜å‚¨æŒ‡å‘åˆ›å»ºçš„æ‰€æœ‰è§†å›¾æ§åˆ¶å™¨çš„é“¾æ¥ï¼Œåˆ™åœ¨<code>Finder</code>å®ç°ä¸­ï¼Œæ‚¨å¯ä»¥ç®€å•åœ°å°†é“¾æ¥è¿”å›è‡³æ‰€éœ€çš„è§†å›¾æ§åˆ¶å™¨ã€‚ ä½†æ˜¯å¤§å¤šæ•°æƒ…å†µå¹¶éå¦‚æ­¤ï¼Œå› ä¸ºåº”ç”¨ç¨‹åºå †æ ˆï¼ˆå°¤å…¶æ˜¯å¤§å‹åº”ç”¨ç¨‹åºå †æ ˆï¼‰çš„å˜åŒ–éå¸¸åŠ¨æ€ã€‚ æ­¤å¤–ï¼Œæ‚¨å¯ä»¥åœ¨å †æ ˆä¸Šæœ‰å‡ ä¸ªç›¸åŒçš„è§†å›¾æ§åˆ¶å™¨æ¥æ˜¾ç¤ºä¸åŒçš„å®ä½“ï¼ˆä¾‹å¦‚ï¼Œå‡ ä¸ªProductViewControllerså¯ä»¥æ˜¾ç¤ºå…·æœ‰ä¸åŒproductIDçš„ä¸åŒäº§å“ï¼‰ï¼Œå› æ­¤<code>Finder</code>å®ç°å¯èƒ½éœ€è¦è‡ªå®šä¹‰å®ç°å¹¶åœ¨å †æ ˆä¸Šæœç´¢ç›¸åº”çš„è§†å›¾æ§åˆ¶å™¨ã€‚ è¯¥åº“é€šè¿‡æä¾›<code>StackIteratingFinder</code>ä½œä¸º<code>Finder</code>çš„æ‰©å±•æ¥ç®€åŒ–æ­¤ä»»åŠ¡ï¼Œè¯¥åè®®å…·æœ‰ç”¨äºç®€åŒ–æ­¤ä»»åŠ¡çš„é€‚å½“è®¾ç½®ã€‚ åœ¨<code>StackIteratingFinder</code>çš„å®ç°ä¸­<code>StackIteratingFinder</code>æ‚¨åªéœ€è¦å›ç­”é—®é¢˜-è¿™ä¸ªè§†å›¾æ§åˆ¶å™¨æ˜¯è·¯ç”±å™¨æ ¹æ®æ‚¨çš„è¯·æ±‚å¯»æ‰¾çš„é‚£ä¸ªæ§åˆ¶å™¨ã€‚ </p><br><p> æ­¤ç±»å®ç°çš„ç¤ºä¾‹ï¼š </p><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductViewControllerFinder</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StackIteratingFinder</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> options: <span class="hljs-type"><span class="hljs-type">SearchOptions</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(options: <span class="hljs-type"><span class="hljs-type">SearchOptions</span></span> = .currentAndUp) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.options = options } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isTarget</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> productViewController: ProductViewController, with productID: UUID)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> productViewController.productID == productID } }</code> </pre> <br><h3 id="vspomogatelnye-suschnosti"> è¾…åŠ©å®ä½“ </h3><br><h4 id="routinginterceptor"> <code>RoutingInterceptor</code> </h4> <br><p>  <code>RoutingInterceptor</code>å…è®¸æ‚¨åœ¨å¼€å§‹ç»„åˆè§†å›¾æ§åˆ¶å™¨ä¹‹å‰æ‰§è¡Œä¸€äº›æ“ä½œï¼Œå¹¶å‘Šè¯‰è·¯ç”±å™¨æ˜¯å¦å¯ä»¥åœ¨å †æ ˆä¸­é›†æˆè§†å›¾æ§åˆ¶å™¨ã€‚ æ­¤ç±»ä»»åŠ¡æœ€å¸¸è§çš„ç¤ºä¾‹æ˜¯èº«ä»½éªŒè¯ï¼ˆä½†åœ¨å®ç°ä¸­ä¸€ç‚¹éƒ½ä¸å¸¸è§ï¼‰ã€‚ ä¾‹å¦‚ï¼Œæ‚¨æƒ³æ˜¾ç¤ºä¸€ä¸ªå…·æœ‰ç”¨æˆ·å¸æˆ·è¯¦ç»†ä¿¡æ¯çš„è§†å›¾æ§åˆ¶å™¨ï¼Œä½†æ˜¯ä¸ºæ­¤ï¼Œç”¨æˆ·å¿…é¡»ç™»å½•åˆ°ç³»ç»Ÿã€‚ æ‚¨å¯ä»¥å®ç°<code>RoutingInterceptor</code>å¹¶å°†å…¶æ·»åŠ åˆ°ç”¨æˆ·è¯¦ç»†ä¿¡æ¯æ§åˆ¶å™¨çš„è§†å›¾é…ç½®ä¸­ï¼Œå¹¶è¿›è¡Œå†…éƒ¨æ£€æŸ¥ï¼šå¦‚æœç”¨æˆ·å·²ç™»å½•ï¼Œåˆ™å…è®¸è·¯ç”±å™¨ç»§ç»­å¯¼èˆªï¼›å¦‚æœæœªç™»å½•ï¼Œåˆ™æ˜¾ç¤ºæç¤ºç”¨æˆ·ç™»å½•çš„è§†å›¾æ§åˆ¶å™¨ï¼›å¦‚æœæ­¤æ“ä½œæˆåŠŸï¼Œåˆ™å…è®¸è·¯ç”±å™¨ç»§ç»­å¯¼èˆªæˆ–å–æ¶ˆå¦‚æœç”¨æˆ·æ‹’ç»ç™»å½•ï¼Œåˆ™ä¸ºå¥¹ã€‚ </p><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LoginInterceptor</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RoutingInterceptor</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">execute</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">for</span></span></span></span><span class="hljs-function"><span class="hljs-params"> destination: AppDestination, completion: @escaping </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(</span></span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">: InterceptorResult)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> !<span class="hljs-type"><span class="hljs-type">LoginManager</span></span>.sharedInstance.isUserLoggedIn <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">// ... //  LoginViewController       completion(.success)  completion(.failure("User has not been logged in.")) // ... return } completion(.success) } }</span></span></code> </pre><br><p> åº“éšé™„çš„ç¤ºä¾‹ä¸­åŒ…å«å¸¦æœ‰æ³¨é‡Šçš„<code>RoutingInterceptor</code>çš„å®ç°ã€‚ </p><br><h4 id="contexttask"> <code>ContextTask</code> </h4> <br><p> å¦‚æœæä¾›äº†<code>ContextTask</code> ï¼Œåˆ™å¯ä»¥å°†å…¶å•ç‹¬åº”ç”¨äºé…ç½®ä¸­çš„æ¯ä¸ªè§†å›¾æ§åˆ¶å™¨ï¼Œè€Œä¸ç®¡å®ƒæ˜¯ç”±è·¯ç”±å™¨åˆ›å»ºçš„è¿˜æ˜¯åœ¨å †æ ˆä¸­æ‰¾åˆ°çš„ï¼Œè€Œæ‚¨åªæƒ³æ›´æ–°å…¶ä¸­çš„æ•°æ®æˆ–è®¾ç½®ä¸€äº›é»˜è®¤å€¼å‚æ•°ï¼ˆä¾‹å¦‚ï¼Œæ˜¾ç¤ºå…³é—­æŒ‰é’®æˆ–ä¸æ˜¾ç¤ºï¼‰ã€‚ </p><br><h4 id="postroutingtask"> <code>PostRoutingTask</code> </h4> <br><p> æˆåŠŸå®Œæˆè¯·æ±‚çš„è§†å›¾æ§åˆ¶å™¨åˆ°å †æ ˆçš„é›†æˆåï¼Œè·¯ç”±å™¨å°†è°ƒç”¨<code>PostRoutingTask</code>çš„å®ç°ã€‚ åœ¨å…¶å®ç°ä¸­ï¼Œæ·»åŠ å„ç§åˆ†ææˆ–æå–å„ç§æœåŠ¡éå¸¸æ–¹ä¾¿ã€‚ </p><br><p>  <strong>æœ‰å…³æ‰€æœ‰æè¿°å®ä½“çš„å®ç°çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§è¯¥åº“çš„æ–‡æ¡£ä»¥åŠéšé™„çš„ç¤ºä¾‹ã€‚</strong> </p><br><p>  PSï¼šå¯ä»¥æ·»åŠ åˆ°é…ç½®ä¸­çš„è¾…åŠ©å®ä½“çš„æ•°é‡ä¸å—é™åˆ¶ã€‚ </p><br><h3 id="konfiguraciya"> æ„å‹ </h3><br><p> æ‰€æœ‰æè¿°çš„å®ä½“éƒ½å¾ˆå¥½ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥å°†ç»„æˆè¿‡ç¨‹åˆ†ä¸ºå¤šä¸ªå°çš„ï¼Œå¯äº’æ¢çš„å’Œå€¼å¾—ä¿¡èµ–çš„å—ã€‚ </p><br><p> ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç»§ç»­æœ€é‡è¦çš„äº‹æƒ…-é…ç½®ï¼Œå³è¿™äº›å—ä¹‹é—´çš„è¿æ¥ã€‚ ä¸ºäº†æ”¶é›†å®ƒä»¬ä¹‹é—´çš„è¿™äº›å—å¹¶å°†å®ƒä»¬ç»„åˆæˆä¸€ä¸ªæ­¥éª¤é“¾ï¼Œè¯¥åº“æä¾›äº†ä¸€ä¸ªæ„å»ºå™¨ç±»<code>StepAssembly</code> ï¼ˆå¯¹äºå®¹å™¨<code>StepAssembly</code> ï¼‰ã€‚ å®ƒçš„å®ç°ä½¿æ‚¨å¯ä»¥å°†ç»„åˆå—å­—ç¬¦ä¸²åŒ–ä¸ºå•ä¸ªé…ç½®å¯¹è±¡ï¼Œä¾‹å¦‚å­—ç¬¦ä¸²ä¸Šçš„å°ç ï¼Œè¿˜å¯ä»¥æŒ‡ç¤ºå¯¹å…¶ä»–è§†å›¾æ§åˆ¶å™¨çš„é…ç½®çš„ä¾èµ–æ€§ã€‚ å°†æ¥å¦‚ä½•é…ç½®å–å†³äºæ‚¨ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨å¿…è¦çš„å‚æ•°å°†å…¶é¦ˆé€åˆ°è·¯ç”±å™¨ï¼Œå®ƒå°†ä¸ºæ‚¨æ„å»ºä¸€å †æ§åˆ¶å™¨ï¼Œæ‚¨å¯ä»¥å°†å…¶ä¿å­˜åˆ°å­—å…¸ä¸­ï¼Œä»¥åå†é€šè¿‡æŒ‰é”®ä½¿ç”¨-è¿™å–å†³äºæ‚¨çš„ç‰¹å®šä»»åŠ¡ã€‚ </p><br><p> è€ƒè™‘ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼šå‡è®¾ï¼Œé€šè¿‡å•å‡»åˆ—è¡¨ä¸­çš„æŸä¸ªå•å…ƒæ ¼ï¼Œæˆ–è€…å½“åº”ç”¨ç¨‹åºä»é‡ç”ŸåŠ¨ç‰©å›­æˆ–ç”µå­é‚®ä»¶å®¢æˆ·ç«¯æ”¶åˆ°é€šç”¨é“¾æ¥æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä»¥æ¨¡æ€æ–¹å¼æ˜¾ç¤ºå…·æœ‰ç‰¹å®šproductIDçš„äº§å“æ§åˆ¶å™¨ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¿…é¡»åœ¨<code>UINavigationController</code>å†…éƒ¨æ„å»ºäº§å“æ§åˆ¶å™¨ï¼Œä»¥ä¾¿å®ƒå¯ä»¥åœ¨å…¶æ§åˆ¶é¢æ¿ä¸Šæ˜¾ç¤ºå…¶åç§°å’Œå…³é—­æŒ‰é’®ã€‚ æ­¤å¤–ï¼Œæ­¤äº§å“åªèƒ½æ˜¾ç¤ºç»™å·²ç™»å½•çš„ç”¨æˆ·ï¼Œå¦åˆ™ï¼Œè¯·é‚€è¯·ä»–ä»¬ç™»å½•ã€‚ </p><br><p> å¦‚æœåœ¨ä¸ä½¿ç”¨åº“çš„æƒ…å†µä¸‹åˆ†ææ­¤ç¤ºä¾‹ï¼Œåˆ™å®ƒå°†ç±»ä¼¼äºä»¥ä¸‹å†…å®¹ï¼š </p><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductArrayViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UITableViewController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> products: [<span class="hljs-type"><span class="hljs-type">UUID</span></span>]? <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> analyticsManager = <span class="hljs-type"><span class="hljs-type">AnalyticsManager</span></span>.sharedInstance <span class="hljs-comment"><span class="hljs-comment">//  UITableViewControllerDelegate override func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) { guard let productID = products[indexPath.row] else { return } //   LoginInterceptor guard !LoginManager.sharedInstance.isUserLoggedIn else { //    LoginViewController         `showProduct(with: productID)` return } showProduct(with: productID) } func showProduct(with productID: String) { //   ProductViewControllerFactory let productViewController = ProductViewController(nibName: "ProductViewController", bundle: nil) //   ProductViewControllerContextTask productViewController.productID = productID //   NavigationControllerStep  PushToNavigationAction let navigationController = UINavigationController(rootViewController: productViewController) //   GenericActions.PresentModally present(alertController, animated: navigationController) { [weak self]   . ProductViewControllerPostTask self?.analyticsManager.trackProductView(productID: productID) } } }</span></span></code> </pre> <br><p> æ­¤ç¤ºä¾‹ä¸åŒ…æ‹¬é€šç”¨é“¾æ¥çš„å®ç°ï¼Œè¿™å°†éœ€è¦éš”ç¦»æˆæƒä»£ç ï¼Œå¹¶åœ¨ç”¨æˆ·çªç„¶å•å‡»é“¾æ¥ä¹‹åè¿›è¡Œæœç´¢ä»¥åŠæœç´¢ä¹‹åï¼Œåº”ä¿æŒå°†ç”¨æˆ·å®šå‘åˆ°çš„ä¸Šä¸‹æ–‡ï¼Œå¹¶ä¸”å·²ç»å‘ä»–å±•ç¤ºäº†æ­¤äº§å“ï¼Œè¿™æœ€ç»ˆå°†ä½¿ä»£ç éå¸¸å®ç”¨ã€‚å¾ˆéš¾è¯»ã€‚ </p><br><p>  <strong>è€ƒè™‘ä½¿ç”¨è¯¥åº“çš„ç¤ºä¾‹é…ç½®ï¼š</strong> </p><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> productScreen = <span class="hljs-type"><span class="hljs-type">StepAssembly</span></span>(finder: <span class="hljs-type"><span class="hljs-type">ProductViewControllerFinder</span></span>(), factory: <span class="hljs-type"><span class="hljs-type">ProductViewControllerFactory</span></span>()) <span class="hljs-comment"><span class="hljs-comment">//  : .adding(LoginInterceptor()) .adding(ProductViewControllerContextTask()) .adding(ProductViewControllerPostTask(analyticsManager: AnalyticsManager.sharedInstance)) //  : .using(PushToNavigationAction()) .from(NavigationControllerStep()) // NavigationControllerStep -&gt; StepAssembly(finder: NilFinder(), factory: NavigationControllerFactory()) .using(GeneralAction.presentModally()) .from(GeneralStep.current()) .assemble()</span></span></code> </pre> <br><p> å¦‚æœå°†å…¶ç¿»è¯‘æˆäººç±»è¯­è¨€ï¼š </p><br><ul><li> æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç™»å½•ï¼Œå¦‚æœæ²¡æœ‰æä¾›è¾“å…¥ </li><li> å¦‚æœç”¨æˆ·å·²æˆåŠŸç™»å½•ï¼Œè¯·ç»§ç»­ </li><li>  <code>Finder</code>æä¾›çš„æœç´¢äº§å“è§†å›¾æ§åˆ¶å™¨ </li><li> å¦‚æœæ‰¾åˆ°-ä½¿å¯è§å¹¶å®Œæˆ </li><li> å¦‚æœæœªæ‰¾åˆ°-åˆ›å»ºä¸€ä¸ª<code>UINavigationController</code> ï¼Œå°†<code>ProductViewControllerFactory</code>ä½¿ç”¨<code>PushToNavigationAction</code>åˆ›å»ºçš„è§†å›¾æ§åˆ¶å™¨é›†æˆåˆ°å…¶ä¸­ </li><li> ä»å½“å‰è§†å›¾æ§åˆ¶å™¨ä½¿ç”¨<code>GenericActions.PresentModally</code> <code>UINavigationController</code> </li></ul><br><p> åƒè®¸å¤šå¤æ‚çš„è§£å†³æ–¹æ¡ˆä¸€æ ·ï¼Œè¯¥é…ç½®éœ€è¦è¿›è¡Œä¸€äº›ç ”ç©¶ï¼Œä¾‹å¦‚<code>AutoLayout</code>çš„æ¦‚å¿µï¼Œä¹ä¸€çœ‹ï¼Œå®ƒä¼¼ä¹å¾ˆå¤æ‚ä¸”å¤šä½™ã€‚ ä½†æ˜¯ï¼Œç»™å®šä»£ç ç‰‡æ®µè¦è§£å†³çš„ä»»åŠ¡æ•°é‡æ¶µç›–äº†ä»æˆæƒåˆ°æ·±åº¦é“¾æ¥çš„æ‰€æœ‰æ–¹é¢ï¼Œå¹¶ä¸”åˆ†æˆä¸€ç³»åˆ—åŠ¨ä½œå¯ä»¥è½»æ¾æ›´æ”¹é…ç½®ï¼Œè€Œæ— éœ€æ›´æ”¹ä»£ç ã€‚ æ­¤å¤–ï¼Œ <code>StepAssembly</code>çš„å®ç°å°†å¸®åŠ©æ‚¨é¿å…æ­¥éª¤é“¾ä¸å®Œæ•´å’Œç±»å‹æ§åˆ¶çš„é—®é¢˜-ä¸åŒè§†å›¾æ§åˆ¶å™¨çš„è¾“å…¥å‚æ•°ä¸å…¼å®¹çš„é—®é¢˜ã€‚ </p><br><p> è€ƒè™‘ä¸€ä¸ªå®Œæ•´çš„åº”ç”¨ç¨‹åºçš„ä¼ªä»£ç ï¼Œå…¶ä¸­<code>ProductArrayViewController</code>åœ¨å…¶ä¸­æ˜¾ç¤ºäº§å“åˆ—è¡¨ï¼Œå¦‚æœç”¨æˆ·é€‰æ‹©æ­¤äº§å“ï¼Œåˆ™æ ¹æ®ç”¨æˆ·æ˜¯å¦ç™»å½•æˆ–è€…åœ¨æˆåŠŸç™»å½•åæ˜¯å¦æ„¿æ„ç™»å½•å¹¶æ˜¾ç¤ºæ¥æ˜¾ç¤ºè¯¥äº§å“ï¼š </p><br><p>  <strong>é…ç½®å¯¹è±¡</strong> </p><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">// `RoutingDestination`    .          . struct AppDestination: RoutingDestination { let finalStep: RoutingStep let context: Any? } struct Configuration { //     ,             static func productDestination(with productID: UUID) -&gt; AppDestination { let productScreen = StepAssembly(finder: ProductViewControllerFinder(), factory: ProductViewControllerFactory()) .add(LoginInterceptor()) .add(ProductViewControllerContextTask()) .add(ProductViewControllerPostTask(analyticsManager: AnalyticsManager.sharedInstance)) .using(PushToNavigationAction()) .from(NavigationControllerStep()) .using(GenericActions.PresentModally()) .from(CurrentControllerStep()) .assemble() return AppDestination(finalStep: productScreen, context: productID) } }</span></span></code> </pre> <br><p> <strong>  </strong> </p><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductArrayViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UITableViewController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> products: [<span class="hljs-type"><span class="hljs-type">UUID</span></span>]? <span class="hljs-comment"><span class="hljs-comment">//... // DefaultRouter -  Router   ,   UIViewController   let router = DefaultRouter() override func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) { guard let productID = products[indexPath.row] else { return } router.navigate(to: Configuration.productDestination(with: productID)) } }</span></span></code> </pre> <br><p> <strong>  </strong> </p><br><pre> <code class="swift hljs"><span class="hljs-meta"><span class="hljs-meta">@UIApplicationMain</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppDelegate</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIResponder</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIApplicationDelegate</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//... func application(_ application: UIApplication, open url: URL, sourceApplication: String?, annotation: Any) -&gt; Bool { guard let productID = UniversalLinksManager.parse(url: url) else { return false } return DefaultRouter().navigate(to: Configuration.productDestination(with: productID)) == .handled } }</span></span></code> </pre><br><p>              . </p><br><p>             . ,          , ,           â€”       ProductArrayViewController,      UINavigationController   HomeViewController â€”         <code>StepAssembly</code>  <code>from()</code> .     <code>RouteComposer</code> ,      (     ).  ,      <code>Configuration</code>               .     ,      A/B ,         . </p><br><h3 id="vmesto-zaklyucheniya"> è€Œä¸æ˜¯ç»“è®º </h3><br><p>   ,      3       .     ,  ,       .   <code>Fabric</code> , <code>Finder</code>  <code>Action</code>            .   ,     â€”              ,    ,       .          ,      . </p><br><p> ,      ,      objective c       Cocoa Touch,             .     iOS  9  12. </p><br><p>            <code>UIViewController</code>  (MVC, MVVM, VIP, RIB, VIPER  ..) </p><br><p>      ,   ,     ,   .         .            . </p><br><p>      . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN421097/">https://habr.com/ru/post/zh-CN421097/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN421087/index.html">å¦‚ä½•åœ¨VDSçš„Go for Gitlabä¸Šè®¾ç½®Webåº”ç”¨ç¨‹åºéƒ¨ç½²</a></li>
<li><a href="../zh-CN421089/index.html">ä¿„ç½—æ–¯ä¾›åº”å•†å·²ç»å¼„æ¸…æ¥šäº†å¦‚ä½•å°†â€œæ˜¥å­£é…å¥—â€çš„éƒ¨åˆ†è´¹ç”¨è½¬ç§»ç»™Google</a></li>
<li><a href="../zh-CN421091/index.html">æˆ‘ä»¬å¦‚ä½•é€šè¿‡åˆ‡æ¢åˆ°Pythonæ¥å‡å°‘äº”æ¬¡å¼€å‘è¯„åˆ†æ¨¡å‹çš„æ—¶é—´</a></li>
<li><a href="../zh-CN421093/index.html">æˆ‘å¦‚ä½•å­¦ä¹ Springæ¡†æ¶-ç¬¬2éƒ¨åˆ†ï¼ˆå¯¹åˆå­¦è€…çš„å¸®åŠ©-åˆå­¦è€…è‡ªå·±çš„å·¥ä½œï¼‰</a></li>
<li><a href="../zh-CN421095/index.html">æ ¹æ®æ–°çš„å…³äºé˜»æ­¢é¢„å®¡çš„æ³•æ¡ˆï¼Œå¯èƒ½ä¼šå‡å°‘1900ä¸‡ä¸ªç½‘ç«™</a></li>
<li><a href="../zh-CN421099/index.html">å¾ˆéš¾é›†ä¸­ç²¾ç¥å—ï¼Ÿ ä¹Ÿè®¸è¿™ä¸æ˜¯ä½ çš„é”™</a></li>
<li><a href="../zh-CN421101/index.html">8æœˆçš„â€œæµ‹è¯•è€…æ—¥å†â€ã€‚ çœ‹ä¹¦</a></li>
<li><a href="../zh-CN421103/index.html">é¦–å…ˆçœ‹çœ‹Mavic 2ï¼šæ›´é•¿ï¼Œæ›´å®‰é™ï¼Œæ›´å¿«åœ°é£è¡Œ</a></li>
<li><a href="../zh-CN421105/index.html">æƒ…å†µï¼šSpotifyä¸éŸ³ä¹å®¶è¿›è¡Œç›´æ¥äº¤æ˜“-å”±ç‰‡å…¬å¸ä¸æ»¡æ„</a></li>
<li><a href="../zh-CN421107/index.html">æˆ‘ä»¬ä½¿ç”¨Python / Tkinteræ‹†å¸å’ŒæŸ¥çœ‹åˆæ ¼è¯ä¹¦</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>