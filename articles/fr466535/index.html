<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧀 🔙 👩🏾‍🌾 Repenser deepClone 🙌🏾 🔛 👩🏿‍🎤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Comme vous le savez en JavaScript, les objets sont copiés par référence. Mais parfois, vous devez effectuer un clonage en profondeur d'un objet. De no...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Repenser deepClone</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466535/"> Comme vous le savez en JavaScript, les objets sont copiés par référence.  Mais parfois, vous devez effectuer un clonage en profondeur d'un objet.  De nombreuses bibliothèques js proposent leur implémentation de la fonction deepClone pour ce cas.  Mais, malheureusement, la plupart des bibliothèques ne prennent pas en compte plusieurs éléments importants: <br><br><ul><li>  Les tableaux peuvent se trouver dans l'objet et il est préférable de les copier en tant que tableaux </li><li>  L'objet peut avoir des champs avec un symbole comme clé </li><li>  Les champs d'objet ont des descripteurs autres que ceux par défaut </li><li>  Les fonctions peuvent se trouver dans les champs de l'objet et doivent également être clonées. </li><li>  Un objet a enfin un prototype différent de Object.prototype </li></ul><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Qui l'a cassé, j'ai placé le code complet sous le spoiler</b> <div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deepClone</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">source</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'object'</span></span></span></span><span class="hljs-function"><span class="hljs-params">: cloneObject, </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'function'</span></span></span></span><span class="hljs-function"><span class="hljs-params">: cloneFunction }[</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">typeof</span></span></span></span><span class="hljs-function"><span class="hljs-params"> source] || clonePrimitive</span></span></span><span class="hljs-function">)(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">source</span></span></span><span class="hljs-function">)</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">; } </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">cloneObject</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">source</span></span></span><span class="hljs-function">) { </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">return</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">Array</span></span></span></span><span class="hljs-function"><span class="hljs-params">.isArray(source</span></span></span><span class="hljs-function">) ? </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> source.map(deepClone) : clonePrototype(source, cloneFields(source, simpleFunctor({}))) ); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cloneFunction</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">source</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cloneFields(source, simpleFunctor(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> source.apply(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>); })); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">clonePrimitive</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">source</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> source; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">simpleFunctor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">value</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">mapper</span></span></span><span class="hljs-function"> =&gt;</span></span> mapper ? simpleFunctor(mapper(value)) : value; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">makeCloneFieldReducer</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">source</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">destinationFunctor, field</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> descriptor = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptor(source, field); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> destinationFunctor(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">destination</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.defineProperty(destination, field, <span class="hljs-string"><span class="hljs-string">'value'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> descriptor ? { ...descriptor, <span class="hljs-attr"><span class="hljs-attr">value</span></span>: deepClone(descriptor.value) } : descriptor)); }; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cloneFields</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">source, destinationFunctor</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyNames(source) .concat(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertySymbols(source)) .reduce(makeCloneFieldReducer(source), destinationFunctor) ); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">clonePrototype</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">source, destinationFunctor</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> destinationFunctor(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">destination</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.setPrototypeOf(destination, <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getPrototypeOf(source))); }</code> </pre> </div></div><br>  Mon implémentation est écrite dans un style fonctionnel qui me procure fiabilité, stabilité et simplicité.  Mais comme, malheureusement, beaucoup ne peuvent toujours pas reconstruire leur pensée avec le procéduralisme et la pseudo-POO, je vais expliquer chaque brique de construction de mon implémentation: <br><br>  La fonction deepClone elle-même prendra 1 argument source - la source à partir de laquelle nous clonerons, et son clone profond avec toutes les fonctionnalités ci-dessus sera retourné: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deepClone</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">source</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ({ <span class="hljs-string"><span class="hljs-string">'object'</span></span>: cloneObject, <span class="hljs-string"><span class="hljs-string">'function'</span></span>: cloneFunction }[<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> source] || clonePrimitive)(source)(); }</code> </pre><br>  Tout est simple ici, selon le type de données dans la source, une fonction est sélectionnée qui peut la cloner, et la source elle-même lui est transférée. <br><br>  Vous pouvez également remarquer que le résultat renvoyé est appelé en tant que fonction sans paramètres avant d'être renvoyé à l'utilisateur.  Ceci est nécessaire, car j'encapsule la valeur dans laquelle je clone, dans le foncteur le plus simple, afin de pouvoir le muter sans violer la pureté des fonctions auxiliaires.  Voici l'implémentation de ce foncteur: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">simpleFunctor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">value</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">mapper</span></span></span><span class="hljs-function"> =&gt;</span></span> mapper ? simpleFunctor(mapper(value)) : value; }</code> </pre><br>  Il peut faire 2 choses - mapper (si la fonction mapper lui est transmise) et extraire (si rien n'est passé). <br><br>  Nous allons maintenant analyser les fonctions auxiliaires cloneObject, cloneFunction et clonePrimitive.  Chacun d'eux prend 1 argument de source d'un type spécifique et retourne son clone. <br><br>  La mise en œuvre de <b>cloneObject</b> doit tenir compte du fait que les tableaux sont également de type objet, eh bien, dans d'autres cas, ils doivent cloner les champs et le prototype.  Voici sa mise en œuvre: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cloneObject</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">source</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">Array</span></span></span></span><span class="hljs-function"><span class="hljs-params">.isArray(source</span></span></span><span class="hljs-function">) ? </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> source.map(deepClone) : clonePrototype(source, cloneFields(source, simpleFunctor({}))) ); }</code> </pre><br>  Le tableau peut être copié à l'aide de la méthode slice, mais comme nous avons un clonage profond et que le tableau peut contenir non seulement des valeurs primitives, la méthode map est utilisée avec le deepClone décrit ci-dessus comme argument. <br><br>  Pour les autres objets, nous créons un nouvel objet et l'enveloppons dans notre foncteur décrit ci-dessus, clonons les champs (ainsi que les descripteurs) à l'aide de la fonction d'assistance cloneFields, puis clonons le prototype à l'aide de clonePrototype. <br><br>  Fonctions d'assistance que je décrirai ci-dessous.  En attendant, envisagez la mise en œuvre de <b>cloneFunction</b> : <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cloneFunction</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">source</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cloneFields(source, simpleFunctor(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> source.apply(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>); })); }</code> </pre><br>  Vous ne pouvez tout simplement pas cloner une fonction avec toute la logique.  Mais vous pouvez l'encapsuler dans une autre fonction qui appelle l'original avec tous les arguments et le contexte et renvoie son résultat.  Un tel «clone» gardera certainement la fonction d'origine en mémoire, mais il «pèsera» un peu et reproduira pleinement la logique d'origine.  Nous enveloppons la fonction clonée dans un foncteur et en utilisant cloneFields nous copions tous les champs de la fonction d'origine dedans, car la fonction dans JS est aussi un objet, juste appelé, et peut donc y stocker des champs. <br><br>  Potentiellement, une fonction peut avoir un prototype différent de Function.prototype, mais je n'ai pas considéré ce cas extrême.  L'un des charmes de FP est que nous pouvons facilement ajouter un nouveau wrapper sur une fonction existante afin d'implémenter les fonctionnalités nécessaires. <br><br>  La dernière brique de construction clonePrimitive sert à cloner des valeurs primitives.  Mais comme les valeurs primitives sont copiées par valeur (ou par référence, mais sont immuables dans certaines implémentations des moteurs JS), nous pouvons simplement les copier.  Mais puisque nous ne sommes pas censés obtenir une valeur pure, mais une valeur enveloppée dans un foncteur que l'extraction peut appeler sans arguments, nous encapsulerons notre valeur dans une fonction: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">clonePrimitive</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">source</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> source; }</code> </pre><br>  Maintenant, nous implémentons les fonctions auxiliaires qui ont été utilisées ci-dessus - clonePrototype et cloneFields <br><br>  Pour cloner un prototype, <b>clonePrototype</b> extrait simplement le prototype de l'objet source et, en effectuant une opération de mappage sur le foncteur résultant, le définit sur l'objet cible: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">clonePrototype</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">source, destinationFunctor</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> destinationFunctor(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">destination</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.setPrototypeOf(destination, <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getPrototypeOf(source))); }</code> </pre><br>  Le clonage de champs est un peu plus compliqué, j'ai donc divisé la fonction <b>cloneFields</b> en deux.  La fonction externe prend la concaténation de tous les champs nommés et de tous les champs de symboles, en recevant absolument tous les champs, et les exécute via le réducteur créé par la fonction auxiliaire: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cloneFields</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">source, destinationFunctor</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyNames(source) .concat(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertySymbols(source)) .reduce(makeCloneFieldReducer(source), destinationFunctor) ); }</code> </pre><br>  makeCloneFieldReducer devrait créer pour nous une fonction de réduction qui pourrait être passée à la méthode de réduction sur un tableau de tous les champs de l'objet source.  En tant que batterie, notre foncteur qui stocke la cible sera utilisé.  Le réducteur doit extraire la poignée du champ de l'objet source et l'affecter au champ de l'objet cible.  Mais ici, il est important de considérer qu'il existe deux types de descripteurs - avec valeur et avec get / set.  Évidemment, la valeur doit être clonée, mais avec get / set il n'y a pas un tel besoin, un tel descripteur peut être retourné tel quel: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">makeCloneFieldReducer</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">source</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">destinationFunctor, field</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> descriptor = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptor(source, field); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> destinationFunctor(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">destination</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.defineProperty(destination, field, <span class="hljs-string"><span class="hljs-string">'value'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> descriptor ? { ...descriptor, <span class="hljs-attr"><span class="hljs-attr">value</span></span>: deepClone(descriptor.value) } : descriptor)); }; }</code> </pre><br>  C’est tout.  Une telle implémentation de deepClone résout tous les problèmes posés au début de l'article.  De plus, il est construit sur des fonctions pures et un foncteur, ce qui donne toutes les garanties inhérentes au calcul lambda. <br><br>  Je note également que je n'ai pas mis en œuvre un excellent comportement pour les collections autres qu'un tableau qui mériterait d'être cloné individuellement, comme Map ou Set.  Bien que dans certains cas, cela puisse être nécessaire. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr466535/">https://habr.com/ru/post/fr466535/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr466519/index.html">Analyse détaillée d'AWS Lambda</a></li>
<li><a href="../fr466521/index.html">C for Metal - métal précieux pour l'informatique sur les cartes graphiques Intel</a></li>
<li><a href="../fr466525/index.html">Qu'est-ce qu'une disposition iPhone PSD et comment l'utiliser?</a></li>
<li><a href="../fr466527/index.html">Test de la fonctionnalité utilisateur du site Web avec les objets de page Capybara</a></li>
<li><a href="../fr466529/index.html">Types de compilation dans la JVM: exposer la session Black Magic</a></li>
<li><a href="../fr466537/index.html">Utilisation de modules JavaScript en production: situation actuelle. Partie 1</a></li>
<li><a href="../fr466539/index.html">Utilisation de modules JavaScript en production: situation actuelle. 2e partie</a></li>
<li><a href="../fr466541/index.html">Utilisation de DbTool pour amorcer des bases de données dans des applications .NET (Core)</a></li>
<li><a href="../fr466543/index.html">Les prêts Habr Weekly # 17 / Sberbank seront approuvés par AI - effrayant, publicité dans les produits open source - douteux</a></li>
<li><a href="../fr466547/index.html">Bonne fête du programmeur</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>