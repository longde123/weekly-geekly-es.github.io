<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💬 🥃 🆗 Curso MIT "Segurança de sistemas de computadores". Palestra 6: “Oportunidades”, parte 3 👏🏿 👩🏽‍🤝‍👨🏿 📚</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Instituto de Tecnologia de Massachusetts. Curso de Aula nº 6.858. "Segurança de sistemas de computador". Nikolai Zeldovich, James Mickens. 2014 ano 
 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Curso MIT "Segurança de sistemas de computadores". Palestra 6: “Oportunidades”, parte 3</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/418221/"><h3>  Instituto de Tecnologia de Massachusetts.  Curso de Aula nº 6.858.  "Segurança de sistemas de computador".  Nikolai Zeldovich, James Mickens.  2014 ano </h3><br>  Computer Systems Security é um curso sobre o desenvolvimento e implementação de sistemas de computador seguros.  As palestras abrangem modelos de ameaças, ataques que comprometem a segurança e técnicas de segurança baseadas em trabalhos científicos recentes.  Os tópicos incluem segurança do sistema operacional (SO), recursos, gerenciamento de fluxo de informações, segurança de idiomas, protocolos de rede, segurança de hardware e segurança de aplicativos da web. <br><br>  Palestra 1: “Introdução: modelos de ameaças” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Palestra 2: “Controle de ataques de hackers” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Aula 3: “Estouros de Buffer: Explorações e Proteção” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Palestra 4: “Separação de Privilégios” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Palestra 5: “De onde vêm os sistemas de segurança?” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> <br>  Palestra 6: “Oportunidades” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <a name="habracut"></a><br><br>  <b>Público-alvo:</b> se esse <b>UID</b> fornecer acesso somente leitura a esse arquivo e você também tiver um descritor de arquivo, se perder o <b>UID</b> , ainda poderá obter permissão para ler esse arquivo? <br><br>  <b>Professor:</b> sim, pois ele aparecerá em catálogos.  Porque assim que você adiciona o recurso ao arquivo, é isso.  Está aberto para você com privilégios especiais e assim por diante.  Mas o problema é que eles têm esse design híbrido. <br><br>  Ou seja, eles dizem - você realmente pode adicionar recursos aos diretórios e pode abrir um novo arquivo enquanto trabalha em paralelo.  Pode ser que você adicione o recurso a um diretório, como <b>/ etc</b> , mas você não tem acesso obrigatório a todos os arquivos no diretório <b>/ etc.</b>  Mas assim que você entra no modo de recursos, pode tentar abrir esses arquivos, sabendo que tem acesso ao diretório <b>/ etc.</b>  Afinal, ele já está aberto. Por que você não me fornece um arquivo chamado <b>"senha"</b> localizado neste diretório? <br><br><img src="https://habrastorage.org/webt/8y/ew/2d/8yew2dwzcw7lpgl31ttm1ayzj6g.jpeg"><br><br>  E então o kernel precisa decidir se você deseja abrir o arquivo neste diretório no modo de leitura ou gravação ou o que você possui.  Então, acho que este é o único lugar em que você ainda precisa desse privilégio externo, porque eles tentaram criar um design compatível, onde usavam semânticas não muito naturais para descrever a operação de diretórios.  Este parece ser o único local onde permanecem os princípios para a configuração de um <b>sistema de</b> arquivos <b>Unix</b> . <br><br>  <b>Público:</b> existem outros lugares? <br><br>  <b>Professor:</b> boa pergunta.  Acho que terei que obter o código-fonte anterior para descobrir o que está acontecendo, mas a maioria das outras situações realmente não exige verificação de <b>UID</b> .  Porque, por exemplo, não é usado para redes.  Essas são provavelmente as operações usuais do sistema de arquivos - se você possui um segmento de memória compartilhada, basta abri-lo e pronto. <br><br>  <b>Público:</b> poderia explicar novamente qual é exatamente o ID do usuário, se você tiver o recurso de <b>capacidade</b> ? <br><br>  <b>Professor:</b> isso é importante quando você tem a oportunidade de catalogar.  A questão é: o que essa oportunidade apresenta a você?  Considere uma interpretação, por exemplo, o estado dos recursos de um sistema limpo, não o <b>Capsicum</b> .  Se nesse sistema você tiver a oportunidade de um diretório, terá acesso incondicional a todos os arquivos desse diretório. <br><br>  No <b>Unix,</b> esse geralmente não é o caso.  Você pode abrir o diretório como <b>/ etc</b> , mas ele possui muitos arquivos de sistema nos quais as informações confidenciais podem ser armazenadas, por exemplo, a chave privada do servidor.  E o fato de poder abrir e rolar por esse diretório não significa que você não pode abrir arquivos nesse diretório.  Ou seja, tendo acesso ao diretório, você tem acesso aos arquivos. <br><br>  No <b>Capsicum</b> , se você abrir o diretório <b>/ etc</b> e entrar no modo de recurso, acontece o seguinte.  Você diz: “Não sei o que é esse diretório.  Acabei de adicionar um descritor de arquivo. "  Há um arquivo chamado "chave".  Por que você não abre este arquivo <b>"chave"</b> ?  Só porque naquele momento, você provavelmente não deseja que esse processo baseado em recursos abra esse arquivo, porque você não precisa dele.  Embora isso permita que você ignore <b>as</b> permissões do <b>Unix</b> para o arquivo. <br><br>  Portanto, acho que os autores deste artigo abordaram cuidadosamente o desenvolvimento de um sistema que não violaria os mecanismos de segurança existentes. <br><br>  <b>Público:</b> ou seja, você diz que, em alguns casos, pode usar uma combinação desses dois fatores de segurança?  Ou seja, embora o usuário possa alterar o arquivo no diretório, quais arquivos ele acessa depende de seu ID de usuário? <br><br>  <b>Professor:</b> sim, exatamente.  Na prática, no <b>Capsicum</b> , antes de entrar no modo de recursos, você precisa adivinhar quais arquivos podem ser necessários posteriormente.  Você pode precisar de bibliotecas compartilhadas, arquivos de texto, modelos, conexões de rede e assim por diante.  Portanto, você abre tudo isso com antecedência.  E nem sempre é necessário saber qual arquivo você precisa.  Então esses caras fizeram isso para que você possa simplesmente abrir o descritor de arquivo do diretório e visualizar os arquivos necessários mais tarde.  No entanto, pode ser que esses arquivos não tenham as mesmas permissões que você possui.  É precisamente por esse motivo que uma combinação de dois fatores de segurança é usada - verificando os recursos e o <b>uid do</b> usuário.  Portanto, isso faz parte do mecanismo do kernel. <br><br><img src="https://habrastorage.org/webt/xk/zu/ea/xkzueav2oq8qjqezg3f7hrzvemc.jpeg"><br><br>  Por que eles precisam de uma biblioteca como <b>libcapsicum</b> ?  Eu acho que há duas coisas principais que eles apóiam nesta biblioteca. <br><br>  Uma delas é que eles implementam uma função chamada <b>lch_start</b> , que você deve usar em vez da função <b>cap_enter</b> .  Outra função que <b>libcapsicum</b> fornece é o conceito de listas fd, que é usado para passar descritores de arquivo por números.  O objetivo desta <b>lista fd é</b> fácil de explicar.  Isso é basicamente uma generalização de como o <b>Unix</b> gerencia e passa descritores de arquivos entre processos.  No <b>Unix</b> e <b>Linux</b> tradicional, que você usa hoje, alguns descritores de arquivo são passados ​​para ele quando o processo é iniciado.  Você simplesmente abre alguns descritores de arquivo com valores inteiros nesta tabela e inicia o processo filho de que precisa.  Ou você executa um binário específico e ele herda todos esses slots abertos na tabela <b>fd</b> .  No entanto, não há outra maneira boa de nomear essas coisas além de usar números como nomes. <br><br>  Considere um exemplo no qual o slot 0 será usado para entrada, slot 1 para saída e slot 2 para impressão de mensagens de erro.  É assim que funciona no <b>Unix</b> .  E funciona bem se você apenas transferir esses três arquivos ou três fluxos de dados para o processo. <br><br><img src="https://habrastorage.org/webt/bn/kq/yt/bnkqytvftq_0clyfqaqlqmwlfbs.jpeg"><br><br>  Mas no <b>Capsicum,</b> acontece que você “passa por” muito mais descritores de arquivos no seu caminho.  Portanto, quando você passa um descritor de arquivo para alguns arquivos, passa por um descritor de arquivo para uma conexão de rede, um descritor para uma biblioteca compartilhada que você possui e assim por diante.  Gerenciar todos esses números é bastante tedioso.  Portanto, de fato, <b>libcapsicum</b> fornece a capacidade de abstrair o nome desses descritores de arquivo anteriores entre processos usando um nome hierárquico usado em vez desses números inteiros obscuros. <br>  Essa é uma das coisas simples que eles fornecem em sua biblioteca.  Para que eu possa passar o descritor de arquivo para o processo e dar um nome, não importa qual número seja indicado.  Este método é muito mais simples. <br><br>  Eles ainda têm outro mecanismo de inicialização de sandbox mais complexo.  Isso é <b>lch</b> , a <b>API do</b> host da sandbox usada em vez de apenas entrar no modo de recursos de <b>capacidade</b> .  Por que eles precisavam de algo mais do que uma simples entrada no modo de oportunidade?  O que geralmente incomoda você ao criar uma sandbox? <br><br>  <b>Público:</b> provavelmente, <b>lch</b> apaga todas as coisas herdadas para garantir um início "limpo" do sistema. <br><br>  <b>Professor:</b> sim.  Eu acho que eles estão preocupados em tentar levar em conta tudo o que a sandbox tem acesso.  O problema é que, se você simplesmente chamar <b>cap_enter</b> , tecnicamente, no nível do mecanismo do kernel, ele funcionará.  Certo?  Isso apenas impede que você descubra novas oportunidades. <br><br>  Mas o problema é que pode haver muitas coisas existentes às quais o processo já tem acesso. <br><br>  Portanto, acho que o exemplo mais simples é a presença de descritores de arquivos abertos lá que você esqueceu, e eles simplesmente serão herdados por esse processo. <br><br><img src="https://habrastorage.org/webt/td/yv/dd/tdyvddlujfmx8gudizztmw9n5gm.jpeg"><br><br>  Por exemplo, eles consideraram <b>tcpdump</b> .  Primeiro, eles mudaram o <b>tcpdump</b> simplesmente chamando <b>cap_enter</b> antes mesmo de analisar todas as conexões de rede recebidas.  De certa forma, isso funciona bem porque você não pode obter mais recursos de <b>capacidade</b> .  Mas então, olhando para o descritor de arquivo aberto, eles perceberam que você tem acesso total ao terminal do usuário, porque você possui um descritor de arquivo aberto.  Para que você possa interceptar todas as teclas digitadas pelo usuário e assim por diante.  Portanto, este provavelmente não é um bom plano para o <b>tcpdump</b> .  Porque você não deseja que alguém intercepte sua atividade no teclado. <br><br>  Portanto, no caso do <b>tcpdump,</b> eles alteraram manualmente os descritores de arquivo e adicionaram alguns bits de recursos a eles para limitar os tipos de operações que você pode executar.  Se você se lembra, no <b>Capsicum, o</b> recurso também possui esses bits extras, indicando a classe de operações que podem ser executadas para um determinado descritor de arquivo.  Assim, eles assumem basicamente que o descritor de arquivo é 0. Aponta para o <b>terminal do</b> usuário tty.  Inicialmente, era apenas um ponteiro direto para a estrutura <b>tty</b> no kernel.  Para limitar o tipo de operações que podem ser executadas para esse descritor, eles introduziram alguma estrutura beta intermediária de recursos no meio.  Portanto, o descritor de arquivo aponta para essa estrutura de recursos e já aponta para o arquivo real que você está tentando acessar.  E essa estrutura de recursos contém alguns bits ou permissões restritivos para um objeto descritor de arquivo que pode ser implementado. <br><br>  Assim, com a entrada de dados padrão no <b>tcpdump,</b> você não pode fazer nada com ele.  Você pode apenas ver que existe, e é isso.  Para o descritor do arquivo de saída, eles forneceram uma oportunidade quando você pode gravar algo nele, mas não pode alterar o registro, ou seja, não é possível cancelar as alterações feitas. <br><br><img src="https://habrastorage.org/webt/cg/-4/p5/cg-4p5ivw8r8yde-rotszxgxn2a.jpeg"><br><br>  Então, o que mais você poderia se preocupar em lançar <b>a sandbox</b> ?  Penso no estado do descritor de arquivo.  Mais alguma coisa importa?  Eu acho que no <b>Unix</b> são descritores de arquivos e memória. <br><br>  Outra coisa é que esses caras estão preocupados com o fato de que no seu espaço de endereço possa haver dados confidenciais alocados anteriormente.  E o processo que você vai isolar na caixa de areia pode ler toda a memória disponível.  Portanto, se houver algum tipo de senha que você verificou anteriormente, quando o usuário efetuar login e você ainda não tiver limpado a memória, esse processo poderá lê-la e fazer algo "interessante". <br><br>  Eles resolveram esse problema da seguinte maneira: no <b>lch_start,</b> você precisa executar um programa "novo".  Você pega o programa e empacota todos os argumentos nele, todos os descritores de arquivos que deseja fornecer.  Em seguida, você inicia um novo processo ou inicia a operação de reinicialização de todo o espaço de memória virtual.  E não há dúvida de que esse processo não receberá privilégios adicionais para afetar o conjunto de dados confidenciais.  Isso é exatamente o que você passou para a função <b>lch_start</b> , em termos de nomes binários, argumentos e recursos do programa. <br><br>  <b>Público: o</b> que acontece se o processo iniciado contiver <b>setuid</b> binário <b>= 0</b> ? <br><br>  <b>Professor:</b> Eu acho que esses caras não usam "binários" <b>setuid</b> no modo de recurso para evitar algumas interações estranhas que possam aparecer.  Eles implementam esta regra: você pode ter um programa <b>setuid</b> que obtém seus privilégios do binário <b>setuid</b> e, em seguida, pode chamar <b>cap_enter</b> ou <b>lch_start</b> .  Mas depois que você entra no modo de recursos, não pode restaurar preferências adicionais. <br><br>  Em princípio, isso poderia funcionar, mas seria muito estranho.  Porque, se você se lembrar, a única coisa em que o <b>UID</b> importa quando você está no modo de recurso é abrir arquivos dentro de um diretório.  Portanto, não está claro se esse é realmente um excelente plano para obter privilégios adicionais ou se há falhas nele. <br><br>  <b>Público:</b> Anteriormente, falamos sobre por que a biblioteca não suporta realmente uma separação estrita entre os dois fatores de segurança.  Mas não precisamos usar <b>lch_start</b> ? <br><br>  <b>Professor:</b> isso mesmo.  Suponha que você tenha algo como <b>tcpdump</b> ou <b>gzip</b> - essa é outra coisa com a qual eles trabalham.  Você supõe que o aplicativo provavelmente não esteja comprometido, e há alguma função básica do aplicativo e se preocupa com o modo como ele se comporta na caixa de proteção.  No caso do <b>tcpdump,</b> é uma análise de pacotes provenientes da rede; no caso do <b>gzip</b> , está descompactando arquivos.  E até certo ponto, você assume que o processo está fazendo tudo certo e que não haverá vulnerabilidades.  Portanto, você confia nele para executar <b>lch_start</b> e acredita que ele criará a imagem corretamente, configurará corretamente todos os recursos e se limitará a qualquer outra chamada de sistema fora do modo de recursos. <br><br>  E então você lança coisas perigosas.  Mas até então a instalação estava correta e você não tem como sair dessa sandbox.  Então, acho que você precisa ver como realmente pode usar o modo de recurso para aplicativos sandbox. <br><br>  Então conversamos um pouco sobre o <b>tcpdump</b> .  Como você isola esse processo?  Outro exemplo interessante é o programa <b>gzip</b> , que compacta e descompacta arquivos.  Então, por que eles estão preocupados com a caixa de areia?  Acho que eles estão preocupados com o fato de o código de descompactação poder ser potencialmente defeituoso ou com erros no gerenciamento de memória, gerenciamento de buffer durante a descompactação etc. <br><br><img src="https://habrastorage.org/webt/rg/0p/fj/rg0pfjhm0nsvzqfxtmemlhvwoq8.jpeg"><br><br>  Outra questão interessante é por que as alterações no <b>gzip</b> parecem muito mais complicadas do que no <b>tcpdump</b> ?  Eu acho que isso se deve à forma como o aplicativo é estruturado internamente, certo?  Portanto, se você tiver um aplicativo que simplesmente compactou ou descompactou um arquivo, é normal iniciá-lo sem alterá-lo no modo de recursos.  Você simplesmente atribui um novo padrão para descompactar algo, e o padrão fornece dados descompactados na saída, e isso funcionará bem. <br><br>  O problema, como quase sempre acontece com esses métodos de sandbox, é que o aplicativo realmente tem uma lógica de processo muito mais complexa.  Por exemplo, o <b>gzip</b> pode compactar vários arquivos de uma vez e assim por diante.  E, nesse caso, você tem algum tipo de processo de liderança no início do aplicativo, que na verdade possui direitos adicionais para abrir vários arquivos, compactá-los e assim por diante.  E a lógica principal geralmente precisa ser outro processo de suporte.  No caso do <b>gzip, o</b> aplicativo não foi estruturado para que a compactação e descompactação atuassem como processos separados.  Portanto, eles tiveram que mudar a implementação do kernel <b>gzip</b> e alguma estrutura do próprio aplicativo, para que, além de apenas passar dados para a função de descompressão, eles fossem enviados por uma chamada <b>RPC</b> ou realmente gravados em algum tipo de descritor de arquivo.  Isso foi para evitar problemas de terceiros e descompactar praticamente sem privilégios.  A única coisa que o <b>gzip</b> poderia fazer ao mesmo tempo era retornar os dados descompactados ou compactados para o processo que o chamou. <br><br>  Outra coisa de lição de casa é como você realmente usa <b>Capsicum</b> no <b>OKWS</b> ?  O que você acha disso?  Seria útil?  O pessoal do <b>OKWS ficaria</b> feliz em atualizar para o <b>FreeBSD</b> porque é muito mais fácil de usar?  Como você usaria <b>Capsicum</b> no <b>FreeBSD</b> ? <br><br>  <b>Público:</b> Pode-se livrar-se de algumas restrições estritas. <br><br>  <b>Professor:</b> sim, podemos substituí-los completamente pela presença de um diretório de descritores e recursos de arquivos.  Você não precisaria configurar um <b>chroot</b> confuso.  Em vez de usar o <b>chroot</b> com muitas pequenas coisas, você pode definir permissões com cuidado.  Você pode simplesmente abrir os arquivos exatos que precisa.  Então isso parece uma grande vantagem. <br><br>  Em seguida, no <b>OKWS</b> , você tem o serviço de inicialização <b>OK</b> , que deve iniciar todos os processos pai.  Assim que eles morrem, o sinal volta ao <b>okld</b> para reiniciar o processo "morto".  E isso teria que ser executado como <b>root</b> , porque ele tinha que isolar os processos na caixa de areia.  Mas há várias coisas no <b>OKWS</b> que podem ser melhoradas com <b>Capsicum</b> . <br><br>  Por exemplo, você pode fornecer ao <b>okld</b> muito menos privilégios.  Porque, por exemplo, para obter a porta 80, você precisa de privilégios de root.  Mas depois disso, você pode colocar com segurança todo o resto na sandbox, porque os direitos de root não são mais necessários.  Então é bem legal.  Talvez você possa até delegar ao processo o direito de responder às solicitações de outra pessoa, por exemplo, um processo de monitoramento do sistema que apenas possui esse descritor de processo ou descritor de processo para o processo filho e, sempre que esse processo falha, ele inicia um novo.  Portanto, acho que a capacidade de criar uma caixa de proteção sem privilégios de root é muito útil. <br><br>  <b>Público-alvo:</b> você pode atribuir a cada processo um descritor de arquivo que permita adicionar apenas entradas ao log. <br><br>  <b>Professor:</b> sim, e isso é muito legal.  Como dissemos na última vez, o <b>oklogd</b> pode "bagunçar" o arquivo de log.  E quem sabe o que o kernel permitirá que ele faça quando tiver o descritor de arquivo do próprio arquivo de log.  No entanto, podemos determinar com mais precisão os recursos do descritor de arquivo, fornecendo um arquivo de log e indicando que ele pode apenas gravar, mas não procurar nada.  Assim, obtemos a função somente acréscimo se você é apenas um "escritor" para este arquivo.  É muito conveniente  Você pode conceder ao processo permissões para gravar no arquivo, mas não lê-lo, o que é muito difícil de fazer usando apenas <b>as</b> permissões do <b>Unix</b> . <br><br>         <b>Capsicum</b> ? <br><br> <b>:</b>  , ,   ,        .     ,       ,  ,       . <br><br> : ,  .   <b>Capsicum</b> ,   ,      .           . <br><br> <b>:</b> ,     ,  okld      .      ,    . <br><br> <b>:</b>  ,      .   .     ,    ,   <b>Capability</b>      ,       .   ,     ,   ,   , ,        . <br>   ,         <b>OKWS</b> .               . , ,        ,    .    . <br><br> ,      ,   «».     ,       .  ,  ,         ,    ,       .        . <br> :    «»   ,      ,   ? <br><br> : ,   <b>FreeBSD</b>   .   ,     -   ,     .  <b>FreeBSD</b>     <b>Casper</b> ,    ,   <b>Capability</b> .            ,   «». <br><br>      - ,    ,  ,  - ,        ,  <b>Casper</b>    . <br><br><img src="https://habrastorage.org/webt/pj/hd/aw/pjhdaw8gumxqioaoawbwert89ks.jpeg"><br><br>      ,    «»     .   . ,     ,     ,   <b>Casper</b>     - . <br><br>   ,         ,       -  .    ,   <b>Unix</b>         <b>FD</b> .      ,      .  ,        ,    . <br><br>  ,       <b>FreeBSD</b> ,      <b>DNS</b> .       <b>DNS</b> -,   «».    ,    <b>tcpdump</b> .    tcpdump   ,        IP-.   ,   ,     <b>DNS</b> -. <br><br>  , ,     DNS-      DNS-,    .    <b>Casper</b> ,      DNS-. <br><br>  ,     ,   ,     Capsicum?    ?       ?       ,   ,    .         <b>Capsicum</b> ,    ? <br><br>     tcpdump  <b>GZIP</b> ,  ,   .            ? <br><br><img src="https://habrastorage.org/webt/yn/u5/ov/ynu5ovmtuqxeqgmma5p7hnhhwrg.jpeg"><br><br> <b>:</b> ,    ,   ,  . ,      <b>Capability</b> . <br><br> <b>:</b> ,  .      <b>Capsicum</b>  ,    ,    .  ,    ,        .  ,   ,   ,    ,    <b>Capsicum</b> ,   . <br><br>     ,          «». ,  <b>TCP — helper</b> , ,  , ,    .    ,  ,  ,    . <br><br> <b>:</b>  ,             . <br><br> <b>:</b> , .        . ,          .    <b>lth_start</b> ,      .  ,   ,      ,     - . <br><br>  ,   ,  Capsicum        .    ,       ,   ,             .    Unix    -    ,      . <br><br>          ,     . ,               .  ,          ,    .   ,    . <br><br> ,   Chrome      .  ,     ,       ,        Unix,  -,     <b>Unix</b> . <br><br> ,      ? <br><br> <b>:</b>            . <br><br> <b>:</b> .       .    ,    .      ,       , ,                 ,     . <br><br>     <b>Unix</b>     ,      .  ,        .    ,              .        .      ,     . <br><br>     .  <b>Linux</b>  ,  <b>setcall</b> ,     ,    .  ,    <b>Capsicum</b> ,        ,  <b>Capsicum</b>     ,     .   <b>Linux</b>  <b>setcall</b>     ,   .    ,   ,      <b>Linux</b> . <br><br> ,    —    , ,      ,     ,        .   ,      -  ,     «//»,       .        <b>Capsicum</b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> onde você pode iniciar o processo para um arquivo específico e não para o diretório pessoal inteiro. </font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/MlWK2YbZRZ8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A versão completa do curso está disponível </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br>  Obrigado por ficar conosco.  Você gosta dos nossos artigos?  Deseja ver materiais mais interessantes?  Ajude-nos fazendo um pedido ou recomendando a seus amigos, um <b>desconto de 30% para os usuários da Habr em um análogo exclusivo de servidores básicos que inventamos para você:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Toda a verdade sobre o VPS (KVM) E5-2650 v4 (6 núcleos) 10GB DDR4 240GB SSD 1Gbps de US $ 20 ou como dividir o servidor?</a>  (as opções estão disponíveis com RAID1 e RAID10, até 24 núcleos e até 40GB DDR4). <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3 meses de graça</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ao pagar por um novo Dell R630 por um período de seis meses - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x HDD Intel Deca-Core Xeon E5-2630 v4 / 128GB DDR4 / 4x1TB ou SSD 2x240GB / 1Gbps 10 TB - de US $ 99,33 por mês</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , apenas até o final de agosto, faça o pedido pode estar </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br>  <b>Dell R730xd 2 vezes mais barato?</b>  Somente nós temos <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2 TVs Intel Dodeca-Core Xeon E5-2650v4 128GB DDR4 6x480GB SSD 1Gbps 100 a partir de US $ 249</a> na Holanda e nos EUA!</b>  Leia sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Como criar um prédio de infraestrutura.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">classe usando servidores Dell R730xd E5-2650 v4 custando 9.000 euros por um centavo?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt418221/">https://habr.com/ru/post/pt418221/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt418211/index.html">Curso MIT "Segurança de sistemas de computadores". Palestra 4: “Compartilhando Privilégios”, Parte 3</a></li>
<li><a href="../pt418213/index.html">Curso MIT "Segurança de sistemas de computadores". Palestra 5: “De onde vêm os sistemas de segurança”, parte 1</a></li>
<li><a href="../pt418215/index.html">Curso MIT "Segurança de sistemas de computadores". Aula 5: “De onde vêm os erros do sistema de segurança”, Parte 2</a></li>
<li><a href="../pt418217/index.html">Curso MIT "Segurança de sistemas de computadores". Palestra 6: “Oportunidades”, parte 1</a></li>
<li><a href="../pt418219/index.html">Curso MIT "Segurança de sistemas de computadores". Palestra 6: Oportunidades, Parte 2</a></li>
<li><a href="../pt418223/index.html">Curso MIT "Segurança de sistemas de computadores". Palestra 7: A Sandbox do Cliente Nativo, Parte 1</a></li>
<li><a href="../pt418225/index.html">Curso MIT "Segurança de sistemas de computadores". Palestra 7: Sandbox do Cliente Nativo Parte 2</a></li>
<li><a href="../pt418227/index.html">Curso MIT "Segurança de sistemas de computadores". Palestra 7: A Sandbox do Cliente Nativo, Parte 3</a></li>
<li><a href="../pt418229/index.html">Curso MIT "Segurança de sistemas de computadores". Aula 8: Modelo de Segurança de Rede, Parte 1</a></li>
<li><a href="../pt418233/index.html">Mnemônicos da BMW para encontrar valores-limite</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>