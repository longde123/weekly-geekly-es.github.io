<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õπüèø üçë üíÉüèø Organizar el almacenamiento de c√≥digo en GitLab e integrar la revisi√≥n de c√≥digo en GitFlow üï∫üèø üë©üèø‚Äçüè≠ üôèüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No hace mucho tiempo, en uno de los proyectos de nuestra compa√±√≠a, se decidi√≥ finalmente abandonar el uso de Subversion para almacenar y versionar c√≥d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Organizar el almacenamiento de c√≥digo en GitLab e integrar la revisi√≥n de c√≥digo en GitFlow</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/neoflex/blog/425315/"><p>  No hace mucho tiempo, en uno de los proyectos de nuestra compa√±√≠a, se decidi√≥ finalmente abandonar el uso de Subversion para almacenar y versionar c√≥digo a favor de Git. <br></p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pm/lu/an/pmluanwspkx7wwuwnebnzv6b0um.png"></div><br><p>  Los principales objetivos de la transici√≥n fueron los siguientes: </p><br><ul><li>  Mejora de la transparencia del proceso de desarrollo. </li><li>  Implementaci√≥n del procedimiento de revisi√≥n de c√≥digo obligatorio antes de actualizar las actualizaciones de los entornos de prueba. </li><li>  Implemente la integraci√≥n continua para generar actualizaciones despu√©s de la revisi√≥n del c√≥digo e inst√°lelas en entornos de prueba. </li></ul><br><a name="habracut"></a><p>  Un requisito previo para lograr estos objetivos era el uso de GitLab (este servidor Git ya fue utilizado por el cliente y ya hab√≠a un c√≥digo que pertenec√≠a al frente de la soluci√≥n) y Jira (tambi√©n ya utilizado por el cliente). <br></p><br><p>  Se propuso utilizar Git Flow como modelo de desarrollo objetivo, agregando un c√≥digo de revisi√≥n.  Este modelo de desarrollo de facto se ha convertido en el est√°ndar en el desarrollo de software de c√≥digo abierto y es utilizado por la mayor√≠a de los gigantes de la industria.  Es por eso que su soporte est√° integrado en muchas herramientas populares para trabajar con Git.  Se ha escrito una gran cantidad de materiales sobre el tema de su uso; citar√© el m√°s exitoso de ellos para la familiarizaci√≥n inicial: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">uno</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">dos</a> . <br></p><br><p>  Por s√≠ mismo, este modelo ofrece solo principios generales de mantenimiento de c√≥digo, dejando de lado los procesos que acompa√±an su redacci√≥n.  Por lo tanto, la implementaci√≥n de todo lo dem√°s, incluido el c√≥digo de revisi√≥n, depende del servidor Git espec√≠fico.  En este sentido, GitHub es m√°s conveniente: se cre√≥ originalmente como una plataforma para la colaboraci√≥n de un gran n√∫mero de desarrolladores independientes y le permite limitar los derechos para enviar confirmaciones (Push) en el repositorio con la capacidad de crear solicitudes para enviar c√≥digo.  Adem√°s, GitLab ofrece su propio flujo de trabajo para mantener el c√≥digo llamado GitLab Flow, dise√±ado para usar GitLab CI.  Por lo tanto, en GitLab, la funcionalidad para crear solicitudes de env√≠o de c√≥digo no est√° implementada y se propone utilizar solicitudes de fusi√≥n de rama para revisar el c√≥digo de cambio.  Para construir e instalar artefactos en el proyecto, Jenkins ya se us√≥, lo que le permite crear y configurar de manera flexible las tareas de ensamblaje e implementaci√≥n, y se decidi√≥ no cambiar a GitLab CI, rechazando simult√°neamente la idea de usar GitLab Flow. <br></p><br><p>  Tambi√©n noto que el proyecto se ha configurado integraciones en Jira y Git.  En Jira, en el complemento Git, se agreg√≥ un repositorio creado para almacenar el c√≥digo fuente para el seguimiento, y en GitLab, este repositorio se configur√≥ para integrarse con Jira en la secci√≥n "Integraciones" del repositorio. <br></p><br><p>  Para resolver este problema, se desarroll√≥ un flujo de trabajo para trabajar con c√≥digo que es similar en estructura a Git Flow, pero que permite realizar revisiones de c√≥digo cada vez que se realizan cambios en las ramas principales del proceso (desarrollo, lanzamiento-n y maestro) usando GitLab.  A continuaci√≥n, se describir√° el proceso resultante, as√≠ como las etapas de integraci√≥n continua y entrega de software a las cadenas adyacentes.  Entre par√©ntesis est√°n los comandos correspondientes para ejecutar. <br></p><br><p>  El repositorio creado para almacenar el c√≥digo fuente se carga en el repositorio local (git clone) y se inicializa Git Flow (git flow init), adem√°s de la rama maestra (para crear etiquetas para almacenar versiones estables), se crea la rama de desarrollo (la rama de desarrollo principal, en que integra ramificaciones de funciones, lanzamientos y arreglos), se establecen m√°scaras para ramificaciones de funciones, lanzamientos y arreglos, y tambi√©n se realiza una transici√≥n a la ramificaci√≥n de desarrollo. <br></p><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/745/165/8b4/7451658b43174ccb99895463524d0661.png"></div><br><p>  A continuaci√≥n, la rama del c√≥digo fuente actual de Subversion se transfiere a la copia de trabajo, el c√≥digo se confirma (git add -A + git commit -m "Mensaje de confirmaci√≥n") a la rama de desarrollo del repositorio local y su carga al repositorio remoto (desarrollo de origen de inserci√≥n de git).  Despu√©s de eso, puede comenzar a desarrollar una nueva funcionalidad usando Git para versionar el c√≥digo. <br></p><br><p>  Durante el desarrollo, se descarga la versi√≥n actual de la rama de desarrollo y se crean ramas para desarrollar nuevas funciones (funci√≥n de flujo de git, iniciar MYFEATURE) de acuerdo con los c√≥digos de tareas de Jira dentro de los cuales se lleva a cabo el desarrollo. <br></p><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d58/3f3/735/d583f3735a70c227efffb305dce38b44.png"></div><br><p>  Se realiza autom√°ticamente una transici√≥n a la rama creada (git checkout MYFEATURE), se desarrolla la funcionalidad planificada y los cambios se confirman en la rama local MYFEATURE (git commit -m "Mensaje de compromiso").  Tenga en cuenta que para la correcta integraci√≥n de Git y Jira, el c√≥digo de confirmaci√≥n en Jira al que se aplica esta correcci√≥n debe indicarse en los mensajes de confirmaci√≥n.  Luego, estos commits se mostrar√°n en las tareas correspondientes, as√≠ como en la secci√≥n "Git commits" del proyecto, con la ayuda de la cual puede determinar inequ√≠vocamente qu√© se incluye en un lanzamiento en particular. <br></p><br><p>  Cuando la funcionalidad de la tarea seleccionada se desarrolla y est√° lista para enviarse al entorno de prueba, los commits creados se cargan en la rama remota con el mismo nombre (git push -u origin MYFEATURE) y se realiza una solicitud para fusionar la rama descargada con la rama de desarrollo al l√≠der del equipo o sus funciones de actuaci√≥n. <br></p><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/49d/7b1/2ad/49d7b12ad5f02edb327f97f67cf8e341.png"></div><br><p>  Para solicitar una fusi√≥n, el desarrollador resuelve conflictos de fusi√≥n (si los hay) y el l√≠der del equipo de desarrollo (o que act√∫a) produce una revisi√≥n del c√≥digo, durante el cual es posible crear confirmaciones adicionales (git commit -m "Mensaje de confirmaci√≥n") con correcciones a los comentarios recibidos durante la revisi√≥n de c√≥digo, en una rama con nueva funcionalidad y envi√°ndolas al repositorio central (git push -u origin MYFEATURE).  Despu√©s de completar con √©xito la revisi√≥n, el l√≠der del equipo (o la actuaci√≥n) confirma la fusi√≥n de las sucursales.  Aqu√≠ no es superfluo establecer la bandera para eliminar la rama despu√©s de la fusi√≥n; de lo contrario, el n√∫mero de ramas puede crecer r√°pidamente a escalas indecentes. <br></p><br><p>  Para garantizar una integraci√≥n continua en el repositorio de GitLab, se configura un Web Hook en la secci√≥n "Integraciones", que llama a las tareas de Jenkins para construir e instalar nuevas funcionalidades en el entorno de prueba.  Jenkins, utilizando un complemento para trabajar con Git, descarga el c√≥digo fuente, obtiene el nombre de la tarea y utiliza la API de Jira para solicitar una lista de componentes que se han cambiado y deben ensamblarse, iniciar el proceso de compilaci√≥n, ejecutar las pruebas unitarias y cargar los artefactos creados si pasan con √©xito en Sonatype Nexus y los instala en un entorno de prueba.  Si en una de las etapas ocurre una falla o fallan las pruebas de la Unidad, entonces, con la ayuda del complemento de Telegram, se informa al equipo de desarrollo sobre el resultado de la compilaci√≥n.  Si la instalaci√≥n se realiz√≥ correctamente, se notifica al equipo de control de calidad que la tarea est√° lista para la prueba. <br></p><br><p>  Si aparecen defectos, se descarga la versi√≥n actual de la rama de desarrollo y desde la confirmaci√≥n de fusi√≥n de la rama MYFEATURE con la rama de desarrollo se crea la rama hotfix-MYFEATURE (git checkout [BASECOMMIT] -b hotfix-MYFEATURE). <br></p><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/548/a48/f37/548a48f374180393510107a99d2ede12.png"></div><br><p>  Al crear, se realiza un pago autom√°tico a la rama creada, se realizan correcciones y los cambios se confirman en la rama local hotfix-MYFEATURE (git commit hotfix-MYFEATURE -m "Confirmar mensaje").  Cuando se completa la correcci√≥n y est√° lista para enviarse al entorno de prueba, se env√≠an a una rama remota con el mismo nombre (git push -u origin hotfix-MYFEATURE) y se crea una solicitud de fusi√≥n con la rama de desarrollo. <br></p><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/35d/7f3/1bb/35d7f31bbcb9f2e20aeb771d28123673.png"></div><br><p>  Para solicitar una fusi√≥n, el desarrollador resuelve los conflictos de fusi√≥n (si corresponde) y realiza una revisi√≥n del c√≥digo, durante el cual es posible crear confirmaciones adicionales con correcciones a los comentarios recibidos.  Una vez que la revisi√≥n se completa con √©xito, las ramas se fusionan.  Inmediatamente despu√©s de que el parche se transfiere a la rama de desarrollo, el Web Hook tambi√©n funciona para llamar a la tarea en Jenkins para construir, ejecutar pruebas unitarias, cargar los artefactos creados en Sonatype Nexus e instalar el parche en el entorno de prueba.  Un mecanismo de notificaci√≥n similar funciona para las correcciones. <br></p><br><p>  Si se solucionan todos los defectos, se descarga la versi√≥n actual de la rama de desarrollo y desde la confirmaci√≥n de fusi√≥n de la rama hotfix-MYFEATURE a la rama de desarrollo, se crea la rama release-mn (git flow release start RELEASENAME [BASECOMMIT]). <br></p><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a49/72b/955/a4972b9552f26c5c8001a955e059338a.png"></div><br><p>  La creaci√≥n de una rama de lanzamiento tambi√©n inicializa el lanzamiento de un Web Hook para llamar a una tarea en Jenkins, que descarga el c√≥digo fuente de Git, obtiene el nombre de la rama de lanzamiento y, utilizando la API de Jira, consulta la lista de componentes que se modificaron como parte de las tareas de lanzamiento, descarga las versiones actuales de Sonatype Nexus y los establece en un entorno de prueba de regresi√≥n.  Despu√©s de la instalaci√≥n de la versi√≥n en el entorno de prueba de regresi√≥n, se ejecutan scripts para preparar el entorno para la prueba (reinicio de la aplicaci√≥n, limpieza de la base de datos, etc.) y las pruebas autom√°ticas de regresi√≥n se ejecutan para verificar el funcionamiento de la funcionalidad del sistema principal, lo que da como resultado un informe utilizando el complemento Allure Reports para Jenkins.  Despu√©s de la instalaci√≥n, el equipo de control de calidad recibe una notificaci√≥n en Telegram sobre los resultados de la ejecuci√≥n de la prueba autom√°tica y la disponibilidad de la versi√≥n para la prueba de regresi√≥n manual. <br></p><br><p>  Si aparecen defectos durante la prueba de regresi√≥n, la versi√≥n actual de la rama release-mn se descarga y, desde la √∫ltima confirmaci√≥n, la rama hotfix / BUGNAME se crea con el nombre del defecto en Jira (git checkout -b hotfix / BUGNAME [BASECOMMIT]). <br></p><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/860/8dc/caf/8608dccafee44d15cb75bcd3449ec0d0.png"></div><br><p>  Se realiza un pago autom√°tico en la rama creada, se realizan las correcciones necesarias y los cambios se confirman en la rama local hotfix / BUGNAME (git commit hotfix / BUGNAME -m "Confirmar mensaje").  Cuando se completa la correcci√≥n y est√° lista para enviarse al entorno de prueba de regresi√≥n, se env√≠an a una rama remota con el mismo nombre (git push -u origin hotfix / BUGNAME) y se crea una solicitud de fusi√≥n con la rama release-mn <br></p><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fbb/438/ab5/fbb438ab59b57ecb5d20f863698078c5.png"></div><br><p>  Para solicitar una fusi√≥n, el desarrollador resuelve los conflictos de fusi√≥n (si corresponde) y realiza una revisi√≥n del c√≥digo, durante el cual es posible crear confirmaciones adicionales con correcciones a los comentarios recibidos durante la revisi√≥n del c√≥digo.  Estas confirmaciones tambi√©n se realizan en la rama local hotfix / BUGNAME (git commit hotfix / BUGNAME -m "Commit message") y se env√≠an a una rama remota con el mismo nombre (git push -u origin hotfix / BUGNAME).  Una vez que la revisi√≥n se completa con √©xito, las ramas se fusionan.  La fusi√≥n inicializa el lanzamiento de Web Hook para llamar a la tarea en Jenkins, similar a la anterior, pero diferente en que descarga el c√≥digo de Git, obtiene el nombre del defecto, usa la API de Jira para solicitar una lista de componentes que se han cambiado como parte de la soluci√≥n, recopilar estos componentes, descarga a Sonatype Nexus y los instala en un entorno de prueba de regresi√≥n.  Adem√°s, por analog√≠a, el entorno est√° preparado para la auto-evaluaci√≥n, se ejecutan las auto-pruebas de regresi√≥n y se notifican sus resultados. <br></p><br><p>  Cuando se reparan todos los defectos, la versi√≥n se instala en un entorno productivo.  Para hacer esto, combine la rama release-mn con las ramas desarrollada y maestra, y tambi√©n cree una etiqueta de lanzamiento. <br></p><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/caa/361/ec1/caa361ec1a043b0959a648d434de6a72.png"></div><br><p>  Cuando se crea, inicializa el lanzamiento de Web Hook para llamar a la tarea en Jenkins, que descarga el c√≥digo fuente de Git, obtiene el n√∫mero de versi√≥n y, utilizando la API de Jira, solicita una lista de tareas que se incluyeron en la versi√≥n y los componentes que se modificaron como parte de estas tareas, despu√©s de que bombea la versi√≥n actual de los artefactos de Sonatype Nexus y los instala en un entorno productivo. <br></p><br><p>  Con las revisiones para las ventas, se decidi√≥ utilizar un proceso similar al lanzamiento; de lo contrario, las etapas de prueba de los cambios realizados se perder√°n. <br></p><br><p>  Al implementar el proceso, tambi√©n se realiz√≥ capacitaci√≥n para empleados que no ten√≠an experiencia trabajando con Git y GitLab, para lo cual se desarroll√≥ un programa de capacitaci√≥n adecuado.  Con √©l, usted mismo podr√° impartir capacitaci√≥n sobre el uso de Source Tree e Intellij IDEA para trabajar con Git, as√≠ como con GitLab para realizar revisiones de c√≥digo.  En el pr√≥ximo post le dar√©, complementando con ilustraciones. <br></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es425315/">https://habr.com/ru/post/es425315/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es425301/index.html">La evoluci√≥n de la descomposici√≥n: de los servidores Linux a Kubernetes</a></li>
<li><a href="../es425303/index.html">Revisi√≥n de la conferencia droidcon de Viena</a></li>
<li><a href="../es425305/index.html">C√≥mo organiza The Chemical Brothers Show: detalles t√©cnicos y cambios</a></li>
<li><a href="../es425311/index.html">El libro "Programaci√≥n para ni√±os. De lo b√°sico a la creaci√≥n de robots.</a></li>
<li><a href="../es425313/index.html">Las 10 mejores extensiones de VS Code de 2018 para desarrolladores front-end</a></li>
<li><a href="../es425317/index.html">C√≥mo se hace: escribimos "Buscaminas" en 4 minutos</a></li>
<li><a href="../es425321/index.html">La programaci√≥n es la materializaci√≥n de ideas.</a></li>
<li><a href="../es425323/index.html">"Madriguera de conejo". Dise√±ador UX en el equipo de producto.</a></li>
<li><a href="../es425325/index.html">Int√©rpretes de bytecode de bricolaje</a></li>
<li><a href="../es425327/index.html">Programaci√≥n funcional: mida siete veces, corte una vez</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>