<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëπ üöé üë©üèæ‚Äçü§ù‚Äçüë©üèΩ "Uno, dos, tres: ¬°quema el √°rbol de Navidad!" O mi primer vistazo al peque√±o controlador CANNY 3 üçæ üôÖüèø üíÜüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=""A√±o Nuevo" es mandarinas, Olivier, fines de semana y, por supuesto, regalos. 

 Como probablemente ya haya adivinado, de repente me convert√≠ en el pr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>"Uno, dos, tres: ¬°quema el √°rbol de Navidad!" O mi primer vistazo al peque√±o controlador CANNY 3</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482948/">  "A√±o Nuevo" es mandarinas, Olivier, fines de semana y, por supuesto, regalos. <br><br>  Como probablemente ya haya adivinado, de repente me convert√≠ en el propietario del microcontrolador CANNY 3 Tiny.  Es cierto, no estoy particularmente interesado en la electr√≥nica de bricolaje y la √∫ltima vez que intent√© conectar algo al controlador hace casi siete a√±os, cuando hice retroiluminaci√≥n <a href="https://habr.com/ru/post/184144/">para el perejil usando el clon Arduino</a> .  ¬øPero no desaparece lo bueno?  Todav√≠a debemos ver qu√© tipo de bestia es esta. <br><br>  Entonces, seg√∫n el sitio de los desarrolladores, sus productos son ampliamente utilizados e incluso instalados en KAMAZ que participan en el rally Dakar.  Al mismo tiempo, la caracter√≠stica principal de sus controladores es que para programar no tiene que escribir una sola l√≠nea de c√≥digo.  Todo el programa se desarrolla como un diagrama de bloques.  Como una persona lejos del mundo del bricolaje, estaba muy intrigado. <br><br>  Y todo estar√≠a bien, pero hay un inconveniente.  El a√±o pasado, sinceramente, quer√≠a comprar un par de camiones Dakarovsky KAMAZ, pero no pude obtenerlos con un descuento en el Black Friday.  Por lo tanto, tenemos que salir de esta situaci√≥n de manera simple y elegante. <br><br>  En este art√≠culo conectaremos el bot√≥n y el LED rojo pira√±a al controlador, despu√©s de lo cual los programaremos para que el LED se encienda y apague presionando el bot√≥n. <br><br>  ¬øQuieres unirte a mi diversi√≥n desenfrenada de A√±o Nuevo?  Entonces eres bienvenido bajo cat. <br><br><img src="https://habrastorage.org/webt/gw/ij/hy/gwijhya-ewtskixrwrdvavds_ww.png"><br><a name="habracut"></a><br>  Por cierto, en Habr√© ya hab√≠a un <a href="https://habr.com/ru/post/369429/">art√≠culo sobre los controladores CANNY</a> , pero en primer lugar hab√≠a otro controlador all√≠, y en segundo lugar, el software para desarrollar programas estaba desactualizado desde ese momento.  Como resultado, me llev√≥ aproximadamente una hora descubrir c√≥mo parpadear el LED verde integrado en el controlador.  Esto es en parte por lo que decid√≠ compartir con ustedes mis intentos de "frenar" el controlador.  <i>Y en parte solo porque me gusta escribir en Habr, cuando tengo tiempo libre.</i> <br><br>  Antes de continuar, considero que es mi deber advertir a los lectores.  A pesar de que este art√≠culo se presenta como un "tutorial", no soy un experto ni en microelectr√≥nica ni en programaci√≥n.  Solo compartir√© lo que logr√© resolver para ahorrarle tiempo. <br><br>  Esto es lo que discutir√° el art√≠culo: <br><br>  <a href="https://habr.com/ru/post/482948/">Parte I: Desembalaje y familiarizaci√≥n</a> <br>  <a href="https://habr.com/ru/post/482948/">Parte II: conectar el circuito</a> <br>  <a href="https://habr.com/ru/post/482948/">Parte III: Programaci√≥n</a> <br>  <a href="https://habr.com/ru/post/482948/">Parte IV: Conclusi√≥n</a> <br><a name="I"></a><br><h2>  Parte I: Desembalaje y familiarizaci√≥n </h2><br>  Para empezar, debe decir al menos algunas palabras sobre nuestro h√©roe del art√≠culo.  El peque√±o controlador CANNY 3 es la familia de controladores CANNY m√°s peque√±a.  Los hermanos mayores CANNY 3 peque√±os: los controladores de las series CANNY 7 y CANNY 5 pueden trabajar con el bus CAN del autom√≥vil.  Nuestro hermano menor, as√≠ como mi viejo autom√≥vil Zhiguli, no saben nada sobre el autob√∫s CAN y viven en paz. <br><br>  Para obtener m√°s informaci√≥n sobre el controlador, consulte la <a href="https://wiki.canny.ru/index.php%3Ftitle%3DCANNY_3_tiny" rel="nofollow">secci√≥n Wiki</a> correspondiente.  Los desarrolladores tambi√©n tienen una secci√≥n en el <a href="https://forum.canny.ru/viewforum.php%3Fid%3D12" rel="nofollow">foro</a> , gracias a la cual finalmente descubr√≠ c√≥mo configurar los registros del controlador para entrada y salida. <br><br>  Pero volveremos a los problemas de programaci√≥n m√°s tarde.  Veamos finalmente un regalo inesperado. <br><br><img src="https://habrastorage.org/webt/j6/wl/oc/j6wlocyi347hcsq7yjy3xzny6b4.png"><br><br>  Al abrir la caja, experiment√© una breve sensaci√≥n de ternura.  El controlador es realmente peque√±o.  Perdona a los fan√°ticos perdon√°ndome una comparaci√≥n inapropiada, pero √©l es casi como "beb√© Yoda". <br><br><img title="imagen de https://www.boredpanda.com/baby-yoda-the-mandalorian-star-wars/?utm_source=google&amp;utm_medium=organic&amp;utm_campaign=organic" src="https://habrastorage.org/webt/1m/a8/cs/1ma8csw3fpmhebz9lwywv97bkhw.png"><br><br>  Seg√∫n las tiendas en l√≠nea, el controlador tiene dos opciones de configuraci√≥n: sin un bloque de terminales y arn√©s, as√≠ como con ellos.  Dada mi curvatura en t√©rminos de "soldar algo", estoy muy contento de haber obtenido una versi√≥n con un bloque de terminales y un arn√©s. <br><br>  Ocultar√© algunas fotos m√°s del controlador y el arn√©s debajo del spoiler. <br><br><div class="spoiler">  <b class="spoiler_title">M√°s fotos</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/dg/yg/l3/dgygl39ncrq4k7_kju-ew_qaonw.png"><br><img src="https://habrastorage.org/webt/mx/xx/ha/mxxxhah45zvwcpprfzmaiedqsfo.png"><br></div></div><br><a name="II"></a><br><h2>  Parte II: conectar el circuito </h2><br>  Como dije, conectaremos un LED al controlador (en nuestro caso, "pira√±a"), pero cualquiera es posible (simplemente no ten√≠a otro).  Controlaremos el LED usando el bot√≥n.  El algoritmo de operaci√≥n es el siguiente: una vez presionado el bot√≥n y el LED est√° encendido, una vez m√°s presionado se apaga. <br><br>  Describamos brevemente las caracter√≠sticas del controlador d√≠as importantes de nuestro caso: <br><br><ol><li>  Alimentaremos el controlador desde el cargador microUSB (en mi caso 5V, 1 A); </li><li>  El controlador tiene 6 pines programables, as√≠ como los pines "+" y "-"; </li><li>  Las salidas programables se pueden configurar como una "entrada" o como una salida; </li><li>  La corriente m√°xima en la salida de los terminales controlados es de 100 mA; </li><li>  Las conclusiones tienen modos diferentes, incluido PWM, pero hoy no profundizaremos tanto. </li></ol><br>  Trat√© de hacerlo para que pudieras entender mi idea simple e incluso puse a KiCad para dibujar al menos un boceto. <br><br>  <i>Para ser honesto, no soy bueno en tales asuntos, y veo KiCad la primera (o segunda) vez en mi vida, as√≠ que si encuentras errores, aseg√∫rate de dec√≠rmelo para que pueda solucionarlo.</i> <br><br><img src="https://habrastorage.org/webt/dn/t6/xf/dnt6xf2vl6xzwv_yru_pgf_syla.png"><br><br><img src="https://habrastorage.org/webt/rt/km/y9/rtkmy9vwn_gofdpom7x0boetzvo.png"><br><br>  Como espera, entendemos por los diagramas que en nuestro proyecto usaremos: el controlador en s√≠, una placa de pruebas, una resistencia de limitaci√≥n de corriente de 80 ohmios, un bot√≥n similar a KLS7-TS6601-5.0-180 y un LED similar a BL-FL7600UEC, pero de hecho puede reemplazarlos con lo que est√° a su alcance. <br><br>  La l√≥gica de conexi√≥n es la siguiente: <br><br><ol><li>  La salida "-" del controlador est√° conectada al bus negativo; </li><li>  La salida "2" nos servir√° como un "plus", con√©ctelo al bus correspondiente en la placa de pruebas; </li><li>  Conclusi√≥n "1" Trabajar√° en la entrada y recibir√° una se√±al si el bot√≥n cierra el circuito (cuando se presiona); </li><li>  La salida "4" ser√° alimentada por nuestro LED, por conveniencia lo conect√© a otro bus "+" en el tablero, pero esto no es necesario. </li><li>  El √°rbol de Navidad es un atributo del a√±o nuevo y en todos los sentidos justifica el t√≠tulo de este art√≠culo. </li></ol><br><a name="III"></a><br><h2>  Parte III: Programaci√≥n </h2><br>  Para programar el controlador, necesitamos el entorno de desarrollo CannyLab, puede descargarlo desde el sitio del desarrollador.  Al momento de escribir, la versi√≥n actual era 1.41.  El entorno de desarrollo no requiere instalaci√≥n, solo necesita descomprimir el archivo en alguna carpeta. <br><br>  Antes de escribir c√≥digo para nuestro circuito, asegur√©monos de que todo funcione para nosotros. <br>  En mi caso, lo primero que hice fue escribir el software del sistema en el controlador. <br><br>  Conectamos el controlador mediante un cable microUSB a la computadora.  En mi caso, en Windows 10, no tuve que instalar ning√∫n controlador por separado. <br><br>  Nos aseguramos de que el controlador est√© conectado; de lo contrario, haga clic en el bot√≥n "Conectar" (parece dos enlaces en una cadena) <br><br>  A continuaci√≥n, debe llamar al cuadro de di√°logo a la direcci√≥n "Dispositivo -&gt; Software del sistema -&gt; Escribir" y seleccionar el archivo apropiado (en mi caso, "c3tinyv00108.ccx").  Por si acaso, dejar√© una captura de pantalla a continuaci√≥n. <br><br><img src="https://habrastorage.org/webt/99/09/og/9909ogg8gl7vwfvwhvt2j3zi2ii.png"><br><br>  Ahora puedes configurar el programa. <br><br>  El programa se forma arrastrando los elementos de la izquierda al campo blanco del espacio de trabajo y luego conectando los elementos entre s√≠. <br><br>  Para parpadear el LED incorporado en modo PWM, necesitamos 3 constantes, un bloque generador de se√±al PWM y un registro de escritura. <br><br>  Conectamos todo como en la imagen. <br><br><img src="https://habrastorage.org/webt/vy/n5/sp/vyn5spknchxhe7ko4wm4wbbkpa0.png"><br><br>  Los valores para constantes y registros se pueden establecer si hace doble clic en ellos con LMB. <br>  ¬øCu√°les son estos misteriosos valores de constantes? <br><br><ul><li>  "3000" - un per√≠odo de 3 segundos; </li><li>  "1500" - nos dice que nuestro LED de tres segundos solo brillar√° uno y medio; </li><li>  ‚Äú1‚Äù: solo inicia el generador. </li></ul><br>  <i>Para no buscar el valor deseado del registro durante mucho tiempo, ingrese la l√≠nea "LED" en la ventana "Filtro"</i> <br><br>  Escribimos el programa en la memoria del controlador. <br><br><img src="https://habrastorage.org/webt/4o/3x/e-/4o3xe-ht5p4-e17yzjpmx6-cmt0.png"><br><br>  A continuaci√≥n, desconecte el controlador de la computadora y cambie el cable a carga USB. <br><br>  La luz verde parpadea con un per√≠odo de tres segundos, por lo que todo funciona como quer√≠amos. <br><br><img src="https://habrastorage.org/webt/sz/ir/kc/szirkckvqoex2r0ynkj9eebhghw.png"><br><br>  Un par de palabras sobre el entorno de desarrollo, en primer lugar, comprueba si hay errores en el diagrama antes de cargarlo en el controlador, lo que significa que hay alguna "protecci√≥n contra el tonto".  En segundo lugar, si hace clic en el bot√≥n en forma de "error", se abrir√° el emulador de la tabla, pero m√°s sobre eso en otro momento. <br><br>  Pasemos al programa para el circuito. <br><br>  Montar el diagrama como en la imagen. <br><br><img src="https://habrastorage.org/webt/mk/oe/m4/mkoem46zzjx5l-qvq3yn9vvuejs.png"><br><br>  Para no buscar nombres de registros y constantes durante mucho tiempo, utilice el filtro por analog√≠a con la captura de pantalla. <br><br><img src="https://habrastorage.org/webt/ll/fx/ga/llfxga06iodeygrpjyu2pwenup8.png"><br><br>  Explica brevemente los bloques. <br><br><pre><code class="plaintext hljs">¬´ /   ¬ª -  . .   2¬ª</code> </pre> <br>  Nos establece la salida 2 para suministrar + 5V, de manera similar para el cuarto canal <br><br>  Como el canal 2 se usa realmente como "+ 5 V", simplemente escribimos la constante "1" en √©l (creo que puede usar cualquier n√∫mero mayor que cero). <br><br>  <i>Nota: El voltaje en las salidas del controlador depende del voltaje de suministro y puede variar dependiendo de c√≥mo lo alimente.</i> <br><br>  Pero el canal 4 aqu√≠ da + 5V, luego no, dependiendo de presionar un bot√≥n. <br><br>  El canal 1 est√° configurado de forma predeterminada para la entrada y no es necesario configurar nada por separado, tomamos su valor de entrada usando el bloque: <br><br><pre> <code class="plaintext hljs">¬´ . .  1¬ª</code> </pre><br>  Y pasamos al bloque de la negaci√≥n l√≥gica ("No"). <br><br>  El bloque "No" es necesario para que, por defecto, cuando el circuito est√© encendido, nuestro LED se ilumine de inmediato.  Si se elimina este bloque y el registro de canal 1 se conecta directamente al detector de borde de ataque, el LED se apagar√° de manera predeterminada. <br><br>  El detector de borde de ataque se activa cuando presionamos el bot√≥n y no dar√° m√°s se√±ales hasta que decidamos presionarlo nuevamente. <br><br>  Para guardar el estado actual, se utiliza un disparador "T".  Si se alimenta uno a la entrada "T", y se alimenta un solo pulso a la entrada "C" desde la salida del detector, entonces nuestro disparador alternar√° el estado "0" y el estado "1" en la salida.  Justo exactamente lo que necesitamos. <br><br>  A continuaci√≥n, la se√±al de la salida del disparador va al registro de salida del canal 4, que a su vez alimenta el LED. <br><br>  Ambos gr√°ficos se pueden descargar desde <a href="https://github.com/bosonbeard/Funny-models-and-scripts/tree/master/5.Canny" rel="nofollow">GitHub</a> . <br><a name="IV"></a><br><h2>  Parte IV: Conclusi√≥n </h2><br><img src="https://habrastorage.org/webt/sl/jf/80/sljf80-deg-ha1k35vza91rlu5q.png"><br><br><img src="https://habrastorage.org/webt/tn/om/n7/tnomn7q4-cw7pqe0jpvgtm4nee4.png"><br><br><img src="https://habrastorage.org/webt/sa/yc/xz/saycxzcopf5rbpbzdcz6dbue0xs.png"><br><br>  Las im√°genes a continuaci√≥n muestran que todo funciona (y mi dedo a√∫n est√° visible). <br>  <i>Al comienzo del art√≠culo, mencion√© el torniquete, pero era demasiado vago para pelarlo y esta√±ar, as√≠ que por ahora us√© cables separados, que todav√≠a tengo de los experimentos con Craftduino.</i> <br><br>  "¬øY qu√© hay de multiplataforma?" - preguntas.  Trat√© de escribir c√≥digo en el controlador ejecutando el entorno de desarrollo en Linux a trav√©s de Wine.  Como resultado, el entorno de desarrollo comenz√≥, pero el controlador en s√≠ no ve la computadora (tal vez necesite "conjurarla" con Wine).  Por lo tanto, a√∫n no es posible hablar sobre soluciones multiplataforma listas para usar. <br><br>  Otra desventaja del controlador es el alto costo en comparaci√≥n con algunas falsificaciones "chinas" para Arduino, pero esto se compensa parcialmente por la calidad.  Es agradable tener el controlador en sus manos, y todo fue embalado en una caja con mucho cuidado.  El controlador incluso se cay√≥ una vez, pero hasta ahora todo funciona. <br><br>  Es cierto que en las evaluaciones del controlador, probablemente soy un poco subjetivo.  Es agradable para m√≠ que el producto sea dom√©stico y que los desarrolladores, aunque un poco, est√©n involucrados en las victorias de KAMAZ en el rally Dakar. <br><br>  En general, estuve satisfecho con el regalo, el estilo visual de programaci√≥n es muy inusual para m√≠, pero al mismo tiempo tiene sus ventajas.  Creo que a las personas que estudiaron ingenier√≠a electr√≥nica y ciencias de la computaci√≥n, incluso de los libros de texto sovi√©ticos y que sab√≠an qu√© registros, disparadores, multiplexores, etc., les gustar√≠a m√°s que nada. <br><br>  <i>UPD: Amigos, estaba un poco atrasado y viol√© ligeramente las reglas de Habr, por lo que elimin√© los enlaces directos al sitio web de desarrolladores del controlador para que el art√≠culo no se vea publicitario y cumpla con las reglas.</i>  <i>Creo que puede encontrar f√°cilmente el enlace para descargar el entorno de desarrollo CannyLab y las "pruebas" sobre KAMAZ usted mismo.</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/482948/">https://habr.com/ru/post/482948/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../482938/index.html">Aplicaci√≥n de los principios de programaci√≥n funcional en el dise√±o de ERP</a></li>
<li><a href="../482940/index.html">El resumen de materiales frescos del mundo del front-end para la √∫ltima semana No. 396 (30 de diciembre de 2019 - 5 de enero de 2020)</a></li>
<li><a href="../482942/index.html">Mitos y leyendas del antiguo Fediverse.</a></li>
<li><a href="../482944/index.html">Dispensador de transportador de componentes m√∫ltiples</a></li>
<li><a href="../482946/index.html">1–° DSS y estimaci√≥n de t√©rminos y costos de proyectos por el m√©todo COCOMO II</a></li>
<li><a href="../482950/index.html">Java: cosas que pueden parecer curiosas para un desarrollador experimentado</a></li>
<li><a href="../482956/index.html">Revisi√≥n de WCS 5.2 - Servidor WebRTC para desarrolladores de Webcast y Webcam</a></li>
<li><a href="../482958/index.html">"Reglas de crecimiento: de junior a CTO", resumen de un webinar de Fedor Borshchev</a></li>
<li><a href="../482960/index.html">Descripci√≥n general de WCS 5.2: servidor WebRTC para desarrolladores web de transmisiones en l√≠nea y video chat</a></li>
<li><a href="../482968/index.html">Quarkus: una nueva mirada a Cloud Native Java</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>