<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏞️ 🤙 🚶🏾 Préférences de stratégie de groupe et PowerShell lorsque les imprimantes comptent pour des centaines ✍🏿 🥇 🖐🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="De nombreuses copies sont réparties autour de la gestion des imprimantes réseau sur les ordinateurs des utilisateurs. Fondamentalement, les administra...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Préférences de stratégie de groupe et PowerShell lorsque les imprimantes comptent pour des centaines</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421211/"><img src="https://habrastorage.org/webt/on/rk/c4/onrkc4w9qra4taifkmg2lyqqazc.jpeg"><br><br>  De nombreuses copies sont réparties autour de la gestion des imprimantes réseau sur les ordinateurs des utilisateurs.  Fondamentalement, les administrateurs étaient divisés en deux camps: la connexion avec des scripts de connexion (bat / vbs) et la gestion via GPP.  Les deux approches ont leurs avantages: les scripts sont traités plus rapidement, et GPP est plus flexible et est utilisé plus souvent que les utilisateurs redémarrent les ordinateurs.  Mais quand il y a plus d'une centaine d'imprimantes et qu'elles sont dispersées dans des dizaines de bureaux et de villes, il y aura des difficultés dans les deux cas. <br><br>  Il est nécessaire non seulement de connecter le bon ensemble d'imprimantes à chaque utilisateur, en tenant compte de son emplacement actuel, mais aussi de ne pas en oublier.  Et si parfois non seulement les utilisateurs, mais aussi les imprimantes elles-mêmes sont déplacées ... <br><br>  En général, mes collègues et moi avons choisi GPP pour nous-mêmes, tout d'abord, afin que quelqu'un en plus des principaux administrateurs puisse comprendre la configuration actuelle en consultant simplement le rapport GPMC.  Cependant, celui qui dit que son interface standard est pratique pour gérer plus de 100 appareils - laissez le premier me jeter une pierre.  De plus, lors de la mise en service du prochain lot, vous devez effectuer de nombreuses tâches de routine pour configurer la numérisation réseau et l'ajouter au serveur d'impression. <br><br>  Et tout ce qui est fait plus d'une fois peut être automatisé! <br><br>  Que ferons-nous aujourd'hui? <br><br><ul><li>  tenir des registres de toutes les imprimantes réseau; </li><li>  automatiser l'ajout d'imprimantes au GPP (PS / XML); </li><li>  automatisez l'ajout d'imprimantes au serveur d'impression et au cluster (BAT / VBS)! </li></ul><br>  Commençons donc. <br><a name="habracut"></a><br><h3>  1. Comptabilisation des imprimantes réseau </h3><br>  Le premier problème qui se pose lors de la gestion d'un grand nombre d'objets est la comptabilité.  Sans lui, il est facile de se demander où il est installé et à qui il doit être connecté. <br>  La solution la plus simple et la plus universelle est CSV.  Au final, à partir de n'importe quel système d'inventaire, les feuilles de calcul ServiceDesk ou Excel peuvent être téléchargées vers CSV puis facilement importées dans PowerShell, ce que nous ferons ensuite. <br><br>  Notre déchargement ressemble à ceci: <br><br> <a href=""><img src="https://habrastorage.org/webt/dc/xk/kv/dcxkkv1pb1lbd_tba7gauxpuoss.png" alt="image"></a> <br><br>  Je vais vous expliquer tout de suite pourquoi il y a tant de domaines: <br><br><ul><li>  <b>Nom</b> - le nom de réseau de l'imprimante, il est écrit dans DNS et sur le serveur d'impression </li><li>  <b>ByGroup</b> - le champ détermine <b>s'il faut</b> connecter l'imprimante à tous ceux qui se trouvent sur le sous-réseau correspondant ou uniquement à ceux qui sont membres du groupe AD.  Le groupe définit également les ACL. </li><li>  <b>Sous</b> - <b>réseau</b> - le sous-réseau dans lequel l'utilisateur doit se trouver pour travailler avec l'imprimante </li><li>  <b>Emplacement</b> - la ligne d'emplacement de l'imprimante par laquelle l'Assistant Ajout d'imprimante de Windows recherche <div class="spoiler">  <b class="spoiler_title">Comment la recherche d'imprimantes par emplacement est organisée</b> <div class="spoiler_text">  Beaucoup de gens ne savent pas ce qui se passe lorsqu'une imprimante recherche un assistant de configuration d'imprimante standard.  Et c'est ce qui se passe.  L'assistant prend le champ Emplacement des attributs d'ordinateur dans AD et sélectionne parmi les imprimantes publiées dans AD toutes les dont l'emplacement commence sur la même ligne.  Autrement dit, si l'ordinateur de l'utilisateur à l'emplacement indique «Omsk / Office on Lenin», la recherche affichera les imprimantes avec les emplacements «Omsk / Office on Lenin /», «Omsk / Office on Lenin / Office 404» et «Omsk / Office on Lénine / Réception » </div></div></li><li>  <b>Pilote</b> - le nom du pilote qui sera spécifié lors de l'ajout au serveur d'impression.  Ce pilote doit déjà être installé sur le serveur.  Habituellement, tous les fabricants fournissant des équipements d'impression plus ou moins sérieux ont des pilotes universels, et ils sont installés au plus une fois par lot, puis si le fournisseur a changé, je n'ai donc pas automatisé cette pièce. </li><li>  <b>Le type</b> n'est qu'une description de l'imprimante afin que les utilisateurs puissent facilement sélectionner l'imprimante dont ils ont besoin en fonction de ses capacités si nécessaire. </li><li>  <b>Modèle</b> - modèle de l'imprimante ou du MFP.  Ici, à l'aide de tableaux auxiliaires, les deux précédents sont renseignés pour ce champ. </li><li>  <b>UID</b> - et cela fait partie du gâteau d'aujourd'hui.  Cet UID marque les objets dans le GPP, simplifiés - afin de ne pas réinstaller l'imprimante à chaque mise à jour de la stratégie de groupe. </li></ul><br>  Cet ensemble de données est suffisant pour ne pas les coder en dur dans Powershell.  Vous pouvez commencer le plaisir. <br><br><h3>  2. Automatisez GPP </h3><br>  En général, le fichier Printers.xml dans un objet GPP ressemble à ceci: <br><br><pre><code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Printers</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{1F577D12-3D1B-471e-A1B7-060317597B9C}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9A5E9697-9095-436d-A0EE-4D128FDFBCE5}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-BARAB-061"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">status</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-BARAB-061"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{43231EA0-A4A3-4F1A-8A25-95BC4FEFBCC6}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bypassErrors</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"U"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">comment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"\\print-cluster-1.common.domain\PRN-BARAB-061"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterGroup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"COMDOM\PRN-BARAB-061"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">sid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"S-1-5-21-210359847-7924152125-768726458-48993"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterIpRange</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">min</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.142.1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.142.254"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Printers</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  La source du format peut être étudiée ici: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[MS-GPPREF]: Imprimantes</a> et ici: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[MS-GPPREF]: Attributs XML communs</a> . <br><br>  En pratique, je pense que vous pouvez facilement comparer les noms de champs de ce fichier avec les cases à cocher de l'interface GPP, mais je noterai les points clés: <br><br>  <b>clsid</b> est les valeurs fixes des classes de préférences de stratégie de groupe, elles peuvent (et doivent) être laissées telles quelles. <br><br>  Nom / État sont les noms d'affichage des éléments dans la console GPP. <br>  <b>uid</b> - mais il s'agit de l'identifiant unique de l'objet que vous avez vu dans le tableau ci-dessus. <br><br>  S'il change à chaque mise à jour de la liste des imprimantes, l'imprimante se reconnecte à tous les utilisateurs, ce qui peut provoquer différents effets secondaires. <br>  <b>Chemin</b> - <b>Chemin</b> UNC vers l'imprimante <br>  <b>FilterGroup, FilterIpRange</b> - Ciblage des éléments par appartenance des utilisateurs au groupe AD et recherche de l'ordinateur dans la plage d'adresses IP. <br><br><h4>  2.1.  Nous importons les données et créons la structure de base du document XML: </h4><br>  Pour ce faire, utilisez la classe système [System.Xml.XmlDocument]: <br><br><pre> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$PrintersCSV</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">Import-Csv</span></span> <span class="hljs-literal"><span class="hljs-literal">-Delimiter</span></span> <span class="hljs-string"><span class="hljs-string">";"</span></span> <span class="hljs-string"><span class="hljs-string">".\Printers.csv"</span></span> <span class="hljs-literal"><span class="hljs-literal">-Encoding</span></span> Default [<span class="hljs-type"><span class="hljs-type">System.Xml.XmlDocument</span></span>]<span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">New-Object</span></span> System.Xml.XmlDocument <span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.PrependChild(<span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.CreateXmlDeclaration(<span class="hljs-string"><span class="hljs-string">"1.0"</span></span>, <span class="hljs-string"><span class="hljs-string">"utf-8"</span></span>, <span class="hljs-variable"><span class="hljs-variable">$null</span></span>)) | <span class="hljs-built_in"><span class="hljs-built_in">Out-Null</span></span> <span class="hljs-variable"><span class="hljs-variable">$Printers</span></span> = <span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.AppendChild(<span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.CreateElement(<span class="hljs-string"><span class="hljs-string">"Printers"</span></span>)) <span class="hljs-variable"><span class="hljs-variable">$Printers</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"clsid"</span></span>,<span class="hljs-string"><span class="hljs-string">"{1F577D12-3D1B-471e-A1B7-060317597B9C}"</span></span>)</code> </pre><br><h4>  2.2.  Ajoutez des fonctions d'assistance pour créer les éléments XML nécessaires et définir leurs attributs </h4><br>  Création d'un élément d'imprimante: <br><br><pre> <code class="hljs powershell"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">Function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NewSharedPrinter</span></span></span></span> { <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">CmdletBinding</span></span></span><span class="hljs-function">()] </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">param</span></span></span></span> ( <span class="hljs-variable"><span class="hljs-variable">$SharedPrinter</span></span>, <span class="hljs-variable"><span class="hljs-variable">$clsid</span></span> = <span class="hljs-string"><span class="hljs-string">"{9A5E9697-9095-436d-A0EE-4D128FDFBCE5}"</span></span>, <span class="hljs-variable"><span class="hljs-variable">$uid</span></span>, <span class="hljs-variable"><span class="hljs-variable">$name</span></span>, <span class="hljs-variable"><span class="hljs-variable">$action</span></span> ) <span class="hljs-variable"><span class="hljs-variable">$image</span></span> <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (<span class="hljs-variable"><span class="hljs-variable">$action</span></span>){ <span class="hljs-string"><span class="hljs-string">"C"</span></span> {<span class="hljs-variable"><span class="hljs-variable">$image</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>} <span class="hljs-string"><span class="hljs-string">"R"</span></span> {<span class="hljs-variable"><span class="hljs-variable">$image</span></span> = <span class="hljs-number"><span class="hljs-number">1</span></span>} <span class="hljs-string"><span class="hljs-string">"U"</span></span> {<span class="hljs-variable"><span class="hljs-variable">$image</span></span> = <span class="hljs-number"><span class="hljs-number">2</span></span>} <span class="hljs-string"><span class="hljs-string">"D"</span></span> {<span class="hljs-variable"><span class="hljs-variable">$image</span></span> = <span class="hljs-number"><span class="hljs-number">3</span></span>} } <span class="hljs-variable"><span class="hljs-variable">$SharedPrinter</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"clsid"</span></span>,<span class="hljs-variable"><span class="hljs-variable">$clsid</span></span>) <span class="hljs-variable"><span class="hljs-variable">$SharedPrinter</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"name"</span></span>,<span class="hljs-variable"><span class="hljs-variable">$name</span></span>) <span class="hljs-variable"><span class="hljs-variable">$SharedPrinter</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"status"</span></span>,<span class="hljs-variable"><span class="hljs-variable">$name</span></span>) <span class="hljs-variable"><span class="hljs-variable">$SharedPrinter</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"image"</span></span>,<span class="hljs-variable"><span class="hljs-variable">$image</span></span>) <span class="hljs-variable"><span class="hljs-variable">$SharedPrinter</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"uid"</span></span>,<span class="hljs-variable"><span class="hljs-variable">$uid</span></span>) <span class="hljs-variable"><span class="hljs-variable">$SharedPrinter</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"userContext"</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-variable"><span class="hljs-variable">$SharedPrinter</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"bypassErrors"</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-variable"><span class="hljs-variable">$SharedPrinterProperties</span></span> = <span class="hljs-variable"><span class="hljs-variable">$SharedPrinter</span></span>.AppendChild(<span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.CreateElement(<span class="hljs-string"><span class="hljs-string">"Properties"</span></span>)) <span class="hljs-variable"><span class="hljs-variable">$SharedPrinterProperties</span></span>.setattribute(<span class="hljs-string"><span class="hljs-string">"action"</span></span>,<span class="hljs-variable"><span class="hljs-variable">$action</span></span>) <span class="hljs-variable"><span class="hljs-variable">$SharedPrinterProperties</span></span>.setattribute(<span class="hljs-string"><span class="hljs-string">"comment"</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>) <span class="hljs-variable"><span class="hljs-variable">$SharedPrinterProperties</span></span>.setattribute(<span class="hljs-string"><span class="hljs-string">"path"</span></span>,<span class="hljs-string"><span class="hljs-string">"\\print-cluster-1.common.domain\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$name</span></span></span><span class="hljs-string">"</span></span>) <span class="hljs-variable"><span class="hljs-variable">$SharedPrinterProperties</span></span>.setattribute(<span class="hljs-string"><span class="hljs-string">"default"</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-variable"><span class="hljs-variable">$SharedPrinterProperties</span></span>.setattribute(<span class="hljs-string"><span class="hljs-string">"port"</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>) }</code> </pre><br>  Création d'éléments de filtrage (ciblage) par groupe et par sous-réseau: <br><pre> <code class="hljs powershell"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">Function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NewFilterGroup</span></span></span></span>{ <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">CmdletBinding</span></span></span><span class="hljs-function">()] </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">param</span></span></span></span> ( <span class="hljs-variable"><span class="hljs-variable">$FilterGroup</span></span>, <span class="hljs-variable"><span class="hljs-variable">$bool</span></span> = <span class="hljs-string"><span class="hljs-string">"AND"</span></span>, <span class="hljs-variable"><span class="hljs-variable">$not</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-variable"><span class="hljs-variable">$name</span></span>, <span class="hljs-variable"><span class="hljs-variable">$sid</span></span> ) <span class="hljs-variable"><span class="hljs-variable">$FilterGroup</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"bool"</span></span>,<span class="hljs-variable"><span class="hljs-variable">$bool</span></span>) <span class="hljs-variable"><span class="hljs-variable">$FilterGroup</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"not"</span></span>,<span class="hljs-variable"><span class="hljs-variable">$not</span></span>) <span class="hljs-variable"><span class="hljs-variable">$FilterGroup</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"name"</span></span>,<span class="hljs-string"><span class="hljs-string">"COMDOM\"</span></span>+<span class="hljs-variable"><span class="hljs-variable">$name</span></span>) <span class="hljs-variable"><span class="hljs-variable">$FilterGroup</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"sid"</span></span>,<span class="hljs-variable"><span class="hljs-variable">$sid</span></span>) <span class="hljs-variable"><span class="hljs-variable">$FilterGroup</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"userContext"</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">Function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NewFilterSubnet</span></span></span></span>{ <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">CmdletBinding</span></span></span><span class="hljs-function">()] </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">param</span></span></span></span> ( <span class="hljs-variable"><span class="hljs-variable">$FilterIPRange</span></span>, <span class="hljs-variable"><span class="hljs-variable">$bool</span></span> = <span class="hljs-string"><span class="hljs-string">"AND"</span></span>, <span class="hljs-variable"><span class="hljs-variable">$not</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-variable"><span class="hljs-variable">$start</span></span>, <span class="hljs-variable"><span class="hljs-variable">$end</span></span> ) <span class="hljs-variable"><span class="hljs-variable">$FilterIPRange</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"bool"</span></span>,<span class="hljs-variable"><span class="hljs-variable">$bool</span></span>) <span class="hljs-variable"><span class="hljs-variable">$FilterIPRange</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"not"</span></span>,<span class="hljs-variable"><span class="hljs-variable">$not</span></span>) <span class="hljs-variable"><span class="hljs-variable">$FilterIPRange</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"min"</span></span>,<span class="hljs-variable"><span class="hljs-variable">$start</span></span>) <span class="hljs-variable"><span class="hljs-variable">$FilterIPRange</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"max"</span></span>,<span class="hljs-variable"><span class="hljs-variable">$end</span></span>) }</code> </pre><br>  Les trois fonctions fonctionnent directement avec l'objet PS transféré et ne renvoient rien.  Remarque pour les perfectionnistes: au moment de l'écriture du script, c'était plus facile et plus rapide, je n'ai pas essayé d'écrire le code orienté objet parfait, j'avais juste besoin qu'il fonctionne.  Alors oui, le code a quelque chose à améliorer, mais surtout - ça marche! <br><br><h4>  2.3.  Et enfin, la boucle principale, l'ajout de commandes d'imprimante </h4><br>  Deux éléments sont créés pour chaque imprimante: un pour ajouter si l'utilisateur est dans un groupe <b>et</b> un sous-réseau et un pour supprimer une imprimante si l'utilisateur n'est pas membre du groupe <b>ou se</b> trouve sur un sous-réseau différent. <br><br>  Si, pour une raison quelconque, il n'y a pas d'UID d'imprimante dans le fichier CSV, il sera généré et affiché dans la console. <br><br>  Pour traduire le sous-réseau de la notation CIDR en plage d'adresses, j'ai emprunté la merveilleuse applet de commande <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PSipcalc</a> . <br><br><pre> <code class="hljs powershell"><span class="hljs-keyword"><span class="hljs-keyword">ForEach</span></span> (<span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-variable"><span class="hljs-variable">$PrintersCSV</span></span> | <span class="hljs-built_in"><span class="hljs-built_in">Sort-Object</span></span> Name)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.uid){ <span class="hljs-variable"><span class="hljs-variable">$uid</span></span> = <span class="hljs-string"><span class="hljs-string">"{"</span></span>+([<span class="hljs-type"><span class="hljs-type">guid</span></span>]::NewGuid()).Guid.ToUpper()+<span class="hljs-string"><span class="hljs-string">"}"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Write-Host</span></span> <span class="hljs-string"><span class="hljs-string">"Printer </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$</span></span></span><span class="hljs-string">(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$PrinterItem</span></span></span><span class="hljs-string">.Name) is new. Policy item ID: </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$uid</span></span></span><span class="hljs-string">"</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-variable"><span class="hljs-variable">$uid</span></span> = <span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.uid } <span class="hljs-variable"><span class="hljs-variable">$SharedPrinter</span></span> = <span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.CreateElement(<span class="hljs-string"><span class="hljs-string">"SharedPrinter"</span></span>) NewSharedPrinter <span class="hljs-literal"><span class="hljs-literal">-SharedPrinter</span></span> <span class="hljs-variable"><span class="hljs-variable">$SharedPrinter</span></span> <span class="hljs-literal"><span class="hljs-literal">-name</span></span> <span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.Name <span class="hljs-literal"><span class="hljs-literal">-action</span></span> <span class="hljs-string"><span class="hljs-string">"U"</span></span> <span class="hljs-literal"><span class="hljs-literal">-uid</span></span> <span class="hljs-variable"><span class="hljs-variable">$uid</span></span> <span class="hljs-variable"><span class="hljs-variable">$Filters</span></span> = <span class="hljs-variable"><span class="hljs-variable">$SharedPrinter</span></span>.AppendChild(<span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.CreateElement(<span class="hljs-string"><span class="hljs-string">"Filters"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.ByGroup <span class="hljs-operator"><span class="hljs-operator">-ieq</span></span> <span class="hljs-string"><span class="hljs-string">"yes"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">Get-ADGroup</span></span> <span class="hljs-literal"><span class="hljs-literal">-Identity</span></span> <span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.Name | <span class="hljs-built_in"><span class="hljs-built_in">Out-Null</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">Write-Host</span></span> <span class="hljs-string"><span class="hljs-string">"Creating group </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$</span></span></span><span class="hljs-string">(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$PrinterItem</span></span></span><span class="hljs-string">.Name)"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New-ADGroup</span></span> <span class="hljs-literal"><span class="hljs-literal">-Name</span></span> <span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.Name ` <span class="hljs-literal"><span class="hljs-literal">-Path</span></span> <span class="hljs-string"><span class="hljs-string">"OU=    ,OU=User Groups,DC=DOM,DC=COM"</span></span> <span class="hljs-literal"><span class="hljs-literal">-GroupScope</span></span> DomainLocal } <span class="hljs-variable"><span class="hljs-variable">$FilterGroup</span></span> = <span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.CreateElement(<span class="hljs-string"><span class="hljs-string">"FilterGroup"</span></span>) NewFilterGroup <span class="hljs-literal"><span class="hljs-literal">-FilterGroup</span></span> <span class="hljs-variable"><span class="hljs-variable">$FilterGroup</span></span> <span class="hljs-literal"><span class="hljs-literal">-name</span></span> <span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.Name <span class="hljs-literal"><span class="hljs-literal">-sid</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">Get-ADGroup</span></span> <span class="hljs-literal"><span class="hljs-literal">-Identity</span></span> <span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.Name).SID.Value <span class="hljs-variable"><span class="hljs-variable">$Filters</span></span>.AppendChild(<span class="hljs-variable"><span class="hljs-variable">$FilterGroup</span></span>) | <span class="hljs-built_in"><span class="hljs-built_in">Out-Null</span></span> } <span class="hljs-variable"><span class="hljs-variable">$FilterNetwork</span></span> = .\PSipcalc.ps1 <span class="hljs-literal"><span class="hljs-literal">-NetworkAddress</span></span> <span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.Subnet <span class="hljs-variable"><span class="hljs-variable">$FilterIPRange</span></span> = <span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.CreateElement(<span class="hljs-string"><span class="hljs-string">"FilterIpRange"</span></span>) NewFilterSubnet <span class="hljs-literal"><span class="hljs-literal">-FilterIPRange</span></span> <span class="hljs-variable"><span class="hljs-variable">$FilterIPRange</span></span> <span class="hljs-literal"><span class="hljs-literal">-start</span></span> <span class="hljs-variable"><span class="hljs-variable">$FilterNetwork</span></span>.HostMin <span class="hljs-literal"><span class="hljs-literal">-end</span></span> <span class="hljs-variable"><span class="hljs-variable">$FilterNetwork</span></span>.HostMax <span class="hljs-variable"><span class="hljs-variable">$Filters</span></span>.AppendChild(<span class="hljs-variable"><span class="hljs-variable">$FilterIPRange</span></span>) | <span class="hljs-built_in"><span class="hljs-built_in">Out-Null</span></span> <span class="hljs-variable"><span class="hljs-variable">$Printers</span></span>.AppendChild(<span class="hljs-variable"><span class="hljs-variable">$SharedPrinter</span></span>) | <span class="hljs-built_in"><span class="hljs-built_in">Out-Null</span></span> <span class="hljs-variable"><span class="hljs-variable">$RevertSharedPrinter</span></span> = <span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.CreateElement(<span class="hljs-string"><span class="hljs-string">"SharedPrinter"</span></span>) NewSharedPrinter <span class="hljs-literal"><span class="hljs-literal">-SharedPrinter</span></span> <span class="hljs-variable"><span class="hljs-variable">$RevertSharedPrinter</span></span> <span class="hljs-literal"><span class="hljs-literal">-name</span></span> <span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.Name <span class="hljs-literal"><span class="hljs-literal">-action</span></span> <span class="hljs-string"><span class="hljs-string">"D"</span></span> <span class="hljs-literal"><span class="hljs-literal">-uid</span></span> <span class="hljs-variable"><span class="hljs-variable">$uid</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.ByGroup <span class="hljs-operator"><span class="hljs-operator">-ieq</span></span> <span class="hljs-string"><span class="hljs-string">"yes"</span></span>) { <span class="hljs-variable"><span class="hljs-variable">$bool</span></span> = <span class="hljs-string"><span class="hljs-string">"OR"</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-variable"><span class="hljs-variable">$bool</span></span> = <span class="hljs-string"><span class="hljs-string">"AND"</span></span> } <span class="hljs-variable"><span class="hljs-variable">$Filters</span></span> = <span class="hljs-variable"><span class="hljs-variable">$RevertSharedPrinter</span></span>.AppendChild(<span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.CreateElement(<span class="hljs-string"><span class="hljs-string">"Filters"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.ByGroup <span class="hljs-operator"><span class="hljs-operator">-ieq</span></span> <span class="hljs-string"><span class="hljs-string">"yes"</span></span>) { <span class="hljs-variable"><span class="hljs-variable">$FilterGroup</span></span> = <span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.CreateElement(<span class="hljs-string"><span class="hljs-string">"FilterGroup"</span></span>) NewFilterGroup <span class="hljs-literal"><span class="hljs-literal">-FilterGroup</span></span> <span class="hljs-variable"><span class="hljs-variable">$FilterGroup</span></span> <span class="hljs-literal"><span class="hljs-literal">-name</span></span> <span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.Name <span class="hljs-literal"><span class="hljs-literal">-sid</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">Get-ADGroup</span></span> <span class="hljs-literal"><span class="hljs-literal">-Identity</span></span> <span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.Name).SID.Value <span class="hljs-literal"><span class="hljs-literal">-bool</span></span> <span class="hljs-string"><span class="hljs-string">"AND"</span></span> <span class="hljs-operator"><span class="hljs-operator">-not</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-variable"><span class="hljs-variable">$Filters</span></span>.AppendChild(<span class="hljs-variable"><span class="hljs-variable">$FilterGroup</span></span>) | <span class="hljs-built_in"><span class="hljs-built_in">Out-Null</span></span> } <span class="hljs-variable"><span class="hljs-variable">$FilterIPRange</span></span> = <span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.CreateElement(<span class="hljs-string"><span class="hljs-string">"FilterIpRange"</span></span>) NewFilterSubnet <span class="hljs-literal"><span class="hljs-literal">-FilterIPRange</span></span> <span class="hljs-variable"><span class="hljs-variable">$FilterIPRange</span></span> <span class="hljs-literal"><span class="hljs-literal">-start</span></span> <span class="hljs-variable"><span class="hljs-variable">$FilterNetwork</span></span>.HostMin <span class="hljs-literal"><span class="hljs-literal">-end</span></span> <span class="hljs-variable"><span class="hljs-variable">$FilterNetwork</span></span>.HostMax <span class="hljs-literal"><span class="hljs-literal">-bool</span></span> <span class="hljs-variable"><span class="hljs-variable">$bool</span></span> <span class="hljs-operator"><span class="hljs-operator">-not</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-variable"><span class="hljs-variable">$Filters</span></span>.AppendChild(<span class="hljs-variable"><span class="hljs-variable">$FilterIPRange</span></span>) | <span class="hljs-built_in"><span class="hljs-built_in">Out-Null</span></span> <span class="hljs-variable"><span class="hljs-variable">$Printers</span></span>.AppendChild(<span class="hljs-variable"><span class="hljs-variable">$RevertSharedPrinter</span></span>) | <span class="hljs-built_in"><span class="hljs-built_in">Out-Null</span></span> }</code> </pre><br><h4>  2.4.  Et maintenant, nous imprimons le résultat dans un fichier </h4><br>  Je ne vois rien de mal à économiser quelques minutes et à écrire immédiatement à la politique: <br><br><pre> <code class="hljs tex"><span class="hljs-formula"><span class="hljs-formula">$PrintersGPP.Save("</span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span></span><span class="hljs-formula">COMDOM</span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">SysVol</span></span></span></span></span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">COMMON</span></span></span></span></span><span class="hljs-formula">.DOMAIN</span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">Policies</span></span></span></span></span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">{</span></span></span></span></span><span class="hljs-formula">f985a9ae-cb71-468b-8a99-e2c7f428aa2f}</span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">User</span></span></span></span></span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">Preferences</span></span></span></span></span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">Printers</span></span></span></span></span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">Printers</span></span></span></span></span><span class="hljs-formula">.xml")</span></span></code> </pre> <br><h3>  3. Ajout d'imprimantes au serveur d'impression </h3><br>  Windows dispose d'un ensemble de scripts vbs assez peu connu pour la gestion des imprimantes.  De plus, c'est même dans les versions client.  Il se trouve dans le <code>%SystemRoot%\System32\Printing_Admin_Scripts\en-US</code> . Vous pouvez lire le Murzilka <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  Nous sommes intéressés par trois utilitaires de l'ensemble: <br><br>  <b>prnport.vbs</b> - pour créer un port d'imprimante sur le serveur d'impression <br>  <b>prnmngr.vbs</b> - pour créer l'imprimante elle-même <br>  <b>prncnfg.vbs</b> - pour configurer les paramètres et activer le partage d'imprimante <br>  Nous avons également besoin de l'utilitaire <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SetACL</a> pour définir les droits d'accès des imprimantes. <br><br><h4>  3.1.  Créer une imprimante sur le serveur d'impression </h4><br>  Pour ce faire, créez le script CreateRemotePrinter.bat. <br><br>  Comme arguments, il faudra, dans l'ordre: <br>  % 1 - Le nom de l'imprimante; <br>  % 2 - Le nom du pilote; <br>  % 3 - Emplacement <br>  % 4 - Description de l'imprimante. <br><br><pre> <code class="dos hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> PRTOOLS="c:\Windows\System32\Printing_Admin_Scripts\en-US" <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> SETACL="SetACL.exe" cscript /nologo <span class="hljs-variable"><span class="hljs-variable">%PRTOOLS%</span></span>\prnport.vbs -s <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>-cl-node-<span class="hljs-number"><span class="hljs-number">1</span></span> -a -r %<span class="hljs-number"><span class="hljs-number">1</span></span> -h %<span class="hljs-number"><span class="hljs-number">1</span></span>.common.domain -t -o raw -me cscript /nologo <span class="hljs-variable"><span class="hljs-variable">%PRTOOLS%</span></span>\prnmngr.vbs -s <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>-cl-node-<span class="hljs-number"><span class="hljs-number">1</span></span> -a -p %<span class="hljs-number"><span class="hljs-number">1</span></span> -m %<span class="hljs-number"><span class="hljs-number">2</span></span> -r %<span class="hljs-number"><span class="hljs-number">1</span></span> cscript /nologo <span class="hljs-variable"><span class="hljs-variable">%PRTOOLS%</span></span>\prncnfg.vbs -s <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>-cl-node-<span class="hljs-number"><span class="hljs-number">1</span></span> -t -p %<span class="hljs-number"><span class="hljs-number">1</span></span> -h %<span class="hljs-number"><span class="hljs-number">1</span></span> -l %<span class="hljs-number"><span class="hljs-number">3</span></span> -m %<span class="hljs-number"><span class="hljs-number">4</span></span> +shared <span class="hljs-variable"><span class="hljs-variable">%SETACL%</span></span> -on \\<span class="hljs-built_in"><span class="hljs-built_in">print</span></span>-cl-node-<span class="hljs-number"><span class="hljs-number">1</span></span>\%<span class="hljs-number"><span class="hljs-number">1</span></span> -ot <span class="hljs-built_in"><span class="hljs-built_in">prn</span></span> -actn ace -ace "n:STN-TN\%<span class="hljs-number"><span class="hljs-number">1</span></span>;p:man_docs,<span class="hljs-built_in"><span class="hljs-built_in">print</span></span>"</code> </pre><br>  Dans le cas général, cela suffit.  Mais notre serveur d'impression est situé sur le cluster MSCS, et l'ensemble de scripts vbs ci-dessus ne fonctionne pas avec les clusters.  Par conséquent, quelque chose d'autre doit être fait. <br><br><h4>  3.2.  Transfert d'une imprimante d'un serveur d'impression standard vers une imprimante en cluster </h4><br>  Lors de l'accès au cluster, les scripts de l'ensemble ci-dessus créent simplement un port et une imprimante sur le nœud actif actuel, et ils n'apparaissent pas sur le cluster.  Juste pour un tel cas, Microsoft a un autre outil en magasin - PrintBRM (Print queue Backup / Recovery / Migration).  Je n'ai pas trouvé de documentation officielle pour cela, donc je partage ce qui est: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Aide sur les paramètres sur SS64</a> . <br><br>  Poursuivre le script CreateRemotePrinter.bat. <br><br>  L'utilitaire PrintBRM peut copier correctement la configuration de l'imprimante avec les ports du cluster, mais si vous effectuez simplement une copie (commencez avec l'option -b) et restaurez (-r), il n'y aura pas de miracle. <br><br>  Alors maintenant, il y aura un peu de magie.  Il est décrit en détail <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sur le blog de l'équipe MS Performance</a> . <br>  Tout d'abord, nous sauvegardons l'imprimante dans le fichier temp.printerexport. <br><br>  Ensuite, nous décompressons le sous-répertoire printerexport, supprimons les répertoires LMONS et PRTPROCS, et supprimons également le contenu de plusieurs fichiers XML.  Je n'entrerai pas dans les détails, mais ces fichiers contiennent une configuration spécifique à un serveur spécifique et interfèrent avec la récupération de l'imprimante vers un autre serveur, en particulier un cluster. <br><br>  Après cela, nous replaçons la configuration modifiée dans le fichier temp.printerexport et la téléchargeons dans le cluster: <br><br><pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> PRNBRM="C:\Windows\System32\spool\tools\PrintBrm.exe" <span class="hljs-variable"><span class="hljs-variable">%PRNBRM%</span></span> -b -nobin -s <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>-cl-node-<span class="hljs-number"><span class="hljs-number">1</span></span> -f temp.printerexport <span class="hljs-variable"><span class="hljs-variable">%PRNBRM%</span></span> -r -d printerexport -f temp.printerexport <span class="hljs-built_in"><span class="hljs-built_in">del</span></span> /f /q temp.printerexport <span class="hljs-built_in"><span class="hljs-built_in">del</span></span> /s /f /q printerexport\LMONS printerexport\PRTPROCS <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ^&lt;SpoolerAttrib /^&gt; &gt; printerexport\BrmSpoolerAttrib.xml <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ^&lt;PPROCS /^&gt; &gt; printerexport\PProcs.xml <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ^&lt;PRINTERDRIVERS /^&gt; &gt; printerexport\BrmDrivers.xml <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ^&lt;LMONS Arch="Windows x64"/^&gt; &gt; printerexport\BRMLMons.xml <span class="hljs-variable"><span class="hljs-variable">%PRNBRM%</span></span> -b -d printerexport -f temp.printerexport <span class="hljs-built_in"><span class="hljs-built_in">del</span></span> /s /f /q printerexport <span class="hljs-variable"><span class="hljs-variable">%PRNBRM%</span></span> -r -s <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>-cluster-<span class="hljs-number"><span class="hljs-number">1</span></span> -f temp.printerexport -p all -o force <span class="hljs-built_in"><span class="hljs-built_in">del</span></span> /f /q temp.printerexport cscript /nologo <span class="hljs-variable"><span class="hljs-variable">%PRTOOLS%</span></span>\prnmngr.vbs -s <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>-cl-node-<span class="hljs-number"><span class="hljs-number">1</span></span> -d -p %<span class="hljs-number"><span class="hljs-number">1</span></span> cscript /nologo <span class="hljs-variable"><span class="hljs-variable">%PRTOOLS%</span></span>\prnport.vbs -s <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>-cl-node-<span class="hljs-number"><span class="hljs-number">1</span></span> -d -r %<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre><br><h4>  3.3.  Ajouter des imprimantes simultanément au GPP et au serveur / cluster </h4><br>  Vous devez maintenant intégrer ce script de manière transparente dans la liste d'imprimantes CSV. <br><br>  Ajoutez avant la boucle principale une demande de liste des existants sur le serveur: <br><br><pre> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$ActualPrintersList</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">Get-WmiObject</span></span> <span class="hljs-literal"><span class="hljs-literal">-Class</span></span> win32_share <span class="hljs-literal"><span class="hljs-literal">-computer</span></span> print<span class="hljs-literal"><span class="hljs-literal">-cluster</span></span><span class="hljs-literal"><span class="hljs-literal">-1</span></span> | <span class="hljs-built_in"><span class="hljs-built_in">Where-Object</span></span> Name <span class="hljs-operator"><span class="hljs-operator">-like</span></span> <span class="hljs-string"><span class="hljs-string">"*PRN*"</span></span> | <span class="hljs-built_in"><span class="hljs-built_in">Select-Object</span></span> <span class="hljs-literal"><span class="hljs-literal">-ExpandProperty</span></span> Name</code> </pre><br>  Et dans le corps de la boucle, exécutez notre Bat-surnom: <br><br><pre> <code class="hljs powershell"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-string"><span class="hljs-string">"\\print-cluster-1\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$</span></span></span><span class="hljs-string">(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$PrinterItem</span></span></span><span class="hljs-string">.Name)"</span></span> <span class="hljs-operator"><span class="hljs-operator">-NotIn</span></span> <span class="hljs-variable"><span class="hljs-variable">$ActualPrintersList</span></span>) { <span class="hljs-built_in"><span class="hljs-built_in">Write-Host</span></span> <span class="hljs-string"><span class="hljs-string">"Adding printer </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$</span></span></span><span class="hljs-string">(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$PrinterItem</span></span></span><span class="hljs-string">.Name) to print-cluster-1..."</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Start-Process</span></span> <span class="hljs-literal"><span class="hljs-literal">-FilePath</span></span> .\CreateRemotePrinter.bat <span class="hljs-literal"><span class="hljs-literal">-ArgumentList</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$</span></span></span><span class="hljs-string">(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$PrinterItem</span></span></span><span class="hljs-string">.Name) `"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$</span></span></span><span class="hljs-string">(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$PrinterItem</span></span></span><span class="hljs-string">.Driver)`" `"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$</span></span></span><span class="hljs-string">(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$PrinterItem</span></span></span><span class="hljs-string">.Location)`" `"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$</span></span></span><span class="hljs-string">(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$PrinterItem</span></span></span><span class="hljs-string">.Type)`""</span></span> <span class="hljs-literal"><span class="hljs-literal">-Wait</span></span> }</code> </pre><br><h3>  4. Tout mettre ensemble, le lancer, obtenir le résultat </h3><br><div class="spoiler">  <b class="spoiler_title">Données source en CSV</b> <div class="spoiler_text"> <code>Name;ByGroup;Subnet;Location;Driver;Type;Model;uid <br> PRN-NALTA-028;yes;192.168.192.0/24;/;HP Universal Printing PCL 6 (v5.6.0); 4  — HP LaserJet Pro M425dn;HP LaserJet Pro M425dn;{35F6CF36-2A24-4A81-B061-8BE71CEC27EA} <br> PRN-TARUS-002;yes;192.168.128.0/23;/;HP Universal Printing PCL 6 (v5.6.0); 4  — HP LaserJet M3027 MFP;HP LaserJet M3027 MFP;{398F4A94-530C-4E3B-8A30-4288D5E8854D} <br> PRN-KIRILL-081;;192.168.196.0/24;/;HP Universal Printing PCL 6 (v5.6.0); 4  — HP LaserJet 3390;HP LaserJet 3390;{421FC2DE-2E97-49FC-AEB0-3070B0166AD5} <br> PRN-BARAB-061;yes;192.168.142.0/24;/;HP Universal Printing PCL 6 (v5.6.0); 4  — HP LaserJet Pro M425dn;HP LaserJet Pro M425dn;{43231EA0-A4A3-4F1A-8A25-95BC4FEFBCC6} <br> PRN-PYSHM-004;;192.168.143.0/24; /;KX DRIVER for Universal Printing; 4  — Kyocera ECOSYS M2540dn;Kyocera ECOSYS M2540dn;{45509B48-E7BC-4497-9665-86D4E1E96FE1} <br> PRN-BUY---001;yes;192.168.44.0/24;/;HP Universal Printing PCL 6 (v5.6.0); 4  — HP LaserJet Pro M402dn;HP LaserJet Pro M402dn;{457DB3FE-E35F-450E-B1D6-912F0D831573} <br> PRN-BATAY-042;yes;192.168.128.0/23;/;HP Universal Printing PCL 6 (v5.6.0); 4  — HP LaserJet P2015 Series;HP LaserJet P2015 Series;{4740604B-C403-4511-91B0-689A197260F3} <br> PRN-EMPTY-002;yes;192.168.199.0/24;/;HP Universal Printing PCL 6 (v5.6.0); 4  — HP LaserJet Pro M425dn;HP LaserJet Pro M425dn;{475578CB-689F-463B-9710-AE207973146C} <br> PRN-LIPKI-003;;192.168.44.0/24;/;KX DRIVER for Universal Printing; 4  — Kyocera ECOSYS M2540dn;Kyocera ECOSYS M2540dn;{4794D22E-6586-4A81-A85D-A21FB8B209CF} <br> PRN-KOTOV-013;yes;192.168.128.0/23;/;HP Universal Printing PCL 6 (v5.6.0); 4  — HP LaserJet Pro M425dn;HP LaserJet Pro M425dn;{4DFFBA1F-48D2-4824-B2EB-0AAD12B6A9D6} <br> PRN-ELAB-064;;192.168.140.0/24;/;HP Universal Printing PCL 6 (v5.6.0); 4  — HP LaserJet Pro M425dn;HP LaserJet Pro M425dn;{52069D45-EF86-442D-A157-368D7510A1CF} <br></code> </div></div><div class="spoiler">  <b class="spoiler_title">PSipcalc.ps1</b> <div class="spoiler_text">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://www.powershelladmin.com/w/images/4/4e/PSipcalc.ps1.txt</a> </div></div><div class="spoiler">  <b class="spoiler_title">GeneratePrintersXml.ps1</b> <div class="spoiler_text"><pre> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$PrintersCSV</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">Import-Csv</span></span> <span class="hljs-literal"><span class="hljs-literal">-Delimiter</span></span> <span class="hljs-string"><span class="hljs-string">";"</span></span> <span class="hljs-string"><span class="hljs-string">".\Printers.csv"</span></span> <span class="hljs-literal"><span class="hljs-literal">-Encoding</span></span> Default <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">System.Xml.XmlDocument</span></span></span><span class="hljs-function">]$</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PrintersGPP</span></span></span></span> = <span class="hljs-built_in"><span class="hljs-built_in">New-Object</span></span> System.Xml.XmlDocument <span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.PrependChild(<span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.CreateXmlDeclaration(<span class="hljs-string"><span class="hljs-string">"1.0"</span></span>, <span class="hljs-string"><span class="hljs-string">"utf-8"</span></span>, <span class="hljs-variable"><span class="hljs-variable">$null</span></span>)) | <span class="hljs-built_in"><span class="hljs-built_in">Out-Null</span></span> <span class="hljs-variable"><span class="hljs-variable">$Printers</span></span> = <span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.AppendChild(<span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.CreateElement(<span class="hljs-string"><span class="hljs-string">"Printers"</span></span>)) <span class="hljs-variable"><span class="hljs-variable">$Printers</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"clsid"</span></span>,<span class="hljs-string"><span class="hljs-string">"{1F577D12-3D1B-471e-A1B7-060317597B9C}"</span></span>) <span class="hljs-variable"><span class="hljs-variable">$DelPrinters</span></span> = <span class="hljs-variable"><span class="hljs-variable">$Printers</span></span>.AppendChild(<span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.CreateElement(<span class="hljs-string"><span class="hljs-string">"SharedPrinter"</span></span>)) NewSharedPrinter <span class="hljs-literal"><span class="hljs-literal">-SharedPrinter</span></span> <span class="hljs-variable"><span class="hljs-variable">$DelPrinters</span></span> <span class="hljs-literal"><span class="hljs-literal">-name</span></span> <span class="hljs-string"><span class="hljs-string">"Delete All"</span></span> <span class="hljs-literal"><span class="hljs-literal">-action</span></span> <span class="hljs-string"><span class="hljs-string">"D"</span></span> <span class="hljs-literal"><span class="hljs-literal">-uid</span></span> <span class="hljs-string"><span class="hljs-string">"{21097DBD-285D-48C3-B042-7746D7E6DA1B}"</span></span> <span class="hljs-variable"><span class="hljs-variable">$Filters</span></span> = <span class="hljs-variable"><span class="hljs-variable">$DelPrinters</span></span>.AppendChild(<span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.CreateElement(<span class="hljs-string"><span class="hljs-string">"Filters"</span></span>)) <span class="hljs-variable"><span class="hljs-variable">$FilterRunOnce</span></span> = <span class="hljs-variable"><span class="hljs-variable">$Filters</span></span>.AppendChild(<span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.CreateElement(<span class="hljs-string"><span class="hljs-string">"FilterRunOnce"</span></span>)) <span class="hljs-variable"><span class="hljs-variable">$FilterRunOnce</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"id"</span></span>,<span class="hljs-string"><span class="hljs-string">"{F2537B78-C7D7-43DF-98D6-B32E90644825}"</span></span>) <span class="hljs-variable"><span class="hljs-variable">$FilterRunOnce</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"hidden"</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-variable"><span class="hljs-variable">$FilterRunOnce</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"not"</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-variable"><span class="hljs-variable">$FilterRunOnce</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"bool"</span></span>,<span class="hljs-string"><span class="hljs-string">"AND"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">Function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NewSharedPrinter</span></span></span></span> { <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">CmdletBinding</span></span></span><span class="hljs-function">()] </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">param</span></span></span></span> ( <span class="hljs-variable"><span class="hljs-variable">$SharedPrinter</span></span>, <span class="hljs-variable"><span class="hljs-variable">$clsid</span></span> = <span class="hljs-string"><span class="hljs-string">"{9A5E9697-9095-436d-A0EE-4D128FDFBCE5}"</span></span>, <span class="hljs-variable"><span class="hljs-variable">$uid</span></span>, <span class="hljs-variable"><span class="hljs-variable">$name</span></span>, <span class="hljs-variable"><span class="hljs-variable">$action</span></span> ) <span class="hljs-variable"><span class="hljs-variable">$image</span></span> <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (<span class="hljs-variable"><span class="hljs-variable">$action</span></span>){ <span class="hljs-string"><span class="hljs-string">"C"</span></span> {<span class="hljs-variable"><span class="hljs-variable">$image</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>} <span class="hljs-string"><span class="hljs-string">"R"</span></span> {<span class="hljs-variable"><span class="hljs-variable">$image</span></span> = <span class="hljs-number"><span class="hljs-number">1</span></span>} <span class="hljs-string"><span class="hljs-string">"U"</span></span> {<span class="hljs-variable"><span class="hljs-variable">$image</span></span> = <span class="hljs-number"><span class="hljs-number">2</span></span>} <span class="hljs-string"><span class="hljs-string">"D"</span></span> {<span class="hljs-variable"><span class="hljs-variable">$image</span></span> = <span class="hljs-number"><span class="hljs-number">3</span></span>} } <span class="hljs-variable"><span class="hljs-variable">$SharedPrinter</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"clsid"</span></span>,<span class="hljs-variable"><span class="hljs-variable">$clsid</span></span>) <span class="hljs-variable"><span class="hljs-variable">$SharedPrinter</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"name"</span></span>,<span class="hljs-variable"><span class="hljs-variable">$name</span></span>) <span class="hljs-variable"><span class="hljs-variable">$SharedPrinter</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"status"</span></span>,<span class="hljs-variable"><span class="hljs-variable">$name</span></span>) <span class="hljs-variable"><span class="hljs-variable">$SharedPrinter</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"image"</span></span>,<span class="hljs-variable"><span class="hljs-variable">$image</span></span>) <span class="hljs-variable"><span class="hljs-variable">$SharedPrinter</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"uid"</span></span>,<span class="hljs-variable"><span class="hljs-variable">$uid</span></span>) <span class="hljs-variable"><span class="hljs-variable">$SharedPrinter</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"userContext"</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-variable"><span class="hljs-variable">$SharedPrinter</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"bypassErrors"</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-variable"><span class="hljs-variable">$SharedPrinterProperties</span></span> = <span class="hljs-variable"><span class="hljs-variable">$SharedPrinter</span></span>.AppendChild(<span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.CreateElement(<span class="hljs-string"><span class="hljs-string">"Properties"</span></span>)) <span class="hljs-variable"><span class="hljs-variable">$SharedPrinterProperties</span></span>.setattribute(<span class="hljs-string"><span class="hljs-string">"action"</span></span>,<span class="hljs-variable"><span class="hljs-variable">$action</span></span>) <span class="hljs-variable"><span class="hljs-variable">$SharedPrinterProperties</span></span>.setattribute(<span class="hljs-string"><span class="hljs-string">"comment"</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>) <span class="hljs-variable"><span class="hljs-variable">$SharedPrinterProperties</span></span>.setattribute(<span class="hljs-string"><span class="hljs-string">"path"</span></span>,<span class="hljs-string"><span class="hljs-string">"\\print-cluster-1.common.domain\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$name</span></span></span><span class="hljs-string">"</span></span>) <span class="hljs-variable"><span class="hljs-variable">$SharedPrinterProperties</span></span>.setattribute(<span class="hljs-string"><span class="hljs-string">"default"</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-variable"><span class="hljs-variable">$SharedPrinterProperties</span></span>.setattribute(<span class="hljs-string"><span class="hljs-string">"port"</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">Function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NewFilterGroup</span></span></span></span>{ <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">CmdletBinding</span></span></span><span class="hljs-function">()] </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">param</span></span></span></span> ( <span class="hljs-variable"><span class="hljs-variable">$FilterGroup</span></span>, <span class="hljs-variable"><span class="hljs-variable">$bool</span></span> = <span class="hljs-string"><span class="hljs-string">"AND"</span></span>, <span class="hljs-variable"><span class="hljs-variable">$not</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-variable"><span class="hljs-variable">$name</span></span>, <span class="hljs-variable"><span class="hljs-variable">$sid</span></span> ) <span class="hljs-variable"><span class="hljs-variable">$FilterGroup</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"bool"</span></span>,<span class="hljs-variable"><span class="hljs-variable">$bool</span></span>) <span class="hljs-variable"><span class="hljs-variable">$FilterGroup</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"not"</span></span>,<span class="hljs-variable"><span class="hljs-variable">$not</span></span>) <span class="hljs-variable"><span class="hljs-variable">$FilterGroup</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"name"</span></span>,<span class="hljs-string"><span class="hljs-string">"COMDOM\"</span></span>+<span class="hljs-variable"><span class="hljs-variable">$name</span></span>) <span class="hljs-variable"><span class="hljs-variable">$FilterGroup</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"sid"</span></span>,<span class="hljs-variable"><span class="hljs-variable">$sid</span></span>) <span class="hljs-variable"><span class="hljs-variable">$FilterGroup</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"userContext"</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">Function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NewFilterSubnet</span></span></span></span>{ <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">CmdletBinding</span></span></span><span class="hljs-function">()] </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">param</span></span></span></span> ( <span class="hljs-variable"><span class="hljs-variable">$FilterIPRange</span></span>, <span class="hljs-variable"><span class="hljs-variable">$bool</span></span> = <span class="hljs-string"><span class="hljs-string">"AND"</span></span>, <span class="hljs-variable"><span class="hljs-variable">$not</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-variable"><span class="hljs-variable">$start</span></span>, <span class="hljs-variable"><span class="hljs-variable">$end</span></span> ) <span class="hljs-variable"><span class="hljs-variable">$FilterIPRange</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"bool"</span></span>,<span class="hljs-variable"><span class="hljs-variable">$bool</span></span>) <span class="hljs-variable"><span class="hljs-variable">$FilterIPRange</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"not"</span></span>,<span class="hljs-variable"><span class="hljs-variable">$not</span></span>) <span class="hljs-variable"><span class="hljs-variable">$FilterIPRange</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"min"</span></span>,<span class="hljs-variable"><span class="hljs-variable">$start</span></span>) <span class="hljs-variable"><span class="hljs-variable">$FilterIPRange</span></span>.SetAttribute(<span class="hljs-string"><span class="hljs-string">"max"</span></span>,<span class="hljs-variable"><span class="hljs-variable">$end</span></span>) } <span class="hljs-variable"><span class="hljs-variable">$ActualPrintersList</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">Get-WmiObject</span></span> <span class="hljs-literal"><span class="hljs-literal">-Class</span></span> win32_share <span class="hljs-literal"><span class="hljs-literal">-computer</span></span> print<span class="hljs-literal"><span class="hljs-literal">-cluster</span></span><span class="hljs-literal"><span class="hljs-literal">-1</span></span> | <span class="hljs-built_in"><span class="hljs-built_in">Where-Object</span></span> Name <span class="hljs-operator"><span class="hljs-operator">-like</span></span> <span class="hljs-string"><span class="hljs-string">"*PRN*"</span></span> | <span class="hljs-built_in"><span class="hljs-built_in">Select-Object</span></span> <span class="hljs-literal"><span class="hljs-literal">-ExpandProperty</span></span> Name <span class="hljs-keyword"><span class="hljs-keyword">ForEach</span></span> (<span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-variable"><span class="hljs-variable">$PrintersCSV</span></span> | <span class="hljs-built_in"><span class="hljs-built_in">Sort-Object</span></span> Name)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.uid){ <span class="hljs-variable"><span class="hljs-variable">$uid</span></span> = <span class="hljs-string"><span class="hljs-string">"{"</span></span>+([<span class="hljs-type"><span class="hljs-type">guid</span></span>]::NewGuid()).Guid.ToUpper()+<span class="hljs-string"><span class="hljs-string">"}"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Write-Host</span></span> <span class="hljs-string"><span class="hljs-string">"Printer </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$</span></span></span><span class="hljs-string">(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$PrinterItem</span></span></span><span class="hljs-string">.Name) is new. Policy item ID: </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$uid</span></span></span><span class="hljs-string">"</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-variable"><span class="hljs-variable">$uid</span></span> = <span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.uid } <span class="hljs-variable"><span class="hljs-variable">$SharedPrinter</span></span> = <span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.CreateElement(<span class="hljs-string"><span class="hljs-string">"SharedPrinter"</span></span>) NewSharedPrinter <span class="hljs-literal"><span class="hljs-literal">-SharedPrinter</span></span> <span class="hljs-variable"><span class="hljs-variable">$SharedPrinter</span></span> <span class="hljs-literal"><span class="hljs-literal">-name</span></span> <span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.Name <span class="hljs-literal"><span class="hljs-literal">-action</span></span> <span class="hljs-string"><span class="hljs-string">"U"</span></span> <span class="hljs-literal"><span class="hljs-literal">-uid</span></span> <span class="hljs-variable"><span class="hljs-variable">$uid</span></span> <span class="hljs-variable"><span class="hljs-variable">$Filters</span></span> = <span class="hljs-variable"><span class="hljs-variable">$SharedPrinter</span></span>.AppendChild(<span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.CreateElement(<span class="hljs-string"><span class="hljs-string">"Filters"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.ByGroup <span class="hljs-operator"><span class="hljs-operator">-ieq</span></span> <span class="hljs-string"><span class="hljs-string">"yes"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">Get-ADGroup</span></span> <span class="hljs-literal"><span class="hljs-literal">-Identity</span></span> <span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.Name | <span class="hljs-built_in"><span class="hljs-built_in">Out-Null</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">Write-Host</span></span> <span class="hljs-string"><span class="hljs-string">"Creating group </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$</span></span></span><span class="hljs-string">(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$PrinterItem</span></span></span><span class="hljs-string">.Name)"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New-ADGroup</span></span> <span class="hljs-literal"><span class="hljs-literal">-Name</span></span> <span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.Name ` <span class="hljs-literal"><span class="hljs-literal">-Path</span></span> <span class="hljs-string"><span class="hljs-string">"OU=    ,OU=User Groups,DC=DOM,DC=COM"</span></span> <span class="hljs-literal"><span class="hljs-literal">-GroupScope</span></span> DomainLocal } <span class="hljs-variable"><span class="hljs-variable">$FilterGroup</span></span> = <span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.CreateElement(<span class="hljs-string"><span class="hljs-string">"FilterGroup"</span></span>) NewFilterGroup <span class="hljs-literal"><span class="hljs-literal">-FilterGroup</span></span> <span class="hljs-variable"><span class="hljs-variable">$FilterGroup</span></span> <span class="hljs-literal"><span class="hljs-literal">-name</span></span> <span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.Name <span class="hljs-literal"><span class="hljs-literal">-sid</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">Get-ADGroup</span></span> <span class="hljs-literal"><span class="hljs-literal">-Identity</span></span> <span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.Name).SID.Value <span class="hljs-variable"><span class="hljs-variable">$Filters</span></span>.AppendChild(<span class="hljs-variable"><span class="hljs-variable">$FilterGroup</span></span>) | <span class="hljs-built_in"><span class="hljs-built_in">Out-Null</span></span> } <span class="hljs-variable"><span class="hljs-variable">$FilterNetwork</span></span> = .\PSipcalc.ps1 <span class="hljs-literal"><span class="hljs-literal">-NetworkAddress</span></span> <span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.Subnet <span class="hljs-variable"><span class="hljs-variable">$FilterIPRange</span></span> = <span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.CreateElement(<span class="hljs-string"><span class="hljs-string">"FilterIpRange"</span></span>) NewFilterSubnet <span class="hljs-literal"><span class="hljs-literal">-FilterIPRange</span></span> <span class="hljs-variable"><span class="hljs-variable">$FilterIPRange</span></span> <span class="hljs-literal"><span class="hljs-literal">-start</span></span> <span class="hljs-variable"><span class="hljs-variable">$FilterNetwork</span></span>.HostMin <span class="hljs-literal"><span class="hljs-literal">-end</span></span> <span class="hljs-variable"><span class="hljs-variable">$FilterNetwork</span></span>.HostMax <span class="hljs-variable"><span class="hljs-variable">$Filters</span></span>.AppendChild(<span class="hljs-variable"><span class="hljs-variable">$FilterIPRange</span></span>) | <span class="hljs-built_in"><span class="hljs-built_in">Out-Null</span></span> <span class="hljs-variable"><span class="hljs-variable">$Printers</span></span>.AppendChild(<span class="hljs-variable"><span class="hljs-variable">$SharedPrinter</span></span>) | <span class="hljs-built_in"><span class="hljs-built_in">Out-Null</span></span> <span class="hljs-variable"><span class="hljs-variable">$RevertSharedPrinter</span></span> = <span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.CreateElement(<span class="hljs-string"><span class="hljs-string">"SharedPrinter"</span></span>) NewSharedPrinter <span class="hljs-literal"><span class="hljs-literal">-SharedPrinter</span></span> <span class="hljs-variable"><span class="hljs-variable">$RevertSharedPrinter</span></span> <span class="hljs-literal"><span class="hljs-literal">-name</span></span> <span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.Name <span class="hljs-literal"><span class="hljs-literal">-action</span></span> <span class="hljs-string"><span class="hljs-string">"D"</span></span> <span class="hljs-literal"><span class="hljs-literal">-uid</span></span> <span class="hljs-variable"><span class="hljs-variable">$uid</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.ByGroup <span class="hljs-operator"><span class="hljs-operator">-ieq</span></span> <span class="hljs-string"><span class="hljs-string">"yes"</span></span>) { <span class="hljs-variable"><span class="hljs-variable">$bool</span></span> = <span class="hljs-string"><span class="hljs-string">"OR"</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-variable"><span class="hljs-variable">$bool</span></span> = <span class="hljs-string"><span class="hljs-string">"AND"</span></span> } <span class="hljs-variable"><span class="hljs-variable">$Filters</span></span> = <span class="hljs-variable"><span class="hljs-variable">$RevertSharedPrinter</span></span>.AppendChild(<span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.CreateElement(<span class="hljs-string"><span class="hljs-string">"Filters"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.ByGroup <span class="hljs-operator"><span class="hljs-operator">-ieq</span></span> <span class="hljs-string"><span class="hljs-string">"yes"</span></span>) { <span class="hljs-variable"><span class="hljs-variable">$FilterGroup</span></span> = <span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.CreateElement(<span class="hljs-string"><span class="hljs-string">"FilterGroup"</span></span>) NewFilterGroup <span class="hljs-literal"><span class="hljs-literal">-FilterGroup</span></span> <span class="hljs-variable"><span class="hljs-variable">$FilterGroup</span></span> <span class="hljs-literal"><span class="hljs-literal">-name</span></span> <span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.Name <span class="hljs-literal"><span class="hljs-literal">-sid</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">Get-ADGroup</span></span> <span class="hljs-literal"><span class="hljs-literal">-Identity</span></span> <span class="hljs-variable"><span class="hljs-variable">$PrinterItem</span></span>.Name).SID.Value <span class="hljs-literal"><span class="hljs-literal">-bool</span></span> <span class="hljs-string"><span class="hljs-string">"AND"</span></span> <span class="hljs-operator"><span class="hljs-operator">-not</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-variable"><span class="hljs-variable">$Filters</span></span>.AppendChild(<span class="hljs-variable"><span class="hljs-variable">$FilterGroup</span></span>) | <span class="hljs-built_in"><span class="hljs-built_in">Out-Null</span></span> } <span class="hljs-variable"><span class="hljs-variable">$FilterIPRange</span></span> = <span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.CreateElement(<span class="hljs-string"><span class="hljs-string">"FilterIpRange"</span></span>) NewFilterSubnet <span class="hljs-literal"><span class="hljs-literal">-FilterIPRange</span></span> <span class="hljs-variable"><span class="hljs-variable">$FilterIPRange</span></span> <span class="hljs-literal"><span class="hljs-literal">-start</span></span> <span class="hljs-variable"><span class="hljs-variable">$FilterNetwork</span></span>.HostMin <span class="hljs-literal"><span class="hljs-literal">-end</span></span> <span class="hljs-variable"><span class="hljs-variable">$FilterNetwork</span></span>.HostMax <span class="hljs-literal"><span class="hljs-literal">-bool</span></span> <span class="hljs-variable"><span class="hljs-variable">$bool</span></span> <span class="hljs-operator"><span class="hljs-operator">-not</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-variable"><span class="hljs-variable">$Filters</span></span>.AppendChild(<span class="hljs-variable"><span class="hljs-variable">$FilterIPRange</span></span>) | <span class="hljs-built_in"><span class="hljs-built_in">Out-Null</span></span> <span class="hljs-variable"><span class="hljs-variable">$Printers</span></span>.AppendChild(<span class="hljs-variable"><span class="hljs-variable">$RevertSharedPrinter</span></span>) | <span class="hljs-built_in"><span class="hljs-built_in">Out-Null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-string"><span class="hljs-string">"\\print-cluster-1\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$</span></span></span><span class="hljs-string">(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$PrinterItem</span></span></span><span class="hljs-string">.Name)"</span></span> <span class="hljs-operator"><span class="hljs-operator">-NotIn</span></span> <span class="hljs-variable"><span class="hljs-variable">$ActualPrintersList</span></span>) { <span class="hljs-built_in"><span class="hljs-built_in">Write-Host</span></span> <span class="hljs-string"><span class="hljs-string">"Adding printer </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$</span></span></span><span class="hljs-string">(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$PrinterItem</span></span></span><span class="hljs-string">.Name) to print-cluster-1..."</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Start-Process</span></span> <span class="hljs-literal"><span class="hljs-literal">-FilePath</span></span> .\CreateRemotePrinter.bat <span class="hljs-literal"><span class="hljs-literal">-ArgumentList</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$</span></span></span><span class="hljs-string">(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$PrinterItem</span></span></span><span class="hljs-string">.Name) `"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$</span></span></span><span class="hljs-string">(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$PrinterItem</span></span></span><span class="hljs-string">.Driver)`" `"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$</span></span></span><span class="hljs-string">(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$PrinterItem</span></span></span><span class="hljs-string">.Location)`" `"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$</span></span></span><span class="hljs-string">(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$PrinterItem</span></span></span><span class="hljs-string">.Type)`""</span></span> <span class="hljs-literal"><span class="hljs-literal">-Wait</span></span> } } <span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.Save(<span class="hljs-string"><span class="hljs-string">"\\COMDOM\SysVol\COMMON.DOMAIN\Policies\{f985a9ae-cb71-468b-8a99-e2c7f428aa2f}\User\Preferences\Printers\Printers.xml"</span></span>) <span class="hljs-variable"><span class="hljs-variable">$PrintersGPP</span></span>.Save(<span class="hljs-string"><span class="hljs-string">".\Printers.xml"</span></span>)</code> </pre> </div></div><div class="spoiler">  <b class="spoiler_title">CreateRemotePrinter.bat</b> <div class="spoiler_text"><pre> <code class="dos hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> PRTOOLS="c:\Windows\System32\Printing_Admin_Scripts\en-US" <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> SETACL="SetACL.exe" <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> PRNBRM="C:\Windows\System32\spool\tools\PrintBrm.exe" cscript /nologo <span class="hljs-variable"><span class="hljs-variable">%PRTOOLS%</span></span>\prnport.vbs -s <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>-cl-node-<span class="hljs-number"><span class="hljs-number">1</span></span> -a -r %<span class="hljs-number"><span class="hljs-number">1</span></span> -h %<span class="hljs-number"><span class="hljs-number">1</span></span>.common.domain -t -o raw -me cscript /nologo <span class="hljs-variable"><span class="hljs-variable">%PRTOOLS%</span></span>\prnmngr.vbs -s <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>-cl-node-<span class="hljs-number"><span class="hljs-number">1</span></span> -a -p %<span class="hljs-number"><span class="hljs-number">1</span></span> -m %<span class="hljs-number"><span class="hljs-number">2</span></span> -r %<span class="hljs-number"><span class="hljs-number">1</span></span> cscript /nologo <span class="hljs-variable"><span class="hljs-variable">%PRTOOLS%</span></span>\prncnfg.vbs -s <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>-cl-node-<span class="hljs-number"><span class="hljs-number">1</span></span> -t -p %<span class="hljs-number"><span class="hljs-number">1</span></span> -h %<span class="hljs-number"><span class="hljs-number">1</span></span> -l %<span class="hljs-number"><span class="hljs-number">3</span></span> -m %<span class="hljs-number"><span class="hljs-number">4</span></span> +shared <span class="hljs-variable"><span class="hljs-variable">%SETACL%</span></span> -on \\<span class="hljs-built_in"><span class="hljs-built_in">print</span></span>-cl-node-<span class="hljs-number"><span class="hljs-number">1</span></span>\%<span class="hljs-number"><span class="hljs-number">1</span></span> -ot <span class="hljs-built_in"><span class="hljs-built_in">prn</span></span> -actn ace -ace "n:STN-TN\%<span class="hljs-number"><span class="hljs-number">1</span></span>;p:man_docs,<span class="hljs-built_in"><span class="hljs-built_in">print</span></span>" <span class="hljs-variable"><span class="hljs-variable">%PRNBRM%</span></span> -b -nobin -s <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>-cl-node-<span class="hljs-number"><span class="hljs-number">1</span></span> -f temp.printerexport <span class="hljs-variable"><span class="hljs-variable">%PRNBRM%</span></span> -r -d printerexport -f temp.printerexport <span class="hljs-built_in"><span class="hljs-built_in">del</span></span> /f /q temp.printerexport <span class="hljs-built_in"><span class="hljs-built_in">del</span></span> /s /f /q printerexport\LMONS printerexport\PRTPROCS <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ^&lt;SpoolerAttrib /^&gt; &gt; printerexport\BrmSpoolerAttrib.xml <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ^&lt;PPROCS /^&gt; &gt; printerexport\PProcs.xml <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ^&lt;PRINTERDRIVERS /^&gt; &gt; printerexport\BrmDrivers.xml <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ^&lt;LMONS Arch="Windows x64"/^&gt; &gt; printerexport\BRMLMons.xml <span class="hljs-variable"><span class="hljs-variable">%PRNBRM%</span></span> -b -d printerexport -f temp.printerexport <span class="hljs-built_in"><span class="hljs-built_in">del</span></span> /s /f /q printerexport <span class="hljs-variable"><span class="hljs-variable">%PRNBRM%</span></span> -r -s <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>-cluster-<span class="hljs-number"><span class="hljs-number">1</span></span> -f temp.printerexport -p all -o force <span class="hljs-built_in"><span class="hljs-built_in">del</span></span> /f /q temp.printerexport cscript /nologo <span class="hljs-variable"><span class="hljs-variable">%PRTOOLS%</span></span>\prnmngr.vbs -s <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>-cl-node-<span class="hljs-number"><span class="hljs-number">1</span></span> -d -p %<span class="hljs-number"><span class="hljs-number">1</span></span> cscript /nologo <span class="hljs-variable"><span class="hljs-variable">%PRTOOLS%</span></span>\prnport.vbs -s <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>-cl-node-<span class="hljs-number"><span class="hljs-number">1</span></span> -d -r %<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre></div></div><div class="spoiler">  <b class="spoiler_title">Le fichier résultant Printers.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Printers</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{1F577D12-3D1B-471e-A1B7-060317597B9C}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9A5E9697-9095-436d-A0EE-4D128FDFBCE5}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Delete All"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">status</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Delete All"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"3"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{21097DBD-285D-48C3-B042-7746D7E6DA1B}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bypassErrors</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">disabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"D"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">deleteAll</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterRunOnce</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{F2537B78-C7D7-43DF-98D6-B32E90644825}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">hidden</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9A5E9697-9095-436d-A0EE-4D128FDFBCE5}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-BARAB-061"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">status</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-BARAB-061"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{43231EA0-A4A3-4F1A-8A25-95BC4FEFBCC6}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bypassErrors</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"U"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">comment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"\\print-cluster-1.common.domain\PRN-BARAB-061"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterGroup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"COMDOM\PRN-BARAB-061"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">sid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterIpRange</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">min</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.142.1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.142.254"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9A5E9697-9095-436d-A0EE-4D128FDFBCE5}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-BARAB-061"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">status</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-BARAB-061"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"3"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{43231EA0-A4A3-4F1A-8A25-95BC4FEFBCC6}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bypassErrors</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"D"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">comment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"\\print-cluster-1.common.domain\PRN-BARAB-061"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterGroup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"COMDOM\PRN-BARAB-061"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">sid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterIpRange</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OR"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">min</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.142.1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.142.254"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9A5E9697-9095-436d-A0EE-4D128FDFBCE5}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-BATAY-042"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">status</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-BATAY-042"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{4740604B-C403-4511-91B0-689A197260F3}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bypassErrors</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"U"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">comment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"\\print-cluster-1.common.domain\PRN-BATAY-042"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterGroup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"COMDOM\PRN-BATAY-042"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">sid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterIpRange</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">min</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.128.1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.129.254"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9A5E9697-9095-436d-A0EE-4D128FDFBCE5}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-BATAY-042"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">status</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-BATAY-042"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"3"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{4740604B-C403-4511-91B0-689A197260F3}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bypassErrors</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"D"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">comment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"\\print-cluster-1.common.domain\PRN-BATAY-042"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterGroup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"COMDOM\PRN-BATAY-042"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">sid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterIpRange</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OR"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">min</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.128.1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.129.254"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9A5E9697-9095-436d-A0EE-4D128FDFBCE5}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-BUY---001"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">status</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-BUY---001"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{457DB3FE-E35F-450E-B1D6-912F0D831573}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bypassErrors</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"U"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">comment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"\\print-cluster-1.common.domain\PRN-BUY---001"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterGroup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"COMDOM\PRN-BUY---001"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">sid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterIpRange</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">min</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.44.1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.44.254"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9A5E9697-9095-436d-A0EE-4D128FDFBCE5}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-BUY---001"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">status</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-BUY---001"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"3"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{457DB3FE-E35F-450E-B1D6-912F0D831573}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bypassErrors</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"D"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">comment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"\\print-cluster-1.common.domain\PRN-BUY---001"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterGroup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"COMDOM\PRN-BUY---001"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">sid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterIpRange</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OR"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">min</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.44.1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.44.254"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9A5E9697-9095-436d-A0EE-4D128FDFBCE5}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-ELAB-064"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">status</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-ELAB-064"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{52069D45-EF86-442D-A157-368D7510A1CF}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bypassErrors</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"U"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">comment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"\\print-cluster-1.common.domain\PRN-ELAB-064"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterIpRange</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">min</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.140.1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.140.254"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9A5E9697-9095-436d-A0EE-4D128FDFBCE5}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-ELAB-064"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">status</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-ELAB-064"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"3"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{52069D45-EF86-442D-A157-368D7510A1CF}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bypassErrors</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"D"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">comment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"\\print-cluster-1.common.domain\PRN-ELAB-064"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterIpRange</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">min</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.140.1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.140.254"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9A5E9697-9095-436d-A0EE-4D128FDFBCE5}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-EMPTY-002"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">status</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-EMPTY-002"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{475578CB-689F-463B-9710-AE207973146C}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bypassErrors</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"U"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">comment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"\\print-cluster-1.common.domain\PRN-EMPTY-002"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterGroup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"COMDOM\PRN-EMPTY-002"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">sid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterIpRange</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">min</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.199.1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.199.254"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9A5E9697-9095-436d-A0EE-4D128FDFBCE5}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-EMPTY-002"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">status</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-EMPTY-002"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"3"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{475578CB-689F-463B-9710-AE207973146C}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bypassErrors</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"D"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">comment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"\\print-cluster-1.common.domain\PRN-EMPTY-002"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterGroup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"COMDOM\PRN-EMPTY-002"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">sid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterIpRange</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OR"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">min</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.199.1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.199.254"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9A5E9697-9095-436d-A0EE-4D128FDFBCE5}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-KIRILL-081"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">status</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-KIRILL-081"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{421FC2DE-2E97-49FC-AEB0-3070B0166AD5}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bypassErrors</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"U"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">comment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"\\print-cluster-1.common.domain\PRN-KIRILL-081"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterIpRange</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">min</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.196.1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.196.254"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9A5E9697-9095-436d-A0EE-4D128FDFBCE5}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-KIRILL-081"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">status</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-KIRILL-081"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"3"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{421FC2DE-2E97-49FC-AEB0-3070B0166AD5}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bypassErrors</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"D"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">comment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"\\print-cluster-1.common.domain\PRN-KIRILL-081"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterIpRange</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">min</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.196.1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.196.254"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9A5E9697-9095-436d-A0EE-4D128FDFBCE5}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-KOTOV-013"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">status</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-KOTOV-013"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{4DFFBA1F-48D2-4824-B2EB-0AAD12B6A9D6}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bypassErrors</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"U"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">comment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"\\print-cluster-1.common.domain\PRN-KOTOV-013"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterGroup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"COMDOM\PRN-KOTOV-013"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">sid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterIpRange</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">min</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.128.1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.129.254"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9A5E9697-9095-436d-A0EE-4D128FDFBCE5}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-KOTOV-013"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">status</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-KOTOV-013"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"3"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{4DFFBA1F-48D2-4824-B2EB-0AAD12B6A9D6}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bypassErrors</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"D"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">comment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"\\print-cluster-1.common.domain\PRN-KOTOV-013"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterGroup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"COMDOM\PRN-KOTOV-013"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">sid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterIpRange</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OR"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">min</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.128.1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.129.254"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9A5E9697-9095-436d-A0EE-4D128FDFBCE5}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-LIPKI-003"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">status</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-LIPKI-003"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{4794D22E-6586-4A81-A85D-A21FB8B209CF}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bypassErrors</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"U"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">comment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"\\print-cluster-1.common.domain\PRN-LIPKI-003"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterIpRange</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">min</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.44.1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.44.254"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9A5E9697-9095-436d-A0EE-4D128FDFBCE5}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-LIPKI-003"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">status</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-LIPKI-003"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"3"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{4794D22E-6586-4A81-A85D-A21FB8B209CF}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bypassErrors</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"D"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">comment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"\\print-cluster-1.common.domain\PRN-LIPKI-003"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterIpRange</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">min</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.44.1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.44.254"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9A5E9697-9095-436d-A0EE-4D128FDFBCE5}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-NALTA-028"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">status</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-NALTA-028"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{35F6CF36-2A24-4A81-B061-8BE71CEC27EA}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bypassErrors</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"U"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">comment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"\\print-cluster-1.common.domain\PRN-NALTA-028"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterGroup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"COMDOM\PRN-NALTA-028"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">sid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterIpRange</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">min</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.192.1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.192.254"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9A5E9697-9095-436d-A0EE-4D128FDFBCE5}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-NALTA-028"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">status</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-NALTA-028"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"3"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{35F6CF36-2A24-4A81-B061-8BE71CEC27EA}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bypassErrors</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"D"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">comment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"\\print-cluster-1.common.domain\PRN-NALTA-028"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterGroup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"COMDOM\PRN-NALTA-028"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">sid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterIpRange</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OR"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">min</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.192.1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.192.254"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9A5E9697-9095-436d-A0EE-4D128FDFBCE5}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-PYSHM-004"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">status</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-PYSHM-004"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{45509B48-E7BC-4497-9665-86D4E1E96FE1}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bypassErrors</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"U"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">comment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"\\print-cluster-1.common.domain\PRN-PYSHM-004"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterIpRange</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">min</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.143.1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.143.254"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9A5E9697-9095-436d-A0EE-4D128FDFBCE5}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-PYSHM-004"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">status</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-PYSHM-004"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"3"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{45509B48-E7BC-4497-9665-86D4E1E96FE1}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bypassErrors</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"D"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">comment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"\\print-cluster-1.common.domain\PRN-PYSHM-004"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterIpRange</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">min</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.143.1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.143.254"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9A5E9697-9095-436d-A0EE-4D128FDFBCE5}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-TARUS-002"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">status</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-TARUS-002"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{398F4A94-530C-4E3B-8A30-4288D5E8854D}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bypassErrors</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"U"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">comment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"\\print-cluster-1.common.domain\PRN-TARUS-002"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterGroup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"COMDOM\PRN-TARUS-002"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">sid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterIpRange</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">min</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.128.1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.129.254"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9A5E9697-9095-436d-A0EE-4D128FDFBCE5}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-TARUS-002"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">status</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PRN-TARUS-002"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"3"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{398F4A94-530C-4E3B-8A30-4288D5E8854D}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bypassErrors</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"D"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">comment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"\\print-cluster-1.common.domain\PRN-TARUS-002"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterGroup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AND"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"COMDOM\PRN-TARUS-002"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">sid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">userContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FilterIpRange</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OR"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">min</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.128.1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"192.168.129.254"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Filters</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SharedPrinter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Printers</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre></div></div><div class="spoiler">  <b class="spoiler_title">Résultat sur le serveur d'impression</b> <div class="spoiler_text"> <a href=""><img src="https://habrastorage.org/webt/-u/l2/xx/-ul2xx66ybbj1tybovfsnxc1h7u.png" alt="image"></a> </div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr421211/">https://habr.com/ru/post/fr421211/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr421197/index.html">En Russie, un neuro-casque est en cours de développement pour les personnes souffrant de troubles de la parole et du moteur</a></li>
<li><a href="../fr421199/index.html">Fintech Digest: les technologies de l'IA modifient le marché des services bancaires, le courrier électronique comme outil de paiement, la crypto-monnaie en Australie</a></li>
<li><a href="../fr421201/index.html">Nouveautés d'AppCode 2018.2</a></li>
<li><a href="../fr421205/index.html">Il y a 110 ans: trigonométrie, taux de change du dollar et cierges magiques</a></li>
<li><a href="../fr421207/index.html">Situation: deux vulnérabilités dans la pile TCP du noyau Linux sont fermées</a></li>
<li><a href="../fr421213/index.html">DJI Mavic 2 Pro / Zoom sur les détails</a></li>
<li><a href="../fr421215/index.html">Comment j'ai piraté Steam. Deux fois</a></li>
<li><a href="../fr421217/index.html">Prise en charge de Python dans Power BI</a></li>
<li><a href="../fr421221/index.html">Thérapie sévère: cure pour MacOS</a></li>
<li><a href="../fr421223/index.html">DevFest SPB 2018</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>