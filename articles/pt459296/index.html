<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë¥üèø üíü üë©üèæ‚Äçü§ù‚Äçüë®üèø JavaScript Pre√ßo 2019 üë®üèΩ ‚ôàÔ∏è üç™</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nos √∫ltimos anos, o que √© chamado de " pre√ßo do JavaScript " sofreu grandes mudan√ßas positivas devido √† maior velocidade de an√°lise e compila√ß√£o de sc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>JavaScript Pre√ßo 2019</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/459296/">  Nos √∫ltimos anos, o que √© chamado de " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pre√ßo do JavaScript</a> " sofreu grandes mudan√ßas positivas devido √† maior velocidade de an√°lise e compila√ß√£o de scripts pelo navegador.  Agora, em 2019, os principais componentes da carga nos sistemas criados pelo JavaScript s√£o o tempo de carregamento dos scripts e o tempo de execu√ß√£o. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/7x/g6/g_/7xg6g_poas_6_4qwu5u4clgjxrs.jpeg"></a> <br><br>  A intera√ß√£o do usu√°rio com o site pode ser interrompida temporariamente se o navegador estiver ocupado executando o c√≥digo JavaScript.  Como resultado, podemos dizer que a otimiza√ß√£o de gargalos associados ao carregamento e execu√ß√£o de scripts pode ter um forte impacto positivo no desempenho do site. <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">Diretrizes pr√°ticas gerais para otimiza√ß√£o de sites</font> </h2><br>  O que significa acima para desenvolvedores web?  O ponto aqui √© que o custo dos recursos para analisar (analisar, analisar) e compilar scripts n√£o √© t√£o s√©rio quanto antes.  Portanto, ao analisar e otimizar pacotes configur√°veis ‚Äã‚ÄãJavaScript, os desenvolvedores devem considerar as tr√™s recomenda√ß√µes a seguir: <br><br><ol><li>  Tente reduzir o tempo necess√°rio para baixar scripts. <br><br><ul><li>  Tente manter seus pacotes JS pequenos.  Isso √© especialmente importante para sites projetados para dispositivos m√≥veis.  O uso de pequenos pacotes aprimora o tempo de carregamento do c√≥digo, reduz o n√≠vel de uso da mem√≥ria e reduz a carga no processador. </li><li>  Tente impedir que todo o c√≥digo do projeto seja apresentado como um grande pacote.  Se o tamanho do pacote exceder aproximadamente 50-100 Kb - divida-o em fragmentos separados de tamanho pequeno.  Gra√ßas √† multiplexa√ß√£o HTTP / 2, v√°rias solicita√ß√µes de servidor e v√°rias respostas podem ser processadas simultaneamente.  Isso reduz a carga no sistema associada √† necessidade de atender solicita√ß√µes adicionais para carregamento de dados. </li><li>  Se voc√™ estiver trabalhando em um projeto m√≥vel, tente manter o c√≥digo o menor poss√≠vel.  Esta recomenda√ß√£o est√° associada a baixas taxas de dados em redes m√≥veis.  Al√©m disso, lute pelo uso econ√¥mico da mem√≥ria. </li></ul></li><li>  Tente reduzir o tempo necess√°rio para executar scripts. <br><br><ul><li> Evite usar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tarefas demoradas</a> que possam carregar o encadeamento principal por um longo tempo e aumentar o tempo necess√°rio para que as p√°ginas estejam em um estado no qual os usu√°rios possam interagir com eles.  No ambiente atual, os scripts executados ap√≥s serem carregados contribuem muito para o "pre√ßo do JavaScript". </li></ul></li><li>  N√£o incorpore trechos de c√≥digo grandes nas p√°ginas. <br><br><ul><li>  A regra a seguir deve ser respeitada aqui: se o tamanho do script exceder 1 Kb, tente n√£o incorpor√°-lo no c√≥digo da p√°gina.  Um dos motivos desta recomenda√ß√£o √© o fato de 1 Kb ser o limite ap√≥s o qual o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">cache</a> do c√≥digo de script externo come√ßa a funcionar no Chrome.  Al√©m disso, lembre-se de que a an√°lise e compila√ß√£o de scripts incorporados ainda est√£o em execu√ß√£o no encadeamento principal. </li></ul></li></ol><br><h2>  <font color="#3AC1EF">Por que √© t√£o importante carregar e executar scripts?</font> </h2><br>  Por que √© importante otimizar o tempo de carregamento e execu√ß√£o de scripts em condi√ß√µes modernas?  Os tempos de carregamento de script s√£o extremamente importantes em situa√ß√µes em que os sites s√£o acessados ‚Äã‚Äãatrav√©s de redes lentas.  Apesar de as redes 4G (e at√© 5G) estarem se espalhando cada vez mais, a propriedade <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">NetworkInformation.effectiveType</a> em muitos casos de uso de conex√µes m√≥veis √† Internet mostra indicadores que est√£o no n√≠vel das redes 3G ou mesmo em n√≠veis mais baixos. <br><br>  O tempo necess√°rio para executar o c√≥digo JS √© importante para dispositivos m√≥veis com processadores lentos.  Devido ao fato de os dispositivos m√≥veis usarem diferentes CPUs e GPUs, devido ao fato de que quando os dispositivos superaquecem, para proteg√™-los, o desempenho de seus componentes diminui, √© poss√≠vel observar uma lacuna s√©ria entre o desempenho de telefones e tablets caros e baratos.  Isso afeta muito o desempenho do c√≥digo JavaScript, pois a capacidade de executar esse c√≥digo por um dispositivo √© limitada pelos recursos do processador desse dispositivo. <br><br>  De fato, se analisarmos o tempo total gasto carregando e preparando a p√°gina para trabalhar em um navegador como o Chrome, cerca de 30% desse tempo poder√° ser gasto executando o c√≥digo JS.  Abaixo est√° uma an√°lise do carregamento de uma p√°gina da Web muito t√≠pica (reddit.com) em um computador desktop de alto desempenho. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/31d/8f6/af0/31d8f6af06d7158ecc9bd17710d216bb.png"></div><br>  <i><font color="#999999">No processo de carregamento da p√°gina, cerca de 10 a 30% do tempo √© gasto na execu√ß√£o de c√≥digo usando V8</font></i> <br><br>  Se falamos de dispositivos m√≥veis, em um telefone m√©dio (Moto G4), √© necess√°rio 3-4 vezes mais para executar o reddit.com em um c√≥digo JS do que em um dispositivo de alto n√≠vel (Pixel 3).  Em um dispositivo fraco (Alcatel 1X custa menos de US $ 100), resolver o mesmo problema requer pelo menos 6 vezes mais tempo do que algo como o Pixel 3. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/71a/4f0/3a9/71a4f03a9f7d673740c6917f30cee360.png"></div><br>  <i><font color="#999999">O tempo necess√°rio para processar o c√≥digo JS em dispositivos m√≥veis de diferentes classes</font></i> <br><br>  Observe que as vers√µes para celular e desktop do reddit.com s√£o diferentes.  Portanto, voc√™ n√£o pode comparar os resultados de dispositivos m√≥veis e, por exemplo, o MacBook Pro. <br><br>  Ao tentar otimizar o tempo de execu√ß√£o do c√≥digo JavaScript, preste aten√ß√£o √†s <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tarefas demoradas</a> que podem capturar o fluxo da interface do usu√°rio por um longo tempo.  Essas tarefas podem impedir a execu√ß√£o de outras tarefas extremamente importantes, mesmo quando a apar√™ncia da p√°gina parece completamente pronta para o trabalho.  Tarefas de longo prazo devem ser divididas em tarefas menores.  Ao dividir o c√≥digo em partes e controlar a ordem de carregamento dessas partes, voc√™ pode conseguir que as p√°ginas cheguem a um estado interativo mais rapidamente.  Esperan√ßosamente, isso far√° com que os usu√°rios tenham menos inconveni√™ncia na intera√ß√£o com as p√°ginas. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/002/eef/32b/002eef32b869be9ae677bc41b41c86c2.png"></div><br>  <i><font color="#999999">Tarefas de longa execu√ß√£o capturam o encadeamento principal.</font></i>  <i><font color="#999999">Eles devem ser quebrados em peda√ßos</font></i> <br><br><h2>  <font color="#3AC1EF">Como as melhorias da V8 aceleram a an√°lise e compila√ß√£o de scripts?</font> </h2><br>  A velocidade de an√°lise do c√≥digo JS de origem na V8, desde a √©poca do Chrome 60, aumentou duas vezes.  Ao mesmo tempo, a an√°lise e a compila√ß√£o agora contribuem menos para o "pre√ßo do JavaScript".  Isso se deve a outros esfor√ßos de otimiza√ß√£o do Chrome que levam √† paraleliza√ß√£o dessas tarefas. <br><br>  Na V8, a quantidade de trabalho em an√°lise e compila√ß√£o de c√≥digo produzido no encadeamento principal √© reduzida em m√©dia em 40%.  Por exemplo, para o Facebook, a melhoria desse indicador foi de 46%, para o Pinterest - 62%.  O resultado mais alto, 81%, foi obtido no YouTube.  Esses resultados s√£o poss√≠veis devido ao fato de a an√°lise e a compila√ß√£o serem movidas para um fluxo separado.  E isso √© um complemento √†s melhorias existentes em rela√ß√£o √† solu√ß√£o de streaming das mesmas tarefas fora do fluxo principal. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4a7/41e/24c/4a741e24c05a9149d98ee568be74b564.png"></div><br>  <i><font color="#999999">Tempo de an√°lise de JS em v√°rias vers√µes do Chrome</font></i> <br><br>  Voc√™ tamb√©m pode visualizar como as otimiza√ß√µes da V8 produzidas em v√°rias vers√µes do Chrome afetam o tempo do processador necess√°rio para processar o c√≥digo.  Ao mesmo tempo em que o Chrome 61 precisava analisar o c√≥digo JS do Facebook, o Chrome 75 agora pode analisar o c√≥digo JS do Facebook e, al√©m disso, analisar o c√≥digo do Twitter 6 vezes. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c6b/000/0e0/c6b0000e0b2bb98087ff12f8a9eb0d97.png"></div><br>  <i><font color="#999999">No per√≠odo em que o Chrome 61 precisava processar o c√≥digo JS do Facebook, o Chrome 75 pode processar o c√≥digo do Facebook e seis vezes a quantidade de c√≥digo do Twitter.</font></i> <br><br>  Vamos falar sobre como essas melhorias foram alcan√ßadas.  Em poucas palavras, os recursos de script podem ser analisados ‚Äã‚Äãe compilados no modo de fluxo cont√≠nuo no fluxo de trabalho.  Isso significa o seguinte: <br><br><ul><li>  O V8 pode analisar e compilar o c√≥digo JS sem bloquear o encadeamento principal. </li><li> O processamento de fluxo do script inicia quando o analisador HTML universal encontra a <code>&lt;script&gt;</code> .  Um analisador HTML manipula scripts que bloqueiam a an√°lise de p√°gina.  Encontrando scripts ass√≠ncronos, ele continua trabalhando. </li><li>  Na maioria dos cen√°rios do mundo real, caracterizada por determinadas velocidades de conex√£o de rede, o V8 analisa o c√≥digo mais rapidamente do que pode carregar.  Como resultado, a V8 conclui as tarefas de an√°lise e compila√ß√£o do c√≥digo alguns milissegundos ap√≥s o carregamento dos √∫ltimos bytes do script. </li></ul><br>  Se voc√™ falar sobre tudo isso com mais detalhes, o ponto aqui √© o seguinte.  Em vers√µes muito mais antigas do Chrome, o script precisava ser baixado na √≠ntegra antes de analis√°-lo.  Essa abordagem √© simples e compreens√≠vel, mas quando √© usada, os recursos do processador s√£o irracionalmente usados.  O Chrome, entre as vers√µes 41 e 68, inicia a an√°lise no modo ass√≠ncrono, imediatamente ap√≥s o carregamento do script, executando esta tarefa em um encadeamento separado. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/574/43a/4fd/57443a4fd274a348de26652d006941c3.png"></div><br>  <i><font color="#999999">Os scripts s√£o enviados para o navegador em fragmentos.</font></i>  <i><font color="#999999">O V8 inicia o processamento de dados de streaming depois de ter pelo menos 30 Kb de c√≥digo.</font></i> <br><br>  No Chrome 71, passamos para um sistema baseado em tarefas.  Aqui, o planejador pode iniciar simultaneamente v√°rias sess√µes de processamento de script ass√≠ncrono / atrasado.  Devido a essa altera√ß√£o, a carga criada pela an√°lise do encadeamento principal diminuiu em cerca de 20%.  Isso levou a uma melhoria de cerca de 2% nas pontua√ß√µes TTI / FID obtidas em sites reais. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a3f/161/863/a3f16186348f3773a04f7caccc185592.png"></div><br>  <i><font color="#999999">O Chrome 71 usa um sistema de processamento de c√≥digo com base em tarefas.</font></i>  <i><font color="#999999">Com essa abordagem, o planejador pode processar v√°rios scripts ass√≠ncronos / pendentes ao mesmo tempo.</font></i> <br><br>  No Chrome 72, tornamos o processamento de streaming a principal maneira de analisar scripts.  Agora, mesmo os scripts s√≠ncronos regulares s√£o tratados dessa maneira (embora isso n√£o se aplique aos scripts internos).  Al√©m disso, paramos de cancelar as opera√ß√µes de an√°lise baseada em tarefas se o encadeamento principal necessitar de c√≥digo analisado.  Isso √© feito devido ao fato de que isso leva √† necessidade de executar novamente parte do trabalho j√° realizado. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A vers√£o anterior do Chrome</a> tinha suporte para an√°lise de fluxo e compila√ß√£o de c√≥digo.  Em seguida, o script baixado da rede deve primeiro entrar no fluxo principal e depois ser√° redirecionado para o sistema de processamento de script de streaming. <br><br>  Isso geralmente levou o analisador de fluxo a aguardar dados que j√° foram baixados da rede, mas ainda n√£o foram redirecionados pelo fluxo principal para o processamento do fluxo.  Isso aconteceu devido ao fato de que o encadeamento principal pode estar ocupado com outras tarefas (como analisar HTML, criar um layout de p√°gina ou executar o c√≥digo JS). <br><br>  Agora estamos experimentando como come√ßar a analisar o c√≥digo ao pr√©-carregar p√°ginas.  Anteriormente, a implementa√ß√£o desse mecanismo era prejudicada pela necessidade de usar os recursos do encadeamento principal para transferir tarefas para o analisador de streaming.  Detalhes sobre a an√°lise do c√≥digo JS executado "instantaneamente" podem ser encontrados <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br><h2>  <font color="#3AC1EF">Como as melhorias afetaram o que pode ser visto nas ferramentas do desenvolvedor?</font> </h2><br>  Al√©m do acima, pode-se notar que havia um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">problema</a> nas ferramentas do desenvolvedor antes.  Consistia no fato de que as informa√ß√µes sobre a tarefa de an√°lise eram exibidas como se elas bloquearem completamente o encadeamento principal.  No entanto, o analisador executou opera√ß√µes bloqueando o encadeamento principal apenas quando precisou de novos dados.  Desde que passamos do esquema de uso de um √∫nico fluxo para processamento de dados de streaming para o esquema no qual as tarefas de processamento de streaming s√£o aplicadas, isso se tornou bastante √≥bvio.  Aqui est√° o que voc√™ pode ver no Chrome 69. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/87c/b4c/ab0/87cb4cab05a3c00e7b21dfc25524a9c8.png"></div><br>  <i><font color="#999999">O problema est√° nas ferramentas do desenvolvedor, devido √†s quais as informa√ß√µes sobre a an√°lise de scripts foram exibidas como se elas bloquearem completamente o encadeamento principal</font></i> <br><br>  Aqui voc√™ pode ver que a tarefa de script de an√°lise leva 1,08 segundos.  Mas analisar o JavaScript, de fato, n√£o √© t√£o lento!  Na maioria das vezes, nada de √∫til √© executado, exceto pela espera de dados do encadeamento principal. <br>  No Chrome 76, voc√™ j√° pode ver uma imagem completamente diferente. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ef8/874/e37/ef8874e37664a31f03c822c71feb0fa8.png"></div><br>  <i><font color="#999999">No Chrome 76, a an√°lise √© dividida em muitas pequenas tarefas</font></i> <br><br>  Em geral, pode-se notar que a guia Desempenho das ferramentas do desenvolvedor √© √≥tima para ver a imagem geral do que est√° acontecendo na p√°gina.  Para obter informa√ß√µes mais detalhadas que refletem os recursos da V8, como tempo de an√°lise e tempo de compila√ß√£o, voc√™ pode usar o Rastreamento do Chrome com suporte ao RCS (Runtime Call Stats).  Nos dados RCS recebidos, voc√™ pode encontrar os indicadores Analisar e Antecedentes e Compilar e Antecedentes.  Eles s√£o capazes de relatar quanto tempo levou para analisar e compilar o c√≥digo JS fora do encadeamento principal.  As m√©tricas de an√°lise e compila√ß√£o indicam quanto tempo foi gasto em atividades relacionadas no encadeamento principal. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3a4/200/d26/3a4200d269fe47bedac1d84c27722a2b.png"></div><br>  <i><font color="#999999">An√°lise de dados RCS usando o Google Tracing</font></i> <br><br><h2>  <font color="#3AC1EF">Como as mudan√ßas afetaram o trabalho com sites reais?</font> </h2><br>  Vejamos alguns exemplos de como o processamento de scripts de streaming influenciou a navega√ß√£o em sites reais. <br><br><h3>  <font color="#3AC1EF">‚ñçReddit</font> </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d77/4ba/270/d774ba2709a772bbcfb26294b67ab385.png"></div><br>  <i><font color="#999999">Veja reddit.com em um MacBook Pro.</font></i>  <i><font color="#999999">Tempo para analisar e compilar o c√≥digo JS gasto nos encadeamentos principal e de trabalho</font></i> <br><br>  Existem v√°rios pacotes JS no site reddit.com, cada um com mais de 100 Kb de tamanho.  Eles s√£o agrupados em fun√ß√µes externas, o que leva √† execu√ß√£o de grandes volumes de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">compila√ß√£o "lenta"</a> no encadeamento principal.  Crucial no diagrama acima √© o tempo necess√°rio para processar os scripts no encadeamento principal.  Isso ocorre porque uma grande carga no encadeamento principal pode aumentar o tempo que leva para a p√°gina alternar para o modo interativo.  Ao processar o c√≥digo do site reddit.com, a maior parte do tempo √© gasta no encadeamento principal e os recursos do encadeamento de trabalho / plano de fundo s√£o usados ‚Äã‚Äãno m√≠nimo. <br><br>  Voc√™ pode otimizar este site dividindo alguns pacotes grandes em partes (cerca de 50 Kb cada) e fazendo isso sem envolver o c√≥digo em uma fun√ß√£o.  Isso maximizaria o processamento paralelo de scripts.  Como resultado, os pacotes podem ser analisados ‚Äã‚Äãe compilados ao mesmo tempo no modo de streaming.  Isso reduziria a carga no encadeamento principal ao preparar a p√°gina para o trabalho. <br><br><h3>  <font color="#3AC1EF">‚ñçFacebook</font> </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bc2/d83/a53/bc2d83a53f5b73658168e3dba70c9a85.png"></div><br>  <i><font color="#999999">Veja facebook.com no seu MacBook Pro.</font></i>  <i><font color="#999999">Tempo para analisar e compilar o c√≥digo JS gasto nos encadeamentos principal e de trabalho</font></i> <br><br>  Tamb√©m podemos considerar um site como o facebook.com, que usa cerca de 6 MB de c√≥digo JS compactado.  Esse c√≥digo √© carregado usando aproximadamente 292 solicita√ß√µes.  Alguns deles s√£o ass√≠ncronos, outros t√™m como objetivo pr√©-carregar dados, outros t√™m baixa prioridade.  A maioria dos scripts do Facebook √© pequena em tamanho e foco estreito.  Isso pode ter um bom efeito no processamento paralelo de dados por meio de fluxos de segundo plano / trabalho.  O fato √© que muitos scripts pequenos podem ser analisados ‚Äã‚Äãe compilados ao mesmo tempo por meio do processamento de scripts de streaming. <br><br>  Observe que seu site provavelmente √© diferente do site do Facebook.  Voc√™ provavelmente n√£o possui aplicativos mantidos abertos por um longo per√≠odo de tempo (como o que √© um site do Facebook ou a interface do Gmail) e, ao trabalhar com os quais pode ser justificado o download de volumes t√£o graves de scripts com um navegador de desktop.  Mas, apesar disso, podemos dar uma recomenda√ß√£o geral que seja justa para qualquer projeto.  Est√° no fato de que vale a pena dividir o c√≥digo do aplicativo em pacotes configur√°veis ‚Äã‚Äãmodestos e que voc√™ precisa fazer o download desses pacotes configur√°veis ‚Äã‚Äãsomente quando houver necessidade deles. <br><br>  Embora a maior parte do trabalho de an√°lise e compila√ß√£o de c√≥digo JS possa ser realizada usando ferramentas de streaming em um encadeamento em segundo plano, algumas opera√ß√µes ainda exigem um encadeamento principal.  Quando o segmento principal est√° ocupado com algo, a p√°gina n√£o pode responder √† intera√ß√£o do usu√°rio.  Portanto, √© recomend√°vel prestar aten√ß√£o ao impacto nos sites UX que o carregamento e a execu√ß√£o do c√≥digo JS t√™m. <br><br>  Lembre-se de que nem todos os mecanismos e navegadores JavaScript agora transmitem scripts e otimizam seu carregamento.  Apesar disso, esperamos que os princ√≠pios gerais de otimiza√ß√£o descritos acima possam melhorar a experi√™ncia do usu√°rio ao trabalhar com sites visualizados em qualquer um dos navegadores existentes. <br><br><h2>  <font color="#3AC1EF">Pre√ßo de an√°lise JSON</font> </h2><br>  A an√°lise do c√≥digo JSON pode ser muito mais eficiente do que a an√°lise do c√≥digo JavaScript.  A quest√£o √© que a gram√°tica JSON √© muito mais simples que a gram√°tica JavaScript.  Esse conhecimento pode ser aplicado para melhorar a velocidade de prepara√ß√£o do trabalho de aplicativos da Web que usam grandes objetos de configura√ß√£o (como reposit√≥rios Redux), cuja estrutura se assemelha ao c√≥digo JSON.  Como resultado, verifica-se que, em vez de apresentar os dados como literais de objetos incorporados no c√≥digo, voc√™ pode represent√°-los como cadeias de objetos JSON e analisar esses objetos em tempo de execu√ß√£o. <br><br>  A primeira abordagem, usando objetos JS, fica assim: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> data = { <span class="hljs-attr"><span class="hljs-attr">foo</span></span>: <span class="hljs-number"><span class="hljs-number">42</span></span>, <span class="hljs-attr"><span class="hljs-attr">bar</span></span>: <span class="hljs-number"><span class="hljs-number">1337</span></span> }; <span class="hljs-comment"><span class="hljs-comment">// </span></span></code> </pre> <br>  A segunda abordagem, usando cadeias JSON, envolve o uso de tais constru√ß√µes: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> data = <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse(<span class="hljs-string"><span class="hljs-string">'{"foo":42,"bar":1337}'</span></span>); <span class="hljs-comment"><span class="hljs-comment">// </span></span></code> </pre> <br>  Como voc√™ s√≥ precisa executar o processamento de string JSON uma vez, a abordagem que usa <code>JSON.parse</code> √© muito mais r√°pida do que usar literais de objeto JavaScript.  Especialmente - no carregamento de p√°gina "frio".  √â recomend√°vel que voc√™ use cadeias JSON para representar objetos que come√ßam em 10 Kb.  No entanto, como em qualquer dica de desempenho, essa dica n√£o deve ser seguida sem pensar.  Antes de aplicar esta t√©cnica para apresentar dados em produ√ß√£o, √© necess√°rio fazer medi√ß√µes e avaliar seu real impacto no projeto. <br><br>  O uso de literais de objeto como armazenamento para grandes quantidades de dados representa outra amea√ßa.  A quest√£o √© que existe o risco de que esses literais possam ser processados ‚Äã‚Äãduas vezes: <br><br><ol><li>  A primeira passagem de processamento √© realizada com an√°lise preliminar do literal. </li><li>  A segunda abordagem √© realizada durante a an√°lise "pregui√ßosa" do literal. </li></ol><br>  Voc√™ n√£o pode se livrar da primeira passagem do processamento de literais de objetos.  Felizmente, por√©m, a segunda passagem pode ser evitada colocando literais de objetos no n√≠vel superior ou dentro do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">PIFE</a> . <br><br><h2>  <font color="#3AC1EF">E quanto √† an√°lise e compila√ß√£o de c√≥digos em visitas repetidas a sites?</font> </h2><br>  √â poss√≠vel otimizar o desempenho do site para os casos em que os usu√°rios os visitam mais de uma vez, gra√ßas aos recursos da V8 para armazenar em cache o c√≥digo e o bytecode.  Quando um script √© solicitado pelo servidor pela primeira vez, o Chrome faz o download e passa a V8 para compila√ß√£o.  O navegador, al√©m disso, salva o arquivo desse script em seu cache de disco.  Quando a segunda solicita√ß√£o para baixar o mesmo arquivo JS √© executada, o Chrome o pega no cache do navegador e passa novamente a V8 para compila√ß√£o.  Desta vez, no entanto, o c√≥digo compilado √© serializado e anexado ao arquivo de script em cache como metadados. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b78/216/702/b7821670255f45c9ec4a08217b495153.png"></div><br>  <i><font color="#999999">Sistema de armazenamento em cache de c√≥digo na V8</font></i> <br><br>  Quando o script √© solicitado pela terceira vez, o Chrome pega o arquivo e seus metadados do cache e transfere os dois da V8.  A V8 desserializa os metadados e, como resultado, pode pular a etapa de compila√ß√£o.  O cache de c√≥digo √© acionado se as visitas ao site forem realizadas dentro de 72 horas.  O Chrome tamb√©m usa a estrat√©gia de armazenamento em cache de c√≥digo ganancioso quando um trabalhador do servi√ßo √© usado para armazenar em cache scripts.  Detalhes sobre cache de c√≥digo podem ser encontrados <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br><h2>  <font color="#3AC1EF">Sum√°rio</font> </h2><br>  Em 2019, os principais gargalos de desempenho das p√°ginas da web s√£o o carregamento e a execu√ß√£o de scripts.  Para melhorar a situa√ß√£o, tente usar scripts s√≠ncronos (internos) de tamanhos pequenos, necess√°rios para organizar a intera√ß√£o do usu√°rio com a parte da p√°gina que lhe √© vis√≠vel imediatamente ap√≥s o carregamento.  Recomenda-se que os scripts usados ‚Äã‚Äãpara atender a outras partes das p√°ginas sejam carregados no modo adiado.  Quebrar pacotes grandes em peda√ßos pequenos.  Isso facilitar√° a implementa√ß√£o de uma estrat√©gia para trabalhar com c√≥digo, na aplica√ß√£o em que o c√≥digo √© carregado apenas quando necess√°rio e somente onde √© necess√°rio.  Isso maximizar√° os recursos do V8, destinados ao processamento paralelo do c√≥digo. <br><br>  Se voc√™ estiver desenvolvendo projetos m√≥veis, deve se esfor√ßar para garantir que eles usem o m√≠nimo de c√≥digo JS poss√≠vel.  Essa recomenda√ß√£o deriva do fato de que os dispositivos m√≥veis geralmente funcionam em redes bastante lentas.  Al√©m disso, esses dispositivos podem ser limitados em termos de RAM e recursos de processador dispon√≠veis.  Tente encontrar um equil√≠brio entre o tempo necess√°rio para preparar scripts baixados da rede e usando o cache.  Isso maximizar√° a quantidade de an√°lise e compila√ß√£o de c√≥digo executada fora do encadeamento principal. <br><br>  <b>Caros leitores!</b>  Voc√™ otimiza seus projetos da web levando em considera√ß√£o as peculiaridades do processamento de c√≥digo JS pelos navegadores modernos? <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/rw/6v/yn/rw6vyn2bxx4usoqc39holmj2z8m.jpeg"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt459296/">https://habr.com/ru/post/pt459296/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt459284/index.html">Breve introdu√ß√£o √† estrat√©gia de produtos e prioriza√ß√£o de recursos</a></li>
<li><a href="../pt459286/index.html">Telureto de tungst√™nio semi-met√°lico - a faca su√≠√ßa do dia da nanotecnologia</a></li>
<li><a href="../pt459288/index.html">Implementa√ß√£o nativa da biblioteca ECS</a></li>
<li><a href="../pt459292/index.html">Automa√ß√£o de teste de aplicativos m√≥veis: compara√ß√£o de ferramentas</a></li>
<li><a href="../pt459294/index.html">O que √© mais importante: conhecer uma linguagem de programa√ß√£o ou ser capaz de resolver um problema de neg√≥cios?</a></li>
<li><a href="../pt459298/index.html">Angular: status em 2019</a></li>
<li><a href="../pt459300/index.html">Quasar 1.0: uma nova ferramenta √∫til para desenvolvedores do Vue e n√£o apenas para eles</a></li>
<li><a href="../pt459302/index.html">Tentando novamente solicita√ß√µes HTTP com falha no Angular</a></li>
<li><a href="../pt459304/index.html">Desvio angular de armadilha e economia de tempo</a></li>
<li><a href="../pt459306/index.html">Renderiza√ß√£o do servidor em um ambiente sem servidor</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>