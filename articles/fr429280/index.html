<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙆🏻 🔣 🎠 Comment une vulnérabilité dans REG.RU a permis d'obtenir des données d'enregistrement de n'importe quel domaine 💅🏽 🏴󠁧󠁢󠁳󠁣󠁴󠁿 👄</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Aujourd'hui, je veux parler de la façon dont, en 2012, j'ai trouvé une vulnérabilité dans le système d'enregistrement de domaine REG.RU. Très souvent,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment une vulnérabilité dans REG.RU a permis d'obtenir des données d'enregistrement de n'importe quel domaine</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/poiskvps/blog/429280/"> Aujourd'hui, je veux parler de la façon dont, en 2012, j'ai trouvé une vulnérabilité dans le système d'enregistrement de domaine REG.RU.  Très souvent, je vois des histoires dans lesquelles les auteurs parlent de vulnérabilités tout en mentionnant que la société n'a pas prêté suffisamment d'attention au bogue trouvé pendant longtemps ou ne l'a pas corrigé du tout.  Dans mon cas, tout était exactement le contraire et la vulnérabilité a été éliminée très rapidement. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/bx/wh/kl/bxwhklvvnvkoktoq7zgcevrmbxq.jpeg"></a> <br><a name="habracut"></a><br>  En septembre 2012, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">REG.RU a</a> commencé à enregistrer des domaines dans la zone <b>ru.com</b> et a envoyé des lettres à tous ses clients avec une proposition de recevoir gratuitement pour la première année un domaine dans une nouvelle zone avec le nom d'un domaine déjà enregistré dans les zones <b>ru</b> , <b>rf</b> , <b>su</b> , <b>com</b> , <b>net</b> . <br><br>  L'obtention d'un domaine gratuit s'est avérée assez simple: il fallait suivre le lien de la lettre, saisir le code d'activation du domaine, et le domaine a été enregistré gratuitement pendant un an. <br><br><img src="https://habrastorage.org/webt/fw/h1/gp/fwh1gpaq6m27gl4ihvcknielwoq.png"><br><br>  Avant d'enregistrer un domaine, le système a proposé de se familiariser avec les coordonnées du domaine «original» pour lequel le domaine du cadeau sera enregistré, mais ces données étaient ouvertes uniquement pour la visualisation sans possibilité de modification, de sorte que la signification de leur affichage n'était pas claire.  Cependant, c'était le premier bug: l'enregistrement d'un nouveau domaine était disponible via un lien du formulaire <code>https://www.reg.ru/domain/new/get_free_ru_com?service_id=XXXX</code> , et l'ID du service pouvait simplement être énuméré en voyant à qui il était enregistré. un ou un autre domaine. <br><br>  Les spécialistes de REG.RU se sont assurés que tous les contacts n'étaient pas affichés complètement, mais seuls les 7 premiers caractères de chaque champ étaient affichés, ce qui ne devrait théoriquement pas divulguer complètement les informations sur le propriétaire du domaine, cependant, par exemple, mon nom et mon prénom comptaient moins de 7 caractères et ils est apparu complètement.  Eh bien, en plus de tout, si vous montrez les 7 premiers caractères du nom, vous pouvez souvent deviner quels caractères vous devez ajouter, un exemple simple est «Vladimi». <br><br>  Ce bug a été corrigé assez rapidement, et maintenant le système n'affichait que les 4 premiers caractères, ce qui était bien mieux, même si une personne portant le nom de «Han Solo» ne serait pas très satisfaite. <br><br><img src="https://habrastorage.org/webt/nd/t1/qf/ndt1qficctztgphltdk3ia2eb7y.png"><br><br>  Le bogue suivant est la possibilité d'enregistrer un domaine sans entrer de code d'activation.  Pour empêcher tous les propriétaires de domaine de s'exécuter pour enregistrer des domaines gratuits à la fois, REG.RU a décidé d'envoyer des lettres non pas immédiatement, mais dans quelques jours, afin que la charge soit répartie uniformément.  D'un point de vue technique, cela ressemblait à ceci: dans la base de données du tableau avec les domaines, une nouvelle colonne «Code d'autorisation» était créée avec une valeur vide, et de temps en temps des lettres étaient envoyées aux utilisateurs avec le même code remplissant ce champ.  Une simple recherche pourrait aller vers un lien comme <code>https://www.reg.ru/domain/new/get_free_ru_com?service_id=XXXX</code> , augmentant l'ID du service à la valeur lorsque le système n'a pas encore réussi à émettre un code d'autorisation pour un tel domaine et enregistrer le domaine avec un espace code. <br><br>  Il n'y avait rien de mal à enregistrer un tel domaine, mais après l'enregistrement, il est devenu possible de voir les coordonnées complètes (nom, adresse et numéro de téléphone) du propriétaire du domaine «original» sans caractères cachés.  Il n'a pas été difficile de corriger ce bogue, en ajoutant simplement une vérification pour un code d'autorisation non vide lors de l'inscription, que les experts REG.RU ont également rapidement corrigé. <br><br>  Après un certain temps, j'ai trouvé un autre bogue, mais il a fallu un peu plus d'action que de simplement trier les ID de service.  Pour simplifier la procédure d'enregistrement des domaines de cadeaux, REG.RU a permis d'enregistrer un domaine sans entrer de code d'autorisation à partir d'une lettre si le compte de messagerie dans le système reg.ru coïncidait avec l'adresse e-mail indiquée comme contact dans le domaine d'origine.  C'était assez pratique pour l'utilisateur, mais en termes de sécurité, tout n'était pas si bon. <br><br>  En 2012, il n'y avait pas de loi sur la protection des données personnelles dans l'édition actuelle, et pour de nombreux domaines de la zone <b>ru</b> , vous pouviez voir l'adresse e-mail de contact via Whois.  Au moment où ce bogue a été détecté, l'adresse e-mail était déjà masquée, mais grâce aux services de visualisation de l'historique Whois, vous pouviez voir l'e-mail et, avec une forte probabilité, il était pertinent.  Après cela, vous avez dû essayer de vous inscrire dans le système REG.RU avec cette adresse e-mail et après cela, sans code d'autorisation, obtenir un domaine gratuit, qui à son tour a ouvert l'accès aux informations de contact du domaine d'origine. <br><br>  Pour être bref, la procédure est la suivante: <br><br><ol><li>  Nous allons à la page comme <code>https://www.reg.ru/domain/new/get_free_ru_com?service_id=XXXX</code> et regardons le nom de domaine avec cet ID, par exemple <b>habr.ru.com</b> . </li><li>  Grâce au service Whois History Viewer, nous trouvons l'adresse e-mail du domaine <b>habr.ru.</b> </li><li>  En utilisant cette adresse e-mail, nous créons un compte dans le système REG.RU (la confirmation de la propriété de l'adresse e-mail n'était alors pas requise). </li><li>  Sans entrer le code de vérification, nous enregistrons le domaine <b>habr.ru.com</b> et voyons les coordonnées complètes du propriétaire <b>habr.ru.</b> </li></ol><br>  Les erreurs qui ont été faites par REG.RU pourraient potentiellement entraîner la fuite d'une grande quantité de données personnelles des propriétaires de domaine, mais tous les bugs ont été corrigés très rapidement.  Moins de deux jours se sont écoulés depuis le moment de la rédaction de la première lettre (et je l'ai écrite personnellement au directeur exécutif de REG.RU) et avant de corriger toutes les vulnérabilités, ce qui, à mon avis, est assez court pour une entreprise de cette taille et les conditions pour corriger d'autres vulnérabilités dans d'autres sociétés. <br><br><blockquote><div style="text-align:center;"><img src="https://habrastorage.org/webt/op/1d/zd/op1dzdczzwfxzcisazp6zysnoxg.png"></div><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Jetez un œil</a> à <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">VPS.today</a> , un site pour trouver des serveurs virtuels.  1400 tarifs de 120 hébergeurs, une interface pratique et un grand nombre de critères pour trouver le meilleur serveur virtuel. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dd/ky/d6/ddkyd6kuoqn62p8il6p3oc4zilq.png"></div></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr429280/">https://habr.com/ru/post/fr429280/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr429270/index.html">Journalisme adulte: de la Russie au Kremlin</a></li>
<li><a href="../fr429272/index.html">Un bref aperçu d'un livre React et du développement Web fonctionnel Redux: Chapitre 1. Bienvenue dans React</a></li>
<li><a href="../fr429274/index.html">Démarrage: comment vivre en rond</a></li>
<li><a href="../fr429276/index.html">Auto-encodeurs variationnels: théorie et code de travail</a></li>
<li><a href="../fr429278/index.html">Technologie d'enregistrement magnétique prospective MAMR: qu'est-ce qui nous attend dans un futur proche?</a></li>
<li><a href="../fr429286/index.html">Comment accélérer l'apprentissage automatique des GPU - introduction d'une nouvelle plateforme open source</a></li>
<li><a href="../fr429288/index.html">Développeur! Ne vous considérez pas comme un assez bon spécialiste, ce n'est pas vrai</a></li>
<li><a href="../fr429290/index.html">Tesla va construire une autre batterie géante en Australie</a></li>
<li><a href="../fr429292/index.html">Réponses du support technique 3CX: mise à niveau rapide et gratuite vers la dernière version 3CX</a></li>
<li><a href="../fr429296/index.html">Vélo électrique Shit and Stick</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>