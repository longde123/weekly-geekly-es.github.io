<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏿‍🎓 🆙 🐀 Wie wir schlechte Prognosen in etwas bessere Prognosen umwandeln (Fortsetzung) ♑️ 👨‍👧‍👧 👨🏾‍🎓</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In einem früheren Artikel habe ich darüber gesprochen, wie Leute eine große und komplexe Excel-Datei ( Sie können sie hier lesen ) für die Umsatzprogn...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie wir schlechte Prognosen in etwas bessere Prognosen umwandeln (Fortsetzung)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/424933/"><p>  In einem früheren Artikel habe ich darüber gesprochen, wie Leute eine große und komplexe Excel-Datei ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sie können sie hier lesen</a> ) für die Umsatzprognose erstellt haben.  Wir haben uns entschlossen, in diese Schande einzugreifen, und vorgeschlagen, das Prognosemodell zu wiederholen, damit weniger Fehler, eine einfachere Bedienung und eine flexible Abstimmung möglich sind. </p><br><h3 id="kakie-klyuchevye-problemy-v-opisannoy-modeli">  Was sind die Hauptprobleme im beschriebenen Modell: </h3><br><ol><li>  Daten, Modell und Ansichten werden zu einer Entität gemischt.  Aus diesem Grund zerstört eine Änderung an mindestens einem Element diesen gesamten Monolithen. </li><li>  Übermäßige Berechnung für die manuelle Verarbeitung, die in großen Mengen zu Fehlern und Tippfehlern führt. </li></ol><br><h3 id="chto-my-predlozhili">  Was wir vorgeschlagen haben: </h3><br><ol><li>  Im ursprünglichen Modell wurden die ursprünglichen Daten, auf denen es erstellt wurde, nirgendwo angezeigt.  Wir haben vorgeschlagen, diese Daten im Format der 2. Normalform in die Excel-Datei selbst in zwei separate Blätter (Umsatz und Anzahl der Kunden) einzugeben.  Glücklicherweise sind die Verkaufsdaten in unserer monatlichen Aggregation nur Zehntausende von Zeilen, nicht Millionen.  Wir haben auch konfiguriert, dass diese Daten mithilfe von Power Query direkt aus der Datenbank empfangen werden. <a name="habracut"></a></li><li>  Wir haben ein Modellierungsblatt erstellt, das aus 3 Blöcken besteht: <br><ul><li>  Revenue Pivot-Tabelle </li><li>  Übersichtstabelle der Anzahl der Clients </li><li>  Abrechnungstabelle der durchschnittlichen Schecks <br>  Jede Pivot-Tabelle ist eine Pivot-Tabelle, die auf den Quelldaten in den Details basiert, die für die aktuelle Simulation nach Abteilungen und Einheiten erforderlich sind, sowie in den erforderlichen Details zu Zeiträumen (Monaten). <br><img src="https://habrastorage.org/webt/uv/3z/mh/uv3zmh-wl4awfrj6rfexngymb5q.png"></li></ul></li><li>  Im Simulationsblatt haben wir einfache Prognosemodelle basierend auf historischen Zeitreihen erstellt.  Wir haben die Anzahl der Kunden und die durchschnittliche Rechnung erweitert, und der prognostizierte Gesamtumsatz wurde als Produkt dieser Werte betrachtet.  Nach Überprüfung der Daten haben wir drei Prognosemodelle erstellt: Median für vergangene Perioden, exponentielle dreifache Glättung und Nullstellung (wenn wir 0 Prognosen benötigen). <br><img src="https://habrastorage.org/webt/xn/-e/x7/xn-ex79q2h2-u1ntngvxiavkr0m.png"></li><li>  Die Berechnung des durchschnittlichen Eingangs (Fakt) und des Umsatzes (Prognose) erfolgt nicht durch Referenzieren der Zellen, sondern unter Verwendung von VLR und Offset-Markierung, wodurch die Berechnungen gegenüber Änderungen der Anfangsdaten resistent werden. <br><img src="https://habrastorage.org/webt/gn/y7/sw/gny7swii7rerdwbdgdswbbbllps.png"></li><li>  Es ist klar, dass das Modell jetzt für den Benutzer nicht lesbar ist, weil  Es gibt zu viele Bedeutungen.  Zu diesem Zweck haben wir separate Einheitenblätter erstellt.  Jedes Blatt verfügt über eine Zelle, in der ausgewählt wird, welche Daten in diesem Blatt zusammengefasst werden sollen.  Basierend auf VLOOKUP ziehen wir Daten aus dem Modellblatt in das Blatt. </li><li>  Die Erstellung von 30 Blättern nach Einheiten erfolgte nach einem speziellen Verfahren.  Zunächst wird das erste Blatt erstellt, eine der Einheiten, die alle möglichen Abteilungsnamen enthält.  Wenn es in der Einheit keine Abteilung gibt, ziehen die Formeln sie auf 0 zurück. Um alle 30 Einheiten zu erstellen, erstellen wir Duplikate und ändern die Namen in der Kontrollzelle (sie wird zum Generieren des VLOOKUP-Schlüssels verwendet), und wir haben die erforderlichen Daten in Form einer Präsentation.  Der VLOOKUP kann mehr als eine Zelle als Schlüssel verwenden, wenn Sie den Trick verwenden: Kombinieren Sie die benötigten Zellen mithilfe der Verkettung (der CLIP-Funktion oder des &amp; -Symbols) zu einer. </li><li>  Dem Präsentationsformular wurde ein Element hinzugefügt, mit dem Sie das Modell steuern können: ein einfacher Faktor für die vorhergesagten Werte der durchschnittlichen Prüfung und Anzahl.  Dieses Element wird mithilfe der INDIRECT-Funktion, mit der Sie den generierten Link verwenden können, auf einem speziellen technischen Blatt erfasst.  Aus diesem technischen Datenblatt werden alle diese Korrekturen mit dem VLOOKUP auf das Modellblatt übertragen. <br><img src="https://habrastorage.org/webt/nn/pw/zv/nnpwzvykp3sqghpaimfbouefgkk.png"></li><li>  Verallgemeinerungsblätter sind keine Summierung von Präsentationsblättern mehr, sondern werden genauso aufgebaut wie alle anderen Blätter - durch Summieren der Daten auf dem Modellblatt.  Repräsentationen sind daher reine Repräsentationen und haben keine Abhängigkeiten untereinander. </li></ol><br><h3 id="chto-my-poluchili">  Was wir haben: </h3><br><ol><li>  Es ist immer klar, von welchen Ziffern wir die Daten erhalten haben (da die Power Query-Abfrage gespeichert wurde). </li><li>  Wir können die Daten ändern, ohne das Modell zu beschädigen. </li><li>  Änderungen in der Struktur und Hierarchie erfordern geringfügige Änderungen (Sie müssen nur die Namen in einem Blatt der Präsentation ändern und dann duplizieren). </li><li>  Wir haben die Anzahl möglicher Fehler drastisch reduziert, weil  Die meisten Daten werden mit Formeln, Links und Schlüsseln ausgefüllt. </li><li>  Der Kunde hat eine interaktive Prognose erhalten, in der er die Werte selbst ändern und sofort eine Prognose erhalten kann. </li><li>  Wir konnten gleichzeitig die Anforderungen erfüllen, dass wir Daten sowohl jährlich als auch monatlich benötigen. </li><li>  Kann in der nächsten Budgetperiode verwendet werden. </li><li>  Sie können die Prognosemodelle ändern, wenn diese uns unangemessen erscheinen. </li></ol><br><h3 id="pochemu-my-reshili-ostatsya-v-eksele-a-ne-peredelali-eto-na-kakie-to-drugie-tehnologii">  Warum haben wir uns entschieden, in Excel zu bleiben, und es bei einigen anderen Technologien nicht wiederholt? </h3><br><ol><li>  Wir mussten diese Datei im Betrieb der derzeitigen Mitarbeiter belassen.  In Excel ist es für uns einfacher zu zeigen, wie dies alles funktioniert und was sie beheben können. </li><li>  Excel bewältigt die Aufgabe und andere Lösungen - überflüssige Entitäten. </li><li>  Der Kunde ist an dieses Formular gewöhnt und hat bestimmte Arbeitskosten, die wir uns nicht leisten konnten, „umgeschult“. </li></ol><br><p>  Wie viel Zeit wir gebraucht haben: ungefähr 5 Arbeitstage, an denen 1 Person 2-4 Stunden am Tag verbracht hat, und am Ende des Tages haben wir die Ergebnisse überprüft. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de424933/">https://habr.com/ru/post/de424933/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de424921/index.html">Wie Netzwerkmathematik Ihnen helfen kann, Freunde zu finden</a></li>
<li><a href="../de424923/index.html">Treffen Sie Anarchisten, die sich selbst behandeln</a></li>
<li><a href="../de424925/index.html">Wi-Fi ist sicherer: Alles, was Sie über WPA3 wissen müssen</a></li>
<li><a href="../de424927/index.html">Im Schatten des Großen Kosmos</a></li>
<li><a href="../de424929/index.html">Asiatisches Wunder Shimano: Die Geschichte des legendären Herstellers von Fahrradausrüstung</a></li>
<li><a href="../de424935/index.html">Food Design Digest, September 2018</a></li>
<li><a href="../de424937/index.html">Digitale Veranstaltungen in Moskau vom 1. bis 7. Oktober</a></li>
<li><a href="../de424939/index.html">Polymorphes Quine</a></li>
<li><a href="../de424941/index.html">Streaming von Daten von einem REST-Service in eine MQ-Warteschlange</a></li>
<li><a href="../de424945/index.html">Smartphone fährt ein Spielzeugauto.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>