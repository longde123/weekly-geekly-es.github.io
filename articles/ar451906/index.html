<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍤 📱 🤸🏾 مشكلة عدم حصانة Exchange: كيفية اكتشاف ارتفاع الامتياز إلى مسؤول المجال 👉 🥠 ✒️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="تسمح مشكلة عدم الحصانة التي تم اكتشافها في Exchange هذا العام لأي مستخدم مجال بالحصول على حقوق مسؤول المجال والتنازل عن Active Directory (AD) والمضيفي...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>مشكلة عدم حصانة Exchange: كيفية اكتشاف ارتفاع الامتياز إلى مسؤول المجال</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/varonis/blog/451906/" style=";text-align:right;direction:rtl">  تسمح مشكلة عدم <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الحصانة التي تم</a> اكتشافها في <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Exchange</a> هذا العام لأي مستخدم مجال بالحصول على حقوق مسؤول المجال والتنازل عن Active Directory (AD) والمضيفين المتصلين الآخرين.  اليوم سوف نخبرك بكيفية عمل هذا الهجوم وكيفية اكتشافه. <br><br><img src="https://habrastorage.org/webt/ud/tc/xh/udtcxhyp-k1wn1vnlmuu_4d3-d8.png"><br><a name="habracut"></a><br>  <b>إليك كيفية عمل هذا الهجوم:</b> <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  يأخذ المهاجم حساب أي مستخدم مجال لديه صندوق بريد نشط من أجل الاشتراك في وظيفة إعلام الدفع من Exchange </li><li style=";text-align:right;direction:rtl">  يستخدم المهاجم ترحيل NTLM لخداع خادم Exchange: في النهاية ، يتصل خادم Exchange بجهاز الكمبيوتر الخاص بالمستخدم المخترق باستخدام NTLM عبر أسلوب HTTP ، والذي يستخدمه المهاجم للمصادقة على وحدة تحكم المجال باستخدام LDAP بمعلومات حساب Exchange </li><li style=";text-align:right;direction:rtl">  نتيجة لذلك ، يستخدم المهاجم امتيازات حساب Exchange هذه لرفع امتيازاته.  يمكن أيضًا تنفيذ هذه الخطوة الأخيرة من قِبل مسؤول معاد يتمتع بالفعل بوصول شرعي لإجراء التغيير اللازم في الحقوق.  من خلال إنشاء قاعدة للكشف عن هذا النشاط ، ستتم حمايتك من هذا الهجوم والهجمات المماثلة. </li></ol><br>  بعد ذلك ، يمكن للمهاجم ، على سبيل المثال ، تشغيل DCSync للحصول على كلمات مرور مجزأة لجميع المستخدمين في مجال ما.  هذا سيسمح له بتنفيذ أنواع مختلفة من الهجمات - من الهجمات على التذكرة الذهبية إلى نقل التجزئة. <br><br>  قام فريق بحث Varonis بدراسة متجه الهجوم بالتفصيل وأعد دليلًا لعملائنا لاكتشافه وفي الوقت نفسه تحقق مما إذا كان قد تم اختراقه بالفعل. <br><br><h2 style=";text-align:right;direction:rtl">  <b>الكشف عن تصعيد امتياز المجال</b> </h2><br>  في <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">DatAlert ، قم</a> بإنشاء قاعدة مخصصة لتتبع التغييرات على أذونات كائن معين.  ستعمل عند إضافة الحقوق والأذونات إلى كائن الاهتمام في المجال: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  حدد اسم القاعدة </li><li style=";text-align:right;direction:rtl">  قم بتعيين الفئة كـ "تصعيد الامتياز" </li><li style=";text-align:right;direction:rtl">  عيّن القيمة لنوع المورد إلى جميع أنواع الموارد </li><li style=";text-align:right;direction:rtl">  خادم الملفات = خدمات الدليل </li><li style=";text-align:right;direction:rtl">  عيّن المجال الذي تهتم به ، على سبيل المثال ، حسب الاسم </li><li style=";text-align:right;direction:rtl">  إضافة عامل تصفية لإضافة أذونات على كائن م </li><li style=";text-align:right;direction:rtl">  ولا تنس أن تترك خيار "البحث في الكائنات التابعة" دون تحديد </li></ol><br><img src="https://habrastorage.org/webt/2h/fc/92/2hfc9248n-qc6fgx-xxil9iv9qw.png"><br><br><h2 style=";text-align:right;direction:rtl">  <b>والآن التقرير: اكتشاف حقوق كائن المجال</b> </h2><br>  يعد تغيير الأذونات على كائن AD حدثًا نادرًا ، لذا يجب التحقيق في أي شيء تسبب في هذا التحذير.  سيكون من الجيد أيضًا اختبار مظهر التقرير ومحتوياته قبل إطلاق القاعدة نفسها في المعركة. <br><br>  سيُظهر هذا التقرير أيضًا ما إذا كنت قد تعرضت للاختراق بالفعل بهذا الهجوم: <br><br><img src="https://habrastorage.org/webt/c0/08/1a/c0081aezqosmxqzhoot2qdf5bsg.png"><br><br>  بعد تنشيط القاعدة ، يمكنك التحقيق في جميع أحداث تصعيد الامتياز الأخرى باستخدام واجهة الويب DatAlert: <br><br><img src="https://habrastorage.org/webt/xu/0f/qh/xu0fqhcovoplluhydy9gllxwaiq.png"><br><br>  بعد تكوين هذه القاعدة ، يمكنك مراقبة وحماية هذه الأنواع وغيرها من الثغرات الأمنية المشابهة ، والتحقيق في الأحداث باستخدام كائنات خدمة الدليل AD ، والتحقق من تعرضك لهذه الثغرة الأمنية الحرجة. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar451906/">https://habr.com/ru/post/ar451906/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar451896/index.html">إن eyeDisk "غير قابلة للكسر" محمي بواسطة فحص القزحية ، ولكنه ينقل كلمة مرور بنص واضح</a></li>
<li><a href="../ar451898/index.html">الابتكار في الروسية</a></li>
<li><a href="../ar451900/index.html">المساهمة الأولى لمتصفح API من Facebook</a></li>
<li><a href="../ar451902/index.html">مايكروسوفت أزور المطور كامب روسيا</a></li>
<li><a href="../ar451904/index.html">في بعض الأحيان أكثر أقل. عندما يؤدي انخفاض الحمل إلى زيادة التأخير</a></li>
<li><a href="../ar451908/index.html">تاريخ أجهزة الكمبيوتر: ليلة في متحف ياندكس</a></li>
<li><a href="../ar451912/index.html">شبكة عصبية عميقة من MuseNet تكتب الموسيقى</a></li>
<li><a href="../ar451916/index.html">PHP غير متزامن وقصة دراجة واحدة</a></li>
<li><a href="../ar451918/index.html">إلى مسألة منظمة الشفافية الدولية</a></li>
<li><a href="../ar451920/index.html">تحسين تخزين البريد في Zimbra Collaboration Suite</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>