<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ’‰ ğŸ’…ğŸ» ğŸ‘ƒğŸ» Kerentanan pengecer - tiga kasus di mana OTP dapat diperoleh dalam permintaan ğŸ¥ ğŸ•— ğŸ––ğŸ¿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Saat memasukkan akun pribadi berbagai layanan, untuk tujuan keamanan, 2FA sering digunakan - selain login dan kata sandi, Anda perlu memasukkan kode s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kerentanan pengecer - tiga kasus di mana OTP dapat diperoleh dalam permintaan</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/465791/">  Saat memasukkan akun pribadi berbagai layanan, untuk tujuan keamanan, 2FA sering digunakan - selain login dan kata sandi, Anda perlu memasukkan kode satu kali. <br><br>  Tapi, ternyata, tidak semuanya begitu aman bahkan dengan otentikasi dua faktor - pada tahun lalu saya menemukan tiga (!) Layanan ketika kode masuk satu kali, yang dikirim ke klien melalui SMS, dapat dilihat dalam permintaan itu sendiri. <br><br>  Selanjutnya secara singkat tentang apa yang mengancam dengan contoh-contoh spesifik. <br><br>  <b>1. Jaringan pompa bensin yang populer, lebih dari 500.000 pelanggan terdaftar.</b> <br><br><div class="spoiler">  <b class="spoiler_title">Permintaan saat memasukkan versi web akun pribadi Anda:</b> <div class="spoiler_text"><pre><code class="plaintext hljs">POST https://someazs.ua/ua/profile/auth/ Accept: application/json, text/javascript, */*; q=0.01 Accept-Encoding: gzip, deflate, br Accept-Language: ru,en-US;q=0.9,en;q=0.8,uk;q=0.7 Connection: keep-alive Content-Length: 408 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Cookie: PHPSESSID=6n3l2o90hfb020u9ag020u8ha1; usersomeazs_popupcoupons=1;... Host: someazs.ua Origin: https://someazs.ua Referer: https://someazs.ua/ua/login/ User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36 X-Compress: null X-Requested-With: XMLHttpRequest data[phone_mask]: 951234567 data[phone]: 0951234567</code> </pre> <br></div></div><br><img src="https://habrastorage.org/webt/64/gw/li/64gwlig4jbxmmjgyarfwpk1_lxa.png"><br><br>  Jawaban: <code>{"Status":0,"Code":"7038","status":true,"step2":true}</code> <br><br>  Kode dari SMS - 7038 - hanya terlihat di respons server. <br><a name="habracut"></a><br>  Yaitu, di situs, ketika memasukkan akun pribadi, respons berisi kode masuk satu kali, yang dikirim ke klien melalui SMS - Anda dapat masuk ke akun orang lain dengan hanya menentukan nomor telepon klien dan melihat OTP dalam permintaan itu sendiri. <br><br>  Di akun pribadi Anda tersedia: nomor kartu loyalitas, nama, saldo (bonus dalam UAH, liter, kopi), riwayat transaksi, dalam pengaturan - tanggal lahir, email pelanggan, dll. <br><br><img src="https://habrastorage.org/webt/cy/g1/fc/cyg1fca8yzihzbxvru6nuybbuvi.png"><br><br>  Dengan bantuan tindakan lebih lanjut yang bersifat non-teknis (misalnya, dering pelanggan), dengan keberuntungan yang tepat, orang dapat menggunakan uang klien / liter / kopi.  Mengapa saya menulis "dengan keberuntungan"?  Ketika saya berbicara tentang masalah tersebut, saya diberi tahu bahwa penyelesaian dengan bonus orang lain tidak begitu mudah dilakukan, bahkan jika Anda memiliki akses ke akun tersebut, karena ada cek tambahan.  Namun ... <br><br>  Kesalahan diperbaiki dengan cepat, terima kasih. <br><br><hr><br>  <b>2. Jaringan toko sosial (mirip dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Harga Tetap</a> ), aplikasi seluler (lebih dari 100 ribu unduhan)</b> <br><br><img src="https://habrastorage.org/webt/wx/ps/ib/wxpsibh9vr7yeouxqlrsk65xyy8.png"><br><br>  Saat melacak permintaan melalui Fiddler, saya perhatikan hal berikut.  Saat memasuki aplikasi seluler, setelah memasukkan nomor telepon dan kartu loyalitas, kode satu kali dikirimkan ke klien. <br><br>  Masalahnya adalah bahwa ia menjalankan permintaan GET dari formulir: <br><pre> <code class="xml hljs">https://bulk.somesmssender.com/?sending_method=sms&amp;from=someretailes&amp;user=onviber4821&amp;txt=%D0%9A%D0%BE%D0%B4+%D0%BF%D0%BE%D0%B4%D1%82%D0%B2%D0%B5%D1%80%D0%B6%D0%B4%D0%B5%D0%BD%D0%B8%D1%8F%3A+1234&amp;phone=380987654321&amp;sign=42f66957a03090eb90556b0ef7fed2e1</code> </pre> <br><br>  Kode satu kali itu sendiri terlihat langsung dalam permintaan ini: teks dari SMS yang dikirim adalah <pre> <code class="xml hljs">%D0%9A%D0%BE%D0%B4+%D0%BF%D0%BE%D0%B4%D1%82%D0%B2%D0%B5%D1%80%D0%B6%D0%B4%D0%B5%D0%BD%D0%B8%D1%8F%3A+1234&amp;</code> </pre> <br><br>  Laporan konversi sederhana: Kode + konfirmasi: +1234 <br><br><img src="https://habrastorage.org/webt/dx/vk/iw/dxvkiw2myayp4dj-yys1bqlilka.png"><br><br>  Yaitu  dalam aplikasi itu sendiri, Anda dapat melihat kode mana yang akan dikirim.  Di sini Anda juga dapat masuk ke akun orang lain, sudah tanpa faktor kedua. <br><br>  Untuk beberapa alasan, klien dari jaringan ini adalah yang paling tidak terlindungi dari penipuan, jadi saya mencoba berkali-kali untuk menyampaikan informasi kepada perusahaan.  Saya menulis tiga kali pada bulan Agustus ke alamat yang ditunjukkan pada halaman aplikasi di Play Market - Saya tidak menerima jawaban tunggal, bahkan jawaban otomatis. <br><br>  Kemudian saya menulis ke perusahaan yang layanan distribusi SMS-nya mereka gunakan.  Mereka menjawab kepada saya bahwa perlu untuk menghubungi pemilik aplikasi seluler, karena mereka sendiri tidak dapat mempengaruhi pengembangan dan transfer informasi dari perusahaan ini. <br><br>  Ini benar, tetapi, saya berasumsi bahwa layanan olahpesan dapat memengaruhi mereka sebagai mitra / klien.  Selain itu, alasan saya menulis ke layanan pengiriman adalah bahwa permintaan GET yang saya sebutkan adalah pengembangan mereka, dan ini juga kemungkinan besar terjadi pada klien lain.  Saya menyarankan bahwa layanan diinginkan untuk memperbaiki logika distribusi - bukan untuk mentransmisikan nomor telepon pelanggan dan kode satu kali dalam permintaan - mereka tidak menjawab saya. <br><br><div class="spoiler">  <b class="spoiler_title">Sedikit tentang bagaimana lagi saya mencoba menyampaikan masalahnya</b> <div class="spoiler_text">  Kemudian di situs web toko saya menulis ke email kontak, saya menunggu - dan lagi tidak ada.  Tapi karena saya keras kepala, saya menemukan di situs yang sama semua kemungkinan kontak (baik kotak surat umum dan alamat pribadi) dan menulis kepada mereka - seperti yang Anda tahu, tidak ada yang menjawab juga. <br>  Karena itu, kemudian saya beralih ke obrolan dan langsung di obrolan menanyakan pertanyaan apakah mereka menerima surat saya.  Awalnya mereka menjawab bahwa mereka tidak melihat, kemudian mereka menemukan dan berjanji bahwa mereka akan memberikannya. <br></div></div><br>  Menariknya, selain kurangnya reaksi terhadap email di alamat utama aplikasi, setelah mengobrol saya menerima surat.  Di salah satu dari mereka saya melihat bagaimana mereka membawa saya ke dalam sistem: "Orang pintar" <br><br><img src="https://habrastorage.org/webt/jo/ro/fp/jorofpagidbbwkbn96uoo9itapc.png"><br><br>  Sikap begitu-begitu terhadap klien. <br><br>  Ketika saya terakhir memeriksa, tidak ada perbaikan dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Avrora</a> . <br>  Juga tidak ada koreksi pada bagian dari layanan distribusi, tetapi di sini situasinya lebih serius, jadi saya tidak secara langsung menyebutkan nama layanan tersebut. <br><br><hr><br>  <b>3. Aplikasi seluler untuk menyimpan kartu diskon dan melakukan pembayaran seluler (lebih dari 130 ribu pelanggan)</b> <br><br>  Di pintu masuk, Anda hanya perlu memasukkan email dan kode.  Dalam hal ini, kueri dijalankan: <br><br><pre> <code class="plaintext hljs">POST http://api.somewallet.com/mobileclient.svc/getRegistrationCode HTTP/1.1 Content-Type: application/json; charset=UTF-8 Content-Length: 100 Host: api.somewallet.com Connection: Keep-Alive Accept-Encoding: gzip User-Agent: okhttp/3.12.3 {"request":{"Culture":"ru_RU","DeviceIdentifier":"4514825570005447","Identifier":"some@email"}}</code> </pre> <br>  Inilah jawabannya: <br><br><pre> <code class="plaintext hljs">{"GetRegistrationCodeResult":{"ErrorMessage":{"Code":0,"LogReferenceId":0,"Message":"SUCCESS"},"Data":{"Code":"044912"}}}</code> </pre> <br><br>  Di sini, jawabannya juga menunjukkan kode yang perlu dimasukkan (044912). <br><br>  Setelah masuk, saya mendapat akses ke fungsi-fungsi berikut: <br><br><ul><li>  melihat kartu loyalitas dan bonusnya, </li><li>  kupon untuk toko tertentu, </li><li>  informasi kontak tentang klien (nomor telepon dan email, tanggal lahir dan nama) </li><li>  pengaturan, mengubah dan menghapus kode akses 4 digit, </li><li>  lihat kartu pembayaran </li><li>  menerima token pembayaran (mirip dengan token dari artikel saya sebelumnya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Cara naik taksi dengan biaya orang lain</a> ). </li></ul><br>  Dengan demikian, semua fungsi aplikasi dapat diakses oleh siapa saja yang hanya menunjukkan alamat email pengguna aplikasi ini - Anda tidak perlu mengetahui kode satu kali dari pengguna, karena dapat dilihat segera setelah masuk.  Masalahnya identik dengan dua lainnya. <br><br>  Mereka menanggapi pesan saya, memperbaiki kerentanan dan berterima kasih secara finansial. <br><br><hr><br>  Kami dapat mengatakan bahwa kadang-kadang dalam layanan Anda dapat melewati otentikasi dua faktor hanya dengan melihat permintaan otorisasi.  Dan ini memengaruhi situs web dan aplikasi seluler.  Jadi pada saat Anda mengembangkan atau menguji layanan dengan akun pribadi, perhatikan hal ini. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id465791/">https://habr.com/ru/post/id465791/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id465779/index.html">Yealink T19 Penyediaan otomatis + Buku Alamat Dinamis</a></li>
<li><a href="../id465781/index.html">Bagaimana saya membuat pemecah Okhttp khusus melalui coroutine Kotlin</a></li>
<li><a href="../id465783/index.html">Game dev Rusia, tidak ada artinya dan tanpa ampun</a></li>
<li><a href="../id465787/index.html">Love the Goat</a></li>
<li><a href="../id465789/index.html">Pelatihan Cisco 200-125 CCNA v3.0. Hari 29. PAT dan NAT</a></li>
<li><a href="../id465793/index.html">Frontend Weekly Digest (26 Agustus - 1 September 2019)</a></li>
<li><a href="../id465795/index.html">Intisari bahan-bahan segar dari dunia front-end untuk minggu terakhir No. 378 (26 Agustus - 1 September 2019)</a></li>
<li><a href="../id465797/index.html">Algoritma genetika (atau Klien selalu raja - dan seringkali bodoh)</a></li>
<li><a href="../id465801/index.html">Intisari Desain Makanan, Agustus 2019</a></li>
<li><a href="../id465803/index.html">Maven-cara untuk membangun proyek Go</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>