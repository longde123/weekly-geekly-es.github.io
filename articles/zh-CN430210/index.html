<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚘 ☺️ 🍻 Check Point安全学院测试我的耐心 🤢 👨🏼 ⤴️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="我在哈布雷（Habré）上多次提到Check Point安全学院计划：其实质是Check Point公司在夏季宣布了“夺旗”格式的比赛，参与者的过去经验并不重要，而仅仅是他解开网络的能力难题。 根据这次比赛的结果，该公司招募了20名参与者参加为期3个月的网络安全专业课程，并且从该课程开始时所有参与者...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Check Point安全学院测试我的耐心</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/430210/">我在哈布雷（Habré）上多次提到<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Check Point安全学院</a>计划：其实质是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Check Point</a>公司在夏季宣布了“夺旗”格式的比赛，参与者的过去经验并不重要，而仅仅是他解开网络的能力难题。 根据这次比赛的结果，该公司招募了20名参与者参加为期3个月的网络安全专业课程，并且从该课程开始时所有参与者都将获得KB专家的全薪，并有义务在课程结束后两年内在公司工作。 <br><br><img src="https://habrastorage.org/webt/vf/kb/ix/vfkbixclsmvdnirjojnsjcc5q2k.png"><br>  <i>在CTF比赛中，旗帜甚至可以是图片，例如这样。</i> <br><br> 参赛者的选拔工作已于8月完成，但比赛网站将持续运行至明年夏天，我邀请那些希望报名并出于体育兴趣尝试的人参加比赛。 比赛由12个不同复杂程度的难题组成，评分为10到150分。 <br> 在这里，我想解析“惊喜”类别中的“测试我的耐心”难题。 她中等难度（50分），这是她的全文： <br><blockquote> 你好 <br> 我们在本地制表者的计算机上找到了<a href="">此</a>可执行文件。 <br> 有传言说，制表师是唯一成功破解它的人。 <br> 认为您和制表师一样好吗？ <br>  <b>注意：此文件绝不是恶意文件</b> </blockquote>通过引用-Windows的32位二进制文​​件， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">某些杀毒软件</a>对此<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">发誓</a> ，但是如果您仍然运行它，它将看起来像这样： <br><br><img src="https://habrastorage.org/webt/iw/x_/_f/iwx__foij5pljrqee4346ldcgqy.png"><br><br> 二进制文件内部被加密； 它拒绝在调试器下运行； 如果尝试在调试器运行时将其连接到该调试器，它将立即终止。 可能是Check Point的专家将他们的难题包裹在一个从某种恶意中借来的加密打包机中。 <br><br> 我们如何猜测制表商所组成的数字？ <br><a name="habracut"></a><br> 有两种方法。 第一个可以有条件地称为“有力量，没关系”：如果无法实时调试程序，那么我们将调试死的程序！ <br><br> 启动32位任务管理器（\ Windows \ SysWOW64 \ taskmgr.exe），右键单击神秘进程，然后选择“创建转储文件”。  （用于32位进程的64位任务管理器创建了wow64cpu仿真器的转储，这更难使用。） <br><br> 我们查看转储，发现至少其中的行已被解密： <br><br><img src="https://habrastorage.org/webt/ug/fx/u-/ugfxu-y-1tgtxfjbhjb-zx7gmlg.png"><br><br> 但是带有隐藏数字或标志的行尚不可见。 <br><br> 我们转向主要口径武器：WinDbg（X86）-&gt; Open Crash Dump ... <br><br><img src="https://habrastorage.org/webt/kz/em/by/kzemby77zuk_wllg194irxj864y.png"><br><br> 我们想看到的行在内存中的位置写着“好，我的朋友！”？ <br>  <code>lm</code>命令允许您确定二进制文件是从<code>01140000</code>加载到<code>015b2000</code> ； 然后<code>sa 01140000 015b2000 "Good job my friend!"</code> 在<code>0115a0d0</code>找到搜索字符串： <br><br><img src="https://habrastorage.org/webt/3g/nu/ed/3gnuedahkhiapktjyob3fsxavto.png"><br><br> 现在，让我们查找该行的打印位置：也许某个命令包含的字节<code>d0 a0 15 01</code>对应于您要查找的行的地址？  （ <code>sb 01140000 015b2000 d0 a0 15 01</code> ） <br><br> 祝你好运！  -发现了这样的团队： <br><br><img src="https://habrastorage.org/webt/rm/5v/ah/rm5vah4nctvyf7bewf8uy-dkzbo.png"><br><br> 此命令的代码是什么？  （ <code>ub 011412f7; u 011412f7</code> ） <br><br><img src="https://habrastorage.org/webt/xx/oc/kx/xxockxynmnfarqsjejxdghowqk8.png"><br><br> 我们看到，根据功能<code>01141180</code>的结果，打印的是所需的消息，还是“错误的...”。 <br><br> 功能代码<code>01141180</code>占据三个屏幕； 很容易看出这是<code>strcmp()</code>的实现，其中添加了<code>Sleep(700)</code>调用。 目前尚不清楚为什么会有<code>Sleep()</code> ; 但它仍然不会影响函数的结果，因此我们最好弄清楚要比较的字符串： <br><br><img src="https://habrastorage.org/webt/kz/ie/l3/kziel3yw1_p5f74wyjngg-aam2k.png"><br><br>  <code>ebp-14h</code>两个等于<code>ebp-14h</code>和<code>ebp-24h</code>指针； 第二个作为<code>011410b0</code>传递给函数<code>011410b0</code> 。 <br> 这不是要求隐藏号码的功能吗？ 让我们检查调用堆栈（ <code>k</code> ）： <br><br><img src="https://habrastorage.org/webt/8t/ov/tl/8tovtlh8uebmq10eb5hwfbaa_nq.png"><br><br> 是的，是她！ <br><br> 难题的一般方案现在很清楚：将用户的预感存储在<code>ebp-24h</code> ，将<code>ebp-14h</code>的数字存储在<code>ebp-24h</code> <code>ebp-14h</code> ，然后将它们进行比较，然后打印“好，我的朋友！”或“错了……”。 <br><br> 剩下的就是从堆栈帧中提取隐藏的数字。 我们已经从调用堆栈中知道了他的<code>ebp</code> ： <br><br><img src="https://habrastorage.org/webt/p1/eq/qo/p1eqqone8e7i_kszzwojdlq8goa.png"><br><br> 来吧，来吧... <br><br><img src="https://habrastorage.org/webt/zn/zo/yk/znzoyk99atyzq37hewnooffjvsu.png"><br><br> 成功！ 您可以打开一些美味的软木塞。 <br><br> 但是留下了三个神秘的东西，没有解释： <ol><li> 为什么<code>Sleep(700)</code>的<code>strcmp()</code> <code>Sleep(700)</code>内调用<code>Sleep(700)</code> ？ </li><li> 为什么当我们输入隐藏号码时，程序在打印“我的朋友好！”之前冻结了十秒钟？ </li><li> 制表师与这个难题有什么关系？ </li></ol><br> 因此，事实证明，还有第二种（更智能的）方式来猜测所猜测的数字。 如果您只是随机尝试数字0-9，则很容易注意到该程序在9个数字上“挂起”了一点。 如果尝试使用数字90-99，则可以看到在数字98上程序“冻结”的时间是原来的两倍。  （发现其胆量之后，我们已经了解了问题所在：每对字符的成功比较会导致0.7 s的延迟。）要解决这个难题，甚至无需启动调试器，只需选择下一位数字就可以了，这样，答案答案之前的延迟就可以手动增加使用精确的秒表或简单的脚本。 因此，当测量和分析直至错误消息的时间时，编译器暗示了一种<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">攻击密码算法的长期方法</a> 。 <br><br> 但是，在我看来，学习如何获取包裹在未知加密打包程序中的程序既有趣又有价值：-) <br><br> 请注意，我们不需要弄清楚二进制文件是如何加密的，或者带有您看到的数字的字符串如何显示在堆栈上（我们在转储中看到它不在字符串常量中）-我们设法做好了准备，为此大约一打WinDbg命令就足够了。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN430210/">https://habr.com/ru/post/zh-CN430210/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN430200/index.html">在加密货币市场崩溃和采矿兴趣下降的情况下，英伟达的股价下跌</a></li>
<li><a href="../zh-CN430202/index.html">使用DirectX 11在C ++中编写成对相互作用的粒子系统</a></li>
<li><a href="../zh-CN430204/index.html">麻省理工学院的课程“计算机系统安全”。 讲座18：“私人互联网浏览”，第1部分</a></li>
<li><a href="../zh-CN430206/index.html">麻省理工学院的课程“计算机系统安全”。 第18课：私人浏览Internet，第2部分</a></li>
<li><a href="../zh-CN430208/index.html">麻省理工学院的课程“计算机系统安全”。 讲座18：“私人互联网浏览”，第3部分</a></li>
<li><a href="../zh-CN430212/index.html">OpenSceneGraph：场景几何基础</a></li>
<li><a href="../zh-CN430216/index.html">据我了解，我吃了很多甜食，或者按申请中的支票分类商品</a></li>
<li><a href="../zh-CN430218/index.html">能源优化STM32：实用指南</a></li>
<li><a href="../zh-CN430220/index.html">如何将“百年纪念” USB集线器变成智能托管并节省300美元</a></li>
<li><a href="../zh-CN430222/index.html">寻找工作的高级工程师。 我如何接受20次人力资源采访以​​及对此的看法</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>