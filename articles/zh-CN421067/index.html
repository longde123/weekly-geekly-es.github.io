<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘ˆğŸ» ğŸ‘¨ğŸ¼â€ğŸ¤â€ğŸ‘¨ğŸ» ğŸ•˜ æˆ‘ä»¬å¦‚ä½•å¼€å‘ç”¨äºå®¡æŸ¥å†å²åœ°ç‚¹çš„ARåº”ç”¨ç¨‹åº âœˆï¸ ğŸ‘¸ğŸ¿ ğŸ›ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æœ€è¿‘ï¼Œæˆ‘ä»¬å°†æ—§æŠ€æœ¯ä¸ç°ä»£æŠ€æœ¯ç»“åˆåœ¨ä¸€èµ·ï¼Œå…¶ä¸­çš„å†…å®¹è¢«åˆ å‡äº†ã€‚ 

 å¢å¼ºç°å® 
 ä½œä¸ºåŸå¸‚æŒ‡å—çš„å¢å¼ºç°å®åº”ç”¨ç¨‹åºæ˜¯ä¸€ä¸ªä¼—æ‰€å‘¨çŸ¥çš„ä¸»é¢˜ï¼Œå¹¶ç”±è®¸å¤šå¼€å‘äººå‘˜å®æ–½ã€‚ ä½¿ç”¨ARçš„æ–¹å‘æ˜¯ç¬¬ä¸€ä¸ªï¼Œå› ä¸ºå®ƒå…è®¸æ‚¨ä½¿ç”¨å¢å¼ºç°å®çš„æ‰€æœ‰æ˜¾è€Œæ˜“è§çš„å¯èƒ½æ€§ï¼šå‘ç”¨æˆ·æ˜¾ç¤ºæœ‰å…³å»ºç­‘ç‰©çš„ä¿¡æ¯ï¼Œæä¾›æœ‰å…³æœºæ„å·¥ä½œçš„ä¿¡æ¯å¹¶ç†Ÿæ‚‰æ™¯ç‚¹ã€‚ åœ¨å…¬å¸...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>æˆ‘ä»¬å¦‚ä½•å¼€å‘ç”¨äºå®¡æŸ¥å†å²åœ°ç‚¹çš„ARåº”ç”¨ç¨‹åº</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/lodoss/blog/421067/"><img src="https://habrastorage.org/webt/iy/gx/ir/iygxirzoaz4v6phrwhfplokazzu.jpeg"><br><br> æœ€è¿‘ï¼Œæˆ‘ä»¬å°†æ—§æŠ€æœ¯ä¸ç°ä»£æŠ€æœ¯ç»“åˆåœ¨ä¸€èµ·ï¼Œå…¶ä¸­çš„å†…å®¹è¢«åˆ å‡äº†ã€‚ <br><a name="habracut"></a><br><h2> å¢å¼ºç°å® </h2><br> ä½œä¸ºåŸå¸‚æŒ‡å—çš„å¢å¼ºç°å®åº”ç”¨ç¨‹åºæ˜¯ä¸€ä¸ªä¼—æ‰€å‘¨çŸ¥çš„ä¸»é¢˜ï¼Œå¹¶ç”±è®¸å¤šå¼€å‘äººå‘˜å®æ–½ã€‚ ä½¿ç”¨ARçš„æ–¹å‘æ˜¯ç¬¬ä¸€ä¸ªï¼Œå› ä¸ºå®ƒå…è®¸æ‚¨ä½¿ç”¨å¢å¼ºç°å®çš„æ‰€æœ‰æ˜¾è€Œæ˜“è§çš„å¯èƒ½æ€§ï¼šå‘ç”¨æˆ·æ˜¾ç¤ºæœ‰å…³å»ºç­‘ç‰©çš„ä¿¡æ¯ï¼Œæä¾›æœ‰å…³æœºæ„å·¥ä½œçš„ä¿¡æ¯å¹¶ç†Ÿæ‚‰æ™¯ç‚¹ã€‚ åœ¨å…¬å¸å†…éƒ¨ä¸¾è¡Œçš„æœ€åä¸€æ¬¡é»‘å®¢é©¬æ‹‰æ¾ä¸­ï¼Œæå‡ºäº†å‡ ä¸ªä½¿ç”¨å¢å¼ºç°å®çš„é¡¹ç›®ï¼Œæˆ‘ä»¬æƒ³åˆ°äº†åˆ›å»ºä¸€ä¸ªARåº”ç”¨ç¨‹åºçš„æƒ³æ³•ï¼Œè¯¥åº”ç”¨ç¨‹åºå°†æ˜¾ç¤ºè¿‡å»çš„åœ°æ ‡æˆ–å†å²ä½ç½®ã€‚ ä¸ºæ­¤ï¼Œè¯·å°†ç°ä»£å¢å¼ºç°å®æŠ€æœ¯ä¸æ—§ç…§ç‰‡ç»“åˆèµ·æ¥ã€‚ ä¾‹å¦‚ï¼Œé¢å¯¹åœ£ä»¥æ’’å¤§æ•™å ‚ï¼Œæ‚¨å¯ä»¥å°†æ™ºèƒ½æ‰‹æœºæ‘„åƒå¤´å¯¹å‡†ä»–ï¼Œå¹¶æŸ¥çœ‹ä»–çš„ç¬¬ä¸€åº§æœ¨åˆ¶å»ºç­‘ç‰©ï¼Œè¯¥å»ºç­‘ç‰©äº1715å¹´è¢«æ‹†æ¯ã€‚ <br><br> å·¥ä½œåŸç†å¦‚ä¸‹ï¼šè¯¥åº”ç”¨ç¨‹åºåœ¨åœ°å›¾ä¸Šæ˜¾ç¤ºåŸå¸‚çš„ç»™å®šå†å²æ™¯ç‚¹å’Œæ™¯ç‚¹ï¼Œæ˜¾ç¤ºæœ‰å…³åŸå¸‚çš„ç®€è¦ä¿¡æ¯ï¼Œå¹¶é€šè¿‡é€šçŸ¥çš„æ–¹å¼é€šçŸ¥ç”¨æˆ·ä»–ç¦»æœ‰è¶£çš„åœ°æ–¹ä¸è¿œã€‚ å½“ä¸€ä¸ªäººèµ°è¿‘40ç±³çš„å†å²å¤è¿¹æ—¶ï¼ŒARæ¨¡å¼å¯ç”¨ã€‚ åŒæ—¶ï¼Œç›¸æœºæ‰“å¼€ï¼Œæœ‰å…³å¯¹è±¡çš„ç®€è¦ä¿¡æ¯ç›´æ¥æ˜¾ç¤ºåœ¨ç”¨æˆ·å‘¨å›´çš„ç©ºé—´ä¸­ã€‚ åè€…å…·æœ‰ä¸è™šæ‹Ÿå¯¹è±¡è¿›è¡Œäº¤äº’çš„èƒ½åŠ›ï¼šé€šè¿‡è§¦æ‘¸å†å²ä½ç½®çš„å¡ç‰‡ï¼Œæ‚¨å¯ä»¥ç»§ç»­æŸ¥çœ‹å¸¦æœ‰å›¾åƒçš„ç›¸å†Œã€‚ <br><br> çœ‹èµ·æ¥è¯¥åº”ç”¨ç¨‹åºéå¸¸ç®€å•ï¼Œä½†æ˜¯å³ä½¿åœ¨è¿™é‡Œä¹Ÿå­˜åœ¨ä¸€äº›é™·é˜±ã€‚ æˆ‘ä¸ä¼šè®²ä¸€ä¸ªçç¢çš„äº‹æƒ…çš„æ•…äº‹ï¼Œä¾‹å¦‚ä»æœåŠ¡å™¨ä¸‹è½½æ•°æ®æˆ–åœ¨åœ°å›¾ä¸Šæ˜¾ç¤ºç‚¹ï¼Œæˆ‘å°†ç›´æ¥ä»‹ç»å¼•èµ·é—®é¢˜çš„åŠŸèƒ½ã€‚ <br><br><h2> é—®é¢˜1.æµ®ç‚¹æ•° </h2><br> å› æ­¤ï¼Œé¦–å…ˆè¦åšçš„æ˜¯æ ¹æ®å†å²ä½ç½®ç›¸å¯¹äºå½“å‰ä½ç½®çš„å®é™…ä½ç½®ä»¥åŠç”¨æˆ·æ³¨è§†çš„æ–¹å‘å°†æ ‡è®°ç‚¹æ”¾ç½®åœ¨ç©ºé—´ä¸­ã€‚ <br><br> é¦–å…ˆï¼Œæˆ‘ä»¬å†³å®šä½¿ç”¨å·²ç»ä¸ºiOSå‡†å¤‡çš„åº“ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ARKit-CoreLocation</a> ã€‚ è¯¥é¡¹ç›®ä½äºå…¬å…±é¢†åŸŸçš„GitHubä¸Šï¼Œé™¤ä¸»è¦ç±»çš„ä»£ç å¤–ï¼Œè¿˜åŒ…å«é›†æˆç¤ºä¾‹ï¼Œå¹¶ä½¿æˆ‘ä»¬èƒ½å¤Ÿåœ¨å‡ ä¸ªå°æ—¶å†…å®Œæˆæˆ‘ä»¬æ„Ÿå…´è¶£çš„ä»»åŠ¡ã€‚ åªéœ€è¦å‘åº“æä¾›ç‚¹çš„åæ ‡å’Œç”¨ä½œæ ‡è®°çš„å›¾åƒã€‚ <br><br> æ¯«ä¸å¥‡æ€ªï¼Œè¿™ç§è½»æ¾å¿…é¡»ä»˜å‡ºã€‚ æ ‡è®°ç‚¹ä¸æ–­åœ¨å¤ªç©ºä¸­æ¼‚æµ®ï¼šå®ƒä»¬è¦ä¹ˆçˆ¬åˆ°å¤©èŠ±æ¿ä¸Šï¼Œè¦ä¹ˆè¢«ç»˜åˆ¶åœ¨è„šä¸‹çš„æŸä¸ªåœ°æ–¹ã€‚ å¹¶éæ¯ä¸ªç”¨æˆ·éƒ½åŒæ„åœ¨å‡ åˆ†é’Ÿå†…æŠ“ä½ARå¯¹è±¡çš„ç„¦ç‚¹ï¼Œä»¥ç†Ÿæ‚‰ä»–æ„Ÿå…´è¶£çš„ä¿¡æ¯ã€‚ <br><br> äº‹å®è¯æ˜ï¼Œè®¸å¤šäººéƒ½é‡åˆ°äº†è¯¥åº“é”™è¯¯ï¼Œä½†å°šæœªæ‰¾åˆ°è§£å†³æ–¹æ¡ˆã€‚ ä¸å¹¸çš„æ˜¯ï¼ŒGitHubä¸Šçš„ä»£ç æ²¡æœ‰æ›´æ–°è¶…è¿‡å…­ä¸ªæœˆï¼Œæ‰€ä»¥æˆ‘ä¸å¾—ä¸ç»•è¿‡å®ƒã€‚ <br><br> æˆ‘ä»¬å°è¯•ä½¿ç”¨æµ·æ‹”é«˜åº¦è€Œä¸æ˜¯åæ ‡ä¸­çš„å›ºå®šæµ·æ‹”é«˜åº¦ï¼ŒLocationManagerä¼šé’ˆå¯¹ç”¨æˆ·çš„å½“å‰ä½ç½®è¿”å›è¯¥æµ·æ‹”é«˜åº¦ã€‚ ä½†æ˜¯ï¼Œè¿™å¹¶ä¸èƒ½å®Œå…¨æ¶ˆé™¤é—®é¢˜ã€‚ ç”¨æ‰‹æ‰­è½¬è®¾å¤‡åï¼Œæ¥è‡ªä½ç½®ç®¡ç†å™¨çš„æ•°æ®å°±å¼€å§‹ä»¥é«˜è¾¾60ç±³çš„è·ç¦»è·³è·ƒã€‚ ç»“æœï¼Œå›¾ç‰‡å˜å¾—ä¸ç¨³å®šï¼Œè¿™å½“ç„¶ä¸é€‚åˆæˆ‘ä»¬ã€‚ <br><br> ç»“æœï¼Œå†³å®šæ”¾å¼ƒARKit-CoreLocationåº“ï¼Œå¹¶è‡ªè¡Œåœ¨ç©ºé—´ä¸­æ”¾ç½®ç‚¹ã€‚  Christopher Web-Orensteinæ’°å†™çš„æ–‡ç« ARKitå’ŒCoreLocationå¯¹æ­¤èµ·åˆ°äº†å¾ˆå¤§ä½œç”¨ã€‚ æˆ‘ä¸å¾—ä¸èŠ±æ›´å¤šçš„æ—¶é—´å¹¶åˆ·æ–°å†…å­˜ä¸­çš„ä¸€äº›æ•°å­¦æ–¹é¢ï¼Œä½†æ˜¯ç»“æœå´æ˜¯å€¼å¾—çš„ï¼šARå¯¹è±¡ç»ˆäºå¯ä»¥ä»£æ›¿å®ƒä»¬äº†ã€‚ ä¹‹åï¼Œä»…éœ€æ²¿Yè½´æ•£å¸ƒå®ƒä»¬å³å¯ä½¿æ ‡ç­¾å’Œç‚¹æ›´æ˜“äºé˜…è¯»ï¼Œå¹¶åœ¨ä»å½“å‰ä½ç½®åˆ°è¯¥ç‚¹çš„è·ç¦»ä¸ARå¯¹è±¡çš„Zåæ ‡ä¹‹é—´å»ºç«‹å¯¹åº”å…³ç³»ï¼Œä»è€Œä½¿æœ‰å…³æœ€è¿‘å†å²ä½ç½®çš„ä¿¡æ¯æˆä¸ºå‰æ™¯ã€‚ <br><br> æœ‰å¿…è¦è®¡ç®—æ–°çš„SCNNodeåœ¨ç©ºé—´ä¸­çš„ä½ç½®ï¼Œç€é‡äºåæ ‡ï¼š <br><br><pre><code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> place = PlaceNode() <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> locationTransform = MatrixHelper.transformMatrix(<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: matrix_identity_float4x4, originLocation: curUserLocation, location: nodeLocation, yPosition: pin.yPos, shouldScaleByDistance: <span class="hljs-literal"><span class="hljs-literal">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> nodeAnchor = ARAnchor(transform: locationTransform) scene.session.<span class="hljs-keyword"><span class="hljs-keyword">add</span></span>(anchor: nodeAnchor) scene.scene.rootNode.addChildNode(place)</code> </pre> <br> ä»¥ä¸‹å‡½æ•°å·²æ·»åŠ åˆ°MatrixHelperç±»ï¼š <br><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MatrixHelper</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">transformMatrix</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">for</span></span></span></span><span class="hljs-function"><span class="hljs-params"> matrix: simd_float4x4, originLocation: CLLocation, location: CLLocation, yPosition: Float)</span></span></span></span> -&gt; simd_float4x4 { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> distanceToPoint = <span class="hljs-type"><span class="hljs-type">Float</span></span>(location.<span class="hljs-built_in"><span class="hljs-built_in">distance</span></span>(from: originLocation)) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> distanceToNode = (<span class="hljs-number"><span class="hljs-number">10</span></span> + distanceToPoint/<span class="hljs-number"><span class="hljs-number">1000.0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> bearing = <span class="hljs-type"><span class="hljs-type">GLKMathDegreesToRadians</span></span>(<span class="hljs-type"><span class="hljs-type">Float</span></span>(originLocation.coordinate.direction(to: location.coordinate))) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> position = vector_float4(<span class="hljs-number"><span class="hljs-number">0.0</span></span>, yPosition, -distanceToNode, <span class="hljs-number"><span class="hljs-number">0.0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> translationMatrix = <span class="hljs-type"><span class="hljs-type">MatrixHelper</span></span>.translationMatrix(with: matrix_identity_float4x4, <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: position) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> rotationMatrix = <span class="hljs-type"><span class="hljs-type">MatrixHelper</span></span>.rotateAroundY(with: matrix_identity_float4x4, <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: bearing) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> transformMatrix = simd_mul(rotationMatrix, translationMatrix) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> simd_mul(matrix, transformMatrix) } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">translationMatrix</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(with matrix: matrix_float4x4, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">for</span></span></span></span><span class="hljs-function"><span class="hljs-params"> translation : vector_float4)</span></span></span></span> -&gt; matrix_float4x4 { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> matrix = matrix matrix.columns.<span class="hljs-number"><span class="hljs-number">3</span></span> = translation <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> matrix } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rotateAroundY</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(with matrix: matrix_float4x4, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">for</span></span></span></span><span class="hljs-function"><span class="hljs-params"> degrees: Float)</span></span></span></span> -&gt; matrix_float4x4 { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> matrix : matrix_float4x4 = matrix matrix.columns.<span class="hljs-number"><span class="hljs-number">0</span></span>.x = cos(degrees) matrix.columns.<span class="hljs-number"><span class="hljs-number">0</span></span>.z = -sin(degrees) matrix.columns.<span class="hljs-number"><span class="hljs-number">2</span></span>.x = sin(degrees) matrix.columns.<span class="hljs-number"><span class="hljs-number">2</span></span>.z = cos(degrees) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> matrix.inverse } }</code> </pre><br> ä¸ºäº†è®¡ç®—æ–¹ä½è§’ï¼Œæ·»åŠ äº†æ‰©å±•<b>CLLocationCoordinate2D</b> <br><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CLLocationCoordinate2D</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calculateBearing</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(to coordinate: CLLocationCoordinate2D)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Double</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> a = sin(coordinate.longitude.toRadians() - longitude.toRadians()) * cos(coordinate.latitude.toRadians()) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> b = cos(latitude.toRadians()) * sin(coordinate.latitude.toRadians()) - sin(latitude.toRadians()) * cos(coordinate.latitude.toRadians()) * cos(coordinate.longitude.toRadians() - longitude.toRadians()) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> atan2(a, b) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">direction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(to coordinate: CLLocationCoordinate2D)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">CLLocationDirection</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.calculateBearing(to: coordinate).toDegrees() } }</code> </pre><br><h2> é—®é¢˜2ï¼šè¿‡å¤šçš„ARå¯¹è±¡ </h2><br> æˆ‘ä»¬é‡åˆ°çš„ä¸‹ä¸€ä¸ªé—®é¢˜æ˜¯å¤§é‡çš„ARå¯¹è±¡ã€‚ æˆ‘ä»¬åŸå¸‚ä¸­æœ‰è®¸å¤šå†å²å¤è¿¹å’Œæ™¯ç‚¹ï¼Œå› æ­¤éª°å­ä¸ä¿¡æ¯èåˆå¹¶ç›¸äº’çˆ¬è¡Œã€‚ ç”¨æˆ·å¾ˆéš¾è¾¨è®¤å‡ºéƒ¨åˆ†é“­æ–‡ï¼Œè¿™å¯èƒ½ä¼šç»™äººç•™ä¸‹ä»¤äººåæ„Ÿçš„å°è±¡ã€‚ åå•†åï¼Œæˆ‘ä»¬å†³å®šé™åˆ¶åŒæ—¶æ˜¾ç¤ºçš„ARå¯¹è±¡çš„æ•°é‡ï¼Œåªä¿ç•™è·å½“å‰ä½ç½®500ç±³åŠå¾„èŒƒå›´å†…çš„ç‚¹ã€‚ <br><br> ä½†æ˜¯ï¼Œåœ¨æŸäº›åœ°åŒºï¼Œç§¯åˆ†çš„é›†ä¸­åº¦ä»ç„¶å¾ˆé«˜ã€‚ å› æ­¤ï¼Œä¸ºäº†å¢åŠ å¯è§æ€§ï¼Œä»–ä»¬å†³å®šä½¿ç”¨ç¾¤é›†ã€‚ åœ¨åœ°å›¾å±å¹•ä¸Šï¼Œç”±äºMapKitä¸­åµŒå…¥äº†é€»è¾‘ï¼Œå› æ­¤é»˜è®¤æƒ…å†µä¸‹æ­¤åŠŸèƒ½å¯ç”¨ï¼Œä½†æ˜¯åœ¨ARæ¨¡å¼ä¸‹ï¼Œå¿…é¡»æ‰‹åŠ¨å®ç°ã€‚ <br><br> èšç±»åŸºäºä»å½“å‰ä½ç½®åˆ°ç›®æ ‡çš„è·ç¦»ã€‚ å› æ­¤ï¼Œå¦‚æœè¯¥ç‚¹è½å…¥åŠå¾„ç­‰äºç”¨æˆ·ä¸åˆ—è¡¨ä¸­å…ˆå‰å¸å¼•ç‚¹ä¹‹é—´è·ç¦»çš„ä¸€åŠçš„åŒºåŸŸä¸­ï¼Œåˆ™è¯¥ç‚¹å°†ç®€å•åœ°éšè—èµ·æ¥å¹¶æˆä¸ºç¾¤é›†çš„ä¸€éƒ¨åˆ†ã€‚ å½“ç”¨æˆ·æ¥è¿‘å®ƒæ—¶ï¼Œè·ç¦»å‡å°ï¼Œå¹¶ä¸”ç¾¤é›†åŒºåŸŸçš„åŠå¾„ç›¸åº”å‡å°ï¼Œå› æ­¤ä½äºé™„è¿‘çš„æ™¯ç‚¹ä¸ä¼šåˆå¹¶åˆ°ç¾¤é›†ä¸­ã€‚ ä¸ºäº†åœ¨è§†è§‰ä¸ŠåŒºåˆ†å•ä¸ªç‚¹çš„èšç±»ï¼Œæˆ‘ä»¬å†³å®šæ›´æ”¹æ ‡è®°çš„é¢œè‰²ï¼Œå¹¶æ˜¾ç¤ºARä¸­çš„å¯¹è±¡æ•°è€Œä¸æ˜¯åœ°åã€‚ <br><br><img src="https://habrastorage.org/webt/xp/pd/t2/xppdt23ercvm5gapt8bmsh0df3g.png" alt="å›¾ç‰‡"><br><br> ä¸ºäº†ç¡®ä¿ARå¯¹è±¡çš„äº¤äº’æ€§ï¼Œå°†UITapGestureRecognizeræŒ‚åœ¨ARSCNViewä¸Šï¼Œå¹¶ä½¿ç”¨hitTestæ–¹æ³•åœ¨å¤„ç†ç¨‹åºä¸­æ£€æŸ¥ç”¨æˆ·å•å‡»äº†å“ªä¸ªSCNNodeå¯¹è±¡ã€‚ å¦‚æœç»“æœæ˜¯é™„è¿‘æ™¯ç‚¹çš„ç…§ç‰‡ï¼Œåˆ™è¯¥åº”ç”¨ç¨‹åºä»¥å…¨å±æ¨¡å¼æ‰“å¼€ç›¸åº”çš„ç›¸å†Œã€‚ <br><br><h2> é—®é¢˜3ã€‚é›·è¾¾ </h2><br> åœ¨å®æ–½è¯¥åº”ç”¨ç¨‹åºæœŸé—´ï¼Œæœ‰å¿…è¦åœ¨å°å‹é›·è¾¾ä¸Šæ˜¾ç¤ºè¿™äº›ç‚¹ã€‚ ä»ç†è®ºä¸Šè®²ï¼Œä¸åº”è¯¥æœ‰ä»»ä½•è¯¯è§£ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»è®¡ç®—äº†åˆ°è¯¥ç‚¹çš„æ–¹ä½è§’å’Œè·ç¦»ï¼Œç”šè‡³è®¾æ³•å°†å®ƒä»¬è½¬æ¢ä¸º3Dåæ ‡ã€‚ åªéœ€è¦å°†ç‚¹æ”¾ç½®åœ¨å±å¹•ä¸Šçš„äºŒç»´ç©ºé—´ä¸­å³å¯ã€‚ <br><br><img src="https://habrastorage.org/webt/xz/kk/4f/xzkk4fdfzasalo_b8bsb7x-geri.png"><br><br> ä¸ºäº†é¿å…é‡è¹ˆè¦†è¾™ï¼Œä»–ä»¬è½¬å‘äº†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Radar</a>åº“ï¼Œè¯¥åº“çš„å¼€æºä»£ç å‘å¸ƒåœ¨GitHubä¸Šã€‚ è¯¥ç¤ºä¾‹ç”ŸåŠ¨ç”ŸåŠ¨çš„é¢„è§ˆå’Œçµæ´»çš„è®¾ç½®ä»¤äººé¼“èˆï¼Œä½†å®é™…ä¸Šï¼Œè¿™äº›ç‚¹ç›¸å¯¹äºç©ºé—´ä¸­çš„çœŸå®ä½ç½®æ˜¯åç§»çš„ã€‚ åœ¨èŠ±äº†ä¸€äº›æ—¶é—´å°è¯•æ ¡æ­£å…¬å¼ä¹‹åï¼Œæˆ‘ä»¬è½¬å‘äº†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">iPhone Augmented Reality Toolkitä¸­</a>æè¿°çš„ä¸å¤ªç¾è§‚ä½†å¯é çš„é€‰é¡¹ï¼š <br><br><pre> <code class="hljs pgsql">func place(dot: Dot) { var y: CGFloat = <span class="hljs-number"><span class="hljs-number">0.0</span></span> var x: CGFloat = <span class="hljs-number"><span class="hljs-number">0.0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> degree &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> { degree += <span class="hljs-number"><span class="hljs-number">360</span></span> } let bearing = dot.bearing.toRadians() let radius: CGFloat = <span class="hljs-number"><span class="hljs-number">60.0</span></span> // radius <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the radar <span class="hljs-keyword"><span class="hljs-keyword">view</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bearing &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; bearing &lt; .pi / <span class="hljs-number"><span class="hljs-number">2</span></span>) { //the <span class="hljs-number"><span class="hljs-number">1</span></span> quadrant <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the radar x = radius + CGFloat(cosf(<span class="hljs-type"><span class="hljs-type">Float</span></span>((.pi / <span class="hljs-number"><span class="hljs-number">2</span></span>) - bearing)) * <span class="hljs-type"><span class="hljs-type">Float</span></span>(dot.distance)) y = radius - CGFloat(sinf(<span class="hljs-type"><span class="hljs-type">Float</span></span>((.pi / <span class="hljs-number"><span class="hljs-number">2</span></span>) - bearing)) * <span class="hljs-type"><span class="hljs-type">Float</span></span>(dot.distance)) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bearing &gt; .pi / <span class="hljs-number"><span class="hljs-number">2.0</span></span> &amp;&amp; bearing &lt; .pi) { //the <span class="hljs-number"><span class="hljs-number">2</span></span> quadrant <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the radar x = radius + CGFloat(cosf(<span class="hljs-type"><span class="hljs-type">Float</span></span>(bearing - (.pi / <span class="hljs-number"><span class="hljs-number">2</span></span>))) * <span class="hljs-type"><span class="hljs-type">Float</span></span>(dot.distance)) y = radius + CGFloat(sinf(<span class="hljs-type"><span class="hljs-type">Float</span></span>(bearing - (.pi / <span class="hljs-number"><span class="hljs-number">2</span></span>))) * <span class="hljs-type"><span class="hljs-type">Float</span></span>(dot.distance)) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bearing &gt; .pi &amp;&amp; bearing &lt; (<span class="hljs-number"><span class="hljs-number">3</span></span> * .pi / <span class="hljs-number"><span class="hljs-number">2</span></span>)) { //the <span class="hljs-number"><span class="hljs-number">3</span></span> quadrant <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the radar x = radius - CGFloat(cosf(<span class="hljs-type"><span class="hljs-type">Float</span></span>((<span class="hljs-number"><span class="hljs-number">3</span></span> * .pi / <span class="hljs-number"><span class="hljs-number">2</span></span>) - bearing)) * <span class="hljs-type"><span class="hljs-type">Float</span></span>(dot.distance)) y = radius + CGFloat(sinf(<span class="hljs-type"><span class="hljs-type">Float</span></span>((<span class="hljs-number"><span class="hljs-number">3</span></span> * .pi / <span class="hljs-number"><span class="hljs-number">2</span></span>) - bearing)) * <span class="hljs-type"><span class="hljs-type">Float</span></span>(dot.distance)) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bearing &gt; (<span class="hljs-number"><span class="hljs-number">3</span></span> * .pi / <span class="hljs-number"><span class="hljs-number">2.0</span></span>) &amp;&amp; bearing &lt; (<span class="hljs-number"><span class="hljs-number">2</span></span> * .pi)) { //the <span class="hljs-number"><span class="hljs-number">4</span></span> quadrant <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the radar x = radius - CGFloat(cosf(<span class="hljs-type"><span class="hljs-type">Float</span></span>(bearing - (<span class="hljs-number"><span class="hljs-number">3</span></span> * .pi / <span class="hljs-number"><span class="hljs-number">2</span></span>))) * <span class="hljs-type"><span class="hljs-type">Float</span></span>(dot.distance)) y = radius - CGFloat(sinf(<span class="hljs-type"><span class="hljs-type">Float</span></span>(bearing - (<span class="hljs-number"><span class="hljs-number">3</span></span> * .pi / <span class="hljs-number"><span class="hljs-number">2</span></span>))) * <span class="hljs-type"><span class="hljs-type">Float</span></span>(dot.distance)) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bearing == <span class="hljs-number"><span class="hljs-number">0</span></span>) { x = radius y = radius - CGFloat(dot.distance) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bearing == .pi / <span class="hljs-number"><span class="hljs-number">2</span></span>) { x = radius + CGFloat(dot.distance) y = radius } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bearing == .pi) { x = radius y = radius + CGFloat(dot.distance) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bearing == <span class="hljs-number"><span class="hljs-number">3</span></span> * .pi / <span class="hljs-number"><span class="hljs-number">2</span></span>) { x = radius - CGFloat(dot.distance) y = radius } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { x = radius y = radius - CGFloat(dot.distance) } let newPosition = CGPoint(x: x, y: y) dot.layer.position = newPosition</code> </pre><br><h2> åç«¯ </h2><br> ä»ç„¶éœ€è¦è§£å†³å­˜å‚¨ç‚¹å’Œç…§ç‰‡çš„é—®é¢˜ã€‚ ä¸ºæ­¤ï¼Œå†³å®šä½¿ç”¨Contentfulï¼Œåœ¨ç›®å‰çš„é¡¹ç›®å®æ–½ä¸­ï¼Œä»–å®Œå…¨é€‚åˆæˆ‘ä»¬ã€‚ <br><img src="https://habrastorage.org/webt/dx/zj/pm/dxzjpmfq_zibj3w7sjmu9wjobyi.png"><br><img src="https://habrastorage.org/webt/iz/bm/4f/izbm4f3bxnrouqtwxs-rmkmdyds.png"><br> åœ¨å¼€å‘ç§»åŠ¨åº”ç”¨ç¨‹åºæ—¶ï¼Œæ‰€æœ‰ç«æ ‡è€…éƒ½å‚ä¸äº†å•†ä¸šé¡¹ç›®ï¼Œå¹¶ä¸”æœ‰æ¡ä»¶åœ°å…è®¸ä»–ä»¬æä¾›å‡ ä¸ªå°æ—¶çš„æœåŠ¡ï¼š <br><br><ul><li> ç§»åŠ¨å¼€å‘äººå‘˜-ä¾¿æ·çš„åç«¯ </li><li> å†…å®¹ç®¡ç†å™¨-æ–¹ä¾¿çš„ç®¡ç†åŒºåŸŸï¼Œç”¨äºå¡«å……æ•°æ® </li></ul><br> åç«¯é©¬æ‹‰æ¾çš„ç±»ä¼¼å®ç°æœ€åˆæ˜¯ç”±å‚åŠ é»‘å®¢é©¬æ‹‰æ¾çš„å›¢é˜Ÿä½¿ç”¨çš„ï¼ˆåœ¨æœ¬æ–‡å¼€å¤´æåˆ°ï¼‰ï¼Œè¿™å†æ¬¡è¯æ˜äº†é»‘å®¢é©¬æ‹‰æ¾ä¹‹ç±»â€‹â€‹çš„ä¸œè¥¿ä½¿æ‚¨èƒ½å¤Ÿæ‘†è„±è§£å†³é¡¹ç›®ä¸­ç´§è¿«çš„é—®é¢˜ï¼Œä½¿é‡å»ºå’Œå°è¯•æŸäº›ä¸œè¥¿æˆä¸ºå¯èƒ½ã€‚å…¨æ–°çš„ã€‚ <br><br><h2> ç»“è®º </h2><br><br> å¼€å‘<nobr>ARåº”ç”¨ç¨‹åº</nobr>éå¸¸æœ‰è¶£ï¼Œåœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°è¯•äº†å‡ ä¸ªç°æˆçš„åº“ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜å¿…é¡»è®°ä½æ•°å­¦å¹¶è‡ªå·±ç¼–å†™å¾ˆå¤šä¸œè¥¿ã€‚ <br><br> ä¹ä¸€çœ‹ï¼Œå°½ç®¡æˆ‘ä»¬ä½¿ç”¨äº†Appleçš„æ ‡å‡†SDKï¼Œä½†è¯¥é¡¹ç›®éœ€è¦å¤§é‡çš„å·¥ä½œæ—¶é—´æ¥å®ç°å’Œå®Œå–„ç®—æ³•ã€‚ <br><br> æˆ‘ä»¬æœ€è¿‘å°†åº”ç”¨ç¨‹åºå‘å¸ƒåˆ°<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">AppStoreä¸­</a> ã€‚ è¿™æ˜¯å·¥ä½œæ—¶çš„æ ·å­ã€‚ <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Sjyy8FJUyQI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> åˆ°ç›®å‰ä¸ºæ­¢ï¼Œåœ¨æˆ‘ä»¬çš„æ•°æ®åº“ä¸­ï¼Œåªæœ‰Taganrogæ‰æœ‰ç§¯åˆ†ï¼Œä½†æ˜¯æ¯ä¸ªäººéƒ½å¯ä»¥å‚ä¸â€œè¦†ç›–åŒºåŸŸâ€çš„æ‰©å±•ã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN421067/">https://habr.com/ru/post/zh-CN421067/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN421057/index.html">å¦‚ä½•ä¸ºæ—…å®¢åˆ—è½¦ç»„è£…è´§è½¦</a></li>
<li><a href="../zh-CN421059/index.html">ææ—©æç¤ºåŠ é€Ÿç½‘ç«™</a></li>
<li><a href="../zh-CN421061/index.html">PostgreSQLï¼šWALè†¨èƒ€çš„æ–¹å¼å’ŒåŸå› </a></li>
<li><a href="../zh-CN421063/index.html">Scratchå„¿ç«¥ç¼–ç¨‹æ–°ä¹¦</a></li>
<li><a href="../zh-CN421065/index.html">æˆ‘å¦‚ä½•æ•™AIç©NESç©ä¿„ç½—æ–¯æ–¹å—ã€‚ ç¬¬2éƒ¨åˆ†ï¼šAI</a></li>
<li><a href="../zh-CN421069/index.html">Bobby UrbanèƒŒåŒ…ï¼šåŸå ¡é‡Œé¢</a></li>
<li><a href="../zh-CN421071/index.html">æ¨¡æ•°å’Œä½™æ•°ä¸ç›¸åŒ</a></li>
<li><a href="../zh-CN421073/index.html">ç¬¬1é›†ã€‚é»‘å®¢çš„ä»£ä»·</a></li>
<li><a href="../zh-CN421075/index.html">æ•°å­—è¯å…¸Aåˆ°Z</a></li>
<li><a href="../zh-CN421077/index.html">åœ¨å…‹éº¦ç½—æ²ƒï¼Œæ¯å¹´å››å­£æ¢å­£</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>