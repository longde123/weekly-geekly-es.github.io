<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíæ ü¶è üåª Os princ√≠pios matem√°ticos do layout autom√°tico üöº üé∂ üè™</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Muitos desenvolvedores acreditam que o Auto Layout √© um freio e um problema, e √© extremamente dif√≠cil depur√°-lo. E √© bom que essa conclus√£o seja feita...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Os princ√≠pios matem√°ticos do layout autom√°tico</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/437584/">  Muitos desenvolvedores acreditam que o Auto Layout √© um freio e um problema, e √© extremamente dif√≠cil depur√°-lo.  E √© bom que essa conclus√£o seja feita com base em minha pr√≥pria experi√™ncia e, √†s vezes, √© apenas "eu ouvi dizer que nem vou tentar fazer amizade com ele". <br><br>  Mas talvez o motivo n√£o esteja fora, mas dentro.  Por exemplo, os p√°ssaros mais perigosos do mundo da casuar n√£o atacar√£o as pessoas sem motivo, apenas por autodefesa.  Portanto, tente assumir por um segundo que isso n√£o √© ruim para o Auto Layout, e voc√™ n√£o o entende bem o suficiente e n√£o sabe cozinhar.  Foi isso que Anton Sergeyev fez e se aprofundou na teoria para entender tudo exatamente.  Nos √© oferecido um aperto pronto sobre os fundamentos matem√°ticos do Auto Layout. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xm/53/dw/xm53dwqnl0lczpswansphdrgbpi.png" width="360"></div><br><br><a name="habracut"></a><br>  Auto Layout √© um <strong>sistema de layout</strong> .  Antes de investigarmos, vamos falar sobre tipografia moderna em geral.  Ent√£o, vamos lidar com o <strong>Auto Layout</strong> - vamos descobrir <strong>qual tarefa ele resolve</strong> e como o faz.  Vamos considerar os <strong>recursos na implementa√ß√£o do Layout autom√°tico no iOS</strong> e tentar desenvolver <strong>dicas pr√°ticas</strong> que podem ajudar no trabalho com ele. <br><br>  Como a hist√≥ria ser√° muito pr√≥xima de um artigo matem√°tico, concordamos primeiro com a nota√ß√£o para falar o mesmo idioma. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/-eGciYD9i3I" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <strong>Sobre o palestrante:</strong> Anton Sergeev ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">antonsergeev88</a> ) trabalha na equipe Yandex.Mart, lida com o cliente m√≥vel do Maps no iOS.  Antes do desenvolvimento m√≥vel, ele lidava com sistemas de controle de usinas de energia, onde o custo dos erros no c√≥digo √© alto demais para ser tolerado. <br><br><h2>  Designa√ß√µes <br></h2><br>  Os sistemas de equa√ß√µes lineares s√£o familiares para n√≥s desde a escola - eles s√£o indicados por um colchete e sua solu√ß√£o j√° est√° ausente.  Al√©m disso, sistemas de equa√ß√µes lineares possuem entidades que operam com restri√ß√µes de layout autom√°tico.  Eles s√£o indicados por uma linha reta. <br><br><img src="https://habrastorage.org/webt/ql/qb/sa/qlqbsasmt7hb37gbgal6han6-4c.png"><br><br>  O p√°ssaro estranho e, como j√° sabemos, perigoso n√£o √© acidentalmente pintado no canto superior do slide.  Em homenagem ao cassowary (lat. Cassowary), que, √© claro, mora na Austr√°lia, um algoritmo √© nomeado em todos os nossos iPhones. <br><br>  O layout autom√°tico tem suas pr√≥prias limita√ß√µes; as cores ser√£o definidas em ordem de prioridade: vermelho - obrigat√≥rio;  amarelo - alto;  azul - baixo. <br><br><h2>  Layout <br></h2><br>  Quando eu estava preparando a apresenta√ß√£o, coloquei v√°rios elementos na tela, por exemplo, um casuar.  Para fazer isso, determinei que o casuar √© uma figura retangular.  Voc√™ precisa organiz√°-lo em uma folha que tenha eixos e seu pr√≥prio sistema de coordenadas, e para isso eu determinei as coordenadas do canto superior esquerdo, largura e altura. <br><br><img src="https://habrastorage.org/webt/5s/rq/ci/5srqci-zsre1tg_nbnn3grczdno.png"><br><br>  Conhecer esses quatro valores √© suficiente para representar qualquer Visualiza√ß√£o. <br><br><h3>  Algoritmo No. 1 <br></h3><br>  Ao colocar o casuar na folha, descrevemos discretamente o primeiro algoritmo de layout: <br><br><ul><li>  determinar as coordenadas e tamanhos; </li><li>  aplique-os ao UIView. </li></ul><br>  O algoritmo funciona, mas √© bastante dif√≠cil de usar, por isso vamos simplific√°-lo ainda mais. <br><br>  Suponha que abaixo est√° uma solu√ß√£o para algum sistema de equa√ß√µes lineares. <br><br><img src="https://habrastorage.org/webt/ca/6i/ab/ca6iabqohj0bqr1rmujisor9fv4.png"><br><br>  O sistema de equa√ß√µes lineares √© especial, pois muitas opera√ß√µes s√£o definidas sobre ele: dobrar linhas, multiplic√°-las por constantes etc.  Essas opera√ß√µes s√£o chamadas de transforma√ß√µes lineares e, com a ajuda delas, o sistema √© reduzido √† forma arbitr√°ria. <br><br>  A beleza das transforma√ß√µes lineares √© que elas s√£o revers√≠veis.  Isso nos leva a uma id√©ia interessante e bastante sutil com a qual todo o layout moderno come√ßa. <br><br>  Haja uma View - um ret√¢ngulo com suas coordenadas e tamanho.  Queremos organiz√°-lo para que o centro coincida com o ponto especificado.  Modelamos o centro usando transforma√ß√µes lineares - a <strong>coordenada do canto superior esquerdo + metade da largura</strong> . <br><br><img src="https://habrastorage.org/webt/yg/el/ic/ygelic6e5xa6orhvnaz7g5p_cki.png"><br><br>  Modelamos o centro por transforma√ß√£o linear, n√£o foi: havia apenas as coordenadas do ponto superior esquerdo, largura e altura. <br><br>  Da mesma forma, voc√™ pode simular qualquer outro recuo, por exemplo, 20 pontos no canto direito. <br><br><blockquote>  √â a id√©ia de transforma√ß√µes lineares que nos permite criar v√°rios sistemas de composi√ß√£o tipogr√°fica. <br></blockquote><br>  Considere um exemplo elementar.  Escrevemos um sistema com o qual estabelecemos as coordenadas do meio e do lado direito, a largura e a rela√ß√£o entre largura e altura.  Resolvemos o sistema e obtemos a resposta. <br><br><img src="https://habrastorage.org/webt/hc/xc/hu/hcxchuyy2qvuvati_laj8afryig.png"><br><br>  Ent√£o chegamos ao segundo algoritmo. <br><br><h3>  Algoritmo No. 2 <br></h3><br>  A segunda itera√ß√£o do algoritmo consiste nos seguintes itens: <br><br><ul><li>  compor um sistema de equa√ß√µes lineares; </li><li>  n√≥s resolvemos isso; </li><li>  aplique a solu√ß√£o ao UIView. </li></ul><br>  Imagine que est√°vamos no s√©culo XX, em uma √©poca em que os equipamentos de inform√°tica estavam apenas come√ßando, e fomos os primeiros a criar nosso pr√≥prio sistema de layout.  Inventado, empacotado, dado ao usu√°rio e ele come√ßa a us√°-lo - preenche os par√¢metros iniciais e o transfere para o nosso sistema. <br><br><img src="https://habrastorage.org/webt/8b/np/wk/8bnpwkt2ufktqh1wa7dtumctozs.png"><br><br>  H√° um problema - este sistema n√£o possui uma solu√ß√£o √∫nica.  O problema n√£o √© excepcional, absolutamente todos os sistemas de layout o enfrentam e √© chamado de <strong>falta de solu√ß√£o</strong> . <br><br>  N√£o h√° muitas maneiras de sair dessa situa√ß√£o: <br><br><ul><li>  Voc√™ pode <strong>cair</strong> - este √© um m√©todo muito comum.  Quem trabalha com o MacOS sabe que o NSLayoutConstraintManager faz exatamente isso. </li><li>  <strong>Retorne o valor padr√£o</strong> .  No contexto do layout, sempre podemos retornar todos os zeros. </li><li>  Uma maneira mais conhecida e delicada √© <strong>impedir a entrada incorreta</strong> .  Esse m√©todo √© usado por sistemas populares de layout, por exemplo, <strong>Yoga</strong> , conhecido como <strong>Flex Layout</strong> .  Esses sistemas tentam criar uma interface que n√£o permita entrada incorreta. </li><li>  H√° outra maneira de resolver absolutamente todos os problemas - <strong>repensar tudo desde o in√≠cio</strong> e, inicialmente, <strong>evitar a ocorr√™ncia desse problema</strong> .  O Layout autom√°tico foi por esse caminho. </li></ul><br><h2>  Layout autom√°tico  Declara√ß√£o e solu√ß√£o do problema <br></h2><br>  Temos uma imagem retangular e, para identific√°-la exclusivamente, precisamos de 4 par√¢metros: <br><br><ul><li>  coordenadas do canto superior esquerdo; </li><li>  largura e altura. </li></ul><br><img src="https://habrastorage.org/webt/9k/m4/mn/9km4mnazc-bszyeglny7jgury1k.png"><br><br>  O layout autom√°tico √© muito detalhado.  Comparado a um sistema de equa√ß√µes lineares, √© muito mais dif√≠cil colocar tudo na tela com ele.  Portanto, consideraremos, sem perda de generalidade, o caso unidimensional. <br><br><img src="https://habrastorage.org/webt/yy/g-/bz/yyg-bzfkdyhagrqn28bj7ruydg8.png"><br><br>  Tudo √© muito simples: o espa√ßo √© uma linha reta, e todos os objetos que podem ser colocados nele s√£o pontos em uma linha reta.  Um valor: <strong>X = X <sub>P √©</sub></strong> suficiente para determinar a posi√ß√£o do ponto. <br><br>  Considere a abordagem de layout autom√°tico.  H√° um espa√ßo no qual as restri√ß√µes s√£o definidas.  A solu√ß√£o que queremos obter √© <strong>X = X <sub>0</sub></strong> , e nenhuma outra. <br><br>  H√° um problema - n√£o definimos opera√ß√µes com restri√ß√µes.  N√£o podemos concluir diretamente do registro que <strong>X = X <sub>0</sub></strong> , n√£o podemos multiplicar nada ou adicionar algo a nada.  Para fazer isso, precisamos transformar a restri√ß√£o no que podemos trabalhar - em um sistema de equa√ß√µes e desigualdades. <br><br><img src="https://habrastorage.org/webt/dc/ru/gr/dcrugrl3rwq6esfcnrlz89ora8o.png"><br><br>  O Layout autom√°tico transforma um sistema de equa√ß√µes e desigualdades da seguinte maneira. <br><br><ul><li>  Primeiro, introduz 2 vari√°veis ‚Äã‚Äãadicionais que <strong>n√£o</strong> s√£o <strong>negativas</strong> e <strong>dependem uma da outra</strong> .  Pelo menos um deles √© igual a zero. </li><li>  A restri√ß√£o em si √© convertida na nota√ß√£o <strong>X = X <sub>0</sub> + a <sup>+</sup> - a <sup>-</sup></strong> . </li></ul><br>  Ponto <strong>X <sub>0</sub></strong> <sub>&nbsp;</sub>  - solu√ß√£o do sistema: se <strong>a <sup>+</sup></strong> e <strong>a <sup>-</sup></strong> s√£o iguais a zero, isso ser√° verdade.  Mas <strong>qualquer outro ponto</strong> nessa linha ser√° uma solu√ß√£o. <br><br>  Portanto, √© necess√°rio encontrar o melhor entre todo o conjunto de solu√ß√µes.  Para fazer isso, introduzimos uma fun√ß√£o - uma fun√ß√£o comum que retorna um n√∫mero e podemos comparar n√∫meros.  Desenhamos um gr√°fico e observamos que a solu√ß√£o que originalmente quer√≠amos obter √© m√≠nima. <br><br>  Tem <strong>um problema de programa√ß√£o linear</strong> .  √â exatamente isso que o Layout autom√°tico faz com restri√ß√µes que n√£o s√£o apenas na forma de igualdades, mas tamb√©m de desigualdades. <br><br><h3>  Restri√ß√µes de desigualdade <br></h3><br>  No caso de restri√ß√µes de desigualdade, a transforma√ß√£o ocorre da mesma maneira que nas igualdades: duas vari√°veis ‚Äã‚Äãadicionais s√£o introduzidas e tudo isso √© coletado no sistema.  Somente o funcional √© diferente e √© igual a <strong><sup>-</sup></strong> . <br><br><img src="https://habrastorage.org/webt/su/lp/db/sulpdbiqpzdvnd2s23qwo3zg3p0.png"><br><br>  O gr√°fico acima mostra por que √© assim - qualquer valor de <strong>a <sup>+</sup></strong> com <strong>a <sup>-</sup> = 0</strong> (de <strong>X <sub>0</sub></strong> a <strong>+ ‚àû</strong> ) ser√° a solu√ß√£o ideal para o problema. <br><br>  Vamos tentar combinar essas duas restri√ß√µes de equa√ß√µes e desigualdades em uma - como as restri√ß√µes n√£o vivem isoladas, elas s√£o aplicadas juntas em todo o sistema. <br><br><img src="https://habrastorage.org/webt/kv/p4/ed/kvp4ed32qay13--nhn6neefffd0.png"><br><br>  Para cada restri√ß√£o, um par adicional de vari√°veis ‚Äã‚Äã√© introduzido e o funcional √© compilado.  Como queremos que todas essas restri√ß√µes sejam cumpridas simultaneamente, o <strong>funcional ser√° igual √† soma de todos os funcionais de cada restri√ß√£o</strong> . <br><br>  Coletamos a fun√ß√£o f e vemos que a solu√ß√£o √© <strong>X <sub>1</sub></strong> .  Como esper√°vamos, fazendo restri√ß√µes.  Ent√£o chegamos ao terceiro algoritmo. <br><br><h3>  Algoritmo No. 3 <br></h3><br>  Para fazer algo, voc√™ precisa: <br><br><ul><li>  criar um sistema de restri√ß√µes lineares; </li><li>  transform√°-lo em um problema de programa√ß√£o linear; </li><li>  resolver o problema de qualquer maneira conhecida, por exemplo, o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">m√©todo simplex</a> usado no Layout autom√°tico; </li><li>  aplique a solu√ß√£o ao UIView. </li></ul><br>  Esse algoritmo parece ser suficiente, mas considere o seguinte caso: alteramos o conjunto inicial de restri√ß√µes para que a segunda restri√ß√£o agora seja <strong>X ‚â• X</strong> <strong><sub>2</sub></strong> . <br><br><img src="https://habrastorage.org/webt/li/dd/at/liddathmoov5umsnhvnoevax6jy.png"><br><br>  Que solu√ß√£o esperamos ver? <br><br><ul><li>  <strong>X <sub>1</sub></strong> ?  De fato, na primeira restri√ß√£o est√° escrito assim: <strong>X = X <sub>1</sub></strong> , e esta solu√ß√£o entra em conflito com a segunda restri√ß√£o. </li><li>  <strong>X <sub>2</sub></strong> ?  J√° haver√° um conflito com a primeira restri√ß√£o. </li></ul><br>  Para sair da situa√ß√£o, realizaremos transforma√ß√µes que j√° sabemos fazer. <br><br>  O gr√°fico da nova funcionalidade parece diferente: qualquer ponto do intervalo de <strong>X <sub>1</sub></strong> a <strong>X <sub>2</sub></strong> ser√° a solu√ß√£o v√°lida correta do sistema.  Isso √© chamado de <strong>incerteza</strong> . <br><br><h3>  Incerteza <br></h3><br>  O Auto Layout possui um mecanismo para resolver esses problemas - <strong>prioridades</strong> .  Lembro que amarelo indica alta prioridade e azul - baixo. <br><br><img src="https://habrastorage.org/webt/7e/go/is/7egoisncevkoitvo8fdxkvcdg7g.png"><br><br>  Converter restri√ß√µes.  Observe que o sistema resultante √© apenas preto.  N√≥s sabemos como trabalhar com ele e n√£o h√° informa√ß√µes sobre restri√ß√µes nele.  Est√° nas funcionalidades, das quais haver√° duas.  O Layout autom√°tico minimiza primeiro o primeiro e depois o segundo. <br><br>  Em problemas de programa√ß√£o linear, n√£o estamos procurando a solu√ß√£o em si, mas a √°rea de solu√ß√µes vi√°veis.  Obviamente, queremos que essa √°rea seja apenas um ponto, e o Layout autom√°tico atua da mesma maneira.  Primeiro, ele minimiza a funcionalidade de maior prioridade em ( <strong>-</strong> <strong>‚àû,</strong> <strong>+ ‚àû)</strong> e, na sa√≠da, recebe um dom√≠nio de solu√ß√µes vi√°veis.  O Layout autom√°tico resolve o segundo problema de programa√ß√£o linear j√° na faixa de valores permitidos obtida.  Esse mecanismo √© chamado de <strong>hierarquia de restri√ß√µes</strong> e, neste problema, fornece o ponto <strong>X <sub>2</sub></strong> . <br><br><h3>  Algoritmo No. 4 <br></h3><br><ul><li>  Crie uma hierarquia de restri√ß√µes lineares; </li><li>  transform√°-lo em uma tarefa de programa√ß√£o linear; </li><li>  resolver sequencialmente o problema de programa√ß√£o linear - da prioridade mais alta √† mais baixa. </li><li>  aplique a solu√ß√£o ao UlView. </li></ul><br>  Vejamos a tarefa anterior novamente.  N√£o somos matem√°ticos, mas engenheiros, e qualquer engenheiro deve ser confundido aqui. <br><br>  H√° um problema s√©rio aqui - o <strong>infinito</strong> , e eu n√£o sei o que √©. <br><br>  O algoritmo Cassowary, sob o cap√¥ do Layout Autom√°tico, n√£o era um mecanismo existente que coubesse convenientemente √† tarefa de Layout Autom√°tico, mas foi pensado como uma ferramenta de layout e forneceu mecanismos especiais para escapar do infinito desde o in√≠cio.  Para isso, v√°rios tipos de restri√ß√µes foram inventados: <br><br><ul><li>  <strong>Par√¢metros</strong> s√£o as restri√ß√µes com as quais trabalhamos.  Eles s√£o chamados de <strong>prefer√™ncias</strong> no original <strong>,</strong> √†s vezes na documenta√ß√£o da Apple - <strong>restri√ß√µes opcionais</strong> . </li><li>  <strong>Requisitos</strong> ou requisitos - restri√ß√µes com prioridade <strong>necess√°ria</strong> . </li></ul><br>  Vamos ver como os requisitos com essas prioridades s√£o transformados do ponto de vista da matem√°tica. <br><br><img src="https://habrastorage.org/webt/hm/mn/my/hmmnmycwgdfq9vuip1xeylz4caq.png"><br><br>  Novamente, temos uma linha reta com dois pontos, e a primeira restri√ß√£o √© <strong>X = X <sub>1</sub></strong> .  No slide, √© vermelha, ou seja, essa restri√ß√£o com a prioridade necess√°ria - chamaremos isso de requisito. <br><br>  O Layout autom√°tico o converte em um sistema de equa√ß√µes lineares contendo uma equa√ß√£o <strong>X = X <sub>1</sub></strong> .  Nada mais - sem tarefas de programa√ß√£o linear, sem otimiza√ß√µes. <br><br>  A situa√ß√£o √© semelhante √†s desigualdades, mas um pouco mais complicada - aparecer√° <strong>uma vari√°vel adicional</strong> que pode assumir valores maiores que 0. Para qualquer valor maior que 0, essa restri√ß√£o ser√° atendida.  Observe que aqui n√£o h√° tarefas de programa√ß√£o linear e otimiza√ß√µes. <br><br>  Vamos tentar combinar tudo isso, reunir dois requisitos e convert√™-los em um sistema.  Um leitor atento observou que chegamos ao mesmo problema com o qual come√ßamos - os <strong>requisitos devem ser consistentes</strong> . <br><br><img src="https://habrastorage.org/webt/lj/fu/wx/ljfuwxbedffz_agc5ydwoxiv0os.png"><br><br>  As restri√ß√µes do tipo <strong>requerido</strong> ou requisitos s√£o uma <strong>ferramenta muito poderosa,</strong> mas n√£o a principal, mas a auxiliar.  Foi especialmente introduzido no Auto Layout para resolver o problema de intervalos infinitos, e deve ser usado com cuidado. <br><br>  Vamos tentar combinar todos os tipos de restri√ß√µes que encontramos em um sistema.  Suponha que queremos resolver o problema n√£o em toda a linha, mas apenas entre <strong>X <sub>0</sub></strong> e <strong>X <sub>3</sub> .</strong>  Transformando tudo isso em um sistema de equa√ß√µes e desigualdades lineares, obtemos o seguinte. <br><br><img src="https://habrastorage.org/webt/nl/3k/lw/nl3klwil0nepuuqyjq-nmxxo0rs.png"><br><br>  Em rela√ß√£o ao sistema anterior, duas vari√°veis ‚Äã‚Äãadicionais foram adicionadas - <strong>c</strong> e <strong>d</strong> , mas elas n√£o entrar√£o nos funcionais, pois as restri√ß√µes do tipo requerido n√£o afetam o funcional em sua forma original. <br><br>  Parece que a tarefa n√£o mudou muito - minimizamos o mesmo de antes, mas o intervalo inicial de valores aceit√°veis ‚Äã‚Äãest√° mudando, agora √© de <strong>X <sub>0</sub></strong> a <strong>X <sub>3</sub></strong> . <br><br><blockquote>  Do ponto de vista matem√°tico, os requisitos - restri√ß√µes do tipo requerido - s√£o a capacidade de introduzir equa√ß√µes adicionais no sistema sem modificar seus funcionais. <br></blockquote><br>  Voc√™ precisa ter muito cuidado com isso, pois o abuso excessivo das restri√ß√µes necess√°rias levar√° a um <strong>problema sem solu√ß√µes</strong> , e o Layout autom√°tico n√£o lidar√° com isso. <br><br>  Chegamos ao √∫ltimo quinto algoritmo. <br><br><h3>  Algoritmo No. 5 <br></h3><br><ul><li>  Definir as restri√ß√µes necess√°rias - requisitos de layout; </li><li>  criar uma hierarquia de restri√ß√µes lineares; </li><li>  converter todas as restri√ß√µes em um problema de programa√ß√£o linear; </li><li>  resolver o problema da programa√ß√£o linear; </li><li>  aplique a solu√ß√£o ao UlView. </li></ul><br>  Examinamos o Cassowary - um algoritmo que est√° dentro do Auto Layout, mas quando √© implementado, v√°rios recursos surgem. <br><br><h3>  Recursos do IOS <br></h3><br>  <strong>N√£o h√° c√°lculos no layoutSubviews ()</strong> . <br><br>  Quando eles s√£o produzidos?  Resposta: sempre, a qualquer momento, o Auto Layout √© contado.  O c√°lculo ocorre exatamente quando adicionamos restri√ß√µes √† nossa visualiza√ß√£o ou as ativamos usando m√©todos modernos da API para trabalhar com restri√ß√µes. <br><br><img src="https://habrastorage.org/webt/rf/rf/ca/rfrfca8zmtb5ukabvarjdfygbii.png"><br><br>  Nossas vis√µes s√£o ret√¢ngulos, mas o problema √© que essas informa√ß√µes n√£o est√£o contidas no Cassowary, elas precisam ser incorporadas adicionalmente l√°.  Temos um mecanismo para introduzir restri√ß√µes adicionais.  Se introduzirmos para cada visualiza√ß√£o um conjunto de restri√ß√µes com largura e altura positivas, sempre obteremos ret√¢ngulos na sa√≠da.  √â por isso que n√£o podemos compensar a exibi√ß√£o de layout autom√°tico com dimens√µes negativas. <br><br>  O segundo recurso √© <strong>intrinsicContentSize</strong> - o tamanho intr√≠nseco que pode ser definido para cada visualiza√ß√£o. <br><br><img src="https://habrastorage.org/webt/of/dx/dr/ofdxdrma4ob54homy7amohpvove.png"><br><br>  Essa √© uma interface simples para criar 4 restri√ß√µes adicionais de desigualdade que ser√£o colocadas no sistema.  Esse mecanismo √© muito conveniente, pois permite reduzir o n√∫mero de restri√ß√µes expl√≠citas, o que simplifica o uso do Layout Autom√°tico.  O √∫ltimo e mais fino ponto que geralmente √© esquecido √© o <strong>TranslateAutoresizingMaskIntoConstraints.</strong> <br><br><img src="https://habrastorage.org/webt/xz/pz/su/xzpzsulxwqohzm-ehd5rz2kg148.png"><br><br>  Esta √© uma <strong>muleta que</strong> foi introduzida nos dias do iOS 5, para que o c√≥digo antigo n√£o seja quebrado ap√≥s o aparecimento do Layout Autom√°tico. <br><br>  Imagine uma situa√ß√£o: impomos uma vis√£o sobre restri√ß√µes.  Dentro da view, usamos a view, que n√£o sabe nada sobre restri√ß√µes, tudo digitado em quadros, mas dentro dela ela digita a view, que h√° muito tempo se traduz em restri√ß√µes. <br><br><blockquote>  Lembro que nenhum quadro entra na tarefa de Layout autom√°tico do Cassowary, apenas limita√ß√µes. <br></blockquote><br>  O tamanho e a posi√ß√£o da vista que foi recolhida nos quadros n√£o s√£o totalmente determinados por restri√ß√µes.  Ao calcular o tamanho e a posi√ß√£o de todas as outras visualiza√ß√µes, os tamanhos incorretos ser√£o levados em considera√ß√£o, mesmo ap√≥s o Layout autom√°tico, aplicaremos os quadros corretos. <br><br>  Para evitar essa situa√ß√£o, se o valor da vari√°vel TranslateAutoresizingMaskIntoConstraints for verdadeiro, uma restri√ß√£o adicional ser√° aplicada a cada exibi√ß√£o que √© apresentada no quadro.  Esse conjunto de restri√ß√µes pode variar de execu√ß√£o para execu√ß√£o.  Apenas uma coisa √© conhecida sobre esse conjunto - seu quadro ser√° o que foi transmitido. <br><br>  A compatibilidade entre o c√≥digo antigo escrito sem restri√ß√µes e o novo c√≥digo escrito com restri√ß√µes geralmente pode sofrer devido ao uso indevido dessa propriedade.  Essas restri√ß√µes necessariamente t√™m a prioridade dos requisitos; portanto, se subitamente impusermos restri√ß√µes a essa vis√£o, que possui uma prioridade muito alta, por exemplo, um requisito, podemos criar acidentalmente um sistema n√£o consistente que n√£o ter√° solu√ß√µes. <br><br>  <strong>√â importante saber:</strong> <br><br><ul><li>  Se criarmos uma visualiza√ß√£o do <strong>Interface Builder</strong> , o valor padr√£o para essa propriedade ser√° <strong>falso</strong> . </li><li>  Se criarmos a visualiza√ß√£o diretamente do c√≥digo, ser√° <strong>verdade</strong> . </li></ul><br>  A id√©ia √© muito simples - o c√≥digo antigo no qual a visualiza√ß√£o foi criada n√£o sabia nada sobre o Layout Autom√°tico, e era necess√°rio faz√™-la para que, se a visualiza√ß√£o fosse usada em algum lugar de um novo local, ele funcionaria. <br><br><h2>  Dicas pr√°ticas <br></h2><br>  Ser√£o tr√™s conselhos no total e come√ßar√£o pelos mais importantes. <br><br><h3>  Otimiza√ß√£o <br></h3><br><blockquote>  √â importante localizar o problema. <br></blockquote><br>  Voc√™ j√° enfrentou o problema de otimizar a tela, que √© apresentada no Layout autom√°tico?  Provavelmente n√£o, mais frequentemente voc√™ enfrentou o problema de otimizar o layout das c√©lulas dentro de uma tabela ou de uma <strong>exibi√ß√£o de cole√ß√£o</strong> . <br><br>  O Layout autom√°tico √© otimizado o suficiente para criar qualquer tela e interface, mas criar 50 ou 100 de uma vez √© um problema.  Para localizar e otimizar, vejamos o experimento.  As figuras s√£o retiradas de um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo em</a> que Cassowary foi descrito pela primeira vez. <br><img src="https://habrastorage.org/webt/jl/cb/qo/jlcbqo-0y685wxkbkniflmjlwli.png"><br><br>  A tarefa √© a seguinte: criamos uma cadeia de visualiza√ß√µes uma a uma e conectamos cada uma delas √† anterior.  Assim, uma sequ√™ncia de 1000 elementos foi constru√≠da.  Ap√≥s medir v√°rias opera√ß√µes, o tempo √© indicado em milissegundos.  Os valores s√£o bastante grandes, porque o Auto Layout foi inventado na jun√ß√£o dos anos 80 e 90. <br><br>  Ao coletar essa cadeia, voc√™ pode agir da seguinte maneira: <br><br><ul><li>  <strong>Adicione uma restri√ß√£o de cada vez</strong> e decida cada vez.  Isso levar√° 38 segundos. </li><li>  Voc√™ pode <strong>adicionar todas as restri√ß√µes de uma</strong> s√≥ <strong>vez</strong> e s√≥ ent√£o resolver o sistema.  Esta solu√ß√£o √© mais eficiente.  Segundo dados antigos, a efici√™ncia aumenta em 70%, mas na implementa√ß√£o atual em dispositivos modernos haver√° apenas 20%.  Mas uma adi√ß√£o qualitativa √∫nica de restri√ß√µes sempre ser√° mais eficaz. </li><li>  Quando toda a cadeia √© montada, voc√™ pode <strong>adicionar mais uma restri√ß√£o</strong> .  Como pode ser visto na tabela, esta opera√ß√£o √© bastante barata. </li><li>  O mais interessante: <strong>se n√£o adicionarmos novas restri√ß√µes, mas alterar alguma constante em uma das existentes</strong> , essa √© uma ordem de magnitude mais eficaz do que excluir ou criar uma nova restri√ß√£o. </li></ul><br>  Os dois primeiros pontos podem ser descritos como o c√°lculo prim√°rio das interfaces, os dois √∫ltimos - como o pr√≥ximo. <br><br><h4>  C√°lculo da interface prim√°ria <br></h4><br>  Aqui voc√™ pode usar os m√©todos de adi√ß√£o em massa de restri√ß√µes para otimiza√ß√£o: <br><br><ul><li>  <strong>NSLayoutConstraints.activate (_ :)</strong> - ao criar uma exibi√ß√£o, colete todas as restri√ß√µes seq√ºencialmente em uma matriz, fa√ßa cache e adicione-as de cada vez. </li><li>  Ou crie c√©lulas no <strong>Interface Builder.</strong>  Ele far√° tudo por n√≥s e realizar√° otimiza√ß√µes adicionais, o que geralmente √© conveniente. </li></ul><br><h4>  C√°lculos subsequentes da interface <br></h4><br>  Adicionar ou modificar restri√ß√µes √© uma opera√ß√£o complexa; portanto, √© melhor <strong>n√£o alterar o conjunto de restri√ß√µes, mas apenas alterar as constantes</strong> nas restri√ß√µes existentes.     : <br><br><ul><li> <strong> UIView</strong> ‚Äî     .   view   ,     Auto Layout.     ,    ,      view,     . </li><li> <strong>   </strong> <strong>‚Äî IntrinsicContentSize.</strong>  ,      ,     . </li><li> <strong>   </strong> .         , ,   . </li></ul><br>     ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">WWDC 2018S220 High Performance Auto Layout</a> .   ‚Äî Apple         ,     . <br><br><h2>   <br></h2><br>      ,       constraints. <br><br><h3>    <br></h3><br>   required ,  ‚Äî   ,       ,     .    . <br><br><blockquote>      ,    . <br></blockquote><br>     : <br><br><ul><li> <strong>  ,   </strong> .      (  loader) ‚Äî     . </li><li> <strong>  ,   </strong> .     ,     . </li></ul><br><br><h3>   <br></h3><br>   ,          ,   . <br><br>   <strong>constraint   required,     </strong> .    , ,    ,       .    ,      . <br><br>   ‚Äî <strong>  ,    </strong> .     ,        ‚Äî     .   -    ,        ,      . Auto Layout      ,      . <br><br> <strong>     </strong> ,       .      .  ,       ,    ,   .        layout,  ,    ,      .        . <br><br><h3>   <br></h3><br> <strong> ‚Äî   </strong> ,    Auto Layout,          ,     . <br><br>  ,  required,  ,    <strong>   </strong> .   : <br><br><ul><li>   ,     . </li><li>  ,   ,     . </li></ul><br>  ,       ,  <strong> ,     </strong> . <br><br>            ,      . ,     ,          ,    .  , <strong> ‚Äî   </strong> .      . <br><br> <strong>   ‚Äî    .</strong>      ,       ,     ,   ‚Äî     ,     ‚Äî   required      -. <br><br> <b> :</b> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Solving Linear Arithmetic Constraints for User Interface Applications</a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">The Cassowary Linear Constraint Solving Algorithm</a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Constraints as s Design Pattern</a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Auto Layout Guide by Apple</a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">WWDC 2018 Session 220 High Performance Auto Layout</a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> UILabel   API Auto Layout ‚Äî  </a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> .  Medium</a> <br><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A prop√≥sito, j√° aceitamos </font><font style="vertical-align: inherit;">o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">relat√≥rio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de Anton no programa </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AppsConf 2019</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Gostaria de lembr√°-lo de que mudamos o AppsConf do outono para a primavera, e a pr√≥xima confer√™ncia mais √∫til para desenvolvedores m√≥veis ser√° realizada nos dias 22 e 23 de abril. </font><font style="vertical-align: inherit;">√â hora de pensar no t√≥pico para apresenta√ß√£o e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enviar um relat√≥rio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou discutir com o l√≠der a import√¢ncia de ir √† confer√™ncia e reservar um ingresso.</font></font><br></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt437584/">https://habr.com/ru/post/pt437584/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt437574/index.html">O back-end do WhatsApp, Facebook Messenger e Instagram se unir√° e adicionar√° criptografia de ponta a ponta</a></li>
<li><a href="../pt437576/index.html">Confer√™ncia DEFCON 17. Minhas falhas. Parte 1</a></li>
<li><a href="../pt437578/index.html">Confer√™ncia DEFCON 17. Minhas falhas. Parte 2</a></li>
<li><a href="../pt437580/index.html">Como lembrar de um livro sobre JavaScript em 5 dias ou do ‚ÄúPal√°cio da Mem√≥ria‚Äù na vida cotidiana de um programador</a></li>
<li><a href="../pt437582/index.html">Vis√£o geral do Vue.js 2.6</a></li>
<li><a href="../pt437586/index.html">Criamos um aplicativo de voz usando o exemplo do Google Assistant</a></li>
<li><a href="../pt437588/index.html">√â mais divertido desenvolver para telefones celulares do que para a web?</a></li>
<li><a href="../pt437590/index.html">N√∫meros de lat√™ncia no iPhone</a></li>
<li><a href="../pt437592/index.html">Arquitetura ass√≠ncrona da camada de execu√ß√£o de tarefas</a></li>
<li><a href="../pt437594/index.html">Como eu erradiquei a causa da gagueira e do salto de quadros em todos os jogos e tamb√©m reduzi acidentalmente a temperatura em 15 graus</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>