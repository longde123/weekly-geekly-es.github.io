<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüë®‚Äçüë¶ üëÅ‚Äçüó® üóúÔ∏è Desarrollo de un interruptor t√°ctil Z-Wave en la bater√≠a con botones luminosos. ‚ûñ üå™Ô∏è ü¶ì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="El segundo a√±o he estado desarrollando mi exclusivo interruptor Z-Wave con botones t√°ctiles que me satisfar√°n en t√©rminos de funcionalidad, dise√±o y c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Desarrollo de un interruptor t√°ctil Z-Wave en la bater√≠a con botones luminosos.</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/413473/"><img src="https://habrastorage.org/webt/8u/uo/9w/8uuo9wx7pyclsobv4bqkxrrokgw.jpeg"><br><br>  El segundo a√±o he estado desarrollando mi exclusivo interruptor Z-Wave con botones t√°ctiles que me satisfar√°n en t√©rminos de funcionalidad, dise√±o y costo de fabricaci√≥n. <br><br>  Desde el principio, el objetivo era hacer que el interruptor de 4 botones en una bater√≠a con un tama√±o de 80x80 mm sea lo m√°s delgado posible, los botones t√°ctiles deben ser grandes e iluminados cuando se tocan, no solo un peque√±o c√≠rculo como todos los dem√°s.  El resultado es un interruptor delgado y elegante que puede controlar cualquier dispositivo dom√©stico inteligente. <br><br>  Durante el desarrollo, resolv√≠ muchas tareas en circuitos, dise√±o de casos y selecci√≥n de materiales.  Particularmente interesante es la creaci√≥n del bot√≥n t√°ctil en s√≠, que brilla en su totalidad, pero lo primero es lo primero. <br><br><ul><li>  Funcional </li><li>  Dise√±o de la caja </li><li>  Dise√±o de PCB </li><li>  Estudios de difusores de luz. </li><li>  Selecci√≥n de materiales difusores. </li><li>  Uso </li></ul><br>  Video del funcionamiento del interruptor t√°ctil al final. <br><a name="habracut"></a><br><h3>  Funcional </h3><br>  Se requer√≠an las siguientes capacidades de disyuntor: <br><br><ul><li>  Enciende / apaga la luz </li><li>  Ajustar el brillo de la iluminaci√≥n </li></ul><br>  4 botones controlan 2 grupos de iluminaci√≥n.  Los botones superiores, mientras se mantienen presionados, aumentan gradualmente el brillo, al presionar brevemente se enciende la luz.  Los botones inferiores, mientras se mantienen presionados, disminuyen gradualmente el brillo, con una breve presi√≥n apagan la luz. <br><br>  <b>Todo</b> <br><br>  <i>Haga que cada bot√≥n funcione en modo de conmutaci√≥n, presione - encendido, presione - apagado.</i>  <i>Esto le permitir√° controlar 4 grupos de iluminaci√≥n.</i> <br><br><h3>  Dise√±o de la caja </h3><br>  Me gust√≥ la idea con 4 botones t√°ctiles grandes de Basalte, y decid√≠ desarrollarla en mi direcci√≥n. <br><br><img src="https://habrastorage.org/webt/46/to/au/46toau4idmg_1rgrvhjhelnwxda.jpeg"><br>  <i>Fig.</i>  <i>1 - Interruptor KNX Basalte</i> <br><br>  Quer√≠a que el bot√≥n se ilumine como un todo cuando se toca, en lugar de un LED separado.  Por lo tanto, el estuche es un marco estrecho con recortes para 4 botones t√°ctiles.  Se han pensado las cerraduras para fijar la cubierta posterior y los huecos para instalar imanes.  La placa de fijaci√≥n est√° pegada a la pared en una cinta adhesiva de doble cara y el interruptor ya est√° unido a ella mediante imanes.  Es conveniente usar el interruptor como un control remoto port√°til y es conveniente cargar la bater√≠a. <br><br><img src="https://habrastorage.org/webt/gk/tp/hu/gktphux0nepum4fhx7qhpm2ln2y.jpeg"><br>  <i>Fig.</i>  <i>2 - Carcasa del interruptor t√°ctil</i> <br><br>  Todas las partes del cuerpo est√°n dise√±adas en Blender e impresas en una impresora 3D con pl√°stico ABS blanco. <br><br><img src="https://habrastorage.org/webt/wd/k0/39/wdk039ulydrgq1ajgrklzvajixw.png"><br>  <i>Fig.</i>  <i>3 - Desarrollo de la carcasa del interruptor t√°ctil en Blender</i> <br><br><h3>  Dise√±o de PCB </h3><br>  La placa de circuito est√° dise√±ada por Proteus.  Esta es la segunda versi√≥n, utiliza un chip sensor TTP224 para 4 canales.  La primera versi√≥n utiliza 4 piezas.  TTP223 de un solo canal, no hay diferencia en la operaci√≥n, pero cuando se usa TTP224 hay menos componentes de soldadura. <br><br><img src="https://habrastorage.org/webt/lv/g7/f5/lvg7f5dfflj7omp_jviy39ro-pc.png"><br>  <i>Fig.</i>  <i>4 - Dise√±o de la placa de circuito del interruptor t√°ctil en Proteus</i> <br><br>  Los componentes principales en el tablero son: <br><br><ol><li>  Chip de radio Z-Wave </li><li>  Bater√≠a Robiton 800mAh </li><li>  Regulador de voltaje elevador / reductor de 3.3V S7V8F3 </li><li>  Carga de bater√≠a TP4056 </li><li>  Diagrama para cambiar la energ√≠a de la bater√≠a al USB </li><li>  Bot√≥n de calibraci√≥n </li><li>  IC del bot√≥n t√°ctil TTP224 </li></ol><br>  El chip Z-Wave opera en el rango de 2.7V - 3.6V, la bater√≠a produce hasta 4.7V, por lo que utilic√© el convertidor de reducci√≥n de voltaje Pololu S7V8F3 3.3V.  Para cargar la bater√≠a, utilic√© un chip TP4056 barato y conocido, configur√© la corriente de carga a la mitad de la capacidad de la bater√≠a de 400 mA.  Cuando se conecta la carga, la alimentaci√≥n del dispositivo cambia a USB y la bater√≠a se carga silenciosamente, el esquema de conmutaci√≥n de alimentaci√≥n se implementa en un solo transistor y diodo.  El bot√≥n, cuando se presiona, restablece la potencia del regulador y se reinicia todo el circuito, esto es necesario para calibrar el TTP224.  En la parte frontal del tablero hay 4 botones t√°ctiles de 40 x 40 mm y 4 LED.  Producci√≥n ordenada por Seeedstudio, muy satisfecha con la calidad y el precio. <br><br><img src="https://habrastorage.org/webt/at/_f/nd/at_fndbfqwwo250irzbq5wcmmhs.jpeg"><br>  <i>Fig.</i>  <i>5 - Tablero de interruptores t√°ctiles</i> <br><br>  El componente m√°s importante en el interruptor t√°ctil es el controlador del bot√≥n t√°ctil.  Prob√© 3 controladores y cada uno result√≥ tener pros y contras.  Resultados de la prueba para 3 controladores de botones t√°ctiles: <br><br>  <b>TTP224</b> <br><br>  <b>Pros:</b> Barato, en la PCB en un lado puede haber almohadillas de sensores, en la parte posterior otros componentes, pero la sensibilidad se reduce considerablemente.  Configuraci√≥n de la se√±al de salida: alta / baja, configuraci√≥n del modo de bot√≥n: encendido / encendido.  4 canales <br><br>  <b>Contras:</b> si hay pistas en la parte posterior de la almohadilla t√°ctil, no funciona bien a trav√©s del plexigl√°s de m√°s de 3 mm y, lo que es peor, si la pel√≠cula est√° pegada al cristal, no responde a un ligero toque, solo presiona con la punta de los dedos completa, incluso con la sensibilidad m√°xima establecida (Cs = 1pF, rango 0-50pF, cuanto m√°s peque√±o, m√°s sensible). <br><br><img src="https://habrastorage.org/webt/tf/st/xe/tfstxe1azi2w6cir_s-wsliguzy.jpeg"><br>  <i>Fig.</i>  <i>6 - TTP224 en el tablero terminado</i> <br><br>  <b>AT42QT1011</b> <br><br>  <b>Pros:</b> reacciona a un peque√±o toque a trav√©s de plexigl√°s de 3 mm (o m√°s), si ajusta la sensibilidad a un nivel promedio (Cs = 22nF, rango 2-50nF, cuanto m√°s grande, m√°s sensible).  Se ajusta autom√°ticamente al grosor del vidrio. <br><br>  <b>Contras:</b> debajo del panel t√°ctil, no debe haber pistas, ni potencia, ni tierra, de lo contrario, la sensibilidad disminuye.  La salida es solo un nivel alto.  1 canal solamente. <br><br><img src="https://habrastorage.org/webt/t6/s9/is/t6s9is4fxztieihcctdlgvatnyw.jpeg"><br>  <i>Fig.</i>  <i>7 - Tablero de prueba AT42QT1011</i> <br><br>  <b>MTCH105</b> <br><br>  <b>Pros:</b> reacciona a un ligero toque a trav√©s de plexigl√°s de 3 mm (o m√°s).  Anti-jamming con la ayuda del suelo alrededor y debajo de los sensores, se ajusta autom√°ticamente al grosor del vidrio.  5 canales <br><br>  <b>Contras:</b> reacciona durante mucho tiempo al presionar y durante mucho tiempo se da cuenta de que se solt√≥ el dedo, aproximadamente 0,5 segundos.  Si mantiene el dedo sobre la plataforma del sensor, luego de 9 segundos el LED se apaga y se realiza la calibraci√≥n.  Se requiere que la superficie t√°ctil est√© cubierta con tierra desde todos los lados, incluso debajo de la superficie, de lo contrario, funciona en cualquier punto de contacto de la PCB. <br><br><img src="https://habrastorage.org/webt/ch/oj/l1/chojl19iuyjiyy0xa8fdq3ze7ni.jpeg"><br>  <i>Fig.</i>  <i>8 - MTCH105 en placa de pruebas</i> <br><br>  Eleg√≠ TTP224 (4 canales), porque en una PCB, por un lado, todos los componentes se pueden colocar, y en el otro lado, almohadillas de sensores.  √âl sacrific√≥ la sensibilidad, despu√©s de 3 mm, el plexigl√°s funciona si toca todo con la punta de un dedo, aunque esto puede interpretarse como protecci√≥n contra el contacto accidental :).  Si no hay pistas debajo del √°rea del sensor, reacciona a trav√©s de plexigl√°s de 4 mm al menor toque. <br><br>  <b>Todo</b> <br><br>  <i>Para fabricar un interruptor t√°ctil con dos PCB, el primero para almohadillas t√°ctiles, el segundo para todos los componentes.</i>  <i>A√±adir motor de vibraci√≥n y refuerzo.</i>  <i>Implemente la funci√≥n de luz de fondo baja cuando se active el sensor de movimiento incorporado.</i> <br><br><h3>  Estudios de difusores de luz. </h3><br>  La tarea consist√≠a en iluminar uniformemente una plataforma de 40x40 mm, que toca el dedo.  Debido a las restricciones de tama√±o de la vivienda, fue posible empujar solo un LED para cada sitio. <br><br>  Estudi√© el dispositivo de varios interruptores t√°ctiles: Livolo, Vitrum, bot√≥n t√°ctil HTTM.  Cada uno us√≥ su propio enfoque para dispersar uniformemente la luz. <br><br>  <b>Vitrum</b> <br><br>  Interruptor italiano Z-Wave con caro vidrio decorativo.  El reflector-difusor se implementa de la siguiente manera: en un plexigl√°s transparente, una llanta est√° pintada con pintura reflectante, iluminada desde el lado con un solo LED.  En el lado del LED, se aplica menos pintura, logrando as√≠ un brillo uniforme en todo el borde.  Un vidrio decorativo est√° instalado en la parte superior. <br><br><img src="https://habrastorage.org/webt/_b/og/i8/_bogi8lb0y03la15h3pgcneyhcy.jpeg"><br>  <i>Fig.</i>  <i>9 - Figura borde reflectante en plexigl√°s</i> <br><br>  <b>Livolo</b> <br><br>  Presupuesto interruptor t√°ctil chino.  Hay 2 LED en el tablero: rojo y azul, los LED brillan dentro de un pl√°stico transl√∫cido nublado, debido a las frecuentes refracciones de la luz en el interior, se obtiene un brillo uniforme de toda la superficie, se aplica pintura reflectante a la textolita. <br><br><img src="https://habrastorage.org/webt/z-/zx/lq/z-zxlqsxt9w_pgqirlbbdz7p0rs.jpeg"><br>  <i>Fig.</i>  <i>10 - Toque parte del interruptor Livolo</i> <br><br>  <b>HTTM - Modelo t√°ctil HelTec</b> <br><br>  M√≥dulo t√°ctil listo con chip Noname.  El reflector-difusor consta de 3 partes: textolita con una almohadilla de esta√±o, plexigl√°s para iluminaci√≥n final con muchos microagujeros, una pel√≠cula turbia blanca. <br><br><img src="https://habrastorage.org/webt/wl/es/8e/wles8ecf6zki98-ijs2qmcsnjay.jpeg"><br>  <i>Fig.</i>  <i>10 - M√≥dulo t√°ctil HTTM desmontado</i> <br><br><h3>  Selecci√≥n de materiales difusores. </h3><br>  <b>Difusor de plexigl√°s esmerilado</b> <br><br>  El plexigl√°s transparente de 3 mm habitual se trat√≥ con papel de lija fino en ambos lados para hacerlo opaco.  Tal plexigl√°s dispersa uniformemente la luz sobre toda la superficie.  El grosor del material le permite trabajar c√≥modamente con cualquier chip sensor.  Pero peque√±os rasgu√±os son visibles en la superficie, lo que afecta la apariencia est√©tica. <br><br><img src="https://habrastorage.org/webt/oy/1r/_s/oy1r_sgdofrsgu0ez0apiut8kde.jpeg"><br>  <i>Fig.</i>  <i>11 - Plexigl√°s helado</i> <br><br>  <b>Difusor de plexigl√°s para iluminaci√≥n frontal (LGP) y plexigl√°s de leche</b> <br>  Us√≥ 2 plexigl√°s diferentes de 2 mm de grosor, un s√°ndwich de dos elementos result√≥ ser de 4 mm.  El plexigl√°s inferior para la iluminaci√≥n final, gracias a los puntos blancos aplicados, dispersa uniformemente la luz sobre toda la superficie.  El plexigl√°s de leche superior brinda un brillo suave y una apariencia hermosa, mientras que el brillo es notablemente menor y el peso del interruptor aumenta. <br><br><img src="https://habrastorage.org/webt/4i/tk/5r/4itk5r5llm-ib540ozewsylnrye.jpeg"><br>  <i>Fig.</i>  <i>12 - Plexigl√°s para iluminaci√≥n final y plexigl√°s opal</i> <br><br>  <b>Panel Ledison Lightbox</b> <br>  La compa√±√≠a rusa Ledison proporcion√≥ un panel de caja de luz que consta de 3 componentes para la prueba: un sustrato reflectante, un plexigl√°s especial de dispersi√≥n de luz de 3 mm (se ve transparente, pero una estructura granulada es visible en el interior), una pel√≠cula protectora transparente.  Reemplac√© la pel√≠cula superior con una Oracal 8500 mate y obtuve una buena dispersi√≥n.  Pero cuando se trabaja con el interruptor, la pel√≠cula no se ve s√≥lida, se puede rayar y es dif√≠cil pegarla sin burbujas. <br><br><img src="https://habrastorage.org/webt/la/zc/_s/lazc_slqs6olk8jbxkat3xmqooi.jpeg"><br>  <i>Fig.</i>  <i>13 - Sandwich Ledison Lightbox</i> <br><br>  Despu√©s de todas las pruebas en el interruptor, utilic√© un sustrato reflectante de Ledison y su plexigl√°s se hizo mate.  Por el momento, esta es la mejor opci√≥n para m√≠, y se dispersa de manera uniforme, y el brillo no se reduce, y el grosor es adecuado. <br><br><img src="https://habrastorage.org/webt/kx/vx/th/kxvxthptvnmgjvch7jg-vaaht30.jpeg"><br>  <i>Fig.</i>  <i>14 - Caja, tablero y difusor</i> <br><br><h3>  Uso </h3><br>  Hice las primeras versiones de prueba de los interruptores hace 2 a√±os y ya tengo experiencia en su uso, uno est√° instalado cerca del ba√±o a una altura de 120 cm y es conveniente para los ni√±os, el segundo est√° ubicado cerca de la cama y controla una l√°mpara de noche, una l√°mpara de ara√±a y luz de fondo LED.  Porque  todos los botones est√°n separados por una cruz; son f√°ciles de encontrar en la oscuridad y presionan el deseado.  La retroalimentaci√≥n ligera indica exactamente qu√© bot√≥n se presiona.  En comparaci√≥n con los interruptores de bot√≥n, no encontr√© ning√∫n inconveniente. <br><br><img src="https://habrastorage.org/webt/_7/dy/g9/_7dyg9axf4nwgvs8jv-h5nmzlrs.jpeg"><br>  <i>Fig.</i>  <i>15 - Interruptor t√°ctil de bater√≠a en acci√≥n</i> <br><br>  Not√© un efecto secundario agradable, el interruptor cerca de la cama se puede usar para iluminar los gabinetes, si presiona los botones inferiores. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/oHex7dVJEbo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h3>  PS </h3><br>  Por el momento, el chip Z-Wave utiliza el firmware de un llavero Z-Wave.Me Key Fob de 4 botones, es conveniente que est√© listo y funcione bien, es inconveniente que no todas las funciones que desee.  El √∫nico problema no resuelto fue la iluminaci√≥n de las esquinas en el centro, es necesario cubrirlo con pel√≠cula de aluminio, pero por ahora creo que es mucho mejor esculpir el papel en el interior o en plexigl√°s. <br><br>  Adem√°s, planea cambiar a un m√≥dulo Z-Uno libremente programable para la implementaci√≥n de todo el software Lista de deseos. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es413473/">https://habr.com/ru/post/es413473/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es413463/index.html">API REST de Magento 2 utilizando un m√≥dulo simple como ejemplo</a></li>
<li><a href="../es413465/index.html">AMD anuncia Threadripper 2 de 32 n√∫cleos</a></li>
<li><a href="../es413467/index.html">Copia de seguridad de datos r√°pida y confiable en la nube</a></li>
<li><a href="../es413469/index.html">Una prueba de memoria que mata computadoras port√°tiles es casi una historia de detectives</a></li>
<li><a href="../es413471/index.html">Viernes Mini Tomy Fancy Toy Retrospectiva</a></li>
<li><a href="../es413479/index.html">Escribimos nuestro protocolo encima de UDP</a></li>
<li><a href="../es413481/index.html">Exportar √°rbol de prueba de JMeter a texto</a></li>
<li><a href="../es413485/index.html">Lanzamiento de GitLab 10.8: duplicaci√≥n de inserci√≥n de c√≥digo abierto e implementaci√≥n incremental</a></li>
<li><a href="../es413487/index.html">¬øQu√© debe esperar un desarrollador en el campo de las finanzas: condiciones de trabajo, proyectos y habilidades necesarias?</a></li>
<li><a href="../es413489/index.html">C√≥mo elegir un mensajero verdaderamente seguro y qu√© tiene que ver la cadena de bloques con √©l</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>