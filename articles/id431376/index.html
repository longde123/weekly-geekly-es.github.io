<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>âœï¸ ğŸŒ¹ ğŸ”‰ Migrasi data di perusahaan berdarah: apa yang harus dianalisis, agar tidak membanjiri proyek ğŸšŠ ğŸš ğŸ‘¨ğŸ¿â€ğŸš’</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Proyek integrasi sistem yang khas bagi kami terlihat seperti ini: pelanggan memiliki kereta sistem untuk pelanggan akuntansi, tugasnya adalah mengumpu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Migrasi data di perusahaan berdarah: apa yang harus dianalisis, agar tidak membanjiri proyek</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/hflabs/blog/431376/"><img src="https://habrastorage.org/webt/yk/_w/ry/yk_wry8j7irc6ma2zn65mdw0ulq.jpeg"><br><br>  Proyek integrasi sistem yang khas bagi kami terlihat seperti ini: pelanggan memiliki kereta sistem untuk pelanggan akuntansi, tugasnya adalah mengumpulkan kartu pelanggan ke dalam satu basis data.  Dan tidak hanya untuk mengumpulkan, tetapi juga untuk membersihkan duplikat dan sampah.  Untuk mendapatkan kartu pelanggan yang bersih, terstruktur, dan lengkap. <br><br>  Untuk pemula, saya akan menjelaskan bahwa migrasi berlangsung sesuai dengan skema ini: <i>sumber â†’ konversi data (jawaban <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ETL</a> atau <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">bus</a> ) â†’ penerima</i> . <br><br>  Pada satu proyek, kami kehilangan tiga bulan hanya karena tim integrator pihak ketiga tidak mempelajari data dalam sistem sumber.  Yang paling menyebalkan adalah hal ini bisa dihindari. <br><a name="habracut"></a><br>  Mereka bekerja seperti ini: <br><br><ol><li>  Integrator sistem menyesuaikan proses ETL. </li><li>  ETL mentransformasikan data sumber dan memberikannya kepada saya. </li><li>  Saya belajar membongkar dan mengirim kesalahan ke integrator. </li><li>  Integrator memperbaiki ETL dan memulai migrasi lagi. </li></ol><br>  Dalam artikel ini saya akan menunjukkan cara menganalisis data selama integrasi sistem.  Saya mempelajari unggahan ETL, itu sangat berguna.  Tetapi pada sumber data, teknik yang sama akan mempercepat pekerjaan dua kali. <br><br>  Kiat akan berguna untuk penguji, pelaksana produk perusahaan, integrator sistem, dan analis.  Resepsi bersifat universal untuk database relasional, dan mereka sepenuhnya diungkapkan pada volume dari satu juta pelanggan. <br><br>  Tetapi pertama-tama, tentang salah satu mitos utama integrasi sistem. <br><br><h2>  Dokumentasi dan arsitek akan membantu (sebenarnya tidak) </h2><br>  Integrator sering tidak mempelajari data sebelum migrasi - mereka menghemat waktu.  Mereka membaca dokumentasi, melihat strukturnya, berbicara dengan arsitek - dan itu sudah cukup.  Setelah itu, mereka sudah merencanakan integrasi. <br><br>  Ternyata buruk.  Hanya analisis yang akan menunjukkan apa yang sebenarnya terjadi dalam database.  Jika Anda tidak masuk ke data dengan lengan baju yang digulung dan kaca pembesar, migrasi akan serba salah. <br><br>  <b>Dokumentasi itu bohong.</b>  Sistem khas perusahaan berjalan 5-20 tahun.  Selama ini, perubahan di dalamnya telah didokumentasikan oleh berbagai departemen dan kontraktor.  Masing-masing dengan menara loncengnya sendiri.  Oleh karena itu, tidak ada integritas dalam dokumentasi, tidak ada yang sepenuhnya memahami logika dan struktur penyimpanan data.  Belum lagi tenggat waktu selalu ada dan tidak ada cukup waktu untuk dokumentasi. <br><br>  Sebuah cerita umum: di tabel pelanggan ada bidang "GILA", di atas kertas itu sangat penting.  Tetapi ketika saya melihat data, saya melihat - bidang itu kosong.  Akibatnya, pelanggan setuju bahwa basis target akan dilakukan tanpa bidang untuk SNIL, karena masih belum ada data. <br><br>  Kasus khusus dokumentasi adalah peraturan dan deskripsi proses bisnis: bagaimana data masuk ke dalam basis data, dalam keadaan apa, dalam format apa.  Semua ini juga tidak akan membantu. <br><br>  <b>Proses bisnis sempurna hanya di atas kertas.</b>  Di pagi hari, operator mengantuk Anatoly datang ke kantor bank di pinggiran Vyksa.  Di bawah jendela mereka berteriak sepanjang malam, dan di pagi hari Anatoly bertengkar dengan gadis itu.  Dia membenci seluruh dunia. <br><br>  Saraf belum ditertibkan, dan Anatoly sepenuhnya mendorong nama klien baru ke bidang nama belakang.  Dia benar-benar lupa tentang hari ulang tahunnya - default "01.01.1900 g" tetap dalam formulir.  Saya tidak peduli tentang peraturan ketika segala sesuatu di sekitarnya sangat menyebalkan !!! <br><br>  Kekacauan menaklukkan proses bisnis, sangat proporsional di atas kertas. <br><br>  <b>Seorang arsitek sistem tidak tahu segalanya.</b>  Lagi-lagi ini adalah masa hidup yang terhormat dari sistem perusahaan.  Selama bertahun-tahun mereka bekerja, arsitek telah berubah.  Bahkan jika Anda berbicara dengan yang sekarang, keputusan yang sebelumnya akan muncul sebagai kejutan selama proyek. <br><br>  Dan pastikan: bahkan seorang arsitek yang menyenangkan dalam segala hal akan menjaga kepura-puraan dan kruknya dari rahasia sistem. <br><br>  Integrasi "oleh instrumen" tanpa analisis data adalah kesalahan.  Saya akan menunjukkan bagaimana kita di HFLabs mempelajari data melalui integrasi sistem.  Dalam proyek terakhir, saya hanya menganalisis unggahan ETL.  Tetapi ketika pelanggan memberikan akses ke sumber data, saya pasti memeriksanya sesuai dengan prinsip yang sama. <br><br><h2>  Bidang isian dan nilai nol </h2><br>  Pemeriksaan paling sederhana adalah pada kelengkapan tabel secara keseluruhan dan pada kelengkapan masing-masing bidang.  Saya mulai dengan mereka. <br><br>  <b>Berapa total baris dalam tabel.</b>  Permintaan sesederhana mungkin. <br><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span>(*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> &lt;table_name&gt;;</code> </pre> <br>  Saya mendapatkan hasil pertama. <br><div class="scrollable-table"><table><tbody><tr><th>  Individu </th><th>  Jumlah </th></tr><tr><td>  Total </td><td>  99 966 324 </td></tr></tbody></table></div>  Di sini saya melihat kecukupan data.  Jika hanya dua juta pelanggan datang ke bongkar muat untuk bank besar, maka ada sesuatu yang jelas salah.  Tapi sementara semuanya tampak seperti yang diharapkan, terus maju. <br><br>  <b>Berapa banyak baris yang diisi untuk setiap bidang secara terpisah.</b>  Saya memeriksa semua kolom tabel. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> &lt;column_name&gt;, <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span>(*) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> &lt;column_name&gt; cnt <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> &lt;table_name&gt; <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> &lt;column_name&gt; <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>;</code> </pre> <br>  Yang pertama menemukan bidang ulang tahun yang bahagia, dan langsung penasaran: karena suatu alasan, datanya tidak datang sama sekali. <br><div class="scrollable-table"><table><tbody><tr><th>  Individu </th><th>  Jumlah </th></tr><tr><td>  Total </td><td>  99 966 324 </td></tr><tr><td>  DR </td><td>  0 </td></tr></tbody></table></div>  Jika semua nilai di lapangan adalah "NULL" dalam unggahan, hal pertama yang saya lihat adalah sistem sumber.  Mungkin data disimpan di sana dengan benar, tetapi hilang selama migrasi. <br><br>  Saya melihat bahwa dalam sistem sumber ulang tahun sudah ada.  Saya pergi ke integrator: kawan, kesalahan.  Ternyata dalam proses ETL, fungsi decode bekerja dengan tidak benar.  Kode sudah diperbaiki, pada unggahan berikutnya kita akan memeriksa perubahannya. <br><br>  Saya pergi lebih jauh ke lapangan dengan NPWP. <br><div class="scrollable-table"><table><tbody><tr><th>  Individu </th><th>  Jumlah </th></tr><tr><td>  Total </td><td>  99 966 324 </td></tr><tr><td>  DR </td><td>  0 </td></tr><tr><td>  TIN </td><td>  65 136 </td></tr></tbody></table></div>  Ada 100 juta orang di database, dan hanya 65 ribu diisi dengan NPWP - ini 0,07%.  Tingkat hunian yang lemah adalah sinyal bahwa bidang di dasar penerima mungkin tidak diperlukan sama sekali. <br><br>  Saya memeriksa sistem sumber, semuanya benar: TIN mirip dengan yang sebenarnya, tetapi hampir tidak ada.  Jadi, ini bukan tentang migrasi.  Tetap mencari tahu apakah pelanggan membutuhkan bidang yang hampir kosong di bawah TIN dalam database target. <br><br>  Saya sampai di bendera penghapusan klien. <br><div class="scrollable-table"><table><tbody><tr><th>  Individu </th><th>  Jumlah </th></tr><tr><td>  Total </td><td>  99 966 324 </td></tr><tr><td>  DR </td><td>  0 </td></tr><tr><td>  TIN </td><td>  65 136 </td></tr><tr><td>  Hapus bendera </td><td>  0 </td></tr></tbody></table></div>  Bendera kosong.  Tapi apa, perusahaan tidak menghapus pelanggan?  Saya melihat sistem sumber, berbicara dengan pelanggan.  Ternyata ya: benderanya formal, alih-alih menghapus pelanggan, akun mereka dihapus.  Tidak ada akun - seolah-olah klien telah dihapus. <br><br>  Dalam sistem target, bendera klien jarak jauh diperlukan, ini adalah fitur arsitektur.  Jadi, jika klien memiliki nol akun di sistem penerima, itu perlu ditutup melalui logika tambahan atau tidak diimpor sama sekali.  Lalu bagaimana pelanggan memutuskan. <br><br>  Selanjutnya adalah pelat alamat.  Biasanya ada yang salah dengan tabel seperti itu, karena alamat adalah hal yang rumit, mereka dimasukkan dengan cara yang berbeda. <br><br>  Saya memeriksa kelengkapan komponen alamat. <br><div class="scrollable-table"><table><tbody><tr><th>  Alamat </th><th>  Jumlah </th></tr><tr><td>  Total </td><td>  254 803 976 </td></tr><tr><td>  Negara </td><td>  229 256 090 </td></tr><tr><td>  Indeks </td><td>  46 834 777 </td></tr><tr><td>  Kota </td><td>  6 474 841 </td></tr><tr><td>  Jalan </td><td>  894.040 </td></tr><tr><td>  Rumah </td><td>  20 903 </td></tr></tbody></table></div>  Alamat tidak diisi secara seragam, tetapi terlalu dini untuk menarik kesimpulan: pertama saya akan bertanya kepada pelanggan apa tujuan mereka.  Jika untuk segmentasi berdasarkan negara, semuanya baik-baik saja: ada cukup data.  Jika untuk milis, maka masalahnya adalah: rumah-rumah hampir kosong, tidak ada apartemen. <br><br>  Akibatnya, pelanggan melihat bahwa ETL mengambil alamat dari tablet yang lama dan tidak relevan.  Dia di pangkalan seperti monumen.  Tetapi ada tabel lain, baru dan bagus, data harus diambil darinya. <br><br>  Selama analisis, saya mengisi bidang yang menghubungkan ke direktori dengan kekhasan.  Kondisi "BUKAN NULL" tidak berfungsi dengan mereka: alih-alih "NULL", sel biasanya "0".  Oleh karena itu, periksa bidang referensi secara terpisah. <br><br>  <b>Perubahan dalam mengisi bidang.</b>  Jadi, saya memeriksa keseluruhan hunian dan hunian masing-masing bidang.  Menemukan masalah, integrator memperbaiki proses ETL dan memulai migrasi lagi. <br><br>  Saya menjalankan pembongkaran kedua untuk semua langkah yang tercantum di atas.  Saya menulis statistik ke file yang sama untuk melihat perubahannya. <br><br>  Kelengkapan semua bidang. <br><div class="scrollable-table"><table><tbody><tr><th>  Individu </th><th>  Bongkar 1 </th><th>  Bongkar 2 </th><th>  Delta </th></tr><tr><td>  Total </td><td>  99 966 324 </td><td>  94 847 160 </td><td>  -5 119 164 </td></tr></tbody></table></div>  Di antara unggahan, 5 juta catatan menghilang.  Saya pergi ke integrator, mengajukan pertanyaan khas: <br><br><ul><li>  "Mengapa catatan hilang?"; </li><li>  "Data apa yang disaring?"; </li><li>  "Data apa yang kamu tinggalkan?" </li></ul><br>  Ternyata tidak ada masalah: mereka hanya menghapus pelanggan "teknis" dari bongkar muat baru.  Mereka ada dalam database untuk tes, mereka bukan orang hidup.  Tetapi dengan probabilitas yang sama, data bisa hilang karena kesalahan, ini terjadi. <br><br>  Tapi ulang tahun di bongkar muat baru muncul, seperti yang saya harapkan. <br><div class="scrollable-table"><table><tbody><tr><th>  Individu </th><th>  Bongkar 1 </th><th>  Bongkar 2 </th><th>  Delta </th></tr><tr><td>  Total </td><td>  99 966 324 </td><td>  94 847 160 </td><td>  -5 119 164 </td></tr><tr><td>  DR </td><td>  0 </td><td>  77 046 780 </td><td>  77 046 780 </td></tr></tbody></table></div>  Tapi!  Belum tentu bagus ketika data yang sebelumnya hilang tiba-tiba muncul di unggahan baru.  Misalnya, ulang tahun dapat diisi dengan tanggal standar - tidak ada yang perlu disukacitakan.  Karena itu, saya selalu memeriksa data mana yang datang. <br><br>  <i>Singkatnya, apa yang harus diperiksa.</i> <i><br><br></i> <ol><li>  <i>Jumlah total entri dalam tabel.</i>  <i>Apakah kuantitas ini memadai untuk harapan?</i> </li><li>  <i>Jumlah baris yang diisi di setiap bidang.</i> </li><li>  <i>Rasio jumlah baris yang diisi di setiap bidang dengan jumlah baris dalam tabel.</i>  <i>Jika terlalu kecil, ini adalah kesempatan untuk berpikir apakah akan menyeret bidang ke basis target.</i> </li></ol> <i><br></i>  <i>Ulangi tiga langkah pertama untuk setiap unggahan.</i>  <i>Ikuti dinamika: di mana dan mengapa itu meningkat atau menurun.</i> <br><br><h2>  Panjang nilai dalam bidang string </h2><br>  Saya mengikuti salah satu aturan dasar pengujian - saya memeriksa nilai batas. <br><br>  <b>Nilai mana yang terlalu pendek.</b>  Di antara nilai-nilai terpendek penuh dengan sampah, sehingga menarik untuk digali di sini. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> &lt;table_name&gt; <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span>(&lt;column_name&gt;) &lt; <span class="hljs-number"><span class="hljs-number">3</span></span>;</code> </pre> <br>  Dengan cara ini, saya memeriksa nama, nomor telepon, TIN, OKVED, alamat situs web.  Omong kosong muncul seperti "A * 1", "0", "11", "-" dan "...". <br><br>  <b>Apakah semuanya baik-baik saja dengan nilai maksimum.</b>  Bidang tertutup adalah penanda fakta bahwa data tidak cocok selama transfer, dan data terputus secara otomatis.  MySQL memecahkan masalah ini dengan terkenal tanpa peringatan.  Pada saat yang sama, tampaknya migrasi berjalan lancar. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> &lt;table_name&gt; <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span>(&lt;column_name&gt;) = <span class="hljs-number"><span class="hljs-number">65</span></span>;</code> </pre> <br>  Dengan cara ini, saya menemukan di lapangan dengan jenis dokumen baris "Sertifikat pendaftaran aplikasi imigran untuk pengakuannya."  Dia mengatakan kepada integrator, panjang bidang dikoreksi. <br><br>  <b>Bagaimana nilai-nilai didistribusikan sepanjang.</b>  Di HFLabs, kami memanggil tabel distribusi panjang untuk baris. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span>(&lt;column_name&gt;), <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span>(&lt;column_name&gt;) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> &lt;table_name&gt; <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span>(&lt;column_name&gt;);</code> </pre> <br>  Di sini saya mencari anomali dalam distribusi sepanjang.  Misalnya, ini adalah frekuensi untuk tabel dengan alamat surat. <br><div class="scrollable-table"><table><tbody><tr><th>  Panjangnya </th><th>  Jumlah </th></tr><tr><td>  122 </td><td>  120 </td></tr><tr><td>  123 </td><td>  90 </td></tr><tr><td>  124 </td><td>  130 </td></tr><tr><td>  125 </td><td>  1100 </td></tr><tr><td>  126 </td><td>  70 </td></tr></tbody></table></div>  Nilai dengan panjang 125 terlalu banyak.  Saya melihat basis data sumber dan menemukan bahwa karena suatu alasan, beberapa alamat terputus menjadi 125 karakter tiga tahun lalu.  Di tahun-tahun lainnya, semuanya baik-baik saja.  Saya setuju dengan masalah ini kepada pelanggan dan integrator, kami mengerti. <br><br>  <i>Singkatnya, apa yang harus diperiksa.</i> <i><br><br></i> <ol><li>  <i>Nilai terpendek dalam bidang string.</i>  <i>Seringkali baris dengan karakter kurang dari tiga adalah sampah.</i> </li><li>  <i>Nilai yang "berbatasan" di sepanjang panjang bidang.</i>  <i>Seringkali mereka disunat.</i> </li><li>  <i>Anomali dalam distribusi baris sepanjang.</i> </li></ol><br><h2>  Nilai Populer </h2><br>  Saya membagi menjadi tiga kategori nilai-nilai yang termasuk dalam populer teratas: <br><br><ul><li>  <i>sangat umum</i> , seperti nama "Tatyana" atau nama tengah "Vladimirovich".  Di sini harus diingat bahwa dalam kasus umum, Tatyana tidak boleh 100 kali lebih populer daripada Anna, dan Ismail hampir tidak bisa lebih populer daripada Egor; </li><li>  <i>sampah</i> , seperti ".", "1", "-" dan sejenisnya; </li><li>  <i>Default</i> pada formulir input, sebagai "01/01/1900" untuk tanggal. </li></ul><br>  Dua dari tiga kasus adalah penanda masalah, akan berguna untuk mencarinya. <br><br>  Saya mencari nilai-nilai populer di tiga jenis bidang: <br><br><ol><li>  Bidang string biasa. </li><li>  Bidang string referensi.  Ini adalah bidang string biasa, tetapi jumlah nilai yang berbeda di dalamnya tentu saja diatur.  Bidang-bidang ini menyimpan negara, kota, bulan, jenis telepon. </li><li>  Bidang pengklasifikasi - berisi tautan ke entri di tabel pengklasifikasi pihak ketiga. </li></ol><br>  Saya mempelajari bidang masing-masing jenis ini sedikit berbeda. <br><br>  <b>Untuk bidang string - berapakah 100 nilai populer teratas.</b>  Jika mau, Anda bisa mengambil lebih banyak, tetapi dalam seratus nilai pertama semua anomali biasanya ditempatkan. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> &lt;column_name&gt;, <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span>(*) cnt <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> &lt;table_name&gt; <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> &lt;column_name&gt; <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ROWNUM</span></span> &lt;= <span class="hljs-number"><span class="hljs-number">100</span></span>;</code> </pre> <br>  Saya memeriksa bidang dengan cara ini: <br><br><ul><li>  Nama lengkap, serta nama belakang, nama depan, dan patronimik yang terpisah; </li><li>  tanggal lahir dan umumnya tanggal apa pun; </li><li>  alamat  Alamat lengkap dan komponen individualnya, jika disimpan dalam basis data; </li><li>  Telepon </li><li>  seri, nomor, jenis, tempat penerbitan dokumen. </li></ul><br>  Hampir selalu di antara nilai tes populer dan standar, beberapa bertopik. <br><br><img src="https://habrastorage.org/webt/hl/sg/cr/hlsgcrpcy9y1i-gpyfoead8byzg.png"><br><br>  Terjadi bahwa masalah yang ditemukan bukan masalah sama sekali.  Suatu ketika saya menemukan nomor telepon yang mencurigakan populer di database.  Ternyata klien menunjukkan nomor ini sebagai pekerja, dan dalam database hanya ada banyak karyawan dari satu organisasi. <br><br>  Sepanjang jalan, analisis semacam itu akan menampilkan bidang referensi tersembunyi.  Logikanya, bidang-bidang ini tidak seharusnya menjadi direktori, tetapi sebenarnya mereka ada di database.  Misalnya, saya memilih nilai-nilai populer dari bidang "Posisi", dan hanya ada lima. <br><div class="scrollable-table"><table><tbody><tr><th>  Judul pekerjaan </th></tr><tr><td>  Direktur </td></tr><tr><td>  Akuntan </td></tr><tr><td>  Spesialis </td></tr><tr><td>  Sekretaris </td></tr><tr><td>  Administrator sistem </td></tr></tbody></table></div>  Mungkin perusahaan hanya melayani lima profesi.  Tidak terlalu benar, bukan?  Alih-alih, dalam bentuk untuk operator, alih-alih baris, mereka membuat direktori dan lupa untuk membuang nilai.  Pertanyaan penting di sini adalah: apakah bijak mengisi posting melalui direktori?  Jadi melalui analisis data, saya mencari kemungkinan masalah dengan perangkat lunak operator. <br><br>  <b>Untuk bidang referensi dan pengklasifikasi, saya memeriksa popularitas semua nilai.</b>  Untuk memulainya, saya mencari tahu bidang mana yang merupakan direktori.  Anda tidak dapat bertahan dengan skrip, saya mengambil dokumentasi dan berpura-pura.  Biasanya, direktori dibuat untuk nilai yang jumlahnya terbatas dan relatif kecil: <br><br><ul><li>  negara </li><li>  bahasa </li><li>  mata uang </li><li>  bulan </li><li>  kota. </li></ul><br>  Di dunia yang ideal, isi bidang referensi jelas dan konsisten.  Tapi dunia kita tidak seperti itu, jadi saya periksa dengan permintaan. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> &lt;column_name&gt;, <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span>(*) cnt <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> &lt;table_name&gt; <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> &lt;column_name&gt; <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span>;</code> </pre> <br>  Biasanya di bidang string direktori terletak ini. <br><div class="scrollable-table"><table><tbody><tr><th>  Tempat lahir </th><th>  Jumlah </th></tr><tr><td>  tajikistan </td><td>  467 599 </td></tr><tr><td>  Tajikistan </td><td>  410 484 </td></tr><tr><td>  Rusia </td><td>  292.585 </td></tr><tr><td>  TAJIKISTAN </td><td>  234,465 </td></tr><tr><td>  Rusia </td><td>  158 163 </td></tr><tr><td>  RUSIA </td><td>  76 367 </td></tr></tbody></table></div>  Masalah umum: <br><br><ul><li>  kesalahan ketik; </li><li>  spasi </li><li>  kasus yang berbeda. </li></ul><br>  Setelah menemukan kekacauan, saya pergi ke integrator dengan contoh di tangan.  Biarkan mereka meninggalkan sampah di sumbernya, dan menghilangkan perbedaan.  Kemudian dalam database target untuk rigor, dimungkinkan untuk mengubah garis referensi menjadi pengklasifikasi. <br><br>  Saya memeriksa nilai-nilai populer di bidang classifier untuk menangkap kurangnya pilihan.  Menghadapi kasus seperti itu. <br><div class="scrollable-table"><table><tbody><tr><th>  Gender </th><th>  Jenis telepon </th></tr><tr><td><ol><li>  Perempuan </li><li>  Tidak ditentukan </li></ol></td><td><ol><li>  Rumah </li></ol></td></tr></tbody></table></div>  Penggolong seperti itu terlihat sangat aneh, mereka harus ditunjukkan kepada pelanggan.  Setiap kali saya memiliki kesalahan di balik kasus-kasus seperti itu: entah ada sesuatu yang salah dalam database, atau data diunduh dari tempat yang salah. <br><br>  <i>Singkatnya, apa yang harus diperiksa.</i> <i><br><br></i> <ol><li>  <i>Bidang string mana yang menjadi referensi dan mana yang bukan.</i> </li><li>  <i>Untuk bidang string sederhana, nilai teratas populer.</i>  <i>Biasanya di bagian atas sampah dan data default.</i> </li><li>  <i>Untuk bidang referensi string, distribusi semua nilai berdasarkan popularitas.</i>  <i>Seleksi akan menunjukkan perbedaan dalam nilai referensi.</i> </li><li>  <i>Untuk pengklasifikasi - apakah ada cukup opsi dalam database.</i> </li></ol><br><h2>  Konsistensi dan Rekonsiliasi Lintas </h2><br>  Dari analisis data di dalam tabel, saya beralih ke analisis hubungan. <br><br>  <b>Apakah data terikat atau tidak.</b>  Kami menyebut parameter ini "konsistensi".  Saya mengambil tabel bawahan, misalnya, dengan telepon.  Untuk itu dalam pasangan - tabel induk klien.  Dan saya melihat berapa banyak klien dalam tabel bawahan adalah pengidentifikasi yang tidak ada dalam induk. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span>(*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> ((<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> &lt;ID1&gt; <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> &lt;table_name_1&gt;) <span class="hljs-keyword"><span class="hljs-keyword">MINUS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> &lt;ID2&gt; <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> &lt;table_name_2&gt;));</code> </pre> <br>  Jika permintaan memberi delta, artinya tidak berhasil - ada data yang tidak terkait dalam unggahan.  Jadi saya memeriksa tabel dengan telepon, kontrak, alamat, tagihan dan sebagainya.  Suatu ketika, selama proyek, dia menemukan 23 juta angka yang menggantung di udara. <br><br>  Ini juga bekerja dalam arah yang berlawanan - Saya mencari klien yang karena alasan tertentu tidak memiliki kontrak tunggal, alamat, nomor telepon.  Terkadang ini normal - yah, klien tidak memiliki alamat, apa yang salah.  Di sini Anda perlu mencari tahu dari pelanggan, dokumentasi akan dengan mudah menipu. <br><br>  <b>Apakah ada duplikasi kunci utama dalam tabel yang berbeda.</b>  Terkadang entitas identik disimpan dalam tabel yang berbeda.  Misalnya, pelanggan heteroseksual.  (Tidak ada yang tahu mengapa, karena Brezhnev masih mengklaim strukturnya.) Tetapi tabel di penerima adalah tunggal, dan ketika bermigrasi, pengidentifikasi klien akan mengalami konflik. <br><br>  Saya menghidupkan kepala saya dan melihat struktur pangkalan: di mana fragmentasi entitas serupa mungkin terjadi.  Ini bisa berupa tabel pelanggan, telepon kontak, paspor dan sebagainya. <br><br>  Jika ada beberapa tabel dengan entitas yang serupa, saya melakukan pemeriksaan silang: Saya memeriksa persimpangan pengidentifikasi.  Intersect - lem patch.  Misalnya, kami mengumpulkan pengidentifikasi untuk tabel tunggal sesuai dengan skema "nama tabel sumber + ID". <br><br>  <i>Singkatnya, apa yang harus diperiksa.</i> <i><br><br></i> <ol><li>  <i>Berapa banyak data yang tidak terkait dalam tabel yang ditautkan.</i> </li><li>  <i>Adakah potensi konflik kunci primer?</i> </li></ol><br><h2>  Apa lagi yang perlu diperiksa </h2><br>  <b>Apakah ada karakter Latin yang bukan miliknya?</b>  Misalnya, dalam nama keluarga. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> &lt;column_name&gt; <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> &lt;table_name&gt; <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REGEXP_LIKE</span></span>(&lt;column_name&gt;, <span class="hljs-string"><span class="hljs-string">'[AZ]'</span></span>, <span class="hljs-string"><span class="hljs-string">'i'</span></span>);</code> </pre> <br>  Jadi saya menangkap huruf Latin yang indah "C", yang bertepatan dengan Cyrillic.  Kesalahannya tidak menyenangkan, karena sesuai dengan nama dengan "C" Latin operator tidak akan pernah menemukan klien. <br><br>  <b>Apakah ada karakter asing di bidang string yang dimaksudkan untuk angka?</b> <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> &lt;column_name&gt; <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> &lt;table_name&gt; <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REGEXP_LIKE</span></span>(&lt;column_name&gt;, <span class="hljs-string"><span class="hljs-string">'[^0-9]'</span></span>);</code> </pre> <br>  Masalah muncul di bidang dengan nomor paspor Federasi Rusia atau TIN.  Ponsel sama, tetapi di sana saya mengizinkan plus, tanda kurung dan tanda hubung.  Permintaan juga akan mengungkapkan huruf "O", yang ditetapkan bukan nol. <br><br>  <b>Seberapa memadai data tersebut.</b>  Anda tidak pernah tahu di mana masalah akan muncul, jadi saya selalu waspada.  Saya bertemu dengan beberapa kasus: <br><br><ul><li>  <i>Apakah "Sofya Vladimirovna" klien 50.000 telepon - apakah ini normal?</i>  Jawab: tidak normal.  Klien itu teknis, mereka memasukkan nomor telepon "tanpa pemilik" padanya untuk melakukan sms-mail.  Tidak perlu menarik klien ke pangkalan baru; </li><li>  <i>Nomor identifikasi wajib pajak diisi, pada kenyataannya, kolom berisi "79853617764", "89109462345", "4956780966" dan seterusnya.</i>  Telepon macam apa, okuda?  Dimana penginapannya?  Jawab: angka seperti apa - tidak diketahui siapa yang menyebutkannya - tidak jelas.  Tidak ada yang menggunakannya.  NPWP saat ini disimpan di bidang lain dari tabel lain, diambil dari sana; </li><li>  <i>bidang â€œaddress in one lineâ€ tidak sesuai dengan bidang di mana alamat disimpan di bagian-bagian.</i>  Mengapa alamatnya berbeda?  Jawab: begitu operator mengisi alamat dengan satu baris, dan sistem eksternal mengurutkan alamat ke dalam bidang yang berbeda.  Untuk segmentasi.  Seiring waktu berlalu, orang-orang mengubah alamat.  Operator secara teratur memperbaruinya, tetapi hanya sebagai string: alamat tetap lama di beberapa bagian. </li></ul><br><h2>  Yang Anda butuhkan hanyalah SQL dan Excel </h2><br>  Untuk menganalisis data, perangkat lunak yang mahal tidak diperlukan.  Excel tua yang cukup baik dan pengetahuan tentang SQL. <br><br>  Excel saya gunakan untuk mengkompilasi permintaan panjang.  Sebagai contoh, saya memeriksa kolom untuk kelengkapan, dan ada 140 di tabel. Saya akan menulis dengan tangan saya di depan konspirasi wortel, jadi saya mengumpulkan permintaan dengan formula di excel-plate. <br><br><img src="https://habrastorage.org/webt/ww/m3/br/wwm3br0qxpp7gudattxhkxnx1fm.png"><br>  <sub>Di kolom "A" saya memasukkan nama-nama bidang, saya membawanya dalam dokumentasi atau tabel layanan.</sub>  <sub>Di kolom "B" - formula untuk menempelkan permintaan</sub> <br><br>  Saya memasukkan nama-nama bidang, menulis rumus pertama di kolom "B", tarik sudut - dan Anda selesai. <br><br><img src="https://habrastorage.org/webt/1r/ld/ct/1rldctxhypv2xw3era05-lkixhu.gif"><br>  <sub>Bekerja di Excel, dan di Google Documents, dan di Excel Online (tersedia di Yandex.Disk)</sub> <br><br>  Analisis data menghemat waktu dan menghemat keberanian para manajer.  Dengan itu lebih mudah untuk memenuhi tenggat waktu.  Jika proyek ini besar, analitik akan menghemat jutaan rubel dan reputasi. <br><br><h2>  Bukan angka, tapi kesimpulan </h2><br>  Dia merumuskan aturan untuk dirinya sendiri: untuk tidak menunjukkan nomor telanjang kepada pelanggan, Anda masih tidak akan mendapatkan efeknya.  Tugas saya adalah menganalisis data dan menarik kesimpulan, dan melampirkan angka sebagai bukti.  Kesimpulannya adalah primer, angka adalah sekunder. <br><br>  Apa yang saya kumpulkan untuk laporan: <br><br><ul><li>  <i>kata-kata dari masalah dalam bentuk hipotesis atau pertanyaan</i> : "TIN penuh 0,07%.  Bagaimana Anda menggunakan data ini, seberapa relevan itu, bagaimana menafsirkannya?  Apakah hanya ada satu INN di satu meja? â€  Anda tidak dapat menyalahkan: "TIN Anda tidak terisi sama sekali."  Sebagai tanggapan, Anda hanya akan menerima agresi; </li><li>  <i>contoh masalah.</i>  Ini adalah tablet yang ada begitu banyak di artikel; </li><li>  <i>opsi untuk bagaimana melakukannya:</i> "Mungkin perlu menghapus TIN dari basis target agar tidak menghasilkan bidang kosong." </li></ul><br>  Saya tidak punya hak untuk memutuskan apa yang harus dipilih dari sumber database dan bagaimana mengubah data selama migrasi.  Oleh karena itu, dengan laporan tersebut, saya pergi ke pelanggan atau ke integrator, dan kami mencari tahu bagaimana untuk melanjutkan. <br><br>  Terkadang pelanggan, melihat masalahnya, menjawab: â€œJangan khawatir, jangan perhatikan.  Kami akan membeli memori terabyte ekstra, itu saja.  Itu lebih murah daripada mengoptimalkan. "  Anda tidak dapat menyetujui hal ini: jika Anda mengambil semuanya dalam satu baris, tidak akan ada kualitas pada penerima.  Semua data redundan sampah yang sama sedang dimigrasi. <br><br>  Oleh karena itu, kami dengan lembut tetapi terus bertanya: "Beri tahu kami bagaimana Anda akan menggunakan data khusus ini dalam sistem target."  Bukan "mengapa Anda perlu", yaitu "bagaimana Anda akan menggunakannya."  Jawaban "maka kita akan datang dengan" atau "berjaga-jaga" tidak cocok.  Cepat atau lambat, pelanggan mengerti data apa yang bisa diberikan. <br><br>  Hal utama adalah menemukan dan menyelesaikan semua masalah sampai sistem diluncurkan di prod.  Untuk mengubah arsitektur dan model data hidup, Anda akan kehilangan akal. <br><br>  Itu semua dengan cek dasar, pelajari data! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id431376/">https://habr.com/ru/post/id431376/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id431360/index.html">Jelaskan backdoor dalam event-stream</a></li>
<li><a href="../id431362/index.html">Bagaimana seorang desainer bisa menyingkirkan rutinitas dan tetap tertarik pada pekerjaannya?</a></li>
<li><a href="../id431370/index.html">Laporan tercepat di barat liar. Dan beberapa bug di samping ...</a></li>
<li><a href="../id431372/index.html">Mengganggu dari perangkat eksternal dalam sistem x86. Bagian 2. Opsi boot kernel Linux</a></li>
<li><a href="../id431374/index.html">Penilaian terakhir: analisis indikator keuangan permainan di akses awal</a></li>
<li><a href="../id431378/index.html">Seluruh kebenaran tentang RTOS. Artikel # 23. Antrian: pengantar dan layanan dasar</a></li>
<li><a href="../id431380/index.html">Mitap Netologiya dan Skyeng tentang soft skill "Apa yang perlu diketahui pengembang kecuali kode"</a></li>
<li><a href="../id431382/index.html">Hasil Survei Ekosistem JVM</a></li>
<li><a href="../id431384/index.html">CLion 2018.3: pengembangan jarak jauh, profiling kode, kinerja, dan lainnya</a></li>
<li><a href="../id431388/index.html">Dunia melalui mata mobil. Bagaimana drone melihatnya?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>