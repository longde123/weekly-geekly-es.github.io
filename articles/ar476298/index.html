<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎶 🖖🏾 👨🏿‍🤝‍👨🏻 انتقل عبر الشوك للدراجات ، الجزء الأول: تعلم أساسيات تخصيص مصحح أخطاء Visual Studio باستخدام المكونات الإضافية 🏴󠁧󠁢󠁷󠁬󠁳󠁿 🚥 🗾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="رافق أحد الابتكارات في Visual Studio 2012 ظهور مصحح أخطاء مخصص جديد يسمى Concord. يتيح نظام المكونات الخاص به لـ VSIX المكونات الإضافية لتخصيص سلوك مص...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>انتقل عبر الشوك للدراجات ، الجزء الأول: تعلم أساسيات تخصيص مصحح أخطاء Visual Studio باستخدام المكونات الإضافية</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/476298/" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/kl/8o/1x/kl8o1xvmgggvg_ssk6tb72xz6se.png" align="right">  رافق أحد الابتكارات في Visual Studio 2012 ظهور مصحح أخطاء مخصص جديد يسمى Concord.  يتيح نظام المكونات الخاص به لـ VSIX المكونات الإضافية لتخصيص سلوك مصحح الأخطاء وكتابة أدوات جديدة حساسة للسياق يمكنها استخدام مصحح الأخطاء لاحتياجاتها.  يوفر API الخاص به العديد من ميزات QOL ، مثل التنظيم بين التعليمات البرمجية المدارة / غير المُدارة ، والتكامل السلس مع عملية تصحيح الأخطاء عن بُعد / محليًا ، وأكثر من ذلك.  في الواقع ، يمكن القيام بكل شيء تقريبًا في IDE برمجيًا باستخدام واجهة Concord API!  قم بتغيير قيم المتغيرات المحددة أثناء التنقل ، ووظائف الاتصال عند الطلب (أو قم بإجراء تخطي البرنامج على وجه التحديد لهم!) ، يمكن أن تبحث المكونات الإضافية عن طريق PDB (!) ، وتجاوز خطوة بخطوة ، وحتى تعديل الرمز!  افتح القطة وستتعرف على هذه الابتكارات غير المعروفة في مجال بناء الدراجات. <br><a name="habracut"></a><br>  ربما يجب أن تبدأ من البداية.  يكتشف مصحح الأخطاء المكونات من خلال قراءة المعلومات من ملف <i>vsdconfig</i> المشار إليه بواسطة بيان مكون VSIX.  بدوره ، تشير <i>vsdconfig</i> إلى الواجهات التي يتم تنفيذها بواسطة مكونات البرنامج المساعد وكيفية العثور على هذه المكونات (ارتباط إلى ملف .dll ، يشير إلى الفئة أو ، في حالة التنفيذ الأصلي ، يشير إلى CLSID. سأقدم أمثلة في C #).  أيضا ، يشار إلى معرف فريد (GUID) لكل مكون ، وكذلك "مستواه".  المستوى هو الذي يحدد في أي ترتيب سوف تتم معالجة المكونات الإضافية ، وكذلك في سياق العملية التي سيتم تحميل هذا التطبيق - في عملية IDE أو في عملية التطبيق الذي تم تصحيحه.  هذا يرجع إلى حقيقة أن بعض الوظائف يمكن أن تعمل فقط في سياق IDE ، والعكس بالعكس - فقط في سياق عملية تم تصحيحها.  تعمل بعض وظائف API بنفس الطريقة هناك وهناك.  أيضًا ، هناك عدد من المكونات لديها قواعد تخطيط خاصة بها ، لأنها قد تعتمد على عناصر مصحح الأخطاء الموجودة في مستوياتها الثابتة.  لتجنب الحوادث ، أوصي بـ RTFM (https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.debugger.componentinterfaces؟view=visualstudiosdk-2017) وتجارب مستقلة في صندوق حماية منفصل ، مما لن يكون مؤسفًا حذف إذا حدث شيء ما (هذا مرتبط ، مرة أخرى ، بمثل هذه الفروق الدقيقة - في بعض الحالات ، لا يكون من الواضح سبب عدم تحميل التجميع أو النوع ، لأنني ما زلت لا أستطيع العثور على المكان الذي ستظهر به السجلات التي تشير إلى المشكلة بشكل ثابت. خطأ ، على سبيل المثال ، مع الإشارة إلى التبعية التي لا يمكن تحميلها في العملية الهدف ، فقد تظهر في الإخراج st  DI-، أو لا. كن akuratno، واتخاذ يرتكب متكررة، <s>وعدم الجلوس وراء عجلة القيادة في حالة سكر).</s> <br><br>  قائمة المستويات هي كما يلي (سأقدم النص باللغة الإنجليزية حتى لا يتعرض القارئ لحوادث عند ارتكاب أعمال RFTM): <br><br>  مستويات مكون IDE (القيم&gt; 100،000): <br><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><th>  عنصر </th><th>  مستوى المكون </th></tr><tr><td>  AD7 AL </td><td>  1000000000 </td></tr><tr><td>  مزود التفكيك </td><td>  9998000 </td></tr><tr><td>  Stack Query - المكونات التي ترغب في الاستعلام عن مكدس الاستدعاءات </td><td>  9997000 </td></tr><tr><td>  مزود المكدس </td><td>  9996000 </td></tr><tr><td>  عامل تصفية المكدس - المستوى الذي يمكن فيه ترشيح المكدسات وتعليقها </td><td>  9995000 </td></tr><tr><td>  مدير نقطة التوقف </td><td>  9994000 </td></tr><tr><td>  تقييم التعبير IDE </td><td>  9992000 </td></tr><tr><td>  Symbol Stack Walkers - مشايات المكدس التي تحتاج إلى الوصول إلى الرموز </td><td>  9991000 </td></tr><tr><td>  IDE SymbolProvider - المكونات التي توفر معلومات الرمز لبقية المصحح.  لا ينبغي استخدام مسار الرمز أسفل هذا المستوى. </td><td>  1999000 </td></tr></tbody></table></div><br>  مستويات مكونات العملية المستهدفة (القيم &lt;99.999): <br><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><th>  عنصر </th><th>  مستوى المكون </th></tr><tr><td>  Monitor Symbol Provider - موفرو الرمز عندما تكون الحالة الرمزية مبنية على الكمبيوتر المستهدف (على سبيل المثال: المترجم الشفهي المترجم ديناميكيًا / المنبعث ديناميكيًا) </td><td>  75000 </td></tr><tr><td>  Breakpoint Condition Processor - هذا المستوى هو لمعالجة شروط نقطة التوقف مثل تعبيرات الحالة وعدد مرات الدخول.  أسفل هذه النقطة ، ستكون جميع أحداث نقاط التوقف الفعلية مرئية بغض النظر عما إذا كانت هناك ظروف مزيفة أم لا. </td><td>  70000 </td></tr><tr><td>  Monitor Task Provider - هذا هو المستوى لاستخراج بيانات المهمة في العملية المستهدفة </td><td>  65500 </td></tr><tr><td>  مراقب مقيم التعبير </td><td>  65000 </td></tr><tr><td>  تنسيق الشاشة - المكونات التي تتحكم بين الشاشات المختلفة للخطو ، أو نقاط التوقف حسب العنوان الأصلي ، أو السير المكدس ، إلخ. </td><td>  60000 </td></tr><tr><td>  مراقبة مشوا المكدس </td><td>  55000 </td></tr><tr><td>  Custom Debug Monitor - محجوز لمراقبي تصحيح الأطراف الثالثة الذين يرغبون في الاستفادة من الخدمات التي توفرها شاشات تصحيح الأخطاء القياسية. </td><td>  40500 </td></tr><tr><td>  Runtime Debug Monitor - يوفر فحص البيانات والتحكم في التنفيذ لرمز المدارة / الأم / البرنامج النصي </td><td>  40000 </td></tr><tr><td>  رصد تصحيح قاعدة </td><td>  10000 </td></tr><tr><td>  خدمات مراقبة تصحيح الأخطاء الأساسية - توفر خدمات الأداة المساعدة لأجهزة مراقبة تصحيح الأخطاء الأساسية (على سبيل المثال: إنشاء العملية) بالإضافة إلى خدمات ما قبل تصحيح الأخطاء (على سبيل المثال: تعداد العمليات) </td><td>  1000 </td></tr></tbody></table></div><br>  بعد ذلك ، بالترتيب ، عملية إنشاء مشروع.  إذا لم تكن هناك أي فروق دقيقة مهمة ، فيمكنني وصف هذه العملية إلى الحد الأدنى أو تخطيها على الإطلاق ، ولكن الحقائق مختلفة تمامًا - نحتاج إلى عدد من التبعيات بالمكتبة ، فضلاً عن أداة لإنشاء ملفات التكوين ، والتي لا يتم توزيعها مع VisualStudio لسبب ما ، ولكنها متوفرة فقط مع nuget.  في الواقع ، نحن الآن بحاجة إلى الانتقال إلى الجوهر.  تتمحور عملية إنشاء وإعداد مشروع على النحو التالي: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  افتح Visual Studio.  في حالتي ، 2017 مجتمع الطبعة </li><li style=";text-align:right;direction:rtl">  VSIX Project ( <i>Visual C # -&gt;</i> علامة التبويب القابلية <i>للتوسعة</i> ، أو عبر البحث).  دعنا نسميها "HelloVSIX" </li><li style=";text-align:right;direction:rtl">  أضف مشروع مكتبة فئة جديدة في الحل ، واسمه "DebuggeePlugin" </li><li style=";text-align:right;direction:rtl">  وضعنا المرجع في مشروع "DebuggeePlugin" في مشروع "HelloVSIX" </li><li style=";text-align:right;direction:rtl">  نضع الإشارة إلى التجميع "Microsoft.VisualStudio.Debugger.Engine" في مشروع DebuggeePlugin </li><li style=";text-align:right;direction:rtl">  إضافة المرجع لحزمة nuget Microsoft.VSSDK.Debugger.VSDConfigTool إلى مشروع "DebuggeePlugin".  هذه هي أداتنا لإنشاء تكوينات VSD. </li></ol><br>  الآن ، نحن مستعدون لجعل البرنامج المساعد لدينا يفعل شيئًا مفيدًا.  لنقم بأبسط ما يمكنك القيام به - فدعه يعرض MessageBox مكتوب عليه "Hello VSIX" عندما تصادف العملية الهدف نقطة إدخال.  للقيام بذلك ، نحتاج إلى إنشاء فئة تنفذ واجهة <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">IDkmEntryPointNotification</a> ، بالإضافة إلى ملء العديد من ملفات التكوين.  أضف فئة عامة جديدة تسمى DkmEntryPointNotificationService ، <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">وارث</a> واجهة <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">IDkmEntryPointNotification</a> ، واترك التطبيق الافتراضي الآن: <br><br><pre style=";text-align:right;direction:rtl"><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Debugger; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Debugger.ComponentInterfaces; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Threading.Tasks; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">DebuggeePlugin</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">DkmEntryPointNotificationService</span></span> : <span class="hljs-title"><span class="hljs-title">IDkmEntryPointNotification</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnEntryPoint</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DkmProcess process, DkmThread thread, DkmEventDescriptor eventDescriptor</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NotImplementedException(); } } }</code> </pre> <br>  أضف الملف "DkmEntryPointNotificationService.vsdconfigxml" إلى مشروع "DebuggeePlugin".  لكل فئة معلنة يجب أن تتلقى إعلامات من خلال تطبيقات Microsoft.VisualStudio.Debugger.ComponentInterfaces واجهات مساحة الاسم ، يجب أن يكون لديك مثل هذا الملف.  بالمناسبة ، من الممكن تنفيذ العديد من هذه الواجهات دفعة واحدة في فصل واحد.  نحن الآن بحاجة إلى تغيير إجراء الإنشاء لملف ".vsdconfigxml".  للقيام بذلك ، يجب عليك تحرير ملف المشروع يدويًا (بجدية).  نقوم بإلغاء تحميل مشروع DebuggeePlugin ، وفتحه مع محرر الاستوديو.  نحتاج إلى العثور على علامة XLM التالية: <br><br><pre style=";text-align:right;direction:rtl"> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">None</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DkmEntryPointNotificationService.vsdconfigxml"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre><br>  ونقل هذه العلامة إلى ItemGroup الخاصة بك ، وتغيير الكتابة من بلا إلى VsdConfigXmlFiles: <br><pre style=";text-align:right;direction:rtl"> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">VsdConfigXmlFiles</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DkmEntryPointNotificationService.vsdconfigxml"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  يمكنك حفظ وإعادة تحميل المشروع. <br><br>  الآن ، انتقل إلى التكوينات.  أول شيء يجب فعله: إذا تمت إضافة ملف vsdconfig.xsd إلى مشروع DebuggeePlugin ، فينبغي حذفه.  سنستبدلها الآن ، لأنه من الأسهل التعامل مع النص الخام.  افتح DkmEntryPointNotificationService.vsdconfigxml واستبدل النص بما يلي: <br><br><pre style=";text-align:right;direction:rtl"> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Configuration</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/vstudio/vsdconfig/2008"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ManagedComponent</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ComponentId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"422413E1-450E-40A6-AE24-7E80A81CC668"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ComponentLevel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">^_^quot𘙮quot^_^</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">AssemblyName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DebuggeePlugin"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Class</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DebuggeePlugin.DkmEntryPointNotificationService"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Implements</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">InterfaceGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NoFilter</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Interface</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"IDkmEntryPointNotification"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">InterfaceGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Implements</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Class</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ManagedComponent</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Configuration</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  في أي ملف من هذا القبيل ، سنطلب منك الإشارة إلى الأشياء التالية: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ComponentId - يمكن إنشاء هذه القيمة باستخدام أداة إنشاء GUID (أدوات -&gt; CreateGUID) </li><li style=";text-align:right;direction:rtl">  ComponentLevel هو مستوى مكوننا في التسلسل الهرمي.  انظر الجدول أعلاه ومساعدة المعلومات على MSDN لتحديد نطاق القيم المطلوب. </li><li style=";text-align:right;direction:rtl">  Assemblyname هو اسم التجميع الخاص بنا (ليس حلاً!).  في هذه الحالة ، سيكون هناك DebuggeePlugin </li><li style=";text-align:right;direction:rtl">  اسم الفصل - يجب الإشارة إلى بما في ذلك مساحة الاسم التي يوجد بها الفصل.  في هذه الحالة ، DebuggeePlugin.DkmEntryPointNotificationService </li><li style=";text-align:right;direction:rtl">  صفيف InterfaceGroup - يشير كل إدخال فيه إلى واجهة يتم تنفيذها بواسطة هذا المكون.  داخل كل عقدة InterfaceGroup ، يجب أن يكون هناك عقدة فرعية تشير إلى الواجهات الشائعة للجميع ، في هذه المجموعة ، التصفية ، ولكن حول المرشحات لاحقًا.  الآن لدينا عقدة واجهة واحدة فقط ، وتحمل اسم واجهة IdkmEntryPointNotification.  إذا كان لدينا العديد من واجهات ، سيكون هناك العديد من العقد واجهة. </li></ol><br>  اسمحوا لي أن أذكرك أنه لكل فئة يجب أن تتلقى إعلامات من مصحح الأخطاء ، يجب أن يكون هناك مثل هذا الملف.  لكن المرح لا ينتهي هناك.  كل ملف من هذا القبيل ، بعد ذلك ، يتم جمعه في ملف .vsdconfig في دليل إخراج المشروع.  ويجب الرجوع إليها في بيان البرنامج المساعد.  ويتم ذلك على النحو التالي: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  بعد قيامنا بإنشاء ملف ".vsdconfigxml" ، يجب علينا ... جمع الحل مرة واحدة ، وإلا فلن يكون لدينا أي ملف .vsdconfig في دليل إخراج المشروع) </li><li style=";text-align:right;direction:rtl">  بعد ذلك ، افتح محرر النصوص لملف source.extension.vsixmanifest وأضف الكود التالي قبل علامة PackageManifest الختامية: </li></ol><br><pre style=";text-align:right;direction:rtl"> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Assets</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Asset</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DebuggerEngineExtension"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">d:Source</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"File"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DebuggeePlugin.vsdconfig"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Assets</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  إذا ظهر الملف "DebuggeePlugin.vsdconfig" في مشروع HelloVSIX ، بعد الإجراءات المكتملة ، فيجب إزالته <b>من المشروع</b> وينبغي جمع الحل مرة أخرى ، وإلا فلن يتم تحديثه. <br><br>  العمل التحضيري قد انتهى!  يمكنك البدء في تصحيح البرنامج المساعد لدينا.  يتم ذلك عن طريق بدء مثيل تجريبي لـ VisualStudio (لمشاريع VSIX ، يكون هذا هو الهدف الافتراضي لتصحيح الأخطاء ، لذلك لا توجد خطوات إضافية ضرورية).  في الواقع ، نقر فوق Debug-&gt; StartDebugging ونرى نسخة تجريبية من VisualStudio.  في ذلك ، بشكل افتراضي ، ينبغي بالفعل تثبيت البرنامج المساعد لدينا.  يمكنك التحقق من ذلك من خلال القائمة أدوات&gt; ملحقات والتحديثات. <br><br>  نظرًا لحقيقة أننا قمنا بتطبيق واجهة IDkmEntryPointNotification ، سيتعين علينا إنشاء مشروع اختبار في نسخة تجريبية من VisualStudio.  في الواقع ، نقوم بإنشاء مشروع جديد ، حدد <b>C ++ -&gt; تطبيق وحدة التحكم</b> (اختر C ++ ، لأن الأمثلة التالية سوف تحتوي على تفاصيل C ++) ، نسميها <b>VSIXTestApp</b> ، قم بتشغيل دون أي تغييرات ، وجمع ونرى أن المثال التجريبي لدينا توقف عن وضع استثناء داخل طريقة DebuggeePlugin. DkmEntryPointNotificationService.OnEntryPoint.  ! ممتاز  الآن تحتاج إلى إظهار MessageBox.  للقيام بذلك ، من الضروري إضافة المراجع التالية إلى مشروع DebuggeePlugin: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  Microsoft.VisualStudio.Shell.15.0 </li><li style=";text-align:right;direction:rtl">  Microsoft.VisualStudio.Shell.Interop </li><li style=";text-align:right;direction:rtl">  Microsoft.VisualStudio.Shell.Interop.8.0 </li><li style=";text-align:right;direction:rtl">  Microsoft.VisualStudio.OLE.Interop </li></ul><br>  أضف استخدامين في بداية ملف DkmEntryPointNotificationService.cs: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Shell; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Shell.Interop;</code> </pre><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">وقم</a> بإضافة مكالمة إلى طريقة <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">VsShellUtilities.ShowMessageBox</a> في طريقة DkmEntryPointNotificationService.OnEntryPoint: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Debugger; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Debugger.ComponentInterfaces; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Shell; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Shell.Interop; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Threading.Tasks; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">DebuggeePlugin</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">DkmEntryPointNotificationService</span></span> : <span class="hljs-title"><span class="hljs-title">IDkmEntryPointNotification</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnEntryPoint</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DkmProcess process, DkmThread thread, DkmEventDescriptor eventDescriptor</span></span></span><span class="hljs-function">)</span></span> { VsShellUtilities.ShowMessageBox(Microsoft.VisualStudio.Shell.ServiceProvider.GlobalProvider, <span class="hljs-string"><span class="hljs-string">"Hello VSIX"</span></span>, <span class="hljs-string"><span class="hljs-string">"Hello VSIX"</span></span>, OLEMSGICON.OLEMSGICON_INFO, OLEMSGBUTTON.OLEMSGBUTTON_OK, OLEMSGDEFBUTTON.OLEMSGDEFBUTTON_FIRST); } } }</code> </pre><br>  نقوم بإعادة البناء ، وإطلاق نسخة تجريبية من الاستوديو ، وإطلاق مشروع اختبار وفويلا! <br><br>  نرى أن مثيل اختبار الاستوديو خلق MessageBox! <br><br><img src="https://habrastorage.org/webt/2c/a7/fd/2ca7fdpdvkt3z_fscr76xskl7rk.png"><br><br>  وما الفائدة في الواقع؟ <br><br>  لقد تعلمنا هنا كيفية إعداد مشروع VSIX يحتوي على مكون إضافي لمصحح Visual Studio ، مع مراعاة معظم الفروق الدقيقة التي أعاقت النتيجة.  هذه هي نقطة الانطلاق لمزيد من العمل المفصل.  في المقالة التالية ، سأريك نقطة مهمة أخرى: كيفية إجراء الاتصال بين IDE ومكونات Debug المستهدفة. <br><br>  لمزيد من المساعدة في استخدام واجهة Concord API ، يمكنك الرجوع ليس فقط إلى MSDN ، ولكن أيضًا إلى مستودعات Microsoft التالية على github: <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">github.com/microsoft/PTVS</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">github.com/Microsoft/ConcordExtensibilitySamples</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar476298/">https://habr.com/ru/post/ar476298/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar476288/index.html">أفضل 5 أطر JS لتطوير الواجهة الأمامية في عام 2020. الجزء 2</a></li>
<li><a href="../ar476290/index.html">خطأ في التعامل مع اكسبرس</a></li>
<li><a href="../ar476292/index.html">SVG أو قماش؟</a></li>
<li><a href="../ar476294/index.html">شبكة الألعاب الموزعة كبديل عن GFN: كيف ولماذا يمكن أن تقلع ، حيث تعمل بالفعل في روسيا</a></li>
<li><a href="../ar476296/index.html">21 نوفمبر ، هندسة المنتج MeetUp: من هو مهندس المنتج؟</a></li>
<li><a href="../ar476300/index.html">مجلة الترام هي نجمة ساطعة ومبهرة تتلاشى بسرعة للطفل الروسي الرائد</a></li>
<li><a href="../ar476304/index.html">مصادقة جهاز دونجل لأجهزة Linux على أنظمة المستوى الأعلى</a></li>
<li><a href="../ar476306/index.html">تعليمات TelegramBot لإنشاء الوظائف الأساسية للروبوت. (الجزء الأول)</a></li>
<li><a href="../ar476308/index.html">أفضل 5 ممارسات لتطوير البرمجيات تتبع في عام 2020</a></li>
<li><a href="../ar476310/index.html">الوجه الإنساني CRM</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>