<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèΩ‚Äçüî¨ ü¶à üïë Introdu√ß√£o ao Bash Shell üë∞üèº üë∂ üõ†Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° pessoal. Esta √© uma tradu√ß√£o do RedHat RHCE Exam Preparation Book. Na minha opini√£o, √© muito acess√≠vel sobre o b√°sico do bash. 

 Os scripts de sh...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Introdu√ß√£o ao Bash Shell</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/471242/">  Ol√° pessoal.  Esta √© uma tradu√ß√£o do RedHat RHCE Exam Preparation Book.  Na minha opini√£o, √© muito acess√≠vel sobre o b√°sico do bash. <br><br>  Os scripts de shell s√£o uma ci√™ncia em si.  Sem entrar em detalhes de tudo o que acontece "oculto", voc√™ aprender√° como usar os elementos b√°sicos para escrever seus pr√≥prios scripts e analisar o que acontece nos scripts de shell de terceiros. <br><br><img src="https://habrastorage.org/webt/8w/vx/z3/8wvxz3nzeh5uaiubay0ezgvrbwm.jpeg"><br><a name="habracut"></a><br><h2>  Compreendendo os elementos b√°sicos dos scripts de shell </h2><br>  De fato, um shell script √© uma lista de comandos executados seq√ºencialmente, al√©m de alguma l√≥gica que permite que o c√≥digo seja executado apenas sob determinadas condi√ß√µes. <br><br>  Para entender scripts shell complexos, √© recomend√°vel que voc√™ comece com scripts b√°sicos. <br><br>  O seguinte √© um script muito simples: <br><br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash # # #This is a script that greets the world # Usage: ./hello clear echo hello world exit 0</span></span></code> </pre> <br>  Ele cont√©m v√°rios elementos que devem ser usados ‚Äã‚Äãem todos os scripts.  Para iniciantes, h√° shebang - esta √© a linha #! / Bin / bash.  Quando o script √© iniciado a partir do shell pai, ele abre um subshell no qual os comandos especificados no script s√£o executados. <br><br>  Esses comandos podem ser interpretados de v√°rias maneiras.  Para entender exatamente como eles devem ser interpretados, o shebang √© usado.  No exemplo acima, shebang deixa claro que o script deve ser executado pelo shell bash. <br><br>  Outras conchas tamb√©m podem ser indicadas.  Por exemplo, se seu script contiver c√≥digo Perl, shebang deve ser #! / Usr / bin / perl.  Iniciar um script com shebang √© uma boa pr√°tica;  se omitido, o c√≥digo do script ser√° executado pelo mesmo shell usado para executar o script. <br><br>  Imediatamente ap√≥s o shebang, h√° uma parte explicando sobre o que √© o script.  Algumas linhas de coment√°rio no in√≠cio de cada cen√°rio s√£o uma boa ideia.  Em um script curto, muitas vezes √© √≥bvio o que ele faz, mas, √† medida que o script fica mais longo e √† medida que mais pessoas se envolvem em escrev√™-lo e apoi√°-lo, fica menos claro o que os autores pretendem fazer. <br><br>  Para evitar essa situa√ß√£o, adicione linhas de coment√°rio come√ßando com cada caractere #.  Os coment√°rios podem estar n√£o apenas nas primeiras linhas, mas tamb√©m no in√≠cio de cada subse√ß√£o do script.  Isso certamente ajudar√° se voc√™ ler seu script em alguns meses! <br><br>  Voc√™ tamb√©m pode comentar n√£o apenas em subse√ß√µes, mas tamb√©m em linhas individuais. <br><br>  Independentemente da posi√ß√£o em que √© usado, tudo, desde o caractere # at√© o final da linha, √© um coment√°rio. <br><br>  Ap√≥s o bloco de coment√°rios, o corpo do script est√° localizado.  No exemplo acima, esses s√£o v√°rios comandos que s√£o executados seq√ºencialmente.  O corpo do script de shell pode aumentar √† medida que se desenvolve. <br><br>  No final do script, inclu√≠ a instru√ß√£o <b>exit 0</b> .  A instru√ß√£o exit informa ao shell pai se o script foi bem-sucedido.  O estado de sa√≠da do √∫ltimo comando no script √© o estado de sa√≠da do pr√≥prio script, a menos que a <b>sa√≠da 0</b> seja usada no final do script. <br><br>  √â √∫til saber que voc√™ pode trabalhar com <b>exit</b> para informar ao shell pai como foram as coisas. <br><blockquote>  Introduzido no shell pai, o echo $?  permite consultar o status de sa√≠da do √∫ltimo script em execu√ß√£o. <br></blockquote>  Ap√≥s criar o script, verifique se ele pode ser executado.  A maneira mais comum de fazer isso √© aplicar um pouco de execu√ß√£o a ele.  Portanto, se o nome do arquivo de script for hello, use o <b>comando chmod + x ./hello</b> para torn√°-lo execut√°vel. <br><br>  O script tamb√©m pode ser executado como um argumento para o comando bash.  Nesse caso, digite <b>bash ./hello</b> para executar o script hello.  Se o script for executado como um argumento para o comando bash, o arquivo de script n√£o precisar√° ser execut√°vel. <br><br>  De fato, voc√™ pode armazenar o script em qualquer lugar, mas se voc√™ quiser armazen√°-lo em um diret√≥rio que n√£o esteja inclu√≠do na vari√°vel $ PATH, ser√° necess√°rio execut√°-lo com ./ na frente do nome do script. <br><br>  Digite <b>./hello</b> para executar o script ou coloque-o no diret√≥rio padr√£o inclu√≠do na vari√°vel $ PATH, por exemplo, / usr / local / bin. <br><br>  Voc√™ tamb√©m pode colocar o script no diret√≥rio / bin, ap√≥s o qual basta digitar o nome do arquivo em qualquer lugar do sistema de arquivos e o script ser√° executado. <br><br>  <b>Exemplo</b> <br><br>  Usando <b>vi / bin / datetime,</b> crie um arquivo chamado datetime no diret√≥rio / bin.  Cole este conte√∫do no arquivo criado: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash #    .     ,      date who</span></span></code> </pre><br>  Depois de salvar o arquivo, digite <b>chmod + x / bin / datetime</b> para dar permiss√£o ao arquivo para executar.  Por exemplo, mude para o diret√≥rio inicial usando o <b>comando cd ~</b> e digite simplesmente <b>datetime</b> . <br><br>  V√°, por exemplo, para o diret√≥rio inicial do cd ~ e insira datetime. <br><br><pre> <code class="bash hljs">[root@localhost ~]<span class="hljs-comment"><span class="hljs-comment"># datetime Sat Sep 28 00:33:41 EDT 2019 root tty1 2019-09-25 20:28 root pts/0 2019-09-27 20:07 (comp.corp.domain.ru)</span></span></code> </pre><br><h2>  Usando vari√°veis ‚Äã‚Äãe entradas </h2><br>  Os scripts bash s√£o muito mais do que apenas uma lista de comandos executados sequencialmente.  Uma das coisas boas sobre scripts √© que eles podem trabalhar com vari√°veis ‚Äã‚Äãe entradas para tornar o script flex√≠vel.  Nesta se√ß√£o, voc√™ aprender√° como trabalhar com eles. <br><br><h3>  Usando par√¢metros posicionais </h3><br>  Ao executar o script, voc√™ pode usar os argumentos.  Um argumento √© tudo o que voc√™ coloca atr√°s de um comando de script.  Argumentos podem ser usados ‚Äã‚Äãpara tornar o script mais flex√≠vel.  Pegue o comando <b>useradd lisa</b> .  Neste exemplo, o comando √© <b>useradd</b> e seu argumento, <b>lisa</b> , indica o que precisa ser feito. <br><br>  Como resultado desse comando, um usu√°rio chamado lisa deve ser criado. <br><br>  No script, o primeiro argumento √© <b>$ 1</b> , o segundo √© <b>$ 2. A</b> Listagem 1 mostra como os argumentos podem ser usados.  Tente executar esse c√≥digo especificando nomes de usu√°rios como par√¢metros. <br><br>  <b>Listagem 1</b> <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash # run this script with a few arguments echo The first argument is $1 echo The second argument is $2 echo The third argument is $3</span></span></code> </pre><br>  Par√¢metros significam entrada de dados antes de executar o script.  Nesse caso, especifiquei <b>lisa</b> , <b>lori</b> e <b>bob</b> como par√¢metros ap√≥s o argumento script name: <br><br><pre> <code class="bash hljs">[root@server1 ~]<span class="hljs-comment"><span class="hljs-comment"># ./argument lisa lori bob The first argument is lisa The second argument is lori The third argument is bob [root@server1 ~]#</span></span></code> </pre><br>  Se voc√™ tentou executar o c√≥digo de amostra, poder√° notar que seu conte√∫do n√£o √© perfeito.  Se voc√™ usar tr√™s argumentos ao executar o script da Lista 1, ele funcionar√° perfeitamente.  Se voc√™ usar apenas dois argumentos, o terceiro ser√° gerado sem o valor $ 3. <br><br>  Se voc√™ usar quatro argumentos, o quarto valor (que ser√° armazenado em US $ 4) nunca ser√° exibido.  Portanto, se voc√™ quiser usar argumentos, √© melhor usar uma abordagem mais flex√≠vel. <br><br>  <b>Listagem 2</b> <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash # run this script with a few arguments echo you have entered $# arguments for i in $@ do echo $i done exit 0</span></span></code> </pre><br>  <b>A Listagem 2 mostra dois novos elementos relacionados aos argumentos:</b> <br><br><ul><li>  $ # √â um contador que mostra quantos argumentos foram usados ‚Äã‚Äãao executar o script. </li><li>  $ @ √â uma lista de todos os argumentos que foram usados ‚Äã‚Äãao executar o script. </li></ul><br>  Para listar os argumentos que foram usados ‚Äã‚Äãao executar esse script, o loop for √© usado.  Nos loops <b>for</b> , as instru√ß√µes s√£o executadas desde que a condi√ß√£o seja verdadeira.  Nesse cen√°rio, a condi√ß√£o <b>para i em $ @</b> significa "para cada argumento".  Cada vez que o script passa pelo loop, o valor da vari√°vel <b>$ @ √©</b> atribu√≠do √† vari√°vel <b>$ i</b> . <br><br>  Portanto, desde que haja argumentos, o corpo do script √© executado. <br><br>  O corpo do loop for sempre come√ßa com <b>do</b> e fecha <b>done</b> , e os comandos a serem executados s√£o listados entre essas duas palavras-chave.  Portanto, o script de exemplo usar√° <b>eco</b> para exibir o valor de cada argumento e parar quando n√£o houver mais argumentos dispon√≠veis. <br><br>  <b>Vamos tentar o script na Listagem 2 neste exemplo:</b> <br><br><ol><li>  Digite <b>vi argumento</b> para criar o arquivo de argumento e copie o conte√∫do do script na Listagem 2 para este arquivo. </li><li>  Salve o arquivo e torne-o execut√°vel. </li><li>  Execute o comando <b>./argument abc</b> .  Voc√™ ver√° que tr√™s linhas s√£o exibidas. </li><li>  Execute o comando <b>./argument abcdef</b> .  Voc√™ ver√° que, al√©m de abc, de f tamb√©m ser√° exibido. </li></ol><br><h2>  Vari√°veis </h2><br>  Uma vari√°vel √© um r√≥tulo usado para indicar um local espec√≠fico na mem√≥ria que cont√©m um valor espec√≠fico.  As vari√°veis ‚Äã‚Äãpodem ser definidas estaticamente usando NAME = value ou dinamicamente.  Existem duas solu√ß√µes para definir dinamicamente uma vari√°vel: <br><br><ul><li>  Use a palavra-chave <b>read</b> em um script para solicitar dados do usu√°rio que est√° executando o script. </li><li>  Use substitui√ß√£o de comando para usar o resultado do comando e atribu√≠-lo a uma vari√°vel.  Por exemplo, a <b>data</b> do comando <b>+% d-% m-% y</b> mostra a data atual no formato dia-m√™s-ano.  Para fazer isso em um script, voc√™ pode usar <b>HOJE = $ (data +% d-% m-% y)</b> .  Para substituir comandos, basta colocar o comando cujo resultado voc√™ deseja usar entre os colchetes. </li></ul><br>  Na se√ß√£o anterior sobre par√¢metros posicionais, voc√™ aprendeu como atribuir argumentos a vari√°veis ‚Äã‚Äãao executar um script.  Em alguns casos, pode ser mais eficiente solicitar informa√ß√µes quando voc√™ achar que algo substancial est√° faltando.  O script abaixo mostra como fazer isso. <br><br>  <b>Listagem 3.</b> Script de amostra usando o comando <b>read</b> <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash if [ -z $1 ]; then echo enter a text read TEXT else TEXT=$1 fi echo you have entered the text $TEXT exit 0</span></span></code> </pre><br>  No script da Listagem 3, o operador <b>if ... then ... else ... fi</b> √© usado para testar a exist√™ncia do argumento <b>$ 1</b> .  Isso √© feito usando <b>test</b> (test √© um comando separado).  O comando test pode ser escrito de duas maneiras *: <b>test</b> ou <b>[...]</b> .  No exemplo, a linha <b>se [-z $ 1] ...</b> √© executada para ver o teste (marque) <b>-z $ 1</b> . <br><br>  * <i>- na verdade, tr√™s <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fontes</a> (aprox. Tradutor)</i> <br><br>  <b>O teste -z</b> verifica se <b>$ 1</b> existe ou n√£o.  Em outras palavras, a linha <b>se [-z $ 1]</b> verifica se <b>$ 1 est√°</b> vazio, o que significa que nenhum argumento foi fornecido quando esse script foi executado.  Nesse caso, os comandos ap√≥s a instru√ß√£o <b>then</b> s√£o executados. <br><br>  Observe que, ao escrever o comando de <b>teste</b> com colchetes, √© importante usar espa√ßos ap√≥s o colchete de abertura e antes do colchete de fechamento, sem espa√ßos, o comando n√£o funcionar√°. <br><br>  Observe que a instru√ß√£o <b>then</b> segue imediatamente o <b>teste</b> .  Isso √© poss√≠vel porque um ponto-e-v√≠rgula (;) √© usado.  O ponto e v√≠rgula √© um separador de comandos e pode substituir uma nova linha em um script. <br><br>  A instru√ß√£o <b>then</b> executa dois comandos: o comando <b>echo</b> , que exibe a mensagem na tela, e o comando <b>read</b> . <br><br>  O comando <b>read</b> para o script para que a entrada do usu√°rio possa ser processada e armazenada na vari√°vel TEXT.  Portanto, <b>ler TEXT</b> coloca toda a entrada do usu√°rio na vari√°vel TEXT, que ser√° usada posteriormente no script. <br><br>  A pr√≥xima parte √© representada pela <b>instru√ß√£o else</b> .  Os comandos ap√≥s a <b>instru√ß√£o else</b> s√£o executados em todos os outros casos, o que nesse caso significa "caso contr√°rio, se o argumento foi fornecido".  Nesse caso, a vari√°vel TEXT √© determinada e o valor atual de <b>$ 1 √©</b> atribu√≠do a ela. <br><br>  Observe como a vari√°vel √© definida: imediatamente ap√≥s o nome da vari√°vel, existe um sinal = seguido de $ 1.  Observe que voc√™ nunca deve usar espa√ßos ao definir vari√°veis. <br><br>  Ent√£o, as condi√ß√µes if s√£o fechadas usando o operador <b>fi</b> .  Ap√≥s a conclus√£o da condi√ß√£o if, voc√™ tem certeza de que a vari√°vel TEXT est√° definida e possui um valor.  A pen√∫ltima linha do script l√™ o valor da vari√°vel TEXT e mapeia esse valor para STDOUT usando o comando <b>echo</b> .  Observe que, para solicitar o valor atual de uma vari√°vel, ele se refere ao nome da vari√°vel, come√ßando com o sinal $ √† frente. <br><br>  <b>Voc√™ pode praticar usando este exemplo ao trabalhar com entrada.</b> <br><br><ol><li>  Abra o editor e crie um arquivo chamado texto.  Digite o conte√∫do do c√≥digo na Listagem 3 neste arquivo. </li><li>  Escreva o arquivo no disco e execute <b>chmod + x text</b> para torn√°-lo execut√°vel. </li><li>  Execute o script executando <b>./text</b> e sem argumentos adicionais.  Voc√™ ver√° que ele pede entrada. </li><li>  Execute o script usando " <b>hello</b> " como argumento (./text hello).  O resultado exibir√° "voc√™ inseriu o texto hello" em STDOUT. </li></ol><br><h2>  Usando condi√ß√µes e loops </h2><br>  Como voc√™ j√° viu, instru√ß√µes condicionais podem ser usadas em um script.  Essas instru√ß√µes condicionais s√£o executadas apenas se uma determinada condi√ß√£o for atendida. <br><br>  Existem v√°rias instru√ß√µes e loops condicionais no bash que s√£o frequentemente usados. <br><br><ul><li>  <b>if ... then ... else</b> - usado para executar c√≥digo se uma determinada condi√ß√£o for atendida </li><li>  <b>for</b> - usado para executar comandos para um intervalo de valores </li><li>  <b>while</b> - usado para executar c√≥digo se uma determinada condi√ß√£o for atendida </li><li>  <b>before</b> - usado para executar o c√≥digo at√© que uma determinada condi√ß√£o seja atendida </li><li>  <b>case</b> - usado para avaliar um n√∫mero limitado de valores espec√≠ficos </li></ul><br><h3>  se ent√£o mais </h3><br>  A <b>constru√ß√£o if then else</b> √© comum para avaliar condi√ß√µes espec√≠ficas.  Voc√™ j√° viu um exemplo com ele.  Essa declara√ß√£o condicional √© frequentemente usada com o comando <b>test</b> .  Este comando permite verificar muitas coisas: por exemplo, n√£o apenas se um arquivo existe, mas tamb√©m comparar arquivos, comparar n√∫meros inteiros e muito mais. <br><blockquote>  Voc√™ pode aprender mais sobre teste na refer√™ncia com o comando man test. </blockquote><br>  O b√°sico <b>se</b> construir √© <b>se ... ent√£o ... fi</b> . <br><br>  Ele compara uma condi√ß√£o, conforme mostrado no exemplo a seguir: <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ -z <span class="hljs-variable"><span class="hljs-variable">$1</span></span> ] <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> no value provided <span class="hljs-keyword"><span class="hljs-keyword">fi</span></span></code> </pre><br>  Na Listagem 3, voc√™ viu como pode avaliar duas condi√ß√µes, incluindo <b>outras</b> em uma express√£o.  A Listagem 4 mostra como avaliar v√°rias condi√ß√µes de <b>se</b> para <b>outro</b> .  Isso √© √∫til se voc√™ precisar verificar muitos valores diferentes. <br><br>  Observe que este exemplo tamb√©m usa v√°rios comandos de <b>teste</b> . <br><br>  <b>Listagem 4</b> .  Exemplo com <b>if then else</b> <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash # run this script with one argument # the goal is to find out if the argument is a file or a directory if [ -f $1 ] then echo "$1 is a file" elif [ -d $1 ] then echo "$1 is a directory" else echo "I do not know what \$1 is" fi exit 0</span></span></code> </pre> <br><h3>  ||  e &amp;&amp; </h3><br>  Em vez de escrever <b>instru√ß√µes</b> completas <b>if ...,</b> voc√™ pode usar os operadores l√≥gicos <b>||</b>  bem como <b>&amp;&amp;</b> .  <b>||</b>  √© um "OR" l√≥gico e executar√° a segunda parte da instru√ß√£o somente se a primeira parte n√£o for verdadeira;  <b>&amp;&amp;</b> √© um "AND" l√≥gico e executar√° a segunda parte da declara√ß√£o somente se a primeira parte for verdadeira. <br><br>  <b>Considere estas duas linhas:</b> <br><br><pre> <code class="bash hljs">[ -z <span class="hljs-variable"><span class="hljs-variable">$1</span></span> ] &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> no argument provided</code> </pre> <br><pre> <code class="bash hljs">ping -c 1 8.8.8.8 2&gt;/dev/null || <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> node is not available</code> </pre><br>  O primeiro exemplo verifica se <b>$ 1 est√°</b> vazio.  Se esta verifica√ß√£o estiver correta (o que basicamente significa que o comando termina com o c√≥digo de sa√≠da 0), o segundo comando √© executado. <br><br>  No segundo exemplo, o comando <b>ping √©</b> usado para verificar a disponibilidade do host. <br>  Este exemplo usa um "OR" l√≥gico para exibir o texto "o n√≥ n√£o est√° dispon√≠vel" no caso de uma falha no comando <b>ping</b> . <br><br>  Voc√™ encontrar√° isso frequentemente, em vez da <b>instru√ß√£o if</b> condicional, <b>&amp;&amp;</b> e <b>||</b>  .  No exerc√≠cio abaixo, voc√™ pode praticar o uso de instru√ß√µes condicionais usando <b>if ... then ... else</b> , ou <b>&amp;&amp;</b> e <b>||</b>  . <br><br>  <b>Exerc√≠cio</b> .  Usando <b>if ... then ... else</b> <br><br>  Neste exerc√≠cio, voc√™ trabalhar√° em um script que verifica o que √© um arquivo e o que √© um diret√≥rio. <br><br><ol><li>  Inicie o editor e crie um script chamado filechk. </li><li>  Copie o conte√∫do da Listagem 4 neste script. </li><li>  Execute alguns testes com ele, como <b>./filechk / etc / hosts</b> , <b>./filechck / usr</b> , <b>./filechk arquivo n√£o existente</b> . </li></ol><br><h2>  For loop </h2><br>  O loop for √© uma √≥tima solu√ß√£o para o processamento de intervalos de dados.  Na Listagem 5, voc√™ pode ver o primeiro exemplo com <b>for</b> , onde o intervalo √© determinado e processado enquanto houver valores brutos nesse intervalo. <br><br>  <b>Listagem 5</b> <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash # for (( COUNTER=100; COUNTER&gt;1; COUNTER-- )); do echo $COUNTER done exit 0</span></span></code> </pre> <br>  Um loop <b>for</b> sempre come√ßa com a palavra-chave for, seguida por uma condi√ß√£o que precisa ser verificada.  Isso √© seguido pela palavra-chave do, seguida pelos comandos que devem ser executados; se a condi√ß√£o for verdadeira, o loop ser√° finalizado usando a palavra <b>-</b> chave <b>done</b> . <br><br>  No exemplo da Listagem 5, √© poss√≠vel ver que a condi√ß√£o √© um intervalo de n√∫meros entre par√™nteses designados √† vari√°vel COUNTER. <br><br>  <b>Uma pequena explica√ß√£o</b> <br><br>  As express√µes aritm√©ticas internas <b>((...))</b> s√£o calculadas e seu resultado √© retornado.  Por exemplo, no caso mais simples, a constru√ß√£o a = $ ((5 + 3)) atribuir√° √† vari√°vel "a" o valor da express√£o "5 + 3" ou 8. Al√©m disso, par√™nteses duplos permitem trabalhar com vari√°veis ‚Äã‚Äãno estilo da linguagem C. <br><br>  Primeiro, a vari√°vel √© inicializada para 100 e, desde que o valor seja maior que 1, √© subtra√≠do 1. A cada itera√ß√£o, desde que a condi√ß√£o seja verdadeira, o valor da vari√°vel $ COUNTER √© exibido usando o comando <b>echo</b> . <br><br>  Na Listagem 6, voc√™ pode ver uma das minhas frases favoritas com <b>for</b> .  O intervalo √© definido desta vez como uma sequ√™ncia de n√∫meros, come√ßando de 100 e chegando a 104. <br><br>  <b>Listagem 6</b> <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> {100..104}; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> ping ‚Äìc 1 192.168.4.<span class="hljs-variable"><span class="hljs-variable">$i</span></span> &gt;/dev/null &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> 192.168.4.<span class="hljs-variable"><span class="hljs-variable">$i</span></span> is up; <span class="hljs-keyword"><span class="hljs-keyword">done</span></span></code> </pre><br>  Observe como o intervalo √© determinado: primeiro voc√™ especifica o primeiro n√∫mero, depois dois pontos e indica o √∫ltimo n√∫mero no intervalo.  Al√©m disso, com <b>for i in,</b> para cada um desses n√∫meros, a vari√°vel <b>i √©</b> atribu√≠da.  Cada um desses n√∫meros √© atribu√≠do √† vari√°vel <b>ie</b> o comando <b>ping</b> √© executado, em que a op√ß√£o <b>-c 1</b> garante que apenas uma solicita√ß√£o seja enviada. <br><br>  O resultado do comando <b>ping</b> n√£o <b>√©</b> levado em considera√ß√£o, portanto sua sa√≠da √© redirecionada para / dev / null.  Com base no status de sa√≠da do comando <b>ping</b> , uma parte da express√£o <b>&amp;&amp;</b> √© executada.  Portanto, se o host estiver dispon√≠vel, uma linha ser√° exibida indicando que est√° em execu√ß√£o. <br><br><h2>  Entendendo enquanto e at√© </h2><br>  Se a instru√ß√£o for que voc√™ acabou de ler for √∫til para trabalhar com intervalos de elementos, a instru√ß√£o while ser√° √∫til quando voc√™ desejar rastrear algo como acessibilidade do processo.  H√° tamb√©m uma instru√ß√£o <b>at√©</b> , que √© executada desde que a condi√ß√£o sendo verificada seja falsa.  Na Listagem 7, voc√™ pode ler como <b>while √©</b> usado para monitorar a atividade do processo. <br><blockquote>  Nota  Eu n√£o entendi o que esse script faz.  No meu caso, o CentOS 7 √© usado e, por padr√£o, n√£o h√° monitor, embora o script diga explicitamente: <pre>  uso: monitor &lt;nome do processo&gt; </pre>  Em algum lugar por meia hora, pesquisei no Google o programa de monitoramento do CetOS, mas n√£o o encontrei.  E geralmente n√£o est√° claro qual monitor lateral est√° aqui se o ps aux for usado.  De qualquer forma, n√£o entendi o que esse script faz.  Uma grande solicita√ß√£o para ajudar a resolver esse problema √© ajustar o texto e / ou script. </blockquote>  <b>Listagem 7</b> <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash # # usage: monitor &lt;processname&gt; while ps aux | grep $1 | grep -v grep &gt; /dev/tty11 do sleep 5 done clear echo your process has stopped logger $1 is no longer present mail -s "process $1 has stopped" root &lt; .</span></span></code> </pre> <br>  O script na Listagem 7 consiste em duas partes.  Primeiro, h√° um <b>loop while</b> .  Em segundo lugar, h√° tudo o que precisa ser feito quando o <b>loop while</b> n√£o <b>√©</b> mais avaliado como verdadeiro. <br><br>  O n√∫cleo do <b>loop while</b> √© o comando <b>ps</b> , que tem um valor de <b>$ 1</b> . <br><br>  Observe o uso de <b>grep -v grep</b> , que exclui as linhas que cont√™m o <b>comando grep</b> do resultado.  Lembre-se de que o comando <b>ps</b> incluir√° todos os processos em execu√ß√£o, incluindo o <b>comando grep</b> , para os quais a sa√≠da do <b>comando</b> <b>ps</b> √© passada.  Isso pode levar a uma correspond√™ncia positiva falsa. <br><br>  A sa√≠da do comando <b>ps aux</b> √© redirecionada para / dev / tty11.  Isso permite que voc√™ leia os resultados de tty11 posteriormente, se necess√°rio, mas eles n√£o s√£o exibidos por padr√£o. <br><br>   <b>while</b>  ,   ,    .      <b>sleep 5</b> ,      5 . <br><br>    <b>while</b> ,   .     (    ,     ),       ,   . <br><br>       ,  .   <b>mail -s ‚Äúprocess $1 has stopped‚Äù root &lt; .</b>    root     ,      Linux*.  <b>mail</b>       ,     <b>-s</b> . <br><br> <i>* ‚Äî     CentOS   . (. )</i> <br><br>    <b>&lt; .</b>   . <br><br>     <b>mail</b>     ,      .   ,  ,    .        STDIN.      -     . <br><br>  <b>while</b> ‚Äî    <b>until</b> ,      8. <b>until</b>  ,     ,     . <br><br>   8        <b>users</b>   <b>$1</b> ,    .     ,  .       ,  ,    <b>until</b>   . <br><br> <b> 8</b> <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash # until users | grep $1 &gt; /dev/null do echo $1 is not logged in yet sleep 5 done echo $1 has just logged in mail -s "$1 has just logged in" root &lt; .</span></span></code> </pre> <br><h2>  case </h2><br>      ‚Äî  <b>case</b> *.  <b>case</b>      .  ,  <b>case</b>     Linux,        . <br><br> <i>* ‚Äî  ?</i> <br><br>   <b>case</b>       ,    ,   ,    . <br><br>   9      <b>case</b> ,          . <br><br> <b> 9</b> <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$1</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> start) start;; stop) rm -f <span class="hljs-variable"><span class="hljs-variable">$lockfile</span></span> stop;; restart) restart;; reload) reload;; status) status ;; *) <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Usage: </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$0</span></span></span><span class="hljs-string"> (start|stop|restart|reload|status)"</span></span> ;; <span class="hljs-keyword"><span class="hljs-keyword">esac</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O gabinete</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> possui v√°rios recursos. Primeiro vem a linha - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">caso em sequ√™ncia</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Isto √© seguido por uma lista de todos os valores poss√≠veis que precisam ser avaliados. Cada elemento √© fechado com um colchete </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Isto √© seguido por uma lista de comandos a serem executados se um argumento espec√≠fico foi usado. A lista de comandos √© fechada com ponto e v√≠rgula duplo ;; pode ser usado imediatamente ap√≥s o √∫ltimo comando e pode ser usado em uma linha separada. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Observe tamb√©m que </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se aplica a todos os outros par√¢metros n√£o especificados anteriormente. Este √© um operador abrangente. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O loop de itera√ß√£o do </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">caso</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> termina com a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">instru√ß√£o esac</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Observe que as seq√º√™ncias no </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">caso</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> s√£o executadas em ordem. </font><font style="vertical-align: inherit;">Quando a primeira correspond√™ncia √© feita, a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">declara√ß√£o</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do </font><b><font style="vertical-align: inherit;">caso</font></b><font style="vertical-align: inherit;"> n√£o avalia nada. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como parte da avalia√ß√£o, modelos semelhantes ao modelo podem ser usados. </font><font style="vertical-align: inherit;">Isso √© mostrado em </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*) uma</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sequ√™ncia que corresponde a tudo. </font><font style="vertical-align: inherit;">Mas voc√™ tamb√©m pode usar sequ√™ncias como start | Start | START) para combinar com outro </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">caso</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Depurando scripts no Bash </font></font></h2><br>     ,   ,    .  ,       <b>bash -x</b> .    ,    ,    ,      . <br><br>   10    <b>bash -x</b> ,    ,   <b>grep</b>  ,    ,       . <br><br><pre> <code class="bash hljs">[root@server1 ~]<span class="hljs-comment"><span class="hljs-comment"># bash -x 319.sh + grep Usage: grep [OPTION]... PATTERN [FILE]... Try 'grep --help' for more information. + users + echo is not logged in yet is not logged in yet + sleep 5</span></span></code> </pre> <br><h2>   </h2><br>     ,    .           ,     . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt471242/">https://habr.com/ru/post/pt471242/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt471226/index.html">O Linux tem muitas faces: como trabalhar em qualquer distribui√ß√£o</a></li>
<li><a href="../pt471228/index.html">Grokay PyTorch</a></li>
<li><a href="../pt471232/index.html">Minha experi√™ncia conectando o LPS331AP ao Omega Onion2</a></li>
<li><a href="../pt471236/index.html">Dos√≠metro para Seryozha. Parte III Radi√≥metro nacional</a></li>
<li><a href="../pt471240/index.html">‚ÄúBitchy Betty‚Äù e interfaces de √°udio modernas: por que eles falam com uma voz feminina?</a></li>
<li><a href="../pt471244/index.html">C√≥digo Rosetta: mede o comprimento do c√≥digo em um grande n√∫mero de linguagens de programa√ß√£o, estuda a proximidade das linguagens entre si</a></li>
<li><a href="../pt471248/index.html">Reguladores dos EUA pro√≠bem a distribui√ß√£o do token Telegram Open Network</a></li>
<li><a href="../pt471254/index.html">Startups do ITMO University Accelerator - Iniciando projetos de vis√£o de m√°quina</a></li>
<li><a href="../pt471256/index.html">Vue.js √© bom, mas √© melhor que angular ou reagir?</a></li>
<li><a href="../pt471258/index.html">Sistema de armazenamento / carregamento de dados</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>