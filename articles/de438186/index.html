<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õÖÔ∏è üë®üèª‚Äçüöí üèÑ Checkliste: Was musste getan werden, bevor Microservices f√ºr die Produktion bereitgestellt wurden? ü¶Ñ ‚úä üïö</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dieser Artikel enth√§lt einen kurzen √úberblick √ºber meine eigenen Erfahrungen und die meiner Kollegen, mit denen ich Tag und Nacht gegen Zwischenf√§lle ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Checkliste: Was musste getan werden, bevor Microservices f√ºr die Produktion bereitgestellt wurden?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/438186/"><p><img src="https://habrastorage.org/webt/y7/-a/th/y7-ath7wga1jfx9issm1rhog2lg.jpeg" width="45%" align="right">  Dieser Artikel enth√§lt einen kurzen √úberblick √ºber meine eigenen Erfahrungen und die meiner Kollegen, mit denen ich Tag und Nacht gegen Zwischenf√§lle gek√§mpft hatte.  Und viele Vorf√§lle w√§ren niemals aufgetreten, wenn all diese Mikrodienste, die wir so sehr lieben, zumindest etwas sorgf√§ltiger geschrieben worden w√§ren. </p><br><p>  Leider glauben einige Programmierer ernsthaft, dass eine Docker-Datei mit jedem Team ein Mikrodienst f√ºr sich ist und bereits jetzt bereitgestellt werden kann.  Hafenarbeiter laufen - Geld geht ein.  Dieser Ansatz f√ºhrt zu Problemen, die von Leistungseinbu√üen, Debug-Unf√§higkeit, Servicefehlern bis hin zu einem Albtraum namens Dateninkonsistenz reichen. </p><br><p>  Wenn Sie der Meinung sind, dass es an der Zeit ist, eine weitere App in Kubernetes / ECS / was auch immer zu starten, habe ich etwas zu beanstanden. </p><a name="habracut"></a><br><blockquote>  Haftungsausschluss: Dies ist eine √úbersetzung meines <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">urspr√ºnglichen Beitrags</a> .  Englisch ist nicht meine gemeinsame Sprache.  Bitte helfen Sie mir, mich zu verbessern.  Wenn Sie einen Fehler sehen, k√∂nnen Sie ihn mir gerne zeigen. Ich bin Ihnen dankbar. </blockquote><p>  Ich habe mir eine Reihe von Kriterien f√ºr die Beurteilung der Bereitschaft von Antr√§gen f√ºr den Start in der Produktion gebildet.  Einige Elemente in dieser Checkliste k√∂nnen nicht auf alle Anwendungen angewendet werden, sondern nur auf spezielle.  Andere gelten allgemein f√ºr alles.  Ich bin sicher, Sie k√∂nnen Ihre Optionen in die Kommentare aufnehmen oder einen meiner Artikel bestreiten. </p><br><p> Wenn Ihr Microservice nicht mindestens eines der Kriterien erf√ºllt, k√∂nnen Sie ihn nicht in meinen idealen Cluster einbauen, der in einem 2000 Meter unter der Erde gelegenen Bunker mit Fu√übodenheizung (ja, es wird hei√ü sein) und einem geschlossenen Selbst errichtet wurde -ausreichendes Internet-System. </p><br><p>  Hier geht's! .. </p><br><p>  <i>Hinweis: Die Reihenfolge der Artikel spielt keine Rolle.</i>  <i>Zumindest f√ºr mich.</i> </p><br><h2 id="a-short-description-in-the-readme">  Eine kurze Beschreibung in der Readme </h2><br><blockquote>  Es enth√§lt eine kurze Beschreibung seiner selbst ganz am Anfang von Readme.md in seinem Git-Repository. </blockquote><p>  Gott, es scheint so einfach.  Aber wie oft bin ich darauf gesto√üen, dass das Repository keine kurze Erkl√§rung enth√§lt, warum es ben√∂tigt wird, welche Aufgaben es l√∂st und so weiter.  Und ich spreche nicht einmal √ºber etwas Komplizierteres wie Konfigurationsoptionen. </p><br><h2 id="integration-with-a-monitoring-system">  Integration in ein √úberwachungssystem </h2><br><blockquote>  Senden Sie Metriken an DataDog, NewRelic, Prometheus usw. </blockquote><p>  Analyse des Ressourcenverbrauchs, von Speicherlecks, Stacktraces, Service-Interdependenzen, Fehlerraten usw. Es ist √§u√üerst schwierig zu steuern, was in einer gro√üen verteilten Anwendung geschieht, ohne all dies zu verstehen. </p><br><h2 id="alerts-are-configured">  Alertler sind konfiguriert </h2><br><blockquote>  Hat Warnungen konfiguriert, die alle Standardsituationen sowie bekannte eindeutige Situationen abdecken. </blockquote><p>  Metriken sind gut, aber niemand wird ihnen manuell folgen.  Daher erhalten wir automatisch Anrufe / Pushs / ‚Äã‚ÄãTexte, wenn: </p><br><ul><li>  Der CPU- / Speicherverbrauch hat dramatisch zugenommen. </li><li>  Der Verkehr hat dramatisch zugenommen / abgenommen. </li><li>  Die Anzahl der pro Sekunde verarbeiteten Transaktionen hat sich in jede Richtung stark ge√§ndert. </li><li>  Die Gr√∂√üe eines Bereitstellungsartefakts hat sich merklich ge√§ndert (exe, app, jar, ...). </li><li>  Der Prozentsatz der Fehler oder deren H√§ufigkeit hat den zul√§ssigen Schwellenwert √ºberschritten. </li><li>  Der Dienst hat das Senden von Metriken eingestellt (eine Situation, die h√§ufig √ºbersehen wird). </li><li>  Die Regelm√§√üigkeit bestimmter erwarteter Ereignisse ist fehlerhaft (Cron-Job funktioniert nicht, nicht alle Ereignisse werden verarbeitet usw.) </li><li>  ... </li></ul><br><h2 id="runbooks-created">  Runbooks erstellt </h2><br><blockquote>  F√ºr den Dienst wurde ein Dokument erstellt, das bekannte oder erwartete abnormale Situationen beschreibt. </blockquote><br><ul><li>  Wie kann sichergestellt werden, dass der Fehler intern ist und nicht von Dritten abh√§ngt? </li><li>  ob es darauf ankommt: wo, an wen und was zu schreiben ist; </li><li>  wie man es sicher neu startet; </li><li>  wie man aus einem Backup wiederherstellt und wo sind sie, die Backups; </li><li>  Welche speziellen Dashboards / Suchanfragen wurden erstellt, um diesen Dienst zu √ºberwachen? </li><li>  Hat der Dienst ein eigenes Admin-Panel und wie kommt man dorthin? </li><li>  Gibt es eine API / CLI und wie kann man damit bekannte Probleme beheben? </li><li>  und so weiter. </li></ul><br><p>  Die Liste kann in verschiedenen Organisationen sehr unterschiedlich sein, aber zumindest die grundlegenden Dinge m√ºssen vorhanden sein. </p><br><h2 id="all-logs-are-written-to-stdout--stderr">  Alle Protokolle werden in STDOUT / STDERR geschrieben </h2><br><blockquote>  Der Dienst erstellt im Produktionsmodus keine Protokolldateien, sendet sie nicht an externe Dienste, enth√§lt keine redundanten Abstraktionen wie Protokollrotation usw. </blockquote><p>  Wenn eine Anwendung Dateien mit Protokollen erstellt, sind diese Protokolle unbrauchbar.  Sie werden nicht in 5 parallel laufende Container springen, in der Hoffnung, den notwendigen Fehler von "tail -f" abzufangen (ja, Sie werden <em>weinen und weglaufen</em> ...).  Ein Neustart eines Containers f√ºhrt zum vollst√§ndigen Verlust seiner Protokolle. </p><br><p>  Wenn eine Anwendung Protokolle in ein System eines Drittanbieters schreibt, z. B. in Logstash, f√ºhrt dies zu nutzloser Redundanz.  Der benachbarte Dienst kann dies nicht, weil er auf einem anderen Framework basiert?  Du wirst einen Zoo bekommen. </p><br><p>  Die Anwendung schreibt einen Teil ihrer Protokolle in die Dateien und einen anderen Teil in das STDOUT, weil der Entwickler die INFO in der Konsole sehen m√∂chte, aber DEBUG in den Dateien?  Dies ist im Allgemeinen die schlechteste Option.  Niemand braucht diese Komplexit√§t und beh√§lt den zus√§tzlichen Code und die Konfigurationen bei, die man zuerst lernen muss. </p><br><h2 id="logs-mean-json">  Protokolle bedeuten json </h2><br><blockquote>  Jede Zeile des Protokolls ist im Json-Format geschrieben und enth√§lt einen vereinbarten Satz von Feldern. </blockquote><p>  Jeder schreibt immer noch Protokolle im Klartext.  Dies ist eine echte Katastrophe.  Ich w√ºrde mich freuen, nie etwas √ºber <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Grok Patterns</a> zu erfahren.  Manchmal tr√§ume ich von ihnen und friere, versuche mich nicht zu bewegen, um ihre Aufmerksamkeit nicht zu erregen.  Versuchen Sie einfach einmal, Java-Ausnahmen mit Logstash zu analysieren, und sp√ºren Sie diesen Schmerz. </p><br><p>  Json ist ein Segen, es ist ein Feuer, das vom Himmel gegeben wird.  F√ºgen Sie einfach dort hinzu: </p><br><ul><li>  Zeitstempel <strong>mit Millisekunden</strong> gem√§√ü <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">RFC 3339</a> ; </li><li>  Level: Info, Warnung, Fehler, Debug </li><li>  user_id; </li><li>  app_name </li><li>  und andere Felder. </li></ul><br><p>  Laden Sie sie auf ein geeignetes System hoch (z. B. ordnungsgem√§√ü konfigurierte ElasticSearch) und genie√üen Sie es.  Verbinden Sie die Protokolle vieler Microservices und sp√ºren Sie erneut, <em>wozu</em> monolithische Anwendungen gut waren. </p><br><p>  <em>(Sie k√∂nnen auch eine Anforderungs-ID hinzuf√ºgen und eine Ablaufverfolgung erhalten ...)</em> </p><br><h2 id="logs-with-verbosity-levels">  Protokolle mit Ausf√ºhrlichkeitsstufen </h2><br><blockquote>  Die Anwendung muss eine Umgebungsvariable, z. B. LOG_LEVEL, mit mindestens zwei Optionen unterst√ºtzen: ERRORS und DEBUG. </blockquote><p>  Es ist w√ºnschenswert, dass alle Dienste im selben √ñkosystem dieselbe Umgebungsvariable unterst√ºtzen.  Keine Konfigurationsoption, nicht die Befehlszeilenoption (obwohl dies nat√ºrlich umbrochen werden k√∂nnte), sondern standardm√§√üig direkt aus der Umgebungsvariablen.  Sie sollten in der Lage sein, so viele Protokolle wie m√∂glich zu erhalten, wenn etwas schief geht, und so wenige Protokolle wie m√∂glich, wenn alles in Ordnung ist. </p><br><h2 id="locked-versions-of-dependencies">  Gesperrte Versionen von Abh√§ngigkeiten </h2><br><blockquote>  Abh√§ngigkeiten f√ºr Paketmanager sind behoben, einschlie√ülich Nebenversionen (z. B. cool_framework = 2.5.3).  Festgelegte Sperrdateien sind auch ein guter Weg, dies zu tun. </blockquote><p>  Dies war nat√ºrlich schon an vielen Stellen erw√§hnt worden.  Jemand sperrt Abh√§ngigkeiten von seinen Hauptversionen und hofft, dass es in Nebenversionen nur Fehlerbehebungen und Sicherheitsbehebungen gibt.  Es ist ein Fehler. </p><br><h2 id="dockerized">  Dockerisiert </h2><br><blockquote>  Das Repository enth√§lt eine produktionsbereite Docker-Datei und die Datei docker-compose.yml </blockquote><p>  Docker ist f√ºr viele Unternehmen seit langem ein Standard.  Es gibt Ausnahmen, aber selbst wenn Sie keinen Docker in der Produktion haben, sollte jeder Ingenieur in der Lage sein, "Docker-Compose-Up" einfach auszuf√ºhren und an nichts anderes zu denken, um den Entwickler-Build f√ºr die lokale √úberpr√ºfung zu erhalten.  Und der Systemadministrator sollte ein Artefakt haben, das bereits von Entwicklern mit den richtigen Versionen von Bibliotheken, Dienstprogrammen usw. √ºberpr√ºft wurde, wobei die Anwendung <em>zumindest irgendwie funktioniert</em> , um es an die Produktion anzupassen. </p><br><h2 id="configuration-via-environment">  Konfiguration √ºber Umgebung </h2><br><blockquote>  Alle wichtigen Konfigurationsoptionen werden aus der Umgebung gelesen und die Umgebung hat eine h√∂here Priorit√§t als die Konfigurationsdateien (jedoch niedriger als die Befehlszeilenargumente). </blockquote><p>  Niemand wird jemals Ihre Konfigurationsdateien lesen und deren Format studieren wollen.  Akzeptiere es einfach. </p><br><p>  Weitere Details hier: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://12factor.net/config</a> </p><br><h2 id="readiness-and-liveness-probes">  Bereitschafts- und Lebendigkeitssonden </h2><br><blockquote>  Enth√§lt die entsprechenden Endpunkte oder CLI-Befehle, um die Bereitschaft zu testen, Anforderungen beim Start und w√§hrend des Lebenszyklus zu bearbeiten </blockquote><p>  Wenn eine Anwendung HTTP-Anforderungen bedient, sollte sie standardm√§√üig √ºber zwei Schnittstellen verf√ºgen (CLI-√úberpr√ºfungen sind ebenfalls m√∂glich): </p><br><ol><li><p>  Um zu √ºberpr√ºfen, ob die Anwendung aktiv ist und nicht h√§ngen bleibt, wird die Lebendigkeitssonde verwendet.  Wenn die Anwendung nicht reagiert, kann sie von Orchestratoren wie Kubernetes automatisch gestoppt werden.  Ehrlich gesagt kann das Beenden einer blockierten Anwendung einen Dominoeffekt verursachen und Ihren gesamten Service dauerhaft beeintr√§chtigen.  Dies ist jedoch kein Entwicklerproblem. Erstellen Sie einfach diesen Endpunkt und schalten Sie Ihr Telefon in den Flugmodus. </p><br></li><li><p>  Um zu √ºberpr√ºfen, ob die Anwendung nicht nur gestartet wurde, sondern bereit ist, Anforderungen anzunehmen, kann ein Bereitschaftstest durchgef√ºhrt werden.  Wenn eine Anwendung eine Verbindung mit einer Datenbank, einem Warteschlangensystem usw. hergestellt hat, muss sie mit einem Status von 200 bis 400 (f√ºr Kubernetes) antworten. </p><br></li></ol><br><h2 id="resource-limits">  Ressourcenlimits </h2><br><blockquote>  Enth√§lt Beschr√§nkungen f√ºr Speicher, CPU, Speicherplatz und andere verf√ºgbare Ressourcen im vereinbarten Format. </blockquote><p>  Die konkrete Umsetzung dieses Punktes wird in verschiedenen Organisationen und f√ºr verschiedene Orchestratoren sehr unterschiedlich sein.  Sie m√ºssen jedoch speziell f√ºr alle verf√ºgbaren Umgebungen (prod, dev, test, ...) konfiguriert und <em>au√üerhalb des Git-Repos mit dem Anwendungscode</em> gespeichert <em>werden</em> . </p><br><h2 id="automated-builds-and-delivery">  Automatisierte Erstellung und Lieferung </h2><br><blockquote>  Das in Ihrer Organisation oder Ihrem Projekt verwendete CI / CD-System ist konfiguriert und kann die Anwendung gem√§√ü dem akzeptierten Workflow an die gew√ºnschte Umgebung liefern. </blockquote><p>  <em>Nichts wird jemals manuell an die Produktion geliefert.</em> </p><br><p>  Unabh√§ngig davon, wie schwierig es ist, Builds und die Bereitstellung Ihrer Anwendung zu automatisieren, muss dies erfolgen, bevor dieses Projekt in Produktion geht.  Dieser Artikel umfasst das Erstellen und Ausf√ºhren von Ansible / Chef-Kochb√ºchern / Salt / ... sowie das Erstellen von Anwendungen f√ºr mobile Ger√§te.  Gabeln des Betriebssystems;  Bilder von virtuellen Maschinen, was auch immer. <br>  Schwer zu automatisieren?  Das kann man dann nicht in die Welt bringen.  Niemand wird dies nach Ihrer Abreise wieder manuell erstellen k√∂nnen. </p><br><h2 id="graceful-shutdown">  Anmutiges Herunterfahren </h2><br><blockquote>  Die Anwendung versteht SIGTERM und andere Signale und f√§hrt sich nach der Verarbeitung der aktuellen Aufgabe ordnungsgem√§√ü herunter. </blockquote><p>  Dies ist ein √§u√üerst wichtiger Punkt.  Docker-Prozesse werden verwaist und arbeiten monatelang im Hintergrund, wo niemand sie sieht.  Nicht-Transaktionsvorg√§nge werden mitten in der Ausf√ºhrung beendet, was zu einer Inkonsistenz der Daten zwischen Diensten und zwischen Datenspeichern f√ºhrt.  Dies f√ºhrt zu Fehlern, die nicht vorhersehbar sind und die sehr, sehr teuer sein k√∂nnen. </p><br><p>  Wenn Sie einige Abh√§ngigkeiten von Drittanbietern nicht kontrollieren k√∂nnen und nicht garantieren k√∂nnen, dass Ihr Code SIGTERM korrekt verarbeitet, verwenden Sie etwas wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dummes Init</a> . </p><br><p>  Weitere Informationen hier: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://12factor.net/disposability</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://kubernetes.io/docs/concepts/workloads/pods/pod/#termination-of-pods</a> </li></ul><br><h2 id="database-connection-is-checked-regularly">  Die Datenbankverbindung wird regelm√§√üig √ºberpr√ºft </h2><br><blockquote>  Die Anwendung pingt st√§ndig die Datenbank an und reagiert automatisch auf die Ausnahme "Verbindung verloren", die durch einen Ping oder andere Abfragen aufgetreten ist, und versucht, sie selbst wiederherzustellen oder die Arbeit korrekt abzuschlie√üen. </blockquote><p>  Ich habe viele F√§lle gesehen (es ist nicht nur eine Redewendung), in denen Dienste, die zur Verarbeitung von Warteschlangen oder Ereignissen erstellt wurden, die als D√§monen fungieren, die Verbindung durch Zeit√ºberschreitung verloren und unendlich viele Fehler in Protokolle geschrieben haben, Nachrichten an ihre urspr√ºngliche Warteschlange zur√ºckgesendet und an diese gesendet wurden Dead Letter Queue oder einfach nicht ihren Job machen. </p><br><h2 id="scaled-horizontally">  Horizontal skaliert </h2><br><blockquote>  Wenn die Last zunimmt, reicht es aus, mehr Instanzen der Anwendung auszuf√ºhren, um sicherzustellen, dass alle Anforderungen oder Aufgaben verarbeitet werden. </blockquote><p>  Nicht alle Anwendungen k√∂nnen horizontal skaliert werden.  Ein gutes Beispiel ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kafka Consumers.</a> Dies ist nicht unbedingt schlecht, aber wenn eine bestimmte Anwendung nicht zweimal gestartet werden kann, m√ºssen alle interessierten Personen dies im Voraus wissen.  Diese Informationen sollten ein Dorn im Auge sein, in der Readme-Datei fett formatiert und hinzugef√ºgt werden, wo immer dies m√∂glich ist.  Einige Anwendungen k√∂nnen naturgem√§√ü unter keinen Umst√§nden parallel gestartet werden, was zu ernsthaften Schwierigkeiten bei der Wartung f√ºhrt. </p><br><p>  Es ist viel besser, wenn die Anwendung selbst diese Situationen steuert oder ein Wrapper daf√ºr geschrieben wird, der die "Konkurrenten" effektiv √ºberwacht und einfach verhindert, dass der Prozess ihre Arbeit startet oder startet, bis ein anderer Prozess seinen eigenen abschlie√üt oder eine externe Konfiguration dies zul√§sst N Prozesse arbeiten gleichzeitig. </p><br><h2 id="dead-letter-queues-and-resistance-to-bad-messages">  Warteschlangen f√ºr tote Briefe und Widerstand gegen "schlechte" Nachrichten </h2><br><blockquote>  Wenn der Dienst Warteschlangen abh√∂rt oder auf Ereignisse reagiert, f√ºhrt das √Ñndern des Formats oder Inhalts von Nachrichten nicht zu einem Absturz.  Nicht erfolgreiche Versuche, die Aufgabe zu verarbeiten, werden N-mal wiederholt. Danach wird die Nachricht an die Dead Letter Queue gesendet. </blockquote><p>  Ich habe oft gesehen, wie Verbraucher endlos neu gestartet wurden und die Warteschlangen so gro√ü wurden, dass ihre anschlie√üende Verarbeitung viele Tage dauerte.  Jeder Listener der Warteschlange muss bereit sein, das Format zu √§ndern, zuf√§llige Fehler in der Nachricht selbst (z. B. Datentypen in JSON) oder w√§hrend die Nachricht vom untergeordneten Code verarbeitet wird.  Ich war sogar mit einer Situation konfrontiert, in der die Standardbibliothek f√ºr RabbitMQ in einem √§u√üerst beliebten Framework Wiederholungsversuche, Versuchsz√§hler usw. √ºberhaupt nicht unterst√ºtzte.  und es gab keine einfache M√∂glichkeit, seine Logik zu erweitern. </p><br><p>  Und noch viel schlimmer, wenn die Nachricht im Fehlerfall einfach zerst√∂rt wird. </p><br><h2 id="limited-number-of-processed-messages-and-tasks-by-one-instance">  Begrenzte Anzahl verarbeiteter Nachrichten und Aufgaben durch eine Instanz </h2><br><blockquote>  Es unterst√ºtzt eine Umgebungsvariable, die bei Bedarf festgelegt werden kann, um die maximale Anzahl verarbeiteter Aufgaben zu begrenzen. Danach wird der Dienst ordnungsgem√§√ü heruntergefahren. </blockquote><p>  St√§ndig steigender Speicherverbrauch und "OOM Killed" am Ende sind die Norm des Lebens f√ºr moderne kubernetische K√∂pfe.  Die Implementierung einer primitiven Pr√ºfung, die Ihnen nur die Notwendigkeit erspart, all diese Speicherlecks zu untersuchen, w√ºrde das Leben erleichtern.  Ich habe oft gesehen, dass Menschen viel Zeit und M√ºhe (und Geld) aufwenden, um diese Lecks zu stoppen, aber es gibt keine Garantie daf√ºr, dass das n√§chste Engagement Ihres Arbeitskollegen die Situation nicht verschlimmert.  Wenn die Anwendung eine Woche √ºberleben kann, ist dies ein ausgezeichneter Indikator.  Lassen Sie es dann einfach aufh√∂ren und wird neu gestartet.  Dies ist besser als SIGKILL (zu SIGTERM, siehe oben) oder die Ausnahme "Nicht gen√ºgend Speicher".  F√ºr ein paar Jahrzehnte reicht diese Problemumgehung f√ºr die meisten F√§lle aus. </p><br><h2 id="not-locked-by-a-third-party-integration-with-ip-address-whitelistening">  Nicht durch eine Drittanbieter-Integration mit IP-Adress-Whitelistening gesperrt </h2><br><blockquote>  Wenn eine Anwendung Anforderungen an einen Drittanbieter-Dienst stellt, der nur Anforderungen von begrenzten IP-Adressen zul√§sst, stellt der Dienst diese Anforderungen indirekt (z. B. √ºber einen Reverse-Proxy). </blockquote><p>  Dies ist ein seltener Fall, aber √§u√üerst unangenehm.  Es ist sehr unpraktisch, wenn eine kleine Anwendung die M√∂glichkeit blockiert, das Clusternetzwerk zu √§ndern oder in eine andere Region der gesamten Infrastruktur zu wechseln.  Wenn Sie mit etwas kommunizieren m√ºssen, das nicht mit oAuth oder VPN funktioniert, richten Sie im Voraus einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Reverse-Proxy</a> ein.  Implementieren Sie in Ihren Programmen nicht das dynamische Hinzuf√ºgen / L√∂schen externer Integrationen f√ºr diese Zwecke, die Hostnamen von Drittanbietern usw. verwenden, da Sie sich dabei an die einzige verf√ºgbare Laufzeitumgebung halten.  Es ist besser, mit der Automatisierung dieser Prozesse zu beginnen, um beispielsweise Nginx-Konfigurationen oder andere zu verwalten, und in Ihrer Anwendung darauf zu verweisen. </p><br><h2 id="obvious-http-user-agent">  Offensichtlicher HTTP-Benutzeragent </h2><br><blockquote>  Der Dienst ersetzt den User-Agent-Header durch einen benutzerdefinierten f√ºr alle Anforderungen an APIs. Dieser Header enth√§lt gen√ºgend Informationen √ºber den Dienst selbst und seine Version. </blockquote><p>  Wenn 100 verschiedene Anwendungen miteinander kommunizieren, k√∂nnen Sie verr√ºckt werden und in den Protokollen etwas wie "Go-http-client / 1.1" und die dynamische IP-Adresse des Kubernetes-Containers sehen.  Identifizieren Sie Ihre Anwendung und ihre Version immer explizit. </p><br><h2 id="does-not-violate-a-license">  Verst√∂√üt nicht gegen eine Lizenz </h2><br><blockquote>  Enth√§lt keine Abh√§ngigkeiten, die die Anwendung einschr√§nken, und es handelt sich nicht um eine Kopie des Codes einer anderen Person usw. </blockquote><p>  Dies ist ein selbstverst√§ndlicher Fall, aber ich habe Dinge gesehen, bei denen selbst ein Anwalt, der die NDA geschrieben hat, jetzt Schluckauf hat. </p><br><h2 id="does-not-use-unsupported-dependencies">  Verwendet keine nicht unterst√ºtzten Abh√§ngigkeiten. </h2><br><blockquote>  Wenn Sie den Dienst zum ersten Mal starten, enth√§lt er keine Abh√§ngigkeiten, die bereits veraltet sind. </blockquote><p>  Wenn die Bibliothek, die Sie in das Projekt aufgenommen haben, von niemandem mehr unterst√ºtzt wird, suchen Sie nach einem anderen Weg, um das Ziel zu erreichen, oder beginnen Sie, die Bibliothek selbst zu unterst√ºtzen. </p><br><h2 id="conclusion">  Fazit </h2><br><p>  In meiner Liste gibt es einige sehr spezifische √úberpr√ºfungen f√ºr bestimmte Technologien oder Situationen, oder ich habe einfach vergessen, etwas hinzuzuf√ºgen.  Ich bin sicher, Sie wissen auch, was darin enthalten sein muss. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de438186/">https://habr.com/ru/post/de438186/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de438176/index.html">IPSec √úbersicht bei Mikrotik</a></li>
<li><a href="../de438178/index.html">Erstellen Ihrer ersten ARCore-Anwendung</a></li>
<li><a href="../de438180/index.html">Registrieren Sie eine Immobilientransaktion online</a></li>
<li><a href="../de438182/index.html">Die Studie fand die Vorteile einer moderaten Piraterie f√ºr Produzenten und Vertreiber von Inhalten</a></li>
<li><a href="../de438184/index.html">Bericht der Bank of America: 700 Billionen Dollar aus dem All</a></li>
<li><a href="../de438192/index.html">Dell Inspiron 14 (5482): kosteng√ºnstiges 2-in-1-Ger√§t mit guten Upgrade-Optionen</a></li>
<li><a href="../de438196/index.html">Wenn das Projekt "Theater" ist, verwenden Sie Schauspieler ...</a></li>
<li><a href="../de438198/index.html">Gehen wir tief in die Geschichte ein: Wo wachsen die Beine von Quadrocoptern?</a></li>
<li><a href="../de438202/index.html">JavaScript: √ñffentliche und private Klassenfelder</a></li>
<li><a href="../de438204/index.html">Schnelles Compiler-Ger√§t. Teil 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>