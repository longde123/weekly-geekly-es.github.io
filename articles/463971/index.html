<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèø‚Äçüé® üôå üî∑ Notas de Pentester: Casos de caza üà≥ üëêüèª üèÜ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="- Ustedes son geniales! ¬°As√≠ que nadie nos ha decepcionado todav√≠a! 
 - Lo intentamos. 

 S√≠, la vida de los cazadores de vulnerabilidades est√° llena ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Notas de Pentester: Casos de caza</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/solarsecurity/blog/463971/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/re/l-/nd/rel-ndtljsrzvl8wwp1enh1uvsw.jpeg" alt="imagen"></div><br>  <i>- Ustedes son geniales!</i>  <i>¬°As√≠ que nadie nos ha decepcionado todav√≠a!</i> <i><br></i>  <i>- Lo intentamos.</i> <br><br>  S√≠, la vida de los cazadores de vulnerabilidades est√° llena de cumplidos espec√≠ficos de clientes y situaciones no menos espec√≠ficas.  Durante el a√±o pasado, hemos completado m√°s de cincuenta pruebas de penetraci√≥n en diferentes compa√±√≠as y, hay que decirlo, lo hemos visto todo.  Una contrase√±a para todas las cuentas y sistemas, almacenamiento abierto de contrase√±as en la base de datos, los restos de la funcionalidad de depuraci√≥n en un entorno de combate ... Por lo tanto, cuando nuestros colegas de JSOC CERT <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">contaron</a> varias historias sobre investigaciones de incidentes cibern√©ticos, en el departamento de Pentest decidimos mantenernos al d√≠a y mostrar el otro lado de la "barricada" ¬ª: La infraestructura del cliente a trav√©s de los ojos de un hacker.  Hoy le contaremos sobre los pentests externos m√°s interesantes de los √∫ltimos tiempos, cuando tuvimos que penetrar en el per√≠metro interno del cliente, teniendo solo una lista de sus direcciones IP externas y nombres de dominio. <br><a name="habracut"></a><br><h3>  Odyn </h3><br>  Lunes: <br>  - Chicos, comiencen m√°s r√°pido con un pentest: solo tienen 3 semanas para hackearnos.  Pero tenga en cuenta que sus posibilidades son m√≠nimas: nos revisan todos los a√±os y no encuentran pistas. <br><br>  Despu√©s de 4 horas: <br>  "Ya estamos adentro". <br>  - vamos?  ¬°No puede ser as√≠!  Ahora revisemos los registros ... <br><br>  Viernes: <br>  - Maldici√≥n, de verdad.  ¬øC√≥mo es eso?  Pero como el tiempo no funcion√≥, ¬øquiz√°s buscar√°s otra cosa? <br>  - Si, no hay duda. <br><br>  Y comenzamos a buscar.  Al escanear el per√≠metro de la organizaci√≥n, nos encontramos con un host en el que giraban 4 aplicaciones web, un servidor FTP y el panel de administraci√≥n phpMyAdmin se colg√≥.  El an√°lisis de las aplicaciones web no revel√≥ vulnerabilidades cr√≠ticas all√≠ (por ejemplo, inyecciones SQL, XXE, RCE, etc.) que nos permitir√≠an acceder al servidor.  En alg√∫n momento cambiaron a FTP, y aqu√≠ ya era m√°s interesante: se abri√≥ el acceso an√≥nimo en el servidor, pero solo para leer. <br><br><img src="https://habrastorage.org/webt/lt/qr/e_/ltqre_p9rtpvg9bjptbm3rdkoas.jpeg" alt="imagen"><br><br>  Durante varios d√≠as, examinamos el contenido del servidor y encontramos algunas l√≠neas extra√±as en los registros, algunas contrase√±as ingresadas incorrectamente para uno de los administradores de la aplicaci√≥n web. <br><br><img src="https://habrastorage.org/webt/ct/b4/sg/ctb4sgs3uzd7vbrio_ocne28kle.jpeg" alt="imagen"><br><br>  Con base en las opciones incorrectas, supusimos c√≥mo deber√≠a ser la contrase√±a, y surgi√≥.  Decidimos probarlo para phpMyAdmin y, oh, un milagro, tambi√©n surgi√≥.  Luego, era un asunto peque√±o: cargar el shell, obtener acceso a la red interna, establecerse all√≠ y desarrollarse ya dentro. <br><br><img src="https://habrastorage.org/webt/jo/_y/_q/jo_y_qwwskq7z10la6ijhcv7hpi.jpeg" alt="imagen"><br><br>  As√≠ es como la pereza ordinaria (¬øy de qu√© otra manera explicar la renuencia a ingresar contrase√±as diferentes para cada panel de administraci√≥n?) Allana el camino para los piratas inform√°ticos a la red interna de la organizaci√≥n. <br><br><h3>  ¬øPor qu√© depurar en un entorno de combate? </h3><br>  La mayor√≠a de nuestros avances se producen a trav√©s de aplicaciones web y, a menudo, nos encontramos con curiosos "restos" de tiempos de desarrollo y pruebas.  A menudo encontramos registros, algunas piezas de modos de depuraci√≥n, pero no siempre con su ayuda logramos llevar a cabo RCE (ejecuci√≥n remota de c√≥digo). <br><br>  Durante uno de nuestros clientes, descubrimos un sistema CRM, en el que decidimos dedicar un poco m√°s de tiempo (y, debo decir, que luego vali√≥ la pena).  Al realizar el an√°lisis de la aplicaci√≥n, encontramos los restos de las pruebas, que, aparentemente, se utilizaron en la etapa de desarrollo.  La autenticaci√≥n se produjo en ellos de una manera muy milagrosa: solo se verific√≥ el nombre de usuario y el hecho de pasar un par√°metro que conten√≠a alguna contrase√±a.  Cinco minutos de b√∫squeda y lectura de documentaci√≥n est√°ndar, y tenemos en nuestras manos el nombre de la cuenta de superusuario incorporada.  Llenar el caparaz√≥n ya era una cuesti√≥n de tecnolog√≠a. <br><br><img src="https://habrastorage.org/webt/1v/x7/eu/1vx7euqw9abtywzmfoxknwfakwe.jpeg" alt="imagen"><br><br>  Otro ejemplo.  Al comienzo del proyecto, lanzamos una fuerza bruta recursiva de subdominios y la dejamos.  Despu√©s de alg√∫n tiempo, para nuestra sorpresa, apareci√≥ un subdominio de quinto nivel llamado test.debug.application.client.ru, en el que encontramos una aplicaci√≥n web con Adminer instalado all√≠.  Esta es una aplicaci√≥n de administraci√≥n de base de datos liviana, en versiones anteriores de las cuales, si est√° configurada incorrectamente, puede interactuar con una base de datos SQLite sin una contrase√±a. <br><br>  El hecho de que no hubiera datos en esta base de datos no era importante: despu√©s de todo, en SQLite puede crear una base de datos en una ruta arbitraria con un simple shell web dentro, obteniendo as√≠ la capacidad de administrar convenientemente el servidor y ejecutar comandos desde una p√°gina web. <br><br>  Todo lo que quedaba era averiguar la direcci√≥n completa de la aplicaci√≥n web en el servidor.  Aqu√≠ fuimos ayudados por todos los "amados" CMS 1C-Bitrix, que, en un mensaje de error, compartieron con gusto d√≥nde est√° ubicado.  Entonces solo quedaba llenar el caparaz√≥n y terminar el proyecto. <br><br><img src="https://habrastorage.org/webt/ca/sq/xa/casqxa5eywlhhzzy-c2etsjvkvk.jpeg" alt="imagen"><br><br>  El trabajo con SQLite DB se puede ver <a href="">aqu√≠</a> . <br><br><h3>  ¬øRegistros encontrados?  Contrase√±as como regalo! </h3><br>  Un cliente nos pidi√≥ que realicemos una pentest de una aplicaci√≥n web.  Durante los tres a√±os anteriores, realiz√≥ pentests con otro equipo y probablemente logr√≥ parchear algunos de los agujeros en el per√≠metro, por lo que no esper√°bamos un √©xito r√°pido. <br><br>  Durante el borrado de la aplicaci√≥n web, encontramos una p√°gina en la que se registraba la autorizaci√≥n del usuario.  El tiempo y el inicio de sesi√≥n del usuario que inici√≥ sesi√≥n en la aplicaci√≥n se mostr√≥ en el registro.  Escribimos un script que una vez que un par de minutos sonde√≥ esta p√°gina, analiz√≥ la respuesta y anot√≥ los inicios de sesi√≥n encontrados en un archivo.  Despu√©s de unos d√≠as, logramos recolectar alrededor de cien inicios de sesi√≥n.  Decidimos comenzar la selecci√≥n de contrase√±as: para 5 inicios de sesi√≥n se encontraron en la lista de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">las peores contrase√±as TOP-500</a> . <br><br>  Una vez que obtuvimos acceso a la aplicaci√≥n, continuamos analiz√°ndola y encontramos otro archivo interesante: en √©l se mostraban todas las consultas de la base de datos en tiempo real.  Con una herramienta de depuraci√≥n tan conveniente, la b√∫squeda de vulnerabilidades y la explotaci√≥n de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">inyecci√≥n SQL basada en el tiempo booleano</a> encontrada se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ha</a> convertido en una tarea trivial. <br><br>  A pesar de que ya es 2019, la gente todav√≠a cree que almacenar contrase√±as en una base de datos en forma abierta es una buena idea.  Usamos esto y encontramos la inyecci√≥n SQL y obtenemos una cuenta de administrador con la que completar el shell web y abrir el acceso a la red interna de la organizaci√≥n no fue un gran problema. <br><br><h4>  Marcas de corte </h4><br>  En primer lugar, realice pruebas de penetraci√≥n peri√≥dicas: lo ayudar√°n a encontrar puntos delgados que podr√≠a haberse perdido en la etapa de desarrollo o al cambiar de entornos de prueba a combates. <br><br>  En segundo lugar, considere siempre el factor humano: las personas son demasiado flojas para cambiar las contrase√±as, e incluso pueden usar una contrase√±a en varios sitios.  S√≠, los administradores tambi√©n pecan esto. <br><br>  Tercero, elimine los modos de depuraci√≥n en entornos de combate. <br><br><h3>  PS </h3><br>  En general, la vida cotidiana del departamento de Pentest est√° llena de todo tipo de "entretenimientos" y, por supuesto, las pruebas externas no son las √∫nicas.  El cliente puede desear verificar las vulnerabilidades del per√≠metro interno (pentest interno), o analizar la seguridad de las aplicaciones web y m√≥viles, as√≠ como las redes WiFi, o hacer arreglos para que los empleados verifiquen utilizando m√©todos de ingenier√≠a social. <br><br>  En nuestro tiempo libre de proyectos, <s>comprendemos Zen,</s> buscamos nuevas vulnerabilidades, mejoramos nuestras herramientas y t√©cnicas.  Y estamos comprometidos en un bugbounty (donde sin √©l). <br><br>  Aprender√° sobre la diversidad de nuestras "aventuras" en las siguientes publicaciones. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/463971/">https://habr.com/ru/post/463971/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../463957/index.html">C√≥mo implementar una lista de entrevistas enlazadas individualmente</a></li>
<li><a href="../463961/index.html">Mapeador propio o un poco sobre ExpressionTrees</a></li>
<li><a href="../463963/index.html">Reconocimiento facial en un sitio de construcci√≥n</a></li>
<li><a href="../463965/index.html">Aplicaci√≥n de composici√≥n tipogr√°fica en LaTeX</a></li>
<li><a href="../463969/index.html">Presupuesto familiar de Telegram</a></li>
<li><a href="../463975/index.html">Entorno moderno para reaccionar aplicaciones nativas</a></li>
<li><a href="../463981/index.html">El hijo de mam√° est√° celoso de ella: c√≥mo ganar el Premio Alice dos veces</a></li>
<li><a href="../463983/index.html">Del 0% al 70% del mercado: ¬øC√≥mo absorbi√≥ Google Chrome Internet?</a></li>
<li><a href="../463985/index.html">Aki Phoenix</a></li>
<li><a href="../463987/index.html">Aplicaciones para libros electr√≥nicos en el sistema operativo Android. Parte 2. Librer√≠as y aplicaciones de lectura de libros.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>