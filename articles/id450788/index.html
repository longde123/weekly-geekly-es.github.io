<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨ğŸ½â€ğŸ’¼ ğŸ‘©ğŸ½â€ğŸŒ¾ ğŸ“º Ketergantungan injeksi dengan DITranquillity ğŸ‘ŒğŸ¼ ğŸ‘  ğŸ´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dependency Injection adalah pola yang cukup populer yang memungkinkan Anda untuk mengkonfigurasi sistem secara fleksibel dan secara benar membangun ke...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ketergantungan injeksi dengan DITranquillity</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/450788/"><p> Dependency Injection adalah pola yang cukup populer yang memungkinkan Anda untuk mengkonfigurasi sistem secara fleksibel dan secara benar membangun ketergantungan komponen-komponen sistem ini satu sama lain.  Berkat pengetikan, Swift memungkinkan Anda untuk menggunakan kerangka kerja yang nyaman yang dengannya Anda dapat dengan singkat menggambarkan grafik dependensi.  Hari ini saya ingin berbicara sedikit tentang salah satu kerangka kerja ini - <code>DITranquillity</code> . </p><a name="habracut"></a><br><p>  Tutorial ini akan membahas fitur-fitur perpustakaan berikut: </p><br><ul><li>  Ketik Registrasi </li><li>  Penyebaran Inisialisasi </li><li>  Menanamkan dalam variabel </li><li>  Ketergantungan siklik komponen </li><li>  Menggunakan perpustakaan dengan <code>UIStoryboard</code> </li></ul><br><h3 id="opisanie-komponentov">  Deskripsi Komponen </h3><br><p>  Aplikasi ini akan terdiri dari komponen utama berikut: <code>ViewController</code> , <code>Router</code> , <code>Presenter</code> , <code>Networking</code> - ini adalah komponen yang cukup umum di aplikasi iOS apa pun. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/w-/pn/ro/w-pnroiey2c8xri9o3erqm9er_0.gif" alt="Struktur komponen"></div><br><p>  <code>ViewController</code> dan <code>Router</code> akan saling diperkenalkan secara siklis. </p><br><h3 id="podgotovka">  Persiapan </h3><br><p>  Pertama, buat Aplikasi Tampilan Tunggal dalam Xcode, tambahkan DITranquillity menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">CocoaPods</a> .  Buat hierarki file yang diperlukan, lalu tambahkan pengontrol kedua ke Main.storyboard dan hubungkan menggunakan <code>StoryboardSegue</code> .  Akibatnya, struktur file berikut harus diperoleh: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jw/li/s8/jwlis8txyhuzn1m5swacqvrixe4.png" alt="Struktur file"></div><br><p>  Buat dependensi di kelas-kelas sebagai berikut: </p><br><div class="spoiler">  <b class="spoiler_title">Deklarasi Komponen</b> <div class="spoiler_text"><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">protocol</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Presenter</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCounter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(completion: @escaping </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(Int)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span>) } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyPresenter</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Presenter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> networking: <span class="hljs-type"><span class="hljs-type">Networking</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(networking: <span class="hljs-type"><span class="hljs-type">Networking</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.networking = networking } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCounter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(completion: @escaping </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(Int)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// Implementation } }</span></span></code> </pre> <br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">protocol</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Networking</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fetchData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(completion: @escaping </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(Result&lt;Int, Error&gt;)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span>) } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyNetworking</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Networking</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fetchData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(completion: @escaping </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(Result&lt;Int, Error&gt;)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// Implementation } }</span></span></code> </pre> <br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">protocol</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Router</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">presentNewController</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyRouter</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Router</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">unowned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> viewController: <span class="hljs-type"><span class="hljs-type">ViewController</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(viewController: <span class="hljs-type"><span class="hljs-type">ViewController</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.viewController = viewController } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">presentNewController</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">// Implementation } }</span></span></code> </pre> <br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIViewController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> presenter: <span class="hljs-type"><span class="hljs-type">Presenter!</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> router: <span class="hljs-type"><span class="hljs-type">Router!</span></span> }</code> </pre> </div></div><br><h4 id="ogranicheniya">  Keterbatasan </h4><br><p>  Tidak seperti kelas lain, <code>ViewController</code> tidak dibuat oleh kami, tetapi oleh perpustakaan UIKit di dalam implementasi <code>UIStoryboard.instantiateViewController</code> , oleh karena itu, menggunakan storyboard, kami tidak dapat menyuntikkan dependensi ke dalam pewaris <code>UIViewController</code> menggunakan inisialisasi.  Begitu pula dengan ahli waris <code>UIView</code> dan <code>UITableViewCell</code> . </p><br><p>  Perhatikan bahwa objek yang tersembunyi di balik protokol tertanam di semua kelas.  Ini adalah salah satu tugas utama penerapan dependensi - untuk membuat dependensi bukan pada implementasi, tetapi pada antarmuka.  Ini akan membantu di masa depan untuk menyediakan implementasi protokol yang berbeda untuk menggunakan kembali atau menguji komponen. </p><br><h3 id="vnedrenie-zavisimostey">  Injeksi Ketergantungan </h3><br><p>  Setelah semua komponen sistem dibuat, kami melanjutkan ke koneksi objek di antara mereka sendiri.  Dalam DITranquillity, titik awalnya adalah <code>DIContainer</code> , yang menambahkan pendaftaran menggunakan metode <code>container.register(...)</code> .  Untuk memisahkan ketergantungan menjadi beberapa bagian, <code>DIFramework</code> dan <code>DIPart</code> , yang harus diimplementasikan.  Untuk kenyamanan, kami hanya akan membuat satu kelas <code>ApplicationDependency</code> , yang akan mengimplementasikan <code>DIFramework</code> dan akan berfungsi sebagai tempat pendaftaran untuk semua dependensi.  Antarmuka <code>DIFramework</code> mengharuskan Anda untuk menerapkan hanya satu metode - <code>load(container:)</code> . </p><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ApplicationDependency</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DIFramework</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">load</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(container: DIContainer)</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">// registrations will be placed here } }</span></span></code> </pre> <br><p>  Mari kita mulai dengan pendaftaran paling sederhana yang tidak memiliki dependensi - <code>MyNetworking</code> </p><br><pre> <code class="swift hljs">container.register(<span class="hljs-type"><span class="hljs-type">MyNetworking</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>)</code> </pre> <br><p>  Registrasi ini menggunakan implementasi melalui penginisialisasi.  Terlepas dari kenyataan bahwa komponen itu sendiri tidak memiliki dependensi, penginisialisasi harus disediakan untuk menjelaskan kepada perpustakaan cara membuat komponen. </p><br><p>  Demikian pula, daftarkan <code>MyPresenter</code> dan <code>MyRouter</code> . </p><br><pre> <code class="swift hljs">container.register1(<span class="hljs-type"><span class="hljs-type">MyPresenter</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>) container.register1(<span class="hljs-type"><span class="hljs-type">MyRouter</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>)</code> </pre> <br><p>  <strong>Catatan:</strong> Perhatikan bahwa ini bukan <code>register</code> yang digunakan, tetapi <code>register1</code> .  Sayangnya, ini perlu untuk menunjukkan apakah objek memiliki satu dan hanya satu ketergantungan pada penginisialisasi.  Artinya, jika ada 0 atau dua atau lebih dependensi, Anda hanya perlu menggunakan <code>register</code> .  Pembatasan ini adalah bug dari Swift versi 4.0 dan lebih tinggi. </p><br><p>  Sudah waktunya untuk mendaftarkan <code>ViewController</code> kami.  Itu menyuntikkan objek tidak melalui penginisialisasi, tetapi langsung ke dalam variabel, sehingga deskripsi registrasi akan menjadi sedikit lebih. </p><br><pre> <code class="swift hljs">container.register(<span class="hljs-type"><span class="hljs-type">ViewController</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) .injection(cycle: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, \.router) .injection(\.presenter)</code> </pre> <br><p>  Sintaks dari form <code>\.presenter</code> adalah SwiftKeyPath, berkat itu memungkinkan untuk mengimplementasikan dependensi secara ringkas.  Karena <code>Router</code> dan <code>ViewController</code> bergantung satu sama lain, Anda harus secara eksplisit menunjukkan ini menggunakan <code>cycle: true</code> .  Perpustakaan itu sendiri dapat menyelesaikan dependensi ini tanpa indikasi yang jelas, tetapi persyaratan ini diperkenalkan sehingga orang yang membaca grafik segera memahami bahwa ada siklus dalam rantai dependensi.  Juga perhatikan bahwa <strong>BUKAN</strong> <code>ViewController.init</code> , <strong>tetapi</strong> <code>ViewController.self</code> .  Ini dijelaskan di atas di bagian <em>Keterbatasan</em> . </p><br><p>  Anda juga perlu mendaftarkan <code>UIStoryboard</code> menggunakan metode khusus. </p><br><pre> <code class="swift hljs">container.registerStoryboard(name: <span class="hljs-string"><span class="hljs-string">"Main"</span></span>)</code> </pre> <br><p>  Sekarang kami telah menggambarkan seluruh grafik dependensi untuk satu layar.  Tetapi belum ada akses ke grafik ini.  Anda harus membuat <code>DIContainer</code> yang memungkinkan Anda mengakses objek di dalamnya. </p><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> container: <span class="hljs-type"><span class="hljs-type">DIContainer</span></span> = { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> container = <span class="hljs-type"><span class="hljs-type">DIContainer</span></span>() <span class="hljs-comment"><span class="hljs-comment">// 1 container.append(framework: ApplicationDependency.self) // 2 assert(container.validate(checkGraphCycles: true)) // 3 return container }()</span></span></code> </pre> <br><ol><li>  Inisialisasi wadah </li><li>  Tambahkan deskripsi grafik ke dalamnya. </li><li>  Kami memeriksa bahwa kami melakukan semuanya dengan benar.  Jika kesalahan dibuat, aplikasi tidak akan crash saat menyelesaikan dependensi, tetapi segera saat membuat grafik </li></ol><br><p>  Maka Anda perlu menjadikan wadah sebagai titik awal aplikasi.  Untuk melakukan ini, <code>AppDelegate</code> menerapkan metode <code>didFinishLaunchingWithOptions</code> di <code>didFinishLaunchingWithOptions</code> alih-alih menetapkan <code>Main.storyboard</code> sebagai titik peluncuran di pengaturan proyek. </p><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">application</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Any</span></span></span></span><span class="hljs-function"><span class="hljs-params">]?)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span> { window = <span class="hljs-type"><span class="hljs-type">UIWindow</span></span>(frame: <span class="hljs-type"><span class="hljs-type">UIScreen</span></span>.main.bounds) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> storyboard: <span class="hljs-type"><span class="hljs-type">UIStoryboard</span></span> = <span class="hljs-type"><span class="hljs-type">ApplicationDependency</span></span>.container.resolve() window?.rootViewController = storyboard.instantiateInitialViewController() window?.makeKeyAndVisible() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> }</code> </pre> <br><h3 id="zapusk">  Luncurkan </h3><br><p>  Pada awal pertama, akan terjadi penurunan dan validasi akan gagal karena alasan berikut: </p><br><ul><li>  Wadah tidak akan menemukan jenis <code>Router</code> , <code>Presenter</code> , <code>Networking</code> , karena kami hanya mendaftarkan objek.  Jika kita ingin memberikan akses bukan ke implementasi, tetapi ke antarmuka, kita harus secara eksplisit menentukan antarmuka </li><li>  Wadah tidak mengerti bagaimana menyelesaikan ketergantungan siklik, karena itu perlu untuk secara eksplisit menunjukkan objek mana yang tidak harus dibuat ulang setiap kali grafik diselesaikan. </li></ul><br><p>  Sangat mudah untuk memperbaiki kesalahan pertama - ada metode khusus yang memungkinkan Anda menentukan protokol mana yang tersedia dalam wadah. </p><br><pre> <code class="swift hljs">container.register(<span class="hljs-type"><span class="hljs-type">MyNetworking</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>) .<span class="hljs-keyword"><span class="hljs-keyword">as</span></span>(check: <span class="hljs-type"><span class="hljs-type">Networking</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) {$<span class="hljs-number"><span class="hljs-number">0</span></span>}</code> </pre> <br><p>  Menjelaskan registrasi sebagai berikut, kita katakan: objek <code>MyNetworking</code> dapat diakses melalui protokol <code>Networking</code> .  Ini harus dilakukan untuk semua objek yang disembunyikan di bawah protokol.  <code>{$0}</code> menambahkan untuk pemeriksaan jenis yang benar oleh kompiler. </p><br><p>  Kesalahan kedua sedikit lebih rumit.  Adalah perlu untuk menggunakan <code>scope</code> disebut, yang menggambarkan seberapa sering objek dibuat dan seberapa banyak ia hidup.  Untuk setiap pendaftaran yang berpartisipasi dalam dependensi melingkar, Anda harus menentukan ruang <code>scope</code> sama dengan <code>objectGraph</code> .  Ini akan memperjelas wadah bahwa selama penyelesaian diperlukan untuk menggunakan kembali objek yang dibuat, daripada membuat setiap waktu.  Jadi, ternyata: </p><br><pre> <code class="swift hljs">container.register(<span class="hljs-type"><span class="hljs-type">ViewController</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) .injection(cycle: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, \.router) .injection(\.presenter) .lifetime(.objectGraph) container.register1(<span class="hljs-type"><span class="hljs-type">MyRouter</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>) .<span class="hljs-keyword"><span class="hljs-keyword">as</span></span>(check: <span class="hljs-type"><span class="hljs-type">Router</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) {$<span class="hljs-number"><span class="hljs-number">0</span></span>} .lifetime(.objectGraph)</code> </pre> <br><p>  Setelah memulai ulang, wadah berhasil lulus validasi dan ViewController kami terbuka dengan dependensi yang dibuat.  Anda dapat meletakkan breakpoint di <code>viewDidLoad</code> dan pastikan. </p><br><h3 id="perehod-mezhdu-ekranami">  Transisi antar layar </h3><br><p>  Selanjutnya, buat dua kelas kecil, <code>SecondViewController</code> dan <code>SecondPresenter</code> , tambahkan <code>SecondViewController</code> ke storyboard dan buat <code>Segue</code> antara mereka dengan pengidentifikasi <code>"RouteToSecond"</code> , yang memungkinkan Anda untuk membuka pengontrol kedua dari yang pertama. </p><br><p>  Tambahkan dua pendaftaran lagi ke <code>ApplicationDependency</code> kami untuk masing-masing kelas baru: </p><br><pre> <code class="swift hljs">container.register(<span class="hljs-type"><span class="hljs-type">SecondViewController</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) .injection(\.secondPresenter) container.register(<span class="hljs-type"><span class="hljs-type">SecondPresenter</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>)</code> </pre> <br><p>  <code>.as</code> perlu menentukan <code>.as</code> , karena kami tidak menyembunyikan <code>SecondPresenter</code> belakang protokol, tetapi menggunakan implementasinya secara langsung.  Kemudian, dalam metode <code>viewDidAppear</code> pengontrol pertama, kami memanggil <code>performSegue(withIdentifier: "RouteToSecond", sender: self)</code> , start, controller kedua terbuka, di mana dependensi <code>secondPresenter</code> harus ditempelkan.  Seperti yang Anda lihat, wadah melihat pembuatan pengontrol kedua dari <code>UIStoryboard</code> dan berhasil meletakkan dependensi. </p><br><h3 id="zaklyuchenie">  Kesimpulan </h3><br><p>  Pustaka ini memungkinkan Anda bekerja dengan nyaman dengan dependensi siklik, storyboard, dan sepenuhnya menggunakan inferensi tipe otomatis di Swift, yang memberikan sintaks yang sangat singkat dan fleksibel untuk menggambarkan grafik dependensi. </p><br><h4 id="ssylki">  Referensi </h4><br><p>  Kode sampel lengkap di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">perpustakaan github</a> </p><br><p>  DITranquillity <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pada github</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel bahasa inggris</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id450788/">https://habr.com/ru/post/id450788/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id450776/index.html">Selamat Hari Radio dan Komunikasi! Kartu pos pendek tentang</a></li>
<li><a href="../id450780/index.html">Kesederhanaan buta</a></li>
<li><a href="../id450782/index.html">Keacakan semu akan membantu kami: pemilihan alat untuk menghasilkan aset untuk game</a></li>
<li><a href="../id450784/index.html">Bagaimana Netflix mengelola pemirsa dengan sangat baik?</a></li>
<li><a href="../id450786/index.html">Perbedaan antara Fasih dan gettext</a></li>
<li><a href="../id450790/index.html">Hidrogel, Blueberry, dan Sedikit Kunyit: Sistem Vaskular Buatan</a></li>
<li><a href="../id450794/index.html">Pilihan itu Jahat</a></li>
<li><a href="../id450796/index.html">Bagaimana Tesla Mengajarkan Autopilot</a></li>
<li><a href="../id450798/index.html">Pembelajaran Mesin dalam Pengembangan Seluler: Prospek dan Desentralisasi</a></li>
<li><a href="../id450800/index.html">Pengembangan Layanan Mikro dengan BDD dan IOD</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>