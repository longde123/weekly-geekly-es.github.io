<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📿 🚬 👨🏾‍🤝‍👨🏻 Utiliser des méthodes offensives pour enrichir Threat Intelligence 🤦🏼 📎 ➖</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Aujourd'hui, Threat Intelligence, ou la collecte active d'informations sur les menaces à la sécurité de l'information, est un outil essentiel dans le ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Utiliser des méthodes offensives pour enrichir Threat Intelligence</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jetinfosystems/blog/426025/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/440/45a/1d4/44045a1d4cbaec976766cd6206eee205.jpg" width="500"></div><br>  Aujourd'hui, Threat Intelligence, ou la collecte active d'informations sur les menaces à la sécurité de l'information, est un outil essentiel dans le processus d'identification des incidents de sécurité de l'information.  Les sources typiques de TI comprennent des abonnements gratuits avec des indicateurs malveillants, des bulletins de fabricants de matériel et de logiciels décrivant les vulnérabilités, des rapports de chercheurs en sécurité avec des descriptions détaillées des menaces, ainsi que des abonnements commerciaux de fournisseurs TI.  De plus, souvent, les informations obtenues à l'aide des sources ci-dessus ne sont pas suffisamment complètes et pertinentes.  L'utilisation d'OSINT (open source intelligence) et de méthodes offensives (c'est-à-dire des méthodes qui ne sont pas caractéristiques du défenseur mais de l'attaquant) dans la sécurité de l'information, qui seront discutées dans cet article, peut contribuer à améliorer l'efficacité et la qualité de TI. <br><a name="habracut"></a><br><h2>  AVIS DE NON-RESPONSABILITÉ </h2><br>  Cet article est à titre informatif uniquement.  L'auteur n'est pas responsable des éventuels dommages et / ou perturbations des réseaux et / ou services de tiers liés à l'exécution de certaines actions décrites dans l'article.  L'auteur encourage également les lecteurs à se conformer à la loi. <br><br><h2>  Pas à la place, mais ensemble </h2><br>  Je voudrais tout de suite faire une réserve sur le fait qu'il ne s'agira pas de refuser ou de remplacer Threat Intelligence par des informations reçues de sources traditionnelles payantes et gratuites, mais de les compléter et de les enrichir. <br><br>  Ainsi, l'utilisation de méthodes TI supplémentaires peut augmenter son efficacité et aider à résoudre un certain nombre de problèmes.  Par exemple, avec la prochaine épidémie IoT affectant certaines versions vulnérables du firmware, combien de temps puis-je obtenir un flux avec les adresses IP des appareils potentiellement vulnérables afin de détecter rapidement leur activité sur le périmètre?  Ou lorsque les règles du système de surveillance sont déclenchées par un indicateur (adresse IP ou nom de domaine) qui a été marqué comme malveillant il y a un an ou plus, comment comprendre s'il reste malveillant, à condition que vous lanciez une vérification supplémentaire de l'indicateur comme «Pour l'instant» est généralement impossible. <br><br>  Autrement dit, l'ajout et l'enrichissement seront particulièrement utiles pour les indicateurs de mi-vie selon la «pyramide de la douleur» de David Bianco <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[0]</a> (adresses IP, noms de domaine, artefacts de réseau), cependant, dans certaines circonstances, il est possible d'obtenir de nouveaux indicateurs à longue durée de vie (en haut de la pyramide) les analystes. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/946/868/d57/946868d575b064e8f552c06fa0b8c363.png"><br><br><h2>  Analyse Internet </h2><br>  L'analyse des réseaux est l'une des méthodes utiles pour obtenir Threat Intelligence. <br><br><div class="spoiler">  <b class="spoiler_title">Ce qui est généralement collecté lors de la numérisation</b> <div class="spoiler_text">  Le plus souvent, lors d'une analyse, les résultats les plus intéressants sont obtenus en collectant ce que l'on appelle des «bannières» - les réponses du logiciel d'application du système numérisé aux demandes du scanner.  Les «bannières» contiennent de nombreuses données identifiant le logiciel d'application et ses différents paramètres de «l'autre côté», et une telle vérification se fait assez rapidement. </div></div><br>  Lorsque vous résolvez la tâche d'élargir la portée de Threat Intelligence, l'analyse ciblera l'intégralité d'Internet.  Lors de l'analyse d'un espace d'adressage public (~ 3,7 milliards d'adresses IPv4, à l'exclusion des adresses réservées), vous pouvez extraire les informations utiles suivantes: <br><br><ul><li>  Quels nœuds sont vulnérables à des vulnérabilités largement exploitées dans le cadre de campagnes malveillantes réelles et, de ce fait, sont des sources potentielles d'exposition malveillante. </li><li>  Quels nœuds sont les serveurs de contrôle des réseaux de botnet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[1]</a> , dont les accès peuvent être identifiés par un nœud compromis dans le périmètre protégé. </li><li>  Quels nœuds appartiennent à la partie non publique des réseaux anonymes distribués, qui peuvent être utilisés pour sortir discrètement et sans contrôle en dehors du périmètre protégé. </li><li>  Informations plus détaillées sur les nœuds «éclairés» dans le fonctionnement du système de surveillance. </li></ul><br><h2>  Sélection d'outils </h2><br>  Au fil des années de développement des réseaux d'information, un grand nombre d'outils de numérisation réseau ont été créés.  Parmi les logiciels actuels, on peut distinguer les scanners suivants: <br><br><ul><li>  Nmap <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[2]</a> </li><li>  Zmap <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[3]</a> </li><li>  Masscan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[4]</a> </li></ul><br>  Examinez brièvement les principaux avantages et inconvénients de ces outils pour l'enrichissement des TI dans l'espace Internet. <br><br><h4>  Nmap </h4><br>  Peut-être le scanner de réseau le plus célèbre, créé il y a 20 ans.  En raison de la possibilité d'utiliser des scripts personnalisés (via le moteur de script Nmap), il s'agit d'un outil extrêmement flexible, qui ne se limite pas à la simple collecte de «bannières» appliquées.  À l'heure actuelle, un assez grand nombre de scripts NSE ont été écrits, dont beaucoup sont disponibles gratuitement.  Étant donné que Nmap surveille chaque connexion, en d'autres termes, elle a un caractère synchrone, cela ne vaut pas la peine de l'utiliser pour de grands réseaux tels qu'Internet en raison de la faible vitesse du scanner.  Dans le même temps, il est conseillé d'utiliser cet outil sur de petits échantillons d'adresses obtenus par des outils plus rapides, en raison de la puissance de NSE. <br><br><div class="spoiler">  <b class="spoiler_title">À propos de Nmap Speed</b> <div class="spoiler_text">  Malgré la productivité initialement faible, depuis la sortie de ce scanner, ses développeurs ont ajouté de nombreuses fonctionnalités qui augmentent la vitesse de numérisation.  Parmi eux, les modes de fonctionnement parallèles et la tâche de débit en paquets par seconde.  Cependant, même avec des paramètres tordus, Nmap est en retard sur ses concurrents asynchrones en termes de vitesse.  En utilisant l'exemple de la numérisation / 15 sous-réseaux sur un port 443 / tcp à partir d'une machine virtuelle avec 1 CPU Xeon Gold 6140 et un canal gigabit, nous obtenons: <br><br><ul><li> 71,08 secondes pour Nmap avec les paramètres <code>-T5 -n -Pn -p 443 --open --min-rate 1000000 --randomize-hosts --defeat-rst-ratelimit –oG nmap.txt</code> </li><li>  9,15 secondes pour Zmap avec les paramètres <code>-p 443 –o zmap.txt</code> </li></ul><br></div></div><br><h4>  Zmap </h4><br>  Un scanner de réseau asynchrone assez connu, mais pas le premier du genre, apparu en 2013.  Selon un rapport de développeurs publié lors de la 22e conférence USENIX Security Simposium <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[5]</a> , l'outil est en mesure d'analyser l'intégralité de la plage d'adresses publiques, exécutée sur un ordinateur moyen avec une connexion Internet gigabit, en moins de 45 minutes (via un port).  Les avantages de Zmap comprennent: <br><br><ul><li>  Haute vitesse;  en utilisant le cadre PF_RING et une connexion de 10 gigabits, le temps d'analyse théorique d'un espace d'adressage IPv4 public est de 5 minutes (un port). </li><li>  Prise en charge de l'analyse aléatoire des adresses réseau. </li><li>  Prise en charge du module pour les analyses TCP SYN, ICMP, les requêtes DNS, UPnP, BACNET <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[6]</a> , le sondage UDP. </li><li>  Présence dans les référentiels des distributions GNU / Linux courantes (en outre, il existe un support pour Mac OS et BSD). </li><li>  En plus de Zmap, un certain nombre de projets utilitaires associés ont été développés pour étendre les fonctionnalités du scanner. </li></ul><br>  Si nous parlons des inconvénients de Zmap, nous pouvons noter ici la possibilité de scanner des adresses sur un seul port pour le moment. <br><br>  Parmi les projets liés à Zmap, étendant ses fonctionnalités pour les tâches d'intérêt, on peut distinguer les suivants: <br><br><ul><li>  ZGrab est un scanner de protocole d'application avec prise en charge des protocoles TTP, HTTPS, SSH, Telnet, FTP, SMTP, POP3, IMAP, Modbus, BACNET, Siemens S7 et Tridium Fox (grabber de bannière avec des fonctionnalités avancées). </li><li>  ZDNS est un utilitaire pour les requêtes DNS rapides. </li><li>  ZTag est un utilitaire de balisage des résultats d'analyse fourni par ZGrab. </li><li>  ZBrowse est un utilitaire de distribution sans tête basé sur Chrome pour suivre les modifications du contenu du site Web. </li></ul><br><div class="spoiler">  <b class="spoiler_title">À propos des fonctionnalités de ZGrab</b> <div class="spoiler_text">  Le scanner avancé des protocoles d'application ZGrab, pour lequel la version 2.0 a déjà été publiée (il n'y a pas de parité fonctionnelle complète avec la version 1.X, mais elle sera réalisée dans un proche avenir, après quoi il sera possible de parler du remplacement complet de l'ancienne version par une nouvelle), qui vous permet de filtrer les résultats de manière assez flexible numérisation grâce à la prise en charge du format de sortie structuré (JSON).  Par exemple, pour collecter uniquement l'émetteur du nom distinctif et le sujet des certificats HTTPS, une simple commande suffit: <br><br><pre> <code class="hljs powershell">zmap -<span class="hljs-literal"><span class="hljs-literal">-target</span></span><span class="hljs-literal"><span class="hljs-literal">-port</span></span>=<span class="hljs-number"><span class="hljs-number">443</span></span> -<span class="hljs-literal"><span class="hljs-literal">-output</span></span><span class="hljs-literal"><span class="hljs-literal">-fields</span></span>=saddr | ./zgrab2 tls <span class="hljs-literal"><span class="hljs-literal">-o</span></span> - | jq <span class="hljs-string"><span class="hljs-string">'.ip + "|" + .data.tls.result.handshake_log.server_certificates.certificate.parsed.issuer_dn + "|" + .data.tls.result.handshake_log.server_certificates.certificate.parsed.subject_dn'</span></span> &gt; zmap<span class="hljs-literal"><span class="hljs-literal">-dn</span></span><span class="hljs-literal"><span class="hljs-literal">-443</span></span>.txt</code> </pre> <br></div></div><br><h4>  Masscan </h4><br>  Le scanner asynchrone, créé la même année que Zmap, est similaire en syntaxe de commande à Nmap. <br><br>  Le créateur (Robert David Graham) a déclaré une productivité plus élevée que tous les scanners asynchrones qui existaient à l'époque, y compris Zmap, grâce à l'utilisation d'une pile TCP / IP personnalisée. <br><br>  Avantages du scanner: <br><br><ul><li>  Haute vitesse avec des performances théoriques allant jusqu'à 10 millions de paquets par seconde, ce qui vous permet de scanner tout l'espace public IPv4 en quelques minutes (sur un port) sur une connexion de 10 gigabits - la même chose que dans Zmap en utilisant le cadre PF_RING. </li><li>  Prise en charge des protocoles TCP, SCTP et UDP (via l'envoi de charges utiles UDP depuis Nmap). </li><li>  Prise en charge de l'analyse aléatoire des adresses réseau. </li><li>  Prise en charge de la sélection de la plage IP et de la plage de ports lors de la numérisation. </li><li>  Prise en charge de différents formats pour la sortie des résultats d'analyse (XML, grepable, JSON, binaire, sous forme de liste). </li></ul><br>  Dans le même temps, le scanner présente plusieurs inconvénients: <br><br><ul><li>  Dans le cadre de l'utilisation d'une pile TCP / IP personnalisée, il est recommandé d'exécuter une analyse sur une IP dédiée pour éviter les conflits avec la pile du système d'exploitation. </li><li>  Par rapport à ZGrab, les possibilités de capture de bannière sont plutôt limitées. </li></ul><br><h4>  Tableau de comparaison du scanner </h4><br>  Le tableau récapitulatif ci-dessous fournit une comparaison des fonctionnalités de ces scanners. <br><br><div class="spoiler">  <b class="spoiler_title">Valeurs dans les lignes du tableau</b> <div class="spoiler_text">  "++" - très bien implémenté <br>  "+" - implémenté <br>  "±" - implémenté avec restrictions <br>  "-" - non implémenté </div></div><br><img src="https://habrastorage.org/getpro/habr/post_images/253/a0d/74e/253a0d74ef6cf82937472729a65f1cd0.png"><br><br><h2>  Sélection des cibles et de la méthode de scan </h2><br>  Après avoir choisi les outils à utiliser, vous devez décider de l'objet et du but de l'analyse, c'est-à-dire comprendre quoi et pourquoi analyser.  Si le premier, en règle générale, aucune question ne se pose (il s'agit d'un espace d'adressage IPv4 public avec un certain nombre d'exceptions), alors avec le second, tout dépend du résultat final souhaité.  Par exemple: <br><br><ul><li>  Pour identifier les nœuds qui sont soumis à une vulnérabilité particulière, il est raisonnable de parcourir d'abord la plage analysée avec un outil rapide (Zmap, Masscan) pour identifier les nœuds avec des ports ouverts de services vulnérables;  après avoir finalisé la liste des adresses, il vaut la peine d'utiliser Nmap avec le script NSE correspondant, s'il en existe un, ou de créer un script personnalisé basé sur les informations disponibles sur la vulnérabilité dans les publications des chercheurs en sécurité.  Parfois, un simple grep suffit pour les bannières d'application collectées, car de nombreux services affichent des informations sur leur version. </li><li>  Pour identifier les nœuds de l'infrastructure cachée - à la fois les réseaux anonymes et les nœuds C2 (c'est-à-dire les serveurs de contrôle des réseaux de botnet) - il sera nécessaire de compiler des charges utiles / sondes personnalisées. </li><li>  Pour résoudre un large éventail de problèmes dans l'identification des nœuds compromis, des parties de l'infrastructure des réseaux anonymes et d'autres choses, la collecte et l'analyse des certificats peuvent donner beaucoup lors des prises de contact TLS. </li></ul><br><h2>  Choix d'infrastructure </h2><br>  Le fait que les scanners rapides modernes puissent afficher des résultats impressionnants sur des ressources plutôt modestes du processeur moyen ne signifie pas que la charge sur l'infrastructure réseau sera insignifiante.  En raison des spécificités du trafic généré lors de l'analyse, un taux suffisamment important de paquets par seconde est obtenu.  Selon l'expérience, un cœur du processeur moyen (sur un processeur de production de ces dernières années, dans un environnement virtuel, sous n'importe quel système d'exploitation, sans aucun réglage de la pile TCP / IP) est capable de générer un flux de l'ordre de 100 à 150 000 paquets par seconde et par voie de ~ 50 Mb / s , ce qui représente une lourde charge pour les routeurs logiciels.  L'équipement réseau matériel peut également rencontrer des problèmes pour atteindre la limite de performances ASIC.  Dans le même temps, à une vitesse de numérisation de 100 à 150 Kpps (milliers de paquets par seconde), le contournement de la plage IPv4 publique peut prendre plus de 10 heures, c'est-à-dire  un temps assez important.  Pour une analyse très rapide, vous devez utiliser un réseau distribué de nœuds d'analyse qui divise le pool analysé en parties.  Un ordre de balayage aléatoire est également nécessaire pour que l'utilisation des canaux Internet et le chargement par lots des équipements des fournisseurs au «dernier kilomètre» ne soient pas significatifs. <br><br><h2>  Difficultés et moments «subtils» </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/a07/061/a45/a07061a458b372bd5bddbec15b9fb7a5.jpg"><br><br>  En pratique, lors de la réalisation d'analyses de réseau de masse, on peut rencontrer un certain nombre de difficultés, à la fois de nature technologique et organisationnelle. <br><br><h4>  Problèmes de performances et de disponibilité </h4><br>  Comme mentionné précédemment, l'analyse de réseau de masse crée un flux de trafic avec une valeur PPS élevée, provoquant une charge importante à la fois sur l'infrastructure locale et sur le réseau fournisseur auquel les nœuds d'analyse sont connectés.  Avant d'effectuer des analyses à des fins de recherche, il est impératif de coordonner toutes les actions avec les administrateurs locaux et les représentants du fournisseur.  D'un autre côté, des problèmes de performances peuvent survenir sur les nœuds d'analyse finaux lors de la location de serveurs virtuels sur des services d'hébergement Internet. <br><br><div class="spoiler">  <b class="spoiler_title">Tous les VPS ne sont pas également utiles.</b> <div class="spoiler_text">  Sur les VPS loués à des hébergeurs non traditionnels, on peut rencontrer une situation où sur des machines virtuelles productives (plusieurs vCPU et quelques gigaoctets de mémoire), les taux de paquets Zmap et Masscan ne dépassent pas quelques dizaines de Kpp.  Le plus souvent, la combinaison de matériel obsolète et d'une combinaison non optimale de logiciels d'environnement virtuel joue un rôle négatif.  D'une manière ou d'une autre, selon l'expérience de l'auteur, des garanties de performance plus ou moins substantielles ne peuvent être obtenues que des entreprises - leaders du marché. </div></div><br>  De plus, lors de l'identification des nœuds vulnérables, il convient de considérer que certains contrôles NSE peuvent entraîner un déni de service sur les nœuds analysés.  Une telle évolution de la situation n'est pas simplement non éthique, mais elle se situe définitivement en dehors du champ juridique et entraîne le déclenchement de conséquences sous la forme d'une responsabilité pénale. <br><br><h4>  Que recherchons-nous et comment? </h4><br>  Pour trouver quelque chose, vous devez savoir comment chercher quelque chose.  Les menaces évoluent constamment et une nouvelle étude analytique est constamment nécessaire pour les identifier.  Parfois, les analyses publiées dans les documents de recherche deviennent obsolètes, les incitant à mener leurs propres recherches. <br><br><div class="spoiler">  <b class="spoiler_title">Un exemple célèbre</b> <div class="spoiler_text">  À titre d'exemple, nous pouvons prendre une étude <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[5] de</a> 2013 par les auteurs de Zmap, consacrée à l'identification des nœuds d'un réseau TOR.  Au moment de la publication du document, en analysant la chaîne de certificats et en identifiant le nom du sujet spécialement généré dans les certificats auto-signés, ~ 67 mille nœuds TOR travaillant sur le port tcp / 443 et ~ 2,9 mille nœuds travaillant sur tcp / 9001 ont été trouvés.  Actuellement, la liste des nœuds TOR détectés par cette méthode est beaucoup plus petite (une plus grande variété de ports est utilisée, des transports obfs sont utilisés, la migration vers les certificats Let's Encrypt est effectuée), ce qui force l'utilisation d'autres méthodes analytiques pour résoudre un problème similaire. </div></div><br><h4>  Plaintes d'abus </h4><br>  Lors de l'analyse d'Internet, il y a presque 100% de risques de recevoir un flux de plaintes pour abus.  L'abus généré automatiquement pour une douzaine de paquets SYN est particulièrement ennuyeux.  Et si les analyses sont répétées régulièrement, des réclamations créées manuellement peuvent également circuler. <br><br><div class="spoiler">  <b class="spoiler_title">Qui se plaint le plus souvent</b> <div class="spoiler_text">  Les principales sources d'abus (principalement automatiques) sont les établissements d'enseignement dans la zone du domaine * .edu.  Par expérience, vous devez surtout éviter de scanner les adresses des ASN appartenant à l'Indiana University (USA).  Également dans les présentations de Zmap <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[5]</a> et Masscan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[7],</a> on peut trouver quelques exemples intéressants de réponse inadéquate à l'analyse du réseau. </div></div><br>  Ne prenez pas cet abus à la légère, car: <br><br><ul><li>  En cas de réclamation, l'hébergeur bloque le plus souvent le trafic vers ou depuis les machines virtuelles louées ou suspend même leur fonctionnement. </li><li>  Un FAI peut désactiver la liaison montante afin d'éliminer les risques de blocage du système autonome. </li></ul><br>  La meilleure pratique pour minimiser les plaintes est de: <br><br><ol><li>  Connaissance des conditions d'utilisation de votre fournisseur d'accès Internet / d'hébergement. </li><li>  Créer une page d'informations sur les adresses des sources de scan expliquant le but du scan;  apporter les clarifications appropriées dans les enregistrements DNS TXT. </li><li>  Clarification des scans lors de la réception de plaintes d'abus. </li><li>  Tenir à jour une liste d'exclusions de l'analyse, ajouter à l'exclusion des sous-réseaux qui s'appliquent à la première demande, fournir des clarifications sur la procédure pour faire des exclusions sur la page d'informations. </li><li>  La numérisation n'est plus et pas plus souvent que nécessaire pour résoudre la tâche. </li><li>  Répartition du trafic de numérisation par source, adresses de destination, ainsi que l'heure à laquelle cela est possible. </li></ol><br><h2>  Externalisation de l'analyse réseau </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0ad/0fe/7bd/0ad0fe7bdfc413fb9e6326362bed1d9d.jpg" width="500"></div><br>  La réalisation d'analyses de masse indépendantes nécessite une approche équilibrée (les risques sont décrits ci-dessus), tout en sachant que si le traitement analytique des résultats d'analyse utilisé n'est pas suffisamment approfondi, le résultat final peut être insatisfaisant.  Au moins en termes techniques, vous pouvez faciliter la tâche en utilisant des outils commerciaux existants, tels que: <br><br><ul><li>  Shodan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[8]</a> </li><li>  Censys <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[9]</a> </li><li>  ZoomEye <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[10]</a> </li></ul><br><div class="spoiler">  <b class="spoiler_title">Plus de services</b> <div class="spoiler_text">  En plus des services mentionnés, il existe un nombre assez important de projets, d'une manière ou d'une autre, liés à l'analyse du réseau mondial.  Par exemple: <br><br><ul><li>  Punk.sh (anciennement moteur de recherche Web PunkSPIDER) </li><li>  Project Sonar (ensemble de données avec les résultats des analyses de réseau de Rapid7) </li><li>  Thingful (un autre moteur de recherche IoT) </li></ul></div></div><br><h2>  Shodan </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/ce6/877/d6b/ce6877d6b6b39cb0639d148a7992e46e.jpg"><br><br>  Le premier et le plus célèbre moteur de recherche de services publiés sur Internet, créé à l'origine comme moteur de recherche IoT et lancé en 2009 par John Materley <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[11]</a> .  Actuellement, le moteur de recherche offre plusieurs niveaux d'accès aux informations en lui-même.  Sans inscription, les possibilités sont très basiques, lors de l'inscription et de l'achat d'un abonnement, les fonctionnalités suivantes deviennent disponibles: <br><br><ul><li>  Recherche par filtres de base. </li><li>  Publication d'informations détaillées sur les nœuds («données brutes»). </li><li>  Une API "basique" avec la possibilité de s'intégrer avec des utilitaires courants tels que Maltego, Metasploit, Nmap et autres. </li><li>  La possibilité d'exporter les résultats de la recherche (moyennant des frais, pour les "Crédits" - la devise interne du service). </li><li>  La possibilité de numériser sur demande des adresses individuelles et des plages (moyennant des frais, pour les «crédits»). </li></ul><br>  Les fonctionnalités mentionnées sont déjà suffisantes pour l'OSINT de base <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[12]</a> , cependant, le moteur de recherche révèle pleinement ses capacités avec un abonnement Entreprise, à savoir: <br><br><ul><li>  Analyse à la demande de l'ensemble de la plage IPv4 publique d'Internet, y compris la vérification de la plage de ports spécifiée et la spécification de collecteurs de bannières spécifiques au protocole. </li><li>  Notifications en temps réel basées sur les résultats des analyses en cours. </li><li>  La possibilité de télécharger des résultats d'analyse bruts pour une analyse plus approfondie (aucune restriction, la base de données entière est disponible). </li><li>  La possibilité de développer des collecteurs personnalisés pour des tâches spécifiques (protocoles non standard, etc.). </li><li>  Accès aux résultats de l'analyse historique (jusqu'en octobre 2015). </li></ul><br>  Le projet Shodan a créé un certain nombre de projets connexes, tels que la recherche de logiciels malveillants, l'analyse des pots de miel, les exploits, l'enrichissement des résultats de l'analyse. <br><br><h2>  Censys </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/29b/24e/4ef/29b24e4efeb65eb7c9d22fee64baa3e8.jpg"><br><br>  Moteur de recherche sur l'IoT et pas seulement, créé par l'auteur de Zmap Zakir Durumerik et présenté publiquement en 2015.  Le moteur de recherche utilise la technologie Zmap et un certain nombre de projets connexes (ZGrab et ZTag).  Sans inscription, contrairement à Shodan, le moteur de recherche est limité à 5 requêtes par jour à partir d'une IP.  Après l'enregistrement, les possibilités d'utilisation sont élargies: une API apparaît, les résultats de recherche de demandes sont augmentés (jusqu'à 1000 résultats), cependant, l'accès le plus complet, y compris le téléchargement de données historiques, n'est disponible que sur le plan Entreprise. <br><br>  Les avantages du moteur de recherche par rapport à Shodan incluent les fonctionnalités suivantes: <br><br><ul><li>  Il n'y a aucune restriction sur les filtres de recherche sur les plans tarifaires de base. </li><li>  Grande vitesse de mise à jour des résultats de la numérisation automatique (quotidiennement, selon les auteurs; la vitesse de Shodan est beaucoup plus faible). </li></ul><br>  Les inconvénients comprennent: <br><br><ul><li>  Moins de ports scannés par rapport à Shodan. </li><li>  Impossibilité de numériser «à la demande» (à la fois par plages IP et par ports). </li><li>  Moins d'enrichissement des résultats avec des outils prêts à l'emploi (ce qui est évident étant donné le plus grand nombre d'outils Shodan mis en œuvre dans le cadre de projets connexes). </li></ul><br>  Si les résultats collectés sur la gamme de ports prise en charge par Censys sont suffisants pour atteindre cet objectif, le manque de capacité à analyser à la demande ne devrait pas être un obstacle sérieux en raison de la vitesse élevée de mise à jour des résultats d'analyse. <br><br><h2>  Zoomeye </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/b0a/9c4/46b/b0a9c446b5585b1256f1f707c2bdd40a.jpg"><br><br>  Un moteur de recherche IoT créé par la société chinoise de sécurité de l'information Knowsec Inc en 2013.  Aujourd'hui, le moteur de recherche utilise ses propres développements - Xmap (scanner hôte) et Wmap (scanner web).  Le moteur de recherche recueille des informations sur une gamme assez large de ports, lors de la recherche, il est possible de classer selon un grand nombre de critères (ports, services, OS, applications) avec des détails pour chaque hôte (le contenu des bannières d'application).  Les résultats de la recherche répertorient les vulnérabilités possibles pour le logiciel d'application identifié du projet SeeBug associé (sans vérifier l'applicabilité).  Pour les comptes enregistrés, une API et une recherche Web sont également disponibles avec un ensemble complet de filtres, mais avec une limitation du nombre de résultats affichés.  Pour supprimer les restrictions, il est proposé d'acheter un plan d'entreprise.  Parmi les avantages d'un moteur de recherche, on peut noter: <br><br><ul><li>  Un grand nombre de ports scannés (approximativement similaires à Shodan). </li><li>  Prise en charge Web étendue. </li><li>  Identifiant de l'application et du système d'exploitation. </li></ul><br>  Parmi les inconvénients: <br><br><ul><li>  Intervalle de mise à jour lent pour les résultats de l'analyse. </li><li>  Impossibilité de numériser à la demande. </li><li>  L'enrichissement des résultats de l'analyse se limite à l'identification des services, des logiciels d'application, du système d'exploitation et des vulnérabilités potentielles. </li></ul><br><h4>  Tableau de comparaison des services </h4><br>  Le tableau récapitulatif ci-dessous fournit une comparaison des fonctionnalités des services considérés. <br><br><div class="spoiler">  <b class="spoiler_title">Valeurs dans les lignes du tableau</b> <div class="spoiler_text">  "++" - très bien implémenté <br>  "+" - implémenté <br>  "±" - implémenté avec restrictions <br>  "-" - non implémenté </div></div><br><img src="https://habrastorage.org/getpro/habr/post_images/1fd/028/d58/1fd028d5843b449c8820b81d3f5d620f.png"><br><br><h2>  Scannez-vous </h2><br>  Votre propre infrastructure peut également être une source utile de TI, vous pouvez donc comprendre quels nouveaux hôtes et services sont apparus sur le réseau, sont-ils vulnérables ou même malveillants?  Si des services externes peuvent être utilisés pour analyser le périmètre (par exemple, un tel cas d'utilisation est officiellement pris en charge par le cas d'utilisateur Shodan), alors toutes les actions à l'intérieur du périmètre ne peuvent être effectuées que de manière indépendante.  Dans ce cas, la gamme d'outils pour l'analyse de réseau peut être assez étendue: il s'agit à la fois d'analyseurs passifs, tels que Bro <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[13]</a> , Argus <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[14]</a> , Nfdump <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[15]</a> , p0f <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[16]</a> et des scanners actifs - Nmap, Zmap, Masscan et leurs concurrents commerciaux.  Le cadre IVRE <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[17]</a> , qui vous permet d'obtenir votre propre outil de type Shodan / Censys, peut aider à interpréter les résultats. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f32/ab2/cc3/f32ab2cc38acf9802402815b460574d0.jpg"><br><br>  Le cadre a été développé par un groupe de chercheurs en sécurité de l'information, l'un des auteurs est un développeur actif de l'utilitaire scapy <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[18]</a> Pierre Lalet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[19]</a> .  Parmi les caractéristiques du cadre, citons: <br><br><ul><li>  L'utilisation de l'analyse visuelle pour identifier les modèles et les anomalies anormales. </li><li>  Moteur de recherche avancé avec analyse détaillée des résultats de l'analyse. </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Intégration avec des utilitaires tiers via l'API avec prise en charge Python. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> IVRE est également bien adapté pour analyser de grandes analyses d'Internet. </font></font><br><br><h2>  Conclusions </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La numérisation et l'intelligence active des réseaux sont d'excellents outils qui ont longtemps été utilisés par divers chercheurs dans le domaine de la sécurité de l'information. </font><font style="vertical-align: inherit;">Cependant, pour les agents de sécurité "classiques", ces méthodes de travail sont encore nouvelles. </font><font style="vertical-align: inherit;">L'utilisation d'OSINT et de méthodes offensives en combinaison avec les moyens défensifs classiques renforcera considérablement la protection et assurera sa proactivité.</font></font><br><br><div class="spoiler">  <b class="spoiler_title">Les références</b> <div class="spoiler_text"> [0] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://detect-respond.blogspot.com/2013/03/the-pyramid-of-pain.html</a> <br> [1] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://malware-hunter.shodan.io/</a> <br> [2] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://nmap.org</a> <br> [3] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://zmap.io</a> <br> [4] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://github.com/robertdavidgraham/masscan</a> <br> [5] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://zmap.io/paper.pdf</a> <br> [6] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://en.wikipedia.org/wiki/BACnet</a> <br> [7] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://www.defcon.org/images/defcon-22/dc-22-presentations/Graham-McMillan-Tentler/DEFCON-22-Graham-McMillan-Tentler-Masscaning-the-Internet.pdf</a> <br> [8] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://shodan.io</a> <br> [9] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://censys.io</a> <br> [10] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://www.zoomeye.org</a> <br> [11] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://twitter.com/achillean</a> <br> [12] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://en.wikipedia.org/wiki/Open-source_intelligence</a> <br> [13] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://www.bro.org/</a> <br> [14] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">http://qosient.com/argus/</a> <br> [15] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">http://nfdump.sourceforge.net/</a> <br> [16] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">http://lcamtuf.coredump.cx/p0f/</a> <br> [17] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://github.com/cea-sec/ivre</a> <br> [18] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://scapy.net/</a> <br> [19] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://github.com/pl-</a> </div></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikhail Larin, expert au Center for Monitoring and Response to Information Security Incidents Jet CSIRT, Jet Infosystems.</font></font></i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr426025/">https://habr.com/ru/post/fr426025/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr426015/index.html">L'utilisation de drones civils sciés pour la photographie aérienne géodésique professionnelle de la région</a></li>
<li><a href="../fr426017/index.html">Comment réduire le nombre d'expériences sur des animaux</a></li>
<li><a href="../fr426019/index.html">Station météo sur Arduino de A à Z. Partie 5</a></li>
<li><a href="../fr426021/index.html">libgdx et sentiments</a></li>
<li><a href="../fr426023/index.html">Leçon ouverte "Laboratoire virtuel à Vagrant"</a></li>
<li><a href="../fr426027/index.html">Amazon Cloud Services et analyse de portefeuille d'investissement</a></li>
<li><a href="../fr426029/index.html">Vous abandonnez et souhaitez quitter la tâche? Voici à quoi ressemble une formation de développeur efficace</a></li>
<li><a href="../fr426031/index.html">S'inquiéter de capturer le monde avec l'intelligence artificielle peut être basé sur des hypothèses non scientifiques</a></li>
<li><a href="../fr426033/index.html">Les titans des maths s'affrontent sur la preuve épique de l'hypothèse abc</a></li>
<li><a href="../fr426039/index.html">Lancement d'urgence "Soyouz MS-10" (équipage sauvé, retransmis)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>