<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏿‍🔬 🏳️‍🌈 😂 Server Ad Exchange - Tidak Seperti Lainnya 👈 🍩 👨🏻‍🎨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ad Exchange sebagai bagian dari Penawaran Waktu Nyata (RTB) adalah salah satu solusi AdTech yang mengubah pasar periklanan online. Fungsi utamanya ada...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Server Ad Exchange - Tidak Seperti Lainnya</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/maxilect/blog/421471/">  Ad Exchange sebagai bagian dari Penawaran Waktu Nyata (RTB) adalah salah satu solusi AdTech yang mengubah pasar periklanan online.  Fungsi utamanya adalah untuk merapat sejumlah besar SSP dan DSP yang tidak memiliki integrasi langsung antara satu sama lain, serta menjual kembali berbagai lalu lintas iklan di antara mereka. <br><br>  Berkat pesanan untuk pasar AS, kami langsung terjun ke spesifik membangun platform Ad Exchange.  Dan dalam artikel ini kami menyajikan beberapa ide dan hasil. <br><br><img src="https://habrastorage.org/webt/ua/tj/gw/uatjgwrn-musoqo-_gchjt2fptc.jpeg" alt="gambar"><br><a name="habracut"></a><br><h2>  Pernyataan masalah </h2><br>  Penawaran Waktu Nyata (RTB) menyediakan penjualan ruang iklan di situs secara real time untuk menampilkan iklan yang relevan kepada audiens target. <br><br>  Singkatnya, diagram proses adalah sebagai berikut: <br><br><img src="https://habrastorage.org/webt/u4/e9/3w/u4e93wxmuauj4qskiyt0wt4gz-q.png" alt="gambar"><br><br><ul><li>  pengguna akhir meminta halaman web atau aplikasi seluler tempat tempat spanduk dicadangkan (kode untuk platform penjualan inventaris iklan sudah ada di dalamnya - SSP, Platform Sisi Pasokan); </li><li>  Untuk memastikan harga jual maksimum inventaris, SSP melalui Ad Exchange mengatur tender antara berbagai DSP (Platform Sisi Permintaan), yang tujuannya adalah untuk membeli inventaris semurah mungkin; </li><li>  setelah pengumuman pemenang lelang, DSP yang menang mengirimkan kode spanduk SSP, yang ditampilkan kepada pengguna; </li><li>  sisi lain dari proses ini adalah DMP, sistem pihak ketiga yang memberikan informasi terperinci kepada DSP tentang pengguna akhir (di luar apa yang dapat ditransmisikan oleh SSP dalam bentuk cookie, dll.) untuk membenarkan kelayakan pembelian dan biaya yang diusulkan. </li></ul><br>  Ada beberapa pertukaran Ad Exchange hari ini.  Selain itu, banyak SSP menerapkan penawaran mereka sendiri (sebenarnya menutup fungsionalitas Ad Exchange).  Tetapi pelanggan kami yakin bahwa karena beberapa ide baru, ia dapat dengan cepat memasuki pasar dan menahan persaingan. <br><br>  Pertukaran bekerja pada prinsip-prinsip yang berbeda: seseorang menawarkan margin yang lebih besar, seseorang lebih sedikit, seseorang menjual peralatan unik, yang lain fokus pada barang konsumen bersyarat.  Pasar cukup muda dan aktif berkembang, oleh karena itu tidak ada model bisnis yang diuji selama bertahun-tahun di sini: semuanya dibangun di atas hipotesis dan eksperimen yang berani.  Sebagian besar pemain bekerja sesuai dengan skema sederhana: mereka menerima permintaan dari salah satu dari beberapa SSP yang dapat mereka setujui, dan mengirimkannya ke semua DSP terintegrasi untuk mengantisipasi taruhan yang lebih baik.  Pendapatan Ad Exchange - Perbedaan antara harga pembelian dan penjualan inventaris iklan pada SSP dan DSP dikurangi biaya operasi. <br><br>  Klien kami menyarankan untuk mengoptimalkan skema ini dengan mendistribusikan permintaan SSP dengan benar ke DSP - tidak dengan sengaja mengirim permintaan "kehilangan", sehingga mengurangi biaya operasi.  Karena ini, Anda dapat mengurangi komisi pertukaran tanpa kehilangan pendapatan, dan membuat penawaran Anda lebih menarik dengan latar belakang Ad Exchange yang bersaing dalam perjuangan untuk SSP dan DSP.  Dan menghubungkan lebih banyak mitra akan memberikan pemasukan dan stabilitas di pasar. <br><br>  Untuk menerapkan strategi ini di pasar AS, kami ditugaskan untuk membuat Ad Exchange dengan distribusi permintaan yang cerdas, yaitu memberikan persentase pembelian kembali yang baik.  Secara teori, untuk distribusi seperti itu, Anda dapat menggunakan banyak informasi yang menyertai permintaan, bahkan data dari sistem pihak ketiga yang disebutkan di atas (DMP).  Namun, analitik yang kompleks membutuhkan sumber daya, sehingga tugas sebenarnya adalah menemukan keseimbangan antara biaya distribusi cerdas dan keuntungan (dibandingkan dengan pemain pasar lainnya) dari implementasinya.  Dalam pasar yang belum matang yang relatif baru, membangun solusi yang sangat kompleks, meremas kesepuluh optimasi, sama sekali tidak masuk akal. <br><br>  Fitur penting dari proyek, selain beban tinggi yang diharapkan, adalah pemenuhan persyaratan non-fungsional untuk kecepatan lelang yang dilakukan oleh SSP.  Kecukupan dalam segmen pasar ini adalah batas waktu untuk menunggu tanggapan dari SSP hingga 300 ms, yang harus dipenuhi bersamaan dengan panggilan ke sistem eksternal (DSP). <br><br>  Proyek ini dimulai pada musim gugur 2016.  Berkat pengalaman tim di bidang ini, setelah tiga bulan kami membuat prototipe pertama, dan setelah tiga MVP (Produk Minimum yang Layak) siap, yang memungkinkan kami mengumpulkan analitik pertama untuk memulai distribusi cerdas permintaan di Ad Exchange. <br><br>  Peluncuran MVP menunjukkan bahwa hipotesis tentang keberhasilan komersial proyek sudah benar - Ad Exchange mulai menghasilkan uang untuk klien.  Rencana pengembangan awal untuk Ad Exchange mencakup studi yang lebih mendalam tentang data - yang menghubungkan informasi pengguna akhir dari sistem eksternal ke analitik.  Tetapi pada tahap MVP, diputuskan untuk hanya menggunakan data yang dimiliki SSP.  Ini cukup untuk menghasilkan keuntungan yang diharapkan. <br><br><h2>  Arsitektur Solusi </h2><br>  Solusi ini dibangun di atas rantai Chain of responsibility, yang memungkinkan untuk tidak memperbaiki rute permintaan dalam sistem, dengan mudah menambahkan prosesor dan berbagai layanan, dari pelelangan itu sendiri hingga alat penyaringan. <br><br><img src="https://habrastorage.org/webt/oo/kd/gk/ookdgk5zkuz2ryzrq7xahistsno.jpeg" alt="gambar"><br><br>  Pelanggan tidak membatasi kami dalam tumpukan teknologi yang digunakan.  Oleh karena itu, dengan memperhatikan perkembangan masa depan dan dukungan proyek, kami membangun solusi yang dapat diskalakan secara horizontal menggunakan Postgres dan Hadoop. <br><br>  Ad Exchange sendiri ditulis dalam Java - pada saat yang sama, kami tidak menggunakan kerangka kerja apa pun agar tidak merosot di beban (kami bekerja di level rendah). <br>  Untuk tetap berada dalam batas waktu SSP yang disebutkan, kami memilih parameter pengumpul sampah (G1 digunakan) dan mengerjakan pekerjaan sinkron dengan sejumlah besar permintaan - kami menggunakan klien HTTP yang tidak memblokir aliran, serta perpanjangan protokol HTTP keep-live yang memungkinkan pengiriman beberapa permintaan dalam satu koneksi TCP. <br><br>  Komponen perangkat lunak digunakan pada perangkat keras yang disewa dari host, sebagai  kondisi tugas tidak memungkinkan penggunaan cloud karena sumber daya mesin virtual cloud yang tumpang tindih (alokasi sumber daya yang diperlukan mungkin memerlukan waktu, tetapi kami tidak memilikinya).  Saat ini, Ad Exchange menggunakan empat server fisik, salah satunya adalah redundan (untuk pembaruan yang lancar, dll.). <br><br>  Sumber terbuka Apache Kafka digunakan sebagai perantara pesan - idealnya diintegrasikan ke dalam model "satu pelanggan - banyak penerbit" kami, meskipun harus sedikit diputar sehingga pesan yang diulang tidak sampai. <br><br>  Setiap server menyediakan dalam mode normal yang memproses sekitar 10 ribu permintaan per detik (parameter ini ditetapkan selama pengembangan solusi).  Sekarang beban rata-rata adalah 15-20 ribu permintaan per detik, dan pada puncaknya aliran permintaan mencapai 40 ribu per detik selama beberapa jam, dan Ad Exchange melakukan pekerjaan yang baik untuk ini. <br><br>  Distribusi permintaan antar server dilakukan oleh load balancer perangkat lunak nginx, yang dikonfigurasi untuk tugas kami.  Dalam pengalaman kami, pada nginx Anda dapat menyimpan hingga 60-70 ribu permintaan per detik, tanpa mengalokasikan penyeimbang perangkat keras terpisah.  Jika di masa depan beban di Ad Exchange akan di atas ambang ini, kami berencana untuk membeli penyeimbang perangkat keras yang akan mendistribusikan permintaan antara beberapa jenis nginx yang sama. <br><br>  Ia memantau apa yang terjadi, yang tunduk pada peningkatan beban yang konstan, sistem pemantauan, yang merupakan bagian dari Ad Exchange yang dibuat. <br><br><h2>  Penyimpanan </h2><br>  Mengingat ketergantungan pada analitik selama distribusi kueri, basis data merupakan bagian integral dari Ad Exchange kami.  Sistem menyimpan informasi tentang tawaran, peserta lelang, dan transaksi. <br><br>  Tidak masuk akal untuk mengumpulkan volume data seperti itu untuk seluruh periode Ad Exchange, sehingga penyimpanan memiliki arsitektur multi-level.  Semua data lelang disimpan per minggu.  Berdasarkan mereka, unit tingkat menengah yang lebih tinggi dibangun, yang disimpan selama beberapa bulan.  Dan atas dasar yang menengah, agregat akhir digunakan, yang digunakan dalam analitik jangka panjang dan untuk rekonsiliasi dengan SSP dan DSP.  Di antara informasi lain di unit-unit ini ada data tentang berapa banyak taruhan yang telah dibuat dan berapa banyak uang yang akan dibayarkan pertukaran oleh SSP atau yang diharapkan akan diterima dari DSP. <br>  Titik akhir disimpan selama seluruh durasi Ad Exchange. <br><br>  Pengumpulan analitik dan pembentukan agregat menyediakan layanan terpisah. <br><br>  Agar penyimpanan sesuai dengan kecepatan sistem itu sendiri, saya juga harus bekerja dengannya.  Khususnya, untuk beberapa waktu kami berkelahi dengan hoster, karena  data transaksi sama sekali tidak punya waktu untuk menulis ke database.  Ternyata kesalahannya adalah masalah perangkat keras dengan array RAID.  Setelah menggantinya, kami dapat memeras 90.000 permintaan per detik pada Postgres (dengan memasukkan data ke dalam basis data). <br><br>  Ad Exchange lainnya tidak memiliki kewarganegaraan, yang memberikan penskalaan horizontal yang mudah di masa mendatang.  Itu tidak menyimpan data apa pun berdasarkan permintaan - informasi maksimum yang diterima tentang DSP mana yang harus dipilih.  Sehingga kami dapat menambahkan server baru untuk memproses permintaan sesuai kebutuhan. <br><br><h2>  Pemfilteran lalu lintas </h2><br>  Elemen kunci dari sistem yang memungkinkan Anda untuk mengurangi beban dan mempertahankan batas waktu yang ditunjukkan oleh pelanggan adalah pemfilteran lalu lintas. <br><br>  Menurut tugas yang dihadapi, Ad Exchange apa saja: <br><ul><li>  menerima permintaan dari SSP; </li><li>  mengadakan lelang (mengirimkan permintaan ke beberapa DSP, membandingkan harga yang ditawarkan, mengidentifikasi pemenang); </li><li>  setuju dengan kemenangan SSP (melaporkan harga pemenang dikurangi komisinya, menunggu tanggapan dengan harga akhir pertunjukan); </li><li>  menyelesaikan transaksi (melaporkan ke DSP yang diperlukan tentang kemenangannya, melakukan lalu lintas pengguna). </li></ul><br>  Distribusi permintaan pintar di Ad Exchange kami termasuk pada tahap awal lelang. <br><br>  Ketika kami menerima permintaan dari SSP dengan informasi tertentu (IP, agen pengguna), kami merincinya menggunakan informasi yang terakumulasi dalam informasi pengguna yang diketahui sistem, daftar DSP yang dikirimi permintaan serupa, responsnya, dll.  Ini diperlukan untuk memilih kombinasi DSP yang paling menguntungkan untuk setiap permintaan.  Berkat pemilihan kombinasi seperti itu, sistem ini memungkinkan Anda untuk tidak mengirim permintaan ke DSP yang tidak menawar atau melakukan, tetapi terlalu rendah.  Untuk melakukan ini, layanan terpisah dalam waktu nyata mengumpulkan peta tentang bagaimana DSP menanggapi permintaan (kartu-kartu ini disimpan di Redis). <br><br>  Secara paralel, kami memeriksa status DSP - jika proporsi respons dalam batas waktu turun, sistem secara otomatis mengurangi jumlah permintaan ke DSP ini.  Segera setelah beban pada DSP berkurang (dan proporsi jawaban yang benar dalam waktu yang dapat diterima bertambah), jumlah permintaan secara bertahap kembali ke tingkat sebelumnya. <br><br>  Di antara DSP yang menjawab tepat waktu, kami mengadakan lelang internal - pilih penawaran terbaik dan kirimkan ke SSP.  Dari saat permintaan dari SSP hingga tanggapan kami, tidak lebih dari 300 ms berlalu, sesuai dengan persyaratan industri. <br><br>  Karena kami mengirim data ke SSP, tempat lelang kami diadakan, kami perlu mempertimbangkan tawaran yang dimenangkan di sana.  Server lelang terlibat dalam pendataannya pada tahap berikutnya, saat memproses lalu lintas pengguna.  Berkat dia, peta respons DSP diperkaya dengan data baru (bersama dengan informasi yang dikumpulkan tentang pengguna akhir). <br><br>  Perbandingan data yang diperoleh pada tahap lelang dan parameter yang diketahui dari lalu lintas pengguna memungkinkan kami untuk memfilter bot (klik iklan, bot pencarian, dll.).  Lalu lintas semacam itu tidak ditebus oleh DSP, dan jika tidak ada sistem penyaringannya sendiri, itu berubah menjadi kerugian klien, yang harus ditutup dengan margin. <br><br>  Perlu dicatat bahwa penyaringan lalu lintas bot tidak segera dimulai.  Tapi setelah dimasukkannya kunci sederhana, kenaikan margin sekitar 50%. <br><br>  Omong-omong, selain alat pemfilteran lalu lintas otomatis dalam sistem kami, adalah mungkin bagi pelanggan untuk secara manual mengubah nilai ambang batas sejumlah parameter, sehingga menyesuaikan margin. <br><br>  Lalu lintas pengguna itu sendiri sangat penting bagi kami, tetapi ketika diproses, tidak perlu lagi masuk ke dalam 300 ms.  Ini menggunakan sistem pemrosesan yang terpisah, yang bisa menahan pengguna sedikit, tetapi tidak akan membiarkan kehilangan permintaan ini. <br><br>  Untuk memastikan stabilitas solusi, sebuah subsistem diperkenalkan, yang, memahami beban Ad Exchange saat ini, "memotong" permintaan untuk lelang, yang tidak dapat diproses secara fisik.  Dengan demikian, sistem dilindungi dari pertumbuhan beban yang tidak terkendali dari SSP. <br><br><h2>  Prospek </h2><br>  Hingga saat ini, Ad Exchange yang kami buat berfungsi dan menghasilkan untung besar.  Dan kami menyediakan dukungan dan integrasi mitra baru (DSP / SSP) sebagaimana diperlukan.  Secara total, beberapa lusin sistem telah terintegrasi.  Setiap integrasi seperti itu menyiratkan tidak hanya koneksi perangkat lunak, tetapi juga pengujian komprehensif layanan, karena di bawah beban yang berat masalah layanan yang terhubung dapat mempengaruhi mitra lain. <br><br>  Secara umum, pasar bergerak menuju fakta bahwa SSP dan DSP akan terhubung secara langsung, yang akan membuat pertukaran tidak perlu.  Tetapi integrasi bertumpu pada kemampuan SSP dan DSP.  Terlepas dari keberadaan API yang dideskripsikan secara terbuka (protokol OpenRTB), ia belum diakui secara universal di pasar.  Sebagai contoh, pemain utama seperti Appnexus memiliki dukungan terintegrasi untuk OpenRTB baru-baru ini. <br><br>  Intinya, Ad Exchange adalah penyedia likuiditas.  Jadi keputusan dalam waktu dekat tidak mungkin kehilangan relevansinya.  Selain itu, model pertukaran hanya mendapatkan popularitas di seluruh pasar periklanan. <br><br><hr><br>  Penulis artikel: Nikolay Eremin <br><br>  PS Kami menerbitkan artikel kami di beberapa situs Runet.  Berlangganan ke halaman kami di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">VK</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">FB</a> atau <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">saluran Telegram</a> untuk mencari tahu tentang semua publikasi kami dan berita Maxilect lainnya. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id421471/">https://habr.com/ru/post/id421471/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id421461/index.html">Pelacak Waktu untuk Google Scripts, Documents, dan Spreadsheets</a></li>
<li><a href="../id421463/index.html">Kehidupan malam di langit atau mencari pengolahan Perseid</a></li>
<li><a href="../id421465/index.html">Mobile DevOps dalam praktiknya</a></li>
<li><a href="../id421467/index.html">Pengembangan robot untuk mengumpulkan bola golf</a></li>
<li><a href="../id421469/index.html">Telegram setuju untuk mentransfer ke layanan khusus [tetapi bukan Rusia] alamat IP dan nomor dari beberapa pengguna</a></li>
<li><a href="../id421473/index.html">Apa itu Coroutine di Kotlin?</a></li>
<li><a href="../id421475/index.html">OutOfLine - pola dalam-memori untuk aplikasi C ++ kinerja tinggi</a></li>
<li><a href="../id421477/index.html">Apa yang tertulis dalam file .ssh / known_hosts</a></li>
<li><a href="../id421481/index.html">Mikrofon, tangkapan layar, dan video lokal: bagaimana Voximplant Web SDK mengontrol media di browser</a></li>
<li><a href="../id421485/index.html">Pemberitahuan penting untuk pengguna Halaman Gitlab</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>