<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèΩ‚Äçüéì ü§¢ üë©‚Äçüë¶‚Äçüë¶ Trabalhar com a API KOMPAS-3D ‚Üí Li√ß√£o 16 ‚Üí Caracteres de controle üåê ü§∞üèº üìÅ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Continuamos a s√©rie de artigos sobre como trabalhar com a API CAD COMPASS-3D. Os caracteres de controle j√° foram vistos v√°rias vezes nas li√ß√µes anteri...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Trabalhar com a API KOMPAS-3D ‚Üí Li√ß√£o 16 ‚Üí Caracteres de controle</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ascon/blog/457702/">  Continuamos a s√©rie de artigos sobre como trabalhar com a API CAD COMPASS-3D.  Os caracteres de controle j√° foram vistos v√°rias vezes nas li√ß√µes anteriores do ciclo.  Cada vez que se dizia que as linhas de sa√≠da n√£o deveriam cont√™-las, uma vez que o COMPAS as processa de maneira especial.  Agora √© hora de conhec√™-los melhor. <br><br>  Depois de dominar o trabalho com eles, voc√™ entender√° que criar seq√º√™ncias compostas complexas √© uma tarefa trivial, na maioria dos casos, n√£o exigindo a grava√ß√£o de uma grande quantidade de c√≥digo. <br><br>  Na li√ß√£o, veremos como usar caracteres especiais e caracteres de fonte com caracteres de controle, falaremos sobre como criar fra√ß√µes e desvios com sua ajuda e tamb√©m consideraremos seu uso em conjunto com par√°grafos. <br><br><img src="https://habrastorage.org/webt/5c/cs/bd/5ccsbdc8ufpd1vavz6hzfbqasas.png"><br><a name="habracut"></a><br><blockquote><h4>  O conte√∫do da s√©rie de li√ß√µes ‚ÄúTrabalhando com a API KOMPAS-3D‚Äù </h4><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O b√°sico</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Desenho de desenho</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Conex√£o correta com o KOMPAS</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Inscri√ß√£o principal</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Primitivas gr√°ficas</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Salvando um documento em v√°rios formatos</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Conhecendo as configura√ß√µes</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">M√©todos de escrita mais sofisticados no bloco de t√≠tulo</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Lendo c√©lulas de legenda</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Caracteres especiais, incluindo uma sequ√™ncia</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Etiquetas de texto simples</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cordas compostas</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Par√°grafos</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Texto de v√°rias linhas</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Linhas compostas baseadas em par√°grafos</a> </li><li>  <b>Caracteres de controle</b> </li></ol></blockquote><br><h2>  <font color="#00B2FF">Revis√£o superficial</font> </h2><br>  Os caracteres de controle s√£o: @, $, &amp;,;, ~, ^ e #.  Infelizmente, o KOMPAS SDK tem muito pouca informa√ß√£o sobre como us√°-los.  Para mais informa√ß√µes, consulte a ajuda do KOMPAS, na se√ß√£o <i>‚Äú9.</i>  <i>Configura√ß√µes do KOMPAS-3D / Armazenamento das configura√ß√µes do sistema / Arquivos de servi√ßo / Arquivo de menu do usu√°rio / Sintaxe do arquivo</i> . <i>‚Äù</i> <br><br><img src="https://habrastorage.org/webt/ya/jc/cx/yajccx87d-06xfzy5rjhfdlc2wa.png"><br><br>  Todos os caracteres de controle podem ser divididos condicionalmente em dois grupos: principal e auxiliar.  Os s√≠mbolos auxiliares s√£o usados ‚Äã‚Äãapenas em conjunto com os principais e, por si s√≥, n√£o descrevem nenhum componente.  A tabela abaixo fornece uma breve descri√ß√£o dos caracteres de controle. <br><br><img src="https://habrastorage.org/webt/bg/tj/ap/bgtjapszut_xvfq_u2vq0l3rak4.png"><br><br>  Vamos consider√°-los com mais detalhes. <br><br><h2>  <font color="#00B2FF">Inserir caracteres especiais</font> </h2><br>  J√° consideramos caracteres especiais (ver li√ß√µes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">4</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">10</a> ).  Em seguida, para inserir um caractere especial, uma inst√¢ncia separada da interface <b>ksTextItemParam</b> foi <b>usada</b> .  Usando caracteres de controle, voc√™ pode inserir tantos caracteres especiais em uma sequ√™ncia de caracteres que desejar, sem <b>reutilizar a</b> interface <b>ksTextItemParam</b> . <br>  A sintaxe para inserir caracteres especiais √©: <br><br>  <i><b>AA</b> @ <b>YXXXX</b> ~ <b>BB</b></i> <br><br>  onde <br>  <b>AA</b> - uma sequ√™ncia localizada antes de um caractere especial, <br>  <b>Y</b> - modificador para a representa√ß√£o do c√≥digo de caractere especial, <br>  <b>XXXX</b> - c√≥digo do caractere especial inserido. <br>  <b>BB</b> - uma linha localizada ap√≥s o caractere especial. <br><br>  O c√≥digo para o caractere especial inserido √© especificado entre <i>@</i> e <i>~</i> .  Al√©m disso, dependendo do valor do modificador <b>Y</b> , ele pode ser especificado em nota√ß√£o decimal ou hexadecimal.  Os valores v√°lidos do modificador <b>Y</b> s√£o mostrados na tabela abaixo. <br><br><img src="https://habrastorage.org/webt/pk/td/jq/pktdjqgmgj8ftldxtei4-614ct0.png"><br><br>  <i>Nota:</i> como mostram meus experimentos, o COMPASS normalmente processa a aus√™ncia do caractere <i>~</i> .  Nesse caso, caracteres especiais s√£o inseridos conforme necess√°rio.  No entanto, eu recomendo n√£o confiar nesse comportamento e sempre conclua a opera√ß√£o de inser√ß√£o com o caractere <i>~</i> . <br><br>  A seguir, √© apresentado um exemplo de um programa que demonstra a sa√≠da de caracteres especiais. <br><br><pre><code class="plaintext hljs">BSTR str = SysAllocString(OLESTR(" @+51~ ")); document2D-&gt;ksText(100.0,100.0,0.0,0.0,0.0,0,str); SysFreeString(str); str = SysAllocString(OLESTR(" @*33~ ")); document2D-&gt;ksText(100.0,90.0,0.0,0.0,0.0,0,str); SysFreeString(str);</code> </pre> <br>  Neste exemplo, o mesmo caractere (Œ± alfa) √© exibido duas vezes.  A primeira vez que seu c√≥digo √© especificado em decimal, a segunda vez em hexadecimal.  A figura abaixo mostra o resultado do programa. <br><br><img src="https://habrastorage.org/webt/o3/4b/3i/o34b3igkqgkvdrmze1ky6w4a1es.png"><br><br>  Os caracteres de controle permitem exibir v√°rios caracteres especiais na mesma linha.  Portanto, no exemplo a seguir, as tr√™s primeiras letras do alfabeto grego s√£o exibidas em uma chamada para o m√©todo <b>ksText</b> . <br><br><pre> <code class="plaintext hljs">BSTR str = SysAllocString(OLESTR("@+51~ @+52~ @+53~")); document2D-&gt;ksText(100.0,100.0,0.0,0.0,0.0,0,str); SysFreeString(str);</code> </pre><br>  A figura abaixo mostra o resultado deste programa. <br><br><img src="https://habrastorage.org/webt/mg/_v/xv/mg_vxv17mpco689p7gm6fzhp-ms.png"><br><br>  Modificador + √© o modificador padr√£o.  Portanto, a linha acima pode ser escrita assim: <br><br>  <i>‚Äú@ 51 ~ @ 52 ~ @ 53 ~‚Äù</i> <br><br>  Nesse caso, o resultado do programa permanecer√° o mesmo. <br><br>  Se <i>@ for</i> um caractere inv√°lido, a linha entre <i>@</i> e <i>~</i> ser√° exibida como est√°.  Os caracteres <i>@</i> e <i>~ s√£o</i> omitidos.  Por exemplo, com a linha: <br><br>  <i>‚ÄúAntes @ T51 ~ Depois‚Äù</i> <br><br>  O documento exibir√°: <br><br>  <i>Antes de T51 Depois</i> <br><br>  <i>Nota:</i> esse comportamento do KOMPAS n√£o est√° documentado e pode variar em diferentes vers√µes do programa. <br><br>  <i>Nota:</i> os caracteres de controle n√£o s√£o adequados para inserir caracteres especiais contendo uma sequ√™ncia.  O fato √© que, para limitar a a√ß√£o deles, √© necess√°rio usar o sinalizador SPECIAL_SYMBOL_END (para obter mais detalhes, consulte a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">li√ß√£o 10 do</a> ciclo), mas os caracteres de controle n√£o permitem o uso de sinalizadores. <br><br><h2>  <font color="#00B2FF">Inserir caracteres de fonte</font> </h2><br>  Al√©m de caracteres especiais, voc√™ pode inserir caracteres comuns por seu c√≥digo.  Os caracteres de controle <i>^</i> e <i>~</i> s√£o usados ‚Äã‚Äãpara isso.  Sua sintaxe √© dada abaixo. <br><br>  <i><b>AA</b> ^ ( <b>FNAME</b> ) <b>YXXXX</b> ~ <b>BB</b></i> <br><br>  onde <br>  <b>AA</b> - uma sequ√™ncia localizada antes do caractere inserido, <br>  <b>FNAME</b> - o nome da fonte da qual o caractere √© retirado, <br>  <b>Y</b> - modificador para a representa√ß√£o do c√≥digo de caractere (semelhante a @), <br>  <b>XXXX</b> - c√≥digo num√©rico do caractere inserido, <br>  <b>BB</b> - uma linha localizada ap√≥s o caractere inserido. <br><br>  Por seu prop√≥sito, o caractere de controle <i>^</i> √© semelhante a <i>@</i> .  Eles ainda t√™m uma sintaxe semelhante.  Mas existem duas diferen√ßas importantes entre eles: <br><br><ol><li>  <i>^</i> insere n√£o um caractere especial, mas um caractere de fonte por seu c√≥digo; </li><li>  para o caractere a ser inserido, voc√™ pode definir a fonte no campo <b>FNAME</b> (@ n√£o permite isso). </li></ol><br>  Os c√≥digos de s√≠mbolos podem ser visualizados usando o aplicativo charmap (Tabela de s√≠mbolos), que faz parte do sistema operacional Windows. <br><br>  Se nenhuma fonte for especificada, a fonte padr√£o ser√° usada.  A seguir, um exemplo usando o caractere <i>^</i> . <br><br><pre> <code class="plaintext hljs">BSTR str = SysAllocString(OLESTR(" ^(Arial)*B1~  ^*39~ ")); document2D-&gt;ksText(100.0,100.0,0.0,0.0,0.0,0,str); SysFreeString(str);</code> </pre><br>  Neste exemplo, dois caracteres s√£o inseridos na sequ√™ncia resultante; no primeiro, selecionamos a fonte <i>Arial</i> ; no segundo, deixamos a fonte padr√£o.  A figura abaixo mostra a linha que √© impressa no documento. <br><br><img src="https://habrastorage.org/webt/lj/8i/5k/lj8i5kqw_acqwuvq0lulgnmgolw.png"><br><br>  Observe: a fonte est√° definida apenas para o caractere exibido.  Como mostram meus experimentos, o KOMPAS normalmente processa a aus√™ncia de um terminador.  No entanto, eu n√£o recomendo confiar nesse comportamento e sempre definir um finalizador. <br><br>  Se um caractere inv√°lido (ou um c√≥digo inv√°lido) for especificado ap√≥s <i>^</i> , <i>^</i> e <i>~ ser√£o</i> omitidos e a linha entre eles ser√° exibida como se <i>estivesse</i> usando a fonte padr√£o.  Por exemplo, com a linha <br><br>  <i>‚ÄúAntes ^ Q (Arial) * B1 ~ Depois‚Äù</i> <br><br>  O documento exibir√°: <br><br>  <i>‚ÄúAntes de Q (Arial) * B1 Depois‚Äù</i> <br><br>  Se um nome de fonte incorreto for indicado no campo <b>FNAME</b> , o KOMPAS selecionar√° a fonte e exibir√° o caractere. <br><br>  Se n√£o houver par√™nteses de fechamento na linha, essa linha n√£o ser√° exibida completamente.  Por exemplo, com a linha: <br><br>  <i>‚ÄúAntes ^ Q (Arial * B1 ~ Depois‚Äù</i> <br><br>  O documento ser√° exibido apenas <br><br>  <i>"At√©"</i> <br><br>  <i>Nota:</i> o comportamento acima com sintaxe incorreta de caractere de controle √© v√°lido para o KOMPAS-3D V17 e n√£o est√° documentado.  Em outras vers√µes, pode ser diferente. <br><br><h2>  <font color="#00B2FF">Maneiras adicionais de inserir caracteres</font> </h2><br>  Os caracteres <i>@</i> e <i>^</i> t√™m an√°logos - <i>&amp;</i> e <i>#</i> respectivamente.  Eles t√™m sintaxe semelhante: <br><br>  <i><b>AA</b> e <b>XX</b> ~ <b>BB</b></i> <i><br></i>  <i><b>AA</b> # ( <b>FNAME</b> ) <b>XX</b> ~ <b>BB</b></i> <br><br>  onde <br><br>  <b>AA</b> - uma sequ√™ncia exibida antes do caractere inserido, <br>  <b>XX</b> - c√≥digo do caractere inserido (para &amp; - caractere especial, para # - caractere de fonte), <br>  <b>BB</b> - uma sequ√™ncia exibida ap√≥s o caractere inserido, <br>  <b>FNAME</b> - o nome da fonte. <br><br>  Existem apenas duas diferen√ßas entre os caracteres <i>@</i> e <i>^</i> e suas contrapartes: <br><br><ol><li>  Os caracteres &amp; e # n√£o possuem um modificador Y. O c√≥digo do caractere √© sempre especificado em nota√ß√£o decimal. </li><li>  O c√≥digo para o caractere a ser inserido √© especificado por um m√°ximo de dois d√≠gitos. </li></ol><br>  A seguir est√° o c√≥digo fonte de um programa que demonstra como usar os caracteres <i>&amp;</i> e <i>#</i> . <br><br><pre> <code class="plaintext hljs">BSTR str = SysAllocString(OLESTR(" &amp;51~ ")); document2D-&gt;ksText(100.0,100.0,0.0,0.0,0.0,0,str); SysFreeString(str); str = SysAllocString(OLESTR(" #(Arial)37~  #37~ ")); document2D-&gt;ksText(100.0,90.0,0.0,0.0,0.0,0,str); SysFreeString(str);</code> </pre><br>  A figura abaixo mostra o resultado deste programa. <br><br><img src="https://habrastorage.org/webt/xq/ku/tw/xqkutwd7x225k5zx8dd-lsriorg.png"><br><br><h2>  <font color="#00B2FF">Texto de v√°rias linhas</font> </h2><br>  Usando caracteres de controle, o texto de v√°rias linhas pode ser exibido.  Para fazer isso, no local de transfer√™ncia para uma nova linha, voc√™ precisa inserir a sequ√™ncia: <i>@ /</i> .  Nota: o caractere <i>@</i> √© usado sem um terminador <i>~</i> .  A seguir est√° o c√≥digo fonte de um programa que exibe texto de v√°rias linhas usando caracteres de controle. <br><br><pre> <code class="plaintext hljs">BSTR str = SysAllocString(OLESTR(" @/ ")); document2D-&gt;ksText(100.0,100.0,0.0,0.0,0.0,0,str); SysFreeString(str);</code> </pre><br>  Observa√ß√£o: gra√ßas ao uso de caracteres de controle, exibimos texto de duas linhas com apenas uma chamada para o m√©todo <b>ksText</b> .  A figura abaixo mostra o resultado deste programa. <br><br><img src="https://habrastorage.org/webt/tp/-3/fm/tp-3fmwgsjpyrgrhhw9icccok70.png"><br><br><h2>  <font color="#00B2FF">Inserir caracteres de controle</font> </h2><br>  N√≥s descobrimos como inserir caracteres especiais arbitr√°rios e caracteres Unicode.  Mas e se voc√™ quiser inserir o pr√≥prio caractere de controle?  Aqui voc√™ pode ir de duas maneiras.  A primeira maneira √© usar o caractere <i>^</i> e col√°-lo como caracteres de fonte regulares.  Mas existe uma maneira mais f√°cil. <br><br>  S√≠mbolo <i>;</i>  √© auxiliar e pode ser inserido diretamente no texto.  Para inserir outros caracteres de controle, voc√™ precisa dobr√°-los.  Ou seja, um par de caracteres <i>@@</i> insere um √∫nico caractere <i>@</i> no texto.  O mesmo vale para outros caracteres de controle. <br><br>  A seguir, √© apresentado um exemplo de programa que demonstra a inser√ß√£o de caracteres de controle em uma seq√º√™ncia de caracteres. <br><br><pre> <code class="plaintext hljs">BSTR str = SysAllocString(OLESTR(" : @@ $$ &amp;&amp; ; ~~ ^^ ##")); document2D-&gt;ksText(100.0,100.0,0.0,0.0,0.0,0,str); SysFreeString(str);</code> </pre><br>  A figura abaixo mostra o resultado deste programa. <br><br><img src="https://habrastorage.org/webt/4t/jv/rx/4tjvrxux7i2epcfivimh8aai-2g.png"><br><br><h2>  <font color="#00B2FF">Desvios superiores e inferiores</font> </h2><br>  A seguinte sintaxe √© usada para inserir desvios: <br><br>  <i><b>AA</b> $ <b>XX</b> ;</i>  <i><b>AA</b> $ <b>BB</b></i> <br><br>  onde <br><br>  <b>AA</b> - texto exibido antes dos desvios; <br>  <b>XX</b> - desvio superior; <br>  <b>YY</b> √© o desvio mais baixo; <br>  <b>BB</b> - texto exibido ap√≥s os desvios. <br><br>  Observe: toda a constru√ß√£o √© limitada a <i>$</i> caracteres e o " <i>;</i>  ¬ªServe como separador entre os desvios superior e inferior. <br><br>  Se n√£o houver delimitador "entre os caracteres <i>$</i> <i>;</i>  ", A linha inteira entre eles √© interpretada como o desvio superior.  Se o componente <b>XX estiver</b> ausente, ou seja, ap√≥s o primeiro <i>$</i> ir imediatamente " <i>;</i>  ", A linha subsequente inteira at√© o <i>$</i> mais pr√≥ximo <i>√©</i> interpretada como o desvio mais baixo. <br><br>  <i>Nota: o</i> texto do desvio superior n√£o deve come√ßar pelas letras <i>b</i> , <i>d</i> , <i>s</i> , <i>m</i> e <i>l</i> ( <i>L</i> min√∫sculo).  A raz√£o para isso ser√° explicada um pouco mais tarde. <br><br>  A seguir, √© apresentado um exemplo de um programa que exibe a sa√≠da com desvios <br><br><pre> <code class="plaintext hljs">BSTR str = SysAllocString(OLESTR(" $;$ ")); document2D-&gt;ksText(100.0,100.0,0.0,0.0,0.0,0,str); SysFreeString(str);</code> </pre><br>  A figura abaixo mostra o resultado deste programa: <br><br><img src="https://habrastorage.org/webt/-w/hr/ql/-whrqlu38elpopxgq22zblob6tm.png"><br><br>  Observe que o KOMPAS processa apenas um caractere " <i>;</i>  "  O segundo caractere √© " <i>;</i>  "Pode ser interpretado como o finalizador de toda a estrutura.  Por exemplo, com a linha " <i>11 $ 22; 33; 44 $</i> ", a tela exibir√°: <br><br><img src="https://habrastorage.org/webt/pf/22/0i/pf220i_rer29nw_nsx2h88ja_le.png"><br><br>  <i>Nota:</i> esse comportamento do KOMPAS n√£o est√° documentado, portanto voc√™ n√£o pode confiar nele. <br><br><h2>  <font color="#00B2FF">Fra√ß√£o</font> </h2><br>  A sintaxe da fra√ß√£o √© semelhante √† sintaxe do desvio e possui duas op√ß√µes equivalentes: <br><br>  <i><b>AA</b> $ <b>bXX</b> ;</i>  <i><b>AA</b> $ <b>BB</b></i> <i><br></i>  <i><b>AA</b> $ <b>dXX</b> ;</i>  <i><b>AA</b> $ <b>BB</b></i> <br><br>  onde <br><br>  <b>AA</b> - sa√≠da de texto para fra√ß√µes; <br>  <b>XX</b> √© o numerador; <br>  <b>YY</b> √© o denominador; <br>  <b>BB</b> - texto exibido ap√≥s a fra√ß√£o. <br><br>  Observe: a √∫nica diferen√ßa entre a sa√≠da da fra√ß√£o e a sa√≠da dos desvios √© a presen√ßa da letra <i>d</i> ou <i>b</i> imediatamente ap√≥s o primeiro sinal de <i>$</i> .  Caso contr√°rio, suas sintaxes s√£o id√™nticas. <br><br>  Se n√£o houver " <i>;</i> " entre os caracteres <i>$ d</i> ( <i>$ b</i> ) e <i>$</i>  ", A linha inteira entre eles ser√° interpretada como um numerador.  Se o componente <b>XX estiver</b> ausente, ou seja, depois que <i>$ d</i> ( <i>$ b</i> ) vier imediatamente " <i>;</i>  ", A linha subsequente inteira at√© o <i>$</i> mais pr√≥ximo <i>√©</i> interpretada como o denominador. <br><br>  <i>Nota:</i> o texto do numerador n√£o deve come√ßar pelas letras <i>s</i> , <i>m</i> ou <i>l</i> ( <i>L</i> min√∫sculo).  A raz√£o para isso ser√° explicada um pouco mais tarde. <br><br>  A seguir, √© apresentado um exemplo de um programa que demonstra a sa√≠da da fra√ß√£o usando caracteres de controle. <br><br><pre> <code class="plaintext hljs">BSTR str = SysAllocString(OLESTR(" $d;$ ")); document2D-&gt;ksText(100.0,100.0,0.0,0.0,0.0,0,str); SysFreeString(str);</code> </pre><br>  A figura abaixo mostra o resultado deste programa. <br><br><img src="https://habrastorage.org/webt/ha/sm/dd/hasmddwd9o67w8t747vhwceoae0.png"><br><br>  Por favor, note que o KOMPAS processa os caracteres "extras" <i>;</i>  ¬ªBem como no caso de desvios.  Esse comportamento n√£o √© documentado e n√£o pode ser invocado. <br><br><h2>  <font color="#00B2FF">Controle de varia√ß√£o e tamanho de fra√ß√£o</font> </h2><br>  No in√≠cio da constru√ß√£o de desvios ou fra√ß√µes, uma das letras pode ser localizada: <i>s</i> , <i>m</i> ou <i>l</i> ( <i>L</i> min√∫sculo).  Eles especificam o tamanho dos desvios e elementos da fra√ß√£o (numerador e denominador).  Seu objetivo √© descrito na tabela abaixo. <br><br><img src="https://habrastorage.org/webt/mp/ez/1u/mpez1un_2njdu3jxixivvwqbdz4.png"><br><br>  Se nenhuma dessas letras for especificada, <i>l ser√°</i> usado para a fra√ß√£o e <i>m ser√°</i> usado para desvios.  A seguir, √© apresentado um exemplo de programa que demonstra o uso dessas letras. <br><br><pre> <code class="plaintext hljs">BSTR str = SysAllocString(OLESTR(" $d;$ ")); document2D-&gt;ksText(100.0,100.0,0.0,0.0,0.0,0,str); SysFreeString(str); str = SysAllocString(OLESTR(" $dl;$ ")); document2D-&gt;ksText(100.0,85.0,0.0,0.0,0.0,0,str); SysFreeString(str); str = SysAllocString(OLESTR(" $dm;$ ")); document2D-&gt;ksText(100.0,70.0,0.0,0.0,0.0,0,str); SysFreeString(str); str = SysAllocString(OLESTR(" $ds;$ ")); document2D-&gt;ksText(100.0,60.0,0.0,0.0,0.0,0,str); SysFreeString(str);</code> </pre><br>  A figura abaixo mostra o resultado deste programa. <br><br><img src="https://habrastorage.org/webt/z2/2_/dj/z22_djahn5b1uiugptca_0doqui.png"><br><br>  Embora as letras <i>s</i> , <i>me</i> sejam usadas para fra√ß√µes neste exemplo, seu uso para desvios n√£o √© diferente. <br><br>  Observe que se entre o in√≠cio de uma fra√ß√£o ou desvio ( <i>$</i> , <i>$ d</i> ou <i>$ b</i> ) e a letra <i>s</i> , <i>m</i> ou <i>l</i> houver pelo menos um caractere ‚Äúestranho‚Äù (por exemplo, um espa√ßo), o COMPAS n√£o ‚Äúver√°‚Äù as letras e a fra√ß√£o ou O desvio ser√° o tamanho padr√£o. <br><br><h2>  <font color="#00B2FF">Caracteres de controle aninhados</font> </h2><br>  Ao emitir fra√ß√µes e desvios, as linhas inclu√≠das em sua composi√ß√£o s√£o processadas recursivamente.  Isso significa que, ao formar o numerador e o denominador, os caracteres de controle tamb√©m podem ser usados.  Essa abordagem √© demonstrada no exemplo a seguir. <br><br><pre> <code class="plaintext hljs">BSTR str = SysAllocString(OLESTR("@54~$s2$ + $d@+51~;@+52~$ - ^(Symbol)*70~")); document2D-&gt;ksText(100.0,100.0,0.0,0.0,0.0,0,str); SysFreeString(str);</code> </pre><br>  A figura abaixo mostra o resultado deste programa. <br><br><img src="https://habrastorage.org/webt/qq/f_/9a/qqf_9au_d7ijxvxhvopiuzlhpbk.png"><br><br>  Para inserir letras do alfabeto grego, usamos os caracteres de controle @ e ^ (para a letra ÔÅ∞ pi).  O grau no primeiro termo √© derivado usando desvios.  A substring <i>$ s2 $ a</i> exibe.  A letra <i>s</i> indica o tamanho pequeno do desvio, mas devido √† aus√™ncia de um separador " <i>;</i>  ¬ªApenas o desvio superior √© exibido. <br><br>  Para formar uma fra√ß√£o, a combina√ß√£o <i>$ d; $ √© usada</i> .  Al√©m disso, o numerador e o denominador incluem caracteres de controle que fornecem a sa√≠da das letras do alfabeto grego. <br><br>  O √∫ltimo subtra√≠do (œÄ pi) √© exibido como o s√≠mbolo da fonte Symbol usando os caracteres de controle <i>^</i> e <i>~</i> . <br><br>  Infelizmente, as possibilidades de tal "recurs√£o" s√£o muito limitadas.  N√£o podemos investir fra√ß√µes e desvios um no outro.  O problema √© que os dois s√£o formados usando o caractere <i>$</i> control.  Por esse motivo, o COMPASS n√£o pode analisar corretamente qual <i>$</i> pertence a qual elemento. <br><br><h2>  <font color="#00B2FF">Controlar caracteres no par√°grafo</font> </h2><br>  Voc√™ pode ignorar parcialmente a restri√ß√£o com caracteres de controle aninhado usando par√°grafos.  O uso de caracteres e par√°grafos de controle juntos permite criar estruturas ainda mais complexas.  O exemplo abaixo demonstra a constru√ß√£o de uma fra√ß√£o de 4 n√≠veis. <br><br><div class="spoiler">  <b class="spoiler_title">C√≥digo de programa para criar uma fra√ß√£o de 4 n√≠veis</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">//   DynamicArrayPtr dynamicArray; dynamicArray = static_cast&lt;DynamicArrayPtr&gt;(kompas-&gt;GetDynamicArray(TEXT_ITEM_ARR)); dynamicArray-&gt;ksClearArray(); TextItemParamPtr textItemParam; textItemParam = static_cast&lt;TextItemParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextItemParam)); //     BSTR str = SysAllocString(OLESTR("  ")); textItemParam-&gt;set_s(str); dynamicArray-&gt;ksAddArrayItem(-1, textItemParam); SysFreeString(str); //     TextItemFontPtr textItemFont; textItemFont = static_cast&lt;TextItemFontPtr&gt;(textItemParam-&gt;GetItemFont()); textItemFont-&gt;set_bitVector(NUMERATOR); str = SysAllocString(OLESTR("1 + $d@+51~;2$")); textItemParam-&gt;set_s(str); dynamicArray-&gt;ksAddArrayItem(-1, textItemParam); SysFreeString(str); //    textItemFont-&gt;set_bitVector(DENOMINATOR); str = SysAllocString(OLESTR("1 + $d@+56~;2$")); textItemParam-&gt;set_s(str); dynamicArray-&gt;ksAddArrayItem(-1, textItemParam); SysFreeString(str); //  textItemFont-&gt;set_bitVector(END_FRACTION); str = SysAllocString(OLESTR("  ")); textItemParam-&gt;set_s(str); dynamicArray-&gt;ksAddArrayItem(-1, textItemParam); SysFreeString(str); //   textItemFont.Unbind(); textItemParam.Unbind(); //    ksTextLineParam TextLineParamPtr textLineParam; textLineParam = static_cast&lt;TextLineParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextLineParam)); textLineParam-&gt;Init(); textLineParam-&gt;SetTextItemArr(dynamicArray); dynamicArray.Unbind(); //  ParagraphParamPtr paragraphParam; paragraphParam=static_cast&lt;ParagraphParamPtr&gt;(kompas-&gt;GetParamStruct(ko_ParagraphParam)); paragraphParam-&gt;Init(); paragraphParam-&gt;set_x(100.0); paragraphParam-&gt;set_y(100.0); document2D-&gt;ksParagraph(paragraphParam); document2D-&gt;ksTextLine(textLineParam); document2D-&gt;ksEndObj(); //   textLineParam.Unbind(); paragraphParam.Unbind();</code> </pre><br></div></div><br>  Neste exemplo, caracteres de controle s√£o usados ‚Äã‚Äãpara construir fra√ß√µes no numerador e denominador da fra√ß√£o principal, al√©m de inserir letras do alfabeto grego.  A figura abaixo mostra o resultado deste programa. <br><br><img src="https://habrastorage.org/webt/ji/x6/lo/jix6loqqynqpondf3g47pvhopj0.png"><br><br><h2>  Conclus√£o </h2><br>  Nesta li√ß√£o, encontramos os caracteres de controle e aprendemos como us√°-los para exibir caracteres especiais e caracteres de fonte.  Como voc√™ pode ver, eles fornecem uma sintaxe simples para criar strings que incluem caracteres especiais, fra√ß√µes e desvios.  Infelizmente, eles n√£o s√£o adequados para inserir caracteres especiais contendo cadeias.  Mas esses caracteres especiais s√£o extremamente raros.  Essa √© uma das limita√ß√µes dos caracteres de controle.  Al√©m disso, eles n√£o podem ser usados ‚Äã‚Äãpara criar substrings e substrings, e h√° limita√ß√µes ao trabalhar com caracteres especiais que incluem strings.  Mas isso n√£o diminui seus m√©ritos.  Isso conclui nossa discuss√£o sobre caracteres de controle. <br><br>  <b>Para continuar, acompanhe as not√≠cias do blog.</b> <br><br> <a href=""><img src="https://habrastorage.org/web/595/eee/f27/595eeef271b24830b3578751fcb52716.png"></a>  Sergey Norseev, Ph.D., autor do livro "Application Development for COMPAS in Delphi". </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt457702/">https://habr.com/ru/post/pt457702/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt457692/index.html">Reflex√µes sobre os padr√µes nacionais de NB-Fi e sistemas de cobran√ßa</a></li>
<li><a href="../pt457694/index.html">Os perigos do uso de constantes com v√°rios caracteres</a></li>
<li><a href="../pt457696/index.html">Os perigos do uso de constantes com v√°rios caracteres</a></li>
<li><a href="../pt457698/index.html">Experi√™ncia: usamos proxies como uma ferramenta para combater ataques DoS</a></li>
<li><a href="../pt457700/index.html">Guia de autentica√ß√£o do Node.js. sem passport.js e servi√ßos de terceiros</a></li>
<li><a href="../pt457704/index.html">Como as GPUs lidam com ramifica√ß√£o</a></li>
<li><a href="../pt457706/index.html">Rob√¥ testa SAP ERP</a></li>
<li><a href="../pt457710/index.html">Os incr√≠veis recursos das redes neurais 2019</a></li>
<li><a href="../pt457712/index.html">Como a Verizon e o BGP Optimizer configuram √≥timos offline</a></li>
<li><a href="../pt457714/index.html">Estouro de pilha em ingl√™s: Community Kill Guide</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>