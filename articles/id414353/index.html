<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🥄 🌽 ✍🏿 Kivy. Dari penciptaan ke produksi adalah satu langkah. Bagian 2 🍞 👨🏿‍🍳 👵🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bagian 1 

 Salam! 

 Hari ini, seperti biasa, mari kita bicara tentang membuat aplikasi seluler dengan kerangka kerja Kivy dan Python. Secara khusus,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kivy. Dari penciptaan ke produksi adalah satu langkah. Bagian 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/414353/"><img src="https://habrastorage.org/webt/bu/vd/zj/buvdzj9m_o2hofykxup3chiad7i.png" align="left">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><b>Bagian 1</b></a> <br><br>  Salam! <br><br>  Hari ini, seperti biasa, mari kita bicara tentang membuat aplikasi seluler dengan kerangka kerja Kivy dan Python.  Secara khusus, ini akan fokus pada pembuatan klien seluler untuk satu sumber daya Internet dan menerbitkannya di Google Play.  Saya akan memberi tahu Anda masalah apa yang mungkin dimiliki pemula dan pengembang berpengalaman, yang memutuskan untuk mencoba sendiri dalam pengembangan lintas platform dengan Kivy, apa yang dapat dan tidak boleh dilakukan dalam pemrograman dengan Python untuk Android. <br><a name="habracut"></a><br>  Suatu pagi saya menemukan dalam surat saya di Habré surat yang menanyakan apakah saya bisa menggunakan Python dan Kivy untuk "membuat ulang situs svyatye.com dalam aplikasi seluler sehingga orang dapat membaca dan menggunakannya secara offline" dengan publikasi klien berikutnya di Toko aplikasi Google Play.  Mengikuti tautan dan menelusuri sumber, yang ternyata menjadi perpustakaan besar kutipan, saya membayangkan bagaimana itu akan terlihat dalam presentasi mobile dan bagaimana saya akan membuat daftar "lebih dari 30.236 ucapan ayah suci dan guru gereja" meskipun panjang kutipan, kadang-kadang , mencapai lebih dari 10.000 karakter (5-6 halaman teks cetak).  Karena saya telah bekerja dengan Kivy untuk waktu yang lama, saya segera menyadari bagaimana dan apa yang akan saya lakukan.  Karena itu, ia menjawab kepada pelanggan bahwa tidak akan sulit untuk membuat aplikasi seperti itu.  Namun, kesulitan, yang akan saya bahas di bawah ini, tetap muncul ... <br><br>  Tidak ada spesifikasi teknis yang diberikan.  Satu-satunya persyaratan adalah aplikasi harus bekerja seperti jam.  Tidak ada tenggat waktu.  Tidak ada tata letak antarmuka juga.  "Semuanya harus sesederhana mungkin, tanpa animasi, transformasi dan sekam lainnya, dengan kata lain, sesederhana mungkin."  Yah, semakin baik.  Selain itu, keputusan saya sudah matang - aplikasi akan menggunakan satu objek RecycleView, yang akan menampilkan kategori, subkategori, daftar penulis kutipan dan kutipan sendiri. <br><br><h3>  Daftar </h3><br>  Namun, RecycleView, yang memungkinkan Anda untuk membuka daftar besar ribuan dalam sepersekian detik, berperilaku sangat berbeda dari yang diinginkan.  Tidak, tidak ada masalah membuka daftar kutipan, semuanya bekerja dengan cepat, saya bahkan tidak memuat tanda kutip baru dengan jendela "Tunggu" di situs, karena daftar kutipan dari kategori yang dipilih diberikan secara instan dan lengkap.  Masalahnya berbeda - pelanggan bersikeras bahwa teks kutipan dalam daftar harus ditampilkan secara keseluruhan dan bahwa RecycleView tidak sepenuhnya sesuai di sini.  Faktanya adalah bahwa prinsip pengoperasian widget ini adalah sebagai berikut: satu objek dibuat pada seluruh daftar, yang kemudian hanya dikloning, sebagai akibatnya kita memiliki kecepatan luar biasa dalam membuat daftar, tidak peduli seberapa besar itu.  Tetapi ada satu hal - ketinggian item daftar harus diperbaiki dan diketahui sebelumnya.  Tetapi jika Anda perlu secara dinamis menghitung ketinggian item daftar berikutnya saat menggulir, seperti dalam kasus saya, maka ada kelambatan yang terlihat - daftar membeku selama sepersekian detik, yang, Anda lihat, sama sekali tidak siap untuk bertindak. <br><br>  Dengan kesedihan menjadi dua, saya berhasil membujuk pelanggan ke daftar dengan pratinjau kutipan, teks yang akan terbuka sepenuhnya oleh tapu ke teks pratinjau, seperti yang dilakukan di hampir semua forum, bukan karena RecycleView tidak dapat mengatasi tugas, tetapi karena itu adalah yang paling logis: untuk menggulir teks multi-halaman dari kutipan, terutama jika kutipan itu tidak menarik bagi pengguna, dari sudut pandang saya itu tidak benar. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pi/3d/nw/pi3dnwwczjvhvomwwtz-aej8w7s.png"></div>  <i><b>Fig.</b></i>  <i><b>1</b></i> <i><b><br></b></i>  <i><b>Pratinjau dan teks lengkap saat merekam pratinjau penawaran</b></i> <br><br>  Opsi ini bekerja sangat cepat, tetapi ... pelanggan tidak menyukainya ... Saya harus menggunakan ScrollView yang lambat, yang menjadikan daftar SEBELUM itu ditampilkan di layar, yang berarti tidak membekukan pengguliran daftar kutipan, karena menghitung dan merender semua parameter elemen daftar sebelumnya, yang, Tentu, itu akan mempengaruhi kecepatan daftar layar.  Biasanya kinerja diletakkan di tempat pertama, dan di sini mereka berkata kepada saya, "biarlah lebih lambat." <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lj/nf/wd/ljnfwdbv70f9ykkmwpau3ykypao.jpeg"></div><br>  Yah, saya tidak berdebat lagi, dan meskipun saya benar-benar tidak menyukai solusi ini, saya harus mentransfer semuanya ke ScrollView.  Karena, seperti yang saya katakan, ScrollView sangat lambat, diputuskan untuk menampilkan penawaran dalam sepuluh bagian masing-masing dengan pemuatan otomatis lebih lanjut dari sepuluh berikutnya. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2ca/124/840/2ca124840069a9a452aefd3faa5c53e3.gif"></div><br>  Berjalan sedikit di depan, saya akan mengatakan bahwa ketika umpan balik pertama dari pengguna datang dengan permintaan, mereka mengatakan bahwa bookmark tidak akan benar-benar sakit, karena bagi saya, pelanggan masih meragukan keputusan untuk menggunakan ScrollView, seolah-olah kita meninggalkan preview dari kutipan dan RecycleView, kemudian tanpa masalah mereka bisa langsung mengembalikan dari bookmark yang sebelumnya dilihat oleh pengguna dalam daftar kutipan sesi sebelumnya, tidak peduli berapa lama mereka.  Dan dengan ScrollView, pengguna hanya akan menjadi tua sambil menunggu daftar yang akan ditampilkan setidaknya dari semangat kutipan. <br><br><h3>  Buildozer dan layanan </h3><br>  Ketika aplikasi dikembangkan, ada proposal untuk mengajukan layanan di dalamnya yang akan mengirimkan kutipan acak dari database ke pengguna sekali sehari.  Saya belum pernah menangani tugas serupa di Kivy sebelumnya, tetapi mengingat bahwa ada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">artikel</a> tentang Habré tentang masalah ini, saya memutuskan untuk mencobanya. <br><br>  Setelah membunuh satu minggu penuh, memecahkan lima keyboard dan dua monitor, saya tidak dapat mengkompilasi paket sesuai dengan instruksi dari artikel di atas - selama kompilasi kelas yang diperlukan tidak ditemukan.  Setelah menulis kepada penulis artikel, saya menyarankan bahwa, ternyata, hanya dua alasan mengapa saya gagal adalah benar: entah saya idiot atau pengembang merusak Buildozer, alat untuk membangun paket APK untuk Android.  Asumsi saya ternyata benar - "Tentu saja, mereka melanggarnya, setelah versi 0.33 apa yang akan mereka kumpulkan." <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/j1/sl/le/j1sllelwpmfwhkjxhi1hotfap5w.jpeg"></div><br>  Ya, bagian terbesar dari pertanyaan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">forum Kivy</a> terhubung dengan berbagai masalah yang muncul justru dengan Buildozer.  Sekarang setiap versi alat ini membutuhkan versi Cython sendiri, yang akan Anda pilih secara eksperimental untuk waktu yang lama, menggunakan versi Buildozer terbaru Anda tidak akan dapat menambahkan perpustakaan ke proyek JAR Anda, karena meskipun proyek ini dirakit, perpustakaan tidak akan ditambahkan ke dalamnya dan Anda akan menjadi satu minggu lagi , seperti saya, duduk-duduk mencari masalah.  Dan ... kamu tidak akan menemukannya.  Oleh karena itu, bagi pemula dan orang-orang dengan mental yang lemah, bekerja dengan Buildozer dapat membawa ke klinik. <br><br>  Jadi saya meludah ke traktor yang mati ini, pergi ke neraka, pergi ke github, mengunduh python-untuk-android, mengambil Crystax-NDK di situs off, menginstal Python 3.5 dan dengan tenang mengumpulkan APK proyek dengan cabang Python ketiga, yang ternyata jauh lebih sederhana, dibandingkan dengan Buildozer terkenal. <br><br>  Bagaimana dengan layanan?  Tapi tidak ada apa-apa.  Mereka tidak bekerja.  Lebih tepatnya, layanan yang dibuat dalam proyek Anda tidak akan dimulai dengan reboot smartphone, tidak peduli apa yang penulis artikel klaim tentang layanan di Kivy.  Setelah ditemukan di Google Play dan menginstal proyeknya, saya menemukan bahwa tidak ada layanan dengan memulai kembali program dimulai.  100% layanan di Kivy dimulai hanya dengan peluncuran aplikasi itu sendiri.  Nantinya, jika Anda menutup aplikasi, layanan akan terus bekerja dengan tenang sampai Anda mematikan perangkat. <br><br><h3>  Tentang Python 2 dan Python 3 </h3><br>  Pada bulan Februari tahun ini, Moscow Python diadakan di kantor Yandex di Moskow, di mana Vladislav Shashkov membuat presentasi dengan tema: "Aplikasi seluler Python dengan kivy / buildozer adalah kunci kesuksesan".  Jadi dia punya kebodohan untuk mengatakan bahwa Python 2 dalam perakitan APK lebih cepat dari Python 3. Jangan percaya siapa pun, ini tidak benar.  Python 3 lebih cepat dari Python 2 pada prinsipnya!  Ketika saya mengembangkan "Quotes of the Saints" (kemudian diasumsikan bahwa cabang Python kedua akan digunakan dalam perakitan), saya terkejut menemukan bahwa basis kutipan 20 MB, yang digunakan dalam aplikasi ketika tidak ada koneksi jaringan, dibaca menggunakan json. memuat sebanyak 13-16 detik di perangkat seluler!  Dan basis yang sama, tetapi sudah dengan Python 3 diproses di perangkat dalam 1-2 detik!  Buat kesimpulan sendiri ... <br><br><h3>  Tentang Bereaksi Asli </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bm/92/89/bm92891hjs-ffkf8__e5tej0fly.jpeg"></div><br>  Ya, dalam artikel saya, saya memutuskan untuk menarik paralel antara Kivy dan kerangka kerja lain untuk pengembangan lintas platform.  Di sini Anda hanya perlu membuka spoiler dan melihat bagaimana aplikasi yang sederhana, cepat dan elegan dibuat di React Native ... <br><br><div class="spoiler">  <b class="spoiler_title">Contoh</b> <div class="spoiler_text">  Mari kita coba menggambar antarmuka penuh.  Kami menulis ulang App.js menggunakan komponen dari pustaka asli-basis: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {Container, Content} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'native-base'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {StyleSheet, Text, View} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-native'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> AppFooter <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./components/AppFooter.js'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> styles = StyleSheet.create({ <span class="hljs-attr"><span class="hljs-attr">container</span></span>: { <span class="hljs-attr"><span class="hljs-attr">padding</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span> }, }); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> App = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Container</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Content</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">View</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{styles.container}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> Lorem ipsum... </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">View</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Content</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">AppFooter</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Container</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> App;</code> </pre> <br><br>  Kami melihat komponen AppFooter baru yang harus kami buat.  Kami pergi ke folder ./components/ dan membuat file AppFooter.js dengan konten berikut: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {Footer, FooterTab, Button, Text} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'native-base'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> AppFooter = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Footer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">FooterTab</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">active</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">FooterTab</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Footer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> AppFooter;</code> </pre><br>  Semuanya siap untuk mencoba membangun aplikasi kita! <br><br>  Tombol kami belum tahu cara beralih.  Sudah waktunya untuk mengajar mereka.  Untuk melakukan ini, Anda perlu melakukan dua hal: mempelajari cara menangani peristiwa klik dan mempelajari cara menyimpan keadaan.  Mari kita mulai dengan negara.  Karena kami menolak untuk menyimpan status dalam komponen, setelah memilih komponen murni dan toko global, kami akan menggunakan Redux. <br><br>  Pertama-tama, kita harus menciptakan sisi kita. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {createStore} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> initialState = {}; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> store = createStore(reducers, initialState);</code> </pre><br>  Mari kita buat kosong untuk reduksi.  Di folder reduksi, buat file index.js dengan konten berikut: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> (state = [], action) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (action.type) { <span class="hljs-attr"><span class="hljs-attr">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> state } };</code> </pre><br>  Hubungkan reducers ke App.js: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> reducers <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./reducers'</span></span>;</code> </pre><br>  Sekarang kita perlu mendistribusikan penyimpanan kita pada komponen.  Ini dilakukan dengan menggunakan komponen Penyedia khusus.  Kami menghubungkannya ke proyek: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {Provider} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-redux'</span></span>;</code> </pre><br>  Dan bungkus semua komponen dalam Penyedia.  App.js yang diperbarui terlihat seperti ini: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {Container, Content} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'native-base'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {StyleSheet, Text, View} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-native'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> AppFooter <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./components/AppFooter.js'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {createStore} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {Provider} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> reducers <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./reducers'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> initialState = {}; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> store = createStore(reducers, initialState); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> styles = StyleSheet.create({ <span class="hljs-attr"><span class="hljs-attr">container</span></span>: { <span class="hljs-attr"><span class="hljs-attr">padding</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span> }, }); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> App = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Provider</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">store</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{store}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Container</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Content</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">View</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{styles.container}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> Lorem ipsum... </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">View</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Content</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">AppFooter</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Container</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Provider</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> App;</code> </pre><br>  Sekarang aplikasi kita dapat menyimpan kondisinya.  Mari manfaatkan ini.  Kami menambahkan status mode, secara default diatur ke ARTICLES.  Ini berarti bahwa pada render pertama, aplikasi kita akan diatur untuk menampilkan daftar artikel. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> initialState = { <span class="hljs-attr"><span class="hljs-attr">mode</span></span>: <span class="hljs-string"><span class="hljs-string">'ARTICLES'</span></span> };</code> </pre><br>  Tidak buruk, tetapi menulis nilai string secara manual menyebabkan potensi kesalahan.  Mari kita dapatkan konstanta.  Buat file ./constants/index.js dengan konten berikut: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> MODES = { <span class="hljs-attr"><span class="hljs-attr">ARTICLES</span></span>: <span class="hljs-string"><span class="hljs-string">'ARTICLES'</span></span>, <span class="hljs-attr"><span class="hljs-attr">PODCAST</span></span>: <span class="hljs-string"><span class="hljs-string">'PODCAST'</span></span> };</code> </pre><br>  Dan tulis ulang App.js: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {MODES} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./constants'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> initialState = { <span class="hljs-attr"><span class="hljs-attr">mode</span></span>: MODES.ARTICLES };</code> </pre><br>  Nah, ada keadaan, saatnya untuk meneruskannya ke komponen footer.  Mari kita lihat lagi ./components/AppFooter.js kami: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {Footer, FooterTab, Button, Text} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'native-base'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> AppFooter = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Footer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">FooterTab</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">active</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">FooterTab</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Footer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> AppFooter;</code> </pre><br>  Seperti yang dapat kita lihat, keadaan sakelar ditentukan menggunakan properti aktif dari komponen Button.  Mari kita dorong keadaan aplikasi saat ini ke Button.  Ini tidak sulit, komponen utama kap adalah komponen Penyedia yang kami terhubung sebelumnya.  Tetap hanya untuk mengambil status saat ini darinya dan memasukkan komponen AppFooter ke properti (alat peraga).  Pertama-tama, kami memodifikasi AppFooter kami sehingga keadaan tombol dapat dikontrol dengan melewati mode melalui alat peraga: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {Footer, FooterTab, Button, Text} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'native-base'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {MODES} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"../constants"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> AppFooter = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{mode = MODES.ARTICLES}</span></span></span><span class="hljs-function">) =&gt;</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Footer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">FooterTab</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">active</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{mode</span></span></span></span><span class="xml"><span class="hljs-tag"> === </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">MODES.ARTICLES}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">active</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{mode</span></span></span></span><span class="xml"><span class="hljs-tag"> === </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">MODES.PODCAST}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">FooterTab</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Footer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> AppFooter;</code> </pre><br>  Sekarang mari kita mulai membuat wadah.  Buat file ./containers/AppFooterContainer.js. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> AppFooter <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../components/AppFooter.js'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {MODES} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"../constants"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> AppFooterContainer = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">AppFooter</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">mode</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{MODES.ARTICLES}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> ); export default AppFooterContainer;</span></span></code> </pre> <br>  Dan hubungkan wadah AppFooterContainer di App.js bukannya komponen AppFooter.  Sejauh ini, wadah kami tidak berbeda dari komponen, tetapi semuanya akan berubah segera setelah kami menghubungkannya ke keadaan aplikasi.  Ayo lakukan! <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> AppFooter <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../components/AppFooter.js'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {connect} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> mapStateToProps = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">mode</span></span>: state.mode }); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> AppFooterContainer = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{mode}</span></span></span><span class="hljs-function">) =&gt;</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">AppFooter</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">mode</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{mode}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> ); export default connect( mapStateToProps )(AppFooterContainer);</span></span></code> </pre><br>  Sangat fungsional!  Semua fitur menjadi bersih.  Apa yang sedang terjadi di sini?  Kami menghubungkan wadah kami ke negara menggunakan fungsi terhubung dan menghubungkan alat peraga ke konten negara global menggunakan fungsi mapStateToProps.  Sangat bersih dan asri. <br><br>  Jadi, kami telah belajar mendistribusikan data dari atas ke bawah.  Sekarang kita perlu belajar bagaimana mengubah keadaan global kita dari bawah ke atas.  Tindakan dirancang untuk menghasilkan peristiwa tentang perlunya mengubah negara global.  Mari kita membuat tindakan yang terjadi ketika tombol diklik. <br><br>  Buat file ./actions/index.js: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { SET_MODE } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./actionTypes'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> setMode = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">mode</span></span></span><span class="hljs-function">) =&gt;</span></span> ({<span class="hljs-attr"><span class="hljs-attr">type</span></span>: SET_MODE, mode});</code> </pre><br>  Dan file ./actions/actionTypes, di mana kita akan menyimpan konstanta dengan nama tindakan: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> SET_MODE = <span class="hljs-string"><span class="hljs-string">'SET_MODE'</span></span>;</code> </pre><br>  Tindakan membuat objek dengan nama acara dan kumpulan data yang menyertai acara ini, dan tidak lebih.  Sekarang kita akan belajar bagaimana membuat acara ini.  Kami kembali ke wadah AppFooterContainer dan menghubungkan fungsi mapDispatchToProps yang akan menghubungkan event dispatcher ke alat peraga wadah. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> AppFooter <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../components/AppFooter.js'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {connect} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {setMode} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../actions'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> mapStateToProps = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">mode</span></span>: state.mode }); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> mapDispatchToProps = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">dispatch</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ setMode(mode) { dispatch(setMode(mode)); } }); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> AppFooterContainer = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{mode, setMode}</span></span></span><span class="hljs-function">) =&gt;</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">AppFooter</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">mode</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{mode}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">setMode</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{setMode}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> ); export default connect( mapStateToProps, mapDispatchToProps )(AppFooterContainer);</span></span></code> </pre><br>  Ya, kami memiliki fungsi yang memunculkan acara SET_MODE dan kami melewatkannya ke komponen AppFooter.  Masih ada dua masalah: <br><br>  Tidak ada yang memanggil fungsi ini. <br>  Tidak ada yang mendengarkan acara tersebut. <br><br>  Kami akan menangani masalah pertama.  Kami pergi ke komponen AppFooter dan menghubungkan panggilan ke fungsi setMode. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {Footer, FooterTab, Button, Text} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'native-base'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {MODES} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"../constants"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> AppFooter = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{mode = MODES.ARTICLES, setMode = (</span></span></span><span class="hljs-function">) =&gt;</span></span> {}}) =&gt; <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;Footer&gt; &lt;FooterTab&gt; &lt;Button active={mode === MODES.ARTICLES} onPress={ (</span></span></span><span class="hljs-function">) =&gt;</span></span> setMode(MODES.ARTICLES)}&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;<span class="hljs-regexp"><span class="hljs-regexp">/Button&gt; &lt;Button active={mode === MODES.PODCAST} onPress={ () =&gt; setMode(MODES.PODCAST)}&gt; &lt;Text&gt;&lt;/</span></span>Text&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;<span class="hljs-regexp"><span class="hljs-regexp">/FooterTab&gt; &lt;/</span></span>Footer&gt; ); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> AppFooter;</code> </pre><br>  Sekarang, ketika tombol ditekan, acara SET_MODE akan dinaikkan.  Masih belajar bagaimana mengubah negara global saat muncul.  Kami pergi ke ./reducers/index.js yang sebelumnya dibuat dan membuat peredam untuk acara ini: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { SET_MODE } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../actions/actionTypes'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> (state = [], action) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (action.type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> SET_MODE: { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.assign({}, state, { <span class="hljs-attr"><span class="hljs-attr">mode</span></span>: action.mode }); } <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> state } };</code> </pre><br>  Hebat!  Sekarang mengklik tombol menghasilkan suatu peristiwa yang mengubah keadaan global, dan catatan kaki, setelah menerima perubahan ini, menggambar ulang tombol. <br><br></div></div><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel asli</a> <br>  Benar, sangat sederhana?  Menakutkan membayangkan berapa banyak programmer yang mati karena usia tua pada proyek React Native dan berapa banyak uang yang dibayarkan untuk semua aib ini.  Hasil dari semua ini adalah contoh kecil, sedikit lebih rumit daripada Hello World. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pu/a8/at/pua8at2kpzufujza3a9kpzmvzqc.png"></div><br>  Sekali setelah program konser album "... Dan Keadilan untuk Semua" pada tahun 1988, pemimpin Metallica James Hetfield berkata, "Ini sangat ... tetapi tidak mungkin untuk bermain hidup-hidup."  Jadi, setelah saya menulis kode sampel pada React Native, saya menjadi solidaritas dengan James - itu adalah ... tetapi tidak mungkin untuk menulis hidup-hidup! <br><br>  Dan di sini adalah bagaimana hal yang sama dilakukan menggunakan kerangka kerja Kivy: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.app <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> App <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.factory <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Factory <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.lang <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Builder Builder.load_string(<span class="hljs-string"><span class="hljs-string">""" &lt;MyButton@Button&gt;: background_down: 'button_down.png' background_normal: 'button_normal.png' color: 0, 0, 0, 1 bold: True on_press: self.parent.parent.ids.textEdit.text = self.text; \ self.color = [.10980392156862745, .5372549019607843, .996078431372549, 1] on_release: self.color = [0, 0, 0, 1] &lt;MyActivity@BoxLayout&gt;: orientation: 'vertical' TextInput: id: textEdit BoxLayout: size_hint_y: None height: dp(45) MyButton: text: '' MyButton: text: '' """</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Program</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(App)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> my_activity = Factory.MyActivity() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> my_activity Program().run()</code> </pre><br>  Sangat sederhana sehingga komentar pun berlebihan di sini. <br><br>  Ya, Anda mungkin tidak tahu tentang ini, tetapi semuanya ditulis dalam Kivy: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">vimeo.com/29348760</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">vimeo.com/206290310</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">vimeo.com/25680681</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">www.youtube.com/watch?v=u4NRu7mBXtA</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">www.youtube.com/watch?v=9rk9OQLSoJw</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">www.youtube.com/watch?v=aa9LXpg_gd0</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">www.youtube.com/watch?v=FhRXAD8-UkE</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">www.youtube.com/watch?v=GJ3f88ebDqc&amp;t=111s</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">www.youtube.com/watch?v=D_M1I9GvpYs</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">www.youtube.com/watch?v=VotPQafL7Nw</a> <br><br>  Kesimpulannya, saya memberikan video aplikasi: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/-gfwyi7TgLI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Tulis di komentar artikel apa yang ingin Anda lihat tentang Kivy di halaman Habr.  Jika memungkinkan, semua keinginan akan terwujud.  Sampai ketemu lagi, dzzya! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id414353/">https://habr.com/ru/post/id414353/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id414343/index.html">Terjemahan Mesin Neural Google</a></li>
<li><a href="../id414345/index.html">Membalikkan pengembangan saklar waktu VL-76-S</a></li>
<li><a href="../id414347/index.html">Agresi pasif: bagaimana ia menghancurkan kehidupan kerja kita dan bagaimana menghadapinya</a></li>
<li><a href="../id414349/index.html">Dapatkan Statistik Biaya MCC: Tinkoff dan Rocketbank</a></li>
<li><a href="../id414351/index.html">Alat Musik Paling Tidak Biasa: Organ Hammond, Vako Orchestron dan Synclavier</a></li>
<li><a href="../id414355/index.html">Kehidupan setelah ledakan</a></li>
<li><a href="../id414357/index.html">Kami menggunakan Web Bluetooth API untuk menghubungkan monitor detak jantung dan mengembangkan aplikasi menggunakan Vue.js</a></li>
<li><a href="../id414359/index.html">Interaksi dengan server melalui API di iOS pada Swift 3. Bagian 1</a></li>
<li><a href="../id414361/index.html">Unity3D: Arsitektur Game, ScriptableObjects, Singletones</a></li>
<li><a href="../id414363/index.html">Intisari bahan-bahan segar dari dunia front-end untuk minggu terakhir No. 319 (11-17 Juni 2018)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>