<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëô üë©üèª‚Äçüöí ‚õìÔ∏è Como paramos de passar uma semana emitindo um stand-dev üïë üññüèæ üë∏üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Todo desenvolvedor quer seu pr√≥prio suporte para desenvolvedores. Cada testador quer sua pr√≥pria bancada de testes. E todo especialista em pr√©-produ√ß√£...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como paramos de passar uma semana emitindo um stand-dev</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/rencredit/blog/416815/">  Todo desenvolvedor quer seu pr√≥prio suporte para desenvolvedores.  Cada testador quer sua pr√≥pria bancada de testes.  E todo especialista em pr√©-produ√ß√£o quer seu pr√≥prio suporte - para finalmente verificar tudo e ensaiar o lan√ßamento no produto.  Quando toda essa lista de desejos converge no processamento - um dos maiores e mais ativos sistemas do banco - os custos de infraestrutura fazem voc√™ pensar e procurar "op√ß√µes".  Vamos contar sobre o que encontramos neste post. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a0e/f74/1d0/a0ef741d02ea7e944c115e6f0a34f1b0.png"></div><a name="habracut"></a><br>  O volume de bancos de dados de processamento em nossa empresa √© de cerca de 6 TB.  Em uma c√≥pia dos bancos de dados, os desenvolvedores interferem entre si, de modo que a quantidade real de espa√ßo ocupado pelas bases cresce rapidamente e proporcionalmente.  Embora qu√£o r√°pido ... muito r√°pido para o servi√ßo de acompanhante e n√£o r√°pido o suficiente para quem precisa de c√≥pias dos bancos de dados.  E aqui est√° o porqu√™. <br><br>  Para o teste, √© necess√°rio que o suporte de teste seja totalmente consistente com a vers√£o atual da produ√ß√£o (o mesmo se aplica ao suporte de pr√©-produ√ß√£o).  O backup principal do sistema √© copiado durante todo o dia e depois implantado no estande.  Durante essas opera√ß√µes demoradas, os estandes n√£o est√£o dispon√≠veis; portanto, a c√≥pia √© transferida para fins de semana e feriados quando ningu√©m trabalha com estandes.  Temos um atraso de 1 a 5 dias.  Para concordar preliminarmente com o processo de c√≥pia, tamb√©m leva tempo - temos v√°rias bancadas de teste, geralmente de tr√™s a seis.  Adicionamos 2-3 dias para coordenar o tempo de espera do suporte.  Antes de chegar ao administrador para aprova√ß√£o, o aplicativo ainda est√° na fila.  No total, temos um atraso muito grande. <br><br><h2>  O que ajudou o Delphix </h2><br>  O que pode acelerar o processo e economizar espa√ßo?  Virtualiza√ß√£o de banco de dados.  Consideramos diferentes op√ß√µes: Oracle SnapClone, NetApp + Oracle Cloud, apenas instant√¢neos em matrizes.  Tudo requer configura√ß√£o complexa.  Al√©m disso, as solu√ß√µes Oracle funcionam apenas com bancos de dados Oracle. <br><br>  Ent√£o olhei para Delphix.  √â f√°cil de implementar, suporta diferentes bancos de dados - Oracle, SQL Server, DB2, Sybase ASE.  Uma interface √© fornecida para todas as opera√ß√µes.  Por meio dele, desenvolvedores e testadores podem gerenciar independentemente suas c√≥pias - atualizar, salvar / restaurar o estado, parar / iniciar, etc.  H√° tamb√©m uma API e CLI para integra√ß√£o com sistemas de CI / CD ou seus processos. <br><br>  A implanta√ß√£o do Delphix em si n√£o leva muito tempo - v√°rias horas.  A fonte pode ser conectada por muito mais tempo, aqui o tempo √© proporcional ao tamanho.  No nosso caso, a fonte era uma c√≥pia de vendas do banco de dados e sua conex√£o levou quase um dia.  A prepara√ß√£o da origem e dos servidores para clones do banco de dados n√£o requer trabalho especial.  No servidor de destino, voc√™ precisa instalar o ORACLE_HOME apropriado e tamb√©m criar um usu√°rio especial para se conectar.  Para c√≥pias de teste virtuais, usamos os mesmos servidores que anteriormente tinham c√≥pias f√≠sicas. <br><br>  O Delphix permite criar bancadas de teste quase em tempo real, sem nenhuma coordena√ß√£o, porque as bancadas s√£o completamente isoladas uma da outra.  Algum tempo √© gasto apenas na atualiza√ß√£o do banco de dados para o estado atual - de 20 minutos a v√°rias horas, n√£o h√° d√∫vida de dias. <br><br>  Tentamos realizar testes de estresse em condi√ß√µes o mais pr√≥ximo poss√≠vel do produto.  Se o produto for produzido em discos f√≠sicos - a carga tamb√©m permanecer√°.  Nesse caso, o bot√£o Delphix V2P ajuda, o que permite criar um banco de dados "honesto" a partir de um virtual. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ebc/e68/e50/ebce68e5021b33c29f67bffc947c2f3f.png"><br><br>  Quanto √† economia de espa√ßo em disco, as leituras do painel Delphix, √© claro, s√£o enganosas - uma redu√ß√£o de 73 vezes no volume √© fabulosa demais.  Em nosso processamento, uma c√≥pia da venda com instant√¢neos di√°rios e logs de transa√ß√µes arquivados por 2 semanas (200 GB por dia) ocupa 4,5 TB de espa√ßo em disco.  Outros 1,5 TB - nove clones de tamanhos de 50 a 500 GB, cada um dos quais tamb√©m armazena um hist√≥rico de instant√¢neos di√°rios.  No total, 6 TB s√£o obtidos. <br><br>  Adicionamos outros 15% de espa√ßo livre (900 GB) para que o Delphix possa funcionar normalmente.  Assim, gastando apenas cerca de 7 TB, podemos obter uma c√≥pia de teste com dados relevantes a qualquer momento nas √∫ltimas duas semanas. <br><br>  Anteriormente, para armazenar nove c√≥pias f√≠sicas do banco de dados em 6 TB, precis√°vamos de 54 TB (ou ~ 20 TB levando em considera√ß√£o a compacta√ß√£o de 2 a 3 vezes no armazenamento).  E, diferentemente do novo sistema, aqui os desenvolvedores n√£o podiam gerenciar essas c√≥pias e restaurar os estados anteriores - quando os dados foram destru√≠dos, s√≥ era poss√≠vel recarregar a partir de uma c√≥pia da venda. <br><br>  O Delphix tamb√©m permite criar rapidamente diferentes ramifica√ß√µes do mesmo cont√™iner para diferentes projetos - e tudo isso em um per√≠odo m√≠nimo de tempo.  Os desenvolvedores n√£o t√™m medo de corromper os dados, podem reverter e restaurar seu estado anterior.  Isso aumenta o desempenho. <br><br><h2>  Mas h√° nuances ... </h2><br>  As impress√µes do Delphix s√£o principalmente positivas, embora nem tudo seja perfeito.  O maior problema √© usar discos.  Cada bloco de dados √© armazenado apenas uma vez para todas as c√≥pias virtuais e, at√© que todas as c√≥pias virtuais parem de usar o bloco, ele n√£o pode ser exclu√≠do.  Problemas organizacionais podem surgir aqui - nem todos os usu√°rios est√£o prontos para suportar o curto ciclo de vida de seus estandes.  Se a bancada de testes estiver em uma c√≥pia antiga, eu a venderei.  Resolvemos esse problema extensivamente, expandindo os discos, o que pode ser feito sem interromper o servi√ßo.  Garantimos que 15% do espa√ßo livre seja sempre salvo.  Se for menor, o sistema simplesmente interromper√° a execu√ß√£o de qualquer opera√ß√£o com c√≥pias virtuais.  Embora as pr√≥prias bases permane√ßam dispon√≠veis. <br><br>  Para sistemas com E / S de disco intensiva, √© prov√°vel que a largura de banda da rede seja um fator limitante.  Dependendo do perfil de carga espec√≠fico, o sistema pode come√ßar a funcionar melhor com a virtualiza√ß√£o.  Dependendo da carga, a lat√™ncia m√©dia de leitura seq√ºencial do arquivo db √© de 5 a 10 ms, o que √© bastante bom mesmo para sistemas industriais. <br><br>  As unidades "cl√°ssicas" Delphix s√£o conectadas de qualquer forma que suporte o ESX, e o fornecedor possui uma lista de recomenda√ß√µes sobre como fazer isso com desempenho m√°ximo.  N√≥s usamos SAN.  O pr√≥prio sistema apresenta os discos nos quais os arquivos do banco de dados virtual est√£o localizados, apenas atrav√©s do protocolo NFS.  Por esse motivo, voc√™ precisa ter cuidado com a largura de banda do canal e seu congestionamento.  No nosso caso, faz sentido colocar apenas arquivos de dados do Delphix em matrizes de disco, para que nenhuma atividade no banco afete a velocidade de E / S dos bancos de dados virtuais. <br><br>  Agora estamos trabalhando no Delphix 5.1.9, mas veja a vers√£o 5.2 - nela, a interface do usu√°rio deixou o flash e, de acordo com o fornecedor, tornou-se muito mais conveniente.  O Delphix impressionou nossos colegas e, ap√≥s o processamento, estamos considerando transferir perfil, CRM e Internet banking para esse sistema de desenvolvedores. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt416815/">https://habr.com/ru/post/pt416815/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt416801/index.html">A Duma do Estado em primeira leitura adotou um projeto de lei para cancelar o roaming</a></li>
<li><a href="../pt416805/index.html">Como passar um tempo em uma confer√™ncia de neg√≥cios para um bom uso? Dicas do ISPsystem bizdedev</a></li>
<li><a href="../pt416807/index.html">Jeffrey Richter chega √† R√∫ssia: an√∫ncio da confer√™ncia DotNext 2018 em Moscou</a></li>
<li><a href="../pt416809/index.html">Modelos de snooker Elo e EloBet</a></li>
<li><a href="../pt416813/index.html">Quando 2 x 3 = 2 ou mais uma vez sobre virtualiza√ß√£o de dados</a></li>
<li><a href="../pt416817/index.html">3¬∫ lugar na fase de qualifica√ß√£o do DataScienceGame 2018</a></li>
<li><a href="../pt416819/index.html">Adeus, microsservi√ßos: de cem crian√ßas problem√°ticas a uma estrela</a></li>
<li><a href="../pt416821/index.html">Como o JS funciona: comunica√ß√µes WebRTC e P2P</a></li>
<li><a href="../pt416823/index.html">Sangue, suor e pixels: o que √© o livro de Jason Schreier</a></li>
<li><a href="../pt416825/index.html">Como N√ÉO ser um desenvolvedor med√≠ocre</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>