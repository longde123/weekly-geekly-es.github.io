<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍃 🥟 🔠 使用Elasticsearch为竞争对手的价格监控服务进行产品匹配 👨‍👨‍👧‍👦 👓 🍭</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="早在2017年，便提出了开发竞争对手价格监控服务的想法。 它与其他类似服务的区别在于其每天自动进行商品匹配的功能。 显然，由于几乎完全没有有关如何执行此操作的信息，价格监控服务仅提供了由客户自己或服务运营商进行手动比较的可能性，每个比较的价格为0.2到1卢布。 例如，每个站点有10个站点和20,00...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>使用Elasticsearch为竞争对手的价格监控服务进行产品匹配</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428814/"> 早在2017年，便提出了开发竞争对手价格监控服务的想法。 它与其他类似服务的区别在于其每天自动进行商品匹配的功能。 显然，由于几乎完全没有有关如何执行此操作的信息，价格监控服务仅提供了由客户自己或服务运营商进行手动比较的可能性，每个比较的价格为0.2到1卢布。 例如，每个站点有10个站点和20,000种产品的实际情况不可避免地需要过程的自动化，因为手动匹配已经太长且昂贵。 <br><br> 下面将使用使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Elaticsearch</a>技术的众多竞争药店的示例来描述自动匹配的方法。 <br><a name="habracut"></a><br><h2> 环境说明 </h2><br><ol><li> 作业系统：Windows 10 </li><li> 依据：Elaticsearch 6.2 </li><li> 客户要求：邮递员6.2 </li></ol><br><h2> 设置Elaticsearch </h2><br> 一站式配置<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">产品</a>现场<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">映射器</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">分析仪</a> <br><br><pre><code class="hljs pgsql">PUT http://localhost:<span class="hljs-number"><span class="hljs-number">9200</span></span>/app { "mappings": { "product": { "properties": { "name": { "type": "text", "analyzer": "name_analyzer" #        }, "manufacturer": { "type": "text" }, "city_id": { "type": "integer" }, "company_id": { "type": "integer" }, "category_id": { "type": "integer" }, } } }, "settings": { "index": { "analysis": { "analyzer": { "name_analyzer": { "type": "custom", "tokenizer": "standard", #        ,       "char_filter": [ "html_strip", #       html  "comma_to_dot_char_filter" #    ,     ], "filter": [ "word_delimeter_filter", #     "synonym_filter", #    "lowercase" #      ] } }, "filter": { "synonym_filter": { "type": "synonym_graph", "synonyms": [ ", ", ", ", ", ", ", , ", ", ", ", , , ", ", ", ", ", ", , ", ", , ", ", , , -, -", ", , ", ", , , ", ", ", ", ", ", , ", ", , ", ", ", ", ", ", ", ", ", ", , , ", ", ", ", g", "ml, " ] }, "word_delimeter_filter": { "type": "word_delimiter", "type_table": [ ". =&gt; DIGIT", #       "- =&gt; ALPHANUM", "; =&gt; SUBWORD_DELIM", "` =&gt; SUBWORD_DELIM" ] } }, "char_filter": { "comma_to_dot_char_filter": { "type": "mapping", "mappings": [ ", =&gt; ." ] } } } } } }</code> </pre> <br> 例如，我们可以看一下分析仪“ name_analyzer”的哪个部分会破坏药物的名称“用于10g管外用的羟考酮10mg + 30mg / g软膏”。 我们使用请求<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">_analyze</a> 。 <br><br><pre> <code class="hljs pgsql">POST http://localhost:<span class="hljs-number"><span class="hljs-number">9200</span></span>/app/_analyze { "analyzer" : "name_analyzer", "text" : " 10+30/      10" }</code> </pre> <br> 结果 <br><pre> <code class="hljs objectivec">{ <span class="hljs-string"><span class="hljs-string">"tokens"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"token"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"start_offset"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"end_offset"</span></span>: <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"&lt;ALPHANUM&gt;"</span></span>, <span class="hljs-string"><span class="hljs-string">"position"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> }, { <span class="hljs-string"><span class="hljs-string">"token"</span></span>: <span class="hljs-string"><span class="hljs-string">"10"</span></span>, <span class="hljs-string"><span class="hljs-string">"start_offset"</span></span>: <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-string"><span class="hljs-string">"end_offset"</span></span>: <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"&lt;ALPHANUM&gt;"</span></span>, <span class="hljs-string"><span class="hljs-string">"position"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }, { <span class="hljs-string"><span class="hljs-string">"token"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"start_offset"</span></span>: <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-string"><span class="hljs-string">"end_offset"</span></span>: <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"&lt;ALPHANUM&gt;"</span></span>, <span class="hljs-string"><span class="hljs-string">"position"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span> }, { <span class="hljs-string"><span class="hljs-string">"token"</span></span>: <span class="hljs-string"><span class="hljs-string">"30"</span></span>, <span class="hljs-string"><span class="hljs-string">"start_offset"</span></span>: <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-string"><span class="hljs-string">"end_offset"</span></span>: <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"&lt;ALPHANUM&gt;"</span></span>, <span class="hljs-string"><span class="hljs-string">"position"</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span> }, { <span class="hljs-string"><span class="hljs-string">"token"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"start_offset"</span></span>: <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-string"><span class="hljs-string">"end_offset"</span></span>: <span class="hljs-number"><span class="hljs-number">19</span></span>, <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"&lt;ALPHANUM&gt;"</span></span>, <span class="hljs-string"><span class="hljs-string">"position"</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span> }, { <span class="hljs-string"><span class="hljs-string">"token"</span></span>: <span class="hljs-string"><span class="hljs-string">"g"</span></span>, <span class="hljs-string"><span class="hljs-string">"start_offset"</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-string"><span class="hljs-string">"end_offset"</span></span>: <span class="hljs-number"><span class="hljs-number">21</span></span>, <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"SYNONYM"</span></span>, <span class="hljs-meta"><span class="hljs-meta">#,   </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"g"</span></span></span><span class="hljs-meta">   SYNONYM,  ,          </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">", g"</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"position"</span></span></span><span class="hljs-meta">: 5 }, { </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"token"</span></span></span><span class="hljs-meta">: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">""</span></span></span><span class="hljs-meta">, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"start_offset"</span></span></span><span class="hljs-meta">: 20, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"end_offset"</span></span></span><span class="hljs-meta">: 21, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"type"</span></span></span><span class="hljs-meta">: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"&lt;ALPHANUM&gt;"</span></span></span><span class="hljs-meta">, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"position"</span></span></span><span class="hljs-meta">: 5 }, { </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"token"</span></span></span><span class="hljs-meta">: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">""</span></span></span><span class="hljs-meta">, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"start_offset"</span></span></span><span class="hljs-meta">: 22, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"end_offset"</span></span></span><span class="hljs-meta">: 26, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"type"</span></span></span><span class="hljs-meta">: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"&lt;ALPHANUM&gt;"</span></span></span><span class="hljs-meta">, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"position"</span></span></span><span class="hljs-meta">: 6 }, { </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"token"</span></span></span><span class="hljs-meta">: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">""</span></span></span><span class="hljs-meta">, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"start_offset"</span></span></span><span class="hljs-meta">: 27, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"end_offset"</span></span></span><span class="hljs-meta">: 30, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"type"</span></span></span><span class="hljs-meta">: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"&lt;ALPHANUM&gt;"</span></span></span><span class="hljs-meta">, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"position"</span></span></span><span class="hljs-meta">: 7 }, { </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"token"</span></span></span><span class="hljs-meta">: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">""</span></span></span><span class="hljs-meta">, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"start_offset"</span></span></span><span class="hljs-meta">: 31, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"end_offset"</span></span></span><span class="hljs-meta">: 40, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"type"</span></span></span><span class="hljs-meta">: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"&lt;ALPHANUM&gt;"</span></span></span><span class="hljs-meta">, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"position"</span></span></span><span class="hljs-meta">: 8 }, { </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"token"</span></span></span><span class="hljs-meta">: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">""</span></span></span><span class="hljs-meta">, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"start_offset"</span></span></span><span class="hljs-meta">: 41, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"end_offset"</span></span></span><span class="hljs-meta">: 51, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"type"</span></span></span><span class="hljs-meta">: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"&lt;ALPHANUM&gt;"</span></span></span><span class="hljs-meta">, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"position"</span></span></span><span class="hljs-meta">: 9 }, { </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"token"</span></span></span><span class="hljs-meta">: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">""</span></span></span><span class="hljs-meta">, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"start_offset"</span></span></span><span class="hljs-meta">: 52, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"end_offset"</span></span></span><span class="hljs-meta">: 56, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"type"</span></span></span><span class="hljs-meta">: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"&lt;ALPHANUM&gt;"</span></span></span><span class="hljs-meta">, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"position"</span></span></span><span class="hljs-meta">: 10 }, { </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"token"</span></span></span><span class="hljs-meta">: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"10"</span></span></span><span class="hljs-meta">, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"start_offset"</span></span></span><span class="hljs-meta">: 57, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"end_offset"</span></span></span><span class="hljs-meta">: 59, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"type"</span></span></span><span class="hljs-meta">: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"&lt;ALPHANUM&gt;"</span></span></span><span class="hljs-meta">, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"position"</span></span></span><span class="hljs-meta">: 11 }, { </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"token"</span></span></span><span class="hljs-meta">: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"g"</span></span></span><span class="hljs-meta">, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"start_offset"</span></span></span><span class="hljs-meta">: 59, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"end_offset"</span></span></span><span class="hljs-meta">: 60, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"type"</span></span></span><span class="hljs-meta">: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SYNONYM"</span></span></span><span class="hljs-meta">, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"position"</span></span></span><span class="hljs-meta">: 12 }, { </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"token"</span></span></span><span class="hljs-meta">: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">""</span></span></span><span class="hljs-meta">, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"start_offset"</span></span></span><span class="hljs-meta">: 59, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"end_offset"</span></span></span><span class="hljs-meta">: 60, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"type"</span></span></span><span class="hljs-meta">: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"&lt;ALPHANUM&gt;"</span></span></span><span class="hljs-meta">, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"position"</span></span></span><span class="hljs-meta">: 12 } ] }</span></span></code> </pre> <br><h2> 填充测试数据 </h2><br> 请求<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">_bulk</a> <br><br><pre> <code class="hljs ruby">POST <span class="hljs-symbol"><span class="hljs-symbol">http:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/localhost:9200/</span></span>_bulk { <span class="hljs-string"><span class="hljs-string">"index"</span></span>: { <span class="hljs-string"><span class="hljs-string">"_index"</span></span>: <span class="hljs-string"><span class="hljs-string">"app"</span></span>, <span class="hljs-string"><span class="hljs-string">"_type"</span></span>: <span class="hljs-string"><span class="hljs-string">"product"</span></span>, <span class="hljs-string"><span class="hljs-string">"_id"</span></span>: <span class="hljs-number"><span class="hljs-number">195111</span></span> } } { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">" 10+30/      10"</span></span>, <span class="hljs-string"><span class="hljs-string">"manufacturer"</span></span>: <span class="hljs-string"><span class="hljs-string">"   "</span></span>, <span class="hljs-string"><span class="hljs-string">"city_id"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"company_id"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">"category_id"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> } { <span class="hljs-string"><span class="hljs-string">"index"</span></span>: { <span class="hljs-string"><span class="hljs-string">"_index"</span></span>: <span class="hljs-string"><span class="hljs-string">"app"</span></span>, <span class="hljs-string"><span class="hljs-string">"_type"</span></span>: <span class="hljs-string"><span class="hljs-string">"product"</span></span>, <span class="hljs-string"><span class="hljs-string">"_id"</span></span>: <span class="hljs-number"><span class="hljs-number">195222</span></span> } } { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"     10 +30 /: 10 "</span></span>, <span class="hljs-string"><span class="hljs-string">"manufacturer"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"city_id"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"company_id"</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-string"><span class="hljs-string">"category_id"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }</code> </pre><br><h2> 映射搜索 </h2><br> 让我们要寻找竞争对手的所有相似产品的客户产品具有特征 <br><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"     10 +30 /   10 "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"manufacturer"</span></span>: <span class="hljs-string"><span class="hljs-string">"   "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"city_id"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"company_id"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"category_id"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }</code> </pre><br> 在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">药品目录中，我们</a>从产品名称中选择药品名称。 在这种情况下，单词“ Hyoxysone”。 此单词将是必填条件。 <br><br> 我们还将名称中的所有数字“ 10 30 10”删去，它们也是必不可少的标准。 此外，如果将某个数量包括两次，则在找到的商品中也应该出现两次，否则我们将增加与错误商品相符的机会。 <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">_搜索</a>请求 <br><br><pre> <code class="hljs powershell">GET http://localhost:<span class="hljs-number"><span class="hljs-number">9200</span></span>/app/product/_search { <span class="hljs-string"><span class="hljs-string">"query"</span></span>: { <span class="hljs-string"><span class="hljs-string">"bool"</span></span>: { <span class="hljs-string"><span class="hljs-string">"filter"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"terms"</span></span>: { <span class="hljs-string"><span class="hljs-string">"company_id"</span></span>: [ <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span> ] } }, { <span class="hljs-string"><span class="hljs-string">"term"</span></span>: { <span class="hljs-string"><span class="hljs-string">"city_id"</span></span>: { <span class="hljs-string"><span class="hljs-string">"value"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"boost"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> } } }, { <span class="hljs-string"><span class="hljs-string">"term"</span></span>: { <span class="hljs-string"><span class="hljs-string">"category_id"</span></span>: { <span class="hljs-string"><span class="hljs-string">"value"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"boost"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> } } } ], <span class="hljs-string"><span class="hljs-string">"must"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"bool"</span></span>: { <span class="hljs-string"><span class="hljs-string">"should"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"match"</span></span>: { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: { <span class="hljs-string"><span class="hljs-string">"query"</span></span>: <span class="hljs-string"><span class="hljs-string">"    + /   "</span></span>, <span class="hljs-string"><span class="hljs-string">"boost"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"operator"</span></span>: <span class="hljs-string"><span class="hljs-string">"or"</span></span>, <span class="hljs-string"><span class="hljs-string">"minimum_should_match"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"fuzziness"</span></span>: <span class="hljs-string"><span class="hljs-string">"AUTO"</span></span> } } } ], <span class="hljs-string"><span class="hljs-string">"must"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"match"</span></span>: { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: { <span class="hljs-string"><span class="hljs-string">"query"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"boost"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">"operator"</span></span>: <span class="hljs-string"><span class="hljs-string">"or"</span></span>, <span class="hljs-string"><span class="hljs-string">"minimum_should_match"</span></span>: <span class="hljs-string"><span class="hljs-string">"70%"</span></span>, <span class="hljs-string"><span class="hljs-string">"fuzziness"</span></span>: <span class="hljs-string"><span class="hljs-string">"AUTO"</span></span> } } }, { <span class="hljs-string"><span class="hljs-string">"match_phrase"</span></span>: { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: { <span class="hljs-string"><span class="hljs-string">"query"</span></span>: <span class="hljs-string"><span class="hljs-string">"10 30 10"</span></span>, <span class="hljs-string"><span class="hljs-string">"boost"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">"slop"</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span> } } } ] } } ], <span class="hljs-string"><span class="hljs-string">"should"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"bool"</span></span>: { <span class="hljs-string"><span class="hljs-string">"should"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"match"</span></span>: { <span class="hljs-string"><span class="hljs-string">"manufacturer"</span></span>: { <span class="hljs-string"><span class="hljs-string">"query"</span></span>: <span class="hljs-string"><span class="hljs-string">"   "</span></span>, <span class="hljs-string"><span class="hljs-string">"boost"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"operator"</span></span>: <span class="hljs-string"><span class="hljs-string">"or"</span></span>, <span class="hljs-string"><span class="hljs-string">"minimum_should_match"</span></span>: <span class="hljs-string"><span class="hljs-string">"70%"</span></span>, <span class="hljs-string"><span class="hljs-string">"fuzziness"</span></span>: <span class="hljs-string"><span class="hljs-string">"AUTO"</span></span> } } }, { <span class="hljs-string"><span class="hljs-string">"match"</span></span>: { <span class="hljs-string"><span class="hljs-string">"manufacturer"</span></span>: { <span class="hljs-string"><span class="hljs-string">"query"</span></span>: <span class="hljs-string"><span class="hljs-string">"alenta armacevtika "</span></span>, <span class="hljs-string"><span class="hljs-string">"boost"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"operator"</span></span>: <span class="hljs-string"><span class="hljs-string">"or"</span></span>, <span class="hljs-string"><span class="hljs-string">"minimum_should_match"</span></span>: <span class="hljs-string"><span class="hljs-string">"70%"</span></span>, <span class="hljs-string"><span class="hljs-string">"fuzziness"</span></span>: <span class="hljs-string"><span class="hljs-string">"AUTO"</span></span> } } } ] } } ] } }, <span class="hljs-string"><span class="hljs-string">"highlight"</span></span>: { <span class="hljs-string"><span class="hljs-string">"fields"</span></span>: { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: {} } }, <span class="hljs-string"><span class="hljs-string">"size"</span></span>: <span class="hljs-number"><span class="hljs-number">50</span></span> }</code> </pre> <br> 在输出中，我们获得商品的ID，以及它们的名称+得分（用于分析）以及匹配的匹配片段。 <br><br><ul><li>  <b>羟考松</b> <b>10</b> <b>mg</b> + <b>30</b> <b>mg</b> / <b>g</b> <b>外用软膏</b> <b>，</b> <b>管</b> <b>10</b> <b>g-</b>算法得分：69.84 </li><li>  <b>外用HYOXISON</b> <b>软膏</b> <b>10</b> <b>mg</b> + <b>30</b> <b>mg</b> / <b>g</b> ： <b>10</b> <b>g-</b>算法评估：49.79 </li></ul><br><h2> 结论 </h2><br> 所描述的方法肯定不会给出100％的匹配精度，但是它将极大地促进商品的手动匹配过程。 也适用于不需要绝对精度的任务。 <br> 通常，如果您使用其他启发式方法来改进搜索查询并增加同义词的数量，则可以获得接近令人满意的结果。 <br> 此外，在旧i7上进行的性能测试显示出良好的结果。 在几秒钟内执行200,000个产品的阵列中的10个搜索查询。 您可以<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在这里</a>看到这个现场医学实例。 <br><br> 在评论中提出您的选择，匹配方式。 <br><br> 感谢您的关注！ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN428814/">https://habr.com/ru/post/zh-CN428814/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN428800/index.html">烹饪完美的CSS</a></li>
<li><a href="../zh-CN428806/index.html">消费者支票分析：他们在亚马逊购买的商品</a></li>
<li><a href="../zh-CN428808/index.html">学生生活中的不便</a></li>
<li><a href="../zh-CN428810/index.html">18种音频数字技术材料</a></li>
<li><a href="../zh-CN428812/index.html">TypeScript：使用属性的类型验证将JSON反序列化为类</a></li>
<li><a href="../zh-CN428816/index.html">物料设计：形状-通过更改元素的形状来改进Android应用程序（不仅是）的GUI的技巧</a></li>
<li><a href="../zh-CN428818/index.html">DeOldify：用于为黑白图像着色的程序</a></li>
<li><a href="../zh-CN428820/index.html">您正在使用第三人称3D：Oculus Go + Raspberry Pi</a></li>
<li><a href="../zh-CN428822/index.html">小小的黑客故事，或者是足够的错误本地互联网提供商的赏金</a></li>
<li><a href="../zh-CN428824/index.html">超出合理范围的望远镜</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>