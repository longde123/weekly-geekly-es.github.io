<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüë®‚Äçüëß‚Äçüëß ü•Ä üëÇ Anniversaires sur Google Agenda avec l'√¢ge üß§ üçΩÔ∏è üë©üèª‚Äç‚öñÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Depuis de nombreuses ann√©es, j'utilise Google Calendar. Il √©tait toujours incompr√©hensible pourquoi il n'affiche pas l'√¢ge des personnes de Google Con...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Anniversaires sur Google Agenda avec l'√¢ge</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/481858/"><p>  Depuis de nombreuses ann√©es, j'utilise Google Calendar.  Il √©tait toujours incompr√©hensible pourquoi il n'affiche pas l'√¢ge des personnes de Google Contacts au moment de la naissance, de l'anniversaire ou d'autres √©v√©nements importants. </p><br><p><img src="https://habrastorage.org/webt/-1/dk/uh/-1dkuhbspamx9n-eijb0w3w3vus.jpeg"></p><br><p>  Lorsque j'ai commenc√© √† rechercher d√©lib√©r√©ment la r√©ponse √† cette question, j'ai constat√© que la <a href="https://www.google.com/search%3Fq%3DGoogle%2Bcalendar%2Bage" rel="nofollow">demande d'affichage de l'√¢ge dans le calendrier de Google √©tait</a> tr√®s populaire et qu'il n'y avait toujours pas de r√©ponse d√©finitive.  Cela m'a encourag√© √† cr√©er une solution bas√©e sur Google Apps Script. </p><a name="habracut"></a><br><h2 id="pochemu-imenno-gugl-skripty">  Pourquoi des scripts Google? </h2><br><p>  Je ne voulais pas utiliser de plateforme ou de service tiers, car tous mes contacts se trouvent dans le carnet d'adresses Google.  Je ne voulais pas non plus utiliser une application ou un module compl√©mentaire qui collecterait mes donn√©es personnelles √† des fins incompr√©hensibles.  Une structure de travail transparente √©tait n√©cessaire. </p><br><h2 id="gde-kod">  O√π est le code? </h2><br><p>  Je ne peux pas dire que le script a √©t√© √©crit √† partir de z√©ro - j'ai profit√© des <a href="https://productforums.google.com/forum/" rel="nofollow">d√©veloppements de Bryan Patterson</a> , qui ont √©t√© publi√©s il y a d√©j√† 6 ans, en 2014. </p><br><p>  Voici le r√©sultat: </p><br><div class="spoiler">  <b class="spoiler_title">Anniversaires et anniversaires avec des dates pour votre calendrier.gs</b> <div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   var contactsCal; var defaultCal; var now; var fromDate; var toDate; var events; //  (function() { contactsCal = CalendarApp.getCalendarById('addressbook#contacts@group.v.calendar.google.com'); defaultCal = CalendarApp.getDefaultCalendar(); //       // var defaultCal = CalendarApp.getCalendarById('regrncqXXXXXXp07eihepag74@group.calendar.google.com'); //   now = new Date(); fromDate = new Date(now.getTime()); toDate = new Date(now.getTime() + 31 * (1000 * 60 * 60 * 24)); // + 31     Logger.log(' : ' + Utilities.formatDate(fromDate, 'Asia/Yekaterinburg', 'MMMM dd, yyyy HH:mm:ss Z')); Logger.log(' : ' + Utilities.formatDate(toDate, 'Asia/Yekaterinburg', 'MMMM dd, yyyy HH:mm:ss Z')); events = contactsCal.getEvents(fromDate, toDate); Logger.log(' : ' + events.length); })(); function birthdayAgeToCalendar() { //  for (var i in events) { Logger.log('birthdayAgeToCalendar.  . : ' + events[i].getTitle()); var name = events[i].getTitle().split(" ‚Äì  ")[0]; var contacts = ContactsApp.getContactsByName(name); Logger.log('birthdayAgeToCalendar.  . Name: ' + name); for (var c in contacts) { var bday = contacts[c].getDates(ContactsApp.Field.BIRTHDAY); var bdayMonthName, bdayYear, bdayDate; try { bdayMonthName = bday[0].getMonth(); bdayYear = bday[0].getYear(); bdayDate = new Date(bdayMonthName + ' ' + bday[0].getDay() + ', ' + bdayYear); Logger.log('birthdayAgeToCalendar. bdayDate: ' + bdayDate); } catch (error) {} var years = parseInt(new Date().getFullYear()) - bdayYear; try { defaultCal.createAllDayEvent(name + " ‚Äì  , " + years + "  ()", new Date(bdayMonthName + ' ' + bday[0].getDay() + ', ' + new Date().getFullYear())); Logger.log(": " + name + " ‚Äì  , " + years + "  ()"); } catch (error) {} } } } function anniversaryAgeToCalendar() { // for (var i in events) { Logger.log('anniversaryAgeToCalendar. . : ' + events[i].getTitle()); var name = events[i].getTitle().split("   ")[1]; var contacts = ContactsApp.getContactsByName(name); Logger.log('anniversaryAgeToCalendar. . Name: ' + name); for (var c in contacts) { var bday = contacts[c].getDates(ContactsApp.Field.ANNIVERSARY); //   https://developers.google.com/apps-script/reference/contacts/field var bdayMonthName, bdayYear, bdayDate; try { bdayMonthName = bday[0].getMonth(); bdayYear = bday[0].getYear(); bdayDate = new Date(bdayMonthName + ' ' + bday[0].getDay() + ', ' + bdayYear); Logger.log('anniversaryAgeToCalendar. bdayDate: ' + bdayDate); } catch (error) {} var years = parseInt(new Date().getFullYear()) - bdayYear; try { defaultCal.createAllDayEvent("   " + name + ", " + years + "  ()", new Date(bdayMonthName + ' ' + bday[0].getDay() + ', ' + new Date().getFullYear())); Logger.log(": " + "   " + name + ", " + years + "  ()"); } catch (error) {} } } } function TriggersCreateTimeDriven() { //      // Deletes all triggers in the current project. var triggers = ScriptApp.getProjectTriggers(); for (var i = 0; i &lt; triggers.length; i++) { ScriptApp.deleteTrigger(triggers[i]); } //    ScriptApp.newTrigger("birthdayAgeToCalendar") //  .timeBased() .onMonthDay(1) //  .atHour(1) .create(); ScriptApp.newTrigger("anniversaryAgeToCalendar") // .timeBased() .onMonthDay(1) .atHour(2) .create(); }</span></span></code> </pre> </div></div><br><h2 id="kak-polzovatsya">  Comment utiliser? </h2><br><p>  1.Cr√©ez un nouveau script Google Apps sur Google Drive: </p><br><p><img src="https://habrastorage.org/webt/59/f5/2w/59f52wns2siahgtmgasilb2qwja.png"></p><br><p>  2. Copiez le code du script. </p><br><p>  3. Ex√©cutez le test de la fonction "birthdayAgeToCalendar" - le script cr√©era des √©v√©nements dans le calendrier par d√©faut indiquant l'√¢ge des personnes qui auront des anniversaires dans les 31 jours (mais cette ann√©e): </p><br><p><img src="https://habrastorage.org/webt/j2/qb/ga/j2qbgakicpj3tmd1nggjninwhsg.png"></p><br><p>  4.Voir Vue / Journaux: </p><br><p><img src="https://habrastorage.org/webt/nb/1a/gc/nb1agcmtllsqvjmx97lsajb5iro.png"></p><br><p>  5.V√©rifiez le calendrier: </p><br><p><img src="https://habrastorage.org/webt/vf/st/2o/vfst2ophti9827jzz5ycjegjbk8.png"></p><br><p>  6. Si tout est en ordre, ex√©cutez la fonction "TriggersCreateTimeDriven" - elle cr√©era un d√©marrage automatique des fonctions "birthdayAgeToCalendar" et "birthdayAgeToCalendar" pour chaque premier jour du mois √† l'avance. </p><br><h2 id="itog">  R√©sum√© </h2><br><p>  Je pense que le probl√®me d'affichage de l'√¢ge dans le calendrier Google lorsque des √©v√©nements importants se produisent a √©t√© r√©solu.  Je tiens √©galement √† remercier Yevgeny Namokonov ( <a href="https://t.me/google_sheets" rel="nofollow">cha√Æne de t√©l√©gramme "Google Sheets"</a> ) et Alexander Ivanov, ainsi que sa <a href="https://t.me/contributor_pw" rel="nofollow">cha√Æne de t√©l√©gramme,</a> pour leur aide dans la s√©paration et l'√©dition du code √©crit. </p><br><p>  Plus de d√©tails peuvent √™tre trouv√©s sur <a href="https://github.com/empenoso/Google-Apps-Script" rel="nofollow">GitHub</a> . </p><br><p>  Publi√© par: <a href="https://www.facebook.com/mikhail.shardin" rel="nofollow">Mikhail Shardin</a> , <br>  25 d√©cembre 2019 </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr481858/">https://habr.com/ru/post/fr481858/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr481846/index.html">Utilisation de GitHub CI pour les projets Elixir</a></li>
<li><a href="../fr481848/index.html">Formation du personnel exp√©riment√©</a></li>
<li><a href="../fr481850/index.html">L'Inquisition espagnole et le robot pour l'humiliation: quelles sont les conf√©rences "pr√©datrices" pour le fric</a></li>
<li><a href="../fr481852/index.html">Revue de l'imprimante 3D Anet N4 // Comment colorer de mani√®re r√©aliste un personnage de Dark Souls</a></li>
<li><a href="../fr481854/index.html">Tester des id√©es gr√¢ce au prototypage de tableaux de bord</a></li>
<li><a href="../fr481860/index.html">Que devrait faire l'informatique en 2020?</a></li>
<li><a href="../fr481862/index.html">Nvidia Jetson Embedded Machine Learning Systems</a></li>
<li><a href="../fr481866/index.html">DBA: lorsque le vide passe - nous nettoyons la table manuellement</a></li>
<li><a href="../fr481868/index.html">Dagaz: un nouveau d√©part</a></li>
<li><a href="../fr481874/index.html">M√©triques - indicateurs de la sant√© du projet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>