<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐑 📊 🤾🏼 FLProg-独立集成到自定义控制器的程序中 🌂 🚶 🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="很长时间以来，FLProg项目尚未在Habré中涉及。 这是由于没有时间写文章，甚至是我自己的个人问题。 但是该项目并没有死，它仍然存在并发展。 平均每月发布一次该程序的下一个版本。 自上次发布以来，该方案的渲染已完全重做（由于此，在渲染过程中消除了条纹），引入了该项目的交叉引用系统以及一个错误项目...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>FLProg-独立集成到自定义控制器的程序中</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467007/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/m4/sc/xc/m4scxccdteuasxjzm_whvn1bs9q.png"></div><br> 很长时间以来，FLProg项目尚未在Habré中涉及。 这是由于没有时间写文章，甚至是我自己的个人问题。 但是该项目并没有死，它仍然存在并发展。 平均每月发布一次该程序的下一个版本。 自<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">上次发布</a>以来，该方案的渲染已完全重做（由于此，在渲染过程中消除了条纹），引入了该项目的交叉引用系统以及一个错误项目分析系统。 程序代码本身已移植到编程语言的最新版本。 因此，从积极的一面（从我的角度来看，当然，用户会支持我）方面，程序界面已更改。 增加了许多有趣的块。 实现方案缩放和块搜索。 <br><a name="habracut"></a><br> 但是，该项目的主要问题仍然是该程序的开发人员是一个人（这就是我），而且中国人和我们的制造商最近制造的不同控制器板，传感器，传感器，扩展卡的数量一直在增长。 用户想尝试它们，或在他们的项目中使用它们。 对于外围设备，我一次或多或少地通过创建自定义块编辑器解决了这个问题。 正如他们所说的那样，这一步骤“射击”了，现在，几乎在大多数现有外围设备板上，Internet上或该<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">程序的论坛上</a> ，您都可以找到相应的用户块。 好吧，或者在同一个论坛中（或<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在Vkontakte的</a>一个<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">小组中</a> ），请当地专家撰写一份。 通常您可以以一种或另一种方式达成共识。 <br><br> 现在该解决第二个问题了-这些是控制器板。 <br><br> 最近，发布了该程序的Beta版本，编号为6.0。 在此版本中，实现了用于控制器用户描述的编辑器。 与自定义块一样，描述可以分组到库中，另存为单独的描述，也可以将整个库另存为文件并共享。 <br><br> 在这篇文章中，我将开始一系列至少两篇文章，我们将考虑如何使用此编辑器。 在第一篇文章中，在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">shiotiny</a>的允许下<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">，</a>我将尝试描述<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">他的ShIoTiny董事会。</a> 在第二篇文章中，我们将尝试虚拟提出一个真正的工业控制器的模拟物，并对其进行描述。 <br><br> 因此，让我们开始吧。 <br><br> 打开FLProg程序。 在“工具”菜单中，选择“控制器自定义描述编辑器”。 <br><br><img src="https://habrastorage.org/webt/x-/ut/xg/x-utxgu-j-yc6o4bxbij3ortuye.png"><br><br> 说明编辑器窗口打开。 <br><br> 定制描述可以在库中以任何嵌套深度进行组合。 因此，我们首先创建一个描述库。 <br><br><img src="https://habrastorage.org/webt/io/kh/cs/iokhcsgn0qt_kgc6zvf4nhmi8a4.png"><br><br> 设置库的名称。 <br><br><img src="https://habrastorage.org/webt/ir/l1/bd/irl1bdlbht21as-bsinayisfuzi.png"><br><br> 之后，我们将在库中创建控制器的描述。 <br><br><img src="https://habrastorage.org/webt/er/fr/60/erfr60lyicwjbbppzgshkypj6ha.png"><br><br> 给他起个名字： <br><br><img src="https://habrastorage.org/webt/zr/vw/of/zrvwofrlxkqwswrwq149hkmxlti.png"><br><br> 创建控制器描述时，我们立即进入常规参数分支。 <br><br><img src="https://habrastorage.org/webt/t7/u1/ct/t7u1ct8h0myo9vxvfjtapl58vpe.png"><br><br> 在这里，我们可以更改名称，设置CPU的类型，设置EEPROM的大小，更改描述的版本号。 <br><br> 由于ShloTiny开发板基于ESP8266控制器，因此我们选择它。 选择控制器时，将自动粘贴相应的EEPROM体积。 如有必要，可以更改此值。 新描述的默认版本号设置为1。 <br><br> 将来，当更改现有说明时，建议朝增加的方向进行更改。 在项目中使用此描述时，程序将比较项目和库中描述的版本。 如果库中描述的版本号大于项目中的描述的版本号，则用于更新程序中描述的项目将显示在程序的“项目”菜单中。 如果反之亦然，则将出现一个条目来更新库中的描述。 好吧，如果在库中根本找不到项目中使用的控制器的描述，则用于将项目中的描述输入到库中的项目将出现在同一菜单中。 <br><br> 同样在此线程中，您可以编写控制器的文本说明，以帮助其选择。 <br><br> 要应用在更改到另一个控制器参数分支之前所做的更改，请单击“应用”按钮。 如果不这样做，更改将不会保存。 <br><br> 现在考虑ShloTiny板的电路图。 <br><br><img src="https://habrastorage.org/webt/lq/wt/de/lqwtdebl8ssogd2rvcvvxbz9rd0.png"><br><br> 该评估板具有三个数字输入，三个数字输出，一个模拟输入和一个传感器输入。 董事会共有八项结论。 <br><br> 在编辑器中，转到“控制器结论”分支并设置结论数，然后不要忘记单击“应用”按钮。 <br><br><img src="https://habrastorage.org/webt/ls/wl/lb/lswllbh_hqil-hof8ydl6z7vn9y.png"><br><br> 该程序将生成所需数量的结论。 我们传递给他们中的第一个。 <br><br><img src="https://habrastorage.org/webt/4u/d9/ha/4ud9habaghl5ioujfwby0a-08tc.png"><br><br> 在此分支上，您可以指定一个备用输出名称，该名称将显示在程序中。 如果不存在，程序将显示PinN，其中N是引脚列表中的引脚号。 我建议您在备用名称字段上的板上写上题字。 这将使您更容易理解得出的结论。 对于上述电路板，我们将根据电路图在其中放置Input1的值。 因此，在此线程中，您可以编写输出的单独描述，例如，以指示其应用程序的功能。 如有必要，还可以为输出指定别名，该别名将在程序中输出名称后的方括号中显示。 <br><br> 进行更改后，请不要忘记单击“应用”按钮。 按照相同的原则，让我们称呼其余结论。 <br><br><img src="https://habrastorage.org/webt/bp/y6/1u/bpy61u53hnwuttwg6s4ttl7kq2y.png"><br><br> 在主要输出参数的同一分支中，将其执行的功能添加到其中。 <br><br><img src="https://habrastorage.org/webt/ks/ol/vt/ksolvtqefuyugg0s1aven_efhps.png"><br><br> 可以将以下功能分配给每个引脚。 <br><br><img src="https://habrastorage.org/webt/y8/04/cd/y804cdepj9pr9qgnji3h9ffan38.png"><br><br><ul><li>  I2C是I2C总线引脚之一（SDA或SCL）的功能。 </li><li>  SPI是SPI总线引脚之一（MISO，MOSI，SCK，SS）的功能。 </li><li>  UART是UART接口引脚之一（RX或TX）的功能。 </li><li> 模拟输入功能 </li><li> 模拟输出功能（尚未在FLProg中使用，将来会积压）。 </li><li> 数字输入/输出功能。 </li></ul><br> 分配引脚1数字输入/输出功能。 当为输出分配新功能（尚未配置）时，“错误”分支将出现在控制器树中，并且错误函数分支的整个路径将变为红色。 在“错误”分支上，您可以看到在控制器说明中找到的错误列表。 <br><br><img src="https://habrastorage.org/webt/fu/c5/l6/fuc5l68t2uqnnb018st1us7kp84.png"><br><br> 在这种情况下，“数字输入/输出”功能中的输入1不会将此输入的编号指定为数字。 我们切换到该功能的分支（将来，我计划在单击错误时直接转换到所需的分支）。 <br><br><img src="https://habrastorage.org/webt/m5/86/hp/m586hpytkvzarwhavx6lf1a2lcm.png"><br><br> 根据电路板的电路图，输出“ Input1”连接到控制器GPIO2引脚。 我们在“数字输入编号”字段中输入此值。 编译项目时，此值将插入代码中。 由于未提供使用此输入作为输出的功能，因此我们取消选中“可以用作输出”复选框。 与往常一样，单击“应用”按钮。 以相同的方式，配置其他两个数字输入。 然后转到模拟量输入“ ADC1”的输出，并向其中添加功能“ Analog Input”。 <br><br><img src="https://habrastorage.org/webt/i5/vb/6j/i5vb6johktcuk0mym00jifsptqm.png"><br><br> 在此功能的设置中，必须指定此输出的编号作为模拟输入。 根据方案，它是0（在ESP8266中是1）。 <br><br><img src="https://habrastorage.org/webt/jh/yl/vs/jhylvsjhmvsl6dbki2nsnmu-aoe.png"><br><br> 然后转到输出设置“ 1WIRE”。 在这里，我们向其添加了数字输入/输出功能，但是我们禁止同时使用其输入和输出。 结果，它将仅在传感器块中可供选择，而在创建输入和输出时不可用。 <br><br><img src="https://habrastorage.org/webt/5o/s-/3i/5os-3i6f-756ojmbhfn0jrblftm.png"><br><br> 输出“ K1”-“ K3”的设置与输入“ Input1”-“ Input3”的设置相似，仅在输出禁止的情况下才允许将它们用作输入。 <br><br><img src="https://habrastorage.org/webt/wc/vh/nl/wcvhnl5d42ola1rk3cmcgqltpjy.png"><br><br><img src="https://habrastorage.org/webt/e3/qj/1y/e3qj1yyzrzn36t-plzwu_nl7-sq.png"><br><br> 转到“图像”分支。 在其中，我们可以添加加载到控制器描述中的图像，例如，带有控制器的外观，引脚排列等。 <br><br> 请注意，图像直接加载到控制器描述中，并存储在使用它创建的项目中。 因此，请勿上传大图像。 这将导致项目规模的增加，并会影响项目的开放速度。 <br><br> 使用“添加图像”按钮添加图像。 <br><br><img src="https://habrastorage.org/webt/f_/ar/so/f_arso1h9wd207bcwxg0yx8rbjm.png"><br><br> 选择并加载图像后（仅支持PNG格式），将为树中的每个图像创建一个单独的分支。 在此分支中，您可以为下载的图像指定名称，该名称将显示在控制器信息中。 <br><br><img src="https://habrastorage.org/webt/9f/th/jb/9fthjbpdldgi5zzbmye2ior6kyw.png"><br><br> 如有必要，您可以上传多张图像并按所需顺序设置它们。 <br><br><img src="https://habrastorage.org/webt/b_/cv/lx/b_cvlxb8-0zaxazygmrj300mkhy.png"><br><br><img src="https://habrastorage.org/webt/ru/wh/nu/ruwhnuvfvcuhntsygr0hpapxed0.png"><br><br> 我们转到“标准块”分支。 <br><br><img src="https://habrastorage.org/webt/5e/nr/gg/5enrggudk1-qgs36xmh1ryem1f8.png"><br><br> 该分支显示了可以根据程序的当前设置在程序的标准块库中表示的块。 那是什么意思 该程序的某些构造块仅适用于某些类型的CPU。 它们的可用性取决于所选的处理器。 同样，仅当将相应功能添加到控制器引脚时，设计为与SPI，I2C，UART配合使用的模块才会出现在此列表中。 仅当在常规控制器参数的分支上指定的EEPROM大小大于零或将I2C功能添加到控制器引脚时，才会出现设计用于EEPROM的模块。 默认情况下，禁止使用库中的所有块（以橙色标记）。 通过突出显示必要的分支并单击“允许”按钮，或从上下文菜单中，可以允许使用单独的块或整个块文件夹。 <br><br><img src="https://habrastorage.org/webt/_g/-f/cc/_g-fccqwf5_0twhukgxs6wfxhwo.png"><br><br> 当您允许程序中显示一个块或一个块的文件夹时，它们会涂成黑色。 <br><br> 禁止以相同方式阻止块或单独的文件夹。 <br><br><img src="https://habrastorage.org/webt/dc/yo/4p/dcyo4p2p6mj8c1zqtj_p_mymupw.png"><br><br> 在不允许显示所有块的文件夹中，它们的名称前后带有三个星号。 <br><br> 我们禁止使用电动机，实时时钟，显示器，IR控制单元，传感器（DS18B20和DHT22传感器除外，因为板级开发人员到目前为止仅宣布支持），扩展芯片和压电扬声器。 <br><br><img src="https://habrastorage.org/webt/co/ip/ji/coipji0n9m9oho6ed6jjpuatuu8.png"><br><br> 我们将对LAD语言执行相同的操作 <br><br><img src="https://habrastorage.org/webt/h9/-u/xe/h9-uxez75k-8pyzyi08vk7z-p4m.png"><br><br> 进行更改后，请不要忘记应用它们。 <br><br> 控制器说明的其余分支将在下一篇文章中讨论，而当前设置足以在FLProg程序中使用此特定板。 <br><br> 现在，我只简单说一句“特殊块”分支用于将自定义块加载到描述中，这将使用此控制器显示在程序的标准块库中。  “特殊代码”分支用于编写将始终插入到已编译代码中的代码，“特殊库”分支用于将库加载到控制器的描述中，该描述将上载到\库ArduinoIDE文件夹中，程序可与该文件夹一起使用。 <br><br> 完成所有更改后，保存控制器描述库。 <br><br><img src="https://habrastorage.org/webt/x0/oe/d7/x0oed7fkffsba-owxcfxvgchyjm.png"><br><br> 现在，让我们尝试使用我们创建的控制器描述。 <br> 在FLProg程序中，我们为控制器创建一个新项目。 <br><br><img src="https://habrastorage.org/webt/dx/7w/ya/dx7wyao116azs1a2lwrpoa1tt4i.png"><br><br> 打开控制器选择窗口。 <br><br><img src="https://habrastorage.org/webt/l4/5f/wt/l45fwtcbztx_s8w9p71skiimmyo.png"><br><br> 并选择我们创建的描述。 <br><br><img src="https://habrastorage.org/webt/dq/ly/jp/dqlyjprofstw-fkadjd1jiguzl4.png"><br><br> 选择控制器时，您可以查看其图像，并在必要时将必要的内容保存到文件中。 <br><br><img src="https://habrastorage.org/webt/ba/ni/gw/banigw8zc9shyyogovawmcvlyxy.png"><br><br><img src="https://habrastorage.org/webt/rh/ra/ss/rhrasshfamvayeljiqnmceepo3g.png"><br><br> 您还可以看到其他参数 <br><br><img src="https://habrastorage.org/webt/gf/6p/wd/gf6pwdh-67cn9e8cbm0k4utlbw0.png"><br><br> 选择控制器后，确认其选择： <br><br><img src="https://habrastorage.org/webt/d0/7x/fy/d07xfyaacufag5wf1zqmcokjjd8.png"><br><br> 结果，将打开主项目工作窗口，该窗口根据所选控制器进行配置。 <br><br><img src="https://habrastorage.org/webt/dz/my/qj/dzmyqjeks591vtjfqnqhqnhvty4.png"><br><br> 这篇文章的目的不包括使用FLProg程序进行培训的任务。 在我<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">以前的帖子</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">项目网站</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">项目论坛中</a>对此进行了很好的描述。 此外，YouTube上已经有很多频道发布了有关使用该程序的视频教程。 例如，一个非常好的频道<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“ Arduino的钥匙”</a>刚刚进行了一系列课程，并很好地介绍了材料。 <br><br> 因此，例如，我们仅创建一个简单的项目并尝试对其进行编译。 <br> 首先，添加控制器输入。 <br><br><img src="https://habrastorage.org/webt/4c/94/wf/4c94wfvporudssfe-mdvmg6fenm.png"><br><br> 只有那些允许我们以此身份工作的结论才可供选择，以作为输入。 <br><br><img src="https://habrastorage.org/webt/yy/dk/fi/yydkfixeg0aemh73lrqunx1qq_a.png"><br><br> 然后创建一个数字输出。 此处仅提供允许的结论。 <br><br><img src="https://habrastorage.org/webt/mk/cq/qm/mkcqqm7djcs0klswidh2qkm2bt8.png"><br><br> 我们组装电路，以便在按下Input1（输入1）上的按钮时，继电器K1（Relay1）打开。 <br> 我们还从DS18B20传感器中拉出用于读取信息的单元，并将其放在单独的电路板上。 <br><br><img src="https://habrastorage.org/webt/xn/wa/2p/xnwa2pfpn7em5w2irs5meayndbc.png"><br><br> 转到块设置。 创建新的OneWire总线时，我们看到所有数字输入/输出均可供选择。 这是6.0版中的一个缺陷。 但由于此版本仍具有Beta状态，因此可以原谅。 在6.1版中，可以禁止将引脚用作传感器，传感器或扩展芯片。 另外，在下一篇文章中，我将告诉您另一种解决此问题的方法。 现在，选择1WIRE引脚。 <br><br><img src="https://habrastorage.org/webt/yi/0n/i0/yi0ni02zslfqijbthixnw4yeq_m.png"><br><br> 我们将传感器配置为通过阵列设置地址。 <br><br><img src="https://habrastorage.org/webt/nu/ft/9h/nuft9hg43uwk_toqi1yanem1miq.png"><br><br> 我们在第一个电路板的前面插入一块新的电路板，然后拉出其上的“ OneWire总线扫描”块。 <br><br><img src="https://habrastorage.org/webt/qv/21/r5/qv21r5i9ggwzcovlis6k9kg3f9u.png"><br><br> 我们将其配置在同一OneWire总线和同一阵列上，在该阵列上配置了DS18B20传感器的读取单元。 <br><br><img src="https://habrastorage.org/webt/vm/cm/ri/vmcmrigupgqdmnxfbb8fcwfuluc.png"><br><br> 我们使用触发器的R块（选择上升沿）为控制器启动时的总线扫描的一次启动组装了一个方案。 <br><br><img src="https://habrastorage.org/webt/vh/xd/2l/vhxd2l7bxk3afyi7obm1kaix9l0.png"><br><br> 在带有DS18B20传感器数据读取单元的板上，我们组装了具有滞后作用的继电器开/关电路。 为此，我们使用两个比较器和一个SR触发器。 由于采用了这种方案，继电器2将在温度下降到10度以下时打开，并在温度上升到20度以上时关闭。 <br><br><img src="https://habrastorage.org/webt/55/nw/3y/55nw3y062rknemyx2c7ouyavwgm.png"><br><br> 我们开始编译方案。 <br><br><img src="https://habrastorage.org/webt/oh/tr/so/ohtrso3_hk9k13yizhsgy8stp0o.png"><br><br> 结果，结果代码将在Arduino IDE中打开。 作为一块板，我们选择NodeMCU，其上安装的芯片与ShloTiny相同。 检查代码表明它正确无误，可以下载。 <br><br><img src="https://habrastorage.org/webt/lv/jy/dc/lvjydc9b531j1inhq5vuumgn0n0.png"><br><br><div class="spoiler">  <b class="spoiler_title">编译代码</b> <div class="spoiler_text"><pre><code class="plaintext hljs">#include &lt;OneWire.h&gt; extern "C" { #include "user_interface.h"; } OneWire _ow13(13); byte _FLPArray133289689[9]; unsigned long _d18x2x1Tti = 0UL; float _d18x2x1O = 0.00; bool _trgr1 = 0; bool _bounseInputD2S = 0; bool _bounseInputD2O = 0; unsigned long _bounseInputD2P = 0UL; bool _trgrt1 = 0; bool _trgrt1I = 0; bool _sowb1_needScan = 0; bool _sowb1_ost = 0; bool _sowb1_Out_1 = 0; void setup() { pinMode(2, INPUT); pinMode(12, OUTPUT); pinMode(14, OUTPUT); _bounseInputD2O = digitalRead(2); } void loop() { bool _bounceInputTmpD2 = (digitalRead (2)); if (_bounseInputD2S) { if (millis() &gt;= (_bounseInputD2P + 40)) { _bounseInputD2O = _bounceInputTmpD2; _bounseInputD2S = 0; } } else { if (_bounceInputTmpD2 != _bounseInputD2O ) { _bounseInputD2S = 1; _bounseInputD2P = millis(); } } //:1 if (1) { if (_trgrt1I) { _trgrt1 = 0; } else { _trgrt1 = 1; _trgrt1I = 1; } } else { _trgrt1 = 0; _trgrt1I = 0; }; if (_sowb1_needScan) { if ( _oneWireSeach (_FLPArray133289689, _ow13)) { _sowb1_Out_1 = 1; } _ow13.reset_search(); _sowb1_needScan = 0; } if (_trgrt1) { if (! _sowb1_ost) { _sowb1_ost = 1; _sowb1_needScan = 1; _sowb1_Out_1 = 0; } } else { _sowb1_ost = 0; } //:2 digitalWrite(12, !(_bounseInputD2O)); //:3 if (_isTimer(_d18x2x1Tti, 1000)) { _d18x2x1Tti = millis(); _d18x2x1O = _readDS18_ow13(_FLPArray133289689, _FLPArray133289689[8]); } if (((_d18x2x1O)) &gt; (20)) _trgr1 = 0; if (((_d18x2x1O)) &lt; (10)) _trgr1 = 1; digitalWrite(14, _trgr1); } bool _isTimer(unsigned long startTime, unsigned long period ) { unsigned long currentTime; currentTime = millis(); if (currentTime &gt;= startTime) { return (currentTime &gt;= (startTime + period)); } else { return (currentTime &gt;= (4294967295 - startTime + period)); } } float _convertDS18x2xData(byte type_s, byte data[12]) { int16_t raw = (data[1] &lt;&lt; 8) | data[0]; if (type_s) { raw = raw &lt;&lt; 3; if (data[7] == 0x10) { raw = (raw &amp; 0xFFF0) + 12 - data[6]; } } else { byte cfg = (data[4] &amp; 0x60); if (cfg == 0x00) raw = raw &amp; ~7; else if (cfg == 0x20) raw = raw &amp; ~3; else if (cfg == 0x40) raw = raw &amp; ~1; } return (float)raw / 16.0; } float _readDS18_ow13(byte addr[8], byte type_s) { byte data[12]; byte i; _ow13.reset(); _ow13.select(addr); _ow13.write(0xBE); for ( i = 0; i &lt; 9; i++) { data[i] = _ow13.read(); } _ow13.reset(); _ow13.select(addr); _ow13.write(0x44, 1); return _convertDS18x2xData(type_s, data); } bool _oneWireSeach (byte array[], OneWire ow ) { byte temp[8]; byte i; if ( !ow.search(temp)) { return false; } if (OneWire::crc8(temp, 7) != temp[7]) { return false; } switch (temp[0]) { case 0x10: array[8] = 1; break; case 0x28: array[8] = 0; break; case 0x22: array[8] = 0; break; default: return false; } for ( i = 0; i &lt; 8; i++) { array[i] = temp[i]; } return true; }</code> </pre> <br></div></div><br>  → <a href="">FLProg程序的ShloTiny控制器说明</a> <br><br> 我们将完成本课，在下一篇文章中，我们将尝试描述更严肃的，更接近“真实”工业控制器的事物。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN467007/">https://habr.com/ru/post/zh-CN467007/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN466993/index.html">配置警告下一代插件以与PVS-Studio集成</a></li>
<li><a href="../zh-CN466995/index.html">为PVS-Studio集成配置警告下一代插件</a></li>
<li><a href="../zh-CN466999/index.html">比较流行的Python Python CLI库：click，conce，fire和其他</a></li>
<li><a href="../zh-CN467003/index.html">适用于1075个类别的快速，便捷，自适应菜单（36000个产品）</a></li>
<li><a href="../zh-CN467005/index.html">如何正确为多项式着色</a></li>
<li><a href="../zh-CN467009/index.html">使用Notion和Python制作家庭图书馆</a></li>
<li><a href="../zh-CN467011/index.html">数据科学入门要阅读和看的内容：书籍，字典和课程</a></li>
<li><a href="../zh-CN467015/index.html">JWT：数字签名攻击与MAC攻击</a></li>
<li><a href="../zh-CN467017/index.html">什么是HED / MRSD，其用途是什么？</a></li>
<li><a href="../zh-CN467019/index.html">设计用于Web分析电子商务网站的仪表板。 第3部分：SEO频道</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>