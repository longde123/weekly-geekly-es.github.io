<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüëß ü•Ä ü§æüèΩ Windows 10 IoT Enterprise: secretos de configuraci√≥n para scripts integrados ‚úåüèª üò® üé¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pr√≥logo 
 Debe haber visto cajeros autom√°ticos, quioscos de informaci√≥n, paneles publicitarios que muestran un error o una notificaci√≥n del sistema. S...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Windows 10 IoT Enterprise: secretos de configuraci√≥n para scripts integrados</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/quarta/blog/413359/"><h2>  Pr√≥logo </h2><br>  Debe haber visto cajeros autom√°ticos, quioscos de informaci√≥n, paneles publicitarios que muestran un error o una notificaci√≥n del sistema.  Si no ha visto tales dispositivos p√∫blicos "vivos", puede encontrar f√°cilmente fotos similares en Internet si busca im√°genes de acuerdo con las palabras "error de ventanas ATM".  Y una vez que la notificaci√≥n del sistema apareci√≥ en vivo durante el pron√≥stico del tiempo, la foto se puede encontrar con las palabras "notificaci√≥n en vivo de Windows".  En aras del inter√©s, a√∫n puede buscar "la pantalla azul m√°s grande". <br><br><h2>  ¬øQu√© significa todo esto? </h2><br>  - ¬øTe gustan los gatos? <br>  - no <br>  - ¬°Simplemente no sabes c√≥mo cocinarlos! <br><br>  Para dispositivos especializados, Microsoft sugiere usar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Windows 10 <b>IoT</b> Enterprise</a> , que difiere de Windows 10 Enterprise solo en ausencia de aplicaciones universales.  En consecuencia, desde un punto de vista t√©cnico, Win 10 IoT Enterprise es un sistema operativo de escritorio que involucra la interacci√≥n del usuario.  Pero en dispositivos especializados, la interacci√≥n del usuario no deber√≠a ser porque  a veces ni siquiera hay un usuario en su sentido habitual, especialmente para paneles publicitarios. <br><a name="habracut"></a><br>  Al preparar un dispositivo especializado, algunos expertos t√©cnicos se olvidan del matiz anterior o se olvidan de desactivar cualquier categor√≠a de notificaciones.  Este art√≠culo est√° escrito para recordarle algunas caracter√≠sticas de la configuraci√≥n de Windows para soluciones especializadas.  En este art√≠culo consideraremos la preparaci√≥n de soluciones para una tarea empresarial. <br><br>  Todas las configuraciones se describir√°n para Win 10 IoT Enterprise 2016 LTSB, cuya versi√≥n demo se puede descargar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br><br><h2>  ¬øQu√© tarea empresarial resuelves? </h2><br>  Una vez que llegu√© al punto de recogida de una tienda en l√≠nea.  En esta tienda, los vendedores solo emit√≠an productos o los miraban, y el pedido solo deb√≠a realizarse en el sitio web de la tienda.  Para poder hacer un pedido directamente en el punto de recogida, se instalaron muchas PC en la sala de recogida.  Las PC estaban ocultas, solo hab√≠a un monitor y un mouse, se abri√≥ una base de tienda especializada en la pantalla, en la que era posible encontrar productos y hacer un pedido y un teclado en pantalla. <br><br>  Considere la posibilidad de preparar una soluci√≥n similar que se dise√±ar√° para navegar por el sitio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">www.quarta-embedded.ru</a> .  Condiciones de uso estimadas: sin fuente de alimentaci√≥n ininterrumpida y con un mantenimiento m√≠nimo. <br><br><h2>  Preparaci√≥n de soluciones </h2><br><h3>  Paso 1 - preparando el dispositivo </h3><br>  Como el dispositivo fue tomado una PC normal, con un disco duro de 120 GB, RAM 4 GB.  Modo de arranque del sistema operativo: heredado. <br><br>  Porque  nuestro dispositivo se utilizar√° sin fuente de alimentaci√≥n ininterrumpida, es imprescindible proporcionar cortes de energ√≠a no programados.  Es decir  el dispositivo debe encenderse solo cuando aparece una fuente de alimentaci√≥n, para esto debe configurar el BIOS del dispositivo en consecuencia.  Los elementos necesarios en el BIOS se pueden encontrar por los nombres intuitivos, lo tengo "Avanzado&gt; Opciones de encendido&gt; Despu√©s de la p√©rdida de energ√≠a", config√∫relo en "Encendido".  Pero si desea que el dispositivo permanezca apagado cuando se enciende cuando se apag√≥ intencionalmente, config√∫relo en "Estado anterior". <br><br><h3>  Paso 2 - Instalar Win 10 IoT </h3><br>  Instalar Win 10 IoT Enterprise no es diferente de instalar Win 10 Enterprise, por lo que no veo mucho sentido en describir la instalaci√≥n.  Instalar√© "Win 10 IoT Enterprise 2016 LTSB x32" sin una conexi√≥n a Internet para que nada "extra" ingrese al sistema.  En el primer arranque, cre√© el usuario administrador. <br><br><h3>  Paso 3: guarda la imagen del sistema </h3><br>  ¬øQu√©, no esperaba tal giro?  Acaba de instalar el sistema e inmediatamente guarde la imagen.  Al preparar una soluci√≥n, es aconsejable guardar peri√≥dicamente la imagen del sistema en caso de que algo salga mal de repente.  Entonces no necesitar√° hacer primero la configuraci√≥n del sistema. <br><br>  Cuando hablamos de crear una imagen, tocamos el tema de la replicaci√≥n, pero es tan amplio que se puede dedicar un art√≠culo separado y m√°s de uno, por lo que en este art√≠culo no describir√© este problema en detalle. <br><br>  Para crear una imagen tecnol√≥gica (intermedia), sellar√© el sistema con el comando <br><br><pre><code class="hljs perl">%SYSTEMROOT%\System32\Sysprep\sysprep.exe /audit /generalize /<span class="hljs-keyword"><span class="hljs-keyword">shutdown</span></span> /quiet</code> </pre> <br>  y cree una imagen wim del volumen del sistema utilizando la utilidad DISM. <br><br>  Importante: si sigue el mismo camino, luego de implementar dicha imagen, no olvide copiar el contenido del directorio "Windows \ System32 \ Recovery" al primer volumen en la carpeta "Recovery \ WindowsRE".  Y debe hacer esto antes de cargar el sistema operativo.  despu√©s de cargar el sistema operativo, el directorio "Windows \ System32 \ Recovery" ya estar√° vac√≠o.  Lo tengo implementado de la siguiente manera: <br><br><pre> <code class="hljs tex">if exist W:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Windows</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">System</span></span></span></span>32<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Recovery</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">*</span></span></span></span>.* ( xcopy W:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Windows</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">System</span></span></span></span>32<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Recovery</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">*</span></span></span></span>.* S:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Recovery</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WindowsRE</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"> </span></span></span></span>/h /k /y attrib +s +h +i S:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Recovery</span></span></span></span> attrib +s +h +i S:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Recovery</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">*</span></span></span></span>.* /s /d )</code> </pre><br>  Tenga en cuenta que despu√©s del sellado, el sistema iniciar√° sesi√≥n autom√°ticamente en la cuenta de administrador incorporada.  Y ahora sysprep se iniciar√° autom√°ticamente.  Para evitar que esta ventana me moleste, agregu√© un script de shell con un solo comando al shell: inicio <br><br><pre> <code class="hljs dos"><span class="hljs-built_in"><span class="hljs-built_in">taskkill</span></span> /im sysprep.exe</code> </pre> <br>  Para no olvidar eliminar el script, inmediatamente har√© un script para sellar, en el que se escribir√° el comando para limpiar la ejecuci√≥n autom√°tica. <br><br><pre> <code class="hljs dos"><span class="hljs-built_in"><span class="hljs-built_in">del</span></span> "<span class="hljs-variable"><span class="hljs-variable">%systemdrive%</span></span>\Users\Administrator\AppData\Roaming\Microsoft\Windows\<span class="hljs-built_in"><span class="hljs-built_in">Start</span></span> Menu\Programs\Startup\*.*" /q</code> </pre><br>  Despu√©s de todo, todav√≠a necesito sellar el sistema en modo oobe. <br>  Todos los archivos tecnol√≥gicos que colocar√© en la carpeta C: \ Sysprep <br><br><h3>  Paso 4 - instalaci√≥n del controlador </h3><br>  Curiosamente, pero algunos se quejan de que despu√©s de instalar Win 10 "los controladores no se instalaron por s√≠ mismos".  Me apresuro a molestarte, nada sucede por s√≠ solo, los controladores deben estar instalados.  El sistema viene con un cierto conjunto de controladores est√°ndar, pero es poco probable que con el conjunto est√°ndar de controladores sea posible utilizar todas las capacidades del equipo.  Es mejor si usted mismo instala los controladores m√°s adecuados para su dispositivo.  Windows puede descargar autom√°ticamente los controladores de un repositorio especial de Microsoft e instalarlos, pero no es necesario que todos los controladores necesarios est√©n all√≠ o que sean controladores adecuados.  El controlador que el sistema instala autom√°ticamente puede hacer que el sistema se bloquee.  ¬øQu√© hacer si se encuentra en una situaci√≥n en la que necesita evitar una instalaci√≥n autom√°tica de controladores?  Hay 2 opciones: <br><br>  1. Deshabilitar el servicio de actualizaci√≥n <br>  net stop wuauserv - comando de detenci√≥n del servicio <br>  sc config wuauserv start = disabled: cambia el modo de inicio del servicio a "Disabled" <br>  Pero en este caso, el sistema no recibir√° ninguna actualizaci√≥n <br><br>  2. Deshabilite la instalaci√≥n de un controlador espec√≠fico en las pol√≠ticas de grupo <br><br>  Para hacer esto, necesitas: <br><br>  Abra el Editor de directivas de grupo con gpedit <br><br>  Vaya a la secci√≥n "Configuraci√≥n del equipo \ Plantillas administrativas \ Sistema \ Instalaci√≥n del dispositivo \ Restricci√≥n en la instalaci√≥n de dispositivos".  Versi√≥n en ingl√©s de la rama "Configuraci√≥n del equipo \ Plantillas administrativas \ Sistema \ Instalaci√≥n del dispositivo \ Restricciones de instalaci√≥n del dispositivo" <br>  En esta secci√≥n, puede prohibir la instalaci√≥n de un controlador para una clase espec√≠fica o ID de equipo.  Para evitar que se instalen otros controladores, NO necesita seleccionar la casilla de verificaci√≥n "Aplicar tambi√©n a dispositivos coincidentes que ya est√°n instalados", de lo contrario, ser√° imposible usar el dispositivo. <br><br>  Porque  Tengo una soluci√≥n experimental y los controladores realmente no importan, no los instalar√© a prop√≥sito.  Despu√©s de conectarse a Internet, el sistema encontr√≥ un controlador para algunos dispositivos. <br><br><h3>  Paso 5: rusificaci√≥n del sistema </h3><br>  Creo que esta acci√≥n es muy simple y no necesita ser descrita en detalle.  Dir√© que para la correcta visualizaci√≥n del alfabeto cir√≠lico, especifiqu√© el idioma ruso para los programas que no son compatibles con Unicode.  Indic√≥ la ubicaci√≥n, aunque en mi caso esto no es necesario.  Y en el camino, puede cambiar la zona horaria como  el valor predeterminado es UTC -8.  Instal√© el paquete de idioma en ruso, cuando instal√© el paquete de idioma a trav√©s de Internet, me pareci√≥ largo, as√≠ que lo instal√© usando el paquete descargado previamente "Microsoft-Windows-Client-Language-Pack_x86_ru-ru.cab", instalado con el comando <br><br><pre> <code class="hljs perl">DISM /Online /Add-Package /PackagePath:<span class="hljs-string"><span class="hljs-string">"%~dp0Microsoft-Windows-Client-Language-Pack_x%PROCESSOR_ARCHITECTURE:~-2%_ru-ru.cab"</span></span></code> </pre><br>  Despu√©s de la instalaci√≥n, cambi√© el idioma principal del sistema al ruso y activ√© la opci√≥n de copiar la configuraci√≥n de idioma para la pantalla de bienvenida y las nuevas cuentas. <br>  Eso es todo, se ha agregado el idioma ruso, tal vez pueda guardar la imagen del sistema ... <br><br><h3>  Paso 6 - Configuraci√≥n de energ√≠a </h3><br>  Nuestro dispositivo no debe quedarse dormido y apagar el monitor, por lo que debe configurar la alimentaci√≥n en consecuencia.  La potencia se puede configurar usando el script: <br><br><pre> <code class="hljs powershell">powercfg <span class="hljs-literal"><span class="hljs-literal">-change</span></span> <span class="hljs-literal"><span class="hljs-literal">-monitor</span></span><span class="hljs-literal"><span class="hljs-literal">-timeout</span></span><span class="hljs-literal"><span class="hljs-literal">-ac</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> powercfg <span class="hljs-literal"><span class="hljs-literal">-change</span></span> <span class="hljs-literal"><span class="hljs-literal">-monitor</span></span><span class="hljs-literal"><span class="hljs-literal">-timeout</span></span><span class="hljs-literal"><span class="hljs-literal">-dc</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> powercfg <span class="hljs-literal"><span class="hljs-literal">-change</span></span> <span class="hljs-literal"><span class="hljs-literal">-disk</span></span><span class="hljs-literal"><span class="hljs-literal">-timeout</span></span><span class="hljs-literal"><span class="hljs-literal">-ac</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> powercfg <span class="hljs-literal"><span class="hljs-literal">-change</span></span> <span class="hljs-literal"><span class="hljs-literal">-disk</span></span><span class="hljs-literal"><span class="hljs-literal">-timeout</span></span><span class="hljs-literal"><span class="hljs-literal">-dc</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> powercfg <span class="hljs-literal"><span class="hljs-literal">-change</span></span> <span class="hljs-literal"><span class="hljs-literal">-standby</span></span><span class="hljs-literal"><span class="hljs-literal">-timeout</span></span><span class="hljs-literal"><span class="hljs-literal">-ac</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> powercfg <span class="hljs-literal"><span class="hljs-literal">-change</span></span> <span class="hljs-literal"><span class="hljs-literal">-standby</span></span><span class="hljs-literal"><span class="hljs-literal">-timeout</span></span><span class="hljs-literal"><span class="hljs-literal">-dc</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> powercfg <span class="hljs-literal"><span class="hljs-literal">-change</span></span> <span class="hljs-literal"><span class="hljs-literal">-hibernate</span></span><span class="hljs-literal"><span class="hljs-literal">-timeout</span></span><span class="hljs-literal"><span class="hljs-literal">-ac</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> powercfg <span class="hljs-literal"><span class="hljs-literal">-change</span></span> <span class="hljs-literal"><span class="hljs-literal">-hibernate</span></span><span class="hljs-literal"><span class="hljs-literal">-timeout</span></span><span class="hljs-literal"><span class="hljs-literal">-dc</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> pause</code> </pre><br><h3>  Paso 7: deshabilitar el modo de arranque de emergencia </h3><br>  El punto importante es que si nuestro dispositivo tiene un apagado incorrecto 2-3 veces seguidas, el sistema se iniciar√° en modo de recuperaci√≥n, y esto no deber√≠a permitirse.  Por lo tanto, apague este modo de arranque.  Esto se puede hacer usando el comando <br><br><pre> <code class="hljs pgsql">bcdedit /<span class="hljs-keyword"><span class="hljs-keyword">set</span></span> {<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>} bootstatuspolicy IgnoreAllFailures</code> </pre><br>  Tenga en cuenta que esta configuraci√≥n est√° registrada en el repositorio bcd, que se encuentra en la partici√≥n de recuperaci√≥n.  No guardo la secci√≥n de recuperaci√≥n mientras guardo la imagen del sistema, por lo tanto, despu√©s de implementar el sistema, esta configuraci√≥n estar√° en su estado original desde  Habr√° un nuevo almacenamiento bcd.  Para no olvidar esta configuraci√≥n, la agregar√© al script de sellado en modo oobe. <br><br><h3>  Paso 8: deshabilitar mensajes de error y notificaciones emergentes </h3><br>  Para que el sistema no muestre mensajes de error, una solicitud para enviar informes de errores, mensajes sobre problemas con el equipo, todo esto debe estar deshabilitado.  El servicio de pol√≠ticas de diagn√≥stico se puede configurar en pol√≠ticas de grupo: <br><br>  Configuraci√≥n del equipo \ Plantillas administrativas \ Sistema \ Diagn√≥stico <br>  Diagn√≥stico: configuraci√≥n del nivel de ejecuci√≥n del script: habilite "Detecci√≥n y solo diagn√≥stico" <br><br>  Pero es m√°s f√°cil para m√≠ configurar todo con un solo archivo de registro. <br><br><pre> <code class="hljs powershell">Windows Registry Editor Version <span class="hljs-number"><span class="hljs-number">5.00</span></span> ;    [<span class="hljs-type"><span class="hljs-type">HKEY_LOCAL_MACHINE</span></span>\<span class="hljs-type"><span class="hljs-type">SYSTEM</span></span>\<span class="hljs-type"><span class="hljs-type">CurrentControlSet</span></span>\<span class="hljs-type"><span class="hljs-type">Control</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span>] ;<span class="hljs-string"><span class="hljs-string">"ErrorMode"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000000</span></span> ;   ;<span class="hljs-string"><span class="hljs-string">"ErrorMode"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span> ;     . ,     <span class="hljs-string"><span class="hljs-string">"ErrorMode"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000002</span></span> ;    . ,   dll ;     [<span class="hljs-type"><span class="hljs-type">HKEY_LOCAL_MACHINE</span></span>\<span class="hljs-type"><span class="hljs-type">SOFTWARE</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span> <span class="hljs-type"><span class="hljs-type">Error</span></span> <span class="hljs-type"><span class="hljs-type">Reporting</span></span>] ;<span class="hljs-string"><span class="hljs-string">"Disabled"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000000</span></span> ;   <span class="hljs-string"><span class="hljs-string">"Disabled"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span> ;   ;       [<span class="hljs-type"><span class="hljs-type">HKEY_LOCAL_MACHINE</span></span>\<span class="hljs-type"><span class="hljs-type">SOFTWARE</span></span>\<span class="hljs-type"><span class="hljs-type">Policies</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span>\<span class="hljs-type"><span class="hljs-type">WDI</span></span>] ;<span class="hljs-string"><span class="hljs-string">"ScenarioExecutionEnabled"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000000</span></span> ;      <span class="hljs-string"><span class="hljs-string">"ScenarioExecutionEnabled"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span> ;      <span class="hljs-string"><span class="hljs-string">"EnabledScenarioExecutionLevel"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span> ;    ;<span class="hljs-string"><span class="hljs-string">"EnabledScenarioExecutionLevel"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000002</span></span> ;,    </code> </pre><br>  Las notificaciones emergentes se pueden configurar en las pol√≠ticas de grupo "Configuraci√≥n de usuario \ Plantillas administrativas \ Men√∫ Inicio y barra de tareas \ Notificaciones".  Pero es m√°s f√°cil para m√≠ activar el modo No molestar, se puede activar en la interfaz gr√°fica, en el centro de notificaciones y en el registro.  Porque  Esta configuraci√≥n se aplica a un usuario espec√≠fico, luego debe realizarla bajo el usuario objetivo.  Por lo tanto, creamos un usuario bajo el cual se ejecutar√° la aplicaci√≥n para uso p√∫blico.  Si bien este usuario estar√° en el grupo de administradores, para facilitar la configuraci√≥n.  Para que no haya problemas con el nombre del grupo ruso / ingl√©s, obtendr√© el nombre del grupo por SID. <br><br><pre> <code class="hljs pgsql">net <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> <span class="hljs-keyword"><span class="hljs-keyword">User</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">add</span></span> wmic useraccount <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> "Name='User'" <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> PasswordExpires=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> /f "tokens=2 delims==" %%i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'wmic group where "SID='</span></span>S<span class="hljs-number"><span class="hljs-number">-1</span></span><span class="hljs-number"><span class="hljs-number">-5</span></span><span class="hljs-number"><span class="hljs-number">-32</span></span><span class="hljs-number"><span class="hljs-number">-544</span></span><span class="hljs-string"><span class="hljs-string">'" get Name /value^|find "Name"'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> GroupName=%%i net localgroup %GroupName% <span class="hljs-keyword"><span class="hljs-keyword">User</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">add</span></span> pause</code> </pre><br>  Y encienda el modo no molestar. <br><br><pre> <code class="hljs powershell">Windows Registry Editor Version <span class="hljs-number"><span class="hljs-number">5.00</span></span> ;  <span class="hljs-string"><span class="hljs-string">" "</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_CURRENT_USER</span></span>\<span class="hljs-type"><span class="hljs-type">SOFTWARE</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span>\<span class="hljs-type"><span class="hljs-type">CurrentVersion</span></span>\<span class="hljs-type"><span class="hljs-type">Notifications</span></span>\<span class="hljs-type"><span class="hljs-type">Settings</span></span>] <span class="hljs-string"><span class="hljs-string">"NOC_GLOBAL_SETTING_TOASTS_ENABLED"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000000</span></span> ;  ;<span class="hljs-string"><span class="hljs-string">"NOC_GLOBAL_SETTING_TOASTS_ENABLED"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span> ; </code> </pre><br>  Para no olvidar excluir al usuario del grupo de administradores, agregar√© el comando de exclusi√≥n al script de sellado. <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> /f <span class="hljs-string"><span class="hljs-string">"tokens=2 delims=="</span></span> %%i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ('wmic group <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-string"><span class="hljs-string">"SID='S-1-5-32-544'"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> <span class="hljs-type"><span class="hljs-type">Name</span></span> /value^|<span class="hljs-built_in"><span class="hljs-built_in">find</span></span> <span class="hljs-string"><span class="hljs-string">"Name"</span></span>') <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-type"><span class="hljs-type">GroupName</span></span>=%%i net localgroup %<span class="hljs-type"><span class="hljs-type">GroupName</span></span>% <span class="hljs-type"><span class="hljs-type">User</span></span> /delete</code> </pre><br><h3>  Paso 9 - Configurar actualizaciones del sistema </h3><br>  No est√° de m√°s instalar todas las actualizaciones actuales en el momento de la preparaci√≥n del sistema.  Puede configurar actualizaciones basadas en los detalles de su dispositivo.  Puede deshabilitar la instalaci√≥n de todas las actualizaciones o actualizaciones de controladores, como discutimos en el paso 4. O puede deshabilitar la instalaci√≥n de actualizaciones del sistema y dejar la actualizaci√≥n del controlador. <br><br><pre> <code class="hljs powershell">Windows Registry Editor Version <span class="hljs-number"><span class="hljs-number">5.00</span></span> ;  .      [<span class="hljs-type"><span class="hljs-type">HKEY_LOCAL_MACHINE</span></span>\<span class="hljs-type"><span class="hljs-type">SOFTWARE</span></span>\<span class="hljs-type"><span class="hljs-type">Policies</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span>\<span class="hljs-type"><span class="hljs-type">WindowsUpdate</span></span>\<span class="hljs-type"><span class="hljs-type">AU</span></span>] <span class="hljs-string"><span class="hljs-string">"NoAutoUpdate"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span> ;  ;<span class="hljs-string"><span class="hljs-string">"NoAutoUpdate"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000000</span></span> ; </code> </pre><br>  Pero tambi√©n es posible que necesite instalar actualizaciones del sistema, pero alguna actualizaci√≥n espec√≠fica deshabilitar√° el sistema.  En esta situaci√≥n, puede evitar la instalaci√≥n de una actualizaci√≥n espec√≠fica.  Esto se puede hacer usando la utilidad wushowhide.diagcab, que se puede encontrar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br><br>  En las pol√≠ticas de grupo, puede encontrar muchas configuraciones detalladas para instalar actualizaciones.  "Configuraci√≥n del equipo \ Plantillas administrativas \ Componentes de Windows \ Windows Update" <br><br>  Porque  No necesito actualizaciones, las desactivo por completo: <br><br><pre> <code class="hljs dos"><span class="hljs-built_in"><span class="hljs-built_in">net</span></span> stop wuauserv sc config wuauserv <span class="hljs-built_in"><span class="hljs-built_in">start</span></span>=disabled <span class="hljs-built_in"><span class="hljs-built_in">pause</span></span></code> </pre><br>  Aqu√≠ guardar√© una vez m√°s la imagen del sistema. <br><br><h3>  Paso 10 - configura el inicio de la aplicaci√≥n </h3><br>  La navegaci√≥n a trav√©s del sitio quarta-embedded.ru estar√° en IE, para eliminar el acceso a la barra de direcciones y la configuraci√≥n, puede habilitar el modo de pantalla completa en las pol√≠ticas de grupo.  "Configuraci√≥n de usuario&gt; Plantillas administrativas&gt; Componentes de Windows&gt; Internet Explorer&gt; Habilitaci√≥n del modo de pantalla completa".  Y debe prohibir el cierre de IE "Configuraci√≥n de usuario&gt; Plantillas administrativas&gt; Componentes de Windows&gt; Internet Explorer&gt; Men√∫ del navegador&gt; Men√∫ Archivo: Desactivar el cierre del navegador y el Explorador de Windows". <br>  Para iniciar la aplicaci√≥n en lugar del shell del sistema, utilizaremos una herramienta especial de inicio de aplicaciones: ShellLauncher.  Utiliz√°ndolo puedes: <br><br>  1. Asignar el inicio de una aplicaci√≥n espec√≠fica a un usuario espec√≠fico o grupo de usuarios <br><br>  2. Controle el funcionamiento de la aplicaci√≥n en ejecuci√≥n. Al cerrar la aplicaci√≥n en ejecuci√≥n, puede: <br><br><ul><li>  a.  Reiniciar aplicaci√≥n </li><li>  b.  Sistema de reinicio </li><li>  c.  Apagar el sistema </li><li>  d.  No tomar medidas </li></ul><br>  Primero debe agregar ShellLauncher como componente, esto se puede hacer en la interfaz gr√°fica "Panel de control&gt; Programas&gt; Activar y desactivar componentes de la ventana", secci√≥n "Bloqueo del dispositivo".  Puede configurar el inicio de programas en la rama del registro "HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows Embedded \ Shell Launcher".  el inicio de los programas est√° configurado por los SID de los usuarios, los SID se pueden encontrar utilizando la utilidad whoami.  Para habilitar ShellLauncher, solo necesita reemplazar el lanzamiento del shell est√°ndar en el registro con el lanzamiento de ShellLauncher.  Y un poco de matiz, ShellLauncher no afecta el tama√±o y la posici√≥n de la ventana del programa en ejecuci√≥n, y a IE le gustar√≠a ejecutar la pantalla completa desplegada.  Por lo tanto, configuramos el modo de inicio de IE, nuevamente bajo el usuario Usuario, al mismo tiempo que prohibimos llamar al men√∫ contextual de IE para que el usuario no arruine nada. <br><br><pre> <code class="hljs powershell">Windows Registry Editor Version <span class="hljs-number"><span class="hljs-number">5.00</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_CURRENT_USER</span></span>\<span class="hljs-type"><span class="hljs-type">SOFTWARE</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-built_in"><span class="hljs-built_in">Int</span></span><span class="hljs-type"><span class="hljs-type">ernet</span></span> <span class="hljs-type"><span class="hljs-type">Explorer</span></span>\<span class="hljs-type"><span class="hljs-type">Main</span></span>] <span class="hljs-string"><span class="hljs-string">"FullScreen"</span></span>=<span class="hljs-string"><span class="hljs-string">"yes"</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_CURRENT_USER</span></span>\<span class="hljs-type"><span class="hljs-type">Software</span></span>\<span class="hljs-type"><span class="hljs-type">Policies</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-built_in"><span class="hljs-built_in">Int</span></span><span class="hljs-type"><span class="hljs-type">ernet</span></span> <span class="hljs-type"><span class="hljs-type">Explorer</span></span>\<span class="hljs-type"><span class="hljs-type">Restrictions</span></span>] <span class="hljs-string"><span class="hljs-string">"NoBrowserContextMenu"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span></code> </pre><br>  Ahora estamos configurando ShellLauncher, nuevamente es m√°s conveniente para m√≠ hacer todo usando la consola ... <br><br><pre> <code class="hljs bash">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off chcp 1251 <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>  ShellLouncher   DISM /online /Enable-Feature /all /FeatureName:Client-EmbeddedShellLauncher <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>  SID  User <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> /f <span class="hljs-string"><span class="hljs-string">"tokens=2 delims=="</span></span> %%i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'wmic useraccount where "Name='</span></span>User<span class="hljs-string"><span class="hljs-string">'" get SID /value^|find "SID"'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> SID=%%i <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>   iexplore.exe   User reg add <span class="hljs-string"><span class="hljs-string">"HKLM\SOFTWARE\Microsoft\Windows Embedded\Shell Launcher\%SID%"</span></span> /v Shell /t REG_SZ /d <span class="hljs-string"><span class="hljs-string">"C:\Program Files\Internet Explorer\iexplore.exe www.quarta-embedded.ru"</span></span> /f <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>     IE reg add <span class="hljs-string"><span class="hljs-string">"HKLM\SOFTWARE\Microsoft\Windows Embedded\Shell Launcher\%SID%"</span></span> /v DefaultReturnCodeAction /t REG_DWORD /d 0 /f <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>       reg add <span class="hljs-string"><span class="hljs-string">"HKLM\SOFTWARE\Microsoft\Windows Embedded\Shell Launcher\S-1-5-32-544"</span></span> /v Shell /t REG_SZ /d <span class="hljs-string"><span class="hljs-string">"explorer.exe"</span></span> /f <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>         reg add <span class="hljs-string"><span class="hljs-string">"HKLM\SOFTWARE\Microsoft\Windows Embedded\Shell Launcher\S-1-5-32-544"</span></span> /v DefaultReturnCodeAction /t REG_DWORD /d 3 /f pause</code> </pre><br>  Y, como ejemplo, puede asignar un shell predeterminado para que se ejecute cuando no se asignen aplicaciones al usuario. <br><br><pre> <code class="hljs powershell">Windows Registry Editor Version <span class="hljs-number"><span class="hljs-number">5.00</span></span> ;     ,    cmd.exe [<span class="hljs-type"><span class="hljs-type">HKEY_LOCAL_MACHINE</span></span>\<span class="hljs-type"><span class="hljs-type">SOFTWARE</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span> <span class="hljs-type"><span class="hljs-type">Embedded</span></span>\<span class="hljs-type"><span class="hljs-type">Shell</span></span> <span class="hljs-type"><span class="hljs-type">Launcher</span></span>] <span class="hljs-string"><span class="hljs-string">"Shell"</span></span>=<span class="hljs-string"><span class="hljs-string">"explorer.exe"</span></span> ;        ;<span class="hljs-string"><span class="hljs-string">"DefaultReturnCodeAction"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000000</span></span> ;  ;<span class="hljs-string"><span class="hljs-string">"DefaultReturnCodeAction"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span> ; ;<span class="hljs-string"><span class="hljs-string">"DefaultReturnCodeAction"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000002</span></span> ; <span class="hljs-string"><span class="hljs-string">"DefaultReturnCodeAction"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000003</span></span> ;  </code> </pre><br>  Y enciende el Shell Launcher <br><br><pre> <code class="hljs powershell">Windows Registry Editor Version <span class="hljs-number"><span class="hljs-number">5.00</span></span> ; ShellLouncher    [<span class="hljs-type"><span class="hljs-type">HKEY_LOCAL_MACHINE</span></span>\<span class="hljs-type"><span class="hljs-type">SOFTWARE</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span> <span class="hljs-type"><span class="hljs-type">NT</span></span>\<span class="hljs-type"><span class="hljs-type">CurrentVersion</span></span>\<span class="hljs-type"><span class="hljs-type">Winlogon</span></span>] <span class="hljs-string"><span class="hljs-string">"Shell"</span></span>=<span class="hljs-string"><span class="hljs-string">"eShell.exe"</span></span> ; Shell Launcher ;<span class="hljs-string"><span class="hljs-string">"Shell"</span></span>=<span class="hljs-string"><span class="hljs-string">"explorer.exe"</span></span> ; Shell Launcher</code> </pre><br><h3>  Paso 11: configuraci√≥n de la pantalla de inicio del sistema </h3><br>  En versiones anteriores de Windows, puede configurar sus propios logotipos que aparecer√≠an cuando se inicia el sistema, ahora solo hay dos opciones activadas.  y fuera  Puede deshabilitar el proceso de mostrar la carga en el repositorio bcd, ejecutar√© estos comandos inmediatamente y los agregar√© al script de sellado. <br><br><pre> <code class="hljs bash"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>    Windows  .     <span class="hljs-literal"><span class="hljs-literal">true</span></span>   <span class="hljs-literal"><span class="hljs-literal">false</span></span> bcdedit /<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> {globalsettings} custom:16000067 <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>        Windows.     <span class="hljs-literal"><span class="hljs-literal">false</span></span> bcdedit /<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> {globalsettings} nobootuxprogress <span class="hljs-literal"><span class="hljs-literal">true</span></span></code> </pre><br>  Tambi√©n puede ocultar el proceso de inicio de sesi√≥n del usuario. <br><br><pre> <code class="hljs powershell">Windows Registry Editor Version <span class="hljs-number"><span class="hljs-number">5.00</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_LOCAL_MACHINE</span></span>\<span class="hljs-type"><span class="hljs-type">SOFTWARE</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span> <span class="hljs-type"><span class="hljs-type">Embedded</span></span>\<span class="hljs-type"><span class="hljs-type">EmbeddedLogon</span></span>] ;<span class="hljs-string"><span class="hljs-string">"HideAutoLogonUI"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000000</span></span> ;  <span class="hljs-string"><span class="hljs-string">"HideAutoLogonUI"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span> ; </code> </pre><br>  Ahora active el inicio de sesi√≥n de usuario autom√°tico Usuario, esto se puede hacer usando el comando netplwiz.  Reiniciamos y vemos lo que sucedi√≥, no se muestra el progreso de carga del sistema operativo, no se muestra el inicio de sesi√≥n del usuario.  Solo, justo antes de ingresar al sistema, el √≠cono de Win y la animaci√≥n en forma de bolas aparecen durante unos segundos, pero esto se debe a que el sistema operativo en modo auditor√≠a, despu√©s de sellar en modo oobe, esto no suceder√°.  IE comenz√≥ autom√°ticamente con la direcci√≥n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">www.quarta-embedded.ru</a> , un poco m√°s tarde apareci√≥ la pesta√±a microsoft.com, bueno, nada, necesitar√° agregar un comando para cambiar la configuraci√≥n en el registro al archivo de respuesta de sellado <br><br><pre> <code class="hljs tex">reg add HKLM<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Software</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Microsoft</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Internet</span></span></span></span> Explorer<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Main</span></span></span></span>" /v "DisableFirstRunCustomize" /t REG_DWORD /d 1</code> </pre><br>  Aqu√≠ volver√© a hacer una imagen del sistema. <br><br><h3>  Paso 12: instalaci√≥n y eliminaci√≥n de la clave de Windows </h3><br>  Antes de instalar la llave, debe desconectar la PC de Internet para que el sistema no se active.  Puede agregar una clave e inmediatamente eliminarla para que nadie pueda sacarla.  En este caso, el sistema a√∫n se puede activar. <br><br><pre> <code class="hljs powershell">slmgr /ipk XXXXX<span class="hljs-literal"><span class="hljs-literal">-XXXXX</span></span><span class="hljs-literal"><span class="hljs-literal">-XXXXX</span></span><span class="hljs-literal"><span class="hljs-literal">-XXXXX</span></span><span class="hljs-literal"><span class="hljs-literal">-XXXXX</span></span> slmgr /cpky</code> </pre><br><h3>  Paso 13 - sellar el sistema </h3><br>  Para que el sistema no haga preguntas en el primer arranque despu√©s de sellar en modo oobe, utilizo un archivo de respuesta que se prepar√≥ previamente en la utilidad Windows System Image Manager.  Ejecuto el script para sellar, debajo del contenido del script y el archivo de respuesta. <br><br>  Gui√≥n para sellar: <br><br><pre> <code class="hljs pgsql">del "%systemdrive%\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\*.*" /q <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> /f "tokens=2 delims==" %%i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'wmic group where "SID='</span></span>S<span class="hljs-number"><span class="hljs-number">-1</span></span><span class="hljs-number"><span class="hljs-number">-5</span></span><span class="hljs-number"><span class="hljs-number">-32</span></span><span class="hljs-number"><span class="hljs-number">-544</span></span><span class="hljs-string"><span class="hljs-string">'" get Name /value^|find "Name"'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> GroupName=%%i net localgroup %GroupName% <span class="hljs-keyword"><span class="hljs-keyword">User</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> bcdedit /<span class="hljs-keyword"><span class="hljs-keyword">set</span></span> {<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>} bootstatuspolicy IgnoreAllFailures bcdedit /<span class="hljs-keyword"><span class="hljs-keyword">set</span></span> {globalsettings} custom:<span class="hljs-number"><span class="hljs-number">16000067</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> bcdedit /<span class="hljs-keyword"><span class="hljs-keyword">set</span></span> {globalsettings} nobootuxprogress <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> pushd "%~dp0" %SYSTEMROOT%\System32\Sysprep\sysprep.exe /oobe /generalize /shutdown /quiet /unattend:Unattend.xml</code> </pre><br>  Unattend.xml: <br><br><pre> <code class="hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">unattend</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:schemas-microsoft-com:unattend"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">settings</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">pass</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"specialize"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">component</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Microsoft-Windows-Deployment"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">processorArchitecture</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"x86"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">publicKeyToken</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"31bf3856ad364e35"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">language</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"neutral"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">versionScope</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nonSxS"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:wcm</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/WMIConfig/2002/State"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronous</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronousCommand</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">wcm:action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"add"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Path</span></span></span><span class="hljs-tag">&gt;</span></span>reg add HKLM\Software\Microsoft\Windows\CurrentVersion\Setup\OOBE /v SetupDisplayedProductKey /t REG_DWORD /d 1 /f<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Path</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Order</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Order</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span>Dont show key page<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronousCommand</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronousCommand</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">wcm:action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"add"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Path</span></span></span><span class="hljs-tag">&gt;</span></span>reg add HKLM\Software\Microsoft\Windows\CurrentVersion\Setup\OOBE /v UnattendCreatedUser /t REG_DWORD /d 1 /f<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Path</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Order</span></span></span><span class="hljs-tag">&gt;</span></span>2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Order</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span>Dont make account<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronousCommand</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronousCommand</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">wcm:action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"add"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Path</span></span></span><span class="hljs-tag">&gt;</span></span>reg add "HKLM\Software\Microsoft\Internet Explorer\Main" /v "DisableFirstRunCustomize" /t REG_DWORD /d 1 /f<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Path</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Order</span></span></span><span class="hljs-tag">&gt;</span></span>3<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Order</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span>Disable First Run Customize<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronousCommand</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronousCommand</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">wcm:action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"add"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Path</span></span></span><span class="hljs-tag">&gt;</span></span>cmd.exe /c rd %systemdrive%\Sysprep /s /q<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Path</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Order</span></span></span><span class="hljs-tag">&gt;</span></span>4<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Order</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span>Del Folder<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronousCommand</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronous</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">component</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">component</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Microsoft-Windows-Shell-Setup"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">processorArchitecture</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"x86"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">publicKeyToken</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"31bf3856ad364e35"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">language</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"neutral"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">versionScope</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nonSxS"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:wcm</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/WMIConfig/2002/State"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AutoLogon</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Enabled</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Enabled</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Username</span></span></span><span class="hljs-tag">&gt;</span></span>User<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Username</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AutoLogon</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">component</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">settings</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">settings</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">pass</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"oobeSystem"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">component</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Microsoft-Windows-International-Core"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">processorArchitecture</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"x86"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">publicKeyToken</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"31bf3856ad364e35"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">language</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"neutral"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">versionScope</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nonSxS"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:wcm</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/WMIConfig/2002/State"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">InputLocale</span></span></span><span class="hljs-tag">&gt;</span></span>en-US; ru-RU<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">InputLocale</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SystemLocale</span></span></span><span class="hljs-tag">&gt;</span></span>ru-RU<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SystemLocale</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UILanguage</span></span></span><span class="hljs-tag">&gt;</span></span>ru-RU<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UILanguage</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UILanguageFallback</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UILanguageFallback</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UserLocale</span></span></span><span class="hljs-tag">&gt;</span></span>ru-RU<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UserLocale</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">component</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">component</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Microsoft-Windows-Shell-Setup"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">processorArchitecture</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"x86"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">publicKeyToken</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"31bf3856ad364e35"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">language</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"neutral"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">versionScope</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nonSxS"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:wcm</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/WMIConfig/2002/State"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OOBE</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideEULAPage</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideEULAPage</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideLocalAccountScreen</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideLocalAccountScreen</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideOEMRegistrationScreen</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideOEMRegistrationScreen</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideOnlineAccountScreens</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideOnlineAccountScreens</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideWirelessSetupInOOBE</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideWirelessSetupInOOBE</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ProtectYourPC</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ProtectYourPC</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OOBE</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">component</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">settings</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cpi:offlineImage</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">cpi:source</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:cpi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:schemas-microsoft-com:cpi"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">unattend</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><h2>  Resumen </h2><br>  Lo que sucedi√≥ al final ... El sistema se inici√≥ sin ninguna pregunta, IE comenz√≥ con la p√°gina correcta.  Si tiene en cuenta que no habr√° acceso f√≠sico a la PC, y solo se podr√° acceder al mouse desde los medios de entrada, entonces parece que no se puede romper nada.  Entramos en la cuenta de administrador y vemos que la carpeta Sysprep se elimina.  El sistema est√° listo ... </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es413359/">https://habr.com/ru/post/es413359/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es413347/index.html">An√°lisis de la atm√≥sfera negativa y c√≥mo lidiar con ella.</a></li>
<li><a href="../es413349/index.html">Qu√© m√©tricas de Google Analytics provocan malas decisiones</a></li>
<li><a href="../es413351/index.html">Sobre personas, monstruos y modelos tem√°ticos</a></li>
<li><a href="../es413353/index.html">Rocker - controlador rocksdb para Erlang</a></li>
<li><a href="../es413357/index.html">Primer vistazo al tel√©fono inteligente para juegos ASUS ROG Phone</a></li>
<li><a href="../es413361/index.html">Teor√≠a del gran vertedero: buscamos documentos cient√≠ficos en Internet</a></li>
<li><a href="../es413363/index.html">El artesano atornill√≥ el teleobjetivo Canon EF 70-200 mm a la c√°mara Game Boy</a></li>
<li><a href="../es413367/index.html">¬øQu√© es una burbuja global de hidrocarburos? Resultados de la simulaci√≥n del mercado energ√©tico hasta 2050 g.</a></li>
<li><a href="../es413371/index.html">Coche el√©ctrico</a></li>
<li><a href="../es413375/index.html">¬øEs posible hacer amigos Gitlab CI + Docker + Systemd</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>