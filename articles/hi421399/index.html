<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>тЩЛя╕П ЁЯЪ╝ ЁЯФИ Turla Cybergroup рдЖрдЙрдЯрд▓реБрдХ рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг ЁЯЫОя╕П ЁЯЩЛЁЯП╜ ЁЯзЪЁЯП╗</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Turla (Snake, Uroboros) рдПрдХ рд╕рд╛рдЗрдмрд░ рдЬрд╛рд╕реВрд╕реА рд╕рдореВрд╣ рд╣реИ рдЬрд┐рд╕рдиреЗ 2008 рдореЗрдВ рдЕрдореЗрд░рд┐рдХреА рд╕рд╢рд╕реНрддреНрд░ рдмрд▓реЛрдВ рдХреЗ рдордзреНрдп рдХрдорд╛рди рдХреЗ рдиреЗрдЯрд╡рд░реНрдХ рд╕рд╣рд┐рдд рд╕рдВрд░рдХреНрд╖рд┐рдд рд╡рд╕реНрддреБрдУрдВ рдХреЛ рд╣реИрдХ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдк...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Turla Cybergroup рдЖрдЙрдЯрд▓реБрдХ рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/421399/"><p>  Turla (Snake, Uroboros) рдПрдХ рд╕рд╛рдЗрдмрд░ рдЬрд╛рд╕реВрд╕реА рд╕рдореВрд╣ рд╣реИ рдЬрд┐рд╕рдиреЗ 2008 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдореЗрдВ рдЕрдореЗрд░рд┐рдХреА рд╕рд╢рд╕реНрддреНрд░ рдмрд▓реЛрдВ</a> рдХреЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдордзреНрдп рдХрдорд╛рди рдХреЗ</a> рдиреЗрдЯрд╡рд░реНрдХ рд╕рд╣рд┐рдд рд╕рдВрд░рдХреНрд╖рд┐рдд рд╡рд╕реНрддреБрдУрдВ рдХреЛ рд╣реИрдХ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдкреНрд░рд╕рд┐рджреНрдзрд┐ рдкреНрд░рд╛рдкреНрдд рдХреА рдереАред  рддрдм рд╕реЗ, рд╡рд╣ рджреБрдирд┐рдпрд╛ рднрд░ рдореЗрдВ рд╕реИрдиреНрдп рдкреНрд░рддрд┐рд╖реНрдард╛рдиреЛрдВ рдФрд░ рд░рд╛рдЬрдирдпрд┐рдХ рдПрдЬреЗрдВрд╕рд┐рдпреЛрдВ рдкрд░ рд╣рдорд▓реЛрдВ рдореЗрдВ рдорд╛рд╣рд┐рд░ рд╣реИрдВред  рдкреНрд░рд╕рд┐рджреНрдз рдкреАрдбрд╝рд┐рддреЛрдВ рдореЗрдВ 2013 рдореЗрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдлрд┐рдирд▓реИрдВрдб рдХреЗ рд╡рд┐рджреЗрд╢ рдордВрддреНрд░рд╛рд▓рдп</a> , 2014 рд╕реЗ 2016 рддрдХ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕реНрд╡рд┐рд╕ рд░рдХреНрд╖рд╛ рдирд┐рдЧрдо рдЖрд░рдпреВрдПрдЬреА рд╢рд╛рдорд┐рд▓ рд╣реИрдВ</a> ред  рдФрд░ 2017 рдХреЗ рдЕрдВрдд рдореЗрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЬрд░реНрдорди рд╕рд░рдХрд╛рд░</a> - 2018 рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВред </p><br><p>  рдирд╡реАрдирддрдо рдШрдЯрдирд╛ рдХреЗ рдмрд╛рдж, рдХрдИ рдореАрдбрд┐рдпрд╛ рдЖрдЙрдЯрд▓реЗрдЯреНрд╕ рдиреЗ рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдХреЗ рддрд░реАрдХреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рдХрд╛рд╢рд┐рдд рдХреА - рдореИрд▓рд╡реЗрдпрд░ рд╕реЗ рдирд┐рдпрдВрддреНрд░рдг рдФрд░ рд╕рд┐рд╕реНрдЯрдо рд╕реЗ рдЪреЛрд░реА рдХрд┐рдП рдЧрдП рдбреЗрдЯрд╛ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдИрдореЗрд▓ рдЕрдЯреИрдЪрдореЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреЛрдИ рддрдХрдиреАрдХреА рдЬрд╛рдирдХрд╛рд░реА рдирд╣реАрдВ рджреА рдЧрдИ рдереАред  рдЗрд╕ рд░рд┐рдкреЛрд░реНрдЯ рдореЗрдВ, рд╣рдо рдЯрд░реНрд▓рд╛ рдмреИрдХрдбреЛрд░ рдХреЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЛ рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕реЗ рдИрдореЗрд▓ рдореЗрдВ рдкреАрдбреАрдПрдл рдЕрдЯреИрдЪрдореЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/l_/db/ws/l_dbws8skuoavwqn1vorwdhobgo.jpeg"></div><a name="habracut"></a><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдореАрдбрд┐рдпрд╛ рд░рд┐рдкреЛрд░реНрдЯреЛрдВ рдХреЗ</a> рдЕрдиреБрд╕рд╛рд░, рдЬрд░реНрдорди рд╡рд┐рджреЗрд╢ рдордВрддреНрд░рд╛рд▓рдп рдХреЗ рдХрдИ рдХрдВрдкреНрдпреВрдЯрд░ рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рд╕реЗ рд╕рдВрдХреНрд░рдорд┐рдд рдереЗред  рдЬрд╛рд╣рд┐рд░ рддреМрд░ рдкрд░, рд╣рдорд▓рд╛ 2016 рдореЗрдВ рд╢реБрд░реВ рд╣реБрдЖ рдерд╛ рдФрд░ 2017 рдХреЗ рдЕрдВрдд рдореЗрдВ рд╕реБрд░рдХреНрд╖рд╛ рд╕реЗрд╡рд╛рдУрдВ рджреНрд╡рд╛рд░рд╛ рдЦреЛрдЬрд╛ рдЧрдпрд╛ рдерд╛ред рд╢реБрд░реБрдЖрдд рдореЗрдВ, рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдиреЗ рдлреЗрдбрд░рд▓ рд╣рд╛рдИ рд╕реНрдХреВрд▓ рдСрдл рдкрдмреНрд▓рд┐рдХ рдПрдбрдорд┐рдирд┐рд╕реНрдЯреНрд░реЗрд╢рди (рд╣реЛрдЪреНрд╕реНрдЪреБрд▓реЗ рдбреЗрд╕ рдмреБрдВрдбреЗрд╕) рд╕реЗ рд╕рдордЭреМрддрд╛ рдХрд┐рдпрд╛, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рд╡реЗ рдорд╛рд░реНрдЪ 2017 рдореЗрдВ рд╡рд┐рджреЗрд╢ рдордВрддреНрд░рд╛рд▓рдп рдХреЗ рдиреЗрдЯрд╡рд░реНрдХ рддрдХ рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рддрдХ рдЕрдкрдиреЗ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЕрдВрджрд░ рдЪрд▓реЗ рдЧрдПред ред  рд▓рдЧрднрдЧ рдПрдХ рд╕рд╛рд▓ рддрдХ рдХреБрдЫ рдЧреЛрдкрдиреАрдп рдбреЗрдЯрд╛ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЬрд░реНрдорди рд╡рд┐рджреЗрд╢ рдордВрддреНрд░рд╛рд▓рдп рдХреЗ рдХрд░реНрдордЪрд╛рд░рд┐рдпреЛрдВ рдХрд╛ рдИ-рдореЗрд▓) рддрдХ рдЯрд░реНрд▓рд╛ рдСрдкрд░реЗрдЯрд░реЛрдВ рдХреА рдкрд╣реБрдВрдЪ рдереАред </p><br><p>  рд╣рдорд╛рд░реА рдЬрд╛рдВрдЪ рд╕реЗ рдпрд╣ рднреА рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рдЖрдЙрдЯрд▓реБрдХ рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЗрд╕ рдореИрд▓рд╡реЗрдпрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡рд┐рднрд┐рдиреНрди рд░рд╛рдЬрдиреАрддрд┐рдХ рдФрд░ рд╕реИрдиреНрдп рд╡рд┐рднрд╛рдЧреЛрдВ рдХреЗ рдЦрд┐рд▓рд╛рдл рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред  рд╣рдордиреЗ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд┐рдпрд╛ рдХрд┐ рдЕрдиреНрдп рджреЛ рдпреВрд░реЛрдкреАрдп рджреЗрд╢реЛрдВ рдХреЗ рд╡рд┐рджреЗрд╢ рдордВрддреНрд░рд╛рд▓рдпреЛрдВ рдФрд░ рдкреНрд░рдореБрдЦ рд░рдХреНрд╖рд╛ рдареЗрдХреЗрджрд╛рд░ рдХреЗ рдмреАрдЪ рднреА рд╕рдордЭреМрддрд╛ рд╣реБрдЖред  рд╣рдорд╛рд░реА рдЬрд╛рдВрдЪ рдиреЗ рд╣рдореЗрдВ рдЗрд╕ рдЕрднрд┐рдпрд╛рди рдХреЗ рд▓рд┐рдП рддреБрд░реНрд▓рд╛ рдСрдкрд░реЗрдЯрд░реЛрдВ рджреНрд╡рд╛рд░рд╛ рдкрдВрдЬреАрдХреГрдд рджрд░реНрдЬрдиреЛрдВ рдИрдореЗрд▓ рдкрддреЛрдВ рдХреЛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреА рдФрд░ рдЙрдиреНрд╣реЗрдВ рдкреАрдбрд╝рд┐рддреЛрдВ рдХреЗ рдбреЗрдЯрд╛ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ред </p><br><h2>  1. рдкреНрд░рдореБрдЦ рдмрд┐рдВрджреБ </h2><br><p>  Turla Group рдХреЗ рдЖрдЙрдЯрд▓реБрдХ рдмреИрдХрдбреЛрд░ рдХреЗ рджреЛ рдХрд╛рд░реНрдп рд╣реИрдВред </p><br><p>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдпрд╣ рдЖрдЙрдЯрдЧреЛрдЗрдВрдЧ рдЕрдХреНрд╖рд░реЛрдВ рдХреА рдЪреЛрд░реА рд╣реИ рдЬреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЕрдЧреНрд░реЗрд╖рд┐рдд рдХреА рдЬрд╛рддреА рд╣реИред  рдкреВрд░реНрд╡реА рдпреВрд░реЛрдк рдореЗрдВ рдкреНрд░рдЪрд▓рд┐рдд рдж рдмреИрдЯ! рдХреЗ рд▓рд┐рдП рдЬреНрдпрд╛рджрд╛рддрд░ Microsoft Outlook рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рднреА рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рд╣реИред </p><br><p>  рджреВрд╕рд░реЗ, рдЗрд╕рдХреЗ C &amp; C рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреА рдЯреНрд░рд╛рдВрд╕рдкреЛрд░реНрдЯ рд▓реЗрдпрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдЕрдХреНрд╖рд░реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧред  рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдХрдорд╛рдВрдб рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЕрдиреБрд░реЛрдзрд┐рдд рдлрд╛рдЗрд▓реЗрдВ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдирд┐рд░реНрдорд┐рдд рдкреАрдбреАрдПрдл рджрд╕реНрддрд╛рд╡реЗрдЬреЛрдВ рдореЗрдВ рдЕрдХреНрд╖рд░реЛрдВ рдХреЗ рд▓рдЧрд╛рд╡ рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХреНрд╕рдлрд╝рд┐рд▓реНрдЯ рдХреА рдЧрдИ рд╣реИрдВред  рдмреИрдХрдбреЛрд░ рдХрдорд╛рдВрдб рднреА рдкреАрдбреАрдПрдл рдЕрдЯреИрдЪрдореЗрдВрдЯ рдореЗрдВ рднреЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВред  рдпрд╣ рдЧреЛрдкрдиреАрдпрддрд╛ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред  рдпрд╣ рдзреНрдпрд╛рди рд░рдЦрдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдкреАрдбреАрдПрдл рдкрд╛рдардХреЛрдВ рдпрд╛ рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рдЖрдЙрдЯрд▓реБрдХ рдореЗрдВ рдХрд┐рд╕реА рднреА рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХрд╛ рдлрд╛рдпрджрд╛ рдирд╣реАрдВ рдЙрдард╛рддреЗ рд╣реИрдВред  рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ PDF рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реЛрдВ рд╕реЗ рдбреЗрдЯрд╛ рдХреЛ рдбреАрдХреЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдХрдорд╛рдВрдб рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </p><br><p>  рдЕрднрд┐рдпрд╛рди рдХреЗ рд▓рдХреНрд╖реНрдп рддреБрд░рд▓рд╛ рдХреЗ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╣реИрдВред  рд╣рдордиреЗ рдЗрд╕ рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рд╕реЗ рд╕рдордЭреМрддрд╛ рдХрд░рдиреЗ рд╡рд╛рд▓реА рдХрдИ рдпреВрд░реЛрдкреАрдп рд╕рд░рдХрд╛рд░реА рдПрдЬреЗрдВрд╕рд┐рдпреЛрдВ рдФрд░ рд░рдХреНрд╖рд╛ рдХрдВрдкрдирд┐рдпреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХреА рд╣реИред  рдпрд╣ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдкрд╣реБрдВрдЪ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рджреГрдврд╝рддрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдЬрд╣рд╛рдВ рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдпрд╛ рдЕрдиреНрдп рдиреЗрдЯрд╡рд░реНрдХ рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрдХрд░рдг HTTP (рдПрд╕) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реА рдФрд░ рд╕реА рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рдкрд╛рд░рдВрдкрд░рд┐рдХ рд╕рдВрдЪрд╛рд░ рдХреЛ рдкреНрд░рднрд╛рд╡реА рдврдВрдЧ рд╕реЗ рдЕрд╡рд░реБрджреНрдз рдХрд░рддреЗ рд╣реИрдВред  рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдЖрдВрдХрдбрд╝реЗ рдкрд┐рдЫрд▓реЗ рдХреЛрдб рд▓рд╛рдЗрдиреЛрдВ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рдХреБрдЫ рд╕рд░рдХрд╛рд░реА рд╢реАрд░реНрд╖-рд╕реНрддрд░реАрдп рдбреЛрдореЗрди рдХрд╛ рдЙрд▓реНрд▓реЗрдЦ рдХрд░рддреЗ рд╣реИрдВред  mfa рд╡рд┐рджреЗрд╢реА рдорд╛рдорд▓реЛрдВ рдХреЗ рдордВрддреНрд░рд╛рд▓рдп рдХрд╛ рдбреЛрдореЗрди рд╣реИ, .gouv рдлреНрд░рд╛рдВрд╕ рд╕рд░рдХрд╛рд░ (.gouv.fr) рдХрд╛ рдПрдХ рдЙрдкрдбреЛрдореЗрди рд╣реИ, ocse рдпреВрд░реЛрдк рдореЗрдВ рд╕реБрд░рдХреНрд╖рд╛ рдФрд░ рд╕рд╣рдпреЛрдЧ рд╕рдВрдЧрдарди рд╣реИред </p><br><img src="https://habrastorage.org/webt/xt/ix/e9/xtixe9vxop-os9ktobaea5qqdbu.png"><br><p>  <i>рдЪрд┐рддреНрд░ 1. рдорд╛рд▓рд╡рд╛рд░реА рдХреЛрдб рдореЗрдВ рдкрд╛рдИ рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд╕реЗрд╡рд╛рдУрдВ рд╕реЗ рдЬреБрдбрд╝реЗ рдбреЛрдореЗрди</i> </p><br><p>  рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдФрд░ рдЯреЗрд▓реАрдореЗрдЯреНрд░реА рдбреЗрдЯрд╛ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рд╣рдордиреЗ рдкрд╛рдпрд╛ рдХрд┐ рдЗрд╕ рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдХреЛ рдХрдо рд╕реЗ рдХрдо 2013 рдХреЗ рдмрд╛рдж рд╕реЗ рдЬрдВрдЧрд▓реА рдореЗрдВ рд╡рд┐рддрд░рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рд╣рдореЗрд╢рд╛ рдЯрд░реНрд▓рд╛ рдХреЗ рд╕рд╛рде, рд╣рдо рд╕рдВрдХрд▓рди рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ, рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ рдЖрдорддреМрд░ рдкрд░ рдирдХрд▓реА рд╣реЛрддреЗ рд╣реИрдВред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╣рдо рдорд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рдкрд╣рд▓реЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЛ 2013 рд╕реЗ рдкрд╣рд▓реЗ рд╕рдВрдХрд▓рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕ рд╡рд░реНрд╖ рдХрд╛ рд╕рдВрд╕реНрдХрд░рдг рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдХрд╛рдлреА рдЙрдиреНрдирдд рдерд╛ред  рдЙрд╕рдХреЗ рдмрд╛рдж, рд╣рдореЗрдВ рдмреЗрд╕ рдПрдХ рдХреЗ рд╕рдорд╛рди рдПрдХ рд╕рдВрд╕реНрдХрд░рдг рдорд┐рд▓рд╛, рдЬрд┐рд╕рдХрд╛ рд╕рдВрдХрд▓рди 2009 рджрд┐рдирд╛рдВрдХрд┐рдд рдерд╛ред  рд╕рдЯреАрдХ рд░рд┐рд▓реАрдЬ рдХреА рддрд╛рд░реАрдЦ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдирд╛ рдЕрднреА рддрдХ рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИред  рдиреАрдЪреЗ рджреА рдЧрдИ рд╕рдордпрд╛рд╡рдзрд┐ рдЦреБрд▓реЗ рд╕реНрд░реЛрддреЛрдВ рд╕реЗ рд╣рдорд╛рд░реЗ рдЯреЗрд▓реАрдореЗрдЯреНрд░реА рдФрд░ рдбреЗрдЯрд╛ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИ: </p><br><p>  <b>2009</b> : рдЖрдЙрдЯрд▓реБрдХ рдмреИрдХрдбреЛрд░ рдХреЗ рдЖрдзрд╛рд░ рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рд╕рдВрдХрд▓рди рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк (рдирдХрд▓реА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ)ред  рдХреЗрд╡рд▓ рдИрдореЗрд▓ рд╕рд╛рдордЧреНрд░реА рдХрд╛ рд╕реНрдиреИрдкрд╢реЙрдЯред <br>  <b>2013</b> : рдмреЗрд╣рддрд░: рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдЖрджреЗрд╢ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдЙрдиреНрд╣реЗрдВ XML рдлреЙрд░реНрдореЗрдЯ рдореЗрдВ рдИрдореЗрд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <br>  <b>2013</b> : рдж рдмреИрдЯ рдореЗрдВ рд▓рдХреНрд╖рд┐рдд рдирд╡реАрдирддрдо рдЬреНрдЮрд╛рдд рд╕рдВрд╕реНрдХрд░рдг! .. <br>  <b>2016</b> : рдмреЗрд╣рддрд░: рдЯреАрдореЗрдВ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдирд┐рд░реНрдорд┐рдд рдкреАрдбреАрдПрдл рджрд╕реНрддрд╛рд╡реЗрдЬреЛрдВ рдореЗрдВ рд╕рдВрд▓рдЧреНрдирдХ рдХреЗ рд░реВрдк рдореЗрдВ рднреЗрдЬреА рдЬрд╛рддреА рд╣реИрдВред <br>  <b>2017</b> : рдмреЗрд╣рддрд░: рдПрдХ рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рдбреЗрдЯрд╛ рдХреЛ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдкреАрдбреАрдПрдл рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдмрдирд╛рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИред <br>  <b>рдорд╛рд░реНрдЪ 2018</b> : рдЬрд░реНрдорди рд╕рд░рдХрд╛рд░ рдХреЗ рдиреЗрдЯрд╡рд░реНрдХ рдХреА рд░рд┐рдкреЛрд░реНрдЯрд┐рдВрдЧ рд╕рдордЭреМрддрд╛ред <br>  <b>рдЕрдкреНрд░реИрд▓ 2018</b> : рдмреЗрд╣рддрд░: рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдПрдореНрдкрд╛рдпрд░ PSInject рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ PowerShell рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </p><br><h2>  2. рд╡реИрд╢реНрд╡рд┐рдХ рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ </h2><br><p>  рд╣рд╛рд▓ рдХреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ, рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдПрдХ рд╕реНрдЯреИрдВрдбрдЕрд▓реЛрди рдбреАрдПрд▓рдПрд▓ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╕реНрд╡рдпрдВ-рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рдФрд░ рдЗрдВрдЯрд░реИрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдХреЛрдб рдФрд░ рдж рдмреИрдЯ! рдИрдореЗрд▓ рдХреНрд▓рд╛рдЗрдВрдЯ рд╣реИрдВ, рднрд▓реЗ рд╣реА рдЖрдЙрдЯрд▓реБрдХ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рд▓рд╛рдЧреВ рд╣реЛред  рдпрд╣ рдЖрд╕рд╛рдиреА рд╕реЗ рдХрд┐рд╕реА рднреА рддреБрд░реНрд▓рд╛ рдШрдЯрдХ рджреНрд╡рд╛рд░рд╛ рдЧрд┐рд░рд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдЖрдкрдХреЛ рдЕрддрд┐рд░рд┐рдХреНрдд рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдВ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред </p><br><p>  рдЗрд╕ рдЦрдВрдб рдореЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг 2017 рдХреА рдкрд╣рд▓реА рдЫрдорд╛рд╣реА рдореЗрдВ рдЬрд╛рд░реА рдПрдХ рдирдореВрдиреЗ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИред  рдкреБрд░рд╛рдиреЗ рдпрд╛ рдирдП рдирдореВрдиреЛрдВ рдХреА рдЬрд╛рдирдХрд╛рд░реА рд╢рд╛рдорд┐рд▓ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред </p><br><h3>  2.1ред  рд╕реНрдерд╛рдкрдирд╛ </h3><br><p>  рдПрдХ рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдХреЛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдорд▓рд╛рд╡рд░ рдПрдХ DLL рдирд┐рд░реНрдпрд╛рдд рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рд╕реЗ Install рдХрд╣рддреЗ рд╣реИрдВ рдпрд╛ рдЗрд╕реЗ regsvr32.exe рдХреЗ рд╕рд╛рде рдкрдВрдЬреАрдХреГрдд рдХрд░рддреЗ рд╣реИрдВред  рддрд░реНрдХ рд▓рдХреНрд╖реНрдп рдИрдореЗрд▓ рдХреНрд▓рд╛рдЗрдВрдЯ рд╣реИред  рдиреАрдЪреЗ рджрд┐рдпрд╛ рдЧрдпрд╛ рдЖрдВрдХрдбрд╝рд╛ рд╕рдВрднрд╛рд╡рд┐рдд рдорд╛рди рджрд┐рдЦрд╛рддрд╛ рд╣реИред  рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ, рдХреЗрд╡рд▓ рдЖрдЙрдЯрд▓реБрдХ рдХреЗ рд▓рд┐рдП рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред </p><br><img src="https://habrastorage.org/webt/9g/8r/qm/9g8rqm3z7keq_phkhvlztwzwtyo.png"><br><p>  <i>рдЪрд┐рддреНрд░рд╛ 2. рд╕рдВрднрд╡ рд╕реНрдерд╛рдкрдирд╛ рддрд░реНрдХ</i> </p><br><p>  рдЪреВрдВрдХрд┐ рдХреЛрдИ рд╣рд╛рд░реНрдб-рдХреЛрдбреЗрдб рдкрде рдирд╣реАрдВ рд╣реИ, рдЗрд╕рд▓рд┐рдП DLL рдлрд╝рд╛рдЗрд▓ рдХреЛ рдбрд┐рд╕реНрдХ рдкрд░ рдХрд╣реАрдВ рднреА рд╕реНрдерд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </p><br><h4>  2.1.1ред  Microsoft рдЖрдЙрдЯрд▓реБрдХ </h4><br><p>  рдЯрд░реНрдмреЛ рдбреЗрд╡рд▓рдкрд░реНрд╕ рдореИрд▓рд╡реЗрдпрд░ рд╣рда рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП COM рдСрдмреНрдЬреЗрдХреНрдЯ рдЕрдкрд╣рд░рдг рдкрд░ рднрд░реЛрд╕рд╛ рдХрд░рддреЗ рд╣реИрдВред  рдпрд╣ рдХрдИ рд╡рд░реНрд╖реЛрдВ рд╕реЗ рдЬрдВрдЧрд▓реА рдореЗрдВ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдПрдХ рдкреНрд░рд╕рд┐рджреНрдз рддрд░реАрдХрд╛ рд╣реИ, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЬрд┐рд╕рдореЗрдВ рддреБрд░реНрд▓рд╛ рд╕рдореВрд╣ рднреА рд╢рд╛рдорд┐рд▓ рд╣реИ</a> ред  рд╡рд┐рдзрд┐ рдХрд╛ рд╕рд╛рд░ Windows рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ рд╕рдВрдмрдВрдзрд┐рдд CLSID рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдХреЗ рд▓рдХреНрд╖реНрдп рдЕрдиреБрдкреНрд░рдпреЛрдЧ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА COM рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдирд╛ рд╣реИред </p><br><p>  рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, Windows рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрд░рд┐рд╡рд░реНрддрди рдХрд┐рдП рдЧрдП рд╣реИрдВ: </p><br><pre><code class="hljs powershell">HKCU\Software\Classes\CLSID\{<span class="hljs-number"><span class="hljs-number">49</span></span>CBB1C7<span class="hljs-literal"><span class="hljs-literal">-97D1</span></span><span class="hljs-literal"><span class="hljs-literal">-485A</span></span><span class="hljs-literal"><span class="hljs-literal">-9EC1</span></span><span class="hljs-literal"><span class="hljs-literal">-A26065633066</span></span>} = Mail Plugin HKCU\Software\Classes\CLSID\{<span class="hljs-number"><span class="hljs-number">49</span></span>CBB1C7<span class="hljs-literal"><span class="hljs-literal">-97D1</span></span><span class="hljs-literal"><span class="hljs-literal">-485A</span></span><span class="hljs-literal"><span class="hljs-literal">-9EC1</span></span><span class="hljs-literal"><span class="hljs-literal">-A26065633066</span></span>}\InprocServer32 = [<span class="hljs-type"><span class="hljs-type">Path</span></span> <span class="hljs-type"><span class="hljs-type">to</span></span> <span class="hljs-type"><span class="hljs-type">the</span></span> <span class="hljs-type"><span class="hljs-type">backdoor</span></span> <span class="hljs-type"><span class="hljs-type">DLL</span></span>] HKCU\Software\Classes\CLSID\{<span class="hljs-number"><span class="hljs-number">49</span></span>CBB1C7<span class="hljs-literal"><span class="hljs-literal">-97D1</span></span><span class="hljs-literal"><span class="hljs-literal">-485A</span></span><span class="hljs-literal"><span class="hljs-literal">-9EC1</span></span><span class="hljs-literal"><span class="hljs-literal">-A26065633066</span></span>}\InprocServer32\ThreadingModel = Apartment HKCU\Software\Classes\CLSID\{<span class="hljs-number"><span class="hljs-number">84</span></span>DA0A92<span class="hljs-literal"><span class="hljs-literal">-25E0</span></span><span class="hljs-literal"><span class="hljs-literal">-11D3</span></span><span class="hljs-literal"><span class="hljs-literal">-B9F7</span></span><span class="hljs-literal"><span class="hljs-literal">-00C04F4C8F5D</span></span>}\TreatAs = {<span class="hljs-number"><span class="hljs-number">49</span></span>CBB1C7<span class="hljs-literal"><span class="hljs-literal">-97D1</span></span><span class="hljs-literal"><span class="hljs-literal">-485A</span></span><span class="hljs-literal"><span class="hljs-literal">-9EC1</span></span><span class="hljs-literal"><span class="hljs-literal">-A26065633066</span></span>}</code> </pre> <br><p>  <code>{84DA0A92-25E0-11D3-B9F7-00C04F4C8F5D}</code> - CLSID рдкрд░ рдХрдмреНрдЬрд╛ рдХрд░ рд▓рд┐рдпрд╛ред  рдпрд╣ рдЖрдЙрдЯрд▓реБрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдкреНрд░рдмрдВрдзрдХ рд╕реЗ рдореЗрд▓ рдЦрд╛рддреА рд╣реИ рдФрд░ рд╕рд┐рджреНрдзрд╛рдВрдд рд░реВрдк рдореЗрдВ, рд╡реИрдз рдЖрдЙрдЯрд▓реБрдХ DLL <code>OLMAPI32.DLL</code> рд▓реЛрдб рдХрд░рддрд╛ рд╣реИред  <code>{49CBB1C7-97D1-485A-9EC1-A26065633066}</code> рдХрд┐рд╕реА рднреА рдЬреНрдЮрд╛рдд рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рд╕реЗ рд╕рдВрдмрджреНрдз рдирд╣реАрдВ рд╣реИред  рдпрд╣ CLSID рдордирдорд╛рдирд╛ рд╣реИ рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ COM рд░реАрдбрд╛рдпрд░реЗрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рдПрдХ рдкреНрд▓реЗрд╕рд╣реЛрд▓реНрдбрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </p><br><p>  рдЬрдм рд╕рдВрд╢реЛрдзрди рдкреВрд░рд╛ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╣рд░ рдмрд╛рд░ рдЖрдЙрдЯрд▓реБрдХ рдЕрдкрдиреЗ COM рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдкрд░ рдкрд┐рдЫрд▓реЗ рдбреАрдПрд▓рдПрд▓ рдХреЛ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рд╣рдорд╛рд░реА рдЯрд┐рдкреНрдкрдгрд┐рдпреЛрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдпрд╣ рдЖрдЙрдЯрд▓реБрдХ рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рдХреЗ рджреМрд░рд╛рди рд╣реЛрддрд╛ рд╣реИред </p><br><p>  COM рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рдХреЗ рд▓рд┐рдП рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдЕрдзрд┐рдХрд╛рд░реЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдХреЗрд╡рд▓ рд╡рд░реНрддрдорд╛рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкрд░ рд▓рд╛рдЧреВ рд╣реЛрддрд╛ рд╣реИред  рдЗрд╕ рддрд░рд╣ рдХреЗ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЛ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрд░рдХреНрд╖рдг рдЙрдкрд╛рдп рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">MSDN рдХреЗ</a> рдЕрдиреБрд╕рд╛рд░: "Windows Vista рдФрд░ Windows Server 2008 рдХреЗ рд╕рд╛рде, рдпрджрд┐ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЕрдЦрдВрдбрддрд╛ рд╕реНрддрд░ рдФрд╕рдд рд╕реЗ рдКрдкрд░ рд╣реИ, рддреЛ COM рд░рдирдЯрд╛рдЗрдо рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ COM рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдХреЗрд╡рд▓ рдкреНрд░рддреНрдпреЗрдХ рдорд╢реАрди рдХреЗ рд▓рд┐рдП COM рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЛ рдПрдХреНрд╕реЗрд╕ рдХрд░рддрд╛ рд╣реИред" </p><br><p>  рдЖрдЙрдЯрд▓реБрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдордзреНрдпрдо рдЕрдЦрдВрдбрддрд╛ рдкрд░ рдЪрд▓рддреА рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ рдиреАрдЪреЗ рдХреА рдЫрд╡рд┐ рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдпрд╣ рдкреНрд░рддреНрдпреЗрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП COM рдЕрдЧреНрд░реЗрд╖рдг рд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рдирд╣реАрдВ рд╣реИред </p><br><img src="https://habrastorage.org/webt/q4/uq/zt/q4uqzt_g3c6vgonoluf_7ttrqpw.png"><br><p>  <i>рдЪрд┐рддреНрд░рд╛ 3. рдЖрдЙрдЯрд▓реБрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЕрдЦрдВрдбрддрд╛ рд╕реНрддрд░</i> </p><br><p>  рдЕрдВрдд рдореЗрдВ, COM рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдХреЗ рдХреИрдкреНрдЪрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рд╕реЗ рдмрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдХреЗ рд░рд╛рд╕реНрддреЗ ( <code>C:\Users\User\Documents\mapid.tlb</code> рд╣рдорд╛рд░реЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ) рдкреНрд▓рдЧрдЗрдиреНрд╕ рдХреА рд╕реВрдЪреА рдореЗрдВ рджрд┐рдЦрд╛рдИ рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ рдирд┐рдореНрди рдЖрдХреГрддрд┐ рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред </p><br><img src="https://habrastorage.org/webt/4l/cj/s3/4lcjs3tai1gd5gopfekwd7skjra.png"><br><p>  <i>рдЪрд┐рддреНрд░рд╛ 4. рдЖрдЙрдЯрд▓реБрдХ рдкреНрд▓рдЧрдЗрдиреНрд╕ рдХреА рд╕реВрдЪреА - mapid.tlb рджрд┐рдЦрд╛рдИ рдирд╣реАрдВ рджреЗрддреА рд╣реИ</i> </p><br><p>  рдпрджрд┐ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдкреНрд░реЛрдЧреНрд░рд╛рдо рдРрдб-рдСрди рдХреА рд╕реВрдЪреА рдореЗрдВ рдкреНрд░рдХрдЯ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рднреА рдорд╛рдирдХ Microsoft API - MAPI (рдореИрд╕реЗрдЬрд┐рдВрдЧ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рдЗрдВрдЯрд░рдлрд╝реЗрд╕) рдХрд╛ рдЙрдкрдпреЛрдЧ рдЖрдЙрдЯрд▓реБрдХ рдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </p><br><h4>  2.1.2ред  рдмрд▓реНрд▓реЗ! </h4><br><p>  рдХрд╛рд▓рдХреНрд░рдо рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХреЗ рд░реВрдк рдореЗрдВ, рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ рдЕрдм рдмреИрдЯ рдХреЗ рд▓рд┐рдП рдкрдВрдЬреАрдХрд░рдг рдХреЛрдб рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рд╣реИ! .. рд╣рд╛рд▓рд╛рдВрдХрд┐, рдореЗрд▓рдмреЙрдХреНрд╕ рдФрд░ рд╕рдВрджреЗрд╢реЛрдВ рдХреЗ рдкреНрд░рдмрдВрдзрди рдХреЗ рд▓рд┐рдП рд╕рднреА рдХреЛрдб рдЕрднреА рднреА рдореМрдЬреВрдж рд╣реИрдВред  рдпрджрд┐ рдЖрд╡рд╢реНрдпрдХ рд╣реЛ, рддреЛ рдЗрд╕реЗ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </p><br><p>  рдЪрдордЧрд╛рджрдбрд╝ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреНрд▓рдЧрдЗрди рдХреЗ рд░реВрдк рдореЗрдВ рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП!  рдореИрд▓рд╡реЗрдпрд░ рдиреЗ <code>%appdata%\The Bat!\Mail\TBPlugin.INI</code> рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ <code>%appdata%\The Bat!\Mail\TBPlugin.INI</code> ред  рдпрд╣ рдЪрдордЧрд╛рджрдбрд╝ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреНрд▓рдЧрдЗрди рдХреЛ рдкрдВрдЬреАрдХреГрдд рдХрд░рдиреЗ рдХрд╛ рдПрдХ рд╡реИрдз рддрд░реАрдХрд╛ рд╣реИ!, рдХреБрдЫ рдкреНрд▓рдЧрдЗрдиреНрд╕ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдВрдЯреАрд╕реНрдкреИрдо) рднреА рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред </p><br><p>  рд╣рд░ рдмрд╛рд░ рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдЖрдк рдмреИрдЯ рд╢реБрд░реВ рдХрд░реЗрдВ!  рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ DLL рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред  рдиреАрдЪреЗ рджрд┐рдпрд╛ рдЧрдпрд╛ рдЖрдВрдХрдбрд╝рд╛ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ DLL рдкреНрд▓рдЧрдЗрдиреНрд╕ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдирд┐рд░реНрдпрд╛рдд рдХреИрд╕реЗ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИред </p><br><img src="https://habrastorage.org/webt/xq/x7/zs/xqx7zsv5pwjjmhonegcsmpmnwx0.png"><br><p>  <i>рдЪрд┐рддреНрд░рд╛ 5. рдЪрдордЧрд╛рджрдбрд╝ рдХреЗ рд▓рд┐рдП рдорд╛рдирдХ рдирд┐рд░реНрдпрд╛рдд!</i> </p><br><h3>  2.2ред  рдореЗрд▓ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд╕рд╛рде рд╕рд╣рднрд╛рдЧрд┐рддрд╛ </h3><br><p>  рдореЗрд▓ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд рд▓рдХреНрд╖реНрдп рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИред </p><br><h4>  2.2.1ред  Microsoft рдЖрдЙрдЯрд▓реБрдХ </h4><br><p>  Microsoft рдореИрд╕реЗрдЬрд┐рдВрдЧ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ (MAPI) рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Outlook рдХреЗ рд╕рд╛рде рд╕рд╣рднрд╛рдЧрд┐рддрд╛</a> рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред  рддреБрд░рд▓рд╛ рдмреИрдХрдбреЛрд░ рдЗрд╕ рдПрдкреАрдЖрдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рд╕рдордЭреМрддрд╛ рдкреНрд░рдгрд╛рд▓реА рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ / рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рдореЗрд▓рдмреЙрдХреНрд╕ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдФрд░ рдкреНрд░рдмрдВрдзрди рдХреЗ рд▓рд┐рдП рдХрд░рддрд╛ рд╣реИред </p><br><p>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ MAPILogonEx рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдВрджреЗрд╢ рдкреНрд░рдгрд╛рд▓реА рд╕реЗ рдЬреБрдбрд╝рддрд╛ рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ рдЪрд┐рддреНрд░ рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред </p><br><img src="https://habrastorage.org/webt/nf/fp/u1/nffpu1duhw9u7rmxytdm1chwpey.png"><br><p>  <i>рдЪрд┐рддреНрд░рд╛ 6. MAPI рд▓реЙрдЧрдСрди</i> </p><br><p>  рджреВрд╕рд░рд╛ рдкреИрд░рд╛рдореАрдЯрд░ (lpszProfileName) рдЦрд╛рд▓реА рд╣реИ, <code>MAPI_USE_DEFAULT</code> рдзреНрд╡рдЬ <code>MAPI_USE_DEFAULT</code> ред  рдкреНрд░рд▓реЗрдЦрди рдХреЗ рдЕрдиреБрд╕рд╛рд░: "рд╕рдВрджреЗрд╢ рдЙрдкрддрдВрддреНрд░ рдХреЛ lpszProfileName рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдирд╛рдо рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдб рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред <code>MAPI_EXPLICIT_PROFILE</code> рдзреНрд╡рдЬ <code>MAPI_EXPLICIT_PROFILE</code> рддрдм рддрдХ рдЕрдирджреЗрдЦрд╛ рдХрд┐рдпрд╛ <code>MAPI_EXPLICIT_PROFILE</code> рд╣реИ рдЬрдм рддрдХ рдХрд┐ lpszProfileName рдкреВрд░реНрдг рдпрд╛ рдЦрд╛рд▓реА рди рд╣реЛред" </p><br><p>  рдЗрд╕рдХреЗ рд╡рд┐рдкрд░реАрдд, <code>MAPI_NEW_SESSION</code> рдзреНрд╡рдЬ рд╕реЗрдЯ рдирд╣реАрдВ рд╣реИред  рдкреНрд░рд▓реЗрдЦрди рдХреЗ рдЕрдиреБрд╕рд╛рд░: " <code>lpszProfileName</code> рдкреИрд░рд╛рдореАрдЯрд░ <code>lpszProfileName</code> рдирдЬрд░рдЕрдВрджрд╛рдЬ рдХрд░ рджрд┐рдпрд╛ <code>lpszProfileName</code> рд╣реИ рдпрджрд┐ <code>MAPI_ALLOW_OTHERS</code> рдзреНрд╡рдЬ <code>MAPI_ALLOW_OTHERS</code> рд╕рд╛рде MapiLogonEx рдирд╛рдордХ рдПрдХ рдкрд┐рдЫрд▓рд╛ рд╕рддреНрд░ рд╣реЛ рдФрд░ рдпрджрд┐ <code>MAPI_NEW_SESSION</code> рдзреНрд╡рдЬ рд╕реЗрдЯ рдирд╣реАрдВ рд╣реИред" </p><br><p>  рд╣рдорд╛рд░реА рд░рд╛рдп рдореЗрдВ, рдЖрдЙрдЯрд▓реБрдХ рдлреНрд▓реИрдЧ <code>MAPI_ALLOW_OTHERS</code> рд╕рд╛рде рдПрдХ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕рддреНрд░ рдЦреЛрд▓рддрд╛ рд╣реИред  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдмреИрдХрдбреЛрд░ рдореЗрд▓рдмреЙрдХреНрд╕ рдХреЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рддрдХ рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╣рд▓реЗ рд╕реЗ рдЦреЛрд▓реЗ рдЧрдП рд╕рддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛ред  рдпрд╣ рдмреИрдХрдбреЛрд░ рдкреНрд▓рдЧ рдЗрди рдХреЛ рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд░рддреЗ рд╕рдордп рдпреВрдЬрд╝рд░рдиреЗрдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдХреА рдХрдореА рдХреЛ рдмрддрд╛рддрд╛ рд╣реИред </p><br><p>  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдореЗрд▓рдмреЙрдХреНрд╕ рддрдХ рдкрд╣реБрдБрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдЧрд╛ рдФрд░ рдЕрдиреНрдп MAPI рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕реЗ рдЖрд╕рд╛рдиреА рд╕реЗ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдЧрд╛ред  рдпрд╣ рд╡рд┐рднрд┐рдиреНрди рдореИрд╕реЗрдЬ рд╕реНрдЯреЛрд░реНрд╕, рдкрд╛рд░реНрд╕ рд▓реЗрдЯрд░реНрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреБрдирд░рд╛рд╡реГрддрд┐ рдХрд░реЗрдЧрд╛, рдФрд░ рдЖрдиреЗ рд╡рд╛рд▓реЗ рдФрд░ рдмрд╛рд╣рд░ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕рдВрджреЗрд╢реЛрдВ рдореЗрдВ рдХреЙрд▓рдмреИрдХ рдЬреЛрдбрд╝ рджреЗрдЧрд╛ред  рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддреА рд╣реИ (рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрддрд╛ рдкрд░рд┐рд╡рд░реНрддрд┐рдд): </p><br><pre> <code class="hljs pgsql">&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; ========= Analyzing msg store ( <span class="hljs-number"><span class="hljs-number">1</span></span> / <span class="hljs-number"><span class="hljs-number">1</span></span> ) ========= Service <span class="hljs-type"><span class="hljs-type">name</span></span>:MSUPST MS Pst <span class="hljs-type"><span class="hljs-type">path</span></span>:C:\Users\[username]\Documents\Outlook Files\[email address].pst Wait main <span class="hljs-keyword"><span class="hljs-keyword">window</span></span> <span class="hljs-keyword"><span class="hljs-keyword">before</span></span> <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> store <span class="hljs-keyword"><span class="hljs-keyword">Loop</span></span> count = <span class="hljs-number"><span class="hljs-number">46</span></span> This <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> message store PUSH store <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> list &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; _____________ FOLDERS _____________ Setting sink <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> folders <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> stores. ========Process msg store ( <span class="hljs-number"><span class="hljs-number">1</span></span> / <span class="hljs-number"><span class="hljs-number">1</span></span> ) ========= Account: [email address] Successfull <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> sink <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> Outbox folder <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> store. Successfull <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> sink <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> Inbox folder <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> store.</code> </pre> <br><p>  рдпрд╣ рдкреНрд░рддреНрдпреЗрдХ рдЗрдирдмреЙрдХреНрд╕ рдФрд░ <code>HrAllocAdviseSink</code> рдореЗрдВ рдХреЙрд▓рдмреИрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП <code>HrAllocAdviseSink</code> рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред </p><br><img src="https://habrastorage.org/webt/ud/df/js/uddfjs5ub7qj9n3gxlxslirppcq.png"><br><p>  <i>рдЪрд┐рддреНрд░ 7. рдЖрдЙрдЯрдмреЙрдХреНрд╕ рдореЗрдВ рдХреЙрд▓рдмреИрдХ рджрд░реНрдЬ рдХрд░рдирд╛</i> </p><br><p>  <b>2.2.1.1ред</b>  <b>рдХреЙрд▓рдмреИрдХ рдЗрдирдмреЙрдХреНрд╕</b> </p><br><p>  рдЗрдирдмреЙрдХреНрд╕ рдореЗрдВ рдХреЙрд▓рдмреИрдХ рдЖрдиреЗ рд╡рд╛рд▓реЗ рд╕рдВрджреЗрд╢ рдХрд╛ рдореЗрдЯрд╛рдбреЗрдЯрд╛ рд░рд┐рдХреЙрд░реНрдб рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдкреНрд░реЗрд╖рдХ рдФрд░ рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рдкрддреЗ, рд╡рд┐рд╖рдп рдФрд░ рдЕрдиреБрд▓рдЧреНрдирдХ рдирд╛рдо рд╢рд╛рдорд┐рд▓ рд╣реИрдВред  рдиреАрдЪреЗ рдЙрджрд╛рд╣рд░рдг (рдбреЗрд╡рд▓рдкрд░ рд╕реНрдкреЗрд▓рд┐рдВрдЧ рд╕рд╣реЗрдЬреА рдЧрдИ): </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">RECIVE</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-</span></span>&gt;{ <span class="hljs-attribute"><span class="hljs-attribute">From</span></span>: sender@example.com To: receiver@example.net Cc: Bcc: Subj: Mail subject Att: an_attachment.pdf }</code> </pre> <br><p>  рдлрд┐рд░ рд╡рд╣ рд╣рдорд▓рд╛рд╡рд░реЛрдВ рд╕реЗ рдЯреАрдореЛрдВ рдХреЗ рд╡рд┐рд╖рдп рдкрд░ рдкрддреНрд░ рдФрд░ рд╕рдВрд▓рдЧреНрдирдХ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рддрд╛ рд╣реИред  рдпрд╣ рдлрд╝рдВрдХреНрд╢рди рдзрд╛рд░рд╛ 2.3 рдореЗрдВ рд╡рд░реНрдгрд┐рдд рд╣реИред </p><br><p>  рдЕрдВрдд рдореЗрдВ, рдпрд╣ рдСрдкрд░реЗрдЯрд░ рдХреЗ рдИрдореЗрд▓ рдкрддреЗ рдХреЗ рд╕рд╛рде рдЖрдиреЗ рд╡рд╛рд▓реЗ рд╕рдВрджреЗрд╢реЛрдВ рдХреА рдЬрд╛рдБрдЪ рдХрд░рдХреЗ NDRs рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИред  рдСрдкрд░реЗрдЯрд░ рдХреЗ рдкрддреЗ рд╡рд╛рд▓реЗ рдХрд┐рд╕реА рднреА рдкрддреНрд░ рдХреЛ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рдпрд╣ рд╕рдорд╕реНрдпрд╛ рдкреИрджрд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдпрджрд┐ рдкреАрдбрд╝рд┐рдд рдХреЛ рд╕рдВрджреЗрд╣ рд╣реИ рдХрд┐ рдХреБрдЫ рдЧрд▓рдд рд╣реИ рдФрд░ рдЬрд╡рд╛рдм рджреЗрдЦреЗ рдмрд┐рдирд╛ рд╕рд╣рд╛рдпрддрд╛ рд╕реЗрд╡рд╛ рд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░рддрд╛ рд╣реИред </p><br><p>  <b>2.2.1.2ред</b>  <b>рдЖрдЙрдЯрдмреЙрдХреНрд╕ рдореЗрдВ рдХреЙрд▓рдмреИрдХ</b> </p><br><p>  рдЗрдирдмреЙрдХреНрд╕ рдХреЗ рд░реВрдк рдореЗрдВ, рдЖрдЙрдЯрдмреЙрдХреНрд╕ рд╕рднреА рднреЗрдЬреЗ рдЧрдП рдИрдореЗрд▓реЛрдВ рдХреЗ рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдХреЛ рд░рд┐рдХреЙрд░реНрдб рдХрд░рддрд╛ рд╣реИред  рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд░рд┐рдХреЙрд░реНрдб рдЙрддреНрдкрдиреНрди рд╣реЛрддрд╛ рд╣реИ (рдСрдкрд░реЗрдЯрд░ рдкрддрд╛ рдмрджрд▓ рдЧрдпрд╛): </p><br><pre> <code class="hljs css">21<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:57</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:56</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">SEND</span></span> &lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">-</span></span>{ <span class="hljs-attribute"><span class="hljs-attribute">From</span></span>: To: recipient@example.com Cc: Bcc: Subj: My title Att: [<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-string"><span class="hljs-string">"last_presentation.pdf"</span></span> } 21<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:57</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:56</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Sending</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">data</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">message</span></span> 21<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:57</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:56</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Message</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ENTRYID</span></span>: <span class="hljs-selector-attr"><span class="hljs-selector-attr">[Message ENTRYID]</span></span> 21<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:57</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:56</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Data</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">message</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">was</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">send</span></span>. <span class="hljs-selector-tag"><span class="hljs-selector-tag">To</span></span>: <span class="hljs-selector-attr"><span class="hljs-selector-attr">[redacted]</span></span>@<span class="hljs-keyword"><span class="hljs-keyword">gmx</span></span>[.]<span class="hljs-keyword"><span class="hljs-keyword">com</span></span> From: Subj: My title <span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">57</span></span>:<span class="hljs-number"><span class="hljs-number">56</span></span> Set last time. <span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">57</span></span>:<span class="hljs-number"><span class="hljs-number">56</span></span> Spawned thread for cleaning up outgoing messages (id <span class="hljs-number"><span class="hljs-number">2848</span></span>) <span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">58</span></span>:<span class="hljs-number"><span class="hljs-number">34</span></span> Ending work, client: Outlook <span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">58</span></span>:<span class="hljs-number"><span class="hljs-number">34</span></span> Number of messages to remove: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">58</span></span>:<span class="hljs-number"><span class="hljs-number">34</span></span> Message ENTRYID: [Message ENTRYID] <span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">58</span></span>:<span class="hljs-number"><span class="hljs-number">34</span></span> DeleteMessages executed successfully. <span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">58</span></span>:<span class="hljs-number"><span class="hljs-number">34</span></span> Number of not removed messages: <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br><p>  рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдХреЗ рдкрддреЗ рдкрд░ рдЖрдиреЗ рд╡рд╛рд▓реЗ рд╣рд░ рд╕рдВрджреЗрд╢ рдХреЛ рдЖрдЧреЗ рдмрдврд╝рд╛рддрд╛ рд╣реИ, <code>[тАж]@gmx[.]com</code> ред  GMX - рдПрдХ рд▓реЛрдХрдкреНрд░рд┐рдп рдореБрдлреНрдд рдИрдореЗрд▓ рд╕реЗрд╡рд╛;  рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдиреЗ рд╢рд╛рдпрдж рдЗрд╕реЗ рдЪреБрдирд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╕рдВрдЧрдарди рдЖрдорддреМрд░ рдкрд░ gmx.com рдбреЛрдореЗрди рдХреЛ рдмреНрд▓реЙрдХ рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВред </p><br><p>  рдпрд╣ рдИрдореЗрд▓ рдкрддрд╛ рд╣рдорд╛рд░реЗ рджреНрд╡рд╛рд░рд╛ рдЕрдзреНрдпрдпрди рдХрд┐рдП рдЧрдП рдирдореВрдиреЗ рдореЗрдВ рд╣рд╛рд░реНрдб-рдХреЛрдбрд┐рдд рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ рдиреАрдЪреЗ рдХреА рдЫрд╡рд┐ рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрд╕реЗ рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдХрд╛рд░реНрдпреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдкрдбреЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рд╣рдорд▓рд╛рд╡рд░ рдкреНрд░рддреНрдпреЗрдХ рд▓рдХреНрд╖реНрдп рдХреЗ рд▓рд┐рдП рдХрдо рд╕реЗ рдХрдо рдПрдХ рдИрдореЗрд▓ рдкрддрд╛ рджрд░реНрдЬ рдХрд░рддреЗ рдкреНрд░рддреАрдд рд╣реЛрддреЗ рд╣реИрдВ <br>  рд╕рдВрдЧрдардиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдкреНрд░рд╛рд░реВрдк <code>firstname.lastname@gmx[.]com</code> рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдХрд░реНрдордЪрд╛рд░реА рдХреЗ рдирд╛рдо рдХреЗ рд╕рд╛рде <code>firstname.lastname@gmx[.]com</code> ред  рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рд╕реЗ рдмрдЪрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдХрд░реНрдордЪрд╛рд░реА рдХреЗ рд╡реНрдпрдХреНрддрд┐рдЧрдд рдореЗрд▓рдмреЙрдХреНрд╕ рд╕реЗ рдЗрд╕ рддрд░рд╣ рдХреЗ рдкрддреЗ рдХреЛ рднреЗрдж рдХрд░рдирд╛ рдЕрдХреНрд╕рд░ рдореБрд╢реНрдХрд┐рд▓ рд╣реЛрддрд╛ рд╣реИред  рдЬреВрди 2018 рдореЗрдВ рдирдореВрдирд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд╕рдордп, рдкрддрд╛ рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рдерд╛ред </p><br><img src="https://habrastorage.org/webt/9c/tr/-d/9ctr-dcusp0p35kcuhiqw4pypns.png"><br><p>  <i>рдЪрд┐рддреНрд░рд╛ 8. рдСрдкрд░реЗрдЯрд░реЛрдВ рдХрд╛ рд╣рд╛рд░реНрдб-рдХреЛрдбрд┐рдд рдкрддрд╛</i> </p><br><p>  рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдХреБрдЫ рдирд┐рд╢реНрдЪрд┐рдд рдЕрдВрддрд░рд╛рд▓ рдкрд░ рдСрдкрд░реЗрдЯрд░реЛрдВ рдХреЗ рдкрддреЗ рдкрд░ рд░рд┐рдкреЛрд░реНрдЯ рднреЗрдЬрддреЗ рд╣реИрдВред  рд░рд┐рдкреЛрд░реНрдЯ рдореЗрдВ рдореИрдХ рдкрддрд╛, рдкреВрд░реНрдг рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓, рдФрд░ рдпрджрд┐ рдХреЛрдИ рд╣реЛ, рд╕рд╣рд┐рдд рдЕрджреНрд╡рд┐рддреАрдп рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред  рдлрд┐рд░ рдпрд╣ MISTY1 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбреЗрдЯрд╛ рдХреЛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд░рддрд╛ рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ рдЖрдЧреЗ 2.3.2.2 рдЦрдВрдб рдореЗрдВ рд╡рд░реНрдгрд┐рдд рд╣реИ, рдФрд░ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рдПрдХ рдорд╛рдиреНрдп рдкреАрдбреАрдПрдл рдлрд╛рдЗрд▓ рдмрдирд╛рддрд╛ рд╣реИред  рдЗрд╕ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдбреЗрдЯрд╛ рдмреНрд▓реЙрдм рд╕реЗ рдкрд╣рд▓реЗ, рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдореЗрдВ jpeg рдореЗрдВ 1x1 рд╕рдлреЗрдж рдЫрд╡рд┐ рд╣реИ, рдЬреЛ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдкреНрд░реЛрдЧреНрд░рд╛рдо рдореЗрдВ рд╣рд╛рд░реНрдб-рдХреЛрдбреЗрдб рд╣реИред  рдпрд╣ рдЖрдкрдХреЛ рдПрдХ рд╡реИрдз рдкреАрдбреАрдПрдл рдмрдирд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдЦреЛрд▓рдиреЗ рдкрд░, рдХреЗрд╡рд▓ рдПрдХ рдЦрд╛рд▓реА рдкреГрд╖реНрда рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред </p><br><p>  рдЕрдВрдд рдореЗрдВ, рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдкреАрдбреАрдПрдл рд╕рдВрд▓рдЧреНрди рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдХреЛ рдПрдХ рдИрдореЗрд▓ рднреЗрдЬрддрд╛ рд╣реИред  рдиреАрдЪреЗ рджрд┐рдпрд╛ рдЧрдпрд╛ рдЖрдВрдХрдбрд╝рд╛ рдПрдХ рдкреАрдбреАрдПрдл рдлрд╛рдЗрд▓ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИ рдЬреЛ рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдИ рдЧрдИ рд╣реИред </p><br><img src="https://habrastorage.org/webt/d4/6f/yx/d46fyxd9n7e-ziu9jwjxdtedqke.png"><br><p>  <i>рдЪрд┐рддреНрд░ 9. рдбреЗрдЯрд╛ рдХреЛ рдПрдХреНрд╕рдлрд╝рд┐рд▓рд┐рдПрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдИ рдЧрдИ рдПрдХ рдкреАрдбреАрдПрдл рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреА рд╢реБрд░реБрдЖрдд</i> </p><br><p>  рдЖрдЙрдЯрдмреЙрдХреНрд╕ рдореЗрдВ рдХреЙрд▓рдмреИрдХ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд░рд┐рдкреЛрд░реНрдЯ рднреЗрдЬреА рдЬрд╛рддреА рд╣реИред  рдЗрд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рд╡реИрдз рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ рднреЗрдЬрдиреЗ рдХреЗ рд╕рд╛рде рд╣реА рдкрддреНрд░ рдирд┐рдХрд▓ рдЬрд╛рдПрдЧрд╛ред  рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рдордп рдкрд░ рдЪреЛрд░реА рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдкрддреНрд░ рдирд╣реАрдВ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕рд▓рд┐рдП рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рд╕реЗ рдмрдЪрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЪреБрдкрдХреЗ рд╕реЗ рдзрдиреНрдпрд╡рд╛рдж, рдпрд╣ рдирд┐рдпрдВрддреНрд░рдг рдФрд░ рдирд┐рдпрдВрддреНрд░рдг рддрдВрддреНрд░ рдЬрдВрдЧрд▓реА рдореЗрдВ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рдмрд╣реБрдд рдореБрд╢реНрдХрд┐рд▓ рд╣реИред </p><br><h4>  2.2.2ред  рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рдЫрд┐рдкрд╛рдиреЗ </h4><br><p>  рдЪреВрдВрдХрд┐ рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрдВрдкреНрдпреВрдЯрд░ рдФрд░ рдЖрдЙрдЯрд▓реБрдХ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рддреЛ рдореИрд▓рд╡реЗрдпрд░ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдЧрддрд┐рд╡рд┐рдзрд┐ рдХреЛ рдЫрд┐рдкрд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддрд╛ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдСрдкрд░реЗрдЯрд░реЛрдВ рд╕реЗ рдЖрдиреЗ рд╡рд╛рд▓реЗ рд╕рдВрджреЗрд╢ред </p><br><p>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдПрдХ рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рд╣рдореЗрд╢рд╛ рдСрдкрд░реЗрдЯрд░реЛрдВ рд╕реЗ рднреЗрдЬреЗ рдЧрдП рдпрд╛ рдкреНрд░рд╛рдкреНрдд рдореЗрд▓ рдХреЛ рд╣рдЯрд╛ рджреЗрддрд╛ рд╣реИред  рдЬреИрд╕рд╛ рдХрд┐ рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдЖрдВрдХрдбрд╝реЗ рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдХреБрдЫ рд╕реЗрдХрдВрдб рдХреЗ рд▓рд┐рдП рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдПрдХ рдирдпрд╛ рд╕рдВрджреЗрд╢ рджрд┐рдЦрд╛рдИ рджрд┐рдпрд╛ рд╣реИ, рдЬреЛ рд╣рд╛рд▓рд╛рдВрдХрд┐, рдореЗрд▓рдмреЙрдХреНрд╕ рдореЗрдВ рджрд┐рдЦрд╛рдИ рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИред </p><br><img src="https://habrastorage.org/webt/o7/pc/wh/o7pcwhrtwemk2qfqrfdtgjb6p0o.png"><br><p>  <i>рдЪрд┐рддреНрд░ 10. рдЕрдкрдард┐рдд рд╕рдВрджреЗрд╢</i> </p><br><p>  рджреВрд╕рд░реЗ, рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ <code>CreateWindowsEx</code> рдХреЛ <code>CreateWindowsEx</code> , рдЬреИрд╕рд╛ рдХрд┐ рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдЖрдВрдХрдбрд╝реЛрдВ рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред  рдпрд╣ NetUIHWND рдЬреИрд╕реЗ рд╡рд┐рдВрдбреЛрдЬрд╝ рдХреЗ рдирд┐рд░реНрдорд╛рдг рдХреЛ рд░реЛрдХрддрд╛ рд╣реИ рдЬреЛ рдЖрдЙрдЯрд▓реБрдХ рд╕реНрдХреНрд░реАрди рдХреЗ рдирд┐рдЪрд▓реЗ рджрд╛рдПрдВ рд╣рд┐рд╕реНрд╕реЗ рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗрдиреЗ рд╡рд╛рд▓реА рд╕реВрдЪрдирд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред </p><br><img src="https://habrastorage.org/webt/7y/wn/xq/7ywnxqshbevin9-ncsw8lhprkvo.png"><br><p>  <i>рдЪрд┐рддреНрд░ 11. CreateWindowsEx рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдХреИрдкреНрдЪрд░ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдирд╛</i> </p><br><img src="https://habrastorage.org/webt/ki/1_/zr/ki1_zrks5vaspkm-bpz2j-z9asu.png"><br><p>  <i>рдЪрд┐рддреНрд░рд╛ 12. рдЕрд╡рд░реЛрдзрди CreateWindowsEx</i> </p><br><p>  рдиреАрдЪреЗ рджрд┐рдпрд╛ рдЧрдпрд╛ рдЖрдВрдХрдбрд╝рд╛ NetUIHWND рд╡рд┐рдВрдбреЛ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рджрд┐рдЦрд╛рддрд╛ рд╣реИ, рдЬреЛ рдЖрдорддреМрд░ рдкрд░ рдПрдХ рдирдпрд╛ рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рд╣реЛрдиреЗ рдкрд░ рдбреЗрд╕реНрдХрдЯреЙрдк рдкрд░ рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИред  <code>CreateWindowEx</code> рдХреЗ рдЕрд╡рд░реЛрдзрди рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдЬрдм рд╣рдорд▓рд╛рд╡рд░ рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдкрд░ рдПрдХ рдкрддреНрд░ рднреЗрдЬрддреЗ рд╣реИрдВ рддреЛ рдПрдХ рдЕрдзрд┐рд╕реВрдЪрдирд╛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдирд╣реАрдВ рд╣реЛрддреА рд╣реИред </p><br><img src="https://habrastorage.org/webt/bd/5n/3b/bd5n3bq_pijmhlosvf6muvjcyjq.png"><br><p>  <i>рдЪрд┐рддреНрд░ 13. рдирдпрд╛ рд╕рдВрджреЗрд╢ рдЕрдзрд┐рд╕реВрдЪрдирд╛</i> </p><br><h4>  2.2.3ред  рдмрд▓реНрд▓реЗ! </h4><br><p>  рдЗрд╕ рддрдереНрдп рдХреЗ рдмрд╛рд╡рдЬреВрдж рдХрд┐ рдж рдмреИрдЯ рдХреЗ рд▓рд┐рдП рдкреНрд▓рдЧрдЗрди рдХрд╛ рдкрдВрдЬреАрдХрд░рдг рдХрд╛рд░реНрдп!  рдЕрдм рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИ, рд╡рд┐рд░рд╛рд╕рдд рдореЗрдВ рдорд┐рд▓рд╛ рдХреЛрдб рд╣реИ рдЬреЛ рдж рдмреИрдЯ-рдПрдкреАрдЖрдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдЙрдЯрд▓реБрдХ рдХреЗ рд▓рд┐рдП рд╕рдорд╛рди рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИред </p><br><p>  рдЬреИрд╕рд╛ рдХрд┐ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЖрдХреГрддрд┐ рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдж рдмреИрдЯ рдХреЗ рд╕рд╛рде рд╕рдВрдЪрд╛рд░ рдЪреИрдирд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ! рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ, рдкрддреНрд░ рдкрдврд╝рдиреЗ рдФрд░ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдПред  рд╣рд╛рд▓рд╛рдБрдХрд┐, рдЕрдиреНрдп рд╕рднреА рдлрд╝рдВрдХреНрд╢рди, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╕рдВрджреЗрд╢ рд▓реЙрдЧ рдХрд░рдиреЗ рдпрд╛ рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдЖрдЙрдЯрд▓реБрдХ рдХреЗ рд╕рдорд╛рди рд╣реИрдВред </p><br><img src="https://habrastorage.org/webt/iy/qb/ub/iyqbubrelp4uwudy8n4gby7n6lq.png"><br><p>  <i>рдЪрд┐рддреНрд░рд╛ 14. рдЪрдордЧрд╛рджрдбрд╝! рдЪреИрдирд▓</i> </p><br><h3>  2.3ред  рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ </h3><br><p>  рдЬреИрд╕рд╛ рдХрд┐ рдкрд┐рдЫрд▓реЗ рдЕрдиреБрднрд╛рдЧ рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдореИрд▓рд╡реЗрдпрд░ рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдФрд░ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИред  рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ, рдпрд╣ рдПрдХ рдкреВрд░реА рддрд░рд╣ рдХрд╛рд░реНрдпрд╛рддреНрдордХ рдИрдореЗрд▓-рд╕рдВрдЪрд╛рд▓рд┐рдд рдмреИрдХрдбреЛрд░ рд╣реИ рдЬреЛ рдХрд┐рд╕реА рдЕрдиреНрдп рддреБрд░реНрд▓рд╛ рдШрдЯрдХ рдХреЗ рд╕реНрд╡рддрдВрддреНрд░ рд░реВрдк рд╕реЗ рдХрд╛рдо рдХрд░ рд╕рдХрддрд╛ рд╣реИред  рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдХреЛ рдПрдХ рд╕реНрдерд╛рдпреА рдЗрдВрдЯрд░рдиреЗрдЯ рдХрдиреЗрдХреНрд╢рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ рдФрд░ рдХрд┐рд╕реА рднреА рдХрдВрдкреНрдпреВрдЯрд░ рдкрд░ рдХрд╛рдо рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдмрд╛рд╣рд░реА рдкрддреЗ рдкрд░ рд╕рдВрджреЗрд╢ рднреЗрдЬрддрд╛ рд╣реИред  рдпрд╣ рдХрдбрд╝рд╛рдИ рд╕реЗ рдирд┐рдпрдВрддреНрд░рд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рдЙрдкрдпреЛрдЧреА рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЗрдВрдЯрд░рдиреЗрдЯ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░рдирд╛ред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдЕрдЧрд░ рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдХрд╛ рдИрдореЗрд▓ рдкрддрд╛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рд╣реИ, рддреЛ рд╡реЗ рдПрдХ рдЕрд▓рдЧ рдкрддреЗ рд╕реЗ рдПрдХ рдХрдорд╛рдВрдб рднреЗрдЬрдХрд░ рдирд┐рдпрдВрддреНрд░рдг рд╣рд╛рд╕рд┐рд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдкрддреНрд░ рдХреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗ рднреА рдЫрд┐рдкрд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рдореЗрдВ рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рджреНрд╡рд╛рд░рд╛ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд┐рдП рдЧрдП рдХрдорд╛рдВрдб рд╣реЛрдВрдЧреЗред  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдПрдХ рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдПрдХ рд░реВрдЯрдХрд┐рдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдЧрд▓рддреА рд╕рд╣рд┐рд╖реНрдгреБ рд╣реИ рдЬреЛ рдЖрдиреЗ рд╡рд╛рд▓реЗ рдиреЗрдЯрд╡рд░реНрдХ рдпрд╛рддрд╛рдпрд╛рдд рдХреА рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИред </p><br><h4>  2.3.1ред  рдкреАрдбреАрдПрдл рдкреНрд░рд╛рд░реВрдк </h4><br><p>  2018 рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ, рдХрдИ рдореАрдбрд┐рдпрд╛ рдЖрдЙрдЯрд▓реЗрдЯреНрд╕ рдиреЗ рдХрд╣рд╛ рдХрд┐ рдЯрд░реНрд▓рд╛ рдСрдкрд░реЗрдЯрд░ рд╕рдВрдХреНрд░рдорд┐рдд рдХрдВрдкреНрдпреВрдЯрд░реЛрдВ рдХреЗ рдкреНрд░рдмрдВрдзрди рдХреЗ рд▓рд┐рдП рдИрдореЗрд▓ рдЕрдЯреИрдЪрдореЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  рдореАрдбрд┐рдпрд╛ рд╕рд╣реА рдерд╛ред  рддреБрд░рд▓рд╛ рдЖрдЙрдЯрд▓реБрдХ рдХреЗ рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдХреЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рд╕реЗ рдкрддрд╛ рдЪрд▓рд╛ рдХрд┐ рдпрд╣ рдХреИрд╕реЗ рдЖрджреЗрд╢ рднреЗрдЬрддрд╛ рд╣реИ рдФрд░ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд░рддрд╛ рд╣реИред </p><br><p>  рдХрдорд╛рдВрдб рдХреЛ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдирд┐рд░реНрдорд┐рдд рдкреАрдбреАрдПрдл рдЕрдЯреИрдЪрдореЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдИрдореЗрд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рд╣рдо рдЖрджреЗрд╢реЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдирдореВрдирд╛ рдкреАрдбреАрдПрдл рдХреЛ рдЦреЛрдЬрдиреЗ рдореЗрдВ рдЕрд╕рдорд░реНрде рдереЗ, рд▓реЗрдХрд┐рди рдпреЗ рд╕рдВрднрд╡рддрдГ рд╡реИрдз рдкреАрдбреАрдПрдл рджрд╕реНрддрд╛рд╡реЗрдЬ рд╣реИрдВ, рд╕рд╛рде рд╣реА рд╕рд╛рде рдПрдХреНрд╕рдлрд╝рд┐рд▓реНрдЯрд░реЗрд╢рди рдХреЗ рд▓рд┐рдП рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдИ рдЧрдИ рдкреАрдбреАрдПрдл рдлрд╛рдЗрд▓реЗрдВ рднреА рд╣реИрдВред </p><br><p>  рдкреАрдбреАрдПрдл рджрд╕реНрддрд╛рд╡реЗрдЬреЛрдВ рд╕реЗ, рдПрдХ рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдХреЛ рдмрд╣рд╛рд▓ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдСрдкрд░реЗрдЯрд░ рдкрддреНрд░рд┐рдХрд╛рдУрдВ рдореЗрдВ рдПрдХ рдХрдВрдЯреЗрдирд░ рдХрд╣рддреЗ рд╣реИрдВред  рдпрд╣ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдкреНрд░рд╛рд░реВрдк рдХреЗ рд╕рд╛рде рдПрдХ рдмреВрдБрдж рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдХреЗ рд▓рд┐рдП рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдХрдорд╛рдВрдб рд╢рд╛рдорд┐рд▓ рд╣реИрдВред  рдиреАрдЪреЗ рджрд┐рдпрд╛ рдЧрдпрд╛ рдЖрдВрдХрдбрд╝рд╛ рдЗрд╕ рдХрдВрдЯреЗрдирд░ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджрд┐рдЦрд╛рддрд╛ рд╣реИред  рддрдХрдиреАрдХреА рд░реВрдк рд╕реЗ, рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдПрдХ рд╡реИрдз рдкреАрдбреАрдПрдл рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╣реЛрдирд╛ рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реИред  рдХреЗрд╡рд▓ рдЖрд╡рд╢реНрдпрдХрддрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЗрд╕рдореЗрдВ рдХрдВрдЯреЗрдирд░ рдХреЛ рд╕рд╣реА рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд┐рдпрд╛ рдЬрд╛рдПред </p><br><img src="https://habrastorage.org/webt/hb/r_/yf/hbr_yfy47qewou5f_tqbrpdn5ck.png"><br><p>  <i>рдЪрд┐рддреНрд░рд╛ 15. рдкреАрдбреАрдПрдл рд╕реЗ рдХрдорд╛рдВрдб рдХрдВрдЯреЗрдирд░ рдХреЛ рдирд┐рдХрд╛рд▓рдирд╛</i> </p><br><p>  рдХрдВрдЯреЗрдирд░ рдореЗрдВ рдХрдИ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЪреЗрдХ рдХреЗ рд╕рд╛рде рдПрдХ рдЬрдЯрд┐рд▓ рд╕рдВрд░рдЪрдирд╛ рд╣реЛрддреА рд╣реИред  рдпрд╣ рд╕рдВрдЪрд╛рд░ рддреНрд░реБрдЯрд┐рдпреЛрдВ рдХреЛ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╣рдо рдорд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рд╕рдВрд░рдЪрдирд╛ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рд░рд┐рд╡рд░реНрд╕ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рдХрд╛ рдореБрдХрд╛рдмрд▓рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдИ рдЧрдИ рдереАред  рдХрдВрдЯреЗрдирд░ рдХреА рд╕рдВрд░рдЪрдирд╛ рдиреАрдЪреЗ рдХреА рдЖрдХреГрддрд┐ рдореЗрдВ рджрд┐рдЦрд╛рдИ рдЧрдИ рд╣реИред </p><br><img src="https://habrastorage.org/webt/ud/aa/6w/udaa6wvubnjskhmfrgsoalfke70.png"><br><p>  <i>рдЪрд┐рддреНрд░ 16. рдХрдорд╛рдВрдб рдХрдВрдЯреЗрдирд░ рд╕рдВрд░рдЪрдирд╛</i> </p><br><p>  рдЖрд░рдВрднреАрдХрд░рдг рд╡реЗрдХреНрдЯрд░ рд╕реЗ рдареАрдХ рдкрд╣рд▓реЗ, рдХрдорд╛рдВрдб рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ рдХреА рдПрдХ рд╕реВрдЪреА рд╣реИред  рд╡рд┐рднрд┐рдиреНрди рдЖрдИрдбреА рдорд╛рди рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдП рдЧрдП рд╣реИрдВ: </p><br><img src="https://habrastorage.org/webt/jy/sg/5o/jysg5opuoyhwir5hre-xi9quhxq.png"><br><p><br>  рдЖрдИрдбреА рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ 2 рдФрд░ 4 рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдФрд░ рдбреАрдХреЛрдкреНрд░реЗрд╢рди рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ рдирд┐рдореНрди рдЖрдХреГрддрд┐ рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред  рд╣рд╛рд▓рд╛рдБрдХрд┐, рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЗрд╡рд▓ рдПрдХ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдФрд░ рдПрдХ рд╕рдВрдкреАрдбрд╝рди рдПрд▓реНрдЧреЛрд░рд┐рдердо рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИред  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдЗрди рдХреНрд╖реЗрддреНрд░реЛрдВ рдХрд╛ рдПрдХрдорд╛рддреНрд░ рдЙрджреНрджреЗрд╢реНрдп рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдХреЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЛ рдЬрдЯрд┐рд▓ рдХрд░рдирд╛ рд╣реИред </p><br><img src="https://habrastorage.org/webt/h8/sh/gu/h8shgunmwafcbx6h1shccn9-ndo.png"><br><p>  <i>рдЪрд┐рддреНрд░ 17. рдЕрдкрдШрдЯрди рдФрд░ рдбрд┐рдХреНрд░рд┐рдкреНрд╢рди рдлрд╝рдВрдХреНрд╢рдВрд╕</i> </p><br><p>  рдЯреАрдореЗрдВ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рдЕрдВрддрд┐рдо рднрд╛рдЧ рдореЗрдВ рд╣реИрдВред  рдЙрдиреНрд╣реЗрдВ MISTY1 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ bzip2 рдХреЗ рд╕рд╛рде рд╕рдВрдкреАрдбрд╝рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рдПрдХ рд╣реА рдкреАрдбреАрдПрдл рдлрд╛рдЗрд▓ рдореЗрдВ рдХрдИ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдХрдорд╛рдВрдб рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рдореЗрдВ рдХрдИ рддрд░реНрдХ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред </p><br><h4>  2.3.2ред  рдХреНрд░рд┐рдкреНрдЯреЛрдЧреНрд░рд╛рдлреА </h4><br><p>  рдпрд╣рд╛рдВ рд╣рдо рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХрд╛ рд╡рд░реНрдгрди рдХрд░рддреЗ рд╣реИрдВред </p><br><p>  <b>2.3.2.1ред</b>  <b>XOR рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди</b> </p><br><p>  рдХрдВрдЯреЗрдирд░ рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ (рдкрд╣рд▓реЗ CRC32 рдХреЗ рд╕рд╛рде рд╢реБрд░реВ) XOR рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рдкрд░рд┐рднрд╛рд╖рд┐рдд рдлрд╝рдВрдХреНрд╢рди рджреНрд╡рд╛рд░рд╛ рдЙрддреНрдкрдиреНрди рдмрд╛рдЗрдЯ рд╕реНрдЯреНрд░реАрдо рдХреЗ рд╕рд╛рде рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рдпрд╣ рдПрдХ рдмреАрдЬ рд▓реЗрддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рд░реИрдВрдб рдХрд╣рдХрд░ рджреВрд╕рд░реЗ рдирдВрдмрд░ рдкрд░ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <code>srand</code> рдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  XOR рдореЗрдВ рдбреЗрдЯрд╛ рдХреЗ рддрд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдиреАрдЪреЗ рджрд┐рдЦрд╛рдП рдЧрдП рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рджреВрд╕рд░реЗ рдмреАрдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </p><br><pre> <code class="hljs powershell">int __usercall F_bytestream_xor<span class="hljs-selector-tag"><span class="hljs-selector-tag">@</span></span>&lt;eax&gt;(unsigned int len<span class="hljs-selector-tag"><span class="hljs-selector-tag">@</span></span>&lt;edx&gt;, int ciphertext<span class="hljs-selector-tag"><span class="hljs-selector-tag">@</span></span>&lt;ecx&gt;, unsigned int seed) { unsigned int v3; // ebx int v4; // esi unsigned int v5; // edi int result; // eax unsigned int v7; // ecx char *v8; // edx unsigned int v9; // esi byte key[<span class="hljs-number"><span class="hljs-number">512</span></span>]; // [<span class="hljs-type"><span class="hljs-type">esp</span></span>+<span class="hljs-type"><span class="hljs-type">Ch</span></span>] [<span class="hljs-type"><span class="hljs-type">ebp</span></span>-<span class="hljs-number"><span class="hljs-number">204</span></span><span class="hljs-type"><span class="hljs-type">h</span></span>] char *v11; // [<span class="hljs-type"><span class="hljs-type">esp</span></span>+<span class="hljs-number"><span class="hljs-number">20</span></span><span class="hljs-type"><span class="hljs-type">Ch</span></span>] [<span class="hljs-type"><span class="hljs-type">ebp</span></span>-<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-type"><span class="hljs-type">h</span></span>] v3 = len; v11 = (char *)ciphertext; srand(seed); v4 = <span class="hljs-number"><span class="hljs-number">0</span></span>; v5 = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { result = rand(); *(_DWORD *)&amp;key[<span class="hljs-number"><span class="hljs-number">4</span></span> * <span class="hljs-type"><span class="hljs-type">v5</span></span>++] = result; } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ( v5 &lt; <span class="hljs-number"><span class="hljs-number">128</span></span> ); v7 = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !v3 ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; v8 = v11; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { v8[<span class="hljs-type"><span class="hljs-type">v7</span></span>] ^= key[<span class="hljs-type"><span class="hljs-type">v4</span></span>]; v9 = v4 + <span class="hljs-number"><span class="hljs-number">1</span></span>; result = -(v9 &lt; <span class="hljs-number"><span class="hljs-number">512</span></span>); v4 = result &amp; v9; ++v7; } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ( v7 &lt; v3 ); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; }</code> </pre> <br><p>  <strong>2.3.2.2ред</strong>  <strong>MISTY1</strong> </p><br><p>  Turla рдбреЗрд╡рд▓рдкрд░реНрд╕ рдЕрдкрдиреЗ рдмреИрдХрдбреЛрд░ рдореЗрдВ рдХрдо рд╕рд╛рдорд╛рдиреНрдп рдпрд╛ рд╕рдВрд╢реЛрдзрд┐рдд рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдкрд╕рдВрдж рдХрд░рддреЗ рд╣реИрдВ: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХрд╛рд░реНрдмрди рдФрд░ рд╕рд╛рдБрдк рдореЗрдВ</a> - CAST-128 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЧреЗрдЬрд░</a> - рдХрд╕реНрдЯрдо RSA рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдордЪреНрдЫрд░ рдореЗрдВ</a> - рдмреНрд▓рдо рдмреНрд▓рдо рд╢реБрдм XOR рдмрд╛рдЗрдЯ рд╕реНрдЯреНрд░реАрдо рдХреЗ рд▓рд┐рдП рдПрдХ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд╕рдВрдЦреНрдпрд╛ рдЬрдирд░реЗрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ </li><li>  рд░реВрдЯрдХрд┐рдЯ рдореЗрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпреВрд░реЛрдмреНрд░реЛрд╕</a> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдереНрд░реАрдлрд┐рд╢ рдХрд╛</a> рд╕рдВрд╢реЛрдзрд┐рдд рд╕рдВрд╕реНрдХрд░рдг </li></ul><br><p>  рдЖрдЙрдЯрд▓реБрдХ рдмреИрдХрдбреЛрд░ рдореЗрдВ, рдЙрдиреНрд╣реЛрдВрдиреЗ MISTY1 рд▓рд╛рдЧреВ рдХрд┐рдпрд╛, 1995 рдореЗрдВ рдорд┐рддреНрд╕реБрдмрд┐рд╢реА рдЗрд▓реЗрдХреНрдЯреНрд░рд┐рдХ рдХреНрд░рд┐рдкреНрдЯреЛрдЧреНрд░рд╛рдлрд░реНрд╕ рджреНрд╡рд╛рд░рд╛ рд╡рд┐рдХрд╕рд┐рдд рдПрдХ рд╕рдордорд┐рдд рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдПрд▓реНрдЧреЛрд░рд┐рдереНрдоред  рдЗрд╕рдХреЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЧреБрдг рд╣реИрдВ: </p><br><ul><li>  рд╕рдордорд┐рдд рд╣реИ </li><li>  128-рдмрд┐рдЯ рдХреБрдВрдЬреА рд╣реИ </li><li>  рджреЛ precomputed рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ: s7 (128 рдмрд╛рдЗрдЯреНрд╕) рдФрд░ s9 (2048 рдмрд╛рдЗрдЯреНрд╕) </li><li>  рддреАрди рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ: рдПрдлрдПрд▓, рдПрдлрдУ, рдПрдлрдЖрдИ <br>  o FL рдмрд╛рдЗрдЯ рд▓реЗрдЦрди рдФрд░ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдХреБрдВрдЬреА рдХреЗ рдмреАрдЪ рдХреБрдЫ XOR рд╕рдВрдЪрд╛рд▓рди рдХрд░рддрд╛ рд╣реИ <br>  o рдПрдлрдУ рд░рд┐рдХреЙрд░реНрдб рдФрд░ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдХреБрдВрдЬреА рдХреЗ рдмреАрдЪ XOR рд╕рдВрдЪрд╛рд▓рди рдХрд░рддрд╛ рд╣реИ, рдФрд░ FI рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рдХрд░рддрд╛ рд╣реИ <br>  o FI s7 рдФрд░ s9 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдиреЙрдирд▓рд╛рдЗрдирд┐рдпрд░ рд╡рд┐рд╕реНрддрд╛рд░ рдХрд░рддрд╛ рд╣реИ </li><li>  64 рдмрд┐рдЯреНрд╕ рдХреЗ рдмреНрд▓реЙрдХ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ </li><li>  рдЖрда рдЪрдХреНрд░ рдХрд░рддрд╛ рд╣реИ (рдЪрдХреНрд░ - рдХреЙрд▓ рдПрдлрдУ рдлрд╝рдВрдХреНрд╢рди) </li><li>  Feistel рд╕рд┐рдлрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ </li></ul><br><img src="https://habrastorage.org/webt/jf/d4/_i/jfd4_iplej2iexnsc2pkxkeracy.png"><br><p>  <em>рдЪрд┐рддреНрд░ 18. MISTY1</em> </p><br><img src="https://habrastorage.org/webt/08/qc/_h/08qc_hxb2xju1yxbfsqmizuocwy.png"><br><p>  <em>рдЪрд┐рддреНрд░рд╛ 19. рдмреНрд▓реЙрдХ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдХреЗ рд▓рд┐рдП рдЖрда рдЪрдХреНрд░</em> </p><br><p>  рдЯрд░реНрдмреЛ рдбреЗрд╡рд▓рдкрд░реНрд╕ рдиреЗ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреЛ рдереЛрдбрд╝рд╛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛: </p><br><ul><li>  FI рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рджреЛ XOR рдСрдкрд░реЗрд╢рди рдЬреЛрдбрд╝реЗ рдЧрдП рдЬреИрд╕рд╛ рдХрд┐ рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдЪрд┐рддреНрд░ рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ </li><li>  128-рдмрд┐рдЯ рдХреБрдВрдЬреА рджреЛ рд╣рд╛рд░реНрдб-рдХреЛрдбрд┐рдд 1024-рдмрд┐рдЯ рдХреБрдВрдЬрд┐рдпреЛрдВ рдФрд░ 2048-рдмрд┐рдЯ рдЖрд░рдВрднреАрдХрд░рдг рд╡реЗрдХреНрдЯрд░ рд╕реЗ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ </li><li>  рдкрд░рд┐рд╡рд░реНрддрд┐рдд рддрд╛рд▓рд┐рдХрд╛рдПрдБ s7 рдФрд░ s9ред  рдпрд╣ рдЙрди рд╕рднреА рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХреЛ рдмрд╛рдзрд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдХреНрд░рд┐рдкреНрдЯреЛрдЧреНрд░рд╛рдлрд╝рд┐рдХ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЛ рдПрд╕-рдЯреЗрдмрд▓ рдорд╛рдиреЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдкрд╣рдЪрд╛рдирддреЗ рд╣реИрдВред  рд╕рдВрд╢реЛрдзрд┐рдд рдФрд░ рдореВрд▓ рдПрд╕-рдЯреЗрдмрд▓ рджреЛрдиреЛрдВ рдореЗрдВ рд╕рдорд╛рди рдореВрд▓реНрдп рд╣реИрдВ, рд╡реЗ рдмрд╕ рдлреЗрд░рдмрджрд▓ рдХрд┐рдП рдЧрдП рдереЗ </li></ul><br><img src="https://habrastorage.org/webt/74/ge/qg/74geqg_tqugk_mgizdhn07hrcp0.png"><br><p>  <em>рдЪрд┐рддреНрд░рд╛ 20. рдПрдлрдЖрдИ рдХрд╛рд░реНрдпреЛрдВ рдХреА рддреБрд▓рдирд╛ (рдмрд╛рдИрдВ рдУрд░ рдореВрд▓, рджрд╛рдИрдВ рдУрд░ рдЯрд░реНрд▓рд╛ рд╡рд┐рдХрд╛рд╕)</em> </p><br><h4 id="233-funkcii">  2.3.3ред  рдХрд╛рд░реНрдпреЛрдВ </h4><br><p>  рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдореЗрдВ рдХрдИ рдХрд╛рд░реНрдп рд╣реИрдВ, рдЬреЛ рдлрд╛рдЗрд▓реЛрдВ рдХреЛ рдПрдХреНрд╕рдлрд┐рд▓рд┐рдПрдЯ рдХрд░рдиреЗ рд╕реЗ рд▓реЗрдХрд░ рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рддрдХ рдХреЗ рд╣реИрдВред  рд╡рд┐рднрд┐рдиреНрди рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рд╡рд┐рд╡рд░рдг рдиреАрдЪреЗ рджреА рдЧрдИ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рд╣реИред </p><br><img src="https://habrastorage.org/webt/zk/ij/od/zkijodwltfd9en0cxuya189_758.png"><br><p><br>  0x29 рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП, Turla рдбреЗрд╡рд▓рдкрд░реНрд╕ рдиреЗ рдПрдореНрдкрд╛рдпрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">PSInject</a> рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЗ рдХреЛрдб рдХреА рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдмрдирд╛рдИред  рдпрд╣ рдЖрдкрдХреЛ PowerShell Run рдХреЛ PowerShell Run рдирд╛рдордХ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдЪрд▓рд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ <code>powershell.exe</code> рдХреЛ рдХреЙрд▓ рдХрд┐рдП рдмрд┐рдирд╛ред  рдореБрдЦреНрдп рд▓рд╛рдн рдпрд╣ рд╣реИ рдХрд┐ рдорд╛рд▓рд╡реЗрдпрд░ рдЕрднреА рднреА PowerShell рдХрдорд╛рдВрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рднрд▓реЗ рд╣реА <code>powershell.exe</code> ред <code>powershell.exe</code> рдлрд╝рд╛рдЗрд▓ рдПрдХ рд╕рдордЭреМрддрд╛ рдХрд┐рдП рдЧрдП рдХрдВрдкреНрдпреВрдЯрд░ рдкрд░ рд▓реЙрдХ рд╣реЛред </p><br><p>  рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо рдПрдХ рдкреАрдбреАрдПрдл рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдмрдирд╛рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдереЗ, рдЬрд┐рд╕реЗ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдкреНрд░реЛрдЧреНрд░рд╛рдо рджреНрд╡рд╛рд░рд╛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред  рдЖрдЙрдЯрд▓реБрдХ рдХреЗ рдЗрд╕ рдкреАрдбреАрдПрдл рд╡рд╛рд▓реЗ рдИрдореЗрд▓ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдирд┐рдореНрди рдЖрдВрдХрдбрд╝рд╛ рдореИрд╕реЗрдЬрдмреЙрдХреНрд╕ рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдФрд░ рдХреИрд▓рдХреБрд▓реЗрдЯрд░ ( <code>calc.exe</code> ) рдХреЗ рдкреНрд░рдХреНрд╖реЗрдкрдг рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред  рдпрд╣ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ рдХрд┐ рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ, рд╕рдВрднрд╡рддрдГ рдкреАрдбреАрдПрдл рдЕрдиреБрд▓рдЧреНрдирдХреЛрдВ рдореЗрдВ рдХрдорд╛рдВрдб рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рдЗрд░рд╛рджрд╛ рд╣реИ, рдХрд╛рд░реНрдпрд╛рддреНрдордХ рд╣реИ рдФрд░ рдЗрд╕ рдХрд╕реНрдЯрдо рдкреНрд░рд╛рд░реВрдк рдХреЛ рд╕рдордЭрдиреЗ рд╡рд╛рд▓реЗ рдХрд┐рд╕реА рднреА рд╡реНрдпрдХреНрддрд┐ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </p><br><img src="https://habrastorage.org/webt/-t/xc/lr/-txclr3f050ahxdxykqgnimnr5g.png"><br><p>  <em>рдЪрд┐рддреНрд░ 21. рдкреАрдбреАрдПрдл рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЖрджреЗрд╢реЛрдВ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдирд╛</em> </p><br><h3 id="24-dopolnitelnye-funkcii">  2.4ред  рдЕрддрд┐рд░рд┐рдХреНрдд рдХрд╛рд░реНрдп </h3><br><p>  рдИрдореЗрд▓ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд▓рд┐рдП рдкреНрд▓рдЧ-рдЗрди рдХреЗ рд░реВрдк рдореЗрдВ рд▓рд╛рдЧреВ рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдХреА рдХреНрд╖рдорддрд╛рдУрдВ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдореИрд▓рд╡реЗрдпрд░ рдХреЗ рдЕрдиреНрдп рдХрд╛рд░реНрдп рд╣реИрдВред </p><br><h4 id="241-virtualnaya-faylovaya-sistema">  2.4.1ред  рд╡рд░реНрдЪреБрдЕрд▓ рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо </h4><br><p>  рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХрд┐рд╕реА рднреА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╡рд┐рдВрдбреЛрдЬ рд░рдЬрд┐рд╕реНрдЯреНрд░реА <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Settings\ZonePolicy\</code> рдореЗрдВ рдПрдХ рдЫреЛрдЯреА рд╡рд░реНрдЪреБрдЕрд▓ рдлрд╝рд╛рдЗрд▓ рдкреНрд░рдгрд╛рд▓реА рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред  рдЕрдиреНрдп рдЯрд░реНрд▓рд╛ рдмреИрдХрдбреЛрд░, рдЬреИрд╕реЗ рдХрд┐ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЧреЗрдЬрд░</a> , рднреА рд╡рд┐рдВрдбреЛрдЬрд╝ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ рд╡рд░реНрдЪреБрдЕрд▓ рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рд╕реНрдЯреЛрд░ рдХрд░рддрд╛ рд╣реИред  рд╣рдо рдХреБрдЫ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдорд╛рди рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдереЗ, рдЬреИрд╕рд╛ рдХрд┐ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред </p><br><img src="https://habrastorage.org/webt/gi/g-/wt/gig-wt39jwfeznw0kpe7qjzvhpm.png"><br><h4 id="242-zhurnaly">  2.4.2ред  рдкрддреНрд░рд┐рдХрд╛рдУрдВ </h4><br><p>  рдЬреИрд╕рд╛ рдХрд┐ рдкрд╣рд▓реЗ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдХрд╛рд░реНрдпрдХреНрд░рдо рдПрдХ рдкрддреНрд░рд┐рдХрд╛ рдХреЛ рдмрдЪрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдмрдирд╛рдП рдЧрдП рдкреАрдбреАрдПрдл рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдореЗрдВ рдИ-рдореЗрд▓ рджреНрд╡рд╛рд░рд╛ рдСрдкрд░реЗрдЯрд░ рдХреЛ рдирд┐рдпрдорд┐рдд рд░реВрдк рд╕реЗ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЗрд╕реЗ <code>%appdata%/Microsoft/Windows/scawrdot.db</code> рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рд╣рд╛рд░реНрдб-рдХреЛрдбрд┐рдд 512-рдмрд╛рдЗрдЯ XOR рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдСрдкрд░реЗрдЯрд░реЛрдВ рдХреЛ рдкреНрд░рддреНрдпреЗрдХ рдЫреВрдЯ рдХреЗ рдмрд╛рдж рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рд╛рдлрд╝ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдлреЛрд░реЗрдВрд╕рд┐рдХ рдкрд░реАрдХреНрд╖рд╛ рдХреЗ рджреМрд░рд╛рди рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдХреЗ рд╕рднреА рдкрд┐рдЫрд▓реЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рджреЗрдЦрдирд╛ рдЕрд╕рдВрднрд╡ рд╣реЛрдЧрд╛, рдХреЗрд╡рд▓ рдЕрдВрддрд┐рдоред </p><br><p>  рд▓реЙрдЧ рдмрд╣реБрдд рдЬрд╛рдирдХрд╛рд░реАрдкреВрд░реНрдг рд╣реИрдВ, рд╡реЗ рдЯрд░реНрдмреЛ рдСрдкрд░реЗрдЯрд░реЛрдВ рдХреЛ рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдХреА рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХреЛ рдЯреНрд░реИрдХ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред  рдиреАрдЪреЗ рджрд┐рдпрд╛ рдЧрдпрд╛ рдЖрдВрдХрдбрд╝рд╛ рдбрд┐рдХреНрд░рд┐рдкреНрдЯреЗрдб рд▓реЙрдЧ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рджрд┐рдЦрд╛рддрд╛ рд╣реИред </p><br><img src="https://habrastorage.org/webt/yo/q_/z6/yoq_z6lfqy5b3ozw3f4lh6reqr4.png"><br><p>  <em>рдЪрд┐рддреНрд░ 22. рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рдЕрд╕реНрд╡реАрдХреГрдд</em> </p><br><h2 id="3-vyvody">  3. рдирд┐рд╖реНрдХрд░реНрд╖ </h2><br><p>  рд░рд┐рдкреЛрд░реНрдЯ рд╕реЗ рдкрддрд╛ рдЪрд▓рд╛ рдХрд┐ рдЬрдм рд╡реЗ рдмреИрдХрдбреЛрд░ рдХрд╛ рд╡рд┐рдХрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ рддреЛ рдЯрд░реНрд▓рд╛ рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреЗ рдкрд╛рд╕ рдкрд░реНрдпрд╛рдкреНрдд рд╡рд┐рдЪрд╛рд░ рд╣реИрдВред  рдЬрд╣рд╛рдВ рддрдХ тАЛтАЛрд╣рдо рдЬрд╛рдирддреЗ рд╣реИрдВ, рддреБрд░реНрд▓рд╛ рдПрдХрдорд╛рддреНрд░ рд╕рд╛рдЗрдмрд░-рдЬрд╛рд╕реВрд╕реА рд╕рдореВрд╣ рд╣реИ рдЬреЛ рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдПрдХ рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдИрдореЗрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдкреНрд░рдмрдВрдзрд┐рдд рд╣реЛрддрд╛ рд╣реИ, рдпрд╛ рдкреАрдбреАрдПрдл рд╕рдВрд▓рдЧреНрдирдХред </p><br><p>  рддреБрд░реНрд▓рд╛ рдмреИрдХрдбреЛрд░, рдХрдорд╛рдВрдб рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдФрд░ рдбреЗрдЯрд╛ рдХреЛ рдПрдХреНрд╕рдлрд╝рд┐рд▓рд┐рдПрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреАрдбрд╝рд┐рдд рдХреЗ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдореЗрд▓рдмреЙрдХреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдкрд╣рд▓рд╛ рдирд╣реАрдВ рд╣реИред  рд╣рд╛рд▓рд╛рдБрдХрд┐, рдпрд╣ Microsoft Outlook рдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╛рдирдХ API (MAPI) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реАрдЦрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдкрд╣рд▓рд╛ рдмреИрдХрдбреЛрд░ рд╣реИред  рдпрд╣ рдЙрд╕ рдкрд┐рдЫрд▓реЗ рд╕рдВрд╕реНрдХрд░рдг рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕реБрдзрд╛рд░ рд╣реИ рдЬрд┐рд╕рдХрд╛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╣рдордиреЗ рдЕрдзреНрдпрдпрди рдХрд┐рдпрд╛ рдерд╛</a> , рдЬреЛ рдЖрдЙрдЯрд▓реБрдХ рдПрдХреНрд╕рдкреНрд░реЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рдерд╛ред  рдЗрд╕рдХреЗ рд╡рд┐рдкрд░реАрдд, рдирдпрд╛ рдЯрд░реНрд▓рд╛ рдмреИрдХрдбреЛрд░ рдЖрдЙрдЯрд▓реБрдХ рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЗ рд╕рд╛рде рднреА рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред </p><br><p>   ,  ,     ,         ,  Turla   .      ,   Uroburos,      . </p><br><p>   ,         Turla,  ,    .     ,  ,     .  ,      -   ,        . </p><br><p>    ,     PDF-,     Turla,      ,     . </p><br><p>  ESET     Turla,        . </p><br><p>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">GitHub</a> . </p><br><h2 id="4-indikatory-komprometacii"> 4.   </h2><br><h3 id="41-heshi"> 4.1.  рд╣реИрд╢ </h3><br><p> 8A7E2399A61EC025C15D06ECDD9B7B37D6245EC2 тАФ  Win32/Turla.N;   (GMT) 2013-06-28 14:15:54 <br> F992ABE8A67120667A01B88CD5BF11CA39D491A0 тАФ  Win32/Turla.AW; GMT 2014-12-03 20:50:08 <br> CF943895684C6FF8D1E922A76B71A188CFB371D7 тАФ  Win32/Turla.R; GMT 2014-12-03 20:44:27 <br> 851DFFA6CD611DC70C9A0D5B487FF00BC3853F30 тАФ  Win32/Turla.DA; GMT 2016-09-15 08:14:47 </p><br><h3 id="42-imena-faylov"> 4.2.   </h3><br><p> %appdata%/Microsoft/Windows/scawrdot.db <br> %appdata%/Microsoft/Windows/flobcsnd.dat <br> mapid.tlb </p><br><h3 id="43-klyuchi-reestra"> 4.3.   </h3><br><p> HKCU\Software\Microsoft\Windows\CurrentVersion\Settings\ZonePolicy\ <br> HKCU\Software\Classes\CLSID{49CBB1C7-97D1-485A-9EC1-A26065633066} <br> HKCU\Software\Classes\CLSID{84DA0A92-25E0-11D3-B9F7-00C04F4C8F5D} </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi421399/">https://habr.com/ru/post/hi421399/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi421389/index.html">рдЬреЛрдореНрд░рд╛ рдореЗрдВ рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рд╢рдХреНрддрд┐рдпреЛрдВ рдХрд╛ рдкреГрдердХреНрдХрд░рдг</a></li>
<li><a href="../hi421391/index.html">HackThings - Skoltech рдореЗрдВ 7-9 рд╕рд┐рддрдВрдмрд░ рдХреА рдЪреАрдЬреЛрдВ рдХреЗ рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд░ рдПрдХ рдмрдбрд╝рд╛ рд╣реИрдХрдереЙрди</a></li>
<li><a href="../hi421393/index.html">рдкрд░рд┐рддреНрдпрдХреНрдд Mailchimp рдЯреЛрдХрд░реА: рдЖрд▓рд╕реА рдХреЗ рд▓рд┐рдП рдПрдХ рдЧрд╛рдЗрдб</a></li>
<li><a href="../hi421395/index.html">рдХреНрд▓рдм рдСрдл рд░реЛрдо 2018 рдХреА рд░рд┐рдкреЛрд░реНрдЯ, рдЕрдзреНрдпрд╛рдп 3.7: "рдЬрд▓рд╡рд╛рдпреБ: рдЕрдЪреНрдЫреА рдЦрдмрд░, рд▓реЗрдХрд┐рди рдмрдбрд╝реА рд╕рдорд╕реНрдпрд╛рдПрдВ"</a></li>
<li><a href="../hi421397/index.html">рдорд┐рдиреА рдПрдЖрдИ рдХрдк # 3 рд▓реЙрдиреНрдЪ рдХрд░реЗрдВред рд╕реАрдорд┐рдд рд╕реНрдерд╛рдиреЛрдВ рдореЗрдВ рдорд╢реАрди рдХреА рд▓рдбрд╝рд╛рдИ</a></li>
<li><a href="../hi421401/index.html">рд╕рд┐рдлрд╛рд░рд┐рд╢ рдкреНрд░рдгрд╛рд▓рд┐рдпреЛрдВ рдХреЗ рдПрдирд╛рдЯреЙрдореАред рднрд╛рдЧ рджреЛ</a></li>
<li><a href="../hi421403/index.html">рд╕реБрд░рдХреНрд╖рд╛ рд╕рдкреНрддрд╛рд╣ 32: Fortnite-Android рдирд╛рдЯрдХ</a></li>
<li><a href="../hi421407/index.html">13 рд╕рд┐рддрдВрдмрд░ рдХреЛ рд╕реЗрдВрдЯ рдкреАрдЯрд░реНрд╕рдмрд░реНрдЧ рдореЗрдВ рддрдХрдиреАрдХреА рдмреИрдардХ - рдмреИрдХрдПрдВрдб рдкрд░ рдмрдбрд╝реЗ рдмрджрд▓рд╛рд╡ рдХреИрд╕реЗ рдХрд░реЗрдВ</a></li>
<li><a href="../hi421409/index.html">рдЧреБрдкреНрдд рдмрд╛рддреЗрдВ: рдПрдХ рдЧреБрдкреНрдд рд░рдЦреЗрдВ</a></li>
<li><a href="../hi421411/index.html">рдЧреЛ рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдкрд░рд┐рдЪрдп</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>