<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧖 ❇️ 🤹🏾 神经巫师的反面。 第3部分：完成渲染，制作游戏 👨🏽‍🌾 🤽🏿 🧑🏾‍🤝‍🧑🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="嗨，这是我的一系列出版物的第三部分，专门介绍Neuromancer的逆向开发-Neuro Gicer是同名小说的视频游戏体现。 
 神经巫师的反面。 第1部分：精灵 
 神经巫师的反面。 第2部分：渲染字体 

 这部分似乎有些混乱。 事实是，本文中描述的大多数内容在撰写前一篇文章时就已准备就绪。 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>神经巫师的反面。 第3部分：完成渲染，制作游戏</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415555/"><img src="https://habrastorage.org/webt/wn/4k/jm/wn4kjm-p2fyta0emos5ufhkop_0.png"><br><p> 嗨，这是我的一系列出版物的第三部分，专门介绍Neuromancer的逆向开发-Neuro Gicer是同名小说的视频游戏体现。 </p><br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">神经巫师的反面。</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第1部分：精灵</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">神经巫师的反面。</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第2部分：渲染字体</a> </blockquote><p> 这部分似乎有些混乱。 事实是，本文中描述的大多数内容在撰写<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">前一篇</a>文章时就已准备就绪。 从那时起已经过去了两个月，而且不幸的是，我没有保留工作记录的习惯，所以我只是忘记了一些细节。 但是，就这样吧。 </p><a name="habracut"></a><br><hr><br><p> <em>[在我学会打印行之后，继续颠倒对话框的结构是合乎逻辑的。</em>  <em>但是，出于某种原因，我转而完全进入了渲染系统的分析。]</em>再次，沿着<code>main</code>走，我能够定位首先在屏幕上显示内容的调用： <code>seg000:0159: call sub_1D0B2</code> 。 在这种情况下，“任何”是光标和主菜单的背景图像： </p><br><p><img src="https://habrastorage.org/webt/9l/9h/yq/9l9hyqeu9n7m8vyt8iizlz5wnze.png"><br></p><br><p> 值得注意的是<code>sub_1D0B2</code>函数<em>[以下简称</em> <code>sub_1D0B2</code> <em>]</em>没有参数，但是，它的第一次调用之前是两个几乎相同的代码段： </p><br><pre> <code class="hljs perl">loc_100E5: loc_10123: mov ax, <span class="hljs-number"><span class="hljs-number">2</span></span> mov ax, <span class="hljs-number"><span class="hljs-number">2</span></span> mov dx, seg seg009 mov dx, seg seg01<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> dx <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> dx <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> ax <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> ax mov ax, <span class="hljs-number"><span class="hljs-number">506</span></span>Ah mov ax, <span class="hljs-number"><span class="hljs-number">5076</span></span>h ; <span class="hljs-string"><span class="hljs-string">"cursors.imh"</span></span>, <span class="hljs-string"><span class="hljs-string">"title.imh"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> ax <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> ax call load_imh call load_imh ; load_imh(res, offt, seg) add sp, <span class="hljs-number"><span class="hljs-number">6</span></span> add sp, <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ah</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub_123F8</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub_123F8</span></span></span><span class="hljs-function"> </span></span>; sub_123F8(<span class="hljs-number"><span class="hljs-number">0</span></span>), sub_123F8(<span class="hljs-number"><span class="hljs-number">10</span></span>) add sp, <span class="hljs-number"><span class="hljs-number">2</span></span> add sp, <span class="hljs-number"><span class="hljs-number">2</span></span> cmp word_5AA92, <span class="hljs-number"><span class="hljs-number">0</span></span> mov ax, <span class="hljs-number"><span class="hljs-number">1</span></span> jz short loc_10123 <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> ax <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, 2 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dx</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg010</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, 2 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dx</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dx</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg009</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dx</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, 64</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">h</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ah</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A0h</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub_1CF5B</span></span></span><span class="hljs-function"> </span></span>; sub_1CF5B(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, seg01<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sp</span></span></span><span class="hljs-function">, 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ch</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub_1CF5B</span></span></span><span class="hljs-function"> </span></span>; sub_1CF5B(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">160</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, seg009, <span class="hljs-number"><span class="hljs-number">0</span></span>) add sp, 0Ch</code> </pre> <br><p> 在调用<code>render</code>之前，将光标（ <code>title.imh</code> ）和背景（ <code>title.imh</code> ）解压缩到内存中（ <code>load_imh</code>是从<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第一部分</a>重命名的<code>sub_126CB</code> ），分别分为第九和第十个部分。 对功能<code>sub_123F8</code>研究并没有给我带来任何新信息，但是仅查看<code>sub_1CF5B</code>的参数，我得出以下结论： </p><br><ul><li> 参数4和5一起代表解压缩后的Sprite的地址（ <code>segment:offset</code> ）； </li><li> 参数2和3可能是坐标，因为这些数字与调用<code>render</code>之后显示的图像相关。 </li><li> 最后一个参数可能是精灵背景不透明度的标志，因为解压后的精灵具有黑色背景，并且我们在屏幕上看到没有它的光标。 </li></ul><br><p> 使用第一个参数<em>（并同时进行一般渲染），</em>在跟踪<code>sub_1CF5B</code>之后<em>，</em>一切都变得清晰了。 事实是，在数据段中，从地址<code>0x3BD4</code>开始， <code>0x3BD4</code>了以下类型的11个结构的数组： </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sprite_layer_t</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> flags; <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> update; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> left; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> top; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> dleft; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> dtop; <span class="hljs-keyword"><span class="hljs-keyword">imh_hdr_t</span></span> sprite_hdr; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> sprite_segment; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> sprite_pixels; <span class="hljs-keyword"><span class="hljs-keyword">imh_hdr_t</span></span> _sprite_hdr; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> _sprite_segment; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> _sprite_pixels; } <span class="hljs-keyword"><span class="hljs-keyword">sprite_layer_t</span></span>;</code> </pre> <br><p> 我称这个概念为精灵链。 实际上， <code>sub_1CF5B</code>函数（以下<code>add_sprite_to_chain</code> ）将所选的sprite添加到链中。 在16位计算机上，它大约具有以下签名： </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">sprite_layer_t</span></span> g_sprite_chain[<span class="hljs-number"><span class="hljs-number">11</span></span>]; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add_sprite_to_chain</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> index, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint16_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> left, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint16_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> top, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint16_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> offset, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint16_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> segment, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> opaque)</span></span></span></span>;</code> </pre> <br><p> 它是这样的： </p><br><ul><li> 第一个参数是<code>g_sprite_chain</code>数组中的索引； </li><li>  <code>left</code>和<code>top</code>参数分别写入<code>g_sprite_chain[index].left</code>和<code>g_sprite_chain[index].top</code> ； </li><li> 将sprite标头（位于<code>segment:offset</code>的前8个字节）复制到<code>imh_hdr_t</code>类型的<code>g_sprite_chain[index].sprite_hdr</code> （从第一部分重命名为<code>rle_hdr_t</code> ）： </li></ul><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">imh_hdr_t</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> unknown; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> width; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> height; } <span class="hljs-keyword"><span class="hljs-keyword">imh_hdr_t</span></span>;</code> </pre> <br><ul><li>  <code>g_sprite_chain[index].sprite_segment</code>字段<code>g_sprite_chain[index].sprite_segment</code>记录<code>segment</code>的值； </li><li> 在<code>g_sprite_chain[index].sprite_pixels</code> ，写入一个等于<code>offset + 8</code>的值，因此<code>sprite_segment:sprite_pixels</code>是添加的sprite的位图地址； </li><li>  <code>sprite_hdr</code> ， <code>sprite_segment</code>和<code>sprite_pixels</code>在<code>_sprite_hdr</code> ， <code>_sprite_segment</code>和<code>_sprite_pixels</code> <code>sprite_pixels</code>重复<em>[为什么？</em>  <em>-我不知道，这不是这种重复字段的唯一情况]</em> ； </li><li> 在字段<code>g_sprite_chain[index].flags</code> <code>1 + (opaque &lt;&lt; 4)</code>写入等于<code>1 + (opaque &lt;&lt; 4)</code> <code>g_sprite_chain[index].flags</code>值<code>1 + (opaque &lt;&lt; 4)</code> 。 该记录意味着<code>flags</code>值的第一位指示“当前”层的“活动”，而第五位指示其背景的<strong>不透明度</strong> 。  <em>[我对透明性标志的怀疑消除了，因为我通过实验测试了其对显示图像的影响。</em>  <em>在运行时更改第五位的值，我们可以观察到这些工件]：</em> <br><img src="https://habrastorage.org/webt/9z/i8/ui/9zi8uizaa3s9fwsqke4rwa_3jqa.png"><br></li></ul><br><p> 正如我已经提到的， <code>render</code>函数没有参数，但不需要它-它直接与<code>g_sprite_chain</code>数组一起使用，将“层”交替地从最后一个（ <code>g_sprite_chain[10]</code> -背景）转移到第一个（ <code>g_sprite_chain[0]</code> -前景）。  <code>sprite_layer_t</code>结构具有为此所需的一切，甚至更多。 我说的是未<code>dleft</code>字段<code>update</code> ， <code>dleft</code>和<code>dtop</code> 。 </p><br><p> 实际上， <code>render</code>函数<strong>不会</strong>在每帧中重画<strong>所有</strong>精灵。  <code>g_sprite_chain.update</code>字段的值非零表示需要重绘当前的精灵。 假设我们移动了光标（ <code>g_sprite_chain[0]</code> ），那么在鼠标移动处理程序中将发生以下情况： </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mouse_move_handler</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(...)</span></span></span><span class="hljs-function"> </span></span>{ ... g_sprite_chain[<span class="hljs-number"><span class="hljs-number">0</span></span>].update = <span class="hljs-number"><span class="hljs-number">1</span></span>; g_sprite_chain[<span class="hljs-number"><span class="hljs-number">0</span></span>].dleft = mouse_x - g_sprite_chain[<span class="hljs-number"><span class="hljs-number">0</span></span>].left; g_sprite_chain[<span class="hljs-number"><span class="hljs-number">0</span></span>].dtop = mouse_y - g_sprite_chain[<span class="hljs-number"><span class="hljs-number">0</span></span>].top; }</code> </pre> <br><p> 当控制权传递给<code>render</code>函数时，后者已到达<code>g_sprite_chain[0]</code>层，因此需要对其进行更新。 然后： </p><br><ul><li> 在更新之前的所有图层之前，将计算并绘制光标精灵占据的区域的交集； </li><li> 精灵坐标将被更新： </li></ul><br><pre> <code class="hljs powershell">g_sprite_chain[<span class="hljs-number"><span class="hljs-number">0</span></span>].update = <span class="hljs-number"><span class="hljs-number">0</span></span>; g_sprite_chain[<span class="hljs-number"><span class="hljs-number">0</span></span>].left += g_sprite_chain[<span class="hljs-number"><span class="hljs-number">0</span></span>].dleft g_sprite_chain[<span class="hljs-number"><span class="hljs-number">0</span></span>].dleft = <span class="hljs-number"><span class="hljs-number">0</span></span>; g_sprite_chain[<span class="hljs-number"><span class="hljs-number">0</span></span>].top += g_sprite_chain[<span class="hljs-number"><span class="hljs-number">0</span></span>].dtop g_sprite_chain[<span class="hljs-number"><span class="hljs-number">0</span></span>].dtop = <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre> <br><ul><li> 精灵将在更新的坐标处绘制。 </li></ul><br><p> 这样可以最小化<code>render</code>功能执行的操作数量。 </p><br><hr><br><p> 尽管我简化了很多逻辑，但实现该逻辑并不难。 鉴于现代计算机的计算能力，我们可以负担得起在每帧中重绘所有11 <code>g_sprite_chain.update</code>链精灵， <code>.dleft</code> ，可以<code>.dtop</code> <code>.dleft</code> ， <code>.dtop</code>和<code>.dtop</code>以及与它们相关的所有处理。 另一个简化涉及不透明度标志的处理。 在原始代码中，对于子图中的每个透明像素，将搜索与较低层中的第一个不透明像素的交点。 但是我使用32位视频模式，因此可以在<em>RGBA</em>方案中更改透明度字节的值。 结果，我得到了向（从）链中添加（删除）子画面的功能： </p><br><div class="spoiler">  <b class="spoiler_title">代号</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sprite_layer_t</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> flags; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> left; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> top; <span class="hljs-keyword"><span class="hljs-keyword">imh_hdr_t</span></span> sprite_hdr; <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> *sprite_pixels; <span class="hljs-keyword"><span class="hljs-keyword">imh_hdr_t</span></span> _sprite_hdr; <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> *_sprite_pixels; } <span class="hljs-keyword"><span class="hljs-keyword">sprite_layer_t</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">sprite_layer_t</span></span> g_sprite_chain[<span class="hljs-number"><span class="hljs-number">11</span></span>]; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add_sprite_to_chain</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> n, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint32_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> left, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint32_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> top, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *sprite, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> opaque)</span></span></span><span class="hljs-function"> </span></span>{ assert(n &lt;= <span class="hljs-number"><span class="hljs-number">10</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">sprite_layer_t</span></span> *layer = &amp;g_sprite_chain[n]; <span class="hljs-built_in"><span class="hljs-built_in">memset</span></span>(layer, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sprite_layer_t</span></span>)); layer-&gt;left = left; layer-&gt;top = top; memmove(&amp;layer-&gt;sprite_hdr, sprite, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">imh_hdr_t</span></span>)); layer-&gt;sprite_pixels = sprite + <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">imh_hdr_t</span></span>); memmove(&amp;layer-&gt;_sprite_hdr, &amp;layer-&gt;sprite_hdr, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">imh_hdr_t</span></span>) + <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span>*)); layer-&gt;flags = ((opaque &lt;&lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">16</span></span>) | <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">remove_sprite_from_chain</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> n)</span></span></span><span class="hljs-function"> </span></span>{ assert(n &lt;= <span class="hljs-number"><span class="hljs-number">10</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">sprite_layer_t</span></span> *layer = &amp;g_sprite_chain[n]; <span class="hljs-built_in"><span class="hljs-built_in">memset</span></span>(layer, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sprite_layer_t</span></span>)); }</code> </pre> </div></div><br><p> 将图层传输到<em>VGA</em>缓冲区的功能如下： </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">draw_to_vga</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> left, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> top, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint32_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> w, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint32_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> h, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *pixels, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> bg_transparency)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">draw_sprite_to_vga</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">sprite_layer_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *sprite)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span> top = sprite-&gt;top; <span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span> left = sprite-&gt;left; <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> w = sprite-&gt;sprite_hdr.width * <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> h = sprite-&gt;sprite_hdr.height; <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> bg_transparency = ((sprite-&gt;flags &gt;&gt; <span class="hljs-number"><span class="hljs-number">4</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> *pixels = sprite-&gt;sprite_pixels; draw_to_vga(left, top, w, h, pixels, bg_transparency); }</code> </pre> <br><p>  <code>draw_to_vga</code>函数是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第二部分中</a>描述的同名函数，但带有一个附加参数，指示图像背景的透明度。 将<code>draw_sprite_to_vga</code>调用添加到<code>render</code>函数的开头（其余内容从<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第二部分</a>迁移）： </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">10</span></span>; i &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>; i--) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!(g_sprite_chain[i].flags &amp; <span class="hljs-number"><span class="hljs-number">1</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } draw_sprite_to_vga(&amp;g_sprite_chain[i]); } ... }</code> </pre> <br><p> 我还编写了一个函数，该函数根据鼠标指针的当前位置（ <code>update_cursor</code> ）和一个简单的资源管理器来更新游标精灵的位置。 我们共同努力： </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> <span class="hljs-keyword"><span class="hljs-keyword">spite_chain_index_t</span></span> { SCI_CURSOR = <span class="hljs-number"><span class="hljs-number">0</span></span>, SCI_BACKGRND = <span class="hljs-number"><span class="hljs-number">10</span></span>, SCI_TOTAL = <span class="hljs-number"><span class="hljs-number">11</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">spite_chain_index_t</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> g_cursors[<span class="hljs-number"><span class="hljs-number">399</span></span>]; <span class="hljs-comment"><span class="hljs-comment">/* seg009 */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> g_background[<span class="hljs-number"><span class="hljs-number">32063</span></span>]; <span class="hljs-comment"><span class="hljs-comment">/* seg010 */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> argc, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *argv[])</span></span></span><span class="hljs-function"> </span></span>{ ... assert(resource_manager_load(<span class="hljs-string"><span class="hljs-string">"CURSORS.IMH"</span></span>, g_cursors)); add_sprite_to_chain(SCI_CURSOR, <span class="hljs-number"><span class="hljs-number">160</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, g_cursors, <span class="hljs-number"><span class="hljs-number">0</span></span>); assert(resource_manager_load(<span class="hljs-string"><span class="hljs-string">"TITLE.IMH"</span></span>, g_background)); add_sprite_to_chain(SCI_BACKGRND, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, g_background, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (sfRenderWindow_isOpen(g_window)) { ... update_cursor(); render(); } ... }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">光标GIF</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/lw/ji/sm/lwjismkxi7ewlzw9m9zahx3imjy.gif"></div></div><br><hr><br><p> 好的，对于功能完善的主菜单，菜单本身实际上还不够。 现在是时候回到对话框的颠倒了。  <em>[上次，我<code>draw_frame</code>构成对话框<code>draw_frame</code>函数，并部分地分析了<code>draw_string</code>函数，仅从那里提取了文本渲染逻辑。]</em>看着新的<code>draw_frame</code> ，我看到那里使用了<code>add_sprite_to_chain</code>函数-不足为奇，仅添加一个对话框在精灵链中。 必须处理对话框中文本的位置。 让我提醒您，对<code>draw_string</code>的调用是什么样的： </p><br><pre> <code class="hljs perl"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, 1 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, 5098</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">h</span></span></span><span class="hljs-function"> </span></span>; <span class="hljs-string"><span class="hljs-string">"New/Load"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> ax call draw_string ; draw_string(<span class="hljs-string"><span class="hljs-string">"New/Load"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br><p> 和填充<code>draw_frame</code>的结构<em>[这有点领先，因为我在完全弄清楚<code>draw_string</code>之后重命名了大多数元素。</em>  <em>顺便说一句，就像在<code>sprite_layer_t</code>的情况下<code>sprite_layer_t</code> ，存在重复字段]</em> ： </p><br><pre> <code class="hljs powershell">typedef struct neuro_dialog_t { uint16_t left; // word[<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-type"><span class="hljs-type">x65FA</span></span>]: <span class="hljs-number"><span class="hljs-number">0</span></span>x20 uint16_t top; // word[<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-type"><span class="hljs-type">x65FC</span></span>]: <span class="hljs-number"><span class="hljs-number">0</span></span>x98 uint16_t right; // word[<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-type"><span class="hljs-type">x65FE</span></span>]: <span class="hljs-number"><span class="hljs-number">0</span></span>x7F uint16_t bottom; // word[<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-type"><span class="hljs-type">x6600</span></span>]: <span class="hljs-number"><span class="hljs-number">0</span></span>xAF uint16_t inner_left; // word[<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-type"><span class="hljs-type">x6602</span></span>]: <span class="hljs-number"><span class="hljs-number">0</span></span>x28 uint16_t inner_top; // word[<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-type"><span class="hljs-type">x6604</span></span>]: <span class="hljs-number"><span class="hljs-number">0</span></span>xA0 uint16_t inner_right; // word[<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-type"><span class="hljs-type">x6604</span></span>]: <span class="hljs-number"><span class="hljs-number">0</span></span>xA0 uint16_t inner_bottom; // word[<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-type"><span class="hljs-type">x6608</span></span>]: <span class="hljs-number"><span class="hljs-number">0</span></span>xA7 uint16_t _inner_left; // word[<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-type"><span class="hljs-type">x660A</span></span>]: <span class="hljs-number"><span class="hljs-number">0</span></span>x28 uint16_t _inner_top; // word[<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-type"><span class="hljs-type">x660C</span></span>]: <span class="hljs-number"><span class="hljs-number">0</span></span>xA0 uint16_t _inner_right; // word[<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-type"><span class="hljs-type">x660E</span></span>]: <span class="hljs-number"><span class="hljs-number">0</span></span>x77 uint16_t _inner_bottom; // word[<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-type"><span class="hljs-type">x6610</span></span>]: <span class="hljs-number"><span class="hljs-number">0</span></span>xA7 uint16_t flags; // word[<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-type"><span class="hljs-type">x6612</span></span>]: <span class="hljs-number"><span class="hljs-number">0</span></span>x06 uint16_t unknown; // word[<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-type"><span class="hljs-type">x6614</span></span>]: <span class="hljs-number"><span class="hljs-number">0</span></span>x00 uint8_t padding[<span class="hljs-number"><span class="hljs-number">192</span></span>] // ... uint16_t width; // word[<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-type"><span class="hljs-type">x66D6</span></span>]: <span class="hljs-number"><span class="hljs-number">0</span></span>x30 uint16_t pixels_offset; // word[<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-type"><span class="hljs-type">x66D8</span></span>]: <span class="hljs-number"><span class="hljs-number">0</span></span>x02 uint16_t pixels_segment; // word[<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-type"><span class="hljs-type">x66DA</span></span>]: <span class="hljs-number"><span class="hljs-number">0</span></span>x22FB } neuro_dialog_t;</code> </pre> <br><p> 我没有解释这里的内容，方式和原因，而是留下了这张图片： </p><br><img src="https://habrastorage.org/webt/db/tf/nw/dbtfnw8fn1qx9aktubuvwojuw7y.png"><br><p> 变量<code>x_offt</code>和<code>y_offt</code>分别是<code>draw_string</code>函数的第二个和第三个参数。 基于此信息，将名称重命名为<code>build_dialog_frame</code>和<code>build_dialog_text</code>后，可以轻松构建自己的<code>draw_frame</code>和<code>draw_text</code>版本： </p><br><pre> <code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build_dialog_frame</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">neuro_dialog_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *dialog, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint16_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> left, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint16_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> top, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint16_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> w, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint16_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> h, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint16_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> flags, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *pixels)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build_dialog_text</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">neuro_dialog_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *dialog, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *text, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint16_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x_offt, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint16_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y_offt)</span></span></span></span>; ... <span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> <span class="hljs-keyword"><span class="hljs-keyword">spite_chain_index_t</span></span> { SCI_CURSOR = <span class="hljs-number"><span class="hljs-number">0</span></span>, SCI_DIALOG = <span class="hljs-number"><span class="hljs-number">2</span></span>, ... } <span class="hljs-keyword"><span class="hljs-keyword">spite_chain_index_t</span></span>; ... <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> *g_dialog = <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">neuro_dialog_t</span></span> g_menu_dialog; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> argc, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *argv[])</span></span></span><span class="hljs-function"> </span></span>{ ... assert(g_dialog = <span class="hljs-built_in"><span class="hljs-built_in">calloc</span></span>(<span class="hljs-number"><span class="hljs-number">8192</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)); build_dialog_frame(&amp;g_menu_dialog, <span class="hljs-number"><span class="hljs-number">32</span></span>, <span class="hljs-number"><span class="hljs-number">152</span></span>, <span class="hljs-number"><span class="hljs-number">96</span></span>, <span class="hljs-number"><span class="hljs-number">24</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, g_dialog); build_dialog_text(&amp;g_menu_dialog, <span class="hljs-string"><span class="hljs-string">"New/Load"</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); add_sprite_to_chain(SCI_DIALOG, <span class="hljs-number"><span class="hljs-number">32</span></span>, <span class="hljs-number"><span class="hljs-number">152</span></span>, g_dialog, <span class="hljs-number"><span class="hljs-number">1</span></span>); ... }</code> </pre> <br><img src="https://habrastorage.org/webt/ms/xt/bg/msxtbgydwxelkcfgng8vdud10ee.png"><br><p> 我的版本与原始版本之间的主要区别在于，我使用像素大小的绝对值-更容易。 </p><br><hr><br><p> 即使这样，我也可以肯定，紧随<code>build_dialog_text</code>调用之后的代码部分负责创建按钮： </p><br><pre> <code class="hljs perl"> ... mov ax, <span class="hljs-number"><span class="hljs-number">5098</span></span>h ; <span class="hljs-string"><span class="hljs-string">"New/Load"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> ax call build_dialog_text ; build_dialog_text(<span class="hljs-string"><span class="hljs-string">"New/Load"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) add sp, <span class="hljs-number"><span class="hljs-number">6</span></span> mov ax, <span class="hljs-number"><span class="hljs-number">6</span></span>Eh ; <span class="hljs-string"><span class="hljs-string">'n'</span></span> -  <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> ax <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, 3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, 1 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub_181A3</span></span></span><span class="hljs-function"> </span></span>; sub_181A3(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'n'</span></span>) add sp, 0Ah mov ax, <span class="hljs-number"><span class="hljs-number">6</span></span>Ch ; <span class="hljs-string"><span class="hljs-string">'l'</span></span> -      <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> ax mov ax, <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> ax mov ax, <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> ax <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, 5 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub_181A3</span></span></span><span class="hljs-function"> </span></span>; sub_181A3(<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'l'</span></span>)</code> </pre> <br><p> 这些都是生成的注释<code>'n'</code>和<code>'l'</code> ，它们显然是单词<code>"New"</code>和<code>"load"</code>的第一个字母。 此外，如果我们通过类推来与<code>build_dialog_text</code> ，那么<code>build_dialog_text</code>的前四个参数（以下<code>build_dialog_item</code> ）可以是坐标和大小的因子<em>[实际上，前三个参数，实际上是第四个参数，关于另一个]</em> 。 如果您将这些值叠加在图像上，则一切收敛，如下所示： </p><br><img src="https://habrastorage.org/webt/xy/gw/hj/xygwhjq2ykcj7wf9z0dbtzhzr7q.png"><br><p> 图像中的变量<code>x_offt</code> ， <code>y_offt</code>和<code>width</code>分别是<code>build_dialog_item</code>函数的前三个参数。 此矩形的高度始终等于符号的高度-八。 在仔细查看<code>build_dialog_item</code> ，我发现在<code>neuro_dialog_t</code>结构中指定为<code>padding</code> （现在为<code>items</code> ）的是以下形式的16个结构的数组： </p><br><pre> <code class="hljs cpp"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dialog_item_t</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> left; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> top; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> right; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> bottom; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> unknown; <span class="hljs-comment"><span class="hljs-comment">/* index? */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> letter; } <span class="hljs-keyword"><span class="hljs-keyword">dialog_item_t</span></span>;</code> </pre> <br><p> 字段<code>neuro_dialog_t.unknown</code> （现在为<code>neuro_dialog_t.items_count</code> ）是菜单中项目数的计数器： </p><br><pre> <code class="hljs cpp"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">neuro_dialog_t</span></span></span><span class="hljs-class"> {</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> flags; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> items_count; <span class="hljs-keyword"><span class="hljs-keyword">dialog_item_t</span></span> items[<span class="hljs-number"><span class="hljs-number">16</span></span>]; ... } <span class="hljs-keyword"><span class="hljs-keyword">neuro_dialog_t</span></span>;</code> </pre> <br><p>  <code>dialog_item_t.unknown</code>字段使用<code>build_dialog_item</code>函数的第四个参数初始化。 也许这是数组中元素的索引，但似乎并非总是如此，因此<code>unknown</code> 。  <code>dialog_item_t.letter</code>字段使用<code>build_dialog_item</code>函数的第五个参数初始化。 再次，有可能在左键单击处理程序中，游戏检查鼠标指针的坐标是否落入其中一项的区域（例如，仅按顺序对其进行排序），如果有命中，则从该字段中选择所需的按钮单击处理程序。  <em>[我不知道这实际上是如何完成的，但我完全实现了这一逻辑。</em> </p><br><p> 这足以构成一个完整的主菜单，而无需回顾原始代码，而只是重复其在游戏中观察到的行为。 </p><br><div class="spoiler">  <b class="spoiler_title">Main_Menu.GIF</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/we/q8/ni/weq8ni9fy9vuusoaitjgazjt6e4.gif"></div></div><br><hr><br><p> 如果您观看了前一个gif到最后，您可能会注意到最后一帧的启动游戏屏幕。 实际上，我已经具备了一切准备。 只需下载并下载必要的精灵并将其添加到精灵链即可。 但是，通过将主角的精灵放置在舞台上，我发现了一个与<code>imh_hdr_t</code>结构有关的重要发现。 </p><br><p> 在原始代码中，使用坐标156和110调用将主角的图像添加到链中的<code>add_sprite_to_chain</code>函数。这是我所看到的，我自己重复一下： </p><br><img src="https://habrastorage.org/webt/i1/5s/yf/i15syfep7bdhuhxgsbkhr-bxev4.png" align="left"><br><p> 弄清楚是什么之后，我得到了以下类型的结构<code>imh_hdr_t</code> ： </p><br><pre> <code class="hljs cpp"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">imh_hdr_t</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> dx; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> dy; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> width; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> height; } <span class="hljs-keyword"><span class="hljs-keyword">imh_hdr_t</span></span>;</code> </pre> <br><p> 原来是<code>unknown</code>字段的东西原来是偏移值，这些偏移值是从精灵链中存储的相应坐标（渲染过程中）减去的。 </p><br><p><br clear="left"></p><br><p> 因此，绘制的子画面的左上角的实际坐标大致如下计算： </p><br><pre> <code class="hljs cpp">left = <span class="hljs-keyword"><span class="hljs-keyword">sprite_layer_t</span></span>.left - <span class="hljs-keyword"><span class="hljs-keyword">sprite_layer_t</span></span>.sprite_hdr.dx top = <span class="hljs-keyword"><span class="hljs-keyword">sprite_layer_t</span></span>.top - <span class="hljs-keyword"><span class="hljs-keyword">sprite_layer_t</span></span>.sprite_hdr.dy</code> </pre> <br><p> 将其应用到我的代码中，我得到了正确的画面，然后我开始恢复主角。 实际上，我自己编写了所有与角色控制（鼠标和键盘），动画和移动相关的代码，而无需回顾原始代码。 </p><br><div class="spoiler">  <b class="spoiler_title">Moonwalk.gif</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/tw/ei/m2/tweim2zx4hrsefql82ny-elnimc.gif"></div></div><br><hr><br><p> 获得了第一级的文字介绍。 让我提醒您，字符串资源存储在<code>.BIH</code>文件中。  <code>.BIH</code>文件由大小可变的标头和一系列以null终止的字符串组成。 检查播放此简介的原始代码，我发现<code>.BIH</code>文件中文本部分开头的偏移量包含在第四个标头单词中。 第一行是简介： </p><br><pre> <code class="hljs cpp"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bih_hdr_t</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> unknown[<span class="hljs-number"><span class="hljs-number">3</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> text_offset; } <span class="hljs-keyword"><span class="hljs-keyword">bih_hdr_t</span></span>; ... <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> r1_bih[<span class="hljs-number"><span class="hljs-number">12288</span></span>]; assert(resource_manager_load(<span class="hljs-string"><span class="hljs-string">"R1.BIH"</span></span>, r1_bih)); <span class="hljs-keyword"><span class="hljs-keyword">bih_hdr_t</span></span> *hdr = (<span class="hljs-keyword"><span class="hljs-keyword">bih_hdr_t</span></span>*)r1_bih; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *intro = r1_bih + hdr-&gt;text_offset;</code> </pre> <br><p> 此外，依靠原始文档，我实现了将原始字符串拆分为子字符串的过程，以使它们适合用于文本输出的区域，在这些行中滚动，并在发出下一批之前等待输入。 </p><br><div class="spoiler">  <b class="spoiler_title">GIF简介</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/uk/oa/ag/ukoaagah17k7eegsy4unobeskbg.gif"></div></div><br><hr><br><p> 在出版时，除了已经描述的三部分内容外，我还弄清楚了声音的再现。 到目前为止，这只是我的脑海，在我的项目中要花些时间才能实现。 因此，第四部分可能完全与声音有关。 我还计划讲一些有关该项目的体系结构，但让我们看看它的进展情况。 </p><br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">神经巫师的反面。</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第4部分：声音，动画，霍夫曼，Github</a> </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN415555/">https://habr.com/ru/post/zh-CN415555/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN415545/index.html">使用PowerShell脚本安装Veeam Backup＆Replication</a></li>
<li><a href="../zh-CN415547/index.html">关于OSDAY或您需要教学生如何在俄罗斯IT公司工作并留在那里的一些知识</a></li>
<li><a href="../zh-CN415549/index.html">电动踏板车如何占领硅谷，以及为什么讨厌它们</a></li>
<li><a href="../zh-CN415551/index.html">VoLTE / ViLTE + Wi-Fi通话非常复杂</a></li>
<li><a href="../zh-CN415553/index.html">来自AR技术世界的新鲜材料的摘要</a></li>
<li><a href="../zh-CN415557/index.html">编解码器2 +神经网络=一张软盘上的整个播客</a></li>
<li><a href="../zh-CN415559/index.html">呼叫中心的发展历史，或技术如何改变了运营商与客户之间的工作</a></li>
<li><a href="../zh-CN415561/index.html">如何将事件从Veeam Backup＆Replication推送到即时通讯程序中</a></li>
<li><a href="../zh-CN415563/index.html">“机械” Scrum的处理。 第2部分。团队</a></li>
<li><a href="../zh-CN415565/index.html">为什么（今天）返回444并不总是有用的</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>