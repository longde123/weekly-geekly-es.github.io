<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩 👎🏼 ⚛️ Verteilte C ++ - Anwendungen mit minimalem Aufwand 👩🏾‍⚕️ 🤽🏿 👨🏽‍⚕️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Der Zweck meines Beitrags ist es, über die C ++ - API der verteilten Apache Ignite-Datenbank namens Ignite C ++ sowie deren Funktionen zu sprechen. 

...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Verteilte C ++ - Anwendungen mit minimalem Aufwand</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/gridgain/blog/420623/"><p>  Der Zweck meines Beitrags ist es, über die C ++ - API der verteilten Apache Ignite-Datenbank namens Ignite C ++ sowie deren Funktionen zu sprechen. </p><br><p>  Über den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Apache Ignite</a> auf einem Habr wurde bereits mehr als einmal geschrieben, so dass sicherlich einige von Ihnen bereits grob wissen, was es ist und warum es notwendig ist. </p><br><h2>  Kurz über Apache Ignite für diejenigen, die noch nicht damit vertraut sind </h2><br><p>  Ich werde nicht näher darauf eingehen, wie Apache Ignite entstanden ist und wie es sich von klassischen Datenbanken unterscheidet.  All diese Fragen wurden <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> oder <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> bereits aufgeworfen. </p><br><p>  Apache Ignite ist also im Wesentlichen eine schnell verteilte Datenbank, die für die Arbeit mit RAM optimiert ist.  Ignite selbst ist aus einem speicherinternen Datenraster hervorgegangen und wurde bis vor kurzem als sehr schneller, vollständig speicherinterner verteilter Cache basierend auf einer verteilten Hash-Tabelle positioniert.  Aus diesem Grund bietet es neben dem Speichern von Daten viele praktische Funktionen für die schnelle verteilte Verarbeitung: Map-Reduce, atomare Datenoperationen, vollwertige ACID-Transaktionen, SQL-Datenabfragen, sogenannte Continues Queries, mit denen Änderungen an bestimmten Daten und Daten überwacht werden können andere. </p><br><p>  In letzter Zeit hat die Plattform jedoch <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Unterstützung für die dauerhafte Speicherung von Daten auf der Festplatte</a> hinzugefügt.  Danach erhielt Apache Ignite alle Vorteile einer vollwertigen objektorientierten Datenbank, während der Komfort, der Werkzeugreichtum, die Flexibilität und die Geschwindigkeit des Rasterdatums erhalten blieben. </p><a name="habracut"></a><br><h2>  Ein bisschen Theorie </h2><br><p> Ein wichtiger Teil zum Verständnis der Arbeit mit Apache Ignite ist, dass es in Java geschrieben ist.  Sie werden fragen: "Welchen Unterschied macht es zu dem, was die Datenbank geschrieben hat, wenn ich trotzdem über SQL mit ihr kommuniziere?"  Daran ist etwas Wahres.  Wenn Sie Ignite nur als Datenbank verwenden möchten, können Sie den mit Ignite <code>ignite.sh</code> oder JDBC-Treiber verwenden, die Anzahl der benötigten <code>ignite.sh</code> mithilfe des speziell erstellten Skripts <code>ignite.sh</code> erhöhen und diese mithilfe flexibler Konfigurationen und insbesondere konfigurieren schwebt über die Sprache und arbeitet mit Ignite sogar von PHP, sogar von Go. </p><br><p>  Die native Ignite-Oberfläche bietet viel mehr Funktionen als nur SQL.  Am einfachsten: schnelle atomare Operationen mit Objekten in der Datenbank, verteilten Synchronisationsobjekten und verteiltem Computing in einem Cluster für lokale Daten, wenn Sie nicht Hunderte von Megabyte Daten für Berechnungen auf den Client ziehen müssen.  Wie Sie verstehen, funktioniert dieser Teil der API nicht über SQL, sondern ist in sehr spezifischen allgemeinen Programmiersprachen geschrieben. </p><br><p>  Da Ignite in Java geschrieben ist, ist natürlich die umfassendste API in dieser Programmiersprache implementiert.  Neben Java gibt es jedoch auch API-Versionen für C # .NET und C ++.  Dies sind die sogenannten "Thick" -Clients - tatsächlich der Ignite-Knoten in der JVM, der über C ++ oder C # gestartet wird und mit dem über die JNI kommuniziert wird.  Diese Art von Knoten ist unter anderem erforderlich, damit der Cluster verteiltes Computing in den entsprechenden Sprachen - C ++ und C # - ausführen kann. </p><br><p>  Darüber hinaus gibt es ein offenes Protokoll für die sogenannten „Thin“ -Clients.  Dies sind bereits kompakte Bibliotheken in verschiedenen Programmiersprachen, die über TCP / IP mit dem Cluster kommunizieren.  Sie belegen viel weniger Speicherplatz, starten fast sofort, benötigen keine JVM auf dem Computer, haben jedoch eine etwas schlechtere Latenz und weniger umfangreiche APIs als "dicke" Clients.  Heute gibt es Thin Clients in Java, C # und Node.js, Clients in C ++, PHP, Python3, Go werden aktiv entwickelt. </p><br><p>  In einem Beitrag werde ich mich mit der Ignite Thick API für C ++ API befassen, da diese derzeit die umfassendste API bietet. </p><br><h2>  Erste Schritte </h2><br><p>  Ich werde nicht im Detail auf die Installation und Konfiguration des Frameworks selbst eingehen - der Prozess ist routinemäßig, nicht sehr interessant und wird beispielsweise in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">offiziellen Dokumentation</a> gut beschrieben.  Gehen wir direkt zum Code. </p><br><p>  Da Apache Ignite eine verteilte Plattform ist, müssen Sie zunächst mindestens einen Knoten ausführen, um loszulegen.  Dies geschieht ganz einfach mit der Klasse <code>ignite::Ignition</code> : </p><br><pre> <code class="hljs rust">#include &lt;iostream&gt; #include &lt;ignite/ignition.h&gt; using namespace ignite; int main() { IgniteConfiguration cfg; Ignite node = Ignition::Start(cfg); std::cout &lt;&lt; <span class="hljs-string"><span class="hljs-string">"Node started. Press 'Enter' to stop"</span></span> &lt;&lt; std::endl; std::cin.get(); Ignition::StopAll(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); std::cout &lt;&lt; <span class="hljs-string"><span class="hljs-string">"Node stopped"</span></span> &lt;&lt; std::endl; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre> <br><p>  Herzlichen Glückwunsch, Sie haben Ihren ersten Cache Apache Ignite-Knoten mit Standardeinstellungen gestartet.  Die Ignite-Klasse ist wiederum der Haupteinstiegspunkt für den Zugriff auf die gesamte Cluster-API. </p><br><h2>  Mit Daten arbeiten </h2><br><p>  Die Hauptkomponente von Ignite C ++, die eine API für die Arbeit mit Daten bereitstellt, ist der Cache <code>ignite::cache::Cache&lt;K,V&gt;</code> .  Der Cache bietet eine Reihe grundlegender Methoden zum Arbeiten mit Daten.  Da <code>Cache</code> im Wesentlichen eine Schnittstelle zu einer verteilten Hash-Tabelle ist, ähneln die grundlegenden Methoden für die Arbeit damit der Arbeit mit normalen Containern wie <code>map</code> oder <code>unordered_map</code> . </p><br><pre> <code class="hljs objectivec"><span class="hljs-meta"><span class="hljs-meta">#include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;string&gt;</span></span></span><span class="hljs-meta"> #include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;cassert&gt;</span></span></span><span class="hljs-meta"> #include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;cstdint&gt;</span></span></span><span class="hljs-meta"> #include </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;ignite/ignition.h&gt;</span></span></span><span class="hljs-meta"> using namespace ignite; struct Person { int32_t age; std::string firstName; std::string lastName; } //... int main() { IgniteConfiguration cfg; Ignite node = Ignition::Start(cfg); cache::Cache</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;int32_t, Person&gt;</span></span></span><span class="hljs-meta"> personCache = node.CreateCache</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;int32_t, Person&gt;</span></span></span><span class="hljs-meta">(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"PersonCache"</span></span></span><span class="hljs-meta">); Person p1 = { 35, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"John"</span></span></span><span class="hljs-meta">, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Smith"</span></span></span><span class="hljs-meta"> }; personCache.Put(42, p1); Person p2 = personCache.Get(42); std::cout </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;&lt; p2 &lt;&lt; std::endl; assert(p1 == p2); return 0; }</span></span></span></span></code> </pre> <br><p>  Sieht ziemlich einfach aus, oder?  Tatsächlich werden die Dinge etwas komplizierter, wenn wir uns die Einschränkungen von C ++ genauer ansehen. </p><br><h2>  Herausforderungen bei der C ++ - Integration </h2><br><p>  Wie bereits erwähnt, ist Apache Ignite vollständig in Java geschrieben - einer leistungsstarken OOP-gesteuerten Sprache.  Es ist logisch, dass viele der Funktionen dieser Sprache, die beispielsweise mit der Reflektion der Programmausführungszeit verbunden sind, aktiv zur Implementierung von Apache Ignite-Komponenten verwendet wurden.  Zum Beispiel zur Serialisierung / Deserialisierung von Objekten zur Speicherung auf einer Festplatte und zur Übertragung über ein Netzwerk. </p><br><p>  In C ++ gibt es im Gegensatz zu Java keine so leistungsstarke Reflexion.  Im Allgemeinen nein, leider noch nicht.  Insbesondere gibt es keine Möglichkeit, die Liste und den Typ der Felder eines Objekts herauszufinden, wodurch automatisch der Code generiert werden kann, der zum Serialisieren / Deserialisieren von Objekten vom Benutzertyp erforderlich ist.  Daher besteht die einzige Möglichkeit hier darin, den Benutzer aufzufordern, die erforderlichen Metadaten zum Benutzertyp und zur Arbeitsweise explizit anzugeben. </p><br><p>  In Ignite C ++ wird dies durch die Spezialisierung der Vorlage <code>ignite::binary::BinaryType&lt;T&gt;</code> .  Dieser Ansatz wird sowohl bei "dicken" als auch bei "dünnen" Clients verwendet.  Für die oben vorgestellte Personenklasse könnte eine ähnliche Spezialisierung folgendermaßen aussehen: </p><br><pre> <code class="hljs cpp"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> ignite { <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> binary { <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BinaryType</span></span></span><span class="hljs-class">&lt;Person&gt; {</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> int32_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetTypeId</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> GetBinaryStringHashCode(<span class="hljs-string"><span class="hljs-string">"Person"</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetTypeName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">&amp; name)</span></span></span><span class="hljs-function"> </span></span>{ name = <span class="hljs-string"><span class="hljs-string">"Person"</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> int32_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetFieldId</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* name)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> GetBinaryStringHashCode(name); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsNull</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Person&amp; obj)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetNull</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Person&amp; dst)</span></span></span><span class="hljs-function"> </span></span>{ dst = Person(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Write</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(BinaryWriter&amp; writer, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Person&amp; obj)</span></span></span><span class="hljs-function"> </span></span>{ writer.WriteInt32(<span class="hljs-string"><span class="hljs-string">"age"</span></span>, obj.age; writer.WriteString(<span class="hljs-string"><span class="hljs-string">"firstName"</span></span>, obj.firstName); writer.WriteString(<span class="hljs-string"><span class="hljs-string">"lastName"</span></span>, obj.lastName); } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Read(BinaryReader&amp; reader, Person&amp; dst) { dst.age = reader.ReadInt32(<span class="hljs-string"><span class="hljs-string">"age"</span></span>); dst.firstName = reader.ReadString(<span class="hljs-string"><span class="hljs-string">"firstName"</span></span>); dst.lastName = reader.ReadString(<span class="hljs-string"><span class="hljs-string">"lastName"</span></span>); } }; } <span class="hljs-comment"><span class="hljs-comment">// namespace binary } // namespace ignite</span></span></code> </pre> <br><p>  Wie Sie sehen können, gibt es neben den Serialisierungs- / Deserialisierungsmethoden <code>BinaryType&lt;Person&gt;::Write</code> , <code>BinaryType&lt;Person&gt;::Read</code> mehrere andere Methoden.  Sie werden benötigt, um der Plattform zu erklären, wie mit benutzerdefinierten C ++ - Typen in anderen Sprachen, insbesondere Java, gearbeitet wird.  Schauen wir uns jede Methode genauer an: </p><br><ul><li>  <code>GetTypeName()</code> - Gibt den <code>GetTypeName()</code> zurück.  Der Typname muss auf allen Plattformen, auf denen der Typ verwendet wird, gleich sein.  Wenn Sie den Typ nur in Ignite C ++ verwenden, kann der Name beliebig sein. </li><li>  <code>GetTypeId()</code> - Diese Methode gibt eine plattformübergreifende eindeutige Kennung für den Typ zurück.  Für die korrekte Arbeit mit einem Typ auf verschiedenen Plattformen ist es erforderlich, dass er überall gleich berechnet wird.  Die <code>GetBinaryStringHashCode(TypeName)</code> Methode <code>GetBinaryStringHashCode(TypeName)</code> gibt standardmäßig dieselbe Typ-ID wie auf allen anderen Plattformen zurück. Mit dieser Implementierung dieser Methode können Sie von anderen Plattformen aus korrekt mit diesem Typ arbeiten. </li><li>  <code>GetFieldId()</code> - Gibt eine eindeutige Kennung für den <code>GetFieldId()</code> zurück.  Auch hier lohnt es sich, für die korrekte plattformübergreifende Arbeit die <code>GetBinaryStringHashCode()</code> -Methode zu verwenden. </li><li>  <code>IsNull()</code> - Überprüft, ob eine Instanz einer Klasse ein Objekt vom Typ <code>NULL</code> .  Wird verwendet, um <code>NULL</code> Werte korrekt zu serialisieren.  Nicht sehr nützlich für Instanzen der Klasse selbst, aber es kann äußerst praktisch sein, wenn der Benutzer mit intelligenten Zeigern arbeiten und eine Spezialisierung definieren möchte, z. B. für <code>BinaryType&lt; std::unique_ptr&lt;Person&gt; &gt;</code> . </li><li>  <code>GetNull()</code> - <code>GetNull()</code> aufgerufen, wenn versucht wird, einen <code>NULL</code> Wert zu deserialisieren.  Alles, was über <code>IsNull</code> gesagt <code>IsNull</code> gilt auch für <code>GetNull()</code> . </li></ul><br><h2>  SQL </h2><br><p>  Wenn wir eine Analogie zu klassischen Datenbanken ziehen, ist der Cache ein Datenbankschema mit einem Klassennamen, der eine Tabelle enthält - mit einem Typnamen.  Zusätzlich zu den Cache-Schemata gibt es ein allgemeines Schema namens <code>PUBLIC</code> in dem Sie eine unbegrenzte Anzahl von Tabellen mit Standard-DDL-Befehlen wie <code>CREATE TABLE</code> , <code>DROP TABLE</code> usw. erstellen / löschen können.  Mit dem PUBLIC-Schema verbinden sie sich normalerweise über ODBC / JDBC, wenn sie Ignite einfach als verteilte Datenbank verwenden möchten. </p><br><p>  Ignite unterstützt vollständige SQL-Abfragen, einschließlich DML und DDL.  Es gibt noch keine Unterstützung für SQL-Transaktionen, aber die Community arbeitet derzeit aktiv an der Implementierung von MVCC, mit der Transaktionen hinzugefügt werden. Soweit ich weiß, wurden die wichtigsten Änderungen kürzlich in master eingeführt. </p><br><p>  Um mit Cache-Daten über SQL zu arbeiten, müssen Sie in der Cache-Konfiguration explizit angeben, welche Felder des Objekts in SQL-Abfragen verwendet werden.  Die Konfiguration wird in die XML-Datei geschrieben. Anschließend wird beim Starten des Knotens der Pfad zur Konfigurationsdatei angegeben: </p><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">beans</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.springframework.org/schema/beans"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:util</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.springframework.org/schema/util"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:schemaLocation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"grid.cfg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"org.apache.ignite.configuration.IgniteConfiguration"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"cacheConfiguration"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"org.apache.ignite.configuration.CacheConfiguration"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PersonCache"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"queryEntities"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"org.apache.ignite.cache.QueryEntity"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"keyType"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"java.lang.Integer"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"valueType"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Person"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fields"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">map</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">entry</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"age"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"java.lang.Integer"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">entry</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"firstName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"java.lang.String"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">entry</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"lastName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"java.lang.String"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">map</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">beans</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Die Konfiguration wird von der Java-Engine analysiert, daher müssen die Basistypen auch für Java angegeben werden.  Nachdem die Konfigurationsdatei erstellt wurde, müssen Sie den Knoten starten, die Cache-Instanz abrufen und SQL verwenden: </p><br><pre> <code class="hljs lua">//... int main() { IgniteConfiguration cfg; cfg.springCfgPath = <span class="hljs-string"><span class="hljs-string">"config.xml"</span></span>; Ignite node = Ignition::Start(cfg); cache::Cache&lt;int32_t, Person&gt; personCache = node.GetCache&lt;int32_t, Person&gt;(<span class="hljs-string"><span class="hljs-string">"PersonCache"</span></span>); personCache.Put(<span class="hljs-number"><span class="hljs-number">1</span></span>, Person(<span class="hljs-number"><span class="hljs-number">35</span></span>, <span class="hljs-string"><span class="hljs-string">"John"</span></span>, <span class="hljs-string"><span class="hljs-string">"Smith"</span></span>)); personCache.Put(<span class="hljs-number"><span class="hljs-number">2</span></span>, Person(<span class="hljs-number"><span class="hljs-number">31</span></span>, <span class="hljs-string"><span class="hljs-string">"Jane"</span></span>, <span class="hljs-string"><span class="hljs-string">"Doe"</span></span>)); personCache.Put(<span class="hljs-number"><span class="hljs-number">3</span></span>, Person(<span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-string"><span class="hljs-string">"Harry"</span></span>, <span class="hljs-string"><span class="hljs-string">"Potter"</span></span>)); personCache.Put(<span class="hljs-number"><span class="hljs-number">4</span></span>, Person(<span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-string"><span class="hljs-string">"Ronald"</span></span>, <span class="hljs-string"><span class="hljs-string">"Weasley"</span></span>)); cache::query::SqlFieldsQuery qry( <span class="hljs-string"><span class="hljs-string">"select firstName, lastName from Person where age = ?"</span></span>); qry.AddArgument&lt;int32_t&gt;(<span class="hljs-number"><span class="hljs-number">12</span></span>); cache::query::QueryFieldsCursor cursor = cache.Query(qry); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (cursor.HasNext()) { QueryFieldsRow row = cursor.GetNext(); std::cout &lt;&lt; row.GetNext&lt;std::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>&gt;() &lt;&lt; <span class="hljs-string"><span class="hljs-string">", "</span></span>; std::cout &lt;&lt; row.GetNext&lt;std::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>&gt;() &lt;&lt; std::endl; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre> <br><p>  Auf die gleiche Weise können Sie <code>insert</code> , <code>update</code> , <code>create table</code> und andere Abfragen verwenden.  Natürlich werden auch cacheübergreifende Anforderungen unterstützt.  In diesem Fall sollte der Cache-Name in der Anforderung jedoch in Anführungszeichen als Name des Schemas angegeben werden.  Zum Beispiel anstelle von </p><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> Person <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> Profession</code> </pre> <br><p>  sollte schreiben </p><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"PersonCache"</span></span>.Person <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> <span class="hljs-string"><span class="hljs-string">"ProfessionCache"</span></span>.Profession</code> </pre> <br><h2>  Usw </h2><br><p>  Es gibt wirklich viele Möglichkeiten in Apache Ignite und natürlich war es in einem Beitrag unmöglich, alle zu behandeln.  Die C ++ - API wird derzeit aktiv entwickelt, daher wird es bald interessanter sein.  Es ist möglich, dass ich noch ein paar Beiträge schreibe, in denen ich einige Funktionen genauer analysieren werde. </p><br><p>  <em>PS Ich bin seit 2017 ein Apache Ignite-Committer und entwickle aktiv die C ++ - API für dieses Produkt.</em>  <em>Wenn Sie mit C ++, Java oder .NET ziemlich vertraut sind und an der Entwicklung eines offenen Produkts mit einer aktiven, freundlichen Community teilnehmen möchten, werden wir immer ein paar andere interessante Aufgaben für Sie finden.</em> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de420623/">https://habr.com/ru/post/de420623/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de420611/index.html">Modellierung der Quantenverschränkung in C #</a></li>
<li><a href="../de420613/index.html">11 Bibliotheken (Komponentensätze) für React Native, über die Sie 2018 Bescheid wissen sollten</a></li>
<li><a href="../de420615/index.html">JavaScript: Objekte erkunden</a></li>
<li><a href="../de420617/index.html">Webdesign-Handbuch für Entwickler</a></li>
<li><a href="../de420619/index.html">Responsive Images: CSS-Tricks, die Zeit sparen</a></li>
<li><a href="../de420625/index.html">KDD 2018, Erster Tag, Tutorials</a></li>
<li><a href="../de420627/index.html">C # Asynchrone Programmierung: Wie geht es Ihnen mit der Leistung?</a></li>
<li><a href="../de420629/index.html">PHP Digest Nr. 137 (6. - 20. August 2018)</a></li>
<li><a href="../de420631/index.html">Wir haben keine Angst vor "Wolken"</a></li>
<li><a href="../de420633/index.html">Schreiben eines GeoIP-Exporters für Prometheus mit Visualisierungen in Grafana in 15 Minuten</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>