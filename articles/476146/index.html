<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîµ ü§Ωüèæ üõ∂ C√≥mo escalar centros de datos. Informe Yandex ü•† üßúüèΩ üëá</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hemos desarrollado un dise√±o de una red de centros de datos, que le permite implementar cl√∫steres inform√°ticos de m√°s de 100 mil servidores con un anc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C√≥mo escalar centros de datos. Informe Yandex</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/476146/"> Hemos desarrollado un dise√±o de una red de centros de datos, que le permite implementar cl√∫steres inform√°ticos de m√°s de 100 mil servidores con un ancho de banda de bisecci√≥n de m√°s de un petabit por segundo. <br><br>  A partir del informe de Dmitry Afanasyev, aprender√° sobre los principios b√°sicos del nuevo dise√±o, el escalado de topolog√≠as que surgen con estos problemas, las opciones para resolverlos, sobre las caracter√≠sticas de enrutamiento y escalado de las funciones del plano de reenv√≠o de dispositivos de red modernos en topolog√≠as densamente conectadas con una gran cantidad de rutas ECMP .  Adem√°s, Dima habl√≥ brevemente sobre la organizaci√≥n de la conectividad externa, el nivel f√≠sico, el sistema de cable y las formas de aumentar a√∫n m√°s la capacidad. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/rd/dy/sc/rddysciofis_rkvkotpo1tr52i0.jpeg"></a> <br><br>  - Buenas tardes a todos!  Mi nombre es Dmitry Afanasyev, soy arquitecto de redes de Yandex y me encargo principalmente del dise√±o de redes de centros de datos. <br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/zv/gl/5v/zvgl5vyexhel7a_6_mxp8wm4qoe.jpeg"><br><br>  Mi historia ser√° sobre la red actualizada del centro de datos de Yandex.  Esto es en gran medida una evoluci√≥n del dise√±o que ten√≠amos, pero al mismo tiempo hay algunos elementos nuevos.  Esta es una presentaci√≥n de revisi√≥n, ya que era necesario incluir mucha informaci√≥n en poco tiempo.  Comenzamos eligiendo una topolog√≠a l√≥gica.  Luego habr√° una visi√≥n general del plano de control y problemas con la escalabilidad del plano de datos, la elecci√≥n de lo que suceder√° en el nivel f√≠sico, veamos algunas caracter√≠sticas de los dispositivos.  Tambi√©n tocaremos lo que est√° sucediendo en el centro de datos con MPLS, del que hablamos hace alg√∫n tiempo. <br><br><img src="https://habrastorage.org/webt/ew/lm/rc/ewlmrcydwmv1s3gz2irvhuyev-q.jpeg"><br><br>  Entonces, ¬øqu√© es Yandex en t√©rminos de cargas de trabajo y servicios?  Yandex es un hiperescalador t√≠pico.  Si mira en la direcci√≥n de los usuarios, procesamos principalmente las solicitudes de los usuarios.  Adem√°s, varios servicios de transmisi√≥n y salida de datos, porque tambi√©n tenemos servicios de almacenamiento.  Si est√° m√°s cerca del backend, entonces aparecen cargas de infraestructura y servicios, como almacenes de objetos distribuidos, replicaci√≥n de datos y, por supuesto, colas persistentes.  Uno de los principales tipos de cargas es MapReduce y similares, procesamiento de transmisi√≥n, aprendizaje autom√°tico, etc. <br><br><img src="https://habrastorage.org/webt/qi/71/qd/qi71qdjq7zbaxhmfmqbd6y66fba.jpeg"><br><br>  ¬øC√≥mo es la infraestructura sobre la cual sucede todo esto?  Una vez m√°s, somos un hiperskaler muy t√≠pico, aunque quiz√°s estamos un poco m√°s cerca del lado del espectro donde se encuentran los hiperskalers m√°s peque√±os.  Pero tenemos todos los atributos.  Utilizamos hardware b√°sico y escalado horizontal siempre que sea posible.  Tenemos un crecimiento completo de la agrupaci√≥n de recursos: no trabajamos con m√°quinas separadas, bastidores separados, sino que los combinamos en un gran grupo de recursos intercambiables con algunos servicios adicionales que se dedican a la planificaci√≥n y asignaci√≥n, y trabajamos con todo este grupo. <br><br>  Entonces tenemos el siguiente nivel: el cl√∫ster inform√°tico a nivel del sistema operativo.  Es muy importante que controlemos completamente la pila de tecnolog√≠a que utilizamos.  Controlamos los puntos finales (hosts), la red y la pila de software. <br><br>  Tenemos varios grandes centros de datos en Rusia y en el extranjero.  Est√°n unidos por una columna vertebral que utiliza la tecnolog√≠a MPLS.  Nuestra infraestructura interna se basa casi por completo en IPv6, pero dado que necesitamos manejar el tr√°fico externo, que a√∫n se entrega principalmente a trav√©s de IPv4, necesitamos entregar de alguna manera las solicitudes que llegan a trav√©s de IPv4 a los servidores front-end, y todav√≠a ir un poco a IPv4 externo. Internet, por ejemplo, para indexar. <br><br>  Las √∫ltimas iteraciones del dise√±o de la red del centro de datos utilizan topolog√≠as Clos de varios niveles, y solo se utiliza L3 en ellas.  Salimos de L2 hace alg√∫n tiempo y soltamos un suspiro de alivio.  Finalmente, nuestra infraestructura incluye cientos de miles de instancias de computaci√≥n (servidor).  El tama√±o m√°ximo del cl√∫ster hace alg√∫n tiempo era de unos 10 mil servidores.  Esto se debe en gran medida a c√≥mo pueden funcionar los mismos sistemas operativos a nivel de cl√∫ster: programadores, asignaci√≥n de recursos, etc. Como el progreso ha ocurrido en el lado del software de infraestructura, ahora el objetivo es de aproximadamente 100 mil servidores en un cl√∫ster inform√°tico, y ten√≠amos una tarea: poder construir f√°bricas de redes que permitan la agrupaci√≥n eficiente de recursos en dicho grupo. <br><br><img src="https://habrastorage.org/webt/ra/co/cb/racocb4wtrqihsf4qcpswzzihhc.jpeg"><br><br>  ¬øQu√© queremos de una red de centros de datos?  En primer lugar, una gran cantidad de ancho de banda barato y bastante uniformemente distribuido.  Porque la red es ese sustrato a trav√©s del cual podemos agrupar recursos.  El nuevo tama√±o objetivo es de aproximadamente 100 mil servidores en un cl√∫ster. <br><br>  Adem√°s, por supuesto, queremos un plano de control escalable y estable, porque en una infraestructura tan grande surgen muchos dolores de cabeza incluso por eventos aleatorios, y no queremos que el plano de control nos cause dolor de cabeza.  Al mismo tiempo, queremos minimizar el estado en el mismo.  Cuanto m√°s peque√±a es la condici√≥n, mejor y m√°s estable todo funciona, es m√°s f√°cil de diagnosticar. <br><br>  Por supuesto, necesitamos automatizaci√≥n, porque es imposible administrar dicha infraestructura manualmente, y fue imposible hace alg√∫n tiempo.  Siempre que sea posible, necesitamos apoyo operativo y CI / CD en la medida de lo posible. <br><br>  Con tales tama√±os de centros de datos y cl√∫steres, la tarea de soportar la implementaci√≥n y expansi√≥n incrementales sin interrupci√≥n del servicio se ha vuelto bastante aguda.  Si en grupos el tama√±o de mil autom√≥viles es probablemente cercano a diez mil autom√≥viles, a√∫n podr√≠an desplegarse como una sola operaci√≥n, es decir, estamos planeando expandir la infraestructura y se agregan varios miles de m√°quinas como una sola operaci√≥n, entonces no surge un grupo del tama√±o de cien mil autom√≥viles solo as√≠, ha sido construido por alg√∫n tiempo.  Y es deseable que todo este tiempo lo que ya se ha bombeado, la infraestructura que se implementa, est√© disponible. <br><br>  Y un requisito que ten√≠amos y dejamos: este es el soporte para multitenancy, es decir, virtualizaci√≥n o segmentaci√≥n de red.  Ahora no necesitamos hacer esto en el nivel de f√°brica de la red, porque la segmentaci√≥n se dirigi√≥ a los hosts, y esto nos facilit√≥ el escalado.  Gracias a IPv6 y un gran espacio de direcciones, no necesit√°bamos usar direcciones duplicadas en la infraestructura interna, todas las direcciones ya eran √∫nicas.  Y debido al hecho de que llevamos el filtrado y la segmentaci√≥n de red a los hosts, no necesitamos crear ninguna entidad de red virtual en las redes de centros de datos. <br><br><img src="https://habrastorage.org/webt/nx/hi/9l/nxhi9l-ggxw-kvhbuoeldgkhnno.jpeg"><br><br>  Una cosa muy importante es que no necesitamos.  Si se pueden eliminar algunas funciones de la red, esto simplifica enormemente la vida y, por regla general, ampl√≠a la elecci√≥n del hardware y software disponibles, y simplifica enormemente los diagn√≥sticos. <br><br>  Entonces, ¬øqu√© no necesitamos, qu√© pudimos rechazar, no siempre con alegr√≠a en el momento en que esto sucedi√≥, pero con gran alivio, cuando se complet√≥ el proceso? <br><br>  En primer lugar, el rechazo de L2.  No necesitamos L2 ni real ni emulado.  No se utiliza en gran medida debido al hecho de que controlamos la pila de aplicaciones.  Nuestras aplicaciones se escalan horizontalmente, funcionan con direccionamiento L3, no se preocupan realmente de que se haya presentado alguna instancia en particular, simplemente implementan una nueva, no es necesario implementarla en la direcci√≥n anterior, porque hay un nivel separado de descubrimiento de servicio y monitoreo de m√°quinas ubicadas en el cl√∫ster .  No cambiamos esta tarea a la red.  La tarea de la red es entregar paquetes del punto A al punto B. <br><br>  Adem√°s, no tenemos situaciones en las que las direcciones se muevan dentro de la red, y esto debe ser monitoreado.  En muchos dise√±os, esto generalmente es necesario para soportar la movilidad de VM.  No utilizamos la movilidad de las m√°quinas virtuales en la infraestructura interna de exactamente el gran Yandex y, adem√°s, creemos que, incluso si esto se hace, esto no deber√≠a suceder con el soporte de red.  Si realmente necesita hacer esto, debe hacerlo a nivel de host y dirigir las direcciones que pueden migrar a superposiciones para no tocar o hacer demasiados cambios din√°micos en el sistema de enrutamiento (red de transporte). <br><br>  Otra tecnolog√≠a que no usamos es la multidifusi√≥n.  Te puedo decir en detalle por qu√©.  Esto hace la vida mucho m√°s f√°cil, porque si alguien trata con √©l y observa c√≥mo es exactamente el plano de control de una multidifusi√≥n, en todas las instalaciones, excepto en la m√°s simple, es un gran dolor de cabeza.  Y lo que es m√°s, es dif√≠cil encontrar una implementaci√≥n de c√≥digo abierto que funcione bien, por ejemplo. <br><br>  Finalmente, dise√±amos nuestras redes para que no tengan demasiados cambios.  Podemos contar con el hecho de que el flujo de eventos externos en el sistema de enrutamiento es peque√±o. <br><br><img src="https://habrastorage.org/webt/qa/nz/e3/qanze3l9jiktreg59urwgnfmpec.jpeg"><br><br>  ¬øQu√© problemas surgen y qu√© limitaciones deben tenerse en cuenta cuando desarrollamos una red de centros de datos?  Costo por supuesto.  Escalabilidad, a qu√© nivel queremos crecer.  La necesidad de expansi√≥n sin detener el servicio.  Disponibilidad de ancho de banda.  La visibilidad de lo que est√° sucediendo en la red, para los sistemas de monitoreo, para los equipos operativos.  El soporte para la automatizaci√≥n es, de nuevo, tanto como sea posible, ya que se pueden resolver diferentes tareas en diferentes niveles, incluida la introducci√≥n de capas adicionales.  Bueno y no, [siempre que sea posible], dependencia de los vendedores.  Aunque en diferentes per√≠odos hist√≥ricos, dependiendo de qu√© secci√≥n mirar, esta independencia fue m√°s f√°cil o m√°s dif√≠cil de lograr.  Si tomamos una porci√≥n de los chips de los dispositivos de red, hasta hace poco, hablamos de independencia de los proveedores, si tambi√©n quisi√©ramos chips con alto rendimiento, podr√≠a ser muy arbitrario. <br><br><img src="https://habrastorage.org/webt/fd/bq/s1/fdbqs1_kegdd7s4twvg144y0rus.jpeg"><br><br>  ¬øQu√© topolog√≠a l√≥gica usaremos para construir nuestra red?  Este ser√° un Clos de varios niveles.  De hecho, actualmente no hay alternativas reales.  Y la topolog√≠a de Clos es lo suficientemente buena, incluso si la comparamos con varias topolog√≠as avanzadas que ahora est√°n m√°s en el √°mbito de inter√©s acad√©mico, si tenemos conmutadores con una gran ra√≠z. <br><br><img src="https://habrastorage.org/webt/4y/pk/tt/4ypkttuvzezqubmxx3te-envyzo.jpeg"><br><br>  ¬øC√≥mo est√° estructurada la red Clos en capas y c√≥mo se llaman los diferentes elementos en ella?  En primer lugar, se levant√≥ el viento para descubrir d√≥nde estaba el norte, d√≥nde estaba el sur, d√≥nde estaba el este, d√≥nde estaba el oeste.  Las redes de este tipo generalmente son construidas por aquellos que tienen un tr√°fico muy grande de oeste a este.  En cuanto al resto de los elementos, en la parte superior se muestra un conmutador virtual ensamblado a partir de conmutadores m√°s peque√±os.  Esta es la idea b√°sica de construir recursivamente redes Clos.  Tomamos elementos con alg√∫n tipo de ra√≠z y los conectamos para que lo que sucedi√≥ pueda considerarse como un interruptor con una ra√≠z m√°s grande.  Si necesita a√∫n m√°s, el procedimiento puede repetirse. <br><br>  En casos, por ejemplo, con Clos de dos niveles, cuando es posible distinguir claramente los componentes que son verticales en mi diagrama, generalmente se denominan planos.  Si construimos Clos-con tres niveles de interruptores de columna (todos los que no est√°n en el l√≠mite y no son interruptores ToR y que se usan solo para el tr√°nsito), entonces los aviones se ver√≠an m√°s complicados, un aspecto de dos niveles como ese.  El bloque de ToR o interruptores de hoja y los interruptores de columna asociados de primer nivel que llamamos Pod.  Los interruptores de nivel 1 de la columna vertebral en la parte superior del Pod son la parte superior del Pod, la parte superior del Pod.  Los interruptores que se encuentran en la parte superior de toda la f√°brica son la capa superior de la f√°brica, la parte superior de la tela. <br><br><img src="https://habrastorage.org/webt/k-/sk/dd/k-skddvn98f6y-jk2e_5zzvlm4a.jpeg"><br><br>  Por supuesto, surge la pregunta: las redes de cierre se han construido durante alg√∫n tiempo, la idea en s√≠ misma generalmente proviene de los d√≠as de la telefon√≠a cl√°sica, las redes TDM.  Tal vez algo mejor apareci√≥, tal vez puedes hacer algo mejor de alguna manera?  Si y no  Te√≥ricamente, s√≠, en la pr√°ctica, en el futuro cercano, definitivamente no.  Debido a que hay una serie de topolog√≠as interesantes, algunas de ellas incluso se usan en la producci√≥n, por ejemplo, Dragonfly se usa en aplicaciones HPC;  Tambi√©n hay topolog√≠as interesantes como Xpander, FatClique, Jellyfish.  Si observa informes en conferencias como SIGCOMM o NSDI en los √∫ltimos tiempos, puede encontrar una cantidad bastante grande de documentos sobre topolog√≠as alternativas que tienen mejores propiedades (una u otra) que Clos. <br><br>  Pero todas estas topolog√≠as tienen una propiedad interesante.  Impide su implementaci√≥n en las redes de centros de datos, que estamos tratando de construir sobre hardware b√°sico y que cuestan dinero razonablemente razonable.  En todas estas topolog√≠as alternativas, desafortunadamente, la mayor√≠a de la banda no es accesible a trav√©s de los caminos m√°s cortos.  Por lo tanto, perdemos de inmediato la capacidad de usar el plano de control tradicional. <br><br>  Te√≥ricamente, se conoce la soluci√≥n al problema.  Estas son, por ejemplo, modificaciones del estado del enlace utilizando la ruta k-m√°s corta, pero, nuevamente, no hay protocolos que se implementar√≠an en producci√≥n y que estuvieran disponibles de forma masiva en los equipos. <br><br>  Adem√°s, dado que la mayor parte de la capacidad no es accesible a trav√©s de las rutas m√°s cortas, necesitamos modificar no solo el plano de control para que seleccione todas estas rutas (y, por cierto, este es un estado mucho m√°s grande en el plano de control).  Todav√≠a necesitamos modificar el plano de reenv√≠o y, como regla, se requieren al menos dos caracter√≠sticas adicionales.  Esta es una oportunidad para tomar todas las decisiones sobre el reenv√≠o de paquetes una vez, por ejemplo, en un host.  Esto es en realidad el enrutamiento de origen, a veces en la literatura sobre redes de interconexi√≥n se llama decisiones de reenv√≠o todo a la vez.  Y el enrutamiento adaptativo ya es una funci√≥n que necesitamos en los elementos de la red, que se reduce, por ejemplo, al hecho de que seleccionamos el siguiente salto en funci√≥n de la informaci√≥n sobre la menor carga en la cola.  Como ejemplo, otras opciones son posibles. <br><br>  Por lo tanto, la direcci√≥n es interesante, pero, por desgracia, no podemos aplicarla en este momento. <br><br><img src="https://habrastorage.org/webt/5d/ki/zy/5dkizyihr8k0owfwar8yjdkx5m0.jpeg"><br><br>  Bien, se decidi√≥ por la topolog√≠a l√≥gica de Clos.  ¬øC√≥mo lo escalaremos?  Veamos c√≥mo funciona y qu√© se puede hacer. <br><br><img src="https://habrastorage.org/webt/ap/dy/-2/apdy-2dnjdljys76pfv4rw7sr-k.jpeg"><br><br>  En la red Clos hay dos par√°metros principales que de alguna manera podemos variar y obtener ciertos resultados: elementos de la ra√≠z y el n√∫mero de niveles en la red.  Describo esquem√°ticamente c√≥mo uno y el otro afectan el tama√±o.  Idealmente, combinamos ambos. <br><br><img src="https://habrastorage.org/webt/5d/ki/zy/5dkizyihr8k0owfwar8yjdkx5m0.jpeg"><br><br>  Se puede ver que el ancho total de la red Clos es un producto de todos los niveles de interruptores de columna vertebral de la ra√≠z sur, cu√°ntos enlaces tenemos hacia abajo, c√≥mo se ramifica.  As√≠ es como escalamos el tama√±o de la red. <br><br><img src="https://habrastorage.org/webt/ap/dy/-2/apdy-2dnjdljys76pfv4rw7sr-k.jpeg"><br><br>  En cuanto a la capacidad, especialmente en los conmutadores ToR, hay dos opciones de escala.  O podemos, manteniendo la topolog√≠a general, usar enlaces m√°s r√°pidos, o podemos agregar m√°s planos. <br><br>  Si observa la versi√≥n detallada de la red Clos (en la esquina inferior derecha) y vuelve a esta imagen con la red Clos a continuaci√≥n ... <br><br><img src="https://habrastorage.org/webt/4y/pk/tt/4ypkttuvzezqubmxx3te-envyzo.jpeg"><br><br>  ... entonces esta es exactamente la misma topolog√≠a, pero en esta diapositiva se contrae de manera m√°s compacta y los planos de f√°brica se superponen entre s√≠.  Es uno y lo mismo. <br><br><img src="https://habrastorage.org/webt/n9/ny/zd/n9nyzdzmz4i8o_c-adybirjhfos.jpeg"><br><br>  ¬øC√≥mo se ve escalar una red Clos en n√∫meros?  Aqu√≠ tengo datos sobre qu√© ancho m√°ximo puede obtener una red, qu√© n√∫mero m√°ximo de bastidores, conmutadores ToR o conmutadores de hoja, si no est√°n en bastidores, podemos obtener dependiendo de qu√© ra√≠z de conmutadores usamos para las espinas niveles y cu√°ntos niveles usamos. <br><br>  Muestra cu√°ntos racks podemos tener, cu√°ntos servidores y cu√°nto puede consumir todo esto a raz√≥n de 20 kW por rack.  Un poco antes, mencion√© que apuntamos a un tama√±o de cl√∫ster de aproximadamente 100 mil servidores. <br><br>  Se puede ver que en toda esta construcci√≥n son interesantes dos opciones y media.  Hay una opci√≥n con dos capas de espinas y conmutadores de 64 puertos, que es un poco corta.  Luego, opciones de ajuste perfecto para conmutadores de columna de 128 puertos (con 128 radix) con dos niveles, o conmutadores con 32 radix con tres niveles.  Y en todos los casos donde hay m√°s radix y m√°s niveles, puede hacer una red muy grande, pero si observa el consumo esperado, por regla general, hay gigavatios.  Puede tender el cable, pero es poco probable que obtengamos tanta electricidad en un sitio.  Si observa estad√≠sticas, datos p√∫blicos sobre centros de datos, se pueden encontrar muy pocos centros de datos para una capacidad estimada de m√°s de 150 MW.  Adem√°s, por lo general, los campus de centros de datos, varios centros de datos grandes ubicados bastante cerca uno del otro. <br><br>  Hay otro par√°metro importante.  Si observa la columna izquierda, el ancho de banda utilizable se indica all√≠.  Es f√°cil notar que en una red Clos, una parte importante de los puertos se gasta en conectar los conmutadores entre s√≠.  El ancho de banda utilizable es lo que puede dar, hacia los servidores.  Naturalmente, estoy hablando de puertos condicionales y de la franja.  Como regla general, los enlaces dentro de la red son m√°s r√°pidos que los enlaces hacia los servidores, pero por unidad de banda, en la medida en que podemos entregarlo a nuestro equipo de servidor, todav√≠a hay algunas bandas m√°s dentro de la red misma.  Y cuantos m√°s niveles hagamos, mayores ser√°n los costos unitarios para proporcionar esta tira al exterior. <br><br>  Adem√°s, incluso esta banda extra no es exactamente la misma.  Si bien los tramos son cortos, podemos usar algo como DAC (cobre de conexi√≥n directa, es decir, cables twinax) u √≥ptica multimodo, que cuestan dinero a√∫n m√°s o menos razonable.  Tan pronto como cambiemos a tramos m√°s aut√©nticos, como regla general, se trata de una √≥ptica de modo √∫nico, y el costo de esta banda adicional aumenta notablemente. <br><br>  Y nuevamente, volviendo a la diapositiva anterior, si hacemos una red Clos sin volver a suscribirnos, entonces es f√°cil mirar el diagrama, ver c√≥mo se construye la red: agregando cada nivel de interruptores de columna, repetimos toda la tira que estaba debajo.  Nivel plus: m√°s toda la misma banda, la misma cantidad de puertos en los conmutadores que en el nivel anterior, la misma cantidad de transceptores.  Por lo tanto, el n√∫mero de niveles de interruptores de columna es muy deseable para minimizar. <br><br>  Con base en esta imagen, est√° claro que realmente queremos construir sobre algo como interruptores con una ra√≠z de 128. <br><br><img src="https://habrastorage.org/webt/lh/hu/qu/lhhuquq763qnw40v3n66copxa5w.jpeg"><br><br>  Aqu√≠, en principio, todo es lo mismo que acabo de decir, es m√°s probable que esta diapositiva se considere m√°s adelante. <br><br><img src="https://habrastorage.org/webt/ci/yy/zi/ciyyzijzbhajnlsarxtn-tcoybo.jpeg"><br><br>   ,        ?     ,     -      .    ,     . ,      .  ,    .  ,   ,  ,  , .        ( ),       control plane    , , ,     ,       .        ,    ,     . <br><br> , ,    ,         SerDes- ‚Äî  -   .          forwarding .  ,    ,     ,  ,  ,     Clos-,     .      . <br><br>       ,    ,      .     ,      ,   ,    ,     ,      ,        ,    ,       ,   . <br><br><img src="https://habrastorage.org/webt/8y/in/ym/8yinymhp1wcbtuhl6tbvooghq24.jpeg"><br><br>      ‚Äî   , .  ,  ,   .     ,    ,  ,    -           ,    . ,    ,   ,  ,    . <br><br> ,  ,     ,   . -,    ,    .    ,    ,   128 ,              . <br><br>       ,  , ,    data plane.  . ,  ,   .  ,          ,      ,     . ,   ,   , ,    128    ,       .            .       .          . <br><br>   ,    -  ,    .   ( ),   ,    ‚Äî ToR-  leaf-,        .     -   ,    ,            , , -    .   ,     ,         ,    -    . <br><br><img src="https://habrastorage.org/webt/wc/yl/hl/wcylhl91sqnrvns5wqmembthdaa.jpeg"><br><br> ,        ,    . <br><br><img src="https://habrastorage.org/webt/uz/mo/ng/uzmongpipgv1bxt94ksbvlkruvi.jpeg"><br><br>     ?   .       ,       ,   ,       :    leaf-,   1,   2. ,     ‚Äî  twinax, multimode, single mode.    ,   ,    ,   ,    ,     . <br><br>       .    ,   ,   multimode ,      ,  ,  100-  .  , ,  ,  single mode ,    ,   single mode,  -      CWDM,   single mode (PSM)    ,     ,      ,      . <br><br>   :  ,      100  425  .      SFP28    ,  QSFP28  100 .     multimode   . <br><br>    - ,  -   , -    -   .  ,         .  , -   Pods      twinax- ( ). <br><br>  ,         ,     ,          CWDM.     . <br><br><img src="https://habrastorage.org/webt/ea/ci/pf/eacipf4xy2usawno2ccx4ucuwsm.jpeg"><br><br>   ,   ,      . ,   ,      50- SerDes      .  ,   ,           400G,      50G SerDes-   ,       100 Gbps per lane.   ,     50    100- SerDes  100 Gbps per lane,           . ,  50G SerDes   , ,    ,   100G SerDes         .   -    , ,    . <br><br><img src="https://habrastorage.org/webt/uz/mo/ng/uzmongpipgv1bxt94ksbvlkruvi.jpeg"><br><br>      .  ,      400-  200-    50G SerDes.  ,      ,  ,    ,       ,   , .   128.            ,  , , ,  . <br><br>         ,      ,    .     ,     ,    ,        , ,    100- ,       . <br><br><img src="https://habrastorage.org/webt/0b/r0/or/0br0oryllu-b_r4p9fcbino5bks.jpeg"><br><br>   ‚Äî   ,       . ,     .   leaf-     ‚Äî     ,     .       , ,    ‚Äî            . <br><br> ,  ,     ,      -. ,           ,   -       -,      .     .      ,  ,   ,       .           -  -,                -,     ,       ,  ,       .      :        .   -   , ¬´ ¬ª,      Clos-,      .     ,    ,   . <br><br><img src="https://habrastorage.org/webt/1t/hu/rq/1thurqskba0vbopspd3nhpfgsus.jpeg"><br><br>          .        -  ,   ,       ,      ,    -2-. <br><br>    .       ,      - 512  512 ,    ,      ,     -2.            Pods   -1,      -,      -2. <br><br><img src="https://habrastorage.org/webt/c6/gv/mr/c6gvmrqk7tjkdwxuvopyn76gvn8.jpeg"><br><br>  As√≠ es como se ve.      -2 ()   -.  ,      .            -,  .    ,   ,   . <br><br><img src="https://habrastorage.org/webt/ip/gh/sd/ipghsdpwb_goedtygn0bpaj89kq.jpeg"><br><br>  :   ,  .    control plane-?      ,  -  ,  link state  ,    , ,  ,       .     ,    ‚Äî  ,     link state .     ,   ,    , ,        fanout,     control plane .          link state    . <br><br>  ‚Äî  BGP.    ,   RFC 7938   BGP   -.   :            ,  ,   ,   path hunting.    ,    , ,   valley free.  ,  ,   ,    .    ,   ,     .    .   . <br><br>   ,     ,     BGP.      eBGP,   link local,      :    ToR,      -1-  Pod,       Top of Fabric.      ,       BGP     ,   . <br><br><img src="https://habrastorage.org/webt/hw/ep/kf/hwepkfz0cr9y5fhmdix0xbvhv00.jpeg"><br><br> ,       ,      ,   ,     control plane. L3      ,       ,         .     ‚Äî  ,  ,  ,      multi-path,       multi-path   ,  ,    ,    .  ,          ,     ,    ,      ,   .     ,    multi-path,     ToR-. <br><br><img src="https://habrastorage.org/webt/md/ce/zb/mdcezbkgiaxpdjcs1llfgnsvvps.jpeg"><br><br>   ,  ,   ‚Äî           .     ,   ,    ,        ,     BGP,    .  ,  corner cases    ,     BGP        . <br><br>           RIFT,       . <br><br><img src="https://habrastorage.org/webt/0u/h7/uq/0uh7uqwufze4nmj1oqrb6kun2jm.jpeg"><br><br>     ‚Äî  ,   data plane   ,        .       : ECMP ,       Next Hop. <br><br>    ,  ,     Clos- ,     ,   ,   ,  ,   .       ,     ECMP,  single path-.  .   ,   Clos-   ,      Top of fabric,   ,        .      ,            ,     .     ,     ECMP     state. <br><br>    data plane   ?    LPM (longest prefix match),   ,  100 .    Next Hop ,   , 2-4 .    ,    Next Hops ( adjacencies),   -  16  64.     .       :     MPLS  -?  ,    . <br><br><img src="https://habrastorage.org/webt/ze/ub/bj/zeubbjnb97nq_gvoprd374lotda.jpeg"><br><br>   .     ,        .                 white boxes  MPLS.   MPLS,   ,   ,  ,     ECMP.  Y aqu√≠ est√° el por qu√©. <br><br><img src="https://habrastorage.org/webt/fc/za/pr/fczaprpywdv5b1jhoqrn9lxq8ti.jpeg"><br><br>    ECMP-  IP.                 Next Hops ( adjacencies,          -).   ,           -,     Next Hop.  IP   ,             ,      Next Hops. <br><br><img src="https://habrastorage.org/webt/n5/bl/jw/n5bljwqyrivakkgc2_f8cl4oifw.jpeg"><br><br>   MPLS ,            .          Next Hops    .  , ,  . <br><br>  ,         4000 ToR-,   ‚Äî 64  ECMP,    -1   -2.    ,  ,    ECMP-,      ToR ,       Next Hops. <br><br><img src="https://habrastorage.org/webt/ut/rz/jf/utrzjfe-ddmgf0dxjbq5ipxukcs.jpeg"><br><br>   ,     Segment Routing   .          Next Hops.      wild card:           .   ,       . <br><br>  ,    -   .   ?     Clos- .     ,       Top of fabric.          .  ,         ,       Top of fabric,      , ,          . ,   ,      ,     ,      . <br><br>   ‚Äî    .  ,  Clos-  ,  ,  ,     ToR,       Top of fabric   ,   .      Pod, Edge Pod,    . <br><br>    . , ,  Facebook.     Fabric Aggregator  HGRID.   -,    -.   ,           .   ,   touch points,  .  ,       ,    -.      ,    -  ,       ,       .  , ,    .    overlays,    . <br><br><img src="https://habrastorage.org/webt/mw/sj/ci/mwsjcikq0-fdqoklr0nal6vtjtg.jpeg"><br><br>     ?    ‚Äî   CI/CD-.    ,   ,   ,  .     ,    ,     .  ,       ,     . <br><br>  ,       .       .      ‚Äî  . <br><br>      .      ,  RIFT.        congestion control , , ,      ,  RDMA   . <br><br>        ,    , , ,   overhead.    ‚Äî        HPC Cray Slingshot,     commodity Ethernet,        .   overhead . <br><br><img src="https://habrastorage.org/webt/ja/-z/yx/ja-zyxc9orfwrz1lryew_4jt7r4.jpeg"><br><br>     ,  ,   .  ‚Äî  .     ‚Äî  .   -  scale out ‚Äî .  ,     .    . . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/476146/">https://habr.com/ru/post/476146/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../476134/index.html">MONQ - monitoreo y AIOps originarios de Rusia</a></li>
<li><a href="../476138/index.html">Los astr√≥nomos creen que los sat√©lites de comunicaci√≥n SpaceX, OneWeb y otras compa√±√≠as amenazan el futuro de la astronom√≠a</a></li>
<li><a href="../476140/index.html">¬øC√≥mo mejorar la escucha si conoces 7000 palabras pero no las entiendes de o√≠do?</a></li>
<li><a href="../476142/index.html">¬øPor qu√© evitar el uso de excepciones para controlar su flujo en Java?</a></li>
<li><a href="../476144/index.html">C√≥mo necesitas y no necesitas escribir un chat para bots usando el ejemplo de mi bot para jugar a Secret Santa</a></li>
<li><a href="../476148/index.html">postfix + dovecot + mysql en FreeBSD</a></li>
<li><a href="../476156/index.html">Solicitud-respuesta sincr√≥nica usando Apache Kafka</a></li>
<li><a href="../476160/index.html">El nacimiento del software educativo y su historia: de las m√°quinas mec√°nicas a las primeras computadoras</a></li>
<li><a href="../476162/index.html">Creamos una aplicaci√≥n web moderna. Conocimiento del proyecto y preparaci√≥n para el trabajo. Parte 1</a></li>
<li><a href="../476164/index.html">"Esto tambi√©n es an√°lisis de datos". Hable sobre bioinform√°tica con Mikhail Gelfand</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>