<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚òÇÔ∏è üì¶ üåπ Conception sophistiqu√©e d'appareils simples üçú üó≥Ô∏è üìÇ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Salutations au lecteur! Aujourd'hui, je vais vous raconter une histoire curieuse qui m'a fait r√©fl√©chir aux probl√®mes qui se posent lorsque le mauvais...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Conception sophistiqu√©e d'appareils simples</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/432574/"> Salutations au lecteur!  Aujourd'hui, je vais vous raconter une histoire curieuse qui m'a fait r√©fl√©chir aux probl√®mes qui se posent lorsque le mauvais choix (non optimal) de composants pour la mise en ≈ìuvre de tout produit √©lectronique.  Et aussi sur la simplicit√© apparente en utilisant l'exemple d'un appareil ¬´un jour¬ª. <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/uv/9g/hg/uv9ghgxb_nswu_pvba8bbjt5jp0.jpeg" width="450"></div><a name="habracut"></a>  Convenons que l'histoire est fictive, toutes les co√Øncidences sont al√©atoires ... ou non al√©atoires. <br>  Une fois que Seryozha le programmeur s'est tourn√© vers moi avec une demande de fabrication d'un appareil dans sa voiture qui √©mule la pression s√©quentielle de 2 boutons virtuels lors de la pression d'une voiture physique dans le circuit de commande du r√©gulateur de vitesse (Ford Focus 2).  Le sch√©ma de l'unit√© de contr√¥le standard est le suivant: <br><br><img src="https://habrastorage.org/webt/wu/yr/j3/wuyrj3rbtekr3o9zd3ogzyybvsg.png"><br><br>  C√¥t√© commande, il s'agit d'une entr√©e √† bouton-poussoir classique utilisant un ADC.  et donc la t√¢che de l'appareil, lorsque vous appuyez sur le bouton mat√©riel, appuyez successivement sur le bouton ON et SET + pendant un temps de ~ 0,2 s.  Pour faciliter l'int√©gration de l'appareil, il a √©t√© d√©cid√© de l'alimenter √† partir de la r√©sistance sup√©rieure du diviseur.  La tension aux bornes de connexion est de 4,6 V sans circuit de bouton connect√©.  Comme l'appareil devait √™tre fabriqu√© le soir, j'ai fait un diagramme sans calculs pr√©liminaires √† partir de ce qui √©tait sur la table de montage.  La solution "au front": <br><br><img src="https://habrastorage.org/webt/xz/vg/4j/xzvg4jaka9aknb__8taqs7pwrmw.png"><br><br>  Serezha a √©crit le firmware et l'appareil fonctionnait parfaitement pour les voitures.  Au moment o√π ils voulaient ranger la carte dans le bo√Ætier du commutateur de colonne de direction, quelqu'un de l'arri√®re du bureau a cri√©: ¬´Est-ce si compliqu√©?  La moiti√© des d√©tails peuvent √™tre jet√©s, et en effet STM8 est juste la chose pour une telle t√¢che. "  Et √ßa a commenc√© ... L'auteur de l'id√©e s'est port√© volontaire pour souder le trac√© "en 3 parties" (anticipant apparemment une victoire facile).  J'ai (guid√© par mon propre article sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la jalousie professionnelle</a> ) d√©cid√© de ne pas interf√©rer avec le vol du jeune sp√©cialiste, mais seulement connect√© au stade o√π tout le monde s'est rendu compte qu'un miracle ne s'√©tait pas produit. <br><br>  Le sch√©ma propos√© par mon coll√®gue √©tait vraiment plus simple, mais ne fonctionnait que sur la table: <br><br><img src="https://habrastorage.org/webt/pb/fc/yk/pbfcykqizfvig66cx0l3zo2e008.png"><br><br>  Des erreurs √©taient visibles m√™me √† premi√®re vue, cependant, j'ai d√©cid√© de faire fonctionner le circuit sp√©cifiquement sur le STM8S001J3 MK. <br><br>  Afin de comprendre comment refaire le circuit, nous allons effectuer plusieurs mesures.  La r√©sistance de la r√©sistance sup√©rieure du diviseur ADC est de ~ 130 Ohms et la tension sans charge est de 4,6 V. <br><br>  Ensuite, le diagramme de n≈ìud de bouton a la forme: <br><br><img src="https://habrastorage.org/webt/g4/th/-g/g4th-gpsd2dzk3czstorlhjcati.png"><br><br><ul><li>  lorsque les boutons sont rel√¢ch√©s, le courant dans le circuit est de 2 mA, la tension √† l'entr√©e ADC est de 4,33 V; </li><li>  lorsque le bouton ON est enfonc√©, 3,7 mA, la tension √† l'entr√©e de l'ADC est de 4,11 V; </li><li>  avec le bouton SET enfonc√© + 18,4 mA, la tension √† l'entr√©e ADC est de 2,2 V. </li></ul><br>  Dans le m√™me temps, la plage de tension de fonctionnement du STM8S001J3 MK est de 2,95-5,5 V. Il s'av√®re qu'une tentative d'appuyer sur le bouton SET + entra√Æne une chute de tension en dessous du minimum et le MK est r√©initialis√©. <br><br>  √Ä ce stade, je propose de distraire et de discuter quel est le MK id√©al pour cette t√¢che et pourquoi ils ne l'ont pas choisi.  Habituellement, pour de tels m√©tiers, utilisez ce que le d√©veloppeur sait comment travailler et ce qui est √† port√©e de main.  Par exemple, la puce poss√®de des contr√¥leurs PIC10F200 ou ATtiny10 dans le bo√Ætier SOT23-6 avec une plage de tension de 2 (1,8) √† 5,5 V. Ces microcircuits ne n√©cessitent pas de r√©gulateur de tension (comme STM32L031), mais ils ne red√©marreront pas lorsque vous appuyez sur le bouton SET +. (comme STM8S001J3).  Dans le faisceau, il n'y aura que 2 r√©sistances et un condensateur.  La beaut√©, mais pas la gamme de contr√¥leurs STMicro avec cette gamme de puissance.  Un lecteur attentif notera √† juste titre que dans le cadre d'une telle t√¢che, presque tous les contr√¥leurs peuvent √™tre ma√Ætris√©s, mais l'absence d'un environnement de programmation familier et d'outils de d√©bogage d√©terminent le choix. <br>  Revenons au sch√©ma.  Pour r√©soudre le probl√®me de r√©initialisation du contr√¥leur, nous avons besoin d'√©nergie pour alimenter le contr√¥leur pendant que le bouton SET + est enfonc√©.  Pour estimer la quantit√© de cette √©nergie, il est n√©cessaire de mesurer la consommation actuelle (ou voir la documentation): <br><br><img src="https://habrastorage.org/webt/sc/70/vu/sc70vuonse7-qjwdmc6a2fh4zaa.png"><br><br>  Pr√®s de 500 ŒºA √† son meilleur.  C'est beaucoup, mais pour que ce soit clair, je vais faire un calcul.  Pour stocker l'√©nergie, nous avons besoin d'une diode (VD1) et d'un condensateur (C1): <br><br><img src="https://habrastorage.org/webt/si/2q/fe/si2qfeyf6zzawldlp-kk863noz0.png"><br><br>  La baisse sur VD1 est de 0,2 V, respectivement, lorsque les boutons C1 sont rel√¢ch√©s, elle sera charg√©e √† 4,33 - 0,2 = 4,13 V. Lorsque vous appuyez sur le bouton SET +, la tension √† Vin chute √† 2,2 V, VD1 se ferme et MK aliment√© par d√©charge C1. <br><br><img src="https://habrastorage.org/webt/zn/by/cg/znbycg5v4zszjmr8uqvprphihce.png"><br><br>  (Merci √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">VT100</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DenisHW d'avoir corrig√© l'erreur</a> ) <br>  Dans cette expression, l'√©nergie stock√©e dans le condensateur √† gauche (lorsqu'elle est d√©charg√©e de 4,13 √† 3,1 V), l'√©nergie d√©pens√©e √† droite par le contr√¥leur pendant un temps t = 0,2 s.  Ensuite, la capacit√© du condensateur: <br><br><img src="https://habrastorage.org/webt/yx/cf/l8/yxcfl8hijew86jmxqjkwvfeedic.png"><br><br>  100 microfarads pour cette t√¢che sont tol√©rables, mais essayez d'euthanasier le contr√¥leur tout en appuyant sur le bouton. <br><br>  Pour ce faire, le STM8 dispose d'un mode d'arr√™t actif: <br><br><img src="https://habrastorage.org/webt/0n/mi/g9/0nmig9qr2gusc-np2serzxf0pim.png"><br><br>  En d√©sactivant MVR et Flash, il a √©t√© possible d'obtenir un courant de consommation de ~ 40 ŒºA (ce qui est nettement sup√©rieur au courant d√©clar√©, mais ce courant convient √† cette t√¢che), et gr√¢ce √† l'AWU (unit√© de r√©veil automatique), vous pouvez facilement r√©gler le r√©veil apr√®s 256 ms apr√®s s'√™tre mis en veille.  Dans ce cas, pour assurer le fonctionnement du contr√¥leur, un condensateur d'une capacit√© de seulement 10 ŒºF est n√©cessaire, mais puisqu'apr√®s le serrage des jambes, il faut un certain temps avant que le MK ne s'endorme, la capacit√© n√©cessaire et suffisante √©tait de 47 ŒºF. <br><br>  Il semble que tous les probl√®mes ont √©t√© r√©solus, mais il y en a encore un MAIS.  Le courant lorsque le bouton SET est enfonc√© + 18,4 mA est inf√©rieur au courant limite pour la sortie, mais la tension z√©ro logique sera de l'ordre de 0,7 V. Cela entra√Ænera une chute de courant √† travers la r√©sistance et n√©cessitera soit un recalcul de la r√©sistance, soit l'utilisation d'un transistor externe selon le sch√©ma. avec drain ouvert.  J'ai choisi la deuxi√®me option comme √©tant plus pr√©visible dans le comportement.  Le sch√©ma final a pris la forme: <br><br><img src="https://habrastorage.org/webt/fn/7j/kx/fn7jkxbq6apqrnqzcudayesbwyo.png"><br><br>  Sous cette forme, il a gagn√© avec succ√®s et fonctionne encore √† ce jour. <br><br>  <b>Au lieu d'une conclusion</b> <br><br>  Dans cet article, je veux attirer l'attention sur le probl√®me de la fa√ßon dont un d√©veloppeur est puni pour une approche excessivement superficielle ou frivole du d√©veloppement d'un dispositif simple (√† premi√®re vue).  D'un autre c√¥t√©, je voulais montrer comment le choix non optimal de la base de l'√©l√©ment principal (dans ce cas, MK) complique le processus de d√©veloppement et le produit lui-m√™me compte tenu de deux raisons principales: <br><br><ol><li>  La n√©cessit√© d'adapter le choix des solutions techniques aux comp√©tences du programmeur. </li><li>  Incapacit√© √† saisir la gamme compl√®te des composants possibles adapt√©s √† la t√¢che, √† s√©lectionner "le plus" d'entre eux.  Ces facteurs expliquent le plus souvent le fait que de nombreux appareils (m√©nagers, commerciaux, sp√©ciaux) fonctionnent bien, mais ne sont pas con√ßus comme vous le feriez. </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr432574/">https://habr.com/ru/post/fr432574/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr432562/index.html">Techday Make IT Real - 17 d√©cembre, Moscou</a></li>
<li><a href="../fr432564/index.html">Rust 2018 est sorti ... mais qu'est-ce que c'est?</a></li>
<li><a href="../fr432566/index.html">Deux mondes ou ¬´ing√©nieurs ont quelque chose √† dire¬ª. Sur les diff√©rents types de t√¢ches complexes et les processus qui leur sont associ√©s</a></li>
<li><a href="../fr432568/index.html">¬´Quand vous √™tes le r√©dacteur en chef de Rusbase¬ª: un nouveau podcast sur l'utilisation du contenu et une carri√®re dans les m√©dias technologiques</a></li>
<li><a href="../fr432572/index.html">Le transistor m√©tal-air √©tendra la loi de Moore - comment fonctionne la technologie</a></li>
<li><a href="../fr432576/index.html">Sous le capot d'un JobIntentService</a></li>
<li><a href="../fr432578/index.html">La Chine confirme son leadership dans la course lunaire asiatique</a></li>
<li><a href="../fr432580/index.html">Qu'est-ce que l'IA perce lors de la g√©n√©ration de visages humains</a></li>
<li><a href="../fr432584/index.html">La Chine √† la pointe des syst√®mes de cryptographie quantique</a></li>
<li><a href="../fr432586/index.html">Atomic CSS - ordre et propret√©</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>