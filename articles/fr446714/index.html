<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßõüèª ‚è¨ üëßüèø Curieuses perversions du monde informatique - 4 üëãüèª üÖ±Ô∏è üßùüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Le site Web Daily WTF recueille depuis 15 ans des histoires dr√¥les, sauvages et / ou tristes du monde informatique. J'ai traduit plusieurs histoires q...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Curieuses perversions du monde informatique - 4</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446714/"><div style="text-align:center;"><img src="https://ic.pics.livejournal.com/egor_23/73280836/1707368/1707368_1000.jpg" alt="image"></div><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Le</a> site Web <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Daily WTF</a> recueille depuis 15 ans des histoires dr√¥les, sauvages et / ou tristes du monde informatique.  J'ai traduit plusieurs histoires qui m'ont paru int√©ressantes.  Tous les noms et noms d'entreprises ont √©t√© modifi√©s.  Les num√©ros pr√©c√©dents se trouvent sous l'√©tiquette ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">perversions curieuses</a> ¬ª. <br><br><h2>  La premi√®re histoire.  Fin <s>du</s> mois </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[Original]</a> <br><br>  Si vous demandez √† un ing√©nieur en conception s'il est s√©curitaire de traverser un pont, il se fera un plaisir de vous dire √† quel point les ponts sont fiables, comment les math√©matiques y fonctionnent, dans quelle mesure nous avons progress√© en mati√®re de s√©curit√© des b√¢timents.  Apr√®s avoir parl√© avec lui, vous aurez l'impression qu'aucun pont sur Terre ne se d√©sagr√®gera jamais.  Mais si vous interrogez l'ing√©nieur en d√©veloppement logiciel sur les banques, vous serez tr√®s probablement horrifi√©, et avec une probabilit√© de 50/50 vous convaincre d'investir tout l'argent dans le bitcoin.  Les banques sont connues pour leurs mauvaises d√©cisions lors de la cr√©ation de logiciels - non pas parce que ces d√©cisions sont d√©go√ªtantes, mais parce que la plupart des gens supposent que les banques sont plus pr√©cises et prudentes en mati√®re de s√©curit√©. <br><br>  <b>Kato</b> travaille √† Inibank, o√π un produit commercial appel√© T24 est utilis√© comme noyau du syst√®me bancaire.  Le syst√®me T24 est utilis√© par des centaines de banques √† travers le monde.  Il peut √™tre personnalis√© pour une large gamme de solutions bancaires.  Comme avec la plupart des packages personnalis√©s.  Il y a des programmeurs sp√©cialis√©s dans l'√©criture de code et des consultants qui aident les banques avec les mises √† jour majeures. <br><a name="habracut"></a><br>  Le personnel d'Inibank √©tant occup√©, la banque a invit√© un consultant √† participer √† un projet sp√©cial.  √Ä la fin de la journ√©e de travail, la banque a effectu√© le processus d'ach√®vement, qui est n√©cessaire pour que tout l'argent aille l√† o√π il √©tait dirig√©, toutes les donn√©es de sortie n√©cessaires sont recalcul√©es et tous les rapports requis sont ex√©cut√©s.  Dans les banques, ce processus modifie √©galement la date du syst√®me au jour ouvrable suivant.  C'est pourquoi lorsque vous effectuez des op√©rations bancaires en ligne le dimanche, aucune transaction ne commence √† √™tre trait√©e avant lundi matin.  Le consultant a d√ª cr√©er un nouveau rapport qui serait ex√©cut√© pendant le processus d'ach√®vement et incluait un traitement suppl√©mentaire si la date correspondait √† la fin du mois. <br><br>  Kato a montr√© au nouveau consultant comment la banque √©tablit des rapports de fin de journ√©e.  ¬´Vous voyez, nous avons des variables globales pour le jour ouvrable pr√©c√©dent, pour aujourd'hui et pour le jour ouvrable suivant.  Ils ont le format YYMMDD pour faciliter leur utilisation. " <br><br>  ¬´Ouais, ouais, j'ai compris.  Je comprends.  Dans quel format sont-ils? " <br><br>  "... Euh ... Je peux seulement supposer que c'est l'ann√©e, le mois et le jour." <br><br>  ¬´Ouais, ouais, d'accord.  Super.  Ensuite, je me mets au travail. ¬ª <br><br>  Apr√®s cette conversation, Kato avait un mauvais pressentiment √† ce sujet.  mais il a essay√© de se d√©barrasser de lui.  Le consultant a d√©clar√© que tout √©tait install√© et pr√™t.  Il sait exactement ce qu'il fait, non?  Kato l'a jet√© de sa t√™te et a cess√© de s'inqui√©ter jusqu'√† ce que le temps pour la r√©vision du code soit arriv√© et qu'il ait trouv√© une telle perle: <br><br><pre> <code class="hljs pgsql">TH.DATE = R.DATES(EB.DAT.NEXT.WORKING.DAY)[<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>]:"01" <span class="hljs-keyword"><span class="hljs-keyword">CALL</span></span> CDT(<span class="hljs-string"><span class="hljs-string">'ES00'</span></span>,TH.DATE,"-1C") WTODAY = OCONV(<span class="hljs-type"><span class="hljs-type">DATE</span></span>(),"DY") : FMT(OCONV(<span class="hljs-type"><span class="hljs-type">DATE</span></span>(),"DM"),<span class="hljs-string"><span class="hljs-string">'R%2'</span></span>) : FMT(OCONV(<span class="hljs-type"><span class="hljs-type">DATE</span></span>(),"DD"),<span class="hljs-string"><span class="hljs-string">'R%2'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> TH.DATE EQ WTODAY <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span></code> </pre> <br>  Expliquez bri√®vement ce qui se passe ici: <br><br><ol><li>  Prenez le jour ouvrable suivant et changez le jour en 01 pour obtenir le premier jour du mois. </li><li>  Nous modifions cette date en soustrayant 1 jour calendaire du calendrier espagnol. </li><li>  Nous prenons la date du serveur et la traduisons au format YYYYMMDD, en appelant la commande Date trois fois. </li><li>  Si la date calcul√©e √† l'√©tape 2 est √©gale √† la date calcul√©e √† l'√©tape 3, d√©marrez le processus. </li></ol><br>  Eh bien, en fait ... √ßa marche.  Pour la plupart.  Sauf pour une raison quelconque, la fin de la journ√©e ne se produit pas apr√®s minuit l'avant-dernier jour du mois - et ce n'est pas si rare.  Dans ce cas, le code pensera √† tort qu'il s'agit du dernier jour du mois et commencera √† cr√©er le rapport.  Ce qui va bien avec un autre probl√®me: si la m√™me chose se produit le dernier jour du mois, la cr√©ation du rapport ne commencera pas par erreur.  Et le meilleur bogue: si le dernier jour du mois s'est av√©r√© √™tre dimanche, le calendrier du serveur ne sera jamais install√© dessus, car il saute les jours non ouvr√©s. <br><br>  En parlant de jours non ouvr√©s: Inibank √©tant situ√© aux USA, il n'y a aucune raison d'utiliser le calendrier espagnol.  Oui, les mois et les semaines seront les m√™mes, mais dans le calendrier logiciel espagnol, vous devez sp√©cifier les jours f√©ri√©s aux √âtats-Unis, sinon le programme continuera de fonctionner.  Enfin, comme si tout cela n'√©tait pas encore suffisant, le triple appel Date signifie qu'il peut y avoir des d√©saccords lors du d√©marrage √† minuit exactement: la valeur du mois est demand√©e avant minuit et le lendemain. <br><br>  Kato a ajout√© un commentaire, sugg√©rant un moyen de changer le code: <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">IF</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">R</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DATES</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">EB</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DAT</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.TODAY</span></span>)<span class="hljs-selector-attr"><span class="hljs-selector-attr">[5,2]</span></span> # <span class="hljs-selector-tag"><span class="hljs-selector-tag">R</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DATES</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">EB</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DAT</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.LAST</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.WORKING</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DAY</span></span>)<span class="hljs-selector-attr"><span class="hljs-selector-attr">[5,2]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">THEN</span></span></code> </pre> <br>  Cinq minutes plus tard, le consultant s'est rendu √† son bureau.  "Que signifie cette modification?" <br><br>  Kato n'√©tait pas d'humeur √† discuter √† ce moment.  ¬´Votre code est cass√©, ami.  Tout cela n'est pas n√©cessaire. " <br><br>  ¬´Je vois, je vois.  Il s'agit en fait d'un mode op√©ratoire standard pour notre industrie.  Eh bien, d'accord. " <br><br>  Kato en doutait beaucoup, mais haussa simplement les √©paules.  ¬´Alors l'industrie a tort.  J'ai tout expliqu√© dans le commentaire. " <br><br>  "Ouais.  Oui, je l'ai lu.  Mais je vais le relire. ¬ª  Et il a disparu aussi soudainement qu'il est apparu. <br><br>  Des modifications ont √©t√© apport√©es, Kato a approuv√© le code et le consultant a disparu dans le brouillard. <br><br>  Parfois, allong√© dans son lit la nuit, Kato se demandait: le consultant comprenait-il vraiment ce qu'il avait fait de mal, ou acceptait-il simplement de regarder, recevait son ch√®que et continuait √† √©crire quelque part un code terrible pour un prix deux fois le salaire de Kato?  Dans les banques o√π aucun employ√© ne peut v√©rifier le code. <br><br>  Mais n'investissez pas tout l'argent dans le bitcoin.  C'est encore pire l√†-bas. <br><br><h2>  La deuxi√®me histoire.  Comment cela se fait </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[Original]</a> <br><br>  Les gens aiment manger des hot-dogs jusqu'√† ce qu'ils d√©couvrent comment ils cuisinent.  La plupart ne demandent pas, car ils ne veulent pas savoir et continuent de manger des hot-dogs.  Lors du d√©veloppement de logiciels, nous devons parfois demander.  Non seulement pour r√©soudre des probl√®mes, mais aussi parce que certains programmeurs ont peur que le logiciel dans leurs voitures, circulant sur l'autoroute √† une vitesse de 100 km / h, soit assembl√© √† partir de bandes et de b√¢tons.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Toute notre industrie fait mal ses t√¢ches</a> . <br><br>  <strong>Brett a</strong> travaill√© comme analyste de syst√®mes au MedStitute Medical Research Center.  MedStitute a utilis√© un logiciel propri√©taire appel√© MedTech pour stocker et analyser les donn√©es.  Les m√©decins et les chercheurs ont aim√© les r√©sultats de MedTech, mais leur coll√®gue Brett Tyree savait comment ils ont √©t√© cr√©√©s. <br><br>  Le logiciel n'avait pas acc√®s au backend, et l'ensemble du processus de d√©veloppement s'est d√©roul√© dans l'interface graphique "souris programmable".  Cette interface semblait avoir √©t√© √©crite par une personne qui a √©tudi√© la programmation sur des sites de copier-coller des ann√©es 90, regard√© dix minutes <em>de Jurassic Park</em> et recherch√© des r√©ponses √† StackOverflow jusqu'√† ce que quelque chose puisse √™tre compil√©.  Le ¬´langage de programmation¬ª a √©galement montr√© un niveau similaire de r√©flexion dans la philosophie de conception.  Chacun <em>doit</em> avoir eu un <code>else</code> .  Certains modules ont utilis√© des valeurs bool√©ennes, d'autres ont renvoy√© des cha√Ænes vides pour indiquer de fausses valeurs.  D'apr√®s la documentation, il n'√©tait pas clair dans quelle situation l'un ou l'autre s'est produit.  En fait, chaque <code>if</code> s'est transform√©e en trois d√©clarations. <br><br>  Brett avait besoin de commencer une nouvelle √©tude.  Il √©tait bas√© sur un ensemble simple de statistiques et des patients group√©s utilisant une variable randomis√©e.  Brett a cherch√© dans la liste une variable qui pouvait √™tre randomis√©e, mais ne l'a pas trouv√©e n√©cessaire.  Il a sugg√©r√© qu'il avait fait une erreur et est retourn√© quelques √©crans pour v√©rifier son nom en le copiant pour une recherche.  Brett est revenu sur la liste des variables randomis√©es.  Elle n'√©tait pas l√†.  Il a examin√© de plus pr√®s la liste et a remarqu√© que la liste des variables randomis√©es contenait des donn√©es provenant de champs √† choix multiple.  Le champ dont il avait besoin pour randomiser √©tait bas√© sur un champ calcul√©. <br><br>  Brett savait que Tyree travaillait sur un autre projet randomis√© par champ calcul√©, il l'a donc contact√© √† Slack.  ¬´Comment avez-vous cod√© cette variable al√©atoire?  Medtech emp√™che-t-il cela de se produire? ¬ª <br><br>  "Je parle de conf√©rence, je vous rappellerai plus tard", a √©crit Tyree. <br><br>  Quelques minutes plus tard, Tyree a appel√© Brett. <br><br>  ¬´Vous devez commencer par deux champs.  Disons.  appelons-les <code>$variable_choice</code> , c'est-√†-dire une question √† choix multiples, et <code>$variable_calced</code> , c'est-√†-dire votre champ calcul√©.  Lorsque vous souhaitez cr√©er une variable qui effectue une s√©lection al√©atoire sur la base d'un champ calcul√©, vous dites √† Medtech que cette variable al√©atoire est bas√©e sur <code>$variable_choice</code> .  Ensuite, vous supprimez <code>$variable_choice</code> et renommez <code>$variable_calced</code> en <code>$variable_choice</code> ¬ª <br><br>  ¬´Arr√™tez, le syst√®me vous permet de le faire, mais ne vous permet pas de randomiser les champs calcul√©s d'une autre mani√®re?  Et elle ne le v√©rifie pas? " <br><br>  "J'esp√®re que rien ne change, et elle ne commence √† v√©rifier cela qu'√† la fin de mon projet", a r√©pondu Tyree. <br><br>  ¬´Cette √©tude devrait s'√©taler sur dix ans.  Et sa r√©ussite d√©pend si les d√©veloppeurs consid√®rent cette astuce comme un bug? ¬ª <br><br>  ¬´J'ai r√©ussi √† ne trouver qu'une telle solution.  Faites-moi savoir si vous trouvez quelque chose de mieux. " <br><br>  Brett n'a pas satisfait un tel hack, et il est retourn√© √† √©tudier la documentation.  Il a trouv√© une ¬´meilleure¬ª solution: vous pouvez cr√©er un champ √† choix multiples en lecture seule avec la seule valeur par d√©faut - la valeur du champ calcul√©.  Malheureusement, l'utilisateur peut modifier la liste par inadvertance en r√©pondant √† une question √† choix multiples <em>avant de</em> calculer la valeur du champ calcul√©. <br><br>  En fin de compte, la seule chose qui restait √† Brett √©tait de faire une pause, d'aller √† la caf√©t√©ria et d'acheter quelques hot-dogs. <br><br><h2>  La troisi√®me histoire.  Portabilit√© et mat√©riel </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[Original]</a> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/52e/2cb/0c2/52e2cb0c2e0b8465a1b713aa60dfd474.jpg"></div><br>  Il y a plusieurs lunes, lorsque les PC avaient des bo√Ætiers en m√©tal lourd et en plastique, <b>Matt</b> et son coll√®gue ont √©t√© invit√©s √† √©valuer le progiciel pour la prochaine op√©ration du service commercial.  Malheureusement, lui et son coll√®gue ont travaill√© dans diff√©rents bureaux de la m√™me ville.  √Ä cette √©poque, les outils de collaboration en ligne efficaces n'existaient pas encore, alors Matt devait r√©guli√®rement se rendre dans un autre bureau, emportant un PC avec lui.  Cela signifiait qu'√† chaque fois qu'il √©tait n√©cessaire de d√©connecter les c√¢bles p√©riph√©riques du bo√Ætier 473, de transporter l'ordinateur dans les couloirs et dans les escaliers, de prendre un bus pour se rendre dans un autre bureau, dans lequel il faisait tout cela dans l'ordre inverse.  Parfois, la mauvaise organisation du travail obligeait ce couple √† travailler le week-end, ce qui signifie qu'il transportait des machines √† la maison. <br><br>  Au cours du processus, le disque dur de 20 Mo de l'ordinateur de Matt a d√©bord√©.  De son bureau, il a envoy√© une demande au service informatique.  Pour remplir la demande, le technicien de Gary a √©t√© nomm√©, qui apr√®s un certain temps est apparu dans le cube de Matt, tenant un nouveau disque dur et un tournevis.  Gary a envoy√© √† Matt un caf√© pour se concentrer sur son ¬´patient¬ª.  Apr√®s une petite op√©ration, le PC de Matt s'est allum√© et a fonctionn√© avec un grand disque dur. <br><br>  La veille de la date limite du projet, Matt a presque termin√© sa part du travail.  Il n'avait qu'√† apporter quelques ajouts √† son rapport, puis le copier sur des disquettes et l'envoyer au service des ventes.  Remettant son PC dans le cube et connectant les fils, il alluma l'alimentation et entendit un bruit.  Le PC √©tait mort et ne montrait aucun signe de vie. <br><br>  Apr√®s un appel de panique au service informatique, Gary est de nouveau apparu dans son bureau avec un tournevis.  Ouvrant le bo√Ætier du PC, il a imm√©diatement cri√©: ¬´Attendez une minute!  Avez-vous fait glisser un ordinateur quelque part? " <br><br>  Matt fron√ßa les sourcils.  ¬´Eh bien, oui.  C'est √ßa le truc? " <br><br>  ¬´Oui, bien s√ªr!  Tu n'aurais pas d√ª faire √ßa! ¬ªGary commen√ßa √† maudire.  "Le disque dur a commenc√© √† tra√Æner et a tout court-circuit√© √† l'int√©rieur!" <br><br>  Matt se pencha sur Gary pour voir par lui-m√™me l'int√©rieur de l'ordinateur.  Il a imm√©diatement remarqu√© que le nouveau disque dur √©tait ¬´fix√©¬ª sur une bande. <br><br>  ¬´Arr√™te!  Que <i>tu</i> n'aurais pas d√ª faire √ßa!  Matt d√©signa un morceau de scotch.  "Dois-je contacter votre superviseur au cas o√π?" <br><br>  Le visage de Gary fron√ßa les sourcils.  "Ils ne me donnent pas les attaches n√©cessaires!" <br><br>  "Alors trouve celui qui les a!" <br><br>  Compte tenu du d√©lai imminent, avec la permission du patron, Matt a transf√©r√© sa demande encore plus haut.  Presque imm√©diatement, le ruban adh√©sif a √©t√© remplac√© par du mat√©riel d'origine.  Il n'a jamais compris <i>pourquoi</i> les employ√©s du service informatique n'avaient pas acc√®s √† l'√©quipement n√©cessaire;  il a sugg√©r√© que c'√©tait une id√©e g√©niale d'un idiot d'√©conomiser de l'argent.  Matt ne pouvait que deviner quelles autres improvisations d√©sesp√©r√©es faisaient fonctionner leur infrastructure informatique et combien de temps elles passeraient inaper√ßues si son PC ne se cassait pas. <br><br><h2>  La quatri√®me histoire.  C'est ainsi que PL / SQL affecte votre cerveau. </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[Original]</a> <br><br>  L'√©ternel champion parmi les d√©cisions les plus √©tranges et les plus infructueuses restera pour toujours <em>Oracle</em> .  Aujourd'hui, nous regardons un peu de code PL / SQL. <br><br>  PL / SQL est un langage √©trange, un m√©lange de langage SQL et de proc√©dure (proc√©durale) (langage) orient√© objet coll√© sur le c√¥t√©.  La syntaxe est superbement capable de donner l'impression qu'elle a √©t√© d√©velopp√©e dans les ann√©es 1970, et chaque nouvelle fonction ou changement de langage perp√©tue cette tradition. <br><br>  La structure de chaque module de code PL / SQL est bas√©e sur des <em>blocs</em> .  Chaque bloc est un espace de noms ind√©pendant.  En bref, son anatomie ressemble √† ceci: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> <span class="hljs-comment"><span class="hljs-comment">-- variable declarations go here BEGIN -- code goes here EXCEPTIONS -- exception handling code goes here, using WHEN clauses END;</span></span></code> </pre> <br>  Si vous √©crivez une proc√©dure stock√©e ou un gestionnaire d'√©v√©nements, remplacez le mot cl√© <code>DECLARE</code> par <code>CREATE [OR REPLACE]</code> .  Vous pouvez √©galement imbriquer des blocs dans d'autres blocs, donc vous pouvez souvent voir du code structur√© de cette fa√ßon: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> <span class="hljs-comment"><span class="hljs-comment">--stuff BEGIN --actions END; --more actions END;</span></span></code> </pre> <br>  Oui, assez rapidement, cela commence √† devenir d√©routant.  Et oui, si vous voulez fournir une gestion des erreurs au moins approximativement structur√©e, vous <em>devez</em> commencer √† mettre des blocs les uns dans les autres. <br><br>  La langue et la base de donn√©es ont d'autres fonctionnalit√©s amusantes.  Avant la version 12c, ils n'avaient pas de type de colonne <code>IDENTITY</code> .  Dans les versions pr√©c√©dentes, vous deviez utiliser l'objet <code>SEQUENCE</code> et √©crire des proc√©dures ou des gestionnaires d'√©v√©nements qui effectuent une num√©rotation automatique forc√©e.  En r√®gle g√©n√©rale, l'op√©rateur <code>SELECT INTO‚Ä¶</code> √©tait utilis√© pour attribuer une valeur √† une variable.  Bonus: Oracle SQL n√©cessite <em>toujours</em> une table √† sp√©cifier dans l'instruction <code>FROM</code> , vous devez donc utiliser une table <code>dual</code> invent√©e, comme ceci: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TRIGGER</span></span> <span class="hljs-string"><span class="hljs-string">"SOME_TABLE_AUTONUMBER"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEFORE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-string"><span class="hljs-string">"SOME_TABLE"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EACH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ROW</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> myseq.nextval <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> :new.id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> dual; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>;</code> </pre> <br>  <code>:new</code> dans ce contexte indique la ligne pour laquelle nous num√©rotons automatiquement.  Dans les anciennes versions d'Oracle, c'√©tait la fa√ßon ¬´habituelle¬ª de cr√©er des colonnes avec une num√©rotation automatique.  <strong>Benoit a</strong> d√©couvert une autre fa√ßon, un peu moins courante, de faire la m√™me op√©ration: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TRIGGER</span></span> <span class="hljs-string"><span class="hljs-string">"SCHEMA1"</span></span>.<span class="hljs-string"><span class="hljs-string">"TABLE1_TRIGGER"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEFORE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-string"><span class="hljs-string">"SCHEMA1"</span></span>.<span class="hljs-string"><span class="hljs-string">"TABLE1"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EACH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ROW</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> pl_error_id table1.error_id%<span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span>; CURSOR get_seq IS <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> table1_seq.nextval <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> dual; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OPEN</span></span> get_seq; FETCH get_seq INTO pl_error_id; IF get_seq%NOTFOUND THEN raise_application_error(-20001, 'Sequence TABLE1_SEQ does not exist'); CLOSE get_seq; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span>; CLOSE get_seq; :new.error_id := pl_error_id; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> table1_trigger;</code> </pre> <br>  Il se passe beaucoup de choses ici.  Tout d'abord, notez que la section <code>DECLARE</code> contient l'instruction <code>CURSOR</code> .  Les curseurs vous permettent de parcourir les enregistrements.  Ils sont tr√®s chers et dans le monde Oracle, c'est une ressource qui doit √™tre lib√©r√©e. <br><br>  Ce gestionnaire d'√©v√©nements (d√©clencheur) utilise un bloc imbriqu√© sans raison.  Il utilise √©galement la variable suppl√©mentaire <code>pl_error_id</code> , qui peut √™tre supprim√©e. <br><br>  Mais la partie vraiment bizarre est le bloc <code>IF get_seq%NOTFOUND</code> .  Tout est assez simple: il v√©rifie la condition que le curseur ne retourne pas de cha√Æne.  Pour ce curseur, cela ne peut pas se produire m√™me <em>th√©oriquement</em> , donc les op√©rations √† l'int√©rieur ne sont jamais effectu√©es.  Une s√©quence renvoie toujours une valeur.  Et c'est <em>bien</em> vu le code qui va plus loin. <br><br>  <code>raise_application_error</code> est un analogue de throw dans Oracle.  Cette instruction remonte la pile de blocs ex√©cutables jusqu'√† ce qu'elle trouve la section <code>EXCEPTIONS</code> pour g√©rer l'erreur.  Notez que nous fermons le curseur <em>apr√®s</em> cette instruction - c'est-√†-dire que nous <em>ne</em> fermons <em>jamais</em> le curseur.  Comme indiqu√© ci-dessus, les curseurs sont chers et Oracle n'en autorise qu'un nombre limit√©. <br><br>  Nous voyons ici un exemple √©trange de la fa√ßon dont un d√©veloppeur essaie de se d√©fendre contre une erreur qui ne peut pas se produire, d'une mani√®re qui conduira √† de nouvelles erreurs au fil du temps. <br><br><h2>  La cinqui√®me histoire.  Connexions crypt√©es doubles </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[Original]</a> <br><br>  La cr√©ation de l'authentification pour l'API Web est une t√¢che <em>difficile</em> , mais elle comporte de <em>nombreuses</em> solutions bien √©tablies.  La chose la plus difficile est en fait de choisir l'une des diff√©rentes options, apr√®s quoi il suffit d'ajouter simplement un composant. <br><br>  Lorsqu'il est correctement impl√©ment√©, le syst√®me ne d√©pend pas du type de client.  Je peux acc√©der au service via un navigateur, dans un client lourd ou via cURL.  S'il n'est pas correctement mis en ≈ìuvre, vous obtenez ce qui est arriv√© √† <strong>Amira</strong> . <br><br>  Elle a r√©solu le probl√®me de l'extraction des statistiques dont elle avait besoin depuis le backend, mais n'a pas pu d√©terminer la m√©thode d'authentification.  Par cons√©quent, elle a √©tudi√© le code frontal pour comprendre comment il effectue l'authentification: <br><br><pre> <code class="javascript hljs">crypt = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JSEncrypt(); crypt.setPublicKey(<span class="hljs-string"><span class="hljs-string">'&lt;removed&gt;'</span></span>); challenge = <span class="hljs-string"><span class="hljs-string">"&lt;removed&gt;"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doChallengeResponse</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value.replace(<span class="hljs-regexp"><span class="hljs-regexp">/&amp;/g</span></span>, <span class="hljs-string"><span class="hljs-string">'%26'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value.replace(<span class="hljs-regexp"><span class="hljs-regexp">/\\+/g</span></span>, <span class="hljs-string"><span class="hljs-string">'%2B'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value = crypt.encrypt(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.response.value = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value = <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.submit(); }</code> </pre> <br>  D'une part, je peux supposer que ce code est tr√®s ancien, √©tant donn√© le <code>document.loginForm</code> utilis√© pour les interactions avec les √©l√©ments DOM.  D'un autre c√¥t√©, <code>JSEncrypt</code> √©t√© publi√© pour la premi√®re fois en 2013, ce qui nous donne la barre d'√¢ge maximale. <br><br>  Nous transmettons les param√®tres d'acc√®s au backend en soumettant le formulaire, qui, selon le d√©veloppeur du code, a n√©cessit√© un nettoyage - tous les <code>&amp;</code> <code>+</code> dans le mot de passe sont remplac√©s, mais ... cela n'est pas n√©cessaire, car le formulaire doit r√©pondre √† la demande <code>POST</code> et, en outre, <em>nous avons crypt√© les donn√©es</em> . <br><br>  Voici ce que je pense.  Le code <em>est en fait</em> assez ancien.  Le d√©veloppeur l'a copi√© √† partir d'un article sur StackOverflow vers 2005, qui n'utilisait pas le chiffrement et la <code>POST</code> formulaires via <code>POST</code> .  Ann√©e apr√®s ann√©e, de petits changements y ont √©t√© ajout√©s.  mais le m√©canisme sous-jacent n'a jamais chang√©. <br><br>  Amira a v√©rifi√© l'historique et a constat√© que le cryptage n'√©tait pas utilis√© dans la version pr√©c√©dente.      <code>challenge</code> ,    MD5,     <em></em>  ,     ,       . <br><br>     :   ,     ,         ,     ,    cURL      -.          ,    <em>    SSL/TLS</em> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr446714/">https://habr.com/ru/post/fr446714/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr446702/index.html">Et un autre casque bizarre - pour dormir</a></li>
<li><a href="../fr446706/index.html">Requ√™tes parall√®les dans PostgreSQL</a></li>
<li><a href="../fr446708/index.html">Comparaison des syst√®mes de communication spatiale</a></li>
<li><a href="../fr446710/index.html">Quatre vraies histoires de travail avec une architecture de microservices - rapport du Backend United 3 mitap: Kholodets</a></li>
<li><a href="../fr446712/index.html">HTTPS n'est pas toujours aussi s√©curis√© qu'il n'y para√Æt. Vuln√©rabilit√©s trouv√©es dans 5,5% des sites HTTPS</a></li>
<li><a href="../fr446716/index.html">Conscience et argumentation de la fin du monde</a></li>
<li><a href="../fr446718/index.html">Examen des rapports les plus int√©ressants de CodeFest 2019: version de True Engineering</a></li>
<li><a href="../fr446722/index.html">Les tests montreront: comment se pr√©parer √† la mise en ≈ìuvre de Cisco ISE et comprendre les fonctionnalit√©s du syst√®me dont vous avez besoin</a></li>
<li><a href="../fr446724/index.html">Comment les d√©veloppeurs iOS cherchent √† monter la barre avec le cloud computing</a></li>
<li><a href="../fr446726/index.html">Deep Learning en calcul de flux optique</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>