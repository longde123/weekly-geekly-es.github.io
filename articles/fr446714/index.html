<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧛🏻 ⏬ 👧🏿 Curieuses perversions du monde informatique - 4 👋🏻 🅱️ 🧝🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Le site Web Daily WTF recueille depuis 15 ans des histoires drôles, sauvages et / ou tristes du monde informatique. J'ai traduit plusieurs histoires q...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Curieuses perversions du monde informatique - 4</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446714/"><div style="text-align:center;"><img src="https://ic.pics.livejournal.com/egor_23/73280836/1707368/1707368_1000.jpg" alt="image"></div><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Le</a> site Web <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Daily WTF</a> recueille depuis 15 ans des histoires drôles, sauvages et / ou tristes du monde informatique.  J'ai traduit plusieurs histoires qui m'ont paru intéressantes.  Tous les noms et noms d'entreprises ont été modifiés.  Les numéros précédents se trouvent sous l'étiquette « <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">perversions curieuses</a> ». <br><br><h2>  La première histoire.  Fin <s>du</s> mois </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[Original]</a> <br><br>  Si vous demandez à un ingénieur en conception s'il est sécuritaire de traverser un pont, il se fera un plaisir de vous dire à quel point les ponts sont fiables, comment les mathématiques y fonctionnent, dans quelle mesure nous avons progressé en matière de sécurité des bâtiments.  Après avoir parlé avec lui, vous aurez l'impression qu'aucun pont sur Terre ne se désagrègera jamais.  Mais si vous interrogez l'ingénieur en développement logiciel sur les banques, vous serez très probablement horrifié, et avec une probabilité de 50/50 vous convaincre d'investir tout l'argent dans le bitcoin.  Les banques sont connues pour leurs mauvaises décisions lors de la création de logiciels - non pas parce que ces décisions sont dégoûtantes, mais parce que la plupart des gens supposent que les banques sont plus précises et prudentes en matière de sécurité. <br><br>  <b>Kato</b> travaille à Inibank, où un produit commercial appelé T24 est utilisé comme noyau du système bancaire.  Le système T24 est utilisé par des centaines de banques à travers le monde.  Il peut être personnalisé pour une large gamme de solutions bancaires.  Comme avec la plupart des packages personnalisés.  Il y a des programmeurs spécialisés dans l'écriture de code et des consultants qui aident les banques avec les mises à jour majeures. <br><a name="habracut"></a><br>  Le personnel d'Inibank étant occupé, la banque a invité un consultant à participer à un projet spécial.  À la fin de la journée de travail, la banque a effectué le processus d'achèvement, qui est nécessaire pour que tout l'argent aille là où il était dirigé, toutes les données de sortie nécessaires sont recalculées et tous les rapports requis sont exécutés.  Dans les banques, ce processus modifie également la date du système au jour ouvrable suivant.  C'est pourquoi lorsque vous effectuez des opérations bancaires en ligne le dimanche, aucune transaction ne commence à être traitée avant lundi matin.  Le consultant a dû créer un nouveau rapport qui serait exécuté pendant le processus d'achèvement et incluait un traitement supplémentaire si la date correspondait à la fin du mois. <br><br>  Kato a montré au nouveau consultant comment la banque établit des rapports de fin de journée.  «Vous voyez, nous avons des variables globales pour le jour ouvrable précédent, pour aujourd'hui et pour le jour ouvrable suivant.  Ils ont le format YYMMDD pour faciliter leur utilisation. " <br><br>  «Ouais, ouais, j'ai compris.  Je comprends.  Dans quel format sont-ils? " <br><br>  "... Euh ... Je peux seulement supposer que c'est l'année, le mois et le jour." <br><br>  «Ouais, ouais, d'accord.  Super.  Ensuite, je me mets au travail. » <br><br>  Après cette conversation, Kato avait un mauvais pressentiment à ce sujet.  mais il a essayé de se débarrasser de lui.  Le consultant a déclaré que tout était installé et prêt.  Il sait exactement ce qu'il fait, non?  Kato l'a jeté de sa tête et a cessé de s'inquiéter jusqu'à ce que le temps pour la révision du code soit arrivé et qu'il ait trouvé une telle perle: <br><br><pre> <code class="hljs pgsql">TH.DATE = R.DATES(EB.DAT.NEXT.WORKING.DAY)[<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>]:"01" <span class="hljs-keyword"><span class="hljs-keyword">CALL</span></span> CDT(<span class="hljs-string"><span class="hljs-string">'ES00'</span></span>,TH.DATE,"-1C") WTODAY = OCONV(<span class="hljs-type"><span class="hljs-type">DATE</span></span>(),"DY") : FMT(OCONV(<span class="hljs-type"><span class="hljs-type">DATE</span></span>(),"DM"),<span class="hljs-string"><span class="hljs-string">'R%2'</span></span>) : FMT(OCONV(<span class="hljs-type"><span class="hljs-type">DATE</span></span>(),"DD"),<span class="hljs-string"><span class="hljs-string">'R%2'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> TH.DATE EQ WTODAY <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span></code> </pre> <br>  Expliquez brièvement ce qui se passe ici: <br><br><ol><li>  Prenez le jour ouvrable suivant et changez le jour en 01 pour obtenir le premier jour du mois. </li><li>  Nous modifions cette date en soustrayant 1 jour calendaire du calendrier espagnol. </li><li>  Nous prenons la date du serveur et la traduisons au format YYYYMMDD, en appelant la commande Date trois fois. </li><li>  Si la date calculée à l'étape 2 est égale à la date calculée à l'étape 3, démarrez le processus. </li></ol><br>  Eh bien, en fait ... ça marche.  Pour la plupart.  Sauf pour une raison quelconque, la fin de la journée ne se produit pas après minuit l'avant-dernier jour du mois - et ce n'est pas si rare.  Dans ce cas, le code pensera à tort qu'il s'agit du dernier jour du mois et commencera à créer le rapport.  Ce qui va bien avec un autre problème: si la même chose se produit le dernier jour du mois, la création du rapport ne commencera pas par erreur.  Et le meilleur bogue: si le dernier jour du mois s'est avéré être dimanche, le calendrier du serveur ne sera jamais installé dessus, car il saute les jours non ouvrés. <br><br>  En parlant de jours non ouvrés: Inibank étant situé aux USA, il n'y a aucune raison d'utiliser le calendrier espagnol.  Oui, les mois et les semaines seront les mêmes, mais dans le calendrier logiciel espagnol, vous devez spécifier les jours fériés aux États-Unis, sinon le programme continuera de fonctionner.  Enfin, comme si tout cela n'était pas encore suffisant, le triple appel Date signifie qu'il peut y avoir des désaccords lors du démarrage à minuit exactement: la valeur du mois est demandée avant minuit et le lendemain. <br><br>  Kato a ajouté un commentaire, suggérant un moyen de changer le code: <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">IF</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">R</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DATES</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">EB</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DAT</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.TODAY</span></span>)<span class="hljs-selector-attr"><span class="hljs-selector-attr">[5,2]</span></span> # <span class="hljs-selector-tag"><span class="hljs-selector-tag">R</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DATES</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">EB</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DAT</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.LAST</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.WORKING</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DAY</span></span>)<span class="hljs-selector-attr"><span class="hljs-selector-attr">[5,2]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">THEN</span></span></code> </pre> <br>  Cinq minutes plus tard, le consultant s'est rendu à son bureau.  "Que signifie cette modification?" <br><br>  Kato n'était pas d'humeur à discuter à ce moment.  «Votre code est cassé, ami.  Tout cela n'est pas nécessaire. " <br><br>  «Je vois, je vois.  Il s'agit en fait d'un mode opératoire standard pour notre industrie.  Eh bien, d'accord. " <br><br>  Kato en doutait beaucoup, mais haussa simplement les épaules.  «Alors l'industrie a tort.  J'ai tout expliqué dans le commentaire. " <br><br>  "Ouais.  Oui, je l'ai lu.  Mais je vais le relire. »  Et il a disparu aussi soudainement qu'il est apparu. <br><br>  Des modifications ont été apportées, Kato a approuvé le code et le consultant a disparu dans le brouillard. <br><br>  Parfois, allongé dans son lit la nuit, Kato se demandait: le consultant comprenait-il vraiment ce qu'il avait fait de mal, ou acceptait-il simplement de regarder, recevait son chèque et continuait à écrire quelque part un code terrible pour un prix deux fois le salaire de Kato?  Dans les banques où aucun employé ne peut vérifier le code. <br><br>  Mais n'investissez pas tout l'argent dans le bitcoin.  C'est encore pire là-bas. <br><br><h2>  La deuxième histoire.  Comment cela se fait </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[Original]</a> <br><br>  Les gens aiment manger des hot-dogs jusqu'à ce qu'ils découvrent comment ils cuisinent.  La plupart ne demandent pas, car ils ne veulent pas savoir et continuent de manger des hot-dogs.  Lors du développement de logiciels, nous devons parfois demander.  Non seulement pour résoudre des problèmes, mais aussi parce que certains programmeurs ont peur que le logiciel dans leurs voitures, circulant sur l'autoroute à une vitesse de 100 km / h, soit assemblé à partir de bandes et de bâtons.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Toute notre industrie fait mal ses tâches</a> . <br><br>  <strong>Brett a</strong> travaillé comme analyste de systèmes au MedStitute Medical Research Center.  MedStitute a utilisé un logiciel propriétaire appelé MedTech pour stocker et analyser les données.  Les médecins et les chercheurs ont aimé les résultats de MedTech, mais leur collègue Brett Tyree savait comment ils ont été créés. <br><br>  Le logiciel n'avait pas accès au backend, et l'ensemble du processus de développement s'est déroulé dans l'interface graphique "souris programmable".  Cette interface semblait avoir été écrite par une personne qui a étudié la programmation sur des sites de copier-coller des années 90, regardé dix minutes <em>de Jurassic Park</em> et recherché des réponses à StackOverflow jusqu'à ce que quelque chose puisse être compilé.  Le «langage de programmation» a également montré un niveau similaire de réflexion dans la philosophie de conception.  Chacun <em>doit</em> avoir eu un <code>else</code> .  Certains modules ont utilisé des valeurs booléennes, d'autres ont renvoyé des chaînes vides pour indiquer de fausses valeurs.  D'après la documentation, il n'était pas clair dans quelle situation l'un ou l'autre s'est produit.  En fait, chaque <code>if</code> s'est transformée en trois déclarations. <br><br>  Brett avait besoin de commencer une nouvelle étude.  Il était basé sur un ensemble simple de statistiques et des patients groupés utilisant une variable randomisée.  Brett a cherché dans la liste une variable qui pouvait être randomisée, mais ne l'a pas trouvée nécessaire.  Il a suggéré qu'il avait fait une erreur et est retourné quelques écrans pour vérifier son nom en le copiant pour une recherche.  Brett est revenu sur la liste des variables randomisées.  Elle n'était pas là.  Il a examiné de plus près la liste et a remarqué que la liste des variables randomisées contenait des données provenant de champs à choix multiple.  Le champ dont il avait besoin pour randomiser était basé sur un champ calculé. <br><br>  Brett savait que Tyree travaillait sur un autre projet randomisé par champ calculé, il l'a donc contacté à Slack.  «Comment avez-vous codé cette variable aléatoire?  Medtech empêche-t-il cela de se produire? » <br><br>  "Je parle de conférence, je vous rappellerai plus tard", a écrit Tyree. <br><br>  Quelques minutes plus tard, Tyree a appelé Brett. <br><br>  «Vous devez commencer par deux champs.  Disons.  appelons-les <code>$variable_choice</code> , c'est-à-dire une question à choix multiples, et <code>$variable_calced</code> , c'est-à-dire votre champ calculé.  Lorsque vous souhaitez créer une variable qui effectue une sélection aléatoire sur la base d'un champ calculé, vous dites à Medtech que cette variable aléatoire est basée sur <code>$variable_choice</code> .  Ensuite, vous supprimez <code>$variable_choice</code> et renommez <code>$variable_calced</code> en <code>$variable_choice</code> » <br><br>  «Arrêtez, le système vous permet de le faire, mais ne vous permet pas de randomiser les champs calculés d'une autre manière?  Et elle ne le vérifie pas? " <br><br>  "J'espère que rien ne change, et elle ne commence à vérifier cela qu'à la fin de mon projet", a répondu Tyree. <br><br>  «Cette étude devrait s'étaler sur dix ans.  Et sa réussite dépend si les développeurs considèrent cette astuce comme un bug? » <br><br>  «J'ai réussi à ne trouver qu'une telle solution.  Faites-moi savoir si vous trouvez quelque chose de mieux. " <br><br>  Brett n'a pas satisfait un tel hack, et il est retourné à étudier la documentation.  Il a trouvé une «meilleure» solution: vous pouvez créer un champ à choix multiples en lecture seule avec la seule valeur par défaut - la valeur du champ calculé.  Malheureusement, l'utilisateur peut modifier la liste par inadvertance en répondant à une question à choix multiples <em>avant de</em> calculer la valeur du champ calculé. <br><br>  En fin de compte, la seule chose qui restait à Brett était de faire une pause, d'aller à la cafétéria et d'acheter quelques hot-dogs. <br><br><h2>  La troisième histoire.  Portabilité et matériel </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[Original]</a> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/52e/2cb/0c2/52e2cb0c2e0b8465a1b713aa60dfd474.jpg"></div><br>  Il y a plusieurs lunes, lorsque les PC avaient des boîtiers en métal lourd et en plastique, <b>Matt</b> et son collègue ont été invités à évaluer le progiciel pour la prochaine opération du service commercial.  Malheureusement, lui et son collègue ont travaillé dans différents bureaux de la même ville.  À cette époque, les outils de collaboration en ligne efficaces n'existaient pas encore, alors Matt devait régulièrement se rendre dans un autre bureau, emportant un PC avec lui.  Cela signifiait qu'à chaque fois qu'il était nécessaire de déconnecter les câbles périphériques du boîtier 473, de transporter l'ordinateur dans les couloirs et dans les escaliers, de prendre un bus pour se rendre dans un autre bureau, dans lequel il faisait tout cela dans l'ordre inverse.  Parfois, la mauvaise organisation du travail obligeait ce couple à travailler le week-end, ce qui signifie qu'il transportait des machines à la maison. <br><br>  Au cours du processus, le disque dur de 20 Mo de l'ordinateur de Matt a débordé.  De son bureau, il a envoyé une demande au service informatique.  Pour remplir la demande, le technicien de Gary a été nommé, qui après un certain temps est apparu dans le cube de Matt, tenant un nouveau disque dur et un tournevis.  Gary a envoyé à Matt un café pour se concentrer sur son «patient».  Après une petite opération, le PC de Matt s'est allumé et a fonctionné avec un grand disque dur. <br><br>  La veille de la date limite du projet, Matt a presque terminé sa part du travail.  Il n'avait qu'à apporter quelques ajouts à son rapport, puis le copier sur des disquettes et l'envoyer au service des ventes.  Remettant son PC dans le cube et connectant les fils, il alluma l'alimentation et entendit un bruit.  Le PC était mort et ne montrait aucun signe de vie. <br><br>  Après un appel de panique au service informatique, Gary est de nouveau apparu dans son bureau avec un tournevis.  Ouvrant le boîtier du PC, il a immédiatement crié: «Attendez une minute!  Avez-vous fait glisser un ordinateur quelque part? " <br><br>  Matt fronça les sourcils.  «Eh bien, oui.  C'est ça le truc? " <br><br>  «Oui, bien sûr!  Tu n'aurais pas dû faire ça! »Gary commença à maudire.  "Le disque dur a commencé à traîner et a tout court-circuité à l'intérieur!" <br><br>  Matt se pencha sur Gary pour voir par lui-même l'intérieur de l'ordinateur.  Il a immédiatement remarqué que le nouveau disque dur était «fixé» sur une bande. <br><br>  «Arrête!  Que <i>tu</i> n'aurais pas dû faire ça!  Matt désigna un morceau de scotch.  "Dois-je contacter votre superviseur au cas où?" <br><br>  Le visage de Gary fronça les sourcils.  "Ils ne me donnent pas les attaches nécessaires!" <br><br>  "Alors trouve celui qui les a!" <br><br>  Compte tenu du délai imminent, avec la permission du patron, Matt a transféré sa demande encore plus haut.  Presque immédiatement, le ruban adhésif a été remplacé par du matériel d'origine.  Il n'a jamais compris <i>pourquoi</i> les employés du service informatique n'avaient pas accès à l'équipement nécessaire;  il a suggéré que c'était une idée géniale d'un idiot d'économiser de l'argent.  Matt ne pouvait que deviner quelles autres improvisations désespérées faisaient fonctionner leur infrastructure informatique et combien de temps elles passeraient inaperçues si son PC ne se cassait pas. <br><br><h2>  La quatrième histoire.  C'est ainsi que PL / SQL affecte votre cerveau. </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[Original]</a> <br><br>  L'éternel champion parmi les décisions les plus étranges et les plus infructueuses restera pour toujours <em>Oracle</em> .  Aujourd'hui, nous regardons un peu de code PL / SQL. <br><br>  PL / SQL est un langage étrange, un mélange de langage SQL et de procédure (procédurale) (langage) orienté objet collé sur le côté.  La syntaxe est superbement capable de donner l'impression qu'elle a été développée dans les années 1970, et chaque nouvelle fonction ou changement de langage perpétue cette tradition. <br><br>  La structure de chaque module de code PL / SQL est basée sur des <em>blocs</em> .  Chaque bloc est un espace de noms indépendant.  En bref, son anatomie ressemble à ceci: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> <span class="hljs-comment"><span class="hljs-comment">-- variable declarations go here BEGIN -- code goes here EXCEPTIONS -- exception handling code goes here, using WHEN clauses END;</span></span></code> </pre> <br>  Si vous écrivez une procédure stockée ou un gestionnaire d'événements, remplacez le mot clé <code>DECLARE</code> par <code>CREATE [OR REPLACE]</code> .  Vous pouvez également imbriquer des blocs dans d'autres blocs, donc vous pouvez souvent voir du code structuré de cette façon: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> <span class="hljs-comment"><span class="hljs-comment">--stuff BEGIN --actions END; --more actions END;</span></span></code> </pre> <br>  Oui, assez rapidement, cela commence à devenir déroutant.  Et oui, si vous voulez fournir une gestion des erreurs au moins approximativement structurée, vous <em>devez</em> commencer à mettre des blocs les uns dans les autres. <br><br>  La langue et la base de données ont d'autres fonctionnalités amusantes.  Avant la version 12c, ils n'avaient pas de type de colonne <code>IDENTITY</code> .  Dans les versions précédentes, vous deviez utiliser l'objet <code>SEQUENCE</code> et écrire des procédures ou des gestionnaires d'événements qui effectuent une numérotation automatique forcée.  En règle générale, l'opérateur <code>SELECT INTO…</code> était utilisé pour attribuer une valeur à une variable.  Bonus: Oracle SQL nécessite <em>toujours</em> une table à spécifier dans l'instruction <code>FROM</code> , vous devez donc utiliser une table <code>dual</code> inventée, comme ceci: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TRIGGER</span></span> <span class="hljs-string"><span class="hljs-string">"SOME_TABLE_AUTONUMBER"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEFORE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-string"><span class="hljs-string">"SOME_TABLE"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EACH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ROW</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> myseq.nextval <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> :new.id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> dual; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>;</code> </pre> <br>  <code>:new</code> dans ce contexte indique la ligne pour laquelle nous numérotons automatiquement.  Dans les anciennes versions d'Oracle, c'était la façon «habituelle» de créer des colonnes avec une numérotation automatique.  <strong>Benoit a</strong> découvert une autre façon, un peu moins courante, de faire la même opération: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TRIGGER</span></span> <span class="hljs-string"><span class="hljs-string">"SCHEMA1"</span></span>.<span class="hljs-string"><span class="hljs-string">"TABLE1_TRIGGER"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEFORE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-string"><span class="hljs-string">"SCHEMA1"</span></span>.<span class="hljs-string"><span class="hljs-string">"TABLE1"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EACH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ROW</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> pl_error_id table1.error_id%<span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span>; CURSOR get_seq IS <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> table1_seq.nextval <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> dual; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OPEN</span></span> get_seq; FETCH get_seq INTO pl_error_id; IF get_seq%NOTFOUND THEN raise_application_error(-20001, 'Sequence TABLE1_SEQ does not exist'); CLOSE get_seq; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span>; CLOSE get_seq; :new.error_id := pl_error_id; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> table1_trigger;</code> </pre> <br>  Il se passe beaucoup de choses ici.  Tout d'abord, notez que la section <code>DECLARE</code> contient l'instruction <code>CURSOR</code> .  Les curseurs vous permettent de parcourir les enregistrements.  Ils sont très chers et dans le monde Oracle, c'est une ressource qui doit être libérée. <br><br>  Ce gestionnaire d'événements (déclencheur) utilise un bloc imbriqué sans raison.  Il utilise également la variable supplémentaire <code>pl_error_id</code> , qui peut être supprimée. <br><br>  Mais la partie vraiment bizarre est le bloc <code>IF get_seq%NOTFOUND</code> .  Tout est assez simple: il vérifie la condition que le curseur ne retourne pas de chaîne.  Pour ce curseur, cela ne peut pas se produire même <em>théoriquement</em> , donc les opérations à l'intérieur ne sont jamais effectuées.  Une séquence renvoie toujours une valeur.  Et c'est <em>bien</em> vu le code qui va plus loin. <br><br>  <code>raise_application_error</code> est un analogue de throw dans Oracle.  Cette instruction remonte la pile de blocs exécutables jusqu'à ce qu'elle trouve la section <code>EXCEPTIONS</code> pour gérer l'erreur.  Notez que nous fermons le curseur <em>après</em> cette instruction - c'est-à-dire que nous <em>ne</em> fermons <em>jamais</em> le curseur.  Comme indiqué ci-dessus, les curseurs sont chers et Oracle n'en autorise qu'un nombre limité. <br><br>  Nous voyons ici un exemple étrange de la façon dont un développeur essaie de se défendre contre une erreur qui ne peut pas se produire, d'une manière qui conduira à de nouvelles erreurs au fil du temps. <br><br><h2>  La cinquième histoire.  Connexions cryptées doubles </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[Original]</a> <br><br>  La création de l'authentification pour l'API Web est une tâche <em>difficile</em> , mais elle comporte de <em>nombreuses</em> solutions bien établies.  La chose la plus difficile est en fait de choisir l'une des différentes options, après quoi il suffit d'ajouter simplement un composant. <br><br>  Lorsqu'il est correctement implémenté, le système ne dépend pas du type de client.  Je peux accéder au service via un navigateur, dans un client lourd ou via cURL.  S'il n'est pas correctement mis en œuvre, vous obtenez ce qui est arrivé à <strong>Amira</strong> . <br><br>  Elle a résolu le problème de l'extraction des statistiques dont elle avait besoin depuis le backend, mais n'a pas pu déterminer la méthode d'authentification.  Par conséquent, elle a étudié le code frontal pour comprendre comment il effectue l'authentification: <br><br><pre> <code class="javascript hljs">crypt = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JSEncrypt(); crypt.setPublicKey(<span class="hljs-string"><span class="hljs-string">'&lt;removed&gt;'</span></span>); challenge = <span class="hljs-string"><span class="hljs-string">"&lt;removed&gt;"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doChallengeResponse</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value.replace(<span class="hljs-regexp"><span class="hljs-regexp">/&amp;/g</span></span>, <span class="hljs-string"><span class="hljs-string">'%26'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value.replace(<span class="hljs-regexp"><span class="hljs-regexp">/\\+/g</span></span>, <span class="hljs-string"><span class="hljs-string">'%2B'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value = crypt.encrypt(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.response.value = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value = <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.submit(); }</code> </pre> <br>  D'une part, je peux supposer que ce code est très ancien, étant donné le <code>document.loginForm</code> utilisé pour les interactions avec les éléments DOM.  D'un autre côté, <code>JSEncrypt</code> été publié pour la première fois en 2013, ce qui nous donne la barre d'âge maximale. <br><br>  Nous transmettons les paramètres d'accès au backend en soumettant le formulaire, qui, selon le développeur du code, a nécessité un nettoyage - tous les <code>&amp;</code> <code>+</code> dans le mot de passe sont remplacés, mais ... cela n'est pas nécessaire, car le formulaire doit répondre à la demande <code>POST</code> et, en outre, <em>nous avons crypté les données</em> . <br><br>  Voici ce que je pense.  Le code <em>est en fait</em> assez ancien.  Le développeur l'a copié à partir d'un article sur StackOverflow vers 2005, qui n'utilisait pas le chiffrement et la <code>POST</code> formulaires via <code>POST</code> .  Année après année, de petits changements y ont été ajoutés.  mais le mécanisme sous-jacent n'a jamais changé. <br><br>  Amira a vérifié l'historique et a constaté que le cryptage n'était pas utilisé dans la version précédente.      <code>challenge</code> ,    MD5,     <em></em>  ,     ,       . <br><br>     :   ,     ,         ,     ,    cURL      -.          ,    <em>    SSL/TLS</em> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr446714/">https://habr.com/ru/post/fr446714/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr446702/index.html">Et un autre casque bizarre - pour dormir</a></li>
<li><a href="../fr446706/index.html">Requêtes parallèles dans PostgreSQL</a></li>
<li><a href="../fr446708/index.html">Comparaison des systèmes de communication spatiale</a></li>
<li><a href="../fr446710/index.html">Quatre vraies histoires de travail avec une architecture de microservices - rapport du Backend United 3 mitap: Kholodets</a></li>
<li><a href="../fr446712/index.html">HTTPS n'est pas toujours aussi sécurisé qu'il n'y paraît. Vulnérabilités trouvées dans 5,5% des sites HTTPS</a></li>
<li><a href="../fr446716/index.html">Conscience et argumentation de la fin du monde</a></li>
<li><a href="../fr446718/index.html">Examen des rapports les plus intéressants de CodeFest 2019: version de True Engineering</a></li>
<li><a href="../fr446722/index.html">Les tests montreront: comment se préparer à la mise en œuvre de Cisco ISE et comprendre les fonctionnalités du système dont vous avez besoin</a></li>
<li><a href="../fr446724/index.html">Comment les développeurs iOS cherchent à monter la barre avec le cloud computing</a></li>
<li><a href="../fr446726/index.html">Deep Learning en calcul de flux optique</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>