<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üé† üà∫ üññüèæ Les 10 erreurs de framework Spring les plus courantes üêÄ üßëüèø‚Äçü§ù‚Äçüßëüèæ üî≥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, Habr! Je vous pr√©sente la traduction de l'article ¬´Top 10 des erreurs de cadre printani√®res les plus courantes¬ª de Toni Kukurin. 

 Spring es...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Les 10 erreurs de framework Spring les plus courantes</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/465897/"> Bonjour, Habr!  Je vous pr√©sente la traduction de l'article <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">¬´Top 10 des erreurs de cadre printani√®res les plus courantes¬ª</a> de Toni Kukurin. <br><br>  Spring est probablement l'un des frameworks Java les plus populaires, ainsi qu'une puissante b√™te √† apprivoiser.  Bien que ses concepts de base soient assez faciles √† comprendre, il faut du temps et des efforts pour devenir un d√©veloppeur Spring fort. <br><br>  Dans cet article, nous examinerons certaines des erreurs les plus courantes dans Spring, en particulier celles li√©es aux applications Web et √† Spring Boot.  Comme indiqu√© sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le site Web de Spring Boot</a> , il impose une id√©e de la fa√ßon dont les applications industrielles doivent √™tre construites, donc dans cet article, nous allons essayer de d√©montrer cette id√©e et donner un aper√ßu de quelques conseils qui s'int√©greront bien dans le processus de d√©veloppement d'applications Web Spring Boot standard. <br>  Si vous n'√™tes pas tr√®s familier avec Spring Boot, mais souhaitez tout de m√™me essayer certaines des choses mentionn√©es, j'ai cr√©√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le r√©f√©rentiel GitHub qui accompagne cet article</a> .  Si vous sentez que vous √™tes perdu quelque part dans l'article, je vous recommande de cloner le r√©f√©rentiel sur votre ordinateur local et de jouer avec le code. <br><a name="habracut"></a><br><h2>  Erreur courante n ¬∞ 1: descendre trop bas </h2><br>  Nous rencontrons cette erreur courante car le syndrome <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">¬´pas invent√© ici¬ª</a> est assez courant dans le monde du d√©veloppement logiciel. Les sympt√¥mes incluent la r√©√©criture r√©guli√®re de fragments de code fr√©quemment utilis√©, et de nombreux d√©veloppeurs semblent en souffrir. <br><br>  Bien que la compr√©hension de l'int√©rieur d'une biblioth√®que particuli√®re et de son impl√©mentation soit pour la plupart bonne et n√©cessaire (et peut √™tre un excellent processus d'apprentissage), la r√©solution constante des m√™mes d√©tails d'impl√©mentation de bas niveau nuit √† votre d√©veloppement en tant qu'ing√©nieur logiciel.  Il y a une raison pour laquelle des abstractions et des cadres tels que Spring existent qui vous s√©parent strictement de l'artisanat r√©p√©titif et vous permettent de vous concentrer sur des d√©tails de plus haut niveau - vos objets de domaine et votre logique m√©tier. <br><br>  Par cons√©quent, utilisez des abstractions - la prochaine fois que vous rencontrez un probl√®me sp√©cifique, effectuez d'abord une recherche rapide et d√©terminez si la biblioth√®que qui r√©sout ce probl√®me est int√©gr√©e dans Spring.  Actuellement, vous √™tes le plus susceptible de trouver une solution appropri√©e existante.  Comme exemple de biblioth√®que utile, dans les exemples du reste de cet article, j'utiliserai les annotations <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">du projet Lombok</a> .  Lombok est utilis√© comme g√©n√©rateur de code de mod√®le et le d√©veloppeur paresseux en vous ne devrait pas avoir de probl√®mes avec l'id√©e de cette biblioth√®que.  Par exemple, regardez √† quoi ressemble un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">¬´bean Java standard¬ª</a> avec Lombok: <br><br><pre><code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Getter</span></span> <span class="hljs-meta"><span class="hljs-meta">@Setter</span></span> <span class="hljs-meta"><span class="hljs-meta">@NoArgsConstructor</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Bean</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serializable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> firstBeanProperty; String secondBeanProperty; }</code> </pre> <br>  Comme vous pouvez l'imaginer, le code ci-dessus se compile en: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Bean</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serializable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> firstBeanProperty; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String secondBeanProperty; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getFirstBeanProperty</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.firstBeanProperty; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSecondBeanProperty</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.secondBeanProperty; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setFirstBeanProperty</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> firstBeanProperty)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.firstBeanProperty = firstBeanProperty; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setSecondBeanProperty</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String secondBeanProperty)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.secondBeanProperty = secondBeanProperty; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Bean</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } }</code> </pre> <br>  Cependant, notez que vous devrez probablement installer le plugin si vous avez l'intention d'utiliser Lombok avec votre IDE.  La version du plugin pour IntelliJ IDEA peut √™tre trouv√©e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br><h2>  Erreur courante n ¬∞ 2: fuite de contenu interne </h2><br>  R√©v√©ler votre structure interne est toujours une mauvaise id√©e, car cela cr√©e une rigidit√© dans la conception du service et, par cons√©quent, contribue √† une mauvaise pratique de codage.  Une ¬´fuite¬ª de contenu interne se manifeste dans le fait que la structure de la base de donn√©es est accessible √† partir de certains points de terminaison API.  Par exemple, supposons que le POJO ("Plain Old Java Object") repr√©sente une table dans votre base de donn√©es: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Entity</span></span> <span class="hljs-meta"><span class="hljs-meta">@NoArgsConstructor</span></span> <span class="hljs-meta"><span class="hljs-meta">@Getter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentEntity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Id</span></span> <span class="hljs-meta"><span class="hljs-meta">@GeneratedValue</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Integer id; <span class="hljs-meta"><span class="hljs-meta">@Column</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TopTalentEntity</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name = name; } }</code> </pre> <br>  Supposons qu'il existe un point de terminaison qui doit acc√©der aux donn√©es TopTalentEntity.  Peu importe √† quel point il est tentant de retourner des instances TopTalentEntity, une solution plus flexible serait de cr√©er une nouvelle classe pour afficher les donn√©es TopTalentEntity sur le point de terminaison API: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@AllArgsConstructor</span></span> <span class="hljs-meta"><span class="hljs-meta">@NoArgsConstructor</span></span> <span class="hljs-meta"><span class="hljs-meta">@Getter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentData</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; }</code> </pre> <br>  Ainsi, apporter des modifications au backend de la base de donn√©es ne n√©cessitera aucune modification suppl√©mentaire de la couche de service.  Pensez √† ce qui se passe si vous ajoutez un champ de mot de passe √† TopTalentEntity pour stocker les hachages de mot de passe utilisateur dans la base de donn√©es - sans connecteur tel que TopTalentData, si vous oubliez de changer le service, le frontend affichera accidentellement des informations secr√®tes tr√®s ind√©sirables! <br><br><h2>  Erreur courante # 3: Absence de s√©paration des t√¢ches </h2><br>  √Ä mesure que votre application se d√©veloppe, l'organisation de votre code devient un probl√®me de plus en plus important.  Ironiquement, la plupart des bons principes de d√©veloppement de logiciels commencent √† √™tre viol√©s partout - en particulier dans les cas o√π peu d'attention est accord√©e √† la conception de l'architecture de l'application.  L'une des erreurs les plus courantes que rencontrent les d√©veloppeurs est de m√©langer les responsabilit√©s du code, et c'est tr√®s facile √† faire! <br><br>  Ce qui viole g√©n√©ralement le principe de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">s√©paration des fonctions</a> est simplement ¬´l'ajout¬ª de nouvelles fonctionnalit√©s aux classes existantes.  Bien s√ªr, c'est une excellente solution √† court terme (pour les d√©butants, elle n√©cessite moins de frappe), mais cela deviendra in√©vitablement un probl√®me √† l'avenir, que ce soit pendant les tests, la maintenance ou quelque part entre les deux.  Consid√©rez le contr√¥leur suivant, qui renvoie TopTalentData √† partir de son r√©f√©rentiel: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@RestController</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> TopTalentRepository topTalentRepository; <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(<span class="hljs-string"><span class="hljs-string">"/toptal/get"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> List&lt;TopTalentData&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTopTalent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> topTalentRepository.findAll() .stream() .map(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>::entityToData) .collect(Collectors.toList()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> TopTalentData </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">entityToData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(TopTalentEntity topTalentEntity)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TopTalentData(topTalentEntity.getName()); } }</code> </pre> <br>  Au d√©but, il n'est pas visible que quelque chose ne va pas avec ce morceau de code.  Il fournit une liste TopTalentData qui est extraite des instances TopTalentEntity.  Cependant, si vous regardez attentivement, nous verrons qu'en fait TopTalentController fait quelques choses ici.  √Ä savoir: il mappe les demandes pour un point de terminaison sp√©cifique, r√©cup√®re les donn√©es du r√©f√©rentiel et convertit les entit√©s obtenues √† partir de TopTalentRepository dans un autre format.  Une solution ¬´plus propre¬ª serait de diviser ces responsabilit√©s en leurs propres classes.  Cela pourrait ressembler √† ceci: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@RestController</span></span> <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(<span class="hljs-string"><span class="hljs-string">"/toptal"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@AllArgsConstructor</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> TopTalentService topTalentService; <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(<span class="hljs-string"><span class="hljs-string">"/get"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> List&lt;TopTalentData&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTopTalent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> topTalentService.getTopTalent(); } } <span class="hljs-meta"><span class="hljs-meta">@AllArgsConstructor</span></span> <span class="hljs-meta"><span class="hljs-meta">@Service</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> TopTalentRepository topTalentRepository; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> TopTalentEntityConverter topTalentEntityConverter; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> List&lt;TopTalentData&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTopTalent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> topTalentRepository.findAll() .stream() .map(topTalentEntityConverter::toResponse) .collect(Collectors.toList()); } } <span class="hljs-meta"><span class="hljs-meta">@Component</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentEntityConverter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> TopTalentData </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toResponse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(TopTalentEntity topTalentEntity)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TopTalentData(topTalentEntity.getName()); } }</code> </pre> <br>  Un avantage suppl√©mentaire de cette hi√©rarchie est qu'elle nous permet de d√©terminer o√π se trouve la fonctionnalit√© en v√©rifiant simplement le nom de la classe.  De plus, pendant les tests, nous pouvons facilement remplacer n'importe laquelle des classes par une impl√©mentation fictive, si n√©cessaire. <br><br><h2>  Erreur courante n ¬∞ 4: incoh√©rence et mauvaise gestion des erreurs </h2><br>  Le sujet de la coh√©rence n'est pas n√©cessairement exclusif √† Spring (ou Java, d'ailleurs), mais c'est toujours un aspect important √† prendre en compte lorsque vous travaillez sur des projets Spring.  Alors que le style d'√©criture du code peut faire l'objet de discussions (et c'est g√©n√©ralement une question d'accord sur l'√©quipe ou dans toute l'entreprise), la pr√©sence d'une norme commune est d'une grande aide dans les performances.  Cela est particuli√®rement vrai pour les √©quipes de plusieurs personnes.  La coh√©rence permet de transmettre du code sans frais de maintenance ni explication d√©taill√©e des responsabilit√©s des diff√©rentes classes. <br><br>  Envisagez un projet Spring avec divers fichiers de configuration, services et contr√¥leurs.  √âtant s√©mantiquement coh√©rent dans leur d√©nomination, une structure facilement consultable est cr√©√©e dans laquelle tout nouveau d√©veloppeur peut contr√¥ler la fa√ßon de travailler avec le code: par exemple, le suffixe Config est ajout√© aux classes de configuration, le suffixe Service aux services et le suffixe Controller aux contr√¥leurs. <br><br>  √âtroitement li√©e au th√®me de la coh√©rence, la gestion des erreurs c√¥t√© serveur m√©rite une attention particuli√®re.  Si vous avez d√©j√† d√ª g√©rer des r√©ponses d'exception √† partir d'une API mal √©crite, vous savez probablement pourquoi il peut √™tre difficile d'analyser les exceptions, et il est encore plus difficile de d√©terminer la raison pour laquelle ces exceptions se sont produites √† l'origine. <br><br>  En tant que d√©veloppeur d'API, vous souhaitez id√©alement couvrir tous les points de terminaison utilisateur et les traduire dans un format d'erreur commun.  Cela signifie g√©n√©ralement que vous avez un code d'erreur et une description communs, et pas seulement une excuse sous la forme de: a) renvoyer le message ¬´500 Internal Server Error¬ª ou b) simplement r√©initialiser la trace de la pile √† l'utilisateur (ce qui devrait √™tre √©vit√© √† tout prix, car il montre vos entrailles en plus de la complexit√© du traitement c√¥t√© client). <br>  Un exemple de format de r√©ponse d'erreur courant pourrait √™tre: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ErrorResponse</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Integer errorCode; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String errorMessage; }</code> </pre> <br>  Quelque chose de similaire se trouve g√©n√©ralement dans la plupart des API populaires et fonctionne g√©n√©ralement bien, car il peut √™tre document√© facilement et syst√©matiquement.  Vous pouvez traduire des exceptions dans ce format en fournissant la m√©thode avec l'annotation @ExceptionHandler (un exemple d'annotation est donn√© dans Common Mistake # 6). <br><br><h2>  Erreur courante # 5: multithreading incorrect </h2><br>  Qu'il soit pr√©sent dans les applications de bureau ou Web, dans Spring ou non dans Spring, le multithreading peut √™tre une t√¢che intimidante.  Les probl√®mes caus√©s par l'ex√©cution de programmes parall√®les sont √©vasifs et souvent extr√™mement difficiles √† d√©boguer - en fait, en raison de la nature du probl√®me, une fois que vous comprenez que vous traitez le probl√®me d'ex√©cution parall√®le, vous devez probablement abandonner compl√®tement le d√©bogueur et d√©marrer v√©rifiez votre code manuellement jusqu'√† ce que vous trouviez la cause de l'erreur.  Malheureusement, pour r√©soudre de tels probl√®mes, il n'y a pas de solution de mod√®le.  Selon le cas sp√©cifique, vous devrez √©valuer la situation puis attaquer le probl√®me sous un angle que vous consid√©rez comme le meilleur. <br><br>  Id√©alement, bien s√ªr, vous souhaitez √©viter compl√®tement les bogues multithreads.  Encore une fois, il n'y a pas d'approche unique pour cela, mais voici quelques consid√©rations pratiques pour le d√©bogage et la pr√©vention des erreurs de multithreading: <br><br><h3>  √âvitez le statut global </h3><br>  Tout d'abord, souvenez-vous toujours du probl√®me de ¬´l'√©tat global¬ª.  Si vous cr√©ez une application multithread, absolument tout ce qui peut √™tre chang√© globalement doit √™tre soigneusement surveill√© et, si possible, compl√®tement supprim√©.  S'il y a une raison pour laquelle la variable globale doit rester modifiable, utilisez soigneusement la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">synchronisation</a> et surveillez les performances de votre application pour confirmer qu'elle ne ralentit pas en raison de nouvelles p√©riodes d'attente. <br><br><h3>  √âvitez la mutabilit√© </h3><br>  Cela d√©coule directement de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">programmation fonctionnelle</a> et, selon la POO, indique que la volatilit√© de classe et le changement d'√©tat doivent √™tre √©vit√©s.  En bref, ce qui pr√©c√®de signifie la pr√©sence de poseurs et de champs finaux priv√©s dans toutes les classes du mod√®le.  Leurs valeurs ne changent que pendant la construction.  Ainsi, vous pouvez √™tre s√ªr qu'il n'y aura aucun probl√®me dans la course aux ressources et que l'acc√®s aux propri√©t√©s de l'objet fournira toujours les valeurs correctes. <br><br><h3>  Consigner les donn√©es critiques </h3><br>  √âvaluez o√π votre application peut causer des probl√®mes et pr√©-enregistrez toutes les donn√©es importantes.  Si une erreur se produit, vous serez reconnaissant des informations sur les demandes re√ßues et vous pourrez mieux comprendre pourquoi votre application se comporte mal.  Encore une fois, il convient de noter que la journalisation augmente les E / S de fichiers, vous ne devez donc pas en abuser, car cela peut s√©rieusement affecter les performances de votre application. <br><br><h3>  R√©utiliser les impl√©mentations existantes </h3><br>  Chaque fois que vous devez cr√©er vos propres threads (par exemple, pour effectuer des requ√™tes asynchrones vers divers services), r√©utilisez les impl√©mentations s√©curis√©es existantes, plut√¥t que de cr√©er vos propres solutions.  Pour la plupart, cela signifierait utiliser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ExecutorServices</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CompletableFutures</a> dans le style fonctionnel soign√© de Java 8 pour cr√©er des threads.  Spring permet √©galement le traitement des demandes asynchrones via la classe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DeferredResult</a> . <br><br><h2>  Erreur courante # 6: ne pas utiliser la validation bas√©e sur les annotations </h2><br>  Imaginons que notre service TopTalent, mentionn√© ci-dessus, ait besoin d'un point de terminaison pour ajouter de nouveaux super talents.  De plus, supposons que pour une tr√®s bonne raison, chaque nouveau nom doit contenir exactement 10 caract√®res.  Une fa√ßon de proc√©der pourrait √™tre la suivante: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(<span class="hljs-string"><span class="hljs-string">"/put"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addTopTalent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@RequestBody TopTalentData topTalentData)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> nameNonExistentOrHasInvalidLength = Optional.ofNullable(topTalentData) .map(TopTalentData::getName) .map(name -&gt; name.length() == <span class="hljs-number"><span class="hljs-number">10</span></span>) .orElse(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (nameNonExistentOrInvalidLength) { <span class="hljs-comment"><span class="hljs-comment">// throw some exception } topTalentService.addTopTalent(topTalentData); }</span></span></code> </pre> <br>  Cependant, ce qui pr√©c√®de (en plus d'√™tre mal con√ßu) n'est pas vraiment une solution ¬´propre¬ª.  Nous v√©rifions plus d'un type de validit√© (√† savoir que TopTalentData n'est pas nul et que TopTalentData.name n'est pas nul et que TopTalentData.name est de 10 caract√®res) et l√®ve √©galement une exception si les donn√©es ne sont pas valides. <br><br>  Cela peut √™tre fait beaucoup plus proprement en utilisant le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">validateur Hibernate</a> avec Spring.  Tout d'abord, nous r√©√©crivons la m√©thode addTopTalent pour prendre en charge la validation: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(<span class="hljs-string"><span class="hljs-string">"/put"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addTopTalent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@Valid @NotNull @RequestBody TopTalentData topTalentData)</span></span></span><span class="hljs-function"> </span></span>{ topTalentService.addTopTalent(topTalentData); } <span class="hljs-meta"><span class="hljs-meta">@ExceptionHandler</span></span> <span class="hljs-meta"><span class="hljs-meta">@ResponseStatus</span></span>(HttpStatus.BAD_REQUEST) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ErrorResponse </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handleInvalidTopTalentDataException</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MethodArgumentNotValidException methodArgumentNotValidException)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// handle validation exception }</span></span></code> </pre> <br>  De plus, nous devons indiquer quelle propri√©t√© nous voulons v√©rifier dans la classe TopTalentData: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentData</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Length</span></span>(min = <span class="hljs-number"><span class="hljs-number">10</span></span>, max = <span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-meta"><span class="hljs-meta">@NotNull</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; }</code> </pre> <br>  Spring va maintenant intercepter la demande et la v√©rifier avant d'appeler la m√©thode - il n'est pas n√©cessaire d'utiliser des tests manuels suppl√©mentaires. <br><br>  Une autre fa√ßon de r√©aliser la m√™me chose est de cr√©er nos propres annotations.  Bien que les annotations personnalis√©es ne soient g√©n√©ralement utilis√©es que lorsque vos besoins d√©passent l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ensemble de constantes int√©gr√©es Hibernate</a> , pour cet exemple, imaginons que les annotations de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">longueur</a> n'existent pas.  Vous devez cr√©er un validateur qui v√©rifie la longueur d'une cha√Æne en cr√©ant deux classes suppl√©mentaires, une pour la v√©rification et une pour l'annotation des propri√©t√©s: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Target</span></span>({ElementType.METHOD, ElementType.FIELD, ElementType.PARAMETER}) <span class="hljs-meta"><span class="hljs-meta">@Retention</span></span>(RetentionPolicy.RUNTIME) <span class="hljs-meta"><span class="hljs-meta">@Documented</span></span> <span class="hljs-meta"><span class="hljs-meta">@Constraint</span></span>(validatedBy = { MyAnnotationValidator.class }) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-meta"><span class="hljs-meta">@interface</span></span> MyAnnotation { <span class="hljs-function"><span class="hljs-function">String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">default</span></span></span><span class="hljs-function"> "String length does not match expected"</span></span>; Class&lt;?&gt;[] groups() <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> {}; Class&lt;? extends Payload&gt;[] payload() <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> {}; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">value</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; } <span class="hljs-meta"><span class="hljs-meta">@Component</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyAnnotationValidator</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ConstraintValidator</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyAnnotation</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">String</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> expectedLength; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initialize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MyAnnotation myAnnotation)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.expectedLength = myAnnotation.value(); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isValid</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String s, ConstraintValidatorContext constraintValidatorContext)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> || s.length() == <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.expectedLength; } }</code> </pre> <br>  Notez que dans ces cas, les meilleures pratiques pour la s√©paration des t√¢ches n√©cessitent que vous marquiez la propri√©t√© comme valide si elle est nulle (s == null dans la m√©thode isValid), puis utilisez l'annotation <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">NotNull</a> s'il s'agit d'une exigence suppl√©mentaire pour la propri√©t√©: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentData</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@MyAnnotation</span></span>(value = <span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-meta"><span class="hljs-meta">@NotNull</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; }</code> </pre> <br><h2>  Erreur courante # 7: utilisation de la configuration XML (fixe) </h2><br>  Bien que XML soit n√©cessaire pour les versions pr√©c√©dentes de Spring, la plupart de la configuration peut actuellement se faire exclusivement avec du code Java / des annotations.  Les configurations XML repr√©sentent simplement un passe-partout suppl√©mentaire et inutile. <br>  Cet article (et le r√©f√©rentiel GitHub qui l'accompagne) utilise des annotations pour configurer Spring et Spring sait quels beans il doit se connecter car le package racine a √©t√© annot√© √† l'aide de l'annotation compos√©e @SpringBootApplication, par exemple: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@SpringBootApplication</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Application</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ SpringApplication.run(Application.class, args); } }</code> </pre> <br>  Cette annotation composite (vous pouvez en savoir plus √† ce sujet dans la documentation <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Spring</a> ) donne juste √† Spring un indice sur les packages √† analyser pour extraire les beans.  Dans notre cas particulier, cela signifie que les classes suivantes seront utilis√©es pour connecter les beans, en commen√ßant par le package de niveau sup√©rieur (co.kukurin): <br><br><ul><li> <code>@Component (TopTalentConverter, MyAnnotationValidator) @RestController (TopTalentController) @Repository (TopTalentRepository) @Service (TopTalentService)</code> </li> <li> <code>@Component (TopTalentConverter, MyAnnotationValidator) @RestController (TopTalentController) @Repository (TopTalentRepository) @Service (TopTalentService)</code> </li> <li> <code>@Component (TopTalentConverter, MyAnnotationValidator) @RestController (TopTalentController) @Repository (TopTalentRepository) @Service (TopTalentService)</code> </li> <li> <code>@Component (TopTalentConverter, MyAnnotationValidator) @RestController (TopTalentController) @Repository (TopTalentRepository) @Service (TopTalentService)</code> </li> </ul><br>  Si nous avions des classes suppl√©mentaires annot√©es avec @Configuration, elles seraient √©galement v√©rifi√©es pour la configuration Java. <br><br><h2>  Erreur courante num√©ro 8: oublier les profils </h2><br>  Le probl√®me qui se pose souvent lors du d√©veloppement de serveurs est la diff√©rence entre diff√©rents types de configurations, g√©n√©ralement des configurations industrielles et de d√©veloppement.  Au lieu de modifier manuellement les diff√©rents param√®tres de configuration √† chaque fois que vous passez du test au d√©ploiement d'application, un moyen plus efficace serait d'utiliser des profils. <br><br>  Consid√©rez le cas lorsque vous utilisez la base de donn√©es en m√©moire pour le d√©veloppement local et la base de donn√©es MySQL dans PROM.  Essentiellement, cela signifie que vous utiliserez diff√©rentes URL et (esp√©rons-le) diff√©rentes informations d'identification pour acc√©der √† chacune d'entre elles.  Voyons comment cela peut √™tre fait avec deux fichiers de configuration diff√©rents: <br><br><h4>  FILE APPLICATION.YAML </h4><br><pre> <code class="plaintext hljs"># set default profile to 'dev' spring.profiles.active: dev # production database details spring.datasource.url: 'jdbc:mysql://localhost:3306/toptal' spring.datasource.username: root spring.datasource.password:</code> </pre> <br><h4>  FILE APPLICATION-DEV.YAML </h4><br><pre> <code class="plaintext hljs">spring.datasource.url: 'jdbc:h2:mem:' spring.datasource.platform: h2</code> </pre> <br>  Apparemment, vous ne voulez pas effectuer accidentellement des actions sur votre base de donn√©es industrielle pendant que vous jouez avec le code, il est donc logique de d√©finir le profil par d√©faut dans dev.  Ensuite, sur le serveur, vous pouvez remplacer manuellement le profil de configuration en sp√©cifiant le param√®tre -Dspring.profiles.active = prod pour la JVM.  De plus, vous pouvez √©galement d√©finir la variable d'environnement OS sur le profil par d√©faut souhait√©. <br><br><h2>  Erreur courante n ¬∞ 9: Incapacit√© d'accepter l'injection de d√©pendance </h2><br>  Une utilisation appropri√©e de l'injection de d√©pendances dans Spring signifie qu'elle vous permet de lier tous vos objets ensemble en analysant toutes les classes de configuration requises;  ceci est utile pour d√©coupler les relations et facilite √©galement les tests.  Au lieu de lier des classes, en faisant quelque chose comme ceci: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> TopTalentService topTalentService; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TopTalentController</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.topTalentService = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TopTalentService(); } }</code> </pre> <br><br>  Nous laissons le printemps faire la reliure pour nous: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> TopTalentService topTalentService; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TopTalentController</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(TopTalentService topTalentService)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.topTalentService = topTalentService; } }</code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Misko Hevery de Google Talk explique en</a> d√©tail les ¬´raisons¬ª de l'injection de d√©pendance. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Voyons</a> plut√¥t comment cela est utilis√© dans la pratique.  Dans la division des responsabilit√©s (Common Mistakes # 3), nous avons cr√©√© des classes de service et de contr√¥leur.  Supposons que nous voulons tester un contr√¥leur en supposant que TopTalentService se comporte correctement.  Nous pouvons ins√©rer un objet factice au lieu de l'impl√©mentation de service r√©elle, en fournissant une classe de configuration distincte: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Configuration</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SampleUnitTestConfig</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> TopTalentService </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">topTalentService</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ TopTalentService topTalentService = Mockito.mock(TopTalentService.class); Mockito.when(topTalentService.getTopTalent()).thenReturn( Stream.of(<span class="hljs-string"><span class="hljs-string">"Mary"</span></span>, <span class="hljs-string"><span class="hljs-string">"Joel"</span></span>) .map(TopTalentData::<span class="hljs-keyword"><span class="hljs-keyword">new</span></span>).collect(Collectors.toList())); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> topTalentService; } }</code> </pre> <br>  Ensuite, nous pouvons incorporer l'objet factice en disant √† Spring d'utiliser SampleUnitTestConfig comme fournisseur de configuration: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@ContextConfiguration</span></span>(classes = { SampleUnitTestConfig.class })</code> </pre> <br>  Ensuite, cela nous permettra d'utiliser la configuration de contexte pour incorporer le bean personnalis√© dans le test unitaire. <br><br><h2>  Erreur courante # 10: manque de tests ou tests incorrects </h2><br>  Malgr√© le fait que l'id√©e des tests unitaires existe depuis longtemps, de nombreux d√©veloppeurs semblent ¬´oublier¬ª de le faire (surtout si cela n'est pas n√©cessaire), ou tout simplement le laisser pour plus tard.  De toute √©vidence, cela n'est pas souhaitable, car les tests doivent non seulement v√©rifier l'exactitude de votre code, mais √©galement servir de documentation sur le comportement de l'application dans diff√©rentes situations. <br><br>  Lorsque vous testez des services Web, vous effectuez rarement des tests unitaires exceptionnellement ¬´propres¬ª, car l'interaction via HTTP n√©cessite g√©n√©ralement d'appeler DispatcherServlet Spring et de regarder ce qui se passe lorsque la HttpServletRequest r√©elle est re√ßue (ce qui en fait un test d'int√©gration, avec par validation, s√©rialisation, etc.).  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">REST assur√©</a> - Java DSL pour tester facilement les services REST sur MockMVC s'est av√©r√© √™tre une solution tr√®s √©l√©gante.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Consid√©rez le fragment de code suivant avec injection de d√©pendance: </font></font><br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@RunWith</span></span>(SpringJUnit4ClassRunner.class) <span class="hljs-meta"><span class="hljs-meta">@ContextConfiguration</span></span>(classes = { Application.class, SampleUnitTestConfig.class }) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RestAssuredTestDemonstration</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> TopTalentController topTalentController; <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">shouldGetMaryAndJoel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// given MockMvcRequestSpecification givenRestAssuredSpecification = RestAssuredMockMvc.given() .standaloneSetup(topTalentController); // when MockMvcResponse response = givenRestAssuredSpecification.when().get("/toptal/get"); // then response.then().statusCode(200); response.then().body("name", hasItems("Mary", "Joel")); } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SampleUnitTestConfig active l'impl√©mentation fictive TopTalentService dans TopTalentController, tandis que toutes les autres classes sont connect√©es √† l'aide de la configuration standard obtenue en analysant les packages ayant des racines dans le package de la classe Application. </font><font style="vertical-align: inherit;">RestAssuredMockMvc est simplement utilis√© pour cr√©er un environnement l√©ger et envoyer une demande GET au point de terminaison / toptal / get.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Devenez un ma√Ætre du printemps </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spring est un framework puissant qui est facile √† d√©marrer, mais qui demande un certain temps et du d√©vouement pour atteindre une ma√Ætrise totale. </font><font style="vertical-align: inherit;">Si vous passez du temps √† vous familiariser avec le framework, cela augmentera certainement votre productivit√© √† long terme et vous aidera finalement √† √©crire du code plus propre et √† devenir un meilleur d√©veloppeur. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous recherchez des ressources suppl√©mentaires, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spring In Action</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est un livre de bonnes pratiques couvrant de nombreux sujets cl√©s de Spring.</font></font><br><br>  <b>√âTIQUETTES</b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Java SpringFramework </font></font><br><br><h2>  Commentaires </h2><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Timothy Schimandle</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Au # 2, je pense que le retour d'un objet de domaine est pr√©f√©rable dans la plupart des cas. Votre exemple d'objet personnalis√© est l'une des nombreuses classes contenant des champs que nous voulons masquer. Mais la grande majorit√© des objets avec lesquels j'ai travaill√© n'ont pas une telle restriction, et l'ajout de la classe dto n'est qu'un code inutile. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans l'ensemble, un bon article. Bon travail. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SPIRITED to Timothy Schimandle</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Je suis totalement d'accord. Il semble qu'une couche suppl√©mentaire de code inutile ait √©t√© ajout√©e, je pense que @JsonIgnore aidera √† ignorer les champs (bien que pr√©sentant des d√©fauts dans les strat√©gies de d√©tection de r√©f√©rentiel par d√©faut), mais dans l'ensemble, c'est un excellent article de blog. Fiers de tr√©bucher ... </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arokiadoss Asirvatham</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mec, Une autre erreur courante pour les d√©butants est: 1) la d√©pendance cyclique et 2) la non-conformit√© avec les doctrines de d√©claration de classe Singleton de base, telles que l'utilisation d'une variable d'instance dans les beans avec une port√©e singleton. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hlodowig</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Concernant le num√©ro 8, je pense que les approches des profils sont tr√®s peu satisfaisantes. </font><font style="vertical-align: inherit;">Voyons voir:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S√©curit√©: certaines personnes disent: si votre r√©f√©rentiel √©tait public, y aurait-il des cl√©s / mots de passe secrets? </font><font style="vertical-align: inherit;">Il en sera tr√®s probablement ainsi, en suivant cette approche. </font><font style="vertical-align: inherit;">Sauf si, bien s√ªr, vous ajoutez des fichiers de configuration √† .gitignore, mais ce n'est pas une option s√©rieuse.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Duplication: chaque fois que j'ai des param√®tres diff√©rents, je dois cr√©er un nouveau fichier de propri√©t√©s, ce qui est assez ennuyeux. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Portabilit√©: je sais que ce n'est qu'un argument JVM, mais z√©ro vaut mieux qu'un. </font><font style="vertical-align: inherit;">Infiniment moins sujet aux erreurs.</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J'ai essay√© de trouver un moyen d'utiliser des variables d'environnement dans mes fichiers de configuration au lieu de ¬´coder en dur¬ª les valeurs, mais jusqu'√† pr√©sent je n'ai pas r√©ussi, je pense que je dois faire plus de recherche. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Excellent article Tony, continuez votre bon travail! </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Traduction termin√©e: tele.gg/middle_java</font></font></b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr465897/">https://habr.com/ru/post/fr465897/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr465885/index.html">Comment devenir un Scrum Master de premier plan et faire vibrer l'√©quipe?</a></li>
<li><a href="../fr465889/index.html">Comment nous avons abord√© l'efficacit√© √©nerg√©tique</a></li>
<li><a href="../fr465891/index.html">Comment trouver un produit ou un nom d'entreprise en utilisant Vepp comme exemple</a></li>
<li><a href="../fr465893/index.html">Summ3r de h4ck 2019. D√©partement d'analyse de la s√©curit√©</a></li>
<li><a href="../fr465895/index.html">Pr√©sentation du programme C ++ Russia 2019 Piter: asynchronie, modules, biblioth√®ques ... et taxi</a></li>
<li><a href="../fr465899/index.html">Le livre "Linux Command Prompt. Le guide complet. 2e int. √©d. "</a></li>
<li><a href="../fr465901/index.html">Que devrait avoir une application de fitness?</a></li>
<li><a href="../fr465903/index.html">Bienvenue au Fujitsu World Tour 2019</a></li>
<li><a href="../fr465905/index.html">Conf√©rence ZeroNights 2019</a></li>
<li><a href="../fr465911/index.html">Acceleration meetup 17/09 Vid√©os et pr√©sentations UPD</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>