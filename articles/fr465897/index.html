<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎠 🈺 🖖🏾 Les 10 erreurs de framework Spring les plus courantes 🐀 🧑🏿‍🤝‍🧑🏾 🔳</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, Habr! Je vous présente la traduction de l'article «Top 10 des erreurs de cadre printanières les plus courantes» de Toni Kukurin. 

 Spring es...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Les 10 erreurs de framework Spring les plus courantes</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/465897/"> Bonjour, Habr!  Je vous présente la traduction de l'article <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">«Top 10 des erreurs de cadre printanières les plus courantes»</a> de Toni Kukurin. <br><br>  Spring est probablement l'un des frameworks Java les plus populaires, ainsi qu'une puissante bête à apprivoiser.  Bien que ses concepts de base soient assez faciles à comprendre, il faut du temps et des efforts pour devenir un développeur Spring fort. <br><br>  Dans cet article, nous examinerons certaines des erreurs les plus courantes dans Spring, en particulier celles liées aux applications Web et à Spring Boot.  Comme indiqué sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le site Web de Spring Boot</a> , il impose une idée de la façon dont les applications industrielles doivent être construites, donc dans cet article, nous allons essayer de démontrer cette idée et donner un aperçu de quelques conseils qui s'intégreront bien dans le processus de développement d'applications Web Spring Boot standard. <br>  Si vous n'êtes pas très familier avec Spring Boot, mais souhaitez tout de même essayer certaines des choses mentionnées, j'ai créé <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le référentiel GitHub qui accompagne cet article</a> .  Si vous sentez que vous êtes perdu quelque part dans l'article, je vous recommande de cloner le référentiel sur votre ordinateur local et de jouer avec le code. <br><a name="habracut"></a><br><h2>  Erreur courante n ° 1: descendre trop bas </h2><br>  Nous rencontrons cette erreur courante car le syndrome <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">«pas inventé ici»</a> est assez courant dans le monde du développement logiciel. Les symptômes incluent la réécriture régulière de fragments de code fréquemment utilisé, et de nombreux développeurs semblent en souffrir. <br><br>  Bien que la compréhension de l'intérieur d'une bibliothèque particulière et de son implémentation soit pour la plupart bonne et nécessaire (et peut être un excellent processus d'apprentissage), la résolution constante des mêmes détails d'implémentation de bas niveau nuit à votre développement en tant qu'ingénieur logiciel.  Il y a une raison pour laquelle des abstractions et des cadres tels que Spring existent qui vous séparent strictement de l'artisanat répétitif et vous permettent de vous concentrer sur des détails de plus haut niveau - vos objets de domaine et votre logique métier. <br><br>  Par conséquent, utilisez des abstractions - la prochaine fois que vous rencontrez un problème spécifique, effectuez d'abord une recherche rapide et déterminez si la bibliothèque qui résout ce problème est intégrée dans Spring.  Actuellement, vous êtes le plus susceptible de trouver une solution appropriée existante.  Comme exemple de bibliothèque utile, dans les exemples du reste de cet article, j'utiliserai les annotations <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">du projet Lombok</a> .  Lombok est utilisé comme générateur de code de modèle et le développeur paresseux en vous ne devrait pas avoir de problèmes avec l'idée de cette bibliothèque.  Par exemple, regardez à quoi ressemble un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">«bean Java standard»</a> avec Lombok: <br><br><pre><code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Getter</span></span> <span class="hljs-meta"><span class="hljs-meta">@Setter</span></span> <span class="hljs-meta"><span class="hljs-meta">@NoArgsConstructor</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Bean</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serializable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> firstBeanProperty; String secondBeanProperty; }</code> </pre> <br>  Comme vous pouvez l'imaginer, le code ci-dessus se compile en: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Bean</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serializable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> firstBeanProperty; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String secondBeanProperty; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getFirstBeanProperty</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.firstBeanProperty; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSecondBeanProperty</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.secondBeanProperty; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setFirstBeanProperty</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> firstBeanProperty)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.firstBeanProperty = firstBeanProperty; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setSecondBeanProperty</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String secondBeanProperty)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.secondBeanProperty = secondBeanProperty; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Bean</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } }</code> </pre> <br>  Cependant, notez que vous devrez probablement installer le plugin si vous avez l'intention d'utiliser Lombok avec votre IDE.  La version du plugin pour IntelliJ IDEA peut être trouvée <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br><h2>  Erreur courante n ° 2: fuite de contenu interne </h2><br>  Révéler votre structure interne est toujours une mauvaise idée, car cela crée une rigidité dans la conception du service et, par conséquent, contribue à une mauvaise pratique de codage.  Une «fuite» de contenu interne se manifeste dans le fait que la structure de la base de données est accessible à partir de certains points de terminaison API.  Par exemple, supposons que le POJO ("Plain Old Java Object") représente une table dans votre base de données: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Entity</span></span> <span class="hljs-meta"><span class="hljs-meta">@NoArgsConstructor</span></span> <span class="hljs-meta"><span class="hljs-meta">@Getter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentEntity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Id</span></span> <span class="hljs-meta"><span class="hljs-meta">@GeneratedValue</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Integer id; <span class="hljs-meta"><span class="hljs-meta">@Column</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TopTalentEntity</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name = name; } }</code> </pre> <br>  Supposons qu'il existe un point de terminaison qui doit accéder aux données TopTalentEntity.  Peu importe à quel point il est tentant de retourner des instances TopTalentEntity, une solution plus flexible serait de créer une nouvelle classe pour afficher les données TopTalentEntity sur le point de terminaison API: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@AllArgsConstructor</span></span> <span class="hljs-meta"><span class="hljs-meta">@NoArgsConstructor</span></span> <span class="hljs-meta"><span class="hljs-meta">@Getter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentData</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; }</code> </pre> <br>  Ainsi, apporter des modifications au backend de la base de données ne nécessitera aucune modification supplémentaire de la couche de service.  Pensez à ce qui se passe si vous ajoutez un champ de mot de passe à TopTalentEntity pour stocker les hachages de mot de passe utilisateur dans la base de données - sans connecteur tel que TopTalentData, si vous oubliez de changer le service, le frontend affichera accidentellement des informations secrètes très indésirables! <br><br><h2>  Erreur courante # 3: Absence de séparation des tâches </h2><br>  À mesure que votre application se développe, l'organisation de votre code devient un problème de plus en plus important.  Ironiquement, la plupart des bons principes de développement de logiciels commencent à être violés partout - en particulier dans les cas où peu d'attention est accordée à la conception de l'architecture de l'application.  L'une des erreurs les plus courantes que rencontrent les développeurs est de mélanger les responsabilités du code, et c'est très facile à faire! <br><br>  Ce qui viole généralement le principe de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">séparation des fonctions</a> est simplement «l'ajout» de nouvelles fonctionnalités aux classes existantes.  Bien sûr, c'est une excellente solution à court terme (pour les débutants, elle nécessite moins de frappe), mais cela deviendra inévitablement un problème à l'avenir, que ce soit pendant les tests, la maintenance ou quelque part entre les deux.  Considérez le contrôleur suivant, qui renvoie TopTalentData à partir de son référentiel: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@RestController</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> TopTalentRepository topTalentRepository; <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(<span class="hljs-string"><span class="hljs-string">"/toptal/get"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> List&lt;TopTalentData&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTopTalent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> topTalentRepository.findAll() .stream() .map(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>::entityToData) .collect(Collectors.toList()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> TopTalentData </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">entityToData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(TopTalentEntity topTalentEntity)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TopTalentData(topTalentEntity.getName()); } }</code> </pre> <br>  Au début, il n'est pas visible que quelque chose ne va pas avec ce morceau de code.  Il fournit une liste TopTalentData qui est extraite des instances TopTalentEntity.  Cependant, si vous regardez attentivement, nous verrons qu'en fait TopTalentController fait quelques choses ici.  À savoir: il mappe les demandes pour un point de terminaison spécifique, récupère les données du référentiel et convertit les entités obtenues à partir de TopTalentRepository dans un autre format.  Une solution «plus propre» serait de diviser ces responsabilités en leurs propres classes.  Cela pourrait ressembler à ceci: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@RestController</span></span> <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(<span class="hljs-string"><span class="hljs-string">"/toptal"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@AllArgsConstructor</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> TopTalentService topTalentService; <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(<span class="hljs-string"><span class="hljs-string">"/get"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> List&lt;TopTalentData&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTopTalent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> topTalentService.getTopTalent(); } } <span class="hljs-meta"><span class="hljs-meta">@AllArgsConstructor</span></span> <span class="hljs-meta"><span class="hljs-meta">@Service</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> TopTalentRepository topTalentRepository; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> TopTalentEntityConverter topTalentEntityConverter; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> List&lt;TopTalentData&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTopTalent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> topTalentRepository.findAll() .stream() .map(topTalentEntityConverter::toResponse) .collect(Collectors.toList()); } } <span class="hljs-meta"><span class="hljs-meta">@Component</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentEntityConverter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> TopTalentData </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toResponse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(TopTalentEntity topTalentEntity)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TopTalentData(topTalentEntity.getName()); } }</code> </pre> <br>  Un avantage supplémentaire de cette hiérarchie est qu'elle nous permet de déterminer où se trouve la fonctionnalité en vérifiant simplement le nom de la classe.  De plus, pendant les tests, nous pouvons facilement remplacer n'importe laquelle des classes par une implémentation fictive, si nécessaire. <br><br><h2>  Erreur courante n ° 4: incohérence et mauvaise gestion des erreurs </h2><br>  Le sujet de la cohérence n'est pas nécessairement exclusif à Spring (ou Java, d'ailleurs), mais c'est toujours un aspect important à prendre en compte lorsque vous travaillez sur des projets Spring.  Alors que le style d'écriture du code peut faire l'objet de discussions (et c'est généralement une question d'accord sur l'équipe ou dans toute l'entreprise), la présence d'une norme commune est d'une grande aide dans les performances.  Cela est particulièrement vrai pour les équipes de plusieurs personnes.  La cohérence permet de transmettre du code sans frais de maintenance ni explication détaillée des responsabilités des différentes classes. <br><br>  Envisagez un projet Spring avec divers fichiers de configuration, services et contrôleurs.  Étant sémantiquement cohérent dans leur dénomination, une structure facilement consultable est créée dans laquelle tout nouveau développeur peut contrôler la façon de travailler avec le code: par exemple, le suffixe Config est ajouté aux classes de configuration, le suffixe Service aux services et le suffixe Controller aux contrôleurs. <br><br>  Étroitement liée au thème de la cohérence, la gestion des erreurs côté serveur mérite une attention particulière.  Si vous avez déjà dû gérer des réponses d'exception à partir d'une API mal écrite, vous savez probablement pourquoi il peut être difficile d'analyser les exceptions, et il est encore plus difficile de déterminer la raison pour laquelle ces exceptions se sont produites à l'origine. <br><br>  En tant que développeur d'API, vous souhaitez idéalement couvrir tous les points de terminaison utilisateur et les traduire dans un format d'erreur commun.  Cela signifie généralement que vous avez un code d'erreur et une description communs, et pas seulement une excuse sous la forme de: a) renvoyer le message «500 Internal Server Error» ou b) simplement réinitialiser la trace de la pile à l'utilisateur (ce qui devrait être évité à tout prix, car il montre vos entrailles en plus de la complexité du traitement côté client). <br>  Un exemple de format de réponse d'erreur courant pourrait être: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ErrorResponse</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Integer errorCode; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String errorMessage; }</code> </pre> <br>  Quelque chose de similaire se trouve généralement dans la plupart des API populaires et fonctionne généralement bien, car il peut être documenté facilement et systématiquement.  Vous pouvez traduire des exceptions dans ce format en fournissant la méthode avec l'annotation @ExceptionHandler (un exemple d'annotation est donné dans Common Mistake # 6). <br><br><h2>  Erreur courante # 5: multithreading incorrect </h2><br>  Qu'il soit présent dans les applications de bureau ou Web, dans Spring ou non dans Spring, le multithreading peut être une tâche intimidante.  Les problèmes causés par l'exécution de programmes parallèles sont évasifs et souvent extrêmement difficiles à déboguer - en fait, en raison de la nature du problème, une fois que vous comprenez que vous traitez le problème d'exécution parallèle, vous devez probablement abandonner complètement le débogueur et démarrer vérifiez votre code manuellement jusqu'à ce que vous trouviez la cause de l'erreur.  Malheureusement, pour résoudre de tels problèmes, il n'y a pas de solution de modèle.  Selon le cas spécifique, vous devrez évaluer la situation puis attaquer le problème sous un angle que vous considérez comme le meilleur. <br><br>  Idéalement, bien sûr, vous souhaitez éviter complètement les bogues multithreads.  Encore une fois, il n'y a pas d'approche unique pour cela, mais voici quelques considérations pratiques pour le débogage et la prévention des erreurs de multithreading: <br><br><h3>  Évitez le statut global </h3><br>  Tout d'abord, souvenez-vous toujours du problème de «l'état global».  Si vous créez une application multithread, absolument tout ce qui peut être changé globalement doit être soigneusement surveillé et, si possible, complètement supprimé.  S'il y a une raison pour laquelle la variable globale doit rester modifiable, utilisez soigneusement la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">synchronisation</a> et surveillez les performances de votre application pour confirmer qu'elle ne ralentit pas en raison de nouvelles périodes d'attente. <br><br><h3>  Évitez la mutabilité </h3><br>  Cela découle directement de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">programmation fonctionnelle</a> et, selon la POO, indique que la volatilité de classe et le changement d'état doivent être évités.  En bref, ce qui précède signifie la présence de poseurs et de champs finaux privés dans toutes les classes du modèle.  Leurs valeurs ne changent que pendant la construction.  Ainsi, vous pouvez être sûr qu'il n'y aura aucun problème dans la course aux ressources et que l'accès aux propriétés de l'objet fournira toujours les valeurs correctes. <br><br><h3>  Consigner les données critiques </h3><br>  Évaluez où votre application peut causer des problèmes et pré-enregistrez toutes les données importantes.  Si une erreur se produit, vous serez reconnaissant des informations sur les demandes reçues et vous pourrez mieux comprendre pourquoi votre application se comporte mal.  Encore une fois, il convient de noter que la journalisation augmente les E / S de fichiers, vous ne devez donc pas en abuser, car cela peut sérieusement affecter les performances de votre application. <br><br><h3>  Réutiliser les implémentations existantes </h3><br>  Chaque fois que vous devez créer vos propres threads (par exemple, pour effectuer des requêtes asynchrones vers divers services), réutilisez les implémentations sécurisées existantes, plutôt que de créer vos propres solutions.  Pour la plupart, cela signifierait utiliser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ExecutorServices</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CompletableFutures</a> dans le style fonctionnel soigné de Java 8 pour créer des threads.  Spring permet également le traitement des demandes asynchrones via la classe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DeferredResult</a> . <br><br><h2>  Erreur courante # 6: ne pas utiliser la validation basée sur les annotations </h2><br>  Imaginons que notre service TopTalent, mentionné ci-dessus, ait besoin d'un point de terminaison pour ajouter de nouveaux super talents.  De plus, supposons que pour une très bonne raison, chaque nouveau nom doit contenir exactement 10 caractères.  Une façon de procéder pourrait être la suivante: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(<span class="hljs-string"><span class="hljs-string">"/put"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addTopTalent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@RequestBody TopTalentData topTalentData)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> nameNonExistentOrHasInvalidLength = Optional.ofNullable(topTalentData) .map(TopTalentData::getName) .map(name -&gt; name.length() == <span class="hljs-number"><span class="hljs-number">10</span></span>) .orElse(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (nameNonExistentOrInvalidLength) { <span class="hljs-comment"><span class="hljs-comment">// throw some exception } topTalentService.addTopTalent(topTalentData); }</span></span></code> </pre> <br>  Cependant, ce qui précède (en plus d'être mal conçu) n'est pas vraiment une solution «propre».  Nous vérifions plus d'un type de validité (à savoir que TopTalentData n'est pas nul et que TopTalentData.name n'est pas nul et que TopTalentData.name est de 10 caractères) et lève également une exception si les données ne sont pas valides. <br><br>  Cela peut être fait beaucoup plus proprement en utilisant le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">validateur Hibernate</a> avec Spring.  Tout d'abord, nous réécrivons la méthode addTopTalent pour prendre en charge la validation: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(<span class="hljs-string"><span class="hljs-string">"/put"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addTopTalent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@Valid @NotNull @RequestBody TopTalentData topTalentData)</span></span></span><span class="hljs-function"> </span></span>{ topTalentService.addTopTalent(topTalentData); } <span class="hljs-meta"><span class="hljs-meta">@ExceptionHandler</span></span> <span class="hljs-meta"><span class="hljs-meta">@ResponseStatus</span></span>(HttpStatus.BAD_REQUEST) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ErrorResponse </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handleInvalidTopTalentDataException</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MethodArgumentNotValidException methodArgumentNotValidException)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// handle validation exception }</span></span></code> </pre> <br>  De plus, nous devons indiquer quelle propriété nous voulons vérifier dans la classe TopTalentData: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentData</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Length</span></span>(min = <span class="hljs-number"><span class="hljs-number">10</span></span>, max = <span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-meta"><span class="hljs-meta">@NotNull</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; }</code> </pre> <br>  Spring va maintenant intercepter la demande et la vérifier avant d'appeler la méthode - il n'est pas nécessaire d'utiliser des tests manuels supplémentaires. <br><br>  Une autre façon de réaliser la même chose est de créer nos propres annotations.  Bien que les annotations personnalisées ne soient généralement utilisées que lorsque vos besoins dépassent l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ensemble de constantes intégrées Hibernate</a> , pour cet exemple, imaginons que les annotations de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">longueur</a> n'existent pas.  Vous devez créer un validateur qui vérifie la longueur d'une chaîne en créant deux classes supplémentaires, une pour la vérification et une pour l'annotation des propriétés: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Target</span></span>({ElementType.METHOD, ElementType.FIELD, ElementType.PARAMETER}) <span class="hljs-meta"><span class="hljs-meta">@Retention</span></span>(RetentionPolicy.RUNTIME) <span class="hljs-meta"><span class="hljs-meta">@Documented</span></span> <span class="hljs-meta"><span class="hljs-meta">@Constraint</span></span>(validatedBy = { MyAnnotationValidator.class }) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-meta"><span class="hljs-meta">@interface</span></span> MyAnnotation { <span class="hljs-function"><span class="hljs-function">String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">default</span></span></span><span class="hljs-function"> "String length does not match expected"</span></span>; Class&lt;?&gt;[] groups() <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> {}; Class&lt;? extends Payload&gt;[] payload() <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> {}; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">value</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; } <span class="hljs-meta"><span class="hljs-meta">@Component</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyAnnotationValidator</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ConstraintValidator</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyAnnotation</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">String</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> expectedLength; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initialize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MyAnnotation myAnnotation)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.expectedLength = myAnnotation.value(); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isValid</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String s, ConstraintValidatorContext constraintValidatorContext)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> || s.length() == <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.expectedLength; } }</code> </pre> <br>  Notez que dans ces cas, les meilleures pratiques pour la séparation des tâches nécessitent que vous marquiez la propriété comme valide si elle est nulle (s == null dans la méthode isValid), puis utilisez l'annotation <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">NotNull</a> s'il s'agit d'une exigence supplémentaire pour la propriété: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentData</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@MyAnnotation</span></span>(value = <span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-meta"><span class="hljs-meta">@NotNull</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; }</code> </pre> <br><h2>  Erreur courante # 7: utilisation de la configuration XML (fixe) </h2><br>  Bien que XML soit nécessaire pour les versions précédentes de Spring, la plupart de la configuration peut actuellement se faire exclusivement avec du code Java / des annotations.  Les configurations XML représentent simplement un passe-partout supplémentaire et inutile. <br>  Cet article (et le référentiel GitHub qui l'accompagne) utilise des annotations pour configurer Spring et Spring sait quels beans il doit se connecter car le package racine a été annoté à l'aide de l'annotation composée @SpringBootApplication, par exemple: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@SpringBootApplication</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Application</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ SpringApplication.run(Application.class, args); } }</code> </pre> <br>  Cette annotation composite (vous pouvez en savoir plus à ce sujet dans la documentation <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Spring</a> ) donne juste à Spring un indice sur les packages à analyser pour extraire les beans.  Dans notre cas particulier, cela signifie que les classes suivantes seront utilisées pour connecter les beans, en commençant par le package de niveau supérieur (co.kukurin): <br><br><ul><li> <code>@Component (TopTalentConverter, MyAnnotationValidator) @RestController (TopTalentController) @Repository (TopTalentRepository) @Service (TopTalentService)</code> </li> <li> <code>@Component (TopTalentConverter, MyAnnotationValidator) @RestController (TopTalentController) @Repository (TopTalentRepository) @Service (TopTalentService)</code> </li> <li> <code>@Component (TopTalentConverter, MyAnnotationValidator) @RestController (TopTalentController) @Repository (TopTalentRepository) @Service (TopTalentService)</code> </li> <li> <code>@Component (TopTalentConverter, MyAnnotationValidator) @RestController (TopTalentController) @Repository (TopTalentRepository) @Service (TopTalentService)</code> </li> </ul><br>  Si nous avions des classes supplémentaires annotées avec @Configuration, elles seraient également vérifiées pour la configuration Java. <br><br><h2>  Erreur courante numéro 8: oublier les profils </h2><br>  Le problème qui se pose souvent lors du développement de serveurs est la différence entre différents types de configurations, généralement des configurations industrielles et de développement.  Au lieu de modifier manuellement les différents paramètres de configuration à chaque fois que vous passez du test au déploiement d'application, un moyen plus efficace serait d'utiliser des profils. <br><br>  Considérez le cas lorsque vous utilisez la base de données en mémoire pour le développement local et la base de données MySQL dans PROM.  Essentiellement, cela signifie que vous utiliserez différentes URL et (espérons-le) différentes informations d'identification pour accéder à chacune d'entre elles.  Voyons comment cela peut être fait avec deux fichiers de configuration différents: <br><br><h4>  FILE APPLICATION.YAML </h4><br><pre> <code class="plaintext hljs"># set default profile to 'dev' spring.profiles.active: dev # production database details spring.datasource.url: 'jdbc:mysql://localhost:3306/toptal' spring.datasource.username: root spring.datasource.password:</code> </pre> <br><h4>  FILE APPLICATION-DEV.YAML </h4><br><pre> <code class="plaintext hljs">spring.datasource.url: 'jdbc:h2:mem:' spring.datasource.platform: h2</code> </pre> <br>  Apparemment, vous ne voulez pas effectuer accidentellement des actions sur votre base de données industrielle pendant que vous jouez avec le code, il est donc logique de définir le profil par défaut dans dev.  Ensuite, sur le serveur, vous pouvez remplacer manuellement le profil de configuration en spécifiant le paramètre -Dspring.profiles.active = prod pour la JVM.  De plus, vous pouvez également définir la variable d'environnement OS sur le profil par défaut souhaité. <br><br><h2>  Erreur courante n ° 9: Incapacité d'accepter l'injection de dépendance </h2><br>  Une utilisation appropriée de l'injection de dépendances dans Spring signifie qu'elle vous permet de lier tous vos objets ensemble en analysant toutes les classes de configuration requises;  ceci est utile pour découpler les relations et facilite également les tests.  Au lieu de lier des classes, en faisant quelque chose comme ceci: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> TopTalentService topTalentService; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TopTalentController</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.topTalentService = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TopTalentService(); } }</code> </pre> <br><br>  Nous laissons le printemps faire la reliure pour nous: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> TopTalentService topTalentService; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TopTalentController</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(TopTalentService topTalentService)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.topTalentService = topTalentService; } }</code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Misko Hevery de Google Talk explique en</a> détail les «raisons» de l'injection de dépendance. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Voyons</a> plutôt comment cela est utilisé dans la pratique.  Dans la division des responsabilités (Common Mistakes # 3), nous avons créé des classes de service et de contrôleur.  Supposons que nous voulons tester un contrôleur en supposant que TopTalentService se comporte correctement.  Nous pouvons insérer un objet factice au lieu de l'implémentation de service réelle, en fournissant une classe de configuration distincte: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Configuration</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SampleUnitTestConfig</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> TopTalentService </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">topTalentService</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ TopTalentService topTalentService = Mockito.mock(TopTalentService.class); Mockito.when(topTalentService.getTopTalent()).thenReturn( Stream.of(<span class="hljs-string"><span class="hljs-string">"Mary"</span></span>, <span class="hljs-string"><span class="hljs-string">"Joel"</span></span>) .map(TopTalentData::<span class="hljs-keyword"><span class="hljs-keyword">new</span></span>).collect(Collectors.toList())); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> topTalentService; } }</code> </pre> <br>  Ensuite, nous pouvons incorporer l'objet factice en disant à Spring d'utiliser SampleUnitTestConfig comme fournisseur de configuration: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@ContextConfiguration</span></span>(classes = { SampleUnitTestConfig.class })</code> </pre> <br>  Ensuite, cela nous permettra d'utiliser la configuration de contexte pour incorporer le bean personnalisé dans le test unitaire. <br><br><h2>  Erreur courante # 10: manque de tests ou tests incorrects </h2><br>  Malgré le fait que l'idée des tests unitaires existe depuis longtemps, de nombreux développeurs semblent «oublier» de le faire (surtout si cela n'est pas nécessaire), ou tout simplement le laisser pour plus tard.  De toute évidence, cela n'est pas souhaitable, car les tests doivent non seulement vérifier l'exactitude de votre code, mais également servir de documentation sur le comportement de l'application dans différentes situations. <br><br>  Lorsque vous testez des services Web, vous effectuez rarement des tests unitaires exceptionnellement «propres», car l'interaction via HTTP nécessite généralement d'appeler DispatcherServlet Spring et de regarder ce qui se passe lorsque la HttpServletRequest réelle est reçue (ce qui en fait un test d'intégration, avec par validation, sérialisation, etc.).  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">REST assuré</a> - Java DSL pour tester facilement les services REST sur MockMVC s'est avéré être une solution très élégante.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Considérez le fragment de code suivant avec injection de dépendance: </font></font><br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@RunWith</span></span>(SpringJUnit4ClassRunner.class) <span class="hljs-meta"><span class="hljs-meta">@ContextConfiguration</span></span>(classes = { Application.class, SampleUnitTestConfig.class }) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RestAssuredTestDemonstration</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> TopTalentController topTalentController; <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">shouldGetMaryAndJoel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// given MockMvcRequestSpecification givenRestAssuredSpecification = RestAssuredMockMvc.given() .standaloneSetup(topTalentController); // when MockMvcResponse response = givenRestAssuredSpecification.when().get("/toptal/get"); // then response.then().statusCode(200); response.then().body("name", hasItems("Mary", "Joel")); } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SampleUnitTestConfig active l'implémentation fictive TopTalentService dans TopTalentController, tandis que toutes les autres classes sont connectées à l'aide de la configuration standard obtenue en analysant les packages ayant des racines dans le package de la classe Application. </font><font style="vertical-align: inherit;">RestAssuredMockMvc est simplement utilisé pour créer un environnement léger et envoyer une demande GET au point de terminaison / toptal / get.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Devenez un maître du printemps </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spring est un framework puissant qui est facile à démarrer, mais qui demande un certain temps et du dévouement pour atteindre une maîtrise totale. </font><font style="vertical-align: inherit;">Si vous passez du temps à vous familiariser avec le framework, cela augmentera certainement votre productivité à long terme et vous aidera finalement à écrire du code plus propre et à devenir un meilleur développeur. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous recherchez des ressources supplémentaires, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spring In Action</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est un livre de bonnes pratiques couvrant de nombreux sujets clés de Spring.</font></font><br><br>  <b>ÉTIQUETTES</b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Java SpringFramework </font></font><br><br><h2>  Commentaires </h2><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Timothy Schimandle</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Au # 2, je pense que le retour d'un objet de domaine est préférable dans la plupart des cas. Votre exemple d'objet personnalisé est l'une des nombreuses classes contenant des champs que nous voulons masquer. Mais la grande majorité des objets avec lesquels j'ai travaillé n'ont pas une telle restriction, et l'ajout de la classe dto n'est qu'un code inutile. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans l'ensemble, un bon article. Bon travail. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SPIRITED to Timothy Schimandle</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Je suis totalement d'accord. Il semble qu'une couche supplémentaire de code inutile ait été ajoutée, je pense que @JsonIgnore aidera à ignorer les champs (bien que présentant des défauts dans les stratégies de détection de référentiel par défaut), mais dans l'ensemble, c'est un excellent article de blog. Fiers de trébucher ... </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arokiadoss Asirvatham</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mec, Une autre erreur courante pour les débutants est: 1) la dépendance cyclique et 2) la non-conformité avec les doctrines de déclaration de classe Singleton de base, telles que l'utilisation d'une variable d'instance dans les beans avec une portée singleton. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hlodowig</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Concernant le numéro 8, je pense que les approches des profils sont très peu satisfaisantes. </font><font style="vertical-align: inherit;">Voyons voir:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sécurité: certaines personnes disent: si votre référentiel était public, y aurait-il des clés / mots de passe secrets? </font><font style="vertical-align: inherit;">Il en sera très probablement ainsi, en suivant cette approche. </font><font style="vertical-align: inherit;">Sauf si, bien sûr, vous ajoutez des fichiers de configuration à .gitignore, mais ce n'est pas une option sérieuse.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Duplication: chaque fois que j'ai des paramètres différents, je dois créer un nouveau fichier de propriétés, ce qui est assez ennuyeux. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Portabilité: je sais que ce n'est qu'un argument JVM, mais zéro vaut mieux qu'un. </font><font style="vertical-align: inherit;">Infiniment moins sujet aux erreurs.</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J'ai essayé de trouver un moyen d'utiliser des variables d'environnement dans mes fichiers de configuration au lieu de «coder en dur» les valeurs, mais jusqu'à présent je n'ai pas réussi, je pense que je dois faire plus de recherche. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Excellent article Tony, continuez votre bon travail! </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Traduction terminée: tele.gg/middle_java</font></font></b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr465897/">https://habr.com/ru/post/fr465897/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr465885/index.html">Comment devenir un Scrum Master de premier plan et faire vibrer l'équipe?</a></li>
<li><a href="../fr465889/index.html">Comment nous avons abordé l'efficacité énergétique</a></li>
<li><a href="../fr465891/index.html">Comment trouver un produit ou un nom d'entreprise en utilisant Vepp comme exemple</a></li>
<li><a href="../fr465893/index.html">Summ3r de h4ck 2019. Département d'analyse de la sécurité</a></li>
<li><a href="../fr465895/index.html">Présentation du programme C ++ Russia 2019 Piter: asynchronie, modules, bibliothèques ... et taxi</a></li>
<li><a href="../fr465899/index.html">Le livre "Linux Command Prompt. Le guide complet. 2e int. éd. "</a></li>
<li><a href="../fr465901/index.html">Que devrait avoir une application de fitness?</a></li>
<li><a href="../fr465903/index.html">Bienvenue au Fujitsu World Tour 2019</a></li>
<li><a href="../fr465905/index.html">Conférence ZeroNights 2019</a></li>
<li><a href="../fr465911/index.html">Acceleration meetup 17/09 Vidéos et présentations UPD</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>