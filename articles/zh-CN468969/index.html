<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸš° ğŸ‘Š ğŸ¢ é€šè¿‡APIä»PowerShellåˆ›å»ºGoogleç”¨æˆ· ğŸ‘¿ ğŸ¤´ğŸ¾ ğŸ”¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ä½ å¥½ 

 æœ¬æ–‡å°†ä»‹ç»PowerShellå¦‚ä½•ä¸Google APIäº¤äº’ä»¥æ“çºµG Suiteç”¨æˆ·ã€‚ 

 åœ¨ç»„ç»‡ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨å¤šç§å†…éƒ¨å’Œäº‘æœåŠ¡ã€‚ åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå®ƒä»¬çš„æˆæƒå½’äºGoogleæˆ–Active Directoryï¼Œåœ¨è¿™ä¸¤è€…ä¹‹é—´æˆ‘ä»¬æ— æ³•åˆ†åˆ«ç»´æŠ¤å‰¯æœ¬ï¼Œè€Œåœ¨é‡Šæ”¾æ–°å‘˜å·¥æ—¶ï¼Œæ‚¨éœ€è¦åœ¨è¿™ä¸¤ä¸ªç³»ç»Ÿä¸­åˆ›å»º/...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>é€šè¿‡APIä»PowerShellåˆ›å»ºGoogleç”¨æˆ·</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/468969/"> ä½ å¥½ <br><br> æœ¬æ–‡å°†ä»‹ç»PowerShellå¦‚ä½•ä¸Google APIäº¤äº’ä»¥æ“çºµG Suiteç”¨æˆ·ã€‚ <br><br> åœ¨ç»„ç»‡ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨å¤šç§å†…éƒ¨å’Œäº‘æœåŠ¡ã€‚ åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå®ƒä»¬çš„æˆæƒå½’äºGoogleæˆ–Active Directoryï¼Œåœ¨è¿™ä¸¤è€…ä¹‹é—´æˆ‘ä»¬æ— æ³•åˆ†åˆ«ç»´æŠ¤å‰¯æœ¬ï¼Œè€Œåœ¨é‡Šæ”¾æ–°å‘˜å·¥æ—¶ï¼Œæ‚¨éœ€è¦åœ¨è¿™ä¸¤ä¸ªç³»ç»Ÿä¸­åˆ›å»º/å¯ç”¨å¸æˆ·ã€‚ ä¸ºäº†ä½¿è¯¥è¿‡ç¨‹è‡ªåŠ¨åŒ–ï¼Œæˆ‘ä»¬å†³å®šç¼–å†™ä¸€ä¸ªè„šæœ¬æ¥æ”¶é›†ä¿¡æ¯å¹¶å°†å…¶å‘é€åˆ°ä¸¤ä¸ªæœåŠ¡ã€‚ <br><a name="habracut"></a><br><h3>  <font color="#5D8DDF">ç™»å…¥</font> </h3><br> ç»„æˆéœ€æ±‚åï¼Œæˆ‘ä»¬å†³å®šä½¿ç”¨çœŸå®çš„äººä½œä¸ºç®¡ç†å‘˜è¿›è¡Œæˆæƒï¼Œè¿™ç®€åŒ–äº†åœ¨æ„å¤–æˆ–æœ‰æ„çš„å¤§å˜åŠ¨æ—¶é‡‡å–çš„æªæ–½çš„åˆ†æã€‚ <br><br>  Google APIä½¿ç”¨OAuth 2.0åè®®è¿›è¡Œèº«ä»½éªŒè¯å’Œæˆæƒã€‚ æ‚¨å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ç”¨ä¾‹å’Œæ›´è¯¦ç»†çš„æè¿°ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä½¿ç”¨OAuth 2.0è®¿é—®Google API</a> ã€‚ <br><br> æˆ‘é€‰æ‹©äº†ç”¨äºæ¡Œé¢åº”ç”¨ç¨‹åºä¸­æˆæƒçš„è„šæœ¬ã€‚ è¿˜æœ‰ä¸€ä¸ªé€‰é¡¹å¯ä»¥ä½¿ç”¨ä¸éœ€è¦ç”¨æˆ·ä¸å¿…è¦çš„ç§»åŠ¨çš„æœåŠ¡å¸æˆ·ã€‚ <br><br> ä¸‹å›¾æ˜¯ä»Googleé¡µé¢é€‰æ‹©çš„æ–¹æ¡ˆçš„ç¤ºæ„å›¾ã€‚ <br><br><img src="https://habrastorage.org/webt/wx/sp/rw/wxsprwm-uqyd1koa-2xx4sgjkku.png"><br><br><ol><li> é¦–å…ˆï¼Œæˆ‘ä»¬å°†ç”¨æˆ·å‘é€åˆ°Googleå¸æˆ·ä¸­çš„èº«ä»½éªŒè¯é¡µé¢ï¼ŒæŒ‡ç¤ºGETå‚æ•°ï¼š <br><ul><li> ç”³è¯·ç¼–å· </li><li> åº”ç”¨ç¨‹åºéœ€è¦è®¿é—®çš„åŒºåŸŸ </li><li> å®Œæˆè¯¥è¿‡ç¨‹åï¼Œç”¨æˆ·å°†è¢«é‡å®šå‘åˆ°çš„åœ°å€ </li><li> æˆ‘ä»¬æ›´æ–°ä»¤ç‰Œçš„æ–¹å¼ </li><li> éªŒè¯ç  </li><li> éªŒè¯ç ä¼ è¾“æ ¼å¼ </li></ul><br></li><li> æˆæƒå®Œæˆåï¼Œç”¨æˆ·å°†è¢«é‡å®šå‘åˆ°ç¬¬ä¸€ä¸ªè¯·æ±‚ä¸­æŒ‡å®šçš„é¡µé¢ï¼Œå¹¶å¸¦æœ‰ç”±GETå‚æ•°ä¼ è¾“çš„é”™è¯¯æˆ–æˆæƒä»£ç  </li><li> åº”ç”¨ç¨‹åºï¼ˆè„šæœ¬ï¼‰å°†éœ€è¦è·å–è¿™äº›å‚æ•°ï¼Œå¦‚æœæ¥æ”¶åˆ°ä»£ç ï¼Œåˆ™æ‰§è¡Œä»¥ä¸‹ä»¤ç‰Œè¯·æ±‚ </li><li> å¦‚æœè¯·æ±‚æ­£ç¡®ï¼Œåˆ™Google APIè¿”å›ï¼š <br><br><ul><li> å¯ä»¥ç”¨æ¥å‘å‡ºè¯·æ±‚çš„è®¿é—®ä»¤ç‰Œ </li><li> è¯¥ä»¤ç‰Œçš„æœ‰æ•ˆæ€§ </li><li> æ›´æ–°è®¿é—®ä»¤ç‰Œæ‰€éœ€çš„åˆ·æ–°ä»¤ç‰Œã€‚ </li></ul></li></ol><br> é¦–å…ˆï¼Œæ‚¨éœ€è¦è½¬åˆ°Google APIæ§åˆ¶å°ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å‡­æ®-Google APIæ§åˆ¶å°</a> ï¼Œé€‰æ‹©æ‰€éœ€çš„åº”ç”¨ç¨‹åºï¼Œç„¶ååœ¨â€œå‡­æ®â€éƒ¨åˆ†ä¸­åˆ›å»ºå®¢æˆ·ç«¯OAuthæ ‡è¯†ç¬¦ã€‚ åœ¨åŒä¸€ä½ç½®ï¼ˆæˆ–ç¨åï¼Œåœ¨åˆ›å»ºçš„æ ‡è¯†ç¬¦çš„å±æ€§ä¸­ï¼‰ï¼Œæ‚¨éœ€è¦æŒ‡å®šå…è®¸é‡å®šå‘çš„åœ°å€ã€‚ åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå®ƒå°†æ˜¯å‡ ä¸ªå…·æœ‰ä¸åŒç«¯å£çš„localhostæ¡ç›®ï¼ˆè¯·å‚è§ä¸‹æ–‡ï¼‰ã€‚ <br><br> ä¸ºäº†ä½¿é˜…è¯»è„šæœ¬ç®—æ³•æ›´å®¹æ˜“ï¼Œæ‚¨å¯ä»¥åœ¨ä¸€ä¸ªå•ç‹¬çš„å‡½æ•°ä¸­è¾“å‡ºç¬¬ä¸€æ­¥ï¼Œè¯¥å‡½æ•°å°†ä¸ºåº”ç”¨ç¨‹åºè¿”å›Accesså’Œåˆ·æ–°ä»¤ç‰Œï¼š <br><br><pre><code class="cs hljs">$client_secret = <span class="hljs-string"><span class="hljs-string">'Our Client Secret'</span></span> $client_id = <span class="hljs-string"><span class="hljs-string">'Our Client ID'</span></span> function Get-GoogleAuthToken { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (-not [System.Net.HttpListener]::IsSupported) { <span class="hljs-string"><span class="hljs-string">"HttpListener is not supported."</span></span> exit <span class="hljs-number"><span class="hljs-number">1</span></span> } $codeverifier = -<span class="hljs-keyword"><span class="hljs-keyword">join</span></span> ((<span class="hljs-number"><span class="hljs-number">65.</span></span><span class="hljs-number"><span class="hljs-number">.90</span></span>) + (<span class="hljs-number"><span class="hljs-number">97.</span></span><span class="hljs-number"><span class="hljs-number">.122</span></span>) + (<span class="hljs-number"><span class="hljs-number">48.</span></span><span class="hljs-number"><span class="hljs-number">.57</span></span>) + <span class="hljs-number"><span class="hljs-number">45</span></span> + <span class="hljs-number"><span class="hljs-number">46</span></span> + <span class="hljs-number"><span class="hljs-number">95</span></span> + <span class="hljs-number"><span class="hljs-number">126</span></span> |Get-Random -Count <span class="hljs-number"><span class="hljs-number">60</span></span>| % {[<span class="hljs-keyword"><span class="hljs-keyword">char</span></span>]$_}) $hasher = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">object</span></span> System.Security.Cryptography.SHA256Managed $hashByteArray = $hasher.ComputeHash([System.Text.Encoding]::UTF8.GetBytes($codeverifier)) $base64 = ((([System.Convert]::ToBase64String($hashByteArray)).replace(<span class="hljs-string"><span class="hljs-string">'='</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>)).replace(<span class="hljs-string"><span class="hljs-string">'+'</span></span>,<span class="hljs-string"><span class="hljs-string">'-'</span></span>)).replace(<span class="hljs-string"><span class="hljs-string">'/'</span></span>,<span class="hljs-string"><span class="hljs-string">'_'</span></span>) $ports = @(<span class="hljs-number"><span class="hljs-number">10600</span></span>,<span class="hljs-number"><span class="hljs-number">15084</span></span>,<span class="hljs-number"><span class="hljs-number">39700</span></span>,<span class="hljs-number"><span class="hljs-number">42847</span></span>,<span class="hljs-number"><span class="hljs-number">65387</span></span>,<span class="hljs-number"><span class="hljs-number">32079</span></span>) $port = $ports[(<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>-random -Minimum <span class="hljs-number"><span class="hljs-number">0</span></span> -maximum <span class="hljs-number"><span class="hljs-number">5</span></span>)] Write-Host <span class="hljs-string"><span class="hljs-string">"Start browser..."</span></span> Start-Process <span class="hljs-string"><span class="hljs-string">"https://accounts.google.com/o/oauth2/v2/auth?code_challenge_method=S256&amp;code_challenge=$base64&amp;access_type=offline&amp;client_id=$client_id&amp;redirect_uri=http://localhost:$port&amp;response_type=code&amp;scope=https://www.googleapis.com/auth/admin.directory.user https://www.googleapis.com/auth/admin.directory.group"</span></span> $listener = New-Object System.Net.HttpListener $listener.Prefixes.Add(<span class="hljs-string"><span class="hljs-string">"http://localhost:"</span></span>+$port+<span class="hljs-string"><span class="hljs-string">'/'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> {$listener.Start()} <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> { <span class="hljs-string"><span class="hljs-string">"Unable to start listener."</span></span> exit <span class="hljs-number"><span class="hljs-number">1</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (($code -eq $<span class="hljs-literal"><span class="hljs-literal">null</span></span>)) { $context = $listener.GetContext() Write-Host <span class="hljs-string"><span class="hljs-string">"Connection accepted"</span></span> -f <span class="hljs-string"><span class="hljs-string">'mag'</span></span> $url = $context.Request.RawUrl $code = $url.split(<span class="hljs-string"><span class="hljs-string">'?'</span></span>)[<span class="hljs-number"><span class="hljs-number">1</span></span>].split(<span class="hljs-string"><span class="hljs-string">'='</span></span>)[<span class="hljs-number"><span class="hljs-number">1</span></span>].split(<span class="hljs-string"><span class="hljs-string">'&amp;'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($url.split(<span class="hljs-string"><span class="hljs-string">'?'</span></span>)[<span class="hljs-number"><span class="hljs-number">1</span></span>].split(<span class="hljs-string"><span class="hljs-string">'='</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>] -eq <span class="hljs-string"><span class="hljs-string">'error'</span></span>) { Write-Host <span class="hljs-string"><span class="hljs-string">"Error!"</span></span>$code -f <span class="hljs-string"><span class="hljs-string">'red'</span></span> $buffer = [System.Text.Encoding]::UTF8.GetBytes(<span class="hljs-string"><span class="hljs-string">"Error!"</span></span>+$code) $context.Response.ContentLength64 = $buffer.Length $context.Response.OutputStream.Write($buffer, <span class="hljs-number"><span class="hljs-number">0</span></span>, $buffer.Length) $context.Response.OutputStream.Close() $listener.Stop() exit <span class="hljs-number"><span class="hljs-number">1</span></span> } $buffer = [System.Text.Encoding]::UTF8.GetBytes(<span class="hljs-string"><span class="hljs-string">"Now you can close this browser tab."</span></span>) $context.Response.ContentLength64 = $buffer.Length $context.Response.OutputStream.Write($buffer, <span class="hljs-number"><span class="hljs-number">0</span></span>, $buffer.Length) $context.Response.OutputStream.Close() $listener.Stop() } Return Invoke-RestMethod -Method Post -Uri <span class="hljs-string"><span class="hljs-string">"https://www.googleapis.com/oauth2/v4/token"</span></span> -Body @{ code = $code client_id = $client_id client_secret = $client_secret redirect_uri = <span class="hljs-string"><span class="hljs-string">'http://localhost:'</span></span>+$port grant_type = <span class="hljs-string"><span class="hljs-string">'authorization_code'</span></span> code_verifier = $codeverifier } $code = $<span class="hljs-literal"><span class="hljs-literal">null</span></span></code> </pre> <br> æˆ‘ä»¬è®¾ç½®åœ¨OAuthå®¢æˆ·ç«¯æ ‡è¯†ç¬¦çš„å±æ€§ä¸­è·å¾—çš„å®¢æˆ·ç«¯IDå’Œå®¢æˆ·ç«¯å¯†é’¥ï¼Œå¹¶ä¸”ä»£ç éªŒè¯ç¨‹åºæ˜¯é•¿åº¦ä¸º43è‡³128ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œåº”ä»éä¿ç•™å­—ç¬¦ä¸­éšæœºç”Ÿæˆï¼š[AZ] / [az] / [0-9 ] /â€œ-â€ /â€œã€‚  /â€œ _â€ /â€œã€œâ€ã€‚ <br><br> æ­¤å¤–ï¼Œè¯¥ä»£ç å°†è¢«é‡æ–°å‘é€ã€‚ å®ƒæ¶ˆé™¤äº†æ”»å‡»è€…å¯ä»¥æ‹¦æˆªç”¨æˆ·æˆæƒåè¿”å›é‡å®šå‘çš„å“åº”çš„æ¼æ´ã€‚ <br> æ‚¨å¯ä»¥é‡‡ç”¨å½“å‰æ ¼å¼çš„æ˜æ–‡å½¢å¼å‘é€ä»£ç éªŒè¯ç¨‹åºï¼ˆè¿™ä½¿å…¶æ¯«æ— æ„ä¹‰-ä»…é€‚ç”¨äºä¸æ”¯æŒSHA256çš„ç³»ç»Ÿï¼‰ï¼Œä¹Ÿå¯ä»¥åˆ›å»ºéœ€è¦åœ¨BASE64Urlä¸­ç¼–ç çš„SHA256å“ˆå¸Œï¼ˆä¸è¡¨ä¸­ä¸¤ä¸ªå­—ç¬¦çš„Base64ä¸åŒï¼‰ï¼Œç„¶ååˆ é™¤è¯¥å­—ç¬¦è¡Œå°¾ï¼š=ã€‚ <br><br> æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦å¼€å§‹ä¾¦å¬æœ¬åœ°è®¡ç®—æœºä¸Šçš„httpï¼Œä»¥è·å¾—æˆæƒåçš„å“åº”ï¼Œè¯¥å“åº”å°†ä½œä¸ºé‡å®šå‘è¿”å›ã€‚ <br><br> ç®¡ç†ä»»åŠ¡æ˜¯åœ¨ç‰¹æ®Šçš„æœåŠ¡å™¨ä¸Šæ‰§è¡Œçš„ï¼Œæˆ‘ä»¬ä¸èƒ½æ’é™¤å‡ ä¸ªç®¡ç†å‘˜åŒæ—¶è¿è¡Œè„šæœ¬çš„å¯èƒ½æ€§ï¼Œå› æ­¤ä»–å°†ä¸ºå½“å‰ç”¨æˆ·éšæœºé€‰æ‹©ä¸€ä¸ªç«¯å£ï¼Œä½†æ˜¯æˆ‘æŒ‡å®šäº†é¢„å®šä¹‰çš„ç«¯å£ï¼Œå› ä¸º å®ƒä»¬è¿˜å¿…é¡»åœ¨APIæ§åˆ¶å°ä¸­æ·»åŠ ä¸ºå—ä¿¡ä»»çš„ã€‚ <br><br>  <i>access_type = offline</i>æ„å‘³ç€åº”ç”¨ç¨‹åºå¯ä»¥ç‹¬ç«‹æ›´æ–°è¿‡æœŸçš„ä»¤ç‰Œï¼Œè€Œæ— éœ€ç”¨æˆ·ä¸æµè§ˆå™¨è¿›è¡Œäº¤äº’ï¼Œ <br>  <i>response_type = code</i>è®¾ç½®è¿”å›<i>ä»£ç </i>çš„æ ¼å¼ï¼ˆå½“ç”¨æˆ·å°†ä»£ç ä»æµè§ˆå™¨å¤åˆ¶åˆ°è„šæœ¬æ—¶ï¼ŒæŒ‡çš„æ˜¯æ—§çš„æˆæƒæ–¹æ³•ï¼‰ï¼Œ <br>  <i>scope</i>æŒ‡ç¤ºè®¿é—®çš„<i>èŒƒå›´</i>å’Œç±»å‹ã€‚ å®ƒä»¬ä¹‹é—´å¿…é¡»ç”¨ç©ºæ ¼æˆ–ï¼…20åˆ†éš”ï¼ˆæ ¹æ®URLç¼–ç ï¼‰ã€‚ å¯ä»¥åœ¨æ­¤å¤„æŸ¥çœ‹å…·æœ‰ç±»å‹çš„è®¿é—®åŒºåŸŸåˆ—è¡¨ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Google APIçš„OAuth 2.0èŒƒå›´</a> ã€‚ <br><br> æ”¶åˆ°æˆæƒç åï¼Œåº”ç”¨ç¨‹åºå°†å‘æµè§ˆå™¨è¿”å›å…³é—­æ¶ˆæ¯ï¼Œåœæ­¢ç›‘å¬ç«¯å£å¹¶å‘é€POSTè¯·æ±‚ä»¥æ¥æ”¶ä»¤ç‰Œã€‚ æ ¹æ®åè®®è§„èŒƒï¼Œæˆ‘ä»¬åœ¨å…¶ä¸­æŒ‡å‡ºå…ˆå‰ä»æ§åˆ¶å°APIè®¾ç½®çš„IDå’Œæœºå¯†ï¼Œå°†ç”¨æˆ·é‡å®šå‘åˆ°çš„åœ°å€ä»¥åŠgrant_typeã€‚ <br><br> ä½œä¸ºå“åº”ï¼Œæˆ‘ä»¬å°†è·å¾—ä¸€ä¸ªAccessä»¤ç‰Œï¼Œä»¥ç§’ä¸ºå•ä½çš„æŒç»­æ—¶é—´å’Œä¸€ä¸ªRefreshä»¤ç‰Œï¼Œé€šè¿‡å®ƒä»¬æˆ‘ä»¬å¯ä»¥æ›´æ–°Accessä»¤ç‰Œã€‚ <br><br> åº”ç”¨ç¨‹åºåº”å°†ä»¤ç‰Œå­˜å‚¨åœ¨å…·æœ‰é•¿ä¿è´¨æœŸçš„å®‰å…¨åœ°æ–¹ï¼Œå› æ­¤ï¼Œåœ¨æˆ‘ä»¬å–æ¶ˆè·å¾—çš„è®¿é—®æƒé™ä¹‹å‰ï¼Œåˆ·æ–°ä»¤ç‰Œå°†ä¸ä¼šè¿”å›ç»™åº”ç”¨ç¨‹åºã€‚ æœ€åï¼Œæˆ‘æ·»åŠ äº†ä¸€ä¸ªæ’¤é”€ä»¤ç‰Œçš„è¯·æ±‚ï¼Œå¦‚æœåº”ç”¨ç¨‹åºæœªæˆåŠŸå®Œæˆå¹¶ä¸”åˆ·æ–°ä»¤ç‰Œæ²¡æœ‰è¿”å›ï¼Œå®ƒå°†å†æ¬¡å¯åŠ¨è¯¥è¿‡ç¨‹ï¼ˆæˆ‘ä»¬è®¤ä¸ºå°†ä»¤ç‰Œæœ¬åœ°å­˜å‚¨åœ¨ç»ˆç«¯ä¸Šæ˜¯ä¸å®‰å…¨çš„ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸æƒ³ä½¿åŠ å¯†å¤æ‚åŒ–æˆ–ç»å¸¸æ‰“å¼€æµè§ˆå™¨ï¼‰ã€‚ <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { $token_result = Get-GoogleAuthToken $token = $token_result.<span class="hljs-function"><span class="hljs-function">access_token </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">$token_result.refresh_token -eq $</span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">null</span></span></span></span></span><span class="hljs-function">)</span></span> { Write-Host (<span class="hljs-string"><span class="hljs-string">"Session is not destroyed. Revoking token..."</span></span>) Invoke-WebRequest -Uri (<span class="hljs-string"><span class="hljs-string">"https://accounts.google.com/o/oauth2/revoke?token="</span></span>+$token) } } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ($token_result.refresh_token -eq $<span class="hljs-literal"><span class="hljs-literal">null</span></span>) $refresh_token = $token_result.refresh_token $minute = ([<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>](<span class="hljs-string"><span class="hljs-string">"{0:mm}"</span></span> -f ([timespan]::fromseconds($token_result.expires_in))))+((Get-date).Minute)<span class="hljs-number"><span class="hljs-number">-2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($minute -lt <span class="hljs-number"><span class="hljs-number">0</span></span>) {$minute += <span class="hljs-number"><span class="hljs-number">60</span></span>} elseif ($minute -gt <span class="hljs-number"><span class="hljs-number">59</span></span>) {$minute -=<span class="hljs-number"><span class="hljs-number">60</span></span>} $token_expire = @{ hour = ([<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>](<span class="hljs-string"><span class="hljs-string">"{0:hh}"</span></span> -f ([timespan]::fromseconds($token_result.expires_in))))+((Get-date).Hour) minute = $minute }</code> </pre><br> æ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œè°ƒç”¨ä»¤ç‰Œæ—¶ï¼Œå°†ä½¿ç”¨Invoke-WebRequestã€‚ ä¸Invoke-RestMethodä¸åŒï¼Œå®ƒä¸ä¼šä»¥æ–¹ä¾¿ä½¿ç”¨çš„æ ¼å¼è¿”å›æ¥æ”¶åˆ°çš„æ•°æ®ï¼Œå¹¶æ˜¾ç¤ºè¯·æ±‚çš„çŠ¶æ€ã€‚ <br><br> æ¥ä¸‹æ¥ï¼Œè„šæœ¬å°†è¦æ±‚æ‚¨è¾“å…¥ç”¨æˆ·çš„åå­—å’Œå§“æ°ï¼Œç”Ÿæˆç”¨æˆ·å+ç”µå­é‚®ä»¶ã€‚ <br><br><h3>  <font color="#5D8DDF">å’¨è¯¢å¤„</font> </h3><br> ä»¥ä¸‹æ˜¯è¯·æ±‚-é¦–å…ˆï¼Œæ‚¨éœ€è¦æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç»å…·æœ‰è¿™æ ·çš„ç™»å½•åï¼Œæ‰èƒ½å†³å®šæ˜¯å¦è¦åˆ›å»ºæ–°çš„ç™»å½•åæˆ–æ‰“å¼€å½“å‰çš„ç™»å½•åã€‚ <br><br> æˆ‘å†³å®šä½¿ç”¨switché€šè¿‡é€‰æ‹©ä»¥å•ä¸ªå‡½æ•°çš„æ ¼å¼å®ç°æ‰€æœ‰è¯·æ±‚ï¼š <br><br><pre> <code class="cs hljs">function GoogleQuery { param ( $type, $query ) <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> ($type) { <span class="hljs-string"><span class="hljs-string">"SearchAccount"</span></span> { Return Invoke-RestMethod -Method Get -Uri <span class="hljs-string"><span class="hljs-string">"https://www.googleapis.com/admin/directory/v1/users"</span></span> -Headers @{Authorization = <span class="hljs-string"><span class="hljs-string">"Bearer "</span></span>+(Get-GoogleToken)} -Body @{ domain = <span class="hljs-string"><span class="hljs-string">'rocketguys.com'</span></span> query = <span class="hljs-string"><span class="hljs-string">"email:$query"</span></span> } } <span class="hljs-string"><span class="hljs-string">"UpdateAccount"</span></span> { $body = @{ name = @{ givenName = $query[<span class="hljs-string"><span class="hljs-string">'givenName'</span></span>] familyName = $query[<span class="hljs-string"><span class="hljs-string">'familyName'</span></span>] } suspended = <span class="hljs-string"><span class="hljs-string">'false'</span></span> password = $query[<span class="hljs-string"><span class="hljs-string">'password'</span></span>] changePasswordAtNextLogin = <span class="hljs-string"><span class="hljs-string">'true'</span></span> phones = @(@{ primary = <span class="hljs-string"><span class="hljs-string">'true'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = $query[<span class="hljs-string"><span class="hljs-string">'phone'</span></span>] type = <span class="hljs-string"><span class="hljs-string">"mobile"</span></span> }) orgUnitPath = $query[<span class="hljs-string"><span class="hljs-string">'orgunit'</span></span>] } Return Invoke-RestMethod -Method Put -Uri (<span class="hljs-string"><span class="hljs-string">"https://www.googleapis.com/admin/directory/v1/users/"</span></span>+$query[<span class="hljs-string"><span class="hljs-string">'email'</span></span>]) -Headers @{Authorization = <span class="hljs-string"><span class="hljs-string">"Bearer "</span></span>+(Get-GoogleToken)} -Body (ConvertTo-Json $body) -ContentType <span class="hljs-string"><span class="hljs-string">'application/json; charset=utf-8'</span></span> } <span class="hljs-string"><span class="hljs-string">"CreateAccount"</span></span> { $body = @{ primaryEmail = $query[<span class="hljs-string"><span class="hljs-string">'email'</span></span>] name = @{ givenName = $query[<span class="hljs-string"><span class="hljs-string">'givenName'</span></span>] familyName = $query[<span class="hljs-string"><span class="hljs-string">'familyName'</span></span>] } suspended = <span class="hljs-string"><span class="hljs-string">'false'</span></span> password = $query[<span class="hljs-string"><span class="hljs-string">'password'</span></span>] changePasswordAtNextLogin = <span class="hljs-string"><span class="hljs-string">'true'</span></span> phones = @(@{ primary = <span class="hljs-string"><span class="hljs-string">'true'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = $query[<span class="hljs-string"><span class="hljs-string">'phone'</span></span>] type = <span class="hljs-string"><span class="hljs-string">"mobile"</span></span> }) orgUnitPath = $query[<span class="hljs-string"><span class="hljs-string">'orgunit'</span></span>] } Return Invoke-RestMethod -Method Post -Uri <span class="hljs-string"><span class="hljs-string">"https://www.googleapis.com/admin/directory/v1/users"</span></span> -Headers @{Authorization = <span class="hljs-string"><span class="hljs-string">"Bearer "</span></span>+(Get-GoogleToken)} -Body (ConvertTo-Json $body) -ContentType <span class="hljs-string"><span class="hljs-string">'application/json; charset=utf-8'</span></span> } <span class="hljs-string"><span class="hljs-string">"AddMember"</span></span> { $body = @{ userKey = $query[<span class="hljs-string"><span class="hljs-string">'email'</span></span>] } $ifrequest = Invoke-RestMethod -Method Get -Uri <span class="hljs-string"><span class="hljs-string">"https://www.googleapis.com/admin/directory/v1/groups"</span></span> -Headers @{Authorization = <span class="hljs-string"><span class="hljs-string">"Bearer "</span></span>+(Get-GoogleToken)} -Body $body $array = @() <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($<span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> $ifrequest.groups) {$array += $<span class="hljs-keyword"><span class="hljs-keyword">group</span></span>.email} <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($array -notcontains $query[<span class="hljs-string"><span class="hljs-string">'groupkey'</span></span>]) { $body = @{ email = $query[<span class="hljs-string"><span class="hljs-string">'email'</span></span>] role = <span class="hljs-string"><span class="hljs-string">"MEMBER"</span></span> } Return Invoke-RestMethod -Method Post -Uri (<span class="hljs-string"><span class="hljs-string">"https://www.googleapis.com/admin/directory/v1/groups/"</span></span>+$query[<span class="hljs-string"><span class="hljs-string">'groupkey'</span></span>]+<span class="hljs-string"><span class="hljs-string">"/members"</span></span>) -Headers @{Authorization = <span class="hljs-string"><span class="hljs-string">"Bearer "</span></span>+(Get-GoogleToken)} -Body (ConvertTo-Json $body) -ContentType <span class="hljs-string"><span class="hljs-string">'application/json; charset=utf-8'</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Return ($query[<span class="hljs-string"><span class="hljs-string">'email'</span></span>]+<span class="hljs-string"><span class="hljs-string">" now is a member of "</span></span>+$query[<span class="hljs-string"><span class="hljs-string">'groupkey'</span></span>]) } } } }</code> </pre> <br> åœ¨æ¯ä¸ªè¯·æ±‚ä¸­ï¼Œæ‚¨éœ€è¦å‘é€ä¸€ä¸ªAuthorizationæ ‡å¤´ï¼Œå…¶ä¸­åŒ…å«ä»¤ç‰Œçš„ç±»å‹å’ŒAccessä»¤ç‰Œæœ¬èº«ã€‚ ç›®å‰ï¼Œä»¤ç‰Œçš„ç±»å‹å§‹ç»ˆä¸ºBearerã€‚ å› ä¸º æˆ‘ä»¬éœ€è¦æ£€æŸ¥ä»¤ç‰Œæ˜¯å¦è¿‡æœŸï¼Œå¹¶åœ¨å‘å¸ƒä»¤ç‰Œåçš„ä¸€ä¸ªå°æ—¶åå¯¹å…¶è¿›è¡Œæ›´æ–°ï¼Œè¿™è¡¨æ˜æˆ‘è¦æ±‚å¦ä¸€ä¸ªå‡½æ•°è¿”å›è®¿é—®ä»¤ç‰Œã€‚ æ”¶åˆ°ç¬¬ä¸€ä¸ªAccessä»¤ç‰Œæ—¶ï¼ŒåŒä¸€æ®µä»£ç ä½äºè„šæœ¬çš„å¼€å¤´ï¼š <br><br><pre> <code class="cs hljs">function Get-GoogleToken { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (((Get-date).Hour -gt $token_expire.hour) -or (((Get-date).Hour -ge $token_expire.hour) -and ((Get-date).Minute -gt $token_expire.minute))) { Write-Host <span class="hljs-string"><span class="hljs-string">"Token Expired. Refreshing..."</span></span> $request = (Invoke-RestMethod -Method Post -Uri <span class="hljs-string"><span class="hljs-string">"https://www.googleapis.com/oauth2/v4/token"</span></span> -ContentType <span class="hljs-string"><span class="hljs-string">'application/x-www-form-urlencoded'</span></span> -Body @{ client_id = $client_id client_secret = $client_secret refresh_token = $refresh_token grant_type = <span class="hljs-string"><span class="hljs-string">'refresh_token'</span></span> }) $token = $request.access_token $minute = ([<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>](<span class="hljs-string"><span class="hljs-string">"{0:mm}"</span></span> -f ([timespan]::fromseconds($request.expires_in))))+((Get-date).Minute)<span class="hljs-number"><span class="hljs-number">-2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($minute -lt <span class="hljs-number"><span class="hljs-number">0</span></span>) {$minute += <span class="hljs-number"><span class="hljs-number">60</span></span>} elseif ($minute -gt <span class="hljs-number"><span class="hljs-number">59</span></span>) {$minute -=<span class="hljs-number"><span class="hljs-number">60</span></span>} $script:token_expire = @{ hour = ([<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>](<span class="hljs-string"><span class="hljs-string">"{0:hh}"</span></span> -f ([timespan]::fromseconds($request.expires_in))))+((Get-date).Hour) minute = $minute } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $token }</code> </pre> <br> æ£€æŸ¥ç™»å½•åæ˜¯å¦å­˜åœ¨ï¼š <br><br><pre> <code class="cs hljs">function Check_Google { $query = (GoogleQuery <span class="hljs-string"><span class="hljs-string">'SearchAccount'</span></span> $username) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($query.users -ne $<span class="hljs-literal"><span class="hljs-literal">null</span></span>) { $user = $query.users[<span class="hljs-number"><span class="hljs-number">0</span></span>] Write-Host $user.name.fullName<span class="hljs-string"><span class="hljs-string">' - '</span></span>$user.PrimaryEmail<span class="hljs-string"><span class="hljs-string">' - suspended: '</span></span>$user.Suspended $GAresult = $user } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($GAresult) { $<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> = $GAresult } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {$<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> = <span class="hljs-string"><span class="hljs-string">'gg'</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> }</code> </pre> <br> ç”µå­é‚®ä»¶è¯·æ±‚ï¼š$æŸ¥è¯¢å°†è¦æ±‚APIæœç´¢ä¸è¯¥ç”µå­é‚®ä»¶å®Œå…¨ç›¸åŒçš„ç”¨æˆ·ï¼ŒåŒ…æ‹¬åˆ«åã€‚ æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨é€šé…ç¬¦ï¼š <i>=ï¼Œï¼šï¼Œï¼š{PREFIX} *</i> ã€‚ <br><br> è¦è·å–æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨GETè¯·æ±‚æ–¹æ³•æ¥æ’å…¥æ•°æ®ï¼ˆåˆ›å»ºå¸æˆ·æˆ–å‘ç»„ä¸­æ·»åŠ æˆå‘˜ï¼‰-POSTï¼Œæ›´æ–°ç°æœ‰æ•°æ®-PUTï¼Œåˆ é™¤æ¡ç›®ï¼ˆä¾‹å¦‚ï¼Œç»„ä¸­çš„å‚ä¸è€…ï¼‰-DELETEã€‚ <br><br> è¯¥è„šæœ¬è¿˜å°†è¯¢é—®ç”µè¯å·ç ï¼ˆæ— æ•ˆçš„å­—ç¬¦ä¸²ï¼‰å¹¶å°†å…¶åŒ…æ‹¬åœ¨åŒºåŸŸé€šè®¯ç»„ä¸­ã€‚ å®ƒæ ¹æ®æ‰€é€‰çš„Active Directory OUå†³å®šç”¨æˆ·åº”æ‹¥æœ‰çš„ç»„ç»‡å•ä½ï¼Œå¹¶å°†æä¾›å¯†ç ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { $phone = Read-Host <span class="hljs-string"><span class="hljs-string">"   +7"</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (-not $phone) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { $moscow = Read-Host <span class="hljs-string"><span class="hljs-string">"  ? (y/n) "</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (-not (($moscow -eq <span class="hljs-string"><span class="hljs-string">'y'</span></span>) -or ($moscow -eq <span class="hljs-string"><span class="hljs-string">'n'</span></span>))) $orgunit = <span class="hljs-string"><span class="hljs-string">'/'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($OU -like <span class="hljs-string"><span class="hljs-string">"*OU=Delivery,OU=Users,OU=ROOT,DC=rocket,DC=local"</span></span>) { Write-host <span class="hljs-string"><span class="hljs-string">"   /Team delivery"</span></span> $orgunit = <span class="hljs-string"><span class="hljs-string">"/Team delivery"</span></span> } $Password = -<span class="hljs-keyword"><span class="hljs-keyword">join</span></span> ( <span class="hljs-number"><span class="hljs-number">48.</span></span><span class="hljs-number"><span class="hljs-number">.57</span></span> + <span class="hljs-number"><span class="hljs-number">65.</span></span><span class="hljs-number"><span class="hljs-number">.90</span></span> + <span class="hljs-number"><span class="hljs-number">97.</span></span><span class="hljs-number"><span class="hljs-number">.122</span></span> | Get-Random -Count <span class="hljs-number"><span class="hljs-number">12</span></span> | % {[<span class="hljs-keyword"><span class="hljs-keyword">char</span></span>]$_})+<span class="hljs-string"><span class="hljs-string">"*Ba"</span></span></code> </pre><br> ç„¶åå¼€å§‹å¤„ç†è¯¥å¸æˆ·ï¼š <br><br><pre> <code class="cs hljs">$query = @{ email = $email givenName = $firstname familyName = $lastname password = $password phone = $phone orgunit = $orgunit } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($GMailExist) { Write-Host <span class="hljs-string"><span class="hljs-string">"  "</span></span> -<span class="hljs-function"><span class="hljs-function">f </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mag</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GoogleQuery </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'UpdateAccount'</span></span></span></span><span class="hljs-function"><span class="hljs-params"> $query</span></span></span><span class="hljs-function">) | fl write-host "      $Username  Google." } else</span></span> { Write-Host <span class="hljs-string"><span class="hljs-string">"  "</span></span> -<span class="hljs-function"><span class="hljs-function">f </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mag</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GoogleQuery </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'CreateAccount'</span></span></span></span><span class="hljs-function"><span class="hljs-params"> $query</span></span></span><span class="hljs-function">) | fl } </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">$moscow -eq </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"y"</span></span></span></span></span><span class="hljs-function">)</span></span>{ write-host <span class="hljs-string"><span class="hljs-string">"   moscowoffice"</span></span> $query = @{ groupkey = <span class="hljs-string"><span class="hljs-string">'moscowoffice@rocketguys.com'</span></span> email = $email } (GoogleQuery <span class="hljs-string"><span class="hljs-string">'AddMember'</span></span> $query) | fl }</code> </pre><br> æ›´æ–°å’Œåˆ›å»ºå¸æˆ·çš„åŠŸèƒ½å…·æœ‰ç›¸åŒçš„è¯­æ³•ï¼Œä¸éœ€è¦æ‰€æœ‰å…¶ä»–å­—æ®µï¼Œåœ¨åŒ…å«ç”µè¯å·ç çš„éƒ¨åˆ†ä¸­ï¼Œæ‚¨éœ€è¦æŒ‡å®šä¸€ä¸ªæ•°ç»„ï¼Œè¯¥æ•°ç»„å¯ä»¥åŒ…å«ä¸€æ¡å¸¦æœ‰ç¼–å·åŠå…¶ç±»å‹çš„è®°å½•ã€‚ <br><br> ä¸ºäº†åœ¨å°†ç”¨æˆ·æ·»åŠ åˆ°ç»„ä¸­æ—¶ä¸ä¼šå‡ºé”™ï¼Œæˆ‘ä»¬å¯ä»¥é¦–å…ˆé€šè¿‡ä»ç”¨æˆ·æœ¬äººé‚£é‡Œæ¥æ”¶ç»„æˆå‘˜åˆ—è¡¨æˆ–ç»„æˆæ¥æ£€æŸ¥ä»–æ˜¯å¦å·²ç»åœ¨è¯¥ç»„ä¸­ã€‚ <br><br>  <b>å¯¹äºç‰¹å®šç”¨æˆ·çš„ç»„ç»„æˆçš„è¯·æ±‚å°†ä¸ä¼šé€’å½’ï¼Œåªä¼šæ˜¾ç¤ºç›´æ¥æˆå‘˜èº«ä»½ã€‚</b> å·²æˆåŠŸå°†ç”¨æˆ·åŒ…å«åœ¨è¯¥ç”¨æˆ·æ‰€å±çš„å­ç»„çš„çˆ¶ç»„ä¸­ã€‚ <br><br><h3>  <font color="#5D8DDF">ç»“è®º</font> </h3><br> ä»ç„¶éœ€è¦å‘ç”¨æˆ·å‘é€æ–°å¸æˆ·çš„å¯†ç ã€‚ æˆ‘ä»¬é€šè¿‡SMSè¿›è¡Œæ­¤æ“ä½œï¼Œå¹¶å‘é€å¸¦æœ‰è¯´æ˜çš„å¸¸è§„ä¿¡æ¯å¹¶ç™»å½•åˆ°ä¸ªäººé‚®ä»¶ï¼Œè¯¥é‚®ä»¶ä¸ç”µè¯å·ç ä¸€èµ·ç”±äººå‘˜é€‰æ‹”éƒ¨é—¨æä¾›ã€‚ å¦ä¸€ç§é€‰æ‹©æ˜¯ï¼Œæ‚¨å¯ä»¥çœé’±å¹¶å‘ç§˜å¯†ç”µæŠ¥èŠå¤©å‘é€å¯†ç ï¼Œè¿™ä¹Ÿå¯ä»¥è§†ä¸ºç¬¬äºŒä¸ªå› ç´ ï¼ˆmacbookæ˜¯ä¾‹å¤–ï¼‰ã€‚ <br><br> æ„Ÿè°¢æ‚¨é˜…è¯»åˆ°æœ€åã€‚ æˆ‘å¾ˆé«˜å…´çœ‹åˆ°æœ‰å…³æ”¹å–„æ–‡ç« å†™ä½œé£æ ¼çš„å»ºè®®ï¼Œå¹¶å¸Œæœ›æ‚¨åœ¨ç¼–å†™è„šæœ¬æ—¶å°‘çŠ¯é”™è¯¯=ï¼‰ <br><br> å¯èƒ½åœ¨ä¸»é¢˜ä¸Šæœ‰ç”¨æˆ–ä»…å›ç­”æ‚¨çš„é—®é¢˜çš„é“¾æ¥åˆ—è¡¨ï¼š <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é€‚ç”¨äºç§»åŠ¨å’Œæ¡Œé¢åº”ç”¨ç¨‹åºçš„OAuth 2.0</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å°†OAuth 2.0ç”¨äºWebæœåŠ¡å™¨åº”ç”¨ç¨‹åº</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">OAuthå…¬å…±å®¢æˆ·ç«¯ç”¨äºä»£ç äº¤æ¢çš„è¯æ˜å¯†é’¥</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä½¿ç”¨PowerShellç”Ÿæˆéšæœºå­—æ¯</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ASCIIè¡¨å’Œè¯´æ˜</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PowerShellï¼šè·å–å­—ç¬¦ä¸²çš„å“ˆå¸Œå€¼</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¼–ç /è§£ç Base64Url</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Base64ç¼–ç ä¸Base64urlç¼–ç </a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PowerShell 5.1ä¸­çš„Invoke-RestMethod</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å³ä½¿åœ¨æ­¥éª¤1ä¸­access_typeå¤„äºè„±æœºçŠ¶æ€ï¼Œä¹Ÿæ— æ³•è·å–åˆ·æ–°ä»¤ç‰Œ</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å…³äºæ¯”è¾ƒè¿ç®—ç¬¦</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç›®å½•APIï¼šç”¨æˆ·å¸æˆ·</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æœç´¢ç”¨æˆ·</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç›®å½•APIï¼šç»„</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Invoke-RestMethodçš„é”™è¯¯å¤„ç†-Powershell</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN468969/">https://habr.com/ru/post/zh-CN468969/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN468957/index.html">ä»¥Unexploredä¸ºä¾‹çš„å¾ªç¯åœ°ä¸‹åŸç”Ÿæˆ</a></li>
<li><a href="../zh-CN468959/index.html">å†°é›¹å¤šæ¨¡å—é¡¹ç›®ä¸­çš„ä¾èµ–ç®¡ç†</a></li>
<li><a href="../zh-CN468961/index.html">å¦‚ä½•æ‘†è„±560ç¾å…ƒçš„ç”Ÿæ´»ä¹ æƒ¯ï¼Ÿ æˆ–å¦‚ä½•ç”Ÿæ´»ï¼Œè€Œä¸æ˜¯ç”Ÿæ´»</a></li>
<li><a href="../zh-CN468963/index.html">å¤‡ä»½ï¼Œåº”è¯»è€…è¦æ±‚æä¾›ä¸€éƒ¨åˆ†ï¼šUrBackupæ¦‚è¿°ï¼ŒBackupPCï¼ŒAMANDA</a></li>
<li><a href="../zh-CN468967/index.html">è·å¾—TAUåŠ¨åŠ›å­¦æ–¹ç¨‹çš„â€œæŠ€æœ¯â€ã€‚ ä»¥åŠä¸ºä»€ä¹ˆç³»ç»Ÿè¯†åˆ«å¾ˆçƒ‚ï¼Œå¹¶ä¸”â€œè¯šå®çš„ç‰©ç†å­¦â€è§„åˆ™</a></li>
<li><a href="../zh-CN468971/index.html">ç”¨Javaä¸ºNintendo DSç¼–å†™</a></li>
<li><a href="../zh-CN468973/index.html">ä½¿ç”¨Pythonä¸­çš„Tensorflowå¯¹å«æ˜Ÿå›¾åƒè¿›è¡Œåˆ†ç±»çš„ç¥ç»ç½‘ç»œ</a></li>
<li><a href="../zh-CN468989/index.html">UEBAå¸‚åœºæ¶ˆå¤±-UEBAä¸‡å²</a></li>
<li><a href="../zh-CN468991/index.html">æ¨¡å—åŒ–ç²¾çµå­—ç¬¦åŠå…¶åŠ¨ç”»</a></li>
<li><a href="../zh-CN468993/index.html">Oculus Questè¿æ¥åˆ°PCå¹¶çœ‹åˆ°æ‰‹</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>