<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèª‚Äç‚öñÔ∏è ü§¥üèº üôÖüèª Histoire sur la conception d'une API üé• üí± üë®üèΩ‚Äçüî¨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Une fois, j'ai aid√© un ami qui avait besoin d'int√©grer des donn√©es sur le logement libre et occup√© du syst√®me de gestion immobili√®re avec le site de s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Histoire sur la conception d'une API</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/436888/">  Une fois, j'ai aid√© un ami qui avait besoin d'int√©grer des donn√©es sur le logement libre et occup√© du syst√®me de gestion immobili√®re avec le site de son client.  √Ä ma grande joie, ce syst√®me avait une API.  Mais malheureusement, cela a √©t√© tr√®s mal organis√©. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dfc/80d/a9e/dfc80da9e77fe55d40b833fe3f5ff9b6.jpg" alt="image"></div><br>  J'ai d√©cid√© d'√©crire cet article non pas pour critiquer le syst√®me qui sera discut√©, mais pour parler des erreurs rencontr√©es lors du d√©veloppement de l'API et sugg√©rer des moyens de corriger ces erreurs. <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">Aper√ßu de la situation</font> </h2><br>  L'organisation en question a utilis√© le syst√®me <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Beds24</a> pour g√©rer l'espace de vie.  Les informations sur ce qui est gratuit et ce qui est occup√© ont √©t√© synchronis√©es avec divers syst√®mes de r√©servation d'h√©bergement (tels que Booking, AirBnB et autres).  L'organisation √©tait engag√©e dans le d√©veloppement du site et souhaitait que la recherche affiche uniquement des informations sur les chambres disponibles pour une p√©riode de temps sp√©cifi√©e et d'une capacit√© appropri√©e.  Cette t√¢che semblait tr√®s simple, puisque Beds24 fournit une API pour l'int√©gration avec d'autres syst√®mes.  En fait, il s'est av√©r√© que les d√©veloppeurs de cette API ont fait beaucoup d'erreurs dans sa conception.  Je propose d'analyser ces erreurs, d'identifier des probl√®mes sp√©cifiques et de parler de la fa√ßon d'aborder le d√©veloppement de l'API dans les situations consid√©r√©es. <br><br><h2>  <font color="#3AC1EF">Probl√®me n ¬∞ 1: demander le format du corps</font> </h2><br>  √âtant donn√© que le client ne s'int√©resse qu'aux informations indiquant si, par exemple, une chambre d'h√¥tel est libre ou occup√©e, nous souhaitons uniquement faire r√©f√©rence au <code>/getAvailabilities</code> API <code>/getAvailabilities</code> .  Et, bien qu'un appel √† une telle API devrait conduire √† des donn√©es sur la disponibilit√© des salles, cet appel ressemble en fait √† une demande POST, car l'auteur de l'API a d√©cid√© de lui donner la possibilit√© d'accepter des filtres en tant que corps JSON de la demande.  Voici une liste des param√®tres de requ√™te possibles et des exemples des valeurs qu'ils acceptent: <br><br><pre> <code class="plaintext hljs">{   "checkIn": "20151001",   "lastNight": "20151002",   "checkOut": "20151003",   "roomId": "12345",   "propId": "1234",   "ownerId": "123",   "numAdult": "2",   "numChild": "0",   "offerId": "1",   "voucherCode": "",   "referer": "",   "agent": "",   "ignoreAvail": false,   "propIds": [       1235,       1236   ],   "roomIds": [       12347,       12348,       12349   ] }</code> </pre> <br>  Parcourons cet objet JSON et parlons de ce qui ne va pas ici. <br><br><ol><li>  Les dates ( <code>checkIn</code> , <code>lastNight</code> et <code>checkOut</code> ) sont au format <code>YYYYMMDD</code> .  Il n'y a absolument aucune raison de ne pas utiliser le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">format</a> standard <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ISO 8601</a> ( <code>YYYY-MM-DD</code> ) lors de la conversion de dates en cha√Ænes, car il s'agit d'une norme largement utilis√©e pour la pr√©sentation des dates.  Il est familier √† de nombreux d√©veloppeurs, c'est ce que de nombreux analyseurs JSON s'attendent √† recevoir en entr√©e.  En outre, il existe un sentiment que le champ <code>lastNight</code> est redondant, car il existe un champ <code>checkOut</code> , qui est toujours repr√©sent√© par une date un jour avant la date sp√©cifi√©e dans <code>lastNight</code> .  En ce qui concerne les lacunes not√©es ci-dessus, je sugg√®re, lors de la conception de telles API, de s'efforcer de toujours utiliser des m√©thodes standard de pr√©sentation des dates et d'essayer de ne pas imposer aux utilisateurs d'API la n√©cessit√© de travailler avec des donn√©es redondantes. </li><li>  Tous les champs d'identifiant, ainsi que les <code>numChild</code> <code>numAdult</code> et <code>numChild</code> , sont num√©riques, mais sont repr√©sent√©s sous forme de cha√Ænes.  Dans ce cas, il n'y a aucune raison apparente de les repr√©senter sous forme de cha√Ænes. </li><li>  Ici, vous pouvez remarquer les paires de champs suivants: <code>roomId</code> et <code>roomIds</code> , ainsi que <code>propId</code> et <code>propIds</code> .  La pr√©sence des <code>propId</code> <code>roomId</code> et <code>propId</code> est redondante, car les deux peuvent √™tre utilis√©s pour transmettre des identifiants.  De plus, il y a un probl√®me avec les types.  Veuillez noter que le champ <code>roomId</code> est un champ de cha√Æne et que les valeurs num√©riques des identifiants doivent √™tre utilis√©es dans le tableau <code>roomIds</code> .  Cela peut entra√Æner de la confusion, des probl√®mes d'analyse et, en outre, sugg√®re que sur le serveur certaines op√©rations sont effectu√©es avec des cha√Ænes et d'autres avec des nombres, malgr√© le fait que ces cha√Ænes et nombres sont utilis√©s pour repr√©senter les m√™mes les donn√©es. </li></ol><br>  Je voudrais inviter les d√©veloppeurs d'API √† essayer de ne pas compliquer la vie de ceux qui utiliseront ces API, tout en faisant des erreurs comme les API lors de la conception des API.  √Ä savoir, il faut s'efforcer de mettre en forme des donn√©es standard, pour s'assurer qu'elles ne sont pas redondantes, pour s'assurer que diff√©rents types de donn√©es ne sont pas utilis√©s pour repr√©senter des entit√©s homog√®nes.  Et ne repr√©sentez pas tout sans distinction comme des cha√Ænes. <br><br><h2>  <font color="#3AC1EF">Probl√®me n ¬∞ 2: format du corps de r√©ponse</font> </h2><br>  Comme d√©j√† mentionn√©, nous ne sommes int√©ress√©s que par le <code>/getAvailabilities</code> API <code>/getAvailabilities</code> .  Voyons √† quoi ressemble la r√©ponse de ce point final et parlons des lacunes qui ont √©t√© commises lors de sa formation.  N'oubliez pas que lorsque vous acc√©dez √† l'API, nous sommes int√©ress√©s par une liste d'identifiants d'objets gratuits pendant une p√©riode de temps donn√©e et pouvant accueillir un nombre donn√© de personnes.  Vous trouverez ci-dessous un exemple du corps de la demande √† l'API et un exemple de ce qu'elle renvoie en r√©ponse √† cette demande. <br><br>  Voici la demande: <br><br><pre> <code class="plaintext hljs">{   "checkIn": "20190501",   "checkOut": "20190503",   "ownerId": "25748",   "numAdult": "2",   "numChild": "0" }</code> </pre> <br>  Voici la r√©ponse: <br><br><pre> <code class="plaintext hljs">{   "10328": {       "roomId": "10328",       "propId": "4478",       "roomsavail": "0"   },   "13219": {       "roomId": "13219",       "propId": "5729",       "roomsavail": "0"   },   "14900": {       "roomId": "14900",       "propId": "6779",       "roomsavail": 1   },   "checkIn": "20190501",   "lastNight": "20190502",   "checkOut": "20190503",   "ownerId": 25748,   "numAdult": 2 }</code> </pre> <br>  Parlez des probl√®mes de r√©ponse. <br><br><ol><li>  Dans le corps de la r√©ponse, les <code>numAdult</code> <code>ownerId</code> et <code>numAdult</code> soudainement devenues des nombres.  Et dans la demande, il fallait les indiquer sous forme de cha√Ænes. </li><li>  La liste des objets immobiliers est pr√©sent√©e sous forme de propri√©t√©s d'objet dont les cl√©s sont des identifiants de pi√®ce ( <code>roomId</code> ).  Il serait logique de s'attendre √† ce que ces donn√©es soient sorties sous forme de tableau.  Pour nous, cela signifie que pour obtenir une liste des pi√®ces disponibles, nous devons <code>roomsavail</code> sur l'objet entier, tout en v√©rifiant la pr√©sence de certaines propri√©t√©s des objets qu'il <code>roomsavail</code> , comme <code>roomsavail</code> , et sans pr√™ter attention √† quelque chose comme <code>checkIn</code> et <code>lastNight</code> .  Ensuite, il serait n√©cessaire de v√©rifier la valeur de la propri√©t√© <code>roomsavail</code> , et si elle est sup√©rieure √† 0, nous pourrions conclure que la propri√©t√© correspondante est disponible √† la r√©servation.  Voyons maintenant la propri√©t√© <code>roomsavail</code> .  Voici les options pour le pr√©senter dans le corps de la r√©ponse: <code>"roomsavail": "0"</code> et <code>"roomsavail": 1</code> .  Voir le motif?  Si les pi√®ces sont occup√©es, la valeur de la propri√©t√© est repr√©sent√©e par une cha√Æne.  S'il est gratuit - il se transforme en nombre.  Cela peut entra√Æner de nombreux probl√®mes dans les langages strictement li√©s aux types de donn√©es, car la m√™me propri√©t√© ne doit pas prendre de valeurs de types diff√©rents.  En relation avec ce qui pr√©c√®de, je voudrais sugg√©rer aux d√©veloppeurs d'utiliser des tableaux d'objets JSON pour repr√©senter certains ensembles de donn√©es, et de ne pas utiliser de constructions incommodes sous la forme de paires cl√©-valeur similaires √† celle que nous consid√©rons ici.  De plus, il est n√©cessaire de s'assurer que les champs d'objets homog√®nes ne contiennent pas de donn√©es de types diff√©rents.  Une r√©ponse de serveur correctement format√©e pourrait ressembler √† celle ci-dessous.  Veuillez noter que lors de la pr√©sentation des donn√©es dans ce formulaire, les informations sur la chambre ne contiennent pas de donn√©es en double. </li></ol><br><pre> <code class="plaintext hljs">{   "properties": [       {           "id": 4478,           "rooms": [               {                   "id": 12328,                   "available": false               }           ]       },       {           "id": 5729,           "rooms": [               {                   "id": 13219,                   "available": false               }           ]       },       {           "id": 6779,           "rooms": [               {                   "id": 14900,                   "available": true               }           ]       }   ],   "checkIn": "2019-05-01",   "lastNight": "2019-05-02",   "checkOut": "2019-05-03",   "ownerId": 25748,   "numAdult": 2 }</code> </pre> <br><h2>  <font color="#3AC1EF">Probl√®me 3: gestion des erreurs</font> </h2><br>  C'est ainsi que la gestion des erreurs est organis√©e dans l'API consid√©r√©e ici: le syst√®me envoie des r√©ponses avec un code de <code>200</code> √† toutes les requ√™tes, m√™me en cas d'erreur.  Cela signifie que la seule fa√ßon de distinguer une r√©ponse normale d'une r√©ponse avec un message d'erreur est d'analyser le corps de la r√©ponse et de v√©rifier la pr√©sence des champs <code>error</code> ou <code>errorCode</code> .  Seuls les 6 codes d'erreur suivants sont fournis dans l'API. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/03c/627/623/03c627623d8d26449cd6788e747643aa.png"></div><br>  <i><font color="#999999">Codes d'erreur de l'API Beds24</font></i> <br><br>  Je sugg√®re √† tous ceux qui liront ceci de ne pas renvoyer de r√©ponse avec le code 200 (traitement r√©ussi de la demande) si quelque chose s'est mal pass√© lors du traitement de la demande.  Vous ne pouvez effectuer cette √©tape que si elle est fournie par le framework sur la base duquel vous d√©veloppez l'API.  Le renvoi de codes de r√©ponse ad√©quats permet aux clients API de savoir √† l'avance s'ils doivent analyser le corps de la r√©ponse ou non, et comment le faire (c'est-√†-dire, s'il faut analyser une r√©ponse de serveur normale ou un objet d'erreur). <br><br>  Dans notre cas, il y a deux fa√ßons d'am√©liorer l'API dans cette direction: vous pouvez soit fournir un code HTTP sp√©cial dans la plage 400-499 pour chacune des 6 erreurs possibles (il est pr√©f√©rable de le faire), soit renvoyer, si une erreur se produit, le code 500, qui permettra au moins, le client doit savoir avant d'analyser le corps de la r√©ponse qu'il contient des informations sur l'erreur. <br><br><h2>  <font color="#3AC1EF">Probl√®me num√©ro 4: "instructions"</font> </h2><br>  Voici les ¬´instructions¬ª pour utiliser l'API √† partir de la documentation du projet: <br><br>  Veuillez lire les instructions suivantes lorsque vous utilisez l'API. <br><br><ol><li>  Les appels d'API doivent √™tre con√ßus de telle sorte que lors de leur ex√©cution, ils doivent envoyer et recevoir un minimum de donn√©es. </li><li>  Les appels d'API sont effectu√©s un √† la fois.  Vous devez attendre le prochain appel √† l'API avant de passer le prochain appel. </li><li>  Si vous devez effectuer plusieurs appels √† l'API, une pause de quelques secondes doit √™tre pr√©vue entre eux. </li><li>  Les appels d'API ne doivent pas √™tre effectu√©s trop souvent, maintenant le niveau d'appels au niveau minimum n√©cessaire pour r√©soudre les t√¢ches client. </li><li>  Une utilisation excessive de l'API dans un d√©lai de 5 minutes entra√Ænera la suspension de votre compte sans notifications suppl√©mentaires. </li><li>  Nous nous r√©servons le droit de bloquer l'acc√®s au syst√®me aux clients qui, √† notre avis, utilisent excessivement l'API.  Cela se fait √† notre discr√©tion et sans pr√©avis. </li></ol><br>  Bien que les points 1 et 4 semblent tout √† fait justifi√©s, je ne suis pas d'accord avec les autres points de cette instruction.  Consid√©rez-les. <br><br><ol><li>  Num√©ro d'article 2.  Si vous d√©veloppez une API REST, il est suppos√© que ce sera une API ind√©pendante de l'√©tat.  L'ind√©pendance des appels API par rapport aux appels pr√©c√©dents est l'une des raisons pour lesquelles la technologie REST a trouv√© une large application dans les applications cloud.  Si un certain module du syst√®me ne prend pas en charge l'√©tat, il peut √™tre facilement red√©ploy√© en cas d'erreur.  Les syst√®mes bas√©s sur de tels modules √©voluent facilement lorsque la charge sur eux change.  Lors de la conception d'une API RESTful, vous devez vous assurer qu'il s'agit d'une API ind√©pendante de l'√©tat et que ceux qui l'utilisent n'ont pas √† se soucier de quelque chose comme ex√©cuter une seule demande √† la fois. </li><li>  Num√©ro d'article 3.  Cet article semble plut√¥t √©trange et ambigu.  Je ne comprends pas la raison pour laquelle ce paragraphe de l'instruction a √©t√© √©crit, mais j'ai l'impression qu'il nous dit que dans le processus de traitement de la demande, le syst√®me effectue certaines actions et s'il est "distrait" par une autre demande, pas envoy√©e √† temps, cela peut interf√©rer avec son travail.  De plus, le fait que l'auteur du manuel dise ¬´quelques secondes¬ª ne nous permet pas de conna√Ætre la dur√©e exacte de la pause qui doit √™tre maintenue entre les demandes successives. </li><li>  Points n ¬∞ 5 et n ¬∞ 6.  Il fait r√©f√©rence √† ¬´une utilisation excessive de l'API¬ª, mais aucun crit√®re pour une ¬´utilisation excessive¬ª n'est donn√©.  Peut-√™tre que c'est 10 requ√™tes par seconde?  Ou peut-√™tre 1?  De plus, certains projets Web peuvent g√©n√©rer d'√©normes quantit√©s de trafic.  Si, sans raison ad√©quate et sans notification, ils ferment l'acc√®s √† l'API dont ils ont besoin, leurs administrateurs refuseront tr√®s probablement d'utiliser ces API.  Si vous √©crivez de telles instructions, utilisez un langage clair et mettez-vous √† la place des utilisateurs qui doivent travailler avec votre syst√®me, guid√©s par vos instructions. </li></ol><br><h2>  <font color="#3AC1EF">Probl√®me num√©ro 5: documentation</font> </h2><br>  Voici √† quoi ressemble la documentation de l'API. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5b6/8bf/ae6/5b68bfae633a5c394a5f11d3b8c228ce.png"></div><br>  <i><font color="#999999">Documentation de l'API Beds24</font></i> <br><br>  Le seul probl√®me avec cette documentation est son apparence.  Il serait beaucoup mieux s'il √©tait bien format√©.  Surtout afin de montrer l'apparence possible d'une telle documentation, j'ai, en utilisant <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Dillinger</a> , et y consacrant moins de deux minutes, en faire la version suivante.  √Ä mon avis, cela semble beaucoup mieux que ce qui pr√©c√®de. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ac4/e71/7fe/ac4e717fe2757b3f4af62733a857ff2b.png"></div><br>  <i><font color="#999999">Documentation am√©lior√©e</font></i> <br><br>  Pour cr√©er de tels mat√©riaux, il est recommand√© d'utiliser des outils sp√©ciaux.  Si nous parlons de documents simples similaires √† celui d√©crit ci-dessus, alors quelque chose comme un fichier de d√©marque ordinaire est tout √† fait suffisant pour leur conception.  Si la documentation est plus compliqu√©e, alors pour sa conception, il est pr√©f√©rable d'utiliser des outils comme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Swagger</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Apiary</a> . <br><br>  Soit dit en passant, si vous souhaitez consulter la documentation de l'API Beds24, jetez un ≈ìil <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br><h2>  <font color="#3AC1EF">Probl√®me 6: S√©curit√©</font> </h2><br>  La documentation de tous les points de terminaison API indique ce qui suit: <br><br>  <i><font color="#999999">Pour utiliser ces fonctions, l'acc√®s √† l'API doit √™tre autoris√©.</font></i>  <i><font color="#999999">Cela se fait dans le menu PARAM√àTRES ‚Üí COMPTE ‚Üí ACC√àS AU COMPTE.</font></i> <br><br>  Cependant, en r√©alit√©, n'importe qui peut acc√©der √† cette API et, √† l'aide de certains appels, en obtenir des informations sans fournir d'informations d'identification.  Par exemple, cela s'applique √©galement aux requ√™tes concernant la disponibilit√© de certains logements.  Ceci est discut√© dans une autre partie de la documentation. <br><br>  <i><font color="#999999">La plupart des m√©thodes JSON n√©cessitent une cl√© API pour acc√©der √† un compte.</font></i>  <i><font color="#999999">La cl√© d'acc√®s API peut √™tre d√©finie √† l'aide du menu PARAM√àTRES ‚Üí COMPTE ‚Üí ACC√àS AU COMPTE.</font></i> <br><br>  En plus de l'explication incompr√©hensible des probl√®mes d'authentification, il s'av√®re que l'utilisateur doit cr√©er lui-m√™me la cl√© pour acc√©der √† l'API (cela se fait, en passant, en remplissant manuellement le champ correspondant, certains moyens pour cr√©er automatiquement des cl√©s ne sont pas fournis).  La longueur de cl√© doit √™tre comprise entre 16 et 64 caract√®res.  Si vous autorisez les utilisateurs √† cr√©er leurs propres cl√©s pour acc√©der √† l'API, cela peut entra√Æner l'apparition de cl√©s tr√®s peu s√©curis√©es qui peuvent √™tre facilement r√©cup√©r√©es.  Dans une situation similaire, des probl√®mes li√©s au contenu des cl√©s sont possibles, car vous pouvez entrer n'importe quoi dans le champ cl√©.  Dans le pire des cas, cela pourrait conduire √† une attaque sur le service en utilisant l'injection SQL ou quelque chose comme √ßa.  Lors de la conception d'une API, n'autorisez pas les utilisateurs √† cr√©er eux-m√™mes des cl√©s pour acc√©der √† l'API.  Au lieu de cela, g√©n√©rez-leur automatiquement des cl√©s.  L'utilisateur ne doit pas √™tre en mesure de modifier le contenu d'une telle cl√©, mais, si n√©cessaire, il doit pouvoir g√©n√©rer une nouvelle cl√©, reconnaissant l'ancienne comme non valide. <br><br>  Dans le cas des demandes qui n√©cessitent une authentification, nous voyons un autre probl√®me.  Il consiste en ce qu'un jeton d'authentification doit √™tre envoy√© dans le cadre du corps de la requ√™te.  Voici comment cela est d√©crit dans la documentation. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b45/548/cb9/b45548cb94e4cd4dd64ae53ec5c6dbb8.png"></div><br>  <i><font color="#999999">Exemple d'authentification de l'API Beds24</font></i> <br><br>  Si le jeton d'authentification est transmis dans le corps de la demande, cela signifie que le serveur devra analyser le corps de la demande avant qu'il n'atteigne la cl√©.  Apr√®s cela, il extrait la cl√©, effectue l'authentification, puis d√©cide - que doit-il faire de la demande - de l'ex√©cuter ou non.  Si l'authentification r√©ussit, le serveur ne sera pas soumis √† une charge suppl√©mentaire, car dans ce cas, le corps de la demande devra encore √™tre analys√©.  Mais si la demande n'a pas pu s'authentifier, un temps processeur pr√©cieux sera consacr√© √† l'analyse du corps de la demande pour rien.  Il serait pr√©f√©rable d'envoyer un jeton d'authentification dans l'en-t√™te de la demande, en utilisant quelque chose comme un sch√©ma d'authentification au <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">porteur</a> .  Avec cette approche, le serveur devra analyser le corps de la requ√™te uniquement si l'authentification r√©ussit.  Une autre raison pour laquelle nous recommandons d'utiliser un sch√©ma standard comme Bearer pour l'authentification est le fait que la plupart des d√©veloppeurs connaissent ces sch√©mas. <br><br><h2>  <font color="#3AC1EF">Probl√®me num√©ro 7: performances</font> </h2><br>  C'est le dernier num√©ro de ma liste, mais il n'enl√®ve rien √† son importance.  Le fait est qu'il faut un peu plus d'une seconde pour terminer la demande √† l'API en question.  Dans les applications modernes, de tels retards peuvent √™tre inacceptables.  En fait, ici, vous pouvez conseiller √† toutes les personnes impliqu√©es dans le d√©veloppement de l'API de ne pas oublier les performances. <br><br><h2>  <font color="#3AC1EF">R√©sum√©</font> </h2><br>  Malgr√© tous les probl√®mes dont nous parlions ici, l'API en question nous a permis de r√©soudre les probl√®mes rencontr√©s par le projet.  Mais les d√©veloppeurs ont pris beaucoup de temps pour comprendre l'API et impl√©menter tout ce dont ils ont besoin.  De plus, pour r√©soudre des probl√®mes simples, ils ont d√ª √©crire du code assez compliqu√©.  Si cette API √©tait con√ßue comme il se doit, le travail se ferait plus rapidement et la solution cl√© en main serait plus simple. <br><br>  Par cons√©quent, je voudrais demander √† tous ceux qui con√ßoivent l'API de r√©fl√©chir √† la fa√ßon dont les utilisateurs de leurs services travailleront avec elle.  Assurez-vous que la documentation de l'API d√©crit pleinement leurs capacit√©s, afin qu'elle soit compr√©hensible et bien con√ßue.  Contr√¥lez la d√©nomination des entit√©s, assurez-vous que les donn√©es que votre API √©met ou re√ßoit sont clairement structur√©es afin qu'il soit facile et pratique de travailler avec elles.  De plus, n'oubliez pas la s√©curit√© et le traitement correct des erreurs.  Si nous prenons en compte tout ce dont nous avons parl√© lors de la conception de l'API, vous n'avez pas besoin d'√©crire quelque chose comme les √©tranges ¬´instructions¬ª dont nous avons discut√© ci-dessus pour travailler avec. <br><br>  Comme d√©j√† mentionn√©, ce mat√©riel n'est pas destin√© √† d√©courager les lecteurs d'utiliser Beds24 ou tout autre syst√®me avec une API mal con√ßue.  Mon objectif √©tait de montrer des exemples d'erreurs et d'approches √† leur solution, de donner des recommandations, √† la suite desquelles chacun pourrait am√©liorer la qualit√© de ses d√©veloppements.  J'esp√®re que ce mat√©riel attirera l'attention des programmeurs qui le liront sur la qualit√© des solutions qu'ils d√©veloppent.  Cela signifie qu'il y aura plus de bonnes API dans le monde. <br><br>  <b>Chers lecteurs!</b>  Avez-vous rencontr√© des API mal con√ßues? <br><br><div style="text-align:center;"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr436888/">https://habr.com/ru/post/fr436888/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr436876/index.html">[SAP] SAPUI5 for dummies part 1: Un exercice complet √©tape par √©tape</a></li>
<li><a href="../fr436878/index.html">BERT est un mod√®le de langage de pointe pour 104 langues. Tutoriel pour lancer BERT localement et sur Google Colab</a></li>
<li><a href="../fr436880/index.html">Notions de base sur les mod√®les C ++: mod√®les de fonctions</a></li>
<li><a href="../fr436884/index.html">Nous ma√Ætrisons async / wait sur un exemple r√©el</a></li>
<li><a href="../fr436886/index.html">Utiliser Babel et Webpack pour configurer un projet React √† partir de z√©ro</a></li>
<li><a href="../fr436890/index.html">Tutoriel React Partie 10: Atelier sur l'utilisation des propri√©t√©s et du style des composants</a></li>
<li><a href="../fr436892/index.html">Tutoriel React, partie 11: Formation de balisage dynamique et m√©thode du tableau de cartes</a></li>
<li><a href="../fr436894/index.html">Apocalypse informatique rampante. De nouveaux services cloud laisseront certains ing√©nieurs sans emploi</a></li>
<li><a href="../fr436896/index.html">docker-pretty-ps - enfin un ps docker lisible</a></li>
<li><a href="../fr436900/index.html">FunTech ML-meetup</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>