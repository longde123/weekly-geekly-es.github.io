<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍸 🐶 🚃 Sportiduino - sistem penandaan elektronik untuk acara olahraga, bagian 3 🈵 👩🏿‍🔧 🧕🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="→ Bagian 1 , Bagian 2 

 Setahun telah berlalu sejak publikasi terakhir, dan saya sering ditanya pertanyaan tentang apa yang telah berubah sejak saat ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sportiduino - sistem penandaan elektronik untuk acara olahraga, bagian 3</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/427661/">  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian 1</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian 2</a> <br><br>  Setahun telah berlalu sejak publikasi terakhir, dan saya sering ditanya pertanyaan tentang apa yang telah berubah sejak saat itu.  Singkatnya, transisi ke chip Ntag dibuat, perubahan kecil dibuat di sirkuit untuk memberikan sensitivitas yang lebih baik, volume sinyal dan gerakan jam yang benar, dan perangkat lunak diciptakan untuk bekerja dengan sistem.  Secara umum, sistem telah stabil dan siap untuk diputar dan digunakan.  Lebih detail di bawah ini. <br><a name="habracut"></a><br>  Pertama-tama, saya akan memberi tahu Anda tentang chip RFID, mengapa transisi dilakukan menuju Ntag.  Biarkan saya mengingatkan Anda bahwa memori Mifare Classic 1K berisi 1024 byte, yang 752 byte tersedia untuk menyimpan informasi.  Struktur memori dibagi menjadi 16 blok, yang berisi 4 halaman 16 byte, salah satunya dicadangkan untuk enkripsi.  Jika Anda menggunakan satu halaman sebagai layanan, maka masih ada 46 halaman untuk merekam tanda. <br><br>  Pada awal pengembangan, saya menggunakan memori secara bebas - satu halaman 16 byte per tanda, yang membatasi penggunaan awal yang kecil.  Dan untuk rogaining, turis orienteering atau balap petualangan, 46 stasiun sedikit.  Oleh karena itu, ide pemadatan diwujudkan: dua tanda ditulis pada setiap halaman.  Pada saat yang sama, ada risiko kehilangan data, karena unit rekaman adalah satu halaman, dan ketika merekam ulang, Anda harus membaca setengah yang sudah direkam untuk menulisnya lagi.  Sebenarnya, saya menginjak menyapu ini selama Rogaining November lalu, sebagian kecil dari data hilang, saya harus mengedit banyak secara manual.  Dan, meskipun kesalahan dalam kode terdeteksi, saya memutuskan untuk beralih ke chip yang lebih luas tanpa risiko kehilangan data selama penulisan ulang. <br><br>  Salah satu opsi yang mungkin adalah menggunakan chip Mifare 4K, struktur yang berbeda dari 1K hanya dalam empat kali jumlah memori yang besar.  Tapi keripik seperti itu lebih mahal dan durasi pembersihan, tanda dengan penggunaannya akan meningkat.  Pilihan lain adalah menggunakan chip seri Ntag (213/215/216).  Struktur memori chip Ntag cukup sederhana - memori dibagi menjadi halaman 4 byte, 4 halaman pertama dan 5 halaman terakhir dicadangkan untuk menyimpan informasi layanan, sisanya dapat digunakan.  Chip seri Ntag berbeda dalam ukuran memori, Ntag213 memiliki 36 halaman (144 byte) gratis, Ntag215 memiliki 126 halaman (504 byte), dan Ntag216 memiliki 222 halaman (888 byte).  Sebagai hasilnya, saya menerapkan dukungan untuk semua chip dalam seri ini, meskipun Ntag215 dapat dianggap optimal, yang ingatannya cukup untuk 120 tanda, dan harganya cukup rendah (sekitar $ 0,2 per chip dalam bentuk stiker atau $ 0,4 dalam bentuk gantungan kunci).  Juga, atas saran SFR, ia memutuskan untuk meninggalkan penyimpanan informasi penting - jumlah halaman gratis terakhir yang mendukung pencarian binernya.  Ini menambah stempel waktu, tetapi meningkatkan keandalan. <br><br>  Halaman memori Ntag berisi 4 byte, di mana Anda harus menyesuaikan nomor stasiun - 1 byte dan cap waktu - 4 byte.  Masalahnya dipecahkan oleh fakta bahwa waktu penuh inisialisasi (pembersihan) chip ditulis dalam halaman terpisah, dan ketika ditandai, hanya 3 byte lebih rendah dari waktu.  Kemudian, ketika membaca, waktu tanda sepenuhnya dikembalikan berdasarkan waktu inisialisasi.  Halaman lain dalam chip ditempati oleh nomor chip dan dua tersisa sebagai cadangan.  Struktur yang dihasilkan disajikan di bawah ini: <br><br><img src="https://habrastorage.org/webt/x4/zv/yv/x4zvyv3m8q5tmcznc__em4jcaqy.jpeg"><br><br>  Menggunakan Ntag memungkinkan memecahkan masalah perekaman yang aman dari sejumlah besar tanda pada chip, tetapi masalah lain muncul.  Chip Ntag membutuhkan daya pemancar lebih banyak daripada Mifare dengan area antena yang sama, dan chip gantungan kunci dengan antena berukuran 2 cm ^ 2 mungkin tidak berfungsi dengan baik pada modul RC522 sebagai standar.  Solusi untuk masalah ini adalah menyolder induktansi pada modul ke yang lebih kuat.  Pada saat yang sama, rentang respons meningkat secara signifikan, untuk chip Ntag hingga 2 cm, dan untuk Mifare hingga 3 cm. Tetapi beberapa modul mulai bekerja dengan buruk karena penyolderan seperti itu: chip direkam hanya dengan jarak tertentu dan agak tak terduga dari antena pengirim.  Saya harus masuk ke perpustakaan Arduino RC522 dan menemukan parameter gain di sana, yang bertanggung jawab untuk kekuatan antena, mengeditnya untuk setiap stasiun menyelesaikan masalah.  Dia juga menguasai pembuatan chip secara manual pada gelang dari stiker.  Alibaba sudah siap pakai dan cantik, tetapi area antena mereka hampir setengah dari itu, tanda melewati kurang stabil.  Saya juga mencatat bahwa saya meninggalkan dukungan untuk chip Mifare 1K, Anda dapat bekerja dengan mereka, tetapi untuk ini Anda perlu menggunakan firmware terpisah, dan kapasitas chip terbatas hingga 42 tanda, tetapi mereka datang dengan modul RC522. <br><br><img src="https://habrastorage.org/webt/d3/gm/oc/d3gmocpv7hk81ahbkk2fbddxhea.jpeg"><br><br>  Masalah lain yang harus dipecahkan selama pengembangan adalah jalannya waktu yang salah.  Di beberapa stasiun, jam mulai terlambat atau terburu-buru hingga 5 menit sehari.  Untuk waktu yang lama saya tidak dapat memahami apa alasannya, kemudian saya menemukan bahwa hanya stasiun dengan papan sirkuit cetak yang dibuat di pabrik buggy, sementara semuanya bekerja dengan baik pada yang dietsa secara manual.  Saya berpikir tentang apa yang bisa dihubungkan dengan ini.  Di jalan yang agak terukir dengan tangan karena timah yang melimpah, daya tahan yang kurang.  Ternyata kapasitor pada keluaran dari stabilizer tidak cukup untuk memisahkan daya jam pada trek pabrik yang tipis.  Saya meletakkan kapasitor lain di dekat jam, dan masalahnya, sebagian besar, diselesaikan.  Sebagian kecil arloji masih gagal, tetapi saya sudah mengaitkan ini dengan perkawinan arloji murah dengan ali, Anda perlu mencari pemasok yang dapat diandalkan. <br><br>  Nah, perubahan terakhir di sirkuit adalah penguatan sinyal suara.  Sebelumnya, kontrol dan kekuatan tweeter di sirkuit dilakukan dari kaki mikrokontroler, oleh karena itu cukup terbatas daya.  Sekarang daya langsung dari baterai, dan kontrol melalui transistor, yang secara signifikan meningkatkan volume sinyal.  Semua perubahan ini sekarang diperhitungkan dan dimasukkan ke dalam file Gerber, tetapi saya secara manual mengolah sekitar 40 stasiun, saya harus memilih kompleks, memotong rel, menggantung transistor pada kabel, ada beberapa stasiun rusak. <br><br><img src="https://habrastorage.org/webt/tm/n4/y9/tmn4y9n0ild0bvrr1bzh_jvoweq.jpeg"><br><br>  Karena transisi ke chip lain, firmware stasiun induk harus banyak berubah, tetapi prinsip dan logika kerja, sebagian besar, tetap sama.  Mode penghematan energi, tidur, kerja, pengaturan yang sama menggunakan chip utama.  Tetapi firmware gateway telah sepenuhnya didesain ulang.  Protokol komunikasi sebelumnya, ketika data mengalir di port COM dalam aliran kontinu, tampak rentan: satu byte tidak ada, dan semua data berubah menjadi labu.  Mengadaptasi protokol transfer data yang ada tampak membosankan, jadi dia menemukan sepedanya. <br><br>  Informasi ditransmisikan dan diterima secara berurutan dengan mengirimkan paket hingga 32 byte.  Jika data yang dikirimkan tidak sesuai dengan paket, transmisi dibuat dengan meneruskan paket secara berurutan.  Paket dimulai dengan byte awal 0xFE, diikuti oleh nomor perintah, panjang paket, data, dan pada akhir checksum.  Perintah hanya lulus dengan nilai yang benar dari checksum dan mulai byte.  Cukup sederhana dan cukup andal. <br><br><img src="https://habrastorage.org/webt/oo/cr/ma/oocrma2ibcdulbqoncpeyqqkdlm.jpeg"><br><br>  Sambungan dibuat, tetapi perlu untuk menulis perangkat lunak normal untuk komputer, kerajinan saya pada Pemrosesan tidak cocok untuk ini.  Semyon Yakimov, yang menciptakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">modul</a> Python untuk bekerja dengan sistem, menerima ini, yang sangat ia syukuri.  Modul ini memungkinkan Anda untuk berkomunikasi dengan gateway, mengirim dan menerima data dalam format yang mudah.  Setelah itu, saya menguasai Python sebagai pendekatan pertama dan menulis <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">aplikasi GUI</a> sederhana berdasarkan modul ini dan PyQt, yang dapat digunakan untuk mengkonfigurasi sistem, serta untuk mengumpulkan data dari chip dalam bentuk file JSON.  Nah, maka data dapat diproses menggunakan skrip kecil untuk kompetisi dengan berbagai kondisi dan aturan, dikeluarkan dalam bentuk yang nyaman ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">orientasi wisata</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">rogaining</a> ).  Tapi, bagaimanapun, ini menyiratkan beberapa keterampilan, dan kebahagiaan tidak akan lengkap jika bukan untuk para pengembang program <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">SportOrg</a> , yang menambahkan dukungan untuk Sportiduino (selain Sportident dan SFR).  Program ini secara aktif berkembang dan banyak hal yang dapat menilai mulai berorientasi. <br><br><h3>  Kesimpulan </h3><br>  Dengan demikian, saat ini ada perangkat keras dan perangkat lunak yang berfungsi stabil.  Saya percaya bahwa tujuan usaha telah tercapai: sistem penandaan elektronik yang murah telah muncul.  Saya tidak akan mengubah apa pun dalam kerangka skema ini, kecuali jika ada semacam bug.  Sistem penandaan telah dikembangkan dan diuji di sejumlah besar kompetisi yang berbeda: orienteering, rogaining, march-throw, trail, stage turis.  Selain saya, ini digunakan oleh beberapa orang di tempat yang berbeda.  Seseorang memainkan sistem, seseorang membuat tambahan di sana, misalnya, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">modul radio</a> atau penggunaan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">baterai lithium dan</a> chip <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Mifare</a> sebagai yang utama. <br><br>  Pengembangan terbuka dan non-komersial, dilisensikan di bawah GNU GPLv3.  Siapa pun dapat dengan bebas menyalin, mereproduksi, memodifikasi, dan menggunakannya.  Selama setahun terakhir, saya telah mengajukan banyak pertanyaan apakah saya melakukan penjualan stasiun.  Tidak, saya tidak ingin melakukan ini.  Di sisi lain, saya tidak keberatan jika seseorang mengisi ceruk ini.  Saya hanya siap memberikan saran tentang perakitan dan penggunaan, karena semuanya cukup sederhana di sana. <br><br>  Proyek ini tersedia di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">github</a> , ada diagram, instruksi, dan materi lain yang bermanfaat.  Terima kasih atas perhatian anda </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id427661/">https://habr.com/ru/post/id427661/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id427647/index.html">Laporan Tesla (TSLA) Q3 2018</a></li>
<li><a href="../id427649/index.html">Memasak Matriks di rumah</a></li>
<li><a href="../id427653/index.html">Distribusikan dan taklukkan: tata letak sekarang dan sekarang</a></li>
<li><a href="../id427655/index.html">Traefik sebagai Pengontrol Ingress untuk K8S</a></li>
<li><a href="../id427657/index.html">Menggunakan Inspektur Animasi di Alat Pengembang Chrome</a></li>
<li><a href="../id427663/index.html">Habro beruang dan kepiting</a></li>
<li><a href="../id427665/index.html">Timbangan cerdas terbaik (menurut Wareable)</a></li>
<li><a href="../id427669/index.html">Kontrol Rumah KNX: Pencahayaan</a></li>
<li><a href="../id427671/index.html">Sberbank dan Yandex secara resmi meluncurkan platform perdagangan Beru, Amazon versi Rusia</a></li>
<li><a href="../id427673/index.html">Pembelajaran mesin @ booking.com</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>