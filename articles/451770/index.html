<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍒 🤾🏾 ✌️ Veeam Backup & Replication: consejos útiles para hacer viables las copias de seguridad y réplicas 👨🏿‍🚀 👂🏽 👂🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hoy, nuevamente me complace presentarles buenos consejos de mi colega Evgeny Ivanov, líder del equipo de soporte técnico de Veeam. Esta vez, Zhenya co...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Veeam Backup & Replication: consejos útiles para hacer viables las copias de seguridad y réplicas</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/veeam/blog/451770/">  Hoy, nuevamente me complace presentarles buenos consejos de mi colega Evgeny Ivanov, líder del equipo de soporte técnico de Veeam.  Esta vez, Zhenya compartió recomendaciones para trabajar con copias de seguridad y réplicas.  Espero que lo ayuden a evitar errores comunes, y sus réplicas y copias de seguridad nunca serán un "eslabón débil" en el proceso de recuperación, si es necesario. <br><br>  Así que bienvenido al gato. <br><br><img src="https://habrastorage.org/webt/n2/lg/ct/n2lgctuzddu-htv1gqmsy-f8jx4.png"><br><a name="habracut"></a><br>  En mi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">artículo</a> anterior <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">,</a> descubrimos cómo optimizar la carga en los componentes de la infraestructura de respaldo y examinamos los errores de configuración típicos.  Pasamos a otro tema importante: la preparación competente y la implementación de la recuperación.  También lo analizaremos con ejemplos reales con los que el equipo de soporte técnico ha trabajado. <br><br><h1>  Copia de seguridad sin restaurante: dinero por el desagüe </h1><br>  Nos contactan regularmente los usuarios que se encuentran en situaciones difíciles similares: es necesario realizar una recuperación de la copia de seguridad, pero cuando intentan hacerlo, las personas se topan con un problema insoluble para ellos.  Y este problema no es en absoluto la falta de una copia de seguridad, la actividad de CryptoLocker o algo así.  Esto es "simplemente" una falta de atención para verificar las copias de seguridad y las réplicas para la recuperación.  Muchos a menudo se centran únicamente en el proceso de copia de seguridad, olvidando que simplemente tener una copia de seguridad no es una panacea para posibles problemas.  Debe comprender que la recuperación es un proceso completamente diferente, que tiene sus propias características y que debe ser monitoreado y probado antes de iniciar la producción.  Aquí hay algunos ejemplos ilustrativos: <br><br><ol><li>  El usuario tuvo una falla en la operación de una máquina virtual crítica de tamaño 20 TB.  El tiempo de inactividad, por supuesto, es inaceptable, y el administrador inicia el proceso de recuperación instantánea (recuperación instantánea de VM): después de 5 minutos, la máquina está activa.  Pero recordamos que este estado de la máquina solo puede usarse temporalmente, debe migrarse al almacén de datos de producción.  Y en este ejemplo, como resultó, las capacidades de infraestructura no permitieron copiar 20 TB de datos en un tiempo razonable.  En la configuración del proceso de recuperación instantánea, se eligió guardar los cambios en la unidad <i>C:</i> del servidor Veeam Backup &amp; Replication (a diferencia de la instantánea vSphere), como resultado, por supuesto, el espacio libre en el disco se llenó rápidamente.  Para cuando el usuario contactó con el soporte, la VM tenía cambios que no podían ignorarse.  Es decir, tenemos una situación en la que es imposible finalizar rápidamente el proceso de recuperación instantánea de una máquina crítica: ¿cómo puede guardar datos? <br><br>  Debo admitir que en los últimos años no mencionaré todos los detalles del final, pero recuerdo que al final nunca se nos ocurrió nada brillante.  Los clientes de su lado al menos resolvieron este problema expandiendo la unidad C: desde las reservas, copiaron los archivos más importantes y luego apagaron las máquinas virtuales y migraron.  En general, no ocurrió un milagro. </li><li> El usuario tenía un controlador de dominio en la infraestructura, y todos los componentes de Veeam Backup &amp; Replication se configuraron utilizando DNS.  Sí, es cierto, has oído bien.  Hubo un centenar de opciones para eventos, nada menos, pero la realidad fue así: la gente planificó el mantenimiento y decidió cambiar a una réplica de su controlador de dominio.  Involucraban el cambio planificado, que, en general, se recomienda hacer en tales situaciones.  En la primera etapa, todo salió bien, y en la segunda, la VM original se apagó brevemente para transferir los datos restantes.  Por supuesto, el trabajo de cambio terminó inmediatamente en error, porque DNS dejó de funcionar. <br><br>  Afortunadamente, aquí pudimos hacer frente a la situación al habilitar la réplica manualmente desde vSphere (en realidad, no se recomienda realizar esta operación por nuestra cuenta, como verá en el siguiente ejemplo).  Pero, como comprenderá, el proceso de mantenimiento fue interrumpido y pospuesto.  Además, tuvimos que ingresar manualmente los nombres de host en el archivo <i>C: \ Windows \ System32 \ drivers \ etc \ hosts</i> en el servidor Veeam Backup &amp; Replication para garantizar la corrección al volver a cambiar. </li><li>  Otro cliente tenía toda la infraestructura de respaldo construida alrededor de unidades de cinta, y solo se almacenaban cadenas cortas de archivos en el disco.  Cuando necesitaban restaurar una cantidad de archivos de un servidor de archivos grande, resultó que ninguna máquina podía usarse como depósito auxiliar cuando se recuperaba de la cinta, ya que no había suficiente espacio libre en uno.  (Puede leer sobre la recuperación de la cinta magnética directamente y usar un repositorio auxiliar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aquí</a> (hasta ahora en inglés)). </li></ol><br>  Creo que en los tres ejemplos, los usuarios, por así decirlo, quedaron cautivados por las ilusiones: sugirieron que si la copia de seguridad fue exitosa, entonces no habrá problemas con la recuperación.  Pero esto, como usted sabe, no es siempre el caso, y por lo tanto, debe prepararse para la recuperación tan cuidadosamente como lo hace para la copia de seguridad.  Para empezar, vale la pena estudiar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">el manual del usuario</a> , que contiene información bastante detallada sobre los diferentes tipos de recuperación.  Al comienzo de cada párrafo, se enumeran los requisitos, los pasos preparatorios y las posibles limitaciones.  La descripción de la recuperación de cintas magnéticas o de imágenes de hardware de sistemas de almacenamiento se puede encontrar en las secciones de la documentación y en nuestros <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">artículos</a> sobre Habré.  Además, los pasos para preparar la recuperación de los objetos de la aplicación utilizando las herramientas Veeam Explorers se describen en la sección "Planificación y preparación" del <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">manual</a> para cada herramienta.  Le recomiendo que los lea detenidamente; esto lo ayudará a preparar adecuadamente el sistema para la recuperación si es necesario.  En ruso, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aquí</a> se dan instrucciones para restaurar la base de datos de SQL Server. <br><br><h1>  ¿Por qué no necesita trabajar con réplicas desde la consola vSphere? </h1><br>  En teoría, las réplicas de Veeam son máquinas virtuales ordinarias con las que parece lógico trabajar usando el kit de herramientas vSphere, en particular, el cliente vSphere.  Sin embargo, no recomendamos hacer esto, y he aquí por qué: cambiar a una réplica en Veeam Backup &amp; Replication es un proceso bastante complicado que requiere pasos estrictamente secuenciales (para que pueda retroceder un paso en ese caso) y los pasos finales correctos: solo mire imagen que ilustra el proceso: <br><br><img src="https://habrastorage.org/webt/zd/as/fl/zdasflixvqvvo8s_nd2v1u7druq.png"><br><br>  Si decide habilitar una réplica del cliente vSphere, en el futuro lo más probable es que espere una serie de problemas: <br><br><ol><li>  El cambio al mecanismo de réplica de Veeam Backup &amp; replication (que se muestra en el diagrama) para esta máquina ya no funcionará. </li><li>  Los datos en la base de datos de Veeam Backup no se corresponderán con el estado real de la VM.  En el peor de los casos, debe editar la base de datos para solucionarlo. </li><li>  Incluso puede haber pérdida de datos, como en este ejemplo: el usuario activó manualmente la réplica en el cliente vSphere y decidió continuar trabajando con ella.  Después de un tiempo, notó que la réplica todavía se mostraba en la consola Veeam Backup &amp; Replication y decidió eliminarla como innecesaria.  Hice clic con el botón derecho y le di el comando <i>"Eliminar del disco"</i> .  Veeam Backup &amp; Replication eliminó inmediatamente la réplica del disco, que, por un momento, ya estaba en pleno uso como una máquina virtual normal y contenía los datos necesarios y útiles. </li></ol><br>  Por supuesto, hay situaciones en las que todavía tiene que habilitar la réplica desde el cliente vSphere; por regla general, estos son casos en los que el servidor Veeam está apagado y la réplica debe encenderse con demora.  Pero si todo está en orden con el servidor Veeam, entonces debe trabajar con réplicas desde su consola. <br><br>  Además, no elimine réplicas con el cliente vSphere.  Veeam Backup &amp; Replication no se dará cuenta de dicho cambio, y esto está lleno de errores y datos obsoletos.  Si ya no necesita la réplica, elimínela utilizando la consola Veeam, y no como una VM del cliente vSphere.  Por lo tanto, siempre tendrá una lista actualizada de réplicas. <br><br><h1>  "O" - ¡cuidado, actualizaciones! </h1><br>  Aquí nos referimos, por supuesto, a actualizaciones para hipervisores y varias aplicaciones que se respaldan con Veeam.  Si los mira desde el punto de vista de trabajar con Veeam Backup &amp; Replication, las actualizaciones se pueden dividir en 2 categorías: grandes, serias, con muchos cambios, y pequeñas. <br><br>  Considere primero la primera categoría. <br><br>  Las actualizaciones más importantes son las diseñadas para el hipervisor.  Antes de instalar dicha actualización, debe asegurarse de que sea compatible con Veeam Backup &amp; Replication.  Dichas actualizaciones traen muchos cambios a las bibliotecas y API que utiliza Veeam Backup &amp; Replication, por lo que para anunciar oficialmente su soporte, debe actualizar el código Veeam Backup &amp; Replication y realizar pruebas rigurosas. <br><br>  También debemos tener en cuenta que, por ejemplo, VMware no proporciona acceso preliminar a las últimas versiones de vSphere para los fabricantes de software, por lo que los desarrolladores y evaluadores de Veeam reciben una nueva versión al mismo tiempo que el resto de la humanidad progresiva, por lo tanto, generalmente entre el lanzamiento de VMware y el soporte anunciado oficialmente cierto tiempo  El número y la variedad de cambios necesarios para hacer que una simple revisión se ajuste a sus posibilidades es pequeña, y el soporte oficial, como regla, se anuncia junto con el lanzamiento de la versión de lanzamiento de Veeam Backup &amp; Replication. <br><br>  Como resultado, existe ese momento incómodo cuando, después del lanzamiento de la nueva versión de vSphere, la cantidad de solicitudes de soporte técnico aumenta drásticamente, porque los usuarios se apresuran a instalar la nueva versión y, por supuesto, sus copias de seguridad dejan de funcionar inmediatamente.  Nosotros, el soporte técnico de Veeam, tenemos que explicar a los usuarios exactamente lo que hicieron mal, pedirles que retrocedan (si es posible), o pensar en formas intrincadas para superar el punto muerto.  <b>Por lo tanto, antes de instalar una actualización importante, asegúrese de verificar su compatibilidad con el software que se ejecuta en su computadora, ¡se lo ruego!</b> <br><br>  Todo lo anterior se aplica a las aplicaciones que respalda y espera recuperar con Veeam.  La línea de herramientas de Veeam Explorers también tiene una lista de versiones compatibles de las aplicaciones respectivas, que se actualiza con cada versión de Veeam Backup &amp; Replication.  Por lo tanto, antes de instalar una nueva versión de su aplicación, ya sea Exchange, Oracle o SharePoint, asegúrese de volver a leer la sección correspondiente de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">documentación de Veeam Explorers</a> . <br><br>  A la segunda categoría, es decir  Me refiero a actualizaciones menores, por ejemplo, nuevas versiones de VMware Tools, actualizaciones acumulativas de Exchange, actualizaciones de seguridad de vSphere, etc.  Como regla general, no llevan modificaciones importantes con ellos, y en la mayoría de los casos Veeam Backup &amp; Replication no experimenta problemas con ellos.  (Por lo tanto, no hay anuncios públicos de soporte oficial para el producto para ellos). Sin embargo, en nuestra práctica ha habido casos en que dichas actualizaciones han cambiado el curso habitual de las cosas de manera tan significativa que provocaron errores en Veeam Backup &amp; Replication.  En tales situaciones, después de confirmar el problema, los ingenieros de Veeam intentan liberar la revisión rápidamente. <br><br><div class="spoiler">  <b class="spoiler_title">Los que hablan inglés técnico.</b> <div class="spoiler_text">  Si desea saber en qué están trabajando los ingenieros y a qué se enfrentan los arquitectos de sistemas y los especialistas en soporte técnico, le recomiendo suscribirse a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">nuestros foros</a> .  Cada semana, TheRealGostev crea un boletín de Word from <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">Gostev</a> para los <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">suscriptores</a> .  En él, Anton Gostev, jefe del departamento de gestión de productos, habla sobre los problemas encontrados recientemente (y no solo en el lado de Veeam), planea nuevas versiones y noticias del mundo de TI.  Si necesita más información, puede estudiar los temas del foro; si uno de los clientes tiene un problema con el producto después de cualquier actualización, lo más probable es que ya haya escrito sobre él en el foro. <br></div></div><br>  Como comprenderá, los parches y las actualizaciones pueden generar problemas no solo con las copias de seguridad, sino también con las aplicaciones para las que se realizan estas copias de seguridad.  Y aquí los laboratorios virtuales: Veeam DataLabs lo ayudará.  Probablemente haya escuchado sobre la funcionalidad de SureBackup, diseñada para verificar las copias de seguridad.  Se basa precisamente en el uso de DataLabs, con la creación de un entorno aislado en el que puede, en particular, probar actualizaciones antes de instalarlas en producción.  Te recomiendo encarecidamente que lo hagas: ahórrate muchas células nerviosas.  Y si alguien más no sabe acerca de SureBackup, le recomiendo leer la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">documentación</a> . <br><br>  Quizás por hoy lo tengo todo, ¡gracias por su atención! <br><br><h1>  Que mas leer </h1><br>  Artículos sobre Habré: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Un caso en Pixar o una vez más sobre la importancia de probar las copias de seguridad</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Características del almacenamiento de respaldo a largo plazo</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Mejores prácticas para políticas de respaldo</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Recomendaciones para la política de respaldo y recuperación después del día del juicio final</a> </li></ul><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Manual de usuario (en ruso)</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/451770/">https://habr.com/ru/post/451770/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../451754/index.html">Cómo encontramos expresiones lambda en IntelliJ IDEA</a></li>
<li><a href="../451758/index.html">Enlaces adicionales en la arquitectura lógica del sistema Intel C620</a></li>
<li><a href="../451760/index.html">Uso de Golang para crear microservicios en The Economist: una retrospectiva</a></li>
<li><a href="../451766/index.html">Heisenbug 2019 Piter: lo que sucederá en la transmisión gratuita y qué solo en el evento</a></li>
<li><a href="../451768/index.html">Mejorando el trabajo de Wi-Fi. Principios generales y cosas útiles.</a></li>
<li><a href="../451772/index.html">¿Qué tiene de especial Cloudera y cómo cocinarlo?</a></li>
<li><a href="../451776/index.html">¿Cómo programo motores de juego de roles en Hojas de cálculo de Google</a></li>
<li><a href="../451778/index.html">Otro sistema de monitoreo</a></li>
<li><a href="../451780/index.html">Auditoría en 60 minutos: compruebe la resistencia de los empleados a los ataques de phishing a través de Sophos Phish Threat de forma gratuita</a></li>
<li><a href="../451782/index.html">Subsistema de Windows para Linux (WSL) versión 2: ¿cómo será? (Preguntas frecuentes)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>