<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>âš«ï¸ ğŸ‘š ğŸ˜¢ iOSåº”ç”¨ä¸­çš„SSLå›ºå®šç»•è¿‡ â›”ï¸ ğŸ‘±ğŸ¿ ğŸ”„</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å—¨ï¼Œæˆ‘å«Andrey Batutinï¼Œæˆ‘æ˜¯DataArtçš„é«˜çº§iOSå¼€å‘äººå‘˜ã€‚ åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†å¦‚ä½•ä½¿ç”¨HTTPSä»£ç†å—…æ¢æˆ‘ä»¬çš„ç§»åŠ¨åº”ç”¨ç¨‹åºçš„æµé‡ã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºå¦‚ä½•ç»•è¿‡SSLå›ºå®šã€‚ ä¸ºäº†ä»¥é˜²ä¸‡ä¸€ï¼Œæˆ‘å»ºè®®æ‚¨é˜…è¯»ç¬¬ä¸€ç¯‡æ–‡ç« ï¼ˆå¦‚æœæ‚¨è¿˜æ²¡æœ‰é˜…è¯»è¿‡çš„è¯ï¼‰ï¼šè¿™å°†æœ‰åŠ©äºç†è§£ä¸‹é¢çš„å†…å®¹ã€‚ 

 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>iOSåº”ç”¨ä¸­çš„SSLå›ºå®šç»•è¿‡</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dataart/blog/424485/"><img src="https://habrastorage.org/webt/r5/au/e5/r5aue5majmln6nysnmwfx95do-i.jpeg"><br><br> å—¨ï¼Œæˆ‘å«Andrey Batutinï¼Œæˆ‘æ˜¯DataArtçš„é«˜çº§iOSå¼€å‘äººå‘˜ã€‚ åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œ</a>æˆ‘ä»¬è®¨è®ºäº†å¦‚ä½•ä½¿ç”¨HTTPSä»£ç†å—…æ¢æˆ‘ä»¬çš„ç§»åŠ¨åº”ç”¨ç¨‹åºçš„æµé‡ã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºå¦‚ä½•ç»•è¿‡SSLå›ºå®šã€‚ ä¸ºäº†ä»¥é˜²ä¸‡ä¸€ï¼Œæˆ‘å»ºè®®æ‚¨é˜…è¯»ç¬¬ä¸€ç¯‡æ–‡ç« ï¼ˆå¦‚æœæ‚¨è¿˜æ²¡æœ‰é˜…è¯»è¿‡çš„è¯ï¼‰ï¼šè¿™å°†æœ‰åŠ©äºç†è§£ä¸‹é¢çš„å†…å®¹ã€‚ <br><br> å®é™…ä¸Šï¼Œå®é™…ä¸Šï¼Œä½¿ç”¨SSL Pinningæ˜¯ä¸ºäº†ä½¿åäººæˆ–å¥½å¥‡çš„å¨å¸ˆæ— æ³•è®¿é—®æ‰€æè¿°çš„æ£€æŸ¥å’Œä¿®æ”¹ç§»åŠ¨åº”ç”¨ç¨‹åºæµé‡çš„æ–¹æ³•ã€‚ <a name="habracut"></a><br><br><h2> ä»€ä¹ˆæ˜¯SSLå›ºå®š </h2><br> åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šå®‰è£…äº†â€œæŸ¥å°”æ–¯æ ¹è¯ä¹¦â€ï¼Œä»è€Œä½¿æˆ‘ä»¬çš„æŸ¥å°”æ–¯ä»£ç†å¯ä»¥æ¥æ”¶ï¼Œè§£å¯†ï¼Œå‘æˆ‘ä»¬æ˜¾ç¤ºæµé‡ï¼Œå°†å…¶åŠ å¯†å›å¹¶å‘é€ç»™Dropboxã€‚ <br><br> å¦‚æœä½œä¸ºç§»åŠ¨åº”ç”¨ç¨‹åºçš„å¼€å‘äººå‘˜ï¼Œæˆ‘å¸Œæœ›ä»…ç”±æˆ‘çš„æœåŠ¡å™¨æ£€æŸ¥æˆ‘çš„æµé‡ï¼Œè€Œæ²¡æœ‰å…¶ä»–äººæ£€æŸ¥æˆ‘çš„æµé‡ï¼Œå³ä½¿å¦ä¸€äººå·²ç»åœ¨è®¾å¤‡ä¸Šå®‰è£…äº†SSLè¯ä¹¦ï¼Œæˆ‘ä¹Ÿå¯ä»¥ä½¿ç”¨SSLå›ºå®šã€‚ <br><br> å…¶æœ¬è´¨å¯ä»¥å½’ç»“ä¸ºä»¥ä¸‹äº‹å®ï¼šåœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SSLæ¡æ‰‹</a>æœŸé—´<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ï¼Œ</a>å®¢æˆ·ç«¯ä¼šæ£€æŸ¥ä»æœåŠ¡å™¨æ¥æ”¶åˆ°çš„è¯ä¹¦ã€‚ <br><br> æœ¬æ–‡è®¨è®ºäº†ä½¿ç”¨è¿æ¥åˆ°åº”ç”¨ç¨‹åºä¸­çš„å…è®¸çš„è¯ä¹¦åˆ—è¡¨ï¼ˆç™½åå•ï¼‰æ¥å®ç°çš„æœ€ç®€å•çš„SSLå›ºå®šæ–¹æ³•ã€‚ <br><br> æœ‰å…³SSLå›ºå®šç±»å‹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ­¤å¤„</a> ã€‚ <br><br><h2>  FoodSnifferçš„SSLå›ºå®šå®æ–½ </h2><br> å®Œæ•´çš„é¡¹ç›®ä»£ç åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿™é‡Œ</a> ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸ºä¸¤ä¸ªä¸»æœºè·å–ä¸¤ä¸ªDERæ ¼å¼çš„è¯ä¹¦ï¼š <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">www.dropbox.com</a> ; </li><li>  uc9b17f7c7fce374f5e5efd0a422.dl.dropboxusercontent.comã€‚ </li></ul><br> ç¬¬äºŒå°æœåŠ¡å™¨å°†JSONè‡ªèº«å­˜å‚¨æœ‰æˆ‘ä»¬çš„è´­ä¹°æ¸…å•ã€‚ <br><br> ä¸ºäº†è·å¾—æ­£ç¡®æ ¼å¼çš„è¯ä¹¦ï¼Œæˆ‘ä½¿ç”¨äº†Mozila Firefoxã€‚ <br><br> åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€dropbox.comã€‚ <br><br> å•å‡»åœ°å€æ ä¸­çš„é”å®šç¬¦å·ã€‚ <br><br><img src="https://habrastorage.org/webt/sh/k3/vx/shk3vxqud9j9vmaxj7-fi6tmwa0.jpeg"><br><br><img src="https://habrastorage.org/webt/t2/h3/mh/t2h3mhypmycnrdlucabycodaz3s.jpeg"><br><br> å•å‡»æ›´å¤šä¿¡æ¯ï¼Œé€‰æ‹©å®‰å…¨æ€§-&gt;æŸ¥çœ‹è¯ä¹¦ã€‚ <br><br><img src="https://habrastorage.org/webt/lm/oq/k7/lmoqk7_uba_fh7rh6rjni2frpqu.jpeg"><br><br> ç„¶åé€‰æ‹©è¯¦ç»†ä¿¡æ¯ï¼Œç„¶ååœ¨è¯ä¹¦å±‚æ¬¡ç»“æ„ä¸­æ‰¾åˆ°æœ€ç»ˆè¯ä¹¦ã€‚ <br><br><img src="https://habrastorage.org/webt/f_/rb/tz/f_rbtzkfvjqkfdwymdz6pmrmtcu.jpeg"><br><br> å•å‡»å¯¼å‡ºå¹¶ä»¥DERæ ¼å¼ä¿å­˜ã€‚ <br><br><img src="https://habrastorage.org/webt/cj/hq/rv/cjhqrvecmcfvwnbe4mpeqbi_6oy.jpeg"><br><br> å¯¹uc9b17f7c7fce374f5e5efd0a422.dl.dropboxusercontent.comé‡å¤ç›¸åŒçš„è¿‡ç¨‹ã€‚ <br><br>  <i>æ³¨æ„äº‹é¡¹</i> <br>  Dropboxå†…å®¹æœåŠ¡å™¨ï¼ˆ* .dl.dropboxusercontent.comï¼‰ä½¿ç”¨é€šé…ç¬¦è¯ä¹¦ã€‚ è¿™æ„å‘³ç€æ‚¨ä¸ºuc9b17f7c7fce374f5e5efd0a422æœåŠ¡å™¨æå–çš„è¯ä¹¦å°†é€‚ç”¨äºä»»ä½•å…¶ä»–Dropbox * .dl.dropboxusercontent.comæœåŠ¡å™¨ã€‚ <br><br> ç»“æœï¼Œæˆ‘å¾—åˆ°äº†ä¸¤ä¸ªå¸¦æœ‰è¯ä¹¦çš„æ–‡ä»¶ï¼š <br><br>  <b>dropboxcom.crt</b> ï¼Œ <br>  <b>dldropboxusercontentcom.crt</b> ï¼Œ <br><br> æˆ‘æ·»åŠ åˆ°äº†FoodSniffer iOSåº”ç”¨é¡¹ç›®ä¸­ã€‚ <br><br><img src="https://habrastorage.org/webt/fb/7h/lu/fb7hluyvt6vfrzjv_g9mvahzjco.jpeg"><br><br> ç„¶åï¼Œæˆ‘ä¸ºFoodListAPIConsumerç±»æ·»åŠ äº†æ‰©å±•ï¼Œåœ¨å…¶ä¸­æ£€æŸ¥äº†ä»æœåŠ¡å™¨æ”¶åˆ°çš„è¯ä¹¦ã€‚ ä¸ºæ­¤ï¼Œæˆ‘åœ¨å…è®¸çš„è¯ä¹¦åˆ—è¡¨ä¸­æŸ¥æ‰¾å®ƒï¼Œå¤„ç†NSURLSessionDelegateåè®®çš„Authentication Challengeå§”æ‰˜ï¼š <br><br><pre><code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FoodListAPIConsumer</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">urlSession</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> session: URLSession, didReceive challenge: URLAuthenticationChallenge, completionHandler: @escaping </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(URLSession.AuthChallengeDisposition, URLCredential?)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> trust = challenge.protectionSpace.serverTrust <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { completionHandler(.cancelAuthenticationChallenge, <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> credential = <span class="hljs-type"><span class="hljs-type">URLCredential</span></span>(trust: trust) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (validateTrustCertificateList(trust)) { completionHandler(.useCredential, credential) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { completionHandler(.cancelAuthenticationChallenge, <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">validateTrustCertificateList</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> trust:SecTrust)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> index <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>..&lt;<span class="hljs-type"><span class="hljs-type">SecTrustGetCertificateCount</span></span>(trust) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> certificate = <span class="hljs-type"><span class="hljs-type">SecTrustGetCertificateAtIndex</span></span>(trust, index){ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> serverCertificateData = <span class="hljs-type"><span class="hljs-type">SecCertificateCopyData</span></span>(certificate) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-type"><span class="hljs-type">Data</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( certificates.<span class="hljs-built_in"><span class="hljs-built_in">contains</span></span>(serverCertificateData) ){ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> } } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span> } }</code> </pre> <br> åœ¨<b>è¯ä¹¦</b>æ•°ç»„ä¸­ï¼Œæˆ‘å…·æœ‰å…è®¸çš„è¯ä¹¦çš„æ•°æ®è¡¨ç¤ºå½¢å¼ã€‚ <br><br> ç°åœ¨ï¼Œå½“Charles Proxyè¿è¡Œæ—¶ï¼Œç”±äºCharlesè¯ä¹¦æœªåŒ…å«åœ¨å…è®¸çš„åˆ—è¡¨ä¸­ï¼Œå› æ­¤åº”ç”¨ç¨‹åºå°†æ–­å¼€è¿æ¥ã€‚ ç”¨æˆ·å°†çœ‹åˆ°ä»¥ä¸‹é”™è¯¯ï¼š <br><br><img src="https://habrastorage.org/webt/si/nk/gk/sinkgknwjdxwhtkcnbq8dcl-okc.jpeg"><br><br> é»‘å®¢æ‰“è´¥äº†ï¼ <br><br> ä½†æ˜¯ç°åœ¨æœ‰ä¸€ä¸ªå°é—®é¢˜-å¼€å‘äººå‘˜å¦‚ä½•ç›‘æ§è‡ªå·±åº”ç”¨ç¨‹åºçš„HTTPSæµé‡ï¼Ÿ <br><br><h2> å¼—é‡Œè¾¾ </h2><br> ä¸€ç§é€‰æ‹©æ˜¯ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Frida</a>æ¡†æ¶çš„åŠ¨æ€ä»£ç æ³¨å…¥æ¡†æ¶ç¦ç”¨SSL Pinningã€‚ <br><br> è¿™ä¸ªæƒ³æ³•æ˜¯<b>validateTrustCertificateList</b>æ–¹æ³•åœ¨åº”ç”¨ç¨‹åºå¼€å‘æœŸé—´å§‹ç»ˆè¿”å›trueã€‚ <br><br> å½“ç„¶ï¼Œè¿™å¯ä»¥åœ¨ä¸è¿›è¡ŒåŠ¨æ€ä»£ç æ³¨å…¥çš„æƒ…å†µä¸‹å®ç°ï¼Œä¾‹å¦‚ï¼Œä½¿ç”¨<b>#if targetEnvironmentï¼ˆæ¨¡æ‹Ÿå™¨ï¼‰</b>æ¡ä»¶åœ¨æ¨¡æ‹Ÿå™¨ä¸Šç¦ç”¨SSLå›ºå®šï¼Œä½†è¿™å¤ªç®€å•äº†ã€‚ <br><br> ä½¿ç”¨Fridaï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™JavaScriptè„šæœ¬ï¼ˆæ­£ç¡®åœ°å¯¹å—ï¼Ÿï¼‰ï¼Œåœ¨å…¶ä¸­ï¼Œæˆ‘ä»¬å°†validateTrustCertificateListçš„å®ç°æ›¿æ¢ä¸ºå§‹ç»ˆè¿”å›trueçš„å®ç°ã€‚ <br> å¹¶ä¸”æ­¤è„šæœ¬å°†åœ¨æ‰§è¡Œé˜¶æ®µæ³¨å…¥åˆ°åº”ç”¨ç¨‹åºä¸­ã€‚ <br><br>  Fridaå¦‚ä½•åœ¨iOSä¸Šå·¥ä½œï¼Œæ‚¨å¯ä»¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨æ­¤å¤„</a>é˜…è¯»ã€‚ <br><br><h4>  Fridaå®‰è£…ï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä»æ­¤å¤„è·å–</a> ï¼‰ã€‚ </h4><br><br>  <i>sudo pipå®‰è£…frida-tools</i> <br><br><h2>  Fridaè„šæœ¬ </h2><br> æ›¿æ¢validateTrustCertificateListå‡½æ•°çš„ç›´æ¥è„šæœ¬å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><pre> <code class="hljs pgsql">// Are we debugging it? <span class="hljs-keyword"><span class="hljs-keyword">DEBUG</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> main() { // <span class="hljs-number"><span class="hljs-number">1</span></span> var ValidateTrustCertificateList_prt = Module.findExportByName(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, "_T016FoodSnifferFrida0A15ListAPIConsumerC024validateTrustCertificateD0SbSo03SecG0CF"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ValidateTrustCertificateList_prt == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { console.log("[!] FoodSniffer!validateTrustCertificateList(...) not found!"); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } // <span class="hljs-number"><span class="hljs-number">2</span></span> var ValidateTrustCertificateList = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> NativeFunction(ValidateTrustCertificateList_prt, "int", ["pointer"]); // <span class="hljs-number"><span class="hljs-number">3</span></span> Interceptor.replace(ValidateTrustCertificateList_prt, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> NativeCallback(<span class="hljs-keyword"><span class="hljs-keyword">function</span></span>(trust) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">DEBUG</span></span>) console.log("[*] ValidateTrustCertificateList(...) hit!"); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; }, "int", ["pointer"])); console.log("[*] ValidateTrustCertificateList(...) hooked. SSL pinnig is disabled."); } // Run the script main();</code> </pre><br><ol><li> æˆ‘ä»¬é€šè¿‡å‡½æ•°çš„å…¨ååœ¨åº”ç”¨ç¨‹åºäºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ‰¾åˆ°æŒ‡å‘<b>validateTrustCertificateList</b>çš„æŒ‡é’ˆã€‚ </li><li> æˆ‘ä»¬å°†æŒ‡é’ˆåŒ…è£…åœ¨NativeFunctionåŒ…è£…å™¨ä¸­ï¼Œä»¥æŒ‡ç¤ºå‚æ•°çš„ç±»å‹å’Œå‡½æ•°çš„è¾“å‡ºå€¼ã€‚ </li><li> å°†<b>validateTrustCertificateList</b>å‡½æ•°çš„å®ç°æ›¿æ¢ä¸ºå§‹ç»ˆè¿”å›1ï¼ˆå³trueï¼‰çš„å‡½æ•°ã€‚ </li></ol><br> æ•´ä¸ªè„šæœ¬ä½äº<b>{source_root} /fridascrpts/killCertPinnig.jsä¸­</b> ã€‚ <br><br> é—®é¢˜ä¹‹ä¸€æ˜¯å¦‚ä½•è·å–å‡½æ•°<b>_T016FoodSnifferFrida0A15ListAPIConsumerC024validateTrustCertificateD0SbSo03SecG0CF</b>çš„å…¨å <br><br> ä¸ºæ­¤ï¼Œæˆ‘ä½¿ç”¨äº†ä»¥ä¸‹æŠ€æœ¯ã€‚ <br><br><ul><li> åœ¨åº”ç”¨ç¨‹åºä¸­åˆ›å»ºäº†å¦ä¸€ä¸ªç›®æ ‡<b>FoodSnifferFrida</b> ã€‚ </li><li> æˆ‘å°†<b>FridaGadget.dylib</b>åº“è¿æ¥åˆ°äº†å®ƒï¼Œæˆ‘åœ¨è¿™é‡Œæ¥äº†å®ƒã€‚ åº“è¿æ¥è¿‡ç¨‹åœ¨æ­¤å¤„æ›´è¯¦ç»†åœ°æè¿°ã€‚ </li><li> åœ¨æ¨¡æ‹Ÿå™¨ä¸Šå¯åŠ¨äº†FoodSnifferåº”ç”¨ç¨‹åºã€‚ </li><li> ä½¿ç”¨æ­¤å‘½ä»¤æŸ¥æ‰¾å®Œå…¨<b>é™å®šçš„</b>å‡½æ•°åç§°<b>validateTrustCertificateList</b> ï¼š <br>  <i>frida-trace -R -f re.frida.Gadget -iâ€œ * validateTrust *â€</i> </li><li> æ ¼å¼å¦‚ä¸‹ï¼š <br><img src="https://habrastorage.org/webt/zp/8v/ho/zp8vhoi8wdgh4hme5yttpgus5ck.jpeg"></li></ul><br> ç„¶ååœ¨<b>killCertPinnig.jsä¸­</b>ä½¿ç”¨å®ƒã€‚ <br><br> ä¸ºä»€ä¹ˆè¿™æ ·ä¸€ä¸ªâ€œå¥‡æ€ªâ€çš„åç§°æœ€åå‡ºç°ï¼Œä»¥åŠæ‰€æœ‰è¿™äº›T016å’Œ0A15çš„å«ä¹‰ï¼Œå¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿™é‡Œ</a>çœ‹åˆ°ã€‚ <br><br><h3>  SSL Killingå›ºå®š </h3><br> ç°åœ¨ç»ˆäºåœ¨ç¦ç”¨SSL Pinnigçš„æƒ…å†µä¸‹å¯åŠ¨FoodSnifferï¼ <br><br> å¯åŠ¨Charles Proxyã€‚ <br><br> åœ¨æ¨¡æ‹Ÿå™¨çš„Xcodeé¡¹ç›®ä¸­è¿è¡Œç›®æ ‡FoodSnifferFridaã€‚ æˆ‘ä»¬åº”è¯¥åªçœ‹åˆ°ä¸€ä¸ªç™½è‰²çš„å±å¹•ã€‚ è¯¥åº”ç”¨ç¨‹åºç­‰å¾…Fridaè¿æ¥åˆ°å®ƒã€‚ <br><img src="https://habrastorage.org/webt/m5/gd/0s/m5gd0sdgghn4w9zamqc8fjbeixe.jpeg"><br><br> è¿è¡ŒFridaä»¥æ‰§è¡Œ<b>killCertPinnig.js</b>è„šæœ¬ï¼š <br>  <i>frida -R -f re.frida.Gadget -l ./fridascrpts/killCertPinnig.js</i> <br><br> è®©æˆ‘ä»¬ç­‰å¾…ä¸iOSåº”ç”¨ç¨‹åºçš„è¿æ¥ï¼š <br><br><img src="https://habrastorage.org/webt/ms/ge/kx/msgekxhxchkud3skbbidl8j_v8a.jpeg"><br><br> ä½¿ç”¨ï¼…resumeå‘½ä»¤ç»§ç»­åº”ç”¨ç¨‹åºï¼š <br><br><img src="https://habrastorage.org/webt/pc/bo/4m/pcbo4mhufsllwtifvuk6iex-pi0.jpeg"><br><br> ç°åœ¨ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨åº”ç”¨ç¨‹åºä¸­çœ‹åˆ°é£Ÿç‰©åˆ—è¡¨ï¼š <br><br><img src="https://habrastorage.org/webt/36/2n/za/362nzasutmf3ybjnmblxvhn0m3s.jpeg"><br><br> ä»¥åŠCharles Proxyä¸­çš„JSONï¼š <br><br><img src="https://habrastorage.org/webt/fz/q0/lz/fzq0lzt4ht-efkw6_iujz2dvui4.jpeg"><br><br> èµ¢åˆ©ï¼ <br><br><h3> ç»“è®º </h3><br>  Fridaå°±åƒWiresharkçš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸€æ ·ã€‚ å®ƒé€‚ç”¨äºiOSï¼ŒAndroidï¼ŒLinuxï¼ŒWindowså¹³å°ã€‚ è¯¥æ¡†æ¶ä½¿æ‚¨å¯ä»¥è·Ÿè¸ªå¯¹æ–¹æ³•å’Œå‡½æ•°ï¼ˆç³»ç»Ÿå’Œç”¨æˆ·ï¼‰çš„è°ƒç”¨ã€‚ å¹¶ä¸”è¿˜æ›¿æ¢å‚æ•°å€¼ï¼Œè¿”å›å€¼å’Œå‡½æ•°çš„å®ç°ã€‚ <br><br> åœ¨ä½¿ç”¨Fridaçš„å¼€å‘ç¯å¢ƒä¸­ç»•è¿‡SSLå›ºå®šä¼¼ä¹æœ‰ç‚¹è¿‡å¤§ã€‚ ä¹‹æ‰€ä»¥å¸å¼•æˆ‘ï¼Œæ˜¯å› ä¸ºæˆ‘ä¸éœ€è¦åœ¨åº”ç”¨ç¨‹åºä¸­å…·æœ‰ç”¨äºè°ƒè¯•å’Œåº”ç”¨ç¨‹åºå¼€å‘çš„ç‰¹å®šé€»è¾‘ã€‚ è¿™ç§é€»è¾‘ä¼šä½¿ä»£ç æ··ä¹±ï¼Œå¦‚æœå®æ–½ä¸æ­£ç¡®ï¼Œåˆ™ä¼šæ³„æ¼åˆ°ç¨‹åºé›†çš„å‘è¡Œç‰ˆä¸­ï¼ˆå®ï¼Œæ‚¨å¥½ï¼ï¼‰ã€‚ <br><br> æ­¤å¤–ï¼ŒFridaé€‚ç”¨äºAndroidã€‚ è¿™ä½¿æˆ‘æœ‰æœºä¼šä½¿æ•´ä¸ªå›¢é˜Ÿçš„å·¥ä½œæ›´åŠ è½»æ¾ï¼Œå¹¶ç¡®ä¿æ•´ä¸ªäº§å“ç³»åˆ—çš„å¼€å‘è¿‡ç¨‹é¡ºåˆ©è¿›è¡Œã€‚ <br>  Fridaå°†è‡ªå·±å®šä½ä¸ºé»‘åŒ£å­è¿‡ç¨‹ä»£ç æ³¨å…¥å·¥å…·ã€‚ æœ‰äº†å®ƒï¼Œå°±å¯ä»¥åœ¨ä¸æ›´æ”¹iOSåº”ç”¨ç¨‹åºç›´æ¥ä»£ç çš„æƒ…å†µä¸‹ï¼Œå°†æ–¹æ³•è°ƒç”¨æ—¥å¿—è®°å½•æ·»åŠ åˆ°è¿è¡Œæ—¶ï¼Œè¿™åœ¨è°ƒè¯•å¤æ‚è€Œç½•è§çš„é”™è¯¯æ—¶æ˜¯å¿…ä¸å¯å°‘çš„ã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN424485/">https://habr.com/ru/post/zh-CN424485/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN424471/index.html">è´¢åŠ¡ç‹¬ç«‹æ˜¯æˆ‘çš„æ–¹å¼</a></li>
<li><a href="../zh-CN424475/index.html">ä¿¡æ¯å®‰å…¨ç›‘æ§ä¸­å¿ƒ2018å¹´ä¸ŠåŠå¹´æŠ¥å‘Š</a></li>
<li><a href="../zh-CN424477/index.html">pygameæ¸¸æˆçš„å¯ç”¨æ€§</a></li>
<li><a href="../zh-CN424481/index.html">å…³äºRTOSçš„å…¨éƒ¨çœŸç›¸ã€‚ ç¬¬11æ¡ ä»»åŠ¡ï¼šAPIçš„é…ç½®å’Œä»‹ç»</a></li>
<li><a href="../zh-CN424483/index.html">380äº¿ç¾å…ƒçš„äº¤æ˜“åŠå…¶å½±å“ï¼šåº·å¡æ–¯ç‰¹å’Œè¿ªå£«å°¼å¦‚ä½•é€šè¿‡æŠ•èµ„ä¸äºšé©¬é€Šå’ŒNetflixæŠ—è¡¡</a></li>
<li><a href="../zh-CN424491/index.html">Unityå…­è¾¹å½¢å›¾ï¼šç²—ç³™åº¦ï¼Œæ²³æµå’Œé“è·¯</a></li>
<li><a href="../zh-CN424495/index.html">Google Chromeæµè§ˆå™¨å°†æ·»åŠ ç™»å½•å…¬å¸æœåŠ¡æ—¶æ‹’ç»è‡ªåŠ¨é…ç½®æ–‡ä»¶åŒæ­¥çš„åŠŸèƒ½*</a></li>
<li><a href="../zh-CN424497/index.html">ä¸è¦å†æ€€ç–‘å¼€å‘å•†çš„è™šå‡è¡Œä¸ºã€‚ å­¦ä¹ æ›´å¥½åœ°é‡‡è®¿</a></li>
<li><a href="../zh-CN424499/index.html">å¥½å§ï¼Œä»–çš„ç¬”ä¸‹</a></li>
<li><a href="../zh-CN424501/index.html">çœŸæ­£ç„Šå·¥çš„è¯Šæ–­ç»ˆç«¯</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>