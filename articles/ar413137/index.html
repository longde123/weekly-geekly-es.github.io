<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>โ๏ธ ๐๏ธ ๐ ุชุตููู ูููุงุช ูุจูุฑุฉ ูู ุงูุจูุงูุงุช ุนูู Apache Spark ุจุงุณุชุฎุฏุงู ููุงุฐุฌ ุงูุชุนูู ุงูุขูู ุงูุชุนุณูู ๐ฃ ๐ ๐คฝ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุงูุฌุฒุก 1: ุจูุงู ุงููุดููุฉ 
 ูุฑุญุจุง ูุง ูุจุฑ! ุฃูุง ูููุฏุณ ุญููู ูู CleverDATA. ุงูููู ุณุฃุชุญุฏุซ ุนู ููููุฉ ุชุตููู ูููุงุช ูุจูุฑุฉ ูู ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู ููุงุฐุฌ ุชู ุฅูุดุงุคูุง ุจุงุณุช...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุชุตููู ูููุงุช ูุจูุฑุฉ ูู ุงูุจูุงูุงุช ุนูู Apache Spark ุจุงุณุชุฎุฏุงู ููุงุฐุฌ ุงูุชุนูู ุงูุขูู ุงูุชุนุณูู</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/lanit/blog/413137/" style=";text-align:right;direction:rtl"><h2 style=";text-align:right;direction:rtl">  ุงูุฌุฒุก 1: ุจูุงู ุงููุดููุฉ </h2><br>  ูุฑุญุจุง ูุง ูุจุฑ!  ุฃูุง ูููุฏุณ ุญููู ูู CleverDATA.  ุงูููู ุณุฃุชุญุฏุซ ุนู ููููุฉ ุชุตููู ูููุงุช ูุจูุฑุฉ ูู ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู ููุงุฐุฌ ุชู ุฅูุดุงุคูุง ุจุงุณุชุฎุฏุงู ุฃู ููุชุจุฉ ุชุนููู ุขูู ูุชุงุญุฉ ุชูุฑูุจูุง.  ูู ูุฐู ุงูุณูุณูุฉ ุงูููููุฉ ูู ุฌุฒุฃูู ุ ุณููุธุฑ ูู ุงูุฃุณุฆูุฉ ุงูุชุงููุฉ. <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููููุฉ ุชูุฏูู ูููุฐุฌ ุชุนูููู ุงูุขูุฉ ูุฎุฏูุฉ (ูููุฐุฌ ูุฎุฏูุฉ)ุ </li><li style=";text-align:right;direction:rtl">  ููู ุชุชู ููุงู ุงููุนุงูุฌุฉ ุงูููุฒุนุฉ ููููุงุช ูุจูุฑุฉ ูู ุงูุจูุงูุงุช ูุนูููุง ุจุงุณุชุฎุฏุงู Apache Sparkุ </li><li style=";text-align:right;direction:rtl">  ูุง ูู ุงููุดุงูู ุงูุชู ุชุธูุฑ ุนูุฏูุง ูุชูุงุนู Apache Spark ูุน ุงูุฎุฏูุงุช ุงูุฎุงุฑุฌูุฉุ </li><li style=";text-align:right;direction:rtl">  ููู ูููู ุชูุธูู ุชูุงุนู Apache Spark ูุน ุงูุฎุฏูุงุช ุงูุฎุงุฑุฌูุฉ ุจุงุณุชุฎุฏุงู ููุชุจุงุช akka-Streams ู akka-http ุ ุจุงูุฅุถุงูุฉ ุฅูู ููุฌ Stream Reactive Streamsุ </li></ul><br>  ูู ุงูุจุฏุงูุฉ ุ ุฎุทุทุช ููุชุงุจุฉ ููุงู ูุงุญุฏ ุ ูููู ุจูุง ุฃู ุญุฌู ุงููุงุฏุฉ ุชุจูู ุฃูู ูุจูุฑ ุฌุฏูุง ุ ููุฏ ูุฑุฑุช ุชูุณููู ุฅูู ุฌุฒุฃูู.  ุณููุธุฑ ุงูููู ูู ุงูุฌุฒุก ุงูุฃูู ูู ุงูุจูุงู ุงูุนุงู ูููุดููุฉ ุ ููุฐูู ุงููุดุงูู ุงูุฑุฆูุณูุฉ ุงูุชู ูุฌุจ ุญููุง ุฃุซูุงุก ุงูุชูููุฐ.  ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฌุฒุก ุงูุซุงูู ุ</a> ุณูู ูุชุญุฏุซ ุนู ุงูุชูููุฐ ุงูุนููู ูุญู ูุฐู ุงููุดููุฉ ุจุงุณุชุฎุฏุงู ููุฌ ุงูุชุฏููุงุช ุงูุชูุงุนููุฉ. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/pv/8g/p2/pv8gp2gxotjij6hjkkirlllzlii.png"></div><a name="habracut"></a><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชูุชูู</a> ุดุฑูุชูุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CleverDATA</a> ูุฑูููุง ูู ูุญููู ุงูุจูุงูุงุช ุงูุฐูู ุ ุจูุณุงุนุฏุฉ ูุฌููุนุฉ ูุงุณุนุฉ ูู ุงูุฃุฏูุงุช (ูุซู scikit-learn ู facebook fastText ู xgboost ู tensorFlow ุ ููุง ุฅูู ุฐูู) ุ ูููููู ุจุชุฏุฑูุจ ููุงุฐุฌ ุงูุชุนูู ุงูุขูู.  ูุบุฉ ุงูุจุฑูุฌุฉ ุงูุฃุณุงุณูุฉ ุงููุนููุฉ ุงูุชู ูุณุชุฎุฏููุง ุงููุญูููู ูู Python.  ุชุญุชูู ุฌููุน ููุชุจุงุช ุชุนููู ุงูุขูุฉ ุชูุฑูุจูุง ุ ุญุชู ุงูุชู ุชู ุชูููุฐูุง ูู ุงูุฃุตู ุจูุบุงุช ุฃุฎุฑู ุ ุนูู ูุงุฌูุฉ Python ููุชูุงููุฉ ูุน ููุชุจุงุช Python ุงูุฑุฆูุณูุฉ (ุจุดูู ุฃุณุงุณู ูุน NumPy). <br><br>  ูู ูุงุญูุฉ ุฃุฎุฑู ุ ูุณุชุฎุฏู ุงููุธุงู ุงูุฅูููููุฌู Hadoop ุนูู ูุทุงู ูุงุณุน ูุชุฎุฒูู ููุนุงูุฌุฉ ูููุงุช ูุจูุฑุฉ ูู ุงูุจูุงูุงุช ุบูุฑ ุงููููููุฉ.  ูู ุฐูู ุ ูุชู ุชุฎุฒูู ุงูุจูุงูุงุช ุนูู ูุธุงู ูููุงุช HDFS ูู ุดูู ูุชู ููุฒุนุฉ ููุณูุฎุฉ ุฐุงุช ุญุฌู ูุนูู (ุนุงุฏุฉ 128 ููุฌุง ุจุงูุช ุ ูููู ูู ุงููููู ุชูููููุง).  ุชุญุงูู ุฎูุงุฑุฒููุงุช ูุนุงูุฌุฉ ุงูุจูุงูุงุช ุงูููุฒุนุฉ ุงูุฃูุซุฑ ููุงุกุฉ ุชูููู ุชูุงุนู ุงูุดุจูุฉ ุจูู ุฃุฌูุฒุฉ ุงููุฌููุนุฉ.  ููููุงู ุจุฐูู ุ ูุฌุจ ูุนุงูุฌุฉ ุงูุจูุงูุงุช ุนูู ููุณ ุงูุฃุฌูุฒุฉ ุญูุซ ูุชู ุชุฎุฒูููุง. <br><br>  ุจุงูุทุจุน ุ ูู ูุซูุฑ ูู ุงูุญุงูุงุช ูุง ูููู ุชุฌูุจ ุชูุงุนู ุงูุดุจูุฉ ุชูุงููุง ุ ูููู ุ ูุน ุฐูู ุ ุชุญุชุงุฌ ุฅูู ูุญุงููุฉ ุชูููุฐ ุฌููุน ุงูููุงู ูุญูููุง ูุชูููู ูููุฉ ุงูุจูุงูุงุช ุงูุชู ุณุชุญุชุงุฌ ุฅูู ููููุง ุนุจุฑ ุงูุดุจูุฉ. <br><br>  ูุณูู ูุฐุง ุงููุจุฏุฃ ูู ูุนุงูุฌุฉ ุงูุจูุงูุงุช ุงูููุฒุนุฉ "ููู ุงูุญุณุงุจุงุช ุจุงููุฑุจ ูู ุงูุจูุงูุงุช".  ุชูุชุฒู ุฌููุน ุงูุฃุทุฑ ุงูุฑุฆูุณูุฉ ุ ุฎุงุตุฉ Hadoop MapReduce ู Apache Spark ุ ุจูุฐุง ุงููุจุฏุฃ.  ุฅููุง ุชุญุฏุฏ ุชุฑููุจุฉ ูุชุณูุณู ุนูููุงุช ูุญุฏุฏุฉ ูุงูุชู ูุฌุจ ุชุดุบูููุง ุนูู ุงูุฃุฌูุฒุฉ ุญูุซ ูุชู ุชุฎุฒูู ูุชู ุงูุจูุงูุงุช ุงููุทููุจุฉ. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/qs/os/nw/qsosnwsibgwo5ajbmzg-v4la7m0.png"></div>  <i>ุงูุดูู 1. ุชุชุฃูู ูุฌููุนุฉ HDFS ูู ุนุฏุฉ ุฃุฌูุฒุฉ ุ ุฃุญุฏูุง ุนูุฏุฉ ุงูุงุณู ุ ูุงูุจุงูู ุนูุฏุฉ ุจูุงูุงุช.</i>  <i>ูุฎุฒู Name Node ูุนูููุงุช ุญูู ุงููููุงุช ุงูุชู ุชููู ูุชููุง ุ ูุนู ุงูุฃุฌูุฒุฉ ุงูุชู ุชูุฌุฏ ูููุง ูุนูููุง.</i>  <i>ูุชู ุชุฎุฒูู ุงููุชู ููุณูุง ูู ุนูุฏุฉ ุงูุจูุงูุงุช ุ ูุงูุชู ูุชู ูุณุฎูุง ุนูู ุนุฏุฉ ุฃุฌูุฒุฉ ูุฒูุงุฏุฉ ุงูููุซูููุฉ.</i>  <i>ุชุฏูุฑ ุนูุฏุฉ ุงูุจูุงูุงุช ุฃูุถูุง ููุงู ูุนุงูุฌุฉ ุงูุจูุงูุงุช.</i>  <i>ุชุชููู ุงูููุงู ูู ุงูุนูููุฉ ุงูุฑุฆูุณูุฉ (Master ุ M) ุ ุงูุชู ุชูุณู ุฅุทูุงู ุนูููุงุช ุงูุนูู (ุงูุนุงูู ุ W) ุนูู ุงูุฃุฌูุฒุฉ ุญูุซ ูุชู ุชุฎุฒูู ูุชู ุงูุจูุงูุงุช ุงููุงุฒูุฉ.</i> <br><br>  ูุชู ุฅุทูุงู ุฌููุน ููููุงุช ุงููุธุงู ุงูุจูุฆู Hadoop ุชูุฑูุจูุง ุจุงุณุชุฎุฏุงู Java Virtual Machine (JVM) ููุชู ุฏูุฌูุง ุจุดูู ูุซูู ูุน ุจุนุถูุง ุงูุจุนุถ.  ุนูู ุณุจูู ุงููุซุงู ุ ูุชุดุบูู ุงูููุงู ุงูููุชูุจุฉ ุจุงุณุชุฎุฏุงู Apache Spark ููุนูู ูุน ุงูุจูุงูุงุช ุงููุฎุฒูุฉ ุนูู HDFS ุ ูุง ุชูุฌุฏ ุญุงุฌุฉ ุชูุฑูุจูุง ุฅูู ูุนุงูุฌุฉ ุฅุถุงููุฉ: ูููุฑ ุงูุฅุทุงุฑ ูุฐู ุงููุธููุฉ ูู ุฎุงุฑุฌ ุงูุตูุฏูู. <br><br>  ูุณูุก ุงูุญุธ ุ ุชูุชุฑุถ ูุนุธู ุงูููุชุจุงุช ุงููุตููุฉ ููุชุนูู ุงูุขูู ุฃูู ูุชู ุชุฎุฒูู ุงูุจูุงูุงุช ููุนุงูุฌุชูุง ูุญูููุง.  ูู ุงูููุช ููุณู ุ ููุงู ููุชุจุงุช ูุชูุงููุฉ ุจุฅุญูุงู ูุน ูุธุงู Hadoop ุงูุจูุฆู ุ ุนูู ุณุจูู ุงููุซุงู ุ Spark ML ุฃู Apache Mahout.  ููุน ุฐูู ุ ูุฏููู ุนุฏุฏ ูู ุงูุณูุจูุงุช ุงููุจูุฑุฉ.  ุฃููุงู ุ ุชูุฏู ุชุทุจููุงุช ุฃูู ุจูุซูุฑ ูุฎูุงุฑุฒููุงุช ุงูุชุนูู ุงูุขูู.  ุซุงูููุง ุ ูุง ูููู ูุฌููุน ูุญููู ุงูุจูุงูุงุช ุงูุนูู ูุนูู.  ุชุดูู ูุฒุงูุง ูุฐู ุงูููุชุจุงุช ุญูููุฉ ุฃูู ูููู ุงุณุชุฎุฏุงููุง ูุชุฏุฑูุจ ุงูููุงุฐุฌ ุนูู ูููุงุช ูุจูุฑุฉ ูู ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู ุงูุญูุณุจุฉ ุงูููุฒุนุฉ. <br><br>  ููุน ุฐูู ุ ุบุงูุจูุง ูุง ูุณุชุฎุฏู ูุญููู ุงูุจูุงูุงุช ุทุฑููุง ุจุฏููุฉ ูุชุฏุฑูุจ ุงูููุงุฐุฌ ุ ููุง ุณููุง ุงูููุชุจุงุช ุงูุชู ุชุชูุญ ุงุณุชุฎุฏุงู ูุญุฏุงุช ูุนุงูุฌุฉ ุงูุฑุณููุงุช.  ูู ุฃููุฑ ูู ูุถุงูุง ููุงุฐุฌ ุงูุชุฏุฑูุจ ูู ูุฐู ุงูููุงูุฉ ุ ูุฃููู ุฃุฑูุฏ ุงูุชุฑููุฒ ุนูู ุงุณุชุฎุฏุงู ุงูููุงุฐุฌ ุงูุฌุงูุฒุฉ ุงูุชู ุชู ุฅูุดุงุคูุง ุจุงุณุชุฎุฏุงู ุฃู ููุชุจุฉ ูุชุงุญุฉ ููุชุนูู ุงูุขูู ูุชุตููู ูููุงุช ูุจูุฑุฉ ูู ุงูุจูุงูุงุช. <br><br>  ูุฐุง ุ ูุฅู ุงููููุฉ ุงูุฑุฆูุณูุฉ ุงูุชู ูุญุงูู ุญููุง ููุง ูู ุชุทุจูู ููุงุฐุฌ ุงูุชุนูู ุงูุขูู ุนูู ูููุงุช ูุจูุฑุฉ ูู ุงูุจูุงูุงุช ุงููุฎุฒูุฉ ุนูู HDFS.  ุฅุฐุง ุงุณุชุทุนูุง ุงุณุชุฎุฏุงู ูุญุฏุฉ SparkML ูู ููุชุจุฉ Apache Spark ุ ุงูุชู ุชููุฐ ุฎูุงุฑุฒููุงุช ุงูุชุนูู ุงูุขูู ุงูุฃุณุงุณูุฉ ุ ูุณูููู ุชุตููู ูููุงุช ูุจูุฑุฉ ูู ุงูุจูุงูุงุช ูููุฉ ุชุงููุฉ: <br><br><pre style=";text-align:right;direction:rtl"><code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> model: <span class="hljs-type"><span class="hljs-type">LogisticRegressionModel</span></span> = <span class="hljs-type"><span class="hljs-type">LogisticRegressionModel</span></span>.load(<span class="hljs-string"><span class="hljs-string">"/path/to/model"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> dataset = spark.read.parquet(<span class="hljs-string"><span class="hljs-string">"/path/to/data"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> result = model.transform(dataset)</code> </pre> <br>  ูุณูุก ุงูุญุธ ุ ูุนูู ูุฐุง ุงูููุฌ ููุท ูุน ุงูุฎูุงุฑุฒููุงุช ุงูุชู ุชู ุชูููุฐูุง ูู ูุญุฏุฉ SparkML (ูููู ุงูุนุซูุฑ ุนูู ูุงุฆูุฉ ูุงููุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> ).  ูู ุญุงูุฉ ุงุณุชุฎุฏุงู ููุชุจุงุช ุฃุฎุฑู ุ ุนูุงูุฉ ุนูู ุฐูู ุ ูุง ูุชู ุชูููุฐูุง ุนูู JVM ุ ูุตุจุญ ูู ุดูุก ุฃูุซุฑ ุชุนููุฏูุง. <br><br>  ูุญู ูุฐู ุงููุดููุฉ ุ ูุฑุฑูุง ูู ุงููููุฐุฌ ูู ุฎุฏูุฉ REST.  ููููุง ูุฐูู ุ ุนูุฏ ุจุฏุก ูููุฉ ุชุตููู ุงูุจูุงูุงุช ุงููุฎุฒูุฉ ุนูู HDFS ุ ูู ุงูุถุฑูุฑู ุชูุธูู ุงูุชูุงุนู ุจูู ุงูุฃุฌูุฒุฉ ุงูุชู ูุชู ุชุฎุฒูู ุงูุจูุงูุงุช ุนูููุง ูุงูุฌูุงุฒ (ุฃู ูุฌููุนุฉ ุงูุฃุฌูุฒุฉ) ุงูุชู ุชุนูู ุนูููุง ุฎุฏูุฉ ุงูุชุตููู. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/pv/8g/p2/pv8gp2gxotjij6hjkkirlllzlii.png"></div>  <i>ุงูุดูู 2. ููููู ุงููููุฐุฌ ูุฎุฏูุฉ</i> <br><br><h3 style=";text-align:right;direction:rtl">  ูุตู ุฎุฏูุฉ ุชุตููู Python </h3><br>  ูู ุฃุฌู ุชูุฏูู ุงููููุฐุฌ ูุฎุฏูุฉ ุ ูู ุงูุถุฑูุฑู ุญู ุงูููุงู ุงูุชุงููุฉ: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชูููุฐ ุงููุตูู ุงููุนุงู ุฅูู ุงููููุฐุฌ ุนุจุฑ HTTP ุ </li><li style=";text-align:right;direction:rtl">  ุถูุงู ุงูุงุณุชุฎุฏุงู ุงูุฃูุซุฑ ููุงุกุฉ ูููุงุฑุฏ ุงูุฌูุงุฒ (ุฌููุน ููู ุงููุนุงูุฌ ูุงูุฐุงูุฑุฉ ูู ุงูููุงู ุงูุฃูู) ุ </li><li style=";text-align:right;direction:rtl">  ุชููุฑ ููุงููุฉ ููุฃุญูุงู ุงูุนุงููุฉ ุ </li><li style=";text-align:right;direction:rtl">  ุชููุฑ ุงููุฏุฑุฉ ุนูู ุงูุชูุณุน ุฃููููุง. </li></ol><br>  ูุนุฏ ุงููุตูู ุฅูู ุงููููุฐุฌ ุนุจุฑ HTTP ุฃูุฑูุง ุจุณูุทูุง ููุบุงูุฉ ูู ุงูุชูููุฐ: ุชู ุชุทููุฑ ุนุฏุฏ ูุจูุฑ ูู ุงูููุชุจุงุช ูุจุงูุซูู ุชุณูุญ ูู ุจุชูููุฐ ููุทุฉ ูุตูู REST ุจุงุณุชุฎุฏุงู ูููุฉ ุตุบูุฑุฉ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ.  ุฃุญุฏ ูุฐู ุงูุฅุทุงุฑุงุช ุงูุฏูููุฉ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุงุฑูุฑุฉ</a> .  ุชูููุฐ ุฎุฏูุฉ ุงูุชุตููู ุนูู ุงููุงุฑูุฑุฉ ูุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Flask, request, Response model = load_model() n_features = <span class="hljs-number"><span class="hljs-number">100</span></span> app = Flask(__name__) @app.route(<span class="hljs-string"><span class="hljs-string">"/score"</span></span>, methods=[<span class="hljs-string"><span class="hljs-string">'PUT'</span></span>]) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">score</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> inp = np.frombuffer(request.data, dtype=<span class="hljs-string"><span class="hljs-string">'float32'</span></span>).reshape(<span class="hljs-number"><span class="hljs-number">-1</span></span>, n_features) result = model.predict(inp) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Response(result.tobytes(), mimetype=<span class="hljs-string"><span class="hljs-string">'application/octet-stream'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">"__main__"</span></span>: app.run()</code> </pre> <br>  ููุง ุ ุนูุฏูุง ุชุจุฏุฃ ุงูุฎุฏูุฉ ุ ูููู ุจุชุญููู ุงููููุฐุฌ ูู ุงูุฐุงูุฑุฉ ุ ุซู ูุณุชุฎุฏูู ุนูุฏ ุงุณุชุฏุนุงุก ุทุฑููุฉ ุงูุชุตููู.  ุชููู ูุธููุฉ load_model ุจุชุญููู ุงููููุฐุฌ ูู ูุตุฏุฑ ุฎุงุฑุฌู ุ ุณูุงุก ูุงู ูุธุงู ุงููููุงุช ุ ุฃู ุชุฎุฒูู ูููุฉ ุงูููุชุงุญ ุ ุฅูุฎ. <br><br>  ุงููููุฐุฌ ูู ูุงุฆู ูู ุทุฑููุฉ ุชูุจุคูุฉ.  ูู ุญุงูุฉ ุงูุชุตููู ุ ูุฅูู ูุฃุฎุฐ ูุฏุฎูุงุช ุฅูู ุจุนุถ ูุชุฌู ุงูููุฒุฉ ุจุญุฌู ูุนูู ูููุชุฌ ุฅูุง ูููุฉ ููุทููุฉ ุชุดูุฑ ุฅูู ูุง ุฅุฐุง ูุงู ุงููุชุฌู ุงููุญุฏุฏ ููุงุณุจูุง ููุฐุง ุงููููุฐุฌ ุ ุฃู ุจุนุถ ุงููููุฉ ูู 0 ุฅูู 1 ุ ูุงูุชู ููููู ุนูุฏุฆุฐู ุชุทุจูู ุนุชุจุฉ ุงููุทุน: ูู ุดูุก ููู ุงูุนุชุจุฉ ุ ูู ูุชูุฌุฉ ุฅูุฌุงุจูุฉ ููุชุตููู ุ ูุงูุจุงูู ููุณ ูุฐูู. <br><br>  ูุชู ุชูุฑูุฑ ูุงูู ุงูููุฒุฉ ุงูุฐู ูุญุชุงุฌ ุฅูู ุชุตูููู ูู ุดูู ุซูุงุฆู ูุฅุฒุงูุชู ุฅูู ูุตูููุฉ ุบูุฑ ูุฑุชุจุฉ.  ุณูููู ูู ุงูุนุจุก ุฅุฌุฑุงุก ุทูุจ HTTP ููู ูุชุฌู.  ุนูู ุณุจูู ุงููุซุงู ุ ูู ุญุงูุฉ ูุชุฌู 100 ุงูุฃุจุนุงุฏ ูุงุณุชุฎุฏุงู ููู ุงูููุน float32 ุ ูุฅู ุทูุจ HTTP ุงููุงูู ุ ุจูุง ูู ุฐูู ุงูุฑุคูุณ ุ ุณูุจุฏู ูุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell">PUT /score HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> Host: score<span class="hljs-literal"><span class="hljs-literal">-node</span></span><span class="hljs-literal"><span class="hljs-literal">-1</span></span>:<span class="hljs-number"><span class="hljs-number">8099</span></span> User<span class="hljs-literal"><span class="hljs-literal">-Agent</span></span>: curl/<span class="hljs-number"><span class="hljs-number">7.58</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span> Accept: */* Content<span class="hljs-literal"><span class="hljs-literal">-Type</span></span>: application/binary Content<span class="hljs-literal"><span class="hljs-literal">-Length</span></span>: <span class="hljs-number"><span class="hljs-number">400</span></span> [<span class="hljs-number"><span class="hljs-number">400</span></span> <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span><span class="hljs-type"><span class="hljs-type">s</span></span> <span class="hljs-type"><span class="hljs-type">of</span></span> <span class="hljs-type"><span class="hljs-type">data</span></span>]</code> </pre> <br>  ููุง ุชุฑูู ุ ูุฅู ููุงุกุฉ ูุฐุง ุงูุทูุจ ููุฎูุถุฉ ุฌุฏูุง (400 ุจุงูุช ูู ุงูุญูููุฉ / (133 ุจุงูุช ุฑุฃุณ + 400 ุจุงูุช)) = 75ูช).  ูุญุณู ุงูุญุธ ุ ูู ุฌููุน ุงูููุชุจุงุช ุชูุฑูุจูุง ุ ุชุชูุญ ูู ุทุฑููุฉ ุงูุชูุจุค ุนุฏู ุงุณุชูุจุงู ุงููุชุฌู [1 xn] ุ ูููู ุงููุตูููุฉ [mxn] ุ ูุจุงูุชุงูู ุ ุฅุฎุฑุงุฌ ุงููุชูุฌุฉ ููุฑูุง ูููู ุงูุฅุฏุฎุงู m. <br><br>  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุชู ุชุญุณูู ููุชุจุฉ numpy ููุนูู ูุน ุงููุตูููุงุช ุงููุจูุฑุฉ ุ ููุง ูุชูุญ ูู ุงุณุชุฎุฏุงู ุฌููุน ููุงุฑุฏ ุงูุฌูุงุฒ ุงููุชุงุญุฉ ุจุดูู ูุนุงู.  ูุจุงูุชุงูู ุ ูุง ูููููุง ุฅุฑุณุงู ูุงุญุฏ ููุท ุจู ุนุฏุฏูุง ูุจูุฑูุง ูู ูุชุฌูุงุช ุงูููุฒุงุช ูู ุทูุจ ูุงุญุฏ ุ ูุฅูุบุงุก ุชุณูุณููุง ุฅูู ูุตูููุฉ ุบูุฑ ูุฑุชุจุฉ ุจุญุฌู [mxn] ุ ูุชุตููู ุ ูุฅุฑุฌุงุน ุงููุชุฌู [mx 1] ูู ุงูููู ุงูููุทููุฉ ุฃู ุงูุนุงุฆูุฉ 32.  ููุชูุฌุฉ ูุฐูู ุ ุชุตุจุญ ููุงุกุฉ ุชูุงุนู HTTP ุนูุฏ ุงุณุชุฎุฏุงู ูุตูููุฉ ูู 1000 ุตู ุชุณุงูู 100ูช ุชูุฑูุจูุง.  ูููู ุชุฌุงูู ุญุฌู ุฑุคูุณ HTTP ูู ูุฐู ุงูุญุงูุฉ. <br><br>  ูุงุฎุชุจุงุฑ ุฎุฏูุฉ Flask ุนูู ุงูุฌูุงุฒ ุงููุญูู ุ ููููู ุชุดุบูููุง ูู ุณุทุฑ ุงูุฃูุงูุฑ.  ููุน ุฐูู ุ ูุฅู ูุฐู ุงูุทุฑููุฉ ุบูุฑ ููุงุณุจุฉ ุชูุงููุง ููุงุณุชุฎุฏุงู ุงูุตูุงุนู.  ูุงูุญูููุฉ ูู ุฃู Flask ูู ูุคุดุฑ ุชุฑุงุจุท ูุงุญุฏ ุ ูุฅุฐุง ูุธุฑูุง ุฅูู ุงูุฑุณู ุงูุจูุงูู ูุชุญููู ุงููุนุงูุฌ ุฃุซูุงุก ุชุดุบูู ุงูุฎุฏูุฉ ุ ูุณูู ูุฑู ุฃู ููุงุฉ ูุงุญุฏุฉ ูุญููุฉ ุจูุณุจุฉ 100 ูช ูุงูุจุงูู ุบูุฑ ูุดุท.  ูุญุณู ุงูุญุธ ุ ููุงู ุทุฑู ูุงุณุชุฎุฏุงู ุฌููุน ููุงุฉ ุงูุฌูุงุฒ: ูุฐูู ุ ูุฌุจ ุชุดุบูู Flask ูู ุฎูุงู ุฎุงุฏู ุชุทุจููุงุช ุงูููุจ uwsgi.  ูุชูุญ ูู ุชูููู ุนุฏุฏ ุงูุนูููุงุช ูุงูุฎููุท ุจุดูู ูุซุงูู ูุถูุงู ุงูุญูู ุงูููุชุธู ุนูู ุฌููุน ููู ุงููุนุงูุฌ.  ูููู ุงูุนุซูุฑ ุนูู ูุฒูุฏ ูู ุงูุชูุงุตูู ุญูู ุฌููุน ุฎูุงุฑุงุช ุชูููู uwsgi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> . <br><br>  ูู ุงูุฃูุถู ุงุณุชุฎุฏุงู nginx ูููุทุฉ ุฏุฎูู HTTP ุ ูุฃู uwsgi ูููู ุฃู ูุนูู ุจุดูู ุบูุฑ ูุณุชูุฑ ูู ุญุงูุฉ ุงูุฃุญูุงู ุงูุนุงููุฉ.  ูู ูุงุญูุฉ ุฃุฎุฑู ุ ุชุฃุฎุฐ Nginx ุชุฏูู ุงููุฏุฎูุงุช ุจุงููุงูู ูู ุงูุทูุจุงุช ุนูู ููุณูุง ุ ูุชุตููุฉ ุงูุทูุจุงุช ุบูุฑ ุงูุตุงูุญุฉ ุ ูุฌุฑุนุงุช ุงูุญูู ุนูู uwsgi.  ุชุชูุงุตู Nginx ูุน uwsgi ุนุจุฑ ููุงุจุณ ููููุณ ุจุงุณุชุฎุฏุงู ููู ูุนุงูุฌุฉ.  ูููุง ููู ูุซุงู ูุชููุฆุฉ nginx: <br><br><pre style=";text-align:right;direction:rtl"> <code class="nginx hljs"><span class="hljs-section"><span class="hljs-section">server</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">listen</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">server_name</span></span> <span class="hljs-number"><span class="hljs-number">127.0.0.1</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">location</span></span> / { <span class="hljs-attribute"><span class="hljs-attribute">try_files</span></span> <span class="hljs-variable"><span class="hljs-variable">$uri</span></span> <span class="hljs-variable"><span class="hljs-variable">@score</span></span>; } <span class="hljs-attribute"><span class="hljs-attribute">location</span></span> <span class="hljs-variable"><span class="hljs-variable">@score</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">include</span></span> uwsgi_params; <span class="hljs-attribute"><span class="hljs-attribute">uwsgi_pass</span></span> unix:/tmp/score.sock; } }</code> </pre><br>  ููุง ูุฑู ุ ุชุจูู ุฃูู ุชูููู ูุนูุฏ ุฅูู ุญุฏ ูุง ูุฌูุงุฒ ูุงุญุฏ.  ุฅุฐุง ุงุญุชุฌูุง ุฅูู ุชุตููู ูููุงุช ูุจูุฑุฉ ูู ุงูุจูุงูุงุช ุ ูุณูุฃุชู ุนุฏุฏ ูุจูุฑ ูู ุงูุทูุจุงุช ููุฐู ุงูุฎุฏูุฉ ุ ููููู ุฃู ุชุตุจุญ ุงุฎุชูุงููุง.  ุงูุญู ููุฐู ุงููุดููุฉ ูู ุงูุชุญุฌูู ุงูุฃููู. <br><br>  ูู ุฃุฌู ุงูุฑุงุญุฉ ุ ูููู ุจุชุบููู ุงูุฎุฏูุฉ ูู ุญุงููุฉ Docker ุซู ูุดุฑูุง ุนูู ุงูุนุฏุฏ ุงููุทููุจ ูู ุงูุฃุฌูุฒุฉ.  ุฅุฐุง ุฑุบุจุช ูู ุฐูู ุ ููููู ุงุณุชุฎุฏุงู ุฃุฏูุงุช ุงููุดุฑ ุงูุขูู ูุซู Kubernetes.  ูููุง ููู ูุซุงู ุนูู ูููู Dockerfile ูุฅูุดุงุก ุญุงููุฉ ูุน ุฎุฏูุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> ubuntu #Installing required ubuntu <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> python modules RUN apt-<span class="hljs-keyword"><span class="hljs-keyword">get</span></span> <span class="hljs-keyword"><span class="hljs-keyword">update</span></span> RUN apt-<span class="hljs-keyword"><span class="hljs-keyword">get</span></span> -y install python3 python3-pip nginx RUN <span class="hljs-keyword"><span class="hljs-keyword">update</span></span>-alternatives <span class="hljs-comment"><span class="hljs-comment">--install /usr/bin/python python /usr/bin/python3 1 RUN update-alternatives --install /usr/bin/pip pip /usr/bin/pip3 1 RUN pip install uwsgi flask scipy scikit-learn #copying script files WORKDIR /etc/score COPY score.py . COPY score.ini . COPY start.sh . RUN chmod +x start.sh RUN rm /etc/nginx/sites-enabled/default COPY score.nginx /etc/nginx/sites-enabled/ EXPOSE 80 ENTRYPOINT ["./start.sh"]</span></span></code> </pre> <br>  ูุฐุง ูุฅู ูููููุฉ ุฎุฏูุฉ ุงูุชุตููู ูู ููุง ููู: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/fz/4b/c7/fz4bc7kha2wb_dbhck4gifa52ho.png"></div>  <i>ุงูุดูู 3. ูุฎุทุท ุฎุฏูุฉ ุงูุชุตููู</i> <br><br><h3 style=";text-align:right;direction:rtl">  ููุฎุต ููุฌุฒ ูุนูู Apache Spark ูู ุงููุธุงู ุงูุจูุฆู Hadoop </h3><br>  ุงูุขู ุฎุฐ ุจุนูู ุงูุงุนุชุจุงุฑ ุนูููุฉ ูุนุงูุฌุฉ ุงูุจูุงูุงุช ุงููุฎุฒูุฉ ุนูู HDFS.  ููุง ุฃุดุฑุช ุณุงุจููุง ุ ูุชู ุงุณุชุฎุฏุงู ูุจุฏุฃ ููู ุงูุญุณุงุจุงุช ุฅูู ุงูุจูุงูุงุช ููุฐุง ุงูุบุฑุถ.  ูุจุฏุก ููุงู ุงููุนุงูุฌุฉ ุ ุชุญุชุงุฌ ุฅูู ูุนุฑูุฉ ุงูุฃุฌูุฒุฉ ุงูุชู ูุชู ุชุฎุฒูู ูุชู ุงูุจูุงูุงุช ุงูุชู ูุญุชุงุฌูุง ูู ุฃุฌู ุชุดุบูู ุงูุนูููุงุช ุงููุนููุฉ ูุจุงุดุฑุฉ ุจูุนุงูุฌุชูุง.  ูู ุงูุถุฑูุฑู ุฃูุถูุง ุชูุณูู ุฅุทูุงู ูุฐู ุงูุนูููุงุช ุ ูุฅุนุงุฏุฉ ุชุดุบูููุง ูู ุญุงูุฉ ุงูุทูุงุฑุฆ ุ ุฅุฐุง ูุฒู ุงูุฃูุฑ ุ ุชุฌููุน ูุชุงุฆุฌ ุงูููุงู ุงููุฑุนูุฉ ุงููุฎุชููุฉ ุ ุฅูุฎ. <br><br>  ูุชู ุฅูุฌุงุฒ ุฌููุน ูุฐู ุงูููุงู ูู ุฎูุงู ูุฌููุนุฉ ูุชููุนุฉ ูู ุงูุฃุทุฑ ุงูุชู ุชุนูู ูุน ุงููุธุงู ุงูุฅูููููุฌู Hadoop.  ูุงุญุฏุฉ ูู ุงูุฃูุซุฑ ุดุนุจูุฉ ููุฑูุญุฉ ูู Apache Spark.  ุงูููููู ุงูุฑุฆูุณู ุงูุฐู ุชู ุจูุงุก ุงูุฅุทุงุฑ ุจุฃูููู ุญููู ูู RDD (ูุฌููุนุฉ ุงูุจูุงูุงุช ุงูููุฒุนุฉ ุงููุฑูุฉ).  ุจุดูู ุนุงู ุ ูููู ุงุนุชุจุงุฑ RDD ููุฌููุนุฉ ููุฒุนุฉ ููุงููุฉ ููุณููุท.  ูููู ุงูุญุตูู ุนูู RDD ุจุทุฑููุชูู ุฑุฆูุณูุชูู: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฅูุดุงุก ูู ูุตุฏุฑ ุฎุงุฑุฌู ุ ูุซู ูุฌููุนุฉ ูู ุงูุฐุงูุฑุฉ ุฃู ููู ุฃู ุฏููู ุนูู ูุธุงู ุงููููุงุช ุ ููุง ุฅูู ุฐูู ุ </li><li style=";text-align:right;direction:rtl">  ุงูุชุญููู ูู RDD ุขุฎุฑ ูู ุฎูุงู ุชุทุจูู ุนูููุงุช ุงูุชุญููู.  ูุฏุนู RDD ุฌููุน ุงูุนูููุงุช ุงูุฃุณุงุณูุฉ ููุนูู ูุน ุงููุฌููุนุงุช ุ ูุซู ุงูุฎุฑูุทุฉ ุ flatMap ุ ุงููุฑุดุญ ุ groupBy ุ ุงูุงูุถูุงู ุ ุฅูุฎ. </li></ol><br>  ูู ุงูููู ุฃู ูููู ุฃู RDD ุ ุนูู ุนูุณ ุงููุฌููุนุงุช ุ ููุณุช ุจูุงูุงุช ูุจุงุดุฑุฉ ุ ุจู ุณูุณูุฉ ูู ุงูุนูููุงุช ุงูุชู ูุฌุจ ุฅุฌุฑุงุคูุง ุนูู ุงูุจูุงูุงุช.  ูุฐูู ุ ุนูุฏูุง ูุชู ุงุณุชุฏุนุงุก ุนูููุงุช ุงูุชุญููู ุ ูุง ูุญุฏุซ ุฃู ุนูู ูู ุงููุงูุน ุ ููุญุตู ููุท ุนูู RDD ุฌุฏูุฏ ุ ูุงูุฐู ุณูุญุชูู ุนูู ุนูููุฉ ูุงุญุฏุฉ ุฃูุซุฑ ูู ุงูุนูููุฉ ุงูุณุงุจูุฉ.  ูุจุฏุฃ ุงูุนูู ููุณู ุนูุฏูุง ูุชู ุงุณุชุฏุนุงุก ูุง ูุณูู ุงูุนูููุงุช ุฃู ุงูุฅุฌุฑุงุกุงุช ุงูุทุฑููุฉ.  ูุชุดูู ูุฐู ุงูุญูุธ ูู ููู ุ ูุงูุญูุธ ูู ูุฌููุนุฉ ูู ุงูุฐุงูุฑุฉ ุ ูุญุณุงุจ ุนุฏุฏ ุงูุนูุงุตุฑ ุ ููุง ุฅูู ุฐูู. <br><br>  ุนูุฏ ุจุฏุก ุนูููุฉ ููุงุฆูุฉ ุ ูููู Spark ุ ุนูู ุฃุณุงุณ RDD ุงููุงุชุฌ ุ ุจุจูุงุก ุฑุณู ุจูุงูู ูุนูููุฉ ูุง ุญูููุฉ (DAG ุ ุฑุณู ุจูุงูู ุบูุฑ ูุจุงุดุฑ ููุฌู) ูุชุดุบูููุง ุจุงูุชุชุงุจุน ุนูู ุงููุชูุฉ ููููุง ููุฑุณู ุงูุจูุงูู ุงููุณุชูู.  ุนูุฏ ุจูุงุก DAG ุนูู ุฃุณุงุณ RDD ุ ูููู Spark ุจุนุฏุฏ ูู ุงูุชุญุณููุงุช ุ ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ุฃููู ุ ูุฌูุน ุจูู ุนุฏุฉ ุชุญูููุงุช ูุชุชุงููุฉ ูู ุนูููุฉ ูุงุญุฏุฉ. <br><br>  ูุงูุช RDD ุงููุญุฏุฉ ุงูุฑุฆูุณูุฉ ููุชูุงุนู ูุน Spark API ูู ุฅุตุฏุงุฑุงุช Spark 1.x.  ูู ุงูุฅุตุฏุงุฑ Spark 2.x ุ ูุงู ุงููุทูุฑูู ุฅู ุงูููููู ุงูุฑุฆูุณู ููุชูุงุนู ูู ูุฌููุนุฉ ุงูุจูุงูุงุช.  Dataset ุนุจุงุฑุฉ ุนู ุฅุถุงูุฉ ูู RDD ูุน ุฏุนู ููุชูุงุนู ุงูุดุจูู ุจู SQL.  ุนูุฏ ุงุณุชุฎุฏุงู Dataset API ุ ุชุชูุญ ูู Spark ุงุณุชุฎุฏุงู ูุฌููุนุฉ ูุงุณุนุฉ ูู ุงูุชุญุณููุงุช ุ ุจูุง ูู ุฐูู ุงูุชุญุณููุงุช ููุฎูุถุฉ ุงููุณุชูู ุฅูู ุญุฏ ูุง.  ูููู ุจุดูู ุนุงู ุ ุชูุทุจู ุงููุจุงุฏุฆ ุงูุฃุณุงุณูุฉ ุงูุชู ุชูุทุจู ุนูู RDDs ุนูู ูุฌููุนุฉ ุงูุจูุงูุงุช. <br><br>  ูููู ุงูุนุซูุฑ ุนูู ูุฒูุฏ ูู ุงูุชูุงุตูู ุญูู ุนูู Spark ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงุฆู ุนูู ุงููููุน ุงูุฑุณูู</a> . <br><br>  ุฏุนูุง ูููุฑ ูู ูุซุงู ุนูู ุฃุจุณุท ุชุตููู ุนูู Spark ุฏูู ุงุณุชุฎุฏุงู ุงูุฎุฏูุงุช ุงูุฎุงุฑุฌูุฉ.  ูุชู ุชูููุฐ ุฎูุงุฑุฒููุฉ ูุง ูุนูู ููุง ุฅูู ุญุฏ ูุง ููุง ุ ูุงูุชู ุชุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ูุณุจุฉ ูู ุญุฑู ูุงุชููู ูู ุงููุต ุ ุซู ุชุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุงูุงูุญุฑุงู ุงููุนูุงุฑู.  ููุง ุ ุฃููุงู ููุจู ูู ุดูุก ุ ูู ุงูููู ุงูุงูุชุจุงู ูุจุงุดุฑุฉ ุฅูู ุงูุฎุทูุงุช ุงูุฃุณุงุณูุฉ ุงููุณุชุฎุฏูุฉ ุนูุฏ ุงูุนูู ูุน Spark. <br><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Data</span></span></span><span class="hljs-class">(</span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">id: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-class"><span class="hljs-params">, text: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">case</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Features</span></span></span><span class="hljs-class">(</span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">id: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-class"><span class="hljs-params">, vector: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Array</span></span></span></span><span class="hljs-class"><span class="hljs-params">[</span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Float</span></span></span></span><span class="hljs-class"><span class="hljs-params">]</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">case</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Score</span></span></span><span class="hljs-class">(</span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">id: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-class"><span class="hljs-params">, score: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Float</span></span></span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">//</span></span></span><span class="hljs-class">(</span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">1</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">(</span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">vector: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Array</span></span></span></span><span class="hljs-class"><span class="hljs-params">[</span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Float</span></span></span></span><span class="hljs-class"><span class="hljs-params">]</span></span></span><span class="hljs-class">)</span></span>: <span class="hljs-type"><span class="hljs-type">Float</span></span> = ??? <span class="hljs-comment"><span class="hljs-comment">//(2) val ds: Dataset[Data] = spark.read.parquet("/path/to/data").as[Data] //(3) val result: Dataset[Score] = ds.map {d: Data =&gt; //(4) val filteredText = d.text.toLowerCase.filter { letter =&gt; 'a' &lt;= letter &amp;&amp; letter &lt;= 'z' } val featureVector = new Array[Float](26) if (filteredText.nonEmpty) { filteredText.foreach(letter =&gt; featureVector(letter) += 1) featureVector.indicies.foreach { i =&gt; featureVector(i) = featureVector(i) / filteredText.length() } } Features(d.id, featureVector) }.map {f: Features =&gt; Score(f.id, std(f.vector)) //(5) } result.write.parquet("/path/to/result") //(6)</span></span></code> </pre><br>  ูู ูุฐุง ุงููุซุงู ุ ูุญู: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุญุฏุฏ ูููู ุงููุฏุฎูุงุช ูุงูุจูุงูุงุช ุงููุณูุทุฉ ูุงููุฎุฑุฌุงุช (ูุชู ุชุนุฑูู ุจูุงูุงุช ุงูุฅุฏุฎุงู ุนูู ุฃููุง ุจุนุถ ุงููุตูุต ุงูุชู ูุฑุชุจุท ุจูุง ูุนุฑู ูุนูู ุ ูุชุชุทุงุจู ุงูุจูุงูุงุช ุงููุชูุณุทุฉ ูุน ุงููุนุฑูู ูุน ูุงูู ุงูููุฒุฉ ุ ููุทุงุจู ุงููุงุชุฌ ุงููุนุฑู ูุน ุจุนุถ ุงููููุฉ ุงูุนุฏุฏูุฉ) ุ </li><li style=";text-align:right;direction:rtl">  ูุญุฏุฏ ุฏุงูุฉ ูุญุณุงุจ ุงููููุฉ ุงููุงุชุฌุฉ ุจูุงุณุทุฉ ูุงูู ุงูููุฒุฉ (ุนูู ุณุจูู ุงููุซุงู ุ ุงูุงูุญุฑุงู ุงููุนูุงุฑู ุ ุงูุชูููุฐ ุบูุฑ ูุจูู) ุ </li><li style=";text-align:right;direction:rtl">  ุชุนุฑูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงูุฃุตููุฉ ุนูู ุฃููุง ุจูุงูุงุช ูุฎุฒูุฉ ุนูู HDFS ุจุชูุณูู ุงูุจุงุฑููู ุนูู ุทูู ุงููุณุงุฑ / ุงููุณุงุฑ / ุฅูู / ุงูุจูุงูุงุช ุ </li><li style=";text-align:right;direction:rtl">  ุชุญุฏูุฏ ูุฌููุนุฉ ุจูุงูุงุช ูุณูุทุฉ ูุฎุฑูุทุฉ ููุทูุฉ ูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงูุฃุตููุฉ. </li><li style=";text-align:right;direction:rtl">  ูุจุงููุซู ุ ูุญุฏุฏ ูุฌููุนุฉ ุงูุจูุงูุงุช ุงููุงุชุฌุฉ ูู ุฎูุงู ุชุญููู ุฃุญุงุฏู ุงููุนุงูู ูู ุงููุชูุณุท โโุ </li><li style=";text-align:right;direction:rtl">  ุญูุธ ูุฌููุนุฉ ุงูุจูุงูุงุช ุงููุงุชุฌุฉ ุฅูู HDFS ุจุชูุณูู ุงูุจุงุฑููู ุนูู ุทูู ุงููุณุงุฑ / ุงููุณุงุฑ / ุฅูู / ุงููุชูุฌุฉ.  ูุธุฑูุง ูุฃู ุงูุญูุธ ูู ููู ูู ุนูููุฉ ููุงุฆูุฉ ุ ูุชู ุจุฏุก ุงูุญุณุงุจุงุช ููุณูุง ุจุฏูุฉ ูู ูุฐู ุงููุฑุญูุฉ. </li></ol><br>  ูุนูู Apache Spark ุนูู ูุจุฏุฃ ุงูุนุงูู ุงูุฑุฆูุณู.  ุนูุฏูุง ูุจุฏุฃ ุงูุชุทุจูู ุ ุชุจุฏุฃ ุงูุนูููุฉ ุงูุฑุฆูุณูุฉ ุ ุงูุชู ุชุณูู ุงูุณุงุฆู.  ูููุฐ ุงูููุฏ ุงููุณุคูู ุนู ุชูููุฏ RDD ุ ุนูู ุฃุณุงุณูุง ุณูุชู ุฅุฌุฑุงุก ุงูุญุณุงุจุงุช. <br><br>  ุนูุฏูุง ูุชู ุงุณุชุฏุนุงุก ุนูููุฉ ุทุฑููุฉ ุ ูููู ุงูุณุงุฆู ุจุฅูุดุงุก DAG ุจูุงุกู ุนูู RDD ุงููุงุชุฌ.  ุซู ูุจุฏุฃ ุงูุณุงุฆู ูู ุฅุทูุงู ุชุฏููุงุช ุงูุนูู ุชุณูู ุงูุชูููุฐููู ุ ุญูุซ ุณูุชู ูุนุงูุฌุฉ ุงูุจูุงูุงุช ูุจุงุดุฑุฉ.  ุจุนุฏ ุจุฏุก ุณูุฑ ุงูุนูู ุ ููุฑุฑูุง ุงูุณุงุฆู ุงููุชูุฉ ุงููุงุจูุฉ ููุชูููุฐ ุงูุชู ูุฌุจ ุชูููุฐูุง ุ ููุดูุฑ ุฃูุถูุง ุฅูู ุฃู ุฌุฒุก ูู ุงูุจูุงูุงุช ูุญุชุงุฌ ุฅูู ุชุทุจููู. <br><br>  ููุฌุฏ ุฃุฏูุงู ุฑูุฒ ุงููุซุงู ุงูุฎุงุต ุจูุง ุ ุญูุซ ูุชู ุชูููุฒ ุฃูุณุงู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุชู ูุชู ุชูููุฐูุง ุนูู ุงููููุฐ (ุจูู ุจุฏุงูุฉ ุณุทุฑ ุงููููุฐ ูููุงูุฉ ุฌุฒุก ุงููููุฐ).  ูุชู ุชูููุฐ ูุง ุชุจูู ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุนูู ุงูุณุงุฆู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Data</span></span></span><span class="hljs-class">(</span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">id: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-class"><span class="hljs-params">, text: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">case</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Features</span></span></span><span class="hljs-class">(</span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">id: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-class"><span class="hljs-params">, vector: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Array</span></span></span></span><span class="hljs-class"><span class="hljs-params">[</span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Float</span></span></span></span><span class="hljs-class"><span class="hljs-params">]</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">case</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Score</span></span></span><span class="hljs-class">(</span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">id: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-class"><span class="hljs-params">, score: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Float</span></span></span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">(</span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">vector: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Array</span></span></span></span><span class="hljs-class"><span class="hljs-params">[</span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Float</span></span></span></span><span class="hljs-class"><span class="hljs-params">]</span></span></span><span class="hljs-class">)</span></span>: <span class="hljs-type"><span class="hljs-type">Float</span></span> = ??? <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> ds: <span class="hljs-type"><span class="hljs-type">Dataset</span></span>[<span class="hljs-type"><span class="hljs-type">Data</span></span>] = spark.read.parquet(<span class="hljs-string"><span class="hljs-string">"/path/to/data"</span></span>).as[<span class="hljs-type"><span class="hljs-type">Data</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> result: <span class="hljs-type"><span class="hljs-type">Dataset</span></span>[<span class="hljs-type"><span class="hljs-type">Score</span></span>] = ds.map { <span class="hljs-comment"><span class="hljs-comment">// --------------- EXECUTOR PART BEGIN ----------------------- d: Data =&gt; val filteredText = d.text.toLowerCase.filter { letter =&gt; 'a' &lt;= letter &amp;&amp; letter &lt;= 'z' } val featureVector = new Array[Float](26) if (filteredText.nonEmpty) { filteredText.foreach(letter =&gt; featureVector(letter) += 1) featureVector.indicies.foreach { i =&gt; featureVector(i) = featureVector(i) / filteredText.length() } } Features(d.id, featureVector) // --------------- EXECUTOR PART END ----------------------- }.map { // --------------- EXECUTOR PART BEGIN ----------------------- f: Features =&gt; Score(f.id, std(f.vector)) // --------------- EXECUTOR PART END ----------------------- } result.write.parquet(โ/path/to/resultโ)</span></span></code> </pre><br>  ูู ูุธุงู Hadoop ุงูุจูุฆู ุ ูุชู ุชุดุบูู ุฌููุน ุงูุชุทุจููุงุช ูู ุญุงููุงุช.  ุงูุญุงููุฉ ูู ุนูููุฉ ูุชู ุชุดุบูููุง ุนูู ุฃุญุฏ ุงูุฃุฌูุฒุฉ ูู ูุฌููุนุฉ ุชู ุชุฎุตูุตูุง ููููุฉ ูุนููุฉ ูู ุงูููุงุฑุฏ.  ูุชู ุงูุชุนุงูู ูุน ุฅุทูุงู ุงูุญุงููุฉ ุจูุงุณุทุฉ ูุฏูุฑ ููุงุฑุฏ YARN.  ูุญุฏุฏ ุฃู ูู ุงูุฃุฌูุฒุฉ ูุญุชูู ุนูู ุนุฏุฏ ูุงู ูู ููู ุงููุนุงูุฌ ูุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ุ ููุฐูู ูุง ุฅุฐุง ูุงู ูุญุชูู ุนูู ูุชู ุงูุจูุงูุงุช ุงููุงุฒูุฉ ูููุนุงูุฌุฉ. <br><br>  ุนูุฏ ุชุดุบูู ุชุทุจูู Spark ุ ุชููู YARN ุจุฅูุดุงุก ุงูุญุงููุฉ ูุชุดุบูููุง ุนูู ุฃุญุฏ ุขูุงุช ุงููุฌููุนุฉ ุงูุชู ูุชู ูููุง ุชุดุบูู ุจุฑูุงูุฌ ุงูุชุดุบูู.  ุจุนุฏ ุฐูู ุ ุนูุฏูุง ูููู ุงูุณุงุฆู ุจุชุญุถูุฑ DAG ูู ุงูุนูููุงุช ุงูุชู ูุฌุจ ุชุดุบูููุง ุนูู ุงููููุฐูู ุ ุชููู YARN ุจุชุดุบูู ุญุงููุงุช ุฅุถุงููุฉ ุนูู ุงูุฃุฌูุฒุฉ ุงููุทููุจุฉ. <br><br>  ููุงุนุฏุฉ ุ ูููู ููุณุงุฆู ุฃู ูุฎุตุต ููุงุฉ ูุงุญุฏุฉ ููููุฉ ุตุบูุฑุฉ ูู ุงูุฐุงูุฑุฉ (ุฅูุง ุฅุฐุง ุ ุจุงูุทุจุน ุ ูู ูุชู ุชุฌููุน ูุชูุฌุฉ ุงูุญุณุงุจ ุนูู ุงูุณุงุฆู ูู ุงูุฐุงูุฑุฉ).  ุจุงููุณุจุฉ ุฅูู ุงููููุฐูู ุ ูู ุฃุฌู ุชุญุณูู ุงูููุงุฑุฏ ูุชูููู ุงูุนุฏุฏ ุงูุฅุฌูุงูู ููุนูููุงุช ูู ุงููุธุงู ุ ูููู ุชูููุฒ ุฃูุซุฑ ูู ุฌููุฑ ูุงุญุฏ: ูู ูุฐู ุงูุญุงูุฉ ุ ุณูููู ุงููููุฐ ูุงุฏุฑูุง ุนูู ุฃุฏุงุก ุงูุนุฏูุฏ ูู ุงูููุงู ูู ููุช ูุงุญุฏ. <br><br>  ูููู ูู ุงูููู ุฃู ูููู ุฃูู ูู ุญุงูุฉ ูุดู ุฅุญุฏู ุงูููุงู ููุฏ ุงูุชุดุบูู ูู ุงูุญุงููุฉ ุฃู ูู ุญุงูุฉ ุนุฏู ููุงูุฉ ุงูููุงุฑุฏ ุ ููุฏ ุชูุฑุฑ YARN ุฅููุงู ุงูุญุงููุฉ ุ ุซู ูุฌุจ ุฅุนุงุฏุฉ ุชุดุบูู ุฌููุน ุงูููุงู ุงูุชู ุชู ุชูููุฐูุง ูููุง ูุฑุฉ ุฃุฎุฑู ุนูู ูููุฐ ุขุฎุฑ.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุฅุฐุง ุฎุตุตูุง ุนุฏุฏูุง ูุจูุฑูุง ุจูุง ููู ุงูููุงูุฉ ูู ุงูููู ููู ุญุงููุฉ ุ ููู ุงููุญุชูู ุฃูุง ูุชููู YARN ูู ุชุดุบููู.  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ูุงู ูุฏููุง ุฌูุงุฒุงู ูุชู ุชุฑู ููุงุชูู ุนููููุง ุจุฏูู ุงุณุชุฎุฏุงู ุ ููููููุง ุงูุจุฏุก ูู ูู ุญุงููุฉ ุชุชุทูุจ ููุงุชูู ุ ูููู ูุง ูููููุง ุจุฏุก ุญุงููุฉ ูุงุญุฏุฉ ุชุชุทูุจ ุฃุฑุจุนุฉ ููู. <br><br>  ุงูุขู ุฏุนููุง ูุฑู ููู ุณูุชู ุชูููุฐ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูู ูุซุงููุง ูุจุงุดุฑุฉ ุนูู ุงููุชูุฉ.  ุชุฎูู ุฃู ุญุฌู ุงูุจูุงูุงุช ุงููุตุฏุฑ ูู 2 ุชูุฑุงุจุงูุช.  ููููุง ูุฐูู ุ ุฅุฐุง ูุงู ุญุฌู ุงููุชูุฉ ุนูู HDFS ูู 128 ููุบุง ุจุงูุช ุ ูุณูููู ููุงู 16384 ูุชูุฉ ูู ุงููุฌููุน.  ูุชู ูุณุฎ ูู ูุชูุฉ ุฅูู ุฃุฌูุฒุฉ ูุชุนุฏุฏุฉ ูุถูุงู ุงูููุซูููุฉ.  ูู ุฃุฌู ุงูุจุณุงุทุฉ ุ ูุฃุฎุฐ ูุนุงูู ุงููุณุฎ ูุณุงูู ุงุซููู ุ ุฃู ุฃูู ุณูููู ููุงู 32768 ูุชูุฉ ูุชุงุญุฉ ูู ุงููุฌููุน.  ูููุชุฑุถ ุฃููุง ูุณุชุฎุฏู ูุฌููุนุฉ ูู 16 ุฌูุงุฒูุง ููุชุฎุฒูู.  ูุจูุงุกู ุนูู ุฐูู ุ ูู ูู ุฌูุงุฒ ูู ุญุงูุฉ ุงูุชูุฒูุน ุงูููุชุธู ุ ุณูููู ููุงู ุญูุงูู 2048 ูุชูุฉ ุ ุฃู 256 ุบูุบุงุจุงูุช ููู ุฌูุงุฒ.  ุนูู ูู ุฌูุงุฒ ุ ูุฏููุง 8 ููู ูููุนุงูุฌ ู 64 ุฌูุฌุง ุจุงูุช ูู ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู. <br><br>  ููููุชูุง ุ ูุง ูุญุชุงุฌ ุจุฑูุงูุฌ ุงูุชุดุบูู ุฅูู ุงููุซูุฑ ูู ุงูููุงุฑุฏ ุ ูุฐูู ุณูุฎุตุต 1 ููุงุฉ ู 1 ุบูุบุงุจุงูุช ูู ุงูุฐุงูุฑุฉ ูุฐูู.  ุณูู ูุนุทู ููุงูู ุงูุฃุฏุงุก 2 ููุงุฉ ู 4 ุบูุบุงุจุงูุช ูู ุงูุฐุงูุฑุฉ.  ุงูุชุฑุถ ุฃููุง ูุฑูุฏ ุฒูุงุฏุฉ ุงุณุชุฎุฏุงู ููุงุฑุฏ ุงููุฌููุนุฉ.  ูุจุงูุชุงูู ุ ูุญุตู ุนูู 64 ุญุงููุฉ: ูุงุญุฏุฉ ููุณุงุฆู ุ ู 63 ููููุงููู. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/uw/qu/rc/uwqurc3i8v7wagn1zfexu-3dfgo.png"></div>  <i>ุงูุดูู 4. ุงูุนูููุงุช ุงูุชู ุชุนูู ุนูู ุนูุฏุฉ ุงูุจูุงูุงุช ูุงูููุงุฑุฏ ุงูุชู ูุณุชุฎุฏููููุง.</i> <br><br>  ูุธุฑูุง ูุฃููุง ูู ุญุงูุชูุง ูุณุชุฎุฏู ุนูููุงุช ุงูุฎุฑูุทุฉ ููุท ุ ูุฅู DAG ุงูุฎุงุตุฉ ุจูุง ุณุชุชููู ูู ุนูููุฉ ูุงุญุฏุฉ.  ูุชุชููู ูู ุงูุฅุฌุฑุงุกุงุช ุงูุชุงููุฉ: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฎุฐ ูุชูุฉ ูุงุญุฏุฉ ูู ุงูุจูุงูุงุช ูู ุงููุฑุต ุงูุตูุจ ุงููุญูู ุ </li><li style=";text-align:right;direction:rtl">  ุชุญููู ุงูุจูุงูุงุช </li><li style=";text-align:right;direction:rtl">  ุญูุธ ุงููุชูุฌุฉ ูู ูุชูุฉ ุฌุฏูุฏุฉ ุนูู ุงููุฑุต ุงููุญูู ุงูุฎุงุต ุจู. </li></ol><br>  ูู ุงููุฌููุน ุ ูุญุชุงุฌ ุฅูู ูุนุงูุฌุฉ 16384 ูุชูุฉ ุ ูุฐูู ูุฌุจ ุนูู ูู ูููุฐ ุชูููุฐ 16384 / (63 ูููุฐูุง * 2 ููุงุฉ) = 130 ุนูููุฉ.  ูุจุงูุชุงูู ุ ูุฅู ุฏูุฑุฉ ุญูุงุฉ ุงููููุฐ ูุนูููุฉ ูููุตูุฉ (ูู ุญุงูุฉ ุญุฏูุซ ูู ุดูุก ุฏูู ุงูุณููุท) ุณุชุจุฏู ุนูู ุงููุญู ุงูุชุงูู. <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฅุทูุงู ุงูุญุงููุฉ. </li><li style=";text-align:right;direction:rtl">  ุชููู ูููุฉ ูู ุงูุณุงุฆู ูููู ูููุง ูุนุฑู ูุชูุฉ ูุงูุนูููุฉ ุงููุงุฒูุฉ.  ูุธุฑูุง ูุฃููุง ุฎุตุตูุง ูุฑูุฒูู ููุญุงููุฉ ุ ูุฅู ุงููููุฐ ูุชููู ูููุชูู ูู ููุช ูุงุญุฏ. </li><li style=";text-align:right;direction:rtl">  ุฃุฏุงุก ูููุฉ ูุฅุฑุณุงู ุงููุชูุฌุฉ ููุณุงุฆู. </li><li style=";text-align:right;direction:rtl">  ุงูุญุตูู ุนูู ุงููููุฉ ุงูุชุงููุฉ ูู ุจุฑูุงูุฌ ุงูุชุดุบูู ูุชูุฑุงุฑ ุงูุฎุทูุชูู 2 ู 3 ุญุชู ุชุชู ูุนุงูุฌุฉ ุฌููุน ุงููุชู ููุฐุง ุงูุฌูุงุฒ ุงููุญูู. </li><li style=";text-align:right;direction:rtl">  ุชููู ุงูุญุงููุฉ </li></ol><br>  <i>ููุงุญุธุฉ</i> : ูุชู ุงูุญุตูู ุนูู DAGs ุฃูุซุฑ ุชุนููุฏูุง ุฅุฐุง ูุงู ูู ุงูุถุฑูุฑู ุฅุนุงุฏุฉ ุชูุฒูุน ุงูุจูุงูุงุช ุงููุณูุทุฉ ุจูู ุงูุฃุฌูุฒุฉ ุ ุนุงุฏุฉู ูุนูููุงุช ุงูุชุฌููุน (groupBy ุ ู replaceByKey ุ ููุง ุฅูู ุฐูู) ูุงูุงุชุตุงูุงุช (ุงูุงูุถูุงู) ุ ูุงูุชู ูุนุชุจุฑ ุงููุธุฑ ูููุง ุฎุงุฑุฌ ูุทุงู ูุฐู ุงูููุงูุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  ุงููุดุงูู ุงูุฑุฆูุณูุฉ ููุชูุงุนู ุจูู ุฃุจุงุชุดู ุณุจุงุฑู ูุงูุฎุฏูุงุช ุงูุฎุงุฑุฌูุฉ </h3><br>  ุฅุฐุง ุงุญุชุฌูุง ุ ูู ุฅุทุงุฑ ุนูููุฉ ุงูุฎุฑูุทุฉ ุ ุฅูู ุงููุตูู ุฅูู ุจุนุถ ุงูุฎุฏูุงุช ุงูุฎุงุฑุฌูุฉ ุ ุชุตุจุญ ุงููููุฉ ุฃูู ุตุนูุจุฉ.  ุงูุชุฑุถ ุฃู ูุงุฆู ูู ูุฆุฉ ExternalServiceClient ูุณุคูู ุนู ุงูุชูุงุนู ูุน ุฎุฏูุฉ ุฎุงุฑุฌูุฉ.  ุจุดูู ุนุงู ุ ูุจู ุจุฏุก ุงูุนูู ุ ูุญุชุงุฌ ุฅูู ุชููุฆุชู ุ ุซู ูุณูููุง ุญุณุจ ุงูุถุฑูุฑุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> client = <span class="hljs-type"><span class="hljs-type">ExternalServiceClient</span></span>.create() <span class="hljs-comment"><span class="hljs-comment">// val score = client.score(featureVector) // .</span></span></code> </pre><br>  ุนุงุฏุฉ ุ ุชุณุชุบุฑู ุชููุฆุฉ ุงูุนููู ุจุนุถ ุงูููุช ุ ูุจุงูุชุงูู ุ ููุงุนุฏุฉ ุนุงูุฉ ุ ุชุชู ุชููุฆุชู ุนูุฏ ุจุฏุก ุชุดุบูู ุงูุชุทุจูู ุ ุซู ูุชู ุงุณุชุฎุฏุงูู ููุญุตูู ุนูู ูุซูู ุนููู ูู ุจุนุถ ุงูุณูุงู ุงูุนุงู ุฃู ุงูุชุฌูุน ุงูุนุงู.  ูุฐูู ุ ุนูุฏูุง ุชุชููู ุญุงููุฉ ูุน ูููุฐ Spark ูููุฉ ุชุชุทูุจ ุงูุชูุงุนู ูุน ุฎุฏูุฉ ุฎุงุฑุฌูุฉ ุ ุณูููู ูู ุงูุฌูุฏ ุงูุญุตูู ุนูู ุนููู ุชูุช ุชููุฆุชู ุจุงููุนู ูุจู ุจุฏุก ุงูุนูู ุนูู ุตููู ุงูุจูุงูุงุช ุ ุซู ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงูู ููู ุนูุตุฑ. <br><br>  ููุงู ุทุฑููุชุงู ููููุงู ุจุฐูู ูู Spark.  ุฃููุงู ุ ุฅุฐุง ูุงู ุงูุนููู ูุงุจูุงู ููุชุณูุณู (ูุฌุจ ุนูู ุงูุนููู ููุณู ูุฌููุน ุญูููู ุชูุณูุน ูุงุฌูุฉ java.io.Serializable) ุ ููููู ุชููุฆุชู ุนูู ุจุฑูุงูุฌ ุงูุชุดุบูู ุซู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชูุฑูุฑู ุฅูู ุงููููุฐูู ุนุจุฑ ุขููุฉ ูุชุบูุฑ ุงูุจุซ</a> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> client = <span class="hljs-type"><span class="hljs-type">ExternalServiceClient</span></span>.create() <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> clientBroadcast = sparkContext.broadcast(client) ds.map { f: <span class="hljs-type"><span class="hljs-type">Features</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> score = clientBroadcast.value.score(f.vector) <span class="hljs-type"><span class="hljs-type">Score</span></span>(f.id, score) }</code> </pre><br>  ูู ุญุงูุฉ ุนุฏู ุฅููุงููุฉ ุฅุฌุฑุงุก ุชุณูุณู ููุนููู ุ ุฃู ุฃู ุชููุฆุฉ ุงูุนููู ูู ุนูููุฉ ุชุนุชูุฏ ุนูู ุฅุนุฏุงุฏุงุช ุงูุฌูุงุฒ ุงููุนูู ุงูุฐู ูุนูู ุนููู (ุนูู ุณุจูู ุงููุซุงู ุ ูุชุญููู ุงูุชูุงุฒู ุ ูุฌุจ ุฃู ุชุฐูุจ ุงูุทูุจุงุช ูู ุฌุฒุก ูู ุงูุฃุฌูุฒุฉ ุฅูู ุฌูุงุฒ ุงูุฎุฏูุฉ ุงูุฃูู ุ ูููุขุฎุฑ ุฅูู ุงูุซุงูู) ุ ุซู ูููู ุชููุฆุฉ ุงูุนููู ูุจุงุดุฑุฉ ุนูู ุงููููุฐ. <br><br>  ููุฐุง ุ ูุฅู RDD (ููุฌููุนุฉ ุงูุจูุงูุงุช) ูุฏููุง ุนูููุฉ mapPartitions ุ ููู ูุณุฎุฉ ูุนููุฉ ูุนูููุฉ ุงูุฎุฑูุทุฉ (ุฅุฐุง ูุธุฑุช ุฅูู ุดูุฑุฉ ุงููุตุฏุฑ ููุฆุฉ RDD ุ ูุชู ุชูููุฐ ุนูููุฉ ุงูุฎุฑูุทุฉ ูู ุฎูุงู mapPartitions).  ูุชู ุชุดุบูู ุงููุธููุฉ ุงูุชู ุชู ุชูุฑูุฑูุง ุฅูู ุนูููุฉ mapPartitions ูุฑุฉ ูุงุญุฏุฉ ููู ูุชูุฉ.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุชู ุชูููุฑ ููุฑุฑ ูุฅุฏุฎุงู ูุฐู ุงููุธููุฉ ููุจูุงูุงุช ุงูุชู ุณููุฑุฃูุง ูู ุงููุชูุฉ ุ ูุนูุฏ ุงูุฅุฎุฑุงุฌ ูุฌุจ ุฃู ูุนูุฏ ููุฑุฑูุง ูุจูุงูุงุช ุงูุฅุฎุฑุงุฌ ุงูููุงุจูุฉ ููุชูุฉ ุงูุฅุฏุฎุงู: </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs">ds.mapPartitions {fi: <span class="hljs-type"><span class="hljs-type">Iterator</span></span>[<span class="hljs-type"><span class="hljs-type">Features</span></span>] =&gt; <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> client = <span class="hljs-type"><span class="hljs-type">ExternalServiceClient</span></span>.create() fi.map { f: <span class="hljs-type"><span class="hljs-type">Features</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> score = client.score(f.vector) <span class="hljs-type"><span class="hljs-type">Score</span></span>(f.id, score) } }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ูุฐุง ุงูุฑูุฒ ุ ูุชู ุฅูุดุงุก ุนููู ูุฎุฏูุฉ ุฎุงุฑุฌูุฉ ููู ูุชูุฉ ูู ุจูุงูุงุช ุงููุตุฏุฑ. </font><font style="vertical-align: inherit;">ูุฐุง ุ ุจุงูุทุจุน ุ ุฃูุถู ูู ุฅูุดุงุก ุนููู ูู ูู ูุฑุฉ ููุนุงูุฌุฉ ูู ุนูุตุฑ ุ ููู ูุซูุฑ ูู ุงูุญุงูุงุช ูููู ูุฐุง ุญููุง ููุจูููุง ุชูุงููุง. </font><font style="vertical-align: inherit;">ููุน ุฐูู ุ ุจุนุฏ ุฐูู ููููุงู ุ ุณุฃูุถุญ ููู ููููู ุฅูุดุงุก ูุงุฆู ุณูุชู ุชููุฆุชู ูุฑุฉ ูุงุญุฏุฉ ูู ุจุฏุงูุฉ ุงูุญุงููุฉ ุซู ุงุณุชุฎุฏุงูู ูุจุฏุก ุฌููุน ุงูููุงู ุงูุชู ุชุฃุชู ูู ูุฐู ุงูุญุงููุฉ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชููู ุนูููุฉ ูุนุงูุฌุฉ ุงูููุฑุฑ ุงููุงุชุฌ ูุชุฑุงุจุทุฉ. </font><font style="vertical-align: inherit;">ุฏุนูู ุฃุฐูุฑู ุจุฃู ุงูููุท ุงูุฑุฆูุณู ูููุตูู ุฅูู ุจููุฉ ููุน ุงูููุฑุฑ ูู ุงุณุชุฏุนุงุก ูุชุณูุณู ูู hasNext ูุงูุฃุณุงููุจ ุงูุชุงููุฉ:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (i.hasNext()) { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> item = i.next() โฆ }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฐุง ูุงู ูุฏููุง ูุฑูุฒุงู ูุฎุตุตุงู ูููููุฐ ุ ูุณูููู ูููุง ุณูุฑ ุนูู ุฑุฆูุณูุงู ููุท ูุดุงุฑูุงู ูู ูุนุงูุฌุฉ ุงูุจูุงูุงุช. ุฏุนูู ุฃุฐูุฑู ุฃูู ุฅุฐุง ูุงู ูุฏููุง 8 ููู ุนูู ุงูุฌูุงุฒ ุ ููู ูุณูุญ YARN ููุง ุจุชุดุบูู ุฃูุซุฑ ูู 4 ุนูููุงุช ููููุฐูู ูู ููู ุนูู ุงูุชูุงูู ุ ููู ูููู ูุฏููุง ุณูู 8 ุณูุงุณู ููู ุฌูุงุฒ. ุจุงููุณุจุฉ ููุญูุณุจุฉ ุงููุญููุฉ ุ ูุนุฏ ูุฐุง ูู ุงูุฎูุงุฑ ุงูุฃูุถู ุ ุญูุซ ุณูููุฑ ุงูุญูู ุงูุฃูุตู ูููุฉ ุงูุญูุณุจุฉ ูุน ุงูุญุฏ ุงูุฃุฏูู ูู ุงููููุงุช ููุชุญูู ูู ุงูุชุฏูู. ููุน ุฐูู ุ ูู ุญุงูุฉ ุงูุชูุงุนู ูุน ุงูุฎุฏูุงุช ุงูุฎุงุฑุฌูุฉ ุ ุชุชุบูุฑ ุงูุตูุฑุฉ.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูุฏ ุงุณุชุฎุฏุงู ุงูุฎุฏูุงุช ุงูุฎุงุฑุฌูุฉ ุ ูุนุฏ ุงูุฃุฏุงุก ุฃุญุฏ ุฃูู ุงููุดููุงุช. ุฅู ุฃุจุณุท ุทุฑููุฉ ูุชูููุฐ ุฐูู ูู ุงุณุชุฎุฏุงู ุนููู ูุชุฒุงูู ุ ุญูุซ ูุตู โโุฅูู ุงูุฎุฏูุฉ ููู ุนูุตุฑ ุ ูุจุนุฏ ุชููู ุงุณุชุฌุงุจุฉ ููู ุ ูุดูู ุงููููุฉ ุงููุงุชุฌุฉ. ููุน ุฐูู ุ ูุฅู ูุฐุง ุงูููุฌ ูู ุนูุจ ูุจูุฑ: ุฃุซูุงุก ุงูุชูุงุนู ุงููุชุฒุงูู ุ ูุชู ุญุธุฑ ุณูุณูุฉ ุฑุณุงุฆู ุชุณุชุฏุนู ุฎุฏูุฉ ุฎุงุฑุฌูุฉ ุจุดูู ูุชุฒุงูู ุทูุงู ูุฏุฉ ุงูุชูุงุนู ูุน ูุฐู ุงูุฎุฏูุฉ. ูุงูุญูููุฉ ูู ุฃูู ุนูุฏูุง ูุชู ุงุณุชุฏุนุงุก ุทุฑููุฉ hasNext ุ ูุชููุน ุงูุญุตูู ุนูู ุฅุฌุงุจุฉ ูุง ูุจุณ ูููุง ุนูู ุงูุณุคุงู ุนูุง ุฅุฐุง ูุงู ููุงู ุงููุฒูุฏ ูู ุงูุนูุงุตุฑ ููุนุงูุฌุชูุง. ูู ุญุงูุฉ ุนุฏู ุงููููู (ุนูู ุณุจูู ุงููุซุงู ุ ุนูุฏูุง ุฃุฑุณููุง ุทูุจูุง ูุฎุฏูุฉ ุฎุงุฑุฌูุฉ ููุง ูุนุฑู ูุง ุฅุฐุง ูุงูุช ุณุชุนูุฏ ุฅุฌุงุจุฉ ูุงุฑุบุฉ ุฃู ุบูุฑ ูุงุฑุบุฉ) ููุณ ูุฏููุง ุฎูุงุฑ ุณูู ุงูุชุธุงุฑ ุฅุฌุงุจุฉ ุ ูุจุงูุชุงูู ุญุธุฑ ุณูุณูุฉ ุงูุฑุณุงุฆู ุงูุชู ุชุณูู ูุฐู ุงูุทุฑููุฉ. ูุฐูู</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุฑุฑ ูู ุจููุฉ ุจูุงูุงุช ุญุฌุจ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/4_/hn/vl/4_hnvluet1tc0lvq68urw9ij5fi.png" width="550"></div> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุดูู 5. ูุนุงูุฌุฉ ุงูุจุชุงุช ููููุฑุฑ ุงูุฐู ุชู ุงูุญุตูู ุนููู ูุชูุฌุฉ ุงุณุชุฏุนุงุก ุงููุธููุฉ ุงูุชู ุชู ุชูุฑูุฑูุง ุฅูู mapPartitions ุชุญุฏุซ ูู ุฎูุท ูุงุญุฏ. </font><font style="vertical-align: inherit;">ููุชูุฌุฉ ูุฐูู ุ ูุญุตู ุนูู ุงุณุชุฎุฏุงู ุบูุฑ ูุนุงู ููุบุงูุฉ ููููุงุฑุฏ. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง ุชุชุฐูุฑ ุ ูููุง ุจุชุญุณูู ุฎุฏูุฉ ุงูุชุตููู ุงูุฎุงุตุฉ ุจูุง ุจุญูุซ ุชุชูุญ ููุง ูุนุงูุฌุฉ ุงูุนุฏูุฏ ูู ุงูุทูุจุงุช ูู ููุณ ุงูููุช. </font><font style="vertical-align: inherit;">ููููุง ูุฐูู ุ ูุญุชุงุฌ ุฅูู ุฌูุน ุงูุนุฏุฏ ุงููุงุฒู ูู ุงูุทูุจุงุช ูู ุงูููุฑุฑ ุงูุฃุตูู ุ ูุฅุฑุณุงููุง ุฅูู ุงูุฎุฏูุฉ ุ ูุงูุญุตูู ุนูู ุฑุฏ ูุฅุตุฏุงุฑูุง ููููุฑุฑ ุงููุงุชุฌ.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/0e/dm/yy/0edmyyfjkekpdp5f0ncx84tevei.png" width="450"></div> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุดูู 6. ุงูุชูุงุนู ุงููุชุฒุงูู ุนูุฏ ุฅุฑุณุงู ุทูุจ ุชุตููู ููุฌููุนุฉ ูู ุงูุนูุงุตุฑ ูู</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงููุงูุน ุ ูู ูุฐู ุงูุญุงูุฉ ุ ูู ูููู ุงูุฃุฏุงุก ุฃูุถู ุจูุซูุฑ ุ ูุฃูู ุ ุฃููุงู ุ ูุญู ูุถุทุฑูู ููุญูุงุธ ุนูู ุงูุฎูุท ุงูุฑุฆูุณู ูู ุญุงูุฉ ูุญุธูุฑุฉ ุฃุซูุงุก ุงูุชูุงุนู ูุน ุฎุฏูุฉ ุฎุงุฑุฌูุฉ ุ ู ุ ุซุงูููุง ุ ุงูุฎุฏูุฉ ุงูุฎุงุฑุฌูุฉ ุฎุงููุฉ ุฃุซูุงุก ุนูููุง ุนูู ุงููุชูุฌุฉ.</font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุจูุงู ุงูุฎุชุงูู ูููุดููุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุจุงูุชุงูู ุ ุนูุฏ ุงุณุชุฎุฏุงู ุฎุฏูุฉ ุฎุงุฑุฌูุฉ ุ ูุฌุจ ุนูููุง ุญู ูุดููุฉ ุงููุตูู ุงููุชุฒุงูู. ูู ุงููุงุญูุฉ ุงููุซุงููุฉ ุ ุณูููู ูู ุงูููุงุฆู ููู ุงูุชูุงุนู ูุน ุงูุฎุฏูุงุช ุงูุฎุงุฑุฌูุฉ ุฅูู ุชุฌูุน ูุคุดุฑุงุช ุชุฑุงุจุท ูููุตู. ูู ูุฐู ุงูุญุงูุฉ ุ ุณูุชู ุชูููุฐ ุงูุทูุจุงุช ุฅูู ุงูุฎุฏูุงุช ุงูุฎุงุฑุฌูุฉ ูู ููุช ูุงุญุฏ ูุน ูุนุงูุฌุฉ ูุชุงุฆุฌ ุงูุทูุจุงุช ุงูุณุงุจูุฉ ุ ูุจุงูุชุงูู ุณูููู ูู ุงููููู ุงุณุชุฎุฏุงู ููุงุฑุฏ ุงูุฌูุงุฒ ุจููุงุกุฉ ุฃูุจุฑ. ููุชูุงุนู ุจูู ุงูุฎููุท ุ ูููู ุงุณุชุฎุฏุงู ูุงุฆูุฉ ุงูุชุธุงุฑ ุงูุญุธุฑ ุ ูุงูุชู ุณุชููู ุจูุซุงุจุฉ ูุฎุฒู ูุคูุช ููุงุชุตุงูุงุช. ุณุชุคุฏู ุงูุชุฏููุงุช ุงููุณุคููุฉ ุนู ุงูุชูุงุนู ูุน ุงูุฎุฏูุงุช ุงูุฎุงุฑุฌูุฉ ุฅูู ูุถุน ุงูุจูุงูุงุช ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุ ูุณูุฃุฎุฐูุง ุงูุฏูู ุงูุฐู ูุนุงูุฌ ุงูููุฑุฑ ุงููุงุชุฌ ูู ููุงู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุน ุฐูู ุ ูุซู ูุฐู ุงููุนุงูุฌุฉ ุบูุฑ ุงููุชุฒุงููุฉ ุชูุฏู ุนุฏุฏูุง ูู ุงููุดููุงุช ุงูุฅุถุงููุฉ.</font></font><br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ,       ,       ,          . </li><li style=";text-align:right;direction:rtl">  ,            ,    .          ,     .                         ,      . </li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ุชููู ุทุฑููุฉ hasNext ุจุฅุฑุฌุงุน ุฎุทุฃ ูู ุงูููุฑุฑ ุงููุงุชุฌ ุ ุชุญุชุงุฌ ุฅูู ุงูุชุฃูุฏ ูู ุงูุฑุฏ ุนูู ุฌููุน ุงูุทูุจุงุช ูุงูุฅุดุงุฑุฉ ุฅูู ุฃูู ูู ูููู ููุงู ุงููุฒูุฏ ูู ุงูุจูุงูุงุช ูู ุงููุฎุฒู ุงููุคูุช. </font><font style="vertical-align: inherit;">ูุน ุงููุนุงูุฌุฉ ุงููุชุฒุงููุฉ ุ ูุฐุง ุฃูุฑ ุจุณูุท ููุบุงูุฉ: ุฅุฐุง ุ ุจุนุฏ ูุนุงูุฌุฉ ุงูุงุณุชุฌุงุจุฉ ุงูุชุงููุฉ ุ ุนุงุฏ ุงูููุฑุฑ ุงูุฃุตูู hasNext = false ุ ูุจุงูุชุงูู ุ ูู ูููู ููุงู ุงููุฒูุฏ ูู ุงูุนูุงุตุฑ. </font><font style="vertical-align: inherit;">ูู ุญุงูุฉ ุงููุนุงูุฌุฉ ุบูุฑ ุงููุชุฒุงููุฉ ุ ุฎุงุตุฉ ุฅุฐุง ุฃุฑุณููุง ุนุฏุฉ ุทูุจุงุช ูู ููุณ ุงูููุช ุ ูุฃูุช ุจุญุงุฌุฉ ุฅูู ุชูุณูู ุงุณุชูุงู ุงูุฑุฏูุฏ ุ ูุจุนุฏ ุฅุฑุณุงู ุงูุฑุฏ ุงูุฃุฎูุฑ ููุท ุฃุฑุณู ุฅุดุงุฑุฉ ูุฅููุงู ุงููุนุงูุฌุฉ.</font></font></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญูู ููู ุชูููุง ูู ุญู ูุฐู ุงููุดุงูู ุจูุนุงููุฉ ุ ุณุฃุฎุจุฑูุง ูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฌุฒุก ุงูุชุงูู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ุชุฑูุจูุง!</font></font><br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ูุฐู ุงูุฃุซูุงุก ุ ุงูุธุฑ ุฅูู ุงููุธุงุฆู ุงูุดุงุบุฑุฉ ูู ุดุฑูุชูุง ุ ุฑุจูุง ูุญู ูุจุญุซ ุนููุ</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุทูุฑ ุฌุงูุง</font></font></a> </li><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุฏุณ ูุธู</font></font></a> </li></ul><br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar413137/">https://habr.com/ru/post/ar413137/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar413125/index.html">ูููุญ ุงูุนูุงุฌ ุงูุฌููู ุงููุฑุถู ุงูุตุบุงุฑ ุงููุตุงุจูู ุจุถููุฑ ุงูุนุถูุงุช ูุฑุตุฉ ููุจูุงุก ุนูู ููุฏ ุงูุญูุงุฉ</a></li>
<li><a href="../ar413127/index.html">ุจุถุน ูููุงุช ุญูู ุงูุฃุฏุงุก ุงูุญูููู ูุจุฑูุงูุฌ Hypervisor</a></li>
<li><a href="../ar413129/index.html">25 ุฎุทุฃ ูุจุฑูุฌ ูุจุชุฏุฆ</a></li>
<li><a href="../ar413133/index.html">ุงููุถุงุฏุงุช ุงูุดุนุจูุฉ: ุชุฑููู ุงูุตูุญุงุช</a></li>
<li><a href="../ar413135/index.html">ุชุนููู ุงุฎุชุจุงุฑ ูุฑุงุฌุนุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ููุทูุฑู ุงูุชูุงุนู ุงููุจุชุฏุฆูู</a></li>
<li><a href="../ar413139/index.html">ุงูุณูุงุฑุงุช ุงูููุฑุจุงุฆูุฉ: ุงูุซูุฑุฉ ูุงุฏูุฉ</a></li>
<li><a href="../ar413141/index.html">ุชุตููู ูููุงุช ูุจูุฑุฉ ูู ุงูุจูุงูุงุช ุนูู Apache Spark ุจุงุณุชุฎุฏุงู ููุงุฐุฌ ุงูุชุนูู ุงูุขูู ุงูุชุนุณูู</a></li>
<li><a href="../ar413143/index.html">Bobby Urban Lite: ุญููุจุฉ ุงูุธูุฑ ุงูุญุถุฑูุฉ ุงูุฌุฏูุฏุฉ ูู XD Design</a></li>
<li><a href="../ar413145/index.html">ูุญูู ูุณุงุนุฏ ุงูุฃุนูุงู ุงูุชุฌุงุฑูุฉ ุนูู ูุณุจ ุงููุงู</a></li>
<li><a href="../ar413147/index.html">ูู ูู ุงููููู ุงุณุชุฎุฏุงู Tibero ุจุฏูุงู ูู Oracle. ููู ูู ุงูุถุฑูุฑู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>