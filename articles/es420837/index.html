<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöú üçÅ ‚ùì Prueba de matrices RAID de software para dispositivos NVMe utilizando la metodolog√≠a SNIA üöµ üë©‚Äç‚úàÔ∏è ü§∂üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hace unos meses, mientras trabajaban en el pr√≥ximo proyecto, los muchachos de nuestro laboratorio de investigaci√≥n estudiaron los discos NVMe y las so...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Prueba de matrices RAID de software para dispositivos NVMe utilizando la metodolog√≠a SNIA</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/raidix/blog/420837/"><img src="https://habrastorage.org/webt/4j/ib/lz/4jiblzb0pamckpjzolpdiq1gr8s.jpeg"><br><br>  Hace unos meses, mientras trabajaban en el pr√≥ximo proyecto, los muchachos de nuestro laboratorio de investigaci√≥n estudiaron los discos NVMe y las soluciones de software para encontrar la mejor opci√≥n para ensamblar una matriz de software. <br><br>  Los resultados de la prueba fueron sorprendentemente desalentadores: el enorme potencial de velocidad de los discos NVMe no se correlacionaba en absoluto con el rendimiento demostrado de los productos de software existentes. <br><a name="habracut"></a><br>  A nuestros desarrolladores no les gust√≥.  Y decidieron escribir su producto ... Un producto que a los vendedores posteriormente se les ocurri√≥ alegremente el nombre RAIDIX ERA. <br><br>  Hoy, m√°s de una docena de compa√±√≠as producen servidores adaptados para usar discos NVMe.  El mercado de productos que respaldan y desarrollan esta tecnolog√≠a tiene un enorme potencial.  En el informe anal√≠tico de G2M, se presentan cifras bastante convincentes de que este protocolo de transferencia de datos dominar√° en un futuro pr√≥ximo. <br><br><img src="https://habrastorage.org/webt/wd/f6/ol/wdf6olgkq9vam7sfinx9sb843ek.png"><br>  <i><font color="#99999">Gr√°fico del <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">informe G2M</a></font></i> <br><br>  Actualmente, uno de los l√≠deres en la producci√≥n de componentes NVMe es Intel.  Fue en su equipo que realizamos pruebas para evaluar las capacidades de los productos de software existentes para administrar un hardware tan "innovador". <br><br>  Junto con nuestro socio, Promobit (un fabricante de servidores y sistemas de almacenamiento de datos bajo la marca comercial BITBLAZE), organizamos las pruebas de las unidades NVMe de Intel y el software com√∫n para administrar dichos dispositivos.  Las pruebas se llevaron a cabo seg√∫n el m√©todo SNIA. <br><br>  En este art√≠culo compartiremos los n√∫meros obtenidos durante las pruebas del sistema de hardware Intel NVMe, las matrices de software de MDRAID, Zvol sobre ZFS RAIDZ2 y, de hecho, nuestro nuevo desarrollo. <br><br><h2>  Configuraci√≥n de hardware </h2><br>  Para la base de la plataforma de prueba, tomamos el sistema de servidor Intel Server System R2224WFTZS.  Tiene 2 z√≥calos para instalar procesadores escalables Intel Xeon y 12 canales de memoria (24 DIMM en total) DDR 4 con una frecuencia de hasta 2666 MHz. <br><br>  Puede encontrar m√°s informaci√≥n sobre la plataforma del servidor <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">en el sitio web del fabricante</a> . <br><br>  Todas las unidades NVMe conectadas a trav√©s de 3 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">placas</a> posteriores <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">F2U8X25S3PHS</a> . <br><br>  En total, tenemos 12 unidades NVMe INTEL SSDPD2MD800G4 con firmware CVEK6256004E1P0BGN en el sistema. <br><br>  La plataforma del servidor estaba equipada con dos procesadores Intel¬Æ Xeon¬Æ Gold 6130 a 2,10 GHz con Hyper-Threading habilitado, lo que permite lanzar dos subprocesos desde cada n√∫cleo.  Por lo tanto, en la salida recibimos 64 hilos inform√°ticos. <br><br><h2>  Preparaci√≥n de la prueba </h2><br>  Todas las pruebas en este art√≠culo se realizaron de acuerdo con la especificaci√≥n de la metodolog√≠a SNIA SSS PTSe v 1.1.  Incluso, se realiz√≥ una preparaci√≥n preliminar del almacenamiento para obtener un resultado estable y honesto. <br><br>  SNIA permite al usuario establecer los par√°metros para el n√∫mero de subprocesos y la profundidad de la cola, por lo que configuramos 64/32, que tiene 64 subprocesos inform√°ticos en 32 n√∫cleos. <br><br>  Cada prueba se realiz√≥ en 16 rondas para llevar el sistema a un nivel estable de indicadores y excluir valores aleatorios. <br><br>  Antes de comenzar las pruebas, hicimos una preparaci√≥n preliminar del sistema: <br><br><ol><li>  Instalaci√≥n de la versi√≥n del kernel 4.11 en CentOS 7.4. </li><li>  Apague C-STATES y P-STATES. </li><li>  Ejecute la utilidad tuned-adm y establezca el perfil de rendimiento de latencia. </li></ol><br>  Las pruebas de cada producto y art√≠culo se llevaron a cabo en las siguientes etapas: <br><br>  Preparaci√≥n de dispositivos seg√∫n la especificaci√≥n SNIA (dependiente e independiente del tipo de carga). <br><br><ol><li>  Prueba IOps en bloques de 4k, 8k, 16k, 32k, 64k, 128k, 1m con variaciones de combinaciones de lectura / escritura 0/100, 5/95, 35/65, 50/50, 65/35, 95/5, 100/0 . </li><li>  Pruebas de latencia con bloques de 4k, 8k, 16k con variaciones de combinaciones de lectura / escritura 0/100, 65/35 y 100/0.  El n√∫mero de hilos y la profundidad de la cola es 1-1.  Los resultados se registran como los retrasos promedio y m√°ximo. </li><li>  Prueba de rendimiento con bloques de 128k y 1M, en 64 l√≠neas de 8 equipos. </li></ol><br>  Comenzamos probando el rendimiento, la latencia y el rendimiento de la plataforma de hardware.  Esto nos permiti√≥ evaluar el potencial del equipo propuesto y compararlo con las capacidades de las soluciones de software aplicadas. <br><br><h2>  Prueba 1. Pruebas de hardware </h2><br>  Para empezar, decidimos ver de qu√© es capaz una unidad Intel DCM D3700 NVMe. <br>  En la especificaci√≥n, el fabricante declara los siguientes par√°metros de rendimiento: <br><blockquote>  Lectura aleatoria (100% de alcance) 450,000 IOPS <br>  Escritura aleatoria (alcance 100%) 88000 IOPS </blockquote><br><h3>  Prueba 1.1 Una unidad NVMe.  Prueba de IOPS </h3><br>  Resultado de rendimiento (IOps) en forma de tabla.  Lectura / Escritura Mix%. <br><table><tbody><tr><th>  Tama√±o del bloque </th><th>  R0% / W100% </th><th>  R5% / W95% </th><th>  R35% / W65% </th><th>  R50% / W50% </th><th>  R65% / W35% </th><th>  R95% / W5% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  84017.8 </td><td>  91393.8 </td><td>  117271,6 </td><td>  133059,4 </td><td>  175086.8 </td><td>  281131.2 </td><td>  390969.2 </td></tr><tr><td>  8k </td><td>  42602.6 </td><td>  45735.8 </td><td>  58980.2 </td><td>  67321.4 </td><td>  101357.2 </td><td>  171316.8 </td><td>  216551,4 </td></tr><tr><td>  16k </td><td>  21618.8 </td><td>  22834.8 </td><td>  29703,6 </td><td>  33821,2 </td><td>  52552,6 </td><td>  89731,2 </td><td>  108347 </td></tr><tr><td>  32k </td><td>  10929,4 </td><td>  11322 </td><td>  14787 </td><td>  16811 </td><td>  26577,6 </td><td>  47185,2 </td><td>  50670.8 </td></tr><tr><td>  64k </td><td>  5494,4 </td><td>  5671,6 </td><td>  7342,6 </td><td>  8285.8 </td><td>  13130.2 </td><td>  23884 </td><td>  27249.2 </td></tr><tr><td>  128k </td><td>  2748,4 </td><td>  2805,2 </td><td>  3617,8 </td><td>  4295,2 </td><td>  6506,6 </td><td>  11997,6 </td><td>  13631 </td></tr><tr><td>  1m </td><td>  351,6 </td><td>  354,8 </td><td>  451,2 </td><td>  684,8 </td><td>  830,2 </td><td>  1574,4 </td><td>  1702,8 </td></tr></tbody></table><br>  Resultado de rendimiento (IOps) en forma gr√°fica.  Lectura / Escritura Mix%. <br><br><img src="https://habrastorage.org/webt/ja/gw/al/jagwaldo3cvyw5bxk9uxgeaqvtq.png"><br><br>  En esta etapa, obtuvimos resultados que no llegan a los de f√°brica.  Lo m√°s probable es que NUMA (el esquema de implementaci√≥n de memoria de la computadora utilizado en sistemas multiprocesador, cuando el tiempo de acceso a la memoria est√° determinado por su ubicaci√≥n en relaci√≥n con el procesador) jug√≥ su papel, pero por ahora no le prestaremos atenci√≥n. <br><br><h3>  Prueba 1.2 Una unidad NVMe.  Pruebas de retraso </h3><br>  <b>Tiempo de respuesta promedio</b> (ms) en forma de tabla.  Lectura / Escritura Mix%. <br><table><tbody><tr><th>  Tama√±o del bloque </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  0,02719 </td><td>  0,072134 </td><td>  0,099402 </td></tr><tr><td>  8k </td><td>  0,029864 </td><td>  0,093092 </td><td>  0.121582 </td></tr><tr><td>  16k </td><td>  0,046726 </td><td>  0.137016 </td><td>  0.16405 </td></tr></tbody></table><br>  <b>Tiempo de respuesta promedio</b> (ms) en forma gr√°fica.  Lectura / Escritura Mix%. <br><br><img src="https://habrastorage.org/webt/di/dg/cy/didgcy1xldxrxa8e9qec9cfri8y.png"><br><br>  <b>Tiempo m√°ximo de respuesta</b> (ms) en forma de tabla.  Lectura / Escritura Mix%. <br><table><tbody><tr><th>  Tama√±o del bloque </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  6,9856 </td><td>  4.7147 </td><td>  1.5098 </td></tr><tr><td>  8k </td><td>  7,0004 </td><td>  4.3118 </td><td>  1.4086 </td></tr><tr><td>  16k </td><td>  7.0068 </td><td>  4.6445 </td><td>  1.1064 </td></tr></tbody></table><br>  <b>Tiempo m√°ximo de respuesta</b> (ms) en forma gr√°fica.  Lectura / Escritura Mix%. <br><br><img src="https://habrastorage.org/webt/j0/sp/1y/j0sp1ynjubpq8yfuikeiogvhzz0.png"><br><br><h3>  Prueba 1.3 Rendimiento </h3><br>  El √∫ltimo paso es evaluar el rendimiento.  Aqu√≠ est√°n los siguientes indicadores: <br><blockquote>  Grabaci√≥n secuencial de 1 MB: 634 MBps. <br>  Lectura secuencial de 1 MB: 1707 MBps. <br>  Grabaci√≥n secuencial de 128 Kb - 620 MBps. <br>  Lectura secuencial de 128 Kb - 1704 MBps. </blockquote><br>  Despu√©s de tratar con una unidad, procedemos a evaluar toda la plataforma, que consta de 12 unidades. <br><br><h3>  Prueba 1.4 Sistema en 12 unidades.  Prueba de IOPS </h3><br>  Aqu√≠, se tom√≥ una decisi√≥n decidida para ahorrar tiempo y mostrar resultados solo para trabajar con el bloque 4k, que es, con mucho, el escenario m√°s com√∫n e indicativo para evaluar el rendimiento. <br><br>  Resultado de rendimiento (IOps) en forma de tabla.  Lectura / Escritura Mix%. <br><table><tbody><tr><th>  Tama√±o del bloque </th><th>  R0% / W100% </th><th>  R5% / W95% </th><th>  R35% / W65% </th><th>  R50% / W50% </th><th>  R65% / W35% </th><th>  R95% / W5% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  1363078.6 </td><td>  1562345 </td><td>  1944105 </td><td>  2047612 </td><td>  2176476 </td><td>  3441311 </td><td>  4202364 </td></tr></tbody></table><br>  Resultado de rendimiento (IOps) en forma gr√°fica.  Lectura / Escritura Mix%. <br><br><img src="https://habrastorage.org/webt/lz/nb/za/lznbza47oi8rjwokg-eobx2rfnc.png"><br><br><h3>  Prueba del sistema 1.5 en 12 unidades.  Pruebas de ancho de banda </h3><br><blockquote>  Grabaci√≥n secuencial de 1 MB: 8612 MBps. <br>  Lectura secuencial de 1 MB: 20481 MBps. <br>  Grabaci√≥n secuencial de 128 Kb - 7500 MBps. <br>  Lectura secuencial de 128 Kb - 20400 MBps. </blockquote><br>  Examinaremos nuevamente los indicadores de rendimiento de hardware obtenidos al final del art√≠culo, compar√°ndolos con los n√∫meros del software probado en √©l. <br><br><h2>  Prueba 2: Prueba de MDRAID </h2><br>  Cuando hablamos de una matriz de software, MDRAID viene a la mente primero.  Recuerde que este es el RAID de software base para Linux, que se distribuye de forma gratuita. <br><br>  Veamos c√≥mo MDRAID maneja el sistema de 12 discos propuesto con un nivel de matriz RAID 0. Todos entendemos que construir RAID 0 en 12 unidades requiere un coraje especial, pero ahora necesitamos este nivel de matriz para demostrar las capacidades m√°ximas de esta soluci√≥n. <br><br><h3>  Prueba 2.1 MDRAID.  RAID 0. Prueba IOPS </h3><br>  Resultado de rendimiento (IOps) en forma de tabla.  Lectura / Escritura Mix%. <br><table><tbody><tr><th>  Tama√±o del bloque </th><th>  R0% / W100% </th><th>  R5% / W95% </th><th>  R35% / W65% </th><th>  R50% / W50% </th><th>  R65% / W35% </th><th>  R95% / W5% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  1010396 </td><td>  1049306.6 </td><td>  1312401.4 </td><td>  1459698.6 </td><td>  1932776.8 </td><td>  2692752.8 </td><td>  2963943.6 </td></tr><tr><td>  8k </td><td>  513627.8 </td><td>  527230.4 </td><td>  678140 </td><td>  771887.8 </td><td>  1146340.6 </td><td>  1894547.8 </td><td>  2526853,2 </td></tr><tr><td>  16k </td><td>  261087.4 </td><td>  263638.8 </td><td>  343679.2 </td><td>  392655.2 </td><td>  613912.8 </td><td>  1034843.2 </td><td>  1288299.6 </td></tr><tr><td>  32k </td><td>  131198.6 </td><td>  130947.4 </td><td>  170846.6 </td><td>  216039.4 </td><td>  309028.2 </td><td>  527920.6 </td><td>  644774.6 </td></tr><tr><td>  64k </td><td>  65083.4 </td><td>  65099.2 </td><td>  85257.2 </td><td>  131005.6 </td><td>  154839.8 </td><td>  268425 </td><td>  322739 </td></tr><tr><td>  128k </td><td>  32550.2 </td><td>  32718,2 </td><td>  43378,6 </td><td>  66999.8 </td><td>  78935.8 </td><td>  136869.8 </td><td>  161015.4 </td></tr><tr><td>  1m </td><td>  3802 </td><td>  3718,4 </td><td>  3233,4 </td><td>  3467,2 </td><td>  3546 </td><td>  6150.8 </td><td>  8193.2 </td></tr></tbody></table><br>  Resultado de rendimiento (IOps) en forma gr√°fica.  Lectura / Escritura Mix%. <br><br><img src="https://habrastorage.org/webt/jf/d1/kl/jfd1klb3wv6px-vjbxypjff8nmu.png"><br><br><h3>  Prueba 2.2 MDRAID.  RAID 0. Pruebas de retraso </h3><br>  <b>Tiempo de respuesta promedio</b> (ms) en forma de tabla.  Lectura / Escritura Mix%. <br><table><tbody><tr><th>  Tama√±o del bloque </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  0,03015 </td><td>  0,067541 </td><td>  0.102942 </td></tr><tr><td>  8k </td><td>  0,03281 </td><td>  0,082132 </td><td>  0.126008 </td></tr><tr><td>  16k </td><td>  0,050058 </td><td>  0.114278 </td><td>  0.170798 </td></tr></tbody></table><br>  <b>Tiempo de respuesta promedio</b> (ms) en forma gr√°fica.  Lectura / Escritura Mix%. <br><br><img src="https://habrastorage.org/webt/6l/_o/im/6l_oimj5-72qy9d6w9tobclq3n4.png"><br><br>  <b>Tiempo m√°ximo de respuesta</b> (ms) en forma de tabla.  Lectura / Escritura Mix%. <br><table><tbody><tr><th>  Tama√±o del bloque </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  6.7042 </td><td>  3.7257 </td><td>  0,8568 </td></tr><tr><td>  8k </td><td>  6.5918 </td><td>  2.2601 </td><td>  0.9004 </td></tr><tr><td>  16k </td><td>  6.3466 </td><td>  2.7741 </td><td>  2.5678 </td></tr></tbody></table><br>  <b>Tiempo m√°ximo de respuesta</b> (ms) en forma gr√°fica.  Lectura / Escritura Mix%. <br><br><img src="https://habrastorage.org/webt/ms/-s/or/ms-sorgvctpuijgx_jf2uomifty.png"><br><br><h3>  Prueba 2.3 MDRAID.  RAID 0. Pruebas de ancho de banda </h3><br><blockquote>  Escritura secuencial de 1 MB: 7820 MBPS. <br>  Lectura secuencial de 1 MB - 20418 MBPS. <br>  Escritura secuencial de 128 Kb - 7622 MBPS. <br>  Lectura secuencial de 128 Kb - 20,380 MBPS. </blockquote><br><h3>  Prueba 2.4 MDRAID.  RAID 6. Prueba IOPS </h3><br>  Veamos ahora qu√© tiene este sistema en el nivel RAID 6. <br><br>  Opciones de creaci√≥n de matriz <br><blockquote>  mdadm --create --verbose --chunk 16K / dev / md0 --level = 6 --raid-devices = 12 / dev / nvme0n1 / dev / nvme1n1 / dev / nvme2n1 / dev / nvme3n1 / dev / nvme4n1 / dev / nvme5n1 / dev / nvme8n1 / dev / nvme9n1 / dev / nvme10n1 / dev / nvme11n1 / dev / nvme6n1 / dev / nvme7n1 </blockquote><br>  El volumen total de la matriz fue de <b>7450.87</b> GiB. <br><br>  Comenzamos la prueba despu√©s de la inicializaci√≥n preliminar de la matriz RAID. <br><br>  Resultado de rendimiento (IOps) en forma de tabla.  Lectura / Escritura Mix%. <br><table><tbody><tr><th>  Tama√±o del bloque </th><th>  R0% / W100% </th><th>  R5% / W95% </th><th>  R35% / W65% </th><th>  R50% / W50% </th><th>  R65% / W35% </th><th>  R95% / W5% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  39907,6 </td><td>  42849 </td><td>  61609.8 </td><td>  78167.6 </td><td>  108594,6 </td><td>  641950.4 </td><td>  1902561.6 </td></tr><tr><td>  8k </td><td>  19474,4 </td><td>  20701,6 </td><td>  30316,4 </td><td>  39737.8 </td><td>  57051.6 </td><td>  394072.2 </td><td>  1875791.4 </td></tr><tr><td>  16k </td><td>  10371,4 </td><td>  10979,2 </td><td>  16022 </td><td>  20992.8 </td><td>  29955,6 </td><td>  225157,4 </td><td>  1267495.6 </td></tr><tr><td>  32k </td><td>  8505,6 </td><td>  8824.8 </td><td>  12896 </td><td>  16657.8 </td><td>  23823 </td><td>  173261.8 </td><td>  596857.8 </td></tr><tr><td>  64k </td><td>  5679,4 </td><td>  5931 </td><td>  8576,2 </td><td>  11137,2 </td><td>  15906,4 </td><td>  109469.6 </td><td>  320874.6 </td></tr><tr><td>  128k </td><td>  3976,8 </td><td>  4170,2 </td><td>  5974,2 </td><td>  7716.6 </td><td>  10996 </td><td>  68124.4 </td><td>  160453.2 </td></tr><tr><td>  1m </td><td>  768,8 </td><td>  811,2 </td><td>  1177,8 </td><td>  1515 </td><td>  2149,6 </td><td>  4880,4 </td><td>  5499 </td></tr></tbody></table><br>  Resultado de rendimiento (IOps) en forma gr√°fica.  Lectura / Escritura Mix%. <br><br><img src="https://habrastorage.org/webt/p7/as/5s/p7as5s0v49uhmbhznnvjrpmfgf0.png"><br><br><h3>  Prueba 2.5 MDRAID.  RAID 6. Pruebas de retraso </h3><br>  <b>Tiempo de respuesta promedio</b> (ms) en forma de tabla.  Lectura / Escritura Mix%. <br><table><tbody><tr><th>  Tama√±o del bloque </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  0.193702 </td><td>  0.145565 </td><td>  0.10558 </td></tr><tr><td>  8k </td><td>  0.266582 </td><td>  0.186618 </td><td>  0.127142 </td></tr><tr><td>  16k </td><td>  0.426294 </td><td>  0.281667 </td><td>  0.169504 </td></tr></tbody></table><br>  <b>Tiempo de respuesta promedio</b> (ms) en forma gr√°fica.  Lectura / Escritura Mix%. <br><br><img src="https://habrastorage.org/webt/ls/zv/3f/lszv3flgx0nduvygoxigvjfdfgk.png"><br><br>  <b>Tiempo m√°ximo de respuesta</b> (ms) en forma de tabla.  Lectura / Escritura Mix%. <br><table><tbody><tr><th>  Tama√±o del bloque </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  6.1306 </td><td>  4.5416 </td><td>  4.2322 </td></tr><tr><td>  8k </td><td>  6.2474 </td><td>  4.5197 </td><td>  3.5898 </td></tr><tr><td>  16k </td><td>  5.4074 </td><td>  5.5861 </td><td>  4.1404 </td></tr></tbody></table><br>  <b>Tiempo m√°ximo de respuesta</b> (ms) en forma gr√°fica.  Lectura / Escritura Mix%. <br><br><img src="https://habrastorage.org/webt/fv/id/ri/fvidriesmmcwdstzhrsnmwd-kqa.png"><br><br>  Vale la pena se√±alar que aqu√≠ MDRAID mostr√≥ un muy buen nivel de demoras. <br><br><h3>  Prueba 2.6 MDRAID.  RAID 6. Pruebas de ancho de banda </h3><br><blockquote>  Escritura secuencial de 1 MB: 890 MBPS. <br>  Lectura secuencial de 1 MB: 18800 MBPS. <br>  Escritura secuencial de 128 Kb - 870 MBPS. <br>  Lectura secuencial de 128 Kb - 10400 MBPS. </blockquote><br><h2>  Prueba 3. Zvol sobre ZFS RAIDZ2 </h2><br>  ZFS tiene una funci√≥n de creaci√≥n de RAID incorporada y un administrador de volumen incorporado que crea dispositivos de bloque virtual, que es utilizado por muchos fabricantes de almacenamiento.  Tambi√©n aprovecharemos estas caracter√≠sticas creando un grupo con protecci√≥n RAIDZ2 (an√°logo a RAID 6) y un volumen de bloque virtual encima. <br><br>  Se compil√≥ la versi√≥n 0.79 (ZFS).  Opciones de creaci√≥n de matriz y volumen: <br><blockquote>  ashift = 12 / compresi√≥n - off / dedup - off / recordsize = 1M / atime = off / cachefile = none / Type RAID = RAIDZ2 </blockquote><br>  ZFS muestra muy buenos resultados con el grupo creado recientemente.  Sin embargo, con el doblaje repetido, el rendimiento se reduce significativamente. <br><br>  El enfoque SNIA es bueno porque le permite ver resultados reales al probar sistemas de archivos similares (el basado en ZFS) despu√©s de sobrescribirlos repetidamente. <br><br><h3>  Prueba 3.1 ZVOL (ZFS).  RAIDZ2.  Prueba de IOps </h3><br>  Resultado de rendimiento (IOps) en forma de tabla.  Lectura / Escritura Mix%. <br><table><tbody><tr><th>  Tama√±o del bloque </th><th>  R0% / W100% </th><th>  R5% / W95% </th><th>  R35% / W65% </th><th>  R50% / W50% </th><th>  R65% / W35% </th><th>  R95% / W5% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  15719,6 </td><td>  15147,2 </td><td>  14190,2 </td><td>  15592,4 </td><td>  17965,6 </td><td>  44832,2 </td><td>  76314.8 </td></tr><tr><td>  8k </td><td>  15536,2 </td><td>  14929,4 </td><td>  15140.8 </td><td>  16551 </td><td>  17898.8 </td><td>  44553,4 </td><td>  76187.4 </td></tr><tr><td>  16k </td><td>  16696,6 </td><td>  15937,2 </td><td>  15982.6 </td><td>  17350 </td><td>  18546,2 </td><td>  44895,4 </td><td>  75549,4 </td></tr><tr><td>  32k </td><td>  11859,6 </td><td>  10915 </td><td>  9698,2 </td><td>  10235,4 </td><td>  11265 </td><td>  26741.8 </td><td>  38167.2 </td></tr><tr><td>  64k </td><td>  7444 </td><td>  6440,2 </td><td>  6313,2 </td><td>  6578,2 </td><td>  7465,6 </td><td>  14145.8 </td><td>  19099 </td></tr><tr><td>  128k </td><td>  4425,4 </td><td>  3785,6 </td><td>  4059,8 </td><td>  3859,4 </td><td>  4246,4 </td><td>  7143,4 </td><td>  10052,6 </td></tr><tr><td>  1m </td><td>  772 </td><td>  730,2 </td><td>  779,6 </td><td>  784 </td><td>  824,4 </td><td>  995,8 </td><td>  1514,2 </td></tr></tbody></table><br>  Resultado de rendimiento (IOps) en forma gr√°fica.  Lectura / Escritura Mix%. <br><br><img src="https://habrastorage.org/webt/0j/cf/fr/0jcffrp4gkeayltgnp5us5rg2q8.png"><br><br>  Las cifras de rendimiento son completamente impresionantes.  Al mismo tiempo, el zvol puro (antes de reescribir) da resultados significativamente mejores (5-6 veces m√°s).  Aqu√≠, la prueba mostr√≥ que despu√©s del primer doblaje, el rendimiento cae. <br><br><h3>  Prueba 3.2 ZVOL (ZFS).  RAIDZ2.  Pruebas de retraso </h3><br>  <b>Tiempo de respuesta promedio</b> (ms) en forma de tabla.  Lectura / Escritura Mix%. <br><table><tbody><tr><th>  Tama√±o del bloque </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  0.332824 </td><td>  0.255225 </td><td>  0.218354 </td></tr><tr><td>  8k </td><td>  0.3299 </td><td>  0.259013 </td><td>  0.225514 </td></tr><tr><td>  16k </td><td>  0.139738 </td><td>  0.180467 </td><td>  0.233332 </td></tr></tbody></table><br>  <b>Tiempo de respuesta promedio</b> (ms) en forma gr√°fica.  Lectura / Escritura Mix%. <br><br><img src="https://habrastorage.org/webt/ys/fj/hb/ysfjhbkrepf-zzj6bvdtx_hhrlm.png"><br><br>  <b>Tiempo m√°ximo de respuesta</b> (ms) en forma de tabla.  Lectura / Escritura Mix%. <br><table><tbody><tr><th>  Tama√±o del bloque </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  90,55 </td><td>  69,9718 </td><td>  84,4018 </td></tr><tr><td>  8k </td><td>  91,6214 </td><td>  86.6109 </td><td>  104.7368 </td></tr><tr><td>  16k </td><td>  108.2192 </td><td>  86.2194 </td><td>  105,658 </td></tr></tbody></table><br>  <b>Tiempo m√°ximo de respuesta</b> (ms) en forma gr√°fica.  Lectura / Escritura Mix%. <br><br><img src="https://habrastorage.org/webt/du/ue/_1/duue_1fwxcx-n4dmyd455pdrc40.png"><br><br><h3>  Prueba 3.3 ZVOL (ZFS).  RAIDZ2.  Pruebas de ancho de banda </h3><br><blockquote>  Escritura secuencial de 1 MB: 1150 MBPS. <br>  Lectura secuencial de 1 MB: 5500 MBPS. <br>  Escritura secuencial de 128 Kb - 1100 MBPS. <br>  Lectura secuencial de 128 Kb - 5300 MBPS. </blockquote><br><h2>  Prueba 4: RAIDIX ERA </h2><br>  Veamos ahora las pruebas de nuestro nuevo producto: RAIDIX ERA. <br>  Creamos RAID6.  Tama√±o de la raya: 16kb.  Una vez completada la inicializaci√≥n, ejecute la prueba. <br><br>  Resultado de rendimiento (IOps) en forma de tabla.  Lectura / Escritura Mix%. <br><table><tbody><tr><th>  Tama√±o del bloque </th><th>  R0% / W100% </th><th>  R5% / W95% </th><th>  R35% / W65% </th><th>  R50% / W50% </th><th>  R65% / W35% </th><th>  R95% / W5% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  354887 </td><td>  363830 </td><td>  486865.6 </td><td>  619349.4 </td><td>  921403.6 </td><td>  2202384.8 </td><td>  4073187.8 </td></tr><tr><td>  8k </td><td>  180914.8 </td><td>  185371 </td><td>  249927.2 </td><td>  320438.8 </td><td>  520188.4 </td><td>  1413096.4 </td><td>  2510729 </td></tr><tr><td>  16k </td><td>  92115.8 </td><td>  96327.2 </td><td>  130661.2 </td><td>  169247,4 </td><td>  275446,6 </td><td>  763307.4 </td><td>  1278465 </td></tr><tr><td>  32k </td><td>  59994.2 </td><td>  61765.2 </td><td>  83512.8 </td><td>  116562.2 </td><td>  167028.8 </td><td>  420216.4 </td><td>  640418.8 </td></tr><tr><td>  64k </td><td>  27660,4 </td><td>  28229.8 </td><td>  38687,6 </td><td>  56603.8 </td><td>  76976 </td><td>  214958.8 </td><td>  299137.8 </td></tr><tr><td>  128k </td><td>  14475.8 </td><td>  14730 </td><td>  20674,2 </td><td>  30358.8 </td><td>  40259 </td><td>  109258,2 </td><td>  160141.8 </td></tr><tr><td>  1m </td><td>  2892,8 </td><td>  3031,8 </td><td>  4032,8 </td><td>  6331,6 </td><td>  7514.8 </td><td>  15871 </td><td>  19078 </td></tr></tbody></table><br>  Resultado de rendimiento (IOps) en forma gr√°fica.  Lectura / Escritura Mix%. <br><br><img src="https://habrastorage.org/webt/px/on/md/pxonmd9exhzvhwqse0wugnzkc9o.png"><br><br><h3>  Prueba 4.2 RAIDIX ERA.  RAID 6. Pruebas de retraso </h3><br>  <b>Tiempo de respuesta promedio</b> (ms) en forma de tabla.  Lectura / Escritura Mix%. <br><table><tbody><tr><th>  Tama√±o del bloque </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  0.16334 </td><td>  0.136397 </td><td>  0,10958 </td></tr><tr><td>  8k </td><td>  0.207056 </td><td>  0.163325 </td><td>  0.132586 </td></tr><tr><td>  16k </td><td>  0.313774 </td><td>  0.225767 </td><td>  0.182928 </td></tr></tbody></table><br>  <b>Tiempo de respuesta promedio</b> (ms) en forma gr√°fica.  Lectura / Escritura Mix%. <br><br><img src="https://habrastorage.org/webt/hv/ad/xq/hvadxqbbwsigpbfi2d40nhsfevo.png"><br><br>  <b>Tiempo m√°ximo de respuesta</b> (ms) en forma de tabla.  Lectura / Escritura Mix%. <br><table><tbody><tr><th>  Tama√±o del bloque </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  5.371 </td><td>  3.4244 </td><td>  3.5438 </td></tr><tr><td>  8k </td><td>  5.243 </td><td>  3.7415 </td><td>  3.5414 </td></tr><tr><td>  16k </td><td>  7.628 </td><td>  4.2891 </td><td>  4.0562 </td></tr></tbody></table><br>  <b>Tiempo m√°ximo de respuesta</b> (ms) en forma gr√°fica.  Lectura / Escritura Mix%. <br><br><img src="https://habrastorage.org/webt/pk/ys/bb/pkysbbysl2ldmme0fcbptzjh0ug.png"><br><br>  Los retrasos son similares a los que produce MDRAID.  Pero para obtener conclusiones m√°s precisas, se debe realizar una estimaci√≥n de los retrasos bajo una carga m√°s grave. <br><br><h3>  Prueba 4.3 RAIDIX ERA.  RAID 6. Pruebas de ancho de banda </h3><br><blockquote>  Escritura secuencial de 1 MB: 8160 MBPS. <br>  Lectura secuencial de 1 MB - 19700 MBPS. <br>  Escritura secuencial de 128 Kb - 6200 MBPS. <br>  Lectura secuencial de 128 Kb - 19700 MBPS. </blockquote><br><h2>  Conclusi√≥n </h2><br>  Como resultado de las pruebas, vale la pena comparar los n√∫meros obtenidos de las soluciones de software con lo que nos proporciona la plataforma de hardware. <br><br>  Para analizar el rendimiento de la carga aleatoria, compararemos la velocidad de RAID 6 (RAIDZ2) cuando trabaje con un bloque en 4k. <br><table><tbody><tr><th></th><th>  MD RAID 6 </th><th>  RAIDZ2 </th><th>  RAIDIX ERA RAID 6 </th><th>  Hardware </th></tr><tr><td>  4k R100% / W0% </td><td>  1902561 </td><td>  76314 </td><td>  4073187 </td><td>  4,494,142 </td></tr><tr><td>  4k R65% / W35% </td><td>  108594 </td><td>  17965 </td><td>  921403 </td><td>  1823432 </td></tr><tr><td>  4k R0% / W100% </td><td>  39907 </td><td>  15719 </td><td>  354887 </td><td>  958054 </td></tr></tbody></table><br><img src="https://habrastorage.org/webt/cm/4g/ff/cm4gffjnga2flpdn0nl3yxiwew0.png"><br><br>  Para analizar el rendimiento de la carga en serie, analizaremos RAID 6 (RAIDZ2) con un bloque de 128k.  Entre subprocesos, utilizamos un cambio de 10 GB para eliminar el impacto de cach√© y mostrar un rendimiento real. <br><table><tbody><tr><th></th><th>  MD RAID 6 </th><th>  RAIDZ2 </th><th>  RAIDIX ERA RAID 6 </th><th>  Hardware </th></tr><tr><td>  Lectura de 128k seq </td><td>  10400 </td><td>  5300 </td><td>  19700 </td><td>  20,400 </td></tr><tr><td>  128k seq escribir </td><td>  870 </td><td>  1100 </td><td>  6200 </td><td>  7500 </td></tr></tbody></table><br><img src="https://habrastorage.org/webt/6l/dw/wt/6ldwwti-7dql_njqadpemrz1mxi.png"><br><br><h3>  Cual es el resultado? </h3><br>  Las matrices RAID de software populares y asequibles para trabajar con dispositivos NVMe no pueden mostrar el rendimiento inherente al potencial del hardware. <br><br>  Aqu√≠ hay una necesidad muy obvia de un software de control que pueda agitar la situaci√≥n y mostrar que la simbiosis de control de programa con unidades NVMe puede ser muy productiva y flexible. <br><br>  Al comprender esta solicitud, nuestra empresa cre√≥ un producto RAIDIX ERA, cuyo desarrollo se centr√≥ en resolver los siguientes problemas: <br><br><ul><li>  Alto rendimiento de lectura y escritura (varios millones de IOps) en matrices con paridad en modo mixto. </li><li>  Rendimiento de transmisi√≥n de 30 GBps, incluso durante la conmutaci√≥n por error y la recuperaci√≥n. </li><li>  Soporte para niveles RAID 5, 6, 7.3. </li><li>  Inicializaci√≥n y reconstrucci√≥n de fondo. </li><li>  Configuraciones flexibles para diferentes tipos de carga (lado del usuario). </li></ul><br>  Hoy, podemos decir que estas tareas se han completado y que el producto est√° listo para usar. <br><br>  Al mismo tiempo, entendiendo el inter√©s de muchas partes interesadas en tales tecnolog√≠as, nos preparamos para el lanzamiento no solo de una licencia paga, sino tambi√©n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gratuita</a> , que se puede utilizar por completo para resolver problemas tanto en unidades NVMe como SSD. <br><br>  Lea m√°s sobre RAIDIX ERA <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">en nuestro sitio web</a> . <br><br><h2>  UPD  Pruebas de ZFS reducidas con el tama√±o de registro y volblocksize 8k </h2><br>  Tabla de opciones de ZFS <br><table><tbody><tr><th>  Nombre </th><th>  Propiedad </th><th>  VALOR </th><th>  FUENTE </th></tr><tr><td>  tanque </td><td>  registrar </td><td>  8K </td><td>  local </td></tr><tr><td>  tanque </td><td>  compresi√≥n </td><td>  fuera </td><td>  por defecto </td></tr><tr><td>  tanque </td><td>  deducir </td><td>  fuera </td><td>  por defecto </td></tr><tr><td>  tanque </td><td>  suma de comprobaci√≥n </td><td>  fuera </td><td>  local </td></tr><tr><td>  tanque </td><td>  volblocksize </td><td>  - </td><td>  - </td></tr><tr><td>  tanque / incursi√≥n </td><td>  registrar </td><td>  - </td><td>  - </td></tr><tr><td>  tanque / incursi√≥n </td><td>  compresi√≥n </td><td>  fuera </td><td>  local </td></tr><tr><td>  tanque / incursi√≥n </td><td>  deducir </td><td>  fuera </td><td>  por defecto </td></tr><tr><td>  tanque / incursi√≥n </td><td>  suma de comprobaci√≥n </td><td>  fuera </td><td>  local </td></tr><tr><td>  tanque / incursi√≥n </td><td>  volblocksize </td><td>  8k </td><td>  por defecto </td></tr></tbody></table><br>  La grabaci√≥n ha empeorado, la lectura es mejor. <br>  Pero de todos modos, todos los resultados son significativamente peores que otras soluciones <br><table><tbody><tr><th>  Tama√±o del bloque </th><th>  R0% / W100% </th><th>  R5% / W95% </th><th>  R35% / W65% </th><th>  R50% / W50% </th><th>  R65% / W35% </th><th>  R95% / W5% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  13703.8 </td><td>  14399,8 </td><td>  20903.8 </td><td>  25669 </td><td>  31610 </td><td>  66955.2 </td><td>  140849.8 </td></tr><tr><td>  8k </td><td>  15126 </td><td>  16227,2 </td><td>  22393,6 </td><td>  27720,2 </td><td>  34274.8 </td><td>  67008 </td><td>  139480.8 </td></tr><tr><td>  16k </td><td>  11111.2 </td><td>  11412.4 </td><td>  16980,8 </td><td>  20812.8 </td><td>  24680,2 </td><td>  48803,6 </td><td>  83710.4 </td></tr></tbody></table></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es420837/">https://habr.com/ru/post/es420837/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es420825/index.html">Hoy ser√° el primer partido entre los profesionales de OpenAI y Dota 2 (la gente gan√≥). Entendemos c√≥mo funciona el bot</a></li>
<li><a href="../es420827/index.html">Cree un proyecto maven simple utilizando Java EE + WildFly10 + JPA (Hibernate) + Postgresql + EJB + IntelliJ IDEA</a></li>
<li><a href="../es420829/index.html">Sistema de trabajo. Resumen desde el otro lado</a></li>
<li><a href="../es420831/index.html">El dispositivo para la emisi√≥n de cookies "Cook 3000"</a></li>
<li><a href="../es420833/index.html">Errores importantes de monetizaci√≥n de aplicaciones [y c√≥mo solucionarlos]</a></li>
<li><a href="../es420841/index.html">Revisi√≥n prehospitalaria o "¬°Hola, Swagger! ¬øD√≥nde est√°n mis errores?</a></li>
<li><a href="../es420843/index.html">7 de septiembre, Ekaterimburgo: una reuni√≥n para desarrolladores de .NET</a></li>
<li><a href="../es420845/index.html">La domesticaci√≥n del obstinado con el uso de una muleta: el orificio del adaptador Wi-Fi WF2190 (Realtek8812AU Wireless LAN 802.11ac USB)</a></li>
<li><a href="../es420847/index.html">Introducci√≥n a la programaci√≥n de sombreadores para dise√±os</a></li>
<li><a href="../es420853/index.html">Conozca la pseudo consola de Windows (ConPTY)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>