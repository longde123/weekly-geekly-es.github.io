<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤴🏼 👨🏽‍🏫 👩🏼‍🌾 Gestion des raccourcis clavier ou raccourcis 🎖️ 🏭 👩🏾‍💻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Salut Nous parlerons des touches de raccourci dans WEBAPI + JavaScript, considérons leurs méthodes d'organisation et les problèmes qui surviennent pri...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Gestion des raccourcis clavier ou raccourcis</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/438770/"><p>  Salut  Nous parlerons des touches de raccourci dans WEBAPI + JavaScript, considérons leurs méthodes d'organisation et les problèmes qui surviennent principalement dans les grandes applications. <br><img src="https://habrastorage.org/webt/zl/e2/zq/zle2zqvpyquemp6mux7dazteywi.jpeg"></p><br><p>  Envisagez des moyens de gérer les clés pour une tâche spécifique. </p><br><h2 id="zadacha">  «Tâche» </h2><br><p>  Imaginez que dans un projet existant, vous devez implémenter un traitement de saisie au clavier.  Dans le même temps, l'interface du projet et ses contrôleurs, pour des raisons purement historiques, bien sûr, telles qu'elles sont.  Et il y a ce qui suit: </p><br><p> <code>ParentController</code> dans lequel il y a deux composants avec leurs états et leur état.  <code>Controller1</code> et un élément qui utilise <code>CTRL+SHIFT+F</code> pour rechercher le site, et <code>Controller2</code> avec son élément DOM, qui est une zone locale, dans laquelle il y a une recherche à l'intérieur.  Cependant, ils peuvent être simultanément à l'écran.  Voici quelques façons de résoudre ce problème. </p><a name="habracut"></a><br><h4 id="1-keyboardeventhttpsdevelopermozillaorgrudocswebapikeyboardevent-i-ego-ruchnaya-obrabotka">  1. " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">KeyboardEvent</a> et son traitement manuel" </h4><br><p>  Les objets KeyboardEvent décrivent comment l'utilisateur interagit avec le clavier.  Chaque événement est décrit par une clé;  le type d'événement (keydown, keypress ou keyup) détermine le type d'action produit. </p><br><p>  Sonne bien non?  Examinons de plus près. <br>  Envisagez l'interception de la touche <code>CTRL+SHIFT+F</code> , correspondant généralement à un appel de recherche globale. </p><br><pre> <code class="javascript hljs">element.addEventListener(<span class="hljs-string"><span class="hljs-string">'keypress'</span></span>, (event) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> keyName = event.key; <span class="hljs-comment"><span class="hljs-comment">//        // ..     SHIFT      if (event.ctrlKey &amp;&amp; event.shiftKey &amp;&amp; event.key.toLowerCase() === 't') { alert('CTRL+SHIFT+T pressed'); } });</span></span></code> </pre> <br><p>  Maintenant, applicable à notre tâche, vous pouvez faire deux façons (par exemple) </p><br><p>  <strong>Effectuer l'interception des clés dans les contrôleurs 1 et 2 séparément</strong> </p><br><p>  Cela entraînera le fait que, selon l'ordre dans le DOM, vous devrez peut-être <code>useCapture</code> pour garantir que le traitement de Controller2 puis Controller1 aura lieu.  Vous obtenez donc une logique isolée, mais si l'application est complexe et qu'il y a beaucoup de tels contrôleurs, cette solution n'est pas bonne car  certains peuvent être simultanément à l'écran et ils peuvent avoir leur propre ordre de traitement strict, qui ne dépend pas de leur position dans l'arborescence DOM.  (voir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">bouillonnement et capture</a> ) </p><br><p>  <strong>Capture de clé dans <code>CommonController</code></strong> </p><br><p>  Une solution alternative serait de gérer les clics dans un contrôleur parent commun, qui sait exactement quand afficher ses enfants, contrôlé par les premier et second contrôleurs.  Cela, tout en augmentant les contrôleurs enfants, ne causera pas de difficultés avec la capture des événements et la décision du contrôleur pour lequel traiter les clés.  Cependant, il y aura un autre problème - un épais <code>if</code> apparaît dans le contrôleur parent, qui gère tous les cas possibles.  Pour les grandes applications, cette solution ne convient pas, car  à un moment donné, un autre <code>Controller</code> peut apparaître qui n'est pas un enfant du <code>ParentController</code> alors vous devrez <code>ParentController</code> gestionnaire d'un niveau vers son parent commun et ainsi de suite ... Jusqu'à tôt ou tard l'un des contrôleurs commence à en savoir trop sur les éléments qu'il contient. </p><br><p><img src="https://habrastorage.org/webt/ca/di/uz/cadiuzohwqgknd297ncomfzyb9i.png"><br>  En fait, seulement 80% des navigateurs sont capables de travailler avec <code>KeboardEvent.key</code> , dans tout le reste, vous aurez besoin d'utiliser <code>KeboardEvent.keyCode</code> : <code>Number</code> avec des codes clés.  Ce qui complique grandement la vie.  Ici, il vaut la peine d'aller à une description des inconvénients de cette approche. </p><br><p>  <strong>Inconvénients:</strong> </p><br><ul><li>  L'organisation du code n'est pas très pratique, elle nécessite une carte de codes de caractères et leur équivalent texte, et d'autres utilitaires qui réduisent la quantité de code dans les gestionnaires. </li><li>  80% Le soutien des navigateurs pour travailler avec des symboles sans utiliser leurs codes n'est pas encore suffisant. </li><li>  Chevauchement à l'aide de <code>useCapture</code> un gestionnaire à un autre. </li><li>  S'il existe des hooks avec <code>useCapture</code> et des éléments imbriqués avec les mêmes gestionnaires <br>  le débogage est difficile. </li><li>  Mauvaise évolutivité. </li></ul><br><p>  Mais nativement, il n'y a pas de dépendances et bibliothèques inutiles </p><br><p>  Ensuite, nous parlerons de deux bibliothèques, dont l'une a été conçue pour résoudre leurs propres problèmes similaires. </p><br><h4 id="2-ispolzovanie-biblioteki-hotkeyshttpsgithubcomjaywcjlovehotkeys">  2. «Utilisation de la bibliothèque <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">HotKeys</a> » </h4><br><p>  Trois mille étoiles sur github, taille modeste et absence de dépendances.  Un constructeur chinois, nous promet une solution qui conviendra à tout le monde.  Mais ne nous précipitons pas.  Essayons de résoudre notre problème avec son aide. </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   hotkeys('ctrl+shift+f', function(event, handler){ alert('CTRL+SHIFT+T pressed'); });</span></span></code> </pre> <br><p>  La syntaxe semble déjà beaucoup plus courte et la puce principale pour résoudre le problème affichera directement les composants des contrôleurs 1 et 2 à l'écran.  Après avoir fouillé un peu dans le code de la bibliothèque, il est facile de remarquer que les gestionnaires forment une pile qui est remplie ou effacée lorsqu'ils sont enregistrés aka apparaissant à l'écran (disons qu'un élément avec un gestionnaire qui est apparu plus tard que celui existant aura la priorité dans la file d'attente pour le traitement des touches de raccourci). </p><br><p>  Il arrive souvent que l'élément qui doit intercepter le traitement apparaisse plus tard.  Dans ce cas, nous pouvons diffuser en toute sécurité la logique de la gestion des clics à chacun des contrôleurs.  Et d'autres puces telles que des étendues nous aideront à séparer un flux de clics d'un autre.  Mais dans le cas où l' <code>    ≠   </code> - les mêmes problèmes se posent que dans eventListener natif.  Nous devrons tout mettre dans un contrôleur parent commun. </p><br><p>  De plus, il arrive souvent que vous deviez bloquer le comportement par défaut, mais l'événement n'est pas considéré comme traité (en d'autres termes, il n'y a pas de compréhension sans équivoque si l'événement est traité ou non si nous le recevons) ou il doit être traité par deux contrôleurs simultanément.  L'un d'eux provoquera une réaction au comportement, et l'autre tiendra simplement compte du fait que l'événement s'est produit. </p><br><p>  <strong>Total des avantages:</strong> </p><br><ul><li>  La portée vous permet de séparer les flux. </li><li>  La syntaxe est claire et courte. </li><li>  L'ordre détermine l'apparence de l'élément, pas la position dans le DOM. </li><li>  Taille et manque de dépendances. </li></ul><br><p>  <strong>Inconvénients:</strong> </p><br><ul><li>  Une seule étendue peut être traitée à la fois </li><li>  Le débogage est toujours difficile à cause des appels de fonction dans la boucle, on ne <strong>sait</strong> peut-être pas <strong>sur quel gestionnaire</strong> <del>  <strong>perdu</strong> </del>  <strong>événement géré</strong> </li><li>  La déclaration selon laquelle l'événement est traité s'il a l'indicateur defaultPrevented et sa distribution est interrompue n'est pas vraie. </li><li>  Fonctions globales d'enregistrement des appels et de désabonnement aux événements </li></ul><br><p>  Il convient pour résoudre des tâches typiques, mais il y aura des problèmes avec l'écriture d'un terminal de trading ou d'un grand panneau d'administration, pour un débogage sûr. </p><br><h4 id="3-ispolzovanie-biblioteki-stack-shortcutshttpsgithubcombusinessduckstack-shortcuts">  3. «Utilisation de la bibliothèque de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">raccourcis de pile</a> » </h4><br><p>  À la suite de nombreux râteaux et tentatives d'utilisation de la solution de quelqu'un d'autre, j'ai dû <del>  le vélo </del>  une bibliothèque qui aidera, tout d'abord, à faire ses débuts normalement, à conserver toutes les meilleures propriétés des plus populaires et à apporter quelque chose de nouveau. </p><br><p>  <strong>Quelles tâches ont été résolues à la création?</strong> </p><br><ul><li>  Principe de fonctionnement réactif </li><li>  Gestionnaires de débogage simples </li><li>  Statut de traitement des événements sans ambiguïté </li><li>  Multiplateforme </li><li>  Commodité d'importation et manque de fonctions globales </li><li>  Pas d'accès direct aux fenêtres lors de la connexion </li><li>  Pas besoin d'appeler <code>preventDefault</code> ou <code>stopPropagation</code> </li></ul><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  this.shortcuts = shortcuts({ 'CMD+SHIFT+F': function (event, next) { alert('CMD+SHIFT+F pressed'); } }); //  this.shortcuts.destroy();</span></span></code> </pre> <br><p>  Applicable à notre tâche, la solution coïncide complètement avec la bibliothèque précédente.  Une séparation complète de la logique de traitement sans trop de connaissances les uns des autres ne s'est toujours pas produite, mais beaucoup est devenu plus simple et plus compréhensible.  Merci aux suivants: </p><br><ul><li>  Il n'y a toujours pas de liaison au DOM (à l'exception d'un écouteur) et la pile de gestionnaires est remplie en fonction de l'ordre dans lequel ils sont enregistrés. </li><li>  <code>scope</code> immédiatement refusé d'utiliser l'isolement.  il n'est pas clair quelles tâches il résout et il semble que cela ne fait que compliquer l'architecture. </li><li>  Le débogage et la fonction suivante à ce sujet valent probablement plus ... </li><li>  Mutations dans les événements des données qu'il porte dans <code>event.detail</code> </li></ul><br><p>  <strong>Les</strong> gestionnaires de <strong>débogage</strong> sont organisés de telle manière qu'une <code>callstack</code> est formée à partir d'eux avant l'appel.  Il vous permet de voir dans la console toute la chaîne de l'événement du premier gestionnaire au suivant. </p><br><p>  <strong>next ()</strong> - Un appel de fonction signifie que l'événement n'a pas été traité et sera transmis au gestionnaire suivant.  Un contrat assez familier qui s'applique aux gestionnaires intermédiaires ou middleware en <code>express</code> .  Ainsi, vous saurez toujours si l'événement est traité ou simplement muté ou "pris en compte". </p><br><p><img src="https://habrastorage.org/webt/qi/px/ia/qipxiaoomxpysaam4fdkwfi6edu.png"></p><br><p>  Voici à quoi ressemble la pile d'appels si vous définissez un point d'arrêt dans l'un d'eux. </p><br><p>  <strong>Eh bien, sur les inconvénients:</strong> </p><br><ul><li>  Il n'y a pas encore de scripts de frappe. </li><li>  Aucune portée - un site d'écran partagé ne peut pas être créé) </li><li>  Une combinaison lors de l'inscription (ce n'est pas <code>CMD+F,CMD+V,T</code> ne comprendra pas la virgule) </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr438770/">https://habr.com/ru/post/fr438770/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr438758/index.html">Pourquoi Google modifie-t-il l'interface URL standard dans le navigateur</a></li>
<li><a href="../fr438762/index.html">DBX: tenter de se débarrasser de la compilation des requêtes MySQL</a></li>
<li><a href="../fr438764/index.html">Sixième test de chrome, postface</a></li>
<li><a href="../fr438766/index.html">L'ADN extracellulaire comme biomarqueur du vieillissement et de diverses pathologies</a></li>
<li><a href="../fr438768/index.html">Comment j'ai aidé Alice à ne pas répondre à d'autres noms. Stage Yandex</a></li>
<li><a href="../fr438772/index.html">HX711 ADC de 3,3 V - ne croyez pas la documentation chinoise et pas seulement</a></li>
<li><a href="../fr438774/index.html">Tout le meilleur à la fois. Les articles les plus vifs du blog LANIT sur Habré - 2018</a></li>
<li><a href="../fr438776/index.html">Trucs et astuces de ma chaîne Telegram @pythonetc, janvier 2019</a></li>
<li><a href="../fr438778/index.html">@Pythonetc janvier 2019</a></li>
<li><a href="../fr438782/index.html">Le FSB a proposé la sortie de cartes SIM russes et l'utilisation de la cryptographie domestique pour la 5G</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>