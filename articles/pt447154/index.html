<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üé∫ üëßüèª üèØ D√≠vida t√©cnica que leva a uma crise na empresa üÜé ü§ô üë®‚Äçüè≠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Acumular d√≠vida t√©cnica pode levar sua empresa a uma crise. Mas tamb√©m pode se tornar um poderoso motor de grandes mudan√ßas no processo e ajudar na ad...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>D√≠vida t√©cnica que leva a uma crise na empresa</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dodopizzadev/blog/447154/">  Acumular d√≠vida t√©cnica pode levar sua empresa a uma crise.  Mas tamb√©m pode se tornar um poderoso motor de grandes mudan√ßas no processo e ajudar na ado√ß√£o de pr√°ticas de engenharia.  Vou contar sobre isso no meu pr√≥prio exemplo. <br><br><img src="https://habrastorage.org/webt/vo/nt/1m/vont1m1pxmp9xt_l6ifnysa-og0.png"><br><a name="habracut"></a><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A equipe de TI da Dodo Pizza</a> cresceu de 2 desenvolvedores que atendem a um pa√≠s para 60 pessoas atendendo a 12 pa√≠ses ao longo de 7 anos.  Como Scrum Master e XP Coach, ajudei as equipes a estabelecer processos e adotar pr√°ticas de engenharia, mas essa ado√ß√£o foi muito lenta.  Foi um desafio para mim fazer as equipes manterem a alta qualidade do c√≥digo quando v√°rias equipes trabalham em um √∫nico produto.  Ca√≠mos na armadilha da prefer√™ncia por caracter√≠sticas de neg√≥cios em detrimento da excel√™ncia t√©cnica e acumulamos muita d√≠vida t√©cnica em arquitetura.  Quando o marketing lan√ßou uma campanha publicit√°ria massiva em 2018, n√£o conseguimos suportar a carga e ca√≠mos.  Foi uma pena.  Mas durante a crise, percebemos que somos capazes de trabalhar muitas vezes com mais efici√™ncia.  A crise nos levou a mudan√ßas revolucion√°rias nos processos e a r√°pida introdu√ß√£o das pr√°ticas de engenharia mais conhecidas. <br><br><h2>  Antecedentes </h2><br>  Voc√™ pode pensar que a Dodo Pizza √© uma rede de pizzarias regular.  Mas, na verdade, a <b>Dodo Pizza √© uma empresa de TI que vende pizza</b> .  Nosso neg√≥cio √© baseado no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Dodo IS</a> - plataforma baseada em nuvem, que gerencia todos os processos de neg√≥cios, desde o recebimento do pedido at√© o cozimento e o acabamento, para gerenciamento de invent√°rio, gerenciamento de pessoas e tomada de decis√µes.  Em apenas 7 anos, passamos de 2 desenvolvedores que servem uma √∫nica pizzaria para mais de 70 desenvolvedores que servem mais de 470 pizzarias em 12 pa√≠ses. <br><br>  Quando entrei na empresa, h√° dois anos, t√≠nhamos 6 equipes e cerca de 30 desenvolvedores.  A base de c√≥digo Dodo IS tinha cerca de 1 milh√£o de linhas de c√≥digo.  Tinha uma arquitetura monol√≠tica e muito pouca cobertura de testes de unidade.  N√£o t√≠nhamos testes de API / interface de usu√°rio at√© ent√£o.  A qualidade do c√≥digo do sistema foi decepcionante.  Sab√≠amos disso e sonh√°vamos com um futuro brilhante quando dividimos o mon√≥lito em uma d√∫zia de servi√ßos e reescrevemos as partes mais hediondas do sistema.  N√≥s at√© desenhamos o diagrama ‚Äúser arquitetura‚Äù, mas honestamente n√£o fizemos quase nada em rela√ß√£o ao estado futuro.  <b>Meu objetivo principal era ensinar as pr√°ticas de engenharia dos desenvolvedores e criar um processo de desenvolvimento, fazendo 6 equipes trabalharem em um √∫nico produto</b> . <br><br>  √Ä medida que a equipe cresceu, sofremos com a falta de pr√°ticas claras de processo e engenharia.  Nossos lan√ßamentos se tornaram maiores e mais longos, porque cada vez mais desenvolvedores contribu√≠ram para o sistema, mas n√£o t√≠nhamos testes de regress√£o automatizados e, portanto, perdemos mais tempo em regress√£o manual a cada lan√ßamento.  Sofremos muitas mudan√ßas feitas por 6 equipes em filiais separadas.  Quando uma equipe mesclava suas altera√ß√µes em uma √∫nica ramifica√ß√£o antes do lan√ßamento, √†s vezes perd√≠amos at√© 4 horas resolvendo conflitos de mesclagem. <br><br><blockquote><h4>  Merda acontece </h4><br>  Em 2018, o Marketing publicou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nossa primeira campanha publicit√°ria federal na TV</a> .  Foi um grande evento para n√≥s.  Gastamos 100 milh√µes de rublos (US $ 1,5 milh√£o) financiando a campanha - uma quantia bastante significativa para n√≥s.  Equipe de TI preparada para a campanha tamb√©m.  Automatizamos e simplificamos nossa implanta√ß√£o - agora, com um √∫nico bot√£o no TeamCity, podemos implantar o mon√≥lito em 12 pa√≠ses.  Investigamos testes de desempenho e realizamos an√°lises de vulnerabilidade.  Fizemos o nosso melhor, mas encontramos problemas inesperados. <br><br>  A campanha publicit√°ria foi √≥tima.  Passamos de 100 para 300 pedidos / minuto.  Esta foi uma boa not√≠cia.  As m√°s not√≠cias eram que o Dodo IS n√£o podia suportar tal carga e morreu.  Atingimos nossos limites de escala vertical e n√£o conseguimos mais lidar com pedidos.  <b>O sistema √© reiniciado a cada 3 horas.</b>  <b>Cada minuto de inatividade nos custa milh√µes de d√≥lares, al√©m de perda de respeito de clientes furiosos.</b> </blockquote><br>  Quando vim para a Dodo h√° dois anos, como Chief Agile Officer, eu tinha um grande desejo de fazer parte de nossa pequena equipe - cerca de 12 pessoas, uma equipe dos sonhos.  Comecei imediatamente a introduzir pr√°ticas de engenharia.  A maioria das equipes adotou a programa√ß√£o em pares, testes de unidade e DDD em breve.  Mas nem tudo foi f√°cil.  Eu tive que superar a resist√™ncia dos desenvolvedores, do Product Owner e da equipe de suporte. <br><br>  Ao contr√°rio das pr√°ticas de engenharia, nem todos eram a favor da ideia de equipes de recursos.  Os desenvolvedores estavam acostumados a pensar que uma equipe focada em um componente est√° escrevendo um c√≥digo melhor.  N√£o ficou claro como combinar o r√°pido desenvolvimento de recursos de neg√≥cios com a refatora√ß√£o maci√ßa h√° muito esperada de um sistema complexo.  Um fluxo cont√≠nuo de bugs tamb√©m exigia aten√ß√£o constante.  A equipe de suporte preferia ter sua pr√≥pria equipe focada apenas na corre√ß√£o de bugs.  Muitas equipes estavam acostumadas a trabalhar em filiais separadas e tinham medo de se integrar com frequ√™ncia.  Lan√ßamos n√£o mais de uma vez por semana, e cada vers√£o demorou bastante tempo, exigindo uma quantidade enorme de regress√£o manual e suporte a testes de interface do usu√°rio.  Tentei corrigi-lo, mas minhas altera√ß√µes no processo eram muito lentas e fragmentadas. <br><br><h2>  A hist√≥ria de queda e ascens√£o </h2><br><h4>  Estado inicial: Arquitetura Monol√≠tica </h4><br>  Na busca pela velocidade do desenvolvimento de recursos de neg√≥cios, nem sempre pensamos bem em solu√ß√µes t√©cnicas.  A falta de experi√™ncia tamb√©m nos afetou.  No come√ßo, a empresa n√£o podia contratar os melhores desenvolvedores.  Trabalhamos com entusiastas que concordaram em ajudar na cria√ß√£o do Dodo IS, acreditavam no fundador da empresa - Fedor e trabalhavam quase na √°rea de alimentos (pizza, √© claro).  Os desenvolvedores que ingressaram na equipe posteriormente seguiram a arquitetura estabelecida, que ficou desatualizada.  Portanto, t√≠nhamos um aplicativo monol√≠tico com um √∫nico banco de dados, contendo todos os dados de todos os componentes em um √∫nico local.  Rastreador, caixa, site, API para p√°ginas de destino - todos os componentes do sistema trabalhavam com um √∫nico banco de dados, que se tornam um gargalo.  Nossa arquitetura monol√≠tica criou problemas monol√≠ticos.  Uma √∫nica postagem no blog levou a uma interrup√ß√£o no checkout do restaurante. <br><blockquote><h4>  Hist√≥ria verdadeira </h4><br>  Para ilustrar o qu√£o fr√°gil √© a arquitetura monol√≠tica, darei apenas um exemplo.  <b>Certa vez, todos os nossos restaurantes na R√∫ssia pararam de aceitar pedidos por causa de uma postagem no blog.</b>  <b>Como isso pode acontecer?</b> <br><br>  Um dia, nosso CEO - Fedor publicou um post em seu blog.  Este post rapidamente ganhou popularidade.  H√° um contador no site do blog do Fedor mostrando v√°rias pizzarias em nossa rede e a receita total de todas as pizzarias.  Toda vez que algu√©m l√™ o blog de Fedor, o servidor envia uma solicita√ß√£o ao banco de dados mestre para calcular a receita.  Essas solicita√ß√µes sobrecarregaram o banco de dados e pararam de servir solicita√ß√µes do caixa do restaurante.  Assim, um post popular interrompeu o trabalho de toda a cadeia de restaurantes.  Corrigimos o problema rapidamente, mas era um sinal claro (entre muitos outros) de que nossa arquitetura n√£o √© capaz de atender √†s necessidades de neg√≥cios e precisa ser redesenhada.  Mas n√≥s ignoramos esses sinais.  Implementamos solu√ß√µes r√°pidas e f√°ceis (como adicionar r√©plica somente leitura do banco de dados mestre), mas n√£o t√≠nhamos nenhum roteiro de redesenho t√©cnico. </blockquote><br>  A arquitetura monol√≠tica √© boa para come√ßar, porque √© simples.  Mas n√£o pode suportar a carga alta sendo um √∫nico ponto de falha. <br><br><h4>  Falha no in√≠cio de 2017 </h4><br>  <b>14 de fevereiro √© um dia dos namorados</b> .  Todo mundo adora esse feriado.  Para os amantes se felicitarem, em 14 de fevereiro, fazemos uma pizza especial - calabresa em forma de cora√ß√£o.  Vou me lembrar do dia 14 de fevereiro de 2017 para sempre, porque neste dia, quando todas as pizzarias estavam trabalhando a plena carga, o Dodo IS come√ßou a cair.  Em cada pizzaria, temos de 4 a 5 comprimidos para rastrear qual pedido um pizzaiolo faz para colocar, colocar ingredientes, assar ou enviar para entrega.  O n√∫mero de pizzarias atingiu mais de 300, cada tablet atualizou seu estado v√°rias vezes por minuto.  Todas essas solicita√ß√µes criaram uma carga t√£o grande no banco de dados que o servidor SQL deixou de suportar e o banco de dados come√ßou a falhar.  Dodo IS estabelecido no momento mais inadequado - durante o pico de vendas.  Houve uma temporada de f√©rias movimentada pela frente: 23 de fevereiro (Dia do Ex√©rcito e da Marinha), 8 de mar√ßo (Dia Internacional da Mulher), 1 de maio (Dia da Solidariedade Internacional dos Trabalhadores) e 9 de maio (Dia da Vit√≥ria na Segunda Guerra Mundial).  Durante essas f√©rias, esper√°vamos um crescimento ainda maior de pedidos. <br><br>  <b>O dia em que voc√™ morrer√°</b> .  Conhecendo nossos planos de crescimento e o limite de carga que podemos suportar, descobrimos quanto tempo podemos permanecer vivos, isto √©, quando o pico de carga de hoje se torna regular.  A data estimada do Armagedom prevista para cerca de seis meses - em agosto ou setembro.  Como √© viver sabendo a data de sua morte? <br><br>  <b>Pare o desenvolvimento de recursos por um ano</b> .  Juntamente com o CEO Fedor, tivemos que tomar uma decis√£o √°rdua.  Talvez uma das decis√µes mais dif√≠ceis da hist√≥ria da empresa.  Paramos o desenvolvimento de recursos de neg√≥cios.  Pensamos em parar por tr√™s meses, mas logo percebemos que o volume de d√≠vida t√©cnica era t√£o grande que tr√™s meses n√£o seriam suficientes e temos que continuar trabalhando em quest√µes t√©cnicas e adiar o atraso dos neg√≥cios.  De fato, com 6 equipes, fizemos apenas um recurso de neg√≥cios durante o pr√≥ximo ano.  No restante do tempo, as equipes estavam envolvidas no pagamento de d√≠vidas t√©cnicas.  Essa d√≠vida nos custou muito - mais de US $ 1,5 milh√£o. <br><br><h4>  Algumas melhorias ap√≥s um ano </h4><br>  Ao longo do ano, tivemos essas realiza√ß√µes not√°veis: <br><ul><li>  Automatizamos e aceleramos nosso pipeline de implanta√ß√£o.  Anteriormente, a implanta√ß√£o era semi-manual.  N√≥s implantamos em 10 pa√≠ses em cerca de 2 horas. </li><li>  Come√ßou a dividir um mon√≥lito.  A parte mais carregada do sistema - o rastreador - foi dividida em um servi√ßo separado, com seu pr√≥prio banco de dados.  Agora, o rastreador se comunica com o resto do sistema atrav√©s de uma fila de eventos. </li><li>  Come√ßamos a separar a Caixa de entrega - o segundo componente que cria uma carga alta. </li><li>  Reescreva o sistema de autentica√ß√£o de usu√°rio e dispositivo. </li></ul><br>  Nosso arquiteto gerenciava o backlog t√©cnico.  Usamos as mudan√ßas arquiteturais para impulsionar o backlog.  Cada equipe teve a liberdade de fazer o que era certo para criar uma arquitetura √∫til.  Para o ano com as 6as equipes, criamos para os neg√≥cios apenas um recurso valioso.  No restante do tempo, as equipes trabalharam em d√≠vidas t√©cnicas.  Parece que podemos ter orgulho de n√≥s mesmos.  Mas √† nossa frente havia uma enorme decep√ß√£o. <br><br>  Falha durante a Campanha de Marketing Federal.  A segunda crise de confian√ßa. <br><br>  A d√≠vida t√©cnica √© f√°cil de acumular, mas muito dif√≠cil de pagar.  √â improv√°vel que voc√™ seja capaz de entender com anteced√™ncia quanto isso lhe custar√°. <br><br>  Apesar de termos passado um ano inteiro lutando contra d√≠vidas t√©cnicas, n√£o est√°vamos prontos para uma campanha de marketing maci√ßa e nos enganamos diante de nossos neg√≥cios.  Voc√™ ganha confian√ßa em quedas, perde-a em baldes.  E tivemos que conquist√°-lo novamente. <br><br>  Perdemos o momento em que era necess√°rio diminuir a velocidade do desenvolvimento de recursos de neg√≥cios e combater a d√≠vida t√©cnica.  Era tarde demais quando notamos.  N√≥s nos deitamos sob carga novamente.  O sistema travou e reiniciou a cada 3 horas.  Nosso neg√≥cio perdeu dezenas de milh√µes de rublos. <br><br><img src="https://habrastorage.org/webt/dc/e4/r5/dce4r5zrxw4mk9xhri2qvbora0c.jpeg"><br><br>  Mas, gra√ßas √† crise, vimos que, em condi√ß√µes extremas, podemos trabalhar muitas vezes com mais efici√™ncia.  Lan√ßamos 20 vezes por dia.  Todos trabalhavam como uma equipe, concentrando-se em um √∫nico objetivo.  Durante duas semanas de crise, fizemos o que t√≠nhamos medo de come√ßar antes, porque acredit√°vamos que levaria meses de trabalho.  Ordem ass√≠ncrona, testes de desempenho, logs limpos s√£o apenas uma pequena parte do que fizemos.  Est√°vamos ansiosos para continuar a trabalhar da maneira mais eficaz, mas sem horas extras e estresse. <br><br><h2>  Li√ß√µes aprendidas </h2><br>  Ap√≥s a retrospectiva, reestruturamos completamente nossos processos.  Pegamos a estrutura do LeSS e a complementamos com as pr√°ticas de engenharia.  Nos meses seguintes, fizemos um avan√ßo na ado√ß√£o de pr√°ticas de engenharia.  Com base na estrutura LeSS, implementamos e continuamos a usar: <br><ul><li>  lista de pend√™ncias √∫nica; </li><li>  equipes de recursos totalmente funcionais e com v√°rios componentes; </li><li>  programa√ß√£o em pares; </li><li>  Tentando Mob Programming. </li><li>  Integra√ß√£o cont√≠nua genu√≠na, significando v√°rias integra√ß√µes de c√≥digo de 9 equipes em uma √∫nica ramifica√ß√£o; </li><li>  gerenciamento de configura√ß√£o simplificado com desenvolvimento baseado em tronco; </li><li>  lan√ßamentos frequentes: Implanta√ß√£o Cont√≠nua para microsservi√ßos, v√°rios lan√ßamentos por dia para mon√≥lito; </li><li>  sem uma equipe de controle de qualidade separada, os especialistas em controle de qualidade fazem parte das equipes de desenvolvimento. </li></ul><br><h4>  6 pr√°ticas que escolhemos ap√≥s a crise </h4><br>  <b>1. O poder do foco</b> .  Antes da crise, cada equipe trabalhava em seu pr√≥prio estoque e se especializava em seu dom√≠nio.  No backlog, havia tarefas finamente decompostas, a equipe selecionou v√°rias tarefas para um sprint.  Mas durante a crise, trabalhamos de maneira bem diferente.  As equipes n√£o tinham tarefas espec√≠ficas, elas tinham um grande objetivo desafiador.  Por exemplo, um aplicativo m√≥vel e uma API devem lidar com 300 pedidos por minuto, n√£o importa o qu√™.  Cabe √† equipe como atingir a meta.  As pr√≥prias equipes formulam hip√≥teses, rapidamente as verificam em Produ√ß√£o e jogam fora.  E √© exatamente isso que quer√≠amos continuar fazendo.  As equipes n√£o querem ser codificadores idiotas, querem resolver problemas. <br><br>  O poder do foco se manifestou na solu√ß√£o de problemas complexos.  Por exemplo, durante a crise, criamos um conjunto de testes de desempenho, apesar de n√£o termos experi√™ncia.  Tamb√©m criamos a l√≥gica de receber um pedido ass√≠ncrono.  Pensamos muito sobre isso e conversamos, e parecia-nos que essa √© uma tarefa muito dif√≠cil e longa.  Mas a equipe √© capaz de faz√™-lo em duas semanas, se n√£o estiver distra√≠da e completamente focada no problema. <br><br>  <b>2. Hackathons regulares</b> .  Gost√°vamos de trabalhar no modo quando todas as equipes visavam um objetivo e decidimos √†s vezes organizar esses ‚Äúhackathons‚Äù.  N√£o se pode dizer que as realizamos regularmente, mas houve algumas vezes.  Por exemplo, houve uma invas√£o de 500 erros quando todas as equipes limparam os logs e removeram as causas de 500 erros no site e na API.  O objetivo era manter os logs limpos.  Quando os logs est√£o limpos, os novos erros est√£o claramente vis√≠veis, voc√™ pode configurar facilmente os valores limite para os alertas.  √â semelhante aos testes de unidade - eles n√£o podem ser um pouco vermelhos. <br><br>  Outro exemplo de hackathon s√£o os bugs.  Costum√°vamos ter uma enorme lista de pend√™ncias de bugs, alguns dos que estavam na lista de pend√™ncias h√° anos.  Parecia que eles nunca terminariam.  E todos os dias havia novos.  Voc√™ precisa, de alguma forma, combinar o trabalho em bugs e em itens regulares de pend√™ncias. <br><br><div class="spoiler">  <b class="spoiler_title">Introduzimos a pol√≠tica #zerobugspolicy em 4 etapas.</b> <div class="spoiler_text"><ol><li>  Limpeza inicial de bugs com base na data.  Se o bug estiver no backlog por mais de 3 meses, exclua-o.  Provavelmente estava l√° h√° s√©culos. </li><li>  Agora, classifique os defeitos restantes com base em como eles afetam os clientes.  N√≥s cuidadosamente resolvemos os bugs restantes.  Mantivemos apenas o defeito que dificulta a vida de um grande grupo de usu√°rios.  Se isso √© apenas algo que causa inconveni√™ncia, mas voc√™ pode lidar com isso - exclua impiedosamente.  Ent√£o reduzimos o n√∫mero de bugs para 25, o que √© aceit√°vel. </li><li>  Hackathon.  Todas as equipes pululam e consertam todos os bugs.  Fizemos isso em alguns sprints.  Cada sprint de cada equipe pegava v√°rios bugs e consertava.  Ap√≥s 2-3 sprints, tivemos um registro claro de bugs.  Agora voc√™ pode inserir #zerobugspolicy. </li><li>  #zerobugspolicy.  Cada novo bug agora tem apenas duas maneiras.  √âter cai na lista de pend√™ncias, ou n√£o.  Se ele entrar em atraso, n√≥s o corrigimos primeiro.  Qualquer bug na lista de pend√™ncias tem prioridade mais alta do que qualquer outro item da lista de pend√™ncias.  Mas, para entrar no backlog, o bug deve ser s√©rio.  Ou causa danos irrepar√°veis ‚Äã‚Äãou afeta um grande n√∫mero de usu√°rios. </li></ol><br></div></div><br>  <b>3. Equipes de projeto tempor√°rias para equipes de recursos est√°veis</b> .  Havia uma hist√≥ria engra√ßada com as equipes de projeto.  Durante a crise, formamos equipes de tigres com as melhores habilidades para a tarefa.  Ap√≥s o t√©rmino da crise, as equipes decidiram continuar essa pr√°tica e dispersar as equipes.  Apesar de n√£o gostar dessa id√©ia, deixei que tentassem.  Em apenas 2 semanas (uma corrida), na pr√≥xima retrospectiva, as equipes abandonaram essa pr√°tica (essa decis√£o me deixou extremamente feliz).  Eles tentaram e entenderam por que √© muito mais confort√°vel trabalhar em uma equipe de recursos est√°veis.  Mesmo que a equipe n√£o possua algumas habilidades, eles podem aprender gradualmente.  Mas o esp√≠rito de equipe, o apoio e a assist√™ncia m√∫tua s√£o formados por um longo tempo, leva meses.  As equipes de projeto de curto prazo est√£o constantemente em fase de forma√ß√£o e assalto.  Voc√™ pode suportar isso por algumas semanas, mas n√£o pode trabalhar assim o tempo todo.  √â bom que as equipes tenham tentado e compreendido os benef√≠cios das equipes de recursos est√°veis. <br><br>  <b>4. Livre-se da regress√£o manual</b> .  Antes da crise, lan√ß√°vamos uma vez por semana e durante a crise - dezenas de vezes por dia.  Adoramos nossa capacidade de liberar frequentemente.  Apreciamos como era conveniente fazer uma pequena altera√ß√£o, implement√°-la rapidamente e obter imediatamente feedback da produ√ß√£o.  Portanto, alteramos nossa abordagem de lan√ßamentos, e isso afetou a abordagem de programa√ß√£o e design.  Agora lan√ßamos continuamente, a cada 1-2 dias.  Tudo no ramo de desenvolvimento entra em produ√ß√£o.  Mesmo que alguns recursos n√£o estejam prontos, isso n√£o √© motivo para n√£o liberar o c√≥digo.  Se n√£o quisermos mostrar algum recurso ainda n√£o pronto para os usu√°rios, ocultamos-o com altern√¢ncia de recursos.  Essa abordagem nos ajudou a desenvolver em pequenas etapas. <br><br>  Estabelecemos uma meta para nos livrar das regress√µes manuais.  Levamos 1,5 anos para alcan√ß√°-lo.  Mas ter um objetivo ambicioso a longo prazo faz voc√™ pensar nas etapas que levam ao objetivo. <br><br><div class="spoiler">  <b class="spoiler_title">Fizemos isso em 3 etapas.</b> <div class="spoiler_text"><ol><li>  Automatize o caminho cr√≠tico.  Em junho de 2017, formamos a equipe de controle de qualidade.  A tarefa da equipe era automatizar a regress√£o das fun√ß√µes mais cr√≠ticas do Dodo IS - recebimento e produ√ß√£o de pedidos.  Nos pr√≥ximos 6 meses, uma nova equipe de controle de qualidade de 4 pessoas cobriu todo o caminho cr√≠tico.  Os desenvolvedores das equipes de recursos os ajudaram ativamente.  Juntos, criamos uma linguagem espec√≠fica de dom√≠nio (DSL), bonita e compreens√≠vel, que pode ser lida at√© pelos clientes.  Paralelamente aos testes de ponta a ponta, os desenvolvedores cobriram o c√≥digo com testes de unidade.  Alguns novos componentes foram redesenhados com TDD.  Depois disso, dissolvemos a equipe de controle de qualidade.  Os ex-membros da equipe de controle de qualidade se uniram √†s equipes de recursos para compartilhar conhecimentos sobre como dar suporte e manter autotestes. </li><li>  Modo de sombra.  Tendo autotestes, durante 5 lan√ßamentos, fizemos regress√µes manuais no modo sombra.  As equipes confiaram apenas no conjunto de testes automatizados, mas quando a equipe decidiu "Estamos prontos para o lan√ßamento", executamos uma regress√£o manual para verificar se nossos autotestes perdem algum erro.  N√≥s rastreamos quantos erros foram detectados manualmente e n√£o detectados pelos autotestes.  Ap√≥s 5 lan√ßamentos, revisamos os dados e decidimos confiar em nossos autotestes.  Nenhum erro grave foi esquecido. </li><li>  Remova as regress√µes manuais.  Quando tivemos testes suficientes e come√ßamos a confiar neles, abandonamos completamente os testes manuais.  Quanto mais executamos nossos testes, mais confiamos neles.  Mas isso aconteceu apenas 1,5 anos depois que come√ßamos a automatizar o teste de regress√£o. </li></ol><br></div></div><br>  <b>5. Teste de desempenho faz parte do teste de regress√£o</b> .  Durante a crise, criamos um conjunto de testes de desempenho.  Era uma √°rea completamente nova para n√≥s.  No entanto, em apenas duas semanas, conseguimos criar alguns testes de desempenho usando as ferramentas do Visual Studio.  Esses testes nos ajudaram a n√£o apenas detectar a degrada√ß√£o do desempenho.  N√≥s os usamos para adicionar carga sint√©tica ao servidor de Produ√ß√£o para identificar os limites de desempenho.  Por exemplo, se a carga de produ√ß√£o org√¢nica for 100 pedidos / min e adicionarmos mais 50 pedidos / min com a ajuda de nossos testes de desempenho, podemos ver se os servidores de Produ√ß√£o podem lidar com o aumento da carga.  Assim que notamos exce√ß√µes ou lat√™ncia aumentada, paramos o teste.  Ao fazer essas experi√™ncias, descobrimos a carga m√°xima que nossos servidores de produ√ß√£o podem suportar e qual ser√° o ponto de acesso. <br><br>  No pr√≥ximo ano, superamos os testes de desempenho para a experiente equipe PerformanceLab.  Eles se reuniram com nossos desenvolvedores e pessoal de infraestrutura e nos ajudaram a criar um conjunto robusto de testes de desempenho.  Agora, executamos esses testes semanalmente e fornecemos feedback r√°pido √†s equipes de desenvolvimento, se o desempenho for impactado. <br><br>  Algumas das pr√°ticas de engenharia foram iterativamente refinadas.  Por exemplo, lan√ßamentos frequentes.  Come√ßamos com ciclos de lan√ßamento semanais, suportados por testes manuais lentos e fr√°geis.  Desenvolvemos recursos por uma semana e testamos por mais uma semana.  Mas foi dif√≠cil manter as altera√ß√µes feitas por v√°rios durante uma semana.  Depois, tentamos lan√ßamentos isolados de equipe, quando apenas as altera√ß√µes feitas por uma √∫nica equipe foram lan√ßadas.  Mas esse processo falhou porque todas as equipes tiveram que esperar na fila por v√°rias semanas.  Em seguida, as equipes aprenderam os benef√≠cios da integra√ß√£o frequente e come√ßamos a praticar vers√µes conjuntas de v√°rias mudan√ßas de equipe.  Os desenvolvedores come√ßaram a experimentar a altern√¢ncia de recursos e a avan√ßar para recursos inacabados de produ√ß√£o.  Eventualmente, chegamos √† Integra√ß√£o Cont√≠nua e a v√°rios lan√ßamentos por dia para mon√≥lito e Implanta√ß√£o Cont√≠nua para microsservi√ßos. <br><br><img src="https://habrastorage.org/webt/ce/yd/ay/ceyday2plzigxpfvhdmldzhpav4.jpeg"><br><br>  Outro caso interessante √© com nosso departamento de controle de qualidade.  Antes, n√£o t√≠nhamos uma equipe de controle de qualidade, mas testadores manuais.  Percebendo a necessidade de automa√ß√£o de teste, formamos uma equipe de controle de qualidade, mas desde o primeiro dia essa equipe sabia que seria dissolvida um dia.  Ap√≥s 6 meses, a equipe automatizou nossos principais cen√°rios de neg√≥cios e, com a ajuda dos desenvolvedores, escreveu uma conveniente DSL (Domain Specific Language) para escrever testes.  A equipe se separou e os engenheiros da qualidade se juntaram √†s equipes de recursos.  Agora, as pr√≥prias equipes desenvolvem e mant√™m autotestes. <br><br>  Hoje, temos um √∫nico atraso em que nove equipes de recursos est√£o trabalhando.  As equipes de recursos s√£o est√°veis, multifuncionais e entre componentes.  A maioria de nossas equipes s√£o equipes de recursos. <br><br>  <b>6. Foco nas pr√°ticas de engenharia</b> .  Todas as nossas equipes usam programa√ß√£o em pares.  Considero a programa√ß√£o em pares uma das pr√°ticas mais simples, por√©m poderosas, que ajuda a implementar outras pr√°ticas de engenharia.  Se voc√™ n√£o souber qual pr√°tica de engenharia iniciar, recomendo a programa√ß√£o em pares. <br><br><h2>  Resultados </h2><br>  O principal resultado que a crise nos deu √© um abalo.  N√≥s acordamos e come√ßamos a agir.  A crise nos ajudou a ver o m√°ximo de nossas oportunidades.  Vimos que podemos trabalhar muitas vezes com mais efici√™ncia e rapidez para atingir nossos objetivos.  Mas isso requer mudar a maneira regular de trabalhar.  Paramos de ter medo de fazer experi√™ncias ousadas.  Como resultado dessas experi√™ncias, ao longo do ano passado, melhoramos significativamente a qualidade e a estabilidade do Dodo IS.  Se durante as f√©rias de primavera em 2018 nossas pizzarias n√£o puderam funcionar por causa do Dodo IS, ent√£o em 2019, com um crescimento de 300 a 450 pizzarias, o Dodo IS funcionou perfeitamente.  N√≥s experimentamos discretamente o pico de vendas no Ano Novo, durante a segunda Campanha de Marketing e as f√©rias de primavera.  Pela primeira vez em muito tempo, estamos confiantes na qualidade do sistema e dormimos bem √† noite.  Este √© o resultado do uso constante de pr√°ticas de engenharia e o foco na excel√™ncia t√©cnica. <br><br><h4>  Resultados para empresas </h4><br>  As pr√°ticas de engenharia n√£o s√£o necess√°rias por si pr√≥prias se n√£o beneficiarem seus neg√≥cios.  Como resultado do foco na excel√™ncia t√©cnica, melhoramos a qualidade do c√≥digo e desenvolvemos recursos de neg√≥cios com velocidade previs√≠vel.  Os lan√ßamentos se tornaram um evento regular para n√≥s.  Lan√ßamos o mon√≥lito a cada 2 dias e servi√ßos menores a cada poucos minutos.  Isso significa que podemos fornecer rapidamente valor comercial aos nossos usu√°rios e coletar feedback mais rapidamente.  Gra√ßas √† flexibilidade das equipes de recursos, obtemos alta velocidade de desenvolvimento. <br><br><blockquote>  Hoje, temos 480 pizzarias online, das quais 400 na R√∫ssia.  Durante as f√©rias de maio deste ano, houve problemas com o processamento de pedidos em nossas pizzarias novamente.  Mas desta vez o gargalo foi o atendimento ao cliente nas pizzarias.  O Dodo IS estava funcionando como um rel√≥gio, apesar do n√∫mero crescente de pizzarias e pedidos. </blockquote><br><h4>  Resultados para as equipes </h4><br>  Hoje usamos uma ampla gama de pr√°ticas de engenharia: <br><ol><li>  Equipes de recursos totalmente funcionais e com v√°rios componentes. </li><li>  Programa√ß√£o em Par / Programa√ß√£o em Mob. </li><li>  Integra√ß√£o cont√≠nua genu√≠na, significando v√°rias integra√ß√µes de c√≥digo de 9 equipes em uma √∫nica ramifica√ß√£o. </li><li>  Gerenciamento de configura√ß√£o simplificado com desenvolvimento baseado em tronco. </li><li>  Objetivo comum para v√°rias equipes. </li><li>  O especialista no assunto est√° na equipe. </li><li>  Sem equipe de controle de qualidade separada, os especialistas em controle de qualidade fazem parte das equipes de desenvolvimento. </li><li>  Eventual substitui√ß√£o manual do regress com autotestes. </li><li>  Pol√≠tica de zero bugs. </li><li>  Acumula√ß√£o de d√≠vidas t√©cnicas. </li><li>  Pare a linha como um driver para a acelera√ß√£o do pipeline de implanta√ß√£o. </li></ol><br>  Eles ajudam 9 equipes a trabalhar em um c√≥digo comum e em um √∫nico produto que inclui dezenas de componentes - um site m√≥vel e para desktop, um aplicativo m√≥vel para iOS e Android e um back office gigante com caixa registradora, rastreamento, exibi√ß√£o de restaurante, conta pessoal , an√°lise e previs√£o. <br><br><h4>  O que pode ser melhor </h4><br>  Pode parecer que j√° fizemos um bom progresso nas pr√°ticas de engenharia, mas estamos apenas no come√ßo, ainda temos espa√ßo para crescer.  Por exemplo, tentamos, mas at√© agora de maneira sistem√°tica, a programa√ß√£o mob.  Estudamos a abordagem de reda√ß√£o do teste BDD.  Ainda temos espa√ßo para crescer no IC, entendemos que a integra√ß√£o mesmo uma vez ao dia n√£o √© suficiente.  E quando crescermos at√© 30 equipes, ser√° necess√°rio integrar com mais frequ√™ncia.  Ainda estamos em andamento a transi√ß√£o do TDD para o ATDD.  Temos que criar um processo de tomada de decis√£o arquitetural sustent√°vel e escal√°vel. <br>  O mais importante √© que seguimos para o fortalecimento da excel√™ncia t√©cnica. <br><br>  Devido ao fato de todas as 9 equipes estarem trabalhando em um estoque comum e em um produto, as equipes t√™m um forte desejo de cooperar entre si.  Eles aprenderam a tomar decis√µes fortes por conta pr√≥pria. <br><br><div class="spoiler">  <b class="spoiler_title">Por exemplo, as pr√°ticas a seguir foram propostas e implementadas pelas pr√≥prias equipes.</b> <div class="spoiler_text"><ol><li>  Interrompa a linha como um driver para a acelera√ß√£o do pipeline de implanta√ß√£o (consulte meu relat√≥rio de experi√™ncia "Interrompa a linha para otimizar seu pipeline de implanta√ß√£o"). </li><li>  Substitua os testes da interface do usu√°rio pelos testes da API. </li><li>  Implanta√ß√£o automatizada com um clique. </li><li>  Anfitri√£o do Kubernetes. </li><li>  A equipe de desenvolvimento √© implantada na produ√ß√£o. </li></ol><br></div></div><br><br>  Algumas equipes demonstraram desejo de usar todas as 12 pr√°ticas de XP e me pediram ajuda como XP Coach e Scrum Master. <br><br><h2>  O que aprendemos </h2><br>  Eu gostaria de n√£o deixar a crise acontecer.  Como desenvolvedor, senti a responsabilidade pessoal de acumular uma d√≠vida t√©cnica muito grande e de n√£o levantar uma bandeira vermelha anteriormente: <br><ul><li>  As pr√°ticas de engenharia protegem os neg√≥cios da crise. </li><li>  N√£o acumule d√≠vidas t√©cnicas.  Pode ser tarde demais e custar muito alto. </li><li>  As mudan√ßas evolucion√°rias demoram v√°rias vezes mais que as revolucion√°rias. </li><li>  Crise nem sempre √© uma coisa ruim.  Use a crise para revolucionar os processos. </li><li>  No entanto, √© necess√°ria uma prepara√ß√£o evolutiva longa com anteced√™ncia. </li><li>  N√£o implemente cegamente todas as pr√°ticas que voc√™ gosta.  Algumas pr√°ticas est√£o esperando nos bastidores e, quando ele vier, as equipes as usar√£o sem resist√™ncia.  Aguarde o momento certo. </li><li>  Refine e adapte as pr√°ticas ao seu contexto. </li><li>  Com o tempo, as pr√≥prias equipes come√ßam a tomar fortes decis√µes e implement√°-las.  D√™ a eles um ambiente seguro para tentar, falhar e aprender com os erros. </li></ul><br><br>  D√≠vidas t√©cnicas nos levam a crises.  Mas, com a crise, tanto os desenvolvedores quanto os empres√°rios aprenderam o qu√£o importante √© o foco na excel√™ncia t√©cnica e nas pr√°ticas de engenharia.  Usamos a crise como um gatilho para grandes mudan√ßas organizacionais e de processos. <br><hr><br><h4>  Agradecimentos </h4><br>  Gostaria de agradecer a todas as pessoas que me ajudaram na minha jornada da crise √† transforma√ß√£o do LeSS.  Eu constantemente sinto seu apoio. <br><br>  Muito obrigado ao nosso CEO, Fedor Ovchinnikov, pela confian√ßa.  Voc√™ √© o verdadeiro l√≠der da empresa com uma verdadeira cultura √°gil. <br><br>  Muito obrigado a Dmitry Pavlov, nosso Product Owner, meu velho amigo e co-treinador. <br><br>  Obrigado Alex Andronov e Andrey Morevsky por me apoiarem no meu papel. <br><br>  Muito obrigado a Dasha Bayanova, nossa primeira Scrum Master em tempo integral, que acreditou em mim e sempre me ajuda e me apoia com toda a nossa iniciativa.  √â dif√≠cil superestimar sua ajuda. <br><br>  Um enorme agradecimento especial a Johanna Rothman, que me ajudou a escrever este relat√≥rio em qualquer condi√ß√£o: estar de f√©rias, se recuperar ap√≥s uma doen√ßa.  Johanna, foi um grande prazer trabalhar com voc√™.  Sua ajuda, conselho, aten√ß√£o aos detalhes e dilig√™ncia s√£o muito apreciados. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt447154/">https://habr.com/ru/post/pt447154/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt447144/index.html">Como organizei o armazenamento de fotos</a></li>
<li><a href="../pt447146/index.html">Comutadores industriais n√£o gerenciados EKI</a></li>
<li><a href="../pt447148/index.html">O aplicativo (des) oficial Habr - HabrApp 2.0: acesso</a></li>
<li><a href="../pt447150/index.html">Bate-papo no site e na emiss√£o do Yandex</a></li>
<li><a href="../pt447152/index.html">Lan√ßamento do kit de ferramentas de interface do usu√°rio .NET entre plataformas AvaloniaUI 0.8</a></li>
<li><a href="../pt447156/index.html">Wireshark 3.x: an√°lise de c√≥digo no macOS e revis√£o de erros</a></li>
<li><a href="../pt447158/index.html">Wireshark 3.x: an√°lise de c√≥digo do macOS e revis√£o de erros</a></li>
<li><a href="../pt447160/index.html">Espa√ßo para crian√ßas. Algumas id√©ias para o Dia da Cosmon√°utica</a></li>
<li><a href="../pt447162/index.html">N√£o compre ERP</a></li>
<li><a href="../pt447164/index.html">Como combinar as vantagens de um laptop e um computador desktop? An√°lise de problemas e solu√ß√µes (parte 2)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>