<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¿ ğŸ‘¨ğŸ¼â€ğŸ’» ğŸ¤œğŸ¾ Total kumulatif dalam SQL ğŸ’‚ğŸ¼ ğŸ‘¨ğŸ½â€ğŸ« ğŸ¿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hasil kumulatif (kumulatif) telah lama dianggap sebagai salah satu panggilan SQL. Anehnya, bahkan setelah kemunculan fungsi jendela, ia tetap menjadi ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Total kumulatif dalam SQL</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/474458/"> Hasil kumulatif (kumulatif) telah lama dianggap sebagai salah satu panggilan SQL.  Anehnya, bahkan setelah kemunculan fungsi jendela, ia tetap menjadi orang-orangan sawah (dalam hal apa pun, untuk pemula).  Hari ini kita melihat mekanisme 10 solusi paling menarik untuk masalah ini - dari fungsi jendela hingga peretasan yang sangat spesifik. <br><a name="habracut"></a><br>  Dalam spreadsheet seperti Excel, total berjalan dihitung sangat sederhana: hasil dalam catatan pertama cocok dengan nilainya: <br><br><img src="https://habrastorage.org/webt/sz/2b/rj/sz2brjvhpv7k99d4z6pisxsmtgc.png"><br><br>  ... lalu kami merangkum nilai saat ini dan total sebelumnya. <br><br><img src="https://habrastorage.org/webt/ol/yb/2j/olyb2jjuhlpcljbo5jxk8gvygl0.png"><br><br>  Dengan kata lain <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>1</mn></msub><mo>=</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mn>1</mn></msub><mspace linebreak=&quot;newline&quot; /><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>2</mn></msub><mo>=</mo><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>1</mn></msub><mo>+</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mn>2</mn></msub><mspace linebreak=&quot;newline&quot; /><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>3</mn></msub><mo>=</mo><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>2</mn></msub><mo>+</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mn>3</mn></msub><mspace linebreak=&quot;newline&quot; /><mtext>&amp;#xA0;</mtext><mi>l</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>s</mi><mspace linebreak=&quot;newline&quot; /><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mi>n</mi></msub><mo>=</mo><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mi>n</mi></msub><mspace linebreak=&quot;newline&quot; /></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="76.867ex" height="16.515ex" viewBox="0 -780.1 33095.6 7110.7" role="img" focusable="false" style="vertical-align: -14.703ex; max-width: 638px;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(12918,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-54" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6F" x="704" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-74" x="1190" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="1551" y="0"></use><g transform="translate(2081,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-31" x="422" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-3D" x="3111" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-56" x="4167" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="4936" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6C" x="5466" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-75" x="5764" y="0"></use><g transform="translate(6337,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-65" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-31" x="659" y="-213"></use></g></g><g transform="translate(10890,-1278)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-54" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6F" x="704" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-74" x="1190" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="1551" y="0"></use><g transform="translate(2081,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-32" x="422" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-3D" x="3111" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-54" x="4167" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6F" x="4871" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-74" x="5357" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="5718" y="0"></use><g transform="translate(6248,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-31" x="422" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-2B" x="7223" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-56" x="8223" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="8993" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6C" x="9522" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-75" x="9821" y="0"></use><g transform="translate(10393,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-65" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-32" x="659" y="-213"></use></g></g><g transform="translate(10890,-2555)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-54" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6F" x="704" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-74" x="1190" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="1551" y="0"></use><g transform="translate(2081,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-33" x="422" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-3D" x="3111" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-54" x="4167" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6F" x="4871" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-74" x="5357" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="5718" y="0"></use><g transform="translate(6248,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-32" x="422" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-2B" x="7223" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-56" x="8223" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="8993" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6C" x="9522" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-75" x="9821" y="0"></use><g transform="translate(10393,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-65" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-33" x="659" y="-213"></use></g></g><g transform="translate(15353,-3848)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-64" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6F" x="1072" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-74" x="1557" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-73" x="1919" y="0"></use></g><g transform="translate(10332,-5048)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-54" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6F" x="704" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-74" x="1190" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="1551" y="0"></use><g transform="translate(2081,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6E" x="422" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-3D" x="3181" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-54" x="4238" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6F" x="4942" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-74" x="5428" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="5789" y="0"></use><g transform="translate(6319,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6C" x="0" y="0"></use><g transform="translate(298,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-31" x="1379" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-2B" x="8268" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-56" x="9269" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="10039" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6C" x="10568" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-75" x="10867" y="0"></use><g transform="translate(11439,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-65" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6E" x="659" y="-213"></use></g></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>1</mn></msub><mo>=</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mn>1</mn></msub><mspace linebreak="newline"></mspace><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>2</mn></msub><mo>=</mo><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>1</mn></msub><mo>+</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mn>2</mn></msub><mspace linebreak="newline"></mspace><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>3</mn></msub><mo>=</mo><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>2</mn></msub><mo>+</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mn>3</mn></msub><mspace linebreak="newline"></mspace><mtext>&nbsp;</mtext><mi>l</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>s</mi><mspace linebreak="newline"></mspace><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mi>n</mi></msub><mo>=</mo><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mi>n</mi></msub><mspace linebreak="newline"></mspace></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> Total_1 = Value_1 \\ Total_2 = Total_1 + Value_2 \\ Total_3 = Total_2 + Value_3 \\ \ ldots \\ Total_n = Total_ {n-1} + Value_n \\ </script></p><br>  ... atau: <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>g</mi><mi>i</mi><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>s</mi></mrow><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>1</mn></msub><mo>=</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mn>1</mn></msub><mo>,</mo><mi>n</mi><mo>=</mo><mn>1</mn><mspace linebreak=&quot;newline&quot; /><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mi>n</mi></msub><mo>=</mo><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mi>n</mi></msub><mo>,</mo><mi>n</mi><mtext>&amp;#xA0;</mtext><mi>g</mi><mi>e</mi><mi>q</mi><mn>2</mn><mtext>&amp;#xA0;</mtext><mi>e</mi><mi>n</mi><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>s</mi></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="76.867ex" height="5.551ex" viewBox="0 -780.1 33095.6 2390.2" role="img" focusable="false" style="vertical-align: -3.74ex; max-width: 638px;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(9008,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-65" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-67" x="1146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-69" x="1626" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6E" x="1972" y="0"></use><g transform="translate(2572,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-63" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="433" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-73" x="963" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-65" x="1432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-73" x="1899" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-54" x="4941" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6F" x="5645" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-74" x="6131" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="6492" y="0"></use><g transform="translate(7022,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-31" x="422" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-3D" x="8052" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-56" x="9108" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="9877" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6C" x="10407" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-75" x="10705" y="0"></use><g transform="translate(11278,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-65" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-31" x="659" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-2C" x="12198" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6E" x="12644" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-3D" x="13522" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-31" x="14578" y="0"></use></g><g transform="translate(6626,-1333)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-54" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6F" x="704" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-74" x="1190" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="1551" y="0"></use><g transform="translate(2081,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6E" x="422" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-3D" x="3181" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-54" x="4238" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6F" x="4942" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-74" x="5428" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="5789" y="0"></use><g transform="translate(6319,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6C" x="0" y="0"></use><g transform="translate(298,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-31" x="1379" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-2B" x="8268" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-56" x="9269" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="10039" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6C" x="10568" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-75" x="10867" y="0"></use><g transform="translate(11439,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-65" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6E" x="659" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-2C" x="12430" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6E" x="12875" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-67" x="13726" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-65" x="14206" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-71" x="14673" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-32" x="15133" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-65" x="15884" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6E" x="16350" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-64" x="16951" y="0"></use><g transform="translate(17474,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-63" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="433" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-73" x="963" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-65" x="1432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-73" x="1899" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>g</mi><mi>i</mi><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>s</mi></mrow><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>1</mn></msub><mo>=</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mn>1</mn></msub><mo>,</mo><mi>n</mi><mo>=</mo><mn>1</mn><mspace linebreak="newline"></mspace><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mi>n</mi></msub><mo>=</mo><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mi>n</mi></msub><mo>,</mo><mi>n</mi><mtext>&nbsp;</mtext><mi>g</mi><mi>e</mi><mi>q</mi><mn>2</mn><mtext>&nbsp;</mtext><mi>e</mi><mi>n</mi><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>s</mi></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> \ begin {cases} Total_1 = Value_1, n = 1 \\ Total_n = Total_ {n-1} + Value_n, n \ geq 2 \ end {cases} </script></p><br><br>  Munculnya dua atau lebih kelompok dalam tabel agak mempersulit tugas: sekarang kami menghitung beberapa hasil (untuk setiap kelompok secara terpisah).  Namun, di sini solusinya ada di permukaan: setiap kali perlu untuk memeriksa kelompok mana dari catatan saat ini milik.  <i>Klik dan seret</i> , dan pekerjaan selesai: <br><br><img src="https://habrastorage.org/webt/bk/gu/_a/bkgu_argpjjzckyu-jciknipjze.png"><br><br>  Seperti yang Anda lihat, perhitungan total kumulatif dikaitkan dengan dua komponen yang tidak berubah: <br>  <b>(a)</b> mengurutkan data berdasarkan tanggal dan <br>  <b>(B)</b> mengacu pada baris sebelumnya. <br><br>  Tapi apa itu SQL?  Untuk waktu yang sangat lama tidak ada fungsi yang diperlukan di dalamnya.  Alat yang diperlukan - fungsi jendela - pertama kali muncul hanya dalam standar <i>SQL: 2003</i> .  Pada titik ini, mereka sudah berada di Oracle (versi 8i).  Tetapi implementasi dalam DBMS lainnya tertunda selama 5-10 tahun: SQL Server 2012, MySQL 8.0.2 (2018), MariaDB 10.2.0 (2017), PostgreSQL 8.4 (2009), DB2 9 untuk z / OS (2007) tahun), dan bahkan SQLite 3.25 (2018). <br><br><div class="spoiler">  <b class="spoiler_title">Uji data</b> <div class="spoiler_text"><pre><code class="sql hljs"><span class="hljs-comment"><span class="hljs-comment">--       -- --   create table test_simple (dt date null, val int null ); --      (  , .  NLS_DATE_FORMAT  Oracle) insert into test_simple (dt, val) values ('2019-11-01', 6); insert into test_simple (dt, val) values ('2019-11-02', 3); insert into test_simple (dt, val) values ('2019-11-03', 3); insert into test_simple (dt, val) values ('2019-11-04', 4); insert into test_simple (dt, val) values ('2019-11-05', 2); insert into test_simple (dt, val) values ('2019-11-06', 4); insert into test_simple (dt, val) values ('2019-11-07', 8); insert into test_simple (dt, val) values ('2019-11-08', 0); insert into test_simple (dt, val) values ('2019-11-09', 6); insert into test_simple (dt, val) values ('2019-11-10', 0); insert into test_simple (dt, val) values ('2019-11-11', 8); insert into test_simple (dt, val) values ('2019-11-12', 8); insert into test_simple (dt, val) values ('2019-11-13', 0); insert into test_simple (dt, val) values ('2019-11-14', 2); insert into test_simple (dt, val) values ('2019-11-15', 8); insert into test_simple (dt, val) values ('2019-11-16', 7); --    create table test_groups (grp varchar null, -- varchar2(1) in Oracle dt date null, val int null ); --      (  , .  NLS_DATE_FORMAT  Oracle) insert into test_groups (grp, dt, val) values ('a', '2019-11-06', 1); insert into test_groups (grp, dt, val) values ('a', '2019-11-07', 3); insert into test_groups (grp, dt, val) values ('a', '2019-11-08', 4); insert into test_groups (grp, dt, val) values ('a', '2019-11-09', 1); insert into test_groups (grp, dt, val) values ('a', '2019-11-10', 7); insert into test_groups (grp, dt, val) values ('b', '2019-11-06', 9); insert into test_groups (grp, dt, val) values ('b', '2019-11-07', 10); insert into test_groups (grp, dt, val) values ('b', '2019-11-08', 9); insert into test_groups (grp, dt, val) values ('b', '2019-11-09', 1); insert into test_groups (grp, dt, val) values ('b', '2019-11-10', 10); insert into test_groups (grp, dt, val) values ('c', '2019-11-06', 4); insert into test_groups (grp, dt, val) values ('c', '2019-11-07', 10); insert into test_groups (grp, dt, val) values ('c', '2019-11-08', 9); insert into test_groups (grp, dt, val) values ('c', '2019-11-09', 4); insert into test_groups (grp, dt, val) values ('c', '2019-11-10', 4); --   -- select * from test_simple order by dt; select * from test_groups order by grp, dt;</span></span></code> </pre> <br></div></div><br><h3>  1. Fungsi jendela </h3><br>  Fungsi jendela mungkin adalah cara termudah.  Dalam kasus dasar (tabel tanpa grup) kami menganggap data diurutkan berdasarkan tanggal: <br><br><pre> <code class="sql hljs">order by dt</code> </pre> <br>  ... tapi kami hanya tertarik pada garis sebelum yang sekarang: <br><br><pre> <code class="sql hljs">rows between unbounded preceding and current row</code> </pre> <br>  Pada akhirnya, kita perlu penjumlahan dengan parameter ini: <br><br><pre> <code class="sql hljs">sum(val) over (order by dt rows between unbounded preceding and current row)</code> </pre> <br>  Permintaan lengkap akan terlihat seperti ini: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> s.*, <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(s.val) <span class="hljs-keyword"><span class="hljs-keyword">over</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> s.dt <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span> <span class="hljs-keyword"><span class="hljs-keyword">between</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unbounded</span></span> <span class="hljs-keyword"><span class="hljs-keyword">preceding</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple s <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> s.dt;</code> </pre> <br>  Dalam kasus total kumulatif untuk grup (bidang <code>grp</code> ) kita hanya perlu satu suntingan kecil.  Sekarang kami menganggap data tersebut dibagi menjadi â€œwindowsâ€ berdasarkan grup: <br><br><img src="https://habrastorage.org/webt/ax/zv/v-/axzvv-dmyetwe7w3t5ugalouw1o.png"><br><br>  Untuk menjelaskan pemisahan ini, Anda harus menggunakan <code>partition by</code> kata kunci: <br><br><pre> <code class="sql hljs">partition by grp</code> </pre> <br>  Dan, karenanya, pertimbangkan jumlah untuk windows ini: <br><br><pre> <code class="sql hljs">sum(val) over (partition by grp order by dt rows between unbounded preceding and current row)</code> </pre> <br>  Kemudian seluruh kueri dikonversi seperti ini: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> tg.*, <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(tg.val) <span class="hljs-keyword"><span class="hljs-keyword">over</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">partition</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> tg.grp <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> tg.dt <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span> <span class="hljs-keyword"><span class="hljs-keyword">between</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unbounded</span></span> <span class="hljs-keyword"><span class="hljs-keyword">preceding</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_groups tg <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> tg.grp, tg.dt;</code> </pre> <br>  Kinerja fungsi jendela akan tergantung pada spesifikasi DBMS Anda (dan versinya!), Ukuran tabel, dan ketersediaan indeks.  Tetapi dalam kebanyakan kasus, metode ini akan menjadi yang paling efektif.  Namun, fungsi jendela tidak tersedia dalam versi DBMS yang lebih lama (yang masih digunakan).  Selain itu, mereka tidak dalam DBMS seperti Microsoft Access dan SAP / Sybase ASE.  Jika solusi independen vendor diperlukan, pertimbangan harus diberikan pada alternatif. <br><br><h3>  2. Subquery </h3><br>  Seperti disebutkan di atas, fungsi jendela diperkenalkan sangat terlambat dalam DBMS utama.  Penundaan ini seharusnya tidak mengejutkan: dalam teori relasional, data tidak dipesan.  Lebih dari semangat teori relasional berhubungan dengan solusi melalui subquery. <br><br>  Subquery seperti itu harus mempertimbangkan jumlah nilai dengan tanggal sebelum saat ini (dan termasuk saat ini): <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>d</mi><msub><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>b</mi><mi>a</mi><mi>r</mi><mi>i</mi><mi>s</mi></mrow></msub><mtext>&amp;#xA0;</mtext><mi>l</mi><mi>e</mi><mi>q</mi><mi>d</mi><msub><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>b</mi><mi>a</mi><mi>r</mi><mi>i</mi><mi>s</mi><mi>s</mi><mi>a</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>n</mi><mi>i</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.537ex" height="2.419ex" viewBox="0 -780.1 8842.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-64" x="0" y="0"></use><g transform="translate(523,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-74" x="0" y="0"></use><g transform="translate(361,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-62" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="429" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-72" x="959" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-69" x="1410" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-73" x="1756" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6C" x="2808" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-65" x="3107" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-71" x="3573" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-64" x="4034" y="0"></use><g transform="translate(4557,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-74" x="0" y="0"></use><g transform="translate(361,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-62" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="429" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-72" x="959" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-69" x="1410" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-73" x="1756" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-73" x="2225" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="2695" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="3224" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-74" x="3754" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-69" x="4115" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6E" x="4461" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-69" x="5061" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><msub><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>b</mi><mi>a</mi><mi>r</mi><mi>i</mi><mi>s</mi></mrow></msub><mtext>&nbsp;</mtext><mi>l</mi><mi>e</mi><mi>q</mi><mi>d</mi><msub><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>b</mi><mi>a</mi><mi>r</mi><mi>i</mi><mi>s</mi><mi>s</mi><mi>a</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>n</mi><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-3"> dt_ {baris} \ leq dt_ {baris saat ini} </script>  . <br><br>  Apa dalam kode terlihat seperti ini: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> s.*, (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(t2.val), <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple t2 <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> t2.dt &lt;= s.dt) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple s <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> s.dt;</code> </pre><br>  Solusi yang sedikit lebih efisien adalah di mana subquery mempertimbangkan total hingga tanggal saat ini (tetapi tidak termasuk itu), dan kemudian merangkumnya dengan nilai di baris: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> s.*, s.val + (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(t2.val), <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple t2 <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> t2.dt &lt; s.dt) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple s <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> s.dt;</code> </pre><br>  Dalam kasus hasil kumulatif untuk beberapa kelompok, kita perlu menggunakan subquery yang berkorelasi: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> g.*, (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(t2.val), <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_groups t2 <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> g.grp = t2.grp <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> t2.dt &lt;= g.dt) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_groups g <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> g.grp, g.dt;</code> </pre><br>  Kondisi <code>g.grp = t2.grp</code> memeriksa baris untuk dimasukkan dalam grup (yang, pada prinsipnya, mirip dengan pekerjaan <code>partition by grp</code> di fungsi jendela). <br><br><h3>  3. Koneksi internal </h3><br>  Karena subkueri dan gabungan dapat dipertukarkan, kita dapat dengan mudah mengganti satu dengan yang lain.  Untuk melakukan ini, Anda harus menggunakan Self Join, menghubungkan dua contoh dari tabel yang sama: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> s.*, <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(t2.val), <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple s <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> test_simple t2 <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> t2.dt &lt;= s.dt <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> s.dt, s.val <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> s.dt;</code> </pre><br>  Seperti yang Anda lihat, kondisi pemfilteran dalam subquery <code>t2.dt &lt;= s.dt</code> telah menjadi kondisi gabungan.  Selain itu, untuk menggunakan jumlah fungsi agregasi <code>sum()</code> kita perlu mengelompokkan berdasarkan tanggal dan nilai berdasarkan <code>group by s.dt, s.val</code> . <br><br>  Demikian pula, Anda dapat melakukannya untuk <code>grp</code> grup <code>grp</code> berbeda: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> g.*, <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(t2.val), <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_groups g <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> test_groups t2 <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> g.grp = t2.grp <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> t2.dt &lt;= g.dt <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> g.grp, g.dt, g.val <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> g.grp, g.dt;</code> </pre><br><h3>  4. produk Cartesian </h3><br>  Karena kami mengganti subquery dengan join, mengapa tidak mencoba produk Cartesian?  Solusi ini hanya akan membutuhkan suntingan minimal: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> s.*, <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(t2.val), <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple s, test_simple t2 <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> t2.dt &lt;= s.dt <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> s.dt, s.val <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> s.dt;</code> </pre><br>  Atau untuk kasus grup: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> g.*, <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(t2.val), <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_groups g, test_groups t2 <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> g.grp = t2.grp <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> t2.dt &lt;= g.dt <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> g.grp, g.dt, g.val <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> g.grp, g.dt;</code> </pre><br>  Solusi yang terdaftar (subquery, inner join, cartesian join) berhubungan dengan <i>SQL-92</i> dan <i>SQL: 1999</i> , dan karenanya akan tersedia di hampir semua DBMS.  Masalah utama dengan semua solusi ini adalah kinerja yang buruk.  Ini bukan masalah besar jika kita mewujudkan sebuah tabel dengan hasilnya (tetapi Anda masih ingin lebih cepat!).  Metode lebih lanjut jauh lebih efektif (disesuaikan untuk spesifikasi DBMS spesifik dan versinya sudah ditentukan, ukuran tabel, indeks). <br><br><h3>  5. Permintaan rekursif </h3><br>  Salah satu pendekatan yang lebih spesifik adalah kueri rekursif dalam ekspresi tabel umum.  Untuk melakukan ini, kita memerlukan "jangkar" - kueri yang mengembalikan baris pertama: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, val, val <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> dt = (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">min</span></span>(dt) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple)</code> </pre><br>  Kemudian, dengan bantuan <code>union all</code> , hasil kueri rekursif ditambahkan ke "jangkar".  Untuk melakukan ini, Anda dapat mengandalkan bidang tanggal <code>dt</code> , menambahkan satu hari ke dalamnya: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> r.dt, r.val, cte.total + r.val <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> cte <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> test_simple r <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> r.dt = <span class="hljs-keyword"><span class="hljs-keyword">dateadd</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">day</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, cte.dt) <span class="hljs-comment"><span class="hljs-comment">-- + 1   SQL Server</span></span></code> </pre><br>  Bagian dari kode yang menambahkan satu hari tidak universal.  Sebagai contoh, ini adalah <code>r.dt = dateadd(day, 1, cte.dt)</code> untuk SQL Server, <code>r.dt = cte.dt + 1</code> untuk Oracle, dll. <br><br>  Menggabungkan "jangkar" dan permintaan utama, kami mendapatkan hasil akhir: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> cte (dt, val, total) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, val, val <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> dt = (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">min</span></span>(dt) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple) <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> all <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> r.dt, r.val, cte.total + r.val <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> cte <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> test_simple r <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> r.dt = <span class="hljs-keyword"><span class="hljs-keyword">dateadd</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">day</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, cte.dt) <span class="hljs-comment"><span class="hljs-comment">-- r.dt = cte.dt + 1  Oracle,  .. ) select dt, val, total from cte order by dt;</span></span></code> </pre><br>  Solusi untuk kasus dengan kelompok tidak akan jauh lebih rumit: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> cte (dt, grp, val, total) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> g.dt, g.grp, g.val, g.val <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_groups g <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> g.dt = (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">min</span></span>(dt) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_groups <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> grp = g.grp) <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> all <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> r.dt, r.grp, r.val, cte.total + r.val <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> cte <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> test_groups r <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> r.dt = <span class="hljs-keyword"><span class="hljs-keyword">dateadd</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">day</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, cte.dt) <span class="hljs-comment"><span class="hljs-comment">-- r.dt = cte.dt + 1  Oracle,  .. and cte.grp = r.grp ) select dt, grp, val, total from cte order by grp, dt;</span></span></code> </pre><br><h3>  6. Permintaan rekursif dengan fungsi <code>row_number()</code> </h3><br>  Keputusan sebelumnya didasarkan pada kontinuitas bidang tanggal <code>dt</code> dengan kenaikan berurutan 1 hari.  Kami menghindari ini dengan menggunakan fungsi jendela <code>row_number()</code> , yang memberi nomor pada baris.  Tentu saja, ini tidak adil - karena kita akan mempertimbangkan alternatif untuk fungsi jendela.  Namun, solusi ini mungkin semacam <i>pembuktian konsep</i> : dalam praktiknya, mungkin ada bidang yang menggantikan nomor baris (record id).  Selain itu, di SQL Server, fungsi <code>row_number()</code> muncul sebelum dukungan penuh untuk fungsi jendela diperkenalkan (termasuk <code>sum()</code> ). <br><br>  Jadi, untuk permintaan rekursif dengan <code>row_number()</code> kita membutuhkan dua STE.  Yang pertama, kita hanya memberi nomor pada baris: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> cte1 (dt, val, rn) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, val, row_number() <span class="hljs-keyword"><span class="hljs-keyword">over</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> dt) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> rn <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple)</code> </pre><br>  ... dan jika nomor baris sudah ada dalam tabel, maka Anda dapat melakukannya tanpa itu.  Dalam kueri berikut, kami sudah <code>cte1</code> ke <code>cte1</code> : <br><br><pre> <code class="sql hljs">cte2 (dt, val, rn, total) as (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, val, rn, val <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> cte1 <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> rn = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> all <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> cte1.dt, cte1.val, cte1.rn, cte2.total + cte1.val <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> cte2 <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> cte1 <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> cte1.rn = cte2.rn + <span class="hljs-number"><span class="hljs-number">1</span></span> )</code> </pre><br>  Dan seluruh permintaan terlihat seperti ini: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> cte1 (dt, val, rn) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, val, row_number() <span class="hljs-keyword"><span class="hljs-keyword">over</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> dt) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> rn <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple), cte2 (dt, val, rn, total) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, val, rn, val <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> cte1 <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> rn = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> all <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> cte1.dt, cte1.val, cte1.rn, cte2.total + cte1.val <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> cte2 <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> cte1 <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> cte1.rn = cte2.rn + <span class="hljs-number"><span class="hljs-number">1</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, val, total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> cte2 <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> dt;</code> </pre><br>  ... atau untuk kasus grup: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> cte1 (dt, grp, val, rn) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, grp, val, row_number() <span class="hljs-keyword"><span class="hljs-keyword">over</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">partition</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> grp <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> dt) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> rn <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_groups), cte2 (dt, grp, val, rn, total) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, grp, val, rn, val <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> cte1 <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> rn = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> all <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> cte1.dt, cte1.grp, cte1.val, cte1.rn, cte2.total + cte1.val <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> cte2 <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> cte1 <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> cte1.grp = cte2.grp <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> cte1.rn = cte2.rn + <span class="hljs-number"><span class="hljs-number">1</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, grp, val, total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> cte2 <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> grp, dt;</code> </pre><br><h3>  7. <code>CROSS APPLY</code> / <code>LATERAL</code> </h3><br>  Salah satu cara paling eksotis menghitung total yang berjalan adalah dengan menggunakan pernyataan <code>CROSS APPLY</code> (SQL Server, Oracle) atau <code>LATERAL</code> setara (MySQL, PostgreSQL).  Operator-operator ini muncul agak terlambat (misalnya, di Oracle hanya dari versi 12c).  Dan di beberapa DBMS (misalnya, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">MariaDB</a> ) mereka tidak sama sekali.  Oleh karena itu, keputusan ini murni untuk kepentingan estetika. <br><br>  Secara fungsional, menggunakan <code>CROSS APPLY</code> atau <code>LATERAL</code> identik dengan subquery: kami melampirkan hasil perhitungan ke permintaan utama: <br><br><pre> <code class="sql hljs">cross apply (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(t2.val), <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple t2 <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> t2.dt &lt;= s.dt ) t2</code> </pre><br>  ... yang terlihat seperti ini: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> s.*, t2.total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple s <span class="hljs-keyword"><span class="hljs-keyword">cross</span></span> <span class="hljs-keyword"><span class="hljs-keyword">apply</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(t2.val), <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple t2 <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> t2.dt &lt;= s.dt ) t2 <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> s.dt;</code> </pre><br>  Solusi untuk kasus dengan kelompok akan serupa: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> g.*, t2.total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_groups g <span class="hljs-keyword"><span class="hljs-keyword">cross</span></span> <span class="hljs-keyword"><span class="hljs-keyword">apply</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(t2.val), <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_groups t2 <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> g.grp = t2.grp <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> t2.dt &lt;= g.dt ) t2 <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> g.grp, g.dt;</code> </pre><br>  Total: kami memeriksa solusi platform-independen utama.  Tetapi ada solusi khusus untuk DBMS spesifik!  Karena ada banyak opsi di sini, mari kita memikirkan beberapa yang paling menarik. <br><br><h3>  8. Pernyataan <code>MODEL</code> (Oracle) </h3><br>  Pernyataan <code>MODEL</code> di Oracle memberikan salah satu solusi paling elegan.  Di awal artikel, kami memeriksa rumus umum dari total kumulatif: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>g</mi><mi>i</mi><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>s</mi></mrow><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>1</mn></msub><mo>=</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mn>1</mn></msub><mo>,</mo><mi>n</mi><mo>=</mo><mn>1</mn><mspace linebreak=&quot;newline&quot; /><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mi>n</mi></msub><mo>=</mo><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mi>n</mi></msub><mo>,</mo><mi>n</mi><mtext>&amp;#xA0;</mtext><mi>g</mi><mi>e</mi><mi>q</mi><mn>2</mn><mtext>&amp;#xA0;</mtext><mi>e</mi><mi>n</mi><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>s</mi></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="76.867ex" height="5.551ex" viewBox="0 -780.1 33095.6 2390.2" role="img" focusable="false" style="vertical-align: -3.74ex; max-width: 638px;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(9008,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-65" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-67" x="1146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-69" x="1626" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6E" x="1972" y="0"></use><g transform="translate(2572,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-63" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="433" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-73" x="963" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-65" x="1432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-73" x="1899" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-54" x="4941" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6F" x="5645" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-74" x="6131" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="6492" y="0"></use><g transform="translate(7022,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-31" x="422" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-3D" x="8052" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-56" x="9108" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="9877" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6C" x="10407" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-75" x="10705" y="0"></use><g transform="translate(11278,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-65" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-31" x="659" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-2C" x="12198" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6E" x="12644" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-3D" x="13522" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-31" x="14578" y="0"></use></g><g transform="translate(6626,-1333)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-54" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6F" x="704" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-74" x="1190" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="1551" y="0"></use><g transform="translate(2081,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6E" x="422" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-3D" x="3181" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-54" x="4238" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6F" x="4942" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-74" x="5428" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="5789" y="0"></use><g transform="translate(6319,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6C" x="0" y="0"></use><g transform="translate(298,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-31" x="1379" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-2B" x="8268" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-56" x="9269" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="10039" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6C" x="10568" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-75" x="10867" y="0"></use><g transform="translate(11439,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-65" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6E" x="659" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-2C" x="12430" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6E" x="12875" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-67" x="13726" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-65" x="14206" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-71" x="14673" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMAIN-32" x="15133" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-65" x="15884" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-6E" x="16350" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-64" x="16951" y="0"></use><g transform="translate(17474,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-63" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-61" x="433" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-73" x="963" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-65" x="1432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhhwH59tveBpowodyi6Ji7RT6hMEiQ#MJMATHI-73" x="1899" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>g</mi><mi>i</mi><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>s</mi></mrow><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>1</mn></msub><mo>=</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mn>1</mn></msub><mo>,</mo><mi>n</mi><mo>=</mo><mn>1</mn><mspace linebreak="newline"></mspace><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mi>n</mi></msub><mo>=</mo><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mi>n</mi></msub><mo>,</mo><mi>n</mi><mtext>&nbsp;</mtext><mi>g</mi><mi>e</mi><mi>q</mi><mn>2</mn><mtext>&nbsp;</mtext><mi>e</mi><mi>n</mi><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>s</mi></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-4"> \ begin {cases} Total_1 = Value_1, n = 1 \\ Total_n = Total_ {n-1} + Value_n, n \ geq 2 \ end {cases} </script></p><br><br>  <code>MODEL</code> memungkinkan Anda untuk mengimplementasikan formula ini secara harfiah satu lawan satu!  Untuk melakukan ini, pertama-tama kita mengisi bidang <code>total</code> dengan nilai-nilai dari baris saat ini <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, val, val <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple</code> </pre><br>  ... lalu kita menghitung nomor baris sebagai <code>row_number() over (order by dt) as rn</code> (atau menggunakan bidang yang sudah jadi dengan nomor tersebut, jika ada).  Dan akhirnya, kami memperkenalkan aturan untuk semua baris kecuali yang pertama: <code>total[rn &gt;= 2] = total[cv() - 1] + val[cv()]</code> . <br><br>  Fungsi <code>cv()</code> sini bertanggung jawab atas nilai baris saat ini.  Dan seluruh permintaan akan terlihat seperti ini: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, val, total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, val, val <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple) t <span class="hljs-keyword"><span class="hljs-keyword">model</span></span> <span class="hljs-keyword"><span class="hljs-keyword">dimension</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> (row_number() <span class="hljs-keyword"><span class="hljs-keyword">over</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> dt) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> rn) <span class="hljs-keyword"><span class="hljs-keyword">measures</span></span> (dt, val, total) <span class="hljs-keyword"><span class="hljs-keyword">rules</span></span> (total[rn &gt;= <span class="hljs-number"><span class="hljs-number">2</span></span>] = total[cv() - <span class="hljs-number"><span class="hljs-number">1</span></span>] + val[cv()]) <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> dt;</code> </pre><br><h3>  9. Kursor (SQL Server) </h3><br>  Total berjalan adalah salah satu dari beberapa kasus di mana kursor di SQL Server tidak hanya berguna, tetapi juga lebih disukai daripada solusi lain (setidaknya sampai versi 2012, di mana fungsi jendela muncul). <br><br>  Implementasi melalui kursor cukup sepele.  Pertama, Anda perlu membuat tabel sementara dan mengisinya dengan tanggal dan nilai dari utama: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> <span class="hljs-comment"><span class="hljs-comment">#temp (dt date primary key, val int null, total int null ); insert #temp (dt, val) select dt, val from test_simple order by dt;</span></span></code> </pre><br>  Kemudian kami mengatur variabel lokal di mana pembaruan akan berlangsung: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">declare</span></span> @VarTotal <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>, @VarDT <span class="hljs-built_in"><span class="hljs-built_in">date</span></span>, @VarVal <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> @VarTotal = <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre><br>  Setelah itu kami memperbarui tabel sementara melalui kursor: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">declare</span></span> cur <span class="hljs-keyword"><span class="hljs-keyword">cursor</span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> read_only forward_only <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, val <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-comment"><span class="hljs-comment">#temp order by dt; open cur; fetch cur into @VarDT, @VarVal; while @@fetch_status = 0 begin set @VarTotal = @VarTotal + @VarVal; update #temp set total = @VarTotal where dt = @VarDT; fetch cur into @VarDT, @VarVal; end; close cur; deallocate cur;</span></span></code> </pre><br>  Dan akhirnya, kami mendapatkan hasil yang diinginkan: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, val, total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-comment"><span class="hljs-comment">#temp order by dt; drop table #temp;</span></span></code> </pre><br><h3>  10. Perbarui melalui variabel lokal (SQL Server) </h3><br>  Memperbarui melalui variabel lokal di SQL Server didasarkan pada perilaku tidak berdokumen, sehingga tidak dapat dianggap andal.  Meskipun demikian, ini mungkin solusi tercepat, dan ini menarik. <br><br>  Mari kita membuat dua variabel: satu untuk total kumulatif dan variabel tabel: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">declare</span></span> @VarTotal <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">declare</span></span> @tv <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> (dt <span class="hljs-built_in"><span class="hljs-built_in">date</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, val <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, total <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> );</code> </pre><br>  Pertama, isi <code>@tv</code> data dari tabel utama <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> @tv (dt, val, total) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, val, <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> dt;</code> </pre><br>  Kemudian <code>@tv</code> memperbarui variabel tabel <code>@tv</code> menggunakan <code>@VarTotal</code> : <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">update</span></span> @tv <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> @VarTotal = total = @VarTotal + val <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> @tv;</code> </pre><br>  ... setelah itu kita mendapatkan hasil akhir: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> @tv <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> dt;</code> </pre><br>  Ringkasan: Kami meninjau 10 cara teratas untuk menghitung total kumulatif dalam SQL.  Seperti yang Anda lihat, bahkan tanpa fungsi jendela, masalah ini sepenuhnya dapat dipecahkan, dan mekanisme solusi tidak dapat disebut rumit. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id474458/">https://habr.com/ru/post/id474458/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id474442/index.html">Kisah Ekstensi Kehidupan Irlandia</a></li>
<li><a href="../id474444/index.html">5 proyek pelatihan lebih berani untuk pengembang (Layer, Squoosh, Kalkulator, Crawler Situs Web, Music Player)</a></li>
<li><a href="../id474448/index.html">Apa yang mampu dimiliki otak seorang siswa di dunia komputer</a></li>
<li><a href="../id474450/index.html">Berhenti menggunakan TTL yang sangat kecil untuk DNS</a></li>
<li><a href="../id474452/index.html">Laporan Status Musim Gugur Haxe</a></li>
<li><a href="../id474460/index.html">Deskripsi arsitektur prosesor dalam LLVM menggunakan TableGen</a></li>
<li><a href="../id474462/index.html">Dataset terbuka yang besar untuk bahasa Rusia versi 1.0</a></li>
<li><a href="../id474466/index.html">Sejarah Diablo pertama</a></li>
<li><a href="../id474470/index.html">Serangan DDoS pada layanan RDP: kenali dan atasi. Pengalaman sukses dari Tucha</a></li>
<li><a href="../id474472/index.html">Daftar periksa UX 30 poin untuk aplikasi seluler</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>