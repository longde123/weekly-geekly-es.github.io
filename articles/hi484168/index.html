<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯПИ ЁЯСРЁЯП╛ ЁЯзСЁЯП╝тАНЁЯдЭтАНЁЯзСЁЯП╝ рд╣рдо рдХреЛрдгреАрдп рд╕реАрдбреАрдХреЗ рд╕реЗ рдЖрднрд╛рд╕реА рд╕реНрдХреНрд░реЙрд▓рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреА рд░рдгрдиреАрддрд┐ рд▓рд┐рдЦрддреЗ рд╣реИрдВ ЁЯдЫЁЯП┐ ЁЯО│ ЁЯС▒ЁЯП┐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдирдорд╕реНрддреЗ! 


 рдХреЛрдгреАрдп рд╕реАрдбреАрдХреЗ рдореЗрдВ, рд╕рд╛рддрд╡реЗрдВ рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ рдПрдХ рдЖрднрд╛рд╕реА рд╕реНрдХреНрд░реЙрд▓ рджрд┐рдЦрд╛рдИ рджрд┐рдпрд╛ ред 


 рдпрд╣ рдмрд╣реБрдд рдЕрдЪреНрдЫрд╛ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдЬрдм рдкреНрд░рддреНрдпреЗрдХ рддрддреНрд╡ рдХрд╛ рдЖрдХрд╛рд░ рд╕рдорд╛рди рд╣реЛрддрд╛ рд╣реИ - рдФ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рд╣рдо рдХреЛрдгреАрдп рд╕реАрдбреАрдХреЗ рд╕реЗ рдЖрднрд╛рд╕реА рд╕реНрдХреНрд░реЙрд▓рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреА рд░рдгрдиреАрддрд┐ рд▓рд┐рдЦрддреЗ рд╣реИрдВ</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tinkoff/blog/484168/"><p>  рдирдорд╕реНрддреЗ! </p><br><p>  рдХреЛрдгреАрдп рд╕реАрдбреАрдХреЗ рдореЗрдВ, рд╕рд╛рддрд╡реЗрдВ рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ <a href="https://material.angular.io/cdk/scrolling/overview">рдПрдХ рдЖрднрд╛рд╕реА рд╕реНрдХреНрд░реЙрд▓ рджрд┐рдЦрд╛рдИ рджрд┐рдпрд╛</a> ред </p><br><p> рдпрд╣ рдмрд╣реБрдд рдЕрдЪреНрдЫрд╛ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдЬрдм рдкреНрд░рддреНрдпреЗрдХ рддрддреНрд╡ рдХрд╛ рдЖрдХрд╛рд░ рд╕рдорд╛рди рд╣реЛрддрд╛ рд╣реИ - рдФрд░ рдмреЙрдХреНрд╕ рдХреЗ рдареАрдХ рдмрд╛рд╣рд░ред  рд╣рдо рдмрд╕ рдкрд┐рдХреНрд╕реЗрд▓ рдореЗрдВ рдЖрдХрд╛рд░ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЗрдВрдЧрд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдХрдВрдЯреЗрдирд░ рдХреЛ рдХрд┐рд╕ рддрддреНрд╡ рддрдХ рд╕реНрдХреНрд░реЙрд▓ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП, рдХреНрдпрд╛ рдЗрд╕реЗ рдЖрд╕рд╛рдиреА рд╕реЗ рдХрд░рдирд╛ рд╣реИ, рдФрд░ рд╣рдо рд╡рд░реНрддрдорд╛рди рддрддреНрд╡ рдХреЗ рд╕реВрдЪрдХрд╛рдВрдХ рдХреА рд╕рджрд╕реНрдпрддрд╛ рднреА рд▓реЗ рд╕рдХрддреЗ рд╣реИрдВред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХреНрдпрд╛ рд╣реЛрдЧрд╛ рдЕрдЧрд░ рддрддреНрд╡реЛрдВ рдХрд╛ рдЖрдХрд╛рд░ рдмрджрд▓ рдЬрд╛рдП?  рдЗрд╕рдХреЗ рд▓рд┐рдП, <a href=""><code>VirtualScrollStrategy</code></a> рдореЗрдВ <a href=""><code>VirtualScrollStrategy</code></a> рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рд▓рд╛рдЧреВ рдХрд░рдХреЗ рд╣рдо рдЕрдкрдиреА рд╕реВрдЪреА рдореЗрдВ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдХреНрд░реЙрд▓ рд╕рд┐рдЦрд╛рдПрдВрдЧреЗред </p><br><p>  рдореЗрд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдореЛрдмрд╛рдЗрд▓ рдкреНрд░рд╕реНрддреБрддрд┐ рдХреЗ рд▓рд┐рдП рдПрдХ рдХреИрд▓реЗрдВрдбрд░ рдмрдирд╛рдирд╛ рдЖрд╡рд╢реНрдпрдХ рдерд╛, рдЬрд┐рд╕реЗ рд▓рдЧрд╛рддрд╛рд░ рд╕реНрдХреНрд░реЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдПрдХ рдорд╣реАрдиреЗ рдореЗрдВ рд╣рдлреНрддреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рд╣рдореЗрд╢рд╛ рдЕрд▓рдЧ рд╣реЛрддреА рд╣реИред  рдЖрдЗрдП рдЬрд╛рдирдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ рдХрд┐ рд╡рд░реНрдЪреБрдЕрд▓ рд╕реНрдХреНрд░реЙрд▓рд┐рдВрдЧ рд╕реНрдЯреНрд░реИрдЯреЗрдЬреА рдХреНрдпрд╛ рд╣реИ рдФрд░ рдЕрдкрдирд╛ рдЦреБрдж рдХрд╛ рд▓рд┐рдЦреЗрдВред </p><br><p><img src="https://habrastorage.org/webt/g9/7b/yo/g97byoqd51-wu9jd8o27awx0-bk.png" alt="рдЫрд╡рд┐"></p><a name="habracut"></a><br><h2 id="raschet-razmerov">  рдЖрдХрд╛рд░ рдХреА рдЧрдгрдирд╛ </h2><br><p>  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рдЬрд╛рдирддреЗ рд╣реИрдВ, рд╣рд░ 28 рд╕рд╛рд▓ рдореЗрдВ рдХреИрд▓реЗрдВрдбрд░ рджреЛрд╣рд░рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </p><br><p>  рдРрд╕рд╛ рддрдм рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрдм рдЖрдк рдЗрд╕ рдмрд╛рдд рдХрд╛ рдзреНрдпрд╛рди рдирд╣реАрдВ рд░рдЦрддреЗ рд╣реИрдВ рдХрд┐ рд╡рд░реНрд╖ рд▓реАрдк рд╡рд░реНрд╖ рдирд╣реАрдВ рд╣реИ, рдпрджрд┐ рдпрд╣ 100 рд╕реЗ рд╡рд┐рднрд╛рдЬреНрдп рд╣реИ, рд▓реЗрдХрд┐рди 400 рд╕реЗ рдирд╣реАрдВред рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдореЗрдВ 1900 рд╕реЗ рдкрд╣рд▓реЗ рдФрд░ 2100 рдХреЗ рдмрд╛рдж рдХреЗ рд╡рд░реНрд╖реЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред рдЬрдирд╡рд░реА рдХреЛ рд╕реЛрдорд╡рд╛рд░ рдХреЛ рдкрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо 1900 рд╕реЗ рдПрдХ рднреА рдЦрд╛рддреЗ рдХреЗ рд▓рд┐рдП рд╢реБрд░реВ рдХрд░реЗрдВрдЧреЗ рдФрд░ рд╣рдо рдХрд░реЗрдВрдЧреЗ 196 рд╕рд╛рд▓ рдкреАрдЫреЗ рд╣рдЯреЗрдВред  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рд╣рдорд╛рд░реЗ рдХреИрд▓реЗрдВрдбрд░ рдореЗрдВ 7 рджреЛрд╣рд░рд╛рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЪрдХреНрд░ рд╣реЛрдВрдЧреЗред  1900 рдореЗрдВ 29 рдлрд░рд╡рд░реА рдХреА рдЕрдиреБрдкрд╕реНрдерд┐рддрд┐ рдЪреЛрдЯ рдирд╣реАрдВ рдкрд╣реБрдВрдЪрд╛рдПрдЧреА, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЧреБрд░реБрд╡рд╛рд░ рд╣реЛрдЧрд╛ред </p><br><div style="text-align:center;"><img width="300" src="https://habrastorage.org/webt/ss/rr/oq/ssrroq2ub8w57ihutm6vjo1agou.gif"></div><br><p>  рдЧрдгрдирд╛ рд╕реНрдХреНрд░реЙрд▓ рдХреЗ рджреМрд░рд╛рди рдХреА рдЬрд╛рдПрдЧреА, рдЗрд╕рд▓рд┐рдП рдЧрдгрдирд╛ рдЬрд┐рддрдиреА рд╕рд░рд▓ рд╣реЛрдЧреА, рдкреНрд░рджрд░реНрд╢рди рдЙрддрдирд╛ рд╣реА рдЕрдзрд┐рдХ рд╣реЛрдЧрд╛ред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдПрдХ рд▓реВрдк рд╕реНрдерд┐рд░рд╛рдВрдХ рдмрдирд╛рдПрдВрдЧреЗ, рдЬрд┐рд╕рдореЗрдВ 12 рд╕рдВрдЦреНрдпрд╛рдУрдВ рдореЗрдВ рд╕реЗ 28 рд╕рд░рдгрд┐рдпрд╛рдБ рд╣реЛрдВрдЧреА, рдЬреЛ рдкреНрд░рддреНрдпреЗрдХ рдорд╣реАрдиреЗ рдХреА рдКрдБрдЪрд╛рдИ рдХреЗ рд▓рд┐рдП рдЬрд╝рд┐рдореНрдореЗрджрд╛рд░ рд╣реИрдВ: </p><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-function">function </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCycle</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">label: number, week: number</span></span></span><span class="hljs-function">): ReadonlyArray&lt;ReadonlyArray&lt;number&gt;&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Array.<span class="hljs-keyword"><span class="hljs-keyword">from</span></span>({length: <span class="hljs-number"><span class="hljs-number">28</span></span>}, (_, i) =&gt; Array.<span class="hljs-keyword"><span class="hljs-keyword">from</span></span>( {length: <span class="hljs-number"><span class="hljs-number">12</span></span>}, (_, month) =&gt; label + weekCount(i, month) * week, ), ); }</code> </pre> <br><p>  рдЗрдирдкреБрдЯ рдореЗрдВ, рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдорд╣реАрдиреЗ рдХреЗ рд╢реАрд░реНрд╖рдХ рдХреА рдКрдВрдЪрд╛рдИ рдФрд░ рдПрдХ рд╕рдкреНрддрд╛рд╣ рдХреА рдКрдВрдЪрд╛рдИ (64 рдФрд░ 48 рдкрд┐рдХреНрд╕рд▓, рдХреНрд░рдорд╢рдГ рдКрдкрд░ рдЬреАрдЖрдИрдПрдл рдХреЗ рд▓рд┐рдП) рдкреНрд░рд╛рдкреНрдд рд╣реЛрддреА рд╣реИред  рдПрдХ рдорд╣реАрдиреЗ рдореЗрдВ рд╣рдлреНрддреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рд╣рдореЗрдВ рдЗрд╕ рддрд░рд╣ рдХреЗ рдПрдХ рд╕рд░рд▓ рдХрд╛рд░реНрдп рдХреА рдЧрдгрдирд╛ рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░реЗрдЧреА: </p><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-function">function </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">weekCount</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">year: number, month: number</span></span></span><span class="hljs-function">): number</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> firstOfMonth = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Date(year + STARTING_YEAR, month, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> lastOfMonth = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Date(year + STARTING_YEAR, month + <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> days = lastOfMonth.getDate() + (firstOfMonth.getDay() || <span class="hljs-number"><span class="hljs-number">7</span></span>) - <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Math.ceil(days / <span class="hljs-number"><span class="hljs-number">7</span></span>); }</code> </pre> <br><p>  рдкрд░рд┐рдгрд╛рдо рд╕реНрдерд┐рд░ <code>const CYCLE = getCycle(64, 48);</code> рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИ <code>const CYCLE = getCycle(64, 48);</code>  ред </p><br><p>  рд╣рдо рдПрдХ рдлрд╝рдВрдХреНрд╢рди рд▓рд┐рдЦреЗрдВрдЧреЗ рдЬреЛ рдЖрдкрдХреЛ рдЪрдХреНрд░ рдХреЗ рдЕрдВрджрд░ рд╡рд░реНрд╖ рдФрд░ рдорд╣реАрдиреЗ рджреНрд╡рд╛рд░рд╛ рдКрдВрдЪрд╛рдИ рдХреА рдЧрдгрдирд╛ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ: </p><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-function">function </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reduceCycle</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">lastYear: number = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">28</span></span></span></span><span class="hljs-function"><span class="hljs-params">, lastMonth: number = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">12</span></span></span></span></span><span class="hljs-function">): number</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> CYCLE.reduce( (total, year, yearIndex) =&gt; yearIndex &lt;= lastYear ? total + year.reduce( (sum, month, monthIndex) =&gt; yearIndex &lt; lastYear || (yearIndex === lastYear &amp;&amp; monthIndex &lt; lastMonth) ? sum + month : sum, <span class="hljs-number"><span class="hljs-number">0</span></span>, ) : total, <span class="hljs-number"><span class="hljs-number">0</span></span>, ); }</code> </pre> <br><p>  рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рддрд░реНрдХреЛрдВ рдХреЗ рдмрд┐рдирд╛ рдХреЙрд▓ рдХрд░рдиреЗ рд╕реЗ, рд╣рдореЗрдВ рдПрдХ рдЪрдХреНрд░ рдХрд╛ рдЖрдХрд╛рд░ рдорд┐рд▓рддрд╛ рд╣реИ, рдФрд░ рднрд╡рд┐рд╖реНрдп рдореЗрдВ рд╣рдо рдЕрдкрдиреА рд╕реАрдорд╛ рд╕реЗ рдХрд┐рд╕реА рднреА рд╡рд░реНрд╖ рдХреЗ рдХрд┐рд╕реА рднреА рдорд╣реАрдиреЗ рдХреЗ рд▓рд┐рдП рдХрдВрдЯреЗрдирд░ рдХреЗ рд╢реАрд░реНрд╖ рд╕реЗ рдЗрдВрдбреЗрдВрдЯ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред </p><br><h2 id="virtualscrollstrategy">  VirtualScrollStrategy </h2><br><p>  рдЖрдк рдЯреЛрдХрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдкрдиреА рд░рдгрдиреАрддрд┐ рдХреЛ рд╡рд░реНрдЪреБрдЕрд▓ рд╕реНрдХреНрд░реЙрд▓ рдореЗрдВ рд╕рдмрдорд┐рдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ <br>  <code>VIRTUAL_SCROLL_STRATEGY</code> : </p><br><pre> <code class="cs hljs">{ provide: VIRTUAL_SCROLL_STRATEGY, useClass: MobileCalendarStrategy, },</code> </pre> <br><p>  рд╣рдорд╛рд░реА рдХрдХреНрд╖рд╛ рдХреЛ <code>VirtualScrollStrategy</code> рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рд▓рд╛рдЧреВ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП: </p><br><pre> <code class="cs hljs">export <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">VirtualScrollStrategy</span></span> { scrolledIndexChange: Observable&lt;number&gt;; attach(viewport: CdkVirtualScrollViewport): <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>; detach(): <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>; onContentScrolled(): <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>; onDataLengthChanged(): <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>; onContentRendered(): <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>; onRenderedOffsetChanged(): <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>; scrollToIndex(index: number, behavior: ScrollBehavior): <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>; }</code> </pre> <br><p>  <code>attach</code> рдФрд░ <code>detach</code> рдлрд╝рдВрдХреНрд╢рдВрд╕ рд╢реБрд░реВ рдХрд░рдиреЗ рдФрд░ рдмрдВрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИрдВред  рд╣рдорд╛рд░реЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг <code>onContentScrolled</code> рдкрджреНрдзрддрд┐ рдХреЛ рд╣рд░ рдмрд╛рд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдХрдВрдЯреЗрдирд░ рдХреЛ рд╕реНрдХреНрд░реЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ (рдЕрдирд╛рд╡рд╢реНрдпрдХ <code>requestAnimationFrame</code> рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЕрдирд╛рд╡рд╢реНрдпрдХ рдХреЙрд▓ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдВрддрд░рд┐рдХ рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ)ред </p><br><p>  <code>onDataLengthChanged</code> рдХреЛ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрдм <code>onDataLengthChanged</code> рдореЗрдВ рддрддреНрд╡реЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдмрджрд▓ рдЧрдИ рд╣реИ - рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдРрд╕рд╛ рдХрднреА рдирд╣реАрдВ рд╣реЛрдЧрд╛ред  рдПрдХ рдирд┐рдпрдо рдХреЗ рд░реВрдк рдореЗрдВ, рдРрд╕реА рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рдХреБрд▓ рдКрдВрдЪрд╛рдИ рдФрд░ рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдкреНрд░рджрд░реНрд╢рд┐рдд рддрддреНрд╡реЛрдВ рдХреЛ рдлрд┐рд░ рд╕реЗ <code>attach</code> рдЖрд╡рд╢реНрдпрдХ рд╣реЛрдЧрд╛, рд▓рдЧрднрдЧ рд╡рд╣реА рдЬреЛ <code>attach</code> рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред </p><br><p>  <code>onContentRendered</code> рдФрд░ <code>onRenderedOffsetChanged</code> рдХреЛ рддрдм рдмреБрд▓рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрдм рддрддреНрд╡реЛрдВ рдХрд╛ рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣рд┐рд╕реНрд╕рд╛ рдмрджрд▓рддрд╛ рд╣реИ рдФрд░ рдкрд╣рд▓реЗ рддрддреНрд╡ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рд╣реЛрддрд╛ рд╣реИред  <code>CdkVirtualScrollViewport</code> рдЗрди рд╡рд┐рдзрд┐рдпреЛрдВ рддрдХ рдкрд╣реБрдБрдЪрддрд╛ рд╣реИ рдЬрдм рдЗрд╕реЗ рдкреНрд░рджрд░реНрд╢рд┐рдд рд╡рд╕реНрддреБрдУрдВ рдХреА рдПрдХ рдирдИ рд╢реНрд░реЗрдгреА рджреА рдЬрд╛рддреА рд╣реИ рдФрд░ рдХреНрд░рдорд╢рдГ рдЙрдирдореЗрдВ рд╕реЗ рдкрд╣рд▓реЗ рдХреЗ рд▓рд┐рдП рдЗрдВрдбреЗрдВрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рд╣рдореЗрдВ рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╣рд╛рде рд╕реЗ <code>CdkVirtualScrollViewport</code> рддрд░реАрдХреЛрдВ рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреА рдХреЛрдИ рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред  рдпрджрд┐ рдЖрдкрдХреЛ рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рддреЛ <code>onContentRendered</code> рдЕрдВрджрд░ рдЖрдк рдПрдХ рдирдП рдЗрдВрдбреЗрдВрдЯ рдХреА рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ <code>onRenderedOffsetChanged</code> - рдЗрд╕рдХреЗ рд╡рд┐рдкрд░реАрдд, рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рдЗрдВрдбреЗрдВрдЯ рдХреЗ рд▓рд┐рдП рджреГрд╢реНрдп рддрддреНрд╡реЛрдВ рдХреА рд╢реНрд░реЗрдгреАред </p><br><p>  рд╣рдорд╛рд░реЗ рд▓рд┐рдП рджреВрд╕рд░реА рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╡рд┐рдзрд┐ - <code>scrollToIndex</code> - рдЖрдкрдХреЛ рдХрдВрдЯреЗрдирд░ рдХреЛ рд╡рд╛рдВрдЫрд┐рдд рддрддреНрд╡ рддрдХ рд╕реНрдХреНрд░реЙрд▓ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ, рдФрд░ рдЗрд╕рдХреЗ рд╡рд┐рдкрд░реАрдд - <code>scrolledIndexChange</code> - рд╡рд░реНрддрдорд╛рди рджреГрд╢реНрдп рддрддреНрд╡ рдХреЛ рдЯреНрд░реИрдХ рдХрд░рдирд╛ рд╕рдВрднрд╡ рдмрдирд╛ рджреЗрдЧрд╛ред </p><br><p>  рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рд╕рднреА рд╕рд░рд▓ рддрд░реАрдХреЛрдВ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд░реЗрдВрдЧреЗ, рдФрд░ рдлрд┐рд░ рдореБрдЦреНрдп рдХреЛрдб рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВрдЧреЗ: </p><br><pre> <code class="cs hljs">export <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MobileCalendarStrategy</span></span> <span class="hljs-title"><span class="hljs-title">implements</span></span> <span class="hljs-title"><span class="hljs-title">VirtualScrollStrategy</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> index$ = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Subject&lt;number&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> viewport: CdkVirtualScrollViewport | <span class="hljs-literal"><span class="hljs-literal">null</span></span> = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; scrolledIndexChange = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.index$.pipe(distinctUntilChanged()); attach(viewport: CdkVirtualScrollViewport) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.viewport = viewport; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.viewport.setTotalContentSize(CYCLE_HEIGHT * <span class="hljs-number"><span class="hljs-number">7</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.updateRenderedRange(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.viewport); } detach() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.index$.complete(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.viewport = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } onContentScrolled() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.viewport) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.updateRenderedRange(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.viewport); } } scrollToIndex(index: number, behavior: ScrollBehavior): <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.viewport) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.viewport.scrollToOffset(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getOffsetForIndex(index), behavior); } } <span class="hljs-comment"><span class="hljs-comment">// ... }</span></span></code> </pre> <br><p>  рд╕реНрдХреНрд░реЙрд▓ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдЗрдВрдбреЗрдВрдЯ рджреНрд╡рд╛рд░рд╛ рддрддреНрд╡ рдХреЗ рдЗрдВрдбреЗрдХреНрд╕ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдФрд░ рдЗрд╕рдХреЗ рд╡рд┐рдкрд░реАрдд рдЗрдВрдбреЗрдХреНрд╕ рджреНрд╡рд╛рд░рд╛ рдЗрдВрдбреЗрдВрдЯ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  рд╣рдорд╛рд░реЗ рджреНрд╡рд╛рд░рд╛ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рдХрд╛рд░реНрдп <code>reduceCycle</code> рдкрд╣рд▓реЗ рдХрд╛рд░реНрдп рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рд╣реИ: </p><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getOffsetForIndex</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">index: number</span></span></span><span class="hljs-function">): number</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> month = index % <span class="hljs-number"><span class="hljs-number">12</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> year = (index - month) / <span class="hljs-number"><span class="hljs-number">12</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.computeHeight(year, month); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">computeHeight</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">year: number, month: number</span></span></span><span class="hljs-function">): number</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> remainder = year % <span class="hljs-number"><span class="hljs-number">28</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> remainderHeight = reduceCycle(remainder, month); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> fullCycles = (year - remainder) / <span class="hljs-number"><span class="hljs-number">28</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> fullCyclesHeight = fullCycles * CYCLE_HEIGHT; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fullCyclesHeight + remainderHeight; }</code> </pre> <br><p>  рдпрд╣реА рд╣реИ, рдЗрдВрдбреЗрдХреНрд╕ рджреНрд╡рд╛рд░рд╛ рдКрдВрдЪрд╛рдИ рдкрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдкрд╛рддреЗ рд╣реИрдВ рдХрд┐ рдХрд┐рддрдиреЗ рдкреВрд░реНрдг 28 рд╕рд╛рд▓ рдХреЗ рдЪрдХреНрд░ рд╡рд░реНрддрдорд╛рди рддрд╛рд░реАрдЦ рдХреЗ рд▓рд┐рдП рдлрд┐рдЯ рд╣реИрдВ, рдФрд░ рдлрд┐рд░ рд╣рдо рджрд┐рдП рдЧрдП рдорд╣реАрдиреЗ рддрдХ рдЕрдкрдиреЗ рд╕рд░рдгреА рдХреЛ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВред  рд░рд┐рд╡рд░реНрд╕ рдСрдкрд░реЗрд╢рди рдХреБрдЫ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣реИ: </p><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIndexForOffset</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">offset: number</span></span></span><span class="hljs-function">): number</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> remainder = offset % CYCLE_HEIGHT; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> years = ((offset - remainder) / CYCLE_HEIGHT) * <span class="hljs-number"><span class="hljs-number">28</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> accumulator = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> year = <span class="hljs-number"><span class="hljs-number">0</span></span>; year &lt; CYCLE.length; year++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> month = <span class="hljs-number"><span class="hljs-number">0</span></span>; month &lt; CYCLE[year].length; month++) { accumulator += CYCLE[year][month]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (accumulator - CYCLE[year][month] / <span class="hljs-number"><span class="hljs-number">2</span></span> &gt; remainder) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Math.max((years + year) * MONTHS_IN_YEAR + month, <span class="hljs-number"><span class="hljs-number">0</span></span>); } } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">196</span></span>; }</code> </pre> <br><p>  рдЬрдм рд╣рдо рдкреВрд░реНрдг 28-рд╡рд░реНрд╖реАрдп рдЪрдХреНрд░реЛрдВ рдХреА рдХреБрд▓ рдКрдВрдЪрд╛рдИ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рд╕рднреА рдорд╣реАрдиреЛрдВ рдХреА рдХреБрд▓ рдКрдВрдЪрд╛рдИ рдХреЛ рдЗрдХрдЯреНрдард╛ рдХрд░рддреЗ рд╣реБрдП, рд╕рд░рдгреА рдкрд░ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдХрд░реЗрдВрдЧреЗ, рдЬрдм рддрдХ рдХрд┐ рдпрд╣ рд╡рд╛рдВрдЫрд┐рдд рдЗрдВрдбреЗрдВрдЯ рд╕реЗ рдЕрдзрд┐рдХ рди рд╣реЛ рдЬрд╛рдПред  рдЙрд╕реА рд╕рдордп, рд╣рдо рди рдХреЗрд╡рд▓ рдЙрдЪреНрдЪрддрдо рджреГрд╢реНрдпрдорд╛рди рдорд╣реАрдиреЗ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рддреНрдпреЗрдХ рдорд╣реАрдиреЗ ( <code>CYCLE[year][month] / 2</code> ) рдХреА рдЖрдзреА рд╕реЗ рдЕрдзрд┐рдХ рдКрдВрдЪрд╛рдИ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВрдЧреЗ, рд▓реЗрдХрд┐рди рдКрдкрд░реА рд╕реАрдорд╛ рдХреЗ рд╕рдмрд╕реЗ рдХрд░реАрдмред  рд╕реНрдХреНрд░реЙрд▓ рдкреВрд░рд╛ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдорд╣реАрдиреЗ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдЪрд┐рдХрдиреА рдШреБрдорд╛ рдХреЗ рд▓рд┐рдП рднрд╡рд┐рд╖реНрдп рдореЗрдВ рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред </p><br><p>  рдпрд╣ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдХрд╛рд░реНрдп рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛ рд╣реБрдЖ рд╣реИ рдЬреЛ рджреГрд╢реНрдп рдХреНрд╖реЗрддреНрд░ рдХреЗ рддрддреНрд╡реЛрдВ рдХреЛ рдкреНрд░рд╕реНрддреБрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИ: </p><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">updateRenderedRange</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">viewport: CdkVirtualScrollViewport</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> offset = viewport.measureScrollOffset(); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> viewportSize = viewport.getViewportSize(); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> {start, end} = viewport.getRenderedRange(); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> dataLength = viewport.getDataLength(); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> newRange = {start, end}; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> firstVisibleIndex = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getIndexForOffset(offset); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> startBuffer = offset - <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getOffsetForIndex(start); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (startBuffer &lt; BUFFER &amp;&amp; start !== <span class="hljs-number"><span class="hljs-number">0</span></span>) { newRange.start = Math.max(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getIndexForOffset(offset - BUFFER * <span class="hljs-number"><span class="hljs-number">2</span></span>)); newRange.end = Math.min( dataLength, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getIndexForOffset(offset + viewportSize + BUFFER), ); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> endBuffer = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getOffsetForIndex(end) - offset - viewportSize; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (endBuffer &lt; BUFFER &amp;&amp; end !== dataLength) { newRange.start = Math.max(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getIndexForOffset(offset - BUFFER)); newRange.end = Math.min( dataLength, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getIndexForOffset(offset + viewportSize + BUFFER * <span class="hljs-number"><span class="hljs-number">2</span></span>), ); } } viewport.setRenderedRange(newRange); viewport.setRenderedContentOffset(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getOffsetForIndex(newRange.start)); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.index$.next(firstVisibleIndex); }</code> </pre> <br><p>  рдЪрд▓реЛ рд╕рдм рдХреБрдЫ рдХреНрд░рдо рдореЗрдВ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВред </p><br><p>  рд╣рдо рд╡рд░реНрддрдорд╛рди рдЗрдВрдбреЗрдВрдЯреЗрд╢рди, рдХрдВрдЯреЗрдирд░ рдЖрдХрд╛рд░, рджрд┐рдЦрд╛рдП рдЧрдП рд╡рд░реНрддрдорд╛рди рд░реЗрдВрдЬ рдФрд░ рд╡рд╕реНрддреБрдУрдВ рдХреА рдХреБрд▓ рд╕рдВрдЦреНрдпрд╛ рдХреЗ <code>CdkVirtualScrollViewport</code> рдкреВрдЫрддреЗ рд╣реИрдВред  рддрдм рд╣рдо рдкрд╣рд▓реЗ рджрд┐рдЦрд╛рдИ рджреЗрдиреЗ рд╡рд╛рд▓реЗ рддрддреНрд╡ рдФрд░ рдмрд╣реБрдд рдкрд╣рд▓реЗ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рддрддреНрд╡ рдкрд░ рдЗрдВрдбреЗрдВрдЯ рдкрд╛рддреЗ рд╣реИрдВред </p><br><p>  рдЙрд╕рдХреЗ рдмрд╛рдж, рд╣рдореЗрдВ рдпрд╣ рд╕рдордЭрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ рд╡рд░реНрддрдорд╛рди рддрддреНрд╡реЛрдВ рдХреА рд╕реАрдорд╛ рдХреЛ рдХреИрд╕реЗ рдмрджрд▓рдирд╛ рд╣реИ рдФрд░ рдЙрдирдореЗрдВ рд╕реЗ рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ рдЗрдВрдбреЗрдВрдЯ рдХрд░рдирд╛ рд╣реИ, рддрд╛рдХрд┐ рд╡рд░реНрдЪреБрдЕрд▓ рд╕реНрдХреНрд░реЙрд▓ рддрддреНрд╡реЛрдВ рдХреЛ рд╕реБрдЪрд╛рд░реВ рд░реВрдк рд╕реЗ рд▓реЛрдб рдХрд░ рд╕рдХреЗ рдФрд░ рдКрдВрдЪрд╛рдИ рдХреЛ рдкреБрди: рдЧрдгрдирд╛ рдХрд░рддреЗ рд╕рдордп рдЪрд┐рдХреЛрдЯреА рди рд╣реЛред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ <code>BUFFER</code> рд╕реНрдерд┐рд░рд╛рдВрдХ рд╣реИ, рдЬреЛ <code>BUFFER</code> рдХрд┐ рд╣рдо рджрд┐рдЦрд╛рдИ рджреЗрдиреЗ рд╡рд╛рд▓реЗ рддрддреНрд╡реЛрдВ рд╕реЗ рдХрд┐рддрдиреЗ рдкрд┐рдХреНрд╕реЗрд▓ рдКрдкрд░ рдФрд░ рдиреАрдЪреЗ рджрд┐рдЦрд╛рдИ рджреЗрддреЗ рд╣реИрдВред  рдореЗрд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдореИрдВ 500px рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реВрдВред  рдпрджрд┐ рд╢реАрд░реНрд╖ рдЗрдВрдбреЗрдВрдЯ рдмрдлрд░ рд╕реЗ рдЫреЛрдЯрд╛ рд╣реИ рдФрд░ рдКрдкрд░ рдЕрдзрд┐рдХ рддрддреНрд╡ рд╣реИрдВ, рддреЛ рд╣рдо рдмрдлрд░ рдХреЛ рдбрдмрд▓ рдХрд╡рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╢реАрд░реНрд╖ рдкрд░ рдкрд░реНрдпрд╛рдкреНрдд рддрддреНрд╡ рдЬреЛрдбрд╝рдХрд░ рд╕реАрдорд╛ рдмрджрд▓ рджреЗрдВрдЧреЗред  рд╣рдо рд╕реАрдорд╛ рдХреЗ рдЕрдВрдд рдХреЛ рднреА рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░рддреЗ рд╣реИрдВред  рдЪреВрдВрдХрд┐ рд╣рдо рдКрдкрд░ рд╕реНрдХреНрд░реЙрд▓ рдХрд░рддреЗ рд╣реИрдВ - рдПрдХ рдмрдлрд╝рд░ рд╕рдмрд╕реЗ рдиреАрдЪреЗ рд╣реИред  рдПрдХ рд╣реА рдмрд╛рдд рд╣реИ, рд▓реЗрдХрд┐рди рд╡рд┐рдкрд░реАрдд рджрд┐рд╢рд╛ рдореЗрдВ рд╣рдо рдиреАрдЪреЗ рд╕реНрдХреНрд░реЙрд▓ рдХрд░рддреЗ рд╕рдордп рдкреНрд░рджрд░реНрд╢рди рдХрд░рддреЗ рд╣реИрдВред </p><br><p>  рдлрд┐рд░ рд╣рдо <code>CdkVirtualScrollViewport</code> рдирдИ рд╢реНрд░реЗрдгреА рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕рдХреЗ рдкрд╣рд▓реЗ рддрддреНрд╡ рдХреЗ рд▓рд┐рдП рдЗрдВрдбреЗрдВрдЯ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░рддреЗ рд╣реИрдВред  рд╡рд░реНрддрдорд╛рди рджреГрд╢реНрдпрдорд╛рди рд╕реВрдЪрдХрд╛рдВрдХ рдХреЛ рдкрд╛рд╕ рдХрд░реЗрдВред </p><br><h2 id="ispolzovanie">  рдХреЗ рдЙрдкрдпреЛрдЧ </h2><br><p>  рд╣рдорд╛рд░реА рд░рдгрдиреАрддрд┐ рддреИрдпрд╛рд░ рд╣реИред  рдШрдЯрдХ рдкреНрд░рджрд╛рддрд╛рдУрдВ рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ, рдЬреИрд╕рд╛ рдХрд┐ рдКрдкрд░ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдФрд░ рдЯреЗрдореНрдкрд▓реЗрдЯ рдореЗрдВ <code>CdkVirtualScrollViewport</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ: </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cdk-virtual-scroll-viewport</span></span></span><span class="hljs-tag"> (</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">scrolledIndexChange</span></span></span><span class="hljs-tag">)=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"activeMonth = $event"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">section</span></span></span><span class="hljs-tag"> *</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">cdkVirtualFor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"let month of months; templateCacheSize: 10"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>{{month.name}}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">our-calendar</span></span></span><span class="hljs-tag"> [</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">month</span></span></span><span class="hljs-tag">]=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"month"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">our-calendar</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">section</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cdk-virtual-scroll-viewport</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  рдпрд╣ рд╕реНрдХреНрд░реЙрд▓ рдХреЗ рдЕрдВрдд рдореЗрдВ рдЕрдЧрд▓реЗ рдорд╣реАрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЪрд┐рдХрдиреА рдореЛрдбрд╝ рдХрд╛ рдПрд╣рд╕рд╛рд╕ рдХрд░рддрд╛ рд╣реИред  рдмрд╛рд░реАрдХрд┐рдпрд╛рдВ рд╣реИрдВред </p><br><p>  рддрдереНрдп рдпрд╣ рд╣реИ рдХрд┐ рдЙрдВрдЧрд▓реА рдЬрд╛рд░реА рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдореЛрдмрд╛рдЗрд▓ рдЙрдкрдХрд░рдгреЛрдВ рдкрд░ рд╕реНрдХреНрд░реЙрд▓ рдХрд░рдирд╛ рдЬрд╛рд░реА рд░рд╣рддрд╛ рд╣реИред  рдЗрд╕рд▓рд┐рдП, рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдЙрд╕ рдкрд▓ рдХреЛ рд╕рдордЭрдирд╛ рдореБрд╢реНрдХрд┐рд▓ рд╣реЛрдЧрд╛ рдЬрдм рдЪрд╛рд▓реВ рдорд╣реАрдиреЗ рдХреЛ рд╕рдВрд░реЗрдЦрд┐рдд рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реЛред  рдЗрд╕рдХреЗ рд▓рд┐рдП рд╣рдо RxJs рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  <code>touchstart</code> рдИрд╡реЗрдВрдЯ рдХреА <code>touchstart</code> рдФрд░ рдЕрдЧрд▓реЗ <code>touchend</code> рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рддреЗ рд╣реИрдВред  рдЗрд╕рдХреА рд╢реБрд░реБрдЖрдд рдХреЗ рдмрд╛рдж, рд╣рдо рдпрд╣ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рджреМрдбрд╝ рдСрдкрд░реЗрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рд╕реНрдХреНрд░реЙрд▓ рдЬрд╛рд░реА рд╣реИ, рдпрд╛ рдпрджрд┐ рдЙрдВрдЧрд▓реА рдмрд┐рдирд╛ рддреНрд╡рд░рдг рдХреЗ рдЬрд╛рд░реА рдХреА рдЧрдИ рдереАред  рдпрджрд┐ <code>SCROLL_DEBOUNCE_TIME</code> рдЕрд╡рдзрд┐ рдХреЗ рджреМрд░рд╛рди рдХреЛрдИ рд╕реНрдХреНрд░реЙрд▓ рдИрд╡реЗрдВрдЯ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╣рдо рд╡рд░реНрддрдорд╛рди рдорд╣реАрдиреЗ рдХреЛ рд╕рдВрд░реЗрдЦрд┐рдд рдХрд░рддреЗ рд╣реИрдВред  рдЕрдиреНрдпрдерд╛, рд╣рдо рддрдм рддрдХ рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рддреЗ рд╣реИрдВ рдЬрдм рддрдХ рдЕрд╡рд╢рд┐рд╖реНрдЯ рд╕реНрдХреНрд░реЙрд▓ рдмрдВрдж рдирд╣реАрдВ рд╣реЛ рдЬрд╛рддрд╛ред  рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдЖрдкрдХреЛ <code>takeUntil(touchstart$)</code> рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЬрдбрд╝рддреНрд╡реАрдп рд╕реНрдХреНрд░реЙрд▓ рдХреЛ рдПрдХ рдирдП рд╕реНрдкрд░реНрд╢ рдХреЗ рд╕рд╛рде рд░реЛрдХрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдкреВрд░реА рдзрд╛рд░рд╛ рдХреЛ рд╢реБрд░реБрдЖрдд рдореЗрдВ рд╡рд╛рдкрд╕ рдЖрдирд╛ рдЪрд╛рд╣рд┐рдП: </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> touchstart$ = touchStartFrom(monthsScrollRef.elementRef.nativeElement); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> touchend$ = touchEndFrom(monthsScrollRef.elementRef.nativeElement); <span class="hljs-comment"><span class="hljs-comment">// Smooth scroll to closest month after scrolling is done touchstart$ .pipe( switchMap(() =&gt; touchend$), switchMap(() =&gt; race( monthsScrollRef.elementScrolled(), timer(SCROLL_DEBOUNCE_TIME), ).pipe( debounceTime(SCROLL_DEBOUNCE_TIME * 2), take(1), takeUntil(touchstart$), ), ), takeUntil(this.destroy$), ) .subscribe(() =&gt; { monthsScrollRef.scrollToIndex(this.activeMonth, 'smooth'); });</span></span></code> </pre> <br><p>  рдпрд╣рд╛рдВ рдпрд╣ рдзреНрдпрд╛рди рджрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ <code>scrollToIndex</code> рд╕реАрдбреАрдХреЗ рдореЗрдВ рд╕реНрдХреНрд░реЙрд▓рд┐рдВрдЧ <code>scrollToIndex</code> рдХреЗ рд▓рд┐рдП рдПрдХ рджреЗрд╢реА рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдпрд╣ рд╕рдлрд╛рд░реА рдореЗрдВ рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред  рдЖрдк рдЗрд╕реЗ рд╕реНрдХреНрд░реЙрд▓ рдХрд░рдХреЗ рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВред рд╣рдорд╛рд░реЗ рджреНрд╡рд╛рд░рд╛ рд╕реНрдХреНрд░реЙрд▓ <code>requestAnimationFrame</code> рдЧрдП рд░рдгрдиреАрддрд┐ рдХреЗ рдЕрдВрджрд░ рд╣рдордиреЗ рдЬреЛ рд░рдгрдиреАрддрд┐ <code>requestAnimationFrame</code> рд╣реИ, <code>requestAnimationFrame</code> рдЕрдВрджрд░ <code>requestAnimationFrame</code> рдорд╛рдзреНрдпрдо рд╕реЗ рдЕрдкрдиреА рдЪрд┐рдХрдиреА рд╕реНрдХреНрд░реЙрд▓ рд▓рд┐рдЦрдХрд░ред </p><br><h2 id="vyvod">  рдирд┐рд╖реНрдХрд░реНрд╖ </h2><br><p>  DI рдФрд░ Angular рдЯреАрдо рдХреА рд╕рдордЭрджрд╛рд░реА рдХреА рдмрджреМрд▓рдд, рд╣рдо рдЕрдкрдиреЗ рд▓рд┐рдП рд╡рд░реНрдЪреБрдЕрд▓ рд╕реНрдХреНрд░реЙрд▓ рдХреЛ рд▓рдЪреАрд▓реЗ рдврдВрдЧ рд╕реЗ рдХрд╕реНрдЯрдорд╛рдЗрдЬрд╝ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдереЗред  рдкрд╣рд▓реА рдирдЬрд╝рд░ рдореЗрдВ, рдЕрд▓рдЧ-рдЕрд▓рдЧ рдКрдВрдЪрд╛рдЗрдпреЛрдВ рд╡рд╛рд▓реЗ рддрддреНрд╡реЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдЖрднрд╛рд╕реА рд╕реНрдХреНрд░реЙрд▓ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдирд╛ рдПрдХ рдХрдард┐рди рдХрд╛рдо рдХреА рддрд░рд╣ рд▓рдЧрддрд╛ рд╣реИред </p><br><p>  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЬрдм рдкреНрд░рддреНрдпреЗрдХ рддрддреНрд╡ рдХреА рдКрдВрдЪрд╛рдИ рдХреА рдЧрдгрдирд╛ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ, рддреЛ рдЖрдкрдХреА рд░рдгрдиреАрддрд┐ рд▓рд┐рдЦрдирд╛ рдХрд╛рдлреА рд╕рд░рд▓ рд╣реЛ рдЧрдпрд╛ред  рдореБрдЦреНрдп рдмрд╛рдд рдпрд╣ рд╣реИ рдХрд┐ рдпрд╣ рдЧрдгрдирд╛ рдЬрд▓реНрджреА рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕реЗ рдЕрдХреНрд╕рд░ рдХрд╣рд╛ рдЬрд╛рдПрдЧрд╛ред  рдпрджрд┐ рдЖрдкрдХреЛ рдмрдбрд╝реА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдХрд╛рд░реНрдб рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЬрд┐рд╕ рдкрд░ рдЙрдирдХреА рдКрдВрдЪрд╛рдИ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рддрддреНрд╡ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдКрдВрдЪрд╛рдИ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреНрд░рднрд╛рд╡реА рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ рдФрд░ рдЕрдкрдиреА рд░рдгрдиреАрддрд┐ рд▓рд┐рдЦрдиреЗ рд╕реЗ рдбрд░реЛ рдорддред </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi484168/">https://habr.com/ru/post/hi484168/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi484152/index.html">рд╣рд╛рдИ рд╕реНрдкреАрдб рдкреАрдПрд╕реА рдирд┐рдпрдВрддреНрд░рдХ WISE-5580</a></li>
<li><a href="../hi484154/index.html">рдбрд╛рдпреЛрдлреИрдВрдЯреАрди рд╕рдореАрдХрд░рдгреЛрдВ рдХреА рдкреНрд░рдгрд╛рд▓реА рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреА рд╡рд┐рдзрд┐</a></li>
<li><a href="../hi484160/index.html">рдорд╛рдпрд╛рд╡реА рдкреНрд░рддрд┐рднрд╛: рд░реВрд╕ рд▓реЙрд╕ рдмреЗрд╕реНрдЯ рдЖрдИрдЯреА рдкреЗрд╢реЗрд╡рд░</a></li>
<li><a href="../hi484164/index.html">рдкреБрд╕реНрддрдХреЛрдВ рдХрд╛ рдЗрддрд┐рд╣рд╛рд╕ рдФрд░ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХрд╛ рднрд╡рд┐рд╖реНрдп</a></li>
<li><a href="../hi484166/index.html">VVVVVV ??? VVVVVV !!! :)</a></li>
<li><a href="../hi484170/index.html">R77.30 рд╕реЗ 80.20 рддрдХ рдЪреЗрдХ рдкреНрд╡рд╛рдЗрдВрдЯ рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВ</a></li>
<li><a href="../hi484172/index.html">рдПрдХрддрд╛ рдореЗрдВ рдирд┐рд░рдВрддрд░ рдПрдХреАрдХрд░рдг: рдПрдХ рдЙрдкрд╣рд╛рд░ рдХреЗ рд░реВрдк рдореЗрдВ рд╡рд┐рдзрд╛рдирд╕рднрд╛ рдХреЗ рд╕рдордп рдХреЛ рдХрдо рдХрд░рдиреЗ рдФрд░ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдмрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдП + рдХреИрд╕реЗ</a></li>
<li><a href="../hi484174/index.html">"рдЪрд░рдо" рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рдпрд╛ рдЬрдм рд╣рдордиреЗ "DOZOR" рд╢реЛ рдореЗрдВ рднрд╛рдЧ рд▓рд┐рдпрд╛, рддрдм рдХреИрд╕рд▓ рдкреАрдирд╛</a></li>
<li><a href="../hi484176/index.html">рдПрдХрддрд╛ рдореЗрдВ рд╕реНрдерд┐рддрд┐ рдЯреЗрдореНрдкрд▓реЗрдЯ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдирд╛</a></li>
<li><a href="../hi484178/index.html">рдЧреНрд░рд╣ рдкреГрдереНрд╡реА рдХреЗ рд▓рд┐рдП рдмреБрджреНрдзрд┐рдорд╛рди рдИрдерд░рдиреЗрдЯ рд╕реНрд╡рд┐рдЪ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>