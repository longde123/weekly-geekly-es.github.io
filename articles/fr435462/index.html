<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õ≥Ô∏è üç∑ üÜö Test des projets Node.js. Partie 1. Anatomie d'essai et types d'essai ü§Ωüèø üéä ‚ôæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'auteur du mat√©riel, dont nous publions aujourd'hui la premi√®re partie de la traduction, dit qu'en tant que consultant ind√©pendant sur Node.js, il an...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Test des projets Node.js. Partie 1. Anatomie d'essai et types d'essai</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/435462/">  L'auteur du mat√©riel, dont nous publions aujourd'hui la premi√®re partie de la traduction, dit qu'en tant que consultant ind√©pendant sur Node.js, il analyse plus de 10 projets chaque ann√©e.  Ses clients, ce qui est tout √† fait justifi√©, lui demandent de porter une attention particuli√®re aux tests.  Il y a quelques mois, il a commenc√© √† prendre des notes concernant les techniques de test pr√©cieuses et les erreurs qu'il a rencontr√©es.  Le r√©sultat √©tait un mat√©riel contenant trois douzaines de recommandations pour les tests. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/f16/1a0/3e2/f161a03e2b08ae35b31f718a083a39a0.jpg" alt="image"></a> <br><br>  En particulier, il se concentrera sur la s√©lection des types de tests qui conviennent √† une situation particuli√®re, sur leur conception appropri√©e, sur l'√©valuation de leur efficacit√© et sur l'endroit exact dans les cha√Ænes CI / CD dont vous avez besoin pour les placer.  Certains des exemples ici sont illustr√©s en utilisant Jest, certains en utilisant Mocha.  Ce mat√©riel est principalement ax√© non pas sur les outils, mais sur la m√©thodologie de test. <br><br>  ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Test des projets Node.js.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 2. √âvaluation des performances des tests, int√©gration continue et analyse de la qualit√© du code</a> <br><a name="habracut"></a><br><h3>  <font color="#3AC1EF">‚ñç0.</font>  <font color="#3AC1EF">R√®gle d'or: les tests doivent √™tre tr√®s simples et directs</font> </h3><br>  Connaissez-vous quelqu'un - un ami, un membre de la famille, le h√©ros du film, qui est toujours charg√© de bonne humeur et toujours pr√™t √† offrir un coup de main sans rien exiger en retour?  C'est ainsi que de bons tests doivent √™tre con√ßus.  Ils doivent √™tre simples, b√©n√©fiques et susciter des √©motions positives.  Ceci peut √™tre r√©alis√© par une s√©lection rigoureuse des m√©thodes de test, des outils et des objectifs.  Ceux dont l'utilisation justifie le temps et les efforts consacr√©s √† la pr√©paration et √† la r√©alisation des tests et donne en m√™me temps de bons r√©sultats.  Vous n'avez qu'√† tester ce qui doit √™tre test√©, vous devez vous efforcer de vous assurer que les tests sont simples et flexibles, et parfois vous pouvez refuser certains tests, sacrifiant ainsi la fiabilit√© du projet pour sa simplicit√© et sa rapidit√© de d√©veloppement. <br><br>  Les tests ne doivent pas √™tre consid√©r√©s comme du code d'application normal.  Le fait est qu'une √©quipe typique engag√©e dans le d√©veloppement d'un projet, dans tous les cas, fait tout son possible pour le maintenir en √©tat de fonctionnement, c'est-√†-dire s'efforce, disons, d'un produit commercial pour fonctionner comme l'attendent ses utilisateurs.  Par cons√©quent, une telle √©quipe peut ne pas avoir le sentiment qu'il devra soutenir un autre ¬´projet¬ª complexe repr√©sent√© par un ensemble de tests.  Si les tests du code principal se d√©veloppent, attirant de plus en plus l'attention sur eux-m√™mes et devenant une source de pr√©occupation constante, alors le travail sur eux sera soit abandonn√©, soit en essayant de maintenir un niveau d√©cent, cela leur donnera tellement de temps et d'√©nergie que cela ralentira le travail sur le projet principal. <br><br>  Par cons√©quent, le code de test doit √™tre aussi simple que possible, avec un nombre minimum de d√©pendances et de niveaux d'abstraction.  Les tests doivent ressembler pour pouvoir √™tre compris en un coup d'≈ìil.  La plupart des recommandations que nous examinerons ici d√©coulent de ce principe. <br><br><h2>  <font color="#3AC1EF">Section 1. Anatomie des tests</font> </h2><br><h3>  <font color="#3AC1EF">‚ñç1.</font>  <font color="#3AC1EF">Concevez vos tests de sorte que le rapport vous indique ce qui est test√©, dans quel sc√©nario et ce qui est attendu des tests</font> </h3><br><h4>  Recommandations </h4><br>  Le rapport de test doit indiquer si la version actuelle de l'application r√©pond √† ses exigences.  Cela doit √™tre fait sous une forme qui sera compr√©hensible pour ceux qui n'ont pas √† se familiariser avec le code d'application.  Il peut s'agir d'un testeur, d'un sp√©cialiste DevOps qui d√©ploie le projet ou du d√©veloppeur lui-m√™me, qui a examin√© le projet quelque temps apr√®s avoir √©crit son code.  Cela peut √™tre r√©alis√© si, lors de la r√©daction des tests, se concentrer sur les exigences du produit.  Avec cette approche, la structure du test peut √™tre imagin√©e en trois parties: <br><br><ol><li> Qu'est-ce qui est test√© exactement?  Par exemple, la m√©thode <code>ProductsService.addNewProduct</code> . </li><li>  Dans quel sc√©nario et dans quelles circonstances le test est-il effectu√©?  Par exemple, la r√©action du syst√®me est v√©rifi√©e dans une situation o√π le prix des marchandises n'a pas √©t√© transmis √† la m√©thode. </li><li>  Quels sont les r√©sultats des tests attendus?  Par exemple, dans une situation similaire, le syst√®me refuse de confirmer l'ajout d'un nouveau produit √† celui-ci. </li></ol><br><h4>  Cons√©quences de la d√©rogation aux recommandations </h4><br>  Supposons que le syst√®me ne puisse pas √™tre d√©ploy√©, et √† partir du rapport de test, vous pouvez seulement d√©couvrir qu'il n'a pas r√©ussi le test appel√© <code>Add product</code> , qui v√©rifie l'ajout d'un certain produit √† celui-ci.  Cela donnera-t-il des informations sur ce qui s'est exactement pass√©? <br><br><h4>  Bonne approche </h4><br>  Les informations de test se composent de trois √©l√©ments d'information. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//1.   describe('Products Service', function() { //2.  describe('Add new product', function() {   // 3. ,       it('When no price is specified, then the product status is pending approval', ()=&gt; {     const newProduct = new ProductService().add(...);     expect(newProduct.status).to.equal('pendingApproval');   }); }); });</span></span></code> </pre> <br><h4>  Bonne approche </h4><br>  Le rapport de test ressemble √† un document contenant une d√©claration des exigences du produit. <br><br>  Voici √† quoi cela ressemble √† diff√©rents niveaux. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1f3/172/8fb/1f31728fba16acd94c79d10fbcbb6c02.jpg"></div><br>  <i><font color="#999999">Document sur les exigences du produit, d√©nomination des tests, r√©sultats des tests</font></i> <br><br><ol><li>  Un document avec les exigences du produit peut √™tre, en fait, un document sp√©cial, ou il peut exister sous la forme d'un e-mail. </li><li>  Lorsque vous nommez des tests, d√©crivez l'objectif du test, son sc√©nario et les r√©sultats attendus, vous devez respecter le langage utilis√© pour formuler les exigences du produit.  Cela vous aidera √† comparer le code de test et les exigences du produit. </li><li>  Les r√©sultats des tests doivent √™tre clairs m√™me pour ceux qui ne connaissent pas le code d'application ou qui l'ont compl√®tement oubli√©.  Ce sont des testeurs, des sp√©cialistes DevOps, des d√©veloppeurs qui retournent travailler avec le code quelques mois apr√®s l'avoir √©crit. </li></ol><br><h3>  <font color="#3AC1EF">‚ñç2.</font>  <font color="#3AC1EF">D√©crivez ce que vous attendez des tests dans le langage du produit: utilisez des instructions de style BDD</font> </h3><br><h4>  Recommandations </h4><br>  Le d√©veloppement de tests dans un style d√©claratif permet √† ceux qui travaillent avec eux de saisir instantan√©ment leur essence.  Si les tests sont √©crits en utilisant une approche imp√©rative, ils sont remplis de constructions conditionnelles qui compliquent grandement leur compr√©hension.  Selon ce principe, les attentes doivent √™tre d√©crites dans un langage proche de l'ordinaire.  Le style BDD d√©claratif utilise des constructions <code>expect</code> ou <code>should</code> , plut√¥t qu'un code sp√©cial de leur propre conception.  S'il n'y a pas de d√©clarations n√©cessaires dans Chai ou Jest, et qu'il s'av√®re que de telles d√©clarations sont souvent n√©cessaires, envisagez d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ajouter de nouveaux ¬´ch√®ques¬ª √† Jest</a> ou d'√©crire vos propres <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">plugins pour Chai</a> . <br><br><h4>  Cons√©quences de la d√©rogation aux recommandations </h4><br>  Si vous ne suivez pas les recommandations d√©crites ci-dessus, cela se terminera par le fait que les membres de l'√©quipe de d√©veloppement √©criront moins de tests et <code>.skip()</code> les v√©rifications ennuyeuses √† l'aide de la m√©thode <code>.skip()</code> . <br><br><h4>  Mauvaise approche </h4><br>  Le lecteur de ce test devra examiner enti√®rement le code imp√©ratif assez long uniquement pour comprendre ce qui est test√© exactement dans le test. <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"When asking for an admin, ensure only ordered admins in results"</span></span> , ()={   <span class="hljs-comment"><span class="hljs-comment">//,       ‚Äî "admin1"  "admin2",   "user1"   const allAdmins = getUsers({adminOnly:true});   const admin1Found, adming2Found = false;   allAdmins.forEach(aSingleUser =&gt; {       if(aSingleUser === "user1"){           assert.notEqual(aSingleUser, "user1", "A user was found and not admin");       }       if(aSingleUser==="admin1"){           admin1Found = true;       }       if(aSingleUser==="admin2"){           admin2Found = true;       }   });   if(!admin1Found || !admin2Found ){       throw new Error("Not all admins were returned");   } });</span></span></code> </pre> <br><h4>  Bonne approche </h4><br>  Vous pouvez litt√©ralement comprendre ce test en un coup d'≈ìil. <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"When asking for an admin, ensure only ordered admins in results"</span></span> , ()={   <span class="hljs-comment"><span class="hljs-comment">//,        const allAdmins = getUsers({adminOnly:true});     expect(allAdmins).to.include.ordered.members(["admin1" , "admin2"]) .but.not.include.ordered.members(["user1"]); });</span></span></code> </pre> <br><h3>  <font color="#3AC1EF">‚ñç3.</font>  <font color="#3AC1EF">Effectuer des tests de code linting √† l'aide de plugins sp√©ciaux</font> </h3><br><h4>  Recommandations </h4><br>  Il existe un ensemble de plug-ins pour ESLint con√ßus sp√©cifiquement pour analyser le code de test et pour trouver des probl√®mes dans ce code.  Par exemple, le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">plug-in eslint-plugin-mocha</a> donnera des avertissements si le test est √©crit au niveau global (et n'est pas un descendant de <code>describe()</code> ), ou si les tests s'av√®rent √™tre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ignor√©s</a> , ce qui peut donner de faux espoirs que tous les tests s'av√®rent √™tre r√©ussis.  Le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">plugin eslint-plugin-jest</a> fonctionne de mani√®re similaire, par exemple, en avertissant des tests qui n'ont pas d'instructions, c'est-√†-dire de ceux qui ne v√©rifient rien. <br><br><h4>  Cons√©quences de la d√©rogation aux recommandations </h4><br>  Le d√©veloppeur sera heureux de voir que le code est couvert √† 90% dans les tests et que 100% des tests r√©ussissent.  Cependant, il ne restera dans cet √©tat que jusqu'√† ce qu'il s'av√®re que de nombreux tests, en fait, ne v√©rifient rien, et que certains scripts de test sont simplement ignor√©s.  On ne peut qu'esp√©rer que personne ne d√©ploiera des projets ¬´test√©s¬ª de cette mani√®re en production. <br><br><h4>  Mauvaise approche </h4><br>  Le sc√©nario de test est plein d'erreurs qui, heureusement, peuvent √™tre d√©tect√©es √† l'aide du linter. <br><br><pre> <code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">"Too short description"</span></span>, () =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> userToken = userService.getDefaultToken() <span class="hljs-comment"><span class="hljs-comment">// *error:no-setup-in-describe, use hooks (sparingly) instead it("Some description", () =&gt; {});//* error: valid-test-description. Must include the word "Should" + at least 5 words }); it.skip("Test name", () =&gt; {// *error:no-skipped-tests, error:error:no-global-tests. Put tests only under describe or suite expect("somevalue"); // error:no-assert }); it("Test name", () =&gt; {*//error:no-identical-title. Assign unique titles to tests });</span></span></code> </pre> <br><h3>  <font color="#3AC1EF">‚ñç4.</font>  <font color="#3AC1EF">Respectez la m√©thode de la bo√Æte noire - testez uniquement les m√©thodes publiques</font> </h3><br><h4>  Recommandations </h4><br>  Tester certains m√©canismes de code interne signifie une augmentation significative de la charge sur les d√©veloppeurs et ne donne presque aucun avantage.  Si une certaine API produit les bons r√©sultats, vaut-il la peine de passer plusieurs heures √† tester ses m√©canismes internes et √† continuer √† supporter ces tests, qui se cassent tr√®s facilement, √† jour?  Lors du test des m√©thodes accessibles au public, leur impl√©mentation interne, bien qu'implicitement, est √©galement v√©rifi√©e.  Un tel test donnera une erreur si un probl√®me survient dans le syst√®me, ce qui entra√Æne l'√©mission de donn√©es incorrectes.  Cette approche est √©galement appel√©e ¬´test comportemental¬ª.  D'autre part, en testant les m√©canismes internes d'une certaine API (c'est-√†-dire en utilisant la technique de la ¬´bo√Æte blanche¬ª), le d√©veloppeur se concentre sur les petits d√©tails de l'impl√©mentation, et non sur le r√©sultat final du code.  Les tests qui v√©rifient de telles subtilit√©s peuvent commencer √† g√©n√©rer des erreurs, par exemple, apr√®s une petite refactorisation de code, m√™me si le syst√®me continue de produire des r√©sultats corrects.  En cons√©quence, cette approche augmente consid√©rablement la charge du programmeur associ√©e √† la prise en charge du code de test. <br><br><h4>  Cons√©quences de la d√©rogation aux recommandations </h4><br>  Les tests qui tentent de capturer les m√©canismes internes d'un certain syst√®me se comportent comme un berger d'une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">fable</a> qui appelait les paysans avec des cris de ¬´Help!  Loup! ¬ªQuand il n'y avait pas de loup √† proximit√©.  Les gens ont couru √† l'aide pour d√©couvrir qu'ils avaient √©t√© tromp√©s.  Et quand le loup est vraiment apparu, personne n'est venu √† la rescousse.  De tels tests produisent des r√©sultats faussement positifs, par exemple, dans les cas o√π les noms de certaines variables internes changent.  En cons√©quence, il n'est pas surprenant que celui qui proc√®de √† ces tests commence bient√¥t √† ignorer leurs "cris", ce qui, finalement, conduit au fait qu'une fois qu'une v√©ritable erreur grave peut passer inaper√ßue. <br><br><h4>  Mauvaise approche </h4><br>  Ce test teste les m√©canismes internes d'une classe sans raison particuli√®re pour de tels contr√¥les. <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductService</span></span></span></span>{ <span class="hljs-comment"><span class="hljs-comment">//      //     ,      calculateVAT(priceWithoutVAT){   return {finalPrice: priceWithoutVAT * 1.2};   //           } //  getPrice(productId){   const desiredProduct= DB.getProduct(productId);   finalPrice = this.calculateVATAdd(desiredProduct.price).finalPrice; } } it("White-box test: When the internal methods get 0 vat, it return 0 response", async () =&gt; {   //       VAT,      .  ,   ,        expect(new ProductService().calculateVATAdd(0).finalPrice).to.equal(0); });</span></span></code> </pre> <br><h3>  <font color="#3AC1EF">‚ñç5.</font>  <font color="#3AC1EF">Choisissez les objets de sauvegarde appropri√©s: √©vitez les foules, pr√©f√©rant les talons et les espions</font> </h3><br><h4>  Recommandations </h4><br>  L'utilisation de test double lorsque le test est un mal n√©cessaire, car ils sont associ√©s aux m√©canismes internes de l'application.  Sans certains d'entre eux, c'est tout simplement impossible √† faire.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Voici du</a> mat√©riel utile sur ce sujet.  Cependant, diverses approches de l'utilisation de tels objets ne peuvent pas √™tre qualifi√©es d'√©quivalentes.  Ainsi, certains d'entre eux - les talons (talon) et les espions (espion), visent √† tester les exigences du produit, mais, comme effet secondaire in√©vitable, ils sont oblig√©s d'affecter l√©g√®rement les m√©canismes internes de ce produit.  Les simulations, d'autre part, visent √† tester les m√©canismes internes du projet.  Par cons√©quent, leur utilisation entra√Æne une √©norme charge inutile sur les programmeurs, dont nous avons parl√© ci-dessus, offrant d'adh√©rer √† la m√©thodologie de la "bo√Æte noire" lors de l'√©criture des tests. <br><br>  Avant d'utiliser des objets en double, posez-vous une question simple: "Est-ce que je les utilise pour tester la fonctionnalit√© qui est d√©crite, ou pourrait-elle √™tre d√©crite dans les exigences techniques du projet?".  Si la r√©ponse √† cette question est n√©gative, cela peut signifier que vous allez tester le produit en utilisant l'approche de la ¬´bo√Æte blanche¬ª, dont nous avons d√©j√† parl√© des lacunes. <br><br>  Par exemple, si vous souhaitez savoir si votre application fonctionne correctement dans une situation o√π un service de paiement n'est pas disponible, vous pouvez arr√™ter ce service et faire en sorte que l'application re√ßoive quelque chose indiquant qu'il n'y a pas de r√©ponse.  Cela vous permettra de v√©rifier la r√©action du syst√®me √† une situation similaire, pour savoir s'il se comporte correctement.  Au cours d'un tel test, une v√©rification est faite du comportement, ou de la r√©ponse, ou du r√©sultat de l'application dans certaines conditions.  Dans cette situation, vous pouvez utiliser l'espion pour v√©rifier si, lors de la d√©tection d'une chute dans le service de paiement, un certain e-mail a √©t√© envoy√©.  Il s‚Äôagit l√† encore d‚Äôune v√©rification du comportement du syst√®me dans une certaine situation, qui, √† coup s√ªr, est enregistr√©e dans les exigences techniques de celui-ci, par exemple, sous la forme suivante: ¬´Envoyez un e-mail √† l‚Äôadministrateur si le paiement n‚Äôest pas effectu√©¬ª.  D'autre part, si vous utilisez un objet simul√© pour repr√©senter un service de paiement et v√©rifiez l'op√©ration lors de l'acc√®s avec le transfert de ce qu'il attend de lui, alors nous parlerons de tester des m√©canismes internes qui ne sont pas directement li√©s √† la fonctionnalit√© de l'application, et, tout √† fait peut peut-√™tre changer souvent. <br><br><h4>  Cons√©quences de la d√©rogation aux recommandations </h4><br>  Avec tout refactoring de code, vous devrez rechercher tous les moki, refactoring et leur code.  En cons√©quence, le test de support deviendra un lourd fardeau, ce qui en fera des ennemis du d√©veloppeur, pas de ses amis. <br><br><h4>  Mauvaise approche </h4><br>  Cet exemple montre un objet factice concentr√© sur le test des m√©canismes internes de l'application. <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"When a valid product is about to be deleted, ensure data access DAL was called once, with the right product and right config"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; {   <span class="hljs-comment"><span class="hljs-comment">//,        const dataAccessMock = sinon.mock(DAL);   // ,           dataAccessMock.expects("deleteProduct").once().withArgs(DBConfig, theProductWeJustAdded, true, false);   new ProductService().deletePrice(theProductWeJustAdded);   mock.verify(); });</span></span></code> </pre> <br><h4>  Bonne approche </h4><br>  Les espions visent √† tester la conformit√© des syst√®mes avec leurs exigences, mais, comme effet secondaire, ils affectent in√©vitablement les m√©canismes internes des syst√®mes. <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"When a valid product is about to be deleted, ensure an email is sent"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; {   <span class="hljs-comment"><span class="hljs-comment">//,        const spy = sinon.spy(Emailer.prototype, "sendEmail");   new ProductService().deletePrice(theProductWeJustAdded);   //  .       ? ,               (  ) });</span></span></code> </pre> <br><h3>  <font color="#3AC1EF">‚ñç6.</font>  <font color="#3AC1EF">Pendant les tests, utilisez une entr√©e r√©aliste, non limit√©e √† quelque chose comme "foo"</font> </h3><br><h4>  Recommandations </h4><br>  Souvent, les erreurs de production se manifestent dans une combinaison de circonstances tr√®s sp√©cifique et m√™me surprenante.  Et cela signifie que plus les donn√©es d'entr√©e utilis√©es lors des tests sont proches de la r√©alit√©, plus la probabilit√© d'une d√©tection pr√©coce des erreurs est √©lev√©e.  Permet de g√©n√©rer des donn√©es ressemblant √† de v√©ritables biblioth√®ques sp√©cialis√©es telles que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Faker</a> .  Par exemple, ces biblioth√®ques g√©n√®rent des num√©ros de t√©l√©phone, des noms d'utilisateur, des num√©ros de cartes bancaires, des noms d'entreprises et m√™me des textes ¬´lorem ipsum¬ª al√©atoires mais r√©alistes.  En outre, envisagez d'utiliser les donn√©es des environnements de production dans les tests.  Si vous souhaitez porter ces tests √† un niveau encore plus √©lev√©, reportez-vous √† notre prochaine recommandation sur les tests bas√©s sur les propri√©t√©s. <br><br><h4>  Cons√©quences de la d√©rogation aux recommandations </h4><br>  Lors du test d'un projet au cours de son d√©veloppement, tous les tests ne peuvent √™tre r√©ussis que s'ils sont effectu√©s √† l'aide de donn√©es irr√©alistes comme les lignes ¬´foo¬ª.  Mais en production, le syst√®me √©chouera dans une situation o√π le pirate lui donnera quelque chose comme <code>@3e2ddsf . ##' 1 fdsfds . fds432 AAAA</code> <code>@3e2ddsf . ##' 1 fdsfds . fds432 AAAA</code>  <code>@3e2ddsf . ##' 1 fdsfds . fds432 AAAA</code> . <br><br><h4>  Mauvaise approche </h4><br>  Le syst√®me r√©ussit ces tests uniquement parce qu'ils utilisent des donn√©es irr√©alistes. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> addProduct = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name, price</span></span></span><span class="hljs-function">) =&gt;</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> productNameRegexNoSpace = <span class="hljs-regexp"><span class="hljs-regexp">/^\S*$/</span></span>;<span class="hljs-comment"><span class="hljs-comment">//  if(!productNameRegexNoSpace.test(name))   return false;// , -   ,  .     //  -    return true; }; it("Wrong: When adding new product with valid properties, get successful confirmation", async () =&gt; {   // "Foo",    ,    ,    false   const addProductResult = addProduct("Foo", 5);   expect(addProductResult).to.be.true;   // :     - ,     //         });</span></span></code> </pre> <br><h4>  Bonne approche </h4><br>  Il utilise des donn√©es randomis√©es similaires aux donn√©es r√©elles. <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"Better: When adding new valid product, get successful confirmation"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; {   <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> addProductResult = addProduct(faker.commerce.productName(), faker.random.number());   <span class="hljs-comment"><span class="hljs-comment">//   : {'Sleek Cotton Computer',  85481}   expect(addProductResult).to.be.true;   //  ,         ,    .   //     ,    ! });</span></span></code> </pre> <br><h3>  <font color="#3AC1EF">‚ñç 7.</font>  <font color="#3AC1EF">Syst√®mes de test utilisant plusieurs combinaisons d'entr√©es √† l'aide de tests bas√©s sur les propri√©t√©s</font> </h3><br><h4>  Recommandations </h4><br>  En r√®gle g√©n√©rale, les tests utilisent de petits ensembles de donn√©es d'entr√©e.  M√™me s'ils ressemblent √† des donn√©es r√©elles (nous en avons parl√© dans la section pr√©c√©dente), ces tests ne couvrent qu'un nombre tr√®s limit√© de combinaisons possibles d'entr√©es de l'entit√© √©tudi√©e.  Par exemple, cela pourrait ressembler √† ceci: <code>(method('', true, 1), method("string" , false" , 0))</code> . Le probl√®me est que dans l'API de production, qui est appel√©e avec cinq param√®tres, elle peut obtenir l'entr√©e de milliers de variantes diff√©rentes de leurs combinaisons, dont l'une peut entra√Æner un √©chec (il serait appropri√© de rappeler le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">flou ici</a> ). Que faire si vous pouviez √©crire un seul test qui v√©rifie automatiquement une certaine m√©thode pour 1000 combinaisons de ses entr√©es et d√©couvre laquelle est-ce que la m√©thode ne r√©pond pas correctement?  nous dans une telle situation est utile. A savoir, au cours de ce module v√©rifie d'essai, appelant avec toutes les combinaisons possibles de donn√©es d'entr√©e, ce qui augmente la probabilit√© de trouver quelques bugs. Supposons que nous ayons une m√©thode <code>addNewProduct(id, name, isDiscount)</code> et Biblioth√®que effectuer des tests, l'appelle avec de nombreuses combinaisons de param√®tres de type num√©rique, cha√Æne et logique, par exemple - <code>(1, "iPhone", false)</code> , <code>(2, "Galaxy", true)</code> .  Il est possible d'effectuer des tests bas√©s sur la v√©rification des propri√©t√©s en utilisant l'environnement d'ex√©cution de test habituel (Mocha, Jest, etc.) et en utilisant des biblioth√®ques sp√©cialis√©es comme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">js-verify</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">testcheck</a> (cette biblioth√®que a une tr√®s bonne documentation). <br><br><h4>  Cons√©quences de la d√©rogation aux recommandations </h4><br>  Le d√©veloppeur, inconsciemment, s√©lectionne ces donn√©es de test qui ne couvrent que les parties du code qui fonctionnent correctement.  Malheureusement, cela r√©duit l'efficacit√© des tests comme moyen de d√©tecter les erreurs. <br><br><h4>  Bonne approche </h4><br>  Test de nombreuses options d'entr√©e √† l'aide de la biblioth√®que mocha-testcheck. <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'mocha-testcheck'</span></span>).install(); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> {expect} = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'chai'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> faker = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'faker'</span></span>); describe(<span class="hljs-string"><span class="hljs-string">'Product service'</span></span>, () =&gt; { describe(<span class="hljs-string"><span class="hljs-string">'Adding new'</span></span>, () =&gt; {   <span class="hljs-comment"><span class="hljs-comment">//  100         check.it('Add new product with random yet valid properties, always successful',     gen.int, gen.string, (id, name) =&gt; {       expect(addNewProduct(id, name).status).to.equal('approved');     }); }) });</span></span></code> </pre> <br><h3>  <font color="#3AC1EF">‚ñç8.</font>  <font color="#3AC1EF">Efforcez-vous que le code de test soit autosuffisant, minimisant les aides externes et les abstractions</font> </h3><br><h4>  Recommandations </h4><br>  Il est probablement maintenant √©vident que je m'engage √† des tests extr√™mement simples.  Le fait est qu'autrement, l'√©quipe de d√©veloppement d'un certain projet doit en fait g√©rer un autre projet.  Pour comprendre son code, ils doivent passer un temps pr√©cieux, qu'ils n'ont pas tant.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Il est</a> tr√®s bien √©crit sur ce ph√©nom√®ne: ¬´Un code de production de haute qualit√© est un code bien pens√©, et un code de test de haute qualit√© est un code tout √† fait compr√©hensible ... Lorsque vous √©crivez un test, pensez √† qui verra le message d'erreur affich√© par lui.  Cette personne ne voudrait pas, pour comprendre les causes de l'erreur, lire le code de l'ensemble de la suite de tests ou le code de l'arbre d'h√©ritage des utilitaires utilis√©s pour les tests. " <br><br>  Pour que le lecteur comprenne le test sans quitter son code, minimisez l'utilisation d'utilitaires, de crochets ou de tout m√©canisme externe lors de l'ex√©cution du test.  Si pour ce faire, vous devez recourir trop souvent au copier-coller de code, vous pouvez vous arr√™ter √† un m√©canisme auxiliaire externe, dont l'utilisation ne violera pas l'intelligibilit√© du test.  Mais, si le nombre de ces m√©canismes augmente, le code de test perdra sa compr√©hensibilit√©. <br><br><h4>  Cons√©quences de la d√©rogation aux recommandations </h4><br>  ,      4  , 2      ,         ?  !         ,           ,        . <br><br><h4>   </h4><br>       .           ? <br><br><pre> <code class="javascript hljs">test(<span class="hljs-string"><span class="hljs-string">"When getting orders report, get the existing orders"</span></span>, () =&gt; {   <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> queryObject = QueryHelpers.getQueryObject(config.DBInstanceURL);   <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reportConfiguration = ReportHelpers.getReportConfig();<span class="hljs-comment"><span class="hljs-comment">//   ?        userHelpers.prepareQueryPermissions(reportConfiguration);//  ?         const result = queryObject.query(reportConfiguration);   assertThatReportIsValid();//  ,           -    expect(result).to.be.an('array').that.does.include({id:1, productd:2, orderStatus:"approved"});   //      ?        })</span></span></code> </pre> <br><h4>  Bonne approche </h4><br>   ,        . <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"When getting orders report, get the existing orders"</span></span>, () =&gt; {   <span class="hljs-comment"><span class="hljs-comment">// ,           const orderWeJustAdded = ordersTestHelpers.addRandomNewOrder();   const queryObject = newQueryObject(config.DBInstanceURL, queryOptions.deep, useCache:false);   const result = queryObject.query(config.adminUserToken, reports.orders, pageSize:200);   expect(result).to.be.an('array').that.does.include(orderWeJustAdded); })</span></span></code> </pre> <br><h3> <font color="#3AC1EF">‚ñç9.        :      </font> </h3><br><h4>  Recommandations </h4><br>     ,      ,    , ,           .               .       ,        (    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a> )    .   ‚Äî  ,     (  ,      ).      ‚Äî    ,     ,   , ,   .    ,    ,                    .       ‚Äî     , ,   ,       ,      (   , , ,        ). <br><br><h4>  Cons√©quences de la d√©rogation aux recommandations </h4><br> ,    .   .          .       .     ,     ,            ,       . <br><br><h4>   </h4><br>       .      ,    . <br><br><pre> <code class="javascript hljs">before(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-comment"><span class="hljs-comment">//       .   ? - ,  -   json-. await DB.AddSeedDataFromJson('seed.json'); }); it("When updating site name, get successful confirmation", async () =&gt; { // ,  ,  "Portal", ,           const siteToUpdate = await SiteService.getSiteByName("Portal"); const updateNameResult = await SiteService.changeName(siteToUpdate, "newName"); expect(updateNameResult).to.be(true); }); it("When querying by site name, get the right site", async () =&gt; { // ,  ,  "Portal", ,           const siteToCheck = await SiteService.getSiteByName("Portal"); expect(siteToCheck.name).to.be.equal("Portal"); //!      :[ });</span></span></code> </pre> <br><h4>  Bonne approche </h4><br>      ,   ,         . <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"When updating site name, get successful confirmation"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; { <span class="hljs-comment"><span class="hljs-comment">//           const siteUnderTest = await SiteService.addSite({   name: "siteForUpdateTest" }); const updateNameResult = await SiteService.changeName(siteUnderTest, "newName"); expect(updateNameResult).to.be(true); });</span></span></code> </pre> <br><h3> <font color="#3AC1EF">‚ñç10.     ,   .      expect</font> </h3><br><h4>  Recommandations </h4><br>         ,  ,      <code>try-catch-finally</code>         <code>catch</code> .   ,  ,         ,         . <br><br>            Chai,    <code>expect(method).to.throw</code> .     Jest: <code>expect(method).toThrow()</code> .         ,    .   ,     ,          . <br><br><h4>  Cons√©quences de la d√©rogation aux recommandations </h4><br>     ,   , ,             . <br><br><h4>   </h4><br>    ,            <code>try-catch</code> . <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"When no product name, it throws error 400"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span>() =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> errorWeExceptFor = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> result = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> addNewProduct({<span class="hljs-attr"><span class="hljs-attr">name</span></span>:<span class="hljs-string"><span class="hljs-string">'nest'</span></span>});} <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (error) { expect(error.code).to.equal(<span class="hljs-string"><span class="hljs-string">'InvalidInput'</span></span>); errorWeExceptFor = error; } expect(errorWeExceptFor).not.to.be.null; <span class="hljs-comment"><span class="hljs-comment">//    ,         //  ,     null,       });</span></span></code> </pre> <br><h4>  Bonne approche </h4><br>     <code>expect</code>   ,      ,      . <br><br><pre> <code class="javascript hljs">it.only(<span class="hljs-string"><span class="hljs-string">"When no product name, it throws error 400"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span>() =&gt; { expect(addNewProduct)).to.eventually.throw(AppError).with.property(<span class="hljs-string"><span class="hljs-string">'code'</span></span>, <span class="hljs-string"><span class="hljs-string">"InvalidInput"</span></span>); });</code> </pre> <br><h3> <font color="#3AC1EF">‚ñç11.   ,    </font> </h3><br><h4>  Recommandations </h4><br>       . ,        (smoke test),      -,    ,      .           -  .  ,        ,       ,      <code>#cold</code> , <code>#api</code> , <code>#sanity</code> .                    . ,  Mocha      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> <code>-g</code> ( <code>--grep</code> ). <br><br><h4>  Cons√©quences de la d√©rogation aux recommandations </h4><br>   ,   ,       ,   ,         ,  ,       .        . <br><br><h4>  Bonne approche </h4><br>  <code>#cold-test</code>         ,       .        ,         -,  ,      ‚Äî      . <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//    ( ,    ),     // ,        //   describe('Order service', function() { describe('Add new order #cold-test #sanity', function() {   it('Scenario - no currency was supplied. Expectation - Use the default currency #sanity', function() {     //-    }); }); });</span></span></code> </pre> <br><h3> <font color="#3AC1EF">‚ñç12.        </font> </h3><br><h4>  Recommandations </h4><br>       ,   Node.js-.    ,  ,    Node.js  . <br><br>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">TDD</a> ‚Äî      ,     ,          .     ,       .       ,    ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Red-Green-Refactor</a> .   ,      - ,       , ,   ,     ,         .  ,            .        ( ‚Äî   ,  ,   ). <br><br><h4>  Cons√©quences de la d√©rogation aux recommandations </h4><br>    ‚Äî    ,       .      . <br><br><h2> <font color="#3AC1EF"> 2.  </font> </h2><br><h3> <font color="#3AC1EF">‚ñç13.      ,        </font> </h3><br><h4>  Recommandations </h4><br>  ,    ,      10 ,     .     ,   .    ,         .   ,         (,    ),  ,    ,   ,     ?        - ? <br><br> ,    . ,  2019 ,  , TDD,   ‚Äî          ,     . ,        ,    ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a>    . ,   IoT-, ,   ,    -  Kafka  RabbitMQ,      .      - , ,  ,       .     ,   ,      ,     ,       ?     (,   ,     Alexa)    ,   ,        . <br><br>       ,      (    ).    , ,           , ,   ,   ,     . ,  ,  -    API   ‚Äî     Consumer-Driven Contracts    .   ,     , ,  ,    .  ,  ,       ,  ,    ,  .    ,  ,     . <br><br>    ,    TDD       .  ,  TDD     ,      .         ,  ,       ,  . <br><br><h4>  Cons√©quences de la d√©rogation aux recommandations </h4><br>          ‚Äî       ( ),       . <br><br><h4>  Bonne approche </h4><br>       .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a>   .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a>  , ,   Node.js,      . <br><br><h3> <font color="#3AC1EF">‚ñç14. ,       </font> </h3><br><h4>  Recommandations </h4><br>        .      ‚Äî  .    ,       ,        .  ,     ,    - ,   ,   -    ?    ,   .      ,          :       TDD,   ‚Äî       . <br><br>      ¬´¬ª.    API,   -      ,    (,        , ,   ,   ,    ). ,  ,    ,      (,      ).  ,    ,   ,    ,   ,  ,   . <br><br><h4>  Cons√©quences de la d√©rogation aux recommandations </h4><br>    , ,      , ,        20. <br><br><h4>  Bonne approche </h4><br>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">supertest</a> ,    API,    Express,         . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/286/bd8/02d/286bd802d29e7f6eb475567c97c9429d.png"></div><br> <i><font color="#999999"> API,   Express</font></i> <br><br><h3> <font color="#3AC1EF">‚ñç15.       ,        API,   Consumer-Driven Contracts</font> </h3><br><h4>  Recommandations </h4><br> ,      ,  ,   ,        .  ,   ,  - ,    ,    ,  -    .  ¬´-22¬ª  :       .   ,     ,       .        ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Consumer-Driven Contracts   PACT</a> . <br><br>       .       .  PACT        ,     (  ¬´¬ª).           ,   ,    PACT,    ,   ,      .        ,    ,   ,    ,       . <br><br><h4>  Cons√©quences de la d√©rogation aux recommandations </h4><br>             . <br><br><h4>  Bonne approche </h4><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c39/0ef/dcd/c390efdcd01b24f5089bf7160fd5c5c6.png"></div><br> <i><font color="#999999"> Consumer-Driven Contracts</font></i> <br><br>     ,  ,   B  ,     .  B         . <br><br><h3> <font color="#3AC1EF">‚ñç16.     </font> </h3><br><h4>  Recommandations </h4><br>       (middleware) - ,        ,  - ,      Express-.        .   ,    ,         .    ,     ,   JS-  <code>{req,res}</code> .      ,      ¬´¬ª (,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Sinon</a> )  ,      <code>{req,res}</code> .  ,    ,    ,   .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://www.npmjs.com/package/node-mocks-">node-mock-http</a>   , ,      ,         . ,     ,    HTTP-,   -. <br><br><h4>  Cons√©quences de la d√©rogation aux recommandations </h4><br>      Express       . <br><br><h4>  Bonne approche </h4><br>                 Express-. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// ,     const unitUnderTest = require('./middleware') const httpMocks = require('node-mocks-http'); //  Jest,     Mocha    describe()  it() test('A request without authentication header, should return http status 403', () =&gt; { const request = httpMocks.createRequest({   method: 'GET',   url: '/user/42',   headers: {     authentication: ''   } }); const response = httpMocks.createResponse(); unitUnderTest(request, response); expect(response.statusCode).toBe(403); });</span></span></code> </pre> <br><h3> <font color="#3AC1EF">‚ñç17.         </font> </h3><br><h4>  Recommandations </h4><br>         ,        , ,      , ,  ,  .     ,        ,      - .    ,     ,   ,           ( , ,   ),    ,        ( ‚Äî   )      .       ,    : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SonarQube</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">2600</a>   GitHub)  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Code Climate</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">1500</a> ). <br><br><h4>  Cons√©quences de la d√©rogation aux recommandations </h4><br>  ,     ,   .      .          ,         . <br><br><h4>  Bonne approche </h4><br>         Code Climate. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cae/1fe/d5c/cae1fed5caf16576b4001dfe0235820c.png"></div><br> <i><font color="#999999">  Code Climate</font></i> <br><br><h3> <font color="#3AC1EF">‚ñç18.     ,      Node.js</font> </h3><br><h4>  Recommandations </h4><br>        ,  ,     .    ,  ,    ,  -  ,   . ,    -      ,  ,  ,  ,  ?  ,  ,    ?   ,    API    ? <br><br>           Netflix   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> -</a> .    ,        ,    ,  ,              . ,      - ‚Äî <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Chaos Monkey</a> .     ,        ,       ,       .      Kubernetes ‚Äî <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">kube-monkey</a> .         ,                Node.js? ,         ,   ,     V8   1.7  .            .          <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">node-chaos</a> ,     -. <br><br><h4>  Cons√©quences de la d√©rogation aux recommandations </h4><br>      , ,     ,         . <br><br><h4>  Bonne approche </h4><br>   npm- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">chaos-monkey</a> ,            Node.js. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d24/162/bdb/d24162bdb8c2c430f9163a7eda8c6c32.png"></div><br> <i><font color="#999999"> chaos-monkey</font></i> <br><br><h2>  <font color="#3AC1EF">R√©sum√©</font> </h2><br>         ,   Node.js-.  ,         .             . <br><br>  <b>Chers lecteurs!</b>     -    ? <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr435462/">https://habr.com/ru/post/fr435462/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr435450/index.html">Bonne ann√©e, bonne nouvelle MQTT / UDP</a></li>
<li><a href="../fr435452/index.html">Test de bout en bout des microservices avec Catcher</a></li>
<li><a href="../fr435454/index.html">AOP vs fonctionnalit√©s</a></li>
<li><a href="../fr435456/index.html">Est-il dangereux de laisser un smartphone √† c√¥t√© de vous la nuit?</a></li>
<li><a href="../fr435460/index.html">Coworkidea Coworking Photo Tour (Barcelone)</a></li>
<li><a href="../fr435464/index.html">Test des projets Node.js. Partie 2. √âvaluation des performances des tests, int√©gration continue et analyse de la qualit√© du code</a></li>
<li><a href="../fr435466/index.html">Tutoriel React Partie 6: Quelques fonctionnalit√©s du cours, JSX et JavaScript</a></li>
<li><a href="../fr435468/index.html">Tutoriel React, partie 7: styles en ligne</a></li>
<li><a href="../fr435470/index.html">Tutoriel React, Partie 8: Poursuite des travaux sur une application TODO, pr√©sentation des propri√©t√©s des composants</a></li>
<li><a href="../fr435476/index.html">Mkcert: certificats HTTPS valides pour localhost</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>