<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐ญ ๐ถ ุชูุงุฑูุฑ ุนู ุญุงูุฉ ุงูุชุฎุฒูู ุจุงุณุชุฎุฏุงู R. Parallel computing ุ ุงูุฑุณูู ุงูุจูุงููุฉ ุ xlsx ุ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ููู ูุฐุง ๐ก ๐ ๐คพ๐ฟ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุชููุฑ ูุฐู ุงูููุงูุฉ ุชุนูููุงุช ุจุฑูุฌูุฉ ูุฅูุดุงุก ุชูุงุฑูุฑ ููุชุธูุฉ ุนู ุญุงูุฉ ูุญุฑูุงุช ุฃูุฑุงุต ุงูุชุฎุฒูู EMC VNX ูุน ุทุฑู ุจุฏููุฉ ูุชุงุฑูุฎ ุงูุฅูุดุงุก. 


 ุญุงููุช ูุชุงุจุฉ ุงูุชุนูููุงุช ุงูุจุฑู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุชูุงุฑูุฑ ุนู ุญุงูุฉ ุงูุชุฎุฒูู ุจุงุณุชุฎุฏุงู R. Parallel computing ุ ุงูุฑุณูู ุงูุจูุงููุฉ ุ xlsx ุ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ููู ูุฐุง</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/461441/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ุชููุฑ ูุฐู ุงูููุงูุฉ ุชุนูููุงุช ุจุฑูุฌูุฉ ูุฅูุดุงุก ุชูุงุฑูุฑ ููุชุธูุฉ ุนู ุญุงูุฉ ูุญุฑูุงุช ุฃูุฑุงุต ุงูุชุฎุฒูู <strong>EMC VNX</strong> ูุน ุทุฑู ุจุฏููุฉ ูุชุงุฑูุฎ ุงูุฅูุดุงุก. </p><br><p style=";text-align:right;direction:rtl">  ุญุงููุช ูุชุงุจุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูุน ุงูุชุนูููุงุช ุงูุฃูุซุฑ ุชูุตููุง ูููู ูุงุญุฏ.  ุงุณุชุจุฏู ูููุงุช ุงููุฑูุฑ ุงูุฎุงุตุฉ ุจู ููุท.  ูุดุงุฑ ุฃูุถูุง ุฅูู ุชูุณูู ุงูุจูุงูุงุช ุงููุตุฏุฑ ุ ูุฐูู ุณุฃููู ุณุนูุฏูุง ุฅุฐุง ุญุงูู ุดุฎุต ูุง ุชุทุจููู ูู ุงูููุฒู. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/um/it/no/umitnoobcf6fiyywqho_5gsbvjk.png" alt="ุงูุฑุณููุงุช ุงููุธูุฑ"></p><a name="habracut"></a><br><h2 id="predystoriya" style=";text-align:right;direction:rtl">  ูุจู ุงูุชุงุฑูุฎ </h2><br><p style=";text-align:right;direction:rtl">  ููููู ุชุฎุทู ุฅุฐุง ูู ุชูู ูุซูุฑุฉ ููุงูุชูุงู ูู ุฃูู ุชููู "ุงูุฃุฑุฌู". <br>  ูุฏููุง ูุฑูุฒ ุจูุงูุงุช.  ูุง ุชูุฌุฏ ุฃูุธูุฉ ุชุฎุฒูู ุฌุฏูุฏุฉ ุฌุฏูุง.  ููุงู ุงูุนุฏูุฏ ูู ุฃูุธูุฉ ุงูุชุฎุฒูู ุ ูุดู ุงููุฑุต ุฃูุถุง.  ุนุฏุฉ ูุฑุงุช ูู ุงูุฃุณุจูุน ูุฐูุจ ุงููุงุณ ุฅูู ูุฑูุฒ ุงูุจูุงูุงุช ููุบูุฑูู ูุญุฑูุงุช ุงูุฃูุฑุงุต ูู ูุธุงู ุงูุชุฎุฒูู.  ูุชู ุงุชุฎุงุฐ ูุฑุงุฑ ุจุงุณุชุจุฏุงู ุงูุฃูุฑุงุต ุจุนุฏ ุฅูุฐุงุฑ ูู ูุธุงู " <strong>ุงุณุชุจุฏุงู ุงููุฑุต ุงูููุตู ุจู</strong> ". </p><br><p style=";text-align:right;direction:rtl">  <em>ูุง ุดูุก ุฎุงุฑุฌ ุนู ุงููุฃููู.</em> </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/5l/ho/ne/5lhonedh_eha1d0gm2vnzrv2ry4.png" alt="ูุง ุจุฃุณ"></p><br><p style=";text-align:right;direction:rtl">  ูููู ูู ุงูุขููุฉ ุงูุฃุฎูุฑุฉ ุ ุจุฏุฃุช LUNs ุงููุฑุฏูุฉ ุงูุชู ุชู ุฌูุนูุง ุนูู ุฃูุธูุฉ ุงูุชุฎุฒูู ูุฐู ูุนุฑุถูุง ุนูู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ ูู ุงูุชุฏููุฑ ุจุดูู ุฎุทูุฑ.  ุจุนุฏ ุงูุชุญุฏุซ ูุน ุงูุฏุนู ุงูููู ููุจุงุฆุน ุ ุฃุตุจุญ ูู ุงููุงุถุญ ุฃู ุงูุฃูุฑุงุต ูุฌุจ ุชุบููุฑูุง ุจุงููุนู ููุณ ููุท ุนูุฏ ุธููุฑ ุฑุณุงูุฉ ุงูุฅูุฐุงุฑ ุฃุนูุงู ุ ูููู ุฃูุถูุง ุนูุฏูุง ูุธูุฑ ุนุฏุฏ ูุจูุฑ ูู ุงูุฑุณุงุฆู ุงูุฃุฎุฑู ุฃู ุงููุธุงู ูุง ูุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุงูุฃุฎุทุงุก ุงูุฎุทูุฑุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุฑุงูุจุฉ SNMP ุจูุงุณุทุฉ ุฃูุธูุฉ ุงูุชุฎุฒูู ูุฐู ุบูุฑ ูุฏุนููุฉ.  ุฃูุช ุจุญุงุฌุฉ ุฅูู ุงุณุชุฎุฏุงู ุฅูุง ุจุฑูุงูุฌ ููููุฉ ุจุงูุธ ุงูุซูู (ููุณ ูุฏููุง) ุ ุฃู ุฃุฏุงุฉ ูุณุงุนุฏุฉ <strong>NaviSECCli</strong> ุ ูุงูุชู ูุฌุจ ุฃู ุชููู ูุชุตูุงู ุจูู ูุญุฏุฉ ุชุญูู (ููุฌุฏ ุงุซูุงู ูููู) ููู ูุธุงู ุชุฎุฒูู ุ ูููู ูุฐุง ูู ููู ูุฑุบูุจูุง ููู. </p><br><p style=";text-align:right;direction:rtl">  ุชูุฑุฑ ุฃุชูุชุฉ ูุฌููุนุฉ ุงูุณุฌูุงุช ูุงูุจุญุซ ุนู ุงูุฃุฎุทุงุก ูููุง.  ููุฌุจ ุชุฑู ูุฑุงุฑ ุงุณุชุจุฏุงู ุงูุฃูุฑุงุต ูููููุฏุณูู ุงููุณุคูููู ุจูุงุกู ุนูู ูุชุงุฆุฌ ุชุญููู ุงูุชูุฑูุฑ. </p><br><h2 id="pervye-shagi" style=";text-align:right;direction:rtl">  ุงูุฎุทูุงุช ุงูุฃููู </h2><br><p style=";text-align:right;direction:rtl">  ูู ุงูุจุฏุงูุฉ ุ ูุชุจ ุฃุญุฏ ุฒููุงุฆู ุฑูุฒ <strong>PowerShell</strong> ูุงู ุจูุง ููู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฃุฎุฐ ุฌุฏูู ุฅุฏุฎุงู ูุญุชูู ุนูู ุนูุงููู IP ููุญุฏุงุช ุงูุชุญูู ูู ุงูุชุฎุฒูู ุ </li><li style=";text-align:right;direction:rtl">  ุฐูุจุช ุงูุฏูุฑุฉ ุฅูู ุนูุงููู IP ููุญุฏุงุช ุงูุชุญูู <em>A</em> ุ ุซู ุฅูู ุนูุงููู IP ููุญุฏุงุช ุงูุชุญูู <em>B</em> ุ </li><li style=";text-align:right;direction:rtl">  ูู ูุฐู ุงูุนูููุฉ ุ ูุงุจูุชูู ุจุงูุฅุถุงูุฉ ุฅูู ุงูุฃุฑูุงู ุงูุชุณูุณููุฉ ููุฃูุฑุงุต ุ </li><li style=";text-align:right;direction:rtl">  ูุนุงูุฌุฉ ุฌููุน ุฃุณุทุฑ ุงูุณุฌูุงุช ูุชุตููุชูุง ููุญุชูู ุงูุฑุณุงุฆู ุงููุทููุจุฉ ุ </li><li style=";text-align:right;direction:rtl">  ุฅูุดุงุก ูุงุฆู <strong>PowerShell</strong> ููู ุฎุตุงุฆุตู ูุงู ุจุชุญููู ุงูุจูุงูุงุช ุงูุถุฑูุฑูุฉ ูู ุงูุฎุทูุท ุงูุชู ุชู ุงูุญุตูู ุนูููุง ุฃุนูุงู ุ </li><li style=";text-align:right;direction:rtl">  ุฏูุฌ ุฌููุน ุงููุงุฆูุงุช ุงููุงุชุฌุฉ ูู ุฌุฏูู ุชู ุฅุตุฏุงุฑู ูู ุดูู ููู CSV. </li></ul><br><p style=";text-align:right;direction:rtl">  ุงูุฑูุฒ ุฃุฏูุงู.  ุชุญูุธ ููุฑุงู ุนูู ุฃูู ูุนูู ุ ููููุง ูุฏููุง โโุญูุงู ุจุฏููุงู. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุตุฏุฑ PowerShell</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"><code class="perl hljs">cd <span class="hljs-string"><span class="hljs-string">'d:\Navisphere CLI\' $csv = "D:\VNX-IP.csv" $Filter1 = "name1" $Filter2 = "name2" $Filter3 = "name3" $Data = import-csv $csv -Delimiter '</span></span>;<span class="hljs-string"><span class="hljs-string">' | Where {$_.cl -EQ $Filter1 -Or $_.cl -EQ $Filter2 -Or $_.cl -EQ $Filter3} | Sort-Object -Property @{Expression={$_.cl}; Ascending=$true}, @{Expression={$_.Name} ;Ascending=$true} #$Filter1 = "nameOfcl" #$Data = import-csv $csv -Delimiter '</span></span>;<span class="hljs-string"><span class="hljs-string">' | Where {$_.Name -EQ $Filter1} $Data | select Name,IP,cl $yStart = (Get-Date).AddDays(-30).ToString('</span></span>yyyy<span class="hljs-string"><span class="hljs-string">') $yEnd = (Get-Date).ToString('</span></span>yyyy<span class="hljs-string"><span class="hljs-string">') $mStart = (Get-Date).AddDays(-30).ToString('</span></span>MM<span class="hljs-string"><span class="hljs-string">') $mEnd = (Get-Date).ToString('</span></span>MM<span class="hljs-string"><span class="hljs-string">') $dStart = (Get-Date).AddDays(-30).ToString('</span></span>dd<span class="hljs-string"><span class="hljs-string">') $dEnd = (Get-Date).ToString('</span></span>dd<span class="hljs-string"><span class="hljs-string">') #$start = (Get-Date).AddDays(-3).ToString('</span></span>MM\/dd\/yy<span class="hljs-string"><span class="hljs-string">') #$end = (Get-Date).ToString('</span></span>MM\/dd\/yy<span class="hljs-string"><span class="hljs-string">') $i = 1 $table = ForEach ($row in $Data) { Write-Host $row.Name -ForegroundColor "Yellow" Write-Host "SP A" Write-Host (Get-Date).ToString('</span></span>HH:mm:ss<span class="hljs-string"><span class="hljs-string">') $txt = .\NaviSECCli.exe -scope 0 -h $row.newA -user myusername -password mypassword getlog -date $mStart/$dStart/$yStart $mEnd/$dEnd/$yEnd | Select-String -Pattern "\(820\)","\(803\)","\(801\)","\(920\)","\(901\)" ForEach ($n in $txt) { $x = $n -Split('</span></span> <span class="hljs-string"><span class="hljs-string">') $disk = $x[3] + "_" + $x[5] + "_" + $x[7].Split("(")[0] $sn = (.\NaviSECCli.exe -scope 0 -h $row.newA -user myusername -password mypassword getdisk $disk -serial)[1] | %{$_ -replace "Serial Number: ",""} | %{$_ -replace "State: ",""} | %{$_ -replace " ",""} New-Object PSObject -Property @{ i = $i cl = $row.cl Storage = $row.Name SP = "A" Date = $x[0] Time = $x[1] Disk = $disk Error = (($n -Split('</span></span>\[<span class="hljs-string"><span class="hljs-string">'))[0] -Split('</span></span>\)<span class="hljs-string"><span class="hljs-string">'))[1].Trim() eCode = (($n -Split('</span></span>\(<span class="hljs-string"><span class="hljs-string">'))[1] -Split('</span></span>\)<span class="hljs-string"><span class="hljs-string">'))[0] SN = $sn } $i = $i + 1 } Write-Host "SP B" Write-Host (Get-Date).ToString('</span></span>HH:mm:ss<span class="hljs-string"><span class="hljs-string">') $txt = .\NaviSECCli.exe -scope 0 -h $row.newB -user myusername -password mypassword getlog -date $mStart/$dStart/$yStart $mEnd/$dEnd/$yEnd | Select-String -Pattern "\(820\)","\(803\)","\(801\)","\(920\)","\(901\)" ForEach ($n in $txt) { $x = $n -Split('</span></span> <span class="hljs-string"><span class="hljs-string">') $disk = $x[3] + "_" + $x[5] + "_" + $x[7].Split("(")[0] $sn = (.\NaviSECCli.exe -scope 0 -h $row.newA -user myusername -password mypassword getdisk $disk -serial)[1] | %{$_ -replace "Serial Number: ",""} | %{$_ -replace "State: ",""} | %{$_ -replace " ",""} New-Object PSObject -Property @{ i = $i cl = $row.cl Storage = $row.Name SP = "B" Date = $x[0] Time = $x[1] Disk = $disk Error = (($n -Split('</span></span>\[<span class="hljs-string"><span class="hljs-string">'))[0] -Split('</span></span>\)<span class="hljs-string"><span class="hljs-string">'))[1].Trim() eCode = (($n -Split('</span></span>\(<span class="hljs-string"><span class="hljs-string">'))[1] -Split('</span></span>\)<span class="hljs-string"><span class="hljs-string">'))[0] SN = $sn } $i = $i + 1 } Write-Host " " } $table | select i,cl,Storage,SP,Date,Time,Disk,Error,eCode,SN | Export-Csv -Path '</span></span>d:\VNX-Errors.csv<span class="hljs-string"><span class="hljs-string">' -NoTypeInformation -UseCulture -Encoding UTF8</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูุงู ูู ุดูุก ุนูู ูุง ูุฑุงู ุ ููุงู ูู ูุง ุชุจูู ูู ุฅุถุงูุฉ "ููุนุงู" ูู ุดูู ุฅุฑุณุงู ุชููุงุฆู ูุฎุทุงุจ ุฅูู ุงูุฒููุงุก ุงูููุชููู ูุชูุณูู ุงูุญุฏ ุงูุฃุฏูู ูู CSV ุงููุงุชุฌุฉ.  ููู (!) ูู ูุฐู ุงููุดุงูู ุนููุช ููุชุฑุฉ ุทูููุฉ ุฌุฏูุง.  ุนูู ุณุจูู ุงููุซุงู ุ ุชู ุฌูุน ุงูุจูุงูุงุช ููุฏุฉ ุดูุฑ ุญูุงูู <strong>45 ุฏูููุฉ</strong> ุ ููู ูุง ูู ููู ููุงุณุจูุง ุฌุฏูุง ุ ูุฃูู ุจุงูุฅุถุงูุฉ ุฅูู ุงูุชูุงุฑูุฑ ุงูููุชุธูุฉ ุ ุฃุฑุฏุช ุฅุฌุฑุงุก ุชุญููู ููุนุงู ุงูุญุงูู ุ ูุณูููู ูุฐุง ููุชูุง ุทูููุงู ููุบุงูุฉ.  ูููู "ุฑูุถ - ุงูุนุฑุถ".  ุจุฏุฃูุง ูู ุงูุชูููุฑ. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/jn/85/ts/jn85tsztuso-z7ulzxh2a1jk7yq.jpeg"></p><br><p style=";text-align:right;direction:rtl">  ูู ุงููุงุถุญ ุฃูู ุชุญุชุงุฌ ุฅูู ุชุญุณูู ุงูููุฏ ูุชูููู ุงูุญูุณุจุฉ ุงููุชูุงุฒูุฉ.  ูู <strong>PowerShell</strong> ุ ูู ููุฌุญ ูู ุฃูุซุฑ ูู 5 ุณูุงุณู ูุชุฒุงููุฉ ุจุงุณุชุฎุฏุงู <strong>ุณูุฑ ุงูุนูู</strong> ุ ููู ููู ุจุนุฏ ุจุทุฑู ุจุฏููุฉ.  ูุฐูู ุชูุฑุฑ ูุญุงููุฉ ุชุญููู ููุทู ุงูุจุฑูุงูุฌ ุงููุตู ุฅูู <strong>R.</strong>  ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ <strong>NaviSECCli</strong> ุ ูุงูุชู ูููู ุชุดุบูููุง ูู ุชุญุช <strong>R</strong> ุ ุชุฌุนู ูุณุญ ุงูุชุฎุฒูู ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงููุตุฏุฑ ุ ูุจุงูุชุงูู ูุฅู ุงูุญู ููุงุณุจ ุชูุงููุง. <br>  ููุงู - <del>  ุจุถุนุฉ ุฃูุงู </del>  - ุงูุชููุช! </p><br><p style=";text-align:right;direction:rtl">  ูุฑุฑูุง ูู ุงูุฅุฎุฑุงุฌ ุฃู ุฃุชููู ุฑุณุงูุฉ ุฅุฎุจุงุฑูุฉ ููููุฉ ุชุญุชูู ุนูู <strong>ุฅุฌูุงูู ุนุฏุฏ ุงูุฃุฎุทุงุก</strong> ูู ูุต ุงูุฑุณุงูุฉ ุ ูุจุนุถ <strong>ุงูุฌุฏูู ุงูุฒููู</strong> ูุนุฏุฏ ุงูุญูุงุฏุซ (ุจุญูุซ ูุงู ููุงู ุดูุก ูุฅุธูุงุฑ ุงูุฅุฏุงุฑุฉ) ุ ููุฐูู <strong>ูุฑูู</strong> ูู ุดูู ุฌุฏูู xlsx.  ููุฏ ูุฑุฑูุง ุฃูู ูู ุงูุฌุฏูู ุฃุฑูุฏ ุฃู ุฃุญุตู ุนูู 3 ุนูุงูุงุช ุชุจููุจ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุจูุงูุงุช ุงูุญูุงุฏุซ ููุฏุฉ 3 ุฃูุงู ุญุณุจ ููุน ุงููุฑุต ูุงูุญุงุฏุซ </li><li style=";text-align:right;direction:rtl">  ุนูุงูุฉ ุชุจููุจ ููุงุซูุฉ ุ ูููู ููุฏุฉ 30 ููููุง </li><li style=";text-align:right;direction:rtl">  ุจูุงูุงุช ุฃูููุฉ (ุฅุฐุง ุฃุฑุงุฏ ุดุฎุต ูุง ุชุดุบูููุง ูู Excel ุจุฃููุณูู) </li></ul><br><h4 id="algoritm-skripta" style=";text-align:right;direction:rtl">  ุฎูุงุฑุฒููุฉ ุงูุจุฑูุงูุฌ ุงููุตู </h4><br><p style=";text-align:right;direction:rtl">  <strong>1.</strong> ูู ุจุชูุฒูู ุงูุจูุงูุงุช ุงููุชููุฑุฉ ุนูู csv ูู ูุญุฏุงุช ุงูุชุญูู ุ <br>  <strong>2.</strong> ุชุดุบูู ูู ุฎูุงู ุงูุญูุณุจุฉ ุงููุชูุงุฒูุฉ ุฏูุฑุฉ ูุฌููุน ูุญุฏุงุช ุงูุชุญูู ูุน ุงูุจุญุซ ุนู ุณุฌูุงุช ุฑุณุงุฆู ุงูุฅูุฐุงุฑ ุงููุทููุจุฉ ุ <br>  <strong>3.</strong> ุงูุฌูุน ุจูู ุงููุชุงุฆุฌ ูู ุฅุทุงุฑ ุงูุจูุงูุงุช ุ <br>  <strong>4.</strong> ุงูููุงู ุจูุนุงูุฌุฉ ุงูุจูุงูุงุช ูุงูุชุญููู ุ <br>  <strong>5.</strong> ุชูููุฏ ูุซููุฉ XLSX. <br>  <strong>6. ูุญู</strong> ุชุดููู ุงูุฌุฏูู ุงูุฐู ูุญูุธู ูู ุจุงุจูุง ููู ุบูููุง. <br>  <strong>7.</strong> ุชุดููู ุฎุทุงุจ ูุญุชูู ุนูู ุงูุจูุงูุงุช ุงูุชู ุชู ุฌูุนูุง. <br>  <strong>8.</strong> ุฅุฑุณุงู ุฎุทุงุจ. </p><br><h2 id="proydyom-po-punktam-algoritma" style=";text-align:right;direction:rtl">  ุฏุนูุง ูุฐูุจ ูู ุฎูุงู ููุงุท ุงูุฎูุงุฑุฒููุฉ </h2><br><h3 id="1-zagruzhaem-iz-csv-imeyuschiesya-dannye-po-kontrolleram" style=";text-align:right;direction:rtl">  1. ูู ุจุชูุฒูู ุงูุจูุงูุงุช ุงููุชุงุญุฉ ุนูู ูุญุฏุงุช ุงูุชุญูู ูู CSV </h3><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุชูุณูู ุงูุฌุฏูู ุงููุตุฏุฑ ูุน ูุนููุงุช VNX</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># A tibble: 83 x 9 Name IP cl type newA newB oldA oldB cntIP &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; 1 XXX 10.***.**~ XclNam~ 5300-1 10.201.1~ 10.201.1~ 10.***.*~ 10.***.*~ 10.***.*~ 2 XXX 10.***.**~ XclNam~ 5300-1 10.201.1~ 10.201.1~ 10.***.*~ 10.***.*~ 10.***.*~ 3 XXX 10.***.**~ XclNam~ 5300-1 10.201.1~ 10.201.1~ 10.***.*~ 10.***.*~ 10.***.*~ 4 XXX 10.***.**~ XclNam~ 5300-1 10.201.1~ 10.201.1~ 10.***.*~ 10.***.*~ 10.***.*~ 5 XXX 10.***.**~ XclNam~ 5300-1 10.201.1~ 10.201.1~ 10.***.*~ 10.***.*~ 10.***.*~ 6 XXX 10.***.**~ XclNam~ 5300-1 10.201.1~ 10.201.1~ 10.***.*~ 10.***.*~ 10.***.*~ 7 XXX 10.***.**~ XclNam~ 5300-1 10.201.1~ 10.201.1~ 10.***.*~ 10.***.*~ 10.***.*~ 8 XXX 10.***.**~ XclNam~ 5300-1 10.201.1~ 10.201.1~ 10.***.*~ 10.***.*~ 10.***.*~ 9 XXX 10.***.**~ XclNam~ 5300-1 10.201.1~ 10.201.1~ 10.***.*~ 10.***.*~ 10.***.*~ 10 XXX 10.***.**~ XclNam~ 5300-1 10.201.1~ 10.201.1~ 10.***.*~ 10.***.*~ 10.***.*~ # ... with 73 more rows</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูุฌูุน ูุนูููุงุช ุงูุทูุงุฑุฆ ุ ุชุญุชุงุฌ ุฅูู ุงูุงุชุตุงู ูู ุณูุณูุฉ ุนูู ุญุฏ ุณูุงุก ูุญุฏุงุช ุงูุชุญูู ( <em>ุฃุนูุฏุฉ newA</em> ู <em>newB</em> ) ุจุงุณุชุฎุฏุงู ุจุฑูุงูุฌ <em>EMC</em> ุงููุชุฎุตุตุฉ - <strong>NaviCLI</strong> ูุน ููุงุชูุญ ูุนููุฉ. <br>  ููุฑุงุญุฉ ุ ูุนูุฏ ุชููุฆุฉ ุงูุฌุฏูู ุงููุงุชุฌ ุจุนุฏ ุงูุชุญููู ุจุญูุซ ุชููู ุนูุงููู IP ูููุชุง ุงููุญุฏุชูู ูู ููุณ ุงูุนููุฏ ุ ุจุญูุซ ููููู ุฅูุดุงุก ุฏูุฑุฉ ูุงุญุฏุฉ ุฎูุงู ุงููุงุฆูุฉ ุ ูููุณ ุฏูุฑุชูู ูุชุชุงููุชูู.  ูุญู ููุนู ูุฐุง ุจุงุณุชุฎุฏุงู ูุธููุฉ <strong>ุฌูุน</strong> .  ูุชู ูุตู ูุถุงูุง ุงูุนูู ุจุงุณุชุฎุฏุงู ุชูุณููุงุช ุงูุจูุงูุงุช "ุงูุฑุฃุณูุฉ" ุฃู "ุงูุฃูููุฉ" ุฌูุฏูุง ูู ุงููุซุงุฆู ุงูุฑุณููุฉ ููููุชุจุฉ <strong>ุงูุนูุณูุฉ</strong> .  ููููู ูุฑุงุกุชูุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ููุง</a> . </p><br><p style=";text-align:right;direction:rtl">  ููุฑุฃ ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู ุฏุงูุฉ <strong>read_csv2</strong> ุ <strong>ููุญุฏุฏ</strong> ุฃูุถูุง ุฃููุงุน ุงูุฃุนูุฏุฉ ูุฏูููุง ูู ุฎูุงู ุงููุนููุฉ <strong>col_types</strong> ุงูุฅุถุงููุฉ.  ูุฐู ููุงุฑุณุฉ ุฌูุฏุฉ  ูุณุฑุน ูุซูุฑุง ุงูุชุญููู.  ูู ุญุงูุชูุง ุ ูุฐุง ููุณ ูููุง ุ ูุฃู  ูุญุชูู ููู CSV ุงูุฃุตูู ุนูู ุฃูู ูู 100 ุณุทุฑ ุ ููููุง ูุนุชุงุฏูู ุนูู ุงููุชุงุจุฉ ุจุดูู ุตุญูุญ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   IP VNX. #         , #   ip        . VNX_ip &lt;- vnxIPfilePath %&gt;% read_csv2( col_types = cols( Name = col_character(), IP = col_character(), cl = col_character(), type = col_character(), newA = col_character(), newB = col_character(), oldA = col_character(), oldB = col_character() ) ) %&gt;% filter(cl %in% productCls) %&gt;% gather(key = "cntName", value = "cntIP", 5:6)</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ุงูุฅุฎุฑุงุฌ ุ ูุญุตู ุนูู ุฅุทุงุฑ ุงูุจูุงูุงุช ูุฐุง (ุงูุฃุนูุฏุฉ ุงูุฌุฏูุฏุฉ ูู <strong>cntName</strong> ู <strong>cntIP</strong> ): </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># A tibble: 30 x 8 Name IP cl type oldA oldB cntName cntIP &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; 1 XXX 10.***.***.*~ XclNameX 5300~ 10.***.***.~ 10.***.***.~ newA 10.***.***.~ 2 XXX 10.***.***.*~ XclNameX 5300~ 10.***.***.~ 10.***.***.~ newA 10.***.***.~ 3 XXX 10.***.***.*~ XclNameX 5300~ 10.***.***.~ 10.***.***.~ newA 10.***.***.~ 4 XXX 10.***.***.*~ XclNameX 5300~ 10.***.***.~ 10.***.***.~ newA 10.***.***.~ 5 XXX 10.***.***.*~ XclNameX 5300~ 10.***.***.~ 10.***.***.~ newA 10.***.***.~ 6 XXX 10.***.***.*~ XclNameX 5300~ 10.***.***.~ 10.***.***.~ newA 10.***.***.~ 7 XXX 10.***.***.*~ XclNameX 5300~ 10.***.***.~ 10.***.***.~ newA 10.***.***.~ 8 XXX 10.***.***.*~ XclNameX 5300~ 10.***.***.~ 10.***.***.~ newA 10.***.***.~ 9 XXX 10.***.***.*~ XclNameX 5300~ 10.***.***.~ 10.***.***.~ newA 10.***.***.~ 10 XXX 10.***.***.*~ XclNameX 5300~ 10.***.***.~ 10.***.***.~ newA 10.***.***.~ # ... with 20 more rows</span></span></code> </pre> <br><h3 id="2-3-zapuskaem-cherez-parallelnye-vychisleniya-cikl-po-vsem-kontrolleram-s-poiskom-zapisey-o-trebuemyh-avariynyh-soobscheniyah-rezultaty-obedinyaem-v-data-frame" style=";text-align:right;direction:rtl">  2-3.  ูุญู ูููุฐ ูู ุฎูุงู ุญุณุงุจุงุช ูุชูุงุฒูุฉ ุฏูุฑุฉ ูุฌููุน ูุญุฏุงุช ุงูุชุญูู ูุน ุงูุจุญุซ ุนู ุณุฌูุงุช ุฑุณุงุฆู ุงูุฅูุฐุงุฑ ุงููุทููุจุฉ.  ุงูุฌูุน ุจูู ุงููุชุงุฆุฌ ูู ุฅุทุงุฑ ุงูุจูุงูุงุช </h3><br><p style=";text-align:right;direction:rtl">  ุงูุชุงูู ูู ุงูุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู.  <em>ุงูุญูุณุจุฉ ุงููุชูุงุฒูุฉ</em> . </p><br><p style=";text-align:right;direction:rtl">  ููุฌุฏ ูู <strong>R</strong> ุนุฏุฉ ุฎูุงุฑุงุช (ุจุฏูุงู ูู ุฐูู ุ ุญุชู) ููุญูุณุจุฉ ุงููุชูุงุฒูุฉ.  ุฃุนุฌุจูู ุงูุฑุงุจุท ูู ููุชุจุงุช <strong>foreach</strong> ู <strong>doParallel ุฃูุซุฑ</strong> .  ููููู ุฃู ุชูุฑุฃ ุนููุง ูุนู ุฎูุงุฑุงุช ุงูุญูุณุจุฉ ุงููุชูุงุฒูุฉ ุงูุฃุฎุฑู ูู <strong>R</strong> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ููุง</a> . </p><br><p style=";text-align:right;direction:rtl">  ุจุงุฎุชุตุงุฑ ุ ูุฃุฎุฐ <strong>3 ุฎุทูุงุช</strong> ููุท: <br>  <strong>ุงูุฎุทูุฉ 1</strong>  ุณุฌู ุญุจุงุช <del>  ุงูุฒูุฑุฏ ุงูููู </del>  ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ููุนูู ูู ุงูุญูุณุจุฉ ุงููุชูุงุฒูุฉ ุนุจุฑ <strong>registerDoParallel</strong> (ูู ุญุงูุชูุง ุ ููุชุดู ุฃููุงู ุนุฏุฏ ุงูููู ูู ุญุงูุฉ) </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุชุณุฌูู ุงูููู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs">numCores &lt;- detectCores() registerDoParallel(numCores)</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  <strong>ุงูุฎุทูุฉ 2</strong>  ูุจุฏุฃ ุงูุฏูุฑุฉ ูู ุฎูุงู <strong>foreach</strong> (ูุง ุชูุณ ุชุญุฏูุฏ ุนุงูู ุงูุชุดุบูู <strong>ูช doparูช</strong> ุจุญูุซ ูุชู ุชุดุบูู ุงูุฏูุฑุฉ ุจุดูู ูุชูุงุฒู ูุชุดูุฑ ุ ูู ุฎูุงู ุงููุนููุฉ <strong>.combine ุ ุฅูู</strong> ุงูุทุฑููุฉ ุงูุชู ูุฌูุน ุจูุง ุงููุชูุฌุฉ).  ูู ุญุงูุชูุง <strong>.combine = rbind</strong> ุ ูุฃูู ุนูุฏ ุฅุฎุฑุงุฌ ูู ุญููุฉ ุณูููู ูุฏููุง <strong>ุฅุทุงุฑ ุจูุงูุงุช</strong> . </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฎุทุฃ ูู ุงุณุชุนุงุฏุฉ ุฑูุฒ ุงูุฌุฏูู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#      VNX   ip   . #      ,      #   ,      dataframe #  %dopar%   . #    ,   system.time   , #    %dopar%  %do%.      4-5. # system.time({ errors_df &lt;- foreach(i = 1:nrow(VNX_ip), .combine = rbind, .packages = "tidyverse") %dopar% { errors_raw &lt;- system( paste( "NaviSECCli.exe -scope 0 -h", VNX_ip$cntIP[i], "-user myusername -password mypassword getlog -date", bigPeriodForm, currDateForm ), intern = TRUE ) %&gt;% str_subset(pattern = regex(paste0(errorNumbers, collapse = "|"))) #      ,       if (length(errors_raw) &gt; 0) { #     #       , #     , #       . errorsDescr &lt;- errors_raw %&gt;% gsub("(.*\\) )(.*)(\\s+\\[.*)", "\\2", x = .) %&gt;% trimws() %&gt;% gsub('([[:punct:]])|\\s+', '_', .) #           errors &lt;- errors_raw %&gt;% str_split(pattern = "\\s+", simplify = T) %&gt;% as_tibble() %&gt;% mutate(Disk = paste0(V4, "_", V6, "_", V8) %&gt;% gsub( pattern = "\\([0-9]{3}\\)", replacement = "", x = .) ) #  dataframe    data_frame(cl = VNX_ip$cl[i], Storage = VNX_ip$Name[i], Date = errors$V1 %&gt;% as.Date(format = "%m/%d/%Y"), Time = errors$V2, Disk = errors$Disk, Error = errorsDescr, eCode = errors$V8 %&gt;% str_extract(paste0(errorNumbers, collapse = "|")) %&gt;% str_extract("[0-9]+")) %&gt;% mutate(DateTime = as.POSIXct(paste(Date, Time), format = "%Y-%m-%d %H:%M:%S")) } } # })</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  <strong>ุงูุฎุทูุฉ 3</strong>  ูููู ุจูุณุญ ูุธุงู ุงูุชูุงุฒู ุงูุฐู ุชู ุฅูุดุงุคู ูู ุฎูุงู <strong>stopImplicitCluster ()</strong> </p><br><h4 id="chut-podrobnee-po-poluchenii-chitaemoy-tablicy-iz-raw-teksta-oshibok" style=";text-align:right;direction:rtl">  ูุฒูุฏ ูู ุงูุชูุงุตูู ุญูู ุงูุญุตูู ุนูู ุฌุฏูู ูุงุจู ูููุฑุงุกุฉ ูู ูุต ุงูุฎุทุฃ ุงูุฎุงู </h4><br><p style=";text-align:right;direction:rtl">  ูู ุงููููุฐุฌ ุงููุตู ุ ุงูุฃุฎุทุงุก ูู ููุง ููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">head(errors_raw) [<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-string"><span class="hljs-string">"07/13/2019 00:01:46 Bus 0 Enclosure 3 Disk 9(801) Soft SCSI Bus Error [0x00] 841d1080 10006 "</span></span> [<span class="hljs-number"><span class="hljs-number">2</span></span>] <span class="hljs-string"><span class="hljs-string">"07/13/2019 00:01:46 Bus 0 Enclosure 3 Disk 9(801) Soft SCSI Bus Error [0x00] 841e1a00 10006 "</span></span> [<span class="hljs-number"><span class="hljs-number">3</span></span>] <span class="hljs-string"><span class="hljs-string">"07/13/2019 00:01:46 Bus 0 Enclosure 3 Disk 9(801) Soft SCSI Bus Error [0x00] 8420b600 10006 "</span></span> [<span class="hljs-number"><span class="hljs-number">4</span></span>] <span class="hljs-string"><span class="hljs-string">"07/13/2019 00:01:46 Bus 0 Enclosure 3 Disk 9(801) Soft SCSI Bus Error [0x00] 84206900 10006 "</span></span> [<span class="hljs-number"><span class="hljs-number">5</span></span>] <span class="hljs-string"><span class="hljs-string">"07/13/2019 00:01:46 Bus 0 Enclosure 3 Disk 9(801) Soft SCSI Bus Error [0x00] 841fc900 10006 "</span></span> [<span class="hljs-number"><span class="hljs-number">6</span></span>] <span class="hljs-string"><span class="hljs-string">"07/13/2019 00:01:46 Bus 0 Enclosure 3 Disk 9(801) Soft SCSI Bus Error [0x00] 841fc000 10006</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุง ูุฏููุง ููู ููุตููุฉ ุจูุณุงูุฉ ุ ูุงูุชู ุ ูููููุฉ ุงูุฃููู ุ ุญุชู ูู <em>CSV ุณูุชู</em> ุฅุฏุฑุงุฌูุง ุจุดูู ุทุจูุนู.  ููููุง ููุณุช ุจูุฐู ุงูุจุณุงุทุฉ.  ุชุนููุฏ ุงูุชุญููู ููุง ูู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุชู ูุตู ุงูุชุงุฑูุฎ ูุงูููุช ุฃูุถูุง ุจูุณุงูุฉ (ุฃุตุบุฑ ุงูุดุฑูุฑ) ุ </li><li style=";text-align:right;direction:rtl">  ูุชููู ูุต ุงูุฎุทุฃ ูู "ุงููููุงุช" ุ ุฃู  ููุตููุฉ ุฃูุถูุง ุจูุณุงูุฉ ุ </li><li style=";text-align:right;direction:rtl">  ูุณุจุจ ูุง ุ ูุง ุชูุฌุฏ ูุณุงุญุฉ ุจูู ุฑูู ุงููุฑุต ูุฑูุฒ ุงูุฎุทุฃ (ูุงูุฐู ููุฌุฏ ุจูู ููุณูู). <br>  ุจุดูู ุนุงู ุ ุงูุฌูุฉ ููุญุจู ุงูุชุนุจูุฑุงุช ุงูุนุงุฏูุฉ :) </li></ul><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/yk/rf/2i/ykrf2irog7eq_o3j3d0-ijnild0.jpeg" alt="ูุฐู ูุฑูุถ"></p><br><p style=";text-align:right;direction:rtl">  ูู ุฃุชูุงูู ุจุงูุชูุตูู ุ ูุฃูู ูุณุฃูุฉ ุฐูู ุ ููููู ุณุฃูุถุญ ุฃูู ูุฌุจ ุชูุฒูู ูุต ุงูุฎุทุฃ ุ ุญูุซ ุฅู ุงูููู ุงูููุฌูุฏุฉ ุจูู ููุณ ุงูุฅุบูุงู ูุฑูู ุงูุฎุทุฃ ูููุณ ุงููุชุญ ูุจุนุถ ุงูููู ุงูุฃุฎุฑู.  ูู ุญููุฉ ุ ููุฐุง ูู ูุชุบูุฑ <strong>ุงูุฃุฎุทุงุก</strong> . </p><br><p style=";text-align:right;direction:rtl">  ุฅููุง ุฃูุถูุง ููุทุฉ ูุซูุฑุฉ ููุงูุชูุงู ุ ูู ุฃุฌู ุชุณููู ุฅูุดุงุก ุฅุทุงุฑ ุงูุจูุงูุงุช ุงูููุงุฆู ุ ูุฅููุง ูุฑุบุจ ูู ุงูุชุนุฑูู ุนูู ุนูุงููู IP ููุญุฏุงุช ุงูุชุญูู ุ ุญูุซ ูููู ุจุชุนููู ุงูุชุณูุณู ููุณ ูู ุฎูุงู ุงูุนููุฏ ุงูุฐู ูุญุชูู ุนูู ุนูุงููู IP ููุญุฏุงุช ุงูุชุญูู (ุนูู ุณุจูู ุงููุซุงู ุ <strong>I = VNX_ip $ cntIP</strong> ) ุ ูููู ูู ุฎูุงู ุฑูู ุงูุณุทุฑ (ุฃู: ู <strong>= 1: nrow (VNX_ip)</strong> ).  ูุชูุญ ููุง ุฐูู ุ ุนูุฏ ุชุดููู ุฅุทุงุฑ ุจูุงูุงุช ุจู ุฃุฎุทุงุก <strong>ููุฒุนุฉ</strong> ุจุงููุนู ุ ุฅุถุงูุฉ ุฑูู ุงููุชูุฉ ูุงุณู ุงูุชุฎุฒูู ูู ุฎูุงู ุงูููุงููุงุช <strong>VNX_ip $ cl [i]</strong> ู <strong>VNX_ip $ Name [i]</strong> ุนูู ุงูุชูุงูู.  ุจุฏูู ูุฐุง ุ ูุฌุจ ุฅุฌุฑุงุก ุงููุตูุงุช ุ ูุงูุชู ุณุชููู ุฃุจุทุฃ ูุฃุณูุฃ ูุฑุงุกุฉ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูููุงูุฉ ุ ูุญุตู ุนูู ุฅุทุงุฑ ุจูุงูุงุช (ููููู ุตุงุฏููู ุ ุซู <strong>ูููุจ</strong> ุ ููู ุงููุฑู ูุชุฌุงูุฒ ูุทุงู ุงูููุงูุฉ) ุ ูุงูุฐู ูุญุชูู ุนูู ุฌููุน ุงูุจูุงูุงุช ุงูุชู ูุญุชุงุฌูุง.  ุฃู  ุนูู ุฃู ูุธุงู ุชุฎุฒูู ุ ุนูู ุฃู ูุฑุต ุ ุนูุฏูุง ุญุฏุซ ุฎุทุฃ ูุง. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงูุฅุทุงุฑ ุงูููุงุฆู ูุนุฑุถ ุงูุจูุงูุงุช</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs">&gt; errors_df <span class="hljs-comment"><span class="hljs-comment"># A tibble: 2,705 x 8 cl Storage Date Time Disk Error eCode DateTime &lt;chr&gt; &lt;chr&gt; &lt;date&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dttm&gt; 1 XclNam~ XStorageN~ 2019-07-18 12:09:~ 0_1_3 Soft_SCSI_~ 801 2019-07-18 12:09:55 2 XclNam~ XStorageN~ 2019-07-18 15:09:~ 0_1_3 Soft_SCSI_~ 801 2019-07-18 15:09:56 3 XclNam~ XStorageN~ 2019-07-18 16:28:~ 0_1_3 Soft_SCSI_~ 801 2019-07-18 16:28:50 4 XclNam~ XStorageN~ 2019-07-19 06:36:~ 0_1_6 Soft_SCSI_~ 801 2019-07-19 06:36:39 5 XclNam~ XStorageN~ 2019-07-19 20:57:~ 0_1_6 Soft_Media~ 820 2019-07-19 20:57:35 6 XclNam~ XStorageN~ 2019-07-22 11:00:~ 0_2_~ Soft_SCSI_~ 801 2019-07-22 11:00:43 7 XclNam~ XStorageN~ 2019-07-22 11:00:~ 0_2_~ Soft_SCSI_~ 801 2019-07-22 11:00:44 8 XclNam~ XStorageN~ 2019-07-22 12:02:~ 0_2_~ Soft_SCSI_~ 801 2019-07-22 12:02:31 9 XclNam~ XStorageN~ 2019-07-23 23:29:~ 0_3_8 Soft_SCSI_~ 801 2019-07-23 23:29:49 10 XclNam~ XStorageN~ 2019-07-13 00:01:~ 0_3_9 Soft_SCSI_~ 801 2019-07-13 00:01:46 # ... with 2,695 more rows</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ุฃุฐูู ุดูุก ูู ุฃู ุฏูุฑุฉ ุงูุงูุชุฑุงุน ุงููุชูุงุฒู ูุฌููุน ุฃูุธูุฉ ุงูุชุฎุฒูู <strong>ูุง</strong> ุชุณุชุบุฑู <strong>30 ุฏูููุฉ ุ ูููู 30 ุซุงููุฉ</strong> . </p><br><p style=";text-align:right;direction:rtl">  <em>ุงูุญูุฏ ููู ุฃู ูุฐุง ููุณ ูู ุงูุญุงู ุนูุฏูุง ุชููู 30 ุซุงููุฉ ุณุฑูุนุฉ ุฌุฏูุง.</em> <br><img src="https://habrastorage.org/webt/pr/nf/u9/prnfu9eet3au2ktv5-uk1vauskk.jpeg" alt="ูุฒุญุฉ"></p><br><p style=";text-align:right;direction:rtl">  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃู ุดูุฑุฉ <strong>PowerShell</strong> ุฌูุนุช ุฃูุถูุง ุงูุฃุฑูุงู ุงูุชุณูุณููุฉ ููุฃูุฑุงุต ูู ุฌููุน ุฃูุธูุฉ ุงูุชุฎุฒูู ูู ุฏูุฑุฉ ุ ููู ููุช ุฅุนุงุฏุฉ ูุชุงุจุฉ ุงูููุฏ ุนูู <strong>R ุ ูุงูุช</strong> ูุฐู ุงูุจูุงูุงุช ุฒุงุฆุฏุฉ ุนู ุงูุญุงุฌุฉ.  ูุฐุง ูุฅู ููุงุฑูุฉ ููุช ุงูุชุดุบูู ููุณุช ุตุงุฏูุฉ ุชูุงููุง ุ ููููุง ูุง ุฒุงูุช ูุซูุฑุฉ ููุฅุนุฌุงุจ. </p><br><h3 id="4-5-obrabotka-i-preobrazovanie-dannyh-formirovanie-xlsx-dokumenta" style=";text-align:right;direction:rtl">  4-5.  ูุนุงูุฌุฉ ูุชุญููู ุงูุจูุงูุงุช.  ุฅูุดุงุก ูุณุชูุฏ xlsx </h3><br><p style=";text-align:right;direction:rtl">  ุชู ุชูููู ุชุญููู ุจูุงูุงุช ูุณุชูุฏุงุช xlsx ุฅูู ุชุตููุฉ ุงูุฌุฏูู ุงููุตุฏุฑ ูู ุขุฎุฑ 3 ุฃูุงู ุ ููุฐูู ูู ุงูุดูุฑ ุงููุงุถู ูุชุญููู ุงูุฃุนูุฏุฉ ุจุฃุณูุงุก ุงูุฎุทุฃ ุฅูู ุงูุชูุณูู "ุงูุฃููู" ุ ุจุญูุซ ูููู ูู ููุน ูู ุงูุฃุฎุทุงุก ูู ุนููุฏ ูููุตู.  ุชูุช ูุชุงุจุฉ ูุธููุฉ ูููุตูุฉ ููุฐุง (ุญุชู ูุง ูุชู ุชูุฑุงุฑ ููุณ ุงูุฎุทูุงุช ูุฑุชูู) </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุธููุฉ ุชุตููุฉ ุงููุตุฏุฑ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs">myErrorStats &lt;- function(data, period, orderColname = quo(Soft_Media_Error)) { data %&gt;% filter(Date &gt; period) %&gt;% group_by(cl, Storage, Disk, Error) %&gt;% summarise(count = n()) %&gt;% spread(Error, count, fill = <span class="hljs-number"><span class="hljs-number">0</span></span>) %&gt;% arrange(desc(!!orderColname)) }</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูุนุฑุถ ุฃููุงุน ุงูุฃุฎุทุงุก ูู ุนููุฏ ูููุตู ุ ุชู ุชุทุจูู ูุธููุฉ <strong>ุงูุญุดู</strong> ูุน <strong>ููุก</strong> ุงูููุชุงุญ ุงูุฅุถุงูู <strong>= 0</strong> ุ ูุน ููุก ุงูููู ุงูููููุฏุฉ ุจู <strong>0</strong> .  ุจุฏูู ูุฐุง ุงูููุชุงุญ ุ ุฅุฐุง ูู ููู ููุงู ููุน ูู ุงูุฃุฎุทุงุก ูู ููู ูุง ุ ูุณูุญุชูู ุงูุนููุฏ ุงูููุงุจู ุนูู ููู <strong>NA</strong> . </p><br><p style=";text-align:right;direction:rtl">  ุฃูุถูุง ุ ูู ุงููุธููุฉ ุ ุฃุฑุฏุช ุงูุงุญุชูุงุธ ุจุงููุฏุฑุฉ ุนูู ุชูุฑูุฑ ุงุณู ุงูุนููุฏ ูููุฑุฒ ููุชุบูุฑ ุ ูููู ูู ุงูููุช ููุณู ุ ุชุญุชูู ุนูู ููู ุงูุชุฑุงุถูุฉ ููุฐุง ุงููุชุบูุฑ.  ููุฐุง ุงูุบุฑุถ ุ <strong>ูุชู ุงุณุชุฎุฏุงู</strong> ุจูุงุก ุงูุฌููุฉ ุงูุบุฑูุจ ุ ูุงูุฐู ููููู ูุฑุงุกุฉ ุงููุฒูุฏ ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ููุง</a> . </p><br><p style=";text-align:right;direction:rtl">  ูู ุญุงูุชูุง ุ ุนูุฏ ุชุญุฏูุฏ ูุนููุงุช ุฏุงูุฉ ุ ูุถุน ูุงุญุฏุฉ ูููุง ุนูู ุงููููุฉ ุงูุงูุชุฑุงุถูุฉ <strong>ูููุชุจุณูุง</strong> ( <strong>orderColname = quo (Soft_Media_Error)</strong> ) ุ ุซู ุ ุนูุฏ ุงุณุชุฏุนุงุก ุ ูุถุน ุงูุฃุญุฑู ุฃูุงููุง <strong>!!</strong>  ููุญุตูู ุนูู <strong>ุชุฑุชูุจ (ุชูุงุฒูู (!! orderColname))</strong> . </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุธูุฑ ุงูุฌุฏูู ูุน ูุฌูุฏ ุฃุฎุทุงุก ููุฐุง ุงูุดูุฑ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs">&gt; errorsBigPeriod <span class="hljs-comment"><span class="hljs-comment"># A tibble: 77 x 7 cl Storage Disk Hard_SCSI_Bus_E~ Recommend_Disk_~ Soft_Media_Error &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; 1 XclN~ XStora~ 1_1_~ 0 1 64 2 XclN~ XStora~ 0_2_5 0 0 29 3 XclN~ XStora~ 1_1_~ 0 1 29 4 XclN~ XStora~ 0_3_2 0 0 27 5 XclN~ XStora~ 0_3_~ 1 0 25 6 XclN~ XStora~ 1_3_5 0 1 23 7 XclN~ XStora~ 0_2_9 0 0 21 8 XclN~ XStora~ 0_3_4 0 0 14 9 XclN~ XStora~ 0_1_~ 0 0 14 10 XclN~ XStora~ 1_0_1 0 0 12 # ... with 67 more rows, and 1 more variable: Soft_SCSI_Bus_Error &lt;dbl&gt;</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ููุฏ ููุช ุจุชุญููู ุชูููู ูุณุชูุฏ xlsx ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุงูุฉ ุญูู ุชูุงุฑูุฑ ุญุงูุฉ VM</a> ุ ูุฐูู ูู ุฃุชูุงูู ุจุงูุชูุตูู.  ูุชู ุฅุนุทุงุก ูู ุฑูุฒ ูู ููุงูุฉ ุงูููุงู. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/td/7v/vx/td7vvxmj5guiwtxhjyxif4cany8.jpeg"></p><br><p style=";text-align:right;direction:rtl">  ูููุง ููู ุจุนุถ ุงูููุฒุงุช ุงููููุฉ ุงูุชู ุชุฒูุฏ ูู ุณูููุฉ ูุฑุงุกุฉ ุงูุชูุฑูุฑ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุนูุงูุงุช ุงูุชุจููุจ ุงููููุนุฉ (ุจุดูู ุงูุชุฑุงุถู ุ ุงูุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู ููุชูุญ) ุ </li><li style=";text-align:right;direction:rtl">  ุฃุณูุงุก ุงูุฃุนูุฏุฉ ุงููููุฒุฉ </li><li style=";text-align:right;direction:rtl">  ุงูุชูุณูู ุงูุชููุงุฆู ูุฌููุน ุงูุฃุนูุฏุฉ ุจุญูุซ ูููู ูู ุงููุต ูุงุจูุงู ูููุฑุงุกุฉ ุฏูู ุงูุญุงุฌุฉ ุฅูู ุชูุณูุน ุงูุฃุนูุฏุฉ. </li></ul><br><h3 id="6-formiruem-grafik-kotoryy-sohranyaem-v-png" style=";text-align:right;direction:rtl">  6. ุฅูุดุงุก ุฌุฏูู ูุญูุธู ูู ุจุงุจูุง ููู ุบูููุง </h3><br><p style=";text-align:right;direction:rtl">  ุนูู ุงูุฑุณู ุงูุจูุงูู ุ ุฃุฑุฏุช ุงูุญุตูู ุนูู ุฅุฌูุงูู ุนุฏุฏ ุงูุฃุฎุทุงุก ูููููุง ูุฌููุน ุฃูุธูุฉ ุงูุชุฎุฒูู ุญุณุจ ุงูููุน.  ูุฃุฏุงุฉ ุฑุณู ุ ุชูุฑุฑ ุงุณุชุฎุฏุงู ููุชุจุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ggplot2</a> ุงูููุงุณูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุฃุธูุฑ ุงูุฅุตุฏุงุฑ ุงูุฃูู ูู ุงูุฑุณู ุงูุจูุงูู ุฌููุน ุงูุฃุฎุทุงุก ูู ุฑุณู ุจูุงูู ูุงุญุฏ ูุจุฏุง ููุง ููู: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/7t/jc/aj/7tjcajacotjzcoo3y0j9oc2od80.png"></p><br><p style=";text-align:right;direction:rtl">  ูุงู ุงูุฒููุงุก ุฃูู ุงุชุถุญ ุฃูู ุบูุฑ ูุงุจู ูููุฑุงุกุฉ. <br><del>  ูุงุฐุง ุณููููููุ </del><br>  ุชู ุฃุฎุฐ ุงูููุงุญุธุงุช ูู ุงูุงุนุชุจุงุฑ ูุชูุช ุฅุถุงูุฉ ูุธููุฉ <strong>facet_grid</strong> ุฅูู ุงูุฃุนูุฏุฉ ุงูููุงุณูุฉ ( <strong>geom_bar</strong> ) ูุชูุณูู ุงููุชูุฌุฉ ุฅูู ุฑุณูู ุจูุงููุฉ ูููุตูุฉ ุญุณุจ ููุน ุงูุฎุทุฃ. <br>  ุงููุชูุฌุฉ ุงูููุงุฆูุฉ ุชูุงุณุจ ุงูุฌููุน. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/l1/vc/v5/l1vcv5950ji9iymrlyrij0uds3w.png" alt="ุฌุฏูู ููุฎุต"></p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅุนุฏุงุฏ ุงูุจูุงูุงุช ุ ุงูุฑุณูู ุงูุจูุงููุฉ ุ ุญูุธ ุฅูู ููู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">####   #### #       errorsTotal &lt;- errors_df %&gt;% group_by(Date, Error) %&gt;% summarise(count = n()) %&gt;% # spread(Error, count, fill = 0) %&gt;% arrange(desc(Date)) #        . #       ,   . plot &lt;- errorsTotal %&gt;% ggplot(aes(x = Date, y = count, fill = Error)) + geom_bar(stat = "identity", width = 0.5, color = "grey") + theme_minimal() + # theme(legend.position="top") + scale_color_grey() + labs(title = "  EMC VNX", subtitle = "        ", fill = " ") + xlab("") + ylab("   ") + scale_fill_brewer(palette = "Spectral") + facet_grid(rows = vars(factor( Error, levels = c( "Soft_SCSI_Bus_Error", "Soft_Media_Error", "Hard_SCSI_Bus_Error", "Recommend_Disk_Replacement" ) ))) # #   # plot #   png,     plot_filePath &lt;- file.path("results", "plot.png") #    png     ggsave(filename = plot_filePath, plot = plot)</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูู ุงููุซูุฑ ููุงูุชูุงู ูู ุชุดููู ุงูุฌุฏูู ุงูุฒููู. </p><br><p style=";text-align:right;direction:rtl">  ุฃุฑุฏุช ุฃู ุชููู ุงููุฎุทุทุงุช ุจุชุฑุชูุจ ูุนูู.  ููููุงู ุจุฐูู ุ ูุงู ูุง ุจุฏ ูู ููู ูุนุงูู ุชูููู ุงูุตููู ูู <strong>facet_grid</strong> ูุนุงูู ุ ุฃู ุญุชู <strong>ูุนุงูู</strong> <strong>ููุธู</strong> .  ุงูุนุงูู ูู ูุซู ูุฐุง ุงูุชูุณูู ููุจูุงูุงุช ุงููุงูุฑุฉ ูู R ุ ููู ุนุจุงุฑุฉ ุนู ูุฌููุนุฉ ูู ุงูููู (ูู ุญุงูุชูุง ุ ุงูุณูุงุณู ุ ุฃู <strong>ุงูุฃุญุฑู</strong> ) ุ ููุชู ุชุนุฑูู ูุฌููุนุฉ ูุฐู ุงูููู ุจุฏูุฉ (ุชุณูู ูุณุชููุงุช ุนุงูู) ุ ูุญุชู ูุชู ูุฑุฒ ูุฐู ุงููุณุชููุงุช.  ูุจุฏู ุงูุฃูุฑ ูุนูุฏูุง ุ ููู ูู ุดูุก ููุน ูู ููุงูู ุงูุตุญูุญ ุฅุฐุง ููุช ุฅู ุฃุณูุงุก ุงูุฃุดูุฑ ูู ูุซุงู ุฑุงุฆุน ุนูู ุนุงูู ูุฑุชุจ.  ุฃู  ูุญู ูุนุฑู ุฃุณูุงุก ุฃุดูุฑ ูููู ุฃู ูููู ููุง ุ ููุนุฑู ุฃูุถูุง (ุฌูุฏูุง ุ ุขูู) ุฃู ูุฃุชู ุฃููุงู ููุงูุฑ ุซู ูุจุฑุงูุฑ ุซู ูุงุฑุณ ููุง ุฅูู ุฐูู.  ุนูู ููุณ ุงููุจุฏุฃ ุงูุฐู ูุฎููู ุนุงููุง. </p><br><h3 id="7-8-formiruem-pismo-soderzhaschee-sobrannye-dannye-otpravlyaem-pismo" style=";text-align:right;direction:rtl">  7-8.  ูุญู ุชุดููู ุฑุณุงูุฉ ุชุญุชูู ุนูู ุงูุจูุงูุงุช ุงูุชู ุชู ุฌูุนูุง.  ุฅุฑุณุงู ุฎุทุงุจ </h3><br><p style=";text-align:right;direction:rtl">  ููุง ุชู ุงููุธุฑ ูู ุชุดููู ูุฅุฑุณุงู ุงูุฑุณุงุฆู ุ ููุฐูู ุชุดููู ุงูููุงู ูู <strong>ูููุฏูุฒ ุฌุฏููุฉ</strong> ูู ููุงู ุนู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชูุงุฑูุฑ ุนู ุญุงูุฉ VM</a> .  ูุญู ุจุจุณุงุทุฉ ูุถุน ุจุนุถ ุงููุชุบูุฑุงุช ูู ุงููุต ูููุณููุง ุจุดูู ุฃู ุจุขุฎุฑ.  ูุง ุชูุณู ุงููุฑูู. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงูุดูู ุงูููุงุฆู ููุฑุณุงูุฉ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/w6/rg/fi/w6rgfilewjuf24olnavadpu6zhm.jpeg"></p></div></div><br><h2 id="vyvody" style=";text-align:right;direction:rtl">  ุงููุชุงุฆุฌ </h2><br><p style=";text-align:right;direction:rtl">  ุฃุซุจุชุช <strong>R</strong> ูุฑุฉ ุฃุฎุฑู ุฃููุง ุฃุฏุงุฉ ุนุงูููุฉ ูุฃุฏุงุก ุงูููุงู ุงูููููุฉ ูุชุตูุฑ ูุชุงุฆุฌูุง.  ููุน ุชูููู ุงูุญูุณุจุฉ ุงููุชูุงุฒูุฉ ุ ุชุตุจุญ ูุฐู ุงูุฃุฏุงุฉ ุฃูุถูุง ุณุฑูุนุฉ. <br>  ุฃุธูุฑุช ุงูููุงุฑุณุฉ ุฃูุถูุง ุฃู <strong>PowerShell</strong> ุจุทูุก ุฌุฏูุง ูู ุชุญููู ุงูุณุฌูุงุช ูุชุฑุฌูุชูุง ุฅูู ุชูุณูู ูุงุจู ูููุฑุงุกุฉ. <br>  ุดูุฑุง ุฌุฒููุง ููุฌููุน ุงูุฐูู ูุฑุฃูุง ุงููุซูุฑ ูู ุงูุฑุณุงุฆู ุญุชู ุงูููุงูุฉ. </p><br><h4 id="polnostyu-kod-prilozheniya" style=";text-align:right;direction:rtl">  ุฑูุฒ ุงูุชุทุจูู ุงููุงูู </h4><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฑูุฒ ุงูุชุทุจูู ุงููุงูู R</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#### ENV #### #         (    system32) setwd("C:\\Scripts\\VNX_disks_check/") #   library(tidyverse) library(lubridate) library(zoo) library(stringi) library(xlsx) library(mailR) library(foreach) library(doParallel) #### CONST #### #            vnxIPfilePath &lt;- file.path("data", "VNX-IP.csv") #     bigPeriod &lt;- Sys.Date() - 30 #     smallPeriod &lt;- Sys.Date() - 3 #    productCls &lt;- c("name1", "name2", "name3") #   IP VNX. #         , #   ip        . VNX_ip &lt;- vnxIPfilePath %&gt;% read_csv2( col_types = cols( Name = col_character(), IP = col_character(), cl = col_character(), type = col_character(), newA = col_character(), newB = col_character(), oldA = col_character(), oldB = col_character() ) ) %&gt;% filter(cl %in% productCls) %&gt;% gather(key = "cntName", value = "cntIP", 5:6) ####    VNX #### #         (      ) # NaviSECCli.exe -scope 0 -h 10.201.16.15 -user root -password Secrt4yo getlog -date 07/16/2019 07/17/2019 #   ,   . #      ,       errorNumbers &lt;- c("\\(820\\)", "\\(803\\)", "\\(801\\)", "\\(920\\)", "\\(901\\)") ##   ## #         numCores &lt;- detectCores() registerDoParallel(numCores) #    ,   NaviCLI #  1    ,     "" , # ..   ,      ,     . bigPeriodForm &lt;- bigPeriod %&gt;% format(format = "%m/%d/%Y") currDateForm &lt;- (Sys.Date() + 1) %&gt;% format(format = "%m/%d/%Y") #    . #      VNX   ip   . #      ,      #   ,      dataframe #  %dopar%   . #    ,   system.time   , #    %dopar%  %do%.      4-5. # system.time({ errors_df &lt;- foreach(i = 1:nrow(VNX_ip), .combine = rbind, .packages = "tidyverse") %dopar% { errors_raw &lt;- system( paste( "NaviSECCli.exe -scope 0 -h", VNX_ip$cntIP[i], "-user myusername -password mypassword getlog -date", bigPeriodForm, currDateForm ), intern = TRUE ) %&gt;% str_subset(pattern = regex(paste0(errorNumbers, collapse = "|"))) #      ,       if (length(errors_raw) &gt; 0) { #       , #     , #       . errorsDescr &lt;- errors_raw %&gt;% gsub("(.*\\) )(.*)(\\s+\\[.*)", "\\2", x = .) %&gt;% trimws() %&gt;% gsub('([[:punct:]])|\\s+', '_', .) #           errors &lt;- errors_raw %&gt;% str_split(pattern = "\\s+", simplify = T) %&gt;% as_tibble() %&gt;% mutate(Disk = paste0(V4, "_", V6, "_", V8) %&gt;% gsub( pattern = "\\([0-9]{3}\\)", replacement = "", x = .) ) #  dataframe    data_frame(cl = VNX_ip$cl[i], Storage = VNX_ip$Name[i], Date = errors$V1 %&gt;% as.Date(format = "%m/%d/%Y"), Time = errors$V2, Disk = errors$Disk, Error = errorsDescr, eCode = errors$V8 %&gt;% str_extract(paste0(errorNumbers, collapse = "|")) %&gt;% str_extract("[0-9]+")) %&gt;% mutate(DateTime = as.POSIXct(paste(Date, Time), format = "%Y-%m-%d %H:%M:%S")) } } # }) #     .      ,    . stopImplicitCluster() ####  #### #    .    ,     .  . # https://dplyr.tidyverse.org/articles/programming.html myErrorStats &lt;- function(data, period, orderColname = quo(Soft_Media_Error)) { data %&gt;% filter(Date &gt; period) %&gt;% group_by(cl, Storage, Disk, Error) %&gt;% summarise(count = n()) %&gt;% spread(Error, count, fill = 0) %&gt;% arrange(desc(!!orderColname)) } #           .  . errorsBigPeriod &lt;- errors_df %&gt;% myErrorStats(bigPeriod) #             errorsSmallPeriod &lt;- errors_df %&gt;% myErrorStats(smallPeriod) #   ,     errors_filePath &lt;- file.path("results", "VNX_Errors.xlsx") ####  xlsx  #### #    wb&lt;-createWorkbook(type="xlsx") #         TABLE_ROWNAMES_STYLE &lt;- CellStyle(wb) + Font(wb, isBold=TRUE) TABLE_COLNAMES_STYLE &lt;- CellStyle(wb) + Font(wb, isBold=TRUE) + Alignment(wrapText=TRUE, horizontal="ALIGN_CENTER") + Border(color="black", position=c("TOP", "BOTTOM"), pen=c("BORDER_THIN", "BORDER_THICK")) #  t s sheetSmall &lt;- createSheet(wb, sheetName = " 3 ") sheetBig &lt;- createSheet(wb, sheetName = " ") sheetRaw &lt;- createSheet(wb, sheetName = " ") ##   addDataFrame( errorsSmallPeriod %&gt;% as.data.frame(), sheetSmall, startRow = 1, startColumn = 1, row.names = FALSE, byrow = FALSE, colnamesStyle = TABLE_COLNAMES_STYLE, rownamesStyle = TABLE_ROWNAMES_STYLE ) addDataFrame( errorsBigPeriod %&gt;% as.data.frame(), sheetBig, startRow = 1, startColumn = 1, row.names = FALSE, byrow = FALSE, colnamesStyle = TABLE_COLNAMES_STYLE, rownamesStyle = TABLE_ROWNAMES_STYLE ) #          DateTime     addDataFrame( errors_df %&gt;% as.data.frame() %&gt;% arrange(desc(DateTime)), sheetRaw, startRow = 1, startColumn = 1, row.names = FALSE, byrow = FALSE, colnamesStyle = TABLE_COLNAMES_STYLE, rownamesStyle = TABLE_ROWNAMES_STYLE ) #  ,     autoSizeColumn(sheet = sheetSmall, colIndex=c(1:ncol(errorsSmallPeriod))) autoSizeColumn(sheet = sheetBig, colIndex=c(1:ncol(errorsBigPeriod))) autoSizeColumn(sheet = sheetRaw, colIndex=c(1:ncol(errors_df))) #     .   - . if (file.exists(errors_filePath)) {file.remove(errors_filePath)} #  xlsx  saveWorkbook(wb, errors_filePath) ####   #### #       errorsTotal &lt;- errors_df %&gt;% group_by(Date, Error) %&gt;% summarise(count = n()) %&gt;% # spread(Error, count, fill = 0) %&gt;% arrange(desc(Date)) #         plot &lt;- errorsTotal %&gt;% ggplot(aes(x = Date, y = count, fill = Error)) + geom_bar(stat = "identity", width = 0.5, color = "grey") + theme_minimal() + # theme(legend.position="top") + scale_color_grey() + labs(title = "  EMC VNX", subtitle = "        ", fill = " ") + xlab("") + ylab("   ") + scale_fill_brewer(palette = "Spectral") + facet_grid(rows = vars(factor( Error, levels = c( "Soft_SCSI_Bus_Error", "Soft_Media_Error", "Hard_SCSI_Bus_Error", "Recommend_Disk_Replacement" ) ))) # #   # plot #   png,     plot_filePath &lt;- file.path("results", "plot.png") #    png     ggsave(filename = plot_filePath, plot = plot) ####    #### #    emailRecepientsList &lt;- c("sendall-tech@domain.ru") #      emailParams &lt;- list( from = "login@domain.ru", to = emailRecepientsList, smtpParams = list( host.name = "10.10.10.1", port = 25, user.name = "login@domain.ru", passwd = "mypassword", ssl = FALSE ) ) #     (    ). #     ,          ,     . errorsTotal &lt;- errorsSmallPeriod[-c(1,2,3)] %&gt;% sum() #    emailBody &lt;- paste0( '&lt;html&gt; &lt;h3&gt; ,  .&lt;/h3&gt; &lt;p&gt;  3    &lt;strong&gt;', errorsTotal, '&lt;/strong&gt;    EMC VNX&lt;/p&gt; &lt;p&gt;       ,      .&lt;/p&gt; &lt;p&gt;  3 : &lt;ul&gt; &lt;li&gt;   3 .   &lt;strong&gt;Soft_Media_Error&lt;/strong&gt;.&lt;/li&gt; &lt;li&gt;  30 .   &lt;strong&gt;Soft_Media_Error&lt;/strong&gt;.&lt;/li&gt; &lt;li&gt; .   &lt;strong&gt;&lt;/strong&gt;.&lt;/li&gt; &lt;/ul&gt;          .   .&lt;/p&gt; &lt;p&gt;&lt;img src="', plot_filePath, '"&gt;&lt;/p&gt; &lt;/html&gt;' ) ####      #### send.mail(from = emailParams$from, to = emailParams$to, subject = "     EMC VNX", body = emailBody, encoding = "utf-8", html = TRUE, inline = TRUE, smtp = emailParams$smtpParams, authenticate = TRUE, send = TRUE, attach.files = c(errors_filePath), debug = FALSE)</span></span></code> </pre> </div></div><br><h2 id="parametry-okruzheniya-i-versii-ispolzuemogo-po" style=";text-align:right;direction:rtl">       </h2><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <strong> </strong> : EMC VNX 5300 </li><li style=";text-align:right;direction:rtl"> <strong>    </strong> : NaviCLI-Win-32-x86-en_US-7.31.25.1.29-1 </li><li style=";text-align:right;direction:rtl"> <strong>  ,    </strong> : 4*2 CPU, 8 Gb RAM </li></ul><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title">  R</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs">&gt; sessionInfo() R version <span class="hljs-number"><span class="hljs-number">3.5</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span> (<span class="hljs-number"><span class="hljs-number">2019</span></span><span class="hljs-number"><span class="hljs-number">-03</span></span><span class="hljs-number"><span class="hljs-number">-11</span></span>) Platform: x86_64-w64-mingw32/x64 (<span class="hljs-number"><span class="hljs-number">64</span></span>-bit) Running under: Windows Server <span class="hljs-number"><span class="hljs-number">2012</span></span> R2 x64 (build <span class="hljs-number"><span class="hljs-number">9600</span></span>) Matrix products: default locale: [<span class="hljs-number"><span class="hljs-number">1</span></span>] LC_COLLATE=Russian_Russia<span class="hljs-number"><span class="hljs-number">.1251</span></span> LC_CTYPE=Russian_Russia<span class="hljs-number"><span class="hljs-number">.1251</span></span> LC_MONETARY=Russian_Russia<span class="hljs-number"><span class="hljs-number">.1251</span></span> [<span class="hljs-number"><span class="hljs-number">4</span></span>] LC_NUMERIC=C LC_TIME=Russian_Russia<span class="hljs-number"><span class="hljs-number">.1251</span></span> attached base packages: [<span class="hljs-number"><span class="hljs-number">1</span></span>] parallel stats graphics grDevices utils datasets methods base other attached packages: [<span class="hljs-number"><span class="hljs-number">1</span></span>] taskscheduleR_1<span class="hljs-number"><span class="hljs-number">.4</span></span> pander_0<span class="hljs-number"><span class="hljs-number">.6</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span> doParallel_1<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.14</span></span> iterators_1<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.10</span></span> foreach_1<span class="hljs-number"><span class="hljs-number">.4</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span> mailR_0<span class="hljs-number"><span class="hljs-number">.4</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> [<span class="hljs-number"><span class="hljs-number">7</span></span>] xlsx_0<span class="hljs-number"><span class="hljs-number">.6</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> stringi_1<span class="hljs-number"><span class="hljs-number">.4</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span> zoo_1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">-6</span></span> lubridate_1<span class="hljs-number"><span class="hljs-number">.7</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span> wesanderson_0<span class="hljs-number"><span class="hljs-number">.3</span></span><span class="hljs-number"><span class="hljs-number">.6</span></span> forcats_0<span class="hljs-number"><span class="hljs-number">.4</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> [<span class="hljs-number"><span class="hljs-number">13</span></span>] stringr_1<span class="hljs-number"><span class="hljs-number">.4</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> dplyr_0<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span> purrr_0<span class="hljs-number"><span class="hljs-number">.3</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span> readr_1<span class="hljs-number"><span class="hljs-number">.3</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> tidyr_0<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span> tibble_2<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span> [<span class="hljs-number"><span class="hljs-number">19</span></span>] ggplot2_3<span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> tidyverse_1<span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> loaded via a namespace (<span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> attached): [<span class="hljs-number"><span class="hljs-number">1</span></span>] tidyselect_0<span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.5</span></span> reshape2_1<span class="hljs-number"><span class="hljs-number">.4</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span> rJava_0<span class="hljs-number"><span class="hljs-number">.9</span></span><span class="hljs-number"><span class="hljs-number">-11</span></span> haven_2<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> lattice_0<span class="hljs-number"><span class="hljs-number">.20</span></span><span class="hljs-number"><span class="hljs-number">-38</span></span> colorspace_1<span class="hljs-number"><span class="hljs-number">.4</span></span><span class="hljs-number"><span class="hljs-number">-1</span></span> [<span class="hljs-number"><span class="hljs-number">7</span></span>] vctrs_0<span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> generics_0<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span> utf8_1<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span> rlang_0<span class="hljs-number"><span class="hljs-number">.4</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> R.oo_1<span class="hljs-number"><span class="hljs-number">.22</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> pillar_1<span class="hljs-number"><span class="hljs-number">.4</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span> [<span class="hljs-number"><span class="hljs-number">13</span></span>] glue_1<span class="hljs-number"><span class="hljs-number">.3</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> withr_2<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span> R.utils_2<span class="hljs-number"><span class="hljs-number">.9</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> RColorBrewer_1<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">-2</span></span> modelr_0<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span> readxl_1<span class="hljs-number"><span class="hljs-number">.3</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> [<span class="hljs-number"><span class="hljs-number">19</span></span>] plyr_1<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span> munsell_0<span class="hljs-number"><span class="hljs-number">.5</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> gtable_0<span class="hljs-number"><span class="hljs-number">.3</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> cellranger_1<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> rvest_0<span class="hljs-number"><span class="hljs-number">.3</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span> R.methodsS3_1<span class="hljs-number"><span class="hljs-number">.7</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> [<span class="hljs-number"><span class="hljs-number">25</span></span>] codetools_0<span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">-16</span></span> labeling_0<span class="hljs-number"><span class="hljs-number">.3</span></span> fansi_0<span class="hljs-number"><span class="hljs-number">.4</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> xlsxjars_0<span class="hljs-number"><span class="hljs-number">.6</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> broom_0<span class="hljs-number"><span class="hljs-number">.5</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span> Rcpp_1<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> [<span class="hljs-number"><span class="hljs-number">31</span></span>] scales_1<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> backports_1<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span> jsonlite_1<span class="hljs-number"><span class="hljs-number">.6</span></span> digest_0<span class="hljs-number"><span class="hljs-number">.6</span></span><span class="hljs-number"><span class="hljs-number">.20</span></span> hms_0<span class="hljs-number"><span class="hljs-number">.5</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> grid_3<span class="hljs-number"><span class="hljs-number">.5</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span> [<span class="hljs-number"><span class="hljs-number">37</span></span>] cli_1<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> tools_3<span class="hljs-number"><span class="hljs-number">.5</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span> magrittr_1<span class="hljs-number"><span class="hljs-number">.5</span></span> lazyeval_0<span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span> crayon_1<span class="hljs-number"><span class="hljs-number">.3</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span> pkgconfig_2<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span> [<span class="hljs-number"><span class="hljs-number">43</span></span>] zeallot_0<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> data.table_1<span class="hljs-number"><span class="hljs-number">.12</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span> xml2_1<span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> assertthat_0<span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> httr_1<span class="hljs-number"><span class="hljs-number">.4</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> rstudioapi_0<span class="hljs-number"><span class="hljs-number">.10</span></span> [<span class="hljs-number"><span class="hljs-number">49</span></span>] R6_2<span class="hljs-number"><span class="hljs-number">.4</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> nlme_3<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">-137</span></span> compiler_3<span class="hljs-number"><span class="hljs-number">.5</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span></code> </pre> </div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar461441/">https://habr.com/ru/post/ar461441/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar461431/index.html">"ูุญุจ ูููุฑู": DNS ุนุจุฑ HTTPS</a></li>
<li><a href="../ar461433/index.html">ุจุงุณุชุฎุฏุงู ุฎุงุฏู ุงููููุฉ 4 ูู ุตุงูู ููุฑ 3.0</a></li>
<li><a href="../ar461435/index.html">ุงูุชุนุฑู ุนูู ุงููุดุงุนุฑ ุจุงุณุชุฎุฏุงู ุดุจูุฉ ุนุตุจูุฉ ุชูุงููููุฉ</a></li>
<li><a href="../ar461437/index.html">370 ุงููุตุงุจูุญ ุงูููุฑุจุงุฆูุฉ</a></li>
<li><a href="../ar461439/index.html">ุจุฏุก ุชุดุบูู ููุชุจุฉ ูููู React ู TypeScript</a></li>
<li><a href="../ar461443/index.html">ุจุนุฏ ุงูุชุญููู: ูุง ูู ูุนุฑูู ุนู ุงููุฌูู ุงูุฃุฎูุฑ ุนูู ุดุจูุฉ ุฎุงุฏู ููุชุงุญ ุชุดููุฑ SKS Keyserver</a></li>
<li><a href="../ar461447/index.html">ุงูููุญูุฉ ุญูู ูุณุคููู ุงููุธุงู ูููุน ููุฏุฏ ุจุงูุงููุฑุงุถ</a></li>
<li><a href="../ar461449/index.html">PhpStorm 2019.2: ุฎุตุงุฆุต PHP 7.4 ุงูููุชูุจุฉ ุ ู Finder Duplicate ุ ู EditorConfig ุ ู Script Script ุ ูุงููุฒูุฏ</a></li>
<li><a href="../ar461451/index.html">ูููู ุงูุซุงูู ูุน ูุงููู: ูุณุฑูุฑ ุ ููู ููุณ ูุณุชุนุฏูุง ููุฐูุงุจ ุจุนุฏ</a></li>
<li><a href="../ar461455/index.html">Habr Weekly # 11 / ููุงุฐุง ูุญุชุงุฌ ุฅูู ุฌุงูุนุงุช ุงูุขู ุ ูุง ูู ูุธููุฉ "ุญููููุฉ" ุ ุชู ุงูุงูุชูุงุก ูู Galaxy Fold</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>