<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏿‍🎤 🚉 👨🏼‍🔬 Otimizações usadas no Python: lista e tupla 🧜🏼 👋🏽 🏔️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No Python, existem dois tipos semelhantes - lista (lista) e tupla (tupla). A diferença mais famosa entre os dois é que as tuplas são imutáveis. 

 Voc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Otimizações usadas no Python: lista e tupla</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/417783/">  No Python, existem dois tipos semelhantes - lista (lista) e tupla (tupla).  A diferença mais famosa entre os dois é que as tuplas são imutáveis. <br><br>  Você não pode alterar objetos na tupla: <br><br><pre><code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>a = (<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>) &gt;&gt;&gt; a[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-number"><span class="hljs-number">10</span></span> Traceback (most recent call last): File <span class="hljs-string"><span class="hljs-string">"&lt;stdin&gt;"</span></span>, line <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> &lt;module&gt; TypeError: <span class="hljs-string"><span class="hljs-string">'tuple'</span></span> object does <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> support item assignment</code> </pre> <br>  Mas você pode modificar objetos mutáveis ​​dentro de uma tupla: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>b = (<span class="hljs-number"><span class="hljs-number">1</span></span>,[<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>],<span class="hljs-number"><span class="hljs-number">3</span></span>) &gt;&gt;&gt; b[<span class="hljs-number"><span class="hljs-number">1</span></span>] [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>] &gt;&gt;&gt; b[<span class="hljs-number"><span class="hljs-number">1</span></span>].append(<span class="hljs-number"><span class="hljs-number">4</span></span>) &gt;&gt;&gt; b (<span class="hljs-number"><span class="hljs-number">1</span></span>, [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>], <span class="hljs-number"><span class="hljs-number">3</span></span>)</code> </pre><a name="habracut"></a><br>  Dentro do CPython (intérprete padrão), a lista e a tupla são implementadas como uma folha de ponteiros (links) para objetos Python, ou seja,  fisicamente, eles não armazenam objetos próximos um do outro.  Quando você exclui um objeto da lista, a referência a esse objeto é excluída.  Se outra pessoa se referir ao objeto, ele continuará na memória. <br><br><h4>  Tuplas </h4><br>  Apesar do fato de as tuplas serem muito menos comuns no código e não tão populares, esse é um tipo muito fundamental que o Python constantemente usa para fins internos. <br><br>  Você pode não perceber, mas usa tuplas quando: <br><br><ul><li>  trabalhar com argumentos ou parâmetros (eles são armazenados como tuplas) </li><li>  retorna duas ou mais variáveis ​​de uma função </li><li>  itere chaves de valor em um dicionário </li><li>  use formatação de string </li></ul><br>  Normalmente, o script mais simples usa milhares de tuplas: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> gc &gt;&gt;&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">type_stats</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(type_obj)</span></span></span><span class="hljs-function">:</span></span> ... count = <span class="hljs-number"><span class="hljs-number">0</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> obj <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> gc.get_objects(): ... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> type(obj) == type_obj: ... count += <span class="hljs-number"><span class="hljs-number">1</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> count ... &gt;&gt;&gt; type_stats(tuple) <span class="hljs-number"><span class="hljs-number">3136</span></span> &gt;&gt;&gt; type_stats(list) <span class="hljs-number"><span class="hljs-number">659</span></span> &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas &gt;&gt;&gt; type_stats(tuple) <span class="hljs-number"><span class="hljs-number">6953</span></span> &gt;&gt;&gt; type_stats(list) <span class="hljs-number"><span class="hljs-number">2455</span></span></code> </pre><br><h4>  Listas vazias vs tuplas vazias </h4><br>  Uma tupla vazia funciona como um singleton, ou seja,  sempre há apenas uma tupla vazia na memória de um script Python em execução.  Todas as tuplas vazias se referem simplesmente ao mesmo objeto, isso é possível porque as tuplas são imutáveis.  Essa abordagem economiza muita memória e acelera o processo de trabalho com tuplas vazias. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>a = () &gt;&gt;&gt; b = () &gt;&gt;&gt; a <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> b <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> &gt;&gt;&gt; id(a) <span class="hljs-number"><span class="hljs-number">4409020488</span></span> &gt;&gt;&gt; id(b) <span class="hljs-number"><span class="hljs-number">4409020488</span></span> &gt;&gt;&gt; <span class="hljs-comment"><span class="hljs-comment">#  CPython,  id    .</span></span></code> </pre><br>  Mas isso não funciona com listas, porque elas podem ser alteradas: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>a = [] &gt;&gt;&gt; b = [] &gt;&gt;&gt; a <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> b <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> &gt;&gt;&gt; id(a) <span class="hljs-number"><span class="hljs-number">4465566920</span></span> &gt;&gt;&gt; id(b) <span class="hljs-number"><span class="hljs-number">4465370632</span></span></code> </pre><br><h4>  Otimizando a alocação de memória para tuplas </h4><br>  Para reduzir a fragmentação da memória e acelerar a criação de tuplas, o Python reutiliza tuplas antigas que foram excluídas.  Se uma tupla consiste em menos de 20 elementos e não é mais usada, em vez de excluí-la, o Python a coloca em uma lista especial, que armazena as tuplas livres para reutilização. <br><br>  Essa lista é dividida em 20 grupos, onde cada grupo é uma lista de tuplas de tamanho n, onde n é de 0 a 20. Cada grupo pode armazenar até 2.000 tuplas gratuitas.  O primeiro grupo armazena apenas um elemento e é uma lista de uma tupla vazia. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>a = (<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>) &gt;&gt;&gt; id(a) <span class="hljs-number"><span class="hljs-number">4427578104</span></span> &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">del</span></span> a &gt;&gt;&gt; b = (<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>) &gt;&gt;&gt; id(b) <span class="hljs-number"><span class="hljs-number">4427578104</span></span></code> </pre><br>  No exemplo acima, podemos ver que aeb têm o mesmo endereço na memória.  Isso se deve ao fato de termos instantaneamente obtido uma tupla do mesmo tamanho. <br><br><h4>  Otimizando a alocação de memória para listas </h4><br>  Como as listas estão sujeitas a alterações, a mesma otimização que no caso das tuplas não pode mais ser acionada.  Apesar disso, as listas usam otimizações semelhantes destinadas a listas vazias.  Se a lista vazia for excluída, também poderá ser reutilizada no futuro. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>a = [] &gt;&gt;&gt; id(a) <span class="hljs-number"><span class="hljs-number">4465566792</span></span> &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">del</span></span> a &gt;&gt;&gt; b = [] &gt;&gt;&gt; id(b) <span class="hljs-number"><span class="hljs-number">4465566792</span></span></code> </pre><br><h4>  Redimensionar lista </h4><br>  Para evitar a sobrecarga das listas de redimensionamento constante, o Python não a redimensiona sempre que necessário.  Em vez disso, cada lista possui um conjunto de células adicionais ocultas ao usuário, mas que posteriormente podem ser usadas para novos elementos.  Assim que as células ocultas terminam, o Python adiciona espaço extra para novos elementos.  E ele faz isso com uma boa margem, o número de células ocultas é selecionado com base no tamanho atual da lista - quanto maior, mais slots ocultos adicionais para novos elementos. <br><br>  Essa otimização é especialmente útil quando você tenta adicionar muitos elementos em um loop. <br><br>  O padrão de crescimento do tamanho da lista é mais ou menos assim: 0, 4, 8, 16, 25, 35, 46, 58, 72, 88, ... <br><br>  Por exemplo, se você deseja adicionar um novo elemento a uma lista com 8 elementos, não haverá células livres e o Python expandirá imediatamente seu tamanho para 16 células, onde 9 delas serão ocupadas e visíveis ao usuário. <br><br>  Fórmula de dimensionamento do Python: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_new_size</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(n_items)</span></span></span><span class="hljs-function">:</span></span> ... new_size = n_items + (n_items // <span class="hljs-number"><span class="hljs-number">2</span></span> ** <span class="hljs-number"><span class="hljs-number">3</span></span>) ... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> n_items &lt; <span class="hljs-number"><span class="hljs-number">9</span></span>: ... new_size += <span class="hljs-number"><span class="hljs-number">3</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: ... new_size += <span class="hljs-number"><span class="hljs-number">6</span></span> ... ... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> new_size ... &gt;&gt;&gt; get_new_size(<span class="hljs-number"><span class="hljs-number">9</span></span>) <span class="hljs-number"><span class="hljs-number">16</span></span></code> </pre><br><h4>  Velocidade </h4><br>  Se compararmos esses dois tipos em velocidade, em média, em um hospital, as tuplas são um pouco mais rápidas que as listas.  Raymond Hettinger tem uma ótima explicação para a diferença de velocidade no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fluxo</a> de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pilha</a> . <br><br>  PS: Eu sou o autor deste artigo, você pode fazer qualquer pergunta. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt417783/">https://habr.com/ru/post/pt417783/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt417773/index.html">Instalador de componentes OpenPnP caseiro</a></li>
<li><a href="../pt417775/index.html">Mecanismo de comissão do Bitcoin e por que ser amigo de mineiros</a></li>
<li><a href="../pt417777/index.html">Leitura de fim de semana: 25 materiais para entusiastas de vinil iniciantes</a></li>
<li><a href="../pt417779/index.html">Usando o Unity3D no aplicativo iOS / Android nativo para modelar a iluminação de espaços abertos</a></li>
<li><a href="../pt417781/index.html">Sonda da NASA "toca" o Sol - e não derrete</a></li>
<li><a href="../pt417785/index.html">Qual administrador de sistema não sonha com sua empresa de terceirização?</a></li>
<li><a href="../pt417787/index.html">Minha experiência profissional no papel do treinador ágil na Europa, parte um</a></li>
<li><a href="../pt417789/index.html">Discussões sobre perspectivas de telecomunicações</a></li>
<li><a href="../pt417791/index.html">Como fomos para a New York Developer Week</a></li>
<li><a href="../pt417793/index.html">Esqueça as megaestruturas de alienígenas: novas observações explicam o comportamento da estrela Tabby apenas poeira</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>