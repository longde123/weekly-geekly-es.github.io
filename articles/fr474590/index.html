<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üóº ü§∏üèª üßï Conf√©rence DEFCON 27. B√©n√©ficier des produits de piratage pour macOS. 2e partie üë®‚Äçüëß üö† üêü</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Conf√©rence DEFCON 27. B√©n√©ficier des produits de piratage pour macOS. Partie 1 

 Ayant re√ßu un fichier avec du code malveillant d'un serveur C&C pira...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Conf√©rence DEFCON 27. B√©n√©ficier des produits de piratage pour macOS. 2e partie</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/474590/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Conf√©rence DEFCON 27. B√©n√©ficier des produits de piratage pour macOS.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 1</a> <br><br>  Ayant re√ßu un fichier avec du code malveillant d'un serveur C&amp;C pirate distant, l'exploit proc√®de √† son ex√©cution.  Il utilise la m√™me m√©thode SDF lorsque l'archive du malware est d√©compress√©e √† l'aide de la commande idem int√©gr√©e, puis ex√©cut√©e via l'API NS.  Ainsi, Windtall utilise un chargeur de d√©marrage int√©gr√© standard. <br><br><img src="https://habrastorage.org/webt/s5/ah/23/s5ah23zhuchevz5cvkvhqsnpqcs.jpeg"><br><br>  De plus, la porte d√©rob√©e est √©quip√©e d'une logique d'auto-liquidation, donc chaque fois que le malware d√©marre, il contacte le serveur pirate et lui demande s'il doit √™tre d√©sinstall√©.  Si le serveur C&amp;C r√©pond avec le code ¬´1¬ª, le programme se supprime, arr√™tant ainsi l'activit√© des logiciels espions. <a name="habracut"></a><br><br><img src="https://habrastorage.org/webt/hb/b0/nv/hbb0nv9sjwt182m_llrlfnucgxm.jpeg"><br><br>  Il s'agit d'une fonctionnalit√© tr√®s utile qui permet √† un attaquant de "d√©sinfecter" √† distance une cible sans laisser de traces de son intervention.  Je vais maintenant montrer comment nous avons refait ce virus pour nos propres besoins. <br><br><img src="https://habrastorage.org/webt/yr/zs/vb/yrzsvbpwib8b9jenyer3zks92ki.jpeg"><br><br>  Tout d'abord, parlons de r√©primander un exploit.  La cr√©ation d'une page Web de pirate qui t√©l√©charge automatiquement un fichier ZIP contenant une application malveillante est assez simple.  Comme je l'ai mentionn√©, Safari d√©zippera automatiquement les archives ZIP par d√©faut, donc si nous pla√ßons une application malveillante dans cette archive qui impl√©mente certains gestionnaires d'URL, Mac OS l'enregistrera automatiquement avant que l'utilisateur ne d√©marre l'application. <br><br>  Une page Web malveillante peut alors demander cette URL utilisateur d√©j√† enregistr√©e, ce qui conduira au lancement de l'application.  Habituellement, une fen√™tre d'avertissement appara√Æt, mais l'utilisateur clique sur le bouton sans y pr√™ter attention. <br><br>  Donc, vous voyez une d√©monstration de l'exploit repens√© et une fen√™tre d'avertissement que "Final_Presentation" est une application t√©l√©charg√©e sur Internet, demandant si l'utilisateur est s√ªr qu'il veut l'ouvrir sur l'ordinateur? <br><br>  Cliquer sur le bouton ¬´Ouvrir¬ª est la deuxi√®me requ√™te provoquant une fen√™tre pop-up, et si l'utilisateur clique sur l'ic√¥ne de l'application qui y est affich√©e, nous verrons que le malware a √©t√© automatiquement install√© sur le syst√®me. <br><br><img src="https://habrastorage.org/webt/da/cz/w0/daczw0yu3d4vlyaa2ma79fx5tq8.jpeg"><br><br>  Il y a une faille logique dans Apple o√π vous n'avez pas besoin de patcher le syst√®me d'exploitation pour infecter le syst√®me, et cela fonctionne toujours dans la derni√®re version de macOS.  Maintenant que nous avons refait l'exploit, parlons de refaire le malware. <br><br><img src="https://habrastorage.org/webt/k8/q2/wh/k8q2whc8srob_t065-xvvldbgy4.jpeg"><br><br>  Notre premi√®re √©tape consiste √† remplacer l'adresse int√©gr√©e du serveur C &amp; C afin que l'exploit contacte notre serveur et en t√©l√©charge le malware converti.  Malheureusement, l'adresse √©tait crypt√©e, mais cela ne nous a pas d√©rang√©s.  Nous avons d√©cid√© de faire en sorte que les logiciels malveillants chargent toujours la biblioth√®que dynamique.  Ensuite, d√®s que notre biblioth√®que a √©t√© lanc√©e dans l'espace d'adressage du processus malveillant, nous pourrions, en principe, modifier le malware afin qu'il intercepte les adresses d√©crypt√©es du serveur C&amp;C pendant le fonctionnement avant m√™me d'utiliser ce serveur pour la connexion.  Examinons de plus pr√®s ce processus. <br><br>  Permettez-moi de vous rappeler encore une fois - notre objectif √©tait de re-profiler les logiciels malveillants en sp√©cifiant notre propre serveur C&amp;C afin que les logiciels malveillants se connectent √† notre infrastructure. <br><br><img src="https://habrastorage.org/webt/3h/qj/33/3hqj33qe_pjauk4ynkd_bgpy8q0.jpeg"><br><br>  Ainsi, la biblioth√®que dynamique a √©t√© charg√©e dans l'espace d'adressage des logiciels malveillants, et nous avons remplac√© la proc√©dure de d√©cryptage ou appliqu√© Swizzle.  Cette m√©thode de remplacement d'API efficace et puissante s'appelle Yoop. <br><br>  La diapositive montre que nous avons remplac√© la fonction de d√©cryptage de telle mani√®re que chaque fois que le malware l'appelle, il appelle en fait notre m√©thode de d√©cryptage dans notre biblioth√®que.  Je n'ai aucune id√©e de ce que l'algorithme de d√©cryptage est et comment il fonctionne, et, franchement, je m'en fiche, mais apr√®s la substitution, je peux voir le r√©sultat de ce cryptage.  Donc, si la m√©thode de cryptage d'origine me renvoie les adresses de serveur C&amp;C d√©crypt√©es, je peux simplement int√©grer mon propre serveur C&amp;C dans la logique du logiciel malveillant.  Cela nous permet de remplacer de mani√®re transparente le serveur C&amp;C d√©chiffr√© par notre serveur. <br><br>  Maintenant, j'ajoute quelques messages de d√©bogage √† la biblioth√®que afin que lorsque nous ex√©cutons le malware converti, nous pouvons voir comment les adresses du serveur C&amp;C sont remplac√©es pendant son ex√©cution.  Dans la fen√™tre du terminal de ligne de commande, vous pouvez voir comment notre biblioth√®que, qui passe par la m√©thode de d√©cryptage d'origine, d√©tecte que cette r√©ponse provient du serveur C&amp;C, dont l'adresse est maintenant d√©crypt√©e. <br><br><img src="https://habrastorage.org/webt/jy/vq/pp/jyvqppeptj5tsynsrub5ao7qzb8.jpeg"><br><br>  Comme nous ne voulons pas que notre programme fasse r√©f√©rence √† la logique du malware d'origine, nous rejetons simplement cette fonction et retournons √† notre propre programme.  Bien s√ªr, nous devons toujours √™tre s√ªrs que la porte d√©rob√©e acc√®de √† notre serveur C&amp;C, et non au serveur du groupe APT d'origine. <br><br>  Nous devions √©crire notre serveur C&amp;C, car maintenant les logiciels malveillants s'y connecteront, et nous devons fournir une ¬´conversation¬ª avec le protocole afin de perplexer correctement les logiciels malveillants. <br><br><img src="https://habrastorage.org/webt/9a/dg/uj/9adgujslps8-egi02h548dxeplo.jpeg"><br><br>  La fonction principale de la porte d√©rob√©e Windtall est de collecter et d'extraire les fichiers utilisateur, nous avons donc d'abord d√ª ajouter cette fonction √† notre serveur C&amp;C.  Les fichiers sont r√©cup√©r√©s via une requ√™te POST, nous avons donc simplement √©crit quelques lignes de code Python pour nous permettre d'enregistrer les fichiers r√©cup√©r√©s et qui nous sont envoy√©s depuis l'h√¥te infect√©. <br><br>  Vous voyez √† l'√©cran comment notre serveur C&amp;C re√ßoit les fichiers extraits de l'ordinateur attaqu√©. <br><br><img src="https://habrastorage.org/webt/5z/tu/ey/5ztueycxug4uq7-8_mvofucvowe.jpeg"><br><br>  Sur la gauche, vous pouvez voir comment les requ√™tes r√©seau entrent, et sur la droite - comment notre serveur les √©crit dans le syst√®me de fichiers.  Cela signifie que nous prenons d√©sormais en charge la capacit√© des logiciels malveillants d'extraire des fichiers de tous types √† partir d'un h√¥te infect√©. <br><br>  Nous avons √©galement adapt√© notre serveur C&amp;C pour prendre en charge les capacit√©s de t√©l√©chargement et d'ex√©cution de Windtall.  Nous avons remarqu√© que ce malware ex√©cute 2 requ√™tes. <br><br><img src="https://habrastorage.org/webt/ap/y3/6h/apy36hocalariebs3edovjvgfas.jpeg"><br><br>  La premi√®re demande concerne l'obtention du nom de fichier √† t√©l√©charger, et la deuxi√®me demande nous devons r√©pondre avec des octets sp√©cifiques du fichier que nous voulons t√©l√©charger.  Les logiciels malveillants enregistrent tout cela dans le fichier que nous avons sp√©cifi√©, puis le d√©compressent et l'ex√©cutent.  Je le r√©p√®te encore une fois - cela nous a pris seulement quelques lignes en Python, c'est simple, car il utilise de nombreuses biblioth√®ques int√©gr√©es. <br><br>  D√®s que nous avons fait cela, nous avons eu l'occasion de "puzzle" l'implant.  Regardons-le en action.  Nous voyons comment les logiciels malveillants se connectent √† notre serveur C&amp;C, car nous avons r√©ussi √† changer l'adresse du serveur d'origine et √† ex√©cuter la t√¢che qui lui est confi√©e: il t√©l√©charge l'application Calculatrice. <br><br><img src="https://habrastorage.org/webt/gg/au/3d/ggau3dqd27ai3u5dk115bylndnw.jpeg"><br><br>  La possibilit√© de t√©l√©charger et d'ex√©cuter des applications √† distance signifie que nous pouvons installer d'autres outils ou d'autres exemples de logiciels malveillants sur l'ordinateur de l'utilisateur.  Cela augmente infiniment le potentiel d'utilisation d'un logiciel de piratage r√©utilis√©. <br><br>  Enfin, donnons √† notre serveur la possibilit√© de supprimer √† distance les logiciels malveillants.  La fonction d'autodestruction est tr√®s utile si les gars du FBI s'introduisent par effraction dans votre porte.  Un clic sur la cl√© - et le virus lui-m√™me se supprimera de tous les syst√®mes infect√©s. <br><br><img src="https://habrastorage.org/webt/yp/ru/dy/yprudyqitu1zcbxqi3ahyfvsixs.jpeg"><br><br>  Les logiciels espions nous contactent p√©riodiquement pour nous demander s‚Äôil est n√©cessaire de s‚Äôeffacer et, si n√©cessaire, nous r√©pondons simplement avec le code ¬´1¬ª, apr√®s quoi il est compl√®tement d√©sinstall√© du syst√®me. <br><br>  Une autre d√©mo le montrera en action.  Vous pouvez voir que notre malware a son propre logo orange imitant un document Power Point, mais en r√©alit√© c'est un r√©pertoire syst√®me cach√©. <br><br><img src="https://habrastorage.org/webt/ar/pd/ak/arpdakjxkom1af3v9jxmttspha0.jpeg"><br><br>  Apr√®s avoir √† nouveau envoy√© une demande de destruction au serveur C &amp; C et nous y avons r√©pondu, l'ic√¥ne orange a disparu du r√©pertoire du programme et l'application elle-m√™me a cess√© de ¬´nous parler¬ª car elle a effectu√© une auto-destruction. <br><br><img src="https://habrastorage.org/webt/p5/6u/ln/p56ulnb7cf18kh9qd_hmudrhuse.jpeg"><br><br>  Nous avons donc montr√© comment certains √©chantillons de logiciels malveillants pour macOS sont reprofil√©s, et discutons maintenant comment rester non d√©tect√©.  Comme nous refaisons des programmes malveillants connus que la protection int√©gr√©e de macOS et un logiciel antivirus tiers d√©tectent et bloquent, nous devons en quelque sorte r√©soudre ce probl√®me. <br><br><h3>  Comment ne pas √™tre d√©tect√© </h3><br>  Tout d'abord, parlons des programmes de d√©tection et de contr√¥le des virus int√©gr√©s √† macOS, tels que XProtect, l'outil de suppression des virus MRT et la v√©rification de la r√©vocation des certificats. <br><br><img src="https://habrastorage.org/webt/ky/_a/di/ky_adibiddjzdqx6zhbhmlfxnb4.jpeg"><br><br>  √Ä premi√®re vue, cela semble probl√©matique, car ces programmes peuvent bloquer nos logiciels espions convertis sur n'importe quel Mac.  Par cons√©quent, vous devez r√©fl√©chir √† la fa√ßon de contourner la protection, car si nous sommes pris avec notre logiciel malveillant soigneusement repens√© et qu'Apple le bloque, ce sera un √©chec complet. <br><br>  Jetons d'abord un coup d'≈ìil √† XProtect.  Il s'agit d'un simple scanner antivirus bas√© sur des bases de donn√©es de signatures de virus et int√©gr√© aux derni√®res versions de macOS. <br><br><img src="https://habrastorage.org/webt/io/_h/gy/io_hgyg0wdmy6rt34vr_gdlui1a.jpeg"><br><br>  Il analyse les fichiers t√©l√©charg√©s par l'utilisateur sur l'ordinateur avant leur premier lancement, guid√© par les r√®gles de d√©tection de virus.  √Ä l'√©cran, nous voyons une analyse de la signature du virus OSX.KeRanger.A, dont nous venons d'examiner le reprofilage. <br><br>  Nous avons √©crit un utilitaire simple appel√© UXProtect, qui vous permet d'examiner ces signatures via l'interface utilisateur de l'interface utilisateur, ainsi que d'analyser les fichiers √† tout moment pour les signatures de virus.  Parce que XProtect utilise uniquement le moteur de d√©tection de signature, il est extr√™mement facile de se d√©placer.  Examinons de plus pr√®s la signature du virus KeRanger. <br><br><img src="https://habrastorage.org/webt/sw/5h/mw/sw5hmwzwllc0p3bkn3pyd6r1dsy.jpeg"><br><br>  Nous voyons une indication d'un groupe de signatures de logiciels malveillants que vous avez juste besoin de r√©organiser ou de modifier l'une de ces instructions pour contourner.  La modification de quelques octets d'une instruction fait que la signature ne correspond plus aux param√®tres de d√©tection.  Par exemple, nous avons chang√© le nombre d'octets √† lire dans le tampon de 0x400 √† 0x300.  Cela n'a pas affect√© la fonctionnalit√© du virus, mais d√®s que nous avons chang√© le nombre d'octets que le scanner v√©rifie pour une correspondance avec la signature, nous avons compl√®tement exclu la possibilit√© que XProtect r√©agisse √† cette menace. <br><br>  Il est temps pour une autre d√©monstration, o√π vous verrez deux exemples de KeRanger.  Nous utilisons √† nouveau le client BitTorrent infect√©.  Sur la gauche de l'√©cran se trouve la copie originale du pirate informatique du virus, et sur la droite se trouve sa version r√©utilis√©e qui, afin d'obtenir la cl√© de cryptage, communique avec notre serveur C&amp;C.  De plus, il est modifi√© pour contourner la protection XProtect. <br><br><img src="https://habrastorage.org/webt/ag/mw/gs/agmwgscqk2ajoq1ef2shu2lm9yq.jpeg"><br><br>  Vous voyez qu'une instance du virus d'origine est bloqu√©e par le syst√®me sans possibilit√© de d√©marrage, et la seule op√©ration autoris√©e est la suppression. <br><br><img src="https://habrastorage.org/webt/kv/mb/y4/kvmby4yeqnevt_msi9viidiyhxg.jpeg"><br><br>  Si nous lan√ßons une version KeRanger repens√©e, le syst√®me signale simplement qu'elle est t√©l√©charg√©e sur Internet et nous demande si nous voulons vraiment la lancer. <br><br><img src="https://habrastorage.org/webt/va/wn/4j/vawn4ja6artoxgxuure3xnzutt8.jpeg"><br><br>  Si nous cliquons sur ¬´Ouvrir¬ª, le ransomware est install√© silencieusement dans le syst√®me et commence imm√©diatement √† crypter tous les fichiers utilisateur. <br><br><img src="https://habrastorage.org/webt/oo/uj/ex/ooujexbhzffuj8wg6klvihde_gg.jpeg"><br><br>  La prochaine fa√ßon de prot√©ger votre Mac consiste √† v√©rifier les signatures de certificats.  La plupart des binaires macOS sign√©s ne sont pas bloqu√©s par la fonction de s√©curit√© de GateKeeper, c'est pourquoi les pirates informatiques fournissent des signatures pour la plupart des logiciels malveillants Mac modernes.  En revanche, une fois qu'un virus sign√© est d√©tect√©, Apple r√©voque simplement son certificat de signature.  Cela signifie que ce malware ne peut √™tre ex√©cut√© sur aucun Mac. <br><br>  Par exemple, nous avons un binaire du virus Windtall dont le certificat de signature a √©t√© r√©voqu√© par Apple.  Cela signifie que m√™me si nous le reprofilons et l'appliquons au nouveau syst√®me, nous ne pourrons toujours pas commencer.  Par cons√©quent, nous essayons simplement de contourner la proc√©dure de r√©vocation de certificat en supprimant le certificat de signature lui-m√™me. <br><br><img src="https://habrastorage.org/webt/0f/9g/dy/0f9gdymdaskct9prhp2exlstml4.jpeg"><br><br>  Ensuite, nous utilisons une copie non sign√©e du logiciel malveillant converti ou nous lui fournissons un certificat de signature juridique diff√©rent, ce qui est assez facile √† obtenir. <br><br>  Pour supprimer r√©ellement le certificat, Apple lui-m√™me fournit un utilitaire appel√© Code Sign qui contient l'indicateur de suppression de signature non document√©, ou ¬´remove signature¬ª.  Si vous effectuez cette op√©ration avec votre logiciel malveillant, Apple ne fera tout simplement pas attention au certificat de signature r√©voqu√©. <br><br>  Nous pouvons √©galement signer √† nouveau notre application √† l'aide du m√™me utilitaire √† l'aide de la commande codesign -s ¬´Developer ID Applikation:¬ª.  Cela entra√Ænera le Windtall re-sign√© ne sera plus bloqu√© par macOS. <br><br>  Enfin, nous passons √† MRT, l'outil de suppression de virus int√©gr√© disponible sur les derni√®res versions du syst√®me d'exploitation Mac.  Il est similaire √† XProtect, mais il analyse les logiciels malveillants d√©j√† install√©s sur le syst√®me et les d√©tecte automatiquement lors de la d√©tection.  Contrairement √† XProtect, ses signatures sont int√©gr√©es dans son propre fichier binaire.  Apple utilise souvent cet outil pour supprimer les applications l√©gitimes qu'il consid√®re dangereuses pour votre ordinateur.  Ce sont g√©n√©ralement des applications contenant des vuln√©rabilit√©s connues. <br><br><img src="https://habrastorage.org/webt/tq/za/iu/tqzaiuk9rktufxpfwcf8ozwwoae.jpeg"><br><br>  Puisque MRT, comme XProtect, fonctionne avec des signatures, il peut √©galement √™tre contourn√©.  Nous avons utilis√© le vidage MRT, encore une fois, car les signatures sont int√©gr√©es au binaire lui-m√™me, et nous avons pu toutes les visualiser, y compris la signature du virus Fruitfly.  Nous nous demandions si MRT pouvait d√©tecter notre copie convertie de ce malware? <br><br><img src="https://habrastorage.org/webt/eg/wa/te/egwatesmsl0ez1ccvzlhw_s0-2y.jpeg"><br><br>  Nous avons commenc√© √† rechercher la signature int√©gr√©e de Fruitfly et avons constat√© que sa d√©tection √©tait bas√©e sur deux choses: le chemin d'installation du virus et le fichier .plist t√©l√©charg√©.  Cela signifie que si nous modifions le chemin ou le nom d'un malware, MRT ne pourra pas le d√©tecter.  Comme je l'ai dit, en cons√©quence, contourner cette protection s'est av√©r√© assez simple. <br><br>  Nous avons constat√© que contourner un logiciel antivirus tiers n'est pas non plus difficile, car vous pouvez ex√©cuter un virus converti m√™me sur un syst√®me sur lequel l'utilisateur a d√©j√† install√© un antivirus. <br><br><img src="https://habrastorage.org/webt/bm/8o/k0/bm8ok05gky6s453v91lxix-mh2s.jpeg"><br><br>  Il y a eu beaucoup de discussions √† ce sujet, je ne veux pas entrer dans les d√©tails, mais en g√©n√©ral, les produits antivirus traditionnels sont bas√©s sur la v√©rification de signature, comme le logiciel antivirus Apple, ce qui signifie qu'ils peuvent √™tre contourn√©s par les m√™mes m√©thodes. <br><br>  Par exemple, j'ai pris le m√™me Fruitfly, je me suis souvenu qu'il s'agissait √©galement d'un script Perl et je l'ai transmis √† l'utilitaire en ligne gratuit Perl Obfuscator, con√ßu pour rendre le script Perl difficile √† lire et r√©duire √† z√©ro la probabilit√© de sa d√©tection.  Naturellement, cela a fonctionn√©.  Mais vous pouvez aller de mani√®re plus ing√©nieuse, surtout si vous utilisez un malware binaire.  Vous pouvez l'int√©grer dans une archive, utiliser un chiffreur ou m√™me une ex√©cution en m√©moire, c'est-√†-dire un t√©l√©chargement sans fichier et une ex√©cution de virus dans la RAM. <br><br>  Il y a quelques ann√©es, ces technologies ont √©t√© discut√©es lors de la conf√©rence BlackHat et il a √©t√© conclu que m√™me si un utilisateur Mac avait install√© un logiciel antivirus tiers sur le syst√®me, il n'√©tait toujours pas en mesure de d√©tecter les logiciels malveillants reprogramm√©s.  C'est une mauvaise nouvelle pour les utilisateurs de macOS, car nous savons que les pirates exp√©riment√©s utilisent des logiciels malveillants convertis.  Souvent, toute la modification se r√©sume √† changer quelques octets de code ou d'arguments de ligne de commande, ce qui permet de prendre le contr√¥le d'un ordinateur afin de l'utiliser √† leurs propres fins.  De plus, la plupart des outils antivirus int√©gr√©s √† macOS et les logiciels antivirus tiers ne sont pas en mesure de d√©tecter les menaces converties. <br><br>  √âtant donn√© que ce logiciel r√©utilis√© est juste un logiciel espion original et bien connu, je vais mettre un "chapeau blanc" et vous dire comment vous pouvez toujours le trouver. <br><br><h3>  D√©tection du logiciel de reconfiguration </h3><br>  Il est bien connu qu'un logiciel antivirus bas√© sur les signatures ne r√©siste pas aux logiciels malveillants convertis.  Par cons√©quent, nous devons pr√™ter attention au comportement inhabituel, anormal et malveillant de ces logiciels malveillants. <br><br>  Nous devons essayer de le d√©tecter, non pas gr√¢ce √† la signature bien connue du virus, mais en observant ses actions dans le syst√®me.  Nous nous sommes assur√©s que lorsque vous refaites un logiciel espion bien connu, ses fonctions de base et son objectif restent inchang√©s. <br><br>  Si nous refaisons le cheval de Troie ransomware Ransomware, il cryptera toujours vos fichiers, et la porte d√©rob√©e repens√©e continuera √† collecter des fichiers et √† les envoyer au serveur espion. <br>  Sur la diapositive ci-dessus, j'ai affich√© les fonctions ou capacit√©s du syst√®me, qui devraient √™tre surveill√©es et surveill√©es pour leur activit√©.  Ceux-ci incluent la ¬´persistance¬ª des applications, l'activit√© inhabituelle du microphone ou de la cam√©ra, le t√©l√©chargement ou le transfert de fichiers, la capture d'√©cran non autoris√©e, les sympt√¥mes d'interception du clavier, les cliqueurs synth√©tiques et le cryptage des fichiers.  Cela d√©tectera m√™me les logiciels malveillants r√©utilis√©s. <br><br>  Parlons de pers√©v√©rance.  Lorsque je dis ¬´pers√©v√©rance¬ª, je veux dire que d√®s que le logiciel espion est install√© sur l'ordinateur, il d√©marre automatiquement √† chaque fois apr√®s le red√©marrage du syst√®me.  Il s'agit d'une fonctionnalit√© de tout logiciel malveillant pour macOS ou Windows - afin de s'efforcer durement d'atteindre un objectif malveillant. <br><br>  Nous pouvons simplement contr√¥ler le syst√®me de fichiers en observant le comportement de l'application ¬´persistante¬ª et, si quelque chose change, en informer l'utilisateur ou l'administrateur syst√®me. <br><br>  Maintenant, je veux montrer comment vous pouvez d√©tecter l'activit√© du virus Windtall original ou remodel√©, qui se manifeste par un acc√®s non autoris√© √† un microphone ou √† une webcam Mac. <br><br><img src="https://habrastorage.org/webt/9g/lg/rb/9glgrbybold1rwxqx_xhklasvn4.jpeg"><br><br>  De nombreux logiciels malveillants Mac acc√®dent √† une webcam ou √† un microphone afin d'espionner un utilisateur d'un syst√®me infect√©.  Pour d√©tecter cette activit√© virale, nous pouvons enregistrer chaque allumage de la cam√©ra et du microphone dans le syst√®me macOS afin que l'utilisateur re√ßoive automatiquement une notification concernant cet √©v√©nement.        ,    FruitFly,   ,  Zoom,           . <br><br>    .       ,         . <br><br><img src="https://habrastorage.org/webt/l8/1s/p3/l81sp3q6f1-3x6pjtwr6z0cehpk.jpeg"><br><br>        macOS ‚Äì      Event Taps.            ,      .        . <br><br>     FruitFly,      ,           ,        ‚Äì ¬´¬ª . <br><br><img src="https://habrastorage.org/webt/bi/ce/d4/biced48qutbyjlpsfiywsgwvk0m.jpeg"><br><br>     ,       macOS,    .          .       ,  macOS  ,      .     ,     . <br><br>        Objective-See,    -  macOS.       ,              .      ,     ,        . <br><br><img src="https://habrastorage.org/webt/fg/lz/ea/fglzeamo6vlyrjgnj1sa6hp5vvw.jpeg"><br><br>     ,     ‚Äì    ,     ,        ¬´  ¬ª. <br><br><img src="https://habrastorage.org/webt/bk/c6/po/bkc6poi2uugp2kmcff2q77h0v98.jpeg"><br><br> ,      Digita Security,        .      :           .               Apple,        ,             . <br><br>        ,     .    ,  ,         ,       ,    macOS. <br><br>   ,          . ,    Windtall,   ,  Safari ,     . <br><br><img src="https://habrastorage.org/webt/ek/iq/wo/ekiqwo4mwk-hqxnyijkrxd9n3l4.jpeg"><br><br>     ,      URL     ,     -    URL.            Windtall,       ,      . <br><br>    FruitFly        ,      ,     -   . ,  ,    ,   Apple,      -  . <br><br>  ,  FruitFly      ,            .      ,     .                template       . ,       . <br><br>  ,          ,      .     ,       ,    macOS. <br><br>    ,        Mac,     2020   ,       . <br><br><img src="https://habrastorage.org/webt/bv/ix/tg/bvixtgp1tqcst1xbg6jbdvrlq4k.jpeg"><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/InL3YA_6P6s" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h3>  Un peu de publicit√© :) </h3><br>  Merci de rester avec nous.  Aimez-vous nos articles?  Vous voulez voir des mat√©riaux plus int√©ressants?  Soutenez-nous en passant une commande ou en recommandant √† vos amis, le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cloud VPS pour les d√©veloppeurs √† partir de 4,99 $</a> , une <b>r√©duction de 30% pour les utilisateurs Habr sur un analogue unique de serveurs d'entr√©e de gamme que nous avons invent√© pour vous:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">toute la v√©rit√© sur VPS (KVM) E5-2650 v4 (6 C≈ìurs) 10 Go DDR4 240 Go SSD 1 Gbps √† partir de 20 $ ou comment partager un serveur?</a>  (les options sont disponibles avec RAID1 et RAID10, jusqu'√† 24 c≈ìurs et jusqu'√† 40 Go de DDR4). <br><br>  <b>Dell R730xd 2 fois moins cher?</b>  Nous avons seulement <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">2 x Intel TetraDeca-Core Xeon 2x E5-2697v3 2.6GHz 14C 64GB DDR4 4x960GB SSD 1Gbps 100 TV √† partir de 199 $</a> aux Pays-Bas!</b>  <b><b>Dell R420 - 2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps 100TB - √† partir de 99 $!</b></b>  Pour en savoir plus sur la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cr√©ation d'un b√¢timent d'infrastructure.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">classe utilisant des serveurs Dell R730xd E5-2650 v4 co√ªtant 9 000 euros pour un sou?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr474590/">https://habr.com/ru/post/fr474590/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr474578/index.html">Pourquoi le service de marketing par e-mail combat r√©ellement le spam et comment il fonctionne</a></li>
<li><a href="../fr474580/index.html">Rendre l'application accessible √† l'aide de la biblioth√®que de tests de disponibilit√© de ax</a></li>
<li><a href="../fr474582/index.html">Services bancaires en ligne (sans) dangereux: une √©tude des ressources Web des banques en Russie et dans le monde</a></li>
<li><a href="../fr474584/index.html">Installer Kali Linux avec une interface graphique sur un serveur virtuel</a></li>
<li><a href="../fr474588/index.html">Les 9 meilleures trouvailles open source pour octobre 2019</a></li>
<li><a href="../fr474592/index.html">Comment travailler en dehors du bureau et ne pas devenir fou</a></li>
<li><a href="../fr474594/index.html">Comment diviser une entreprise entre fondateurs - l'avis d'un avocat</a></li>
<li><a href="../fr474596/index.html">Application sur TSD et communication avec 1C: Enterprise 8.3 via HTTP-Service. Partie 5 (Menu, objet compagnon)</a></li>
<li><a href="../fr474598/index.html">Comment obtenir un entretien avec un ing√©nieur QA sans exp√©rience de travail</a></li>
<li><a href="../fr474602/index.html">R√©soudre l'√©quation de la r√©gression lin√©aire simple</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>