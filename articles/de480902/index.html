<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßñüèæ üïö ‚ñ´Ô∏è Neue Postgres_exporter PostgreSQL-√úberwachungsfunktionen üë®üèª‚Äçüíº üàµ üêó</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Guten Tag, liebe Leser! 


 In der ersten Anmerkung zu posgres_exporter habe ich einen ziemlich speziellen Fall bei der Arbeit mit einer neuen Fitcha ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Neue Postgres_exporter PostgreSQL-√úberwachungsfunktionen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/480902/"><p>  Guten Tag, liebe Leser! </p><br><p> In der ersten <a href="https://habr.com/ru/post/468573/">Anmerkung zu posgres_exporter habe</a> ich einen ziemlich speziellen Fall bei der Arbeit mit einer neuen Fitcha untersucht, n√§mlich die M√∂glichkeit, eine Reihe von Instanzen und / oder Datenbanken von einem Exporteur zu √ºberwachen.  Und er beschrieb die ‚ÄûMenge‚Äú Probleme, auf die er gesto√üen war und welche Problemumgehungen er benutzte, um es zum Laufen zu bringen. <br>  Und so wurde am 25. November die n√§chste Version von postgres_exporter 0.8.0 ver√∂ffentlicht.  Es hat die im vorherigen Beitrag beschriebenen Probleme gel√∂st und, was besonders sch√∂n ist, neue Funktionen hinzugef√ºgt. </p><br><p>  Ich bitte um eine Katze ... </p><a name="habracut"></a><br><p>  Zun√§chst m√∂chte ich Ihnen postgre_exporter n√§her vorstellen und eine Art kurze Kurzanleitung schreiben.  Gehen wir die wichtigsten Punkte durch: </p><br><ol><li>  Umgebungsvariablen und Startparameter </li><li>  Was sind Standardmetriken? </li><li>  So f√ºgen Sie Ihre eigenen Metriken hinzu </li></ol><br><h2 id="opisanie">  Beschreibung </h2><br><p>  <a href="https://github.com/wrouesnel/postgres_exporter" rel="nofollow">postgres_exporter</a> - Ein Dienstprogramm zum Erfassen von Metriken aus Instanzen eines PostgreSQL-DBMS-Clusters in einem barrierefreien Prometheus-Format, das in Go geschrieben wurde, ist Open Source und wird kostenlos vertrieben. </p><br><h2 id="peremennye-okruzheniya-i-argumenty-komandnoy-stroki">  Umgebungsvariablen und Befehlszeilenargumente </h2><br><p>  Postgres_exporter verf√ºgt als solches nicht √ºber eine Konfigurationsdatei, und alle Parameter werden entweder √ºber Umgebungsvariablen oder √ºber Befehlszeilenargumente an den Exporter √ºbergeben.  Gleichzeitig k√∂nnen die Parameter f√ºr die Verbindung zum DBMS nur √ºber Umgebungsvariablen √ºbertragen werden. </p><br><h3 id="peremennye-okruzheniya">  Umgebungsvariablen </h3><br><p>  Wie oben erw√§hnt, k√∂nnen Umgebungsvariablen in zwei Gruppen unterteilt werden.  Ersterer √ºbergibt die Verbindungszeichenfolge, letzterer dupliziert die Befehlszeilenargumente. </p><br><p> Beginnen wir mit der ersten Gruppe.  Diese Variablen beginnen mit dem Pr√§fix <code>DATA_SOURCE_</code> : </p><br><ul><li><p>  DATA_SOURCE_NAME - wird standardm√§√üig verwendet.  Erm√∂glicht die Aufzeichnung der Verbindungszeichenfolge im Format <code>=</code> und in Form eines URI und kann den Anmeldenamen und das Kennwort der Verbindung enthalten. <br>  G√ºltige Joboptionen f√ºr die Verbindung mit PostgreSQL: </p><br><ul><li>  <code>postgresql://rolename@dbhost:dbport/datname?sslmode=disable</code> ; </li><li>  <code>postgresql://rolename:rolpass@dbhost:dbport?sslmode=disable&amp;db=datname</code> ; </li><li>  <code>postgresql://rolename:rolpass@?sslmode=disable&amp;dbname=database&amp;host=dbhost&amp;port=dbport</code> ; </li><li>  <code>postgresql://rolename:rolpass@?sslmode=disable&amp;dbname=database&amp;host=/tmp</code> (Verbindung √ºber einen UNIX-Socket aus den unix_socket_directories einer PostgreSQL-Instanz); </li><li>  <code>host=dbhost port=dbport dbname=database user=rolename sslmode=disable</code> ; </li></ul><br><p>  Wenn Sie eine Verbindung zu mehreren Instanzen herstellen m√ºssen (ein Leerzeichen nach dem Komma ist nicht zul√§ssig): </p><br><ul><li>  <code>postgresql://rolename@dbhost:dbport/datname?sslmode=disable,postgresql://rolename@dbhost:dbport/datname?sslmode=disable</code> ; </li><li>  <code>sslmode=disable dbname=postgres host=127.0.0.1 port=5434 user=postgres,sslmode=disable dbname=postgres port=5432 user=postgres</code> . </li></ul><br></li><li>  DATA_SOURCE_URI - Alternative zu DATA_SOURCE_NAME.  Diese Option ist nur geeignet, wenn Sie beabsichtigen, eine Verbindung zu einer einzelnen Instanz von PostgreSQL herzustellen. <br>  Die Variable DATA_SOURCE_URI legt den Teil der URI ohne Benutzernamen und Kennwort in der Form "dbhost: dbport / dbname? Key = value" fest.  Der Benutzername und das Kennwort stammen aus den Umgebungsvariablen DATA_SOURCE_USER und DATA_SOURCE_PASS oder aus den Dateien DATA_SOURCE_USER_FILE DATA_SOURCE_PASS_FILE. <br>  Wenn der Benutzername und das Kennwort in Dateien gespeichert werden, werden deren Inhalte extrahiert und den Variablen DATA_SOURCE_USER und DATA_SOURCE_PASS zugewiesen.  Im Code wird all dies in einem vollst√§ndigen URI der Form <code>"postgresql://" + DATA_SOURCE_USER + ":" + DATA_SOURCE_PASS + "@" + DATA_SOURCE_URI</code> </li><li>  DATA_SOURCE_URI_FILE - Entspricht DATA_SOURCE_URI und wird nur aus der Datei gelesen. </li><li>  DATA_SOURCE_USER - Legt bei Verwendung von DATA_SOURCE_URI den Benutzernamen f√ºr die Verbindung zum DBMS fest. </li><li>  DATA_SOURCE_USER_FILE - Entspricht DATA_SOURCE_USER und wird nur aus der Datei gelesen. </li><li>  DATA_SOURCE_PASS - Legt bei Verwendung von DATA_SOURCE_URI das Benutzerkennwort f√ºr die Verbindung zum DBMS fest. </li><li>  DATA_SOURCE_PASS_FILE - Entspricht DATA_SOURCE_PASS und wird nur aus der Datei gelesen. </li></ul><br><p>  Die zweite Gruppe enth√§lt variable doppelte Argumente.  Das hei√üt  beim Start haben Sie die Wahl, legen die Betriebsparameter der Anwendung in Form von Umgebungsvariablen fest oder √ºbergeben sie beim Start als Argumente.  Beginnen Sie mit dem Pr√§fix <code>PG_EXPORTER_</code> : </p><br><ul><li>  PG_EXPORTER_WEB_LISTEN_ADDRESS - Legt die Adresse und den Port fest, √ºber den der Exporteur Anfragen von Prometheus erh√§lt.  Standardm√§√üig <code>:9187</code> ; </li><li>  PG_EXPORTER_WEB_TELEMETRY_PATH - Der Pfad, entlang dem Metriken angegeben werden.  Standardm√§√üig <code>/metrics</code> ; </li><li>  PG_EXPORTER_DISABLE_DEFAULT_METRICS - deaktiviert standardm√§√üig die Erfassung von Metriken.  Die Tatsache, dass diese Metriken unten sein werden.  Nur wahr oder falsch akzeptiert Werte.  Standardm√§√üig "False" (Erfassung von Metriken ist zul√§ssig); </li><li>  PG_EXPORTER_DISABLE_SETTINGS_METRICS - Deaktiviert die Erfassung von Metriken in der Ansicht pg_settings.  Die Tatsache, dass diese Metriken unten sein werden.  Nur wahr oder falsch akzeptiert Werte.  Standardm√§√üig "False" (Erfassung von Metriken ist zul√§ssig); </li><li>  PG_EXPORTER_AUTO_DISCOVER_DATABASES - Erkennt alle Datenbanken einer Cluster-Instanz, um ihre Metriken zu erfassen.  Nur wahr oder falsch akzeptiert Werte.  Standardm√§√üig false (Metriken werden nur in der Datenbank erfasst, die in den Verbindungsparametern angegeben wurde). </li><li>  PG_EXPORTER_EXCLUDE_DATABASES - Schlie√üt die Datenbank aus der Liste der Datenbanken aus, f√ºr die Metriken erfasst werden, wenn <code>PG_EXPORTER_AUTO_DISCOVER_DATABASES=true</code> .  Stellt eine durch Kommas getrennte Liste von Datenbanknamen dar.  Der Standardwert ist eine leere Zeichenfolge.  <strong>WICHTIG</strong> : <br><ul><li>  templates template0 und template1 - m√ºssen nicht ausgeschlossen werden, daher werden sie abgeschnitten, wenn eine Liste von Datenbanken aus pg_databases abgerufen wird. </li><li>  kann die in der URI angegebene Datenbank nicht ausschlie√üen. </li></ul></li><li>  PG_EXPORTER_EXTEND_QUERY_PATH - Der Pfad zur YAML-Datei, die Benutzerabfragen enth√§lt.  Die Datei queries.yaml enth√§lt Beispiele. </li><li>  PG_EXPORTER_CONSTANT_LABELS - Allen Metriken wurde eine Bezeichnung (Konstante) hinzugef√ºgt.  Es wird als Liste von Paaren <code>=</code> , die durch ein Komma getrennt sind. </li></ul><br><h3 id="argumenty-komandnoy-stroki">  Befehlszeilenargumente </h3><br><ul><li>  Die web.listen-Adresse ist dieselbe wie PG_EXPORTER_WEB_LISTEN_ADDRESS. </li><li>  web.telemetry-path - das gleiche wie PG_EXPORTER_WEB_TELEMETRY_PATH; </li><li>  disable-default-metrics ist dasselbe wie PG_EXPORTER_DISABLE_DEFAULT_METRICS. </li><li>  Disable-Settings-Metrics sind die gleichen wie PG_EXPORTER_DISABLE_SETTINGS_METRICS. </li><li>  Auto-Discovery-Datenbanken sind mit PG_EXPORTER_AUTO_DISCOVER_DATABASES identisch. </li><li>  exclude-databases ist dasselbe wie PG_EXPORTER_EXCLUDE_DATABASES; </li><li>  extend.query-path - das gleiche wie PG_EXPORTER_EXTEND_QUERY_PATH; </li><li>  constantLabels - das gleiche wie PG_EXPORTER_CONSTANT_LABELS; </li><li>  dumpmaps - Zeigt den internen Inhalt der Metrikkarte an.  Wird zum Debuggen von Benutzeranforderungen verwendet.  Startet die Anwendung nicht. </li><li>  log.level - Legt eine der m√∂glichen Protokollierungsstufen fest: <code>debug</code> , <code>info</code> , <code>warn</code> , <code>error</code> , <code>fatal</code> ; </li><li>  log.format - Legt die Methode und das Format der Protokollausgabe fest.  Zum Beispiel: <code>logger:syslog?appname=bob&amp;local=7</code> oder <code>logger:stdout?json=true</code> .  Standardm√§√üig <code>logger:stderr</code> . </li></ul><br><h2 id="metriki-po-umolchaniyu">  Standardmetriken </h2><br><p>  <code> -</code> sind bestimmte √úberwachungsmetriken, deren Auflistung direkt im Code festgelegt ist.  Die Sammlung <code> -</code> kann durch Angabe der Befehlszeilenparameter --disable-default-metrics und / oder --disable-settings-metrics oder durch Definition der entsprechenden Umgebungsvariablen deaktiviert werden. <br>  Ich stelle fest, dass in der aktuellen Version das Problem der Verwendung von Metriken beim Aktivieren von autoDiscovery behoben wurde, wodurch es zu einer Duplizierung von Metriken kam, die zu Fehlern f√ºhrte. </p><br><p>  Standardm√§√üig werden Metriken aus den folgenden Ansichten an die √úberwachung gesendet: </p><br><ul><li>  pg_stat_bgwriter; </li><li>  pg_stat_database; </li><li>  pg_stat_database_conflicts; </li><li>  pg_locks; </li><li>  pg_stat_replication; </li><li>  pg_stat_activity; </li><li>  pg_settings. </li></ul><br><p>  Worauf Sie achten sollten, sind pg_stat_replication und pg_stat_activity, da die Menge der zur√ºckgegebenen Felder von der PostgreSQL-Version abh√§ngt.  Dazu wird im Exporter die DBMS-Version gepr√ºft und der entsprechende Auftrag ausgew√§hlt.  Sie k√∂nnen in Benutzerabfragen keine Version angeben.  Es wird vorausgesetzt, dass der Administrator im Voraus wei√ü, in welcher Version die Instanz √ºberwacht wird.  Probleme k√∂nnen auch auftreten, wenn Sie versuchen, Metriken von einem Exporteur aus Instanzen unterschiedlicher Versionen zu erfassen. <br>  Mit den Metriken f√ºr Instanzeinstellungen (pg_settings) ist alles etwas einfacher, sie werden durch die Anforderung gebildet: </p><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>, setting, <span class="hljs-keyword"><span class="hljs-keyword">COALESCE</span></span>(unit, <span class="hljs-string"><span class="hljs-string">''</span></span>), short_desc, vartype <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_settings <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> vartype <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> (<span class="hljs-string"><span class="hljs-string">'bool'</span></span>, <span class="hljs-string"><span class="hljs-string">'integer'</span></span>, <span class="hljs-string"><span class="hljs-string">'real'</span></span>);</code> </pre> <br><p>  Standardm√§√üig wird eine Reihe von Metriken daher nur aus numerischen Werten gebildet. </p><br><p>  Des Weiteren werden wir die Schlussfolgerung des Exporteurs ber√ºcksichtigen, einschlie√ülich der Frage, wie wir verstehen, warum hartcodierte Metriken ihr Existenzrecht haben.  Nehmen Sie zum Beispiel zwei Metriken: shared_buffers und wal_sender_timeout.  In der Ausgabe des Exporteurs erhalten wir f√ºr jede Metrik drei Zeilen. <br>  Die erste Zeile - stellt den Hinweis dar und besteht aus dem Namen der Metrik in postgres_exporter, einer Beschreibung (die Spalte short_desc der Ansicht pg_settings) und, falls eine Konvertierung in den Basistyp stattgefunden hat, welcher (der Wert in eckigen Klammern). <br>  Die zweite Zeile gibt die Art des Wertes in Prometheus an.  Und die dritte Zeile, eine Metrik mit einer Reihe von Beschriftungen und einem zugewiesenen Wert. </p><br><p>  R√ºckgabewerte f√ºr shared_buffers. </p><br><pre> <code class="plaintext hljs"># HELP pg_settings_shared_buffers_bytes Sets the number of shared memory buffers used by the server. [Units converted to bytes.] # TYPE pg_settings_shared_buffers_bytes gauge pg_settings_shared_buffers_bytes{server="127.0.0.1:5432"} 1.34217728e+08</code> </pre> <br><p>  <code>pg_settings_shared_buffers_bytes</code> - der Name der Metrik.  Es setzt sich nach den Regeln der guten Form aus dem Namen der Tabelle, dem Namen der Metrik und der Ma√üeinheit zusammen.  Als n√§chstes folgt eine kurze Beschreibung aus der Tabelle pg_settings.  Zuletzt ein Hinweis darauf, dass der Metrikwert in eine Einheit von Bytes konvertiert wurde (Einheiten in Bytes konvertiert).  Warum es sich lohnt, auf Letzteres zu achten, denn direkt in der Datenbank sieht der Wert etwas anders aus, n√§mlich: </p><br><pre> <code class="sql hljs"> name | setting | unit | short_desc <span class="hljs-comment"><span class="hljs-comment">----------------+---------+------+-------------------------------------------------------------- shared_buffers | 16384 | 8kB | Sets the number of shared memory buffers used by the server.</span></span></code> </pre> <br><p>  Die Art der Metrik ist GAUGE, was bedeutet, dass sie im Laufe der Zeit beliebige Werte annehmen kann.  In unserem Fall kann sich die Anzahl der Puffer bei der Feinabstimmung in beide Richtungen √§ndern. <br>  Weitere Informationen zu den Metriktypen und ihren Unterschieden finden Sie in der Prometheus-Dokumentation. </p><br><p>  Die folgende Metrik lautet wal_sender_timeout.  Informationsfelder werden nach dem gleichen Prinzip wie oben beschrieben gesammelt.  Nur in diesem Fall wird der Metrikwert in Sekunden konvertiert und die Datenbank in Millisekunden gespeichert.  Bei dieser Funktion m√ºssen Sie vorsichtig sein und beim Plotten von Diagrammen ber√ºcksichtigen. </p><br><pre> <code class="plaintext hljs"># HELP pg_settings_wal_sender_timeout_seconds Sets the maximum time to wait for WAL replication. [Units converted to seconds.] # TYPE pg_settings_wal_sender_timeout_seconds gauge pg_settings_wal_sender_timeout_seconds{server="127.0.0.1:5432"} 60</code> </pre> <br><p>  Der in der Datenbank gespeicherte Wert: </p><br><pre> <code class="sql hljs">demo=<span class="hljs-comment"><span class="hljs-comment"># SELECT name, setting, COALESCE(unit, ''), short_desc, vartype FROM pg_settings WHERE name='wal_sender_timeout'; name | setting | coalesce | short_desc | vartype --------------------+---------+----------+----------------------------------------------------+--------- wal_sender_timeout | 60000 | ms | Sets the maximum time to wait for WAL replication. | integer</span></span></code> </pre><br><p>  Alle Werte mit Einheiten werden auf zwei Typen reduziert: Volumenmetriken in Bytes;  Zeitmetriken zu Sekunden. </p><br><h3 id="polzovatelskiy-nabor-metrik">  Benutzerdefinierter Metriksatz </h3><br><p>  Zus√§tzlich zu oder anstelle der Standardmetriken k√∂nnen Sie Ihre eigenen verwenden.  Legen Sie dazu einfach den Dateipfad mit Benutzerabfragen √ºber das Argument --extend.query-path = query.yaml oder √ºber die Umgebungsvariable PG_EXPORTER_EXTEND_QUERY_PATH fest. <br>  Das Projekt-Repository enth√§lt eine YAML-Datei mit Beispielen: <a href="" rel="nofollow">queries.yaml</a> </p><br><p>  Ich stelle fest, dass im Vergleich zur vorherigen Version in 0.8.0 neue Schl√ºssel master und cache_seconds hinzugef√ºgt wurden.  Im folgenden Beispiel analysieren wir das Aufnahmeformat und den Zweck der Felder. </p><br><p>  Beispielinhalt der Datei queries.yaml </p><br><pre> <code class="plaintext hljs">pg_database: query: "SELECT pg_database.datname, pg_database_size(pg_database.datname) as size_bytes FROM pg_database" master: true cache_seconds: 30 metrics: - datname: usage: "LABEL" description: "Name of the database" - size_bytes: usage: "GAUGE" description: "Disk space used by the database"</code> </pre> <br><p>  Schl√ºssel und Werte aus dem obigen Beispiel: </p><br><ul><li>  <code>pg_database</code> - ein beliebiges Pr√§fix f√ºr die von der Anforderung zur√ºckgegebenen Metriken (Erforderlich); </li><li>  <code>query</code> - enth√§lt eine SQL-Abfrage (Erforderlich); </li><li>  <code>master</code> - f√ºhrt die Anforderung nur in der Datenbank aus, die beim Herstellen einer Verbindung mit der URI (master database) angegeben wurde.  Erforderlich, wenn der Exporter mit dem Flag --auto-discover-databases gestartet wird.  Akzeptiert wahr oder falsch.  Standardm√§√üig falsch.  (Optional); </li><li>  <code>cache_seconds</code> - Zeit, w√§hrend der Cache-Daten zur√ºckgegeben werden.  Es wird in Sekunden eingestellt; </li><li>  <code>metrics</code> - Enth√§lt eine Liste von Tags und Metriken. </li><li>  <code>datname</code> , <code>size_bytes</code> - Listenelement.  Der Name des Listenelements muss mit dem Namen der Spalte in der Abfrage √ºbereinstimmen. </li><li>  <code>usage</code> - Art des Wertes.  Akzeptiert COUNTER, GAUGE, LABLE (mehr in der Prometheus-Dokumentation) </li><li>  <code>description</code> - Benutzerdefinierte Metrikbeschreibung </li></ul><br><p>  Beispiel f√ºr R√ºckgabemetriken: </p><br><pre> <code class="plaintext hljs"># HELP pg_database_size_bytes Disk space used by the database # TYPE pg_database_size_bytes gauge pg_database_size_bytes{datname="dbtest1",server="localhost:5432"} 1.0105503e+07 pg_database_size_bytes{datname="demo",server="localhost:5432"} 2.813719199e+09 pg_database_size_bytes{datname="postgres",server="localhost:5432"} 4.735491e+06 pg_database_size_bytes{datname="template0",server="localhost:5432"} 7.758339e+06 pg_database_size_bytes{datname="template1",server="localhost:5432"} 7.758339e+06</code> </pre><br><h2 id="rezyume">  Zusammenfassung </h2><br><p>  Nun, wir fassen alles zusammen, was wir in der neuesten Version von postgres_exporter 0.8.0 haben.  Grunds√§tzlich beziehen sich alle Verbesserungen auf die √úberwachung mehrerer Instanzen und / oder mehrerer Datenbanken in einer Instanz. </p><br><ul><li>  Mit dem Argument "Datenbanken ausschlie√üen" (in 0.6.0 erschienen) k√∂nnen Sie Datenbanken aus der Liste der Datenbanken ausschlie√üen, f√ºr die Metriken erfasst werden.  Sie k√∂nnen jedoch die in der URI-Verbindung angegebene Datenbank nicht ausschlie√üen, da es sich um eine Masterbasis handelt. </li><li>  Jetzt k√∂nnen Sie benutzerdefinierte Abfragen f√ºr globale Ansichten (pg_stat_activity, pg_stat_database usw.) zusammen mit dem Argument auto-discover-databases verwenden.  Zu diesem Zweck wurde ein zus√§tzliches <strong>Master-</strong> Feld hinzugef√ºgt, das angibt, dass die Anforderung nur in der Master-Datenbank ausgef√ºhrt werden soll. </li><li>  Jetzt k√∂nnen Sie die Standardmetriken mit dem Argument Auto-Discovery-Datenbanken verwenden. </li><li>  F√ºr Benutzeranforderungen wurde das Feld cache_seconds hinzugef√ºgt, in dem Sie die Zeit (in Sekunden) festlegen k√∂nnen, nach der die Antwort des Servers auf die entsprechende Anforderung zwischengespeichert wird. </li></ul><br><h2 id="istochniki">  Quellen </h2><br><ul><li>  <a href="https://prometheus.io/" rel="nofollow">Prometheus</a> [ <a href="https://en.wikipedia.org/wiki/Prometheus_(software)" rel="nofollow">1</a> ] ist eine Open Source-Anwendung zur √úberwachung und Warnung von Ereignissen.  Es schreibt Echtzeitmetriken in eine Zeitreihendatenbank, die mit dem HTTP-Anforderungsmodell erstellt wurde, mit flexiblen Abfragen und Echtzeitwarnungen. </li><li>  <a href="https://github.com/wrouesnel/postgres_exporter" rel="nofollow">postgres_exporter</a> ist ein Exporteur von PostgreSQL-Metriken f√ºr Prometheus. <br>  Version zum Zeitpunkt des Schreibens, v 0.5.1.  Unterst√ºtzte Versionen von PostgreSQL 9.4+ (aber wie die Praxis gezeigt hat, funktioniert es mit 9.3). </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de480902/">https://habr.com/ru/post/de480902/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de480886/index.html">Neuronale Netze und der goldene Schnitt: zweiter Lauf</a></li>
<li><a href="../de480888/index.html">DIY Coroutinen. Teil 1. Lazy Generators</a></li>
<li><a href="../de480890/index.html">Umfrageergebnisse zur Verwendung des Express-Panels</a></li>
<li><a href="../de480892/index.html">Ballon-Internet</a></li>
<li><a href="../de480900/index.html">Bring mein Baby zur√ºck! (N.-F. Geschichte)</a></li>
<li><a href="../de480904/index.html">PHP Microservice Framework: Entwicklungsumgebung f√ºr Swoft</a></li>
<li><a href="../de480906/index.html">Ein einfaches Python-Spiel schreiben</a></li>
<li><a href="../de480910/index.html">Erstellen einer grundlegenden Testklasse f√ºr Selentests und Initialisieren √ºber JUnit RuleChain</a></li>
<li><a href="../de480912/index.html">Dap in Aktion. TodoMVC schreiben. Teil 1</a></li>
<li><a href="../de480914/index.html">Microservices f√ºr Einsteiger</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>