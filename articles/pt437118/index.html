<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèª‚Äç‚öïÔ∏è üì§ üèéÔ∏è AI e 2048. Parte 1: M√©todo Monte Carlo üè• üçÜ üåí</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=""2048" daqui a algumas semanas marca 5 anos, o que significa que √© hora de escrever algo dedicado a este jogo maravilhoso. 

 O t√≥pico de um jogo inde...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>AI e 2048. Parte 1: M√©todo Monte Carlo</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/edison/blog/437118/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img width="690" height="313" src="https://habrastorage.org/webt/7u/sw/lm/7uswlmwcbpmdfhrcmk0-qgp38iu.png"></a> <br><br>  "2048" daqui a algumas semanas marca 5 anos, o que significa que √© hora de escrever algo dedicado a este jogo maravilhoso. <br><br>  O t√≥pico de um jogo independente de intelig√™ncia artificial em um quebra-cabe√ßa √© especialmente informativo.  Existem v√°rias maneiras de implement√°-lo e hoje analisaremos uma relativamente f√°cil.  Nomeadamente, ensinaremos √† mente do computador a coletar graus de dois usando o m√©todo de Monte Carlo. <a name="habracut"></a><br><br><blockquote> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" title="EDISON Software - desenvolvimento web"><img align="left" width="153" height="75" src="https://habrastorage.org/webt/w0/zl/to/w0zltoxvysbr0yeinstkfvw1wbg.png" alt="EDISON Software - desenvolvimento web"></a> <br clear="right">  Este artigo foi escrito com o apoio da EDISON Software, uma empresa que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">desenvolve aplicativos m√≥veis</a> e fornece <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">servi√ßos de teste de software</a> . </blockquote><br>  A inspira√ß√£o para este trabalho foi uma discuss√£o sobre stackoverflow, em que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">caras espertos sugeriram maneiras eficazes de um jogo de computador</a> .  Aparentemente, a melhor maneira √© o m√©todo minimax com recorte alfa-beta e em alguns dias a pr√≥xima publica√ß√£o ser√° dedicada a ele. <br><br>  M√©todo de cassino sugerido pelo usu√°rio stackoverflow <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img width="14" height="14" src="https://habrastorage.org/webt/eo/fj/at/eofjat4aio6bqe8i7xfdcg1iswo.png"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Ronenz</a> como parte da discuss√£o acima.  A pr√≥xima se√ß√£o inteira √© uma tradu√ß√£o de sua publica√ß√£o. <br><br><h1>  M√©todo de Monte Carlo </h1><br>  Fiquei interessado na ideia de IA para este jogo, na qual <b>n√£o h√° intelig√™ncia codificada</b> (ou seja, n√£o h√° heur√≠sticas, pontua√ß√£o, etc.).  A IA deve "conhecer" apenas as regras do jogo e "entender" o jogo.  Isso o distingue da maioria das IA (como neste t√≥pico), porque a jogabilidade √©, de fato, for√ßa bruta controlada pela fun√ß√£o de pontua√ß√£o, refletindo a compreens√£o humana do jogo. <br><br><h2>  Algoritmo AI </h2><br>  Eu encontrei um algoritmo de jogo simples, mas surpreendentemente bom: para determinar o pr√≥ximo movimento para um determinado estado do campo, a IA joga o jogo na RAM, fazendo <b>movimentos aleat√≥rios</b> at√© o jogo terminar em derrota.  Isso √© feito v√°rias vezes, com a pontua√ß√£o final sendo rastreada.  Ent√£o, a pontua√ß√£o final m√©dia √© calculada levando em considera√ß√£o o curso inicial.  O movimento inicial que apresentou o resultado m√©dio mais alto √© selecionado como o movimento j√° realmente escolhido. <br><br>  Com 100 execu√ß√µes para cada turno inicial, a IA passa para 2048 em 80% dos casos e 4096 para 50% dos casos.  Ao usar 10.000 execu√ß√µes, 2048 √© obtido em 100% dos casos, 70% para 4096 e cerca de 1% para 8192. <br><img align="right" width="352" height="524" src="https://habrastorage.org/webt/81/bo/mg/81bomgvnk-q3jy4jae0ux6ljutk.png"><br clear="left">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Visualizar em a√ß√£o</a> <br><br>  O melhor resultado alcan√ßado √© mostrado na captura de tela: <br><br>  Um fato interessante para esse algoritmo √© que, embora se espere que jogos com movimentos executados aleatoriamente sejam muito ruins, no entanto, escolher o melhor (ou pelo menos ruim, se voc√™ quiser) leva a uma jogabilidade muito boa: um jogo t√≠pico de Monte Carlo AI pode marcar 70.000 pontos por 3000 jogadas, mas jogos com um jogo arbitr√°rio na mem√≥ria de qualquer posi√ß√£o fornecem uma m√©dia de 340 pontos adicionais para cerca de 40 jogadas adicionais antes de perder.  (Voc√™ pode verificar isso iniciando o AI e abrindo o console de depura√ß√£o.) <br><br>  Este gr√°fico ilustra esse conceito: a linha azul mostra a pontua√ß√£o do jogo ap√≥s cada jogada.  A linha vermelha mostra o <b>melhor</b> resultado do algoritmo, fazendo movimentos arbitrariamente dessa posi√ß√£o para o final do jogo.  De fato, os valores vermelhos ‚Äúpuxam‚Äù os azuis, pois s√£o as melhores frases do algoritmo.  Curiosamente, a linha vermelha est√° ligeiramente acima da linha azul em cada ponto, mas a linha azul reduz a diferen√ßa cada vez mais. <br><br><div style="text-align:center;"><img width="666" height="425" src="https://habrastorage.org/webt/ws/u5/j4/wsu5j4-k1wxxdzuk9ambg9amtv0.png"></div><br>  Acho surpreendente que o algoritmo n√£o preveja necessariamente uma boa jogabilidade e, no entanto, escolha os movimentos que a produzem (um bom processo). <br><br>  Mais tarde, descobri que esse m√©todo pode ser classificado como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">um algoritmo de busca em √°rvore de Monte Carlo</a> . <br><br><h2>  Implementa√ß√£o e links </h2><br>  Primeiro, criei uma vers√£o JavaScript que pode ser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">vista em a√ß√£o aqui</a> .  Esta vers√£o √© capaz de executar 100 execu√ß√µes em um per√≠odo de tempo razo√°vel.  Abra o console para mais informa√ß√µes.  ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fonte</a> ) <br><br>  Mais tarde, para brincar, usei a infraestrutura @nneonneo altamente otimizada e implementei minha vers√£o em C ++.  Esta vers√£o permite at√© 100.000 execu√ß√µes por turno e at√© 1.000.000 se voc√™ estiver pronto para esperar.  Instru√ß√µes de montagem inclu√≠das.  Tudo funciona no console e tamb√©m possui um controle remoto para reprodu√ß√£o na vers√£o web.  ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fonte</a> ) <br><br><h2>  Resultados </h2><br>  Surpreendentemente, um aumento no n√∫mero de corridas n√£o melhora fundamentalmente a jogabilidade.  Parece que essa estrat√©gia tem um limite de 80.000 pontos com um bloco de 4096 e todos os resultados menores muito pr√≥ximos de atingir o bloco 8192. Um aumento no n√∫mero de execu√ß√µes de 100 para 100.000 aumenta as chances de atingir esse limite (de 5% para 40%), mas n√£o supera isso. <br><br>  A realiza√ß√£o de 10.000 corridas com um aumento tempor√°rio de at√© 1.000.000 de posi√ß√µes pr√≥ximas da cr√≠tica tornou poss√≠vel superar essa barreira em menos de 1% dos casos, com o n√∫mero m√°ximo de pontos marcados em 129892 e nos ladrilhos 8192. <br><br><h2>  Melhorias e otimiza√ß√µes </h2><br>  Ap√≥s implementar esse algoritmo, tentei muitas melhorias, incluindo o uso de classifica√ß√µes m√≠nimas ou m√°ximas ou uma combina√ß√£o de valores m√≠nimos, m√°ximos e m√©dios.  Tamb√©m tentei usar a profundidade: em vez de tentar completar K corridas por turno, tentei K jogadas por lista de jogadas de um determinado comprimento (por exemplo, ‚Äúcima, cima, esquerda‚Äù) e escolhi a primeira jogada da lista de jogadas com a melhor vit√≥ria. <br><br>  Posteriormente, implementei uma √°rvore de pontua√ß√£o que levava em conta a probabilidade condicional de que ele seria capaz de concluir um movimento ap√≥s uma determinada lista de movimentos. <br><br>  No entanto, nenhuma dessas id√©ias mostrou uma vantagem real sobre uma simples primeira id√©ia.  Deixei um c√≥digo comentado para essas id√©ias na fonte C ++. <br><br>  Adicionei o mecanismo Deep Search, que aumentou temporariamente o n√∫mero de execu√ß√µes para 1.000.000 quando alguma delas acidentalmente conseguiu alcan√ßar o pr√≥ximo bloco mais alto.  Isso levou a uma melhoria no desempenho do tempo. <br><br>  Gostaria de saber se algu√©m tem outras id√©ias de melhoria que ap√≥iam a independ√™ncia da IA ‚Äã‚Äãem rela√ß√£o √† √°rea de assunto? <br><br><h1>  Op√ß√µes e clones 2048 </h1><br>  Por divers√£o, tamb√©m implementei a IA como um bookmarklet, conectando-a aos controles do jogo.  Isso permite que voc√™ trabalhe com o jogo original e com muitas de suas varia√ß√µes. <br><br>  Isso √© poss√≠vel devido √† natureza independente de dom√≠nio da IA.  Algumas das op√ß√µes s√£o bastante originais, como um clone hexagonal. <br><br><div class="scrollable-table"><table><tbody><tr><td>  A tradu√ß√£o est√° conclu√≠da, mas n√£o apenas para fins desta publica√ß√£o foi iniciada.  Antes da c√≥lica, eu queria testar v√°rias id√©ias para IA em 2048. Para esse prop√≥sito, implementei o jogo no Excel escrevendo um aplicativo com macros.  A implementa√ß√£o do VBA por si s√≥ n√£o √© um feito - pesquisando no Google, voc√™ pode descobrir rapidamente com uma d√∫zia de diferentes tipos de trabalhos em excel.  Mas n√£o apenas para preparar 2048 na forma de planilhas, mas tamb√©m para realizar um jogo independente de computador - ainda n√£o me deparei com isso. <br></td></tr></tbody></table></div><br><h1>  2048.xlsm </h1><br>  O pr√≥prio aplicativo Excel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pode ser baixado do Google</a> . <br><br>  A imagem √© clic√°vel - uma imagem em tamanho real ser√° aberta. <br><br> <a href=""><img width="690" height="313" src="https://habrastorage.org/webt/7u/sw/lm/7uswlmwcbpmdfhrcmk0-qgp38iu.png"></a> <br><br>  Brevemente sobre a interface e a funcionalidade do aplicativo. <br><br>  Para come√ßar a jogar, voc√™ precisa clicar no bot√£o " <b>Usu√°rio: iniciar jogo</b> ".  Quando voc√™ pressiona esse bot√£o novamente, a inscri√ß√£o muda de " <b>Usu√°rio: inicie o jogo</b> " para " <b>Usu√°rio: encerre o jogo</b> " e vice-versa, ou seja, a qualquer momento voc√™ pode interromper o jogo e inici√°-lo novamente.  Quando o jogo termina, voc√™ pode alterar manualmente o alinhamento em campo, melhorando ou piorando sua posi√ß√£o, a fim de testar ou verificar algumas id√©ias. <br><br>  Durante o jogo em si, voc√™ pode fazer jogadas de duas maneiras: <br><br><ul><li>  <b>Teclado:</b> simplesmente pressionando as teclas "cima", "baixo", "esquerda", "direita". </li><li>  <b>Com o mouse:</b> clique nas c√©lulas com grandes setas indicando a dire√ß√£o desejada. </li></ul><br>  O bot√£o " <b>Novo campo</b> " limpa o campo de jogo e coloca aleatoriamente os "dois" e "quatro" nele. <br><br>  O mais interessante √© que o m√©todo Monte Carlo foi implementado, na forma em que foi proposto pelo cara com stackoverflow.  Em cada posi√ß√£o, o computador na mem√≥ria passa por ramifica√ß√µes aleat√≥rias para cada primeiro movimento ("para cima", "para baixo", "esquerda", "direita") at√© levar a uma perda.  Estatisticamente, a dire√ß√£o mais favor√°vel √© destacada em vermelho em uma tabela especial abaixo.  Voc√™ pode us√°-lo como uma dica se perceber que seu pr√≥prio jogo est√° parado e precisar se salvar de alguma forma.  ;) <br><br>  Acima da tabela, h√° caixas de sele√ß√£o com op√ß√µes de an√°lise.  No momento, apenas Monte Carlo foi decidido, o restante ser√° adicionado nos pr√≥ximos dias (como resultado, haver√° mais problemas com a atualiza√ß√£o do aplicativo do Excel e explica√ß√µes da teoria). <br><br>  H√° tamb√©m um bot√£o <b>AI: game</b> .  Ao clicar nele, o assistente do computador far√° um movimento de acordo com o m√©todo Monte Carlo ou outro selecionado no grupo de comutadores (o minimax e a rede neural trabalhar√£o nessa lista um pouco mais tarde). <br><br><h3>  Todos os artigos das s√©ries AI e 2048 </h3><br><ul><li>  <strong>Monte Carlo</strong> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Recorte beta Minimax + alfa</a> </li><li>  Aguardando o m√°ximo </li><li>  Rede neural </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt437118/">https://habr.com/ru/post/pt437118/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt437108/index.html">A maioria dos textos na Internet √© escrita por loucos.</a></li>
<li><a href="../pt437110/index.html">Os nanomateriais est√£o mudando nosso mundo e ainda n√£o temos procedimentos para verificar sua seguran√ßa</a></li>
<li><a href="../pt437112/index.html">DMA: Mitos e Realidade</a></li>
<li><a href="../pt437114/index.html">Semin√°rio on-line aberto: ‚ÄúSSH / NC / Socat: dicas e truques‚Äù</a></li>
<li><a href="../pt437116/index.html">AWS, MongoDB e as realidades econ√¥micas do c√≥digo aberto</a></li>
<li><a href="../pt437120/index.html">Cadeira de escrit√≥rio coreana: sensa√ß√µes Harachair Miracle</a></li>
<li><a href="../pt437122/index.html">Nomeando coisas</a></li>
<li><a href="../pt437124/index.html">Uma maneira f√°cil de adicionar v√°rios idiomas ao seu site</a></li>
<li><a href="../pt437126/index.html">Artigos com DevFest SPB 2018</a></li>
<li><a href="../pt437128/index.html">QtCreator e seu uso como um IDE para Rust</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>