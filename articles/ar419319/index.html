<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ง๐ป ๐๐ฝ โ ููููุฉ ุจุฏุก Istio ุจุงุณุชุฎุฏุงู Kubernetes ูู ุงูุฅูุชุงุฌ. ุงูุฌุฒุก ุงูุฃูู ๐ ๐ ๐ฎ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุง ูู ุงุณุชูู ุ ูุฐู ูู ุดุจูุฉ ุงูุฎุฏูุฉ ุ ููู ุชูููุฉ ุชุถูู ุทุจูุฉ ูู ุงูุชุฌุฑูุฏ ุนุจุฑ ุงูุดุจูุฉ. ูุญู ูุนุชุฑุถ ูู ุฃู ุฌุฒุก ูู ุญุฑูุฉ ุงููุฑูุฑ ูู ุงููุชูุฉ ููููุฐ ูุฌููุนุฉ ูุญุฏุฏุฉ ูู ุงูุนูู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ููููุฉ ุจุฏุก Istio ุจุงุณุชุฎุฏุงู Kubernetes ูู ุงูุฅูุชุงุฌ. ุงูุฌุฒุก ุงูุฃูู</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/avito/blog/419319/" style=";text-align:right;direction:rtl">  ูุง ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงุณุชูู</a> ุ  ูุฐู ูู ุดุจูุฉ ุงูุฎุฏูุฉ ุ ููู ุชูููุฉ ุชุถูู ุทุจูุฉ ูู ุงูุชุฌุฑูุฏ ุนุจุฑ ุงูุดุจูุฉ.  ูุญู ูุนุชุฑุถ ูู ุฃู ุฌุฒุก ูู ุญุฑูุฉ ุงููุฑูุฑ ูู ุงููุชูุฉ ููููุฐ ูุฌููุนุฉ ูุญุฏุฏุฉ ูู ุงูุนูููุงุช ูุนูุง.  ุฃูููุงุ  ุนูู ุณุจูู ุงููุซุงู ุ ูููู ุจุงูุชูุฌูู ุงูุฐูู ุ ุฃู ูุทุจู ููุฌ ูุงุทุน ุงูุฏุงุฆุฑุฉ ุ ูููููุง ุชูุธูู "ูุดุฑ ุงูููุงุฑู" ุ ูุชุญููู ุญุฑูุฉ ุงููุฑูุฑ ุฌุฒุฆููุง ุฅูู ุฅุตุฏุงุฑ ุฌุฏูุฏ ูู ุงูุฎุฏูุฉ ุ ููููููุง ุชูููุฏ ุงูุชูุงุนูุงุช ุงูุฎุงุฑุฌูุฉ ูุงูุชุญูู ูู ุฌููุน ุงูุฑุญูุงุช ูู ุงููุฌููุนุฉ ุฅูู ุงูุดุจูุฉ ุงูุฎุงุฑุฌูุฉ.  ูู ุงููููู ูุถุน ููุงุนุฏ ุณูุงุณุฉ ููุชุญูู ูู ุงูุญููุงุช ุจูู ุงูุฎุฏูุงุช ุงูุตุบูุฑุฉ ุงููุฎุชููุฉ.  ุฃุฎูุฑูุง ุ ูููููุง ุงูุญุตูู ุนูู ุฎุฑูุทุฉ ุงูุชูุงุนู ุงููุงููุฉ ุนุจุฑ ุงูุดุจูุฉ ูุฌุนู ุงููุฌููุนุฉ ุงูููุญุฏุฉ ูู ุงูููุงููุณ ุดูุงูุฉ ุชูุงููุง ููุชุทุจููุงุช. <br><br>  ุญูู ุขููุฉ ุงูุนูู ูููู ุงูุนุซูุฑ ุนูููุง ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงุฆู ุงูุฑุณููุฉ</a> .  Istio ูู ุฃุฏุงุฉ ูููุฉ ุญููุง ูููููุง ุญู ุงูุนุฏูุฏ ูู ุงููุดููุงุช ูุงููุดููุงุช.  ูู ูุฐู ุงูููุงูุฉ ุ ุฃูุฏ ุฃู ุฃุฌูุจ ุนูู ุงูุฃุณุฆูุฉ ุงูุฃุณุงุณูุฉ ุงูุชู ุชูุดุฃ ุนุงุฏุฉ ูู ุจุฏุงูุฉ ุงูุนูู ูุน Istio.  ูุฐุง ุณูู ูุณุงุนุฏู ุนูู ุงูุชุนุงูู ูุนูุง ุจุดูู ุฃุณุฑุน. <br><br><img src="https://habrastorage.org/webt/cg/g_/dm/cgg_dmyxbtcrlna9cjib_vzazdm.png"><br><a name="habracut"></a><br><h3 style=";text-align:right;direction:rtl">  ูุจุฏุฃ ุงูุนูู </h3><br>  ุชุชููู Istio ูู ููุทูุชูู ุฑุฆูุณูุชูู - ูุณุชูู ุงูุชุญูู ููุณุชูู ุงูุจูุงูุงุช.  ูุญุชูู ูุณุชูู ุงูุชุญูู ุนูู ุงูููููุงุช ุงูุฑุฆูุณูุฉ ุงูุชู ุชุถูู ุงูุชุดุบูู ุงูุตุญูุญ ููุจุงูู.  ูู ุงูุฅุตุฏุงุฑ ุงูุญุงูู (1.0) ุ ุชุญุชูู ุทุงุฆุฑุฉ ุงูุชุญูู ุนูู ุซูุงุซุฉ ููููุงุช ุฑุฆูุณูุฉ: Pilot ุ Mixer ุ Citadel.  ูู ููุธุฑ ูู ุงูููุนุฉ ุ ููู ุงูุถุฑูุฑู ุฅูุดุงุก ุดูุงุฏุงุช ูุถูุงู TLS ุงููุชุจุงุฏู ุจูู ุงูุฎุฏูุงุช.  ุฏุนููุง ูููู ูุธุฑุฉ ูุงุญุตุฉ ุนูู ุงูุฌูุงุฒ ูุงูุบุฑุถ ูู Pilot ู Mixer. <br><br><img src="https://habrastorage.org/webt/bz/eb/pz/bzebpzcfxr7himr5du7j1cm18zg.png"><br><br>  Pilot ูู ุนูุตุฑ ุงูุชุญูู ุงูุฑุฆูุณู ุงูุฐู ููุดุฑ ุฌููุน ุงููุนูููุงุช ุญูู ูุง ูุฏููุง ูู ุงููุฌููุนุฉ - ุงูุฎุฏูุงุช ูููุงุท ุงูููุงูุฉ ูููุงุนุฏ ุงูุชูุฌูู (ุนูู ุณุจูู ุงููุซุงู ุ ููุงุนุฏ ูุดุฑ Canary ุฃู ููุงุนุฏ ูุงุทุน ุงูุฏุงุฆุฑุฉ). <br><br>  Mixer - ูููู ุงุฎุชูุงุฑู ููุณุชูู ุงูุชุญูู ุ ูููุฑ ุงููุฏุฑุฉ ุนูู ุฌูุน ุงูููุงููุณ ูุงูุณุฌูุงุช ูุฃู ูุนูููุงุช ุญูู ุชูุงุนูุงุช ุงูุดุจูุฉ.  ููุง ูุฑุงูุจ ุงูุงูุชุซุงู ูููุงุนุฏ ุงูุณูุงุณุฉ ูุงูุงูุชุซุงู ูุญุฏูุฏ ุงูุฃุณุนุงุฑ. <br><br>  ูุชู ุชูููุฐ ูุณุชูู ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู ุญุงููุงุช ุงููููู ุงูุฌุงูุจู.  ุจุดูู ุงูุชุฑุงุถู ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุชู ุงุณุชุฎุฏุงู ุฎุงุฏู ุงููููู ุงููุจุนูุซ</a> ุงูููู.  ูููู ุงุณุชุจุฏุงูู ุจุชูููุฐ ุขุฎุฑ ุ ุนูู ุณุจูู ุงููุซุงู nginx (nginmesh). <br><br>  ููู ูุนูู Istio ุจุดูุงููุฉ ุชุงูุฉ ููุชุทุจููุงุช ุ ููุงู ูุธุงู ุญูู ุชููุงุฆู.  ุฃุญุฏุซ ุชุทุจูู ููุงุณุจ ูุฅุตุฏุงุฑุงุช Kubernetes 1.9+ (ุงูุฑุฏ ุงูุชููุงุฆู ุนูู ุงูููุจ).  ุจุงููุณุจุฉ ูุฅุตุฏุงุฑุงุช Kubernetes 1.7 ู 1.8 ุ ูู ุงููููู ุงุณุชุฎุฏุงู ุงูููููุฆ. <br><br>  ุชุฑุชุจุท ุญุงููุงุช Sidecar ุจุงูุทูุงุฑ ุนุจุฑ ุจุฑูุชูููู GRPC ุ ูุงูุฐู ูุณูุญ ุจุชุญุณูู ูููุฐุฌ ุฏูุน ุงูุชุบููุฑุงุช ุงูุชู ุชุญุฏุซ ูู ุงููุชูุฉ.  ุจุฏุฃ ุงุณุชุฎุฏุงู GRPC ูู Envoy ููุฐ ุงูุฅุตุฏุงุฑ 1.6 ุ ูู Istio ุชู ุงุณุชุฎุฏุงูู ููุฐ ุงูุฅุตุฏุงุฑ 0.8 ููู ูููู ุชุฌุฑูุจู - ุบูุงู ุนูู golang ุนุจุฑ ุงููุจุนูุซ ุงูุฐู ูููู ุจุชูููู ูุนููุงุช ุงูุฅุทูุงู. <br><br>  Pilot ู Mixer ููุง ูููููุงู ุนุฏููู ุงูุฌูุณูุฉ ุชูุงููุง ุ ููุชู ุงูุงุญุชูุงุธ ุจุฌููุน ุงูุญุงูุงุช ูู ุงูุฐุงูุฑุฉ.  ูุชู ุชุญุฏูุฏ ุงูุชูููู ููุง ุนูู ุฃููุง ุงูููุงุฑุฏ ุงููุฎุตุตุฉ Kubernetes ุ ูุงูุชู ูุชู ุญูุธูุง ูู etcd. <br>  ูุณุชูู ูููู Istio ุนููุงู Pilot ูููุชุญ ุชุฏูู GRPC ุฅููู. <br><br>  ููุง ููุช ุ ุชุทุจู Istio ุฌููุน ุงููุธุงุฆู ุงูุดูุงูุฉ ุชูุงููุง ููุชุทุจููุงุช.  ุฏุนููุง ููุชุดู ููู.  ุงูุฎูุงุฑุฒููุฉ ูู ููุง ููู: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูุดุฑ ูุณุฎุฉ ุฌุฏูุฏุฉ ูู ุงูุฎุฏูุฉ. </li><li style=";text-align:right;direction:rtl">  ุงุนุชูุงุฏูุง ุนูู ููุฌ ุญูู ุงูุญุงููุฉ ุงูุฌุงูุจูุฉ ุ ูุชู ุฅุถุงูุฉ ุญุงููุฉ istio-init ูุญุงููุฉ ุนุงูู istio (ูุจุนูุซ) ูู ูุฑุญูุฉ ุชุทุจูู ุงูุชูููู ุ ุฃู ูููู ุฅุฏุฑุงุฌูุง ูุฏูููุง ูู ูุตู Pod ุงูุฎุงุต ุจููุงู Kubernetes. </li><li style=";text-align:right;direction:rtl"> ุญุงููุฉ istio-init ุนุจุงุฑุฉ ุนู ุจุฑูุงูุฌ ูุตู ูุทุจู ููุงุนุฏ iptables ูููููุฏ.  ููุงู ุฎูุงุฑุงู ูุฅุนุฏุงุฏ ุงูุชูุงู ุญุฑูุฉ ุงููุฑูุฑ ูู ุญุงููุฉ ูููู istio: ุงุณุชุฎุฏุงู ููุงุนุฏ iptables ูุฅุนุงุฏุฉ ุงูุชูุฌูู ุ ุฃู <a href="">TPROXY</a> .  ูู ููุช ูุชุงุจุฉ ูุฐุง ุงูุชูุฑูุฑ ุ ูุชู ุงุณุชุฎุฏุงู ุงูููุฌ ุงูุงูุชุฑุงุถู ูุน ููุงุนุฏ ุฅุนุงุฏุฉ ุงูุชูุฌูู.  ูู istio-init ูููู ุชูููู ุญุฑูุฉ ุงููุฑูุฑ ุงูุชู ูุฌุจ ุงุนุชุฑุงุถูุง ูุชูุฌูููุง ุฅูู ูููู istio.  ุนูู ุณุจูู ุงููุซุงู ุ ูู ุฃุฌู ุงุนุชุฑุงุถ ูู ุญุฑูุฉ ุงููุฑูุฑ ุงููุงุฑุฏุฉ ูุงูุตุงุฏุฑุฉ ุ ุชุญุชุงุฌ ุฅูู ุชุนููู ูุนููุงุช <code>-i</code> ู <code>-b</code> ุนูู <code>*</code> .  ููููู ุชุญุฏูุฏ ููุงูุฐ ูุนููุฉ ููุชู ุงุนุชุฑุงุถูุง.  ููู ูุง ูุชู ุงุนุชุฑุงุถ ุดุจูุฉ ูุฑุนูุฉ ูุนููุฉ ุ ููููู ุชุญุฏูุฏูุง ุจุงุณุชุฎุฏุงู ุนูุงูุฉ <code>-x</code> . </li><li style=";text-align:right;direction:rtl">  ุจุนุฏ ุชูููุฐ ุญุงููุงุช ุงูุชููุฆุฉ ุ ูุชู ุฅุทูุงู ุงูุญุงููุงุช ุงูุฑุฆูุณูุฉ ุ ุจูุง ูู ุฐูู ูููู ุงูุทูุงุฑ (ุงููุจุนูุซ).  ูุชุตู ุงูุทูุงุฑ ุงูุฐู ุชู ูุดุฑู ุจุงููุนู ุนุจุฑ GRPC ููุชููู ูุนูููุงุช ุญูู ุฌููุน ุงูุฎุฏูุงุช ูุณูุงุณุงุช ุงูุชูุฌูู ุงูููุฌูุฏุฉ ูู ุงููุฌููุนุฉ.  ููููุง ููุจูุงูุงุช ุงููุณุชููุฉ ุ ูููู ุจุชูููู ุงููุฌููุนุงุช ููุนูููุง ูุจุงุดุฑุฉู ููุงุท ุงูููุงูุฉ ูุชุทุจููุงุชูุง ูู ูุฌููุนุฉ Kubernetes.  ูู ุงูุฌุฏูุฑ ุจุงูุฐูุฑ ุฃูุถูุง ููุทุฉ ูููุฉ: ูููู ุงููุจุนูุซ ุจุดูู ุญููู ุจุฅุนุฏุงุฏ ุงููุณุชูุนูู (IP ุ ุฃุฒูุงุฌ ุงูููุงูุฐ) ุงูุชู ูุจุฏุฃ ุงูุงุณุชูุงุน ุฅูููุง.  ูุฐูู ุ ุนูุฏูุง ุชุฏุฎู ุงูุทูุจุงุช ุฅูู pod ุ ุชุชู ุฅุนุงุฏุฉ ุชูุฌูููุง ุจุงุณุชุฎุฏุงู ููุงุนุฏ iptables ูุฅุนุงุฏุฉ ุงูุชูุฌูู ูู sidecar ุ ูููู ูููุจุนูุซ ูุนุงูุฌุฉ ูุฐู ุงูุงุชุตุงูุงุช ุจูุฌุงุญ ูููู ููุงู ุญุฑูุฉ ูุฑูุฑ ุงููููู ุจุดูู ุฃูุจุฑ.  ุฃูุถูุง ูู ูุฐู ุงููุฑุญูุฉ ุ ูุชู ุฅุฑุณุงู ุงููุนูููุงุช ุฅูู Mixer ุ ูุงูุชู ุณููุงูุดูุง ูุงุญููุง ุ ูุฅุฑุณุงู ุงูุชุฏุงุฏุงุช ุงูุชุชุจุน. </li></ol><br>  ููุชูุฌุฉ ูุฐูู ุ ูุญุตู ุนูู ุดุจูุฉ ูุงููุฉ ูู ุงูุฎูุงุฏู ุงูููููุฉ ูููุจุนูุซูู ุ ูุงูุชู ูููููุง ุชูููููุง ูู ููุทุฉ ูุงุญุฏุฉ (Pilot).  ุชูุฑ ุฌููุน ุงูุทูุจุงุช ุงููุงุฑุฏุฉ ูุงูุตุงุฏุฑุฉ ูู ุฎูุงู ุงููุจุนูุซ.  ุนูุงูุฉ ุนูู ุฐูู ุ ูุชู ุงุนุชุฑุงุถ ุญุฑูุฉ ูุฑูุฑ TCP ููุท.  ููุฐุง ูุนูู ุฃู ุนููุงู IP ูุฎุฏูุฉ Kubernetes ูุญู ุจุงุณุชุฎุฏุงู kube-dns ุนุจุฑ UDP ุฏูู ุชุบููุฑ.  ุจุนุฏ ุฐูู ุ ุจุนุฏ ุงูุญู ุ ูุชู ุงุนุชุฑุงุถ ุงูุทูุจ ุงูุตุงุฏุฑ ููุนุงูุฌุชู ุจูุงุณุทุฉ ุงููุจุนูุซ ุ ูุงูุฐู ููุฑุฑ ุจุงููุนู ููุทุฉ ุงูููุงูุฉ ุงูุชู ุณูุชู ุฅุฑุณุงู ุงูุทูุจ ุฅูููุง (ุฃู ูุง ุ ูู ุญุงูุฉ ุณูุงุณุงุช ุงููุตูู ุฃู ุชุดุบูู ุฎูุงุฑุฒููุงุช ูุงุทุน ุงูุฏุงุฆุฑุฉ). <br><br>  ูุน ุชุฑุชูุจ Pilot ุ ุชุญุชุงุฌ ุงูุขู ุฅูู ููู ููููุฉ ุนูู ุงูุฎูุงุท ูุณุจุจ ุญุงุฌุชู.  ููููู ูุฑุงุกุฉ ุงููุซุงุฆู ุงูุฑุณููุฉ ุงูููุฌูุฏุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> . <br><br>  ูุชููู ุงูุฎูุงุท ูู ุดููู ุงูุญุงูู ูู ูููููู: ุงูููุงุณ ุนู ุจูุนุฏ ุ ุณูุงุณุฉ ุงูุณูุงุณุฉ (ูุจู ุงูุฅุตุฏุงุฑ 0.8 ูุงู ูููููุง ูุงุญุฏูุง ูู ุงูุฎูุงุท ุงููุชุณุงูู).  ููุงููุง ุนุจุงุฑุฉ ุนู ุฎูุงุท ุ ูู ููููุง ูุณุคูู ุนู ูููุชู.  ูุณุชูุจู ุงูููุงุณ ุนู ุจูุนุฏ Istio ุนุจุฑ GRPC ูู ุญุงููุงุช ุงูุชูุฑูุฑ ุงูุฌุงูุจู ูุนูููุงุช ุญูู ูู ูุฐูุจ ุฅูู ุฃูู ูุจุฃู ูุนููุงุช.  ููุจู Istio-policy ุงูุชุญูู ูู ุงูุทูุจุงุช ููุชุญูู ููุง ุฅุฐุง ูุงูุช ููุงุนุฏ ุงูุณูุงุณุฉ ูุณุชููุงุฉ.  ูุชู ุฅุฌุฑุงุก ุงุฎุชุจุงุฑุงุช Poilicy ุ ุจุงูุทุจุน ุ ููุณ ููู ุทูุจ ุ ูููู ูุชู ุชุฎุฒูููุง ูุคูุชูุง ุนูู ุงูุนููู (ูู ุงูุณูุงุฑุฉ ุงูุฌุงูุจูุฉ) ููุชุฑุฉ ูุนููุฉ.  ูุชู ุฅุฑุณุงู ุชุฏููู ุงูุชูุฑูุฑ ุนู ุทุฑูู ุงูุทูุจุงุช ุงููุฌูุนุฉ.  ุณูุฑู ุจุนุฏ ุฐูู ุจูููู ููููุฉ ุงูุชูููู ูุงููุนููุงุช ุงูุชู ุชุญุชุงุฌ ุฅูู ุฅุฑุณุงููุง. <br><br>  ูู ุงูููุชุฑุถ ุฃู ูููู Mixer ูููููุง ูุชุงุญูุง ููุบุงูุฉ ูููุฑ ุนูููุง ุบูุฑ ูุชูุทุน ุนูู ุฌูุน ุจูุงูุงุช ุงูููุงุณ ุนู ุจูุนุฏ ููุนุงูุฌุชูุง.  ูุชุญูู ุงููุธุงู ุฅูู ูุฎุฒู ูุคูุช ูุชุนุฏุฏ ุงููุณุชููุงุช.  ูู ุงูุจุฏุงูุฉ ุ ูุชู ุชุฎุฒูู ุงูุจูุงูุงุช ูุคูุชูุง ุนูู ุงูุฌุงูุจ ุงูุฌุงูุจู ููุญุงููุงุช ุ ุซู ุนูู ุฌุงูุจ ุงูุฎูุงุท ุซู ุฅุฑุณุงููุง ุฅูู ูุง ูุณูู ุจุฎูุงุทุงุช ุงูุฎูุงุท.  ููุชูุฌุฉ ูุฐูู ุ ูู ุญุงูุฉ ูุดู ุฃู ูู ููููุงุช ุงููุธุงู ุ ูููู ุงููุฎุฒู ุงููุคูุช ููุชุนุทู ุจุนุฏ ุงุณุชุฑุฏุงุฏ ุงููุธุงู.  ุชุนุฏ ูุงุฌูุงุช ุงููุฒุฌ ุงูุฎูููุฉ ููุงุท ุงูููุงูุฉ ูุฅุฑุณุงู ุจูุงูุงุช ุงูููุงุณ ุนู ุจูุนุฏ: statsd ู newrelic ููุง ุฅูู ุฐูู.  ููููู ูุชุงุจุฉ ุงููุงุฌูุฉ ุงูุฎูููุฉ ุ ุฅููุง ุจุณูุทุฉ ููุบุงูุฉ ุ ูุณูุฑู ููููุฉ ุงูููุงู ุจุฐูู. <br><br><img src="https://habrastorage.org/webt/pz/qy/a_/pzqya_uanc5lmnd1kdv8ddu-frc.png"><br><br>  ููุชูุฎูุต ุ ูุฅู ูุฎุทุท ุงูุนูู ูุน ุงูููุงุณ ุนู ุจุนุฏ ูู ุนูู ุงููุญู ุงูุชุงูู. <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุฑุณู ุงูุฎุฏูุฉ 1 ุทูุจูุง ููุฎุฏูุฉ 2. </li><li style=";text-align:right;direction:rtl">  ุนูุฏ ูุบุงุฏุฑุฉ ุงูุฎุฏูุฉ 1 ุ ูุชู ุชุบููู ุงูุทูุจ ูู ุฌุงูุจูุง ุงูุฌุงูุจู. </li><li style=";text-align:right;direction:rtl">  ูุฑุงูุจ ูุจุนูุซ Sidecar ููููุฉ ุชูุฑูุฑ ุทูุจ ุงูุฎุฏูุฉ 2 ูุฅุนุฏุงุฏ ุงููุนูููุงุช ุงููุงุฒูุฉ. </li><li style=";text-align:right;direction:rtl">  ุซู ูุฑุณููุง ุฅูู ุงูููุงุณ ุนู ุจุนุฏ ุจุงุณุชุฎุฏุงู ุทูุจ ุงูุชูุฑูุฑ. </li><li style=";text-align:right;direction:rtl">  ูุญุฏุฏ ูุธุงู Istio-telemetry ูุง ุฅุฐุง ูุงู ุณูุชู ุฅุฑุณุงู ูุฐุง ุงูุชูุฑูุฑ ุฅูู ุงูุฎูููุฉ ุ ูุฅูู ุฃู ุงูุจูุงูุงุช ูุฃู ุจูุงูุงุช ุณูุชู ุฅุฑุณุงููุง. </li><li style=";text-align:right;direction:rtl">  ูุฑุณู Istio-telemetry ุจูุงูุงุช ุงูุชูุฑูุฑ ุฅูู ุงููุงุฌูุฉ ุงูุฎูููุฉ ุฅุฐุง ูุฒู ุงูุฃูุฑ. </li></ol><br>  ุงูุขู ุฏุนููุง ูุฑู ููููุฉ ุงูุงูุชุดุงุฑ ูู ูุธุงู Istio ุ ุงูุฐู ูุชููู ููุท ูู ุงูููููุงุช ุงูุฑุฆูุณูุฉ (ุงูุทูุงุฑ ูุงููุจุนูุซ ุงูุฌุงูุจู). <br><br>  ุฃููุงู ุ ุฏุนูุง ูููู ูุธุฑุฉ ุนูู ุงูุชูููู ุงูุฑุฆูุณู (ุงูุดุจูุฉ) ุงูุฐู ููุฑุฃู Pilot: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: v1 kind: ConfigMap metadata: name: istio namespace: istio-system labels: app: istio service: istio data: mesh: |- #      tracing  (pilot  envoy'  ,     ) enableTracing: false #     mixer endpoint',  sidecar      #mixerCheckServer: istio-policy.istio-system:15004 #mixerReportServer: istio-telemetry.istio-system:15004 #   ,    envoy  Pilot (    envoy proxy) rdsRefreshDelay: 5s # default   envoy sidecar defaultConfig: #   rdsRefreshDelay discoveryRefreshDelay: 5s #    (     envoy) configPath: "/etc/istio/proxy" binaryPath: "/usr/local/bin/envoy" #    sidecar  (, ,      tracing span') serviceCluster: istio-proxy # ,    envoy  ,        drainDuration: 45s parentShutdownDuration: 1m0s #    REDIRECT  iptables.    TPROXY. #interceptionMode: REDIRECT # ,     admin   sidecar  (envoy) proxyAdminPort: 15000 # ,     trace'  zipkin  (     ,       ) zipkinAddress: tracing-collector.tracing:9411 # statsd     envoy  () # statsdUdpAddress: aggregator:8126 #    Mutual TLS controlPlaneAuthPolicy: NONE # ,     istio-pilot  ,     service discovery  sidecar  discoveryAddress: istio-pilot.istio-system:15007</code> </pre><br>  ุชูุฌุฏ ุฌููุน ููููุงุช ูุณุชูู ุงูุชุญูู ุงูุฑุฆูุณูุฉ ูู ูุณุงุญุฉ ุงูุงุณู ูู ูุธุงู Kubernetes. <br><br>  ุงูุญุฏ ุงูุฃุฏูู ุงูุฐู ูุญุชุงุฌู ููุดุฑ Pilot ููุท.  ููููุงู ุจุฐูู ุ ุณูู ูุณุชุฎุฏู <a href="">ูุฐุง ุงูุชูููู.</a> <br><br>  ููู ุจุชูููู ุงูุญุงููุฉ ุงูุฌุงูุจูุฉ ููุญูู ูุฏููุงู. <br><br>  ุงูุญุงููุฉ ุงูุฃูููุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">initContainers: - name: istio-init args: - -p - "15001" - -u - "1337" - -m - REDIRECT - -i - '*' - -b - '*' - -d - "" image: istio/proxy_init:1.0.0 imagePullPolicy: IfNotPresent resources: limits: memory: 128Mi securityContext: capabilities: add: - NET_ADMIN</code> </pre><br>  ูุงูุฌุงูุจ ุงูุฌุงูุจู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> name: istio-proxy args: - "bash" - "-c" - | exec /usr/local/bin/pilot-agent proxy sidecar \ --configPath \ /etc/istio/proxy \ --binaryPath \ /usr/local/bin/envoy \ --serviceCluster \ service-name \ --drainDuration \ 45s \ --parentShutdownDuration \ 1m0s \ --discoveryAddress \ istio-pilot.istio-system:15007 \ --discoveryRefreshDelay \ 1s \ --connectTimeout \ 10s \ --proxyAdminPort \ "15000" \ --controlPlaneAuthPolicy \ NONE env: - name: POD_NAME valueFrom: fieldRef: fieldPath: metadata.name - name: POD_NAMESPACE valueFrom: fieldRef: fieldPath: metadata.namespace - name: INSTANCE_IP valueFrom: fieldRef: fieldPath: status.podIP - name: ISTIO_META_POD_NAME valueFrom: fieldRef: fieldPath: metadata.name - name: ISTIO_META_INTERCEPTION_MODE value: REDIRECT image: istio/proxyv2:1.0.0 imagePullPolicy: IfNotPresent resources: requests: cpu: 100m memory: 128Mi limits: memory: 2048Mi securityContext: privileged: false readOnlyRootFilesystem: true runAsUser: 1337 volumeMounts: - mountPath: /etc/istio/proxy name: istio-envoy</code> </pre><br>  ูู ุฃุฌู ุจุฏุก ูู ุดูุก ุจูุฌุงุญ ุ ุชุญุชุงุฌ ุฅูู ุงูุญุตูู ุนูู ServiceAccount ู ClusterRole ู ClusterRoleBinding ู CRD for Pilot ุ ููููู ุงูุนุซูุฑ ุนูู ุฃูุตุงู ููุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> . <br><br>  ููุชูุฌุฉ ูุฐูู ุ ูุฌุจ ุฃู ุชุจุฏุฃ ุงูุฎุฏูุฉ ุงูุชู ูููู ูููุง ุจุญูู ุงูุณูุงุฑุฉ ุงูุฌุงูุจูุฉ ุจูุจุนูุซ ุจูุฌุงุญ ุ ูุงูุญุตูู ุนูู ูู ุงูุงูุชุดุงูุงุช ูู ุงูุทูุงุฑ ููุนุงูุฌุฉ ุงูุทูุจุงุช. <br><br>  ูู ุงูููู ุฃู ูููู ุฃู ุฌููุน ููููุงุช ูุณุชูู ุงูุชุญูู ูู ุชุทุจููุงุช ุนุฏููุฉ ุงูุญุงูุฉ ููููู ุชุญุฌูููุง ุฃููููุง ุฏูู ุฃู ูุดุงูู.  ุฌููุน ุงูุจูุงูุงุช ููุฌูุฏุฉ ูู etcd ูุฃูุตุงู ูุฎุตุตุฉ ูููุงุฑุฏ Kubernetes. <br><br>  Istio ุฃูุถูุง (ุญุชู ุงูุขู ุชุฌุฑูุจููุง) ูุฏูู ุงููุฏุฑุฉ ุนูู ุงูุฑูุถ ุฎุงุฑุฌ ุงููุฌููุนุฉ ูุงููุฏุฑุฉ ุนูู ุงููุดุงูุฏุฉ ูุงูุชูุนุซู ูุงูุชุดุงู ุงูุฎุฏูุฉ ุจูู ุงูุนุฏูุฏ ูู ูุฌููุนุงุช Kubernetes.  ููููู ูุฑุงุกุฉ ุงููุฒูุฏ ุนู ูุฐุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> . <br><br>  ุจุงููุณุจุฉ ููุชุฑููุจ ูุชุนุฏุฏ ุงููุชู ุ ูุฌุจ ูุฑุงุนุงุฉ ุงููููุฏ ุงูุชุงููุฉ: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ูููู Pod CIDR ู Service CIDR ูุฑูุฏูุง ุนุจุฑ ูู ุงููุฌููุนุงุช ููุฌุจ ุฃูุง ูุชุฏุงุฎู. </li><li style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ุชููู ุฌููุน CIDRs Pod ูุชุงุญุฉ ูู ุฃู CIDRs Pod ุจูู ุงููุฌููุนุงุช. </li><li style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ุชููู ุฌููุน ุฎูุงุฏู Kubernetes API ูุชุงุญุฉ ูุจุนุถูุง ุงูุจุนุถ. </li></ol><br>  ูุฐู ูู ุงููุนูููุงุช ุงูุฃูููุฉ ููุณุงุนุฏุชู ุนูู ุจุฏุก ุงุณุชุฎุฏุงู Istio.  ููุน ุฐูู ุ ูุง ูุฒุงู ููุงู ุงูุนุฏูุฏ ูู ุงููุฒุงูู.  ุนูู ุณุจูู ุงููุซุงู ุ ููุฒุงุช ุชูุฌูู ุญุฑูุฉ ุงููุฑูุฑ ุงูุฎุงุฑุฌูุฉ (ุฅูู ุฎุงุฑุฌ ุงููุฌููุนุฉ) ุ ูููุงูุฌ ุชุตุญูุญ ุงูุฃุฎุทุงุก ุงูุฌุงูุจูุฉ ุ ูุชุญุฏูุฏ ุงููููุงุช ุ ูุฅุนุฏุงุฏ ุฎูุงุท ููุชุงุจุฉ ุฎูููุฉ ุฎุงูุท ูุฎุตุตุฉ ุ ูุฅูุดุงุก ุขููุฉ ุชุชุจุน ูุชุดุบูููุง ุจุงุณุชุฎุฏุงู ุงููุจุนูุซ. <br>  ุณููุธุฑ ูู ูู ูุฐุง ูู ุงูููุดูุฑุงุช ุงูุชุงููุฉ.  ุงุทุฑุญ ุฃุณุฆูุชู ุ ุณุฃุญุงูู ุชุบุทูุชูุง. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar419319/">https://habr.com/ru/post/ar419319/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar419307/index.html">ุชูุชู Roskomnadzor ุจุงุชุตุงูุงุช ุงูุฃุนูุงู ุนูู Facebook</a></li>
<li><a href="../ar419309/index.html">ููู ุฌุงูุง ุณูุฑูุจุช ุงููุชูุณุท</a></li>
<li><a href="../ar419311/index.html">ุงูููุงููุณ ุงูุตูุงุนูุฉ ูู ุงูุดุฑูุฉ ุงููุตูุนุฉ ุงููุญููุฉ Effest ูุน ูุคุดุฑ ุชุฌุณูุฏ ุงูููู ุงูุฌูุฏ</a></li>
<li><a href="../ar419313/index.html">ูุตูุฉ ุจุงููุช ุฃู ูุง ูุตูุช ุญููู ุงููุณุชุดุงุฑูู ุงููุงูููู</a></li>
<li><a href="../ar419315/index.html">ุนูุฑ ุงููุญุฑู ุจุนุฏ ููุช ุงูุตุงุฑูุฎ</a></li>
<li><a href="../ar419321/index.html">SamsPcbGuide ุงูุฌุฒุก 7: ุฎุทูุท ุฅุดุงุฑุฉ ุงูุชุชุจุน. ุฃุฒูุงุฌ ุชูุงุถููุฉ</a></li>
<li><a href="../ar419323/index.html">ูู ุจุชุซุจูุช Kubernetes ุนูู Hetzner Cloud</a></li>
<li><a href="../ar419325/index.html">ููู ุงูุทุงูุจ ุฅูู ูุฑูุณุง</a></li>
<li><a href="../ar419327/index.html">ุฏููู ูุงุฆูุฉ ุงููุงุฌูุฉ ุนูู MikroTik</a></li>
<li><a href="../ar419329/index.html">ุงูุฃุญุฏุงุซ ุงูุฑูููุฉ ูู ููุณูู ูู 6 ุฅูู 12 ุฃุบุณุทุณ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>