<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ต๐ป โ๏ธ ๐จ๐ฝโโ๏ธ ูุฑุงุฌุนุฉ Google Hadoop (dataproc) ๐ฉ๐ผโ๐ซ ๐คด๐พ ๐ด๐ฟ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ููุฐ ูุชุฑุฉ ุ ููุช ุจุชูุดูุท ูุณุฎุฉ ุชุฌุฑูุจูุฉ ูุฌุงููุฉ ุชุญุช Google ูู ุฃุฌู ุงูุณุญุงุจุฉ ุงูุฎุงุตุฉ ุจูู ุ ูู ุฃุญู ูุดููุชู ุ ุงุชุถุญ ุฃู Google ุชููุญ 300 ุฏููุงุฑูุง ููุฏุฉ 12 ุดูุฑูุง ููุชุฌุฑุจุฉ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ูุฑุงุฌุนุฉ Google Hadoop (dataproc)</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421021/" style=";text-align:right;direction:rtl"> ููุฐ ูุชุฑุฉ ุ ููุช ุจุชูุดูุท ูุณุฎุฉ ุชุฌุฑูุจูุฉ ูุฌุงููุฉ ุชุญุช Google ูู ุฃุฌู ุงูุณุญุงุจุฉ ุงูุฎุงุตุฉ ุจูู ุ ูู ุฃุญู ูุดููุชู ุ ุงุชุถุญ ุฃู Google ุชููุญ 300 ุฏููุงุฑูุง ููุฏุฉ 12 ุดูุฑูุง ููุชุฌุฑุจุฉ ุ ูููู ุนูู ุนูุณ ุชููุนุงุชู ุ ูุชู ูุฑุถ ุญุฏูุฏ ุฃุฎุฑู ุฅูู ุฌุงูุจ ุญุฏ ุงูููุฒุงููุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ูู ุฃุณูุญ ุจุงุณุชุฎุฏุงู ุฃุฌูุฒุฉ ุงูุชุฑุงุถูุฉ ูุน ุฃูุซุฑ ูู 8 vcpu ูู ููุทูุฉ ูุงุญุฏุฉ.  ุจุนุฏ ูุตู ุนุงู ุ ูุฑุฑุช ุงุณุชุฎุฏุงู ููุฒุงููุฉ ุงูุชุฌุฑุจุฉ ููุชุนุฑูู ุนูู dataproc ุ ููู ูุฌููุนุฉ ููุชูุงุฉ ูุณุจููุง ูู Google.  ุชุชูุซู ุงููููุฉ ูู ูุญุงููุฉ ุชูููู ูุฏู ุณูููุฉ ุฅุทูุงู ูุดุฑูุน ุนูู ูุตูู Google ุ ุณูุงุก ูุงู ุฐูู ููุทูููุง ุฃู ุฃูู ูู ุงูุฃูุถู ุงูุชุฑููุฒ ููุฑูุง ุนูู ุฃุฌูุฒุชู ูุงูุชูููุฑ ูู ุงูุฅุฏุงุฑุฉ.  ูุฏู ุดุนูุฑ ุบุงูุถ ุจุฃู ุงูุฃุฌูุฒุฉ ุงูุญุฏูุซุฉ ููุจุงุฑ ุงูุณู ูุฌุจ ุฃู ูุชููููุง ุจุณูููุฉ ูุน ููุงุนุฏ ุงูุจูุงูุงุช ุงูุตุบูุฑุฉ ุงูุชู ุชุญุชูู ุนูู ุนุดุฑุงุช ุฃู ูุฆุงุช ุบูุบุงุจุงูุช ุ ููุชู ุชุญููููุง ุจูุญุดูุฉ ุ ุฅู ูู ููู ูุฌููุนุฉ ุงูุจูุงูุงุช ุจุฃููููุง ุ ูุฅู ุงูุบุงูุจูุฉ ุงูุนุธูู ูู ุฐุงูุฑุฉ ุงููุฌููุนุฉ.  ูุฏ ูุง ุชููู ููุงู ุญุงุฌุฉ ูุจุนุถ ุงูุจูุงูุงุช ุงููุฑุนูุฉ ุงููููุตูุฉ ููุฎุงุฒู ุงูุจูุงูุงุช. <br><br>  ุจุงุฎุชุตุงุฑ ุ ุฃุนุฌุจุช dataproc ุจุณูููุฉ ุงูุฅุทูุงู ูุงูุฅุนุฏุงุฏุงุช ุ ููุงุฑูุฉ ูุน Oracle ู Cloudera.  ูู ุงููุฑุญูุฉ ุงูุฃููู ุ ูุนุจุช ูุน ูุฌููุนุฉ ุนูุฏุฉ ูุงุญุฏุฉ ุนูู 8 vCpu ุ ูุณูุญ ุงูุญุฏ ุงูุฃูุตู ูููุง ุจุชุฌุฑุจุฉ ูุฌุงููุฉ ุชูุงููุง.  ุฅุฐุง ูุธุฑุช ุฅูู ุงูุจุณุงุทุฉ ุ ูุฅู ุงูุชูููููุฌูุง ุงูุฎุงุตุฉ ุจูู ุชุณูุญ ุจุงููุนู ููููุฏูุณููู ุจุจุฏุก ูุฌููุนุฉ ูู ุบุถูู 15 ุฏูููุฉ ุ ูุชุญููู ุจูุงูุงุช ุงูุนููุฉ ูุฅุนุฏุงุฏ ุงูุชูุงุฑูุฑ ุจุงุณุชุฎุฏุงู ุฃุฏุงุฉ BI ุนุงุฏูุฉ ุ ุฏูู ุฃู ููุงูุฐ ูุฑุนูุฉ ูุณูุทุฉ.  ุจุนุถ ุงููุนุฑูุฉ ุงูุนูููุฉ ุจุญุฏูุจ ูู ุชุนุฏ ูุทููุจุฉ ุนูู ุงูุฅุทูุงู. <br><a name="habracut"></a><br>  ูู ุญูุซ ุงููุจุฏุฃ ุ ุฑุฃูุช ุฃู ุงูุดูุก ุฑุงุฆุน ูุจุฏุงูุฉ ุณุฑูุนุฉ ููุฃููุงู ูุนูููุฉ ููููู ุชุดุบูู ูููุฐุฌ ุฃููู ูุชูููู ููุน ุงูุฃุฌูุฒุฉ ุงูุชู ุชุญุชุงุฌูุง ููููุฉ.  ููุน ุฐูู ุ ูู ุงููุงุถุญ ุฃู ูุฌููุนุฉ ุฃูุจุฑ ุ ูู ุนุดุฑุงุช ุงูุนูุฏ ุ ุณุชุฃูู ุฃูุซุฑ ุจูุซูุฑ ูู ุงุณุชุฆุฌุงุฑ + ุฒูุฌูู ูู ุงููุณุคูููู ุงูุฐูู ููุธุฑูู ุฅูู ุงููุฌููุนุฉ.  ุจุนูุฏูุง ุนู ุญูููุฉ ุฃู ุงูุณุญุงุจุฉ ุณุชุจุฏู ูุงุจูุฉ ููุญูุงุฉ ุงูุชุตุงุฏููุง.  ุญุงููุช ุงูุฎุทูุฉ ุงูุฃููู ุชูููู ุฎูุงุฑ ุฏููู ุชูุงููุง ูุน ูุฌููุนุฉ ุนูุฏุฉ ูุงุญุฏุฉ 8 vCpu ู 0.5 ุชูุฑุงุจุงูุช ูู ุงูุจูุงูุงุช ุงูุฃูููุฉ.  ูู ุญูุซ ุงููุจุฏุฃ ุ ูุฅู ุงุฎุชุจุงุฑุงุช ุดุฑุงุฑุฉ + hadoop ุนูู ูุฌููุนุงุช ุฃูุจุฑ ููุชูุฆุฉ ุจุงููุนู ุนูู ุงูุฅูุชุฑูุช ุ ููููู ุฃุฎุทุท ูุงุฎุชุจุงุฑ ุงูุฎูุงุฑ ุฃูุจุฑ ููููุงู ูู ููุช ูุงุญู. <br><br>  ูู ุณุงุนุฉ ูุงุญุฏุฉ ููุท ุ ุจุญุซุช ูู ุงูุจุฑุงูุฌ ุงููุตูุฉ ูุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูููุชูุฉ ุ ูุฃุนุฏุช ุฌุฏุงุฑูุง ุงููุงุฑู ูุฅุนุฏุงุฏ ุฎุงุฏู ุงุฏุฎุงุฑ ุ ููุง ุณูุญ ูู jdbc ุจุงูุงุชุตุงู ุจู sql ูู Windows ุงูููุฒูู.  ุฃูุถูุช ุณุงุนุชูู ุฃู ุซูุงุซ ุณุงุนุงุช ุฃุฎุฑู ูู ุชุญุณูู ุฅุนุฏุงุฏุงุช ุงูุดุฑุงุฑุฉ ุงูุงูุชุฑุงุถูุฉ ูุชุญููู ุทุงููุชูู ุตุบูุฑุชูู ุจุญุฌู 10 ุบูุบุงุจุงูุช (ุญุฌู ูููุงุช ุงูุจูุงูุงุช ูู Oracle).  ุฏูุนุช ุงูุฌุฏุงูู ุจุฃููููุง ูู ุงูุฐุงูุฑุฉ (ุชุบููุฑ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ููุฌุฏูู ุ) ููุงู ูู ุงููููู ุงูุนูู ูุนูุง ูู ุฌูุงุฒ Windows ุงูุฎุงุต ุจู ูู Dbeaver ู Tableau (ุนุจุฑ ููุตู ุดุฑุงุฑุฉ SQL). <br><br>  ุงูุชุฑุงุถููุง ุ ุงุณุชุฎุฏูุช ุดุฑุงุฑุฉ ูููุฐูุง ูุงุญุฏูุง ููุท ุนูู 4 vCpu ุ ูุญุฑุฑุช ุดุฑุงุฑุฉ defaults.conf ุ ูุซุจุช 3 ูููุฐูู ุ ู 2 vCpu ููู ููููุง ููู ุฃุชููู ููุฐ ูุชุฑุฉ ุทูููุฉ ูู ููู ุณุจุจ ูุฌูุฏ ุญุงุณูุจ ูููุฑุฏ ูุงุญุฏ ููุท ูู ุนููู.  ุงุชุถุญ ุฃููู ูู ุฃุนุฏู ุงูุฐุงูุฑุฉ ุ ูุงูุฎููุท ุงูุฃุฎุฑู ูู ุชุณุชุทุน ุจุจุณุงุทุฉ ุชุฎุตูุต ุงูุฐุงูุฑุฉ.  ููุช ุจุชุนููู 6.5 ุบูุบุงุจุงูุช ุนูู executer ุ ูุจุนุฏ ุฐูู ุจุฏุฃ ุงูุซูุงุซุฉ ูู ุงูุงุฑุชูุงุน ููุง ูู ูุชููุน. <br>  ุจุนุฏ ุฐูู ุ ูุฑุฑุช ุงููุนุจ ุจุญุฌู ุตูุช ุฃูุซุฑ ุฎุทูุฑุฉ ููููุงู ููููุฉ ุฃูุฑุจ ุฅูู DWH ูู ุงุฎุชุจุงุฑุงุช TPC-DS.  ุจุงููุณุจุฉ ูููุจุชุฏุฆูู ุ ููุช ุฑุณูููุง ุจุฅูุดุงุก ุฌุฏุงูู ุจูุนุงูู ููุงุณ 500 ููุฃุฏุงุฉ ุงูุฑุณููุฉ. ุญุตูุช ุนูู ุดูุก ูุซู 480 ุบูุบุงุจุงูุช ูู ุงูุจูุงูุงุช ุงูุฃูููุฉ (ูุต ูุญุฏุฏ).  ุงุฎุชุจุงุฑ TPC-DS ูู DWH ูููุฐุฌู ุ ูุน ุงูุญูุงุฆู ูุงูุฃุจุนุงุฏ.  ูู ุฃูู ุฃููู ููููุฉ ุฅูุดุงุก ุงูุจูุงูุงุช ูุจุงุดุฑุฉ ุนูู ุชุฎุฒูู google ุ ูุงุถุทุฑุฑุช ุฅูู ุฅูุดุงุก ุฃุฌูุฒุฉ ุงูุชุฑุงุถูุฉ ุนูู ุงููุฑุต ุซู ูุณุฎูุง ุฅูู ุชุฎุฒูู google.  ุฌูุฌู ุ ููุง ุฃููููุง ุ ุชุนุชูุฏ ุฃู ุบุทุงุก ุงููุญุฑู ูุนูู ุจุดูู ูุซุงูู ูุน ุชุฎุฒูู ุฌูุฌู ูุงูุณุฑุนุฉ ููุงู ุฃูุถู ููููุงู ููุง ูู ูุงูุช ุงูุจูุงูุงุช ุฏุงุฎู ุงููุฌููุนุฉ ุนูู HDFS.  ูู ูุฐู ุงูุญุงูุฉ ุ ููุชูู ุฌุฒุก ูู ุงูุญูู ูู HDFS ุฅูู ุชุฎุฒูู google. <br><br>  ุจุนุฏ ุงูุงุชุตุงู ูู ุฎูุงู Dbeaver ุ ููุช ุจุชุญููู ุงููููุงุช ุงููุตูุฉ ุฅูู ุฃุฌูุฒุฉ ููุญูุฉ ูุงุฆูุฉ ุนูู ุงูุจุงุฑููู ูุน ุชุบููู ุณุฑูุน ุจุงุณุชุฎุฏุงู ุฃูุงูุฑ SQL.  480 ุฌูุฌุง ุจุงูุช ูู ุงูุจูุงูุงุช ุงููุตูุฉ ูุนุจุฃุฉ ูู ูููุงุช ุงูุจุงุฑููู 187 ุฌูุฌุง ุจุงูุช.  ุงุณุชุบุฑูุช ุงูุนูููุฉ ุญูุงูู ุณุงุนุชูู ุ ูุงุญุชูุช ุฃูุจุฑ ุทุงููุฉ ูู ุงููุต 188 ุบูุบุงุจุงูุช ุ ููุงู 3 ุดุฑุทููู ุจุชุญููููุง ุฅูู ุจุงุฑููู ูู 74 ุฏูููุฉ ุ ููุงู ุญุฌู ุงูุณูุงุฑุฉ ุงูุฑูุงุถูุฉ ูุชุนุฏุฏุฉ ุงูุงุณุชุฎุฏุงูุงุช 66.8 ุบูุบุงุจุงูุช.  ุนูู ุณุทุญ ุงูููุชุจ ุงูุฎุงุต ุจู ูุน ููุณ 8 vCpu (i7-3770k) ุฃุนุชูุฏ ุฃู "ุฅุฏุฑุงุฌ ูู ุฌุฏูู ุญุฏุฏ * ..." ูู ุฌุฏูู ุฃูุฑุงูู ูุน ูุชูุฉ 8 ูููู ุณูุณุชุบุฑู ููููุง ุ ูุงูููุฏุงุฑ ุงูุฐู ุณูุณุชุบุฑูู ููู ุงูุจูุงูุงุช ุฃูุฑ ูุฎูู. <br><br><img src="https://habrastorage.org/webt/lu/qf/q1/luqfq1slztl3vqur8d3q19gfiy0.png" alt="ุงูุตูุฑุฉ"><br><br>  ุจุนุฏ ุฐูู ุ ุฑุงุฌุนุช ุฃุฏุงุก ุฃุฏูุงุช BI ุนูู ูุซู ูุฐุง ุงูุชูููู ุ ูููุช ุจุจูุงุก ุชูุฑูุฑ ุจุณูุท ูู Tableua <br><br><img src="https://habrastorage.org/webt/ww/pd/ka/wwpdkamuyenfsivuobd3jjwr4xk.png" alt="ุงูุตูุฑุฉ"><br><br>  ุจุงููุณุจุฉ ุฅูู ุงูุงุณุชูุณุงุฑุงุช ุ Query1 ูู ุงุฎุชุจุงุฑ TPC-DS <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงูุงุณุชุนูุงู 1</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> customer_total_return <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> sr_customer_sk <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> ctr_customer_sk, sr_store_sk <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> ctr_store_sk, <span class="hljs-keyword"><span class="hljs-keyword">Sum</span></span>(sr_return_amt) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> ctr_total_return <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> store_returns, date_dim <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> sr_returned_date_sk = d_date_sk <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> d_year = <span class="hljs-number"><span class="hljs-number">2001</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> sr_customer_sk, sr_store_sk) <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> c_customer_id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> customer_total_return ctr1, <span class="hljs-keyword"><span class="hljs-keyword">store</span></span>, customer <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> ctr1.ctr_total_return &gt; (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Avg</span></span>(ctr_total_return) * <span class="hljs-number"><span class="hljs-number">1.2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> customer_total_return ctr2 <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> ctr1.ctr_store_sk = ctr2.ctr_store_sk) <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> s_store_sk = ctr1.ctr_store_sk <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> s_state = <span class="hljs-string"><span class="hljs-string">'TN'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> ctr1.ctr_customer_sk = c_customer_sk <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> c_customer_id <span class="hljs-keyword"><span class="hljs-keyword">LIMIT</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>;</code> </pre> <br></div></div><br>  ุงูุชูู ูู 1:08 ุ Query2 ุจูุดุงุฑูุฉ ุฃูุจุฑ ุงูุฌุฏุงูู (ูุชุงููุฌ_ุงููุจูุนุงุช ุ ูุจูุนุงุช ุงูููุจ) <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงูุงุณุชุนูุงู 2</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> wscs <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> sold_date_sk, sales_price <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> ws_sold_date_sk sold_date_sk, ws_ext_sales_price sales_price <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> web_sales) <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> ALL (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> cs_sold_date_sk sold_date_sk, cs_ext_sales_price sales_price <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> catalog_sales)), wswscs <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> d_week_seq, <span class="hljs-keyword"><span class="hljs-keyword">Sum</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> ( d_day_name = <span class="hljs-string"><span class="hljs-string">'Sunday'</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> sales_price <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>) sun_sales, <span class="hljs-keyword"><span class="hljs-keyword">Sum</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> ( d_day_name = <span class="hljs-string"><span class="hljs-string">'Monday'</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> sales_price <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>) mon_sales, <span class="hljs-keyword"><span class="hljs-keyword">Sum</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> ( d_day_name = <span class="hljs-string"><span class="hljs-string">'Tuesday'</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> sales_price <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>) tue_sales, <span class="hljs-keyword"><span class="hljs-keyword">Sum</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> ( d_day_name = <span class="hljs-string"><span class="hljs-string">'Wednesday'</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> sales_price <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>) wed_sales, <span class="hljs-keyword"><span class="hljs-keyword">Sum</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> ( d_day_name = <span class="hljs-string"><span class="hljs-string">'Thursday'</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> sales_price <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>) thu_sales, <span class="hljs-keyword"><span class="hljs-keyword">Sum</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> ( d_day_name = <span class="hljs-string"><span class="hljs-string">'Friday'</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> sales_price <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>) fri_sales, <span class="hljs-keyword"><span class="hljs-keyword">Sum</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> ( d_day_name = <span class="hljs-string"><span class="hljs-string">'Saturday'</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> sales_price <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>) sat_sales <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> wscs, date_dim <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> d_date_sk = sold_date_sk <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> d_week_seq) <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> d_week_seq1, <span class="hljs-keyword"><span class="hljs-keyword">Round</span></span>(sun_sales1 / sun_sales2, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">Round</span></span>(mon_sales1 / mon_sales2, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">Round</span></span>(tue_sales1 / tue_sales2, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">Round</span></span>(wed_sales1 / wed_sales2, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">Round</span></span>(thu_sales1 / thu_sales2, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">Round</span></span>(fri_sales1 / fri_sales2, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">Round</span></span>(sat_sales1 / sat_sales2, <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> wswscs.d_week_seq d_week_seq1, sun_sales sun_sales1, mon_sales mon_sales1, tue_sales tue_sales1, wed_sales wed_sales1, thu_sales thu_sales1, fri_sales fri_sales1, sat_sales sat_sales1 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> wswscs, date_dim <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> date_dim.d_week_seq = wswscs.d_week_seq <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> d_year = <span class="hljs-number"><span class="hljs-number">1998</span></span>) y, (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> wswscs.d_week_seq d_week_seq2, sun_sales sun_sales2, mon_sales mon_sales2, tue_sales tue_sales2, wed_sales wed_sales2, thu_sales thu_sales2, fri_sales fri_sales2, sat_sales sat_sales2 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> wswscs, date_dim <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> date_dim.d_week_seq = wswscs.d_week_seq <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> d_year = <span class="hljs-number"><span class="hljs-number">1998</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span>) z <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> d_week_seq1 = d_week_seq2 - <span class="hljs-number"><span class="hljs-number">53</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> d_week_seq1;</code> </pre><br></div></div><br>  ุชู ุงูุงูุชูุงุก ูู 4:33 ุฏูููุฉ ุ Query3 ูู 3.6 ุ Query4 ูู 32 ุฏูููุฉ. <br><br>  ุฅุฐุง ูุงู ุดุฎุต ูุง ููุชููุง ุจุงูุฅุนุฏุงุฏุงุช ุ ููู ุจูุต ููุงุญุธุงุชู ุญูู ุฅูุดุงุก ูุฌููุนุฉ.  ูู ุญูุซ ุงููุจุฏุฃ ุ ูุง ููุฌุฏ ุณูู ุจุถุนุฉ ุฃูุงูุฑ gcloud ูุฅุนุฏุงุฏ HIVE_SERVER2_THRIFT_PORT. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ููุงุญุธุงุช</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ุฎูุงุฑ ูุชูุฉ ุงูุนูุฏุฉ ูุงุญุฏ: <br>  ูุฌููุนุงุช ุจูุงูุงุช dclap - gcloud - ุงูููุทูุฉ ุงูุฃูุฑูุจูุฉ ุงูุดูุงููุฉ 1 ุฅูุดุงุก test1 \ <br>  - ุดุจูุฉ ูุฑุนูุฉ ุงูุชุฑุงุถูุฉ \ <br>  - ุดุฑูุท ุฏูู 1 \ <br>  - ููุทูุฉ ุงูุฑูุจุง ุดูุงูุง 1 ุฃ \ <br>  - ุนูุฏุฉ ูุงุญุฏุฉ \ <br>  - ููุน ุงููุงูููุฉ ุงููุณุคูู n1-highmem-8 \ <br>  - ูุฏูุฑ ูุฑุต ุชูููุฏ ุจุญุฌู 500 \ <br>  - ุตูุฑุฉ ุงูุฅุตุฏุงุฑ 1.3 \ <br>  --initialization-Actions gs: //dataproc-initialization-actions/hue/hue.sh \ <br>  --initialization-Actions gs: //dataproc-initialization-actions/zeppelin/zeppelin.sh \ <br>  --initialization-Actions gs: //dataproc-initialization-actions/hive-hcatalog/hive-hcatalog.sh \ <br>  - ูุดุฑูุน 123 <br><br>  ุฎูุงุฑ ูู 3 ุนูุฏ: <br>  ูุฌููุนุงุช ุจูุงูุงุช dclap gcloud - ุงูููุทูุฉ ุงูุฃูุฑูุจูุฉ ุงูุดูุงููุฉ 1 \ <br>  ุฅูุดุงุก ูุชูุฉ ุงูุงุฎุชุจุงุฑ 1 - ุงูุดุฑูุท ุฏูู 1 \ <br>  - ุดุจูุฉ ูุฑุนูุฉ ุงูุชุฑุงุถูุฉ - ููุทูุฉ ุฃูุฑูุจุง-ุดูุงู 1-ุฃ \ <br>  - ููุน ุงููุงูููุฉ ุงููุณุคูู n1-standard-1 \ <br>  - ูุฏูุฑ - ูุฑุต ุชูููุฏ - ุญุฌู 10 - ุนุฏุฏ ุงูุนุงูููู 2 \ <br>  - ุนุงูู ูู ููุน ุงูุฌูุงุฒ n1-standard-1 - ุนุงูู - ูุฑุต ุชูููุฏ - ุญุฌู 10 \ <br>  --initialization-Actions gs: //dataproc-initialization-actions/hue/hue.sh \ <br>  --initialization-Actions gs: //dataproc-initialization-actions/zeppelin/zeppelin.sh \ <br>  --initialization-Actions gs: //dataproc-initialization-actions/hive-hcatalog/hive-hcatalog.sh \ <br>  - ูุดุฑูุน 123 <br><br>  ุญุณุงุจ gcloud - ูุดุฑูุน = 123 \ <br>  ููุงุนุฏ ุฌุฏุงุฑ ุงูุญูุงูุฉ ุฅูุดุงุก allow-dataproc \ <br>  - ุงูุงุชุฌุงู = INGRESS - ุงูุฃููููุฉ = 1000 - ุงูุดุจูุฉ = ุงูุชุฑุงุถู \ <br>  - ุงูุนูู = ุงูุณูุงุญ - ุงูููุงุนุฏ = tcp: 8088 ุ tcp: 50070 ุ tcp: 8080 ุ tcp: 10010 ุ tcp: 10000 \ <br>  - ูุทุงูุงุช ุงููุตุฏุฑ = xxx.xxx.xxx.xxx / 32 - ุนูุงูุงุช ุงููุฏู = dataproc <br><br>  ูู ุงูุนูุฏุฉ ุงูุฑุฆูุณูุฉ: <br>  sudo su - vi /usr/lib/spark/conf/spark-env.sh <br>  ุงูุชุบููุฑ: ุชุตุฏูุฑ HIVE_SERVER2_THRIFT_PORT = 10010 <br><br>  sudo -u spark /usr/lib/spark/sbin/start-thriftserver.sh <br></div></div><br>  ูุชุจุน ... </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar421021/">https://habr.com/ru/post/ar421021/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar421007/index.html">ูุณุฌู ุงูุดุฑูุท - ุฃุฏุงุฉ ูุชุณุฌูู ุงูุงุฎุชุจุงุฑุงุช ุงูุฐุงุชูุฉ</a></li>
<li><a href="../ar421009/index.html">25 ู 26 ุฃุบุณุทุณ: ูุคุชูุฑ ุนุจุฑ ุงูุฅูุชุฑูุช ุญูู ุงูุฅุฏุงุฑุฉ ุงูุชุดุบูููุฉ</a></li>
<li><a href="../ar421011/index.html">ุงูุฃุณุฆูุฉ ูู ุงูููุงุจูุฉ ุงูุชู ุชุนุชูุฏ ุฃููุง ุบุจูุฉ. ููู ููุณ ุญููุง</a></li>
<li><a href="../ar421015/index.html">ูุณุญ ุงูุงุณุชุฏุงูุฉ ูุนุงู 2018 ููุทุงุนุงุช ุงูุฅูุชุฑูุช ุงููุทููุฉ</a></li>
<li><a href="../ar421019/index.html">ูุดุฑ ุฎุฏูุฉ Windows ุงูุฎุงุตุฉ ุจู - ุฏููู "ุงููุจุฑูุฌูู ุบูุฑ ุงูุญูููููู"</a></li>
<li><a href="../ar421023/index.html">ุงููุตุงู ุงูุดุฎุตูุฉ ูู ุงูุดุฑูุงุช</a></li>
<li><a href="../ar421025/index.html">7 ุฌุฏุฑุงู ุญูุงูุฉ ูููุฉ ูุฏุงุฑุฉ ูุญูุงูุฉ ุงูุจููุฉ ุงูุชุญุชูุฉ ุงูุณุญุงุจูุฉ ุงูุฎุงุตุฉ ุจู</a></li>
<li><a href="../ar421027/index.html">SDMX (ุชุจุงุฏู ุงูุจูุงูุงุช ุงูุฅุญุตุงุฆูุฉ ูุงูุจูุงูุงุช ุงููุตููุฉ)</a></li>
<li><a href="../ar421029/index.html">ููููุฉ ุฒูุงุฏุฉ ุฅูุชุงุฌูุฉ ุงููุฎุงุฒู ูุงูุชุฎูุต ูู ุงูุทูุงุจูุฑ</a></li>
<li><a href="../ar421031/index.html">Random.org - 20 ุนุงูุง ูู ุงูุชุงุฑูุฎ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>