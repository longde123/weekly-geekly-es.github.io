<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧖 🦗 🔝 Sebagai seorang programmer, kernel datacenter menulis 🔋 🔑 🔱</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hanya sedikit orang yang percaya bahwa tumpukan ilmu data modern dapat dibangun bukan dengan Python, tetapi ada preseden seperti itu :). Tumpukan Odno...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sebagai seorang programmer, kernel datacenter menulis</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/odnoklassniki/blog/439394/"><img src="https://habrastorage.org/getpro/habr/post_images/ff7/128/e7e/ff7128e7e376b301570865e4d2436d4e.png"><br><p>  Hanya sedikit orang yang percaya bahwa tumpukan ilmu data modern dapat dibangun bukan dengan Python, tetapi ada preseden seperti itu :).  Tumpukan Odnoklassniki dibentuk selama bertahun-tahun, terutama oleh programmer yang beralih ke ilmu data, tetapi masih tetap dekat dengan produk, sehingga didasarkan pada teknologi terbuka tumpukan JVM: Hadoop, Spark, Kafka, Cassandra, dll.  Ini membantu kami mengurangi waktu dan biaya untuk menjalankan model, tetapi kadang-kadang hal itu menimbulkan kesulitan.  Misalnya, ketika menyiapkan solusi dasar untuk peserta <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">SNA Hackathon 2019</a> , mereka harus mengompresi tekad mereka dan terjun ke dunia pengetikan dinamis.  Detail (dan trolling mudah) di bawah cut :) </p><a name="habracut"></a><br><h3>  Instalasi </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/dc2/4eb/aff/dc24ebaff7995594e4a9abdef0f65bf6.jpg"><br><p> Ada beberapa jenis python di hampir semua mesin pengembangan.  Dia ditemukan di tambang, sudah dalam rangkap - 2.7 dan 3.4.  Setelah mencari-cari di tempat memori, saya ingat bahwa saya menginstal versi 3.4 tiga tahun lalu, setelah para peserta menghadapi masalah epik di SNA Hackathon 2016, mencoba untuk memperluas grafik setengah gigabyte dalam memori (sebagai hasil dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">video pelatihan</a> kecil dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kompetisi terpisah</a> ), tetapi hari ini adalah ekonomi sudah usang secara moral dan perlu diperbarui. </p><br><p>  Di dunia Jawa, setiap proyek selama pertemuan menunjukkan semua yang ingin dimasukkan ke dalam dirinya sendiri, dan terus berlanjut dengan ini.  Secara teori, semuanya sederhana dan indah, tetapi dalam praktiknya, ketika Anda membutuhkan pustaka A dan pustaka B, pasti keduanya akan membutuhkan pustaka C, dengan dua versi yang tidak kompatibel :).  Dalam upaya yang sia-sia untuk memutus lingkaran setan ini, beberapa perpustakaan mengemas semua dependensinya dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">diri mereka sendiri</a> dan bersembunyi dari yang lain, sementara sisanya berputar semampu mereka. </p><br><p>  Ada apa dengan python ini?  Tidak ada proyek seperti itu, tetapi ada "lingkungan", dan dalam setiap lingkungan, ekosistem independen dapat dibentuk dari paket versi tertentu.  Pada saat yang sama, ada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">alat untuk malas</a> , dengan bantuan yang tidak lebih sulit untuk mengelola lingkungan Python lokal, daripada cluster heterogen yang didistribusikan Clauder atau Horton.  Tetapi konflik timbal balik antara versi paket tidak akan terjadi di mana-mana. Saya segera dihadapkan dengan kenyataan bahwa rilis <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pandas 0.24</a> mengalihkan metode _maybe_box_datetimelike pribadi ke API publik, dan tiba-tiba ternyata banyak orang telah menggunakannya dalam bentuk sebelumnya dan sekarang jatuh :) (dan ya, di Dunia Jawa adalah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sama</a> ).  Tetapi pada akhirnya, semuanya diperbaiki, terlepas dari peringatan mengerikan tentang depriycheyshin baru, itu berhasil. </p><br><h3>  Garis dasar kolaboratif </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/014/e7e/7b5/014e7e7b5ff3aa7c85a439e588e738fd.png" alt="gambar"><br><p>  Tugas-tugas di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">SNA Hackathon 2019</a> dibagi menjadi tiga area - rekomendasi untuk log, teks dan gambar.  Mari kita mulai dengan log (spoiler - megapattern Cmd + C / Cmd + V dengan stackoverflow juga berfungsi dengan python).  Data dikumpulkan dari produksi langsung - setiap pengguna secara acak, tanpa menimbang, ditunjukkan beberapa umpan dari lingkungannya, setelah semua tanda pada saat pertunjukan dan reaksi akhir dicatat dalam log.  Sepotong tugas kue: kita mengambil tanda, kita mendorong <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">logg</a> , untung! </p><br><p>  Tetapi rencana itu terlintas pada tahap pertama, saat membaca data.  Secara teori, ada paket <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Apache Arrow</a> yang luar biasa, yang seharusnya menyatukan pekerjaan dengan data dalam ekosistem yang berbeda dan, khususnya, untuk memungkinkan membaca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">file "parket"</a> dari python tanpa percikan.  Dalam praktiknya, ternyata.  bahwa bahkan dengan membaca struktur bersarang sederhana ia memiliki <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">masalah</a> , dan hierarki kita yang indah telah berubah menjadi kemelaratan datar :(. </p><br><p>  Tetapi ada aspek-aspek positif.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jupyter</a> , secara umum, senang, itu hampir sama nyamannya, meskipun tidak secantik <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Zeppelin</a> .  Bahkan ada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">inti batu</a> !  Nah, kecepatan regresi logistik pada sepotong kecil data dalam memori senang - itu tidak mencapai kekuatan opsi yang didistribusikan, tetapi belajar langsung pada empat tanda dan beberapa ratus ribu contoh. </p><br><p>  Namun, kemudian, antusiasme yang muncul terpukul keras: jika transformasi data yang diperlukan (kelompok dengan kunci dan berkumpul ke dalam daftar) tidak ada dalam daftar standar dan berlaku atau peta muncul, maka kecepatan turun berdasarkan urutan besarnya.  Akibatnya, 80% dari waktu baseline tidak membaca data, bergabung, pelatihan model dan penyortiran, tetapi kompilasi dangkal dari daftar. </p><br><p>  By the way, justru karena fitur ini saya selalu terkejut dengan pengguna pySpark - setelah semua, hampir semua fungsi standar tersedia dalam bentuk Spark SQL, yang sama dalam python dan rock, dan setelah python-seperti yudf-in pertama dengan sesuatu yang personal seperseribu ribu cluster berubah menjadi labu ... </p><br><p>  Tapi, pada akhirnya, semua rintangan diatasi dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sembilan</a> poin sudah cukup untuk skor 0,65! </p><br><h3>  Garis dasar teks </h3><br><img src="https://habrastorage.org/webt/f2/tq/ei/f2tqei-pbxqoaan8z1jhmyesija.png"><br><p>  Nah, sekarang tugas kita lebih rumit - jika logreg dapat ditemukan dalam ratusan implementasi untuk semua platform, maka ada lebih banyak variasi alat untuk bekerja dengan teks di bawah python.  Untungnya, teks sudah dikirim tidak hanya dalam bentuk mentah, tetapi juga diproses oleh sistem preprocessing reguler kami yang didasarkan pada Spark dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Lucene</a> .  Karena itu, Anda dapat segera mengambil daftar token dan tidak khawatir tentang tokenization / lematization / stemming. </p><br><p>  Untuk beberapa waktu saya ragu harus mengambil apa: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">BigARTM</a> domestik atau <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Gensim</a> impor.  Akibatnya, saya memilih yang kedua dan menyalin <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tutorial doc2vec</a> :).  Saya berharap kolega dari tim BigARTM tidak akan gagal untuk mengambil kesempatan dan menunjukkan keunggulan perpustakaan mereka di kompetisi. </p><br><p>  Kami sekali lagi memiliki rencana sederhana: kami mengambil semua teks dari tes, melatih model Doc2Vec, kemudian menyimpulkannya di kereta dan mempelajari logreg pada hasilnya (susun adalah segalanya bagi kami!).  Tapi, seperti biasa, masalah dimulai segera.  Meskipun jumlah teks yang relatif sederhana dalam sampel pelatihan (hanya satu setengah gigabyte), ketika mencoba menyeretnya ke jalan, python memakan 20 (20 Karl!) Memori, beralih ke swap dan tidak kembali.  Saya harus makan gajah di beberapa bagian. </p><br><p>  Saat membaca, kami selalu menunjukkan kolom mana yang akan diangkat dari lantai, yang memungkinkan kami untuk tidak membaca teks mentah dalam memori.  Ini menghemat penggunaannya hingga setengahnya, dokumen dari set uji dimuat ke dalam memori untuk pelatihan tanpa masalah.  Dengan satu set pelatihan trik semacam itu tidak cukup, jadi pada suatu waktu kami mengunggah tidak lebih dari satu file "parket".  Selanjutnya, dalam file yang diunduh, kami hanya meninggalkan ID hari yang ingin kami gunakan untuk pelatihan, dan kami sudah menyimpulkannya. </p><br><p>  Logging di atas ini berfungsi sama cepatnya, dan pada akhirnya kita mendapatkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">14 paragraf</a> dan skor 0,54 :) </p><br><h3>  Garis dasar gambar </h3><br><p><img src="https://habrastorage.org/webt/7_/6s/aw/7_6sawssmwohrrk1spxk9_zuqy8.jpeg"></p><br><p>  Apa yang bisa lebih populer daripada pembelajaran mendalam?  Hanya kucing!  Oleh karena itu, untuk gambar dasar, kami membuat rencana sederhana yang brilian: kami menjalankan detektor kucing pada gambar-gambar dari set tes, dan kemudian kami memberi peringkat konten sesuai dengan skor :) </p><br><p>  Dan lagi ada banyak untuk dipilih.  Klasifikasi atau deteksi?  pyTorch atau Tensorflow?  Kriteria utama adalah kemudahan implementasi dengan metode copy-paste.  Dan pemenangnya adalah ... <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">YOLOv3 di MXNet</a> :).  Keringkasan demo mereka memikat pada pandangan pertama, tetapi kemudian, seperti biasa, masalah dimulai. </p><br><p>  Apa yang bekerja dengan data besar biasanya dimulai?  Dengan perkiraan kinerja dan waktu alat berat yang diperlukan!  Saya ingin membuat garis dasar se otonom mungkin, jadi mereka mengajarkannya untuk bekerja secara langsung dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">file tar</a> dan dengan cepat menyadari bahwa dengan kecepatan mengekstraksi 200 foto per detik dari tar ke tmpfs, dibutuhkan waktu sekitar setengah jam, norma untuk memproses 352.758 gambar.  Tambahkan pemuatan dan preprocessing foto - 100 per detik, sekitar satu jam untuk semuanya, norma.  Tambahkan perhitungan jaringan saraf - 20 foto per detik, 5 jam, yah ... ok. Tambahkan hasil ekstraksi - 1 foto per detik, minggu, WTF? </p><br><p>  Setelah beberapa jam menari dengan rebana, pemahaman muncul bahwa NDArray yang kita amati tidak pernah numpy, tetapi struktur internal MXNet, yang melakukan semua perhitungan dengan malas.  Bingo!  Apa yang harus dilakukan  Siapa saja pemula yang tahu bahwa itu semua tentang ukuran bets!  Jika MXNet menghitung skor dengan malas, maka jika kami pertama kali meminta mereka untuk beberapa lusin foto, dan kemudian kami mulai mengekstraksinya, maka mungkin pemrosesan foto akan dilakukan dalam batch?  Dan ya, setelah menambahkan batching pada kecepatan 10 foto per detik, saya berhasil menemukan semua kucing :). </p><br><p>  Kemudian kami menerapkan teknik terkenal dan dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">10 paragraf</a> kami mendapat skor 0,504 :). </p><br><h3>  Kesimpulan </h3><br><img src="https://habrastorage.org/webt/aq/yf/0n/aqyf0navjrowlvcgvn0k3a7hcne.jpeg"><br><p>  Ketika satu sensei yang bijak ditanya, "Siapa yang akan menang, master Aikido atau karate?", Dia menjawab "Tuan akan menang."  Kami dituntun ke kesimpulan yang kira-kira sama dengan percobaan ini: tidak ada dan tidak bisa menjadi bahasa yang ideal untuk semua kesempatan.  Dengan Python, Anda dapat dengan cepat mengumpulkan solusi dari blok yang sudah jadi, tetapi mencoba untuk menjauh dari mereka dengan jumlah data yang cukup besar akan membawa banyak rasa sakit.  Di Java dan Scala, Anda juga dapat menemukan banyak alat yang siap pakai dan dengan mudah mengimplementasikan ide-ide Anda sendiri, tetapi bahasa itu sendiri akan lebih menuntut kualitas kode. </p><br><p>  Dan tentu saja, semoga sukses untuk semua anggota <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">SNA Hackathon 2019</a> ! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id439394/">https://habr.com/ru/post/id439394/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id439382/index.html">Menggunakan Ansible, Terraform, Docker, Konsul, Nomad di awan (Alexey Vakhov, Uchi.ru)</a></li>
<li><a href="../id439384/index.html">Pemodelan Metropolis</a></li>
<li><a href="../id439388/index.html">Robot dalam Jurnalisme, atau Cara Menggunakan Kecerdasan Buatan untuk Membuat Konten</a></li>
<li><a href="../id439390/index.html">Inovasi terbaik jejaring sosial pada tahun 2018</a></li>
<li><a href="../id439392/index.html">Musim kejuaraan 2019 terbuka! SNA Hackathon Ala ML Boot Camp 8 dimulai</a></li>
<li><a href="../id439396/index.html">Setel Ulang Kata Sandi Pengontrol UniFi</a></li>
<li><a href="../id439402/index.html">JavaScript: The Big Whole Well Why</a></li>
<li><a href="../id439404/index.html">Sejarah singkat pengadaan publik elektronik di Rusia</a></li>
<li><a href="../id439408/index.html">Pseudo Lens Flare</a></li>
<li><a href="../id439410/index.html">Jeff Hawkins akhirnya siap menjelaskan penelitian otaknya</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>