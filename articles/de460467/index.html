<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏻‍⚕️ 🤘🏿 👨🏾‍⚕️ Wir suchen nach einer Panne im Auto durch das Geräusch: Wir fordern ein wenig maschinelles Lernen, um Anomalien im Motor zu finden 🧑 ↔️ 😘</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In der Schule hatte ich einen Klassenkameraden, der hören konnte, wie das Auto auf dem Hof ​​funktioniert, und mit ernstem Gesicht ein Urteil fällen k...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wir suchen nach einer Panne im Auto durch das Geräusch: Wir fordern ein wenig maschinelles Lernen, um Anomalien im Motor zu finden</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460467/"><p>  In der Schule hatte ich einen Klassenkameraden, der hören konnte, wie das Auto auf dem Hof ​​funktioniert, und mit ernstem Gesicht ein Urteil fällen konnte: Alles ist in Ordnung oder etwas ist kaputt, und ich muss dringend nach neuen Teilen / Öl / Werkzeugen suchen!  Ich, wie eine absolute Teekanne im Automobilgeschäft, hörte immer das übliche Rasseln des nächsten Dvenashka, bemerkte keine Unterschiede und staunte nur schweigend über sein Gehör und seine Fähigkeiten. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/te/rg/mw/tergmw8wjcwkvmcv5cuog4arfms.png"></div><br><p> Jetzt habe ich die Innenseiten des Autos nicht besser verstanden, aber ich habe angefangen, mit der Verarbeitung von Tonsignalen und maschinellem Lernen zu arbeiten. Hier werden wir versuchen zu verstehen, ob es möglich ist, einem Computer beizubringen, Anomalien im Geräusch eines Motors zu erkennen. </p><br><p>  Zumindest ist es nur interessant zu überprüfen, und in Zukunft könnte eine solche Technologie den Autobesitzern viel Geld sparen.  Zumindest meiner Meinung nach treten kritische Fehler allmählich unter der Haube auf, und in den frühen Stadien sind viele von ihnen schnell und kostengünstig zu hören, was Zeit, Geld und bereits wackelige Nerven spart. </p><br><p>  Nun, vielleicht ist es Zeit, von Worten zu Taten überzugehen.  Lass uns gehen! </p><a name="habracut"></a><br><p>  Ich möchte gleich sagen, dass ich in allem, was Mathematik und Algorithmen betrifft, mehr Wert auf Bedeutung und Verständnis legen werde. Hier wird es keine Formeln und mathematischen Berechnungen geben.  Ich habe hier keine neuen Algorithmen entwickelt. Wenn Sie möchten, ist es für Formeln besser, Google und Wikipedia zu verwenden und die Links zu verwenden, die ich im gesamten Artikel hinterlassen werde. </p><br><p>  Ich werde alle Erklärungen am Beispiel des Geräusches eines defekten Motors aus diesem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Video auf YouTube geben</a> . </p><br><p>  Die von YouTube heruntergeladene Datei (Sie können sie mit Browsererweiterungen oder einfach durch Ändern des YouTube-Links zu ssyoutube herunterladen) konvertieren wir mit ffmpeg in das WAV-Format: </p><br><pre><code class="plaintext hljs">ffmpeg -i input_video.mp4 -c:a pcm_s16le -ar 16000 -ac 1 engine_sound.wav</code> </pre> <br><p>  Bevor ich mit der Verarbeitung dieser Datei beginne, möchte ich einige Worte darüber sagen, was ein Spektrogramm ist und wie es uns bei der Lösung dieses Problems helfen wird.  Sicherlich haben viele von Ihnen ein ähnliches Bild gesehen - dies ist die amplitudenzeitliche Darstellung von Ton oder ein Oszillogramm. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jg/7i/he/jg7ihe-rdu0xfe64fncvtkkutp4.png"></div><br><p>  Wenn in einfachen Worten, dann ist Schall eine Welle, und die Amplitudenwerte dieser Welle werden zu bestimmten Zeiten auf dem Oszillogramm beobachtet. </p><br><p>  Um aus einer solchen Darstellung ein Spektrogramm zu erhalten, benötigen wir die Fourier-Transformation.  Mit seiner Hilfe können Sie die Amplituden-Frequenz-Darstellung des Klangs oder des Amplitudenspektrums erhalten.  Ein solches Spektrum zeigt, bei welcher Frequenz und mit welcher Amplitude das untersuchte Signal ausgedrückt wird. </p><br><p>  Tatsächlich ist ein Spektrogramm ein Satz von Spektren kurzer aufeinanderfolgender Teile eines Signals.  Vielleicht reicht eine solche "Definition" aus, um nicht stark von der Aufgabe abgelenkt zu werden.  Alles wird klarer, wenn Sie sich die Visualisierung des Spektrogramms ansehen (das Bild wurde mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">WaveAssistant aufgenommen</a> ).  Die Zeit ist auf der X-Achse aufgetragen, die Frequenz auf der Y-Achse, dh jede Spalte in dieser Matrix ist der Spektrummodul zu einem bestimmten Zeitpunkt. </p><br><p><img src="https://habrastorage.org/webt/bd/tn/9k/bdtn9kffs19iv8ikvnyn0cg9bb0.png" alt="Anfangsfragment des Signalspektrogramms"></p><br><p>  Dieses Spektrogramm zeigt, dass das Geräusch des Motors ohne Klopfen ungefähr gleich aussieht und bei Frequenzen in der Nähe von 600, 1200, 2400 und 4800 Hz ausgedrückt wird.  Das Geräusch eines Klopfens, das den Besitzer stört, ist im Frequenzbereich von 600 bis 1200 Hz von 5 bis 8 Sekunden sehr deutlich.  Da die Aufnahme unter ziemlich lauten Bedingungen auf der Straße gemacht wurde, sind diese Geräusche auch im Spektrogramm vorhanden, was unsere Aufgabe etwas erschwert. </p><br><p>  Wenn wir uns ein solches Spektrogramm ansehen, können wir dennoch sicher sagen, wo das Klopfen war und wo nicht.  Der Computer hat keine Augen, daher müssen wir einen Algorithmus auswählen, der in der Lage ist, zwischen einer solchen Abweichung (und vorzugsweise nicht nur dieser) zu unterscheiden, sofern in der Aufzeichnung Rauschen vorhanden ist. </p><br><p>  Spektrogramme können mit der librosa-Bibliothek wie folgt berechnet werden: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> librosa.util <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> buf_to_float <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> librosa.core <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> stft <span class="hljs-comment"><span class="hljs-comment">#     import numpy as np from scipy.io import wavfile #    wav- def cut_wav(path_to_wav, start_time, end_time): sr, wav_data = wavfile.read(path_to_wav) return wav_data[int(sr * start_time): int(sr * end_time)] def get_stft(wav_data): feat = np.abs(stft(buf_to_float(wav_data), n_fft=fft_size, hop_length=fft_step)) #  -       return feat.T wav_path = './engine_sound.wav' train_features = [] #    , time_list -    for [ts, te] in time_list: wav_part = cut_wav(wav_path, ts, te) spec = get_stft(wav_part) train_features.append(spec) X_train = np.vstack(train_features) #     full_wav_data = wavfile.read(wav_path)[1] X_test = get_stft(full_wav_data)</span></span></code> </pre> <br><h1 id="reshenie">  Lösung </h1><br><p>  Genau genommen müssen wir das Problem der binären Klassifizierung lösen, bei dem wir feststellen müssen, ob der Motor defekt ist oder normal funktioniert.  Mein Kollege und ich haben bereits in unserem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">vorherigen Artikel</a> ähnliche Aufgaben <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">beschrieben</a> , bei denen wir ein Faltungs-Neuronales Netzwerk zur Klassifizierung akustischer Ereignisse verwendet haben.  Eine solche Lösung ist hier kaum möglich: Neuronen lieben es sehr, wenn sie große Datenmengen erhalten.  Wir haben es mit einer einzelnen Einrückung zu tun, die etwas länger als eine Minute dauert und offensichtlich nicht als großer Datensatz bezeichnet werden kann. </p><br><p>  Die Auswahl wurde beim Gaußschen Mischungsmodell (Modell der Gaußschen Mischungen) gestoppt.  Ein guter Artikel, der das Funktionsprinzip und das Training dieses Modells beschreibt, ist hier zu finden <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">.</a> Die allgemeine Idee dieses Modells besteht darin, die Daten unter Verwendung einer komplexen Verteilung in Form einer linearen Kombination mehrerer mehrdimensionaler Normalverteilungen zu beschreiben (mehr über die mehrdimensionale Normalverteilung <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> ). </p><br><p>  Da der Motor während seines Betriebs ungefähr "gleich" klingt, kann das Geräusch seines Betriebs als stationär angesehen werden, und die Idee, dieses Geräusch unter Verwendung einer solchen Verteilung zu beschreiben, scheint ziemlich sinnvoll.  Um die Essenz von GMM zu verstehen, empfehle ich dringend, sich ein Beispiel für das Training anzusehen und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> die Anzahl der Gaussoiden zu wählen. </p><br><p>  Unser Fall unterscheidet sich von den obigen Beispielen darin, dass anstelle von Punkten auf einer zweidimensionalen Ebene die aus dem Signalspektrogramm entnommenen Spektrumswerte verwendet werden.  Sie können Verteilungsparameter wie den Typ der Kovarianzmatrix mithilfe des BIC-Kriteriums ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beispiel</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beschreibung</a> ) auswählen. In meinem Fall zeigten sich jedoch die optimalen Parameter aus Sicht dieses Kriteriums schlechter als die im folgenden Code gezeigten: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.mixture <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> GaussianMixture n_components = <span class="hljs-number"><span class="hljs-number">3</span></span> gmm_clf = GaussianMixture(n_components) gmm_clf.fit(X_train)</code> </pre> <br><p>  Unter der Annahme, dass das Geräusch des normalen Betriebs durch eine Verteilung beschrieben wird, deren Parameter während des Trainingsprozesses ausgewählt wurden, ist es möglich zu messen, wie nahe ein Geräusch an dieser Verteilung liegt. </p><br><p>  Dazu können Sie die durchschnittliche Wahrscheinlichkeit der Spalten des Spektrogramms des untersuchten Signals berechnen und dann einen Schwellenwert auswählen, der die Wahrscheinlichkeit von Geräuschen guter Arbeit von allen anderen trennt.  Die Glaubwürdigkeit für jede Sekunde ist wie folgt: </p><br><pre> <code class="python hljs">n_seconds = len(full_wav_data) // sr gmm_scores = [] <span class="hljs-comment"><span class="hljs-comment">#     for i in range(n_seconds - 1): test_sec = X_test[(i * sr) // fft_step: ((i + 1) * sr) // fft_step, :] sc = gmm_clf.score(test_sec) gmm_scores.append(sc)</span></span></code> </pre> <br><p>  Wenn Sie die erhaltene Wahrscheinlichkeit in der Tabelle anzeigen, erhalten wir das folgende Bild. <br>  Der obere Teil zeigt das Spektrogramm des Signals, das mit der Matplotlib-Bibliothek angezeigt wird.  Durch Klopfen verursachte Änderungen sind nicht so stark erkennbar wie im obigen Beispiel (weshalb Sie hier 2 Bilder gesehen haben).  Wenn Sie genau hinschauen, sind sie dennoch sichtbar.  Vertikale Linien markieren die Start- und Endzeiten des Klopfens. </p><br><p><img src="https://habrastorage.org/webt/yj/rw/gp/yjrwgpubihtsds-vxin8ilfbqp0.png"></p><br><h1 id="vyvody">  Schlussfolgerungen </h1><br><p>  Wie Sie der Grafik entnehmen können, ist die Wahrscheinlichkeit zum Zeitpunkt des Klopfens tatsächlich unter den Schwellenwert gefallen, was bedeutet, dass wir diese beiden Klassen (Arbeiten mit und ohne Klopfen) trennen können.  Aber ich muss sagen, dass dieser Wert nahe genug an der Schwelle und in Bereichen liegt, in denen das Klopfen nicht zu hören ist.  Dies liegt daran, dass in der Aufzeichnung häufig Fremdgeräusche auftreten, die sich auch auf die Wahrscheinlichkeit auswirken. </p><br><p>  Wir fügen hier Training in nur wenigen Sekunden Sound und schlechten Aufnahmebedingungen hinzu, und Sie können bereits überrascht sein, dass das Experiment irgendwie erfolgreich war! </p><br><p>  Um diese Methode in die Praxis umzusetzen und sich ihrer Zuverlässigkeit sicher zu sein, müssen Sie höchstwahrscheinlich viel mehr Ton aufnehmen und das Mikrofon gut platzieren, um das Rauschen beim Eintritt in die Aufnahmen zu minimieren. </p><br><p>  Dieser Artikel ist nur ein Versuch, ein ähnliches Problem zu lösen, ohne absolute Korrektheit zu beanspruchen. Wenn Sie Ideen und Vorschläge oder Fragen haben, lassen Sie uns diese gemeinsam in den Kommentaren oder persönlich diskutieren. </p><br><p>  Der vollständige Github-Code ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de460467/">https://habr.com/ru/post/de460467/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de460457/index.html">DIY Solarkraftwerk 200 m2</a></li>
<li><a href="../de460459/index.html">Konfigurationsdatei htaccess</a></li>
<li><a href="../de460461/index.html">Simulation gezielter Angriffe als Sicherheitsbewertung. Rote Teaming Cyber-Anweisungen</a></li>
<li><a href="../de460463/index.html">Was ist mit GALILEO - GNSS Programmer Version passiert?</a></li>
<li><a href="../de460465/index.html">Digitale Schatten - Reduzieren Sie kompetent digitale Risiken</a></li>
<li><a href="../de460469/index.html">Die Grundlagen des transparenten Proxys mit 3proxy und iptables / netfilter oder wie man "alles durch einen Proxy lässt"</a></li>
<li><a href="../de460471/index.html">Admin-Panel-Fehler oder Laravel Orchid-Entwicklungserfahrung</a></li>
<li><a href="../de460473/index.html">Weißes Rauschen zeichnet ein schwarzes Quadrat</a></li>
<li><a href="../de460475/index.html">Mobiler Rettungsring mit Fernbedienung</a></li>
<li><a href="../de460479/index.html">Und der Teddybär scheint schwer beladen zu sein</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>