<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèª‚Äç‚öïÔ∏è ü§òüèø üë®üèæ‚Äç‚öïÔ∏è Wir suchen nach einer Panne im Auto durch das Ger√§usch: Wir fordern ein wenig maschinelles Lernen, um Anomalien im Motor zu finden üßë ‚ÜîÔ∏è üòò</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In der Schule hatte ich einen Klassenkameraden, der h√∂ren konnte, wie das Auto auf dem Hof ‚Äã‚Äãfunktioniert, und mit ernstem Gesicht ein Urteil f√§llen k...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wir suchen nach einer Panne im Auto durch das Ger√§usch: Wir fordern ein wenig maschinelles Lernen, um Anomalien im Motor zu finden</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460467/"><p>  In der Schule hatte ich einen Klassenkameraden, der h√∂ren konnte, wie das Auto auf dem Hof ‚Äã‚Äãfunktioniert, und mit ernstem Gesicht ein Urteil f√§llen konnte: Alles ist in Ordnung oder etwas ist kaputt, und ich muss dringend nach neuen Teilen / √ñl / Werkzeugen suchen!  Ich, wie eine absolute Teekanne im Automobilgesch√§ft, h√∂rte immer das √ºbliche Rasseln des n√§chsten Dvenashka, bemerkte keine Unterschiede und staunte nur schweigend √ºber sein Geh√∂r und seine F√§higkeiten. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/te/rg/mw/tergmw8wjcwkvmcv5cuog4arfms.png"></div><br><p> Jetzt habe ich die Innenseiten des Autos nicht besser verstanden, aber ich habe angefangen, mit der Verarbeitung von Tonsignalen und maschinellem Lernen zu arbeiten. Hier werden wir versuchen zu verstehen, ob es m√∂glich ist, einem Computer beizubringen, Anomalien im Ger√§usch eines Motors zu erkennen. </p><br><p>  Zumindest ist es nur interessant zu √ºberpr√ºfen, und in Zukunft k√∂nnte eine solche Technologie den Autobesitzern viel Geld sparen.  Zumindest meiner Meinung nach treten kritische Fehler allm√§hlich unter der Haube auf, und in den fr√ºhen Stadien sind viele von ihnen schnell und kosteng√ºnstig zu h√∂ren, was Zeit, Geld und bereits wackelige Nerven spart. </p><br><p>  Nun, vielleicht ist es Zeit, von Worten zu Taten √ºberzugehen.  Lass uns gehen! </p><a name="habracut"></a><br><p>  Ich m√∂chte gleich sagen, dass ich in allem, was Mathematik und Algorithmen betrifft, mehr Wert auf Bedeutung und Verst√§ndnis legen werde. Hier wird es keine Formeln und mathematischen Berechnungen geben.  Ich habe hier keine neuen Algorithmen entwickelt. Wenn Sie m√∂chten, ist es f√ºr Formeln besser, Google und Wikipedia zu verwenden und die Links zu verwenden, die ich im gesamten Artikel hinterlassen werde. </p><br><p>  Ich werde alle Erkl√§rungen am Beispiel des Ger√§usches eines defekten Motors aus diesem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Video auf YouTube geben</a> . </p><br><p>  Die von YouTube heruntergeladene Datei (Sie k√∂nnen sie mit Browsererweiterungen oder einfach durch √Ñndern des YouTube-Links zu ssyoutube herunterladen) konvertieren wir mit ffmpeg in das WAV-Format: </p><br><pre><code class="plaintext hljs">ffmpeg -i input_video.mp4 -c:a pcm_s16le -ar 16000 -ac 1 engine_sound.wav</code> </pre> <br><p>  Bevor ich mit der Verarbeitung dieser Datei beginne, m√∂chte ich einige Worte dar√ºber sagen, was ein Spektrogramm ist und wie es uns bei der L√∂sung dieses Problems helfen wird.  Sicherlich haben viele von Ihnen ein √§hnliches Bild gesehen - dies ist die amplitudenzeitliche Darstellung von Ton oder ein Oszillogramm. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jg/7i/he/jg7ihe-rdu0xfe64fncvtkkutp4.png"></div><br><p>  Wenn in einfachen Worten, dann ist Schall eine Welle, und die Amplitudenwerte dieser Welle werden zu bestimmten Zeiten auf dem Oszillogramm beobachtet. </p><br><p>  Um aus einer solchen Darstellung ein Spektrogramm zu erhalten, ben√∂tigen wir die Fourier-Transformation.  Mit seiner Hilfe k√∂nnen Sie die Amplituden-Frequenz-Darstellung des Klangs oder des Amplitudenspektrums erhalten.  Ein solches Spektrum zeigt, bei welcher Frequenz und mit welcher Amplitude das untersuchte Signal ausgedr√ºckt wird. </p><br><p>  Tats√§chlich ist ein Spektrogramm ein Satz von Spektren kurzer aufeinanderfolgender Teile eines Signals.  Vielleicht reicht eine solche "Definition" aus, um nicht stark von der Aufgabe abgelenkt zu werden.  Alles wird klarer, wenn Sie sich die Visualisierung des Spektrogramms ansehen (das Bild wurde mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">WaveAssistant aufgenommen</a> ).  Die Zeit ist auf der X-Achse aufgetragen, die Frequenz auf der Y-Achse, dh jede Spalte in dieser Matrix ist der Spektrummodul zu einem bestimmten Zeitpunkt. </p><br><p><img src="https://habrastorage.org/webt/bd/tn/9k/bdtn9kffs19iv8ikvnyn0cg9bb0.png" alt="Anfangsfragment des Signalspektrogramms"></p><br><p>  Dieses Spektrogramm zeigt, dass das Ger√§usch des Motors ohne Klopfen ungef√§hr gleich aussieht und bei Frequenzen in der N√§he von 600, 1200, 2400 und 4800 Hz ausgedr√ºckt wird.  Das Ger√§usch eines Klopfens, das den Besitzer st√∂rt, ist im Frequenzbereich von 600 bis 1200 Hz von 5 bis 8 Sekunden sehr deutlich.  Da die Aufnahme unter ziemlich lauten Bedingungen auf der Stra√üe gemacht wurde, sind diese Ger√§usche auch im Spektrogramm vorhanden, was unsere Aufgabe etwas erschwert. </p><br><p>  Wenn wir uns ein solches Spektrogramm ansehen, k√∂nnen wir dennoch sicher sagen, wo das Klopfen war und wo nicht.  Der Computer hat keine Augen, daher m√ºssen wir einen Algorithmus ausw√§hlen, der in der Lage ist, zwischen einer solchen Abweichung (und vorzugsweise nicht nur dieser) zu unterscheiden, sofern in der Aufzeichnung Rauschen vorhanden ist. </p><br><p>  Spektrogramme k√∂nnen mit der librosa-Bibliothek wie folgt berechnet werden: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> librosa.util <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> buf_to_float <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> librosa.core <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> stft <span class="hljs-comment"><span class="hljs-comment">#     import numpy as np from scipy.io import wavfile #    wav- def cut_wav(path_to_wav, start_time, end_time): sr, wav_data = wavfile.read(path_to_wav) return wav_data[int(sr * start_time): int(sr * end_time)] def get_stft(wav_data): feat = np.abs(stft(buf_to_float(wav_data), n_fft=fft_size, hop_length=fft_step)) #  -       return feat.T wav_path = './engine_sound.wav' train_features = [] #    , time_list -    for [ts, te] in time_list: wav_part = cut_wav(wav_path, ts, te) spec = get_stft(wav_part) train_features.append(spec) X_train = np.vstack(train_features) #     full_wav_data = wavfile.read(wav_path)[1] X_test = get_stft(full_wav_data)</span></span></code> </pre> <br><h1 id="reshenie">  L√∂sung </h1><br><p>  Genau genommen m√ºssen wir das Problem der bin√§ren Klassifizierung l√∂sen, bei dem wir feststellen m√ºssen, ob der Motor defekt ist oder normal funktioniert.  Mein Kollege und ich haben bereits in unserem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">vorherigen Artikel</a> √§hnliche Aufgaben <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">beschrieben</a> , bei denen wir ein Faltungs-Neuronales Netzwerk zur Klassifizierung akustischer Ereignisse verwendet haben.  Eine solche L√∂sung ist hier kaum m√∂glich: Neuronen lieben es sehr, wenn sie gro√üe Datenmengen erhalten.  Wir haben es mit einer einzelnen Einr√ºckung zu tun, die etwas l√§nger als eine Minute dauert und offensichtlich nicht als gro√üer Datensatz bezeichnet werden kann. </p><br><p>  Die Auswahl wurde beim Gau√üschen Mischungsmodell (Modell der Gau√üschen Mischungen) gestoppt.  Ein guter Artikel, der das Funktionsprinzip und das Training dieses Modells beschreibt, ist hier zu finden <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">.</a> Die allgemeine Idee dieses Modells besteht darin, die Daten unter Verwendung einer komplexen Verteilung in Form einer linearen Kombination mehrerer mehrdimensionaler Normalverteilungen zu beschreiben (mehr √ºber die mehrdimensionale Normalverteilung <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> ). </p><br><p>  Da der Motor w√§hrend seines Betriebs ungef√§hr "gleich" klingt, kann das Ger√§usch seines Betriebs als station√§r angesehen werden, und die Idee, dieses Ger√§usch unter Verwendung einer solchen Verteilung zu beschreiben, scheint ziemlich sinnvoll.  Um die Essenz von GMM zu verstehen, empfehle ich dringend, sich ein Beispiel f√ºr das Training anzusehen und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> die Anzahl der Gaussoiden zu w√§hlen. </p><br><p>  Unser Fall unterscheidet sich von den obigen Beispielen darin, dass anstelle von Punkten auf einer zweidimensionalen Ebene die aus dem Signalspektrogramm entnommenen Spektrumswerte verwendet werden.  Sie k√∂nnen Verteilungsparameter wie den Typ der Kovarianzmatrix mithilfe des BIC-Kriteriums ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beispiel</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beschreibung</a> ) ausw√§hlen. In meinem Fall zeigten sich jedoch die optimalen Parameter aus Sicht dieses Kriteriums schlechter als die im folgenden Code gezeigten: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.mixture <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> GaussianMixture n_components = <span class="hljs-number"><span class="hljs-number">3</span></span> gmm_clf = GaussianMixture(n_components) gmm_clf.fit(X_train)</code> </pre> <br><p>  Unter der Annahme, dass das Ger√§usch des normalen Betriebs durch eine Verteilung beschrieben wird, deren Parameter w√§hrend des Trainingsprozesses ausgew√§hlt wurden, ist es m√∂glich zu messen, wie nahe ein Ger√§usch an dieser Verteilung liegt. </p><br><p>  Dazu k√∂nnen Sie die durchschnittliche Wahrscheinlichkeit der Spalten des Spektrogramms des untersuchten Signals berechnen und dann einen Schwellenwert ausw√§hlen, der die Wahrscheinlichkeit von Ger√§uschen guter Arbeit von allen anderen trennt.  Die Glaubw√ºrdigkeit f√ºr jede Sekunde ist wie folgt: </p><br><pre> <code class="python hljs">n_seconds = len(full_wav_data) // sr gmm_scores = [] <span class="hljs-comment"><span class="hljs-comment">#     for i in range(n_seconds - 1): test_sec = X_test[(i * sr) // fft_step: ((i + 1) * sr) // fft_step, :] sc = gmm_clf.score(test_sec) gmm_scores.append(sc)</span></span></code> </pre> <br><p>  Wenn Sie die erhaltene Wahrscheinlichkeit in der Tabelle anzeigen, erhalten wir das folgende Bild. <br>  Der obere Teil zeigt das Spektrogramm des Signals, das mit der Matplotlib-Bibliothek angezeigt wird.  Durch Klopfen verursachte √Ñnderungen sind nicht so stark erkennbar wie im obigen Beispiel (weshalb Sie hier 2 Bilder gesehen haben).  Wenn Sie genau hinschauen, sind sie dennoch sichtbar.  Vertikale Linien markieren die Start- und Endzeiten des Klopfens. </p><br><p><img src="https://habrastorage.org/webt/yj/rw/gp/yjrwgpubihtsds-vxin8ilfbqp0.png"></p><br><h1 id="vyvody">  Schlussfolgerungen </h1><br><p>  Wie Sie der Grafik entnehmen k√∂nnen, ist die Wahrscheinlichkeit zum Zeitpunkt des Klopfens tats√§chlich unter den Schwellenwert gefallen, was bedeutet, dass wir diese beiden Klassen (Arbeiten mit und ohne Klopfen) trennen k√∂nnen.  Aber ich muss sagen, dass dieser Wert nahe genug an der Schwelle und in Bereichen liegt, in denen das Klopfen nicht zu h√∂ren ist.  Dies liegt daran, dass in der Aufzeichnung h√§ufig Fremdger√§usche auftreten, die sich auch auf die Wahrscheinlichkeit auswirken. </p><br><p>  Wir f√ºgen hier Training in nur wenigen Sekunden Sound und schlechten Aufnahmebedingungen hinzu, und Sie k√∂nnen bereits √ºberrascht sein, dass das Experiment irgendwie erfolgreich war! </p><br><p>  Um diese Methode in die Praxis umzusetzen und sich ihrer Zuverl√§ssigkeit sicher zu sein, m√ºssen Sie h√∂chstwahrscheinlich viel mehr Ton aufnehmen und das Mikrofon gut platzieren, um das Rauschen beim Eintritt in die Aufnahmen zu minimieren. </p><br><p>  Dieser Artikel ist nur ein Versuch, ein √§hnliches Problem zu l√∂sen, ohne absolute Korrektheit zu beanspruchen. Wenn Sie Ideen und Vorschl√§ge oder Fragen haben, lassen Sie uns diese gemeinsam in den Kommentaren oder pers√∂nlich diskutieren. </p><br><p>  Der vollst√§ndige Github-Code ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de460467/">https://habr.com/ru/post/de460467/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de460457/index.html">DIY Solarkraftwerk 200 m2</a></li>
<li><a href="../de460459/index.html">Konfigurationsdatei htaccess</a></li>
<li><a href="../de460461/index.html">Simulation gezielter Angriffe als Sicherheitsbewertung. Rote Teaming Cyber-Anweisungen</a></li>
<li><a href="../de460463/index.html">Was ist mit GALILEO - GNSS Programmer Version passiert?</a></li>
<li><a href="../de460465/index.html">Digitale Schatten - Reduzieren Sie kompetent digitale Risiken</a></li>
<li><a href="../de460469/index.html">Die Grundlagen des transparenten Proxys mit 3proxy und iptables / netfilter oder wie man "alles durch einen Proxy l√§sst"</a></li>
<li><a href="../de460471/index.html">Admin-Panel-Fehler oder Laravel Orchid-Entwicklungserfahrung</a></li>
<li><a href="../de460473/index.html">Wei√ües Rauschen zeichnet ein schwarzes Quadrat</a></li>
<li><a href="../de460475/index.html">Mobiler Rettungsring mit Fernbedienung</a></li>
<li><a href="../de460479/index.html">Und der Teddyb√§r scheint schwer beladen zu sein</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>