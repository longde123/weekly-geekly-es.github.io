<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍍 👐 👨🏿‍✈️ 我们如何训练神经网络对螺丝进行分类 🗄️ 👩🏾‍🤝‍👩🏻 📴</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="神经网络可以识别照片中的猫，找到沙发，改善视频录制，从幼犬或简单的草图中绘制图片。 我们已经习惯了。 关于神经网络的新闻几乎每天都会出现，并且已经变得司空见惯。 Grid Dynamics公司设定的任务不是平常的，而是艰巨的-教导神经网络从一张照片中找到庞大的在线商店目录中的特定螺钉或螺栓。 这个任...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>我们如何训练神经网络对螺丝进行分类</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/455650/"> 神经网络可以识别照片中的猫，找到沙发，改善视频录制，从幼犬或简单的草图中绘制图片。 我们已经习惯了。 关于神经网络的新闻几乎每天都会出现，并且已经变得司空见惯。  Grid Dynamics公司设定的任务不是平常的，而是艰巨的-教导神经网络从一张照片中找到庞大的在线商店目录中的特定螺钉或螺栓。 这个任务比找到猫要困难得多。 <br><br><img src="https://habrastorage.org/webt/a7/vv/1w/a7vv1w1gjwm8knv6kvrtvmd30vc.jpeg"><br><br> 螺丝在线商店的问题有库存。 成千上万的模型。 每个螺钉都有其自身的描述和特性，因此没有希望使用过滤器。 怎么办 手动搜索还是在货架上的大型超市中搜索？ 在这两种情况下，都是浪费时间。 结果，服务对象会感到疲倦并锤打钉子。 为了帮助他，我们将使用神经网络。 如果她能找到封条或沙发，那就让她做些有用的事情-拿起螺丝和螺栓。 我们将在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Grid Dynamics</a>从事数据分析和机器学习的<strong>Maria Matskevichus</strong>的报告中告诉您如何教用户如何快速准确地选择神经网络的螺钉。 <br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">发生了什么的简短演示</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/XZWdNCJ-zvE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><br><h2> 买家问题 </h2><br> 想象一下-我们买了一张桌子，但是丢失了一个小螺丝，如果没有它，就无法组装桌子。 我们去了在线商店进行搜索，我们看到15,000个独特的职位，每个职位都是我们的动力。 <br><br> 我们去过滤器-大约有10个，每个都有5到100个属性。 选择帽子的类型和颜色：平顶帽子-扁平和黄色铜-黄铜。 我们收到了问题。 <br><br><img src="https://habrastorage.org/webt/r7/kl/zt/r7klztf19kbxdk7g6tl6jgmwsfm.jpeg"><br><br> 这是什么 我们不是在寻找这个。 解雇引渡负责人！ <br><br> 过了一会儿，我们仍然选择2个合适的固定螺丝。 <br><br><img src="https://habrastorage.org/webt/xn/ta/o1/xntao1sbhfrwxngdq2ktgjmfnga.jpeg"><br><br> 剩下的最简单的事情就是解密描述和特征。 每个制造商都以自己的方式描述螺钉。 描述特定模型的参数没有特定要求。 <br><br> 一切都会给客户带来困难。 浪费时间，紧张和技术支持的劳力，这可以帮助客户找到所需的模型。 在意识到买家的这些问题之后，我们的客户-一家大型美国公司-决定为客户提供通过照片进行快速，准确和简单的搜索，而不是进行缓慢且并不总是成功的语义搜索。 <br><br><img src="https://habrastorage.org/webt/vv/j6/ka/vvj6kac8ogeii9gknobzy_lp_z8.jpeg"><br><br><h2> 实施困难 </h2><br> 我们承担了任务，并意识到存在几个问题。 <br><br>  <strong>螺丝看起来很像。</strong> 看图片。 <br><br><img src="https://habrastorage.org/webt/yh/tt/vy/yhttvysy1-fpbxmdtc2nnxpiyhu.jpeg"><br><br> 这些是不同的螺丝。 如果翻转照片，您会发现重要特征不同-头。 <br><br><img src="https://habrastorage.org/webt/p1/jx/kl/p1jxkll1hxawlcfkxjlmwp6tc5c.jpeg"><br><br> 在这张照片中？ <br><br><img src="https://habrastorage.org/webt/6q/aj/tv/6qajtvlljafp_cq_wap9y49abmo.jpeg"><br><br> 这里的模型是相同的。 照明有所不同，但是在两张照片中都有一个螺丝模型。 <br><br>  <strong>有稀有物种需要分类。</strong> 例如，带有“耳朵”或戒指。 <br><br><img src="https://habrastorage.org/webt/y5/xu/t8/y5xut8u9qqvn_yuglz2jnryrnre.jpeg"><br><br>  <strong>使用该应用程序的最低要求。</strong> 用户可以上传具有任何背景，外来物体，阴影，光线不足的照片，应用程序必须给出结果。 在白色背景上的螺钉或螺栓很少见。 <br><br><img src="https://habrastorage.org/webt/ni/tk/46/nitk46f2hdufffnl0iseynuyd8m.jpeg"><br><br>  <strong>该应用程序应实时工作。</strong> 用户正在这里和现在等待结果。 <br><br>  <strong>竞争对手。</strong> 最近，我们的客户竞争对手亚马逊推出了其<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">零件查找器</a> 。 这是一个从照片中搜索螺钉和螺栓的应用程序。 <br><br><img src="https://habrastorage.org/webt/pc/-s/ls/pc-slse0i24woqx1kstagelupx8.jpeg"><br><br> 除了Amazona，我们还有两个初创竞争对手，他们为客户提供自己的解决方案。 我们不仅要击败亚马逊，还要击败初创公司，这并不难。 一位竞争者提出了采用20个最流行的螺栓并对它们进行训练的<strong>目标检测</strong>的想法。 但是，当神经网络从客户现场提供100、1000或全部15000颗螺钉会发生什么，物体检测将如何工作以及在何处获取大量数据的问题时，竞争对手没有找到答案。 <br><br><h2> 解决方案 </h2><br>  <strong>它应该是可扩展的，</strong>并且不取决于螺钉的种类和目录的大小。 为了解决该问题，我们决定将螺钉视为一组特征或属性。 每个属性是一组属性。 <br><br><img src="https://habrastorage.org/webt/xy/g8/_a/xyg8_ao4gsrat9z-h1rx2jonc9c.jpeg"><br><br> 选择了以下特征： <br><br><ul><li> 帽子-头（32个属性）; </li><li> 外部涂层-表面处理（15个属性）； </li><li> 点-提示（12个属性）； </li><li> 线程覆盖率-线程覆盖率（4个属性）。 </li></ul><br> 我们检查了所有标志的图，并意识到要描述15,000种不同的螺钉，它们只需要50个。它们将组成具有不同属性的不同标志的组合。 需要50颗螺钉和一枚硬币来测量照片中螺钉的比例。 <br><br> 于是他们决定了。 我们决定了这个主意。 需要更多数据。 <br><br><h2> 资料 </h2><br> 我们从客户那里收到数据，有些不高兴。 目录数据-对象的照片在一个空白背景的。 <br><br><img src="https://habrastorage.org/webt/wi/j1/6i/wij16itobierywpgzvfe73nc2cw.jpeg"><br><br> 但是它们与应用程序要处理的数据不太对应。 用户将要使用任何背景，会用手掌拍照或用手指按住螺栓。 在其上训练网络的数据将与真实图像不一致。 <br><br> 然后我们决定听从<strong>理查德·索克</strong> （ <strong>Richard Soker）</strong>的建议。 <br><br><blockquote> 与其花一个月没有老师的学习方法，不如花一个星期，标记数据并训练分类器。 </blockquote><br> 因此，我们做到了-在打印机上打印了许多彩色背景，购买了这50个螺栓，并在背景上拍摄了训练数据。 因此，我们获得了桌子和地毯表面的所有可能选择。 <br><br><img src="https://habrastorage.org/webt/my/rx/fa/myrxfayjmxipzesfqvfqzbukmhy.jpeg"><br><br> 收集数据后，下一步就是了解螺栓在图片中的位置（如果有的话）。 <br><br><h2> 本地化 </h2><br> 我们研究了两种本地化方法： <strong>对象检测</strong>和<strong>语义分割</strong> 。 <br><br><img src="https://habrastorage.org/webt/xe/yo/zv/xeyozvhmupnhillkiqp_pg9k-ta.jpeg"><br><br>  <strong>对象检测</strong>返回对象周围最小区域的框。  <strong>语义分割</strong>返回掩码。 在我们的情况下，面罩更合适。 它保留了其形状，消除了背景，过多的阴影，并且使您可以比对象检测更好地对螺钉进行分类。 <br><br><img src="https://habrastorage.org/webt/re/zj/jg/rezjjg8pjjemrbtkmicc9u2n1r4.jpeg"><br><br> 语义分割的任务是为每个像素返回其属于一个类的概率。 要训​​练这样的模型，需要标记的数据。 我们使用了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“ labelme”</a>应用程序，通过该应用程序标记了样本。 我们用一枚硬币和一颗螺丝钉得到了大约一千个口罩。 <br><br><img src="https://habrastorage.org/webt/zm/oz/k4/zmozk4jv2bkrzfnema6gb_rizsk.jpeg"><br><br><h3> 型号 </h3><br> 我们选择了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">U-Net</a> 。  Kaggle非常喜欢这个网络，我们现在也是如此。 <br><br><img src="https://habrastorage.org/webt/ct/_b/mu/ct_bmu46ku4wjcpxqahqrn7j9em.jpeg"><br><br>  U-Net是编码器-解码器的成功实现。 <br><br><ul><li>  <strong>构造路径或编码器</strong> 。 这是U-Net的一部分，U-Net试图表示整个数据集，在更压缩的空间中以矢量表示形式出现。 她学习了这些迹象并发现了最重要的迹象。 </li><li>  <strong>扩展路径或解码器</strong> 。 尝试解码特征图并了解对象在图片中的位置。 </li></ul><br> 我们决定了模型。 现在我们选择损失函数，我们将在学习过程中将其值最小化。 <br><br><h3> 损失函数 </h3><br> 细分的经典选项是<strong>Dice系数</strong> ： <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mi>G</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>P</mi><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>G</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>+</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>G</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="39.321ex" height="2.66ex" viewBox="0 -832 16930 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455650/&amp;usg=ALkJrhgHFHtOR-s2a5PiGocHLTQj6IrX7A#MJMATHI-44" x="0" y="0"></use><g transform="translate(828,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455650/&amp;usg=ALkJrhgHFHtOR-s2a5PiGocHLTQj6IrX7A#MJMATHI-50" x="1658" y="0"></use><g transform="translate(2409,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455650/&amp;usg=ALkJrhgHFHtOR-s2a5PiGocHLTQj6IrX7A#MJMATHI-47" x="3239" y="0"></use><g transform="translate(4026,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455650/&amp;usg=ALkJrhgHFHtOR-s2a5PiGocHLTQj6IrX7A#MJMAIN-3D" x="5134" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455650/&amp;usg=ALkJrhgHFHtOR-s2a5PiGocHLTQj6IrX7A#MJMATHI-66" x="6440" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455650/&amp;usg=ALkJrhgHFHtOR-s2a5PiGocHLTQj6IrX7A#MJMATHI-72" x="6991" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455650/&amp;usg=ALkJrhgHFHtOR-s2a5PiGocHLTQj6IrX7A#MJMATHI-61" x="7442" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455650/&amp;usg=ALkJrhgHFHtOR-s2a5PiGocHLTQj6IrX7A#MJMATHI-63" x="7972" y="0"></use><g transform="translate(8405,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455650/&amp;usg=ALkJrhgHFHtOR-s2a5PiGocHLTQj6IrX7A#MJMAIN-32" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455650/&amp;usg=ALkJrhgHFHtOR-s2a5PiGocHLTQj6IrX7A#MJMAIN-7C" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455650/&amp;usg=ALkJrhgHFHtOR-s2a5PiGocHLTQj6IrX7A#MJMATHI-50" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455650/&amp;usg=ALkJrhgHFHtOR-s2a5PiGocHLTQj6IrX7A#MJMATHI-63" x="1780" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455650/&amp;usg=ALkJrhgHFHtOR-s2a5PiGocHLTQj6IrX7A#MJMATHI-64" x="2214" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455650/&amp;usg=ALkJrhgHFHtOR-s2a5PiGocHLTQj6IrX7A#MJMATHI-6F" x="2737" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455650/&amp;usg=ALkJrhgHFHtOR-s2a5PiGocHLTQj6IrX7A#MJMATHI-74" x="3223" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455650/&amp;usg=ALkJrhgHFHtOR-s2a5PiGocHLTQj6IrX7A#MJMATHI-47" x="3584" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455650/&amp;usg=ALkJrhgHFHtOR-s2a5PiGocHLTQj6IrX7A#MJMAIN-7C" x="4371" y="0"></use></g><g transform="translate(13055,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455650/&amp;usg=ALkJrhgHFHtOR-s2a5PiGocHLTQj6IrX7A#MJMAIN-7C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455650/&amp;usg=ALkJrhgHFHtOR-s2a5PiGocHLTQj6IrX7A#MJMATHI-50" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455650/&amp;usg=ALkJrhgHFHtOR-s2a5PiGocHLTQj6IrX7A#MJMAIN-7C" x="1030" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455650/&amp;usg=ALkJrhgHFHtOR-s2a5PiGocHLTQj6IrX7A#MJMAIN-2B" x="1530" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455650/&amp;usg=ALkJrhgHFHtOR-s2a5PiGocHLTQj6IrX7A#MJMAIN-7C" x="2531" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455650/&amp;usg=ALkJrhgHFHtOR-s2a5PiGocHLTQj6IrX7A#MJMATHI-47" x="2809" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455650/&amp;usg=ALkJrhgHFHtOR-s2a5PiGocHLTQj6IrX7A#MJMAIN-7C" x="3596" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow><mo>=</mo><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>P</mi><mtext>&nbsp;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> D（P，G）= \ frac {2 | P \ cdot G |} {| P | + | G |} </script></p><br><br> 这是精度和查全率之间的谐波平均值。 谐波均值意味着我们平均地权衡了第一种误差和第二种误差。 我们的数据不平衡，这对我们而言并不十分合适。 <br><br><img src="https://habrastorage.org/webt/s4/tv/vo/s4tvvo5frbz97yeg95ghcmcgjqo.jpeg"><br><br> 总是有很多背景，而对象本身还不够。 因此，该模型将始终提供非常高的精度和非常低的查全率。 为了以不同方式权衡第一类和第二类错误，我们决定采用<strong>Tversky指数</strong> ： <br><br><p><math> </math> $$ display $$ S（P，G，α，β）= \ frac {| P \ cdot G |} {| P \ cdot G | +α| P / G | +β| G / P |} $$显示$$ </p><br><br>  Tversky索引具有两个系数α和β，分别权衡这两个误差。 如果取α=β= 0.5，则得到相同的骰子系数。 如果选择其他参数， <strong>则会</strong>得到<strong>Jaccard索引</strong> -对象相似度的度量之一。 对于α=β= 1-Tversky索引等于Jaccard索引。 <br><br> 您还可以获得Fβ得分。 对于α+β= 1，Tversky指数对应于Fβ得分。 <br><br> 为了选择α和β，我们进行了几次实验。 他们假设该<strong>模型将因第二种错误而受到更大的罚款</strong> 。 当模型将背景像素分类为对象像素时，还不错。 如果对象周围有小的背景框，则正常。 但是，当模型将螺钉像素分类为背景像素时，螺钉上会出现孔洞，这会变得不均匀，这会干扰我们的分类。 <br><br> 因此，我们决定增加参数β，使其更接近1，使参数α接近0。 <br><br><img src="https://habrastorage.org/webt/kq/cd/rw/kqcdrwc-hbnghdommkqtb_o9yxg.jpeg"><br><br> 图片显示，当β= 0.7和α= 0.3时，可获得最佳掩模。 我们决定停止此操作，并根据所有数据训练模型。 <br><br><h3> 培训课程 </h3><br> 学习策略非常棘手。 由于我们是在个人时间手动标记数据，因此我们决定使用U-Net的一项功能。 它在一个新通道上细分每个新类-添加一个新通道，并在其上定位了一个对象。 <br><br> 因此，在我们的培训中，没有一幅既包含硬币又包含螺栓的图片。 所有图片都包含一个类别：10％-硬币，90％-螺丝。 <br><br><img src="https://habrastorage.org/webt/x1/nu/85/x1nu85eenmhkjxjhloakvkixbgq.jpeg"><br><br> 这样就可以正确分配工作并节省硬币上的时间-这是一个，但是形式很简单。 我们很容易学会对其进行细分，这使我们可以将90％的工作转移到螺钉上。 它们具有不同的形状和颜色，因此了解如何对其进行细分非常重要。 <br><br> 我们的网络已经学会了对那些不在我们样本中的实例进行细分。 例如，不存在异常形状的螺栓，但是模型也很好地对其进行了细分。 她学会了概括螺钉和螺栓的符号，并将其用于新数据，这非常好。 <br><br><img src="https://habrastorage.org/webt/qj/tw/zf/qjtwzf-39r0_d1p6lmtkceh5slc.jpeg"><br><br><h2> 分类 </h2><br> 这是对象定位之后的下一阶段。 很少有人训练卷积神经网络来对对象进行分类；他们经常使用<strong>转移学习</strong> 。 让我们看一下卷积神经网络的体系结构，然后简要回顾一下转移学习是什么。 <br><br><img src="https://habrastorage.org/webt/x_/nj/mp/x_njmpkiczozha_bxuyxsdjjtso.jpeg"><br><br> 在早期阶段，网络学习识别边界和角度。 后来，它可以识别简单的形状：矩形，圆形，正方形。 越接近顶部，就越能识别其所训练的数据的特征。 在最顶部，模型可以识别类。 <br><br> 世界上大多数物体都由简单的形式组成并且具有共同的特征。 您可以加入经过大量数据培训的网络，并将这些属性用于我们的分类。 该网络将在较小的数据集上进行培训，而不会花费大量资源。 这就是我们所做的。 <br><br><img src="https://habrastorage.org/webt/az/au/rj/azaurjthm-u2bi6m1v_cudav72g.jpeg"><br><br> 一旦决定了转学的一般技术，就需要选择一个预先训练的模型。 <br><br><h3> 选型 </h3><br> 我们的应用程序实时工作。 该模型应该是轻便且可移动的-参数很少，但准确。 考虑到这两个因素，我们牺牲了一些准确性以支持亮度。 因此，我们选择的不是最准确的，而是轻巧的模型<strong>-Xception</strong> 。 <br><br><img src="https://habrastorage.org/webt/fh/79/k0/fh79k0s5gfidknkaqnekdmfb6ps.jpeg"><br><br> 在Xception中，代替了通常的卷积- <strong>卷积</strong> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">可分离卷积</a> 。 因此，Xception比其他网络（例如，使用VGG）轻。 <br><br><img src="https://habrastorage.org/webt/vm/uj/wt/vmujwtib1valz_zzxcspvvgudw4.jpeg"><br><br> 普通卷积同时进行通道间和维间卷积。 可分离卷积共享：首先是维间卷积<strong>-Depthwise</strong> ，然后是<strong>通道间</strong> 。 结果结合起来。 <br><br>  Xception执行可分离的卷积，虽然它产生的效果与普通的卷积相同，但参数较少。 <br><br><img src="https://habrastorage.org/webt/dr/4x/tv/dr4xtvgjidi4f42dlbkng81b2zg.jpeg"><br><br> 我们将公式中的值替换为用于计算参数的值，例如，用于16个过滤器。 对于普通卷积，您需要计算的参数是“可分离卷积”的7倍。 因此，Xception更准确，更少。 <br><br><img src="https://habrastorage.org/webt/4l/aq/u3/4laqu3wafqnk9iqbp3dexyy8zy0.jpeg"><br><br><h3> 培训课程 </h3><br> 首先，我们决定建立一些基准并在原始图片中训练模型。 我们有4个分类器，每个分类器负责一个特定的属性。 结果不令人满意。 <br><br><img src="https://habrastorage.org/webt/ae/ne/ak/aeneakp61lkwkildsz8kqgdr1ge.jpeg"><br><br> 然后他们在盒子上训练了模型，然后返回了物体检测结果。 线程覆盖率的准确性得到了很好的提高。 但是对于其他分类器，结果也不尽人意。 <br><br><img src="https://habrastorage.org/webt/zn/cm/xn/zncmxnp-ly_8o3id4pfil5cosqu.jpeg"><br><br> 然后他们决定只给分类器他们想要并且将要分类的那部分螺丝。 头只给帽子，提示-只带头。 为此，我们制作了蒙版，获得了一个轮廓，在该轮廓上圈出了最小面积的矩形，并计算了旋转角度。 <br><br><img src="https://habrastorage.org/webt/jl/lo/wq/jllowqowcwjrki7s1gth-pl_004.jpeg"><br><br> 目前，我们仍然不知道螺钉头和尖端在哪一侧。 为了找到答案，他们将盒子切成两半，看着正方形。 <br><br><img src="https://habrastorage.org/webt/h_/k1/cz/h_k1czvxjoiapjnjbth5ny7cit0.jpeg"><br><br> 包含头部的区域始终大于包含尖端的区域。 比较面积，我们确定螺丝的哪一部分，哪一部分。 它有效，但并非在所有情况下都适用。 <br><br><img src="https://habrastorage.org/webt/z4/va/ci/z4vaciqdgvun8erixvsvr9iea6o.jpeg"><br><br> 当螺钉的长度与盖的直径相当时，将获得一个正方形，而不是一个矩形。 转动它时，我们得到一张图片，如第3幅所示。该模型无法很好地对该选项进行分类。 <br><br> 然后，我们将所有长螺钉取下，计算它们的旋转角度，并建立<strong>旋转网</strong>浅层神经网络，该网络将螺钉取下并预测旋转角度。 <br><br><img src="https://habrastorage.org/webt/bu/m2/tn/bum2tncic229p7s1y0wldwrlkhk.jpeg"><br><br> 然后将此辅助模型用于较小的短螺钉和螺栓。 我们取得了很好的结果-一切正常，小螺丝也旋转。 在这一阶段，误差实际上减小到零。 我们获取了这些数据，对分类器进行了训练，发现对于每个分类器（除Finish之外），准确性都得到了显着提高。 太好了-我们将继续努力。 <br><br><img src="https://habrastorage.org/webt/sm/l3/en/sml3encb5d6y6jueenvwg9bpooa.jpeg"><br><br> 但是由于某种原因，Finish没有起飞。 我们研究了错误并看到了图片。 <br><br><img src="https://habrastorage.org/webt/jq/_e/k2/jq_ek25gfktmad7pggi96ia7di4.jpeg"><br><br> 在不同的照明条件和不同的相机设置下，同一对螺丝的颜色也不同。 这不仅会混淆模型，还会混淆人。 灰色可以变成粉红色，黄色可以变成橙色。 回想一下蓝金装-同样的故事。 螺钉的反射面会产生误导。 <br><br> 我们在互联网上研究了类似的案例，发现中国科学家试图通过颜色对汽车进行分类，并且<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">面临</a>着同样的汽车问题。 <br><br><img src="https://habrastorage.org/webt/2u/uc/43/2uuc433a4s3uwvt8zzy-ebswcxy.jpeg"><br><br> 作为解决方案，中国科学家创建了一个浅层网络。 它的功能是在两个分支中，它们最后串联在一起。 这种架构称为<strong>ColorNet</strong> 。 <br><br><img src="https://habrastorage.org/webt/aw/33/fc/aw33fcyy4nk8z-3lromrjc7ytyu.jpeg"><br><br> 我们为任务实施了解决方案，并且准确性提高了近2倍。 有了这样的结果和模型，您可以工作并从在线商店目录中的表中查找螺丝。 <br><br><img src="https://habrastorage.org/webt/cb/bn/yy/cbbnyyxrcjlsluvxnpf9sieuwl4.jpeg"><br><br> 我们只有4个针对4个属性的分类器，还有许多其他分类器。 因此，您需要创建某种过滤器，该过滤器将接收目录数据并以某种方式对其进行过滤。 <br><br><h2> 筛选 </h2><br> 每个分类器返回一个软标签和一个类。 我们获取了软标签和数据库的值，计算出一些<strong>分数</strong> -将每个功能的所有标签相乘。 <br><br><img src="https://habrastorage.org/webt/jq/fj/k9/jqfjk93kayaexrfjop70einshzc.jpeg"><br><br> 分数显示所有分类器对该功能组合最有可能出现的信心。 分数越高，目录中的螺丝和图片中的螺丝越可能相似。 <br><br><h2> 流水线 </h2><br> 原来是这样的应用程序。 <br><br><img src="https://habrastorage.org/webt/av/nq/a9/avnqa9l-l5lo9fxxtovxs68omru.jpeg"><br><br><ul><li>  <strong>输入</strong> ：从原始图片开始。 </li><li>  <strong>本地化</strong> ：确定螺栓或螺钉的位置以及硬币的位置。 </li><li>  <strong>转换和旋转</strong> 。 </li><li>  <strong>分类</strong> ：我们会仔细修剪所有东西，分类并确定尺寸。 </li><li>  <strong>过滤</strong> 。 </li><li>  <strong>退出</strong>到特定的SKU位置。 </li></ul><br><h2> 如何实施一个复杂的项目 </h2><br>  <strong>局部吃掉大象</strong> 。 将大问题分成几部分。 <br><br>  <strong>标记将反映现实的数据。</strong> 不要担心数据标记-这是最安全的方法，它将迅速确保最高的模型质量。 数据合成方法通常比使用真实数据产生更差的结果。 <br><br>  <strong>测试一下</strong> 。 在建立许多模型之前，我们先取一小部分数据，用手标记一下，然后测试每个假设的操作。 之后，他们才训练了U-Net，分类器和旋转。 <br><br>  <strong>不要重新发明轮子</strong> 。 通常，您面临的问题已经有了解决方案。 在Internet上浏览，阅读文章-一定要找到一些东西！ <br><br> 关于我们的Visual Search应用程序的故事不仅涉及螺钉的分类。 它是关于如何创建一个没有类似物的复杂项目的，但是即使有类似物，它们也不能满足我们为应用程序设置的要求。 <br><br> 有关Grid Dynamics项目以及数据科学团队面临的其他挑战的更多信息，请参见该公司的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">技术博客</a> 。 <br><br><blockquote> 带有这种偏差的报告-在真正的非标准项目中使用机器学习算法-我们只是在寻找<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">UseData Conf</a> 。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">这是</a>有关我们最感兴趣的领域的更多信息。 <br><br> 如果您知道如何恶作剧以使模型飞行，请<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">发送应用程序</a> 。 如果您知道融合并不能保证速度，并准备告诉您什么是更重要的注意事项，我们将在9月16日等待您。 </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN455650/">https://habr.com/ru/post/zh-CN455650/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN455640/index.html">马文·明斯基（Marvin Minsky）的“情感机器”：第4章。“我们如何认识意识”</a></li>
<li><a href="../zh-CN455642/index.html">Yandex.Cloud中的分布式消息队列服务的体系结构</a></li>
<li><a href="../zh-CN455644/index.html">我们在实践中使用数据</a></li>
<li><a href="../zh-CN455646/index.html">安全周24：Android智能手机上的工厂后门</a></li>
<li><a href="../zh-CN455648/index.html">生命周期ML</a></li>
<li><a href="../zh-CN455652/index.html">深度学习与常识：开发聊天机器人</a></li>
<li><a href="../zh-CN455658/index.html">传奇的Intel Core i7-2600K：在2019年测试Sandy Bridge（第3部分）</a></li>
<li><a href="../zh-CN455662/index.html">大型机械显示器，带凸轮机构作为解码器</a></li>
<li><a href="../zh-CN455666/index.html">在IT服务公司中建立对外销售</a></li>
<li><a href="../zh-CN455668/index.html">我们在没有HDL的FPGA下编写。 高级开发工具比较</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>