<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ”˜ ğŸ‘« ğŸ‡ Architekturmuster "Builder" im Universum von "Swift" und "iOS" / "macOS" ğŸ›« ğŸ‘¶ğŸ¿ ğŸ“¿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dieses Mal mÃ¶chte ich ein wenig Ã¼ber ein anderes generatives Designmuster aus dem Arsenal der Gang of Four sprechen - â€Builderâ€œ . Es stellte sich hera...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Architekturmuster "Builder" im Universum von "Swift" und "iOS" / "macOS"</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/457086/"><p>  Dieses Mal mÃ¶chte ich ein wenig Ã¼ber ein anderes generatives Designmuster aus dem Arsenal der Gang of Four sprechen - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">â€Builderâ€œ</a> .  Es stellte sich heraus, dass ich im Laufe meiner (wenn auch nicht zu umfangreichen) Erfahrung ziemlich oft sah, dass das Muster im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Java-</a> Code im Allgemeinen und in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Android-</a> Anwendungen im Besonderen verwendet wurde.  In <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">â€iOSâ€œ</a> -Projekten war <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">das</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Muster</a> fÃ¼r mich ziemlich selten, egal ob sie in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">â€Swiftâ€œ</a> oder <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">â€Objective-Câ€œ geschrieben wurden</a> .  Trotz all seiner Einfachheit kann es sich in geeigneten FÃ¤llen als recht praktisch und, wie man sagen kann, als mÃ¤chtig herausstellen. <a name="habracut"></a></p><br><p><img src="https://habrastorage.org/webt/yb/mn/d3/ybmnd3bovtbxkuii2d4iot2lxsu.jpeg" alt="Bild"></p><br><p>  Die Vorlage wird verwendet, um den komplexen Initialisierungsprozess zu ersetzen, indem das gewÃ¼nschte Objekt Schritt fÃ¼r Schritt erstellt wird, wobei die Finalisierungsmethode am Ende aufgerufen wird.  Die Schritte kÃ¶nnen optional sein und sollten keine strenge Aufrufsequenz haben. </p><br><p><img src="https://habrastorage.org/webt/m8/4m/ho/m84mhoyuodwqs34x4d2wqolx7dc.gif" alt="Bild"></p><br><h2 id="primer-iz-foundation">  Stiftungsbeispiel </h2><br><p> In FÃ¤llen, in denen die gewÃ¼nschte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">â€URLâ€œ</a> nicht festgelegt ist, sondern aus Komponenten besteht (z. B. der Hostadresse und dem relativen Pfad zur Ressource), haben Sie wahrscheinlich den praktischen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>URLComponents</code></a> Mechanismus aus der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Foundation-</a> Bibliothek verwendet. </p><br><p>  <code>URLComponents</code> ist grÃ¶ÃŸtenteils nur eine Klasse, die viele Variablen kombiniert, in denen die Werte verschiedener URL-Komponenten gespeichert sind, sowie die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>url</code></a> Eigenschaft, die die entsprechende URL fÃ¼r den aktuellen Komponentensatz zurÃ¼ckgibt.  Zum Beispiel: </p><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> urlComponents = <span class="hljs-type"><span class="hljs-type">URLComponents</span></span>() urlComponents.scheme = <span class="hljs-string"><span class="hljs-string">"https"</span></span> urlComponents.user = <span class="hljs-string"><span class="hljs-string">"admin"</span></span> urlComponents.password = <span class="hljs-string"><span class="hljs-string">"qwerty"</span></span> urlComponents.host = <span class="hljs-string"><span class="hljs-string">"somehost.com"</span></span> urlComponents.port = <span class="hljs-number"><span class="hljs-number">80</span></span> urlComponents.path = <span class="hljs-string"><span class="hljs-string">"/some/path"</span></span> urlComponents.queryItems = [<span class="hljs-type"><span class="hljs-type">URLQueryItem</span></span>(name: <span class="hljs-string"><span class="hljs-string">"page"</span></span>, value: <span class="hljs-string"><span class="hljs-string">"0"</span></span>)] <span class="hljs-number"><span class="hljs-number">_</span></span> = urlComponents.url <span class="hljs-comment"><span class="hljs-comment">// https://admin:qwerty@somehost.com:80/some/path?page=0</span></span></code> </pre> <br><p>  TatsÃ¤chlich ist der obige Anwendungsfall die Implementierung des Builder-Musters.  In diesem Fall fungiert <code>URLComponents</code> als Builder selbst. Das Zuweisen von Werten zu seinen verschiedenen Eigenschaften ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>scheme</code></a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>host</code></a> usw.) ist die schrittweise Initialisierung des zukÃ¼nftigen Objekts, und das Aufrufen der <code>url</code> Eigenschaft ist wie eine Finalisierungsmethode. </p><br><p>  <em>In den Kommentaren kam es zu heftigen KÃ¤mpfen um die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">"RFC"</a> -Dokumente, die die "URL" und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">"URI"</a> beschreiben. Um genauer zu sein, schlage ich beispielsweise vor anzunehmen, dass wir nur Ã¼ber die "URL" von Remote-Ressourcen sprechen und diese nicht berÃ¼cksichtigen "URL" -Schemata, wie beispielsweise "Datei".</em> </p><br><p>  Alles scheint in Ordnung zu sein, wenn Sie diesen Code selten verwenden und alle Feinheiten kennen.  Aber was ist, wenn Sie etwas vergessen?  Zum Beispiel etwas Wichtiges wie eine Hostadresse?  Was wird Ihrer Meinung nach das Ergebnis der AusfÃ¼hrung des folgenden Codes sein? </p><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> urlComponents = <span class="hljs-type"><span class="hljs-type">URLComponents</span></span>() urlComponents.scheme = <span class="hljs-string"><span class="hljs-string">"https"</span></span> urlComponents.path = <span class="hljs-string"><span class="hljs-string">"/some/path"</span></span> <span class="hljs-number"><span class="hljs-number">_</span></span> = urlComponents.url</code> </pre> <br><p>  Wir arbeiten mit Eigenschaften, nicht mit Methoden, und es werden mit Sicherheit keine Fehler "rausgeworfen".  Die <code>url</code> Eigenschaft "finalizing" gibt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einen optionalen</a> Wert zurÃ¼ck. Vielleicht erhalten wir also <code>nil</code> ?  Nein, wir erhalten ein vollwertiges Objekt vom Typ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>URL</code></a> mit einem bedeutungslosen Wert - "https: / some / path".  Daher kam mir der Gedanke, das Schreiben meines eigenen "Builders" basierend auf der oben beschriebenen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">"API"</a> zu Ã¼ben. </p><br><h2 id="zdes-dolzhen-byl-byt-emodzi-velosiped-no-habr-ego-ne-otobrazhaet">  (Es hÃ¤tte ein "Emoji" "Fahrrad" geben sollen, aber "Habr" zeigt es nicht an) </h2><br><p>  Trotzdem halte ich <code>URLComponents</code> gute und bequeme â€APIâ€œ zum Zusammenstellen von â€URLsâ€œ aus Komponenten und im Gegenteil zum â€Parsenâ€œ der Komponenten der bekannten â€URLsâ€œ.  Darauf basierend schreiben wir jetzt unseren eigenen Typ, der die "URL" aus den Teilen sammelt und die "API" besitzt (angenommen), die wir im Moment benÃ¶tigen. </p><br><p>  Erstens mÃ¶chte ich die unterschiedliche Initialisierung beseitigen, indem ich allen erforderlichen Eigenschaften neue Werte zuweise.  Stattdessen implementieren wir die MÃ¶glichkeit, eine Instanz des Builders zu erstellen und allen Eigenschaften Werte zuzuweisen, indem wir von der Kette aufgerufene Methoden verwenden.  Die Kette endet mit einer Finalisierungsmethode, deren Ergebnis die entsprechende Instanz der <code>URL</code> .  Vielleicht sind Sie auf Ihrer Lebensreise auf so etwas wie " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>StringBuilder</code></a> in Java" gestoÃŸen - wir werden uns jetzt um eine solche "API" bemÃ¼hen. </p><br><p>  Um Methodenschritte entlang der Kette aufrufen zu kÃ¶nnen, muss jeder von ihnen eine Instanz des aktuellen Builders zurÃ¼ckgeben, in der die entsprechende Ã„nderung gespeichert wird.  Aus diesem Grund und auch um das mehrfache Kopieren von Objekten und das Tanzen um <code>mutating</code> Methoden, insbesondere ohne nachzudenken, loszuwerden, werden wir unseren Builder zu einer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Klasse</a> erklÃ¤ren: </p><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">URLBuilder</span></span></span><span class="hljs-class"> </span></span>{ }</code> </pre> <br><p>  Wir deklarieren Methoden, die die Parameter der zukÃ¼nftigen "URL" angeben, unter BerÃ¼cksichtigung der oben genannten Anforderungen: </p><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">URLBuilder</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> scheme = <span class="hljs-string"><span class="hljs-string">"https"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> user: <span class="hljs-type"><span class="hljs-type">String?</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> password: <span class="hljs-type"><span class="hljs-type">String?</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> host: <span class="hljs-type"><span class="hljs-type">String?</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> port: <span class="hljs-type"><span class="hljs-type">Int?</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> path = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> queryItems: [<span class="hljs-type"><span class="hljs-type">String</span></span> : <span class="hljs-type"><span class="hljs-type">String</span></span>]? <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">with</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(scheme: String)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">URLBuilder</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.scheme = scheme <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">with</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(user: String)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">URLBuilder</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.user = user <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">with</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(password: String)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">URLBuilder</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.password = password <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">with</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(host: String)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">URLBuilder</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.host = host <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">with</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(port: Int)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">URLBuilder</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.port = port <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">with</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(path: String)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">URLBuilder</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.path = path <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">with</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(queryItems: [String : String])</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">URLBuilder</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.queryItems = queryItems <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> } }</code> </pre> <br><p>  Wir speichern die angegebenen Parameter in den privaten Eigenschaften der Klasse fÃ¼r die zukÃ¼nftige Verwendung durch die Finalisierungsmethode. </p><br><p>  Eine weitere Hommage an die â€APIâ€œ, auf der unsere Klasse basiert, ist die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>path</code></a> Eigenschaft, die im Gegensatz zu allen benachbarten Eigenschaften nicht optional ist. Wenn kein relativer Pfad vorhanden ist, wird eine leere Zeichenfolge als Wert gespeichert. </p><br><p>  Um diese endgÃ¼ltige Methode zu schreiben, mÃ¼ssen Sie Ã¼ber ein paar weitere Dinge nachdenken.  Erstens hat die â€URLâ€œ einige Teile, ohne die sie, wie eingangs angegeben, keinen Sinn mehr ergibt - dies ist <code>scheme</code> und <code>host</code> .  Wir haben den ersten mit dem Standardwert â€ausgezeichnetâ€œ. Wenn wir ihn vergessen haben, erhalten wir hÃ¶chstwahrscheinlich immer noch das erwartete Ergebnis. </p><br><p>  Mit dem zweiten sind die Dinge etwas komplizierter: Es kann kein Standardwert zugewiesen werden.  In diesem Fall gibt es zwei MÃ¶glichkeiten: Wenn fÃ¼r diese Eigenschaft kein Wert vorhanden ist, geben Sie entweder <code>nil</code> oder geben Sie einen Fehler aus, und lassen Sie den Clientcode selbst entscheiden, was damit geschehen soll.  Die zweite Option ist komplizierter, ermÃ¶glicht es Ihnen jedoch, einen bestimmten Programmiererfehler explizit anzugeben.  Vielleicht gehen wir zum Beispiel diesen Weg. </p><br><p>  Ein weiterer interessanter Punkt betrifft die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>user</code></a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>password</code></a> : Sie sind nur dann sinnvoll, wenn sie gleichzeitig verwendet werden.  Was aber, wenn ein Programmierer vergisst, einen dieser beiden Werte zuzuweisen? </p><br><p>  Und wahrscheinlich ist das Letzte, was zu berÃ¼cksichtigen ist, dass wir als Ergebnis der Finalisierungsmethode den Wert der <code>url</code> Eigenschaft von <code>URLComponents</code> haben <code>URLComponents</code> , und dies ist in diesem Fall nicht sehr nÃ¼tzlich, optional.  FÃ¼r jede Kombination von festgelegten Werten von <code>nil</code> Eigenschaften erhalten wir sie jedoch nicht.  (Nur eine leere, gerade erstellte Instanz von <code>URLComponents</code> hat keinen Wert.) Um dies zu Ã¼berwinden, kÃ¶nnen Sie verwenden <code>!</code>  - Bediener "erzwungenes Auspacken".  Aber im Allgemeinen mÃ¶chte ich seine Verwendung nicht fÃ¶rdern, daher abstrahieren wir in unserem Beispiel kurz vom Wissen Ã¼ber die Feinheiten von â€Foundationâ€œ und betrachten die diskutierte Situation als einen Systemfehler, dessen Auftreten nicht von unserem Code abhÃ¤ngt. </p><br><p>  Also: </p><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">URLBuilder</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">throws</span></span> -&gt; <span class="hljs-type"><span class="hljs-type">URL</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> host = host <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-type"><span class="hljs-type">URLBuilderError</span></span>.emptyHost } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> user != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> password != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-type"><span class="hljs-type">URLBuilderError</span></span>.inconsistentCredentials } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> password != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> user != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-type"><span class="hljs-type">URLBuilderError</span></span>.inconsistentCredentials } } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> urlComponents = <span class="hljs-type"><span class="hljs-type">URLComponents</span></span>() urlComponents.scheme = scheme urlComponents.user = user urlComponents.password = password urlComponents.host = host urlComponents.port = port urlComponents.path = path urlComponents.queryItems = queryItems?.<span class="hljs-built_in"><span class="hljs-built_in">map</span></span> { <span class="hljs-type"><span class="hljs-type">URLQueryItem</span></span>(name: $<span class="hljs-number"><span class="hljs-number">0</span></span>, value: $<span class="hljs-number"><span class="hljs-number">1</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> url = urlComponents.url <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-type"><span class="hljs-type">URLBuilderError</span></span>.systemError <span class="hljs-comment"><span class="hljs-comment">// Impossible? } return url } enum URLBuilderError: Error { case emptyHost case inconsistentCredentials case systemError } }</span></span></code> </pre> <br><p>  Das ist vielleicht alles!  Nun kÃ¶nnte eine explodierte Erstellung der â€URLâ€œ aus dem Beispiel am Anfang folgendermaÃŸen aussehen: </p><br><pre> <code class="swift hljs"><span class="hljs-number"><span class="hljs-number">_</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> <span class="hljs-type"><span class="hljs-type">URLBuilder</span></span>() .with(user: <span class="hljs-string"><span class="hljs-string">"admin"</span></span>) .with(password: <span class="hljs-string"><span class="hljs-string">"Qwerty"</span></span>) .with(host: <span class="hljs-string"><span class="hljs-string">"somehost.com"</span></span>) .with(port: <span class="hljs-number"><span class="hljs-number">80</span></span>) .with(path: <span class="hljs-string"><span class="hljs-string">"/some/path"</span></span>) .with(queryItems: [<span class="hljs-string"><span class="hljs-string">"page"</span></span>: <span class="hljs-string"><span class="hljs-string">"0"</span></span>]) .build() <span class="hljs-comment"><span class="hljs-comment">// https://admin:Qwerty@somehost.com:80/some/path?page=0</span></span></code> </pre> <br><p>  NatÃ¼rlich mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>try</code></a> auÃŸerhalb eines <code>do</code> <code>catch</code> oder ohne Operator <code>?</code>  Wenn ein Fehler auftritt, stÃ¼rzt das Programm ab.  Wir haben dem â€Kundenâ€œ jedoch die MÃ¶glichkeit gegeben, Fehler nach eigenem Ermessen zu behandeln. </p><br><p>  <em>Ja, und eine weitere nÃ¼tzliche Funktion der schrittweisen Erstellung mit dieser Vorlage ist die MÃ¶glichkeit, Schritte in verschiedenen Teilen des Codes zu platzieren.</em>  <em>Nicht der hÃ¤ufigste Fall, aber dennoch.</em>  <em>Danke <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">Akryukov</a> fÃ¼r die Erinnerung!</em> </p><br><h2 id="zaklyuchenie">  Fazit </h2><br><p>  Die Vorlage ist extrem einfach zu verstehen und alles Einfache ist, wie Sie wissen, genial.  Oder umgekehrt?  Nun, egal.  Die Hauptsache ist, dass ich ohne ein Zucken meiner Seele sagen kann, dass es (die Vorlage) mir bereits geholfen hat, Probleme bei der Erstellung groÃŸer und komplexer Initialisierungsprozesse zu lÃ¶sen.  Zum Beispiel der Prozess der Vorbereitung einer Kommunikationssitzung mit dem Server in der Bibliothek, den ich vor fast zwei Jahren fÃ¼r einen Dienst geschrieben habe.  Der Code ist Ã¼brigens <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">"Open Source"</a> und auf Wunsch ist es durchaus mÃ¶glich, sich damit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">vertraut</a> zu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">machen</a> .  (Obwohl seitdem natÃ¼rlich viel Wasser geflossen ist und andere Programmierer diesen Code angewendet haben.) </p><br><p>  <strong>Meine anderen BeitrÃ¤ge zu Designmustern:</strong> </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">"Factory Method" und "Abstract Factory" im Universum von "Swift" und "iOS"</a> , </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">â€Die Iterator-Architekturvorlage im schnellen Universum</a> , </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">â€Das Architekturmusterâ€ Besucher â€œim iOS- und Swift-Universum</a> . </li></ul><br><p>  <em>Und dies ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">mein â€Twitterâ€œ</a> , um ein hypothetisches Interesse an meiner Ã¶ffentlich-beruflichen TÃ¤tigkeit zu befriedigen.</em> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de457086/">https://habr.com/ru/post/de457086/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de457070/index.html">Textolite statt Pappe. Ein paar Worte zum interaktiven Abzeichen OFFZONE 2019</a></li>
<li><a href="../de457072/index.html">So lÃ¶sen Sie ein altes Problem mit ML in Python und .Net</a></li>
<li><a href="../de457074/index.html">Die Entwicklung der Entwickler: Welche Spiele sollten wir in Zukunft erwarten?</a></li>
<li><a href="../de457078/index.html">So verwandeln Sie Ihren Telegramm-Avatar in eine Uhr</a></li>
<li><a href="../de457082/index.html">Nicht wahrnehmbare GewÃ¤hrung von Administratorrechten</a></li>
<li><a href="../de457090/index.html">Sicherheitskrippen: JWT</a></li>
<li><a href="../de457092/index.html">Wir studieren MITRE ATT & CK. Mobile Matrizen: GerÃ¤tezugriff. Teil 5</a></li>
<li><a href="../de457094/index.html">Excel-Add-In, mit dem Filter bei der Arbeit mit Cubes (VBA) einfach festgelegt werden kÃ¶nnen</a></li>
<li><a href="../de457096/index.html">Wir geben mehreren Analysten die Hand: API Livy zur Automatisierung typischer Bankaufgaben</a></li>
<li><a href="../de457098/index.html">Elegante JavaScript-Fehlerbehandlung mit der Entweder-Monade</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>