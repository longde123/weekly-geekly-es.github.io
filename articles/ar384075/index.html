<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐คท๐ผ ๐ โ๏ธ ููุงุญุธุฉ ูุนุงูุฑุฉ ุฌูุงุฒ ุงุณุชุดุนุงุฑ ููุถุน ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ ๐ฐ ๐ป โฉ๏ธ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุชุชุทูุจ ุจุนุถ ูุณุชุดุนุฑุงุช ุงูุชุณุงุฑุน ูุนุงูุฑุฉ ุตูุฑ ุฅุถุงููุฉ ุจุนุฏ ุงูุชุฑููุจ ุนูู ุงูููุญุฉ. ุนูุฏูุง ุฑุฃูุช ุนุฏุฉ ูุตุงุฏุฑ ูุน ูุนุงูุฑุฉ ูุณุชุดุนุฑุงุช ุงูุชุณุงุฑุน ุ ุญูุซ ุชู ุฃุฎุฐ ุงููููู G ูู ุงูุงุนุชุจุงุฑ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ููุงุญุธุฉ ูุนุงูุฑุฉ ุฌูุงุฒ ุงุณุชุดุนุงุฑ ููุถุน ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/384075/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุชุทูุจ ุจุนุถ ูุณุชุดุนุฑุงุช ุงูุชุณุงุฑุน ูุนุงูุฑุฉ ุตูุฑ ุฅุถุงููุฉ ุจุนุฏ ุงูุชุฑููุจ ุนูู ุงูููุญุฉ. </font><font style="vertical-align: inherit;">ุนูุฏูุง ุฑุฃูุช ุนุฏุฉ ูุตุงุฏุฑ ูุน ูุนุงูุฑุฉ ูุณุชุดุนุฑุงุช ุงูุชุณุงุฑุน ุ ุญูุซ ุชู ุฃุฎุฐ ุงููููู G ูู ุงูุงุนุชุจุงุฑ ุจุจุณุงุทุฉ ุนู ุทุฑูู ุทุฑุญ ุงููููุฉ = 9.8 ู / ุซ 2 ูู ุงููุญูุฑ Z ุ ุธูุฑุช ุงูููุฑุฉ ููุชุงุจุฉ ูุฐู ุงููุฐูุฑุฉ.</font></font><br>
<br>
<img src="https://habrastorage.org/files/b4d/dcb/c3b/b4ddcbc3ba4d4e2dbd467eeab056db2d.jpg"><br>
<a name="habracut"></a><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู ุงููุดุฑ</font></font></h4><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุดููุฉ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจูุงู ุงููุดููุฉ ูุทุฑููุฉ ุงูุญู</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ุชุญุตู ุนูู ุงูููุงุทุ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ุชุญุณุจ ูุฑูุฒ ุงููุฑุฉุ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููููุฉ ุชุณุฑูุน ุงูุจุญุซ ุนู ูุฑูุฒ ุงููุฑุฉุ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ุชุณุฑูุน ุงูุจุญุซ ุนู ูุฑูุฒ ุงููุฑุฉุ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญูู ุฃุฎุทุงุก ุงูููุงุณ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฌููุน</font></font></li>
</ul><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุดููุฉ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุง ูู ุงููุดููุฉ - ุชุฎุถุน ุฃุฌูุฒุฉ ุงุณุชุดุนุงุฑ MEMS ุจุนุฏ ุงูุชุซุจูุช ูู ุงูููุญุฉ ูุชุดููุงุช ุทูููุฉ ุชุคุซุฑ ุนูู:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุถุน ุงูุตูุฑ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุญุฌูู ุงูููู ุงูููุงุณุฉ ุ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนููุฏูุฉ ุงููุญุงูุฑ ูุจุนุถูุง ุงูุจุนุถ.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฅุฐุง ุชู ุงูุชูุงู ุงูููุงุณ ูุงูุชุนุงูุฏ ุจุดูู ุบูุฑ ููุญูุธ ุ ูุฅู ููุถุน ุงูุตูุฑ ูุตุจุญ ูุชุดุงุจููุง ุจุดูู ููููุณ. ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ููุช ุจุชุฑุฌูุฉ ุงููููุฉ ุงููููุฐุฌูุฉ ููุฅุฒุงุญุฉ ุงูุตูุฑูุฉ ููููุงุณ ุงูุชุณุงุฑุน ููุณุชุดุนุฑ MPU9250 ุฅูู m / s </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ูุณูุชู ุงูุญุตูู ุนูู ุฐูู ูู ููุทูุฉ 0.2 m / s </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ุฃู ุฃู ุงููุณุชุดุนุฑ ุซุงุจุช ุ ููููู ููุธูุฑ ุงูุชุณุงุฑุน ุ ูุจุนุฏ 5 ุซูุงูู ูุญุตู ุนูู ุณุฑุนุฉ 1 ู / ุซ. ูู ูุงุญูุฉ ุ ูุชู ุชูุฑูุฑ ุฌููุน ุจูุงูุงุช ุงููุณุชุดุนุฑ ุฏุงุฆููุง ูู ุฎูุงู ููุน ูู ุงูููุชุฑ (ุนูู ุณุจูู ุงููุซุงู ุ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุซู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). ูููู ูู ูุงุญูุฉ ุฃุฎุฑู ุ ููุงุฐุง ูุฌุจ ุฃู ูุนูุถ ุงููุฑุดุญ ุจุงุณุชูุฑุงุฑ ุนู ูุฐุง ุงูุชุญูุฒุ ุจุนุฏ ูู ุดูุก ุ ุณูุธูุฑ ุงููุณุชุดุนุฑ ุญุฑูุฉ ุญูุซ ูุง. ูุฐุง ูููู ูู ุฏูุฉ ุงููุชูุฌุฉ. ุจุดูู ุนุงู ุ ุชุญุชุงุฌ ุฅูู ุงูุนุซูุฑ ุนูู ูููุฉ ุงูุฅุฒุงุญุฉ ูุฑุฉ ูุงุญุฏุฉ ุซู ุทุฑุญ ูุฐู ุงููููุฉ ูู ูุฑุงุกุงุชูุง ุฃุซูุงุก ุชุดุบูู ุงููุณุชุดุนุฑ.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅู ุฃุจุณุท ุญู ููุนุซูุฑ ุนูู ูููุฉ ุงูุฅุฒุงุญุฉ ุงูุตูุฑูุฉ ุ ุงูุชู ุชุชุจุงุฏุฑ ุฅูู ุงูุฐูู ุนูู ุงูููุฑ ุ ูู ุชููุฆุฉ ุงูุธุฑูู ุงูุชู ูุฌุจ ุฃู ูุธูุฑ ูููุง ุงููุณุชุดุนุฑ ุตูุฑูุง ุจุฏูุฉ. ุงููููุฉ ุงููุณุฌูุฉ ุนูู ุงููุณุชุดุนุฑ ูู ูููุฉ ุงูุฅุฒุงุญุฉ ุงูุตูุฑูุฉ! ูุจุงูุชุงููุ ููู ูุง - ุชุนูู ุงูุฌุงุฐุจูุฉ ุจุงุณุชูุฑุงุฑ ุนูู ูููุงุณ ุงูุชุณุงุฑุน. ูุชุฌูุจ ุฐูู ุ ุณุชููู ููุงู ุญุงุฌุฉ ุฅูู ุงูุนุฏุงู ุงููุฒู (ูู ููุฌุญ ุงููุฐู). ูุนูู ุงููุฌุงู ุงููุบูุงุทูุณู ููุฃุฑุถ ุนูู ุงูุจูุตูุฉ ูุฏูุฑุชูุง ุนูู ุงูุฌูุฑูุณููุจ. ูุฐูู ุฅุฐุง ูู ููู ูุฏูู ูุฑูุจุฉ ูุถุงุฆูุฉ ุดุฎุตูุฉ ุ ูุณูุชุนูู ุนููู ุงูุชูุตู ุฅูู ุดูุก ูุง.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุญู ุงูุซุงูู ุงูุฐู ูุชุจุงุฏุฑ ุฅูู ุงูุฐูู ุนูู ุงูููุฑ ูู ูุถุน ุงููุณุชุดุนุฑ (ุฃู ุจุงูุฃุญุฑู ูุญูุฑู) ูู ูุถุน ุณูุนุฑู ููู ุจุงูุถุจุท ูุง ูุฌุจ ุฃู ูุธูุฑู ุงููุณุชุดุนุฑ. ุงููุฑู ุจูู ูุง ูุธูุฑู ุงููุณุชุดุนุฑ ููุง ูุฌุจ ุฃู ูุธูุฑู - ููู ูููู ููุงู ุชุนููุถ ุตูุฑ! ูุจุงูุชุงููุ ุนูู ุณุจูู ุงููุซุงู ุ ูุนูู ุฃูู ุฅุฐุง ุชู ูุถุน ูููุงุณ ุงูุชุณุงุฑุน ูู ูุณุชูู ูุน ุงูุฃูู ุ ููู ุงููุงุญูุฉ ุงููุธุฑูุฉ ุ ุณูุชู ุชูุฌูู ูุงูู ุงูุชุณุงุฑุน ุงูุฌุงุฐุจู ุจุงูุถุจุท ุนูู ุทูู ุงููุญูุฑ Z ูููุณุชุดุนุฑ. ุญุฌู ูุงูู ุงูุชุณุงุฑุน ุงูุฐู ูุนุฑูู.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุน ุฐููุ ููุงู ูุดููุฉ. </font><font style="vertical-align: inherit;">ููู ูุชุฃูู ูู ุญูููุฉ ุฃูู ูุง ูููููุง ุถุจุท ูุญูุฑ ุงููุณุชุดุนุฑ ุจุฏูุฉ ุนูู ูุณุชูู ูุน ุงูุฃูู. </font><font style="vertical-align: inherit;">ูุงูุญูููุฉ ูู ุฃู ุงูุณุทุญ ุงูุฐู ุณูุนุชูุฏ ุนููู ููุณ ููุงุฒูุง ูููุญุฉ ุงูุฏูุงุฆุฑ ุงููุทุจูุนุฉ. </font><font style="vertical-align: inherit;">ููุฐุง ุจุฏูุฑู ูุง ูุชูุงุฒู ูุน ุงููููุน ุงูุฐู ููุฌุฏ ููู ุงููุณุชุดุนุฑ. </font><font style="vertical-align: inherit;">ูุง ููู ุงููุณุชุดุนุฑ ููุณู ุชูุงููุง ุนูู ูููุนู ููุง ุชููู ุงููุญุงูุฑ ุงูููุฌูุฏุฉ ุฏุงุฎู ุงููุณุชุดุนุฑ ููุงุฒูุฉ ูุฌุณู ุงููุณุชุดุนุฑ. </font><font style="vertical-align: inherit;">ูุนุทู ุงูุฎุทุฃ ูู ุชุนููู ุงููุญูุฑ ุจุงููุณุจุฉ ุฅูู ุงูุฃูู ุจููุฏุงุฑ ุฏุฑุฌุฉ ูุงุญุฏุฉ ุฅุณูุงุทูุง ูุดุงุจููุง ูู ุงูุญุฌู ููููุฉ ุงูุฅุฒุงุญุฉ ุงูุตูุฑูุฉ ููุณูุง ุ ูุงูุชู ูุฑูุฏ ุงูุนุซูุฑ ุนูููุง. </font><font style="vertical-align: inherit;">ูู ุญุงูุฉ ูููุงุณ ุงููุบูุทูุณูุฉ ุ ูุง ูุนุฑู ุฃูุถูุง ุฅูู ุฃูู ูุชู ุชูุฌูู ูุชุฌู ุงููุฌุงู ุงููุบูุงุทูุณู. </font><font style="vertical-align: inherit;">ูู ุงููุงุญูุฉ ุงููุธุฑูุฉ ุ ุฅูู ุงูุดูุงู. </font><font style="vertical-align: inherit;">ููู ูู ุงููุงูุน ุ ุงููุฌุงู ุงููุบูุงุทูุณู ููุฃุฑุถ ููุณู ุบูุฑ ูุชุฌุงูุณ ูู ุดุฏุชู ูุงุชุฌุงูู. </font><font style="vertical-align: inherit;">ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุชููู ุงูุฃุฌุณุงู ุงููุนุฏููุฉ ุงููุฑูุจุฉ ุจุฅุฌุฑุงุก ุชุนุฏููุงุชูุง.</font></font><br>
<img src="https://habrastorage.org/files/62a/4e5/7e2/62a4e57e29a24a389b1fddf12a652219.png"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจูุงู ุงููุดููุฉ ูุทุฑููุฉ ุงูุญู</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงููููุฉ ูู ููุง ููู: ูุญุชุงุฌ ุฅูู ุชุญุฏูุฏ ูุชุฌู ุงูุฅุฒุงุญุฉ ุงูุตูุฑู ุจุงุณุชุฎุฏุงู ุงููุณุชุดุนุฑ ุ ูุงูุฐู ุณูุณุฌู ุฏุงุฆููุง ูุชุฌู ุงูุฅุฒุงุญุฉ + ูุชุฌู ุงูุชุฃุซูุฑ ุงูุฎุงุฑุฌู ุงูุซุงุจุช (ุชุณุงุฑุน ุงูุฌุงุฐุจูุฉ ุ ุฏูุฑุงู ุงูุฃุฑุถ ุ ุงููุฌุงู ุงููุบูุงุทูุณู ููุฃุฑุถ) ุ ุญุฌู ูุงุชุฌุงู ูุง ูุนุฑูู (ูู ุญุงูุฉ ูููุงุณ ุงูุชุณุงุฑุน ูุญู ูุนุฑู ุงููููุฉ ุ ูููู ูุฑุฉ ุฃุฎุฑู ูุฏ ูุง ูููู ูููุงุณ ุงููุณุชุดุนุฑ ูุณุงูููุง ูู 1). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุทุฑููุฉ ุงูุญู. </font><font style="vertical-align: inherit;">ุชูุชุฑุญ ูุฐู ุงูููุงูุฉ ุชุญุฏูุฏ ูุงููุงุช ุงูุฅุฒุงุญุฉ ุนูู ุงููุญู ุงูุชุงูู. </font><font style="vertical-align: inherit;">ูุฃุฎุฐ ุงููุณุชุดุนุฑ ููุญููู ุจูู ุทุฑููุฉ ููููู ุจุชุณุฌูู ูุฑุงุกุงุช ุงููุณุชุดุนุฑ. </font><font style="vertical-align: inherit;">ุจุนุฏ ุงูููุงุณุงุช N ุ ุชููู ุงูููู ุงููุฃุฎูุฐุฉ ูู ุงููุณุชุดุนุฑ ูุงูููุฌูุฏุฉ ุนูู ุงูุฑุณู ุงูุจูุงูู ุนุจุงุฑุฉ ุนู ูุฑุฉ ุ ูุตู ูุทุฑูุง ูู ุญุฌู ุงูุชุฃุซูุฑ ุงูุฎุงุฑุฌู ุ ูุงููุฑูุฒ ูู ุงูุฅุฒุงุญุฉ ุงูุตูุฑูุฉ ุงููุทููุจุฉ ุจุงูุถุจุท.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ุชุญุตู ุนูู ุงูููุงุทุ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชุณููู ุฅุฌุฑุงุก ุงูููุงุณ ููุณู ุ ููููู ูุชุงุจุฉ ุจุฑูุงูุฌ ุจุณูุท. </font><font style="vertical-align: inherit;">ูุฌุจ ุชุณุฌูู ุฃุฌูุฒุฉ ุงูุงุณุชุดุนุงุฑ ุนูุฏูุง ูููู ุงูุฌูุงุฒ ุซุงุจุชูุง. </font><font style="vertical-align: inherit;">ูุญุชุงุฌ ููุท ุฅูู ุชุญููู ุงูุฌูุงุฒ ุฅูู ุงูููุถุน ุงููุทููุจ. </font><font style="vertical-align: inherit;">ูู ุฃุฌู ุชุญุฏูุฏ ุญุงูุฉ ุซุงุจุชุฉ ุ ูููู ูููุงุณ ุงูุชุณุงุฑุน ุบูุฑ ุงููุนุงูุฑ ููุงุณุจูุง ุฃูุถูุง - ููุท ุฎุฐ ุงููุฑู ุจูู ุงููููุฉ ุงูุญุงููุฉ ูุงููููุฉ ุงูุณุงุจูุฉ. </font><font style="vertical-align: inherit;">ูุฅุฐุง ูุงู ููุงู ุงููุฒูุฏ ูู ุงูุถูุถุงุก ุ ูุฅููุง ูููู ุจุฅุตูุงุญ ุงูุญุฑูุฉ. </font><font style="vertical-align: inherit;">ูุชู ุงูุญุตูู ุนูู ุนุชุจุชู ูู ููุทูุฉ 0.07G. </font><font style="vertical-align: inherit;">ุฅุฐุง ุฃูุณูุช ุจูุฏูู ุ ูุณุชุธูุฑ ุฃูุซุฑ ูู ูุฐู ุงููููุฉ. </font><font style="vertical-align: inherit;">ุงุณุชุนููุช ุดุฑูุท ูุงุตู ูุฅุตูุงุญ ุงููููู. </font><font style="vertical-align: inherit;">ุฅุฐุง ูุงูุช ูุง ุชุฒุงู ูุง ุชุนูู ุ ุชุญูู ููุนุฑูุฉ ูุง ุฅุฐุง ูุงูุช ููุงู ุซูุงุฌุฉ ุฃู ูุฑูุญุฉ ุฃู ุดูุก ูุดุงุจู ูุฑูุจ.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ูููู ุฃู ูููู ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-comment">//       </span>
<span class="hljs-keyword">static</span> TSumSensorsData 	g_sens_data[<span class="hljs-number">2</span>];
<span class="hljs-keyword">static</span> <span class="hljs-keyword">int32_t</span>   	g_sens_data_sum_cnt[<span class="hljs-number">2</span>];
<span class="hljs-keyword">static</span> <span class="hljs-keyword">uint8_t</span>		g_sens_data_num;<font></font>
<font></font>
<span class="hljs-comment">//  - ,     </span>
<span class="hljs-function">IS_INTERRUPT <span class="hljs-keyword">void</span> <span class="hljs-title">on_dma_raw_ready_calibrate_step1</span><span class="hljs-params">()</span>
</span>{<font></font>
	SensorRawBuffer *raw = sensor_get_raw_buffer();<font></font>
	g_sens_data[g_sens_data_num].acc_x += swap_i16(raw-&gt;accell_x_unswap);<font></font>
	g_sens_data[g_sens_data_num].acc_y += swap_i16(raw-&gt;accell_y_unswap);<font></font>
	g_sens_data[g_sens_data_num].acc_z += swap_i16(raw-&gt;accell_z_unswap);<font></font>
	g_sens_data[g_sens_data_num].gyro_x += swap_i16(raw-&gt;gyro_x_unswap);<font></font>
	g_sens_data[g_sens_data_num].gyro_y += swap_i16(raw-&gt;gyro_y_unswap);<font></font>
	g_sens_data[g_sens_data_num].gyro_z += swap_i16(raw-&gt;gyro_z_unswap);<font></font>
	g_sens_data[g_sens_data_num].mag_x += raw-&gt;mag_x_raw * g_mag_calibrate.kx;<font></font>
	g_sens_data[g_sens_data_num].mag_y += raw-&gt;mag_y_raw * g_mag_calibrate.ky;<font></font>
	g_sens_data[g_sens_data_num].mag_z += raw-&gt;mag_z_raw * g_mag_calibrate.kz;<font></font>
	g_sens_data_sum_cnt[g_sens_data_num]++;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//   main</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sensors_calibrate_program</span><span class="hljs-params">(FlashROM *flash_ptr)</span>
</span>{
	<span class="hljs-keyword">double</span> calibrate_result_error[<span class="hljs-number">3</span>];<font></font>
	TVector16 calibrate_result[<span class="hljs-number">3</span>];
	<span class="hljs-keyword">int32_t</span> radius[ACCEL_NO_MOTION_DETECT_COUNT];
	<span class="hljs-keyword">uint8_t</span> raw_is_deleted[ACCEL_NO_MOTION_DETECT_COUNT];<font></font>
	TVector16 raw[<span class="hljs-number">3</span>][ACCEL_NO_MOTION_DETECT_COUNT];<font></font>
	<font></font>
        . . .<font></font>
<font></font>
	<span class="hljs-comment">//  </span>
	g_sens_data_sum_cnt[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;<font></font>
	g_sens_data_num = <span class="hljs-number">0</span>;
	<span class="hljs-keyword">int16_t</span> prev_avg_x = <span class="hljs-number">0</span>;
	<span class="hljs-keyword">int16_t</span> prev_avg_y = <span class="hljs-number">0</span>;
	<span class="hljs-keyword">int16_t</span> prev_avg_z = <span class="hljs-number">0</span>;
	<span class="hljs-keyword">int8_t</span> low_motion_cnt = <span class="hljs-number">0</span>;<font></font>
<font></font>
	<span class="hljs-keyword">while</span>(low_motion_cnt &lt; ACCEL_NO_MOTION_DETECT_COUNT)<font></font>
	{<font></font>
		<span class="hljs-keyword">if</span> (g_sens_data_sum_cnt[g_sens_data_num] &gt;= ACCEL_NO_MOTION_DETECT_SAMPLES)<font></font>
		{<font></font>
			<span class="hljs-keyword">uint8_t</span> new_data_num = (g_sens_data_num + <span class="hljs-number">1</span>) &amp; <span class="hljs-number">1</span>;<font></font>
			g_sens_data[new_data_num].acc_x = <span class="hljs-number">0</span>;<font></font>
			g_sens_data[new_data_num].acc_y = <span class="hljs-number">0</span>;<font></font>
			g_sens_data[new_data_num].acc_z = <span class="hljs-number">0</span>;<font></font>
			g_sens_data[new_data_num].gyro_x = <span class="hljs-number">0</span>;<font></font>
			g_sens_data[new_data_num].gyro_y = <span class="hljs-number">0</span>;<font></font>
			g_sens_data[new_data_num].gyro_z = <span class="hljs-number">0</span>;<font></font>
			g_sens_data[new_data_num].mag_x = <span class="hljs-number">0</span>;<font></font>
			g_sens_data[new_data_num].mag_y = <span class="hljs-number">0</span>;<font></font>
			g_sens_data[new_data_num].mag_z = <span class="hljs-number">0</span>;<font></font>
			g_sens_data_sum_cnt[new_data_num] = <span class="hljs-number">0</span>;<font></font>
<font></font>
			<span class="hljs-keyword">uint8_t</span> old_data_num = g_sens_data_num;<font></font>
			g_sens_data_num = new_data_num; <span class="hljs-comment">//           </span>
			<span class="hljs-comment">// ( -    ,   )</span><font></font>
<font></font>
			<span class="hljs-comment">//     -  </span>
			<span class="hljs-keyword">int16_t</span> avg_x = g_sens_data[old_data_num].acc_x / g_sens_data_sum_cnt[old_data_num];
			<span class="hljs-keyword">int16_t</span> avg_y = g_sens_data[old_data_num].acc_y / g_sens_data_sum_cnt[old_data_num];
			<span class="hljs-keyword">int16_t</span> avg_z = g_sens_data[old_data_num].acc_z / g_sens_data_sum_cnt[old_data_num];<font></font>
<font></font>
			<span class="hljs-comment">//      </span>
			<span class="hljs-keyword">int16_t</span> dx = avg_x - prev_avg_x;
			<span class="hljs-keyword">int16_t</span> dy = avg_y - prev_avg_y;
			<span class="hljs-keyword">int16_t</span> dz = avg_z - prev_avg_z;<font></font>
			prev_avg_x = avg_x;<font></font>
			prev_avg_y = avg_y;<font></font>
			prev_avg_z = avg_z;<font></font>
<font></font>
			<span class="hljs-comment">//     </span>
			<span class="hljs-keyword">if</span> ((abs_i16(dx) &lt;= ACCEL_NO_MOTION_DETECT_AVG_VALUE)&amp;&amp;(abs_i16(dy) &lt;= ACCEL_NO_MOTION_DETECT_AVG_VALUE)&amp;&amp;(abs_i16(dz) &lt;= ACCEL_NO_MOTION_DETECT_AVG_VALUE))<font></font>
			{<font></font>
				<span class="hljs-comment">//    </span><font></font>
				raw[RAW_ACC][low_motion_cnt].x = avg_x;<font></font>
				raw[RAW_ACC][low_motion_cnt].y = avg_y;<font></font>
				raw[RAW_ACC][low_motion_cnt].z = avg_z;<font></font>
				raw[RAW_GYRO][low_motion_cnt].x = g_sens_data[old_data_num].gyro_x / g_sens_data_sum_cnt[old_data_num];<font></font>
				raw[RAW_GYRO][low_motion_cnt].y = g_sens_data[old_data_num].gyro_y / g_sens_data_sum_cnt[old_data_num];<font></font>
				raw[RAW_GYRO][low_motion_cnt].z = g_sens_data[old_data_num].gyro_z / g_sens_data_sum_cnt[old_data_num];<font></font>
				raw[RAW_MAG][low_motion_cnt].x = g_sens_data[old_data_num].mag_x / g_sens_data_sum_cnt[old_data_num];<font></font>
				raw[RAW_MAG][low_motion_cnt].y = g_sens_data[old_data_num].mag_y / g_sens_data_sum_cnt[old_data_num];<font></font>
				raw[RAW_MAG][low_motion_cnt].z = g_sens_data[old_data_num].mag_z / g_sens_data_sum_cnt[old_data_num];<font></font>
<font></font>
				low_motion_cnt++;<font></font>
<font></font>
				<span class="hljs-comment">//   </span><font></font>
				beep();<font></font>
<font></font>
				<span class="hljs-comment">//     2   ,     -   </span>
				<span class="hljs-comment">//  -  </span>
				<span class="hljs-comment">//      </span>
				delay_ms(<span class="hljs-number">2000</span>);<font></font>
			}<font></font>
		}<font></font>
	}<font></font>
. . .<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุญุตูู ุนูู ุงููุฑุฉ ุนูู ุงูุฑุณู ุงูุจูุงูู ุ ุชุญุชุงุฌ ุฅูู ูู ุงูุฌูุงุฒ ุจุงุณุชุฎุฏุงู ุงููุณุชุดุนุฑ ููููุง ููุฎุทุท ูุนูู. </font><font style="vertical-align: inherit;">ููุฐู ุงูุฃุบุฑุงุถ ุ ูุฅู ุงููุฑุฉ ุงูุฃุฑุถูุฉ ููุงุณุจุฉ ุชูุงููุง ุ ูุฃููุง ุชุญุชูู ุนูู ุชุฑููุฒ. </font><font style="vertical-align: inherit;">ูุฏ ุชุนุชูุฏ ุฃูู ุจุญุงุฌุฉ ุฅูู ุงููุญุช ูู ุฌููุน ุฃูุญุงุก ุงูุนุงูู. </font><font style="vertical-align: inherit;">ููู ุงูุฃูุฑ ููุณ ูุฐูู.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุซุงู ุนูู ูุชูุฌุฉ ุฎุงุทุฆุฉ</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/3b4/db9/bdf/3b4db9bdff434974b8616d24153755a1.png"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงูุถุฑูุฑู ูุญุช ุงููุฌุณ ููุณ ุนูู ุณุทุญ ุงููุฑุฉ ุงูุฃุฑุถูุฉ ุจุฃูููู ุ ูููู ุนูู ุฎุท ุงูุทูู. </font><font style="vertical-align: inherit;">ูููุชุฑุถ ุฃููุง ุฃุฎุฐูุง ุณุจุน ููุงุท ุนูู ุฎุท ุงูุทูู (ุงูุฃูู ูุงูุฃุฎูุฑ ูู ุงููุทุจูู ุงูุดูุงูู ูุงูุฌููุจู). </font><font style="vertical-align: inherit;">ูู ูู ููุทุฉ ูู ุฎุท ุงูุทูู ุ ูุนูู ุฌูุงุฒู ุนูู ุงููุฑุฉ ุงูุฃุฑุถูุฉ ููุง ุฒููุง ููู ุงูุฌูุงุฒ ุญูู ูุญูุฑู ุจุฎุทูุฉ ูุนููุฉ ุ ุนูู ุณุจูู ุงููุซุงู 30-35 ุฏุฑุฌุฉ. </font><font style="vertical-align: inherit;">ุงุชุถุญ ุฃูู ุฅุฐุง ููุช ุจุงูุชุฏููุฑ 12 ูุฑุฉ ุญูู ูุญูุฑู ุ ูุณูุชู ุงูุญุตูู ุนูู 7 ููุงุณุงุช ูู ุฅุฌูุงูู 84 ููุทุฉ. </font></font><br>
<br>
<img src="https://habrastorage.org/files/dfb/5df/1e5/dfb5df1e5107458e8560d939b6a5cd9a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฌูุงู ุงูุทุฑููุฉ ูู ุฃู ูู ุดูุก ูููู ุงูููุงู ุจู "ุนูู ุงูุฑูุจุฉ". </font><font style="vertical-align: inherit;">ูุง ุชูุนุจ ุฏูุฉ ุชุญุฏูุฏ ุงูููุงูุน ุฏูุฑูุง ุฎุงุตูุง ุ ูุง ุนููู ุณูู ุงูุชูุงุก ููููุง ูููุฎุทุท ุจุญูุซ ูุฑุณู ูุงูู ุงูุชุฃุซูุฑ ุงูุฎุงุฑุฌู ุนูู ุงูุฑุณู ุงูุจูุงูู ูุฑุฉ. </font><font style="vertical-align: inherit;">ูุจุฏู ุงูุตุญูุญ ูู ุดูุก ูู ูุฐุง ุงููุจูู - ุงูุธุฑ ุงูุดูู (ุชู ุชูููุฒ ุงููุฑูุฒ ุจุนูุงูุฉ).</font></font><br>
<br>
<img src="https://habrastorage.org/files/2d4/8e8/3a3/2d48e83a3c784bdb8736b86e4b3f6d87.gif"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ุชุญุณุจ ูุฑูุฒ ุงููุฑุฉุ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐู ูููุฉ ูุซูุฑุฉ ููุงูุชูุงู ูููุง ุงูุนุฏูุฏ ูู ุงูุญููู. ูุฏ ูุจุฏู ุฃูู ููุจุญุซ ุนู ุงููุฑูุฒ ุ ูููู ุฃุฎุฐ ุงููุชูุณุท โโุงูุญุณุงุจู ูุฅุญุฏุงุซูุงุช ุงูููุงุท ุงูุชู ุชู ุงูุญุตูู ุนูููุง. ููุน ุฐูู ุ ูุฅู ุงูุฃูุฑ ููุณ ูุฐูู - ูููู ูุถุน ุงูููุงุท ุจุดูู ุบูุฑ ูุชุณุงู ุนูู ุงููุฑุฉ (ุงูุธุฑ ุงูุดูู.). </font></font><br>
<br>
<img src="https://habrastorage.org/files/eda/0cd/9d2/eda0cd9d222e401ca3898d108182fbd8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุจุฏู ูุนุงุฏูุฉ ุงููุฑุฉ ููุง ููู: (X - A) </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + (Y - B) </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + (Z - C) </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = R </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ุญูุซ X ุ Y ุ Z ูู ุฅุญุฏุงุซูุงุช ุงูููุทุฉ ุงูุชู ุชูุน ุนูู ุงููุฑุฉ. A ู B ู C ูู ุฅุญุฏุงุซูุงุช ุงููุฑูุฒ ุนูู ูุญุงูุฑ x ู y ู z ุนูู ุงูุชูุงูู. R ูู ูุตู ูุทุฑ ุงููุฑุฉ. ููููู ุจูุงุก ูุธุงู ูุนุงุฏูุงุช ููุญุงููุฉ ุญู ูุฐุง ุงููุธุงู ุจุจุณุงุทุฉ ุจุงุณุชุฎุฏุงู ุจุนุถ ุงูุทุฑู. ุฃู ููููู ููุท ุงูุชูุซุงู ููุนุซูุฑ ุนูู ุงููุฑูุฒ (ููุฐุง ูุดุจู ุทุฑููุฉ ุงูุชูุฑูุจ ุงููุชุชุงูู). ูุนูู ุงูุทุฑููุฉ ุจุณูุท: ูููุฉ ุงูุฎุทุฃ (X - A) </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + (Y - B) </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ (Z - C) </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - R </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุฌุจ ุฃู ูููู ุฅูู ุงูุตูุฑ. ูุฐุง ูุนูู ุฃู ูุฌููุน ูุฐู ุงููููุงุช ูุฌููุน ููุงุท ุงููุฑุฉ ูุฌุจ ุฃู ูููู ุฃูุถูุง ุฅูู ุงูุตูุฑ. ุจูุนุฑูุฉ ุฐูู ุ ูููููุง ุงุฎุชูุงุฑ ุงูููู A ู B ู C ุงูุชู ูููู ุฎุทุฃ ุฌููุน ุงูููุงุท ูููุง ุถุฆูููุง. ููุทูุฉ ุงูุจุญุซ ูุญุฏูุฏุฉ ุจุญุฌู ุงููุฑุฉ (ุงูููุนุจ ุงูุดุฑุทู). ุฃู ุฃููุง ูุฌุจ ุฃู ูุถุน ูุฑูุฒ ุงููุฑุฉ ุจุงูุชุณูุณู ูู ุฌููุน ููุงุท ุงูููุนุจ ููุญุณุจ ุงูุฎุทุฃ. ุญูุซ ููุฌุฏ ุฎุทุฃ ุจุณูุท - ููุฌุฏ ุงููุฑูุฒ. </font></font><br>
<br>
<img src="https://habrastorage.org/files/d53/d46/4d5/d53d464d57c0411790594a6df5a45ca1.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุซู R ุ ูุญุชุงุฌ ุฅูู ุฃุฎุฐ ุงููููุฉ ุงููุธุฑูุฉ ููุงูู ุงูุชุฃุซูุฑ ุงูุฎุงุฑุฌู - ููููุงุณ ุงูุชุณุงุฑุน ุ ูุฐุง ูู ุชุณุงุฑุน ุงูุฌุงุฐุจูุฉ ุ ููุจูุตูุฉ - ูุฐุง ูู ูุชูุณุท โโุญุฌู ุงููุฌุงู ุงููุบูุงุทูุณู ููุฃุฑุถ ุ ููุฌูุฑูุณููุจ - ุณุฑุนุฉ ุฏูุฑุงู ุงูุฃุฑุถ. ุจุงูุทุจุน ุ ูู ุงูุตูุบุฉ ูุฌุจ ุฃู ุชููู ููุงู ููู ุจุนุฏ ูุงุญุฏ (ุงููุญุฏุงุช ุงูุชูููุฏูุฉ ูููุณุชุดุนุฑ ุฃู ู / ุซ </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2)</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ุฏุฑุฌุฉ / ุซุงููุฉ ุ ููุง ุฅูู ุฐูู). </font><font style="vertical-align: inherit;">ุฅูู ุฃูุซุฑ ููุงุกูุฉ ููุชุญููู ุฅูู ูุญุฏุงุช ุนุดูุงุฆูุฉ ูู ุงููุณุชุดุนุฑ ุงูููุงุจู.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ุชุญุณุจ ูููุฉ ูุนููุฉ ูู ุงููุญุฏุงุช ุงูููุงุณูุฉ ูููุณุชุดุนุฑุ</font></font></b><div class="spoiler_text">   =  *   / (   โ   )<br>
:      16-      ยฑ2g        ?: <br>
9,8 /<sup>2</sup> * 65536 / (2g + 2g) = 9,8 /<sup>2</sup> * 65536 / (2 * 9,8 /<sup>2</sup> + 2 * 9,8 /<sup>2</sup>) = 16384 . . .<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุงูููุงุณุจุฉ ุ ุฅุฐุง ููุช ุชุนุฑู ูุตู ูุทุฑ ุงููุฑุฉ ุจุงูุถุจุท ุ ูููููู ุญุณุงุจ ุงููุฑูุฒ ููุท ุจูุงุณุทุฉ "ุฅุณููู". </font><font style="vertical-align: inherit;">ุฃู ูู ุงูููุงุท ุงูุชู ุชูุน ููุท ุนูู ูุทุนุฉ ูู ุณุทุญ ุงููุฑุฉ. </font><font style="vertical-align: inherit;">ููู ูุฐู ููุณุช ูุถูุชูุง.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููููุฉ ุชุณุฑูุน ุงูุจุญุซ ุนู ูุฑูุฒ ุงููุฑุฉุ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงูุถุฑูุฑู ุงูุจุญุซ ุนู ุงููุฑูุฒ ููุณ ูู ุงูููุนุจ ุจุงููุงูู (ุฃุจุนุงุฏ ุงููุฑุฉ) ุ ูููู ุนูู ุทูู ุงูุฎุท ุ ุงูุฐู ุชููู ุจุฏุงูุชู ุนุดูุงุฆูุฉ ุ ููู ููุทุฉ ุชุงููุฉ ุฃูุฑุจ ุฅูู ุงููุฑูุฒ ุงูุญูููู ูุงูููุงูุฉ ูู ุงููุฑูุฒ. </font><font style="vertical-align: inherit;">ูููุชุฑุถ ุฃููุง ูุจุฏุฃ ูู ุงูููุทุฉ (0 ุ 0 ุ 0) ... ูุชุญุฑู ุฏุงุฆููุง ุจุฎุทูุฉ ุซุงุจุชุฉ. </font><font style="vertical-align: inherit;">ูุฐูู ุ ุฅุฐุง ุชุตูุฑูุง ูุฌููุนุฉ ูู ููุนุจุงุช 3x3x3 ุ ุญูุซ ูููู ูู ูุฌู ูุณุงูู ุญุฌู ุงูุฎุทูุฉ ููุชุฎูู ุฃูุถูุง ุฃู ุงูููุถุน ุงูุญุงูู ูู ุงูููุนุจ ุงูุฃูุณุท ุ ููุฏููุง ุฎูุงุฑุงุช 9 + 8 + 9 ุญูุซ ูุถุน ุงูููุทุฉ ุงูุชุงููุฉ. </font><font style="vertical-align: inherit;">ุนูููุง ููุท ุฃู ูููู ุนูุฏ ูู ููุทุฉ ุ ูุญุณุงุจ ุฃู ูู ุงูููุงุท ุงููุฌุงูุฑุฉ 26 ุณูููู ุงูุฎุทุฃ ุฃูู. </font><font style="vertical-align: inherit;">ุฅุฐุง ุงุชุถุญ ุฃู ุงูุฎุทุฃ ุฃูู ูู ุงูููุทุฉ ุงูุญุงููุฉ ุ ูููุณ ูู ุฅุญุฏู ุงูููุงุทู ุงููุฌุงูุฑุฉ ุ ููุฐุง ูุนูู ุฃูู ูู ุงููุฑูุฒ ูุฃู ุงูุจุญุซ ูุฏ ุงูุชูู.</font></font><br>
<br>
<img src="https://habrastorage.org/files/ba5/4dd/8d4/ba54dd8d423e4323a643cb4653361f1a.bmp"><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ูููู ุฃู ูููู ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ</font></font></b><div class="spoiler_text"><pre><code class="vbscript hljs"><span class="hljs-keyword">Public</span> <span class="hljs-keyword">Function</span> get_err(A As Double, B As Double, C As Double, R As Double) As Double
<span class="hljs-keyword">Dim</span> x, y, z As Double
<span class="hljs-keyword">Dim</span> sigma As Double
<span class="hljs-keyword">Dim</span> row_n As Long<font></font>
get_err = <span class="hljs-number">0</span>
<span class="hljs-keyword">For</span> row_n = <span class="hljs-number">1</span> <span class="hljs-keyword">To</span> <span class="hljs-number">15</span>
    x = Application.ActiveWorkbook.ActiveSheet.Cells(row_n, <span class="hljs-number">1</span>).Value<font></font>
    y = Application.ActiveWorkbook.ActiveSheet.Cells(row_n, <span class="hljs-number">2</span>).Value<font></font>
    z = Application.ActiveWorkbook.ActiveSheet.Cells(row_n, <span class="hljs-number">3</span>).Value<font></font>
    get_err = get_err + <span class="hljs-built_in">abs</span>( (A - x) ^ <span class="hljs-number">2</span> + (B - y) ^ <span class="hljs-number">2</span> + (C - z) ^ <span class="hljs-number">2</span> - R ^ <span class="hljs-number">2</span> )
<span class="hljs-keyword">Next</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span><font></font>
<font></font>
. . .<font></font>
A = <span class="hljs-number">0</span>
B = <span class="hljs-number">0</span>
C = <span class="hljs-number">0</span><font></font>
<font></font>
<span class="hljs-keyword">Do</span> <span class="hljs-keyword">While</span> <span class="hljs-literal">True</span>
   min_sigma = <span class="hljs-number">0</span>
    <span class="hljs-keyword">For</span> ai = <span class="hljs-number">-1</span> <span class="hljs-keyword">To</span> <span class="hljs-number">1</span>
        <span class="hljs-keyword">For</span> bi = <span class="hljs-number">-1</span> <span class="hljs-keyword">To</span> <span class="hljs-number">1</span>
            <span class="hljs-keyword">For</span> ci = <span class="hljs-number">-1</span> <span class="hljs-keyword">To</span> <span class="hljs-number">1</span>
                sigma = get_err(A + ai, B + bi, C + ci, <span class="hljs-number">16384</span>)
                <span class="hljs-keyword">If</span> sigma &lt; min_sigma <span class="hljs-keyword">Or</span> min_sigma = <span class="hljs-number">0</span> <span class="hljs-keyword">Then</span><font></font>
                    ai_min = ai<font></font>
                    bi_min = bi<font></font>
                    ci_min = ci<font></font>
                    min_sigma = sigma<font></font>
                <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
            <span class="hljs-keyword">Next</span>
        <span class="hljs-keyword">Next</span>
    <span class="hljs-keyword">Next</span><font></font>
    <font></font>
    <span class="hljs-keyword">If</span> ai_min = <span class="hljs-number">0</span> <span class="hljs-keyword">And</span> bi_min = <span class="hljs-number">0</span> <span class="hljs-keyword">And</span> ci_min = <span class="hljs-number">0</span> <span class="hljs-keyword">Then</span>
        <span class="hljs-keyword">Exit</span> <span class="hljs-keyword">Do</span>
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span><font></font>
    <font></font>
    A = A + ai_min<font></font>
    B = B + bi_min<font></font>
    C = C + ci_min<font></font>
<span class="hljs-keyword">Loop</span><font></font>
. . .<font></font>
</code></pre><br>
</div></div><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ุชุณุฑูุน ุงูุจุญุซ ุนู ูุฑูุฒ ุงููุฑุฉุ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุญุงุฌุฉ ุฅูู ุงูุจุญุซ ูุน ุงูููุนุจ ูุชุบูุฑ. </font><font style="vertical-align: inherit;">ุฃููุงู ูุจุญุซ ุนู ุงููุฑูุฒ ุจุฎุทูุงุช ูุจูุฑุฉ. </font><font style="vertical-align: inherit;">ูุฌุฏูุง ุงููุฑูุฒ ููููู ุงูุฎุทูุฉ ููุจุฏุฃ ููู ูู ุงูุจุญุซ ุจุดูู ุฃูุจุฑ. </font><font style="vertical-align: inherit;">ูููุฐุง ุ ุญุชู ุชุญุตู ุนูู ูุชูุฌุฉ ุงูุฏูุฉ ุงููุงุฒูุฉ.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ูููู ุฃู ูููู ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ</font></font></b><div class="spoiler_text"><pre><code class="vbscript hljs"><span class="hljs-keyword">Public</span> <span class="hljs-keyword">Function</span> get_err(A As Double, B As Double, C As Double, R As Double) As Double
<span class="hljs-keyword">Dim</span> x, y, z As Double
<span class="hljs-keyword">Dim</span> sigma As Double
<span class="hljs-keyword">Dim</span> row_n As Long<font></font>
get_err = <span class="hljs-number">0</span>
<span class="hljs-keyword">For</span> row_n = <span class="hljs-number">1</span> <span class="hljs-keyword">To</span> <span class="hljs-number">15</span>
    x = Application.ActiveWorkbook.ActiveSheet.Cells(row_n, <span class="hljs-number">1</span>).Value<font></font>
    y = Application.ActiveWorkbook.ActiveSheet.Cells(row_n, <span class="hljs-number">2</span>).Value<font></font>
    z = Application.ActiveWorkbook.ActiveSheet.Cells(row_n, <span class="hljs-number">3</span>).Value<font></font>
    get_err = get_err + <span class="hljs-built_in">abs</span>( (A - x) ^ <span class="hljs-number">2</span> + (B - y) ^ <span class="hljs-number">2</span> + (C - z) ^ <span class="hljs-number">2</span> - R ^ <span class="hljs-number">2</span> )
<span class="hljs-keyword">Next</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span><font></font>
. . .<font></font>
A = <span class="hljs-number">0</span>
B = <span class="hljs-number">0</span>
C = <span class="hljs-number">0</span>
<span class="hljs-keyword">step</span> = <span class="hljs-number">1000</span>
<span class="hljs-keyword">Do</span> <span class="hljs-keyword">While</span> <span class="hljs-literal">True</span>
   min_sigma = <span class="hljs-number">0</span>
    <span class="hljs-keyword">For</span> ai = <span class="hljs-number">-1</span> <span class="hljs-keyword">To</span> <span class="hljs-number">1</span>
        <span class="hljs-keyword">For</span> bi = <span class="hljs-number">-1</span> <span class="hljs-keyword">To</span> <span class="hljs-number">1</span>
            <span class="hljs-keyword">For</span> ci = <span class="hljs-number">-1</span> <span class="hljs-keyword">To</span> <span class="hljs-number">1</span>
                sigma = get_err(A + ai * <span class="hljs-keyword">step</span>, B + bi * <span class="hljs-keyword">step</span>, C + ci * <span class="hljs-keyword">step</span>, <span class="hljs-number">16384</span>)
                <span class="hljs-keyword">If</span> sigma &lt; min_sigma <span class="hljs-keyword">Or</span> min_sigma = <span class="hljs-number">0</span> <span class="hljs-keyword">Then</span><font></font>
                    ai_min = ai<font></font>
                    bi_min = bi<font></font>
                    ci_min = ci<font></font>
                    min_sigma = sigma<font></font>
                <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
            <span class="hljs-keyword">Next</span>
        <span class="hljs-keyword">Next</span>
    <span class="hljs-keyword">Next</span>
    <span class="hljs-keyword">If</span> ai_min = <span class="hljs-number">0</span> <span class="hljs-keyword">And</span> bi_min = <span class="hljs-number">0</span> <span class="hljs-keyword">And</span> ci_min = <span class="hljs-number">0</span> <span class="hljs-keyword">Then</span>        
        <span class="hljs-keyword">step</span> = <span class="hljs-keyword">step</span> / <span class="hljs-number">10</span>
        <span class="hljs-keyword">If</span> <span class="hljs-keyword">step</span> &lt; <span class="hljs-number">0.01</span> <span class="hljs-keyword">Then</span>
            <span class="hljs-keyword">Exit</span> <span class="hljs-keyword">Do</span>
        <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    <span class="hljs-keyword">Else</span>
    A = A + ai_min * <span class="hljs-keyword">step</span>
    B = B + bi_min * <span class="hljs-keyword">step</span>
    C = C + ci_min * <span class="hljs-keyword">step</span>
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
<span class="hljs-keyword">Loop</span><font></font>
. . .<font></font>
</code></pre><br>
</div></div><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญูู ุฃุฎุทุงุก ุงูููุงุณ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃุซูุงุก ุงูููุงุณุงุช ุ ูุฏ ุชููู ููุงู ููุงูู ุ ูุณุจุจ ูุง ุ ูุฏ ุชููู ูุชูุฌุฉ ุงูููุงุณ ุฃุจุนุฏ ุจูุซูุฑ ูู ุณุทุญ ุงููุฑุฉ. ุฃู ูุฏ ูููู ููุงู ุงููุซูุฑ ูู ุงูููุงุท. ุฃู ุ ุจุดูู ุนุงู ุ ูุฏ ูุง ุชููู ูุชูุฌุฉ ุงูููุงุณุงุช ูุฑุฉ ุ ูููู "ุจูุถุฉ" ุฃู "ููุทุงุฏ". ูู ูุฐู ุงูุญุงูุฉ ุ ุจุงูุทุจุน ุ ุชุญุชุงุฌ ุฅูู ุชูุฑุงุฑ ุฌููุน ุงูููุงุณุงุช ุ ูุชุญุฏูุฏ ุงูุฃุณุจุงุจ ุงููุญุชููุฉ ููุฃุฎุทุงุก. ุนูู ุณุจูู ุงููุซุงู ุ ุจุงููุณุจุฉ ููููุงุณ ุงููุบูุงุทูุณูุฉ ุ ูููู ุฃู ูููู ูุณูุงุฑูุง ุฃู ูุณูุงุฑูุง ูู ุทุงููุฉ ูุฃูุช ุชุฃุฎุฐ ููุงุณุงุช ูููู ูุจุงุดุฑุฉ. ููููุง ุฎูุถุช ุงููุณุชุดุนุฑ ุนูู ุทูู ุฎุท ุงูุทูู ุ ูููุง ุฃุซุฑ ุงููุนุฏู ุนูู ุงููุชูุฌุฉ. ูุฐูู ุ ูู ุงูุถุฑูุฑู ุชุญุฏูุฏ ุนุชุจุฉ ูููุฉ ุงูุฎุทุฃ ุงููุณููุญ ุจูุง. ููู ูุง ุชุนูุฏ ุงูููุงุณุงุช ุจุณุจุจ ุนุฏุฉ ููุงุท ุฎุงุทุฆุฉ ุจุดูู ูุงุถุญ ุ ููููู ุชุทุจูู ูุฑุดุญ. ูุจุฏุฃ ุงููุฑุดุญ ุจุณูุท ููุบุงูุฉ - ุจุนุฏ ุญุณุงุจ ุงููุฑูุฒ ูุฃูู ูุฑุฉ ุ ูู ุจูุฑุฒ ุงูููุงุท ุญุณุจ ูุณุชูู ุงูุฎุทุฃ ูู ูู ูููุง.ูููู ุจุจุณุงุทุฉ ุงูุชุฎูุต ูู ุจุนุถ ุงูููุงุท ุงูุชู ุจูุง ุฃูุจุฑ ุฎุทุฃ (ุนูู ุณุจูู ุงููุซุงู ุ 10ูช). ุซู ุชุญุชุงุฌ ุฅูู ุชูุฑุงุฑ ุงูุจุญุซ ุนู ุงููุฑูุฒ.</font></font><br>
<img src="https://habrastorage.org/files/e22/c6f/b13/e22c6fb1385e4d678aabf7f1d879bc02.png"> <img src="https://habrastorage.org/files/569/40f/d17/56940fd17eef42cba93f590606bbe9e7.png"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฌููุน</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐู ุงูุทุฑููุฉ ูุฏููุง ุฏูุฉ ุฌูุฏุฉ. </font><font style="vertical-align: inherit;">ุชุณูุญ ูู ุงูุทุฑููุฉ ุจุงูููุงู ุจุงููุณุงุฆู ุงููุฑุชุฌูุฉ ุงูุจุณูุทุฉ (ุงููุฑุฉ ุ ุงูุจูู ุ ุฅูุฎ). </font><font style="vertical-align: inherit;">ูุนูู ุจุณุฑุนุฉ ูุงููุฉ. </font><font style="vertical-align: inherit;">ููุฏ ุจุณูุท. </font><font style="vertical-align: inherit;">ุชุญุชูู ุงูุนุฏูุฏ ูู ุฃุฌูุฒุฉ ุงูุงุณุชุดุนุงุฑ ุนูู ุณุฌูุงุช ุฎุงุตุฉ ุญูุซ ููููู ูุชุงุจุฉ ุงููููุฉ ุงูููุฌูุฏุฉ ุ ูุณูุทุฑุญูุง ุงููุณุชุดุนุฑ ุนูู ุงูููุฑ. </font><font style="vertical-align: inherit;">ุนุงุฏุฉ ูุง ูููู ููุฐู ุงูุณุฌูุงุช ุงูุจุงุฏุฆุฉ "TRIM" ุ ููุง ูู ุงูุญุงู ูู MPU9260 ุ ุฃู "OFFSET" ุ ููุง ูู ุงูุญุงู ูู LSM303. </font><font style="vertical-align: inherit;">ููู LIS302DL ุงููุนุฑูู ููุณ ูุฏูู ูุซู ูุฐู ุงูุณุฌูุงุช. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุง ุชูุณ ุฃู ุชุถุน ุนูุงูุฉ ุฒุงุฆุฏ ุฅุฐุง ููุช ุชุญุจ ุฐูู. </font><font style="vertical-align: inherit;">ุงูุชุจ ูู ุงูุชุนูููุงุช ุทุฑูู ููุนุงูุฑุฉ ุงููุณุชุดุนุฑุงุช.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar384075/">https://habr.com/ru/post/ar384075/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar384063/index.html">ููู ูุง ุชููู ุจุถุนุฉ ุบูุบุงุจุงูุช ูู ุญุฑูุฉ ุงููุฑูุฑ ุฏูู ุฃู ููุงุญุธูุง ุฃุญุฏ ุฅุฐุง ููุช ูุง ุชุฑูุฏ ุงูุชุฑููุฉ ุฅูู Windows 10</a></li>
<li><a href="../ar384067/index.html">ุชุฏูุน ููุฒููุง ุงูููุนุฏ ุงูููุงุฆู ูุชูููุน ุชูุฏูุฏ ูุงูุฑูููุณ ุฅูู 26 ููุงูุฑ</a></li>
<li><a href="../ar384069/index.html">ุจุญุซ: ูู ุชุณุงุนุฏ ุงูุชูุงุฑูู ุงูุฑูุงุถูุฉ ุนูู ุงูุฅุฑูุงูุ</a></li>
<li><a href="../ar384071/index.html">ูุธุฑุช ุดุฑูุฉ Sony Pictures ูู ุดุฑุงุก BitTorrent ูู ุนุงู 2006</a></li>
<li><a href="../ar384073/index.html">ููุณุฑ ูุงุบูุง ุชุญุช ุงูุฃุฑุถ ุงููุญูุท ุงููุดุงุท ุงูุจุฑูุงูู ุนูู ุฃูู</a></li>
<li><a href="../ar384079/index.html">ุจุงููุฑุงูุง ูุงุณุนุฉ ูุฌุจู ุดุงุฑุจ</a></li>
<li><a href="../ar384081/index.html">ุตูุฑ ุงููุถุงุก ููุฃุณุจูุน (09/07/13/09)</a></li>
<li><a href="../ar384083/index.html">ุญุฑุจ ุงูุนุงูููู ุณุชููู ูููููุฌ. ูุง ูู ุงููุงุฆูุงุช ุงููุถุงุฆูุฉ ุงูุฎุทุฑุฉ ุนูู ุฃุจูุงุก ุงูุฃุฑุถุ</a></li>
<li><a href="../ar384085/index.html">ูุดุฑุช SpaceX ุตูุฑุฉ ุฏุงุฎููุฉ ูุณูููุฉ ุงููุถุงุก ุทุงูู ุงูุชููู</a></li>
<li><a href="../ar384087/index.html">ุชูุณูุง ููุฏูู S P85D ุณูุงุฑุฉ ููุณุฑ ูุธุงู ุชูููู ุชูุงุฑูุฑ ุงููุณุชููู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>