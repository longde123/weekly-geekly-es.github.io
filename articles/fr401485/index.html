<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😝 😾 👩🏽‍🚒 Test de performances du serveur cloud à l'aide de Dwarf Fortress 👨‍🎤 👩🏻‍💻 ⏺️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dwarf Fortress est un jeu légendaire qui simule un monde fantastique en détail, et un joueur (dans l'un des modes) peut construire et gérer une coloni...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Test de performances du serveur cloud à l'aide de Dwarf Fortress</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/401485/">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Dwarf Fortress</a> est un jeu légendaire qui simule un monde fantastique en détail, et un joueur (dans l'un des modes) peut construire et gérer une colonie (forteresse) de gnomes (nains).  Assez a été écrit sur le jeu, donc je n'entrerai pas dans les détails.  Il est important qu'en raison de la grande taille du monde du jeu et des détails élevés de la simulation, le jeu soit assez exigeant en ressources - à la fois le processeur et la mémoire / cache.  Le jeu prend en charge les trois principaux systèmes d'exploitation. <br><br>  Il existe un projet DFHack pour le jeu, qui est engagé dans la rétro-ingénierie des structures de données de jeu et vous permet de créer des plugins et des scripts en C ++, Lua ou Ruby. <br><br>  Je suis l'auteur de l'application et du code serveur qui implémente entièrement l'interface utilisateur du jeu sur les appareils iOS.  Autrement dit, l'utilisateur met le jeu, le plug-in et l'application d'origine, et peut jouer à distance à partir d'un appareil mobile avec toutes les commodités. <br><br>  Le serveur peut être installé à la maison et loué auprès de l'un des fournisseurs de cloud.  Et l'idée de cette étude est née - premièrement, pour savoir lequel des services cloud est le mieux adapté et peut être recommandé aux utilisateurs en premier lieu, et deuxièmement, comparer réellement les performances du serveur en utilisant quelque chose de différent des serveurs Web et des utilitaires spéciaux . <br><a name="habracut"></a><br>  Pour les tests, la version de Dwarf Fortress / DFHack 0.43.03-r1 a été utilisée.  J'ai une image publique pour Docker, y compris le jeu lui-même et la version minimale de DFHack (ainsi que le code serveur lui-même pour le jeu distant, mais dans ce cas, il n'est pas utilisé).  Un script a été écrit en Lua pour exécuter des tests et envoyer les résultats à un serveur Web.  Également pour l'automatisation, le script suivant a été utilisé, spécifié dans les données utilisateur lors de la configuration des serveurs.  Autrement dit, vous aviez juste besoin de créer un serveur, attendez que les résultats arrivent et supprimez-le. <br><br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash fallocate -l 4G /swp ; chmod 600 /swp ; mkswap /swp ; swapon /swp ; echo '/swp none swap sw 0 0' &gt;&gt;/etc/fstab apt-get update apt-get install -fy docker.io apt install unzip wget https://github.com/mifki/dfremote-cloud-benchmark/raw/master/benchmark.lua wget http://mifki.com/a/t/gloveloved.zip unzip gloveloved.zip -d save/ docker run --name=df -dt -v $PWD/save:/df_linux/data/save -v $PWD/benchmark.lua:/df_linux/hack/scripts/benchmark.lua mifki/dfremote sleep 5 docker exec df /df_linux/dfhack-run benchmark server_name</span></span></code> </pre> <br>  Les fournisseurs suivants ont été testés: Digital Ocean, Amazon Lightsail, Amazon EC2, Vultr, Linode, Google Compute Engine et Macbook Pro Fin 2013 2Ghz Core i7. <br><br>  Si le service cloud prend en charge la création d'un serveur avec Docker en un clic, alors cette fonctionnalité a été utilisée, sinon, la version d'Ubuntu 16.04 a été sélectionnée.  Ainsi, seul Vultr n'a pas utilisé Ubuntu, mais CentOS 7. Pour les serveurs avec plus de 2 Go de mémoire, le fichier d'échange n'a pas été utilisé.  Pour Google Compute Engine micro et petit, un lecteur SSD a été sélectionné. <br><br>  Les options de serveur les moins chères ont été choisies, d'une part, car elles sont plus intéressantes pour ceux qui vont les utiliser pour le jeu, et d'autre part, parce que Dwarf Fortress n'utilise toujours qu'un seul cœur de processeur pour la simulation et (dans la version spécifiée) Application 32 bits. <br><br><h3>  Les tests </h3><br>  Le processus de jeu de Dwarf Fortress se compose de deux parties - la génération du monde et l'histoire initiale, dans laquelle vous pouvez spécifier la taille du monde et la longueur de l'histoire (et d'autres paramètres), et le processus de jeu lui-même.  De manière cohérente, sans redémarrer le jeu, les tests suivants ont été effectués: <br><br><ol><li>  Générer un monde de très petite taille avec une très longue histoire. </li><li>  Générer un monde de grande taille avec une courte histoire. </li><li>  Gameplay.  Utilisé l'un des sauvegardes du «groupe» (quand beaucoup de gens jouent à tour de rôle) - gantée aimée (Anethadefíni, 254).  Le choix n'est pas si important, tant qu'il y a une forteresse suffisamment grande, et rien qui arrêterait automatiquement le jeu ne se produit pendant le test, qui a duré 20 jours en jeu. </li></ol><br>  Le dernier test est le plus important, premièrement, parce que c'est le gameplay lui-même, pour lequel tout se passe, et deuxièmement, il est moins affecté par le hasard que la génération du monde (dans laquelle les civilisations, les colonies, le paysage, les événements et ainsi de suite). <br><br><h3>  Résultats </h3><br>  Voici l'horaire.  Le temps d'exécution en secondes, respectivement, moins c'est mieux.  Prix ​​mensuels en dollars américains. <br><br><img src="https://habrastorage.org/files/d87/d72/2de/d87d722deebd43f48670376da89c58f7.png" alt="image"><br><br>  Une diffusion non naturelle des résultats du premier test est immédiatement visible, je ne sais pas exactement à quoi cela est lié.  Je crois, en partie avec la mise en cache, en partie avec les mauvaises performances du serveur nouvellement créé pour une raison quelconque.  Par conséquent, les résultats sont triés par le dernier test, qui, comme indiqué, est le plus important.  Le deuxième test est également généralement en corrélation avec les résultats du troisième. <br><br>  En dehors de la première place attendue sur le serveur EC2 c4.large, qui est un type de C4 optimisé pour les performances, Amazon Lightsail s'est avéré être le plus rapide, ce qui, compte tenu du prix, est une très agréable surprise.  Il est suivi par presque le même résultat du serveur et de l'ordinateur portable à processeur unique de Google.  De plus, le Vultr inconnu, Linode, dont je m'attendais à mieux, s'est avéré bon.  Le prix du public revient à Digital Ocean - plus lent, mais le plus simple et le plus rapide à utiliser.  Les serveurs EC2 m3.medium plutôt chers sont étonnamment lents, et les serveurs GCE les moins chers sont vraiment mauvais même avec des SSD, je n'ai pas obtenu le résultat du test du serveur de micro-taille. <br><br>  Séparément, il faut dire à propos des instances EC2 de type T2.  Leur caractéristique est qu'avec un simple serveur reçoit des crédits de processeur (jusqu'à une certaine limite), qui sont dépensés sous charge.  En dépensant des prêts, le serveur fonctionne à pleine capacité, lorsqu'ils sont épuisés - les performances tombent à 20%.  D'une part, il est très bien adapté à nos besoins - les gens, en particulier à partir d'un appareil mobile, ne jouent pas en continu toute la journée, de plus la simulation dans le jeu s'arrête lorsqu'une personne fait quelque chose dans le menu, etc., c'est donc une bonne option pour obtenir haute performance pour peu d'argent.  En revanche, il s'agit de «fausses» performances, donc je n'ai pas inclus d'instances de ce type dans les tests afin de ne dérouter personne.  Par expérience, tant qu'il y a des prêts, ils sont assez rapides, lorsqu'ils s'épuisent - très lentement. <br><br>  C’est tout. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr401485/">https://habr.com/ru/post/fr401485/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr401475/index.html">Interprétation multi-mondes et multivers - peuvent-ils devenir une seule et même idée?</a></li>
<li><a href="../fr401477/index.html">Des chercheurs d'IBM mesurent la conductivité thermique par un contact monatomique</a></li>
<li><a href="../fr401479/index.html">Vacance</a></li>
<li><a href="../fr401481/index.html">10 technologies qui devraient être dans un smartphone moderne</a></li>
<li><a href="../fr401483/index.html">Элементы защиты банкнот. Частное расследование</a></li>
<li><a href="../fr401487/index.html">La huitième génération d'Intel Core restera sur le processus de fabrication 14 nm</a></li>
<li><a href="../fr401489/index.html">Ford développe son propre système de contrôle de véhicule autonome</a></li>
<li><a href="../fr401491/index.html">Des ingénieurs japonais ont créé un pollinisateur quadricoptère</a></li>
<li><a href="../fr401493/index.html">Les mathématiciens mettent en lumière une hypothèse minimaliste</a></li>
<li><a href="../fr401495/index.html">L'histoire de la technologie implantable. Aides auditives</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>