<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üóæ üéΩ üå¨Ô∏è Entwicklerkochbuch: DDD-Rezepte (Teil 5, Prozesse) üóÇÔ∏è ü¶á üåõ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Einf√ºhrung 


 In den vorherigen Artikeln haben wir beschrieben: Umfang , methodische Grundlagen , ein Beispiel f√ºr Architektur und Struktur . In dies...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Entwicklerkochbuch: DDD-Rezepte (Teil 5, Prozesse)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/454668/"><h1 id="vvedenie">  Einf√ºhrung </h1><br><p> In den vorherigen Artikeln haben wir beschrieben: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Umfang</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">methodische Grundlagen</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ein Beispiel f√ºr Architektur</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Struktur</a> .  In diesem Artikel m√∂chte ich erl√§utern, wie die Prozesse beschrieben werden, welche Prinzipien zum Sammeln von Anforderungen gelten, wie sich Gesch√§ftsanforderungen von funktionalen unterscheiden und wie von Anforderungen zu Code gewechselt wird.  Sprechen Sie √ºber die Prinzipien der Verwendung des Anwendungsfalls und wie sie uns helfen k√∂nnen.  Sehen Sie sich Beispiele f√ºr Implementierungsoptionen f√ºr Interactor- und Service Layer-Entwurfsmuster an. </p><br><p><img src="https://habrastorage.org/webt/wo/je/ct/woject0sgeuwc_4xnnzugty-5jg.png" alt="wie deine gro√üemutter"></p><br><p>  Die im Artikel angegebenen Beispiele werden mit unserer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">LunaPark-</a> L√∂sung gegeben. Sie hilft Ihnen bei den ersten Schritten in den beschriebenen Ans√§tzen. </p><br><h1 id="otdelyaem-funkcionalnye-trebovaniya-ot-biznes-trebovaniy">  Trennen Sie funktionale Anforderungen von Gesch√§ftsanforderungen. </h1><br><p>  Immer wieder kommt es vor, dass viele Gesch√§ftsideen nicht wirklich zum endg√ºltigen, beabsichtigten Produkt werden.  Dies ist h√§ufig darauf zur√ºckzuf√ºhren, dass der Unterschied zwischen Gesch√§ftsanforderungen und funktionalen Anforderungen nicht verstanden werden kann, was letztendlich zu einer unzureichenden Erfassung von Anforderungen, unn√∂tiger Dokumentation, Projektverz√∂gerungen und gr√∂√üeren Projektfehlern f√ºhrt. </p><br><p>  Oder manchmal sind wir mit Situationen konfrontiert, in denen die endg√ºltige L√∂sung zwar den Bed√ºrfnissen der Kunden entspricht, die Gesch√§ftsziele jedoch irgendwie nicht erreicht werden. </p><br><p>  Daher ist es unbedingt erforderlich, die Gesch√§ftsanforderungen von den funktionalen Anforderungen zu trennen, bis Sie mit der Definition beginnen.  Nehmen wir ein Beispiel. </p><a name="habracut"></a><br><p>  Angenommen, wir schreiben einen Antrag f√ºr eine Pizza-Lieferfirma und haben beschlossen, ein Kurier-Tracking-System zu erstellen.  Die Gesch√§ftsanforderungen lauten wie folgt: </p><br><p>  <em>"Einf√ºhrung eines webbasierten Systems und eines mobilen, auf Mitarbeitern basierenden Mitarbeiterverfolgungssystems, das Kuriere auf ihren Routen erfasst und die Effizienz verbessert, indem die Aktivit√§ten der Kuriere, ihre Abwesenheit von der Arbeit und die Arbeitsproduktivit√§t √ºberwacht werden."</em> </p><br><p>  Hier k√∂nnen wir eine Reihe von charakteristischen Merkmalen unterscheiden, die darauf hinweisen, dass dies Anforderungen aus dem Gesch√§ft sind: </p><br><ul><li>  Gesch√§ftsanforderungen werden immer aus Sicht des Kunden geschrieben; </li><li>  Dies sind breite Anforderungen auf hoher Ebene, die jedoch immer noch teilorientiert sind. </li><li>  Sie sind keine Unternehmensziele, sondern helfen dem Unternehmen, Ziele zu erreichen. </li><li>  Beantworten Sie die Fragen ‚Äû <strong>Warum</strong> ‚Äú und ‚Äû <strong>Was</strong> ‚Äú.  Was m√∂chte das Unternehmen erhalten?  Und warum braucht sie es? </li></ul><br><p>  Funktionale Anforderungen sind <em>Aktionen</em> , die das System ausf√ºhren muss, um Gesch√§ftsanforderungen zu implementieren.  Somit h√§ngen die funktionalen Anforderungen mit der entwickelten L√∂sung oder Software zusammen.  Wir formulieren die funktionalen Anforderungen f√ºr das obige Beispiel: </p><br><ul><li>  Das System sollte den L√§ngen- und Breitengrad des Mitarbeiters √ºber GPS / GLONASS anzeigen. </li><li>  Das System sollte die Positionen der Mitarbeiter auf der Karte anzeigen. </li><li>  Das System sollte es Managern erm√∂glichen, Benachrichtigungen an ihre Au√üendienstmitarbeiter zu senden. </li></ul><br><p>  Wir heben die folgenden Merkmale hervor: </p><br><ul><li>  funktionale Anforderungen werden immer aus Sicht des Systems geschrieben; </li><li>  sie sind spezifischer und detaillierter; </li><li>  Dank der Erf√ºllung der funktionalen Anforderungen wird eine effektive L√∂sung entwickelt, die den Anforderungen des Unternehmens und den Zielen des Kunden entspricht. </li><li>  Beantworten Sie die Frage " <strong>wie</strong> ".  Wie das System Gesch√§ftsanforderungen l√∂st. </li></ul><br><p>  Es sollten einige Worte zu nicht funktionalen Anforderungen (auch als ‚ÄûQualit√§tsanforderungen‚Äú bezeichnet) gesagt werden, die das Design oder die Implementierung einschr√§nken (z. B. Anforderungen an Leistung, Sicherheit, Verf√ºgbarkeit, Zuverl√§ssigkeit).  Solche Anforderungen beantworten die Frage, <strong>was</strong> das System sein soll. </p><br><p>  Entwicklung ist die √úbersetzung von Gesch√§ftsanforderungen in funktionale.  Angewandte Programmierung ist die Implementierung funktionaler Anforderungen und des Systems - nicht funktionsf√§hig. </p><br><h1 id="varianty-ispolzovaniya-use-cases">  Anwendungsf√§lle </h1><br><p>  Die Implementierung funktionaler Anforderungen ist in kommerziellen Systemen h√§ufig die komplexeste.  In einer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">reinen Architektur werden</a> funktionale Anforderungen √ºber die <em>Use-Case-</em> Ebene implementiert. </p><br><p>  Aber f√ºr den Anfang m√∂chte ich mich an die Quelle wenden.  Ivar Jacobson - der Autor der Definition von <em>Use Case</em> , einer der Autoren von UML, und der RUP-Methodik in seinem Artikel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Use-Case 2.0 Der Hub of Software Development</a> identifiziert 6 Prinzipien f√ºr die Verwendung von Use <em>Cases</em> : </p><br><ol><li>  mach sie einfach durch Geschichtenerz√§hlen; </li><li>  einen strategischen Plan haben, das ganze Bild kennen; </li><li>  Fokus auf Bedeutung; </li><li>  Richten Sie das System in Schichten aus. </li><li>  liefern Sie das System Schritt f√ºr Schritt; </li><li>  die Bed√ºrfnisse des Teams erf√ºllen. </li></ol><br><p>  Wir betrachten kurz jedes dieser Prinzipien, sie sind f√ºr uns zum weiteren Verst√§ndnis n√ºtzlich.  Unten finden Sie meine kostenlose √úbersetzung mit Abk√ºrzungen und Beilagen. Ich empfehle Ihnen dringend, sich mit dem Original vertraut zu machen. </p><br><h3 id="prostota-cherez-povestvovanie">  Einfachheit durch Geschichtenerz√§hlen </h3><br><p>  <em>Erz√§hlung ist Teil unserer Kultur;</em>  <em>Dies ist der einfachste und effektivste Weg, um Wissen und Informationen von einer Person zur anderen zu √ºbertragen.</em>  <em>Dies ist der beste Weg, um zu kommunizieren, was das System tun soll, und um dem Team zu helfen, sich auf gemeinsame Ziele zu konzentrieren.</em> </p><br><p>  <em>Anwendungsf√§lle spiegeln die Systemziele wider.</em>  <em>Um den Anwendungsfall zu verstehen, erz√§hlen wir eine bestimmte Geschichte.</em>  <em>Die Geschichte erz√§hlt, wie man ein Ziel erreicht und Probleme l√∂st, die auf dem Weg entstehen.</em>  <em>Anwendungsf√§lle wie ein Storybook bieten eine M√∂glichkeit, die verschiedenen, aber verwandten Geschichten auf einfache und umfassende Weise zu identifizieren und zu behandeln.</em>  <em>Dies erleichtert das Sammeln, Verteilen und Verstehen von Systemanforderungen.</em> </p><br><p>  Dieses Prinzip korreliert mit der Ubiques-Sprache aus dem DDD-Ansatz. </p><br><h3 id="ponimanie-kartiny-v-celom">  Das ganze Bild verstehen </h3><br><p>  <em>Unabh√§ngig davon, welches System Sie entwickeln, ob gro√ü, klein, Software, Hardware oder Unternehmen, ist es sehr wichtig, das Gesamtbild zu verstehen.</em>  <em>Ohne das System als Ganzes zu verstehen, k√∂nnen Sie nicht die richtigen Entscheidungen dar√ºber treffen, was in das System aufgenommen werden soll, was ausgeschlossen werden soll, wie viel es kosten wird und welche Vorteile es bringen wird.</em> </p><br><p>  Ivar Jacobson schl√§gt vor, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">das Anwendungsfalldiagramm zu verwenden</a> , das zum Sammeln von Anforderungen sehr praktisch ist.  Wenn die Anforderungen kompiliert und klar sind, ist die Kontextkarte von Eric Evans die beste Option.  Oft wird der Scrum-Ansatz so interpretiert, dass die Menschen keine Zeit mit einem strategischen Plan verbringen, da sie mehr als zwei Wochen sp√§ter ein Relikt der Vergangenheit planen.  Jeff Sutherlands Propaganda fiel auf den Wasserfluss, und Leute, die zweiw√∂chige Schulungen f√ºr Scrum Masters absolvierten, die Projekte verwalten durften, machten ihre Arbeit.  Der gesunde Menschenverstand erkennt jedoch die Bedeutung der strategischen Planung an.  Es ist nicht erforderlich, einen detaillierten Strategieplan zu erstellen, dies sollte jedoch der Fall sein. </p><br><h3 id="fokus-na-znachenii">  Wert im Fokus </h3><br><p>  <em>Wenn Sie versuchen zu verstehen, wie das System verwendet wird, ist es immer wichtig, sich auf den Wert zu konzentrieren, den es seinen Benutzern und anderen interessierten Parteien bietet.</em>  <em>Wert wird nur gebildet, wenn das System verwendet wird.</em>  <em>Daher ist es viel besser, sich auf die Anwendung des Systems zu konzentrieren, als auf lange Listen von Funktionen, die es bieten kann.</em> </p><br><p>  <em>Anwendungsf√§lle bieten diesen Fokus und helfen Ihnen, sich darauf zu konzentrieren, wie das System von einem bestimmten Benutzer verwendet wird, um sein Ziel zu erreichen.</em>  <em>Anwendungsf√§lle decken viele M√∂glichkeiten zur Verwendung des Systems ab: diejenigen, die ihre Ziele erfolgreich erreichen, und diejenigen, die auftretende Schwierigkeiten l√∂sen.</em> </p><br><p>  Dar√ºber hinaus gibt der Autor ein wunderbares Schema, dem die gr√∂√üte Aufmerksamkeit geschenkt werden sollte: </p><br><p><img src="https://habrastorage.org/webt/5g/nk/ma/5gnkmae4chv6_azevvzhg2euglc.png"></p><br><p>  Das Diagramm zeigt einen Anwendungsfall ‚ÄûBargeldbezug an einem Geldautomaten‚Äú.  Der einfachste Weg, um das Ziel zu erreichen, ist in der <em>Grundrichtung</em> (Grundablauf) beschrieben.  Andere F√§lle werden als alternativer Fluss beschrieben.  Diese Anweisungen helfen beim Geschichtenerz√§hlen, beim Strukturieren des Systems und beim Schreiben von Tests. </p><br><h3 id="posloynoe-postroenie">  Schichtung </h3><br><p>  <em>Die meisten Systeme erfordern viel Arbeit, bevor sie einsatzbereit sind.</em>  <em>Sie haben viele Anforderungen, von denen die meisten von anderen Anforderungen abh√§ngen. Sie m√ºssen implementiert werden, bevor die Anforderungen erf√ºllt und bewertet werden.</em> </p><br><p>  <em>Es ist ein gro√üer Fehler, jeweils ein solches System zu erstellen.</em>  <em>Das System sollte aus Teilen aufgebaut sein, von denen jedes f√ºr die Benutzer einen eindeutigen Wert hat.</em> </p><br><p>  Diese Ideen finden Resonanz bei agilen Ans√§tzen und bei <em>Domain-</em> Ideen. </p><br><h3 id="poshagovyy-vyvod-produkta-na-rynok">  Schrittweise Produkteinf√ºhrung </h3><br><p>  <em>Die meisten Softwaresysteme haben sich √ºber viele Generationen hinweg weiterentwickelt.</em>  <em>Sie werden nicht gleichzeitig produziert;</em>  <em>Sie bestehen aus einer Reihe von Versionen, von denen jede auf einer fr√ºheren Version basiert.</em>  <em>Sogar die Ver√∂ffentlichungen selbst gehen oft nicht sofort aus, sondern entwickeln sich durch eine Reihe von Zwischenversionen.</em>  <em>Jeder Schritt bietet eine klare, verwendbare Version des Systems.</em>  <em>Auf diese Weise sollten alle Systeme erstellt werden.</em> </p><br><h3 id="udovletvoryat-potrebnosti-komandy">  Erf√ºllen Sie die Bed√ºrfnisse des Teams </h3><br><p>  <em>Leider gibt es keine universelle L√∂sung f√ºr Softwareentwicklungsprobleme.</em>  <em>Unterschiedliche Teams und unterschiedliche Situationen erfordern unterschiedliche Stile und unterschiedliche Detaillierungsgrade.</em>  <em>Unabh√§ngig davon, f√ºr welche Methoden und Techniken Sie sich entscheiden, m√ºssen Sie sicherstellen, dass sie anpassungsf√§hig genug sind, um den aktuellen Anforderungen des Teams gerecht zu werden.</em> </p><br><p>  Eric Evans fordert Sie in seinem Buch auf, nicht viel Zeit damit zu verbringen, alle Prozesse √ºber UML zu beschreiben.  Es reicht aus, visuelle Schemata zu verwenden.  Unterschiedliche Teams, unterschiedliche Projekte erfordern unterschiedliche Detaillierungsgrade, da der UML-Autor selbst dar√ºber spricht. </p><br><h1 id="realizaciya">  Implementierung </h1><br><p>  In der reinen Architektur definiert Robert Martin die folgenden <em>Anwendungsf√§lle</em> : </p><br><blockquote>  Diese Anwendungsf√§lle koordinieren den Datenfluss zu und von den Entit√§ten und weisen diese Entit√§ten an, ihre kritischen Gesch√§ftsregeln zu verwenden, um die Ziele des Anwendungsfalls zu erreichen. </blockquote><p>  Versuchen wir, diese Ideen in Code zu √ºbersetzen.  Erinnern wir uns an das Schema aus dem dritten Prinzip der Verwendung der Anwendungsf√§lle und nehmen es als Grundlage.  Stellen Sie sich einen wirklich komplexen Gesch√§ftsprozess vor: ‚ÄûKochen eines Kohlkuchens‚Äú. </p><br><p>  Versuchen wir es zu zerlegen: </p><br><ul><li>  Produktverf√ºgbarkeit pr√ºfen; </li><li>  nimm sie aus dem Lager; </li><li>  den Teig kneten; </li><li>  lass den Teig aufgehen; </li><li>  bereite die F√ºllung vor; </li><li>  einen Kuchen machen; </li><li>  backe einen Kuchen. </li></ul><br><p>  Wir implementieren diese gesamte Sequenz √ºber den <em>Interactor</em> , und jeder Schritt wird √ºber eine Funktion oder ein Funktionsobjekt auf der Serviceschicht implementiert. </p><br><h1 id="posledovatelnost-deystviy-interactor">  Reihenfolge der Aktionen (Interaktor) </h1><br><p><img src="https://habrastorage.org/webt/6b/vk/ra/6bvkra2chr3b8d43dmtxebpjaj4.png" alt="Schritt f√ºr Schritt"></p><br><p>  Ich empfehle dringend, die Entwicklung eines komplexen Gesch√§ftsprozesses mit der <em>Reihenfolge der Aktionen zu beginnen</em> .  Genauer gesagt, m√ºssen Sie die <em>Domain Domain</em> bestimmen, zu der der Gesch√§ftsprozess geh√∂rt.  Kl√§ren Sie alle gesch√§ftlichen Anforderungen.  Identifizieren Sie alle am Prozess beteiligten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><em>Entit√§ten</em></a> .  Dokumentieren Sie die Anforderungen und Definitionen jeder <em>Entit√§t</em> in der Wissensdatenbank. </p><br><p>  Malen Sie alles schrittweise auf Papier.  Manchmal ben√∂tigen Sie ein Sequenzdiagramm.  Sein Autor ist derselbe, der den Anwendungsfall erfunden hat - Ivar Jacobson.  Das Diagramm wurde von ihm erfunden, als er f√ºr Erickson ein auf der Relaisschaltung basierendes Telefonnetz-Wartungssystem entwickelte.  Ich mag dieses Diagramm sehr und der Begriff <em>Sequenz</em> ist meiner Meinung nach aussagekr√§ftiger als der Begriff <em>Interactor</em> .  In Anbetracht der gr√∂√üeren Verbreitung des letzteren werden wir den bekannten Begriff <em>Interactor verwenden</em> . </p><br><p>  Ein kleiner Hinweis, wenn Sie einen Gesch√§ftsprozess beschreiben, ist eine gute Hilfe f√ºr Sie. Die Hauptregel der Dokumentenverwaltung kann lauten: ‚ÄûAls Ergebnis einer Gesch√§ftst√§tigkeit sollte ein Dokument erstellt werden.‚Äú  Zum Beispiel entwickeln wir ein Rabattsystem.  Mit einem Rabatt schlie√üen wir aus gesch√§ftlicher Sicht eine Vereinbarung zwischen dem Unternehmen und dem Kunden.  Alle Bedingungen m√ºssen in diesem Vertrag festgelegt werden.  Das hei√üt, in der DiscountSystem-Dom√§ne haben Sie Entites :: Contract.  Binden Sie den Rabatt nicht an den Kunden, sondern erstellen Sie einen Unternehmensvertrag, in dem die Regeln f√ºr seine Bereitstellung beschrieben werden. </p><br><p>  Kehren wir zur Beschreibung unseres Gesch√§ftsprozesses zur√ºck, nachdem er f√ºr alle an seiner Entwicklung beteiligten Personen transparent geworden ist und Ihr gesamtes Wissen feststeht.  Ich empfehle Ihnen, Code mit der <em>Reihenfolge der Aktionen zu</em> schreiben. </p><br><p>  Die <em>Sequenzdesign-</em> Vorlage ist verantwortlich f√ºr: </p><br><ul><li>  Abfolge von <em>Aktionen</em> ; </li><li>  Koordination der √ºbertragenen Daten zwischen <em>Aktionen</em> ; </li><li>  Verarbeitungsfehler, die von <em>Aktionen</em> w√§hrend ihrer Ausf√ºhrung begangen wurden; </li><li>  R√ºckgabe des Ergebnisses der zugesagten <em>Aktionen</em> ; </li><li>  <strong>WICHTIG</strong> : Die wichtigste Verantwortung f√ºr dieses Entwurfsmuster ist die Implementierung der Gesch√§ftslogik. </li></ul><br><p>  Ich m√∂chte n√§her auf die letzte Verantwortung eingehen, wenn wir einen komplexen Prozess haben - wir m√ºssen ihn so beschreiben, dass klar ist, was passiert, ohne auf technische Details einzugehen.  <strong>Sie sollten es so aussagekr√§ftig beschreiben, wie es Ihre Programmierkenntnisse zulassen</strong> .  Vertrauen Sie diese Klasse dem erfahrensten Mitglied Ihres Teams an. </p><br><p>  Kehren wir zum Kuchen zur√ºck: Versuchen wir, den Prozess seiner Vorbereitung durch <em>Interactor</em> zu beschreiben. </p><br><h2 id="realizaciya-1">  Implementierung </h2><br><p>  Ich gebe eine Beispielimplementierung mit unserer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">LunaPark-</a> L√∂sung, die wir in einem fr√ºheren Artikel vorgestellt haben. </p><br><pre><code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Kitchen</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Sequences</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CookingPieWith</span></span></span><span class="hljs-class"></span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">abbage</span></span></span><span class="hljs-class"> &lt; LunaPark::Interactors::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Sequence</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TEMPERATURE</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Values::Temperature</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class">(180, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">unit</span></span></span><span class="hljs-class">: :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cel</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call!</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Services::CheckProductsAvailability</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">list</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ingredients</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dough</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Services::BeatDough</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">from</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Repository::Products</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">beat_ingredients</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">filler</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Services::Make</span></span></span><span class="hljs-class"></span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">abbageFiller</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">from</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Repository::Products</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">filler_ingredients</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pie</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Services::MakePie</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dough</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">with</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">filler</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bake</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Services::BakePie</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pie</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">temp</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TEMPERATURE</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sleep</span></span></span><span class="hljs-class"> 5.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">min</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">until</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bake</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pie</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr_accessor</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">beat_ingredients</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">filler_ingredients</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr_accessor</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pie</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ingredients_list</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">beat_ingredients_list</span></span></span><span class="hljs-class"> + </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">filler_ingredients_list</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre> <br><p>  Wie wir sehen k√∂nnen, ist der <code>call!</code>  beschreibt die gesamte Gesch√§ftslogik des Kuchenbackprozesses.  Und es ist bequem zu verwenden, um die Logik der Anwendung zu verstehen. </p><br><p>  Au√üerdem k√∂nnen wir den Prozess des Backens von Fischpastete leicht beschreiben, indem <code>MakeabbageFiller</code> <code>MakeFishFiller</code> durch <code>MakeabbageFiller</code> <code>MakeFishFiller</code> .  Daher √§ndern wir den Gesch√§ftsprozess sehr schnell, ohne wesentliche Code√§nderungen.  Au√üerdem k√∂nnen wir beide <em>Sequenzen</em> gleichzeitig belassen und Gesch√§ftsf√§lle skalieren. </p><br><h3 id="dogovorennosti">  Arrangements </h3><br><ul><li>  Methode <code>call!</code>  ist eine erforderliche Methode und beschreibt die Reihenfolge der <em>Aktionen</em> . </li><li>  Jeder Initialisierungsparameter kann durch einen Setter oder <code>attr_acessor</code> : </li></ul><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Foo</span></span></span><span class="hljs-class"> &lt; LunaPark::Interactors::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Sequence</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># ... private attr_accessor :bar end Foo.call(bar: 42)</span></span></span></span></code> </pre> <br><ul><li>  Der Rest der Methoden sollte privat sein. </li></ul><br><h2 id="primer-ispolzovaniya">  Anwendungsbeispiel </h2><br><pre> <code class="ruby hljs">beat_ingredients = [ Entity::Product.new <span class="hljs-symbol"><span class="hljs-symbol">:flour</span></span>, <span class="hljs-number"><span class="hljs-number">500</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:gr</span></span>, Entity::Product.new <span class="hljs-symbol"><span class="hljs-symbol">:oil</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:gr</span></span>, Entity::Product.new <span class="hljs-symbol"><span class="hljs-symbol">:salt</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:spoon</span></span>, Entity::Product.new <span class="hljs-symbol"><span class="hljs-symbol">:milk</span></span>, <span class="hljs-number"><span class="hljs-number">150</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:ml</span></span>, Entity::Product.new <span class="hljs-symbol"><span class="hljs-symbol">:egg</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:unit</span></span>, Entity::Product.new <span class="hljs-symbol"><span class="hljs-symbol">:yeast</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:spoon</span></span> ] filler_ingredients = [ Entity::Product.new <span class="hljs-symbol"><span class="hljs-symbol">:cabbage</span></span>, <span class="hljs-number"><span class="hljs-number">500</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:gr</span></span>, Entity::Product.new <span class="hljs-symbol"><span class="hljs-symbol">:salt</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:spoon</span></span>, Entity::Product.new <span class="hljs-symbol"><span class="hljs-symbol">:pepper</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:spoon</span></span> ] cooking = CookingPieWithabbage.call( <span class="hljs-symbol"><span class="hljs-symbol">beat_ingredients:</span></span> beat_ingredients, <span class="hljs-symbol"><span class="hljs-symbol">filler_ingredients:</span></span> filler_ingredients ) <span class="hljs-comment"><span class="hljs-comment">#   : cooking.success? # =&gt; true cooking.fail # =&gt; false cooking.fail_message # =&gt; '' cooking.data # =&gt; Entity::Pie #   : cooking.success? # =&gt; false cooking.fail # =&gt; true cooking.fail_message # =&gt; 'The pie burned out' cooking.data # =&gt; nil</span></span></code> </pre> <br><p>  Der Prozess wird durch das Objekt dargestellt und wir haben alle notwendigen Methoden, um es aufzurufen - war der Aufruf erfolgreich, ist w√§hrend des Aufrufs ein Fehler aufgetreten, und wenn ja, welche? </p><br><h2 id="obrabotka-oshibok">  Fehlerbehandlung </h2><br><p>  Wenn wir uns jetzt an das dritte Prinzip der Use-Case-Anwendung erinnern, achten wir darauf, dass wir neben der Hauptzeile auch <em>alternative</em> Anweisungen hatten.  Dies sind Fehler, die wir behandeln m√ºssen.  Stellen Sie sich ein Beispiel vor: Wir m√∂chten sicher nicht, dass Ereignisse in diese Richtung verlaufen, aber wir k√∂nnen nichts dagegen tun. Die harte Realit√§t ist, dass die Kuchen regelm√§√üig verbrannt werden. </p><br><p>  <em>Interactor</em> f√§ngt alle Fehler ab, die von der <code>LunaPark::Errors::Processing</code> Klasse geerbt wurden. </p><br><p>  Wie verfolgen wir den Kuchen?  Definieren Sie dazu den Fehler <code>Burned</code> in der <code>BakePie</code> <em>Aktion</em> . </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Kitchen</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Errors</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Burned</span></span></span><span class="hljs-class"> &lt; LunaPark::Errors::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Processing</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p>  Und stellen Sie beim Backen sicher, dass unser Kuchen nicht ausgebrannt ist: </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Kitchen</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Services</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BakePie</span></span></span><span class="hljs-class"> &lt; LunaPark::Callable </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># ... rescue Errors::Burned, 'The pie burned out' if pie.burned? # ... end end end end</span></span></span></span></code> </pre> <br><p>  In diesem Fall funktioniert die Fehlerfalle, und wir k√∂nnen sie in <code></code> . <br>  Fehler, die nicht von der <code>Processing</code> geerbt wurden, werden als Systemfehler wahrgenommen und auf Serverebene abgefangen.  Sofern nicht anders angegeben, erh√§lt der Benutzer einen 500 ServerError. </p><br><h2 id="praktika-ispolzovaniya">  √úbungsgebrauch </h2><br><h3 id="1-staraytes-opisyvat-vse-vyzovy-v-metode-call">  1. Versuchen Sie, alle Aufrufe in der Aufrufmethode zu beschreiben! </h3><br><p>  Sie sollten nicht jede <em>Aktion in einer</em> separaten Methode implementieren. <em>Dadurch</em> wird der Code aufgebl√§hter.  Sie m√ºssen die gesamte Klasse mehrmals betrachten, um zu verstehen, wie es funktioniert.  Verw√∂hne das Rezept zum Backen eines Kuchens: </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Service</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CookingPieWith</span></span></span><span class="hljs-class"></span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">abbage</span></span></span><span class="hljs-class"> &lt; LunaPark::Interactors::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Sequence</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call!</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">check_products_availability</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">make_cabbage_filler</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">make_pie</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bake</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">check_products_availability</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Services::CheckProductsAvailability</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">list</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ingredients</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># ... end end</span></span></span></span></code> </pre> <br><p>  Verwenden Sie den Aktionsaufruf direkt im Klassenzimmer.  Aus der Sicht von Ruby mag dieser Ansatz ungew√∂hnlich erscheinen, sodass er besser lesbar erscheint: </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DrivingStart</span></span></span><span class="hljs-class"> &lt; LunaPark::Interactors::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Sequence</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call!</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Service::CheckEngine</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Service::StartUpTheIgnition</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">car</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">with</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">key</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Service::ChangeGear</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">car</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">gear_box</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">to</span></span></span><span class="hljs-class">: :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">drive</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Service::StepOnTheGas</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">car</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pedals</span></span></span><span class="hljs-class">[:</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">right</span></span></span><span class="hljs-class">] </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre> <br><h3 id="2-po-vozmozhnosti-ispolzuyte-metod-klassa-call">  2. Verwenden Sie nach M√∂glichkeit die Aufrufklassenmethode </h3><br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment"># good - ,   ,  . #    . Sequence::RingingToPerson.call(params) # good -   ,      e, #    ,     , #    . ring = Sequence::RingingToPerson.new(person) unless ring.success? ring.call sleep 5.min end</span></span></code> </pre><br><h3 id="3-ne-sozdavayte-_funkcionalnye-obekty_-radi-tipizacii-koda-smotrite-po-situacii">  3. Erstellen Sie keine <em>funktionalen Objekte,</em> um den Code einzugeben. Sehen Sie sich die Situation an </h3><br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment"># bad -        ,  #     . module Services class BuildUser &lt; LunaPark::Callable def initialize(first_name:, last_name:, phone:) </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@first</span></span></span><span class="hljs-comment">_name = first_name </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@last</span></span></span><span class="hljs-comment">_name = last_name </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@phone</span></span></span><span class="hljs-comment"> = phone end def call Entity::User.new( first_name: first_name, last_name: last_name, phone: phone ) end private attr_reader :first_name, :last_name, :phone end end module Sequences class RegisteringUser &lt; LunaPark::Interactors::Sequence attr_accessor :first_name, :last_name, :phone def call! user = Service::BuildUser.call(first_name: first_name, last_name: last_name, phone: phone) end end end # good -     ,  . #        , #       . module Sequences class RegisteringUser &lt; LunaPark::Interactors::Sequence attr_accessor :first_name, :last_name, :phone def call! user #... end private def user </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@user</span></span></span><span class="hljs-comment"> = Entity::User.new( first_name: first_name, last_name: last_name, phone: phone ) end end end</span></span></code> </pre> <br><h1 id="servisnyy-sloy-service-layer">  Serviceschicht </h1><br><p><img src="https://habrastorage.org/webt/1-/qv/ip/1-qvipbbxxz2i0cveslcf02b7c0.png" alt="lsd"></p><br><p>  <em>Der</em> Interactor beschreibt, wie gesagt, die Gesch√§ftslogik auf h√∂chstem Niveau.  <em>Die Serviceschicht</em> (Serviceschicht) zeigt bereits die Details der Implementierung funktionaler Anforderungen.  Wenn wir √ºber die Herstellung eines Kuchens sprechen, sagen wir auf der Ebene des Interactor einfach ‚ÄûKnete den Teig‚Äú, ohne auf Einzelheiten dar√ºber einzugehen, wie man ihn knetet.  Der Knetvorgang wird auf <em>Serviceebene beschrieben</em> .  Kehren wir zur urspr√ºnglichen Quelle zur√ºck, dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gro√üen blauen Buch</a> : </p><br><p>  <em>In der angewendeten Dom√§ne gibt es Operationen, die keinen nat√ºrlichen Ort in einem Objekt vom Typ Entit√§t oder Wertobjekt finden k√∂nnen.</em>  <em>Sie sind von Natur aus keine Objekte, sondern Aktivit√§ten.</em>  <em>Da die Grundlage unseres Modellierungsparadigmas jedoch der Objektansatz ist, werden wir versuchen, sie in Objekte umzuwandeln.</em> </p><br><p>  <em>An dieser Stelle ist es leicht, einen h√§ufigen Fehler zu machen: den Versuch aufzugeben, die Operation in einem geeigneten Objekt daf√ºr zu platzieren, und so zur prozeduralen Programmierung zu gelangen.</em>  <em>Wenn Sie jedoch eine Operation mit Gewalt in ein Objekt mit einer ihm fremden Definition einf√ºgen, verliert das Objekt selbst seine Reinheit, was das Verst√§ndnis und die Umgestaltung erschwert.</em>  <em>Wenn Sie viele komplexe Vorg√§nge in einem einfachen Objekt implementieren, kann dies zu einem unverst√§ndlichen Ergebnis f√ºhren. Was Sie tun, ist nicht klar, was.</em>  <em>Solche Operationen betreffen oft andere Objekte des Themenbereichs, und die Koordination zwischen ihnen wird durchgef√ºhrt, um eine gemeinsame Aufgabe auszuf√ºhren.</em>  <em>Zus√§tzliche Verantwortung schafft Abh√§ngigkeitsketten zwischen Objekten und mischt Konzepte, die unabh√§ngig voneinander betrachtet werden k√∂nnen.</em> </p><br><p>  Verwenden Sie bei der Auswahl eines Standorts f√ºr die Implementierung einer Funktion immer den gesunden Menschenverstand.  Ihre Aufgabe ist es, das Modell ausdrucksvoller zu machen.  Schauen wir uns ein Beispiel an: "Wir m√ºssen Holz hacken": </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Entities</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Wood</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">chop</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># ... end end end</span></span></span></span></code> </pre> <br><p>  Diese Methode wird ein Fehler sein.  Brennholz wird sich nicht selbst hacken, wir brauchen eine Axt: </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Entities</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Axe</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">chop</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sacrifice</span></span></span><span class="hljs-class">) </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># ... end end end</span></span></span></span></code> </pre> <br><p>  Wenn wir ein vereinfachtes Gesch√§ftsmodell verwenden, reicht dies aus.  Wenn der Prozess jedoch detaillierter modelliert werden muss, ben√∂tigen wir eine Person, die dieses Brennholz hackt, und m√∂glicherweise ein Protokoll, das als St√§nder f√ºr den Prozess verwendet wird. </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Entities</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Human</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">chop_firewood</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wood</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">axe</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">chock</span></span></span><span class="hljs-class">) </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># ... end end end</span></span></span></span></code> </pre><br><p>  Wie Sie wahrscheinlich bereits vermutet haben, ist dies keine gute Idee.  Nicht alle von uns sind mit dem Schneiden von Holz besch√§ftigt, dies ist keine direkte Pflicht einer Person.  Wir sehen oft, wie √ºberlastet die Modelle in Ruby on Rails sind, die eine √§hnliche Logik enthalten: Rabatte erhalten, Waren in den Warenkorb legen, Geld auf den Kontostand abheben.  Diese Logik gilt nicht f√ºr die Entit√§t, sondern f√ºr den Prozess, an dem diese Entit√§t beteiligt ist. </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Services</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ChopFirewood</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># ... end end</span></span></span></span></code> </pre> <br><p>  Nachdem wir herausgefunden haben, welche Logik wir in den <em>Diensten</em> speichern <em>, werden</em> wir versuchen, eine davon zu implementieren.  In den meisten F√§llen werden Dienste √ºber Methoden oder Funktionsobjekte implementiert. </p><br><h2 id="funkcionalnye-obekty">  Funktionsobjekte </h2><br><p>  Ein Funktionsobjekt erf√ºllt eine Funktionsanforderung.  In seiner primitivsten Form hat ein funktionales Objekt eine einzige √∂ffentliche Methode - den <code>call</code> . </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serivices</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Sum</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">initialize</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">y</span></span></span><span class="hljs-class">) @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">y</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">y</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x</span></span></span><span class="hljs-class"> + </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">y</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">self</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x</span></span></span><span class="hljs-class">,</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">y</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x</span></span></span><span class="hljs-class">,</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">y</span></span></span><span class="hljs-class">).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr_reader</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">y</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre> <br><p>  Solche Objekte haben mehrere Vorteile: Sie sind pr√§zise und sehr einfach zu testen.  Es gibt einen Nachteil, solche Objekte k√∂nnen sich als gro√üe Anzahl herausstellen.  Es gibt verschiedene M√∂glichkeiten, √§hnliche Objekte zu gruppieren. In einem Teil unserer Projekte teilen wir sie nach Typ: </p><br><ul><li>  <em>Serviceobjekt</em> (Service) - Ein Objekt, das ein neues Objekt erstellt. </li><li>  <em>Befehl</em> (Befehl) - √Ñndert das aktuelle Objekt. </li><li>  <em>Guardian</em> (Guard) - Gibt einen Fehler zur√ºck, wenn ein Fehler aufgetreten ist. </li></ul><br><h2 id="servisnyy-obekt-service">  Serviceobjekt </h2><br><p>  In unserer Implementierung implementiert <em>Service</em> - eine funktionale Anforderung und gibt immer einen Wert zur√ºck. </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">KorovaMilkBar</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Services</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FindMilk</span></span></span><span class="hljs-class"> &lt; LunaPark::Callable </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GLASS_SIZE</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Values::Unit</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wrap</span></span></span><span class="hljs-class"> '200</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">g</span></span></span><span class="hljs-class">' </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">initialize</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fridge</span></span></span><span class="hljs-class">:) @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fridge</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fridge</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fridge</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">shelfs</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">find</span></span></span><span class="hljs-class"> { |</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">shelf</span></span></span><span class="hljs-class">| </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">shelf</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">has?</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GLASS_SIZE</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">of</span></span></span><span class="hljs-class">: :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">milk</span></span></span><span class="hljs-class">) } </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr_reader</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fridge</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FindMilk</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fridge</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">the_red_one</span></span></span><span class="hljs-class">) </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># =&gt; #&lt;Glass: ... &gt;</span></span></span></span></code> </pre> <br><h2 id="komanda-command">  Befehl </h2><br><p>  In unserer Implementierung f√ºhrt <em>Command</em> - eine <em>Aktion aus</em> und √§ndert das Objekt, wenn true true zur√ºckgibt.  Tats√§chlich erstellt das <em>Team</em> kein Objekt, sondern √§ndert ein vorhandenes. </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">KorovaMilkBar</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Commands</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FillGlass</span></span></span><span class="hljs-class"> &lt; LunaPark::Callable </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">initialize</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">glass</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">with</span></span></span><span class="hljs-class">:) @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">glass</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">glass</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">content</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">with</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">glass</span></span></span><span class="hljs-class"> &lt;&lt; content </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">true</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr_reader</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fridge</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">glass</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Glass</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">empty</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">milk</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Milk</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class">(200, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">gr</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">glass</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">empty?</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># =&gt; true FillGlass.call glass, with: milk # =&gt; true glass.empty? # =&gt; false</span></span></span></span></code> </pre> <br><h2 id="vahter-guard">  W√§chter (Wache) </h2><br><p>  <em>Der Watchman</em> f√ºhrt eine logische Pr√ºfung durch und gibt im Fehlerfall einen Verarbeitungsfehler aus.  Diese Art von Objekt wirkt sich in keiner Weise auf die <em>Hauptrichtung</em> aus, sondern wechselt in die <em>alternative Richtung,</em> wenn etwas schief geht. </p><br><p>  Beim Servieren von Milch ist darauf zu achten, dass sie frisch ist: </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">KorovaMilkBar</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Guards</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IsFresh</span></span></span><span class="hljs-class"> &lt; LunaPark::Callable </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">initialize</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">product</span></span></span><span class="hljs-class">) @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">products</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">products</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">products</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">each</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">do</span></span></span><span class="hljs-class"> |</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">product</span></span></span><span class="hljs-class">| </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">raise</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Errors::Rotten</span></span></span><span class="hljs-class">, "</span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment">#{product.title} is not fresh" if product.expiration_date &gt; Date.today end nil end private attr_reader :products end end end</span></span></span></span></code> </pre> <br><p>  M√∂glicherweise ist es zweckm√§√üig, Funktionsobjekte nach Typ zu trennen.  Sie k√∂nnen beispielsweise Ihren eigenen <em>Builder</em> hinzuf√ºgen - erstellt ein Objekt basierend auf Parametern. </p><br><h3 id="dogovorennosti-1">  Arrangements </h3><br><ul><li>  Die <code>call</code> ist die einzige obligatorische √∂ffentliche Methode. </li><li>  Die <code>initialize</code> ist die einzige optionale √∂ffentliche Methode. </li><li>  Der Rest der Methoden sollte privat sein. </li><li>  Logische Fehler m√ºssen von der Klasse <code>LunaPark::Errors::Processing</code> geerbt werden. </li></ul><br><h2 id="obrabotka-oshibok-1">  Fehlerbehandlung </h2><br><p>  Es gibt zwei Arten von Fehlern, die w√§hrend der Ausf√ºhrung einer <em>Aktion auftreten k√∂nnen</em> . </p><br><h5 id="oshibki-processa-vypolneniya">  Laufzeitfehler </h5><br><p>  Solche Fehler k√∂nnen infolge einer Verletzung der Verarbeitungslogik auftreten. </p><br><p>  Zum Beispiel: </p><br><ul><li>  beim Erstellen eines Benutzers ist E-Mail reserviert; </li><li>  Wenn Sie versuchen, Milch zu trinken, ist es vorbei. </li><li>  Ein anderer Microservice lehnte die Aktion ab (aus einem logischen Grund und nicht, weil der Service nicht verf√ºgbar ist). </li></ul><br><p>  H√∂chstwahrscheinlich m√∂chte der Benutzer √ºber diese Fehler informiert werden.  Auch das sind wahrscheinlich die Fehler <br>  was wir vorhersehen k√∂nnen. </p><br><p>  Solche Fehler sollten von <code>LunaPark::Errors::Processing</code> geerbt werden </p><br><h5 id="sistemnyy-oshibki">  Systemfehler </h5><br><p>  Fehler, die infolge eines Systemabsturzes aufgetreten sind. </p><br><p>  Zum Beispiel: </p><br><ul><li>  Die Datenbank funktioniert nicht. </li><li>  etwas geteilt durch Null. </li></ul><br><p>  H√∂chstwahrscheinlich k√∂nnen wir diese Fehler nicht vorhersehen und dem Benutzer nichts sagen, au√üer dass alles sehr schlecht ist, und den Entwicklern einen Bericht senden, in dem Ma√ünahmen gefordert werden.  Solche Fehler sollten von <code>SystemError</code> geerbt <code>SystemError</code> </p><br><p>  Es gibt auch <strong>Validierungsfehler</strong> , auf die wir im n√§chsten Artikel n√§her eingehen werden. </p><br><h2 id="praktika-ispolzovaniya-1">  √úbungsgebrauch </h2><br><h3 id="1-ispolzuyte-peremennye-chtoby-povysit-chitaemost">  1. Verwenden Sie Variablen, um die Lesbarkeit zu verbessern </h3><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Fishing</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># bad -   Serivices::Catch.call(fish, rod) # bad -  Serivices::Catch.call(fish: fish, rod: rod) # good -   Serivices::Catch.call(fish, with: rod) module Serivices class Catch def initialize(fish, with:) </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@fish</span></span></span></span><span class="hljs-class"><span class="hljs-comment"> = fish </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@rod</span></span></span></span><span class="hljs-class"><span class="hljs-comment"> = with #      #   . end # ... private attr_reader :fish, :rod end end end</span></span></span></span></code> </pre> <br><h3 id="2-peredavayte-obekty-a-ne-parametry">  2. √úbergeben Sie Objekte, keine Parameter </h3><br><p>  Versuchen Sie, den Initialisierer einfach zu gestalten, wenn die Parameterverarbeitung nicht den Zweck hat. <br>  √úbergeben Sie Objekte, keine Parameter. </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Service</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># bad -        -.  #      ,   . class Foo def initialize(foo_params:, bar_params:) </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@foo</span></span></span></span><span class="hljs-class"><span class="hljs-comment"> = Values::Foo.new(*foo_params) </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@bar</span></span></span></span><span class="hljs-class"><span class="hljs-comment"> = Values::Bar.new(*bar_params) end # ... end Services::Foo.call(foo: {a: 1, b: 2}, bar: 34) # good -   -. class Bar def initialize(foo:, bar:) </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@foo</span></span></span></span><span class="hljs-class"><span class="hljs-comment"> = foo </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@bar</span></span></span></span><span class="hljs-class"><span class="hljs-comment"> = bar # ... end end foo = Values::Foo.new(a: 1, b: 2) bar = Values::Bar.new(34) Services::Bar.call(foo: foo, bar: bar) # good -       - Builder. class BuildFoo def initialize(param_1:, param_2:) </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span></span><span class="hljs-class"><span class="hljs-comment">_1 = param_1 </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span></span><span class="hljs-class"><span class="hljs-comment">_1 = param_1 end def call Foo.new( param_1: param_1.foo, param_2: param_2.bar, param_3: some_magick ) end # ... end end</span></span></span></span></code> </pre> <br><h3 id="3-ispolzuyte-v-nazvanie-deystviya---glagol-deystviya-i-obekt-vozdeystviya">  3. Verwenden Sie den Namen Actions - das Verb der Aktion und das Objekt des Einflusses. </h3><br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment"># bad module Services class Milk; end class Work; end class FooBuild; end class PasswordGenerator; end end # good module Services class GetMilk; end class WorkOnTable; end class BuildFoo; end class GeneratePassword; end end</span></span></code> </pre> <br><h3 id="4-po-vozmozhnosti-ispolzuyte-metod-klassa-call">  4. Verwenden Sie nach M√∂glichkeit die Aufrufklassenmethode </h3><br><p>  Normalerweise eine Instanz der <em>Actions-</em> Klasse, die nur selten zum Schreiben verwendet wird, um einen Anruf zu t√§tigen. </p><br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment"># good -    . Services::BuildFoo.call(params) # good -     Services::BuildFoo.(params) # good -   ,      , #    ,     ,   #  . ring = Services::RingToPhone.new(phone: neighbour) 10.times do ring.call end</span></span></code> </pre> <br><h3 id="5-obrabotka-oshibok-ne-yavlyaetsya-zadachey-servisa">  5. Die Fehlerbehandlung ist keine Serviceaufgabe </h3><br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment"># bad -    ,   . def call #... rescue SystemError =&gt; e return false end</span></span></code> </pre> <br><h2 id="moduli">  Module </h2><br><p>  Bis zu diesem Moment haben wir die Implementierung der <em>Service-Schicht</em> als eine Reihe von Funktionsobjekten betrachtet.  Aber wir k√∂nnen leicht Methoden auf dieser Ebene platzieren: </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Services</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sum</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class"> + </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre> <br><p>  Ein weiteres Problem, mit dem wir konfrontiert sind, ist eine gro√üe Anzahl von Serviceeinrichtungen.  Anstelle des "Rails Fat Model", das wir auf den neuesten Stand gebracht haben, erhalten wir den "Services Fat Folder".  Es gibt verschiedene M√∂glichkeiten, die Struktur zu organisieren, um das Ausma√ü der Trag√∂die zu verringern.  Eric Evans l√∂st dieses Problem, indem er eine Reihe von Funktionen in einer Klasse kombiniert.  Stellen Sie sich vor, wir m√ºssen die Gesch√§ftsprozesse des Kinderm√§dchens Arina Rodionovna modellieren, sie kann Puschkin f√ºttern und ihn ins Bett bringen: </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NoonService</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">initialize</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arina_radionovna</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pushkin</span></span></span><span class="hljs-class">) </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># ... end def to_feed # ... end def to_sleep # ... end end</span></span></span></span></code> </pre> <br><p>  Dieser Ansatz ist aus Sicht von OOP korrekter.  Wir empfehlen jedoch, es zumindest in der Anfangsphase aufzugeben.  Nicht sehr erfahrene Programmierer beginnen in dieser Klasse viel Code zu schreiben, was letztendlich zu einer erh√∂hten Konnektivit√§t f√ºhrt.  Stattdessen k√∂nnen Sie das Modul verwenden, das die Aktivit√§t als eine Abstraktion darstellt: </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Services</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Noon</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ToFeed</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call!</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># ... end end class &lt;&lt; self #    ,   #    def to_feed(arina_radionovna, pushkin) ToFeed.new(arina_radionovna, pushkin).call end #    ,    def to_sleep(arina_radionovna, pushkin) arina_radionovna.tell_story pushkin pushkin.state = :sleep end end end end</span></span></span></span></code> </pre> <br><p>  Bei der Aufteilung in Module sollte eine niedrige externe Kopplung (niedrige Kopplung) mit hoher interner Koh√§sion (hohe Koh√§sion) beobachtet werden. Wir verwenden jedoch Module wie Services oder Interactors. Dies widerspricht auch den Vorstellungen einer reinen Architektur.  Dies ist eine bewusste Entscheidung, die die Wahrnehmung erleichtert.  Unter dem Namen der Datei verstehen wir, welches Entwurfsmuster diese oder jene Klasse implementiert. Wenn dies f√ºr einen erfahrenen Programmierer offensichtlich ist, ist dies f√ºr einen Anf√§nger nicht immer der Fall.  Wenn Ihr Team bereit ist, verwerfen Sie diesen √úberschuss. </p><br><p>  Um einen weiteren kleinen Auszug aus dem gro√üen blauen Buch zu zitieren: </p><br><p>  <em>W√§hlen Sie Module aus, die den Verlauf des Systems beschreiben und zusammenh√§ngende Konzepts√§tze enthalten.</em>  <em>Daraus ergibt sich oft eine geringe Abh√§ngigkeit der Module voneinander.</em>  <em>Ist dies jedoch nicht der Fall, suchen Sie nach einer M√∂glichkeit, das Modell so zu √§ndern, dass die Konzepte voneinander getrennt werden, oder suchen Sie nach dem im Modell fehlenden Konzept, das die Grundlage f√ºr das Modul bilden und die Elemente des Modells auf nat√ºrliche und sinnvolle Weise zusammenf√ºhren k√∂nnte.</em>  <em>Erzielen Sie eine geringe Abh√§ngigkeit der Module voneinander in dem Sinne, dass Konzepte in verschiedenen Modulen unabh√§ngig voneinander analysiert und wahrgenommen werden k√∂nnen.</em>  <em>Verfeinern Sie das Modell, bis darin nat√ºrliche Grenzen gem√§√ü den √ºbergeordneten Konzepten des Themenbereichs angezeigt werden und der entsprechende Code nicht entsprechend unterteilt ist.</em> </p><br><p>  <em>Geben Sie die Modulnamen an, die in der UNIFIED LANGUAGE enthalten sein sollen.</em>  <em>Sowohl die MODULE selbst als auch ihre Namen sollten das Wissen und das Verst√§ndnis des Themenbereichs widerspiegeln.</em> </p><br><p>  Das Thema Module ist gro√ü und interessant, geht aber deutlich √ºber das Thema dieses Artikels hinaus.  N√§chstes Mal werden wir mit Ihnen √ºber <em>Repositories</em> und <em>Adapter</em> sprechen.  Wir haben einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gem√ºtlichen Telegrammkanal er√∂ffnet,</a> in dem wir Materialien zum Thema DDD austauschen m√∂chten.  Wir freuen uns √ºber Ihre Fragen und Ihr Feedback. </p><br><hr><br><div class="spoiler">  <b class="spoiler_title">Inspirationsquellen</b> <div class="spoiler_text"><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://www.netsolutions.com/insights/business-and-functional-requirements-what-is-the-difference-and-why-should-you-care/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">http://magazines.russ.ru/nz/2007/54/gi3.html</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://www.microtool.de/de/knowledge-base/how-use-case-2-0-works/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://www.researchgate.net/publication/220059381_Use_cases_-_Yesterday_today_and_tomorrow</a> </li><li>  Problemorientiertes Design, Eric J. Evans </li></ul></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de454668/">https://habr.com/ru/post/de454668/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de454652/index.html">D√ºsentriebwerk auf einem 3D-Heimdrucker</a></li>
<li><a href="../de454658/index.html">Beauty Gadgets - Ernstes Gesch√§ft</a></li>
<li><a href="../de454662/index.html">Sorgf√§ltiger Umzug in die Niederlande mit seiner Frau und Hypothek. Teil 1: Jobsuche</a></li>
<li><a href="../de454664/index.html">Spielen Sie Tetris in AR</a></li>
<li><a href="../de454666/index.html">Software Defined Radio - wie funktioniert es? Teil 7</a></li>
<li><a href="../de454670/index.html">Die Serie "Tschernobyl": zuschauen und nachdenken</a></li>
<li><a href="../de454672/index.html">Schl√ºssel zum Start: die beste Software und Hardware f√ºr die Computerforensik</a></li>
<li><a href="../de454674/index.html">√úberwachung des armen Mannes oder Server√ºberwachung von der Konsole aus</a></li>
<li><a href="../de454676/index.html">GPS-Uhr auf Arduino</a></li>
<li><a href="../de454678/index.html">Idiomatische GPU-Programmierung in Rust: Emu Library</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>