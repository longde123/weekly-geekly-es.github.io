<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèª‚Äç‚öïÔ∏è üëÇ ‚òùüèæ RASA Chatbot: Parallels Experience ü§∑ üë©üèΩ‚Äçüöí üåâ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A ind√∫stria de chatbot est√° crescendo. No in√≠cio, eram est√∫pidos o suficiente e podiam dialogar com o usu√°rio, liderando e oferecendo poss√≠veis respos...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>RASA Chatbot: Parallels Experience</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/parallels/blog/470754/"><img src="https://habrastorage.org/webt/v-/c5/a0/v-c5a0h7xtstdf2m4u5ivyr1gli.jpeg"><br><br>  A ind√∫stria de chatbot est√° crescendo.  No in√≠cio, eram est√∫pidos o suficiente e podiam dialogar com o usu√°rio, liderando e oferecendo poss√≠veis respostas.  Em seguida, os bots ficaram um pouco mais inteligentes e come√ßaram a exigir entrada de texto do usu√°rio para obter palavras-chave das respostas.  O desenvolvimento do aprendizado de m√°quina levou ao surgimento da capacidade de se comunicar com o bot tamb√©m na voz.  No entanto, a maioria das solu√ß√µes n√£o foi muito longe da mesma constru√ß√£o do gr√°fico de di√°logo e da transi√ß√£o entre seus n√≥s por palavras-chave. <a name="habracut"></a><br><br>  Recentemente, na Parallels, decidimos otimizar v√°rios processos internos e criar um bot para nossas pr√≥prias necessidades como um experimento.  Ap√≥s uma breve pesquisa, decidimos tentar a sorte no projeto de c√≥digo aberto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">RASA</a> .  De acordo com os pr√≥prios desenvolvedores, eles criaram um bot de bate-papo de terceira gera√ß√£o.  Ou seja, esse bot n√£o apenas percorre o gr√°fico de estado, mas √© capaz de salvar e usar o contexto da caixa de di√°logo anterior.  At√© o momento, a melhor ilustra√ß√£o para os bots de bate-papo modernos √© mais ou menos assim: <br><br><img src="https://habrastorage.org/webt/wi/d6/ks/wid6ksu-v47injjfrc2gvccl2uw.png"><br><br>  Ou seja, os bots de bate-papo s√£o apenas um conjunto de regras verificadas para mudar de um ponto no gr√°fico para outro.  Se voc√™ olhar para as solu√ß√µes existentes dos gigantes do mercado, na verdade n√£o h√° nada muito diferente do conjunto de regras l√°.  Grosso modo, esse conjunto se parece com isso: <br><br>  Di√°logo no ponto XXX. <br>  Se o usu√°rio inseriu uma oferta com as palavras ['comprar', 'ingresso'], v√° para o ponto "PERGUNTAR ONDE" <br>  Se o usu√°rio inseriu uma oferta com as palavras ['comprar', 'costeleta'], v√° para o ponto ‚ÄúPERGUNTAR DO QU√ä‚Äù <br><br>  √â imediatamente √≥bvio que √© lixo aqui, se o usu√°rio digitar: "Gostaria de comprar uma passagem para o Porto", ele perguntar√°: "Para onde voc√™ quer ir?"  Para tornar o di√°logo mais humano, voc√™ precisar√° adicionar novas regras sobre o que fazer se houver uma indica√ß√£o do local. <br>  Em seguida, adicione regras sobre o que fazer se houver uma indica√ß√£o do local e hora, e assim por diante. <br><br>  Esse conjunto de regras crescer√° r√°pido o suficiente, mas n√£o √© a pior coisa, todas as maneiras "certas" podem ser descritas, aprimoradas e lambidas. <br><br>  O mais desagrad√°vel √© que uma pessoa √© uma criatura imprevis√≠vel, diferente de um bot, e pode a qualquer momento come√ßar a perguntar completamente diferente.  Ou seja, no momento em que o bot j√° est√° pronto para reservar um bilhete, uma pessoa pode perguntar "a prop√≥sito, e o tempo?"  ou "embora n√£o, eu gostaria de ir no meu carro, quanto tempo demora a estrada?" <br><br>  No entanto, ele pode fazer isso tamb√©m no momento depois de escolher uma cidade, mas antes de escolher um hor√°rio de partida ou mesmo escolher um lugar para onde ele quer ir.  O bot, baseado em m√°quinas de estado, atolar√° e seus pseud√≥podes mec√¢nicos se contorcer√£o tristemente, e o usu√°rio ficar√° frustrado. <br><br>  Aqui voc√™ pode (e deve) usar o aprendizado de m√°quina.  Mas ent√£o surgem novos problemas: por exemplo, se voc√™ usar o treinamento de refor√ßo para prever transi√ß√µes para pontos do gr√°fico, surgir√£o perguntas: onde obter dados para esse treinamento e quem avaliar√° a qualidade das respostas? <br><br>  √â improv√°vel que os usu√°rios concordem em ensinar seu bot e, como mostra a pr√°tica, uma comunidade de usu√°rios pode ensinar um bot de maneira alguma o que voc√™ deseja e o que a sociedade considera decente.  Al√©m disso, o bot no est√°gio inicial responder√° completamente fora do lugar, o que deixar√° os usu√°rios nervosos e n√£o mexer√° com esse suporte em princ√≠pio. <br><br>  Ap√≥s analisar e pensar em todas as defici√™ncias dos bots existentes, os desenvolvedores do RASA tentaram resolver os problemas da seguinte maneira: <br><br><ul><li>  Qualquer entrada do usu√°rio passa pela ‚Äúdetermina√ß√£o da inten√ß√£o‚Äù, ou seja, o texto digitado usando o aprendizado de m√°quina √© mapeado para uma (ou v√°rias) inten√ß√µes.  Al√©m disso, se necess√°rio, as entidades s√£o isoladas do texto e adicionadas √† mem√≥ria do bot. </li><li>  Esse processo √© semelhante a outros bots, com exce√ß√£o do modelo de determina√ß√£o de inten√ß√£o usado. </li><li>  A pr√≥xima a√ß√£o do bot √© prevista usando o aprendizado de m√°quina com base no contexto, ou seja, as a√ß√µes anteriores, inten√ß√µes e status de mem√≥ria do bot. </li><li>  Ao mesmo tempo, n√£o h√° muitos dados necess√°rios para o treinamento inicial, e o bot pode prever bastante qual a√ß√£o executar, mesmo sem exemplos e regras espec√≠ficos. </li></ul><br>  Considere os mecanismos de trabalho com mais detalhes. <br><br><h3>  <font color="#cc0000">RASA NLU</font> </h3><br>  Vamos come√ßar com a primeira baleia na qual o bot repousa.  Este √© um entendimento da linguagem natural, que consiste em duas partes principais: determina√ß√£o da inten√ß√£o e reconhecimento das entidades. <br><br>  <b>Detec√ß√£o de inten√ß√£o</b> <br>  A determina√ß√£o da inten√ß√£o √© baseada em um algoritmo modificado chamado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">StarSpace</a> do Facebook, implementado no Tensorflow.  Nesse caso, n√£o s√£o usados ‚Äã‚Äãmodelos pr√©-treinados de representa√ß√µes vetoriais de palavras, o que permite contornar as limita√ß√µes dessas representa√ß√µes. <br><br>  Por exemplo, determinar a inten√ß√£o nos algoritmos RASA funcionar√° bem para qualquer idioma, bem como com quaisquer palavras espec√≠ficas especificadas nos exemplos de treinamento.  Quando implementada por meio de representa√ß√µes vetoriais pr√©-treinadas como GloVe ou word2vec, a localiza√ß√£o do bot e sua aplica√ß√£o em √°reas altamente especializadas trar√° dor de cabe√ßa suficiente. <br><br>  O algoritmo trabalha com base na vetoriza√ß√£o de senten√ßas atrav√©s de um conjunto de palavras e na compara√ß√£o de sua ‚Äúsimilaridade‚Äù.  Exemplos de inten√ß√µes e inten√ß√µes s√£o convertidos em vetores usando um saco de palavras e alimentados √† entrada das redes neurais correspondentes.  Na sa√≠da da rede neural, um vetor √© obtido para esse conjunto espec√≠fico de palavras (a mesma incorpora√ß√£o). <br><br>  O treinamento ocorre de forma a minimizar a fun√ß√£o de perda na forma da soma das dist√¢ncias aos pares (produtos cosseno ou vetoriais) entre dois vetores semelhantes e k-diferentes.  Assim, ap√≥s o treinamento, um certo vetor ser√° associado a cada inten√ß√£o. <br><br>  Ap√≥s o recebimento da entrada do usu√°rio, a proposta √© similarmente vetorizada e √© executada no modelo treinado.  Depois disso, a dist√¢ncia do vetor resultante a todos os vetores de inten√ß√£o √© calculada.  O resultado √© classificado, destacando as inten√ß√µes mais prov√°veis ‚Äã‚Äãe cortando valores negativos, ou seja, completamente diferentes. <br><br>  Al√©m dos bolos acima, essa abordagem permite distinguir automaticamente mais de uma inten√ß√£o da proposta.  Por exemplo: ‚Äúsim, eu entendi isso.  Mas como posso chegar em casa agora?  Reconhecido como "intent_confirm + intent_how_to_drive", que permite criar di√°logos mais humanos com o bot. <br><br>  A prop√≥sito, antes do treinamento, voc√™ pode criar frases artificiais a partir de exemplos, misturando as existentes para aumentar o n√∫mero de exemplos de treinamento. <br><br><h3>  <font color="#cc0000">Reconhecimento de entidade RASA</font> </h3><br>  A segunda parte do NLU √© a extra√ß√£o de entidades do texto.  Por exemplo, um usu√°rio escreve: "Quero ir a um restaurante chin√™s com dois amigos", o bot deve destacar n√£o apenas a inten√ß√£o, mas tamb√©m os dados correspondentes a ela.  Ou seja, lembre-se de que os pratos do restaurante devem ser chineses e que o n√∫mero de visitantes √© tr√™s. <br><br>  Para isso, √© usada uma abordagem baseada em campos aleat√≥rios condicionais, que j√° foi descrita em algum lugar do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Habr√©</a> , ent√£o n√£o vou repeti-la.  Quem desejar pode ler sobre esse algoritmo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">no site da Stanford</a> . <br><br>  Al√©m disso, observo que voc√™ pode obter entidades a partir de texto com base em modelos, textos (por exemplo, nomes de cidades), al√©m de se conectar a um servi√ßo separado do Facebook Duckling, o que tamb√©m seria interessante escrever sobre algum dia. <br><br><h3>  <font color="#cc0000">Hist√≥rias da RASA</font> </h3><br>  A segunda baleia azul na qual o RASA Core se baseia s√£o as hist√≥rias.  A ess√™ncia geral das hist√≥rias s√£o exemplos de conversas reais com o bot, formatadas como rea√ß√£o √† inten√ß√£o.  Com base nessas hist√≥rias, uma rede neural recorrente (LSTM) √© treinada, que mapeia o hist√≥rico de mensagens anterior para a a√ß√£o desejada.  Isso permite que voc√™ n√£o configure gr√°ficos de di√°logos rigidamente, assim como n√£o determine todos os estados e transi√ß√µes poss√≠veis entre eles. <br><br>  Com um n√∫mero suficiente de exemplos, a rede prever√° adequadamente o pr√≥ximo estado da transi√ß√£o, independentemente da presen√ßa de um exemplo espec√≠fico.  Infelizmente, o n√∫mero exato de hist√≥rias para isso √© desconhecido, e tudo o que pode ser guiado √© a frase dos desenvolvedores: "quanto mais, melhor". <br><br>  Para treinar o sistema, n√£o apenas gravando algumas caixas de di√°logo inventadas, √© poss√≠vel usar o treinamento interativo. <br><br>  Existem duas op√ß√µes: <br>  1. Fa√ßa com que v√°rios engenheiros se envolvam em conversas com o bot, corrigindo previs√µes incorretas, defini√ß√£o incorreta de entidades e se conecte com a√ß√µes de previs√£o de hist√≥rias. <br><br>  2. Salve as conversas no banco de dados e continue usando engenheiros especialmente treinados para examinar as caixas de di√°logo em que o usu√°rio n√£o conseguiu resolver seu problema, ou seja, mudou para uma pessoa, ou o bot admitiu seu desamparo e n√£o conseguiu responder. <br><br>  Para entender o mecanismo das hist√≥rias, √© mais f√°cil analisar um exemplo simples.  Digamos uma reserva de mesa em um restaurante, um exemplo fornecido pelos desenvolvedores na se√ß√£o de exemplos de c√≥digo-fonte.  Primeiro, determinaremos nossas inten√ß√µes e depois faremos algumas hist√≥rias. <br><br>  Inten√ß√µes e seus exemplos: <br><br>  Intent_hello <br><ul><li>  Oi </li><li>  Ol√° </li><li>  Aloha </li><li>  Bom dia </li></ul><br>  ... <br>  Intent_thanks <br><ul><li>  Obrigado </li><li>  Nice </li><li>  Obrigada </li></ul><br>  ... <br>  Intent_request <br><ul><li>  Bye skip </li></ul><br>  Intent_inform <br><ul><li>  Bye skip </li></ul><br>  Em seguida, voc√™ precisa criar a mem√≥ria do bot, ou seja, determinar os slots nos quais o que o usu√°rio exige ser√° gravado.  Defina os slots: <br><br>  cozinha: <br>  tipo: n√£o caracterizado <br>  auto_fill: false <br>  num_people: <br>  tipo: n√£o caracterizado <br>  auto_fill: false <br><br>  E agora mostraremos exemplos (uma pequena parte) para as inten√ß√µes omitidas acima.  Os colchetes nos exemplos s√£o os dados para o treinamento de Ner_CRF, no formato [entidade] (nome da vari√°vel para armazenamento: o que armazenamos). <br><br>  intent_request_restaurant <br><ul><li>  estou procurando um restaurante </li><li>  posso obter comida (sueca) (culin√°ria) para [seis pessoas] (num_people: 6) </li><li>  um restaurante que serve comida do Caribe </li><li>  id como um restaurante </li><li>  estou procurando um restaurante que serve comida [mediterr√¢nea] (culin√°ria) </li></ul><br>  intent_inform <br><ul><li>  [2] (num_people) pessoas </li><li>  para [tr√™s] (num_people: 3) pessoas </li><li>  apenas [um] (num_people: 1) pessoa </li><li>  que tal [asi√°tico oriental] (cozinha) </li><li>  e quanto √† comida (indiana) </li><li>  uh e quanto ao tipo de comida [turca] (culin√°ria) </li><li>  um [portugu√™s] (cozinha) </li></ul><br>  Agora, determinamos a hist√≥ria do caminho principal: <br><br>  * cumprimentar <br>  - utter_greet <br>  * Intent_request <br>  - restaurant_form <br>  - formul√°rio {"nome": "restaurant_form"} <br>  - formul√°rio {"nome": nulo} <br>  - action_book_restaurant <br>  * obrigado <br>  - utter_noworries <br><br>  Esse √© o bot perfeito para um mundo perfeito.  Se o usu√°rio indicou imediatamente todos os dados necess√°rios na primeira frase, uma tabela ser√° reservada.  Por exemplo, ele escreve "eu quero reservar mesa em restaurante espanhol para cinco pessoas".  Nesse caso, num_people ser√° 5 e cuisine - espanhol, o que √© suficiente para o bot para a√ß√µes adicionais na reserva. <br><br>  No entanto, se voc√™ observar os exemplos, poder√° ver que os dados nem sempre est√£o presentes na quantidade necess√°ria e, √†s vezes, nem sequer est√£o.  Portanto, di√°logos n√£o essenciais aparecem. <br><br>  Suponha que n√£o haja dados sobre a cozinha na solicita√ß√£o, ou seja, algo como este di√°logo: <br>  Ol√° <br>  Oi <br>  Quero reservar restaurante para cinco pessoas <br>  ... <br><br>  Para que seja conclu√≠do corretamente, voc√™ precisa determinar o hist√≥rico do seguinte formul√°rio: <br>  * cumprimentar <br>  - utter_greet <br>  * Intent_request <br>  - restaurant_form <br>  - formul√°rio {"nome": "restaurant_form"} <br>  - slot {"request_slot": "num_people"} <br>  - utter_ask_coven <br>  * formul√°rio: informe {"cuisine": "mexican"} <br>  - slot {"cuisine": "mexican"} <br>  - formul√°rio: restaurant_form <br>  ... <br><br>  E a melhor parte √© que, se voc√™ criar hist√≥rias para v√°rias cozinhas, conhecer um desconhecido, o bot prever√° a pr√≥xima a√ß√£o por conta pr√≥pria, embora n√£o tenha muita certeza.  Ao mesmo tempo, se voc√™ criar uma hist√≥ria semelhante, mas onde o slot "cuisine" for preenchido, e n√£o o slot "num_people", o bot n√£o se importar√° absolutamente em que ordem as informa√ß√µes sobre os par√¢metros de reserva da tabela ser√£o fornecidas. <br><br>  H√° duas maneiras de interromper qualquer tentativa de levar um bot do caminho certo: identificar poss√≠veis hist√≥rias para falar "sobre nada" ou todas as tentativas de iniciar uma conversa como essa - para responder que vale a pena voltar aos neg√≥cios. <br><br>  Como nossa empresa est√° no in√≠cio de uma incr√≠vel jornada pelo mundo dos chatbots, existe a chance de haver novos artigos sobre o rake que coletamos e o que fizemos.  Fique atento! <br><br><img src="https://habrastorage.org/webt/23/uz/eq/23uzeqjeu53ummt2ywqdlaiubmi.jpeg"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt470754/">https://habr.com/ru/post/pt470754/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt470742/index.html">Equa√ß√£o de Navier-Stokes e simula√ß√£o de fluidos na CUDA</a></li>
<li><a href="../pt470744/index.html">Matem√°tica revela segredos do feedback de c√©lulas vivas</a></li>
<li><a href="../pt470746/index.html">O Facebook faz da conversa a pr√≥xima interface popular</a></li>
<li><a href="../pt470750/index.html">Amazon pego pegando os melhores produtos</a></li>
<li><a href="../pt470752/index.html">Analisando Pagamentos Wechat</a></li>
<li><a href="../pt470756/index.html">Criando um aplicativo de back-end para o bate-papo online Apollo, Node.js</a></li>
<li><a href="../pt470758/index.html">Vis√£o geral da atividade viral em setembro de 2019</a></li>
<li><a href="../pt470772/index.html">TON: recomenda√ß√µes e melhores pr√°ticas</a></li>
<li><a href="../pt470774/index.html">Novas anota√ß√µes de tipo no Python 3.8 (Protocolo, Final, TypedDict, Literal)</a></li>
<li><a href="../pt470778/index.html">Revis√£o do drive Seagate ST2000DM008: r√°pido "dois" sem pre√ßo excessivo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>