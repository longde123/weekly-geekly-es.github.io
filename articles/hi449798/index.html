<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯСГ ЁЯЩЗ ЁЯзХЁЯП╛ рдПрдХрддрд╛ рдореЗрдВ рдЯреЙрд╡рд░ рд░рдХреНрд╖рд╛ рдмрдирд╛рдирд╛, рднрд╛рдЧ 1 ЁЯЧ╗ тЖкя╕П ЁЯШЬ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдореИрджрд╛рди 


- рдПрдХ рдЯрд╛рдЗрд▓ рдХреНрд╖реЗрддреНрд░ рдмрдирд╛рдирд╛ред 
- рдЪреМрдбрд╝рд╛рдИ-рдкреНрд░рдердо рдЦреЛрдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЦреЛрдЬ рдкрдеред 
- рдЦрд╛рд▓реА рдФрд░ рдЕрдВрдд рдЯрд╛рдЗрд▓, рд╕рд╛рде рд╣реА рджреАрд╡рд╛рд░ рдЯрд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди рдХреЛ рд▓рд╛рдЧреВ рдХрд░реЗрдВред 
- рдЦреЗрд▓ ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдПрдХрддрд╛ рдореЗрдВ рдЯреЙрд╡рд░ рд░рдХреНрд╖рд╛ рдмрдирд╛рдирд╛, рднрд╛рдЧ 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/449798/"><h1>  рдореИрджрд╛рди </h1><br><ul><li>  рдПрдХ рдЯрд╛рдЗрд▓ рдХреНрд╖реЗрддреНрд░ рдмрдирд╛рдирд╛ред </li><li>  рдЪреМрдбрд╝рд╛рдИ-рдкреНрд░рдердо рдЦреЛрдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЦреЛрдЬ рдкрдеред </li><li>  рдЦрд╛рд▓реА рдФрд░ рдЕрдВрдд рдЯрд╛рдЗрд▓, рд╕рд╛рде рд╣реА рджреАрд╡рд╛рд░ рдЯрд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди рдХреЛ рд▓рд╛рдЧреВ рдХрд░реЗрдВред </li><li>  рдЦреЗрд▓ рдореЛрдб рдореЗрдВ рд╕рдВрдкрд╛рджрди рд╕рд╛рдордЧреНрд░реАред </li><li>  рдЧреНрд░рд┐рдб рдХреНрд╖реЗрддреНрд░реЛрдВ рдФрд░ рд░рд╛рд╕реНрддреЛрдВ рдХрд╛ рд╡реИрдХрд▓реНрдкрд┐рдХ рдкреНрд░рджрд░реНрд╢рдиред </li></ul><br>  рдпрд╣ рдПрдХ рд╕рд╛рдзрд╛рд░рдг <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЯреЙрд╡рд░ рд░рдХреНрд╖рд╛</a> рдЦреЗрд▓ рдмрдирд╛рдиреЗ рдкрд░ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдХреА рдПрдХ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХрд╛ рдкрд╣рд▓рд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИред  рдЗрд╕ рднрд╛рдЧ рдореЗрдВ, рд╣рдо рдПрдХ рдЦреЗрд▓ рдореИрджрд╛рди рдмрдирд╛рдиреЗ, рдПрдХ рд░рд╛рд╕реНрддрд╛ рдЦреЛрдЬрдиреЗ рдФрд░ рдЕрдВрддрд┐рдо рдЯрд╛рдЗрд▓ рдФрд░ рджреАрд╡рд╛рд░реЗрдВ рдмрдирд╛рдиреЗ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВрдЧреЗред <br><br>  рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдПрдХрддрд╛ 2018.3.0f2 рдореЗрдВ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c3d/ae4/591/c3dae459169a0a7f0ce240763b91d55c.jpg"></div><br>  <i>рдПрдХ рдЯреЙрд╡рд░ рд░рдХреНрд╖рд╛ рд╢реИрд▓реА рдЯрд╛рдЗрд▓ рдЦреЗрд▓ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рдПрдХ рдХреНрд╖реЗрддреНрд░ред</i> <br><br><h2>  рдЯреЙрд╡рд░ рд░рдХреНрд╖рд╛ рдЦреЗрд▓ </h2><br>  рдЯреЙрд╡рд░ рд░рдХреНрд╖рд╛ рдПрдХ рд╢реИрд▓реА рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЦрд┐рд▓рд╛рдбрд╝реА рдХрд╛ рд▓рдХреНрд╖реНрдп рдЕрдкрдиреЗ рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рддрдХ рджреБрд╢реНрдордиреЛрдВ рдХреА рднреАрдбрд╝ рдХреЛ рдирд╖реНрдЯ рдХрд░рдирд╛ рд╣реИред  рдЦрд┐рд▓рд╛рдбрд╝реА рджреБрд╢реНрдордиреЛрдВ рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЯрд╛рд╡рд░реЛрдВ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд░рдХреЗ рдЕрдкрдиреЗ рд▓рдХреНрд╖реНрдп рдХреЛ рдкреВрд░рд╛ рдХрд░рддрд╛ рд╣реИред  рдЗрд╕ рд╢реИрд▓реА рдореЗрдВ рдмрд╣реБрдд рднрд┐рдиреНрдирддрд╛рдПрдВ рд╣реИрдВред  рд╣рдо рдПрдХ рдЯрд╛рдЗрд▓ рдХреНрд╖реЗрддреНрд░ рдХреЗ рд╕рд╛рде рдПрдХ рдЧреЗрдо рдмрдирд╛рдПрдВрдЧреЗред  рджреБрд╢реНрдорди рдЕрдкрдиреЗ рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ рдХреА рдУрд░ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдЪрд▓реЗ рдЬрд╛рдПрдВрдЧреЗ, рдФрд░ рдЦрд┐рд▓рд╛рдбрд╝реА рдЙрдирдХреЗ рд▓рд┐рдП рдмрд╛рдзрд╛рдПрдВ рдкреИрджрд╛ рдХрд░реЗрдЧрд╛ред <br><a name="habracut"></a><br>  рдореБрдЭреЗ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдЖрдк рдкрд╣рд▓реЗ рд╕реЗ рд╣реА <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╡рд╕реНрддреБрдУрдВ рдХреЗ рдкреНрд░рдмрдВрдзрди</a> рдкрд░ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдХреА рдПрдХ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХрд╛ рдЕрдзреНрдпрдпрди рдХрд░ рдЪреБрдХреЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╣реИрдВ</a> ред <br><br><h3>  рдореИрджрд╛рди </h3><br>  рдЦреЗрд▓ рдХрд╛ рдореИрджрд╛рди рдЦреЗрд▓ рдХрд╛ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣рд┐рд╕реНрд╕рд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЗрд╕реЗ рдкрд╣рд▓реЗ рдмрдирд╛рдПрдВрдЧреЗред  рдпрд╣ рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдШрдЯрдХ <code>GameBoard</code> рд╕рд╛рде рдПрдХ рдЧреЗрдо рдСрдмреНрдЬреЗрдХреНрдЯ рд╣реЛрдЧрд╛, рдЬрд┐рд╕реЗ рдЖрдХрд╛рд░ рдХреЛ рджреЛ рдЖрдпрд╛рдореЛрдВ рдореЗрдВ рд╕реЗрдЯ рдХрд░рдХреЗ рдкреНрд░рд╛рд░рдВрдн рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рд╣рдо <code>Vector2Int</code> рдХреЗ рдореВрд▓реНрдп рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдлрд╝реАрд▓реНрдб рдХреЛ рдХрд┐рд╕реА рднреА рдЖрдХрд╛рд░ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП, рд▓реЗрдХрд┐рди рд╣рдо рдЖрдХрд╛рд░ рдХреЛ рдХрд╣реАрдВ рдФрд░ рдЪреБрдиреЗрдВрдЧреЗ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЗрд╕рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд╛рдорд╛рдиреНрдп <code>Initialize</code> рд╡рд┐рдзрд┐ рдмрдирд╛рдПрдВрдЧреЗред <br><br>  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╣рдо рдПрдХ рдЪрддреБрд░реНрднреБрдЬ рдХреЗ рд╕рд╛рде рдХреНрд╖реЗрддреНрд░ рдХреА рдХрд▓реНрдкрдирд╛ рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рдкреГрдереНрд╡реА рдХреЛ рдирд┐рд░реВрдкрд┐рдд рдХрд░реЗрдЧрд╛ред  рд╣рдо рдлрд╝реАрд▓реНрдб рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рд╕реНрд╡рдпрдВ рдПрдХ рдЪрддреБрд░реНрднреБрдЬ рдирд╣реАрдВ рдмрдирд╛рдПрдВрдЧреЗ, рд▓реЗрдХрд┐рди рдЗрд╕рдореЗрдВ рдПрдХ рдЪрд╛рдЗрд▓реНрдб рдХреНрд╡рд╛рдб рдСрдмреНрдЬреЗрдХреНрдЯ рдЬреЛрдбрд╝реЗрдВрдЧреЗред  рдЖрд░рдВрдн рд╣реЛрдиреЗ рдкрд░, рд╣рдо рдкреГрдереНрд╡реА рдХреЗ XY рдкреИрдорд╛рдиреЗ рдХреЛ рдХреНрд╖реЗрддреНрд░ рдХреЗ рдЖрдХрд╛рд░ рдХреЗ рдмрд░рд╛рдмрд░ рдХрд░ рджреЗрдВрдЧреЗред  рдпрд╣реА рд╣реИ, рдкреНрд░рддреНрдпреЗрдХ рдЯрд╛рдЗрд▓ рдореЗрдВ рдЗрдВрдЬрди рдХреЗ рд▓рд┐рдП рдорд╛рдк рдХреА рдПрдХ рд╡рд░реНрдЧ рдЗрдХрд╛рдИ рдХрд╛ рдЖрдХрд╛рд░ рд╣реЛрдЧрд╛ред <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">GameBoard</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { [SerializeField] Transform ground = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; Vector2Int size; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Initialize</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector2Int size</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.size = size; ground.localScale = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector3(size.x, size.y, <span class="hljs-number"><span class="hljs-number">1f</span></span>); } }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рди рдкрд░ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдЬрдореАрди рдХреНрдпреЛрдВ рд╕реЗрдЯ рдХрд░реЗрдВ?</b> <div class="spoiler_text">  рд╡рд┐рдЪрд╛рд░ рдпрд╣ рд╣реИ рдХрд┐ рдПрдХрддрд╛ рд╕рдВрдкрд╛рджрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЕрдиреБрдХреВрд▓рди рдпреЛрдЧреНрдп рд╕рдм рдХреБрдЫ рдЕрдиреБрдХреНрд░рдорд┐рдд рдЫрд┐рдкреЗ рд╣реБрдП рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реБрд▓рдн рд╣реИред  рдпрд╣ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдХрд┐ рдЗрди рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреЛ рдХреЗрд╡рд▓ рдирд┐рд░реАрдХреНрд╖рдХ рдореЗрдВ рдмрджрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ, рдПрдХрддрд╛ рд╕рдВрдкрд╛рджрдХ рд▓рдЧрд╛рддрд╛рд░ рдПрдХ рд╕рдВрдХрд▓рдХ рдЪреЗрддрд╛рд╡рдиреА рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░реЗрдЧрд╛ рдХрд┐ рдорд╛рди рдХрднреА рдЕрд╕рд╛рдЗрди рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рд╣рдо рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдлрд╝реАрд▓реНрдб рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рди рд╕реЗрдЯ рдХрд░рдХреЗ рдЗрд╕ рдЪреЗрддрд╛рд╡рдиреА рдХреЛ рджрдмрд╛ рд╕рдХрддреЗ рд╣реИрдВред  рдЖрдк <code>null</code> рднреА рдЕрд╕рд╛рдЗрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдореИрдВрдиреЗ рдЗрд╕реЗ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдпрд╣ рджрд┐рдЦрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдпрд╛ рд╣реИ рдХрд┐ рд╣рдо рдмрд╕ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рдХрд┐ рдЬрдореАрди рдХрд╛ рд╕рд╣реА рд╕рдВрджрд░реНрдн рдирд╣реАрдВ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо <code>default</code> рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред </div></div><br>  рдПрдХ рдирдП рджреГрд╢реНрдп рдореЗрдВ рдПрдХ рдлрд╝реАрд▓реНрдб рдСрдмреНрдЬреЗрдХреНрдЯ рдмрдирд╛рдПрдВ рдФрд░ рдПрдХ рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рдПрдХ рдмрдЪреНрдЪрд╛ рдХреНрд╡рд╛рдб рдЬреЛрдбрд╝реЗрдВ рдЬреЛ рдкреГрдереНрд╡реА рдЬреИрд╕рд╛ рджрд┐рдЦрддрд╛ рд╣реИред  рдЪреВрдВрдХрд┐ рд╣рдо рдПрдХ рд╕рд░рд▓ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдЧреЗрдо рдмрдирд╛ рд░рд╣реЗ рд╣реИрдВ, рдПрдХ рд╕рдорд╛рди рд╣рд░реЗ рд░рдВрдЧ рдХреА рд╕рд╛рдордЧреНрд░реА рдкрд░реНрдпрд╛рдкреНрдд рд╣реЛрдЧреАред  X рдЕрдХреНрд╖ рдХреЗ рд╕рд╛рде рдХреНрд╡рд╛рдб 90 ┬░ рдШреБрдорд╛рдПрдБ рддрд╛рдХрд┐ рдпрд╣ XZ рд╡рд┐рдорд╛рди рдкрд░ рд╕реНрдерд┐рдд рд╣реЛред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/db9/9b8/9af/db99b89afcc551541f1f6adbe4816e54.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fa8/f7c/77d/fa8f7c77d6697bca5e3c8823f5adcd86.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f2a/467/015/f2a467015b8eefc8ca956eaec61d50dc.png"></div><br>  <i>рдЦреЗрд▓ рдХрд╛ рдореИрджрд╛рдиред</i> <br><br><div class="spoiler">  <b class="spoiler_title">рдХреНрдпреЛрдВ XY рд╡рд┐рдорд╛рди рдкрд░ рдЦреЗрд▓ рдХреА рд╕реНрдерд┐рддрд┐ рдирд╣реАрдВ рд╣реИ?</b> <div class="spoiler_text">  рдпрджреНрдпрдкрд┐ рдпрд╣ рдЧреЗрдо 2 рдбреА рд╕реНрдкреЗрд╕ рдореЗрдВ рд╣реЛрдЧрд╛, рд╣рдо рдЗрд╕реЗ 3 рдбреА рдореЗрдВ рд░реЗрдВрдбрд░ рдХрд░реЗрдВрдЧреЗ, рдЬрд┐рд╕рдореЗрдВ 3 рдбреА рджреБрд╢реНрдорди рдФрд░ рдПрдХ рдХреИрдорд░рд╛ рд╣реЛрдЧрд╛, рдЬрд┐рд╕реЗ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдмрд┐рдВрджреБ рдХреЗ рд╕рд╛рдкреЗрдХреНрд╖ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  XZ рд╡рд┐рдорд╛рди рдЗрд╕рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИ рдФрд░ рдкрд░рд┐рд╡реЗрд╢ рдкреНрд░рдХрд╛рд╢ рд╡реНрдпрд╡рд╕реНрдерд╛ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдорд╛рдирдХ рд╕реНрдХрд╛рдИрдмреЙрдХреНрд╕ рдЕрднрд┐рд╡рд┐рдиреНрдпрд╛рд╕ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИред </div></div><br><h3>  рдЦреЗрд▓ </h3><br>  рдЕрдЧрд▓рд╛, рдПрдХ <code>Game</code> рдШрдЯрдХ рдмрдирд╛рдПрдВ рдЬреЛ рдкреВрд░реЗ рдЧреЗрдо рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реЛрдЧрд╛ред  рдЗрд╕ рд╕реНрддрд░ рдкрд░, рдЗрд╕рдХрд╛ рдорддрд▓рдм рдпрд╣ рд╣реЛрдЧрд╛ рдХрд┐ рдпрд╣ рдХреНрд╖реЗрддреНрд░ рдХреЛ рд╢реБрд░реВ рдХрд░ рд░рд╣рд╛ рд╣реИред  рд╣рдо рдмрд╕ рдЗрдВрд╕реНрдкреЗрдХреНрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЖрдХрд╛рд░ рдХреЛ рдЕрдиреБрдХреВрд▓рди рдпреЛрдЧреНрдп рдмрдирд╛рддреЗ рд╣реИрдВ рдФрд░ рдШрдЯрдХ рдХреЛ рдЬрд╝рдмреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░рддреЗ рд╣реИрдВ рдЬрдм рд╡рд╣ рдЙрдарддрд╛ рд╣реИред  рдЖрдЗрдП 11 ├Ч 11 рдХреЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЖрдХрд╛рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Game</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { [SerializeField] Vector2Int boardSize = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2Int(<span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>); [SerializeField] GameBoard board = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Awake</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { board.Initialize(boardSize); } }</code> </pre> <br>  рдлрд╝реАрд▓реНрдб рдЖрдХрд╛рд░ рдХреЗрд╡рд▓ рд╕рдХрд╛рд░рд╛рддреНрдордХ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдпрд╣ рдПрдХ рдЯрд╛рдЗрд▓ рдХреЗ рд╕рд╛рде рдПрдХ рдлрд╝реАрд▓реНрдб рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рдХрдо рд╕рдордЭ рдореЗрдВ рдЖрддрд╛ рд╣реИред  рддреЛ рдЪрд▓реЛ рдиреНрдпреВрдирддрдо 2 ├Ч 2 рддрдХ рд╕реАрдорд┐рдд рдХрд░реЗрдВред  рдпрд╣ <code>OnValidate</code> рд╡рд┐рдзрд┐ рдЬреЛрдбрд╝рдХрд░, рдиреНрдпреВрдирддрдо рдореВрд▓реНрдпреЛрдВ рдХреЛ рдЬрдмрд░рди рд╕реАрдорд┐рдд рдХрд░рдиреЗ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnValidate</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (boardSize.x &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>) { boardSize.x = <span class="hljs-number"><span class="hljs-number">2</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (boardSize.y &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>) { boardSize.y = <span class="hljs-number"><span class="hljs-number">2</span></span>; } }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Onvalidate рдХрдм рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ?</b> <div class="spoiler_text">  рдпрджрд┐ рдпрд╣ рдореМрдЬреВрдж рд╣реИ, рддреЛ рдПрдХрддрд╛ рд╕рдВрдкрд╛рджрдХ рдЙрдиреНрд╣реЗрдВ рдмрджрд▓рдиреЗ рдХреЗ рдмрд╛рдж рдШрдЯрдХреЛрдВ рдХреЗ рд▓рд┐рдП рдХрд╣рддрд╛ рд╣реИред  рдЙрдиреНрд╣реЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд░рддреЗ рд╕рдордп рдЙрдиреНрд╣реЗрдВ рдЧреЗрдо рдСрдмреНрдЬреЗрдХреНрдЯ рдореЗрдВ рдЬреЛрдбрд╝рдирд╛, рджреГрд╢реНрдп рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдлрд┐рд░ рд╕реЗ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рд╕рдВрдкрд╛рджрдХ рдореЗрдВ рдмрджрд▓рдиреЗ рдХреЗ рдмрд╛рдж, рд░рджреНрдж / рдкреБрдирдГ рдкреНрд░рдпрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдФрд░ рдШрдЯрдХ рдХреЛ рд░реАрд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рдмрд╛рджред <br><br>  <code>OnValidate</code> рдХреЛрдб рдХрд╛ рдПрдХрдорд╛рддреНрд░ рд╕реНрдерд╛рди рд╣реИ рдЬрд╣рд╛рдВ рдЖрдк рдШрдЯрдХ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝реАрд▓реНрдб рдореЗрдВ рдорд╛рди рдЕрд╕рд╛рдЗрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </div></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7ae/15d/efd/7ae15defd1e838186f922fc30d346b17.png"></div><br>  <i>рдЦреЗрд▓ рд╡рд╕реНрддреБред</i> <br><br>  рдЕрдм, рдЬрдм рдЖрдк рдЧреЗрдо рдореЛрдб рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рд╕рд╣реА рдЖрдХрд╛рд░ рдХреЗ рд╕рд╛рде рдПрдХ рдлрд╝реАрд▓реНрдб рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВрдЧреЗред  рдЦреЗрд▓ рдХреЗ рджреМрд░рд╛рди, рдХреИрдорд░рд╛ рдХреЛ рд╕реНрдерд┐рддрд┐ рджреЗрдВ рддрд╛рдХрд┐ рдкреВрд░рд╛ рдмреЛрд░реНрдб рджрд┐рдЦрд╛рдИ рджреЗ, рдЙрд╕рдХреЗ рдкрд░рд┐рд╡рд░реНрддрди рдШрдЯрдХ рдХреА рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдмрдирд╛рдПрдБ, рдкреНрд▓реЗ рдореЛрдб рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓реЗрдВ рдФрд░ рдШрдЯрдХ рдХреЗ рдореВрд▓реНрдпреЛрдВ рдХреЛ рдЪрд┐рдкрдХрд╛рдПрдБред  рдореВрд▓ рдореЗрдВ 11 ├Ч 11 рдлрд╝реАрд▓реНрдб рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдКрдкрд░ рд╕реЗ рдПрдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рджреГрд╢реНрдп рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдХреИрдорд░реЗ рдХреЛ рд╕реНрдерд┐рддрд┐ (0.10.0) рдореЗрдВ рд░рдЦ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рдПрдХреНрд╕ рдЕрдХреНрд╖ рдХреЗ рд╕рд╛рде 90 ┬░ рдШреБрдорд╛ рд╕рдХрддреЗ рд╣реИрдВред рд╣рдо рдЗрд╕ рдирд┐рд╢реНрдЪрд┐рдд рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдХреИрдорд░рд╛ рдЫреЛрдбрд╝ рджреЗрдВрдЧреЗ, рд▓реЗрдХрд┐рди рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рднрд╡рд┐рд╖реНрдп рдореЗрдВ рдЗрд╕реЗ рдмрджрд▓реЛред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/eb5/45c/421/eb545c421fdca09acf1258a2fac9e183.png"></div><br>  <i>рдореИрджрд╛рди рдкрд░ рдХреИрдорд░рд╛ред</i> <br><br><div class="spoiler">  <b class="spoiler_title">рдШрдЯрдХ рдореВрд▓реНрдпреЛрдВ рдХреЛ рдХреЙрдкреА рдФрд░ рдкреЗрд╕реНрдЯ рдХреИрд╕реЗ рдХрд░реЗрдВ?</b> <div class="spoiler_text">  рдбреНрд░реЙрдк-рдбрд╛рдЙрди рдореЗрдиреВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬреЛ рдШрдЯрдХ рдХреЗ рдКрдкрд░реА рджрд╛рдПрдВ рдХреЛрдиреЗ рдореЗрдВ рдЧрд┐рдпрд░ рдХреЗ рд╕рд╛рде рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рдкрд░ рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИред </div></div><br><h3>  рдкреНрд░реАрдлрд╝реИрдм рдЯрд╛рдЗрд▓ </h3><br>  рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдЪреМрдХреЛрд░ рдЯрд╛рдЗрд▓реЗрдВ рд╣реЛрддреА рд╣реИрдВред  рджреБрд╢реНрдорди рдЯрд╛рдЗрд▓ рд╕реЗ рдЯрд╛рдЗрд▓ рддрдХ, рдХрд┐рдирд╛рд░реЛрдВ рдХреЛ рдкрд╛рд░ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдВрдЧреЗ, рд▓реЗрдХрд┐рди рддрд┐рд░рдЫреЗ рдирд╣реАрдВред  рдЖрдВрджреЛрд▓рди рд╣рдореЗрд╢рд╛ рдирд┐рдХрдЯрддрдо рдЕрдВрдд рдмрд┐рдВрджреБ рдХреА рдУрд░ рдШрдЯрд┐рдд рд╣реЛрдЧрд╛ред  рдЪрд▓реЛ рдПрдХ рддреАрд░ рдХреЗ рд╕рд╛рде рдЯрд╛рдЗрд▓ рдХреЗ рд╕рд╛рде рдЖрдВрджреЛрд▓рди рдХреА рджрд┐рд╢рд╛ рдХрд╛ рд░реЗрдЦрд╛рдВрдХрди рдХрд░рддреЗ рд╣реИрдВред  рдЖрдк <a href="">рдпрд╣рд╛рдБ</a> рддреАрд░ рдмрдирд╛рд╡рдЯ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░ рд╕рдХрддреЗ <a href="">рд╣реИрдВ</a> ред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/tf/l6/os/tfl6oszqhi93v6aqlllrp1yuhli.png"></div><br>  <i>рдПрдХ рдХрд╛рд▓реА рдкреГрд╖реНрдарднреВрдорд┐ рдкрд░ рддреАрд░ред</i> <br><br>  рдЕрдкрдиреЗ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдореЗрдВ рдПрд░реЛ рдЯреЗрдХреНрд╕рдЪрд░ рд░рдЦреЗрдВ рдФрд░ <em>рдЕрд▓реНрдлрд╛ рдЕрд╕ рдЯреНрд░рд╛рдВрд╕рдкреЗрд░реЗрдВрд╕реА</em> рд╡рд┐рдХрд▓реНрдк рдХреЛ рд╕рдХреНрд╖рдо рдХрд░реЗрдВред  рдлрд┐рд░ рддреАрд░ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд╛рдордЧреНрд░реА рдмрдирд╛рдПрдВ, рдЬреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕рд╛рдордЧреНрд░реА рд╣реЛ рд╕рдХрддреА рд╣реИ рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рдХрдЯрдЖрдЙрдЯ рдореЛрдб рдЪреБрдирд╛ рдЧрдпрд╛ рд╣реИ, рдФрд░ рдореБрдЦреНрдп рдмрдирд╛рд╡рдЯ рдХреЗ рд░реВрдк рдореЗрдВ рддреАрд░ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bfb/2d6/56c/bfb2d656c07931b8f59ef11715eee93b.png"></div><br>  <i>рддреАрд░ рд╕рд╛рдордЧреНрд░реАред</i> <br><br><div class="spoiler">  <b class="spoiler_title">рдХрдЯрдЖрдЙрдЯ рд░реЗрдВрдбрд░ рдореЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреНрдпреЛрдВ рдХрд░реЗрдВ?</b> <div class="spoiler_text">  рдпрд╣ рдЖрдкрдХреЛ рдорд╛рдирдХ рдПрдХрддрд╛ рд░реЗрдВрдбрд░рд┐рдВрдЧ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рддреАрд░ рдХреЛ рдЕрд╕реНрдкрд╖реНрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред </div></div><br>  рдЦреЗрд▓ рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдЯрд╛рдЗрд▓ рдХреЛ рдирд┐рд░реВрдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдЧреЗрдо рдСрдмреНрдЬреЗрдХреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред  рдЙрдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдХреЗ рдкрд╛рд╕ рддреАрд░ рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рдЕрдкрдирд╛ рд╕реНрд╡рдпрдВ рдХрд╛ рдХреНрд╡рд╛рдб рд╣реЛрдЧрд╛, рдЬрд┐рд╕ рддрд░рд╣ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдкреГрдереНрд╡реА рдХрд╛ рдПрдХ рдХреНрд╡рд╛рдб рд╣реИред  рд╣рдо рдЙрдирдХреЗ рддреАрд░ рдХреЗ рд▓рд┐рдВрдХ рдХреЗ рд╕рд╛рде GameTile рдШрдЯрдХ рдореЗрдВ рдЯрд╛рдЗрд▓ рднреА рдЬреЛрдбрд╝реЗрдВрдЧреЗред <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">GameTile</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { [SerializeField] Transform arrow = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; }</code> </pre> <br>  рдПрдХ рдЯрд╛рдЗрд▓ рдСрдмреНрдЬреЗрдХреНрдЯ рдмрдирд╛рдПрдВ рдФрд░ рдЗрд╕реЗ рдкреНрд░реАрдлрд╝реИрдм рдореЗрдВ рдмрджрд▓ рджреЗрдВред  рдЯрд╛рдЗрд▓ рдЬрдореАрди рдХреЗ рд╕рд╛рде рдмрд╣ рдЬрд╛рдПрдЧреА, рдЗрд╕рд▓рд┐рдП рдкреНрд░рддрд┐рдкрд╛рджрди рдХрд░рддреЗ рд╕рдордп рдЧрд╣рд░рд╛рдИ рдХреЗ рд╕рд╛рде рд╕рдорд╕реНрдпрд╛рдУрдВ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рддреАрд░ рдХреЛ рдереЛрдбрд╝рд╛ рдКрдкрд░ рдЙрдард╛рдПрдВред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдереЛрдбрд╝рд╛ рдмрд╛рд╣рд░ рдЬрд╝реВрдо рдХрд░реЗрдВ, рддрд╛рдХрд┐ рдЖрд╕рдиреНрди рддреАрд░реЛрдВ рдХреЗ рдмреАрдЪ рдмрд╣реБрдд рдХрдо рдЬрдЧрд╣ рд╣реЛред  0.001 рдХрд╛ Y рдСрдлрд╕реЗрдЯ рдФрд░ 0.8 рдХрд╛ рдПрдХ рдкреИрдорд╛рдирд╛ рдЬреЛ рд╕рднреА рдПрдХреНрд╕рд┐рд╕ рдХреЗ рд▓рд┐рдП рд╕рдорд╛рди рд╣реИред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f12/02b/6d8/f1202b6d8f8f33593bf56ef0d8665537.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/964/1ac/a4b/9641aca4b874f48c3765af10e2c83157.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/df7/7a3/c9f/df77a3c9f539083eab845be6b9c62919.png"></div><br>  <i>рдкреНрд░реАрдлрд╝реИрдм рдЯрд╛рдЗрд▓ред</i> <br><br><div class="spoiler">  <b class="spoiler_title">рдкреНрд░реАрдлрд╝реИрдм рдЯрд╛рдЗрд▓ рдкрджрд╛рдиреБрдХреНрд░рдо рдХрд╣рд╛рдБ рд╣реИ?</b> <div class="spoiler_text">  рдЖрдк рдкреНрд░реАрдлрд╝реИрдм рд╕рдВрдкрд╛рджрди рдореЛрдб рдХреЛ рдкреНрд░реАрдлрд╝реИрдм рдПрд╕реЗрдЯ рдкрд░ рдбрдмрд▓-рдХреНрд▓рд┐рдХ рдХрд░рдХреЗ рдпрд╛ рдкреНрд░реАрдлрд╝реИрдм рдХрд╛ рдЪрдпрди рдХрд░рдХреЗ рдФрд░ рдЗрдВрд╕реНрдкреЗрдХреНрдЯрд░ рдореЗрдВ <em>рдУрдкрди рдкреНрд░реАрдлрд╝реИрдм</em> рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдХреЗ <em>рдЦреЛрд▓ рд╕рдХрддреЗ рд╣реИрдВ</em> ред  рдЖрдк рдЕрдкрдиреЗ рдкрджрд╛рдиреБрдХреНрд░рдо рд╢реАрд░реНрд╖рд▓реЗрдЦ рдХреЗ рдКрдкрд░реА рдмрд╛рдПрдБ рдХреЛрдиреЗ рдореЗрдВ рдПрдХ рддреАрд░ рд╕реЗ рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдХреЗ рдкреНрд░реАрдлрд╝реИрдм рд╕рдВрдкрд╛рджрди рдореЛрдб рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓ рд╕рдХрддреЗ рд╣реИрдВред </div></div><br>  рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЯрд╛рдЗрд▓реНрд╕ рдХреЛ рдЦреБрдж рдЧреЗрдо рдСрдмреНрдЬреЗрдХреНрдЯ рдирд╣реАрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  рдЙрдиреНрд╣реЗрдВ рдХреЗрд╡рд▓ рдХреНрд╖реЗрддреНрд░ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рдЯреНрд░реИрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИред  рд╣рдо рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдХреЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдСрдмреНрдЬреЗрдХреНрдЯ рдкреНрд░рдмрдВрдзрди</a> рд╢реНрд░реГрдВрдЦрд▓рд╛ рдореЗрдВ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЗ рд▓рд┐рдП рдЙрд╕реА рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд▓реЗрдХрд┐рди рдЦреЗрд▓ рдХреА рд╡рд╕реНрддреБрдУрдВ рдХреЗ рд╕рд░рд▓ рдЦреЗрд▓ рдпрд╛ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдХреЗ рд╢реБрд░реБрдЖрддреА рдЪрд░рдгреЛрдВ рдореЗрдВ, рд╣рдо рдХрд╛рдлреА рдЦреБрд╢ рд╣реИрдВред  рдЗрд╕реЗ рднрд╡рд┐рд╖реНрдп рдореЗрдВ рдмрджрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред <br><br><h3>  рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдЯрд╛рдЗрд▓реНрд╕ рд╣реИрдВ </h3><br>  рдЯрд╛рдЗрд▓ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, <code>GameBoard</code> рдЯрд╛рдЗрд▓ <code>GameBoard</code> рд▓рд┐рдВрдХ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред <br><br><pre> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">SerializeField</span></span>] GameTile tilePrefab = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>;</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/363/6c2/044/3636c204442368c58858152a7c3efee2.png"></div><br>  <i>рдкреНрд░реАрдлрд╝реИрдм рдЯрд╛рдЗрд▓ рд╕реЗ рд▓рд┐рдВрдХ рдХрд░реЗрдВред</i> <br><br>  рдлрд┐рд░ рд╡рд╣ рджреЛ рдЧреНрд░рд┐рдб рдЖрдпрд╛рдореЛрдВ рдкрд░ рджреЛрд╣рд░реЗ рд▓реВрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдкрдиреЗ рдЙрджрд╛рд╣рд░рдг рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИред  рд╣рд╛рд▓рд╛рдБрдХрд┐ рдЖрдХрд╛рд░ X рдФрд░ Y рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрдХреНрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╣рдо XZ рд╡рд┐рдорд╛рди рдкрд░ рдЯрд╛рдЗрд▓реЛрдВ рдХреА рд╡реНрдпрд╡рд╕реНрдерд╛ рдХрд░реЗрдВрдЧреЗ, рд╕рд╛рде рд╣реА рд╕рд╛рде рдХреНрд╖реЗрддреНрд░ рднреАред  рдЪреВрдВрдХрд┐ рдХреНрд╖реЗрддреНрд░ рдореВрд▓ рдХреЗ рд╕рд╛рдкреЗрдХреНрд╖ рдХреЗрдВрджреНрд░рд┐рдд рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рдЯрд╛рдЗрд▓ рд╕реНрдерд┐рддрд┐ рдХреЗ рдШрдЯрдХреЛрдВ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдЖрдХрд╛рд░ рдХреЗ рд╢реВрдиреНрдп рд╕реЗ рдПрдХ рдХреЛ рджреЛ рд╕реЗ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ рдПрдХ рдЕрд╕реНрдерд╛рдпреА рдмрд┐рдВрджреБ рд╡рд┐рднрд╛рдЬрди рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдЕрдиреНрдпрдерд╛ рдпрд╣ рдЖрдХрд╛рд░ рдХреЗ рд▓рд┐рдП рднреА рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Initialize</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector2Int size</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.size = size; ground.localScale = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector3(size.x, size.y, <span class="hljs-number"><span class="hljs-number">1f</span></span>); Vector2 offset = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2( (size.x - <span class="hljs-number"><span class="hljs-number">1</span></span>) * <span class="hljs-number"><span class="hljs-number">0.5f</span></span>, (size.y - <span class="hljs-number"><span class="hljs-number">1</span></span>) * <span class="hljs-number"><span class="hljs-number">0.5f</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> y = <span class="hljs-number"><span class="hljs-number">0</span></span>; y &lt; size.y; y++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x &lt; size.x; x++) { GameTile tile = Instantiate(tilePrefab); tile.transform.SetParent(transform, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); tile.transform.localPosition = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector3( x - offset.x, <span class="hljs-number"><span class="hljs-number">0f</span></span>, y - offset.y ); } } }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/391/265/640/391265640fe99dd10be005de76ce93f3.png"></div><br>  <i>рдЯрд╛рдЗрд▓реНрд╕ рдХреЗ рдЙрджрд╛рд╣рд░рдг рдмрдирд╛рдП рдЧрдПред</i> <br><br>  рдмрд╛рдж рдореЗрдВ рд╣рдореЗрдВ рдЗрди рдЯрд╛рдЗрд▓реЛрдВ рддрдХ рдкрд╣реБрдВрдЪ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЙрдиреНрд╣реЗрдВ рдПрдХ рд╕рд░рдгреА рдореЗрдВ рдЯреНрд░реИрдХ рдХрд░реЗрдВрдЧреЗред  рд╣рдореЗрдВ рд╕реВрдЪреА рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЖрд░рдВрднреАрдХрд░рдг рдХреЗ рдмрд╛рдж, рдХреНрд╖реЗрддреНрд░ рдХрд╛ рдЖрдХрд╛рд░ рдирд╣реАрдВ рдмрджрд▓реЗрдЧрд╛ред <br><br><pre> <code class="cs hljs"> GameTile[] tiles; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Initialize</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector2Int size</span></span></span><span class="hljs-function">)</span></span> { тАж tiles = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GameTile[size.x * size.y]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>, y = <span class="hljs-number"><span class="hljs-number">0</span></span>; y &lt; size.y; y++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x &lt; size.x; x++, i++) { GameTile tile = tiles[i] = Instantiate(tilePrefab); тАж } } }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">рдпрд╣ рдЕрд╕рд╛рдЗрдирдореЗрдВрдЯ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ?</b> <div class="spoiler_text">  рдпрд╣ рдПрдХ рд▓рд┐рдВрдХреНрдб рдЕрд╕рд╛рдЗрдирдореЗрдВрдЯ рд╣реИред  рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╣рдо рд╕рд░рдгреА рддрддреНрд╡ рдФрд░ рд╕реНрдерд╛рдиреАрдп рдЪрд░ рджреЛрдиреЛрдВ рдХреЗ рд▓рд┐рдП рдЯрд╛рдЗрд▓ рдХреЗ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдПрдХ рд▓рд┐рдВрдХ рдкреНрд░рджрд╛рди рдХрд░ рд░рд╣реЗ рд╣реИрдВред  рдпреЗ рдСрдкрд░реЗрд╢рди рдиреАрдЪреЗ рджрд┐рдЦрд╛рдП рдЧрдП рдХреЛрдб рдХреЗ рд╕рдорд╛рди рд╣реЛрддреЗ рд╣реИрдВред <br><br><pre> <code class="cs hljs">GameTile t = Instantiate(tilePrefab); tiles[i] = t; GameTile tile = t;</code> </pre> </div></div><br><h2>  рд░рд╛рд╕реНрддрд╛ рдЦреЛрдЬреЛ </h2><br>  рдЗрд╕ рд╕реНрддрд░ рдкрд░, рдкреНрд░рддреНрдпреЗрдХ рдЯрд╛рдЗрд▓ рдореЗрдВ рдПрдХ рддреАрд░ рд╣реЛрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╡реЗ рд╕рднреА рдЬреЗрдб рдЕрдХреНрд╖ рдХреА рд╕рдХрд╛рд░рд╛рддреНрдордХ рджрд┐рд╢рд╛ рдореЗрдВ рдЗрдВрдЧрд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕реЗ рд╣рдо рдЙрддреНрддрд░ рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд░реЗрдВрдЧреЗред  рдЕрдЧрд▓рд╛ рдХрджрдо рдЯрд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП рд╕рд╣реА рджрд┐рд╢рд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдирд╛ рд╣реИред  рд╣рдо рдРрд╕рд╛ рдЙрд╕ рдорд╛рд░реНрдЧ рдХреЛ рдЦреЛрдЬрдХрд░ рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рд╕реЗ рджреБрд╢реНрдордиреЛрдВ рдХреЛ рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ рдкрд░ рдЪрд▓рдирд╛ рдЪрд╛рд╣рд┐рдПред <br><br><h3>  рдЯрд╛рдЗрд▓ рдкрдбрд╝реЛрд╕реА </h3><br>  рд░рд╛рд╕реНрддреЗ рдЯрд╛рдЗрд▓ рд╕реЗ рдЯрд╛рдЗрд▓ рдореЗрдВ рдЙрддреНрддрд░, рдкреВрд░реНрд╡, рджрдХреНрд╖рд┐рдг рдпрд╛ рдкрд╢реНрдЪрд┐рдо рдореЗрдВ рдЬрд╛рддреЗ рд╣реИрдВред  рдЦреЛрдЬ рдХреЛ рд╕рд░рд▓ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдЕрдкрдиреЗ рдЪрд╛рд░ рдкрдбрд╝реЛрд╕рд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП <code>GameTile</code> рдЯреНрд░реИрдХ рд▓рд┐рдВрдХ <code>GameTile</code> ред <br><br><pre> <code class="cs hljs"> GameTile north, east, south, west;</code> </pre> <br>  рдкрдбрд╝реЛрд╕рд┐рдпреЛрдВ рдХреЗ рдмреАрдЪ рд╕рдВрдмрдВрдз рд╕рдордорд┐рдд рд╣реИрдВред  рдпрджрд┐ рдЯрд╛рдЗрд▓ рджреВрд╕рд░реА рдЯрд╛рдЗрд▓ рдХрд╛ рдкреВрд░реНрд╡реА рдкрдбрд╝реЛрд╕реА рд╣реИ, рддреЛ рджреВрд╕рд░рд╛ рдкрд╣рд▓реЗ рдХрд╛ рдкрд╢реНрдЪрд┐рдореА рдкрдбрд╝реЛрд╕реА рд╣реИред  рджреЛ рдЯрд╛рдЗрд▓реЛрдВ рдХреЗ рдмреАрдЪ рдЗрд╕ рд╕рдВрдмрдВрдз рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <code>GameTile</code> рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд╕реНрдереИрддрд┐рдХ рд╡рд┐рдзрд┐ рдЬреЛрдбрд╝реЗрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MakeEastWestNeighbors</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GameTile east, GameTile west</span></span></span><span class="hljs-function">)</span></span> { west.east = east; east.west = west; }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">рдПрдХ рд╕реНрдерд┐рд░ рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреНрдпреЛрдВ рдХрд░реЗрдВ?</b> <div class="spoiler_text">  рд╣рдо рдЗрд╕реЗ рдПрдХ рдПрдХрд▓ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде рдПрдХ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рд╡рд┐рдзрд┐ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рд╣рдо рдЗрд╕реЗ <code>eastTile.MakeEastWestNeighbors(westTile)</code> рдпрд╛ рдРрд╕рд╛ рдХреБрдЫ <code>eastTile.MakeEastWestNeighbors(westTile)</code> ред  рд▓реЗрдХрд┐рди рдЙрди рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдЬрд╣рд╛рдВ рдпрд╣ рд╕реНрдкрд╖реНрдЯ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдХрд┐рд╕ рдЯрд╛рдЗрд▓ рдХреЛ рд╡рд┐рдзрд┐ рдХрд╣рд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рд╕реНрдереИрддрд┐рдХ рддрд░реАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдмреЗрд╣рддрд░ рд╣реИред  рдЙрджрд╛рд╣рд░рдг <code>Vector3</code> рд╡рд░реНрдЧ рдХреА <code>Distance</code> рдФрд░ <code>Dot</code> рд╡рд┐рдзрд┐рдпрд╛рдВ рд╣реИрдВред </div></div><br>  рдПрдХ рдмрд╛рд░ рдХрдиреЗрдХреНрдЯ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рдЗрд╕реЗ рдХрднреА рдирд╣реАрдВ рдмрджрд▓рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдЕрдЧрд░ рдРрд╕рд╛ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╣рдордиреЗ рдХреЛрдб рдореЗрдВ рдЧрд▓рддреА рдХреАред  рдЖрдк рдорд╛рдиреЛрдВ рдХреЛ <code>null</code> рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджреЛрдиреЛрдВ рд▓рд┐рдВрдХ рдХреА рддреБрд▓рдирд╛ рдХрд░рдХреЗ, рдФрд░ рдпрджрд┐ рдпрд╣ рдЧрд▓рдд рд╣реИ, рддреЛ рдПрдХ рддреНрд░реБрдЯрд┐ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдХреЗ рдЖрдк рдЗрд╕реЗ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдЖрдк рдЗрд╕рдХреЗ рд▓рд┐рдП <code>Debug.Assert</code> рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MakeEastWestNeighbors</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GameTile east, GameTile west</span></span></span><span class="hljs-function">)</span></span> { Debug.Assert( west.east == <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; east.west == <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Redefined neighbors!"</span></span> ); west.east = east; east.west = west; }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Debug.Assert рдХреНрдпрд╛ рдХрд░рддрд╛ рд╣реИ?</b> <div class="spoiler_text">  рдпрджрд┐ рдкрд╣рд▓рд╛ рддрд░реНрдХ <code>false</code> , рддреЛ рдпрд╣ рдПрдХ рд╢рд░реНрдд рддреНрд░реБрдЯрд┐ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдпрджрд┐ рдпрд╣ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╣реИ рддреЛ рджреВрд╕рд░реЗ рддрд░реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред  рдРрд╕реА рдХреЙрд▓ рдХреЗрд╡рд▓ рдЯреЗрд╕реНрдЯ рдмрд┐рд▓реНрдб рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрддреА рд╣реИ, рд▓реЗрдХрд┐рди рд░рд┐рд▓реАрдЬрд╝ рдмрд┐рд▓реНрдб рдореЗрдВ рдирд╣реАрдВред  рдЗрд╕рд▓рд┐рдП, рдпрд╣ рд╡рд┐рдХрд╛рд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рджреМрд░рд╛рди рдЪреЗрдХ рдЬреЛрдбрд╝рдиреЗ рдХрд╛ рдПрдХ рдЕрдЪреНрдЫрд╛ рддрд░реАрдХрд╛ рд╣реИ рдЬреЛ рдЕрдВрддрд┐рдо рд░рд┐рд▓реАрдЬ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ред </div></div><br>  рдЙрддреНрддрд░реА рдФрд░ рджрдХреНрд╖рд┐рдгреА рдкрдбрд╝реЛрд╕рд┐рдпреЛрдВ рдХреЗ рдмреАрдЪ рд╕рдВрдмрдВрдз рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рдорд╛рди рд╡рд┐рдзрд┐ рдЬреЛрдбрд╝реЗрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MakeNorthSouthNeighbors</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GameTile north, GameTile south</span></span></span><span class="hljs-function">)</span></span> { Debug.Assert( south.north == <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; north.south == <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Redefined neighbors!"</span></span> ); south.north = north; north.south = south; }</code> </pre> <br>  рд╣рдо <code>GameBoard.Initialize</code> рдореЗрдВ рдЯрд╛рдЗрд▓ рдмрдирд╛рддреЗ рд╕рдордп рдЗрд╕ рд╕рдВрдмрдВрдз рдХреЛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдпрджрд┐ X рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ рд╢реВрдиреНрдп рд╕реЗ рдЕрдзрд┐рдХ рд╣реИ, рддреЛ рд╣рдо рд╡рд░реНрддрдорд╛рди рдФрд░ рдкрд┐рдЫрд▓реА рдЯрд╛рдЗрд▓реЛрдВ рдХреЗ рдмреАрдЪ рдкреВрд░реНрд╡-рдкрд╢реНрдЪрд┐рдо рд╕рдВрдмрдВрдз рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред  рдпрджрд┐ рд╡рд╛рдИ рд╕рдордиреНрд╡рдп рд╢реВрдиреНрдп рд╕реЗ рдЕрдзрд┐рдХ рд╣реИ, рддреЛ рд╣рдо рд╡рд░реНрддрдорд╛рди рдЯрд╛рдЗрд▓ рдФрд░ рдкрд┐рдЫрд▓реА рдкрдВрдХреНрддрд┐ рд╕реЗ рдЯрд╛рдЗрд▓ рдХреЗ рдмреАрдЪ рдЙрддреНрддрд░-рджрдХреНрд╖рд┐рдг рд╕рдВрдмрдВрдз рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>, y = <span class="hljs-number"><span class="hljs-number">0</span></span>; y &lt; size.y; y++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x &lt; size.x; x++, i++) { тАж <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (x &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { GameTile.MakeEastWestNeighbors(tile, tiles[i - <span class="hljs-number"><span class="hljs-number">1</span></span>]); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (y &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { GameTile.MakeNorthSouthNeighbors(tile, tiles[i - size.x]); } } }</code> </pre> <br>  рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдореИрджрд╛рди рдХреЗ рдХрд┐рдирд╛рд░реЛрдВ рдкрд░ рд╕реНрдерд┐рдд рдЯрд╛рдЗрд▓реЛрдВ рдореЗрдВ рдЪрд╛рд░ рдкрдбрд╝реЛрд╕реА рдирд╣реАрдВ рд╣реИрдВред  рдПрдХ рдпрд╛ рджреЛ рдкрдбрд╝реЛрд╕реА рд╕рдВрджрд░реНрдн <code>null</code> рд░рд╣реЗрдВрдЧреЗред <br><br><h3>  рджреВрд░реА рдФрд░ рджрд┐рд╢рд╛ </h3><br>  рд╣рдо рд╕рднреА рджреБрд╢реНрдордиреЛрдВ рдХреЛ рд▓рдЧрд╛рддрд╛рд░ рд░рд╛рд╕реНрддрд╛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗред  рдпрд╣ рдкреНрд░рддрд┐ рдЯрд╛рдЗрд▓ рдХреЗрд╡рд▓ рдПрдХ рдмрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рддрдм рджреБрд╢реНрдорди рдЙрд╕ рдЯрд╛рдЗрд▓ рд╕реЗ рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдВрдЧреЗ рдЬрд┐рд╕рдореЗрдВ рд╡реЗ рд╕реНрдерд┐рдд рд╣реИрдВ рдЬрд╣рд╛рдВ рдЖрдЧреЗ рдмрдврд╝рдирд╛ рд╣реИред  рд╣рдо рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдЕрдЧрд▓реЗ рдкрде рдЯрд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП рдПрдХ рд▓рд┐рдВрдХ рдЬреЛрдбрд╝рдХрд░ <code>GameTile</code> рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░реЗрдВрдЧреЗред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╣рдо рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреА рджреВрд░реА рдХреЛ рднреА рдмрдЪрд╛рдПрдВрдЧреЗ, рджреБрд╢реНрдорди рдХреЛ рдПрдВрдбрдкреЙрдЗрдВрдЯ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЖрдиреЗ рд╡рд╛рд▓реА рдЯрд╛рдЗрд▓реЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрдХреНрдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рджреБрд╢реНрдордиреЛрдВ рдХреЗ рд▓рд┐рдП, рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рдмреЗрдХрд╛рд░ рд╣реИ, рд▓реЗрдХрд┐рди рд╣рдо рдЗрд╕рдХрд╛ рдЗрд╕реНрддреЗрдорд╛рд▓ рд╕рдмрд╕реЗ рдЫреЛрдЯреЗ рд░рд╛рд╕реНрддреЗ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░реЗрдВрдЧреЗред <br><br><pre> <code class="cs hljs"> GameTile north, east, south, west, nextOnPath; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> distance;</code> </pre> <br>  рд╣рд░ рдмрд╛рд░ рдЬрдм рд╣рдо рддрдп рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рд╣рдореЗрдВ рд░рд╛рд╕реНрддреЗ рддрд▓рд╛рд╢рдиреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рдкрде рдбреЗрдЯрд╛ рдХреЛ рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред  рдЬрдм рддрдХ рд░рд╛рд╕реНрддрд╛ рдирд╣реАрдВ рдорд┐рд▓ рдЬрд╛рддрд╛ рд╣реИ, рддрдм рддрдХ рдХреЛрдИ рдЕрдЧрд▓реА рдЯрд╛рдЗрд▓ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ рдФрд░ рджреВрд░реА рдХреЛ рдЕрдирдВрдд рдорд╛рдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рд╣рдо рдЗрд╕реЗ <code>int.MaxValue</code> рдХреЗ рдЕрдзрд┐рдХрддрдо рд╕рдВрднрд╡ рдкреВрд░реНрдгрд╛рдВрдХ рдорд╛рди рдХреЗ рд░реВрдк рдореЗрдВ рдХрд▓реНрдкрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  <code>GameTile</code> рдХреЛ рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд░реАрд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд╛рдорд╛рдиреНрдп <code>ClearPath</code> рд╡рд┐рдзрд┐ рдЬреЛрдбрд╝реЗрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ClearPath</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { distance = <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.MaxValue; nextOnPath = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre> <br>  рдкрде рдХреЗрд╡рд▓ рддрднреА рдЦреЛрдЬреЗ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрдм рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рд╣реЛред  рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЯрд╛рдЗрд▓ рдХреЛ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рдмрдирдирд╛ рдЪрд╛рд╣рд┐рдПред  рдРрд╕реА рдЯрд╛рдЗрд▓ рдореЗрдВ рд╢реВрдиреНрдп рдХреА рджреВрд░реА рд╣реЛрддреА рд╣реИ, рдФрд░ рдЗрд╕рдореЗрдВ рдЕрдВрддрд┐рдо рдЯрд╛рдЗрд▓ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕ рдкрд░ рд░рд╛рд╕реНрддрд╛ рд╕рдорд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИред  рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рдзрд┐ рдЬреЛрдбрд╝реЗрдВ рдЬреЛ рдПрдХ рдЯрд╛рдЗрд▓ рдХреЛ рдПрдХ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рдореЗрдВ рдмрджрд▓ рджреЗрддреА рд╣реИред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BecomeDestination</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { distance = <span class="hljs-number"><span class="hljs-number">0</span></span>; nextOnPath = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre> <br>  рдЕрдВрддрддрдГ, рд╕рднреА рдЯрд╛рдЗрд▓реЗрдВ рдПрдХ рдкрде рдореЗрдВ рдмрджрд▓ рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдП, рдЗрд╕рд▓рд┐рдП рдЙрдирдХреА рджреВрд░реА рдЕрдм рд╕рдорд╛рди рдирд╣реАрдВ рд╣реЛрдЧреАред <code>int.MaxValue</code> ред  рдпрд╣ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдПрдХ рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдорд╛рд░реНрдЧ рд╣реИ рдпрд╛ рдирд╣реАрдВ, рдПрдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдЧреЗрдЯрд░ рдкреНрд░реЙрдкрд░реНрдЯреА рдЬреЛрдбрд╝реЗрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> HasPath =&gt; distance != <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.MaxValue;</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">рдпрд╣ рд╕рдВрдкрддреНрддрд┐ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддреА рд╣реИ?</b> <div class="spoiler_text">  рдпрд╣ рдПрдХ рдЧреЗрдЯрд╡реЗ рд╕рдВрдкрддреНрддрд┐ рдХреЗ рд▓рд┐рдП рдПрдХ рдЫреЛрдЯреА рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдХреЗрд╡рд▓ рдПрдХ рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рд╣реИред  рдпрд╣ рдиреАрдЪреЗ рджрд┐рдЦрд╛рдП рдЧрдП рдХреЛрдб рдХреЗ рд╕рдорд╛рди рд╣реИред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> HasPath { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> distance != <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.MaxValue; } }</code> </pre> <br>  рдПрд░реЛ рдСрдкрд░реЗрдЯрд░ <code>=&gt;</code> рдЙрдкрдпреЛрдЧ рд╡реНрдпрдХреНрддрд┐рдЧрдд рд░реВрдк рд╕реЗ рд╕рдВрдкрддреНрддрд┐рдпреЛрдВ рдХреЗ рдЧреЗрдЯреНрдЯрд░ рдФрд░ рд╕реЗрдЯрд░ рдХреЗ рд▓рд┐рдП рднреА рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рддрд░реАрдХреЛрдВ, рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░реЛрдВ рдФрд░ рдХреБрдЫ рдЕрдиреНрдп рд╕реНрдерд╛рдиреЛрдВ рдХреЗ рдирд┐рдХрд╛рдпреЛрдВ рдХреЗ рд▓рд┐рдПред </div></div><br><h3>  рд╣рдо рдПрдХ рд░рд╛рд╕реНрддрд╛ рдмрдирд╛рддреЗ рд╣реИрдВ </h3><br>  рдпрджрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ рдкрде рдХреЗ рд╕рд╛рде рдПрдХ рдЯрд╛рдЗрд▓ рд╣реИ, рддреЛ рд╣рдо рдЗрд╕реЗ рдЕрдкрдиреЗ рдкрдбрд╝реЛрд╕рд┐рдпреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдХреА рдУрд░ рдмрдврд╝рдиреЗ рджреЗ рд╕рдХрддреЗ рд╣реИрдВред  рдкреНрд░рд╛рд░рдВрдн рдореЗрдВ, рдкрде рдХреЗ рд╕рд╛рде рдПрдХрдорд╛рддреНрд░ рдЯрд╛рдЗрд▓ рдЕрдВрдд рдмрд┐рдВрджреБ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рд╢реВрдиреНрдп рджреВрд░реА рд╕реЗ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рдпрд╣рд╛рдВ рд╕реЗ рдмрдврд╝рд╛рддреЗ рд╣реИрдВ, рджреБрд╢реНрдордиреЛрдВ рдХреЗ рдЖрдВрджреЛрд▓рди рдХреЗ рд╡рд┐рдкрд░реАрдд рджрд┐рд╢рд╛ рдореЗрдВ рдЖрдЧреЗ рдмрдврд╝рддреЗ рд╣реИрдВред  рдпрд╣реА рд╣реИ, рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреЗ рд╕рднреА рддрддреНрдХрд╛рд▓ рдкрдбрд╝реЛрд╕рд┐рдпреЛрдВ рдореЗрдВ 1 рдХреА рджреВрд░реА рд╣реЛрдЧреА, рдФрд░ рдЗрди рдЯрд╛рдЗрд▓реЛрдВ рдХреЗ рд╕рднреА рдкрдбрд╝реЛрд╕рд┐рдпреЛрдВ рдореЗрдВ 2 рдХреА рджреВрд░реА рд╣реЛрдЧреА, рдФрд░ рдЗрд╕реА рддрд░рд╣ред <br><br>  рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЕрдкрдиреЗ рдкрдбрд╝реЛрд╕рд┐рдпреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдХреЗ рд▓рд┐рдП рдкрде рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ <code>GameTile</code> рдЫрд┐рдкреА рд╡рд┐рдзрд┐ рдЬреЛрдбрд╝реЗрдВред  рдкрдбрд╝реЛрд╕реА рдХреА рджреВрд░реА рд╡рд░реНрддрдорд╛рди рдЯрд╛рдЗрд▓ рд╕реЗ рдПрдХ рдЕрдзрд┐рдХ рд╣реИ, рдФрд░ рдкрдбрд╝реЛрд╕реА рдХрд╛ рдорд╛рд░реНрдЧ рд╡рд░реНрддрдорд╛рди рдЯрд╛рдЗрд▓ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИред  рдЗрд╕ рдкрджреНрдзрддрд┐ рдХреЛ рдХреЗрд╡рд▓ рдЙрди рдЯрд╛рдЗрд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдмреБрд▓рд╛рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рдирдХреЗ рдкрд╛рд╕ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдПрдХ рд░рд╛рд╕реНрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЖрдЗрдП рдЗрд╕реЗ рдЬреЛрд░ рд╕реЗ рдЬрд╛рдВрдЪреЗрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GrowPathTo</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GameTile neighbor</span></span></span><span class="hljs-function">)</span></span> { Debug.Assert(HasPath, <span class="hljs-string"><span class="hljs-string">"No path!"</span></span>); neighbor.distance = distance + <span class="hljs-number"><span class="hljs-number">1</span></span>; neighbor.nextOnPath = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; }</code> </pre> <br>  рд╡рд┐рдЪрд╛рд░ рдпрд╣ рд╣реИ рдХрд┐ рд╣рдо рдЗрд╕ рд╡рд┐рдзрд┐ рдХреЛ рдЯрд╛рдЗрд▓ рдХреЗ рдЪрд╛рд░ рдкрдбрд╝реЛрд╕рд┐рдпреЛрдВ рдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдХреЗ рд▓рд┐рдП рдПрдХ рдмрд╛рд░ рдХрд╣рддреЗ рд╣реИрдВред  рдЪреВрдВрдХрд┐ рдЗрдирдореЗрдВ рд╕реЗ рдХреБрдЫ рд▓рд┐рдВрдХ <code>null</code> , рд╣рдо рдЗрд╕рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВрдЧреЗ рдФрд░ рдирд┐рд╖реНрдкрд╛рджрди рд░реЛрдХ рджреЗрдВрдЧреЗ, рдпрджрд┐ рдРрд╕рд╛ рд╣реИ рддреЛред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЕрдЧрд░ рдкрдбрд╝реЛрд╕реА рдХреЗ рдкрд╛рд╕ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдПрдХ рд░рд╛рд╕реНрддрд╛ рд╣реИ, рддреЛ рд╣рдореЗрдВ рдХреБрдЫ рднреА рдирд╣реАрдВ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рдЗрд╕реЗ рдХрд░рдирд╛ рднреА рдмрдВрдж рдХрд░ рджреЗрдирд╛ рдЪрд╛рд╣рд┐рдПред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GrowPathTo</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GameTile neighbor</span></span></span><span class="hljs-function">)</span></span> { Debug.Assert(HasPath, <span class="hljs-string"><span class="hljs-string">"No path!"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (neighbor == <span class="hljs-literal"><span class="hljs-literal">null</span></span> || neighbor.HasPath) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } neighbor.distance = distance + <span class="hljs-number"><span class="hljs-number">1</span></span>; neighbor.nextOnPath = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; }</code> </pre> <br>  рдЬрд┐рд╕ рддрд░рд╣ рд╕реЗ <code>GameTile</code> рдЕрдкрдиреЗ рдкрдбрд╝реЛрд╕рд┐рдпреЛрдВ рдХреЛ рдЯреНрд░реИрдХ рдХрд░рддрд╛ рд╣реИ рд╡рд╣ рдмрд╛рдХреА рдХреЛрдб рдХреЗ рд▓рд┐рдП рдЕрдЬреНрдЮрд╛рдд рд╣реИред  рдЗрд╕рд▓рд┐рдП, <code>GrowPathTo</code> рдЫрд┐рдкрд╛ рд╣реБрдЖ рд╣реИред  рд╣рдо рд╕рд╛рдорд╛рдиреНрдп рддрд░реАрдХреЛрдВ рдХреЛ рдЬреЛрдбрд╝реЗрдВрдЧреЗ рдЬреЛ рдЯрд╛рдЗрд▓ рдХреЛ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рджрд┐рд╢рд╛ рдореЗрдВ рдЕрдкрдиреЗ рдкрде рдХреЛ рдмрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рддреЗ рд╣реИрдВ, рдЕрдкреНрд░рддреНрдпрдХреНрд╖ рд░реВрдк рд╕реЗ <code>GrowPathTo</code> ред  рд▓реЗрдХрд┐рди рдХреЛрдб рдЬреЛ рдкреВрд░реЗ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдЦреЛрдЬ рдХрд░рддрд╛ рд╣реИ, рдЙрд╕реЗ рдЯреНрд░реИрдХ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдХрд┐рд╕ рдЯрд╛рдЗрд▓ рдХрд╛ рджреМрд░рд╛ рдХрд┐рдпрд╛ рдЧрдпрд╛ред  рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдирд┐рд╖реНрдкрд╛рджрди рд╕рдорд╛рдкреНрдд рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╣рдо рдЗрд╕реЗ рдПрдХ рдкрдбрд╝реЛрд╕реА рдпрд╛ <code>null</code> рд╡рд╛рдкрд╕ рдХрд░ рджреЗрдВрдЧреЗред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-function">GameTile </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GrowPathTo</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GameTile neighbor</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!HasPath || neighbor == <span class="hljs-literal"><span class="hljs-literal">null</span></span> || neighbor.HasPath) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } neighbor.distance = distance + <span class="hljs-number"><span class="hljs-number">1</span></span>; neighbor.nextOnPath = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> neighbor; }</code> </pre> <br>  рдЕрдм рд╡рд┐рд╢рд┐рд╖реНрдЯ рджрд┐рд╢рд╛рдУрдВ рдореЗрдВ рдмрдврд╝рддреЗ рд░рд╛рд╕реНрддреЛрдВ рдХреЗ рд▓рд┐рдП рддрд░реАрдХреЗ рдЬреЛрдбрд╝реЗрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> GameTile </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GrowPathNorth</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; GrowPathTo(north); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> GameTile </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GrowPathEast</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; GrowPathTo(east); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> GameTile </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GrowPathSouth</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; GrowPathTo(south); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> GameTile </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GrowPathWest</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; GrowPathTo(west);</code> </pre> <br><h3>  рд╡реНрдпрд╛рдкрдХ рдЦреЛрдЬ </h3><br>  <code>GameBoard</code> рдХреЛ <code>GameBoard</code> рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рд╕рднреА рдЯрд╛рдЗрд▓реЛрдВ рдореЗрдВ рд╕рд╣реА рдкрде рдбреЗрдЯрд╛ рд╣реЛред  рд╣рдо рдПрдХ рдЪреМрдбрд╝рд╛рдИ-рдкреНрд░рдердо рдЦреЛрдЬ рдХрд░рдХреЗ рдРрд╕рд╛ рдХрд░рддреЗ рд╣реИрдВред  рдЖрдЗрдП рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рдЯрд╛рдЗрд▓ рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рдХрд░реЗрдВ, рдФрд░ рдлрд┐рд░ рдЕрдкрдиреЗ рдкрдбрд╝реЛрд╕рд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП, рдлрд┐рд░ рдЗрди рдЯрд╛рдЗрд▓реЛрдВ рдХреЗ рдкрдбрд╝реЛрд╕рд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП, рдФрд░ рдЗрд╕реА рддрд░рд╣ рд╕реЗ рдЖрдЧреЗ рдмрдврд╝реЗрдВред  рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рдг рдХреЗ рд╕рд╛рде, рджреВрд░реА рдПрдХ рд╕реЗ рдмрдврд╝ рдЬрд╛рддреА рд╣реИ, рдФрд░ рдкрд╣рд▓реЗ рд╕реЗ рдкрде рд╡рд╛рд▓реЗ рдЯрд╛рдЗрд▓реЛрдВ рдХреА рджрд┐рд╢рд╛ рдореЗрдВ рд░рд╛рд╕реНрддреЗ рдХрднреА рдирд╣реАрдВ рдмрдврд╝рддреЗ рд╣реИрдВред  рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рд╕рднреА рдЯрд╛рдЗрд▓реЗрдВ рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреЗ рд╕рдмрд╕реЗ рдЫреЛрдЯреЗ рд░рд╛рд╕реНрддреЗ рдХреЗ рд╕рд╛рде рдЗрдВрдЧрд┐рдд рдХрд░реЗрдВрдЧреАред <br><br><div class="spoiler">  <b class="spoiler_title">A * рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд░рд╛рд╕реНрддрд╛ рдЦреЛрдЬрдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреНрдпрд╛?</b> <div class="spoiler_text">  рдП <sup>*</sup> рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдЪреМрдбрд╝рд╛рдИ-рдкреНрд░рдердо рдЦреЛрдЬ рдХрд╛ рд╡рд┐рдХрд╛рд╕рд╡рд╛рджреА рд╡рд┐рдХрд╛рд╕ рд╣реИред  рдпрд╣ рдЙрдкрдпреЛрдЧреА рд╣реИ рдЬрдм рд╣рдо рдПрдХрдорд╛рддреНрд░ рд╕рдмрд╕реЗ рдЫреЛрдЯреЗ рдорд╛рд░реНрдЧ рдХреА рддрд▓рд╛рд╢ рдХрд░ рд░рд╣реЗ рд╣реИрдВред  рд▓реЗрдХрд┐рди рд╣рдореЗрдВ рд╕рднреА рдЫреЛрдЯреЗ рд░рд╛рд╕реНрддреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП A <sup>*</sup> рдХреЛрдИ рд▓рд╛рдн рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИред  рдПрдиреАрдореЗрд╢рди рдХреЗ рд╕рд╛рде рд╣реЗрдХреНрд╕рд╛рдЧреЛрдиреНрд╕ рдХреА рдПрдХ рдЧреНрд░рд┐рдб рдкрд░ рдЪреМрдбрд╝рд╛рдИ-рдкрд╣рд▓реА рдЦреЛрдЬ рдФрд░ рдП <sup>*</sup> рдХреЗ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╣реЗрдХреНрд╕рд╛рдЧреЛрдиреНрд╕ рдХреЗ рдирдХреНрд╢реЗ рдХреЗ</a> рдмрд╛рд░реЗ рдореЗрдВ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдХреА рд╢реНрд░реГрдВрдЦрд▓рд╛ рджреЗрдЦреЗрдВред </div></div><br>  рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдЙрди рдЯрд╛рдЗрд▓реЛрдВ рдХреЛ рдЯреНрд░реИрдХ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдЬрд┐рдиреНрд╣реЗрдВ рд╣рдордиреЗ рдкрде рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдерд╛, рд▓реЗрдХрд┐рди рдЬрд┐рдирд╕реЗ рд╣рдордиреЗ рдЕрднреА рддрдХ рдкрде рдирд╣реАрдВ рдмрдирд╛рдпрд╛ рд╣реИред  рдЯрд╛рдЗрд▓реНрд╕ рдХреЗ рдЗрд╕ рд╕рдВрдЧреНрд░рд╣ рдХреЛ рдЕрдХреНрд╕рд░ рдЦреЛрдЬ рд╕реАрдорд╛ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред  рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рдЯрд╛рдЗрд▓реНрд╕ рдХреЛ рдЙрд╕реА рдХреНрд░рдо рдореЗрдВ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЙрдиреНрд╣реЗрдВ рд╕реАрдорд╛ рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЖрдЗрдП <code>Queue</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред  рдмрд╛рдж рдореЗрдВ рд╣рдореЗрдВ рдХрдИ рдмрд╛рд░ рдЦреЛрдЬ рдХрд░рдиреА рд╣реЛрдЧреА, рддреЛ рдЪрд▓рд┐рдП рдЗрд╕реЗ <code>GameBoard</code> рдХреЗ рдХреНрд╖реЗрддреНрд░ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВред <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">GameBoard</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { тАж Queue&lt;GameTile&gt; searchFrontier = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Queue&lt;GameTile&gt;(); тАж }</code> </pre> <br>  рдЦреЗрд▓ рдХреЗ рдореИрджрд╛рди рдХреА рд╕реНрдерд┐рддрд┐ рд╣рдореЗрд╢рд╛ рд╕рдЪ рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ <code>Initialize</code> рдХреЗ рдЕрдВрдд рдореЗрдВ рдорд╛рд░реНрдЧ рдЦреЛрдЬрдиреЗ рд╣реЛрдВрдЧреЗ, рд▓реЗрдХрд┐рди рдХреЛрдб рдХреЛ рдПрдХ рдЕрд▓рдЧ <code>FindPaths</code> рд╡рд┐рдзрд┐ рдореЗрдВ <code>FindPaths</code> ред  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЖрдкрдХреЛ рд╕рднреА рдЯрд╛рдЗрд▓реЛрдВ рдХрд╛ рд░рд╛рд╕реНрддрд╛ рд╕рд╛рдл рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдлрд┐рд░ рдПрдХ рдЯрд╛рдЗрд▓ рдХреЛ рдЕрдВрдд рдмрд┐рдВрджреБ рдмрдирд╛рдПрдВ рдФрд░ рдЗрд╕реЗ рд╕реАрдорд╛ рдореЗрдВ рдЬреЛрдбрд╝реЗрдВред  рдЪрд▓реЛ рдкрд╣рд▓реЗ рдкрд╣рд▓реА рдЯрд╛рдЗрд▓ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВред  рдЪреВрдВрдХрд┐ <code>tiles</code> рдПрдХ рд╕рд░рдгреА рд╣реИ, рд╣рдо рдореЗрдореЛрд░реА рдкреНрд░рджреВрд╖рдг рдХреЗ рдбрд░ рдХреЗ рдмрд┐рдирд╛ <code>foreach</code> рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдЕрдЧрд░ рд╣рдо рдмрд╛рдж рдореЗрдВ рдХрд┐рд╕реА рдПрд░реЗ рд╕реЗ рд╕реВрдЪреА рдореЗрдВ рдЪрд▓реЗ рдЬрд╛рддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рд▓реВрдк рдХреЗ рд╕рд╛рде <code>foreach</code> рд▓реВрдк рдХреЛ рднреА рдмрджрд▓рдирд╛ рд╣реЛрдЧрд╛ред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Initialize</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector2Int size</span></span></span><span class="hljs-function">)</span></span> { тАж FindPaths(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FindPaths</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (GameTile tile <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tiles) { tile.ClearPath(); } tiles[<span class="hljs-number"><span class="hljs-number">0</span></span>].BecomeDestination(); searchFrontier.Enqueue(tiles[<span class="hljs-number"><span class="hljs-number">0</span></span>]); }</code> </pre> <br>  рдЕрдЧрд▓рд╛, рд╣рдореЗрдВ рд╕реАрдорд╛ рд╕реЗ рдПрдХ рдЯрд╛рдЗрд▓ рд▓реЗрдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИ рдФрд░ рдЕрдкрдиреЗ рд╕рднреА рдкрдбрд╝реЛрд╕рд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдкрде рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдирд╛ рд╣реИ, рдЙрди рд╕рднреА рдХреЛ рд╕реАрдорд╛ рдореЗрдВ рдЬреЛрдбрд╝рдирд╛ рд╣реИред  рдкрд╣рд▓реЗ рд╣рдо рдЙрддреНрддрд░, рдлрд┐рд░ рдкреВрд░реНрд╡, рджрдХреНрд╖рд┐рдг рдФрд░ рдЕрдВрдд рдореЗрдВ рдкрд╢реНрдЪрд┐рдо рдХреА рдУрд░ рдмрдврд╝реЗрдВрдЧреЗред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FindPaths</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (GameTile tile <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tiles) { tile.ClearPath(); } tiles[<span class="hljs-number"><span class="hljs-number">0</span></span>].BecomeDestination(); searchFrontier.Enqueue(tiles[<span class="hljs-number"><span class="hljs-number">0</span></span>]); GameTile tile = searchFrontier.Dequeue(); searchFrontier.Enqueue(tile.GrowPathNorth()); searchFrontier.Enqueue(tile.GrowPathEast()); searchFrontier.Enqueue(tile.GrowPathSouth()); searchFrontier.Enqueue(tile.GrowPathWest()); }</code> </pre> <br>  рд╣рдо рдЗрд╕ рдЪрд░рдг рдХреЛ рджреЛрд╣рд░рд╛рддреЗ рд╣реИрдВ, рдЬрдмрдХрд┐ рд╕реАрдорд╛ рдореЗрдВ рдЯрд╛рдЗрд▓реЗрдВ рд╣реИрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (searchFrontier.Count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { GameTile tile = searchFrontier.Dequeue(); searchFrontier.Enqueue(tile.GrowPathNorth()); searchFrontier.Enqueue(tile.GrowPathEast()); searchFrontier.Enqueue(tile.GrowPathSouth()); searchFrontier.Enqueue(tile.GrowPathWest()); }</code> </pre> <br>  рдПрдХ рдкрде рдмрдврд╝рддреЗ рд╣реБрдП рд╣рдореЗрд╢рд╛ рд╣рдореЗрдВ рдПрдХ рдирдИ рдЯрд╛рдЗрд▓ рддрдХ рдирд╣реАрдВ рд▓реЗ рдЬрд╛рддрд╛ рд╣реИред  рдХрддрд╛рд░ рдореЗрдВ рдЬреЛрдбрд╝рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рд╣рдореЗрдВ <code>null</code> рд▓рд┐рдП рдорд╛рди рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╣рдо рдХрддрд╛рд░ рд╕реЗ рдЖрдЙрдЯрдкреБрдЯ рдХреЗ рдмрд╛рдж рддрдХ <code>null</code> рд▓рд┐рдП рдЪреЗрдХ рдХреЛ рд╕реНрдердЧрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><pre> <code class="cs hljs"> GameTile tile = searchFrontier.Dequeue(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tile != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { searchFrontier.Enqueue(tile.GrowPathNorth()); searchFrontier.Enqueue(tile.GrowPathEast()); searchFrontier.Enqueue(tile.GrowPathSouth()); searchFrontier.Enqueue(tile.GrowPathWest()); }</code> </pre> <br><h3>  рдкрде рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░реЗрдВ </h3><br>  рдЕрдм рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ рдлрд╝реАрд▓реНрдб рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╕рд╣реА рд░рд╛рд╕реНрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЕрднреА рддрдХ рд╣рдореЗрдВ рдпрд╣ рджрд┐рдЦрд╛рдИ рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИред  рдЖрдкрдХреЛ рддреАрд░реЛрдВ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╡реЗ рдЕрдкрдиреА рдЯрд╛рдЗрд▓реЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрде рдХреЗ рд╕рд╛рде рдЗрдВрдЧрд┐рдд рдХрд░реЗрдВред  рдпрд╣ рдЙрдиреНрд╣реЗрдВ рдореЛрдбрд╝рдХрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдЪреВрдВрдХрд┐ рдпреЗ рдореЛрдбрд╝ рд╣рдореЗрд╢рд╛ рд╕рдорд╛рди рд╣реЛрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдкреНрд░рддреНрдпреЗрдХ рджрд┐рд╢рд╛рдУрдВ рдХреЗ рд▓рд┐рдП <code>GameTile</code> рдПрдХ рд╕реНрдерд┐рд░ <code>Quaternion</code> рдлрд╝реАрд▓реНрдб рдореЗрдВ <code>GameTile</code> ред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Quaternion northRotation = Quaternion.Euler(<span class="hljs-number"><span class="hljs-number">90f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>), eastRotation = Quaternion.Euler(<span class="hljs-number"><span class="hljs-number">90f</span></span>, <span class="hljs-number"><span class="hljs-number">90f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>), southRotation = Quaternion.Euler(<span class="hljs-number"><span class="hljs-number">90f</span></span>, <span class="hljs-number"><span class="hljs-number">180f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>), westRotation = Quaternion.Euler(<span class="hljs-number"><span class="hljs-number">90f</span></span>, <span class="hljs-number"><span class="hljs-number">270f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>);</code> </pre> <br>  рд╕рд╛рдорд╛рдиреНрдп <code>ShowPath</code> рд╡рд┐рдзрд┐ рднреА рдЬреЛрдбрд╝реЗрдВред  рдпрджрд┐ рджреВрд░реА рд╢реВрдиреНрдп рд╣реИ, рддреЛ рдЯрд╛рдЗрд▓ рдЕрдВрдд рдмрд┐рдВрджреБ рд╣реИ рдФрд░ рдЗрдВрдЧрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рднреА рдирд╣реАрдВ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕рдХреЗ рддреАрд░ рдХреЛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдХрд░реЗрдВред  рдЕрдиреНрдпрдерд╛, рддреАрд░ рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░реЗрдВ рдФрд░ рдЗрд╕рдХреЗ рд░реЛрдЯреЗрд╢рди рдХреЛ рд╕реЗрдЯ рдХрд░реЗрдВред  рдЕрдЧрд▓реЗ рджрд┐рд╢рд╛ рдХреЛ рдЕрдкрдиреЗ рдкрдбрд╝реЛрд╕рд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдХрд░рдХреЗ рд╡рд╛рдВрдЫрд┐рдд рджрд┐рд╢рд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ShowPath</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (distance == <span class="hljs-number"><span class="hljs-number">0</span></span>) { arrow.gameObject.SetActive(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } arrow.gameObject.SetActive(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); arrow.localRotation = nextOnPath == north ? northRotation : nextOnPath == east ? eastRotation : nextOnPath == south ? southRotation : westRotation; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рднреА рдЯрд╛рдЗрд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдЗрд╕ рд╡рд┐рдзрд┐ рдХреЛ рдЕрдВрдд рдореЗрдВ рдХреЙрд▓ рдХрд░реЗрдВ </font></font><code>GameBoard.FindPaths</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FindPaths</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { тАж <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (GameTile tile <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tiles) { tile.ShowPath(); } }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b2d/4fe/4d5/b2d4fe4d511b4e729910ea78b267f268.png" width="230" height="230"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд░рд╛рд╕реНрддреЗ рдорд┐рд▓ рдЧрдПред</font></font></i> <br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреНрдпреЛрдВ рди рд╣рдо рддреАрд░ рдХреЛ рд╕реАрдзреЗ GrowPathTo рдореЗрдВ рдмрджрд▓ рджреЗрдВ?</font></font></b> <div class="spoiler_text">      .     .    ,          <code>FindPaths</code> . </div></div><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЦреЛрдЬ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдмрджрд▓реЗрдВ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рдкрддрд╛ рдЪрд▓рд╛ рд╣реИ рдХрд┐ рдЬрдм рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ рджрдХреНрд╖рд┐рдг-рдкрд╢реНрдЪрд┐рдо рдХреЛрдирд╛ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╕рднреА рд░рд╛рд╕реНрддреЗ рдареАрдХ рдкрд╢реНрдЪрд┐рдо рддрдХ рдЬрд╛рддреЗ рд╣реИрдВ рдЬрдм рддрдХ рдХрд┐ рд╡реЗ рдореИрджрд╛рди рдХреЗ рдХрд┐рдирд╛рд░реЗ рддрдХ рдирд╣реАрдВ рдкрд╣реБрдВрдЪ рдЬрд╛рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рд╡реЗ рджрдХреНрд╖рд┐рдг рдХреА рдУрд░ рдореБрдбрд╝ рдЬрд╛рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдпрд╣рд╛рдВ рд╕рдм рдХреБрдЫ рд╕рдЪ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЕрдВрдд рдмрд┐рдВрджреБ рдкрд░ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдХреЛрдИ рдЫреЛрдЯреЗ рд░рд╛рд╕реНрддреЗ рдирд╣реАрдВ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рд╡рд┐рдХрд░реНрдг рдЖрдВрджреЛрд▓рдиреЛрдВ рдЕрд╕рдВрднрд╡ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХрдИ рдЕрдиреНрдп рдЫреЛрдЯреЗ рд░рд╛рд╕реНрддреЗ рд╣реИрдВ рдЬреЛ рдкрд╣рд▓реЗ рд╕реЗ рджрд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдРрд╕реЗ рд░рд╛рд╕реНрддреЗ рдХреНрдпреЛрдВ рдкрд╛рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдЕрдВрдд рдмрд┐рдВрджреБ рдХреЛ рдирдХреНрд╢реЗ рдХреЗ рдХреЗрдВрджреНрд░ рдореЗрдВ рд▓реЗ рдЬрд╛рдПрдВред </font><font style="vertical-align: inherit;">рдПрдХ рд╡рд┐рд╖рдо рдХреНрд╖реЗрддреНрд░ рдЖрдХрд╛рд░ рдХреЗ рд╕рд╛рде, рдпрд╣ рд╕рд░рдгреА рдХреЗ рдмреАрдЪ рдореЗрдВ рд╕рд┐рд░реНрдл рдПрдХ рдЯрд╛рдЗрд▓ рд╣реИред</font></font><br><br><pre> <code class="cs hljs"> tiles[tiles.Length / <span class="hljs-number"><span class="hljs-number">2</span></span>].BecomeDestination(); searchFrontier.Enqueue(tiles[tiles.Length / <span class="hljs-number"><span class="hljs-number">2</span></span>]);</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6d3/d09/d78/6d3d09d7844fbe6a4aaf4618449598de.png" width="230" height="230"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЗрдВрджреНрд░ рдореЗрдВ рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБред</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкрд░рд┐рдгрд╛рдо рддрд░реНрдХрд╕рдВрдЧрдд рд▓рдЧрддрд╛ рд╣реИ рдЕрдЧрд░ рдЖрдкрдХреЛ рдпрд╛рдж рд╣реИ рдХрд┐ рдЦреЛрдЬ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддреА рд╣реИред рдЪреВрдВрдХрд┐ рд╣рдо рдЙрддреНрддрд░-рдкреВрд░реНрд╡-рджрдХреНрд╖рд┐рдг-рдкрд╢реНрдЪрд┐рдо рдХреНрд░рдо рдореЗрдВ рдкрдбрд╝реЛрд╕рд┐рдпреЛрдВ рдХреЛ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЙрддреНрддрд░ рдХреА рд╕рд░реНрд╡реЛрдЪреНрдЪ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рд╣реИред рдЪреВрдВрдХрд┐ рд╣рдо рдЦреЛрдЬ рдХреЛ рдЙрд▓реНрдЯреЗ рдХреНрд░рдо рдореЗрдВ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╣рдордиреЗ рдЬреЛ рдЕрдВрддрд┐рдо рдпрд╛рддреНрд░рд╛ рдХреА рд╣реИ рд╡рд╣ рджрдХреНрд╖рд┐рдг рд╣реИред рдЗрд╕реАрд▓рд┐рдП рдХреЗрд╡рд▓ рдХреБрдЫ рддреАрд░ рджрдХреНрд╖рд┐рдг рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдХрдИ рдкреВрд░реНрд╡ рдХреА рдУрд░ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдк рджрд┐рд╢рд╛рдУрдВ рдХреА рдкреНрд░рд╛рдердорд┐рдХрддрд╛рдУрдВ рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдХреЗ рдкрд░рд┐рдгрд╛рдо рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВред рдЪрд▓реЛ рдкреВрд░реНрд╡ рдФрд░ рджрдХреНрд╖рд┐рдг рдореЗрдВ рд╕реНрд╡реИрдк рдХрд░реЗрдВред рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рдЙрддреНрддрд░-рджрдХреНрд╖рд┐рдг рдФрд░ рдкреВрд░реНрд╡-рдкрд╢реНрдЪрд┐рдо рд╕рдорд░реВрдкрддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреА рд╣реЛрдЧреАред</font></font><br><br><pre> <code class="cs hljs"> searchFrontier.Enqueue(tile.GrowPathNorth()); searchFrontier.Enqueue(tile.GrowPathSouth()); searchFrontier.Enqueue(tile.GrowPathEast()); searchFrontier.Enqueue(tile.GrowPathWest())</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a9a/2c7/0b7/a9a2c70b7d7d178b041f30c11d256ad3.png" width="230" height="230"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЦреЛрдЬ рдХреНрд░рдо рдЙрддреНрддрд░-рджрдХреНрд╖рд┐рдг-рдкреВрд░реНрд╡-рдкрд╢реНрдЪрд┐рдо рд╣реИред </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рд╕реБрдВрджрд░ рджрд┐рдЦрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рджрд┐рд╢рд╛рдУрдВ рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣ рдмреЗрд╣рддрд░ рд╣реИ, рд╡рд┐рдХрд░реНрдг рдЖрдВрджреЛрд▓рди рдХреЗ рдХрд░реАрдм рдкрд╣реБрдВрдЪрдирд╛ рдЬрд╣рд╛рдВ рдпрд╣ рд╕реНрд╡рд╛рднрд╛рд╡рд┐рдХ рд▓рдЧреЗрдЧрд╛ред </font><font style="vertical-align: inherit;">рд╣рдо рдПрдХ рдЪреЗрдХрд░рдмреЛрд░реНрдб рдкреИрдЯрд░реНрди рдореЗрдВ рдкрдбрд╝реЛрд╕реА рдЯрд╛рдЗрд▓реЛрдВ рдХреА рдЦреЛрдЬ рдкреНрд░рд╛рдердорд┐рдХрддрд╛рдУрдВ рдХреЛ рдЙрд▓рдЯ рдХрд░ рдРрд╕рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рдмрдЬрд╛рдп рдХрд┐ рд╣рдо рдЦреЛрдЬ рдХреЗ рджреМрд░рд╛рди рдХрд┐рд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдЯрд╛рдЗрд▓ рдХрд╛ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рд╣рдо </font></font><code>GameTile</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд╛рдорд╛рдиреНрдп рд╕рдВрдкрддреНрддрд┐ рдореЗрдВ </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝рддреЗ </font><font style="vertical-align: inherit;">рд╣реИрдВ рдЬреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╡рд░реНрддрдорд╛рди рдЯрд╛рдЗрд▓ рдПрдХ рд╡рд┐рдХрд▓реНрдк рд╣реИ рдпрд╛ рдирд╣реАрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IsAlternative { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо рдЗрд╕ рдкреНрд░реЙрдкрд░реНрдЯреА рдХреЛ рдЗрд╕рдореЗрдВ рд╕реЗрдЯ рдХрд░реЗрдВрдЧреЗ </font></font><code>GameBoard.Initialize</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЯрд╛рдЗрд▓реНрд╕ рдХреЛ рд╡реИрдХрд▓реНрдкрд┐рдХ рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд┐рд╣реНрдирд┐рдд рдХрд░реЗрдВ рдпрджрд┐ рдЙрдирдХрд╛ рдПрдХреНрд╕ рд╕рдордиреНрд╡рдп рднреА рд╣реИред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>, y = <span class="hljs-number"><span class="hljs-number">0</span></span>; y &lt; size.y; y++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x &lt; size.x; x++, i++) { тАж tile.IsAlternative = (x &amp; <span class="hljs-number"><span class="hljs-number">1</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span>; } }</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдСрдкрд░реЗрд╢рди (x &amp; 1) == 0 рдХреНрдпрд╛ рдХрд░рддрд╛ рд╣реИ?</font></font></b> <div class="spoiler_text">   тАФ     (AND).            .       1,       1.  10101010  00001111   00001010. <br><br>       .      0  1.     1, 2, 3, 4   1, 10, 11, 100.  ,       . <br><br>    AND  ,  ,    .    ,       . </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреВрд╕рд░реЗ, рд╣рдо рдкрд░рд┐рдгрд╛рдо рдХрд╛ рд╕рдВрдХреЗрдд рдмрджрд▓рддреЗ рд╣реИрдВ рдпрджрд┐ рдЙрдирдХрд╛ Y рд╕рдордиреНрд╡рдп рднреА рд╣реЛрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП рд╣рдо рдПрдХ рд╢рддрд░рдВрдЬ рдкреИрдЯрд░реНрди рдмрдирд╛рдПрдВрдЧреЗред</font></font><br><br><pre> <code class="cs hljs"> tile.IsAlternative = (x &amp; <span class="hljs-number"><span class="hljs-number">1</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((y &amp; <span class="hljs-number"><span class="hljs-number">1</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span>) { tile.IsAlternative = !tile.IsAlternative; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬреИрд╕рд╛ рдХрд┐ </font></font><code>FindPaths</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо рд╡рд┐рдХрд▓реНрдк рдЯрд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП рдЦреЛрдЬ рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ рд╣реА рдХреНрд░рдо рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рд▓реЗрдХрд┐рди рдпрд╣ рд╡рд╛рдкрд╕ рдЕрдиреНрдп рд╕рднреА рдЯрд╛рдЗрд▓реНрд╕ рдХреЛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдПред </font><font style="vertical-align: inherit;">рдпрд╣ рдкрде рдХреЛ рд╡рд┐рдХрд░реНрдг рдЖрдВрджреЛрд▓рди рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░ рджреЗрдЧрд╛ рдФрд░ zigzags рдмрдирд╛рдПрдЧрд╛ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tile != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tile.IsAlternative) { searchFrontier.Enqueue(tile.GrowPathNorth()); searchFrontier.Enqueue(tile.GrowPathSouth()); searchFrontier.Enqueue(tile.GrowPathEast()); searchFrontier.Enqueue(tile.GrowPathWest()); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { searchFrontier.Enqueue(tile.GrowPathWest()); searchFrontier.Enqueue(tile.GrowPathEast()); searchFrontier.Enqueue(tile.GrowPathSouth()); searchFrontier.Enqueue(tile.GrowPathNorth()); } }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b43/e3a/d63/b43e3ad6370a6b552073b4f0b4cf0e8b.png" width="230" height="230"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЪрд░ рдЦреЛрдЬ рдХреНрд░рдоред</font></font></i> <br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЯрд╛рдЗрд▓реНрд╕ рдмрджрд▓рдирд╛ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕ рдмрд┐рдВрджреБ рдкрд░, рд╕рднреА рдЯрд╛рдЗрд▓реЗрдВ рдЦрд╛рд▓реА рд╣реИрдВред </font><font style="vertical-align: inherit;">рдПрдХ рдЯрд╛рдЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдПрдХ рджреГрд╢реНрдп рддреАрд░ рдХреА рдЕрдиреБрдкрд╕реНрдерд┐рддрд┐ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдпрд╣ рд╕рднреА рдХреЗ рд╕рдорд╛рди рджрд┐рдЦрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдо рдЙрди рдкрд░ рд╡рд╕реНрддреБрдУрдВ рдХреЛ рд░рдЦрдХрд░ рдЯрд╛рдЗрд▓ рдмрджрд▓рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдЬреЛрдбрд╝ рджреЗрдВрдЧреЗред</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЯрд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЯрд╛рдЗрд▓ рдХреА рд╡рд╕реНрддреБрдПрдВ рд╕реНрд╡рдпрдВ рдЯрд╛рдЗрд▓ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдЯреНрд░реИрдХ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдо рдЗрди рд╡рд╕реНрддреБрдУрдВ рдХреЛ рд╕реАрдзреЗ рд╕рдВрд╢реЛрдзрд┐рдд рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, рдЕрд▓рдЧ рд╕рд╛рдордЧреНрд░реА рдЬреЛрдбрд╝реЗрдВ рдФрд░ рдЗрд╕реЗ рдлрд╝реАрд▓реНрдб рдкрд░ рд░рдЦреЗрдВред </font><font style="vertical-align: inherit;">рдЕрднреА рдХреЗ рд▓рд┐рдП, рд╣рдо рдЦрд╛рд▓реА рдЯрд╛рдЗрд▓ рдФрд░ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рдЯрд╛рдЗрд▓ рдХреЗ рдмреАрдЪ рдЕрдВрддрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрди рдорд╛рдорд▓реЛрдВ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рдЧрдгрдирд╛ рдмрдирд╛рдПрдВ </font></font><code>GameTileContentType</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> GameTileContentType { Empty, Destination }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдЧрд▓рд╛, рдПрдХ рдШрдЯрдХ рдкреНрд░рдХрд╛рд░ рдмрдирд╛рдПрдВ рдЬреЛ </font></font><code>GameTileContent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдкрдХреЛ рдЗрдВрд╕реНрдкреЗрдХреНрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЗрд╕рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреЛ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдФрд░ рдЗрд╕ рддрдХ рдкрд╣реБрдВрдЪ рд╕рд╛рдорд╛рдиреНрдп рд╕рдВрдкрддреНрддрд┐ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реЛрдЧреАред</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">GameTileContent</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { [SerializeField] GameTileContentType type = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> GameTileContentType Type =&gt; type; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдлрд┐рд░ рд╣рдо рджреЛ рдкреНрд░рдХрд╛рд░ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЗ рд▓рд┐рдП рдкреНрд░реАрдлрд╝реИрдмреНрд╕ рдмрдирд╛рдПрдВрдЧреЗ, рдЬрд┐рдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдореЗрдВ </font></font><code>GameTileContent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдВрдмрдВрдзрд┐рдд рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕рд╛рде </font><font style="vertical-align: inherit;">рдПрдХ рдШрдЯрдХ </font><font style="vertical-align: inherit;">рд╣реЛрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЖрдЗрдП рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рдЯрд╛рдЗрд▓реНрд╕ рдХреЛ рдирд╛рдорд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдиреАрд▓реЗ рдЪрдкрдЯреЗ рдХреНрдпреВрдм рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред </font><font style="vertical-align: inherit;">рдЪреВрдВрдХрд┐ рдпрд╣ рд▓рдЧрднрдЧ рд╕рдкрд╛рдЯ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЙрд╕реЗ рдПрдХ рдХреЛрд▓рд╛рдЗрдбрд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред </font><font style="vertical-align: inherit;">рдЦрд╛рд▓реА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдкреНрд░реАрдлрд╝реИрдм рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЦрд╛рд▓реА рдЧреЗрдо рдСрдмреНрдЬреЗрдХреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f55/25d/8db/f5525d8db707ff187e17ce96a11d86ae.png" width="320" height="262" alt="рдЧрдВрддрд╡реНрдп"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c6f/463/e19/c6f463e198abca6134b7bc74d3207833.png" width="320" height="176" alt="рдЦрд╛рд▓реА"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рдФрд░ рдЦрд╛рд▓реА рд╕рд╛рдордЧреНрд░реА рдХреЗ Prefabsред </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо рдЦрд╛рд▓реА рдЯрд╛рдЗрд▓реЛрдВ рдХреЛ рд╕рд╛рдордЧреНрд░реА рдСрдмреНрдЬреЗрдХреНрдЯ рджреЗрдВрдЧреЗ, рдХреНрдпреЛрдВрдХрд┐ рддрдм рд╕рднреА рдЯрд╛рдЗрд▓реЛрдВ рдореЗрдВ рд╣рдореЗрд╢рд╛ рд╕рд╛рдордЧреНрд░реА рд╣реЛрдЧреА, рдЬрд┐рд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╣рдореЗрдВ рд╕рдорд╛рдирддрд╛ рдХреЗ рд▓рд┐рдП рд╕рд╛рдордЧреНрд░реА рдХреЗ рд▓рд┐рдВрдХ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрдЧреА </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдХрд╛рд░рдЦрд╛рдирд╛ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд╛рдордЧреНрд░реА рдХреЛ рд╕рдВрдкрд╛рджрди рдпреЛрдЧреНрдп рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдСрдмреНрдЬреЗрдХреНрдЯ рдореИрдиреЗрдЬрдореЗрдВрдЯ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдореЗрдВ рдЙрд╕реА рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЗрд╕рдХреЗ рд▓рд┐рдП рдПрдХ рдХрд╛рд░рдЦрд╛рдирд╛ рднреА рдмрдирд╛рдПрдВрдЧреЗ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЖрдкрдХреЛ </font></font><code>GameTileContent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдкрдиреЗ рдореВрд▓ рдХрд╛рд░рдЦрд╛рдиреЗ рдХрд╛ рдЯреНрд░реИрдХ рд░рдЦрдирд╛ рд╣реЛрдЧрд╛, рдЬрд┐рд╕реЗ рдХреЗрд╡рд▓ рдПрдХ рдмрд╛рд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдФрд░ рд╡рд┐рдзрд┐ рдореЗрдВ рдЦреБрдж рдХреЛ рдХрд╛рд░рдЦрд╛рдиреЗ рдореЗрдВ рд╡рд╛рдкрд╕ рднреЗрдЬрдирд╛ рдЪрд╛рд╣рд┐рдП </font></font><code>Recycle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> GameTileContentFactory originFactory; тАж <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> GameTileContentFactory OriginFactory { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> =&gt; originFactory; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { Debug.Assert(originFactory == <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Redefined origin factory!"</span></span>); originFactory = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Recycle</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { originFactory.Reclaim(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рдорд╛рдирддрд╛ рд╣реИ </font></font><code>GameTileContentFactory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдЗрд╕рд▓рд┐рдП, рд╣рдо рдЖрд╡рд╢реНрдпрдХ рд╡рд┐рдзрд┐ рдХреЗ рд╕рд╛рде рдЗрд╕рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдпреЛрдЧреНрдп рдСрдмреНрдЬреЗрдХреНрдЯ рдкреНрд░рдХрд╛рд░ рдмрдирд╛рдПрдВрдЧреЗ </font></font><code>Recycle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЗрд╕ рд╕реНрддрд░ рдкрд░, рд╣рдо рдкреВрд░реА рддрд░рд╣ рдХрд╛рд░реНрдпрд╛рддреНрдордХ рдХрд╛рд░рдЦрд╛рдиреЗ рдХреЗ рдирд┐рд░реНрдорд╛рдг рд╕реЗ рдкрд░реЗрд╢рд╛рди рдирд╣реАрдВ рд╣реЛрдВрдЧреЗ рдЬреЛ рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЗрд╕реЗ рдХреЗрд╡рд▓ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдирд╖реНрдЯ рдХрд░ рджреЗрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдмрд╛рдж рдореЗрдВ рдмрд╛рдХреА рдХреЛрдб рдХреЛ рдмрджрд▓реЗ рдмрд┐рдирд╛ рдХрд╛рд░рдЦрд╛рдиреЗ рдореЗрдВ рд╡рд╕реНрддреБрдУрдВ рдХрд╛ рдкреБрди: рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реЛрдЧрд╛ред</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine.SceneManagement; [CreateAssetMenu] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">GameTileContentFactory</span></span> : <span class="hljs-title"><span class="hljs-title">ScriptableObject</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Reclaim</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GameTileContent content</span></span></span><span class="hljs-function">)</span></span> { Debug.Assert(content.OriginFactory == <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Wrong factory reclaimed!"</span></span>); Destroy(content.gameObject); } }</code> </pre> <br><font style="vertical-align: inherit;"></font><code>Get</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░реАрдлрд╝реИрдм рдХреЗ рд╕рд╛рде </font><font style="vertical-align: inherit;">рдХрд╛рд░рдЦрд╛рдиреЗ рдореЗрдВ рдПрдХ рдЫрд┐рдкреА рд╣реБрдИ рд╡рд┐рдзрд┐ рдЬреЛрдбрд╝реЗрдВ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдпрд╣рд╛рдБ рд╣рдо рдлрд┐рд░ рд╕реЗ рд╡рд╕реНрддреБрдУрдВ рдХрд╛ рдкреБрди: рдЙрдкрдпреЛрдЧ рдЫреЛрдбрд╝рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╡рд╣ рд╡рд╕реНрддреБ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдмрдирд╛рддрд╛ рд╣реИ, рдЕрдкрдиреЗ рдореВрд▓ рдХрд╛рд░рдЦрд╛рдиреЗ рдХреЛ рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕реЗ рдХрд╛рд░рдЦрд╛рдиреЗ рдХреЗ рджреГрд╢реНрдп рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рд╡рд╛рдкрд╕ рдХрд░рддрд╛ рд╣реИред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-function">GameTileContent </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Get</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GameTileContent prefab</span></span></span><span class="hljs-function">)</span></span> { GameTileContent instance = Instantiate(prefab); instance.OriginFactory = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; MoveToFactoryScene(instance.gameObject); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> instance; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрджрд╛рд╣рд░рдг рдХреЛ рдлрд╝реИрдХреНрдЯрд░реА рд╕рд╛рдордЧреНрд░реА рджреГрд╢реНрдп рдореЗрдВ рд▓реЗ рдЬрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдЖрд╡рд╢реНрдпрдХрддрд╛рдиреБрд╕рд╛рд░ рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрджрд┐ рд╣рдо рд╕рдВрдкрд╛рджрдХ рдореЗрдВ рд╣реИрдВ, рддреЛ рдПрдХ рджреГрд╢реНрдп рдмрдирд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рд╣рдореЗрдВ рдпрд╣ рдЬрд╛рдБрдЪрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдпрд╣ рдореМрдЬреВрдж рд╣реИ, рдЕрдЧрд░ рд╣рдо рдПрдХ рдЧрд░реНрдо рдкреБрдирд░рд╛рд░рдВрдн рдХреЗ рджреМрд░рд╛рди рдЗрд╕реЗ рджреЗрдЦрддреЗ рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"> Scene contentScene; тАж <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MoveToFactoryScene</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GameObject o</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!contentScene.isLoaded) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Application.isEditor) { contentScene = SceneManager.GetSceneByName(name); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!contentScene.isLoaded) { contentScene = SceneManager.CreateScene(name); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { contentScene = SceneManager.CreateScene(name); } } SceneManager.MoveGameObjectToScene(o, contentScene); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдХреЗрд╡рд▓ рджреЛ рдкреНрд░рдХрд╛рд░ рдХреА рд╕рд╛рдордЧреНрд░реА рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЙрдирдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рджреЛ рдкреНрд░реАрдлрд╝реИрдм рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝реАрд▓реНрдб рдЬреЛрдбрд╝реЗрдВред </font></font><br><br><pre> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">SerializeField</span></span>] GameTileContent destinationPrefab = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; [SerializeField] GameTileContent emptyPrefab = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд╛рд░рдЦрд╛рдиреЗ рдХреЗ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдЕрдВрддрд┐рдо рдЪреАрдЬ </font></font><code>Get</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде рдПрдХ </font><font style="vertical-align: inherit;">рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рдзрд┐ рддреИрдпрд╛рд░ </font><font style="vertical-align: inherit;">рдХрд░рдирд╛ рд╣реИ </font></font><code>GameTileContentType</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬреЛ рд╕рдВрдмрдВрдзрд┐рдд рдкреНрд░реАрдлреИрдм рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> GameTileContent </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Get</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GameTileContentType type</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GameTileContentType.Destination: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Get(destinationPrefab); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GameTileContentType.Empty: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Get(emptyPrefab); } Debug.Assert(<span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"Unsupported type: "</span></span> + type); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреНрдпрд╛ рдкреНрд░рддреНрдпреЗрдХ рдЯрд╛рдЗрд▓ рдореЗрдВ рдЦрд╛рд▓реА рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдПрдХ рдЕрд▓рдЧ рдЙрджрд╛рд╣рд░рдг рдЬреЛрдбрд╝рдирд╛ рдЕрдирд┐рд╡рд╛рд░реНрдп рд╣реИ?</font></font></b> <div class="spoiler_text">       ,               .         .  ,        - , , , ,    .     ,       .     ,        ,   . </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЪрд▓реЛ рдПрдХ рдХрд╛рд░рдЦрд╛рдиреЗ рдХреА рд╕рдВрдкрддреНрддрд┐ рдмрдирд╛рддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕рдХреЗ рд▓рд┐рдВрдХ рдХреЛ рдкреНрд░реАрдлреИрдм рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рддреЗ рд╣реИрдВред </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7eb/75f/1cd/7eb75f1cd4bed3c72ffd7f0c42b69cbe.png" width="320" height="106"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдХрд╛рд░рдЦрд╛рдирд╛ </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ рдлрд┐рд░ </font></font><code>Game</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд╛рд░рдЦрд╛рдиреЗ </font><font style="vertical-align: inherit;">рдХрд╛ </font><font style="vertical-align: inherit;">рд▓рд┐рдВрдХ </font><font style="vertical-align: inherit;">рдкрд╛рд╕ рдХрд░реЗрдВ </font><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">SerializeField</span></span>] GameTileContentFactory tileContentFactory = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>;</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b12/d6a/506/b12d6a5067fa91177dbed14a876f8b3d.png" width="320" height="110"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рдХрд╛рд░рдЦрд╛рдиреЗ рдХреЗ рд╕рд╛рде рдЦреЗрд▓ред</font></font></i> <br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдПрдХ рдЯрд╛рдЗрд▓ рджреЛрд╣рди </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдлрд╝реАрд▓реНрдб рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдПрдХ рдЯрд╛рдЗрд▓ рдХрд╛ рдЪрдпрди рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред рд╣рдо рдЗрд╕реЗ рдЧреЗрдо рдореЛрдб рдореЗрдВ рд╕рдВрднрд╡ рдмрдирд╛рдПрдВрдЧреЗред рд╣рдо рдЙрд╕ рд╕реНрдерд╛рди рдкрд░ рджреГрд╢реНрдп рдореЗрдВ рдПрдХ рдмреАрдо рдХрд╛ рдЙрддреНрд╕рд░реНрдЬрди рдХрд░реЗрдВрдЧреЗ рдЬрд╣рд╛рдВ рдЦрд┐рд▓рд╛рдбрд╝реА рдЦреЗрд▓ рд╡рд┐рдВрдбреЛ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рддрд╛ рд╣реИред рдпрджрд┐ рдмреАрдо рдЯрд╛рдЗрд▓ рдХреЗ рд╕рд╛рде рдШреВрдорддрд╛ рд╣реИ, рддреЛ рдЦрд┐рд▓рд╛рдбрд╝реА рдиреЗ рдЗрд╕реЗ рдЫреБрдЖ, рдЕрд░реНрдерд╛рдд, рдЗрд╕реЗ рдмрджрд▓рдирд╛ рд╣реЛрдЧрд╛ред </font></font><code>Game</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЦрд┐рд▓рд╛рдбрд╝реА рдХреЗ рдЗрдирдкреБрдЯ рдХреЛ рд╕рдВрднрд╛рд▓рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реЛрдЧрд╛ рдХрд┐ рдЦрд┐рд▓рд╛рдбрд╝реА рдХрд┐рд╕ рдЯрд╛рдЗрд▓ рдХреЛ рдЫреВрддрд╛ рд╣реИ </font></font><code>GameBoard</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рднреА рдХрд┐рд░рдгреЗрдВ рдЯрд╛рдЗрд▓ рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рдЪреНрдЫреЗрдж рдирд╣реАрдВ рдХрд░рддреА рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдХрднреА-рдХрднреА рд╣рдореЗрдВ рдХреБрдЫ рднреА рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛрдЧрд╛ред рдЗрд╕рд▓рд┐рдП, рд╣рдо рдЙрд╕ </font></font><code>GameBoard</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд┐рдзрд┐ рдореЗрдВ </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ </font></font><code>GetTile</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдЬреЛ рд╣рдореЗрд╢рд╛ рд╢реБрд░реБрдЖрдд рдореЗрдВ рд▓реМрдЯрддреА рд╣реИ </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЯрд╛рдЗрд▓ рдирд╣реАрдВ рдорд┐рд▓реА рдереА)ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> GameTile </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetTile</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Ray ray</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдПрдХ рдХрд┐рд░рдг рдиреЗ рдЯрд╛рдЗрд▓ рдкрд╛рд░ рдХрд░ рд▓реА рд╣реИ, рд╣рдореЗрдВ </font></font><code>Physics.Raycast</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд┐рд░рдг рдХреЛ рдПрдХ рддрд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдХреЗ </font><font style="vertical-align: inherit;">рдХреЙрд▓ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рджреЗрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рдЪреМрд░рд╛рд╣рд╛ рдерд╛ред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдРрд╕рд╛ рд╣реИ, рддреЛ рд╣рдо рдЯрд╛рдЗрд▓ рд╡рд╛рдкрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рд╣рдо рдирд╣реАрдВ рдЬрд╛рдирддреЗ рдХрд┐ рдХреМрди рд╕рд╛ рдЕрднреА рддрдХ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЕрдм рд╣рдо рдЗрд╕реЗ рд╡рд╛рдкрд╕ рдХрд░ рджреЗрдВрдЧреЗ </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> GameTile </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TryGetTile</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Ray ray</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Physics.Raycast(ray) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХреНрдпрд╛ рдПрдХ рдЯрд╛рдЗрд▓ рдХреЗ рд╕рд╛рде рдПрдХ рдЪреМрд░рд╛рд╣рд╛ рдерд╛, рд╣рдореЗрдВ рдЪреМрд░рд╛рд╣реЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </font></font><code>Physics.Raycast</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреВрд╕рд░реЗ рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ </font></font><code>RaycastHit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдпрд╣ рдЖрдЙрдЯрдкреБрдЯ рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИ, рдЬреЛ </font></font><code>out</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рд╕рд╛рдордиреЗ </font><font style="vertical-align: inherit;">рд╢рдмреНрдж рджреНрд╡рд╛рд░рд╛ рдЗрдВрдЧрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ </font><font style="vertical-align: inherit;">рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рдХрд╛ рдорддрд▓рдм рдпрд╣ рд╣реИ рдХрд┐ рдПрдХ рд╡рд┐рдзрд┐ рдХреЙрд▓ рдЙрд╕ рдЪрд░ рдХреЛ рдПрдХ рдорд╛рди рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреА рд╣реИ рдЬрд┐рд╕реЗ рд╣рдо рдЗрд╕реЗ рдкрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"> RaycastHit hit; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Physics.Raycast(ray, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> hit) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣рдо рдЖрдЙрдЯрдкреБрдЯ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЪрд░ рдХреА рдШреЛрд╖рдгрд╛ рдХреЛ рдПрдореНрдмреЗрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЪрд▓рд┐рдП рдЗрд╕реЗ рдХрд░рддреЗ рд╣реИрдВред </font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Physics.Raycast(ray, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> RaycastHit hit) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо рдЗрд╕ рдмрд╛рдд рдХреА рдкрд░рд╡рд╛рд╣ рдирд╣реАрдВ рдХрд░рддреЗ рдХрд┐ рдХрд┐рд╕ рдЪреМрд░рд╛рд╣реЗ рдкрд░ рдХреЛрд▓рд╛рдЗрдбрд░ рд╣реБрдЖ рд╣реИ, рд╣рдо рдЯрд╛рдЗрд▓ рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд┐рд░реНрдл XZ рдЪреМрд░рд╛рд╣реЗ рдХреА рд╕реНрдерд┐рддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╣рдо рдХреНрд╖реЗрддреНрд░ рдХреЗ рдЖрдзреЗ рдЖрдХрд╛рд░ рдХреЛ рдЪреМрд░рд╛рд╣реЗ рдмрд┐рдВрджреБ рдХреЗ рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ рдореЗрдВ рдЬреЛрдбрд╝рдХрд░ рдЯрд╛рдЗрд▓ рдХреЗ рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ рдлрд┐рд░ рдкрд░рд┐рдгрд╛рдо рдХреЛ рдкреВрд░реНрдгрд╛рдВрдХ рдорд╛рдиреЛрдВ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдкрд░рд┐рдгрд╛рдо рдХреЗ рд░реВрдк рдореЗрдВ рдЕрдВрддрд┐рдо рдЯрд╛рдЗрд▓ рд╕реВрдЪрдХрд╛рдВрдХ рдЗрд╕рдХрд╛ рдПрдХреНрд╕ рд╕рдордиреНрд╡рдп рд╣реЛрдЧрд╛ рдФрд░ рд╡рд╛рдИ рдЪреМрдбрд╝рд╛рдИ рдХреНрд╖реЗрддреНрд░ рдХреА рдЪреМрдбрд╝рд╛рдИ рд╕реЗ рдЧреБрдгрд╛ рдХрд░реЗрдЧрд╛ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Physics.Raycast(ray, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> RaycastHit hit)) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(hit.point.x + size.x * <span class="hljs-number"><span class="hljs-number">0.5f</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> y = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(hit.point.z + size.y * <span class="hljs-number"><span class="hljs-number">0.5f</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tiles[x + y * size.x]; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдпрд╣ рдХреЗрд╡рд▓ рддрднреА рд╕рдВрднрд╡ рд╣реИ рдЬрдм рдЯрд╛рдЗрд▓ рдХреЗ рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ рдХреНрд╖реЗрддреНрд░ рдХреЗ рднреАрддрд░ рд╣реЛрдВ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЗрд╕рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдпрд╣ рдорд╛рдорд▓рд╛ рдирд╣реАрдВ рд╣реИ, рддреЛ рдЯрд╛рдЗрд▓ рд╡рд╛рдкрд╕ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(hit.point.x + size.x * <span class="hljs-number"><span class="hljs-number">0.5f</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> y = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(hit.point.z + size.y * <span class="hljs-number"><span class="hljs-number">0.5f</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (x &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; x &lt; size.x &amp;&amp; y &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; y &lt; size.y) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tiles[x + y * size.x]; }</code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рд╛рдордЧреНрд░реА рдкрд░рд┐рд╡рд░реНрддрди </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддрд╛рдХрд┐ рдЖрдк рдЯрд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдмрджрд▓ рд╕рдХреЗрдВ, </font></font><code>GameTile</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд╛рдорд╛рдиреНрдп рд╕рдВрдкрддреНрддрд┐ рдореЗрдВ </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝ рд╕рдХреЗрдВ </font></font><code>Content</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЗрд╕рдХрд╛ рдЧреЗрдЯрдЯрд░ рдХреЗрд╡рд▓ рд╕рд╛рдордЧреНрд░реА рджреЗрддрд╛ рд╣реИ, рдФрд░ рд╕реЗрдЯрд░ рдкрд┐рдЫрд▓реА рд╕рд╛рдордЧреНрд░реА, рдпрджрд┐ рдХреЛрдИ рд╣реЛ, рдФрд░ рдирдИ рд╕рд╛рдордЧреНрд░реА рд░рдЦрддрд╛ рд╣реИред</font></font><br><br><pre> <code class="cs hljs"> GameTileContent content; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> GameTileContent Content { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> =&gt; content; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (content != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { content.Recycle(); } content = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; content.transform.localPosition = transform.localPosition; } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рдПрдХрдорд╛рддреНрд░ рдРрд╕реА рдЬрдЧрд╣ рд╣реИ рдЬрд┐рд╕ рдкрд░ рдЖрдкрдХреЛ рд╕рд╛рдордЧреНрд░реА рдХреА рдЬрд╛рдБрдЪ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдХреНрдпреЛрдВрдХрд┐ рд╢реБрд░реВ рдореЗрдВ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдХреЛрдИ рд╕рд╛рдордЧреНрд░реА рдирд╣реАрдВ рд╣реИред </font><font style="vertical-align: inherit;">рдЧрд╛рд░рдВрдЯреА рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рджрд╛рд╡реЗ рдкрд░ рдЕрдорд▓ рдХрд░рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╕реЗрдЯрд░ рдХреЛ рдмреБрд▓рд╛рдпрд╛ рди рдЬрд╛рдП </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { Debug.Assert(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> != <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Null assigned to content!"</span></span>); тАж }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ рдЕрдВрдд рдореЗрдВ, рд╣рдореЗрдВ рдПрдХ рдЦрд┐рд▓рд╛рдбрд╝реА рдЗрдирдкреБрдЯ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдПрдХ рдорд╛рдЙрд╕ рдХреНрд▓рд┐рдХ рдХреЛ рдПрдХ рдХрд┐рд░рдг рдореЗрдВ рдмрджрд▓рдирд╛ </font><font style="vertical-align: inherit;">рддрд░реНрдХ рдХреЗ </font></font><code>ScreenPointToRay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд╛рде </font><font style="vertical-align: inherit;">рдХреЙрд▓ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ </font></font><code>Input.mousePosition</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдХреЙрд▓ рдореБрдЦреНрдп рдХреИрдорд░рд╛ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬрд┐рд╕рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд╣реБрдБрдЪрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ </font></font><code>Camera.main</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рд▓рд┐рдП рдЧреБрдг рдЧ рдЬреЛрдбрд╝реЗрдВ </font></font><code>Game</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> Ray TouchRay =&gt; Camera.main.ScreenPointToRay(Input.mousePosition);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдлрд┐рд░ рд╣рдо рдПрдХ рд╡рд┐рдзрд┐ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ рдЬреЛ </font></font><code>Update</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рдЬрд╛рдВрдЪрддрд╛ рд╣реИ рдХрд┐ рдЙрдиреНрдирдпрди рдХреЗ рджреМрд░рд╛рди рдореБрдЦреНрдп рдорд╛рдЙрд╕ рдмрдЯрди рджрдмрд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ рдпрд╛ рдирд╣реАрдВред </font><font style="vertical-align: inherit;">рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, </font></font><code>Input.GetMouseButtonDown</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╢реВрдиреНрдп рдХреЗ рд╕рд╛рде рдПрдХ рддрд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ </font><font style="vertical-align: inherit;">рдХреЙрд▓ рдХрд░реЗрдВ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдХреБрдВрдЬреА рдХреЛ рджрдмрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рд╣рдо рдЦрд┐рд▓рд╛рдбрд╝реА рдХреЗ рд╕реНрдкрд░реНрд╢ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдЕрд░реНрдерд╛рдд, рд╣рдо рдЯрд╛рдЗрд▓ рдХреЛ рдлрд╝реАрд▓реНрдб рд╕реЗ рд▓реЗрддреЗ рд╣реИрдВ рдФрд░ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рдХреЛ рдЗрд╕рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЗ рд░реВрдк рдореЗрдВ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ, рдЗрд╕реЗ рдХрд╛рд░рдЦрд╛рдиреЗ рд╕реЗ рд▓реЗрддреЗ рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetMouseButtonDown(<span class="hljs-number"><span class="hljs-number">0</span></span>)) { HandleTouch(); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HandleTouch</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { GameTile tile = GetTile(TouchRay); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tile != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { tile.Content = tileContentFactory.Get(GameTileContentType.Destination); } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЕрдм рд╣рдо рдХрд░реНрд╕рд░ рдХреЛ рджрдмрд╛рдХрд░ рдХрд┐рд╕реА рднреА рдЯрд╛рдЗрд▓ рдХреЛ рдПрдХ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рдореЗрдВ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВред </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/99a/f15/da3/99af15da39bfc08cb8886b98e0ae15df.png" width="230" height="230"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрдИ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБред</font></font></i> <br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЦреЗрдд рдХреЛ рд╕рд╣реА рдмрдирд╛рдирд╛ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рд╛рд▓рд╛рдБрдХрд┐ рд╣рдо рдЯрд╛рдЗрд▓реНрд╕ рдХреЛ рдПрдВрдбрдкреЙрдЗрдВрдЯ рдореЗрдВ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрд╣ рдЕрдм рддрдХ рдХреЗ рд░рд╛рд╕реНрддреЛрдВ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╣рдордиреЗ рдЕрднреА рддрдХ рдЯрд╛рдЗрд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдЦрд╛рд▓реА рд╕рд╛рдордЧреНрд░реА рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдирд╣реАрдВ рдХреА рд╣реИред </font><font style="vertical-align: inherit;">рдХреНрд╖реЗрддреНрд░ рдХреА рд╢реБрджреНрдзрддрд╛ рдФрд░ рдЕрдЦрдВрдбрддрд╛ рдХреЛ рдмрдирд╛рдП рд░рдЦрдирд╛ рдПрдХ рдХрд╛рд░реНрдп рд╣реИ </font></font><code>GameBoard</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдЗрд╕рд▓рд┐рдП рдЪрд▓реЛ рдЙрд╕реЗ рдЯрд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреА рдЬрд┐рдореНрдореЗрджрд╛рд░реА рджреЗрдВред </font><font style="vertical-align: inherit;">рдЗрд╕реЗ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдЗрд╕рдХреА рд╡рд┐рдзрд┐ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рд╛рдордЧреНрд░реА рдХрд╛рд░рдЦрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд▓рд┐рдВрдХ рджреЗрдВрдЧреЗ </font></font><code>Intialize</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рднреА рдЯрд╛рдЗрд▓реЛрдВ рдХреЛ рдЦрд╛рд▓реА рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░реЗрдВрдЧреЗред</font></font><br><br><pre> <code class="cs hljs"> GameTileContentFactory contentFactory; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Initialize</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> Vector2Int size, GameTileContentFactory contentFactory </span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.size = size; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.contentFactory = contentFactory; ground.localScale = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector3(size.x, size.y, <span class="hljs-number"><span class="hljs-number">1f</span></span>); tiles = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GameTile[size.x * size.y]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>, y = <span class="hljs-number"><span class="hljs-number">0</span></span>; y &lt; size.y; y++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x &lt; size.x; x++, i++) { тАж tile.Content = contentFactory.Get(GameTileContentType.Empty); } } FindPaths(); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рдореБрдЭреЗ </font></font><code>Game</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдкрдиреЗ рдХрд╛рд░рдЦрд╛рдиреЗ рдХреЛ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Awake</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { board.Initialize(boardSize, tileContentFactory); }</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GameBoard рдореЗрдВ рдлрд╝реИрдХреНрдЯрд░реА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝реАрд▓реНрдб рдХреНрдпреЛрдВ рдирд╣реАрдВ рдЬреЛрдбрд╝реА рдЧрдИ?</font></font></b> <div class="spoiler_text">   ,    ,   .        ,       . </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЪреВрдВрдХрд┐ рдЕрдм рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдХрдИ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рд╣реИрдВ, </font></font><code>GameBoard.FindPaths</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП </font><font style="vertical-align: inherit;">рд╣рдо рдЗрд╕реЗ рдмрджрд▓рддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">рддрд╛рдХрд┐ рдпрд╣ </font></font><code>BecomeDestination</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рддреНрдпреЗрдХ рдХреЗ рд▓рд┐рдП </font><font style="vertical-align: inherit;">рдХреЙрд▓ рдХрд░реЗ </font><font style="vertical-align: inherit;">рдФрд░ рдЙрди рд╕рднреА рдХреЛ рд╕реАрдорд╛ рдореЗрдВ рдЬреЛрдбрд╝рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдФрд░ рдпрд╣ рд╕рдм рдХрдИ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБрдУрдВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд▓реЗрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЕрдиреНрдп рд╕рднреА рдЯрд╛рдЗрд▓реЗрдВ рд╣рдореЗрд╢рд╛ рдХреА рддрд░рд╣ рд╕рд╛рдл рд╣реЛ рдЬрд╛рддреА рд╣реИрдВред </font><font style="vertical-align: inherit;">рдлрд┐рд░ рд╣рдо рдХреЗрдВрджреНрд░ рдореЗрдВ рд╣рд╛рд░реНрдб-рд╕реЗрдЯ рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреЛ рд╣рдЯрд╛рддреЗ рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FindPaths</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (GameTile tile <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tiles) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tile.Content.Type == GameTileContentType.Destination) { tile.BecomeDestination(); searchFrontier.Enqueue(tile); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { tile.ClearPath(); } } <span class="hljs-comment"><span class="hljs-comment">//tiles[tiles.Length / 2].BecomeDestination(); //searchFrontier.Enqueue(tiles[tiles.Length / 2]); тАж }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдЕрдЧрд░ рд╣рдо рдЯрд╛рдЗрд▓реНрд╕ рдХреЛ рдПрдВрдбрдкреЙрдЗрдВрдЯ рдореЗрдВ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рд░рд┐рд╡рд░реНрд╕ рдСрдкрд░реЗрд╢рди рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреЛ рдЦрд╛рд▓реА рдЯрд╛рдЗрд▓реНрд╕ рдореЗрдВ рдмрджрд▓рдирд╛ рдЪрд╛рд╣рд┐рдПред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рддрдм рд╣рдореЗрдВ рдХреЛрдИ рднреА рдЕрдВрдХ рдирд╣реАрдВ рдорд┐рд▓ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, </font></font><code>FindPaths</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдкрдиреЗ рдХрд╛рд░реНрдп рдХреЛ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдирд╣реАрдВ рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рдпрд╣ рддрдм рд╣реЛрддрд╛ рд╣реИ рдЬрдм рд╕рднреА рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдкрде рдЖрд░рдВрднреАрдХрд░рдг рдХреЗ рдмрд╛рдж рд╕реАрдорд╛ рдЦрд╛рд▓реА рд╣реЛрддреА рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдо рдЗрд╕реЗ рдХреНрд╖реЗрддреНрд░ рдХреА рдПрдХ рдЕрдорд╛рдиреНрдп рд╕реНрдерд┐рддрд┐ рдХреЗ рд░реВрдк рдореЗрдВ рдирд┐рд░реВрдкрд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рд╡рд╛рдкрд╕ рд▓реМрдЯрддреЗ рд╣реИрдВ </font></font><code>false</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рдкреВрд░рд╛ рдХрд░рддреЗ рд╣реИрдВ; </font><font style="vertical-align: inherit;">рдЕрдиреНрдпрдерд╛ рдЕрдВрдд рдореЗрдВ рд▓реМрдЯреЗрдВ </font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FindPaths</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (GameTile tile <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tiles) { тАж } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (searchFrontier.Count == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } тАж <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рддрд░реАрдХрд╛, рдЗрд╕реЗ рдПрдХ рд╕реНрд╡рд┐рдЪ рдСрдкрд░реЗрд╢рди рдмрдирд╛рдирд╛ред рдЦрд╛рд▓реА рдЯрд╛рдЗрд▓реЛрдВ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдХреЗ, рд╣рдо рдЙрдиреНрд╣реЗрдВ рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБрдУрдВ рдореЗрдВ рдмрджрд▓ рджреЗрдВрдЧреЗ, рдФрд░ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБрдУрдВ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдХреЗ, рд╣рдо рдЙрдиреНрд╣реЗрдВ рд╣рдЯрд╛ рджреЗрдВрдЧреЗред рд▓реЗрдХрд┐рди рдЕрдм рдпрд╣ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдмрджрд▓рдиреЗ рдореЗрдВ рд▓рдЧрд╛ рд╣реБрдЖ рд╣реИ </font></font><code>GameBoard</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЗрд╕реЗ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рдзрд┐ рджреЗрдВрдЧреЗ </font></font><code>ToggleDestination</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдЬрд┐рд╕рдХрд╛ рдкреИрд░рд╛рдореАрдЯрд░ рдЯрд╛рдЗрд▓ рд╣реИред рдпрджрд┐ рдЯрд╛рдЗрд▓ рдПрдВрдбрдкреЙрдЗрдВрдЯ рд╣реИ, рддреЛ рдЗрд╕реЗ рдЦрд╛рд▓реА рдХрд░реЗрдВ рдФрд░ рдХреЙрд▓ рдХрд░реЗрдВ </font></font><code>FindPaths</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред рдЕрдиреНрдпрдерд╛, рд╣рдо рдЗрд╕реЗ рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ рдмрдирд╛рддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рдХреЙрд▓ рднреА рдХрд░рддреЗ рд╣реИрдВ </font></font><code>FindPaths</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToggleDestination</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GameTile tile</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tile.Content.Type == GameTileContentType.Destination) { tile.Content = contentFactory.Get(GameTileContentType.Empty); FindPaths(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { tile.Content = contentFactory.Get(GameTileContentType.Destination); FindPaths(); } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рдЬреЛрдбрд╝рдирд╛ рдХрднреА рднреА рдПрдХ рдЕрдорд╛рдиреНрдп рдлрд╝реАрд▓реНрдб рд╕реНрдерд┐рддрд┐ рдирд╣реАрдВ рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рдХреЛ рд╣рдЯрд╛ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рд╣рдо рдЬрд╛рдБрдЪ рдХрд░реЗрдВрдЧреЗ рдХрд┐ рдХреНрдпрд╛ </font></font><code>FindPaths</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдордиреЗ рдЯрд╛рдЗрд▓ рдХреЛ рдЦрд╛рд▓реА </font><font style="vertical-align: inherit;">рдХрд░рдиреЗ рдХреЗ </font><font style="vertical-align: inherit;">рдмрд╛рдж </font><font style="vertical-align: inherit;">рдЗрд╕реЗ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдирд┐рд╖реНрдкрд╛рджрд┐рдд </font><font style="vertical-align: inherit;">рдХрд┐рдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдирд╣реАрдВ, рддреЛ рдкрд░рд┐рд╡рд░реНрддрди рдХреЛ рд░рджреНрдж рдХрд░реЗрдВ, рдЯрд╛рдЗрд▓ рдХреЛ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рдкрд░ рд╡рд╛рдкрд╕ рд▓рд╛рдПрдВ, рдФрд░ </font></font><code>FindPaths</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд┐рдЫрд▓реА рд╕рд╣реА рд╕реНрдерд┐рддрд┐ рдкрд░ рд▓реМрдЯрдиреЗ рдХреЗ рд▓рд┐рдП </font><font style="vertical-align: inherit;">рдлрд┐рд░ </font><font style="vertical-align: inherit;">рд╕реЗ </font><font style="vertical-align: inherit;">рдХреЙрд▓ рдХрд░реЗрдВ </font><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tile.Content.Type == GameTileContentType.Destination) { tile.Content = contentFactory.Get(GameTileContentType.Empty); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!FindPaths()) { tile.Content = contentFactory.Get(GameTileContentType.Destination); FindPaths(); } }</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреНрдпрд╛ рд╕рддреНрдпрд╛рдкрди рдХреЛ рдЕрдзрд┐рдХ рдХреБрд╢рд▓ рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ?</font></font></b> <div class="spoiler_text">      ,      .           ,   .  ,          .        <code>FindPaths</code> ,      . </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рдЕрдВрдд рдореЗрдВ </font></font><code>Initialize</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо </font></font><code>ToggleDestination</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЗрдВрджреНрд░реАрдп рдЯрд╛рдЗрд▓ рдХреЗ рд╕рд╛рде рдПрдХ рддрд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ, рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп рдХреЙрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ </font></font><code>FindPaths</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдпрд╣ рдПрдХрдорд╛рддреНрд░ рд╕рдордп рд╣реИ рдЬрдм рд╣рдо рдПрдХ рдЕрдорд╛рдиреНрдп рдлрд╝реАрд▓реНрдб рд╕реНрдерд┐рддрд┐ рд╕реЗ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╣рдореЗрдВ рд╕рд╣реА рд╕реНрдерд┐рддрд┐ рдХреЗ рд╕рд╛рде рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рдХреА рдЧрд╛рд░рдВрдЯреА рд╣реИред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Initialize</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> Vector2Int size, GameTileContentFactory contentFactory </span></span></span><span class="hljs-function">)</span></span> { тАж <span class="hljs-comment"><span class="hljs-comment">//FindPaths(); ToggleDestination(tiles[tiles.Length / 2]); }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдВрдд рдореЗрдВ, рд╣рдо </font><font style="vertical-align: inherit;">рдЯрд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рд╕реНрд╡рдпрдВ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп </font></font><code>Game</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЙрд▓ </font></font><code>ToggleDestination</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд░рдиреЗ рдХреЗ </font><font style="vertical-align: inherit;">рд▓рд┐рдП рдмрд╛рдзреНрдп </font><font style="vertical-align: inherit;">рдХрд░рддреЗ рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HandleTouch</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { GameTile tile = board.GetTile(TouchRay); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tile != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//tile.Content = //tileContentFactory.Get(GameTileContentType.Destination); board.ToggleDestination(tile); } }</span></span></code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/832/685/8a9/8326858a93b938353376ff97259df1a7.png" width="230" height="230"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд╣реА рд░рд╛рд╕реНрддреЛрдВ рдХреЗ рд╕рд╛рде рдХрдИ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБред</font></font></i> <br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреНрдпрд╛ рд╣рдореЗрдВ рдЧреЗрдо рдХреЛ рдЯрд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рд╕реАрдзреЗ рд╕реЗрдЯ рдХрд░рдиреЗ рд╕реЗ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдирд╣реАрдВ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП?</font></font></b> <div class="spoiler_text">   .       .       ,   <code>Game</code>             .    ,      . </div></div><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рджреАрд╡рд╛рд░реЗрдВ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЯреЙрд╡рд░ рд░рдХреНрд╖рд╛ рдХрд╛ рд▓рдХреНрд╖реНрдп рджреБрд╢реНрдордиреЛрдВ рдХреЛ рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рд╕реЗ рд░реЛрдХрдирд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рд▓рдХреНрд╖реНрдп рджреЛ рддрд░рд╣ рд╕реЗ рд╣рд╛рд╕рд┐рд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдо рдЙрдиреНрд╣реЗрдВ рдорд╛рд░рддреЗ рд╣реИрдВ, рдФрд░ рджреВрд╕рд░реА рдмрд╛рдд, рд╣рдо рдЙрдиреНрд╣реЗрдВ рдзреАрдорд╛ рдХрд░ рджреЗрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЙрдиреНрд╣реЗрдВ рдорд╛рд░рдиреЗ рдХрд╛ рдЕрдзрд┐рдХ рд╕рдордп рд╣реЛред </font><font style="vertical-align: inherit;">рдЯрд╛рдЗрд▓ рдХреНрд╖реЗрддреНрд░ рдкрд░, рд╕рдордп рдмрдврд╝рд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рджреБрд╢реНрдордиреЛрдВ рдХреЛ рдЬрд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдмрд╛рдзрд╛рдУрдВ рдХреЛ рд░рдЦрдХрд░ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЖрдорддреМрд░ рдкрд░ рдпреЗ рдЯреЙрд╡рд░ рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ рджреБрд╢реНрдордиреЛрдВ рдХреЛ рднреА рдорд╛рд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЗрд╕ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдореЗрдВ рд╣рдо рдЦреБрдж рдХреЛ рдХреЗрд╡рд▓ рджреАрд╡рд╛рд░реЛрдВ рддрдХ рд╕реАрдорд┐рдд рдХрд░ рд▓реЗрдВрдЧреЗред</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЕрдВрддрд░реНрд╡рд╕реНрддреБ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреАрд╡рд╛рд░реЗрдВ рдПрдХ рдЕрдиреНрдп рдкреНрд░рдХрд╛рд░ рдХреА рд╕рд╛рдордЧреНрд░реА рд╣реИрдВ, рддреЛ рдЪрд▓рд┐рдП </font></font><code>GameTileContentType</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрдирдореЗрдВ рдПрдХ рддрддреНрд╡ </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝рддреЗ </font><font style="vertical-align: inherit;">рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> GameTileContentType { Empty, Destination, Wall }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдлрд┐рд░ рджреАрд╡рд╛рд░ рдХреЛ рдкреНрд░реАрдлреИрдм рдмрдирд╛рдПрдВред </font><font style="vertical-align: inherit;">рдЗрд╕ рдмрд╛рд░ рд╣рдо рдЯрд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдПрдХ рдЧреЗрдо рдСрдмреНрдЬреЗрдХреНрдЯ рдмрдирд╛рдПрдВрдЧреЗ рдФрд░ рдЗрд╕рдореЗрдВ рдПрдХ рдмрдЪреНрдЪрд╛ рдХреНрдпреВрдм рдЬреЛрдбрд╝реЗрдВрдЧреЗ, рдЬреЛ рдореИрджрд╛рди рдХреЗ рдКрдкрд░ рд╣реЛрдЧрд╛ рдФрд░ рдкреВрд░реА рдЯрд╛рдЗрд▓ рдХреЛ рднрд░ рджреЗрдЧрд╛ред </font><font style="vertical-align: inherit;">рдЗрд╕реЗ рдЖрдзрд╛ рдпреВрдирд┐рдЯ рдКрдВрдЪрд╛ рдмрдирд╛рдПрдВ рдФрд░ рдХреЛрд▓рд╛рдЗрдбрд░ рдХреЛ рдмрдЪрд╛рдПрдВ, рдХреНрдпреЛрдВрдХрд┐ рджреАрд╡рд╛рд░реЗрдВ рдЗрд╕рдХреЗ рдкреАрдЫреЗ рдХреА рдЯрд╛рдЗрд▓реЛрдВ рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рджреЗрдЦ рд╕рдХрддреА рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рдЬрдм рдХреЛрдИ рдЦрд┐рд▓рд╛рдбрд╝реА рдХрд┐рд╕реА рджреАрд╡рд╛рд░ рдХреЛ рдЫреВрддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рд╕рдВрдмрдВрдзрд┐рдд рдЯрд╛рдЗрд▓ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░реЗрдЧрд╛ред</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1d3/a33/779/1d3a33779b0c4d49f8ab4fed3d8abd20.png" width="320" height="176" alt="рдЬрдбрд╝"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/431/b5c/9f6/431b5c9f65000bab15dd9e1eed14696d.png" width="320" height="226" alt="рдШрдирдХреНрд╖реЗрддреНрд░"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e6b/875/3b2/e6b8753b2e9b954b55a4a3a6e0154560.png" width="225" height="60" alt="рдкреВрд░реНрд╡рдирд┐рд░реНрдорд┐рдд"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prefab рджреАрд╡рд╛рд░ред </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛрдб рдФрд░ рдЗрдВрд╕реНрдкреЗрдХреНрдЯрд░ рджреЛрдиреЛрдВ рдореЗрдВ рджреАрд╡рд╛рд░ рдкреНрд░реАрдлрд╝реИрдм рдХреЛ рдХрд╛рд░рдЦрд╛рдиреЗ рдореЗрдВ рдЬреЛрдбрд╝реЗрдВред</font></font><br><br><pre> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">SerializeField</span></span>] GameTileContent wallPrefab = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; тАж <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> GameTileContent </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Get</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GameTileContentType type</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GameTileContentType.Destination: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Get(destinationPrefab); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GameTileContentType.Empty: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Get(emptyPrefab); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GameTileContentType.Wall: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Get(wallPrefab); } Debug.Assert(<span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"Unsupported type: "</span></span> + type); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/262/eaa/50f/262eaa50f1bf4f80b2d2861d6232368b.png" width="320" height="80"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░реАрдлреИрдм рджреАрд╡рд╛рд░ рдХреЗ рд╕рд╛рде рдлреИрдХреНрдЯрд░реАред</font></font></i> <br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рджреАрд╡рд╛рд░реЛрдВ рдХреЛ рдЪрд╛рд▓реВ рдФрд░ рдмрдВрдж рдХрд░реЗрдВ </font></font></h3><br><font style="vertical-align: inherit;"></font><code>GameBoard</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреАрд╡рд╛рд░реЛрдВ рдХреЗ рдЪрд╛рд▓реВ / рдмрдВрдж рд╡рд┐рдзрд┐ рдореЗрдВ </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝реЗрдВ </font><font style="vertical-align: inherit;">, рдЬреИрд╕рд╛ рдХрд┐ рд╣рдордиреЗ рдЕрдВрдд рдмрд┐рдВрджреБ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдерд╛ред </font><font style="vertical-align: inherit;">рдкреНрд░рд╛рд░рдВрдн рдореЗрдВ, рд╣рдо рдлрд╝реАрд▓реНрдб рдХреА рдЧрд▓рдд рд╕реНрдерд┐рддрд┐ рдХреА рдЬрд╛рдБрдЪ рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToggleWall</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GameTile tile</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tile.Content.Type == GameTileContentType.Wall) { tile.Content = contentFactory.Get(GameTileContentType.Empty); FindPaths(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { tile.Content = contentFactory.Get(GameTileContentType.Wall); FindPaths(); } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо рдХреЗрд╡рд▓ рдЦрд╛рд▓реА рдЯрд╛рдЗрд▓ рдФрд░ рджреАрд╡рд╛рд░ рдЯрд╛рдЗрд▓ рдХреЗ рдмреАрдЪ рд╕реНрд╡рд┐рдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди рдкреНрд░рджрд╛рди рдХрд░реЗрдВрдЧреЗ, рджреАрд╡рд╛рд░реЛрдВ рдХреЛ рд╕реАрдзреЗ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБрдУрдВ рдХреЛ рдмрджрд▓рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рд╣рдо рдХреЗрд╡рд▓ рдПрдХ рджреАрд╡рд╛рд░ рдмрдирд╛рдПрдВрдЧреЗ рдЬрдм рдЯрд╛рдЗрд▓ рдЦрд╛рд▓реА рд╣реЛрдЧреАред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рджреАрд╡рд╛рд░реЛрдВ рдХреЛ рд░рд╛рд╕реНрддреЗ рдХреА рдЦреЛрдЬ рдХреЛ рдЕрд╡рд░реБрджреНрдз рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдкреНрд░рддреНрдпреЗрдХ рдЯрд╛рдЗрд▓ рдореЗрдВ рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ рдХреЗ рд▓рд┐рдП рдПрдХ рд░рд╛рд╕реНрддрд╛ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдЕрдиреНрдпрдерд╛ рджреБрд╢реНрдорди рдлрдВрд╕ рдЬрд╛рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдлрд┐рд░ рд╕реЗ рд╕рддреНрдпрд╛рдкрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ </font></font><code>FindPaths</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдФрд░ рдпрджрд┐ рдЙрдиреНрд╣реЛрдВрдиреЗ рдПрдХ рдЧрд▓рдд рдлрд╝реАрд▓реНрдб рд╕реНрдЯреЗрдЯ рдмрдирд╛рдпрд╛ рд╣реИ рддреЛ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЛ рдЫреЛрдбрд╝ рджреЗрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tile.Content.Type == GameTileContentType.Empty) { tile.Content = contentFactory.Get(GameTileContentType.Wall); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!FindPaths()) { tile.Content = contentFactory.Get(GameTileContentType.Empty); FindPaths(); } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреАрд╡рд╛рд░реЛрдВ рдХреЛ рдЪрд╛рд▓реВ рдФрд░ рдмрдВрдж рдХрд░рдирд╛, рд╕рдорд╛рдкрди рдмрд┐рдВрджреБрдУрдВ рдХреЛ рдЪрд╛рд▓реВ рдХрд░рдиреЗ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЕрдзрд┐рдХ рдмрд╛рд░ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЗрд╕рд▓рд┐рдП рд╣рдо </font></font><code>Game</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореБрдЦреНрдп рд╕реНрдкрд░реНрд╢ </font><font style="vertical-align: inherit;">рдореЗрдВ рджреАрд╡рд╛рд░реЛрдВ рдХреЛ рдмрджрд▓ рджреЗрдВрдЧреЗ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рдХреЛ рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд рд╕реНрдкрд░реНрд╢ (рдЖрдорддреМрд░ рдкрд░ рд╕рд╣реА рдорд╛рдЙрд╕ рдмрдЯрди) рджреНрд╡рд╛рд░рд╛ рд╕реНрд╡рд┐рдЪ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ </font></font><code>Input.GetMouseButtonDown</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 рдХреЗ рдорд╛рди рд╕реЗ </font><font style="vertical-align: inherit;">рдкрд╛рд╕ рдХрд░рдХреЗ рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetMouseButtonDown(<span class="hljs-number"><span class="hljs-number">0</span></span>)) { HandleTouch(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetMouseButtonDown(<span class="hljs-number"><span class="hljs-number">1</span></span>)) { HandleAlternativeTouch(); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HandleAlternativeTouch</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { GameTile tile = board.GetTile(TouchRay); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tile != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { board.ToggleDestination(tile); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HandleTouch</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { GameTile tile = board.GetTile(TouchRay); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tile != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { board.ToggleWall(tile); } }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d62/e45/4e9/d62e454e94a659dd9da841a915a93dac.png" width="230" height="230"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рджреАрд╡рд╛рд░реЗрдВ рд╣реИрдВред</font></font></i> <br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореБрдЭреЗ рддрд┐рд░рдЫреЗ рдЖрд╕рдиреНрди рджреАрд╡рд╛рд░реЛрдВ рдХреА рдЫрд╛рдпрд╛ рдХреЗ рдмреАрдЪ рдмрдбрд╝реЗ рдЕрдВрддрд░рд╛рд▓ рдХреНрдпреЛрдВ рдорд┐рд▓рддреЗ рд╣реИрдВ?</font></font></b> <div class="spoiler_text">  ,          ,    ,   .   ,   ,  far clipping plane      . ,   far plane  20      .  ,         MSAA,     . </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЪрд▓реЛ рдпрд╣ рднреА рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рд╕реАрдзреЗ рджреАрд╡рд╛рд░реЛрдВ рдХреЛ рдмрджрд▓ рдирд╣реАрдВ рд╕рдХрддреЗ рд╣реИрдВред </font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToggleDestination</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GameTile tile</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tile.Content.Type == GameTileContentType.Destination) { тАж } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tile.Content.Type == GameTileContentType.Empty) { tile.Content = contentFactory.Get(GameTileContentType.Destination); FindPaths(); } }</code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкрд╛рде рд╕рд░реНрдЪ рд▓реЙрдХ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд░рд╛рд╕реНрддреЗ рдХреА рдЦреЛрдЬ рдХреЛ рдЕрд╡рд░реБрджреНрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджреАрд╡рд╛рд░реЛрдВ рдХреЗ рд▓рд┐рдП, рдпрд╣ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ рдХрд┐ рд╣рдо рдЦреЛрдЬ рд╕реАрдорд╛ рдкрд░ рджреАрд╡рд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдЯрд╛рдЗрд▓ рди рдЬреЛрдбрд╝реЗрдВред </font><font style="vertical-align: inherit;">рдпрд╣ </font></font><code>GameTile.GrowPathTo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреАрд╡рд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдЯрд╛рдЗрд▓реЛрдВ рдХреЛ рд╡рд╛рдкрд╕ рдирд╣реАрдВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП </font><font style="vertical-align: inherit;">рдордЬрдмреВрд░ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдкрде рдЕрднреА рднреА рджреАрд╡рд╛рд░ рдХреА рджрд┐рд╢рд╛ рдореЗрдВ рдмрдврд╝рдирд╛ рдЪрд╛рд╣рд┐рдП, рддрд╛рдХрд┐ рдореИрджрд╛рди рдкрд░ рд╕рднреА рдЯрд╛рдЗрд▓реЛрдВ рдХрд╛ рдПрдХ рдорд╛рд░реНрдЧ рд╣реЛред </font><font style="vertical-align: inherit;">рдпрд╣ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рджреБрд╢реНрдордиреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рдЯрд╛рдЗрд▓ рдЕрдЪрд╛рдирдХ рдПрдХ рджреАрд╡рд╛рд░ рдореЗрдВ рдмрджрд▓ рдЬрд╛рдПрдЧреАред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-function">GameTile </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GrowPathTo</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GameTile neighbor</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!HasPath || neighbor == <span class="hljs-literal"><span class="hljs-literal">null</span></span> || neighbor.HasPath) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } neighbor.distance = distance + <span class="hljs-number"><span class="hljs-number">1</span></span>; neighbor.nextOnPath = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> neighbor.Content.Type != GameTileContentType.Wall ? neighbor : <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рд╕рднреА рдЯрд╛рдЗрд▓реЛрдВ рдХреЗ рдкрд╛рд╕ рдПрдХ рд░рд╛рд╕реНрддрд╛ рд╣реИ, </font></font><code>GameBoard.FindPaths</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЦреЛрдЬ рдкреВрд░реА рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж </font><font style="vertical-align: inherit;">рдЙрдиреНрд╣реЗрдВ рдЗрд╕рдХреА </font><font style="vertical-align: inherit;">рдЬрд╛рдВрдЪ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдПред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдпрд╣ рдорд╛рдорд▓рд╛ рдирд╣реАрдВ рд╣реИ, рддреЛ рдлрд╝реАрд▓реНрдб рдХреА рд╕реНрдерд┐рддрд┐ рдЕрдорд╛рдиреНрдп рд╣реИ рдФрд░ рдЙрд╕реЗ рд╡рд╛рдкрд╕ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ </font></font><code>false</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЕрдорд╛рдиреНрдп рд░рд╛рдЬреНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдкрде рд╡рд┐рдЬрд╝реБрдЕрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдлрд╝реАрд▓реНрдб рдкрд┐рдЫрд▓реА рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд╡рд╛рдкрд╕ рдЖ рдЬрд╛рдПрдЧреАред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FindPaths</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { тАж <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (GameTile tile <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tiles) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!tile.HasPath) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (GameTile tile <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tiles) { tile.ShowPath(); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cc3/ff2/c3e/cc3ff2c3e52a087d9fa757d5760623d6.png" width="230" height="230"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреАрд╡рд╛рд░реЗрдВ рд░рд╛рд╕реНрддреЗ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рддреА рд╣реИрдВред </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рджреАрд╡рд╛рд░реЛрдВ рдореЗрдВ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╕рд╣реА рд░рд╛рд╕реНрддреЗ рд╣реИрдВ, рдЖрдкрдХреЛ рдХреНрдпреВрдмреНрд╕ рдХреЛ рдкрд╛рд░рднрд╛рд╕реА рдмрдирд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d9b/2f6/70c/d9b2f670c9bcf0fc568c1484750c2e77.png" width="230" height="230"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╛рд░рджрд░реНрд╢реА рджреАрд╡рд╛рд░реЗрдВред </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╕рднреА рд░рд╛рд╕реНрддреЛрдВ рдХреЗ рд╕рд╣реА рд╣реЛрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рджреАрд╡рд╛рд░реЛрдВ рдХреЛ рдЙрд╕ рдХреНрд╖реЗрддреНрд░ рдХреЗ рдПрдХ рд╣рд┐рд╕реНрд╕реЗ рдХреЛ рдШреЗрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрддреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдХреЛрдИ рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ рдирд╣реАрдВ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдо рдорд╛рдирдЪрд┐рддреНрд░ рдХреЛ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдХреЗрд╡рд▓ рдЕрдЧрд░ рдкреНрд░рддреНрдпреЗрдХ рднрд╛рдЧ рдореЗрдВ рдХрдо рд╕реЗ рдХрдо рдПрдХ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рд╣реЛред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдкреНрд░рддреНрдпреЗрдХ рджреАрд╡рд╛рд░ рдХреЛ рдПрдХ рдЦрд╛рд▓реА рдЯрд╛рдЗрд▓ рдпрд╛ рдЕрдВрдд рдмрд┐рдВрджреБ рд╕реЗ рд╕рдЯреЗ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдЕрдиреНрдпрдерд╛ рдпрд╣ рдПрдХ рдкрде рдирд╣реАрдВ рд╣реЛ рдкрд╛рдПрдЧрд╛ред </font><font style="vertical-align: inherit;">рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, 3 ├Ч 3 рджреАрд╡рд╛рд░реЛрдВ рдХрд╛ рдПрдХ рдареЛрд╕ рдмреНрд▓реЙрдХ рдмрдирд╛рдирд╛ рдЕрд╕рдВрднрд╡ рд╣реИред</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд░рд╛рд╕реНрддрд╛ рдЫрд┐рдкрд╛рдУ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд░рд╛рд╕реНрддреЛрдВ рдХрд╛ рд╡рд┐рдЬрд╝реБрдЕрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рд╣рдореЗрдВ рдпрд╣ рджреЗрдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдХрд┐ рдкрде рдЦреЛрдЬ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддреА рд╣реИ рдФрд░ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдпрд╣ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╕рд╣реА рд╣реИред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдпрд╣ рдЦрд┐рд▓рд╛рдбрд╝реА рдХреЛ рджрд┐рдЦрд╛рдиреЗ рдХреА рдЬрд░реВрд░рдд рдирд╣реАрдВ рд╣реИ, рдпрд╛ рдХрдо рд╕реЗ рдХрдо рдЬрд░реВрд░реА рдирд╣реАрдВ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рдЖрдЗрдП рддреАрд░ рдХреЛ рдмрдВрдж рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдкреНрд░рджрд╛рди рдХрд░реЗрдВред </font><font style="vertical-align: inherit;">рдпрд╣ </font></font><code>GameTile</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рдзрд┐ </font><font style="vertical-align: inherit;">рд╕реЗ рдЬреЛрдбрд╝рдХрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ </font></font><code>HidePath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдЬреЛ рдмрд╕ рдЗрд╕рдХреЗ рддреАрд░ рдХреЛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдХрд░рддрд╛ рд╣реИред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HidePath</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { arrow.gameObject.SetActive(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрде рдореИрдкрд┐рдВрдЧ рд╕реНрдерд┐рддрд┐ рдлрд╝реАрд▓реНрдб рд╕реНрдерд┐рддрд┐ рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЕрдкрдиреЗ рд░рд╛рдЬреНрдп рдХреЛ рдЯреНрд░реИрдХ </font></font><code>GameBoard</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдХреЗ рдмрд░рд╛рдмрд░ </font><font style="vertical-align: inherit;">рдПрдХ </font><font style="vertical-align: inherit;">рдмреВрд▓рд┐рдпрди рдлрд╝реАрд▓реНрдб </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝реЗрдВ </font></font><code>false</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рд╕рд╛рде рд╣реА рдПрдХ рдЧреЗрдЯрд░ рдФрд░ рд╕реЗрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд╕рдВрдкрддреНрддрд┐ред </font><font style="vertical-align: inherit;">рд╕реЗрдЯрд░ рдХреЛ рд╕рднреА рдЯрд╛рдЗрд▓реЛрдВ рдкрд░ рдкрде рджрд┐рдЦрд╛рдирд╛ рдпрд╛ рдЫрд┐рдкрд╛рдирд╛ рд╣реЛрдЧрд╛ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> showPaths; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> ShowPaths { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> =&gt; showPaths; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { showPaths = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (showPaths) { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (GameTile tile <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tiles) { tile.ShowPath(); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (GameTile tile <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tiles) { tile.HidePath(); } } } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рдкрджреНрдзрддрд┐ </font></font><code>FindPaths</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛ рдЕрджреНрдпрддрди рдкрде рджрд┐рдЦрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬрдм рд░реЗрдВрдбрд░рд┐рдВрдЧ рд╕рдХреНрд╖рдо рд╣реЛред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FindPaths</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { тАж <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (showPaths) { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (GameTile tile <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tiles) { tile.ShowPath(); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рдкрде рд╡рд┐рдЬрд╝реБрдЕрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рдЕрдХреНрд╖рдо рд╣реИред </font><font style="vertical-align: inherit;">рдЯрд╛рдЗрд▓ рдкреНрд░реАрдлрд╝реИрдм рдореЗрдВ рддреАрд░ рдХреЛ рдмрдВрдж рдХрд░реЗрдВред</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a5a/c71/802/a5ac718028d1bb41c145dfabba9051e1.png" width="320" height="44"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░реАрдлрд╝реИрдм рддреАрд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдирд┐рд╖реНрдХреНрд░рд┐рдп рд╣реИред </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо рдЗрд╕реЗ рдмрдирд╛рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдпрд╣ </font></font><code>Game</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рдХреБрдВрдЬреА рджрдмрд╛рдП рдЬрд╛рдиреЗ рдкрд░ рд╡рд┐рдЬрд╝реБрдЕрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рд╕реНрдерд┐рддрд┐ рдХреЛ рд╕реНрд╡рд┐рдЪ рдХрд░реЗред </font><font style="vertical-align: inherit;">рдкреА рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рддрд░реНрдХрд╕рдВрдЧрдд рд╣реЛрдЧрд╛, рд▓реЗрдХрд┐рди рдПрдХрддрд╛ рд╕рдВрдкрд╛рджрдХ рдореЗрдВ рдЧреЗрдо рдореЛрдб рдХреЛ рд╕рдХреНрд╖рдо / рдЕрдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣ рдПрдХ рд╣реЙрдЯрдХреА рднреА рд╣реИред </font><font style="vertical-align: inherit;">рдирддреАрдЬрддрди, рд╡рд┐рдЬрд╝реБрдЕрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рддрдм рд╕реНрд╡рд┐рдЪ рдХрд░реЗрдЧрд╛ рдЬрдм рдЧреЗрдо рдореЛрдб рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЙрдЯрдХреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдмрд╣реБрдд рдЕрдЪреНрдЫрд╛ рдирд╣реАрдВ рджрд┐рдЦрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рддреЛ рдЖрдЗрдП V рдХреБрдВрдЬреА (рд╡рд┐рдЬрд╝реБрдЕрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖рд┐рдкреНрдд) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a9c/a96/15c/a9ca9615c10cdab502f1769443ad6b38.png" width="230" height="230"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛрдИ рддреАрд░ рдирд╣реАрдВред</font></font></i> <br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЧреНрд░рд┐рдб рдкреНрд░рджрд░реНрд╢рди </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрдм рддреАрд░ рдЫрд┐рдкреЗ рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рдкреНрд░рддреНрдпреЗрдХ рдЯрд╛рдЗрд▓ рдХреЗ рд╕реНрдерд╛рди рдХреЛ рд╕рдордЭрдирд╛ рдореБрд╢реНрдХрд┐рд▓ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЧреНрд░рд┐рдб рд▓рд╛рдЗрдиреЛрдВ рдХреЛ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВред </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣рд╛рдБ рд╕реЗ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдПрдХ </font><font style="vertical-align: inherit;">рдЪреМрдХреЛрд░ рдмреЙрд░реНрдбрд░ рдореЗрд╢ рдЯреЗрдХреНрд╕рдЪрд░ </font><font style="vertical-align: inherit;">рдбрд╛рдЙрдирд▓реЛрдб </font><a href=""><font style="vertical-align: inherit;">рдХрд░реЗрдВ</font></a><font style="vertical-align: inherit;"> рдЬрд┐рд╕реЗ рдПрдХ рдЕрд▓рдЧ рдЯрд╛рдЗрд▓ рдХреА рд░реВрдкрд░реЗрдЦрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4c1/e98/483/4c1e984836babfc368136b83ac2b195b.png" width="128" height="128"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореЗрд╖ рдмрдирд╛рд╡рдЯред</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣рдо рдкреНрд░рддреНрдпреЗрдХ рдЯрд╛рдЗрд▓ рдореЗрдВ рд╡реНрдпрдХреНрддрд┐рдЧрдд рд░реВрдк рд╕реЗ рдЗрд╕ рдмрдирд╛рд╡рдЯ рдХреЛ рдирд╣реАрдВ рдЬреЛрдбрд╝реЗрдВрдЧреЗ, рд▓реЗрдХрд┐рди рдЗрд╕реЗ рдЬрдореАрди рдкрд░ рд▓рд╛рдЧреВ рдХрд░реЗрдВрдЧреЗред рд▓реЗрдХрд┐рди рд╣рдо рдЗрд╕ рдЧреНрд░рд┐рдб рдХреЛ рд╡реИрдХрд▓реНрдкрд┐рдХ рдмрдирд╛рдПрдВрдЧреЗ, рд╕рд╛рде рд╣реА рд░рд╛рд╕реНрддреЛрдВ рдХрд╛ рджреГрд╢реНрдп рднреА рдмрдирд╛рдПрдВрдЧреЗред рдЗрд╕рд▓рд┐рдП, рд╣рдо </font></font><code>GameBoard</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝реАрд▓реНрдб рдореЗрдВ </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝ рджреЗрдВрдЧреЗ </font></font><code>Texture2D</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ рдЗрд╕рдХреЗ рд▓рд┐рдП рдПрдХ рдореЗрд╖ рдмрдирд╛рд╡рдЯ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВрдЧреЗред</font></font><br><br><pre> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">SerializeField</span></span>] Texture2D gridTexture = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>;</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ed4/99a/28e/ed499a28e82a3328c010a71ba1085316.png" width="320" height="94"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореЗрд╖ рдмрдирд╛рд╡рдЯ рдХреЗ рд╕рд╛рде рдХреНрд╖реЗрддреНрд░ред </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЧреНрд░рд┐рдб рджреГрд╢реНрдп рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдФрд░ рдмреБрд▓рд┐рдпрди рдлрд╝реАрд▓реНрдб рдФрд░ рдПрдХ рд╕рдВрдкрддреНрддрд┐ рдЬреЛрдбрд╝реЗрдВред </font><font style="vertical-align: inherit;">рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╕реЗрдЯрд░ рдХреЛ рдкреГрдереНрд╡реА рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдмрджрд▓рдирд╛ рд╣реЛрдЧрд╛, рдЬрд┐рд╕реЗ рдкреГрдереНрд╡реА рдХреЛ рдХреЙрд▓ рдХрд░рдХреЗ </font></font><code>GetComponent&lt;MeshRenderer&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ </font></font><code>material</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд░рд┐рдгрд╛рдо </font><font style="vertical-align: inherit;">рдХреА рд╕рдВрдкрддреНрддрд┐ рддрдХ рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд </font><font style="vertical-align: inherit;">рдХрд░рдХреЗ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдЧреНрд░рд┐рдб рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рддреЛ рд╣рдо </font></font><code>mainTexture</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рднреМрддрд┐рдХ </font><font style="vertical-align: inherit;">рд╕рдВрдкрддреНрддрд┐ рдХреЛ </font><font style="vertical-align: inherit;">рдЧреНрд░рд┐рдб рдмрдирд╛рд╡рдЯ </font><font style="vertical-align: inherit;">рдЕрд╕рд╛рдЗрди рдХрд░реЗрдВрдЧреЗ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЕрдиреНрдпрдерд╛, рдЙрд╕реЗ рдЕрд╕рд╛рдЗрди рдХрд░реЗрдВ </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЬрдм рдЖрдк рд╕рд╛рдордЧреНрд░реА рдХреА рдмрдирд╛рд╡рдЯ рдмрджрд▓рддреЗ рд╣реИрдВ, рддреЛ рд╕рд╛рдордЧреНрд░реА рдЖрд╡реГрддреНрддрд┐ рдХреЗ рдбреБрдкреНрд▓рд┐рдХреЗрдЯ рдмрдирд╛рдП рдЬрд╛рдПрдВрдЧреЗ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рднреМрддрд┐рдХ рд╕рдВрдкрддреНрддрд┐ рд╕реЗ рд╕реНрд╡рддрдВрддреНрд░ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> showGrid, showPaths; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> ShowGrid { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> =&gt; showGrid; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { showGrid = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; Material m = ground.GetComponent&lt;MeshRenderer&gt;().material; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (showGrid) { m.mainTexture = gridTexture; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { m.mainTexture = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ </font></font><code>Game</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓рд┐рдП рдЧреНрд░рд┐рдб рджреГрд╢реНрдп рджрдмрд╛рдиреЗ рдЬреА рджреНрд╡рд╛рд░рд╛ рдмрдВрдж</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { тАж <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetKeyDown(KeyCode.G)) { board.ShowGrid = !board.ShowGrid; } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдореЗрд╖ рд╡рд┐рдЬрд╝реБрдЕрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рдХреЛ рдЗрд╕рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ </font></font><code>Awake</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Awake</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { board.Initialize(boardSize, tileContentFactory); board.ShowGrid = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b04/145/190/b04145190e5d8f15972f25374d7f5813.png" width="230" height="230"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдирд╕реНрдХрд┐рд▓реНрдб рдЧреНрд░рд┐рдбред </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рддрдХ рд╣рдореЗрдВ рдкреВрд░реЗ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдПрдХ рд╕реАрдорд╛ рдорд┐рд▓ рдЧрдИ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рдмрдирд╛рд╡рдЯ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рд╡рд╣ рдирд╣реАрдВ рд╣реИ рдЬреЛ рд╣рдореЗрдВ рдЪрд╛рд╣рд┐рдПред </font><font style="vertical-align: inherit;">рд╣рдореЗрдВ рд╕рд╛рдордЧреНрд░реА рдХреА рдореБрдЦреНрдп рдмрдирд╛рд╡рдЯ рдХреЛ рд╕реНрдХреЗрд▓ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдпрд╣ рдЧреНрд░рд┐рдб рдХреЗ рдЖрдХрд╛рд░ рд╕реЗ рдореЗрд▓ рдЦрд╛рдПред </font><font style="vertical-align: inherit;">рдЖрдк рдЗрд╕реЗ </font><em><font style="vertical-align: inherit;">рдЯреЗрдХреНрд╕рдЯрд╛рдЗрд▓</font></em></font><code>SetTextureScale</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкреНрд░реЙрдкрд░реНрдЯреА ( </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_MainTex</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) рдФрд░ рдЯреВ-рдбрд╛рдпрдореЗрдВрд╢рдирд▓ рд╕рд╛рдЗрдЬ </font><font style="vertical-align: inherit;">рдХреЗ рдирд╛рдо рд╕реЗ рдордЯреАрд░рд┐рдпрд▓ </font><font style="vertical-align: inherit;">рдореЗрдердб рдХрд╣рдХрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рд╣рдо рд╕реАрдзреЗ рдХреНрд╖реЗрддреНрд░ рдХреЗ рдЖрдХрд╛рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ рдЕрдкреНрд░рддреНрдпрдХреНрд╖ рд░реВрдк рд╕реЗ рдПрдХ рдореВрд▓реНрдп рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рд╣реЛрддрд╛ рд╣реИ </font></font><code>Vector2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (showGrid) { m.mainTexture = gridTexture; m.SetTextureScale(<span class="hljs-string"><span class="hljs-string">"_MainTex"</span></span>, size); }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/edb/d2a/b85/edbd2ab858e40a61d5f89452a8809b33.png" width="230" height="230" alt="рдмрд┐рдирд╛"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8bd/91a/ae5/8bd91aae589309dbd64994bb10a935a9.png" width="230" height="230" alt="рд╕рд╛рде"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрде рджреГрд╢реНрдп рдХреЗ рд╕рд╛рде рд╕реНрдХреЗрд▓ рдЧреНрд░рд┐рдб рдмрдВрдж рдФрд░ рдЪрд╛рд▓реВред </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рдЗрд╕ рд╕реНрддрд░ рдкрд░, рд╣рдореЗрдВ рдЯреЙрд╡рд░ рд░рдХреНрд╖рд╛ рд╢реИрд▓реА рдХреЗ рдПрдХ рдЯрд╛рдЗрд▓ рдЧреЗрдо рдХреЗ рд▓рд┐рдП рдПрдХ рдХрд╛рд░реНрдп рдХреНрд╖реЗрддреНрд░ рдорд┐рд▓рд╛ред </font><font style="vertical-align: inherit;">рдЕрдЧрд▓реЗ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдореЗрдВ рд╣рдо рджреБрд╢реНрдордиреЛрдВ рдХреЛ рдЬреЛрдбрд╝реЗрдВрдЧреЗред </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">рдкреАрдбреАрдПрдл </font></a></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА</font></font></a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"></font></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi449798/">https://habr.com/ru/post/hi449798/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi449784/index.html">рдЬрд┐рди рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдпрд╣ Django рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд▓рд╛рдпрдХ рд╣реИ (рдФрд░ рдЬрд┐рд╕рдореЗрдВ рдпрд╣ рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реИ)</a></li>
<li><a href="../hi449788/index.html">рдмрд╣рд╛рджреБрд░ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХ рдЗрдирд╛рдо-рдЖрдзрд╛рд░рд┐рдд рд╡рд┐рдЬреНрдЮрд╛рдкрди рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдкреЗрд╢ рдХрд░рддрд╛ рд╣реИ</a></li>
<li><a href="../hi449790/index.html">рдЙрддреНрдкрд╛рдж рд╡рд┐рдХрд╛рд╕ рджреГрд╢реНрдп рд╕рд╣рд╛рдпрддрд╛: рдбрд┐рдЬрд╛рдЗрди</a></li>
<li><a href="../hi449794/index.html">рдЕрдиреБрдХреВрд▓реА рдПрдВрдЯреАрдирд╛: рдпрд╣ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ? (рдЖрдзрд╛рд░)</a></li>
<li><a href="../hi449796/index.html">рдПрдХ рд▓рдбрд╝рдХреА рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ</a></li>
<li><a href="../hi449802/index.html">рдХреИрд░рд┐рдпрд░ рдкреНрд░реЛрдЧреНрд░рд╛рдорд░ред рднрд╛рдЧ 1. рдкрд╣рд▓рд╛ рдХрд╛рд░реНрдпрдХреНрд░рдо</a></li>
<li><a href="../hi449804/index.html">Biohackers рдХреЗ рд▓рд┐рдП рдПрдВрдЯреА-рдПрдЬрд┐рдВрдЧ рдереЗрд░реЗрдкреА рдХрд╛ рдЕрд╡рд▓реЛрдХрди</a></li>
<li><a href="../hi449806/index.html">рдХреИрд░рд┐рдпрд░ рдкреНрд░реЛрдЧреНрд░рд╛рдорд░ред рднрд╛рдЧ 2. рд╕реНрдХреВрд▓ рдпрд╛ рд╕реНрд╡-рд╢рд┐рдХреНрд╖рд╛</a></li>
<li><a href="../hi449808/index.html">рд╕рдХрд╛рд░рд╛рддреНрдордХ рд╣реИрдХ рджрд┐рди 9 рдкреНрд░рдпреЛрдЧ: рдХреИрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕реЛрдЪ рдЬреАрд╡рди рдФрд░ рдХрд╛рдо рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИ</a></li>
<li><a href="../hi449814/index.html">рд╡рд┐рдВрдбреЛрдЬ рдПрдХреНрд╕рдкреА рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рддреМрд░ рдкрд░ рдореГрдд рд╣реИ, рдЕрдм рдЕрдВрдд рдореЗрдВ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>