<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§πüèº üà∫ üë®üèª‚Äç‚úàÔ∏è Akka antipatterns: demasiados actores üçî üë©üèæ‚Äçüé® üóúÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Por akka hay pocos materiales sobre Habr√©. Decid√≠ traducir algunos de los antipatrones descritos por Manuel en su blog. Realmente pueden no ser obvios...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Akka antipatterns: demasiados actores</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/420639/"><img src="https://habrastorage.org/webt/qx/zr/fg/qxzrfgwmebe3dou1nddp-sx5hou.jpeg" alt="imagen"><br><br>  Por akka hay pocos materiales sobre Habr√©.  Decid√≠ traducir algunos de los antipatrones descritos por Manuel en su blog.  Realmente pueden no ser obvios para las personas que se encontraron por primera vez con el marco. <br><a name="habracut"></a><br>  Se me ocurri√≥ que todav√≠a no hab√≠a escrito sobre este antipatr√≥n muy frecuente.  A menudo se puede encontrar en el c√≥digo de los desarrolladores que reci√©n comienzan a trabajar con el modelo de actor. <br><br>  Hay dos formas de obtener demasiados actores: <br><br>  - haber desarrollado un sistema con demasiados tipos diferentes de actores, muchos de los cuales no son necesarios <br>  - crear una gran cantidad de actores en tiempo de ejecuci√≥n cuando no es necesario e ineficiente <br><br>  Veamos estas opciones en detalle. <br><br><h3>  Demasiados tipos de actores </h3><br>  La idea general es algo como esto: "tenemos actores, por lo que todo deber√≠a ser un actor". <br><br>  El modelo de actor simplifica la escritura de aplicaciones asincr√≥nicas.  Lo hace al proporcionar la ilusi√≥n de ejecuci√≥n de c√≥digo s√≠ncrono dentro de un actor: no hay necesidad de preocuparse por el acceso concurrente al estado de un actor, porque solo un actor puede acceder a su estado y los mensajes se procesan uno a la vez. <br><br>  Pero, de hecho, no todo debe hacerse de forma asincr√≥nica.  Las llamadas a m√©todos que est√°n asociadas exclusivamente con la CPU (y no est√°n "bloqueadas" en el sentido de que no sobrecargan completamente la CPU, por ejemplo, al calcular el valor de Pi), no deben realizarse de forma as√≠ncrona. <br><br>  A menudo veo c√≥digo con una gran cantidad de actores diferentes que interact√∫an entre s√≠ y no hacen nada, lo que tiene una gran ventaja en la ejecuci√≥n as√≠ncrona o simult√°nea.  En estos proyectos, cada uno de estos actores debe almacenar el mismo estado o transmitirlo en cada mensaje. <br><br>  Este enfoque tiene dos inconvenientes: <br><br>  "No se obtiene nada en t√©rminos de rendimiento".  Por el contrario, existe una sobrecarga asociada con la creaci√≥n de mensajes y su transmisi√≥n. <br>  - Con cada tipo de actor y mensajes relacionados, el sistema se vuelve m√°s dif√≠cil de entender y mantener. <br><br>  Por lo tanto, al dise√±ar sistemas de actores, debe pensar en lo que deber√≠a ser realmente as√≠ncrono, b√°sicamente esto: <br><br>  - llamadas a sistemas externos (fuera de su jvm) <br>  - llamadas a operaciones de bloqueo (API desactualizadas, computaci√≥n pesada, ...) <br><br><h3>  Demasiados actores en tiempo de ejecuci√≥n </h3><br>  La idea general es algo como esto: "cuantos m√°s actores tengamos, m√°s r√°pido ir√° todo". <br><br>  En realidad, los actores son livianos y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">puedes ejecutar millones de ellos en una m√°quina virtual</a> .  Si puedes.  ¬øPero es necesario? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vj/e3/lt/vje3ltv7mdcav3hptghw2zchn4m.png" alt="imagen"></div><br>  Si puedes, no significa que debas <br><br>  Respuesta corta: no siempre, depende de lo que hagas con los actores. <br><br>  Si su sistema tiene muchos actores de larga vida, cada uno de los cuales contiene un peque√±o estado e interact√∫a entre s√≠ de vez en cuando, es muy posible que est√© con un mill√≥n de actores, y este es un caso de uso leg√≠timo, muy bien respaldado por Akka.  Por ejemplo, puede crear un sistema con una gran cantidad de usuarios, donde cada usuario est√° representado por un actor.  Un actor puro de Akka ocupa solo 300 bytes de memoria, por lo que es muy posible crear millones en una m√°quina y dejarlos trabajando sin preocuparse por nada.  Y si al final crea una gran cantidad de actores o actores con una gran fortuna que ya no encajar√°n en la memoria de una m√°quina, el fragment de cl√∫ster simplificar√° la distribuci√≥n de actores en varias m√°quinas. <br><br>  Sin embargo, si tiene varios tipos de actores que participan en el c√°lculo de algo, por ejemplo, analizar un documento XML, es dudoso crear millones de dichos actores (no importa directamente o a trav√©s de un enrutador). <br><br>  El procesador tiene un n√∫mero fijo de n√∫cleos (hilos de hardware) a su disposici√≥n, y los actores de Akka procesan los mensajes en un ExecutionContext basado en un grupo de hilos.  Por defecto, este es fork-join-ejecutor basado en ForkJoinPool agregado en Java 7. <br><br>  Pero, a pesar de su ventaja t√©cnica, forkjoinpool no es magia que deroga las leyes de la f√≠sica.  Si tiene un mill√≥n de actores, cada uno de los cuales analiza un documento XML (ya cargado en la memoria) y 4 subprocesos de hardware, el sistema no funcionar√° mucho mejor que si solo tuviera 4 actores que analicen estos documentos XML (cuando condici√≥n de carga homog√©nea).  De hecho, su sistema funcionar√° mucho mejor con 4 actores porque solo habr√° una sobrecarga m√≠nima en t√©rminos de planificaci√≥n y gesti√≥n de memoria.  Por cierto, si su sistema tiene solo unos pocos actores, verifique su grupo de subprocesos, que probablemente est√© tratando de reutilizar el mismo subproceso para el mismo actor. <br><br>  En general, el sistema no funcionar√° m√°s r√°pido si crea muchos actores. <br><br><h3>  Actores ap√°tridas </h3><br>  Los actores est√°n orientados a objetos correctamente (a diferencia de, por ejemplo, los objetos en Java): su estado no es visible desde el exterior y se comunican a trav√©s de mensajes.  Es imposible romper la encapsulaci√≥n, porque no puedes mirar el estado del actor durante su trabajo.  Este es el objetivo de los actores: le brindan la ilusi√≥n de un espacio seguro en el que los mensajes se ejecutan secuencialmente, uno tras otro, lo que le permite usar un estado mutable dentro de su actor sin preocuparse por las condiciones de la carrera (condiciones de la carrera - aprox. Por.) (Bueno, casi sin preocuparse: lo principal es no dejar que el estado se filtre). <br><br>  Es por eso que el uso de actores que no tienen estado es algo extra√±o, por decir lo menos.  Con la excepci√≥n de los actores que controlan la observaci√≥n de grandes partes de la jerarqu√≠a del sistema de actores (por ejemplo, la creaci√≥n de supervisores de respaldo), los actores est√°n realmente dise√±ados para trabajar con c√°lculos largos que tienen estado.  Hablando mucho, quiero decir que el actor procesar√° varios mensajes a lo largo de su vida, produciendo diferentes resultados dependiendo de su condici√≥n, a diferencia de los c√°lculos √∫nicos.  Para ellos, los futuros son una gran abstracci√≥n: permiten la ejecuci√≥n de c√≥digo as√≠ncrono, ideal para casos de trabajo con una red o inform√°tica relacionada con el disco (o tareas de procesador realmente intensas), pueden estar compuestos y tener un mecanismo de procesamiento de fallas.  Tambi√©n se integran bien con los actores Akka (usando el patr√≥n de tuber√≠a). <br><br>  En general: no use actores si no tiene un estado, no est√°n destinados a esto. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es420639/">https://habr.com/ru/post/es420639/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es420629/index.html">PHP Digest No. 137 (6 al 20 de agosto de 2018)</a></li>
<li><a href="../es420631/index.html">No tenemos miedo a las "nubes"</a></li>
<li><a href="../es420633/index.html">Escribir un exportador GeoIP para Prometheus con visualizaciones en Grafana en 15 minutos</a></li>
<li><a href="../es420635/index.html">AI, curso pr√°ctico. El modelo b√°sico para reconocer emociones en im√°genes.</a></li>
<li><a href="../es420637/index.html">Revisi√≥n de la impresora 3D WANHAO D9 / 300: video</a></li>
<li><a href="../es420641/index.html">El soporte t√©cnico de 3CX responde: copia de seguridad y restauraci√≥n de 3CX desde la l√≠nea de comandos</a></li>
<li><a href="../es420643/index.html">Casi todo es igual, solo 10 veces m√°s barato</a></li>
<li><a href="../es420645/index.html">Ingenieros de contrataci√≥n realistas</a></li>
<li><a href="../es420647/index.html">¬øPor qu√© los personajes de videojuegos casi nunca se desnudan?</a></li>
<li><a href="../es420651/index.html">Los cient√≠ficos descubren evidencia de precedentes desagradables relacionados con el cambio clim√°tico</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>