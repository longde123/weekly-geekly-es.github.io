<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ù§Ô∏è üë¶üèø üì™ Impl√©mentation de l'interface utilisateur d'OpenStack LBaaS üë®üèº‚Äçüé§ ‚§µÔ∏è üë≤üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Lorsque j'ai impl√©ment√© l'interface utilisateur de l' √©quilibreur de charge pour un cloud priv√© virtuel, j'ai d√ª faire face √† des difficult√©s importan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Impl√©mentation de l'interface utilisateur d'OpenStack LBaaS</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/selectel/blog/455523/"><img src="https://habrastorage.org/webt/ct/q8/3-/ctq83--b7viz0r6evi5um6brnam.png"><br><br>  Lorsque j'ai impl√©ment√© l'interface utilisateur de l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√©quilibreur</a> de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">charge</a> pour un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cloud priv√© virtuel,</a> j'ai d√ª faire face √† des difficult√©s importantes.  Cela m'a amen√© √† r√©fl√©chir sur le r√¥le du frontend, que je veux partager en premier lieu.  Et puis justifier leurs pens√©es, en utilisant l'exemple d'une t√¢che sp√©cifique. <br><br>  La solution au probl√®me s'est av√©r√©e, √† mon avis, assez cr√©ative, et j'ai d√ª la chercher dans un cadre tr√®s limit√©, donc je pense que cela peut √™tre int√©ressant. <br><a name="habracut"></a><br><h2>  R√¥le frontal </h2><br>  Je dois dire tout de suite que je ne pr√©tends pas la v√©rit√© et que je soul√®ve une question controvers√©e.  Je suis quelque peu d√©prim√© par l'ironie du front-end et du web en particulier, comme quelque chose d'insignifiant.  Et il est encore plus d√©primant que cela arrive parfois raisonnablement.  Maintenant, la mode √©tait d√©j√† endormie, mais il fut un temps o√π tout le monde se promenait avec des cadres, des paradigmes et d'autres entit√©s, disant haut et fort que tout cela √©tait super important et super n√©cessaire, et en retour, ils ont re√ßu l'ironie que le front-end traite de la sortie des formulaires et traitement des clics sur les boutons, ce qui peut se faire ¬´sur le genou¬ª. <br><br>  Maintenant, il semble que tout soit plus ou moins revenu √† la normale.  Personne ne veut vraiment parler de chaque version mineure du prochain framework.  Peu de gens recherchent l'outil ou l'approche parfaite, en raison de la prise de conscience croissante de leur utilit√©.  Mais m√™me cela, par exemple, n'interf√®re pas avec la r√©primande presque d√©raisonnable d'Electron et ses applications.  Je pense que cela est d√ª √† un manque de compr√©hension de la t√¢che r√©solue par le front-end. <br><br>  Le frontend n'est pas seulement un moyen d'afficher les informations fournies par le backend, et pas seulement un moyen de traiter les actions des utilisateurs.  Le frontend est quelque chose de plus, quelque chose d'abstrait, et si vous lui donnez une d√©finition simple et claire, alors le sens sera in√©vitablement perdu. <br><br>  L'interface est dans un ¬´cadre¬ª.  Par exemple, en termes techniques, elle se situe entre l'API fournie par le backend et l'API fournie par les fonctionnalit√©s d'E / S.  En termes de t√¢ches, c'est entre les t√¢ches de l'interface utilisateur que UX r√©sout et les t√¢ches que le backend r√©sout.  Ainsi, une sp√©cialisation frontend assez √©troite est obtenue, une sp√©cialisation de la couche.  Cela ne signifie pas que les prestataires frontaux ne peuvent pas exercer d'influence sur des domaines en dehors de leur sp√©cialisation, mais au moment o√π cette influence est impossible, la v√©ritable t√¢che frontale se pose. <br><br>  Ce probl√®me peut s'exprimer √† travers une contradiction.  L'interface utilisateur n'est pas requise pour se conformer aux mod√®les de donn√©es et au comportement du backend.  Les mod√®les de comportement et de donn√©es du backend ne sont pas requis pour s'adapter aux t√¢ches de l'interface utilisateur.  Et puis la t√¢che du front-end est d'√©liminer cette contradiction.  Plus l'√©cart entre les t√¢ches du backend et l'interface utilisateur est important, plus le r√¥le du frontend est important.  Et pour clarifier ce dont je parle, je vais donner un exemple o√π cet √©cart, pour une raison quelconque, s'est av√©r√© important. <br><br><h2>  √ânonc√© du probl√®me </h2><br>  OpenStack LBaaS, √† mon avis, est un complexe mat√©riel-logiciel d'outils n√©cessaires pour √©quilibrer la charge entre les serveurs.  Il est important pour moi que sa mise en ≈ìuvre d√©pende de facteurs objectifs, de l'affichage physique.  Pour cette raison, il y a des particularit√©s dans l'API et dans les fa√ßons d'interagir avec cette API. <br><br>  Lors du d√©veloppement d'une interface utilisateur, l'int√©r√™t principal n'est pas les caract√©ristiques techniques du backend, mais ses capacit√©s fondamentales.  L'interface est cr√©√©e pour l'utilisateur, et l'utilisateur a besoin d'une interface pour g√©rer les param√®tres d'√©quilibrage, et l'utilisateur n'a pas besoin de plonger dans les fonctionnalit√©s internes de l'impl√©mentation du backend. <br><br>  Le backend est majoritairement d√©velopp√© par la communaut√©, et il est possible d'influencer son d√©veloppement en quantit√©s tr√®s limit√©es.  L'une des principales caract√©ristiques pour moi est que les d√©veloppeurs d'arri√®re-plan sont pr√™ts √† sacrifier la commodit√© et la simplicit√© des contr√¥les pour des raisons de performance, et cela est absolument justifi√©, car il s'agit d'√©quilibrer la charge. <br><br>  Il y a encore un point subtil, et je veux le souligner imm√©diatement, en mettant en garde contre certaines questions.  Il est clair que sur OpenStack et leur API, la lumi√®re n'a pas converg√©.  Vous pouvez toujours d√©velopper votre propre ensemble d'outils ou une ¬´couche¬ª qui fonctionnera avec l'API OpenStack, produisant sa propre API qui convient aux t√¢ches utilisateur.  La seule question est l'opportunit√©.  Si les outils initialement disponibles vous permettent d'impl√©menter l'interface utilisateur comme pr√©vu, est-il judicieux de produire des entit√©s? <br><br>  La r√©ponse √† cette question est multiforme et pour les entreprises, elle reposera sur les d√©veloppeurs, leur emploi, leur comp√©tence, les questions de responsabilit√©, de support, etc.  Dans notre cas, il √©tait pr√©f√©rable de r√©soudre certaines des t√¢ches sur le front-end. <br><br><h3>  Caract√©ristiques d'OpenStack LBaaS </h3><br>  Je veux identifier uniquement les fonctionnalit√©s qui ont eu une forte influence sur l'interface.  Les questions expliquant pourquoi ces fonctionnalit√©s sont apparues ou sur lesquelles elles s'appuient d√©passent d√©j√† le cadre de cet article. <br><br>  Je travaille avec une documentation toute faite et je dois accepter ses fonctionnalit√©s.  Ceux qui sont int√©ress√©s par ce qu'est OpenStack Octavia de l'int√©rieur peuvent se familiariser avec la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation officielle</a> .  Octavia est le nom d'un ensemble d'outils con√ßus pour √©quilibrer la charge dans l'√©cosyst√®me OpenStack. <br><br>  La premi√®re caract√©ristique que j'ai rencontr√©e pendant le d√©veloppement est le grand nombre de mod√®les et de relations n√©cessaires pour afficher l'√©tat de l'√©quilibreur.  L' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">API Octavia</a> d√©crit 12 mod√®les, mais seulement 7 sont n√©cessaires pour le c√¥t√© client. Ces mod√®les ont des connexions, souvent d√©normalis√©es, l'image ci-dessous montre un sch√©ma approximatif: <br><br><div style="text-align:center;"><img title="Exemple de diagramme de mod√®les et de relations OpenStack Octavia" src="https://habrastorage.org/webt/p2/fw/2v/p2fw2vvyascudv9zjx5a0m-5bkq.png"></div><br><br>  "Seven" ne semble pas tr√®s impressionnant, mais en r√©alit√©, pour assurer le bon fonctionnement de l'interface, au moment de la r√©daction de ce texte, j'ai d√ª utiliser 16 mod√®les de donn√©es et environ 30 relations entre eux.  √âtant donn√© qu'Octavia n'est qu'un √©quilibreur, il n√©cessite que d'autres modules OpenStack fonctionnent.  Et tout cela est n√©cessaire pour seulement deux pages dans l'interface utilisateur. <br><br>  Les deuxi√®me et troisi√®me fonctionnalit√©s sont Octavia <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">asynchrones</a> et transactionnelles.  Les mod√®les de donn√©es ont un champ d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√©tat</a> qui refl√®te l'√©tat des op√©rations effectu√©es sur un objet. <br><div class="scrollable-table"><table><tbody><tr><th>  Statut </th><th>  La description </th></tr><tr><td>  ACTIF </td><td>  Objet en bon √©tat </td></tr><tr><td>  SUPPRIM√â </td><td>  Objet supprim√© </td></tr><tr><td>  Erreur </td><td>  L'objet est corrompu </td></tr><tr><td>  PENDING_CREATE </td><td>  Objet en devenir </td></tr><tr><td>  PENDING_UPDATE </td><td>  Objet en cours de mise √† jour </td></tr><tr><td>  PENDING_DELETE </td><td>  Objet en cours de suppression </td></tr></tbody></table></div>  L'op√©ration de lecture d'un objet se produit de mani√®re synchrone et n'a aucune restriction.  Mais les op√©rations de cr√©ation, de mise √† jour et de suppression peuvent prendre un temps ind√©fini.  Cela est pr√©cis√©ment d√ª au fait que les mod√®les de donn√©es ont, en gros, une signification physique. <br><br>  Apr√®s avoir envoy√© une demande de cr√©ation, nous pouvons savoir que l'enregistrement est apparu, nous pouvons le lire, mais tant que l'op√©ration de cr√©ation n'est pas termin√©e, nous ne pouvons effectuer aucune autre op√©ration sur cet enregistrement.  Une telle tentative entra√Ænera une erreur.  L'op√©ration de modification d'un objet ne peut √™tre lanc√©e que lorsque l'objet est dans l'√©tat <b>ACTIF</b> ; vous pouvez envoyer un objet pour suppression dans les √©tats <b>ACTIF</b> et <b>ERREUR</b> . <br><br>  Ces statuts peuvent provenir de WebSockets, ce qui facilite grandement leur traitement, mais les transactions sont un probl√®me beaucoup plus important.  Lors de la modification d'un objet, tous les mod√®les associ√©s participeront √©galement √† la transaction.  Par exemple, lorsque vous <b>apportez des</b> modifications √† <b>Member</b> , le <b>pool</b> , l' <b>√©couteur</b> et l' <b>√©quilibreur de charge associ√©s</b> sont bloqu√©s.  Voici √† quoi cela ressemble en termes d'√©v√©nements re√ßus sur les sockets Web: <br><br><div style="text-align:center;"><img title="Processus de modification du statut des objets associ√©s." src="https://habrastorage.org/webt/ia/fp/ff/iafpffzblzikgdekdrrs83br1_y.png"></div><ul><li>  les quatre premiers √©v√©nements sont le transfert d'objets √† l'√©tat <strong>PENDING_UPDATE</strong> : le champ <strong>cible</strong> contient le nom de mod√®le de l'objet participant √† la transaction; </li><li>  le cinqui√®me √©v√©nement n'est qu'un doublon (je ne sais pas √† quoi il est li√©); </li><li>  les quatre derniers sont un retour √† l'√©tat <strong>ACTIF</strong> .  Dans ce cas, il s'agit d'une op√©ration de changement de poids, et cela prend moins d'une seconde, mais parfois cela prend beaucoup plus de temps. </li></ul><br>  Vous pouvez √©galement voir dans la capture d'√©cran que l'ordre des √©v√©nements n'a pas √† √™tre strict.  Ainsi, il s'av√®re que pour lancer une op√©ration, il est n√©cessaire de conna√Ætre non seulement le statut de l'objet lui-m√™me, mais aussi les statuts de toutes les d√©pendances qui participeront √©galement √† la transaction. <br><br><h3>  Caract√©ristiques de l'interface utilisateur </h3><br>  Imaginez-vous maintenant √† la place d'un utilisateur qui a besoin de savoir quelque part cela pour √©quilibrer entre deux serveurs: <br><br><ol><li>  Il est n√©cessaire de cr√©er un √©couteur dans lequel l'algorithme d'√©quilibrage sera d√©fini. </li><li>  Cr√©ez un pool. </li><li>  Attribuez un pool √† l'√©couteur. </li><li>  Ajoutez des liens vers des ports √©quilibr√©s au pool. </li></ol><br>  Chaque fois, il est n√©cessaire d'attendre la fin de l'op√©ration, qui d√©pend de tous les objets cr√©√©s pr√©c√©demment. <br><br>  Comme une √©tude interne l'a montr√©, de l'avis de l'utilisateur ordinaire, il n'y a qu'une prise de conscience approximative que l'√©quilibreur doit avoir un point d'entr√©e, il doit y avoir des points de sortie et les param√®tres de l'√©quilibrage √† effectuer: algorithme, poids et autres.  L'utilisateur n'a pas besoin de savoir ce qu'est OpenStack. <br><br>  Je ne sais pas √† quel point l'interface devrait √™tre compliqu√©e pour la perception, o√π l'utilisateur lui-m√™me doit suivre toutes les caract√©ristiques techniques du backend d√©crites ci-dessus.  Pour la console, cela peut √™tre autoris√©, car son utilisation implique un niveau √©lev√© d'immersion dans la technologie, mais pour le Web, une telle interface est horrible. <br><br>  Sur le Web, l'utilisateur s'attend √† remplir un formulaire clair et logique, √† appuyer sur un bouton, √† attendre et tout fonctionnera.  Peut-√™tre que cela peut √™tre argument√©, mais je propose de me concentrer sur les fonctionnalit√©s qui affectent la mise en ≈ìuvre du frontend. <br><br>  L'interface a √©t√© con√ßue de mani√®re √† impliquer l'utilisation en cascade des op√©rations: une action dans l'interface peut impliquer plusieurs op√©rations.  L'interface n'implique pas que l'utilisateur peut effectuer des actions qui ne sont actuellement pas possibles, mais l'interface suppose que l'utilisateur doit comprendre pourquoi il en est ainsi.  L'interface est un tout unique et, par cons√©quent, ses √©l√©ments individuels peuvent utiliser des informations provenant de diverses entit√©s d√©pendantes, y compris des m√©ta-informations. <br><br><div style="text-align:center;"><img title="L'interface de la liste des √©quilibreurs dans le panneau Selectel" src="https://habrastorage.org/webt/cc/no/am/ccnoamyjre40swvpswygbqezn_w.png"></div><br><br>  Si nous prenons en compte qu'il existe certaines fonctionnalit√©s de l'interface qui ne sont pas uniques √† l'√©quilibreur, telles que les commutateurs, les accord√©ons, les onglets, un menu contextuel et supposons que leurs principes de fonctionnement sont clairs au d√©part, alors je pense que pour un utilisateur qui sait ce qu'est l'√©quilibrage de charge, non il sera tr√®s difficile de lire la plupart de l'interface ci-dessus et de faire une hypoth√®se sur la fa√ßon de la g√©rer.  Mais mettre en √©vidence quelles parties de l'interface sont cach√©es derri√®re les mod√®les de l'√©quilibreur, de l'√©couteur, du pool, du membre et d'autres entit√©s n'est plus la t√¢che la plus √©vidente. <br><br><h3>  R√©soudre les contradictions </h3><br>  J'esp√®re avoir pu montrer que les fonctionnalit√©s du backend ne correspondent pas bien √† l'interface et que ces fonctionnalit√©s ne peuvent pas toujours √™tre √©limin√©es par le backend.  Parall√®lement √† cela, les fonctionnalit√©s de l'interface ne s'adaptent pas bien sur le backend, et ne peuvent pas toujours √™tre √©limin√©es sans compliquer l'interface.  Chacun de ces domaines r√©sout ses propres probl√®mes.  La responsabilit√© du front-end est de r√©soudre les probl√®mes pour assurer le niveau d'interaction n√©cessaire entre l'interface et le back-end. <br><br>  Dans ma pratique, je me suis imm√©diatement pr√©cipit√© dans la piscine avec ma t√™te, sans faire attention, ou plut√¥t sans m√™me essayer de comprendre les caract√©ristiques qui sont plus √©lev√©es, mais j'ai eu de la chance ou l'exp√©rience a aid√© (et le bon vecteur a √©t√© choisi).  J'ai moi-m√™me remarqu√© √† plusieurs reprises que lors de l'utilisation d'une API ou d'une biblioth√®que tierce, il est tr√®s utile de se familiariser √† l'avance avec la documentation: plus il y a de d√©tails, mieux c'est.  La documentation est souvent similaire, les gens comptent toujours sur l'exp√©rience des autres, mais il y a une description des caract√©ristiques de chaque syst√®me individuel, et elle est contenue dans les d√©tails. <br><br>  Si j'avais initialement pass√© quelques heures suppl√©mentaires √† √©tudier la documentation, plut√¥t que d'extraire les informations n√©cessaires par mots cl√©s, j'aurais pens√© aux probl√®mes qui devraient √™tre rencontr√©s, et cette connaissance pourrait avoir un impact sur l'architecture du projet d√®s les toutes premi√®res √©tapes.  Revenir en arri√®re pour √©liminer les erreurs commises au tout d√©but est tr√®s d√©moralisant.  Et sans contexte complet, il faut parfois revenir plusieurs fois. <br><br>  En option, vous pouvez plier votre ligne, g√©n√©rant progressivement de plus en plus de code ¬´avec une bouch√©e¬ª, mais plus ce tas de code est, plus il sera ratiss√© √† la fin.  Lors de la conception de l'architecture, bien s√ªr, il ne faut pas plonger trop profond√©ment, prendre en compte toutes les options possibles et impossibles, y consacrer beaucoup de temps, il est important de rechercher l'√©quilibre.  Mais une connaissance plus ou moins d√©taill√©e de la documentation s'av√®re souvent √™tre un investissement tr√®s utile et pas tr√®s long. <br><br>  N√©anmoins, d√®s le d√©but, apr√®s avoir vu un grand nombre de mod√®les impliqu√©s, j'ai r√©alis√© qu'il serait n√©cessaire de construire un mappage de l'√©tat du backend avec le client avec toutes les connexions pr√©serv√©es.  Apr√®s avoir r√©ussi √† afficher toutes les informations n√©cessaires sur le client, avec toutes les connexions et ainsi de suite, il a √©t√© n√©cessaire d'organiser une file d'attente de t√¢ches. <br><br>  Les donn√©es sont mises √† jour de mani√®re asynchrone, la disponibilit√© des op√©rations est d√©termin√©e par diverses conditions et lorsque des op√©rations en cascade sont requises, aucune file d'attente ne peut √™tre supprim√©e dans de telles conditions.  Peut-√™tre, en r√©sum√©, c'est toute l'architecture de ma solution: le stockage avec une r√©flexion de l'√©tat du backend et de la file d'attente des t√¢ches. <br><br><h2>  Architecture de la solution </h2><br>  En raison du nombre ind√©fini de mod√®les et de relations, j'ai mis l'√©volutivit√© dans la structure du r√©f√©rentiel en le faisant √† l'aide d'une fabrique qui renvoie une description d√©clarative des collections du r√©f√©rentiel.  La collection a un service, une classe de mod√®le simple avec CRUD.  Il serait possible de faire une description des liens dans le mod√®le, comme cela se fait, par exemple, dans RoR ou dans le bon vieux Backbone, mais cela n√©cessiterait une grande quantit√© de code √† modifier.  Par cons√©quent, la description des relations se trouve √† c√¥t√© de la classe mod√®le: <br><br><div style="text-align:center;"><img title="Exemple de description de lien" src="https://habrastorage.org/webt/_y/jw/pr/_yjwpryzsckc_by0igzpq5vlog0.png"></div><br><br>  Au total, j'ai eu 2 types de connexions: un √† un, un √† plusieurs.  La r√©troaction peut √©galement √™tre d√©crite.  En plus du type, la collection de d√©pendances est indiqu√©e, le champ auquel la d√©pendance trouv√©e est attach√©e et le champ √† partir duquel l'ID de l'objet d√©pendant est lu (en cas de communication un-√†-plusieurs, la liste des ID est lue).  Si la condition de communication d'un objet est plus compliqu√©e que de simples liens vers des objets, alors en usine on peut d√©crire la fonction de tester deux objets, dont les r√©sultats d√©termineront la pr√©sence d'une connexion.  Tout cela ressemble un peu √† ¬´v√©lo¬ª, mais cela fonctionne sans d√©pendances inutiles et exactement comme il se doit. <br><br>  Le r√©f√©rentiel dispose d'un module pour attendre l'ajout et la suppression d'une ressource, il traite essentiellement des √©v√©nements ponctuels avec v√©rification conditionnelle et avec une interface promis.  Lors de l'abonnement, le type d'√©v√©nement (ajout, suppression), la fonction de test et le gestionnaire sont transmis.  Lorsqu'un certain √©v√©nement se produit et avec un r√©sultat de test positif, le gestionnaire est ex√©cut√©, apr√®s quoi le suivi s'arr√™te.  Un √©v√©nement peut se produire lors de l'abonnement synchrone. <br><br>  L'utilisation d'un tel mod√®le a permis d'apposer automatiquement des relations arbitrairement complexes entre les mod√®les et de le faire en un seul endroit.  Cet endroit, j'ai appel√© un tracker.  Lors de l'ajout d'un objet au r√©f√©rentiel, il commence √† suivre ses relations.  Le module d'attente vous permet de r√©pondre aux √©v√©nements et de v√©rifier une connexion entre l'objet surveill√© et l'objet dans le stockage.  Si l'objet √©tait d√©j√† dans le r√©f√©rentiel, le module d'attente appelle imm√©diatement le gestionnaire. <br><br>  Un tel p√©riph√©rique de stockage vous permet de d√©crire n'importe quel nombre de collections et les relations entre elles.  Lors de l'ajout et de la suppression d'objets, le magasin place ou r√©initialise automatiquement les propri√©t√©s avec le contenu des objets d√©pendants.  Les avantages de cette approche sont que toutes les relations sont d√©crites explicitement et qu'elles sont surveill√©es et mises √† jour par un seul syst√®me;  inconv√©nients - dans la complexit√© de la mise en ≈ìuvre et du d√©bogage. <br><br>  En g√©n√©ral, un tel r√©f√©rentiel est plut√¥t trivial et je l'ai fait moi-m√™me, car il serait beaucoup plus difficile d'int√©grer une solution pr√™te √† l'emploi dans une base de code existante, mais il serait encore plus difficile d'attacher une file d'attente de t√¢ches √† une solution pr√™te √† l'emploi. <br><br>  Toutes les t√¢ches, comme les collections, ont une description d√©clarative et sont cr√©√©es par l'usine.  Les t√¢ches peuvent avoir dans la description les conditions de d√©marrage et une liste des t√¢ches qui devront √™tre ajout√©es √† la file d'attente une fois celle-ci termin√©e. <br><br><div style="text-align:center;"><img title="Un exemple de g√©n√©ration d'une t√¢che pour cr√©er un pool" src="https://habrastorage.org/webt/03/7w/fo/037wfo0c0fn7uxeblixnsahw7j8.png"></div><br>  L'exemple ci-dessus d√©crit la t√¢che de cr√©ation d'un pool.  Dans les d√©pendances, l'√©quilibreur et l'√©couteur sont indiqu√©s, par d√©faut, une v√©rification est effectu√©e pour l'√©tat <b>ACTIVE</b> .  L'objet de l'√©quilibreur est verrouill√©, car les t√¢ches de traitement dans la file d'attente peuvent se produire de mani√®re synchrone, le verrouillage vous permet d'√©viter les conflits au moment o√π la demande d'ex√©cution a √©t√© envoy√©e, mais le statut n'a pas chang√©, mais il est suppos√© qu'il va changer.  Au lieu de <b>PARENT</b> , si le pool est cr√©√© √† la suite de la cascade de t√¢ches, l' <b>ID</b> sera automatiquement remplac√©. <br><br>  Apr√®s avoir cr√©√© un pool, des t√¢ches seront ajout√©es √† la file d'attente pour cr√©er un moniteur de disponibilit√© et cr√©er tous les membres de ce pool.  La sortie est une structure qui peut √™tre enti√®rement convertie en JSON.  Ceci est fait pour pouvoir restaurer la file d'attente en cas d'√©chec. <br><br>  La file d'attente, bas√©e sur la description de la t√¢che, surveille ind√©pendamment toutes les modifications dans le r√©f√©rentiel et v√©rifie les conditions qui doivent √™tre remplies pour ex√©cuter la t√¢che.  Comme je l'ai d√©j√† dit, les statuts proviennent de sockets Web, et il est tr√®s simple de g√©n√©rer les √©v√©nements n√©cessaires pour la file d'attente, mais si n√©cessaire, il ne sera pas difficile d'attacher un m√©canisme de mise √† jour des donn√©es du minuteur (cela √©tait initialement pr√©vu dans l'architecture, car les sockets Web √©taient pour diverses raisons peuvent ne pas fonctionner tr√®s stable).  Une fois la t√¢che termin√©e, la file d'attente informe automatiquement le r√©f√©rentiel de la n√©cessit√© de mettre √† jour les liens dans les objets sp√©cifi√©s. <br><br><h2>  Conclusion </h2><br>  Le besoin d'√©volutivit√© a conduit √† une approche d√©clarative.  La n√©cessit√© d'afficher les mod√®les et les relations entre eux a conduit √† un r√©f√©rentiel unique.  La n√©cessit√© de traiter des objets d√©pendants a conduit √† la file d'attente. <br><br>  La combinaison de ces besoins n'est peut-√™tre pas la t√¢che la plus simple en termes de mise en ≈ìuvre (mais c'est une question distincte).  Mais en termes d'architecture, la solution est tr√®s simple et vous permet d'√©liminer toutes les contradictions entre les t√¢ches du backend et de l'interface utilisateur, d'√©tablir leur interaction et de jeter les bases d'autres fonctionnalit√©s possibles de l'une des parties. <br><br>  Du c√¥t√© du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">panneau de commande</a> Selectel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">,</a> le processus d'√©quilibrage est simple et direct, ce qui permet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">aux</a> clients du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">service de</a> ne pas d√©penser de ressources pour la mise en ≈ìuvre ind√©pendante de l'√©quilibreur, tout en conservant la capacit√© de g√©rer le trafic de mani√®re flexible. <br><br>  Essayez notre √©quilibreur en action maintenant et √©crivez votre avis dans les commentaires. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr455523/">https://habr.com/ru/post/fr455523/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr455511/index.html">Le sommeil est la principale ressource pour le cerveau d'un programmeur</a></li>
<li><a href="../fr455513/index.html">L'explosion et le complot mondial: l'histoire de la cr√©ation de batteries lithium-ion</a></li>
<li><a href="../fr455515/index.html">Inverser et pirater le disque dur externe √† chiffrement automatique d'Aigo. Partie 1: Dissection en parties</a></li>
<li><a href="../fr455517/index.html">Dipl√¥m√© du cours de Netologie "Data Science" sur son travail dans le secteur bancaire</a></li>
<li><a href="../fr455519/index.html">Comment nous avons impl√©ment√© l'int√©gration de nouveaux d√©veloppeurs</a></li>
<li><a href="../fr455525/index.html">Zimbra et Mail Bomb Defense</a></li>
<li><a href="../fr455527/index.html">Qu'est-ce qui est √©crit ici? Dans les coulisses des objets JavaScript</a></li>
<li><a href="../fr455529/index.html">Inverser et pirater le disque dur externe √† chiffrement automatique d'Aigo. Partie 2: Dump avec Cypress PSoC</a></li>
<li><a href="../fr455533/index.html">Bubble Physics: A Search for Foam Destruction Mechanism</a></li>
<li><a href="../fr455535/index.html">G√©rer les certificats SSL / TLS dans les nuages ‚Äã‚Äãet les conteneurs - pas du travail humain</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>