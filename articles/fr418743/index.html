<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🗻 🛎️ 🉐 Première place au ML Boot Camp VI 👐🏼 👩🏿‍✈️ 💗</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Depuis de nombreuses années, Mail.ru organise des championnats d'apprentissage automatique, chaque fois que la tâche est intéressante à sa manière et ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Première place au ML Boot Camp VI</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/418743/">  Depuis de nombreuses années, Mail.ru organise des championnats d'apprentissage automatique, chaque fois que la tâche est intéressante à sa manière et complexe à sa manière.  C'est ma quatrième participation à des compétitions, j'aime beaucoup la plateforme et l'organisation, et c'est avec les bootcamps que mon chemin vers l'apprentissage automatique compétitif a commencé, mais j'ai réussi à prendre la première place pour la première fois.  Dans l'article, je vais vous dire comment montrer un résultat stable sans recyclage soit sur le classement public, soit sur des échantillons retardés, si la partie test est significativement différente de la partie formation des données. <br><br><h2>  Défi </h2><br>  Le texte intégral de la tâche est disponible sur → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">lien</a> .  En bref: il y a 10 Go de données, où chaque ligne contient trois types json de "clé: compteur", une certaine catégorie, un certain horodatage et un ID utilisateur.  Plusieurs entrées peuvent correspondre à un seul utilisateur.  Il est nécessaire de déterminer à quelle classe l'utilisateur appartient, la première ou la seconde.  La métrique de qualité pour le modèle est ROC-AUC, elle est bien écrite à ce sujet dans le blog d'Alexander Dyakonov <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[1]</a> . <br><br>  Exemple d'entrée de fichier <br><br><pre><code class="hljs go"><span class="hljs-number"><span class="hljs-number">00000d</span></span>2994b6df9239901389031acaac <span class="hljs-number"><span class="hljs-number">5</span></span> {<span class="hljs-string"><span class="hljs-string">"809001"</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-string"><span class="hljs-string">"848545"</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-string"><span class="hljs-string">"565828"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-string"><span class="hljs-string">"490363"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>} {<span class="hljs-string"><span class="hljs-string">"85789"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-string"><span class="hljs-string">"238490"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-string"><span class="hljs-string">"32285"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-string"><span class="hljs-string">"103987"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-string"><span class="hljs-string">"16507"</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-string"><span class="hljs-string">"6477"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-string"><span class="hljs-string">"92797"</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>} {} <span class="hljs-number"><span class="hljs-number">39</span></span></code> </pre> <a name="habracut"></a><br><h2>  Solution </h2><br>  La première idée qui émerge d'un scientifique des données qui a réussi à télécharger un ensemble de données est de transformer les colonnes json en une matrice clairsemée.  À ce stade, de nombreux participants ont rencontré des problèmes de manque de RAM.  Lors du déploiement d'une seule colonne en python, la consommation de mémoire était supérieure à celle disponible sur un ordinateur portable moyen. <br><br>  Quelques statistiques sèches.  Le nombre de clés uniques dans chaque colonne est 2053602, 20275, 1057788. De plus, dans la partie train et dans la partie test, il n'y a que 493866, 20268, 141931. 427994 utilisateurs uniques dans le train et 181024 dans la partie test.  Environ 4% de la classe 1 dans la partie formation. <br><br>  Comme vous pouvez le voir, nous avons beaucoup de signes, les utiliser tous est un moyen évident de s'équiper dans le train, parce que, par exemple, les arbres de décision utilisent des combinaisons de signes, et il existe des combinaisons encore plus uniques d'un si grand nombre de signes et presque tous n'existent que dans la partie formation données ou en test.  Cependant, l'un des modèles de base que j'avais était lightgbm avec colsample ~ 0,1 et une régularisation très stricte.  Cependant, malgré les énormes paramètres de régularisation, il a montré un résultat instable dans les parties publiques et privées, comme il s'est avéré après la fin de la compétition. <br><br>  La deuxième pensée de la personne qui a décidé de participer à ce concours serait probablement de collecter le train et de tester, en agrégeant les informations par identifiants.  Par exemple, le montant.  Ou un maximum.  Et ici, il s'avère que deux choses très intéressantes que Mail.ru a imaginées pour nous.  Premièrement, le test peut être classé avec une très grande précision.  Même selon les statistiques sur le nombre d'entrées pour cuid et le nombre de clés uniques dans json, le test dépasse considérablement le train.  Le classificateur de base a donné 0,9+ roc-auc en reconnaissance de test.  Deuxièmement, les compteurs n'ont aucun sens, presque tous les modèles sont passés du passage des compteurs aux signes binaires de la forme: il n'y a / pas de clé.  Même les arbres, qui en théorie ne devraient pas être pires du fait qu'au lieu d'une unité il y a un certain nombre, semblent être recyclés pour les compteurs. <br><br>  Les résultats du classement public dépassaient largement ceux de la validation croisée.  Cela était apparemment dû au fait qu'il était plus facile pour le modèle de construire le classement de deux records dans le test que dans le train, car un plus grand nombre de panneaux donnait plus de termes pour le classement. <br><br>  À ce stade, il est devenu tout à fait clair que la validation dans ce concours n'est pas une chose simple et ni les informations publiques ni les CV des autres participants, qui pourraient être trompés en leurre dans le chat officiel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[2]</a> .  Pourquoi est-ce arrivé?  Il semble que le train et le test soient séparés par le temps, ce qui a ensuite été confirmé par les organisateurs. <br><br>  Tout membre expérimenté de kaggle avisera immédiatement la validation contradictoire <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[3]</a> , mais ce n'est pas si simple.  Malgré le fait que la précision du classificateur pour le train et le test soit proche de 1 par le métrique roc-auc, il n'y a pas beaucoup d'entrées similaires dans le train.  J'ai essayé de résumer des échantillons agrégés en cuid avec la même cible pour augmenter le nombre d'enregistrements avec un grand nombre de clés uniques dans json, mais cela a causé des inconvénients à la fois en validation croisée et en public, et j'avais peur d'utiliser de tels modèles. <br><br>  Il y a deux façons: rechercher des valeurs éternelles avec un apprentissage non supervisé ou essayer de prendre des fonctionnalités plus importantes pour le test.  Je suis allé dans les deux sens, en utilisant TruncatedSVD pour non supervisé et en sélectionnant les fonctionnalités par fréquence dans le test. <br><br>  La première étape, cependant, j'ai fait un auto-encodeur profond, mais je me suis trompé, en prenant deux fois la même matrice, je n'ai pas pu corriger l'erreur et utiliser l'ensemble complet des signes: le tenseur d'entrée ne s'adaptait pas à la mémoire du GPU à aucune taille de couche dense.  J'ai trouvé une erreur et plus tard, je n'ai pas essayé de coder les fonctionnalités. <br><br>  J'ai généré SVD de toutes les manières imaginatives: sur le jeu de données d'origine avec cat_feature et la sommation suivante par cuid.  Pour chaque colonne séparément.  Par tf-idf sur json comme sac de mots <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[4]</a> (n'a pas aidé). <br><br>  Pour une plus grande variété, j'ai essayé de sélectionner un petit nombre de caractéristiques dans le train, en utilisant A-NOVA pour la partie train de chaque pli en validation croisée. <br><br><h2>  Les modèles </h2><br>  Les principaux modèles de base: lightgbm, vowpal wabbit, xgboost, SGD.  De plus, j'ai utilisé plusieurs architectures de réseaux de neurones.  Dmitry Nikitko, qui était à la première place du classement public, a conseillé d'utiliser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">HashEmbeddings</a> , ce modèle après une sélection de paramètres a montré un bon résultat et amélioré l'ensemble. <br><br>  Un autre modèle de réseau neuronal avec recherche d'interactions (style machine de factorisation) entre 3-4-5 colonnes de données (trois entrées de gauche), statistiques numériques (4 entrées), matrice SVD (5 entrées). <br><br><img src="https://habrastorage.org/webt/g5/xb/yp/g5xbypjhkxazihg5vfcd7mglya0.png"><br><br><h2>  Ensemble </h2><br>  J'ai compté tous les modèles par pli, en faisant la moyenne des prévisions de test à partir de modèles formés sur divers plis.  Les prévisions de train ont été utilisées pour l'empilement.  Le meilleur résultat a été montré par la pile de niveau 1 utilisant xgboost sur les prédictions des modèles de base et 250 attributs de chaque colonne json, sélectionnés en fonction de la fréquence à laquelle l'attribut se rencontrait dans le test. <br><br>  J'ai passé environ 30 heures de mon temps sur la solution, en comptant sur un serveur avec 4 cœurs core-i7, 64 gigaoctets de RAM et un GTX 1080. En conséquence, ma solution s'est révélée assez stable et je suis passé de la troisième place du classement public au premier privé. <br><br>  Une partie substantielle du code est disponible sur un bitbucket sous forme d'ordinateurs portables <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[5]</a> . <br><br>  Je tiens à remercier Mail.ru pour les concours intéressants et les autres participants pour la communication intéressante dans le groupe! <br><br>  [1] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ROC-AUC sur le blog d'Aleksandrov Dyakonov</a> <br>  [2] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Officiel Chat ML BootCamp officiel</a> <br>  [3] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Validation contradictoire</a> <br>  [4] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sac de mots</a> <br>  [5] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">code source pour la plupart des modèles</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr418743/">https://habr.com/ru/post/fr418743/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr418733/index.html">Visualiser les commentaires des chaînes YouTube des communautés touhou internationales et locales</a></li>
<li><a href="../fr418735/index.html">Se concentrer sur la propriété</a></li>
<li><a href="../fr418737/index.html">Ablation laser, verre tellurique et dopant Er2O3</a></li>
<li><a href="../fr418739/index.html">Centre de technologie additive: Imprimantes 3D industrielles Systèmes 3D, Stratasys, SLM, EOS</a></li>
<li><a href="../fr418741/index.html">Ajoutez le chiffrement et passez au SIP standard</a></li>
<li><a href="../fr418747/index.html">Résolution de problèmes: comment résoudre efficacement les problèmes en équipe?</a></li>
<li><a href="../fr418751/index.html">Dex impudent espion chinois</a></li>
<li><a href="../fr418753/index.html">vSAN dans le cloud VMware</a></li>
<li><a href="../fr418755/index.html">Comment le commerce électronique survit aux promotions à grande échelle. Se préparer aux pics de charge sur le Web [Partie 1]</a></li>
<li><a href="../fr418757/index.html">Délais d'éclaircissement (crypto-monnaies, forex, échanges)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>