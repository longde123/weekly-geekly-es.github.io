<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üóª üõéÔ∏è üâê Premi√®re place au ML Boot Camp VI üëêüèº üë©üèø‚Äç‚úàÔ∏è üíó</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Depuis de nombreuses ann√©es, Mail.ru organise des championnats d'apprentissage automatique, chaque fois que la t√¢che est int√©ressante √† sa mani√®re et ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Premi√®re place au ML Boot Camp VI</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/418743/">  Depuis de nombreuses ann√©es, Mail.ru organise des championnats d'apprentissage automatique, chaque fois que la t√¢che est int√©ressante √† sa mani√®re et complexe √† sa mani√®re.  C'est ma quatri√®me participation √† des comp√©titions, j'aime beaucoup la plateforme et l'organisation, et c'est avec les bootcamps que mon chemin vers l'apprentissage automatique comp√©titif a commenc√©, mais j'ai r√©ussi √† prendre la premi√®re place pour la premi√®re fois.  Dans l'article, je vais vous dire comment montrer un r√©sultat stable sans recyclage soit sur le classement public, soit sur des √©chantillons retard√©s, si la partie test est significativement diff√©rente de la partie formation des donn√©es. <br><br><h2>  D√©fi </h2><br>  Le texte int√©gral de la t√¢che est disponible sur ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">lien</a> .  En bref: il y a 10 Go de donn√©es, o√π chaque ligne contient trois types json de "cl√©: compteur", une certaine cat√©gorie, un certain horodatage et un ID utilisateur.  Plusieurs entr√©es peuvent correspondre √† un seul utilisateur.  Il est n√©cessaire de d√©terminer √† quelle classe l'utilisateur appartient, la premi√®re ou la seconde.  La m√©trique de qualit√© pour le mod√®le est ROC-AUC, elle est bien √©crite √† ce sujet dans le blog d'Alexander Dyakonov <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[1]</a> . <br><br>  Exemple d'entr√©e de fichier <br><br><pre><code class="hljs go"><span class="hljs-number"><span class="hljs-number">00000d</span></span>2994b6df9239901389031acaac <span class="hljs-number"><span class="hljs-number">5</span></span> {<span class="hljs-string"><span class="hljs-string">"809001"</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-string"><span class="hljs-string">"848545"</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-string"><span class="hljs-string">"565828"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-string"><span class="hljs-string">"490363"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>} {<span class="hljs-string"><span class="hljs-string">"85789"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-string"><span class="hljs-string">"238490"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-string"><span class="hljs-string">"32285"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-string"><span class="hljs-string">"103987"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-string"><span class="hljs-string">"16507"</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-string"><span class="hljs-string">"6477"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-string"><span class="hljs-string">"92797"</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>} {} <span class="hljs-number"><span class="hljs-number">39</span></span></code> </pre> <a name="habracut"></a><br><h2>  Solution </h2><br>  La premi√®re id√©e qui √©merge d'un scientifique des donn√©es qui a r√©ussi √† t√©l√©charger un ensemble de donn√©es est de transformer les colonnes json en une matrice clairsem√©e.  √Ä ce stade, de nombreux participants ont rencontr√© des probl√®mes de manque de RAM.  Lors du d√©ploiement d'une seule colonne en python, la consommation de m√©moire √©tait sup√©rieure √† celle disponible sur un ordinateur portable moyen. <br><br>  Quelques statistiques s√®ches.  Le nombre de cl√©s uniques dans chaque colonne est 2053602, 20275, 1057788. De plus, dans la partie train et dans la partie test, il n'y a que 493866, 20268, 141931. 427994 utilisateurs uniques dans le train et 181024 dans la partie test.  Environ 4% de la classe 1 dans la partie formation. <br><br>  Comme vous pouvez le voir, nous avons beaucoup de signes, les utiliser tous est un moyen √©vident de s'√©quiper dans le train, parce que, par exemple, les arbres de d√©cision utilisent des combinaisons de signes, et il existe des combinaisons encore plus uniques d'un si grand nombre de signes et presque tous n'existent que dans la partie formation donn√©es ou en test.  Cependant, l'un des mod√®les de base que j'avais √©tait lightgbm avec colsample ~ 0,1 et une r√©gularisation tr√®s stricte.  Cependant, malgr√© les √©normes param√®tres de r√©gularisation, il a montr√© un r√©sultat instable dans les parties publiques et priv√©es, comme il s'est av√©r√© apr√®s la fin de la comp√©tition. <br><br>  La deuxi√®me pens√©e de la personne qui a d√©cid√© de participer √† ce concours serait probablement de collecter le train et de tester, en agr√©geant les informations par identifiants.  Par exemple, le montant.  Ou un maximum.  Et ici, il s'av√®re que deux choses tr√®s int√©ressantes que Mail.ru a imagin√©es pour nous.  Premi√®rement, le test peut √™tre class√© avec une tr√®s grande pr√©cision.  M√™me selon les statistiques sur le nombre d'entr√©es pour cuid et le nombre de cl√©s uniques dans json, le test d√©passe consid√©rablement le train.  Le classificateur de base a donn√© 0,9+ roc-auc en reconnaissance de test.  Deuxi√®mement, les compteurs n'ont aucun sens, presque tous les mod√®les sont pass√©s du passage des compteurs aux signes binaires de la forme: il n'y a / pas de cl√©.  M√™me les arbres, qui en th√©orie ne devraient pas √™tre pires du fait qu'au lieu d'une unit√© il y a un certain nombre, semblent √™tre recycl√©s pour les compteurs. <br><br>  Les r√©sultats du classement public d√©passaient largement ceux de la validation crois√©e.  Cela √©tait apparemment d√ª au fait qu'il √©tait plus facile pour le mod√®le de construire le classement de deux records dans le test que dans le train, car un plus grand nombre de panneaux donnait plus de termes pour le classement. <br><br>  √Ä ce stade, il est devenu tout √† fait clair que la validation dans ce concours n'est pas une chose simple et ni les informations publiques ni les CV des autres participants, qui pourraient √™tre tromp√©s en leurre dans le chat officiel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[2]</a> .  Pourquoi est-ce arriv√©?  Il semble que le train et le test soient s√©par√©s par le temps, ce qui a ensuite √©t√© confirm√© par les organisateurs. <br><br>  Tout membre exp√©riment√© de kaggle avisera imm√©diatement la validation contradictoire <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[3]</a> , mais ce n'est pas si simple.  Malgr√© le fait que la pr√©cision du classificateur pour le train et le test soit proche de 1 par le m√©trique roc-auc, il n'y a pas beaucoup d'entr√©es similaires dans le train.  J'ai essay√© de r√©sumer des √©chantillons agr√©g√©s en cuid avec la m√™me cible pour augmenter le nombre d'enregistrements avec un grand nombre de cl√©s uniques dans json, mais cela a caus√© des inconv√©nients √† la fois en validation crois√©e et en public, et j'avais peur d'utiliser de tels mod√®les. <br><br>  Il y a deux fa√ßons: rechercher des valeurs √©ternelles avec un apprentissage non supervis√© ou essayer de prendre des fonctionnalit√©s plus importantes pour le test.  Je suis all√© dans les deux sens, en utilisant TruncatedSVD pour non supervis√© et en s√©lectionnant les fonctionnalit√©s par fr√©quence dans le test. <br><br>  La premi√®re √©tape, cependant, j'ai fait un auto-encodeur profond, mais je me suis tromp√©, en prenant deux fois la m√™me matrice, je n'ai pas pu corriger l'erreur et utiliser l'ensemble complet des signes: le tenseur d'entr√©e ne s'adaptait pas √† la m√©moire du GPU √† aucune taille de couche dense.  J'ai trouv√© une erreur et plus tard, je n'ai pas essay√© de coder les fonctionnalit√©s. <br><br>  J'ai g√©n√©r√© SVD de toutes les mani√®res imaginatives: sur le jeu de donn√©es d'origine avec cat_feature et la sommation suivante par cuid.  Pour chaque colonne s√©par√©ment.  Par tf-idf sur json comme sac de mots <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[4]</a> (n'a pas aid√©). <br><br>  Pour une plus grande vari√©t√©, j'ai essay√© de s√©lectionner un petit nombre de caract√©ristiques dans le train, en utilisant A-NOVA pour la partie train de chaque pli en validation crois√©e. <br><br><h2>  Les mod√®les </h2><br>  Les principaux mod√®les de base: lightgbm, vowpal wabbit, xgboost, SGD.  De plus, j'ai utilis√© plusieurs architectures de r√©seaux de neurones.  Dmitry Nikitko, qui √©tait √† la premi√®re place du classement public, a conseill√© d'utiliser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">HashEmbeddings</a> , ce mod√®le apr√®s une s√©lection de param√®tres a montr√© un bon r√©sultat et am√©lior√© l'ensemble. <br><br>  Un autre mod√®le de r√©seau neuronal avec recherche d'interactions (style machine de factorisation) entre 3-4-5 colonnes de donn√©es (trois entr√©es de gauche), statistiques num√©riques (4 entr√©es), matrice SVD (5 entr√©es). <br><br><img src="https://habrastorage.org/webt/g5/xb/yp/g5xbypjhkxazihg5vfcd7mglya0.png"><br><br><h2>  Ensemble </h2><br>  J'ai compt√© tous les mod√®les par pli, en faisant la moyenne des pr√©visions de test √† partir de mod√®les form√©s sur divers plis.  Les pr√©visions de train ont √©t√© utilis√©es pour l'empilement.  Le meilleur r√©sultat a √©t√© montr√© par la pile de niveau 1 utilisant xgboost sur les pr√©dictions des mod√®les de base et 250 attributs de chaque colonne json, s√©lectionn√©s en fonction de la fr√©quence √† laquelle l'attribut se rencontrait dans le test. <br><br>  J'ai pass√© environ 30 heures de mon temps sur la solution, en comptant sur un serveur avec 4 c≈ìurs core-i7, 64 gigaoctets de RAM et un GTX 1080. En cons√©quence, ma solution s'est r√©v√©l√©e assez stable et je suis pass√© de la troisi√®me place du classement public au premier priv√©. <br><br>  Une partie substantielle du code est disponible sur un bitbucket sous forme d'ordinateurs portables <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[5]</a> . <br><br>  Je tiens √† remercier Mail.ru pour les concours int√©ressants et les autres participants pour la communication int√©ressante dans le groupe! <br><br>  [1] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ROC-AUC sur le blog d'Aleksandrov Dyakonov</a> <br>  [2] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Officiel Chat ML BootCamp officiel</a> <br>  [3] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Validation contradictoire</a> <br>  [4] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sac de mots</a> <br>  [5] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">code source pour la plupart des mod√®les</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr418743/">https://habr.com/ru/post/fr418743/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr418733/index.html">Visualiser les commentaires des cha√Ænes YouTube des communaut√©s touhou internationales et locales</a></li>
<li><a href="../fr418735/index.html">Se concentrer sur la propri√©t√©</a></li>
<li><a href="../fr418737/index.html">Ablation laser, verre tellurique et dopant Er2O3</a></li>
<li><a href="../fr418739/index.html">Centre de technologie additive: Imprimantes 3D industrielles Syst√®mes 3D, Stratasys, SLM, EOS</a></li>
<li><a href="../fr418741/index.html">Ajoutez le chiffrement et passez au SIP standard</a></li>
<li><a href="../fr418747/index.html">R√©solution de probl√®mes: comment r√©soudre efficacement les probl√®mes en √©quipe?</a></li>
<li><a href="../fr418751/index.html">Dex impudent espion chinois</a></li>
<li><a href="../fr418753/index.html">vSAN dans le cloud VMware</a></li>
<li><a href="../fr418755/index.html">Comment le commerce √©lectronique survit aux promotions √† grande √©chelle. Se pr√©parer aux pics de charge sur le Web [Partie 1]</a></li>
<li><a href="../fr418757/index.html">D√©lais d'√©claircissement (crypto-monnaies, forex, √©changes)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>