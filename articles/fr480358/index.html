<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü¶Å ‚úãüèª üëù Le prix cach√© des biblioth√®ques CSS-in-JS dans les applications React üßùüèø ‚ôëÔ∏è üòã</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans les applications frontales modernes, la technologie CSS-in-JS est tr√®s populaire. Le fait est que cela donne aux d√©veloppeurs un m√©canisme pour t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Le prix cach√© des biblioth√®ques CSS-in-JS dans les applications React</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/480358/">  Dans les applications frontales modernes, la technologie CSS-in-JS est tr√®s populaire.  Le fait est que cela donne aux d√©veloppeurs un m√©canisme pour travailler avec des styles qui est plus pratique que le CSS ordinaire.  Ne vous m√©prenez pas.  J'aime vraiment CSS, mais cr√©er une bonne architecture CSS n'est pas une t√¢che facile.  La technologie CSS-in-JS pr√©sente des <a href="https://gist.github.com/threepointone/731b0c47e78d8350ae4e105c1a83867d">avantages</a> importants <a href="https://gist.github.com/threepointone/731b0c47e78d8350ae4e105c1a83867d">par</a> rapport aux styles CSS conventionnels.  Mais, malheureusement, l'utilisation de CSS-in-JS peut, dans certaines applications, entra√Æner des probl√®mes de performances.  Dans cet article, je vais essayer d'analyser les fonctionnalit√©s de haut niveau des biblioth√®ques CSS-in-JS les plus populaires, de parler de certains des probl√®mes qui surviennent parfois lors de leur utilisation et de sugg√©rer des moyens d'att√©nuer ces probl√®mes. <br><br> <a href="https://habr.com/ru/company/ruvds/blog/480358/"><img src="https://habrastorage.org/webt/u6/f3/cr/u6f3crp6pcjspyohewwxptq84ve.png"></a> <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">Aper√ßu de la situation</font> </h2><br>  Dans mon entreprise, il a √©t√© d√©cid√© de cr√©er une biblioth√®que d'interface utilisateur.  Cela nous apporterait un avantage consid√©rable, nous permettrait de r√©utiliser des fragments standard d'interfaces dans divers projets.  J'√©tais l'un des volontaires qui ont pris la rel√®ve.  J'ai d√©cid√© d'utiliser la technologie CSS-in-JS, car je connaissais d√©j√† l'API de style des biblioth√®ques CSS-in-JS les plus populaires.  Au cours du travail, je me suis efforc√© d'agir raisonnablement.  J'ai con√ßu une logique r√©utilisable et appliqu√© des propri√©t√©s partag√©es dans les composants.  J'ai donc repris la composition des composants.  Par exemple, le <code>&lt;IconButton /&gt;</code> √©tendu le composant <code>&lt;BaseButton /&gt;</code> , qui, √† son tour, √©tait une impl√©mentation d'une entit√© <code>styled.button</code> simple.  Malheureusement, il s'est av√©r√© que <code>IconButton</code> besoin de son propre style, j'ai donc converti ce composant en composant stylis√©: <br><br><pre> <code class="css hljs"><span class="hljs-selector-tag"><span class="hljs-selector-tag">const</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">IconButton</span></span> = <span class="hljs-selector-tag"><span class="hljs-selector-tag">styled</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">BaseButton</span></span>)`  <span class="hljs-selector-tag"><span class="hljs-selector-tag">border-radius</span></span>: 3<span class="hljs-selector-tag"><span class="hljs-selector-tag">px</span></span>; `;</code> </pre> <br>  Comme de plus en plus de composants sont apparus dans notre biblioth√®que, nous avons utilis√© de plus en plus d'op√©rations de composition.  Cela ne semblait pas contre nature.  Apr√®s tout, la composition est, en fait, le fondement de React.  Tout allait bien jusqu'√† ce que je cr√©e le composant <code>Table</code> .  J'ai commenc√© √† sentir que cette composante se rendait lentement.  Surtout dans les situations o√π le nombre de lignes dans le tableau d√©passe 50. C'√©tait incorrect.  Par cons√©quent, j'ai commenc√© √† comprendre le probl√®me en recourant aux outils de d√©veloppement. <br><br>  Soit dit en passant, si vous vous √™tes d√©j√† demand√© pourquoi les r√®gles CSS ne peuvent pas √™tre modifi√©es √† l'aide de l'inspecteur d'outils de d√©veloppement, sachez que c'est parce qu'elles utilisent <a href="https://developer.mozilla.org/en-US/docs/Web/API/CSSStyleSheet/insertRule">CSSStyleSheet.insertRule ()</a> .  Il s'agit d'un moyen tr√®s rapide de modifier les feuilles de style.  Mais l'un de ses inconv√©nients est le fait que les feuilles de style correspondantes ne peuvent plus √™tre √©dit√©es par l'inspecteur. <br><br>  Inutile de dire que l'arbre g√©n√©r√© par React √©tait vraiment √©norme.  Le nombre de composants <code>Context.Consumer</code> √©tait si grand qu'il pouvait me priver de sommeil.  Le fait est que chaque fois qu'un composant stylis√© unique est rendu √† l'aide <a href="https://www.styled-components.com/">de composants</a> <code>Context.Consumer</code> ou d' <a href="https://emotion.sh/">√©motion</a> , en plus de cr√©er un composant React normal, un composant <code>Context.Consumer</code> suppl√©mentaire est √©galement <code>Context.Consumer</code> .  Cela est n√©cessaire pour permettre au script correspondant (la plupart des biblioth√®ques CSS-in-JS d√©pendent des scripts ex√©cut√©s pendant que la page est en cours d'ex√©cution) de traiter correctement les r√®gles de style g√©n√©r√©es.  Habituellement, cela ne pose aucun probl√®me particulier, mais nous ne devons pas oublier que les composants doivent avoir acc√®s au sujet.  Cela se traduit par la n√©cessit√© de rendre <code>Context.Consumer</code> suppl√©mentaire pour chaque √©l√©ment stylis√©, ce qui vous permet de "lire" le th√®me √† partir <code>ThemeProvider</code> composant <code>ThemeProvider</code> .  Par cons√©quent, lors de la cr√©ation d'un composant stylis√© dans une application avec un th√®me, 3 composants sont cr√©√©s.  Il s'agit d'un composant <code>StyledXXX</code> et de deux autres composants <code>Context.Consumer</code> . <br><br>  Certes, il n'y a rien de particuli√®rement terrible ici, car React fait son travail rapidement, ce qui signifie que dans la plupart des cas, nous n'avons rien √† craindre.  Mais que se passe-t-il si plusieurs composants stylis√©s sont assembl√©s afin de cr√©er un composant plus complexe?  Que faire si ce composant complexe fait partie d'une longue liste ou d'un grand tableau o√π au moins 100 de ces composants sont rendus?  Ici, dans de telles situations, nous sommes confront√©s √† des probl√®mes ... <br><br><h2>  <font color="#3AC1EF">Profilage</font> </h2><br>  Afin de tester diff√©rentes solutions CSS-in-JS, j'ai cr√©√© une application simple.  Il affiche 50 fois le texte <code>Hello World</code> .  Dans la <a href="https://gist.github.com/3nvi/a47c22872d85d584662e1dbed09dab34">premi√®re</a> version de cette application, j'ai envelopp√© ce texte dans un √©l√©ment <code>div</code> ordinaire.  Dans le <a href="https://gist.github.com/3nvi/fed37f5286be2575b8203ec37ff00c99">second</a> , j'ai utilis√© le composant <code>styled.div</code> .  De plus, j'ai ajout√© un bouton √† l'application qui provoque le rendu de tous ces 50 √©l√©ments. <br><br>  Apr√®s avoir rendu le composant <code>&lt;App /&gt;</code> , deux arborescences React diff√©rentes ont √©t√© affich√©es.  Les figures suivantes montrent les arbres d'√©l√©ments d√©duits par React. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5b7/4c1/161/5b74c11614f8364a88d3cf204c12c7f3.png"></div><br>  <i><font color="#999999">Un arbre affich√© dans une application qui utilise un √©l√©ment div normal</font></i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/370/d8b/513/370d8b51371c91ac2c3106c636522711.png"></div><br>  <i><font color="#999999">Une arborescence affich√©e dans une application qui utilise styled.div</font></i> <br><br>  Ensuite, en utilisant le bouton, j'ai rendu <code>&lt;App /&gt;</code> 10 fois afin de collecter des donn√©es concernant la charge sur le syst√®me, que les composants suppl√©mentaires de <code>Context.Consumer</code> .  Voici des informations sur le re-rendu r√©p√©titif d'une application avec des √©l√©ments <code>div</code> r√©guliers en mode conception. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c25/5ef/c20/c255efc205d63352d9e966a8aefbbff7.png"></div><br>  <i><font color="#999999">Re-rendu de l'application avec des √©l√©ments div r√©guliers en mode conception.</font></i>  <i><font color="#999999">La valeur moyenne est de 2,54 ms.</font></i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ddc/5b1/14a/ddc5b114a6e93cc4dbd7fe52ddf8aa26.png"></div><br>  <i><font color="#999999">Re-rendu de l'application avec des √©l√©ments styled.div en mode d√©veloppement.</font></i>  <i><font color="#999999">La valeur moyenne est de 3,98 ms.</font></i> <br><br>  Ce qui est tr√®s int√©ressant, c'est qu'en moyenne, une application CSS-in-JS est 56,6% plus lente que d'habitude.  Mais c'√©tait un mode de d√©veloppement.  Et le mode de production? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/937/07d/34d/93707d34db954762fda1fb82f41fa4ec.png"></div><br>  <i><font color="#999999">Re-rendu de l'application avec les √©l√©ments div habituels en mode production.</font></i>  <i><font color="#999999">La valeur moyenne est de 1,06 ms.</font></i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d66/b66/400/d66b66400375542ed0644cfd7c962e11.png"></div><br>  <i><font color="#999999">Re-rendu de l'application avec des √©l√©ments styled.div en mode production.</font></i>  <i><font color="#999999">La valeur moyenne est de 2,27 ms.</font></i> <br><br>  Lorsque le mode production est activ√©, l'impl√©mentation div de l'application semble √™tre plus de 50% plus rapide par rapport √† la m√™me version en mode d√©veloppement.  Une application styled.div n'est que 43% plus rapide.  Et ici, comme pr√©c√©demment, il est clair que la solution CSS-in-JS est presque deux fois plus lente que la solution habituelle.  Qu'est-ce qui le ralentit? <br><br><h2>  <font color="#3AC1EF">Analyse de l'application lors de son ex√©cution</font> </h2><br>  La r√©ponse √©vidente √† la question de ce qui ralentit une application CSS-in-JS peut √™tre la suivante: "Il a √©t√© dit qu'une centaine de biblioth√®ques CSS-in-JS rendent deux <code>Context.Consumer</code> par composant."  Mais si vous pensez √† tout cela <code>Context.Consumer</code> , alors <code>Context.Consumer</code> n'est qu'un m√©canisme pour acc√©der √† une variable JS.  Bien s√ªr, React doit faire un certain travail afin de savoir o√π lire la valeur correspondante, mais cela seul n'explique pas les r√©sultats de mesure ci-dessus.  La vraie r√©ponse √† cette question peut √™tre trouv√©e en analysant la raison d'utiliser <code>Context.Consumer</code> .  Le fait est que la plupart des biblioth√®ques CSS-in-JS s'appuient sur des scripts qui s'ex√©cutent pendant la sortie de page dans le navigateur, ce qui aide les biblioth√®ques √† mettre √† jour dynamiquement les styles de composants.  Ces biblioth√®ques ne cr√©ent pas de classes CSS lors de l'assemblage de pages.  Au lieu de cela, ils g√©n√®rent et mettent √† jour dynamiquement les balises <code>&lt;style&gt;</code> dans le document.  Cela se fait lorsque les composants sont mont√©s ou lorsque leurs propri√©t√©s changent.  Ces balises contiennent g√©n√©ralement une seule classe CSS dont le nom hach√© correspond √† un seul composant React.  Lorsque les propri√©t√©s de ce composant changent, la <code>&lt;style&gt;</code> correspondante doit √©galement changer.  Voici comment d√©crire ce qui se fait pendant ce processus: <br><br><ul><li>  Les r√®gles CSS que la <code>&lt;style&gt;</code> doit avoir sont r√©g√©n√©r√©es. </li><li>  Un nouveau nom de classe hach√©e est cr√©√© qui est utilis√© pour stocker les r√®gles CSS susmentionn√©es. </li><li>  La propri√©t√© <code>classname</code> du composant React correspondant est mise √† jour vers une nouvelle, indiquant la classe qui vient d'√™tre cr√©√©e. </li></ul><br>  Consid√©rez, par exemple, la biblioth√®que de <code>styled-components</code> .  Lors de la cr√©ation du composant <code>styled.div</code> biblioth√®que <a href="">attribue un</a> identifiant interne (ID) √† ce composant et ajoute une nouvelle <code>&lt;style&gt;</code> √† la <code>&lt;head&gt;</code> HTML <code>&lt;head&gt;</code> .  Cette balise contient un seul commentaire qui fait r√©f√©rence √† l'identifiant interne du composant React auquel appartient le style correspondant: <br><br><pre> <code class="css hljs">&lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">style</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">data-styled-components</span></span>&gt;   <span class="hljs-comment"><span class="hljs-comment">/* sc-component-id: sc-bdVaJa */</span></span> &lt;/<span class="hljs-selector-tag"><span class="hljs-selector-tag">style</span></span>&gt;</code> </pre> <br>  Et voici les actions que la biblioth√®que de composants de style effectue lors de l'affichage du composant React correspondant: <br><br><ol><li>  Analyse les r√®gles CSS √† partir de la cha√Æne de mod√®le des composants de style. </li><li>  <a href="">G√©n√®re un</a> nouveau nom de classe CSS (ou d√©couvre s'il <a href="">faut conserver le</a> nom pr√©c√©dent). </li><li>  <a href="">Effectue le</a> pr√©traitement des styles √† l'aide de stylets. </li><li>  <a href="">Incorpore le</a> CSS r√©sultant du pr√©traitement dans la <code>&lt;style&gt;</code> correspondante de la balise HTML <code>&lt;head&gt;</code> . </li></ol><br>  Pour pouvoir utiliser la rubrique √† l'√©tape 1 de ce processus, <a href="">Context.Consumer est requis</a> .  Gr√¢ce √† ce composant, les valeurs sont lues √† partir du sujet dans la cha√Æne de mod√®le.  Afin de pouvoir modifier la <code>&lt;style&gt;</code> associ√©e √† ce composant, un autre <code>Context.Consumer</code> n√©cessaire √† partir du composant.  Il vous permet d'acc√©der √† une instance d'une feuille de style.  C'est pourquoi dans la plupart des biblioth√®ques CSS-in-JS, nous rencontrons deux instances de <code>Context.Consumer</code> . <br><br>  De plus, √©tant donn√© que tous ces calculs affectent l'interface utilisateur, il convient de noter qu'ils doivent √™tre effectu√©s lors de la phase de rendu des composants.  Ils ne peuvent pas √™tre ex√©cut√©s dans le code des gestionnaires d'√©v√©nements pour le cycle de vie des composants React (de cette fa√ßon, leur ex√©cution peut √™tre retard√©e et ressemblera √† une formation de page lente pour l'utilisateur).  C'est pourquoi le rendu des applications styled.div est plus lent que le rendu d'une application standard. <br><br>  Tout cela a √©t√© remarqu√© par les d√©veloppeurs de composants de style.  Ils ont optimis√© la biblioth√®que afin de r√©duire le temps de re-rendu des composants.  En particulier, la biblioth√®que v√©rifie si le composant stylis√© est ¬´statique¬ª.  Autrement dit, que les styles du composant d√©pendent du th√®me ou des propri√©t√©s qui lui sont transmises.  Par exemple, le composant statique est illustr√© ci-dessous: <br><br><pre> <code class="css hljs"><span class="hljs-selector-tag"><span class="hljs-selector-tag">const</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">StaticStyledDiv</span></span> = <span class="hljs-selector-tag"><span class="hljs-selector-tag">styled</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.div</span></span>`  <span class="hljs-selector-tag"><span class="hljs-selector-tag">color</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:red</span></span> `;</code> </pre> <br>  Et ce composant n'est pas statique: <br><br><pre> <code class="css hljs"><span class="hljs-selector-tag"><span class="hljs-selector-tag">const</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">DynamicStyledDiv</span></span> = <span class="hljs-selector-tag"><span class="hljs-selector-tag">styled</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.div</span></span>`  <span class="hljs-selector-tag"><span class="hljs-selector-tag">color</span></span>: ${props =&gt; props.color} `;</code> </pre> <br>  Si la biblioth√®que d√©couvre que le composant est statique, elle saute les <a href="">4 √©tapes</a> ci-dessus, se rendant compte qu'elle n'aura jamais √† changer le nom de classe g√©n√©r√© (car il n'y a pas d'√©l√©ment dynamique pour lequel il peut √™tre n√©cessaire de modifier les r√®gles CSS qui lui sont associ√©es).  De plus, dans cette situation, la biblioth√®que <a href="">n'affiche pas</a> <code>ThemeContext.Consumer</code> autour du composant stylis√©, car la d√©pendance du th√®me ne permettrait plus au composant d'√™tre consid√©r√© comme "statique". <br><br>  Si vous avez √©t√© suffisamment prudent lors de l'analyse des captures d'√©cran pr√©sent√©es pr√©c√©demment, vous remarquerez peut-√™tre que m√™me en mode production pour chaque <code>styled.div</code> deux composants <code>Context.Consumer</code> sont <code>Context.Consumer</code> .  Chose int√©ressante, le composant rendu √©tait ¬´statique¬ª, car aucune r√®gle CSS dynamique ne lui √©tait associ√©e.  Dans une telle situation, on pourrait s'attendre √† ce que si cet exemple √©tait √©crit √† l'aide de la biblioth√®que de composants de style, il <code>Context.Consumer</code> pas <code>Context.Consumer</code> n√©cessaire pour travailler avec le th√®me.  La raison pour laquelle exactement deux <code>Context.Consumer</code> sont affich√©s ici est que l'exp√©rience, dont les donn√©es sont donn√©es ci-dessus, a √©t√© r√©alis√©e en utilisant l'√©motion - une autre biblioth√®que CSS-in-JS.  Cette biblioth√®que adopte presque la m√™me approche que les composants de style.  Les diff√©rences entre eux sont minimes.  Ainsi, la biblioth√®que d'√©motions analyse la cha√Æne de mod√®le, pr√©traite les styles √† l'aide de <a href="https://stylis.js.org/">stylets</a> et met √† jour le contenu de la <code>&lt;style&gt;</code> correspondante.  Ici, cependant, une diff√©rence cl√© doit √™tre not√©e entre les composants de style et l'√©motion.  Elle consiste dans le fait que la biblioth√®que d'√©motions <code>ThemeContext.Consumer</code> <a href="">toujours</a> tous les composants de <code>ThemeContext.Consumer</code> - qu'ils utilisent ou non le th√®me (cela explique l'apparence de la capture d'√©cran ci-dessus).  Chose int√©ressante, m√™me si l'√©motion rend plus de composants de consommation que de composants de style, les √©motions <a href="https://medium.com/%40tkh44/emotion-ad1c45c6d28b">surpassent les</a> composants de style en termes de performances.  Cela indique que le nombre de composants <code>Context.Consumer</code> n'est pas un facteur majeur de ralentissement du rendu.  Il convient de noter qu'au moment de la r√©daction de ce document, une version b√™ta des composants de style v5.xx a √©t√© publi√©e, ce qui, selon les d√©veloppeurs de la biblioth√®que, <a href="https://medium.com/styled-components/announcing-styled-components-v5-beast-mode-389747abd987">contourne l'</a> √©motion en termes de performances. <br><br>  R√©sumez de quoi nous parlions.  Il s'av√®re qu'une combinaison de nombreux √©l√©ments <code>Context.Consumer</code> (ce qui signifie que React doit coordonner le travail des √©l√©ments suppl√©mentaires) et des m√©canismes de style dynamique internes peuvent ralentir l'application.  Je dois dire que toutes les balises <code>&lt;style&gt;</code> ajout√©es √† <code>&lt;head&gt;</code> pour chaque composant ne sont jamais supprim√©es.  Cela est d√ª au fait que les op√©rations de suppression d'√©l√©ments cr√©ent une charge importante sur le DOM (par exemple, le navigateur doit r√©organiser la page √† cause de cela).  Cette charge est sup√©rieure √† la charge suppl√©mentaire sur le syst√®me provoqu√©e par la pr√©sence sur la page d'√©l√©ments <code>&lt;style&gt;</code> inutiles.  Pour √™tre honn√™te, je ne peux pas affirmer avec certitude que les balises <code>&lt;style&gt;</code> inutiles peuvent entra√Æner des probl√®mes de performances.  Ils stockent simplement les classes inutilis√©es g√©n√©r√©es pendant le fonctionnement de la page (c'est-√†-dire que ces donn√©es n'ont pas √©t√© transmises sur le r√©seau).  Mais vous devez conna√Ætre cette fonctionnalit√© de l'utilisation de la technologie CSS-in-JS. <br><br>  Je dois dire que les balises <code>&lt;style&gt;</code> ne cr√©ent pas toutes les biblioth√®ques CSS-in-JS, car toutes ne sont pas bas√©es sur les m√©canismes qui fonctionnent lorsque les pages fonctionnent dans les navigateurs.  Par exemple, la biblioth√®que <a href="https://github.com/callstack/linaria">linaria</a> ne fait rien du tout pendant que la page s'ex√©cute dans le navigateur. <br><br>  Il d√©finit un ensemble de classes CSS fixes pendant le processus de g√©n√©ration du projet et ajuste la correspondance de toutes les r√®gles dynamiques dans la cha√Æne de mod√®le (c'est-√†-dire les r√®gles CSS en fonction des propri√©t√©s du composant) avec des propri√©t√©s CSS personnalis√©es.  Par cons√©quent, lorsqu'une propri√©t√© de composant change, la propri√©t√© CSS change et l'apparence de l'interface change.  Gr√¢ce √† cela, linaria est beaucoup plus rapide que les biblioth√®ques qui s'appuient sur des m√©canismes qui fonctionnent pendant que les pages sont en cours d'ex√©cution.  Le fait est que lors de l'utilisation de cette biblioth√®que, le syst√®me doit effectuer beaucoup moins de calculs lors du rendu des composants.  La seule chose que vous devez faire lorsque vous utilisez linaria pendant le rendu est de vous rappeler de <a href="">mettre</a> √† <a href="">jour la</a> propri√©t√© CSS personnalis√©e.  En m√™me temps, cependant, cette approche est incompatible avec IE11, elle a un support limit√© pour les propri√©t√©s CSS populaires et, sans configuration suppl√©mentaire, ne vous permet pas d'utiliser des th√®mes.  Comme c'est le cas avec d'autres domaines du d√©veloppement Web, parmi les biblioth√®ques CSS dans JS, il n'y en a pas d'id√©al, adapt√© √† toutes les occasions. <br><br><h2>  <font color="#3AC1EF">R√©sum√©</font> </h2><br>  √Ä un moment donn√©, la technologie CSS-in-JS ressemblait √† une r√©volution dans le domaine du style.  Cela a facilit√© la vie de nombreux d√©veloppeurs et a √©galement permis, sans efforts suppl√©mentaires, de r√©soudre de nombreux probl√®mes, tels que les collisions de noms et l'utilisation de pr√©fixes de fabricants de navigateurs.  Cet article est √©crit pour faire la lumi√®re sur la question de savoir comment les biblioth√®ques CSS-in-JS populaires (celles qui contr√¥lent les styles pendant qu'une page est en cours d'ex√©cution) peuvent affecter les performances des projets Web.  Je voudrais attirer particuli√®rement l'attention sur le fait que l'influence de ces biblioth√®ques sur les performances ne conduit pas toujours √† l'apparition de probl√®mes perceptibles.  En fait, dans la plupart des applications, cet effet est compl√®tement invisible.  Des probl√®mes peuvent survenir dans les applications dont les pages contiennent des centaines de composants complexes. <br><br>  Les avantages de CSS-in-JS l'emportent g√©n√©ralement sur les effets n√©gatifs potentiels de l'utilisation de cette technologie.  Cependant, les inconv√©nients de CSS-in-JS doivent √™tre gard√©s √† l'esprit par les d√©veloppeurs dont les applications rendent de grandes quantit√©s de donn√©es, ceux dont les projets contiennent de nombreux √©l√©ments d'interface en constante √©volution.  Si vous pensez que votre application est soumise aux effets n√©gatifs de CSS-in-JS, alors avant de refactoriser, cela vaut tout pour √™tre correctement √©valu√© et mesur√©. <br><br>  Voici quelques conseils pour am√©liorer les performances des applications qui utilisent les biblioth√®ques CSS-in-JS populaires qui font leur travail lorsque les pages s'ex√©cutent dans un navigateur: <br><br><ol><li>  Ne vous laissez pas trop emporter par la composition des composants stylis√©s.  Essayez de ne pas r√©p√©ter l'erreur dont j'ai parl√© au d√©but, et ne tentez pas, pour cr√©er un bouton malheureux, de construire une composition de trois composants stylis√©s.  Si vous souhaitez "r√©utiliser" le code, utilisez la propri√©t√© CSS et composez les cha√Ænes de mod√®le.  Cela vous permettra de vous passer des nombreux composants inutiles de <code>Context.Consumer</code> .  En cons√©quence, React devra g√©rer moins de composants, ce qui augmentera la productivit√© du projet. </li><li>  Efforcez-vous d'utiliser des composants ¬´statiques¬ª.  Certaines biblioth√®ques CSS-in-JS optimisent le code g√©n√©r√© si les styles du composant ne d√©pendent pas du th√®me ou des propri√©t√©s.  Plus les cha√Ænes de mod√®les sont ¬´statiques¬ª, plus la probabilit√© que les scripts des biblioth√®ques CSS-in-JS s'ex√©cutent plus rapidement est √©lev√©e. </li><li>  Essayez d'√©viter les op√©rations de restitution inutiles de vos applications React.  Efforcez-vous de ne rendre que lorsque vous en avez vraiment besoin.  Gr√¢ce √† cela, ni les actions React ni les actions de la biblioth√®que CSS-in-JS ne se chargeront.  Le nouveau rendu est une op√©ration qui ne doit √™tre effectu√©e que dans des cas exceptionnels.  Par exemple - avec le retrait simultan√© d'un grand nombre de composants "lourds". </li><li>  D√©couvrez si une biblioth√®que CSS-in-JS convient √† votre projet qui n'utilise pas de scripts ex√©cut√©s pendant que la page s'ex√©cute dans le navigateur.  Parfois, nous choisissons la technologie CSS-in-JS, car il est plus pratique pour le d√©veloppeur de l'utiliser, et non diverses API JavaScript.  Mais si votre application n'a pas besoin de support si elle n'a pas une utilisation intensive des propri√©t√©s CSS, alors il est fort possible qu'une biblioth√®que CSS-in-JS comme linaria n'utilise pas de scripts qui s'ex√©cutent pendant que la page est en cours d'ex√©cution.  De plus, cette approche r√©duira la taille du paquet d'applications d'environ 12 Ko.  Le fait est que la taille du code de la plupart des biblioth√®ques CSS-in-JS tient dans 12-15 Ko, et le code de la m√™me linaria est inf√©rieur √† 1 Ko. </li></ol><br>  <b>Chers lecteurs!</b>  Utilisez-vous des biblioth√®ques CSS-in-JS? <br><br><div style="text-align:center;"> <a href="https://ruvds.com/ru-rub"><img src="https://habrastorage.org/webt/yx/3g/bv/yx3gbv0xlht1gyjfwlg2z_kgylo.png"></a> </div><br> <a href="https://ruvds.com/ru-rub/"><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr480358/">https://habr.com/ru/post/fr480358/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr480348/index.html">Deep Fake Science, la crise de la reproductibilit√© et d'o√π viennent les r√©f√©rentiels vides</a></li>
<li><a href="../fr480350/index.html">Le condens√© de mat√©riaux int√©ressants pour le d√©veloppeur mobile # 326 (du 9 au 15 d√©cembre)</a></li>
<li><a href="../fr480352/index.html">Un g√©n√©ticien de Harvard d√©veloppe un prototype d'application de datation pour l'analyse d'ADN</a></li>
<li><a href="../fr480354/index.html">Premiers pas avec les m√©thodes de tableau JavaScript .map (), .filter () et .reduce ()</a></li>
<li><a href="../fr480356/index.html">Conseils Python utiles que vous n'avez pas rencontr√©s</a></li>
<li><a href="../fr480362/index.html">Aventures d'hexafluorure d'uranium appauvri allemand en Russie. Partie 1. Histoire et technologies d'enrichissement</a></li>
<li><a href="../fr480364/index.html">M√©taphysique de l'injection de d√©pendance</a></li>
<li><a href="../fr480368/index.html">Attraper les fuites de m√©moire en C / C ++</a></li>
<li><a href="../fr480370/index.html">Conf√©rence DEFCON 19. Les patrons aiment Excel, les pirates aussi</a></li>
<li><a href="../fr480374/index.html">Le DogBot de React Robotics poursuit sa r√©volution dans l'industrie de la construction</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>