<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõåüèæ ü§Ωüèæ ‚ñ´Ô∏è Inteligencia sobre amenazas de miedo y asco u 8 consejos pr√°cticos de TI üë©üèæ‚Äçüåæ üòÑ üë®‚Äç‚úàÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ten√≠amos dos suscripciones comerciales APT, diez intercambios de informaci√≥n, unos diez canales gratuitos y la lista de nodos de salida de Thor. Y tam...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Inteligencia sobre amenazas de miedo y asco u 8 consejos pr√°cticos de TI</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/solarsecurity/blog/417297/"><img src="https://habrastorage.org/webt/31/k_/ho/31k_hosvjz67wnrm9qu0rrd_pp0.jpeg"><br><br>  Ten√≠amos dos suscripciones comerciales APT, diez intercambios de informaci√≥n, unos diez canales gratuitos y la lista de nodos de salida de Thor.  Y tambi√©n cinco fuertes inversores, un maestro de scripts de PowerShell, un esc√°ner loki y una suscripci√≥n paga a virustotal.  No es que sin esto el centro de monitoreo no funcione, pero si est√°s acostumbrado a detectar ataques complejos, tienes que ir hasta este hobby.  Sobre todo, nos preocupaba la posible automatizaci√≥n de la verificaci√≥n de indicadores de compromiso.  No hay nada m√°s inmoral que la inteligencia artificial, que reemplaza a una persona en el trabajo donde necesita pensar.  Pero entendimos que con un aumento en el n√∫mero de clientes, tarde o temprano nos sumergir√≠amos en √©l. <br><a name="habracut"></a><br>  Muchos dicen que Threat Intelligence es delicioso, pero no todos entienden c√≥mo cocinarlo.  Incluso menos que entienden qu√© procesos deben construirse para que TI funcione y genere ganancias.  Y muy pocas personas saben c√≥mo elegir un proveedor de feeds, d√≥nde verificar el indicador de ca√≠das y si es necesario bloquear el dominio que el colega envi√≥ a WhatsApp. <br><br>  Durante varios a√±os de trabajo constante con TI, logramos caminar con diferentes rastrillos y hoy queremos dar algunos consejos pr√°cticos que ayudar√°n a los principiantes a evitar errores. <br><br><h3>  Consejo n√∫mero 1.  No tenga grandes esperanzas de atrapar un hash: la mayor√≠a del malware ha sido polim√≥rfico durante mucho tiempo </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">En el √∫ltimo art√≠culo,</a> hablamos sobre qu√© es TI y dimos algunos ejemplos de c√≥mo se organiza el proceso de trabajo.  Perm√≠tame recordarle que la informaci√≥n sobre amenazas (inteligencia de amenazas) viene en diferentes formatos y puntos de vista: pueden ser las direcciones IP de los centros de control de botnet y las direcciones de correo electr√≥nico de los remitentes de correos electr√≥nicos de phishing, y art√≠culos que describen t√©cnicas de derivaci√≥n de seguridad que APT agrupa -que comenzar√° a usar.  En general, suceden muchas cosas. <br><br>  Para racionalizar toda esta desgracia, hace unos a√±os, David Bianco propuso la llamada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"pir√°mide del dolor"</a> .  Describe bastante bien la relaci√≥n entre los tipos de indicadores que usa para detectar al atacante y cu√°nto dolor le causar√° al atacante si puede detectar un tipo espec√≠fico de indicador. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lz/ix/mv/lzixmvhlrhcdqpcjwi63chisyzq.png"></div><br><br>  Por ejemplo, si conoce el hash MD5 de un archivo malicioso, se puede detectar con bastante facilidad y con precisi√≥n.  Sin embargo, esto traer√° muy poco dolor al atacante: solo agregue 1 bit de informaci√≥n al archivo, y el hash ya es diferente. <br><br><h3>  Consejo n√∫mero 2.  Intente utilizar esos indicadores, cuyo cambio ser√° dif√≠cil t√©cnica o econ√≥micamente no rentable para el atacante </h3><br>  Anticipando la pregunta de c√≥mo averiguar si hay un archivo con este hash en las estaciones de trabajo de nuestra empresa, respondo: hay diferentes maneras.  Una de las m√°s f√°ciles es instalar Kaspersky Security Center, que contiene una base de datos de hashes MD5 de todos los archivos ejecutables en la empresa, a los que puede hacer SELECT. <br><br>  Volvamos a la pir√°mide del dolor.  A diferencia de la detecci√≥n de hash, ser√° m√°s productivo si puede detectar el TTP (t√°ctica, t√©cnica, procedimiento) del atacante.  Es m√°s complicado y requiere m√°s esfuerzo, pero provocar√° m√°s dolor. <br><br>  Por ejemplo, si sabe que un grupo APT dirigido a su sector de la econom√≠a distribuye correos electr√≥nicos de phishing con archivos * .HTA, el desarrollo de una regla de detecci√≥n que busque archivos en el correo con archivos adjuntos similares afectar√° al atacante.  Tendr√° que cambiar las t√°cticas de env√≠o por correo, quiz√°s incluso invirtiendo $ $ en la compra de exploits de 0 d√≠as o 1 d√≠a, y esto no es barato ... <br><br><h3>  Consejo n√∫mero 3.  No tenga grandes esperanzas con respecto a las reglas de detecci√≥n que no fueron desarrolladas por usted; deber√°n verificarse para detectar falsos positivos y modificarse </h3><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lb/fi/gx/lbfigxu0qc_msq7-qwn3hng6svw.jpeg"></div><br>  Al desarrollar reglas de detecci√≥n, siempre es tentador usar reglas predefinidas.  Un ejemplo gratuito es el repositorio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Sigma</a> , un formato de regla de detecci√≥n independiente de SIEM que traduce las reglas de Sigma en consultas ElasticSearch y reglas Splunk o Arcsight.  Al mismo tiempo, el repositorio contiene alrededor de 200 reglas, de las cuales ~ 130 describen ataques en Windows.  A primera vista, es muy bueno, pero el diablo, como siempre, est√° en los detalles. <br><br>  Echemos un vistazo a <a href="">una de las reglas de</a> detecci√≥n mimikatz <a href="">en</a> detalle: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cg/sw/eu/cgsweugcondwgea0klgqmwafznw.png"></div><br>  La regla detecta procesos que intentaron leer la memoria del proceso lsass.exe.  Mimikatz hace esto cuando intenta obtener hash NTLM, y la regla detecta malware. <br><br>  Sin embargo, para nosotros, como especialistas que se dedican no solo a detectar, sino tambi√©n a responder a incidentes, es extremadamente importante que esto sea realmente mimikatz.  Desafortunadamente, en la pr√°ctica, hay muchos otros procesos leg√≠timos que leen la memoria de lsass.exe con las mismas m√°scaras (algunos antivirus, por ejemplo).  Por lo tanto, en un entorno de combate real, tal regla traer√° m√°s falsos positivos que buenos. <br><br>  Hay incidentes a√∫n m√°s interesantes relacionados con la traducci√≥n autom√°tica de reglas de Sigma a reglas SIEM: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xu/0t/9l/xu0t9lchwgmepeu0hh9xnp92yko.png"></div><br>  En uno de los seminarios web, los colegas de SOC Prime que proporcionaron reglas de detecci√≥n pagas mostraron un ejemplo no funcional de dicha traducci√≥n: el campo DeviceProduct en SIEM debe ser igual a Sysmon y Microsoft Windows, lo cual es imposible. <br><br>  No quiero culpar a nadie y meter un dedo: todos est√°n locos, est√° bien.  Sin embargo, los consumidores de Threat Intelligence deben comprender que es necesario volver a verificar y refinar las reglas obtenidas de fuentes abiertas y cerradas. <br><br><h3>  Consejo # 4: verifique los nombres de dominio y las direcciones IP para detectar malware no solo en el servidor proxy y el firewall, sino tambi√©n en los registros del servidor DNS, prestando atenci√≥n tanto a los intentos de resoluci√≥n exitosos como a los fallidos </h3><br>  Los dominios maliciosos y las direcciones IP son un indicador √≥ptimo en t√©rminos de facilidad de detecci√≥n y la cantidad de dolor que le entrega a un atacante.  Pero con ellos todo es simple solo a primera vista.  Como m√≠nimo, puede preguntarse de d√≥nde obtener el registro de dominio. <br><br>  Si se limita a verificar solo los registros del servidor proxy, puede perderse el malware que intenta acceder a la red directamente o solicita un nombre de dominio inexistente generado por DGA, sin mencionar los t√∫neles DNS; todo esto no estar√° en los registros proxy corporativos. <br><br><h3>  Consejo n√∫mero 5.  "No puede bloquear el monitor": coloque una coma solo despu√©s de saber qu√© tipo de indicador es y darse cuenta de las posibles consecuencias del bloqueo </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/0x/cl/hi/0xclhi5dr1fohibe7rbsjseyze4.jpeg"></div><br>  Cada guardia de seguridad en ejercicio enfrent√≥ una pregunta dif√≠cil: ¬øbloquear la amenaza o monitorear y, si hay algo positivo, comenzar una investigaci√≥n?  Algunas regulaciones e instrucciones escriben directamente - bloquean, y algunas veces esta acci√≥n es err√≥nea. <br><br>  Si el indicador es el nombre de dominio utilizado por la agrupaci√≥n APT, <u>no lo bloquee</u> , sino que comience a monitorear.  Las t√°cticas modernas de ataques dirigidos implican la existencia de un canal de comunicaci√≥n de respaldo encubierto adicional, que solo puede identificarse durante una investigaci√≥n detallada.  El bloqueo autom√°tico en este caso impedir√° la b√∫squeda de este canal, y los compa√±eros del otro lado de la barricada comprender√°n r√°pidamente lo que aprendi√≥ sobre sus actividades. <br><br>  Por otro lado, si el indicador es un dominio de cifrado, ya <u>deber√≠a estar bloqueado</u> .  Pero no olvide monitorear los intentos fallidos de acceder a dominios bloqueados: se pueden incorporar varias direcciones de servidores de administraci√≥n en la configuraci√≥n del encriptador.  Algunos de ellos pueden faltar en los feeds y, por lo tanto, no se bloquear√°n.  Tarde o temprano, el malware se pondr√° en contacto con ellos para obtener una clave que el host cifrar√° instant√°neamente.  Solo un an√°lisis inverso de la muestra puede garantizar que ha bloqueado todas las direcciones del servidor de administraci√≥n. <br><br><h3>  Consejo n√∫mero 6.  Verifique la relevancia de todos los indicadores entrantes antes de configurarlos para monitoreo o bloqueo. </h3><br>  Recuerde que la informaci√≥n sobre las amenazas es creada por personas que tienden a cometer errores, o algoritmos de aprendizaje autom√°tico, que se ven a√∫n m√°s afectados por esto.  Ya hemos sido testigos de c√≥mo varios proveedores de informes pagados sobre las actividades de los grupos APT agregan accidentalmente muestras bastante leg√≠timas a las listas de MD5 maliciosos.  Incluso si los informes de amenazas pagados contienen indicadores de baja calidad, ¬øqu√© podemos decir sobre los indicadores obtenidos a trav√©s de la inteligencia en fuentes abiertas?  Los analistas de TI no siempre verifican los indicadores que crean para detectar falsos positivos, ya que dicha verificaci√≥n recae en los hombros del consumidor. <br><br>  Por ejemplo, si recibi√≥ la direcci√≥n IP de la pr√≥xima modificaci√≥n de Zeus o Dimnie, antes de usarla en los sistemas de detecci√≥n, <u>verifique si es parte del alojamiento o servicio que dice su IP</u> .  De lo contrario, ser√° desagradable analizar una gran cantidad de falsos positivos cuando los usuarios de un sitio alojado en este alojamiento ir√°n a sitios completamente inofensivos.  Una verificaci√≥n similar se puede hacer f√°cilmente con: <br><br><ol><li>  Servicios de categorizaci√≥n que le informar√°n sobre la naturaleza de las actividades del sitio.  Por ejemplo, ipinfo.io escribe directamente el tipo: "hosting". </li><li>  IP inversa de servicios, que le indicar√° cu√°ntos dominios est√°n registrados en esta direcci√≥n IP.  Si hay muchos de ellos, es muy probable que est√© alojando sitios. </li></ol><br>  Entonces, por ejemplo, el resultado de verificar el indicador parece ser un indicador del grupo APT Cobalt (seg√∫n el informe de un respetado proveedor de TI): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qa/f-/dw/qaf-dw_6qr6st4mkhd6ju0owzzs.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bc/dk/gy/bcdkgys-vierrjaj2san0gjz79k.png"></div><br>  Los especialistas en respuesta entendemos que los caballeros de Cobalt deben haber utilizado esta direcci√≥n IP.  Sin embargo, este indicador no tiene ning√∫n beneficio: es irrelevante porque da demasiados falsos positivos. <br><br><h3>  Consejo n√∫mero 7.  Automatice todos los procesos con informaci√≥n sobre amenazas tanto como sea posible.  Comience con uno simple: automatice completamente la verificaci√≥n de falsos positivos a trav√©s de la lista de paradas con la configuraci√≥n adicional de indicadores sin rayas para el monitoreo en SIEM </h3><br>  Para evitar una gran cantidad de falsos positivos relacionados con la inteligencia y obtenidos de fuentes abiertas, puede realizarse una b√∫squeda preliminar de estos indicadores en las listas de detenci√≥n (listas de advertencia).  Dichas listas se pueden formar sobre la base de la calificaci√≥n de Alexa (top-1000), direcciones de subredes internas, dominios de grandes proveedores de servicios como Google, Amazon AWS, MS Azure y otros servicios de alojamiento.  Tambi√©n ser√° extremadamente eficaz una soluci√≥n que cambie din√°micamente las listas de parada que consisten en los principales dominios / direcciones IP visitados por los empleados de la compa√±√≠a en la √∫ltima semana o mes. <br><br>  El desarrollo de tales listas y un sistema de verificaci√≥n puede ser dif√≠cil para el SOC promedio, por lo que tiene sentido pensar en implementar las llamadas plataformas de Inteligencia de amenazas.  Hace aproximadamente medio a√±o, Anti-malware.ru ten√≠a una buena <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">visi√≥n general de</a> las soluciones gratuitas y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">de</a> pago de esta clase. <br><br><h3>  Consejo n√∫mero 8.  Escanee toda la empresa en busca de indicadores de host, no solo hosts que est√°n conectados a SIEM </h3><br>  Debido al hecho de que, por regla general, no todos los hosts empresariales est√°n conectados a SIEM, no es posible verificar si hay un archivo malicioso con un nombre o ruta espec√≠ficos utilizando solo la funcionalidad est√°ndar de SIEM.  Puede salir de esta situaci√≥n de las siguientes maneras: <br><br><ol><li>  Use esc√°neres IoC como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Loki</a> .  Puede ejecutarlo en todos los hosts de la empresa a trav√©s del mismo SCCM y redirigir la salida a una carpeta de red p√∫blica. </li><li>  Utiliza esc√°neres de vulnerabilidades.  Algunos de ellos tienen modos de cumplimiento en los que puede verificar un archivo espec√≠fico en una ruta espec√≠fica. </li><li>  Escriba un script de PowerShell y ejec√∫telo a trav√©s de WinRM.  Si escribe pereza usted mismo, puede usar uno de los muchos scripts, por ejemplo, este. </li></ol><br>  Como dije al principio, este art√≠culo no implica informaci√≥n completa sobre c√≥mo trabajar correctamente con Threat Intelligence.  Sin embargo, en nuestra experiencia, seguir incluso estas reglas simples permitir√° a los principiantes no pisar el rastrillo y comenzar de inmediato con un trabajo efectivo con varios indicadores de compromiso. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es417297/">https://habr.com/ru/post/es417297/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es417285/index.html">D√≥nde insertar comillas en IPv6</a></li>
<li><a href="../es417287/index.html">"Calendario de prueba" para julio. Pruebas anal√≠ticas</a></li>
<li><a href="../es417289/index.html">Diario del aprendiz: D√≠a 1. Aprendiz a junior</a></li>
<li><a href="../es417293/index.html">Recuperaci√≥n de contrase√±a y almacenamiento primario en la nube, o Novedades de Zimbra 8.8.9</a></li>
<li><a href="../es417295/index.html">¬øC√≥mo escrib√≠ la biblioteca est√°ndar de C ++ 11 o por qu√© boost es tan aterrador? Capitulo 3</a></li>
<li><a href="../es417299/index.html">En l√≠nea, fuera de l√≠nea y P2P: c√≥mo comprar bitcoin en Rusia</a></li>
<li><a href="../es417301/index.html">Receta Smooth Release: PMy Note</a></li>
<li><a href="../es417303/index.html">Hack para admitir botones de auriculares con Windows Android</a></li>
<li><a href="../es417305/index.html">Ultima Online: una mirada entre bastidores</a></li>
<li><a href="../es417307/index.html">Glaucoma: ¬øno has o√≠do hablar de ella? Conoce al asesino en serie de visi√≥n silenciosa</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>