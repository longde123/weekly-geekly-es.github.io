<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìç üç¨ üíû Wie ich Recycle erstellt habe! VR üì± üë©üèø‚Äç‚öïÔ∏è üç∏</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Im vorherigen Artikel haben wir versucht, eine grundlegende Szene in A-Frame zu erstellen, um die grundlegenden Konzepte des Frameworks in der Praxis ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie ich Recycle erstellt habe! VR</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/443062/"><img src="https://habrastorage.org/webt/zw/1k/9x/zw1k9xfuttgxodgleuo-ksko4nq.png"><br><br>  Im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">vorherigen Artikel haben</a> wir versucht, eine grundlegende Szene in A-Frame zu erstellen, um die grundlegenden Konzepte des Frameworks in der Praxis auszuprobieren.  In diesem Artikel m√∂chte ich meine Erfahrungen bei der Erstellung eines Spiels auf A-Frame - Recycle!  VR  Das Projekt-Repository ist unter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">folgendem Link</a> verf√ºgbar. <br><br><h2>  Recycling !? </h2><br>  Die Idee, ein Spiel zu erstellen, kam fast sofort, als ich von Web VR erfuhr.  Obwohl ich im Allgemeinen glaube, dass Spiele im Internet guten Projekten auf jeden Fall unterlegen sind, selbst f√ºr mobile Ger√§te, ganz zu schweigen von PCs und Konsolen.  Aber es scheint mir, dass das Spiel der schwierigste Test ist.  Ich begann genau dar√ºber nachzudenken, was ich tun kann.  Ich habe mir andere Projekte angesehen und war sofort beeindruckt von der M√∂glichkeit, mit dem Controller etwas aufzunehmen.  Und da ich seit einiger Zeit mit einer Organisation verbunden bin, die sich mit der getrennten M√ºllabfuhr befasst, kam die Antwort von selbst.  Recycling.  Wir nehmen den M√ºll und werfen ihn in den M√ºll.  Was k√∂nnte einfacher sein.  Aber alles stellte sich als nicht so einfach heraus, und dies wird in der Tat weiter diskutiert. <br><a name="habracut"></a><br><h2>  Rahmenauswahl </h2><br>  Zum Zeitpunkt des Beginns der Arbeit am Spiel kannte ich nur zwei mehr oder weniger ernsthafte Frameworks: React 360, A-Frame.  Offensichtlich war A-Frame am besten f√ºr die Erstellung des Spiels geeignet.  Ja, jetzt wei√ü ich, dass es noch eine PlayCanvas-Spiel-Engine gibt, die auch VR unterst√ºtzt, aber es ist zu sp√§t.  Dar√ºber hinaus stellte sich heraus, dass A-Frame auch nicht schlecht f√ºr die Erstellung von Spielen ist. <br><br><h2>  Wo soll ich anfangen? </h2><br>  Ich begann damit, offizielle Spielbeispiele von A-Frame-Entwicklern zu studieren.  Der Nutzen davon reicht nicht aus.  A-Blast, A-Painter, Museum, Super Craft und jetzt auch Gunters of Oasis.  Von allen vorgestellten Projekten mochte ich A-Blast am meisten - einen Shooter, in dem man mit den s√º√üesten Kreaturen im Universum k√§mpfen muss.  Deshalb wollte ich dieses Spiel als Vorlage f√ºr mein Spiel nehmen.  Aber es hat nicht geklappt.  Und der Grund daf√ºr war die Struktur des Spiels.  Es schien mir, dass sie zu √ºberladen und nicht durchdacht war.  Vielleicht ist mehr nicht erforderlich, aber ich wollte etwas bequemeres und verst√§ndlicheres tun. <br><br><h2>  Struktur </h2><br>  Die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">A-Blast-</a> Struktur stellt nur einen Einstiegspunkt dar - die Datei index.html, die eine Szene mit allen Assets, grundlegenden Spielentit√§ten, Steuerelementen und allem im Allgemeinen enth√§lt. <br><br><img src="https://habrastorage.org/webt/_t/gy/cv/_tgycvogik29i2jemys2srlpuuy.png"><br><br>  Wie Sie im Screenshot sehen k√∂nnen, gibt es neben den erforderlichen Komponenten und Systemen (A-Frame verwendet das Muster des Entity Component System) auch Kugeln und Feinde - im Wesentlichen dieselben Systeme, aber aus irgendeinem Grund haben sie einen eigenen Wrapper.  Sagen Sie im Allgemeinen, dass dieser Code nicht leicht zu verstehen ist.  Also habe ich mich √ºberlegt, wie dieser Code strukturiert werden kann.  Die erste Idee ist, die Szene in ihre Bestandteile zu zerlegen.  Warum sollten ein Router und Vorlagen n√ºtzlich sein, um diesen oder jenen Teil der Szene zu rendern?  Nachdem ich nach der ersten und zweiten gesucht hatte (nein, nicht f√ºnf Minuten), fand ich nichts.  Obwohl ich ein Bef√ºrworter der Regel bin, schreibe keine Fahrr√§der, aber diesmal musste ich meine Entscheidung schreiben.  Obwohl ich irgendwo in 2-3 Wochen auf Vorlagen von Kevin Ngo gesto√üen bin.  Aber es war zu sp√§t. <br><br><h2>  Router und Muster </h2><br><img src="https://habrastorage.org/webt/sp/bm/tn/spbmtnkznus5jjfffyvhjys6xvg.gif"><br><br>  Und so betreten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">A-Frame-Router-Vorlagen</a> die Szene.  Was kann er tun?  Wie oben erw√§hnt, besteht seine Hauptaufgabe darin, die erforderlichen Teile des Spiels zu rendern, z. B. den Titelbildschirm, das Spielfeld, den Endbildschirm des Spiels usw.  Wie kann man das machen?  Grunds√§tzlich finden Sie alles, was Sie brauchen, in der Dokumentation zum Modul auf github, aber kurz gesagt, wir haben folgendes: <br><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-scene</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">router</span></span></span><span class="hljs-tag">&gt;</span></span> ... <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Routes --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-route</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"start-screen"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">template</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"start-screen"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-route</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-route</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"game-field"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">template</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"game-field"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-route</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-route</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"game-over"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">template</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"game-over"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-route</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-route</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"how-to-play"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">template</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"how-to-play"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-route</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- End Routes --&gt;</span></span> ... <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Templates --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"controls"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- End Templates --&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-scene</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><ol><li>  Wir f√ºgen der Szene die Routerkomponente hinzu. </li><li>  F√ºgen Sie f√ºr jeden Teil der Anwendung (Szenenbilder) eine Route hinzu.  Eine Route f√ºr den Startbildschirm, eine andere f√ºr das Spielfeld usw. </li><li>  Rendern Sie Vorlagen direkt √ºber a-Vorlagen </li><li>  Bei Bedarf √§ndern wir die Routen durch <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.el.systems.router.changeRoute(<span class="hljs-string"><span class="hljs-string">'game-field'</span></span>);</code> </pre> <br>  <b>Hinweis</b> : Dieses Beispiel bezieht sich auf den Szenencode, sodass wir das Routersystem direkt aufrufen k√∂nnen. </li><li>  Wir setzen und verbinden die Vorlagen, ungef√§hr so: <br><br><pre> <code class="javascript hljs">AFRAME.registerTemplate(<span class="hljs-string"><span class="hljs-string">'game-field'</span></span>, <span class="hljs-string"><span class="hljs-string">` &lt;a-sub-assets&gt; &lt;a-asset-item id="glass" src="/assets/models/glass_bottle.gltf"&gt;&lt;/a-asset-item&gt; ... &lt;audio id="fail" src="/assets/sounds/fail.wav" preload&gt;&lt;/audio&gt; &lt;/a-sub-assets&gt; &lt;a-template name="button" options="text: EXIT; position: 0 1 4; rotation: 0 180 0; event: stop-game"&gt;&lt;/a-template&gt; &lt;a-entity id="indicator" indicator visible="false" position="0 1 -2" text="align: center; width: 4; color: #00A105; value: -1" &gt;&lt;/a-entity&gt; &lt;a-entity game-field-manager&gt;&lt;/a-entity&gt; `</span></span>);</code> </pre><br>  <b>Hinweis: Mit</b> a-sub-Assets k√∂nnen Sie sowohl Assets als auch a-Assets laden, jedoch nur mit dem Unterschied, dass standardm√§√üig eine Pr√ºfung erfolgt. Wenn das Asset bereits hinzugef√ºgt wurde, wird es beim √Ñndern der Route nicht erneut hinzugef√ºgt. <br><br>  <b>Hinweis 2:</b> Normalerweise k√∂nnen Sie Vorlagen nur mit ES6-Vorlagenzeichenfolge verwenden.  Andernfalls kann es zu "string" + var + "string" werden, nicht cool.  Kevin unterst√ºtzt beispielsweise Template-Engines.  Aber warum sollte man es komplizieren? <br></li></ol><br>  Auf diese Weise k√∂nnen Sie eine praktische Anwendungsstruktur erstellen, die Folgendes enth√§lt: <i>Komponenten, Systeme, Vorlagen, Status, Bibliotheken</i> .  Nichts mehr und alles steht in den Regalen. <br><br><h2>  Objekte manipulieren </h2><br><img src="https://habrastorage.org/webt/zm/m1/i3/zmm1i3r-m5no1cptxljmjcwr88u.gif"><br><br>  Die allererste Aufgabe, die gel√∂st werden sollte, war die Manipulation von Objekten.  Ich brauchte einen funktionalen Greifer.  Anfangs begann ich dar√ºber nachzudenken, wie man eine solche Komponente von Grund auf neu erstellt.  Rein auf philistischer Ebene ist eine solche Reflexion zul√§ssig: Wir haben einen Controller (im Fall eines Desktops ist es ein Cursor), er hat eine Position.  Wir haben auch bestimmte Objekte, zum Beispiel W√ºrfel, sie haben auch eine Position.  Durch √Ñndern der Position des Controllers m√ºssen wir die Position des Objekts √§ndern.  Ist es einfach  Also ja, aber es wird nicht funktionieren.  Ich werde einige Punkte aus einer sehr langen Liste erw√§hnen, um Sie davon zu √ºberzeugen: <br><br><ul><li>  Der Cursor in A-Frame ist ein Nachkomme einer Kamera und hat relative Koordinaten. </li><li>  Die Position des Controllers reicht nicht aus. Sie m√ºssen dennoch die Ausrichtung, den Abstand zum Objekt und die Position der Kamera (des Players) ber√ºcksichtigen. </li><li>  Bei Objekten mit einem physischen K√∂rper funktioniert dies √ºberhaupt nicht, da die Koordinaten der Geometrie mit den Koordinaten des K√∂rpers verbunden sind. </li></ul><br>  Es ist gut, dass der gute Mr. Wil Murphy und seine Freunde <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">A-Frame-Super-H√§nde gemacht haben</a> .  Im Wesentlichen enth√§lt diese Bibliothek alle erforderlichen Komponenten: <br><br><ul><li>  <b>schwebbar</b> .  Anleitung.  Zeigen Sie mit dem Controller oder Cursor auf die Kollisionszone des Objekts (normalerweise das gesamte Objekt). </li><li>  <b>greifbar</b> : Erfassen.  Nehmen Sie ein Objekt mit der entsprechenden Schaltfl√§che und ziehen Sie es </li><li>  <b>dehnbar</b> : Mit beiden H√§nden greifen und dehnen </li><li>  <b>draggable \ dropable</b> : <b>Wird im</b> Wesentlichen ben√∂tigt, um das Ereignis "Das Objekt wurde an einen bestimmten Ort geworfen" zu bestimmen. </li></ul><br>  Im oben genannten Repository finden Sie alles, was Sie zum Einrichten und Verbinden von Superh√§nden ben√∂tigen.  Ich m√∂chte nur auf eine Reihe von Nuancen aufmerksam machen: <br><br><ul><li>  Erstellen Sie separate Mixins f√ºr die rechte und linke Hand.  Trennen Sie die Komponenten nach Art der unterst√ºtzten Ger√§te.  Zum Beispiel kann die rechte Hand zus√§tzlich zu Oculus-Touch, Vive-Steuerungen, Windows-Bewegungssteuerungen auch Oculus-Go-Steuerungen und Gear-VR-Steuerungen geben.  Die linke Hand muss f√ºr BP-Helme versteckt sein.  Jeder Controller muss sowohl Mixin-H√§nde als auch eine Super-Hands-Komponente enthalten.  <a href="">Ein Beispiel</a> ; </li><li>  Wenn Sie Objekte angegeben haben: .clsname f√ºr reycaster, vergessen Sie nicht, es jedem Element hinzuzuf√ºgen, das mit dem Controller √ºbernommen werden kann. Andernfalls schl√§gt kein Ereignis f√ºr Superh√§nde fehl.  Nat√ºrlich, wenn <i>colliderEvent: Raycaster-Schnittpunkt</i> ; </li><li>  Durch Ziehen mit der Maus werden 2D-Koordinaten in die 3D-Welt projiziert. Verwenden Sie daher besser den Cursor f√ºr den Desktop. </li></ul><br><h2>  Physik hinzuf√ºgen </h2><br>  Das Hinzuf√ºgen von Physik zu einem Frame ist eigentlich sehr einfach.  Hierf√ºr gibt es ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">spezielles System</a> .  Es wird der Szene hinzugef√ºgt und voila, Physik ist bereits in Ihrer Tasche. <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-scene</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">physics</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"debug: false"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-box</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">dynamic-body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">position</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0 1 -2"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-box</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-box</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"floor"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">static-body</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-box</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-scene</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  <b>Mark</b> : <i>debug: true</i> erm√∂glicht die Anzeige von physischen K√∂rpern, die an Geometrie gebunden sind.  Dies ist praktisch, wenn Sie ein Objekt ‚Äûskizzieren‚Äú m√ºssen. <br><br>  Tats√§chlich ist dies ein Wrapper f√ºr <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">cannon.js</a> , der die ganze Drecksarbeit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">erledigt</a> , Geometrie und physische K√∂rper f√ºr Sie zu vergleichen.  Informationen zur Funktionsweise dieses Systems finden Sie in der Beschreibung des Repositorys.  Und ich m√∂chte nur auf einen Punkt eingehen, der f√ºr mein Spiel wichtig ist. <br><br>  Ich musste sicherstellen, dass durch Dr√ºcken der Taste auf den Papierkorb eine bestimmte Kraft eingestellt wurde (je mehr Sie die Taste gedr√ºckt halten, desto gr√∂√üer ist die Kraft).  Wie sich herausstellte, ist diese Aufgabe nicht so einfach, wie es auf den ersten Blick scheint.  Was ist so kompliziert?  - Sie sagen, wir <i>bewerbenImpluse</i> und Voila.  Nicht wirklich ... Es legt die Drehung eines Objekts entlang eines Vektors fest, der auf die K√∂rpermitte angewendet wird.  Mit dieser Methode k√∂nnen wir nur ein Weihnachtsfest emulieren.  Wenn Sie jedoch einen Vektor mit dem richtigen Winkel zur Ebene festlegen, erhalten Sie m√∂glicherweise etwas √Ñhnliches wie einen Push.  Aber das brauchte ich nicht. <br><br>  Wie sich herausstellte, brauchte ich Geschwindigkeit, um diesen Parameter einzustellen. Das Objekt beginnt seine Bewegung in eine bestimmte Richtung.  Diese Richtung wird durch den Vektor angegeben.  Und hier beginnt der Spa√ü.  Wie finde ich diesen Vektor?  Ich habe zwei M√∂glichkeiten gefunden: <br><br><ol><li>  Holen Sie sich das Quaternion des Controllers (oder der Kamera f√ºr den Desktop), das seine Ausrichtung im Raum beschreibt.  Erstellen Sie einen Vektor V1 = &lt;1,1,1&gt;, multiplizieren Sie ihn mit der Wurfkraft und wenden Sie die Ausrichtung auf all dies an. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> velocityVector = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.Vector3(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>); velocityVector.multiplyScalar(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.force); velocityVector.applyQuaternion(controllerQuaternion); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.grabbed.body.velocity.set(velocityVector.x, velocityVector.y, velocityVector.z);</code> </pre></li><li>  Suchen Sie die Position des Controllers (Cursors) und die Position des geworfenen Objekts.  Berechnen Sie den Richtungsvektor f√ºr zwei Punkte.  Normalisieren Sie den Vektor.  Und multiplizieren Sie es mit Gewalt. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> directionX = (trashPosition.x - zeroPosition.x); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> directionZ = (trashPosition.z - zeroPosition.z); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> vectorsLength = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.sqrt(<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.pow(directionX, <span class="hljs-number"><span class="hljs-number">2</span></span>) + <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.pow(directionZ, <span class="hljs-number"><span class="hljs-number">2</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> x = (directionX / vectorsLength) * <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.force; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> y = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.force; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> z = (directionZ / vectorsLength) * <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.force; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.grabbed.body.velocity.set(x , y, z );</code> </pre></li></ol><br>  Ich habe die zweite Option gew√§hlt, weil ich darin nur x und z z√§hlen kann.  Und stellen Sie sich selbst ein, da ich einen Wurf entlang des Bogens brauchte, damit der abgelegte M√ºll in den Korb f√§llt, obwohl der Benutzer den Controller h√§lt. <br><br><h2>  Ein paar Worte zum Modell </h2><br><img src="https://habrastorage.org/webt/vt/fl/e9/vtfle9xqpvbpak4i2su4fusxplk.png"><br><br>  Von Anfang an habe ich mich f√ºr ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Low-Poly-</a> Spiel entschieden.  Obwohl WebGL heutzutage in der Lage ist, relativ komplexe Szenen zu rendern, ist seine Leistung fortgeschrittenen Bibliotheken wie DirectX, Vulkan, Mantle usw. immer noch unterlegen. Dies h√§ngt auch von der Leistung des Ger√§ts des Benutzers ab.  Da ich mich auf g√ºnstigere mobile BP-Helme (Oculus Go, Gear VR) konzentrieren m√∂chte, denke ich, dass Low-Poly eine der wenigen L√∂sungen f√ºr die Erstellung einer VR-Anwendung oder eines VR-Spiels ist.  Obwohl nat√ºrlich alles von der Lautst√§rke abh√§ngt. <br><br>  Okay, Low-Poly ist so Low-Poly, aber wie macht man das alles?  Alles ist sehr einfach, es gibt ein gutes Open Source Tool - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Blender</a> .  Glauben Sie mir, er ist zu viel f√§hig, aber f√ºr einfache Aufgaben ist er nicht ganz geeignet.  Es gibt viele Schulungsmaterialien zum Modellieren in Blender, und es wird nicht schwierig sein, sie zu finden.  Ich wollte Ihre Aufmerksamkeit nur auf eine Reihe von Punkten im Zusammenhang mit der Webentwicklung lenken: <br><br><ol><li>  Der Drei-Js-Exporteur ist veraltet.  Notwendigkeit, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GLTF-Exporteur</a> zu finden und zu liefern.  GLTF ist ein spezielles Format f√ºr das Web.  Und ja, das ist JSON. </li><li>  GLTF unterst√ºtzt Cycles Renderer nicht, daher m√ºssen Sie Blender Renderer verwenden.  Und das bedeutet, dass es keine coolen Knoten, Farbtransformationen oder Metallhighlights gibt (kann anders gemacht werden). </li><li>  Sie m√ºssen nur das ausgew√§hlte Element exportieren.  Sie ben√∂tigen keine zus√§tzlichen Kameras und Lichter?  Datei&gt; Exportieren&gt; gltf 2.0.  Im linken Men√º wird nur GLTF 2.0 exportieren&gt; Exportieren ausgew√§hlt. </li><li>  Wir beginnen mit dem Export von Position &lt;0, 0, 0&gt; in Blender.  Es ist besser, an derselben Stelle zu skalieren, damit Sie sp√§ter die Skalierungskomponente nicht in einem Frame verwenden. </li><li>  Wenn Sie wie in Recycle!  VR, Sie m√ºssen Objekte nur dort hinzuf√ºgen, wo der Spieler theoretisch hinschauen kann.  Hinter, hinter den H√§usern, im Recycling!  Es gibt ein paar B√§ume und nur an der Stelle, an der der Benutzer sie sehen kann.  Es ist nicht erforderlich, die Szene zu √ºberladen. </li><li>  Wenn Sie das Modellmaterial √§ndern m√ºssen, m√ºssen Sie warten, bis es geladen ist, das Modell selbst abrufen und alle Knoten herausziehen (GLTF enth√§lt Informationen nicht nur zu Netzen). <br><br><pre> <code class="javascript hljs">e.detail.model.traverse(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">node</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (node.isMesh) { node.material.color = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.Color(someColor); } });</code> </pre></li></ol><br><h2>  Abschlie√üend </h2><br>  Vielen Dank f√ºr Ihre Aufmerksamkeit!  Ich erinnere Sie noch einmal daran, dass das Projekt-Repository unter dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">folgenden Link</a> verf√ºgbar ist.  Jeder, der etwas Neues in dieses Spiel bringen m√∂chte - willkommen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de443062/">https://habr.com/ru/post/de443062/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de443052/index.html">Sch√∂ne genaue Uhr von einem alten Smartphone</a></li>
<li><a href="../de443054/index.html">Eine Auswahl von Dienstprogrammen f√ºr einen Programmierer unter Linux</a></li>
<li><a href="../de443056/index.html">Zweiter HIV-Patient erreicht Remission</a></li>
<li><a href="../de443058/index.html">Saubere Architektur. Teil I - Einf√ºhrung</a></li>
<li><a href="../de443060/index.html">Wird das Raumschiff den Mars erreichen?</a></li>
<li><a href="../de443064/index.html">Die israelische Sonde fliegt zum Mond</a></li>
<li><a href="../de443066/index.html">Sokrates in der Liebe: der tats√§chlich den Grundstein f√ºr die westliche Philosophie legte</a></li>
<li><a href="../de443070/index.html">√úber Ideen, die am Beispiel der Gracchus-Br√ºder verfr√ºht und zeitgem√§√ü sind</a></li>
<li><a href="../de443080/index.html">Festplatten in Laptops und Desktops k√∂nnen eine Quelle f√ºr das Abh√∂ren von Gespr√§chen von Personen in der N√§he sein</a></li>
<li><a href="../de443082/index.html">Warum Sie andere nicht ansehen sollten, wenn Sie eine Sprache lernen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>