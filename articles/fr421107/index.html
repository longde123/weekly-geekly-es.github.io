<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üÜë ü¶è ü§∞ Nous d√©montons et visualisons les certificats qualifi√©s √† l'aide de Python / Tkinter üëáüèΩ ü•Å üë®üèª‚Äçüç≥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Les certificats qualifi√©s sont rapidement devenus partie int√©grante de la vie quotidienne. Et de plus en plus de gens veulent voir cette "b√™te" de l'i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nous d√©montons et visualisons les certificats qualifi√©s √† l'aide de Python / Tkinter</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421107/"><img src="https://habrastorage.org/webt/nc/op/59/ncop592ddqui_ckgkjas77-ccuq.png" align="left">  Les certificats qualifi√©s sont rapidement devenus partie int√©grante de la vie quotidienne.  Et de plus en plus de gens veulent voir cette "b√™te" de l'int√©rieur.  C'est d'une part.  D'un autre c√¥t√©, de plus en plus d'applications sont d√©velopp√©es dans lesquelles les informations de ces certificats sont utilis√©es.  Et ce ne sont pas seulement des attributs du TIN ou du BIN du propri√©taire ou de l'√©diteur du certificat.  Il peut s'agir d'informations sur le fournisseur de chiffrement utilis√© par le titulaire du certificat (attribut subjectSignTool) pour g√©n√©rer une cl√© priv√©e ou sur la base de laquelle certifi√© signifie qu'un centre de certification (CA) a √©t√© cr√©√© qui a √©mis un certificat.  Et si vous √©crivez un programme qui analysera les certificats √©mis, vous pouvez collecter des statistiques int√©ressantes sur les outils de protection des informations cryptographiques utilis√©s par les d√©tenteurs de certificats et sur la base des fonds certifi√©s (ou non certifi√©s) (mais moins int√©ressants) des autorit√©s de certification d√©ploy√©es (attribut issuerSignTools): <br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/iy/l7/-z/iyl7-zghkwsdmk4zfzx9fa1azma.png"><br><br>  Dans les espaces ouverts de Habr, une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tentative</a> r√©ussie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">a</a> d√©j√† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√©t√©</a> faite <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pour</a> d√©monter un certificat qualifi√©.  Malheureusement, l'analyse n'a concern√© que l'obtention des attributs TIN, PSRN et SNILS, qui font partie du nom distinctif DN (Distinguished Name).  Mais pourquoi malheureusement?  L'auteur avait un probl√®me sp√©cifique et il a √©t√© r√©solu.  Nous voulons acc√©der aux attributs d'un certificat qualifi√© via Python et fournir un utilitaire graphique pour les visualiser. <br><br>  Pour acc√©der aux attributs du certificat, nous utiliserons le package <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">fsb795</a> .  Le package est disponible pour Pytho2 et Python3, pour Linux et pour Windows.  Pour l'installer, il suffit d'ex√©cuter la commande traditionnelle: <br><br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># python -m pip install fsb795 Collecting fsb795 Requirement already satisfied: pyasn1-modules&gt;=0.2.2 in /usr/lib/python2.7/site-packages (from fsb795) (0.2.2) Collecting pyasn1&gt;=0.4.4 (from fsb795) Using cached https://files.pythonhosted.org/packages/d1/a1/7790cc85db38daa874f6a2e6308131b9953feb1367f2ae2d1123bb93a9f5/pyasn1-0.4.4-py2.py3-none-any.whl Requirement already satisfied: six in /usr/lib/python2.7/site-packages (from fsb795) (1.11.0) Installing collected packages: pyasn1, fsb795 Successfully installed fsb795-1.5.2 pyasn1-0.4.4 [root@localhost GCryptGOST]#</span></span></code> </pre> <br>  Le package fsb795 n√©cessite les packages pyasn1 et pyasn1-modules.  Par cons√©quent, s'ils ne sont pas install√©s, une tentative sera effectu√©e pour les installer. <br><br>  Pour python3, cette commande ressemble √† ceci: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># python -m pip install fsb795 ... #</span></span></code> </pre> <br>  Vous pouvez √©galement t√©l√©charger les <a href="">packages d'</a> installation <a href="">python3</a> et <a href="">python2</a> et les <a href="">installer</a> localement. <br>  Le nom du package, par analogie avec les modules du package pyasn1-modules, par exemple, rfc2459, etc., indique qu'il est con√ßu pour fonctionner avec des certificats qui r√©pondent aux exigences de l'Ordre du Service f√©d√©ral de s√©curit√© de la F√©d√©ration de Russie du 27 d√©cembre 2011 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">n ¬∞ 795</a> ¬´Sur approbation exigences relatives √† la forme d'un certificat qualifi√© ... ". <br><br>  L'acc√®s au certificat dans le package fsb795 est impl√©ment√© via la classe Certificate: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># -*- coding: utf-8 -*- import os, sys import pyasn1 import binascii import six from pyasn1_modules import rfc2459, pem from pyasn1.codec.der import decoder from datetime import datetime, timedelta class Certificate: #  cert_full = '' cert = '' pyver = '' formatCert = '' def __init__ (self,fileorstr): #     if not os.path.exists(fileorstr): #  ,  ,     #    PEM- strcert = fileorstr.strip('\n') if (strcert[0:27] != '-----BEGIN CERTIFICATE-----'): return idx, substrate = pem.readPemBlocksFromFile(six.StringIO( strcert), ('-----BEGIN CERTIFICATE-----', '-----END CERTIFICATE-----') ) self.pyver = sys.version[0] try: self.cert_full, rest = decoder.decode(substrate, asn1Spec=rfc2459.Certificate()) self.cert = self.cert_full["tbsCertificate"] self.formatCert = 'PEM' except: self.pyver = '' self.formatCert = '' return #   #  self.pyver   python self.pyver = sys.version[0] filename = fileorstr if (self.pyver == '2'): if sys.platform != "win32": filename = filename.encode("UTF-8") else: filename = filename.encode("CP1251") #  DER file1 = open(filename, "rb") substrate = file1.read() if (self.pyver == '2'): b0 = ord(substrate[0]) b1 = ord(substrate[1]) else: b0 = substrate[0] b1 = substrate[1] #  PEM/DER,   0x30,       127  if (b0 == 48 and b1 &gt; 128) : self.formatCert = 'DER' else: self.formatCert = 'PEM' file1 = open(filename, "r") idx, substrate = pem.readPemBlocksFromFile( file1, ('-----BEGIN CERTIFICATE-----', '-----END CERTIFICATE-----') ) file1.close() try: self.cert_full, rest = decoder.decode(substrate, asn1Spec=rfc2459.Certificate()) self.cert = self.cert_full["tbsCertificate"] except: self.pyver = '' self.formatCert = '' #       def subjectSignTool(self): . . . #,     if __name__ == "__main__": . . .</span></span></code> </pre> <br>  Pour cr√©er une instance d'un objet pour un certificat sp√©cifique, il suffit d'ex√©cuter l'instruction suivante: <br><br><pre> <code class="bash hljs">$ python Python 2.7.15 (default, May 23 2018, 14:20:56) [GCC 5.4.0] on linux Type <span class="hljs-string"><span class="hljs-string">"help"</span></span>, <span class="hljs-string"><span class="hljs-string">"copyright"</span></span>, <span class="hljs-string"><span class="hljs-string">"credits"</span></span> or <span class="hljs-string"><span class="hljs-string">"license"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> more information. &gt;&gt;import fsb795 &gt;&gt;tek_cert = fsb795.Certificate(&lt;/  &gt;) &gt;&gt;</code> </pre><br>  En tant que param√®tre, lors de la cr√©ation d'une instance de la classe, un certificat est sp√©cifi√©, qui peut √™tre dans un fichier PEM ou DER ou √™tre une cha√Æne au format PEM. <br><br>  Apr√®s la cr√©ation, chaque instance a quatre attributs: pyver, formatCert, cert_full et cert. <br>  √Ä l'aide de l'attribut pyver, vous pouvez v√©rifier le d√©roulement de l'analyse du certificat.  Si pyver est √©gal √† une cha√Æne vide, le fichier ou la cha√Æne ne contient pas de certificat.  Sinon, l'attribut pyver contient la version du langage python: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>c1=fsb795.Certificate(<span class="hljs-string"><span class="hljs-string">'     '</span></span>) &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (c1.pyver == <span class="hljs-string"><span class="hljs-string">''</span></span>): ... <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">'   '</span></span>) ...     &gt;&gt;&gt; c2 = fsb795.Certificate(<span class="hljs-string"><span class="hljs-string">'/home/a513/cert_nss.der'</span></span>) &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (c2.pyver != <span class="hljs-string"><span class="hljs-string">""</span></span>): ... print(c2.pyver) ... <span class="hljs-number"><span class="hljs-number">2</span></span> &gt;&gt;&gt; print(c2.formatCert) DER &gt;&gt;&gt;</code> </pre> <br>  L'attribut formatCert, lors de la cr√©ation r√©ussie d'une instance de la classe Certificate, contient le type de format de fichier / cha√Æne du certificat.  Il peut s'agir de PEM ou DER.  La raison pour laquelle cet attribut est n√©cessaire appara√Ætra clairement ci-dessous. <br><br>  Le package fsb795 a √©t√© cr√©√© √† l'aide du package <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pyasn1</a> .  Ainsi, deux attributs n'ont pas √©t√© examin√©s.  L'attribut cert stocke le certificat tbs, pr√™t √† √™tre utilis√© avec le package pyasn1.  Un autre attribut cert_full stocke l'int√©gralit√© du certificat d√©cod√© par rapport √† rfc2459.  Nous montrons comment obtenir l'algorithme de cl√© publique avec l'attribut cert et le package pyasn1 connect√©: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>pubkey = c2.cert[<span class="hljs-string"><span class="hljs-string">'subjectPublicKeyInfo'</span></span>] &gt;&gt;&gt; ff = pubkey[<span class="hljs-string"><span class="hljs-string">'algorithm'</span></span>] &gt;&gt;&gt; ff1 = ff[<span class="hljs-string"><span class="hljs-string">'algorithm'</span></span>] &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (ff1) <span class="hljs-number"><span class="hljs-number">1.2</span></span><span class="hljs-number"><span class="hljs-number">.643</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.19</span></span> &gt;&gt;&gt;</code> </pre> <br>  Au final, il sera possible d'√©valuer les capacit√©s du package fsb795 pour obtenir des informations sur la cl√© publique d'un certificat qualifi√©. <br><br>  Lorsqu'une instance de la classe Certificate est cr√©√©e avec succ√®s, nous avons √† notre disposition des m√©thodes qui facilitent l'obtention des donn√©es n√©cessaires √† partir du certificat.  Toutes les informations sur la cl√© publique peuvent √™tre obtenues comme suit: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>c3 = fsb795.Certificate(<span class="hljs-string"><span class="hljs-string">'cert.der'</span></span>) &gt;&gt;&gt; key_info=c3.publicKey() &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> opt <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> key_info.keys(): ... val = str(key_info[opt]) ... <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (opt + <span class="hljs-string"><span class="hljs-string">'='</span></span> + val) ... curve=<span class="hljs-number"><span class="hljs-number">1.2</span></span><span class="hljs-number"><span class="hljs-number">.643</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.36</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> hash=<span class="hljs-number"><span class="hljs-number">1.2</span></span><span class="hljs-number"><span class="hljs-number">.643</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.30</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> valuepk=<span class="hljs-number"><span class="hljs-number">5</span></span>b785f86f0dd5316ba37c8440e398e83f2ec0c34478f90da9c0c8046d341ff66f9044cd00a0e25530 acefd51e6be852dbecacbaabc55e807be8e1f861658bd58 algo=<span class="hljs-number"><span class="hljs-number">1.2</span></span><span class="hljs-number"><span class="hljs-number">.643</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.19</span></span> &gt;&gt;&gt;</code> </pre><br>  Actuellement, la classe Certificate contient les m√©thodes suivantes: <br><br><ul><li>  subjectSignTool () - retourne une cha√Æne avec le nom du certificat du titulaire du certificat cryptographique </li><li>  issuerSignTool () - retourne une liste de quatre √©l√©ments avec les outils cryptographiques d'informations de l'√©metteur du certificat; </li><li>  classUser () - retourne une cha√Æne avec les oids des classes de s√©curit√© du certificat de protection des informations cryptographiques du titulaire du certificat, s√©par√©s par les caract√®res ";;"; </li><li>  issuerCert () - renvoie un dictionnaire avec des champs et des valeurs du nom distinctif DN de l'√©metteur du certificat et un num√©ro qui identifie le certificat (2 - entit√© juridique); </li><li>  subjectCert () - renvoie un dictionnaire avec les champs et les valeurs du nom distinctif DN du titulaire du certificat et un num√©ro qui identifie le certificat (2 - entit√© juridique); </li><li>  publicKey () - retourne un dictionnaire contenant la valeur de cl√© ('valuepk') et les param√®tres de cl√© ('curve' et 'hash'); </li><li>  signatureCert - renvoie deux valeurs: l'algorithme de signature et la valeur de signature; </li><li>  validCert - retourne un dictionnaire avec deux cl√©s 'not_after' et 'not_before'; </li><li>  keyUsage () - renvoie une liste des port√©es de cl√©s; </li><li>  serialNumber () - renvoie le num√©ro de s√©rie du certificat sous forme d√©cimale; </li><li>  prettyPrint () - renvoie une cha√Æne avec une 'impression' du certificat en termes de pyasn1 (self.cert_full.prettyPrint ()). </li></ul><br>  Le spoiler contient un exemple de test qui montre clairement le travail de ces m√©thodes. <br><br><div class="spoiler">  <b class="spoiler_title">Testez test795.py pour tester le package fsb795</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> fsb795 certpem = <span class="hljs-string"><span class="hljs-string">""" -----BEGIN CERTIFICATE----- MIIG3DCCBougAwIBAgIKE8/KkAAAAAAC4zAIBgYqhQMCAgMwggFKMR4wHAYJKoZI hvcNAQkBFg9kaXRAbWluc3Z5YXoucnUxCzAJBgNVBAYTAlJVMRwwGgYDVQQIDBM3 NyDQsy4g0JzQvtGB0LrQstCwMRUwEwYDVQQHDAzQnNC+0YHQutCy0LAxPzA9BgNV BAkMNjEyNTM3NSDQsy4g0JzQvtGB0LrQstCwLCDRg9C7LiDQotCy0LXRgNGB0LrQ sNGPLCDQtC4gNzEsMCoGA1UECgwj0JzQuNC90LrQvtC80YHQstGP0LfRjCDQoNC+ 0YHRgdC40LgxGDAWBgUqhQNkARINMTA0NzcwMjAyNjcwMTEaMBgGCCqFAwOBAwEB EgwwMDc3MTA0NzQzNzUxQTA/BgNVBAMMONCT0L7Qu9C+0LLQvdC+0Lkg0YPQtNC+ 0YHRgtC+0LLQtdGA0Y/RjtGJ0LjQuSDRhtC10L3RgtGAMB4XDTE4MDcwOTE1MjYy NFoXDTI3MDcwOTE1MjYyNFowggFVMR4wHAYJKoZIhvcNAQkBFg9jb250YWN0QGVr ZXkucnUxITAfBgNVBAMMGNCe0J7QniDCq9CV0LrQtdC5INCj0KbCuzEwMC4GA1UE Cwwn0KPQtNC+0YHRgtC+0LLQtdGA0Y/RjtGJ0LjQuSDRhtC10L3RgtGAMSEwHwYD VQQKDBjQntCe0J4gwqvQldC60LXQuSDQo9CmwrsxCzAJBgNVBAYTAlJVMRgwFgYD VQQIDA83NyDQnNC+0YHQutCy0LAxRDBCBgNVBAkMO9Cj0JvQmNCm0JAg0JjQm9Cs 0JjQndCa0JAsINCULjQsINCQ0J3QotCgIDMg0K3Qojsg0J/QntCcLjk0MRgwFgYD VQQHDA/Qsy7QnNC+0YHQutCy0LAxGDAWBgUqhQNkARINMTE0Nzc0NjcxNDYzMTEa MBgGCCqFAwOBAwEBEgwwMDc3MTA5NjQzNDgwYzAcBgYqhQMCAhMwEgYHKoUDAgIk AAYHKoUDAgIeAQNDAARAW3hfhvDdUxa6N8hEDjmOg/LsDDRHj5DanAyARtNB/2b5 BEzQCg4lUwrO/VHmvoUtvsrLqrxV6Ae+jh+GFli9WKOCA0AwggM8MBIGA1UdEwEB /wQIMAYBAf8CAQAwHQYDVR0OBBYEFMQYnG5GfYRnj2ehEQ5tv8Fso/qBMAsGA1Ud DwQEAwIBRjAdBgNVHSAEFjAUMAgGBiqFA2RxATAIBgYqhQNkcQIwKAYFKoUDZG8E Hwwd0KHQmtCX0JggwqvQm9CY0KDQodCh0JstQ1NQwrswggGLBgNVHSMEggGCMIIB foAUi5g7iRhR6O+cAni46sjUILJVyV2hggFSpIIBTjCCAUoxHjAcBgkqhkiG9w0B CQEWD2RpdEBtaW5zdnlhei5ydTELMAkGA1UEBhMCUlUxHDAaBgNVBAgMEzc3INCz LiDQnNC+0YHQutCy0LAxFTATBgNVBAcMDNCc0L7RgdC60LLQsDE/MD0GA1UECQw2 MTI1Mzc1INCzLiDQnNC+0YHQutCy0LAsINGD0LsuINCi0LLQtdGA0YHQutCw0Y8s INC0LiA3MSwwKgYDVQQKDCPQnNC40L3QutC+0LzRgdCy0Y/Qt9GMINCg0L7RgdGB 0LjQuDEYMBYGBSqFA2QBEg0xMDQ3NzAyMDI2NzAxMRowGAYIKoUDA4EDAQESDDAw NzcxMDQ3NDM3NTFBMD8GA1UEAww40JPQvtC70L7QstC90L7QuSDRg9C00L7RgdGC 0L7QstC10YDRj9GO0YnQuNC5INGG0LXQvdGC0YCCEDRoHkDLQe8zqaC3yHaSmikw WQYDVR0fBFIwUDAmoCSgIoYgaHR0cDovL3Jvc3RlbGVjb20ucnUvY2RwL2d1Yy5j cmwwJqAkoCKGIGh0dHA6Ly9yZWVzdHItcGtpLnJ1L2NkcC9ndWMuY3JsMIHGBgUq hQNkcASBvDCBuQwj0J/QkNCa0JwgwqvQmtGA0LjQv9GC0L7Qn9GA0L4gSFNNwrsM INCf0JDQmiDCq9CT0L7Qu9C+0LLQvdC+0Lkg0KPQpsK7DDbQl9Cw0LrQu9GO0YfQ tdC90LjQtSDihJYgMTQ5LzMvMi8yLTk5OSDQvtGCIDA1LjA3LjIwMTIMONCX0LDQ utC70Y7Rh9C10L3QuNC1IOKEliAxNDkvNy8xLzQvMi02MDMg0L7RgiAwNi4wNy4y MDEyMAgGBiqFAwICAwNBALvjFGhdFE9llvlvKeQmZmkI5J+yO2jFWTh8nXPjIpiL OutUew2hIZv15pJ1QM/VgRO3BTBGDOoIrq8LvgC+3kA= -----END CERTIFICATE----- """</span></span> <span class="hljs-comment"><span class="hljs-comment">#c1 = fsb795.Certificate('OOO_VOLGA.der') #c1 = fsb795.Certificate('cert.der') c1 = fsb795.Certificate(certpem) if (c1.pyver == ''): print('Context for certificate not create') exit(-1) print('=================formatCert================================') print(c1.formatCert) res = c1.subjectSignTool() print('=================subjectSignTool================================') print (res) print('=================issuerSignTool================================') res1 = c1.issuerSignTool() print (res1[0]) print (res1[1]) print (res1[2]) print (res1[3]) print('=================prettyPrint================================') res2 = c1.prettyPrint() #print(res2) print('=================classUser================================') res3 = c1.classUser() print (res3) print('=================issuerCert================================') iss, vlad_is = c1.issuerCert() print ('vlad_is=' + str(vlad_is)) for key in iss.keys(): print (key + '=' + iss[key]) print('=================subjectCert================================') sub, vlad_sub = c1.subjectCert() print ('vlad_sub=' + str(vlad_sub)) for key in sub.keys(): print (key + '=' + sub[key]) print('================publicKey=================================') key_info = c1.publicKey() print(key_info['curve']) print(key_info['hash']) print(key_info['valuepk']) print('================serialNumber=================================') print(c1.serialNumber()) print('================validityCert=================================') valid = c1.validityCert() print(valid['not_after']) print(valid['not_before']) print('================signatureCert=================================') algosign, value = c1.signatureCert() print(algosign) print(value) print('================KeyUsage=================================') ku = c1.KeyUsage() for key in ku: print (key) # print(ku) print('================END=================================')</span></span></code> </pre><br></div></div><br>  Pour ex√©cuter un exemple de test, ex√©cutez simplement la commande: <br><br><pre> <code class="bash hljs"><span class="hljs-variable"><span class="hljs-variable">$python</span></span> test795.py</code> </pre> <br>  Avec le package fsb795 √† sa disposition, il √©tait naturel d'√©crire en python un utilitaire graphique autonome et ind√©pendant de la plateforme pour visualiser les certificats qualifi√©s.  Le package Tkinter a √©t√© utilis√© comme support graphique: <br><br><img src="https://habrastorage.org/webt/wb/sw/m8/wbswm8thi6y0edcmxs2osp8uw2q.png"><br><br>  L'utilitaire <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">viewCertFL63</a> comporte trois onglets.  L'onglet √Ä propos du certificat, entre autres, affiche l'heure actuelle.  Nous y reviendrons ci-dessous.  Pour s√©lectionner un certificat, cliquez simplement sur le bouton "S√©lectionner": <br><br><img src="https://habrastorage.org/webt/w_/qe/s6/w_qes6wmp_rwam1prr8-lvmam7s.png"><br><br>  Faites attention au bouton (ceux qui travaillent sur Windows ne verront pas ce bouton), il vous permet de masquer les fichiers / r√©pertoires soi-disant invisibles (cach√©s).  Pour que ce bouton apparaisse, ex√©cutez simplement les commandes suivantes: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> sys.platform != <span class="hljs-string"><span class="hljs-string">"win32"</span></span>: root.tk.call(<span class="hljs-string"><span class="hljs-string">'set'</span></span>, <span class="hljs-string"><span class="hljs-string">'::tk::dialog::file::showHiddenBtn'</span></span>, <span class="hljs-string"><span class="hljs-string">'1'</span></span>) root.tk.call(<span class="hljs-string"><span class="hljs-string">'set'</span></span>, <span class="hljs-string"><span class="hljs-string">'::tk::dialog::file::showHiddenVar'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>)</code> </pre><br>  Un bouton tr√®s utile.  Ainsi, apr√®s avoir choisi un certificat, l'onglet ¬´√Ä propos du certificat¬ª prendra la forme: <br><br><img src="https://habrastorage.org/webt/sn/x4/cc/snx4ccjle-z5atjx-4ffg-gvb_u.png"><br><br><img src="https://habrastorage.org/webt/sj/6x/9h/sj6x9hwsr5dr1xqahzigdvitst8.gif" align="left">  Ce qui est remarquable ici, c'est que si le certificat expire lors de la visualisation du certificat, l'impression sur l'ic√¥ne dans le coin sup√©rieur gauche se divisera en deux moiti√©s.  Tout le monde peut en √™tre convaincu, en r√©organisant l'horloge de l'ordinateur pendant un an √† l'avance. <br>  Dans l'onglet D√©tails, vous pouvez afficher en d√©tail les caract√©ristiques de l'attribut s√©lectionn√© d'un certificat qualifi√©: <br><br><img src="https://habrastorage.org/webt/jc/va/4j/jcva4j74wlkzzbqb34rdjb-etuc.png"><br><br>  Et enfin, le troisi√®me onglet est "Texte".  Cet onglet affiche le contenu de l'ensemble du certificat: <br><br><img src="https://habrastorage.org/webt/6z/z5/xz/6zz5xzinnpyy_qm7s5uheeqbsyu.png"><br><br>  Pour afficher le certificat, vous pouvez utiliser non seulement Python (le bouton "Python"), mais √©galement les utilitaires openssl et pp des services de s√©curit√© r√©seau (NSS).  Si quelqu'un n'a pas ces utilitaires, le premier peut √™tre obtenu en collectant openssl avec le support de la cryptographie russe.  Lorsque vous utilisez l'utilitaire pp, la sortie du certificat ressemble √† ceci: <br><br><img src="https://habrastorage.org/webt/pa/bf/cn/pabfcn24oeu0katqhkdgbp_ryzg.png"><br><br>  Ci-dessus, nous avons mentionn√© l'attribut formatCert de la classe Certificate du package fsb795.  Nous avons donc besoin de la valeur de cet attribut pour indiquer le format du fichier avec le certificat lors de l'ex√©cution de tel ou tel utilitaire.  Par exemple, invoquer l'utilitaire pp avec le format de fichier PEM ressemble √† ceci: <br><br><pre> <code class="bash hljs"><span class="hljs-variable"><span class="hljs-variable">$pp</span></span> ‚Äìtc ‚Äìu ‚Äìa ‚Äìi &lt; &gt;</code> </pre> <br>  L'option -a indique le format du fichier PEM.  Pour le format DER, il n'est pas sp√©cifi√©. <br>  Le param√®tre "‚Äìinform" pour openssl est d√©fini de la m√™me mani√®re. <br>  Le bouton Utilitaire est utilis√© pour indiquer le chemin d'acc√®s aux utilitaires openssl ou pp. <br>  Les distributions de l'utilitaire ViewCertFL63 se trouvent <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br>  Les distributions ont √©t√© construites √† l'aide du package pyinstaller: <br><br><pre> <code class="bash hljs"><span class="hljs-variable"><span class="hljs-variable">$python</span></span> pyinstaller.py --noconsole -F viewCertFL63.py</code> </pre></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr421107/">https://habr.com/ru/post/fr421107/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr421097/index.html">Composition des UIViewControllers et navigation entre eux (et pas seulement)</a></li>
<li><a href="../fr421099/index.html">Est-ce difficile de se concentrer? Ce n'est peut-√™tre pas de ta faute</a></li>
<li><a href="../fr421101/index.html">"Calendrier des testeurs" pour ao√ªt. Lire un livre</a></li>
<li><a href="../fr421103/index.html">Premier aper√ßu du Mavic 2: volez plus longtemps, plus silencieusement, plus rapidement</a></li>
<li><a href="../fr421105/index.html">Situation: Spotify conclut des accords directs avec les musiciens - les labels ne sont pas satisfaits</a></li>
<li><a href="../fr421109/index.html">(Mise √† jour) Intel interdit la publication de r√©f√©rences pour les mises √† jour du microcode</a></li>
<li><a href="../fr421111/index.html">Syst√®me de conception √† Figma. Un regard sur l'interface √† travers les composants</a></li>
<li><a href="../fr421113/index.html">Pr√©sentation de DJI Mavic 2 Pro / Zoom</a></li>
<li><a href="../fr421115/index.html">Contexte dans une application Android</a></li>
<li><a href="../fr421119/index.html">D√©veloppement SmartTV de r√¢teau sous-marin</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>