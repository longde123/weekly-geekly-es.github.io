<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üç® üèê üÖ∞Ô∏è Implementieren, skalieren: die Erfahrung mit Autotests in VTB üë®üèΩ‚Äçüè´ üë®üèΩ‚ÄçüöÄ ‚è≤Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Unsere Abteilung erstellt vollautomatische Pipelines f√ºr die Ausgabe neuer Versionen von Anwendungen an die Produktionsumgebung. Dies erfordert nat√ºrl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Implementieren, skalieren: die Erfahrung mit Autotests in VTB</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vtb/blog/473950/">  Unsere Abteilung erstellt vollautomatische Pipelines f√ºr die Ausgabe neuer Versionen von Anwendungen an die Produktionsumgebung.  Dies erfordert nat√ºrlich automatisierte Funktionstests.  Unter dem Strich - die Geschichte, wie wir, angefangen beim Testen in einem Thread auf dem lokalen Computer, mit dem Allure-Bericht auf GitLab-Seiten zum Multithread-Start von Selbsttests f√ºr Selenoid in der Assembly-Pipeline kamen und als Ergebnis ein cooles Automatisierungstool erhielten, das zuk√ºnftige verwenden k√∂nnen Teams. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/29e/991/c13/29e991c13a89c4069a46fb4ed6965ec0.jpg"><br><a name="habracut"></a><br><h2>  Wo haben wir angefangen? </h2><br>  Um Autotests zu implementieren und in die Pipeline zu integrieren, brauchten wir ein Framework f√ºr die Automatisierung, das flexibel an unsere Anforderungen angepasst werden kann.  Idealerweise wollte ich einen einzigen Standard f√ºr die Autotest-Engine erhalten, der zum Einbetten von Autotests in eine Pipeline geeignet ist.  F√ºr die Implementierung haben wir folgende Technologien ausgew√§hlt: <br><br><ul><li>  Java <br></li><li>  Maven <br></li><li>  Selen <br></li><li>  Gurke + JUNIT 4, <br></li><li>  Allure <br></li><li>  Gitlab <br></li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/252/ac0/c39/252ac0c39f01083634120a48b2a96952.png"><br><br>  Warum so ein Set?  Java ist eine der beliebtesten Sprachen f√ºr Autotests. Dar√ºber hinaus sprechen alle Mitglieder des Teams es.  Selen ist die offensichtliche L√∂sung.  Gurke sollte unter anderem das Vertrauen der an manuellen Tests beteiligten Einheiten in die Ergebnisse von Autotests st√§rken. <br><br><h2>  Single-Threaded-Tests </h2><br>  Um das Rad nicht neu zu erfinden, haben wir die Entwicklungen aus verschiedenen Repositories auf GitHub als Grundlage f√ºr das Framework genommen und f√ºr uns angepasst.  Wir haben ein Repository f√ºr die Hauptbibliothek mit dem Kern des Autotest-Frameworks und ein Repository mit einem Gold-Beispiel f√ºr die Implementierung von Autotests auf unserem Kern erstellt.  Jedes Team musste ein Gold-Image aufnehmen und darin Tests entwickeln, um es an sein Projekt anzupassen.  Wir haben die GitLab-CI-Bank bereitgestellt, auf der wir Folgendes konfiguriert haben: <br><br><ul><li>  t√§gliche Durchl√§ufe aller schriftlichen Autotests f√ºr jedes Projekt; <br></li><li>  wird in der Assembly-Pipeline gestartet. <br></li></ul><br>  Anfangs gab es nur wenige Tests, und sie gingen in einem Strom.  Der Single-Thread-Start auf dem GitLab Windows-Runner war f√ºr uns recht zufriedenstellend: Die Tests belasteten den Pr√ºfstand nur geringf√ºgig und verbrauchten fast keine Ressourcen. <br><br>  Im Laufe der Zeit wurden Autotests immer h√§ufiger, und wir dachten dar√ºber nach, sie parallel auszuf√ºhren, als ein vollst√§ndiger Lauf ungef√§hr drei Stunden dauerte.  Es gab andere Probleme: <br><br><ul><li>  wir konnten nicht sicherstellen, dass die Tests stabil sind; <br></li><li>  Tests, die mehrere L√§ufe hintereinander auf dem lokalen Computer durchliefen, fielen manchmal in CI. <br></li></ul><br>  Beispiel f√ºr die Einrichtung eines Autotests: <br><br><pre><code class="java hljs">&lt;plugins&gt; &lt;plugin&gt;     &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;     &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;     &lt;version&gt;<span class="hljs-number"><span class="hljs-number">2.20</span></span>&lt;/version&gt;     &lt;configuration&gt;         &lt;skipTests&gt;${skipTests}&lt;/skipTests&gt;         &lt;testFailureIgnore&gt;<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>&lt;/testFailureIgnore&gt;         &lt;argLine&gt;             -javaagent:<span class="hljs-string"><span class="hljs-string">"${settings.localRepository}/org/aspectj/aspectjweaver/${aspectj.version}/aspectjweaver-${aspectj.version}.jar"</span></span>             -Dcucumber.options=<span class="hljs-string"><span class="hljs-string">"--tags ${TAGS} --plugin io.qameta.allure.cucumber2jvm.AllureCucumber2Jvm --plugin pretty"</span></span>         &lt;/argLine&gt;     &lt;/configuration&gt;   &lt;dependencies&gt;         &lt;dependency&gt;             &lt;groupId&gt;org.aspectj&lt;/groupId&gt;             &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt;             &lt;version&gt;${aspectj.version}&lt;/version&gt;         &lt;/dependency&gt;     &lt;/dependencies&gt; &lt;/plugin&gt; &lt;plugin&gt;     &lt;groupId&gt;io.qameta.allure&lt;/groupId&gt;     &lt;artifactId&gt;allure-maven&lt;/artifactId&gt;     &lt;version&gt;<span class="hljs-number"><span class="hljs-number">2.9</span></span>&lt;/version&gt; &lt;/plugin&gt; &lt;/plugins&gt;</code> </pre> <br><img src="https://habrastorage.org/getpro/habr/post_images/864/1b8/23b/8641b823bd4b8e0cd4f55ea6f026c6fd.png"><br>  <i>Beispiel f√ºr einen Allure-Bericht</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/387/23c/761/38723c761d476c0f5d7536d22529d614.png"><br>  <i>Runner Load w√§hrend der Tests (8 Kerne, 8 GB RAM, 1 Thread)</i> <br><br>  Pluspunkte von Single-Threaded-Tests: <br><br><ul><li>  einfach zu konfigurieren und auszuf√ºhren; <br></li><li>  Starts in CI unterscheiden sich praktisch nicht von lokalen Starts. <br></li><li>  Tests beeinflussen sich nicht gegenseitig; <br></li><li>  Mindestanforderungen an die L√§uferressourcen. <br></li></ul><br>  Nachteile von Single-Threaded-Tests: <br><br><ul><li>  sehr langfristig; <br></li><li>  lange Stabilisierung der Tests; <br></li><li>  Ineffiziente Nutzung der Runner-Ressourcen, extrem geringe Auslastung. <br></li></ul><br><h2>  JVM-Gabeltests </h2><br>  Da wir uns bei der Implementierung des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Basisframeworks</a> nicht um threadsicheren Code gek√ºmmert haben, wurde das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">cucumber-jvm-parallel-plugin</a> f√ºr Maven zum naheliegendsten Weg, parallel zu laufen.  Das Plugin ist einfach zu konfigurieren, aber f√ºr den korrekten parallelen Betrieb der Autotests m√ºssen Sie es in separaten Browsern ausf√ºhren.  Nichts zu tun, ich musste Selenoid verwenden. <br><br>  Der Selenoid-Server wurde auf einem Computer mit 32 Kernen und 24 GB RAM gestartet.  Das Limit wurde in 48 Browsern festgelegt - 1,5 Threads pro Kern und ca. 400 MB RAM.  Infolgedessen wurde die Testzeit von drei Stunden auf 40 Minuten reduziert.  Die Beschleunigung der L√§ufe half, das Stabilisierungsproblem zu l√∂sen: Jetzt konnten wir 20 bis 30 Mal schnell neue Autotests durchf√ºhren, bis wir sicher waren, dass sie stabil durchgef√ºhrt wurden. <br>  Der erste Nachteil der L√∂sung war die hohe Auslastung der Runner-Ressourcen mit einer geringen Anzahl paralleler Threads: Auf 4 Kernen und 8 GB RAM funktionierten die Tests stabil in nicht mehr als 6 Threads.  Das zweite Minus: Das Plugin generiert Runner-Klassen f√ºr jedes Szenario, egal wie viele ausgef√ºhrt werden. <br><br>  <b>Wichtig!</b>  Werfen Sie beispielsweise keine Variable mit Tags in <i><b>argLine</b></i> wie <i><b>folgt</b></i> : <br><br><pre> <code class="java hljs">&lt;argLine&gt;-Dcucumber.options=<span class="hljs-string"><span class="hljs-string">"--tags ${TAGS} --plugin io.qameta.allure.cucumber2jvm.AllureCucumber2Jvm --plugin pretty"</span></span>&lt;/argLine&gt; ‚Ä¶ Mvn ‚ÄìDTAGS=<span class="hljs-string"><span class="hljs-string">"@smoke"</span></span></code> </pre><br>  Wenn Sie das Tag auf diese Weise √ºbergeben, generiert das Plugin L√§ufer f√ºr alle Tests. Versuchen Sie also, alle Tests auszuf√ºhren, √ºberspringen Sie sie direkt nach dem Start und erstellen Sie viele JVM-Gabeln. <br><br>  Es ist richtig, die Variable mit dem Tag in den Plugin-Einstellungen in <i><b>Tags</b></i> zu werfen (siehe Beispiel unten).  Andere von uns getestete Methoden haben Probleme beim Verbinden des Allure-Plugins. <br><br>  Beispiellaufzeit f√ºr 6 Kurztests mit falschen Einstellungen: <br><br><pre> <code class="java hljs">[INFO] Total time: <span class="hljs-number"><span class="hljs-number">03</span></span>:<span class="hljs-number"><span class="hljs-number">17</span></span> min</code> </pre><br>  Ein Beispiel f√ºr eine Testlaufzeit, wenn Sie das Tag direkt an <b>mvn √ºbergeben ... ‚ÄìDcucumber.options</b> : <br><br><pre> <code class="java hljs">[INFO] Total time: <span class="hljs-number"><span class="hljs-number">44.467</span></span> s</code> </pre><br>  Beispiel f√ºr die Einrichtung eines Autotests: <br><br><pre> <code class="java hljs">&lt;profiles&gt; &lt;profile&gt;   &lt;id&gt;parallel&lt;/id&gt;   &lt;build&gt;       &lt;plugins&gt;           &lt;plugin&gt;               &lt;groupId&gt;com.github.temyers&lt;/groupId&gt;               &lt;artifactId&gt;cucumber-jvm-parallel-plugin&lt;/artifactId&gt;               &lt;version&gt;<span class="hljs-number"><span class="hljs-number">5.0</span></span>.0&lt;/version&gt;               &lt;executions&gt;                   &lt;execution&gt;                       &lt;id&gt;generateRunners&lt;/id&gt;                       &lt;phase&gt;generate-test-sources&lt;/phase&gt;                       &lt;goals&gt;                           &lt;goal&gt;generateRunners&lt;/goal&gt;                       &lt;/goals&gt;                       &lt;configuration&gt;                     &lt;tags&gt;                           &lt;tag&gt;${TAGS}&lt;/tag&gt;                           &lt;/tags&gt;                           &lt;glue&gt;                               &lt;<span class="hljs-keyword"><span class="hljs-keyword">package</span></span>&gt;stepdefs&lt;/<span class="hljs-keyword"><span class="hljs-keyword">package</span></span>&gt;                           &lt;/glue&gt;                       &lt;/configuration&gt;           &lt;/execution&gt;               &lt;/executions&gt;       &lt;/plugin&gt;           &lt;plugin&gt;               &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;               &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;           &lt;version&gt;<span class="hljs-number"><span class="hljs-number">2.21</span></span>.0&lt;/version&gt;               &lt;configuration&gt;                   &lt;forkCount&gt;<span class="hljs-number"><span class="hljs-number">12</span></span>&lt;/forkCount&gt;                   &lt;reuseForks&gt;<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>&lt;/reuseForks&gt;                   &lt;includes&gt;**<span class="hljs-comment"><span class="hljs-comment">/*IT.class&lt;/includes&gt;                  &lt;testFailureIgnore&gt;false&lt;/testFailureIgnore&gt;                   &lt;!--suppress UnresolvedMavenProperty --&gt;                   &lt;argLine&gt; -javaagent:"${settings.localRepository}/org/aspectj/aspectjweaver/${aspectj.version}/aspectjweaver-${aspectj.version}.jar" -Dcucumber.options="--plugin io.qameta.allure.cucumber2jvm.AllureCucumber2Jvm TagPFAllureReporter --plugin pretty"                   &lt;/argLine&gt;               &lt;/configuration&gt;               &lt;dependencies&gt;                   &lt;dependency&gt;                       &lt;groupId&gt;org.aspectj&lt;/groupId&gt;                       &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt;                       &lt;version&gt;${aspectj.version}&lt;/version&gt;                 &lt;/dependency&gt;               &lt;/dependencies&gt;         &lt;/plugin&gt;       &lt;/plugins&gt;   &lt;/build&gt; &lt;/profile&gt;</span></span></code> </pre><br><img src="https://habrastorage.org/getpro/habr/post_images/82f/fa3/c04/82ffa3c04c02ca5be5e47fdfe8c9b052.png"><br>  <i>Ein Beispiel f√ºr einen Allure-Bericht (der instabilste Test, 4 Rerana)</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/075/70c/0ce/07570c0ceade310c1afdceb8e0daf50f.png">  <i>Runner Load w√§hrend der Tests (8 Kerne, 8 GB RAM, 12 Threads)</i> <br><br>  Vorteile: <br><br><ul><li>  einfache Einrichtung - Sie m√ºssen nur das Plugin hinzuf√ºgen; <br></li><li>  die F√§higkeit, gleichzeitig eine gro√üe Anzahl von Tests durchzuf√ºhren; <br></li><li>  schnellere Stabilisierung der Tests dank Anspruch 1. <br></li></ul><br>  Nachteile: <br><br><ul><li>  mehrere Betriebssysteme / Container erforderlich; <br></li><li>  hoher Ressourcenverbrauch pro Gabel; <br></li><li>  Das Plugin ist veraltet und wird nicht mehr unterst√ºtzt. <br></li></ul><br><h2>  Wie man Instabilit√§t besiegt </h2><br>  Pr√ºfst√§nde sind nicht perfekt, ebenso wie die Autotests selbst.  Es √ºberrascht nicht, dass wir eine Reihe von Flacky-Tests erhalten haben.  Das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Maven-todsichere Plugin</a> kam zur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Rettung</a> , das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sofort</a> den Neustart gefallener Tests unterst√ºtzt.  Sie m√ºssen die Plugin-Version auf mindestens 2.21 aktualisieren und eine Zeile mit der Anzahl der Neustarts in die POM-Datei schreiben oder als Argument f√ºr Maven √ºbergeben. <br><br>  Beispiel f√ºr die Einrichtung eines Autotests: <br><br><pre> <code class="java hljs">  &lt;plugin&gt;       &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;    &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;       &lt;version&gt;<span class="hljs-number"><span class="hljs-number">2.21</span></span>.0&lt;/version&gt;       &lt;configuration&gt;          ‚Ä¶.           &lt;rerunFailingTestsCount&gt;<span class="hljs-number"><span class="hljs-number">2</span></span>&lt;/rerunFailingTestsCount&gt;           ‚Ä¶.           &lt;/configuration&gt; &lt;/plugin&gt;</code> </pre><br>  Oder beim Start: <i><b>mvn ... -Dsurefire.rerunFailingTestsCount = 2 ...</b></i> <br>  Alternativ k√∂nnen Sie die Maven-Optionen f√ºr das PowerShell-Skript (PS1) festlegen: <br><br><pre> <code class="java hljs"> Set-Item Env:MAVEN_OPTS <span class="hljs-string"><span class="hljs-string">"-Dfile.encoding=UTF-8 -Dsurefire.rerunFailingTestsCount=2"</span></span></code> </pre> <br>  Vorteile: <br><br><ul><li>  Sie m√ºssen keine Zeit damit verschwenden, einen instabilen Test zu analysieren, wenn er abst√ºrzt. <br></li><li>  Sie k√∂nnen die Stabilit√§tsprobleme des Pr√ºfstands ausgleichen. <br></li></ul><br>  Nachteile: <br><br><ul><li>  Sie k√∂nnen schwebende Fehler √ºberspringen. <br></li><li>  Laufzeit wird erh√∂ht. <br></li></ul><br><h2>  Parallele Tests mit der Cucumber 4-Bibliothek </h2><br><br>  Die Anzahl der Tests wuchs von Tag zu Tag.  Wir haben noch einmal dar√ºber nachgedacht, die L√§ufe zu beschleunigen.  Au√üerdem wollte ich so viele Tests wie m√∂glich in die Pipeline-Baugruppe der Anwendung integrieren.  Ein kritischer Faktor war die zu lange Generation von L√§ufern, wenn sie parallel mit dem Maven-Plugin ausgef√ºhrt wurden. <br><br>  Cucumber 4 wurde zu diesem Zeitpunkt bereits ver√∂ffentlicht, daher haben wir beschlossen, den Kernel f√ºr diese Version neu zu schreiben.  In den Versionshinweisen wurde uns ein paralleler Start auf Thread-Ebene versprochen.  Theoretisch h√§tte dies sein sollen: <br><br><ul><li>  Beschleunigen Sie die Ausf√ºhrung von Autotests erheblich, indem Sie die Anzahl der Threads erh√∂hen. <br></li><li>  Schlie√üen Sie den Zeitverlust f√ºr die Generierung von L√§ufern f√ºr jeden Autotest aus. <br></li></ul><br>  Die Optimierung des Frameworks f√ºr Multithread-Autotests war nicht so schwierig.  Cucumber 4 f√ºhrt jeden einzelnen Test von Anfang bis Ende in einem dedizierten Thread aus, sodass einige h√§ufig verwendete statische Dinge einfach in ThreadLocal-Variablen konvertiert wurden. <br>  Die Hauptsache beim Konvertieren mit Idea Refactoring-Tools besteht darin, die Stellen zu √ºberpr√ºfen, an denen die Variable verglichen wurde (z. B. die √úberpr√ºfung auf Null).  Dar√ºber hinaus m√ºssen Sie das Allure-Plugin in den Anmerkungen der Junit Runner-Klasse rendern. <br><br>  Beispiel f√ºr die Einrichtung eines Autotests: <br><br><pre> <code class="java hljs">&lt;profile&gt; &lt;id&gt;parallel&lt;/id&gt; &lt;build&gt;   &lt;plugins&gt;       &lt;plugin&gt;           &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;     &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;           &lt;version&gt;<span class="hljs-number"><span class="hljs-number">3.0</span></span>.0-M3&lt;/version&gt;      &lt;configuration&gt;               &lt;useFile&gt;<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>&lt;/useFile&gt;               &lt;testFailureIgnore&gt;<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>&lt;/testFailureIgnore&gt;           &lt;parallel&gt;methods&lt;/parallel&gt;               &lt;threadCount&gt;<span class="hljs-number"><span class="hljs-number">6</span></span>&lt;/threadCount&gt;               &lt;perCoreThreadCount&gt;<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>&lt;/perCoreThreadCount&gt;               &lt;argLine&gt;                   -javaagent:<span class="hljs-string"><span class="hljs-string">"${settings.localRepository}/org/aspectj/aspectjweaver/${aspectj.version}/aspectjweaver-${aspectj.version}.jar"</span></span>               &lt;/argLine&gt;           &lt;/configuration&gt;           &lt;dependencies&gt;               &lt;dependency&gt;                   &lt;groupId&gt;org.aspectj&lt;/groupId&gt;          &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt;                   &lt;version&gt;${aspectj.version}&lt;/version&gt;               &lt;/dependency&gt;           &lt;/dependencies&gt;       &lt;/plugin&gt;   &lt;/plugins&gt; &lt;/build&gt; &lt;/profile&gt;</code> </pre><br><img src="https://habrastorage.org/getpro/habr/post_images/b47/ef9/2c6/b47ef92c6608aebaccd13664af9cbf07.png">  <i>Beispiel eines Allure-Berichts (der instabilste Test, 5 Wiederholungen)</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6d7/db7/677/6d7db7677375e71ebde6992c96cee920.png">  <i>Runner Load w√§hrend der Tests (8 Kerne, 8 GB RAM, 24 Threads)</i> <br><br>  Vorteile: <br><br><ul><li>  geringer Ressourcenverbrauch; <br></li><li>  native Unterst√ºtzung von Cucumber - keine zus√§tzlichen Tools erforderlich; <br></li><li>  die F√§higkeit, mehr als 6 Threads auf dem Prozessorkern auszuf√ºhren. <br></li></ul><br>  Nachteile: <br><br><ul><li>  Sie m√ºssen sicherstellen, dass der Code die Ausf√ºhrung mit mehreren Threads unterst√ºtzt. <br></li><li>  Eintrittsschwelle erh√∂ht. <br></li></ul><br><h2>  Allure-Berichte auf GitLab-Seiten </h2><br>  Nach der Einf√ºhrung des Multithread-Starts haben wir viel mehr Zeit mit der Analyse von Berichten verbracht.  Zu diesem Zeitpunkt mussten wir jeden Bericht als Artefakt in GitLab hochladen, dann herunterladen und entpacken.  Es ist nicht sehr bequem und lang.  Und wenn jemand anderes den Bericht zu Hause sehen m√∂chte, muss er die gleichen Operationen ausf√ºhren.  Wir wollten schneller Feedback bekommen und es gab einen Ausweg - GitLab-Seiten.  Dies ist eine integrierte Funktion, die in allen neueren Versionen von GitLab sofort verf√ºgbar ist.  Erm√∂glicht das Bereitstellen statischer Sites auf Ihrem Server und den Zugriff auf diese √ºber einen direkten Link. <br><br>  Alle Screenshots mit Allure-Berichten wurden auf GitLab-Seiten erstellt.  Das Skript zum Bereitstellen des Berichts auf GitLab-Seiten befindet sich in Windows PowerShell (zuvor m√ºssen Sie Autotests ausf√ºhren): <br><br><pre> <code class="java hljs">New-Item -ItemType directory -Path $testresult\history | Out-Null <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> {Invoke-WebRequest -Uri $hst -OutFile $outputhst} Catch{echo <span class="hljs-string"><span class="hljs-string">"fail copy history"</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> {Invoke-WebRequest -Uri $hsttrend -OutFile $outputhsttrnd} Catch{echo <span class="hljs-string"><span class="hljs-string">"fail copy history trend"</span></span>} mvn allure:report #mvn assembly:single -PzipAllureReport xcopy $buildlocation\target\site\allure-maven-plugin\* $buildlocation\<span class="hljs-keyword"><span class="hljs-keyword">public</span></span> /s /i /Y</code> </pre><br><h2>  Was ist das Ergebnis </h2><br>  Wenn Sie also dar√ºber nachgedacht haben, ob Sie Thread-sicheren Code im Cucumber-Autotest-Framework ben√∂tigen, liegt die Antwort auf der Hand - mit Cucumber 4 ist es einfach, ihn zu implementieren, wodurch die Anzahl der gleichzeitig gestarteten Threads erheblich erh√∂ht wird.  Bei dieser Testmethode geht es bereits um die Leistung der Maschine mit Selenoid und Pr√ºfstand. <br><br>  Die Praxis hat gezeigt, dass das Ausf√ºhren von automatischen Tests f√ºr Threads den Ressourcenverbrauch bei bester Leistung minimieren kann.  Wie aus den Diagrammen ersichtlich ist, f√ºhrt eine zweifache Erh√∂hung der Durchfl√ºsse nicht zu einer √§hnlichen Beschleunigung beim Bestehen von Leistungstests.  Trotzdem konnten wir der Anwendungsbaugruppe mehr als 200 automatische Tests hinzuf√ºgen, die selbst mit 5 Wiederholungen in etwa 24 Minuten abgeschlossen sind.  Auf diese Weise erhalten Sie schnelles Feedback von ihnen und k√∂nnen bei Bedarf √Ñnderungen vornehmen und den Vorgang erneut wiederholen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de473950/">https://habr.com/ru/post/de473950/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de473938/index.html">Speichern Sie Anwendungseinstellungen universell √ºber IConfiguration</a></li>
<li><a href="../de473940/index.html">Festigkeitspr√ºfung: Nanomechanik der edlen Ohrmuschel der Perlmuttschale</a></li>
<li><a href="../de473944/index.html">Ratschl√§ge des Entwicklers von RimWorld: kognitive Verzerrungen bei der Vorhersage eines Fans des Spiels</a></li>
<li><a href="../de473946/index.html">Verteilte Protokollierung und Ablaufverfolgung f√ºr Microservices</a></li>
<li><a href="../de473948/index.html">Operon: Beschleunigt die Leistung von Ansible</a></li>
<li><a href="../de473952/index.html">Als ich AI f√ºr rundenbasierte Strategie schrieb</a></li>
<li><a href="../de473956/index.html">Geheime Informationen einer Telefongesellschaft eines Drogendealers</a></li>
<li><a href="../de473958/index.html">Japaner von NICT f√ºhrten einen funktionierenden Glasfasercluster mit einer Bandbreite von 1 Pbit / s ein</a></li>
<li><a href="../de473960/index.html">Strategien zur Inhaltslokalisierung</a></li>
<li><a href="../de473962/index.html">Der dunkle Modus ist jetzt √ºberall. Ist es so n√ºtzlich? (am Ende der Nachbefragung)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>