<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßöüèº üì∑ üôç Falha √©pica lingu√≠stica ou Como empinar o dicion√°rio inteiro do idioma russo no Power BI üõ∏ üßùüèº üçº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="De alguma forma, resolvendo o problema da an√°lise lingu√≠stica no Power BI e, ao mesmo tempo, procurando exemplos para o meu artigo anterior , lembrei-...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Falha √©pica lingu√≠stica ou Como empinar o dicion√°rio inteiro do idioma russo no Power BI</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jetinfosystems/blog/429140/"><img src="https://habrastorage.org/webt/ig/jx/ik/igjxikbvwngnl6pdd9voe9ukrvc.jpeg" alt="imagem"><br><br>  De alguma forma, resolvendo o problema da an√°lise lingu√≠stica no Power BI e, ao mesmo tempo, procurando exemplos para o meu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo anterior</a> , lembrei-me do problema que tentei resolver no Excel h√° v√°rios anos: era necess√°rio implementar um dicion√°rio de idioma russo no sistema anal√≠tico para an√°lise lingu√≠stica de um grande n√∫mero de consultas em linguagem natural.  E era desej√°vel usar ferramentas de escrit√≥rio padr√£o.  A grande maioria das pessoas executaria imediatamente essa tarefa no Excel, e uma vez eu fui pelo mesmo caminho.  Eu usei o caso aberto do idioma russo ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http://opencorpora.org/</a> ) como um dicion√°rio. <br><br>  Mas a decep√ß√£o me esperava - o dicion√°rio consistia em 300 mil formul√°rios de palavras, mais de 5 milh√µes de entradas, e para o Excel √©, em princ√≠pio, uma quantia imposs√≠vel.  Mesmo se voc√™ pressionar "apenas" 1 milh√£o de linhas, apenas uma pessoa muito paciente, que nunca estar√° com pressa, poder√° realizar qualquer manipula√ß√£o com elas ou, se Deus n√£o permitir, c√°lculos.  Mas desta vez, decidi definir uma ferramenta mais adequada para a tarefa - Power BI. <br><a name="habracut"></a><br><h2>  O que √© o Power BI? </h2><br>  Acho este produto amplamente subestimado pela comunidade profissional.  O Power BI √© um conjunto de ferramentas de an√°lise de neg√≥cios que foi criado para usu√°rios que possuem o Excel em um n√≠vel um pouco mais alto do que "dividir o valor em colunas".  Se uma pessoa conseguir escrever f√≥rmulas de m√©dia complexidade no Excel, ela dominar√° o Power BI em algumas noites. <br><br>  Este n√£o √© um produto √∫nico com algum tipo de l√≥gica de programa√ß√£o interna, mas um sistema de tr√™s componentes: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ea3/887/958/ea38879580c8b208c77bf0366d74dc60.png" alt="imagem"><br><br><ul><li>  <b>Consulta de energia</b>  Este √© um ETL, no qual √© necess√°rio escrever consultas usando sua pr√≥pria linguagem de programa√ß√£o totalmente funcional - M. Para ser justo, deve-se notar que, muito provavelmente, √© improv√°vel que um usu√°rio comum precise program√°-lo: a maioria das fun√ß√µes est√° dispon√≠vel diretamente atrav√©s do menu ou do assistente na interface do componente.  A linguagem M √© completamente diferente da linguagem de consulta DAX (PowerPivot).  No entanto, a Microsoft os reuniu.  Isso faz algum sentido do ponto de vista do desenvolvimento: o ETL foi projetado para receber e satura√ß√£o inicial de dados (n√£o r√°pida) e o DAX - para c√°lculos que nos ajudam a visualizar esses dados (rapidamente).  Ou seja, o DAX √© para o front-end e o Power Query para o back-end, para o processo de extra√ß√£o e formata√ß√£o de dados. </li><li>  <b>PowerPivot</b> .  Um m√≥dulo de processamento na mem√≥ria baseado no mecanismo xVelocity.  Usa a linguagem de consulta DAX, muito semelhante √† linguagem de f√≥rmula do Excel. </li><li>  <b>Componente de visualiza√ß√£o</b> .  √â muito √∫til para aplicativos em sistemas nos quais voc√™ precisa visualizar dados: no site de uma empresa ou em um portal de suporte t√©cnico (por exemplo, uma nuvem de solicita√ß√£o) ou em um recurso corporativo interno.  Existem ferramentas que podem fazer isso sem o Power BI, mas muitas delas n√£o ajudar√£o quando o n√∫mero de registros estiver na casa dos milh√µes e os dados precisarem ser agregados de alguma forma.  E com outras ferramentas desse tipo, o Power BI concorre devido √† sua simplicidade e baixo custo de processamento na mem√≥ria.  √â claro que, se estamos falando de terabytes de dados, ser√° necess√°ria uma abordagem diferente.  E, nesses casos, a Microsoft j√° tem algo a oferecer, mas este √© um t√≥pico para um artigo separado. </li></ul><br>  A curva de aprendizado no primeiro est√°gio aumenta muito: se voc√™ √© bom no Excel, 80% dos recursos do Power BI ser√£o revelados a voc√™ ap√≥s um breve estudo.  Esta √© uma ferramenta muito poderosa, bastante f√°cil de usar, mas - at√© um certo ponto.  Para us√°-lo em plena capacidade, voc√™ j√° precisar√° de experi√™ncia e conhecimento profundo das linguagens M e DAX. <br><br><h2>  Para que serve o Power BI Desktop? </h2><br>  Para quem pode ser √∫til?  Antes de tudo, qualquer usu√°rio de neg√≥cios que precise processar e analisar grandes quantidades de dados quando o Excel n√£o for mais capaz de lidar ou estourar at√© o limite.  Eu enfatizo - o Power BI Desktop foi projetado <b>para uma ampla variedade de usu√°rios que resolvem uma gama muito diversificada de tarefas</b> .  Por exemplo, no meu caso, tratava-se de normalizar 5 milh√µes de entradas de texto para a determina√ß√£o subsequente da frequ√™ncia das palavras-chave. <br><br>  Isso est√° em demanda no processamento de question√°rios, consultas de mecanismos de pesquisa, an√∫ncios, ditados / ensaios, algum tipo de matriz estat√≠stica, etc. Ou na solu√ß√£o de palavras cruzadas ... <br><br>  Outro caso e op√ß√£o de implementa√ß√£o √© considerado em um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo</a> sobre o ‚Äúreconhecedor‚Äù de Dmitry Tumaikin.  Implementado no Excel cl√°ssico, mas usando macros ... <br><br>  Outro cen√°rio popular para esse aplicativo do Power BI √© calcular a propor√ß√£o de indicadores para o per√≠odo atual e o anterior.  Por exemplo, temos dados de receita pr√©-agregados e voc√™ precisa compar√°-los por dias com o trimestre anterior, ano ou per√≠odo similar.  E eu quero / preciso inserir o resultado da compara√ß√£o na pr√≥xima coluna na forma de valores, n√£o em f√≥rmulas.  Parece que, para o Excel, a tarefa mais simples √© escrever uma f√≥rmula de compara√ß√£o simples e estic√°-la por todas as c√©lulas da coluna.  Mas n√£o se voc√™ tiver v√°rios milh√µes de linhas na tabela.  No pr√≥prio DAX, essa tarefa √© ainda mais f√°cil do que no Excel, mas tamb√©m apenas com a ajuda de p√≥s-c√°lculos. <br><br>  Muitos outros cen√°rios pr√°ticos para o uso do Power BI podem ser fornecidos, mas voc√™, eu acho, j√° entendeu a ess√™ncia.  Obviamente, todas essas tarefas n√£o s√£o um problema para um programador que possui, por exemplo, Python ou R, mas esses especialistas s√£o a priori menores em ordens de grandeza do que os especialistas em Excel.  O Excel tem apenas possibilidades limitadas, mas n√£o o ocorre com o Power BI, que usa a linguagem de f√≥rmula DAX, que √© muito semelhante √† linguagem de f√≥rmula do Excel e √© capaz de processar milh√µes e dezenas de milh√µes de registros em tempo real.  E ent√£o voc√™ precisa aumentar a RAM (pelo menos at√© 100, pelo menos at√© 300 GB). <br><br><h2>  Ajudamos as solicita√ß√µes de processos de suporte t√©cnico </h2><br>  Mas voltando √† minha tarefa.  Era necess√°rio apresentar como a linha zero do suporte t√©cnico avaliaria automaticamente o t√≥pico de solicita√ß√µes do usu√°rio.  Para come√ßar, decidi isolar certas formas de palavras e determinar os t√≥picos mais importantes que os usu√°rios abordam com mais frequ√™ncia pela frequ√™ncia em que aparecem nas mensagens. <br><br>  O dicion√°rio de origem √© um arquivo de texto simples que possui uma estrutura regular e se parece com isso: <br><br><img src="https://habrastorage.org/webt/-j/yj/pi/-jyjpiiq6ttx9cwq3-3ckouy2c0.png" alt="imagem"><br><br>  Para fins estat√≠sticos, foi necess√°rio determinar a forma inicial para cada forma de palavra: para substantivos - um √∫nico n√∫mero do caso nominativo, para verbos - uma forma indefinida, etc.  Para programadores, essa tarefa era mais simples que simples: para cada palavra na coluna da esquerda, encontre a correspond√™ncia com o formul√°rio que segue imediatamente o n√∫mero dessa palavra no dicion√°rio. <br><br>  Esse √© apenas o usu√°rio m√©dio de neg√≥cios que n√£o possui Python, ferramentas especializadas e habilidades de desenvolvimento, n√£o ser√° capaz de resolver esse problema sem usar o BI de auto-anal√≠tica ou ferramentas semelhantes amig√°veis ‚Äã‚Äãao usu√°rio.  Al√©m disso, se os dados precisarem ser processados ‚Äã‚Äãpara suas necessidades internas ou se n√£o houver informa√ß√µes confidenciais que exijam prote√ß√£o, o Power BI tamb√©m ser√° gratuito *. <br><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text">  *) Refere-se √† vers√£o do Power BI Desktop e √† vers√£o dos Servi√ßos do Power BI para uso pessoal na taxa Gr√°tis. </div></div><br>  Para analisar os dados, eu precisava no Power Query, em uma tabela de 5 milh√µes de registros, adicionar uma nova coluna, deslocada por uma posi√ß√£o.  Inicialmente, tentei aplicar a abordagem cl√°ssica usando o Power Query, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">descrito</a> no portal da comunidade do Power BI por Marcel Beug, autor do guia de refer√™ncia on-line original do Power Query (tamb√©m escrito em Power Query).  Dois algoritmos diferentes s√£o propostos no artigo: um √© inspirado nas id√©ias de Matt Elington, um famoso guru e instrutor do Power BI, e a segunda abordagem √© a ideia original do pr√≥prio Marcel, usando uma fun√ß√£o adicional.  Apesar do fato de que, para aumentar a produtividade, eu armazenei em cache completamente os dados de origem, as duas abordagens exigiram uma quantidade gigantesca de tempo - elas j√° haviam passado o oitavo dia e o processo n√£o havia sido conclu√≠do.  O tamanho do arquivo de origem era 270 MB e o tamanho atual dos dados processados ‚Äã‚Äãera pr√≥ximo a 17 TB.  Tenho certeza de que poucos usu√°rios do Power BI viram esses n√∫meros na janela para carregar dados de uma fonte de arquivo. <br><br><img src="https://habrastorage.org/webt/ox/yq/e_/oxyqe_yrqk_1zhbfscm1rbuvjma.png" alt="imagem"><br><br>  Por que o volume est√° t√£o inchado, n√£o est√° claro;  at√© o produto cartesiano de todos os registros √© muito inferior a 16 TB.  Aqui, o otimizador interno claramente n√£o estava √† altura.  E, por exemplo, o DAX-Studio n√£o permite rastrear consultas do Power Query, apenas o DAX.  Talvez algu√©m compartilhe sua experi√™ncia com o PQ Troubleshipping? <br><br>  Sem esperar pela conclus√£o do primeiro processo, decidi em outra m√°quina tentar resolver o problema usando o DAX por meio de uma consulta auto-escrita.  A solicita√ß√£o foi atendida ... em cerca de 180 segundos e o consumo de mem√≥ria aumentou ligeiramente. <br><br><img src="https://habrastorage.org/webt/nb/aw/e2/nbawe2uffzilci2ttxi6ulhqg24.png" alt="imagem"><br><br>  C√≥digo-fonte para uma solicita√ß√£o DAX: <br><br> <code>KeyWord = <br> CALCULATE( <br> TOPN(1; <br> CALCULATETABLE( <br> VALUES(ShiftedList[Word]) <br> ;ALLEXCEPT(ShiftedList;ShiftedList[Word Nr]) <br> ) <br> )//TOPN <br> )//CALCULATE <br> <br></code> <br><br>  Ou seja, para cada linha na nova coluna [KeyWord], √© pesquisado o primeiro valor da coluna [Word], contendo todas as variantes de formas de palavras com o mesmo n√∫mero b√°sico de formas de palavras (coluna [Word Nr]).  Enquanto o formato do arquivo de origem permanecer inalterado, a solicita√ß√£o dever√° ser atendida sem erros em todas as vers√µes subseq√ºentes do dicion√°rio. <br><br>  O c√≥digo de consulta no Power Query, que forma a tabela de origem no formato necess√°rio, foi gerado "automaticamente" e conclu√≠do em menos de um minuto: <br><br><img src="https://habrastorage.org/webt/v8/yj/xq/v8yjxq04xubrbgacegv6tiw-q2m.png" alt="imagem"><br><br>  Ap√≥s a forma√ß√£o de uma coluna de palavras-chave na interface do PowerPivot em tr√™s minutos, a pesquisa de quaisquer formul√°rios de palavras na interface do Power BI leva n√£o mais que 4 segundos.  Al√©m disso, uma pesquisa de controle pelos mesmos dados no seu Notepad ++ x64 favorito pode levar 20 segundos ou mais.  Mas isso n√£o √© uma pedra no jardim da NPP - √© mais dif√≠cil (e mais longo) pesquisar em toda a matriz de dados do que de acordo com os dados j√° marcados. <br><br>  A prop√≥sito, a solicita√ß√£o DAX acima n√£o nasceu da primeira vez e as op√ß√µes intermedi√°rias consumiram toda a mem√≥ria dispon√≠vel, funcionaram por um longo tempo e terminaram com um erro de dados ou um resultado irrelevante. <br><br><img src="https://habrastorage.org/webt/h0/bm/b_/h0bmb_w7wieehm3olc7lgsfwpnm.png" alt="imagem"><br><br>  Como resultado, o tamanho do arquivo PBIX salvo ficou 60% (112 MB) menor que o dicion√°rio de texto original, mas mais de 4 vezes o tamanho do arquivo ZIP com o mesmo dicion√°rio. <br><br>  Voltando √† batalha entre o Power Query e o DAX: a diferen√ßa na dura√ß√£o da mesma opera√ß√£o em diferentes componentes sugere que o Power BI n√£o √© um p√© de cabra contra o qual n√£o h√° recep√ß√£o.  Ele tem seu pr√≥prio car√°ter e caracter√≠sticas do aplicativo, que devem ser levados em considera√ß√£o em seu trabalho.  Na verdade, como qualquer ferramenta.  E as recomenda√ß√µes de at√© gurus reconhecidos devem ser tratadas com cautela. <br><br>  Parece que Richard Smalley, ganhador do Pr√™mio Nobel, costumava dizer, parafraseando a primeira lei de Clark: ‚ÄúQuando os especialistas dizem que algo √© vi√°vel, provavelmente est√£o certos (eles simplesmente n√£o sabem quando).  Quando eles dizem que isso √© imposs√≠vel, provavelmente est√£o enganados. " <br><br>  Caracter√≠sticas da m√°quina de teste: <br>  <i>Processador: Intel Core i7 4770 a 3,4 GHz (4 n√∫cleos)</i> <i><br></i>  <i>RAM: 16 GB</i> <i><br></i>  <i>SO: Windows 7 Enterprise SP1 x64</i> <br><br>  O dicion√°rio pronto no formato do Power BI pode ser baixado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br>  E <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> est√° dispon√≠vel uma vers√£o online modificada do dicion√°rio.  Voc√™ pode resolver palavras cruzadas como quiser :) <br><br><img src="https://habrastorage.org/webt/6l/zp/-j/6lzp-jafheccraeyj8hi-ktvt8k.png" alt="imagem"><br><br>  ... Ali√°s, h√° v√°rios anos, a tarefa foi resolvida no Excel, embora n√£o 100%.  Apenas para a an√°lise dos textos, n√£o foi utilizado todo o corpus da l√≠ngua russa, mas o dicion√°rio de frequ√™ncias.  Para a limpeza b√°sica de texto, qualquer uma das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">listas de frequ√™ncias</a> top100 dispon√≠veis <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> para v√°rias dezenas de kilobytes √© bastante adequada. <br><br>  <i>Yuri Kolmakov, Especialista, Departamento de Sistemas de Consolida√ß√£o e Visualiza√ß√£o de Dados, Jet Infosystems ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">McCow</a> )</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt429140/">https://habr.com/ru/post/pt429140/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt429122/index.html">O futuro pr√≥ximo da NetApp</a></li>
<li><a href="../pt429124/index.html">Organiza√ß√£o de videoconfer√™ncia at√≠pica em uma grande empresa qu√≠mica</a></li>
<li><a href="../pt429126/index.html">Visitar pai</a></li>
<li><a href="../pt429136/index.html">Samsung introduziu um smartphone com uma tela desbotada</a></li>
<li><a href="../pt429138/index.html">O que oculta PDF</a></li>
<li><a href="../pt429144/index.html">Smartphones dobr√°veis ‚Äã‚Äãe outras informa√ß√µes do Android Dev Summit</a></li>
<li><a href="../pt429146/index.html">Fonte de alimenta√ß√£o comutada para teletipo da d√©cada de 1940 (com tiratr√µes luminosos de merc√∫rio!)</a></li>
<li><a href="../pt429148/index.html">Como "gerentes eficazes" afogaram o Flickr</a></li>
<li><a href="../pt429150/index.html">Gerenciando seus m√≥dulos para CMS usando o compositor</a></li>
<li><a href="../pt429152/index.html">Componente de navega√ß√£o Android. Coisas simples que voc√™ precisa fazer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>