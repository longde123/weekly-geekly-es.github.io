<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏼‍🎓 🧖🏿 👨🏾‍⚕️ Détection des couleurs des voitures à l'aide de réseaux de neurones et de TensorFlow 🛁 👨🏽‍🎓 🏫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, je m'appelle Roman Lapin, je suis étudiant en 2ème année de la faculté de l'Ecole Supérieure de Physique Générale et Appliquée de l'UNN. Cett...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Détection des couleurs des voitures à l'aide de réseaux de neurones et de TensorFlow</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/intel/blog/422689/"><img src="https://habrastorage.org/webt/ay/jz/uv/ayjzuvpfvae66prncupgndyiwpc.jpeg"><br><br>  Bonjour, je m'appelle Roman Lapin, je suis étudiant en 2ème année de la faculté de l'Ecole Supérieure de Physique Générale et Appliquée de l'UNN.  Cette année, j'ai réussi à passer au travers de la sélection et à participer aux travaux d'Intel Summer School à Nizhny Novgorod.  Ma tâche était de déterminer la couleur de la voiture à l'aide de la bibliothèque Tensorflow, sur laquelle j'ai travaillé avec mon mentor et ingénieur de l'équipe ICV Alexei Sidnev. <br>  Et c'est ce que j'ai. <br><a name="habracut"></a><br>  Cette tâche comporte plusieurs aspects: <br><br><ol><li>  La voiture peut être peinte en plusieurs couleurs, comme sur KDPV.  Et dans l'un des ensembles de données, par exemple, nous avions une voiture camouflée. </li><li>  En fonction de l'éclairage et de la caméra qui prend des photos de ce qui se passe sur la route, les voitures de la même couleur seront très différentes.  Les voitures «éclairées» peuvent avoir une très petite partie correspondant à la «vraie» couleur de la voiture. </li></ol><br><h2>  <font color="#0071c5">Détection de couleur de voiture</font> </h2><br>  La couleur de la voiture est une substance plutôt étrange.  Le fabricant a une compréhension claire de la couleur de la voiture qu'ils produisent, par exemple: fantôme, glace, perle noire, pluton, chaux, krypton, angkor, cornaline, platine, bleus.  La police de la circulation a une opinion sur les couleurs des voitures plutôt conservatrice et très limitée.  Chaque personne a une perception subjective de la couleur (vous pouvez vous rappeler l'histoire populaire de la couleur de la robe).  Ainsi, nous avons décidé de baliser comme suit. <br><br>  Sur chaque image, les coordonnées des sommets des rectangles bordant les voitures ont été marquées (ci-après j'utiliserai la version anglaise - <i>boîte de délimitation de voiture</i> ) et à l'intérieur se trouvent les zones qui décrivent le mieux la couleur des véhicules ( <i>boîte de couleur</i> ).  Le nombre de ces derniers est égal à la couleur de la voiture ( <i>n</i> x <i>boîte de couleur</i> - voiture n-couleur). <br><br>  Ci-après, les numéros de voiture sont flous pour la possibilité de publier des photos dans le domaine public. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/mh/p7/z5/mhp7z5aebrmyfhgw-cack-fm8zi.png" alt="image"></div><br>  <i>Jeu de données de marquage des voitures</i> <br><br>  À l'avenir, nous avons travaillé avec deux espaces colorimétriques - RVB et LAB - avec les classes 8 et 810/81, respectivement.  Pour comparer les résultats de différentes approches, nous avons utilisé 8 classes en RVB pour déterminer la couleur, qui sont obtenues en divisant le cube BGR en 8 petits cubes égaux.  Ils peuvent facilement être appelés noms communs: blanc, noir, rouge, vert, bleu, rose, jaune, cyan.  Pour évaluer l'erreur d'une méthode, nous avons déjà utilisé l'espace colorimétrique LAB, dans lequel la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">distance</a> entre les couleurs est déterminée. <br><br>  Il existe deux façons intuitives de déterminer la couleur par <i>case de couleur</i> : <i>couleur</i> moyenne ou médiane.  Mais dans la <i>boîte de couleur,</i> il y a des pixels de différentes couleurs, donc je voulais savoir avec précision comment chacune de ces deux approches fonctionne. <br><br>  Pour 8 couleurs RVB pour chaque <i>case de couleur de</i> chaque machine du jeu de données, nous avons déterminé la couleur moyenne des pixels et la médiane, les résultats sont présentés dans les figures ci-dessous.  Les «vraies» couleurs sont marquées dans les lignes - c'est-à-dire les couleurs définies respectivement comme moyenne ou comme médiane, dans les colonnes - couleurs que l'on retrouve en principe.  Lors de l'ajout d'une machine à la table, le nombre de pixels de chaque couleur a été normalisé à leur nombre, c'est-à-dire que la somme de toutes les valeurs ajoutées à la ligne était égale à un. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ic/q-/ep/icq-ep_xxwuaiuuec8bordv3_cu.png" alt="image"></div><br>  <i>Étude de la précision de la détermination de la couleur d'une machine comme couleur moyenne des pixels couleur 'abox.</i>  <i>Précision moyenne: <b>75%</b></i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/at/b3/wm/atb3wmizgurxd0gemdqiltoj62w.png" alt="image"></div><br>  <i>Étude de la précision de la détermination de la couleur d'une machine comme couleur médiane des pixels dans une boîte de couleur.</i>  <i>Précision moyenne: <b>76%</b></i> <br><br>  Comme vous pouvez le voir, il n'y a pas de différence particulière entre les méthodes, ce qui indique un bon balisage.  À l'avenir, nous avons utilisé la médiane, car elle a donné le meilleur résultat. <br>  La couleur de la voiture sera déterminée en fonction de la zone à l'intérieur du cadre <i>de délimitation de</i> la <i>voiture</i> . <br><br><h2>  <font color="#0071c5">Avez-vous besoin de réseaux?</font> </h2><br>  La question est inévitable: les réseaux de neurones sont-ils vraiment nécessaires pour résoudre une tâche intuitivement simple?  Peut-être pouvez-vous prendre la couleur médiane ou moyenne des pixels dans une <i>boîte englobante de voiture</i> de la même manière?  Les figures ci-dessous montrent le résultat de cette approche.  Comme nous le montrerons plus loin, elle est pire que la méthode utilisant les réseaux de neurones. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/an/bl/o8/anblo8jtdfojv3v7b1yd_bt5zzi.png" alt="image"></div><br>  <i>La répartition de la part des voitures avec la valeur d'erreur L2 dans l'espace LAB entre la couleur de la zone de couleur définie comme la moyenne et la couleur de la zone de délimitation de la voiture de la valeur de cette erreur</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/l-/ir/o0/l-iro02-06n4ugotazhlmumisii.png" alt="image"></div><br>  <i>Distribution de la part des voitures avec la valeur d'erreur L2 dans l'espace LAB entre la zone de couleur de couleur définie comme la médiane et la couleur de la zone de <i>délimitation de</i> la <i>voiture à</i> partir de la valeur de cette erreur</i> <br><br><h2>  <font color="#0071c5">Description de l'approche de la tâche</font> </h2><br>  Dans notre travail, nous avons utilisé l'architecture Resnet-10 pour mettre en évidence les fonctionnalités.  Pour résoudre un problème à étiquette unique et à étiquettes multiples, les fonctions d'activation de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">softmax</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sigmoid,</a> respectivement, ont été choisies. <br>  Un problème important était le choix de la métrique par laquelle nous pouvions comparer nos résultats.  Dans le cas d'une tâche d'étiquette, vous pouvez sélectionner la classe qui correspond à la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">réponse maximale</a> .  Cependant, une telle solution ne fonctionnera évidemment pas dans le cas de machines multi-étiquettes / multi-couleurs, car argmax produit une couleur, très probablement.  La métrique <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">L1</a> dépend du nombre de classes, par conséquent, elle ne pouvait pas non plus être utilisée pour comparer tous les résultats.  Par conséquent, il a été décidé de s'attarder sur la métrique de l'aire sous la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">courbe</a> ROC (ROC AUC - aire sous la courbe) comme universelle et universellement reconnue. <br><br>  Nous avons travaillé dans deux espaces colorimétriques.  Le premier est le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RVB</a> standard, dans lequel nous avons choisi 8 classes: nous avons divisé le cube RVB en 8 sous-cubes identiques: blanc, noir, rouge, vert, bleu, rose, jaune, cyan.  Une telle partition est très grossière, mais simple. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vq/4z/pd/vq4zpd9edgxx4m9z0cnk-8jso2i.png" alt="image"></div><br>  <i>Divisez l'espace colorimétrique RVB en 8 zones</i> <br><br>  De plus, nous avons mené des études avec l'espace colorimétrique LAB, qui a utilisé la partition en 810 classes.  Pourquoi tant?  LAB a été introduit après que le scientifique américain <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">David MacAdam a</a> établi qu'il existe des zones de couleurs qui ne sont pas visibles à l'œil nu ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ellipses de MacAdam</a> ).  LAB a été construit de telle sorte que ces ellipses avaient l'apparence de cercles (dans la section de luminosité L constante). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/-1/y5/q9/-1y5q9owfaqva2sd7sxy45auef0.png" alt="image"></div><br>  <i>Ellipses MacAdam et espace colorimétrique LAB ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">source</a> )</i> <br><br>  Au total, il y a 81 cercles dans la section de ces cercles.Nous avons franchi l'étape 10 par rapport au paramètre L (de 0 à 100), obtenant 810 classes.  De plus, nous avons mené une expérience avec une classe L constante et, par conséquent, 81. <br><br><h2>  <font color="#0071c5">RGB et LAB</font> </h2><br>  Les résultats suivants ont été obtenus pour le problème de la classe 8 et l'espace RVB: <br><table><tbody><tr><th>  Fonction d'activation </th><th>  Tâche à étiquettes multiples </th><th>  ROC AUC </th></tr><tr><td>  softmax </td><td>  - </td><td>  0,97 </td></tr><tr><td>  sigmoïde </td><td>  ✓ </td><td>  0,88 </td></tr></tbody></table>  <i>Tableau des résultats de la reconnaissance des couleurs pour les machines dans un problème de 8 classes</i> <br><br>  Il semble que le résultat de la tâche multi-étiquettes soit déjà assez bon.  Pour vérifier cette hypothèse, nous avons construit une matrice d'erreur, prenant 0,55 comme valeur seuil pour la probabilité.  C'est-à-dire  si cette valeur est dépassée en probabilité pour la couleur correspondante, nous supposons que la machine est peinte dans cette couleur.  Malgré le fait que le seuil est choisi suffisamment bas, on peut voir des erreurs typiques dans la détermination de la couleur de la voiture et tirer des conclusions. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/5s/5q/9t/5s5q9tyt_8nbe4c0vb-mgxtoday.png" alt="image"></div><br>  <i>Tableau des résultats de la reconnaissance des couleurs pour les voitures en 8e classe</i> <br><br>  Il suffit de regarder les lignes correspondant aux couleurs vertes ou roses pour vous assurer que le modèle est loin d'être parfait.  Sur la question de savoir pourquoi, avec une grande valeur métrique, un résultat aussi étrange et infructueux est obtenu, nous reviendrons et indiquerons immédiatement: lorsque l'on considère seulement 8 classes, un grand nombre de couleurs tombent dans les classes "blanc" et "noir", donc un tel résultat . <br><br>  Par conséquent, nous allons passer à l'espace colorimétrique LAB et y mener des recherches. <br><table><tbody><tr><th>  Fonction d'activation </th><th>  Tâche à étiquettes multiples </th><th>  ROC AUC </th></tr><tr><td>  softmax </td><td>  - </td><td>  0,915 </td></tr><tr><td>  sigmoïde </td><td>  ✓ </td><td>  0,846 </td></tr></tbody></table>  <i>Tableau des résultats de la reconnaissance des couleurs de la machine dans le problème de la classe 810</i> <br><br>  Le résultat est moindre, ce qui est logique, car le nombre de classes a augmenté de deux ordres de grandeur.  Prenant le résultat sigmoïde comme point de départ, nous avons essayé d'améliorer notre modèle. <br><br><h2>  <font color="#0071c5">LAB: expériences avec différents poids</font> </h2><br>  Avant cela, toutes les expériences ont été effectuées avec des poids unitaires dans la fonction de <i>perte</i> ( <i>perte</i> ): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ox/u5/af/oxu5afajo-qngyg1t6tdml1sdxo.png" alt="image"></div><br><br>  Ici, GT est la vérité fondamentale, W est les poids. <br><br>  Vous pouvez entrer une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">distance dans l'</a> espace colorimétrique LAB.  Disons que nous avons une unité en GT.  Il correspond alors à un parallélépipède rectangulaire dans l'espace colorimétrique LAB.  Ce parallélépipède (plus précisément, son centre) est retiré à une distance différente de tous les autres parallélépipèdes (encore une fois, leurs centres).  En fonction de cette distance, vous pouvez expérimenter avec les échelles suivantes: <br><br>  a) Zéro à la place d'une unité en GT, et en s'éloignant d'elle - une augmentation des poids; <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zs/in/ql/zsinql6ut3hucnr3ytrvkc0xxqi.png" alt="image"></div><br><br>  b) Inversement, à la place d'une unité en GT, elle en est une; lorsqu'elle est retirée, c'est une baisse de poids; <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8v/-l/oo/8v-looj6mqsgrtzvz9elevykcak.png" alt="image"></div><br><br>  c) Option a) plus un petit additif gaussien d'une amplitude de ½ à la place d'une unité en GT; <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yx/qy/ac/yxqyac6ks3cvy10qh6lilp4ib0q.png" alt="image"></div><br><br>  d) Option a) plus un petit additif gaussien d'une amplitude de 1 à la place d'une unité en GT; <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ep/0s/01/ep0s01rau7n0oiak71zjkp5vhxg.png" alt="image"></div><br><br>  e) Option b) avec un petit additif à une distance maximale de l'unité en GT. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ff/9q/ft/ff9qftnoidusfhdhz1p9jjoqwi0.png" alt="image"></div><br><br>  La dernière version des échelles avec lesquelles nous avons mené des expériences est, comme nous l'avons appelé, le triple Gauss, à savoir trois distributions normales avec des centres à la place des unités dans le GT, ainsi qu'à la plus grande distance d'eux. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qk/jr/kb/qkjrkbhyxschjibmya3xt3hik9y.png" alt="image"></div><br>  <i>Trois distributions normales centrées sur les unités du GT et à la plus grande distance de celles-ci</i> <br><br>  Il faudra l'expliquer plus en détail.  Vous pouvez sélectionner les deux parallélépipèdes les plus éloignés et, par conséquent, les classes, et les comparer dans l'éloignement de l'original.  Pour la classe correspondant à la lointaine, l'amplitude de distribution est fixée à 0,8 et pour la seconde, elle est m fois plus petite, où m est le rapport de la distance de la source à la lointaine à la distance entre la source et la proche. <br><br>  Les résultats sont présentés dans le tableau.  En raison du fait que dans les échelles de l'option a), il n'y avait aucun poids - juste pour les unités en GT, le résultat sur celles-ci était encore pire que le point de départ, car le réseau ne tenait pas compte des définitions de couleurs réussies, apprenant pire.  Les variantes des poids b) et e) coïncidaient pratiquement, donc le résultat sur elles coïncidait.  La plus forte augmentation de points de pourcentage par rapport au résultat initial a été montrée par la variante des poids f) - triple gauss. <br><table><tbody><tr><th>  Fonction d'activation </th><th>  Nombre de cours </th><th>  Type de poids </th><th>  ROC AUC </th></tr><tr><td rowspan="5">  sigmoïde </td><td rowspan="5">  810 </td><td>  a) </td><td>  0,844 </td></tr><tr><td>  b), e) </td><td>  0,848 </td></tr><tr><td>  c) </td><td>  0,888 </td></tr><tr><td>  d) </td><td>  0,879 </td></tr><tr><td>  f) </td><td>  0,909 </td></tr></tbody></table>  <i>Résultats de la reconnaissance des couleurs des machines en problème de classe 810 avec différentes options de poids</i> <br><br><h2>  <font color="#0071c5">LAB: expérimenter de nouveaux labels</font> </h2><br>  Nous avons donc mené des expériences avec différents poids de <i>perte</i> .  Ensuite, nous avons décidé d'essayer de laisser les poids comme un, et de changer les étiquettes, qui sont transférées à la fonction de perte et utilisées pour optimiser le réseau.  Si avant cela les étiquettes coïncidaient avec GT, maintenant ils ont décidé de réutiliser les distributions gaussiennes avec des centres à la place des unités dans GT: <br><br>  La motivation de cette décision est la suivante.  Le fait est qu'avec les étiquettes ordinaires, toutes les voitures des ensembles de données se répartissent en un nombre fixe de classes, moins de 810, de sorte que le réseau apprend à déterminer la couleur des voitures de ces classes uniquement.  Avec de nouvelles étiquettes, les valeurs non nulles tombent dans toutes les classes, et nous pouvons nous attendre à une augmentation de la précision de la détermination de la couleur de la voiture.  Nous avons expérimenté deux sigma (écarts-types) pour les distributions gaussiennes ci-dessus: 41,9 et 20,9.  Pourquoi  Le premier sigma est choisi comme suit: la distance minimale entre les classes (28) est prise et le sigma est déterminé à partir de la condition que la distribution diminue deux fois dans la classe adjacente au GT'noye.  Et le deuxième sigma est juste deux fois plus petit que le premier. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jk/z4/xq/jkz4xqdkl-nwecfnttwzuhwgyuo.png" alt="image"></div><br>  <i>Répartition des voitures de jeux de données d'entraînement par classes avec différentes étiquettes en perte</i> <br><br>  En effet, il a été possible d'améliorer encore le résultat en utilisant une telle astuce, comme le montre le tableau.  En conséquence, la précision de la détermination a atteint 0,955! <br><table><tbody><tr><th>  Fonction d'activation </th><th>  Nombre de cours </th><th>  Type d'étiquette </th><th>  Type de poids </th><th>  ROC AUC </th></tr><tr><td rowspan="4">  sigmoïde </td><td rowspan="4">  810 </td><td>  habituel </td><td>  ceux </td><td>  0,846 </td></tr><tr><td>  habituel </td><td>  trois gauss </td><td>  0,909 </td></tr><tr><td>  nouveau, σ <sub>1</sub> </td><td rowspan="2">  trois gauss </td><td>  0,955 </td></tr><tr><td>  nouveau, σ <sub>2</sub> </td><td>  0,946 </td></tr></tbody></table>  <i>Résultats de la reconnaissance des couleurs pour les machines du problème de la classe 810: avec des étiquettes et des poids unitaires ordinaires, avec des étiquettes et des poids ordinaires sous forme de triple Gauss, avec de nouvelles étiquettes et des poids unitaires</i> <br><br><h2>  <font color="#0071c5">LAB: 81</font> </h2><br>  Si nous parlons d'expériences infructueuses, nous devons mentionner la tentative de former un réseau avec 81 classes et un paramètre constant L. Nous avons remarqué lors des expériences précédentes que la luminosité est déterminée par le réseau assez précisément, et nous avons décidé de ne former que les paramètres a et b (donc appelé les deux autres coordonnées dans LAB).  Malheureusement, malgré le fait que le réseau a pu parfaitement s'entraîner dans l'avion, montrant une plus grande valeur en termes de métrique, l'idée de définir le paramètre L à la sortie du réseau comme moyenne pour la <i>boîte de délimitation</i> de la <i>voiture</i> s'est écrasé et la couleur réelle et ainsi définie était très différente. <br><br><h2>  <font color="#0071c5">Comparaison avec la résolution d'un problème sans utiliser de réseaux de neurones</font> </h2><br>  Revenons maintenant au tout début et comparons ce qui s'est passé avec nous avec la reconnaissance de la couleur de la voiture sans utiliser de réseaux de neurones. <br>  Les résultats sont présentés dans les figures ci-dessous.  On peut voir que le pic est devenu 3 fois plus, et le nombre de voitures avec une grande erreur entre le vrai et une certaine couleur a considérablement diminué. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/l-/ir/o0/l-iro02-06n4ugotazhlmumisii.png" alt="image"></div><br>  <i>La répartition de la part des voitures avec la valeur d'erreur L2 dans l'espace LAB entre la zone de délimitation de la couleur de couleur définie comme la médiane et la couleur de la zone de délimitation de la voiture de la valeur de cette erreur</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/6j/wr/b5/6jwrb5imhzh2rbvnaxrgzedf0p8.png" alt="image"></div><br>  <i>Distribution de la part des voitures avec la valeur d'erreur L2 dans l'espace LAB entre la couleur à la sortie du réseau de neurones et la couleur du cadre de délimitation de la voiture de la valeur de cette erreur</i> <br><br><h2>  <font color="#0071c5">Des exemples</font> </h2><br>  Voici des exemples de reconnaissance des couleurs de la voiture.  La première est que la machine noire (un cas typique) est reconnue comme noire, et la distance dans l'espace LAB entre la vraie couleur et la couleur spécifique (18.16) est inférieure à la distance minimale entre les classes (28).  Dans la deuxième figure, le réseau a pu non seulement déterminer que la voiture était éclairée (il y a une forte probabilité qui correspond à l'une des classes de couleurs blanches), mais aussi sa vraie couleur (argent).  Cependant, la machine de la figure suivante, également éclairée, n'a pas été détectée par le réseau en rouge.  Le réseau n'a pas pu déterminer la couleur de la voiture indiquée dans la figure ci-dessous, ce qui découle du fait que les probabilités pour toutes les couleurs sont trop faibles. <br><br>  À bien des égards, la tâche était due à la nécessité de reconnaître les voitures multicolores.  La dernière figure représente une voiture bicolore noire et jaune.  Le réseau était le plus susceptible de reconnaître la couleur noire, qui est probablement due à la prédominance de machines de cette couleur et de couleurs similaires dans l'ensemble de données de formation, et la couleur jaune, qui est presque vraie, est entrée dans le top 3. <br><table><tbody><tr><th width="200"><img src="https://habrastorage.org/webt/ro/l7/re/rol7re300p2hf30rtsvaiyfbi20.png" align="right" alt="image"></th><th><img src="https://habrastorage.org/webt/n8/ig/cl/n8igclilt4ep3qlmipvt9rmbt5w.png" align="left" alt="image"></th></tr></tbody></table><table><tbody><tr><th width="200"><img src="https://habrastorage.org/webt/o5/pf/fj/o5pffjzvnat7mouv8yhf-kuzs3g.png" align="right" alt="image"></th><th><img src="https://habrastorage.org/webt/vn/ml/wa/vnmlwawbhys7tkvrwquwc6bttsw.png" align="left" alt="image"></th></tr></tbody></table><table><tbody><tr><th width="200"><img src="https://habrastorage.org/webt/jh/mi/hs/jhmihs9rnoqounq2ostwq8iz1q0.png" align="right" alt="image"></th><th><img src="https://habrastorage.org/webt/pv/sg/ft/pvsgftesuo5lmmy_gvuzsj-rg4o.png" align="left" alt="image"></th></tr></tbody></table><table><tbody><tr><th width="200"><img src="https://habrastorage.org/webt/f7/uj/p3/f7ujp3uavgqz6aobfa_hbk6xpos.png" align="right" alt="image"></th><th><img src="https://habrastorage.org/webt/0c/mo/l1/0cmol16qj3ghtsc49jqag2dy8yc.png" align="left" alt="image"></th></tr></tbody></table><table><tbody><tr><th width="200"><img src="https://habrastorage.org/webt/dd/hi/th/ddhithwwjdez_q6sr8xa9cwcs-i.png" align="right" alt="image"></th><th><img src="https://habrastorage.org/webt/gg/hf/px/gghfpxgurqddwvldmop4t1zszfo.png" align="left" alt="image"></th></tr></tbody></table><br><h2>  <font color="#0071c5">Courbe ROC: visualisation et problèmes</font> </h2><br>  Donc, à la sortie, nous avons obtenu un résultat métrique assez élevé.  La figure suivante montre les courbes ROC pour résoudre un problème avec 8 classes et pour un problème avec 810 classes, ainsi que des solutions sans utiliser de réseaux de neurones.  On peut voir que le résultat est légèrement différent de celui qui a été écrit plus tôt.  Les résultats précédents ont été obtenus en utilisant TensorFlow, les graphiques ci-dessous ont été obtenus en utilisant le package scikit-learn. <br><table><tbody><tr><th><div style="text-align:center;"><img src="https://habrastorage.org/webt/yq/zm/ib/yqzmib4v_0jaco5torqqvu0fdmo.png" alt="image"></div></th><th><div style="text-align:center;"><img src="https://habrastorage.org/webt/k0/nb/gn/k0nbgn7ows7rcx-q3so38ugg_dw.png" alt="image"></div></th></tr></tbody></table>  <i>Courbe ROC pour plusieurs options pour résoudre le problème.</i>  <i>À droite, le coin supérieur gauche du graphique de gauche</i> <br><br>  Vous pouvez prendre n'importe quel nombre fixe comme valeur de seuil (par exemple, Tensorflow, lorsque vous définissez le paramètre correspondant sur 50, prend le même nombre de seuils de 0 à 1 à intervalles égaux), vous pouvez utiliser les valeurs à la sortie du réseau, ou vous pouvez les limiter par le bas pour ne pas tenir compte des valeurs de l'ordre de 10 <sup>-4</sup> par exemple.  Le résultat de cette dernière approche est illustré dans la figure suivante. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fb/2c/b2/fb2cb2dxnaxvjjtywmlbdb-xs54.png" alt="image"></div><br>  <i>Courbe ROC pour plusieurs options pour résoudre le problème avec un seuil de 10 <sup>-4</sup></i> <br><br>  On peut voir que toutes les courbes correspondant à la solution du problème en utilisant des réseaux de neurones sont caractéristiquement meilleures (supérieures) que la solution au problème sans elles, mais vous ne pouvez pas choisir la meilleure courbe entre les premières.  Selon le seuil choisi par l'utilisateur, différentes courbes correspondront à différentes solutions optimales au problème.  Par conséquent, d'une part, nous avons trouvé une approche qui nous permet de déterminer avec précision la couleur de la machine et montre une métrique élevée, d'autre part, nous avons montré que la limite n'a pas encore été atteinte et que la métrique de la zone sous la courbe ROC a ses inconvénients. <br><br>  Prêt à répondre aux questions et à écouter les commentaires dans les commentaires. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr422689/">https://habr.com/ru/post/fr422689/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr422679/index.html">Problèmes imaginaires - la raison d'un mauvais logiciel</a></li>
<li><a href="../fr422681/index.html">Intégration SAP et Python ou comment récupérer des données de SAP plus facilement</a></li>
<li><a href="../fr422683/index.html">Aux États-Unis, deux commerçants ont créé une fausse société de courtage pour voler de l'argent à des investisseurs novices</a></li>
<li><a href="../fr422685/index.html">Smart Watch Samsung Galaxy Watch: mise à niveau d'Android Wear OS vers Tizen OS - expérience personnelle</a></li>
<li><a href="../fr422687/index.html">Messagers en danger</a></li>
<li><a href="../fr422691/index.html">La caméra hybride et le lidar améliorent les capacités des robots, complétant les informations sur le monde extérieur</a></li>
<li><a href="../fr422693/index.html">Équipe de plugins pour configurer les composants JavaFX dans une application de bureau</a></li>
<li><a href="../fr422697/index.html">Webpack 4 et division du fichier de configuration en modules</a></li>
<li><a href="../fr422699/index.html">Une échappatoire fermée confirme l'irréalité du monde quantique</a></li>
<li><a href="../fr422701/index.html">Deep Learning et OpenVINO Toolkit. Poser une question à un expert Intel</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>