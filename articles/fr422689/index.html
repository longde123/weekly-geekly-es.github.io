<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèº‚Äçüéì üßñüèø üë®üèæ‚Äç‚öïÔ∏è D√©tection des couleurs des voitures √† l'aide de r√©seaux de neurones et de TensorFlow üõÅ üë®üèΩ‚Äçüéì üè´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, je m'appelle Roman Lapin, je suis √©tudiant en 2√®me ann√©e de la facult√© de l'Ecole Sup√©rieure de Physique G√©n√©rale et Appliqu√©e de l'UNN. Cett...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>D√©tection des couleurs des voitures √† l'aide de r√©seaux de neurones et de TensorFlow</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/intel/blog/422689/"><img src="https://habrastorage.org/webt/ay/jz/uv/ayjzuvpfvae66prncupgndyiwpc.jpeg"><br><br>  Bonjour, je m'appelle Roman Lapin, je suis √©tudiant en 2√®me ann√©e de la facult√© de l'Ecole Sup√©rieure de Physique G√©n√©rale et Appliqu√©e de l'UNN.  Cette ann√©e, j'ai r√©ussi √† passer au travers de la s√©lection et √† participer aux travaux d'Intel Summer School √† Nizhny Novgorod.  Ma t√¢che √©tait de d√©terminer la couleur de la voiture √† l'aide de la biblioth√®que Tensorflow, sur laquelle j'ai travaill√© avec mon mentor et ing√©nieur de l'√©quipe ICV Alexei Sidnev. <br>  Et c'est ce que j'ai. <br><a name="habracut"></a><br>  Cette t√¢che comporte plusieurs aspects: <br><br><ol><li>  La voiture peut √™tre peinte en plusieurs couleurs, comme sur KDPV.  Et dans l'un des ensembles de donn√©es, par exemple, nous avions une voiture camoufl√©e. </li><li>  En fonction de l'√©clairage et de la cam√©ra qui prend des photos de ce qui se passe sur la route, les voitures de la m√™me couleur seront tr√®s diff√©rentes.  Les voitures ¬´√©clair√©es¬ª peuvent avoir une tr√®s petite partie correspondant √† la ¬´vraie¬ª couleur de la voiture. </li></ol><br><h2>  <font color="#0071c5">D√©tection de couleur de voiture</font> </h2><br>  La couleur de la voiture est une substance plut√¥t √©trange.  Le fabricant a une compr√©hension claire de la couleur de la voiture qu'ils produisent, par exemple: fant√¥me, glace, perle noire, pluton, chaux, krypton, angkor, cornaline, platine, bleus.  La police de la circulation a une opinion sur les couleurs des voitures plut√¥t conservatrice et tr√®s limit√©e.  Chaque personne a une perception subjective de la couleur (vous pouvez vous rappeler l'histoire populaire de la couleur de la robe).  Ainsi, nous avons d√©cid√© de baliser comme suit. <br><br>  Sur chaque image, les coordonn√©es des sommets des rectangles bordant les voitures ont √©t√© marqu√©es (ci-apr√®s j'utiliserai la version anglaise - <i>bo√Æte de d√©limitation de voiture</i> ) et √† l'int√©rieur se trouvent les zones qui d√©crivent le mieux la couleur des v√©hicules ( <i>bo√Æte de couleur</i> ).  Le nombre de ces derniers est √©gal √† la couleur de la voiture ( <i>n</i> x <i>bo√Æte de couleur</i> - voiture n-couleur). <br><br>  Ci-apr√®s, les num√©ros de voiture sont flous pour la possibilit√© de publier des photos dans le domaine public. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/mh/p7/z5/mhp7z5aebrmyfhgw-cack-fm8zi.png" alt="image"></div><br>  <i>Jeu de donn√©es de marquage des voitures</i> <br><br>  √Ä l'avenir, nous avons travaill√© avec deux espaces colorim√©triques - RVB et LAB - avec les classes 8 et 810/81, respectivement.  Pour comparer les r√©sultats de diff√©rentes approches, nous avons utilis√© 8 classes en RVB pour d√©terminer la couleur, qui sont obtenues en divisant le cube BGR en 8 petits cubes √©gaux.  Ils peuvent facilement √™tre appel√©s noms communs: blanc, noir, rouge, vert, bleu, rose, jaune, cyan.  Pour √©valuer l'erreur d'une m√©thode, nous avons d√©j√† utilis√© l'espace colorim√©trique LAB, dans lequel la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">distance</a> entre les couleurs est d√©termin√©e. <br><br>  Il existe deux fa√ßons intuitives de d√©terminer la couleur par <i>case de couleur</i> : <i>couleur</i> moyenne ou m√©diane.  Mais dans la <i>bo√Æte de couleur,</i> il y a des pixels de diff√©rentes couleurs, donc je voulais savoir avec pr√©cision comment chacune de ces deux approches fonctionne. <br><br>  Pour 8 couleurs RVB pour chaque <i>case de couleur de</i> chaque machine du jeu de donn√©es, nous avons d√©termin√© la couleur moyenne des pixels et la m√©diane, les r√©sultats sont pr√©sent√©s dans les figures ci-dessous.  Les ¬´vraies¬ª couleurs sont marqu√©es dans les lignes - c'est-√†-dire les couleurs d√©finies respectivement comme moyenne ou comme m√©diane, dans les colonnes - couleurs que l'on retrouve en principe.  Lors de l'ajout d'une machine √† la table, le nombre de pixels de chaque couleur a √©t√© normalis√© √† leur nombre, c'est-√†-dire que la somme de toutes les valeurs ajout√©es √† la ligne √©tait √©gale √† un. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ic/q-/ep/icq-ep_xxwuaiuuec8bordv3_cu.png" alt="image"></div><br>  <i>√âtude de la pr√©cision de la d√©termination de la couleur d'une machine comme couleur moyenne des pixels couleur 'abox.</i>  <i>Pr√©cision moyenne: <b>75%</b></i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/at/b3/wm/atb3wmizgurxd0gemdqiltoj62w.png" alt="image"></div><br>  <i>√âtude de la pr√©cision de la d√©termination de la couleur d'une machine comme couleur m√©diane des pixels dans une bo√Æte de couleur.</i>  <i>Pr√©cision moyenne: <b>76%</b></i> <br><br>  Comme vous pouvez le voir, il n'y a pas de diff√©rence particuli√®re entre les m√©thodes, ce qui indique un bon balisage.  √Ä l'avenir, nous avons utilis√© la m√©diane, car elle a donn√© le meilleur r√©sultat. <br>  La couleur de la voiture sera d√©termin√©e en fonction de la zone √† l'int√©rieur du cadre <i>de d√©limitation de</i> la <i>voiture</i> . <br><br><h2>  <font color="#0071c5">Avez-vous besoin de r√©seaux?</font> </h2><br>  La question est in√©vitable: les r√©seaux de neurones sont-ils vraiment n√©cessaires pour r√©soudre une t√¢che intuitivement simple?  Peut-√™tre pouvez-vous prendre la couleur m√©diane ou moyenne des pixels dans une <i>bo√Æte englobante de voiture</i> de la m√™me mani√®re?  Les figures ci-dessous montrent le r√©sultat de cette approche.  Comme nous le montrerons plus loin, elle est pire que la m√©thode utilisant les r√©seaux de neurones. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/an/bl/o8/anblo8jtdfojv3v7b1yd_bt5zzi.png" alt="image"></div><br>  <i>La r√©partition de la part des voitures avec la valeur d'erreur L2 dans l'espace LAB entre la couleur de la zone de couleur d√©finie comme la moyenne et la couleur de la zone de d√©limitation de la voiture de la valeur de cette erreur</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/l-/ir/o0/l-iro02-06n4ugotazhlmumisii.png" alt="image"></div><br>  <i>Distribution de la part des voitures avec la valeur d'erreur L2 dans l'espace LAB entre la zone de couleur de couleur d√©finie comme la m√©diane et la couleur de la zone de <i>d√©limitation de</i> la <i>voiture √†</i> partir de la valeur de cette erreur</i> <br><br><h2>  <font color="#0071c5">Description de l'approche de la t√¢che</font> </h2><br>  Dans notre travail, nous avons utilis√© l'architecture Resnet-10 pour mettre en √©vidence les fonctionnalit√©s.  Pour r√©soudre un probl√®me √† √©tiquette unique et √† √©tiquettes multiples, les fonctions d'activation de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">softmax</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sigmoid,</a> respectivement, ont √©t√© choisies. <br>  Un probl√®me important √©tait le choix de la m√©trique par laquelle nous pouvions comparer nos r√©sultats.  Dans le cas d'une t√¢che d'√©tiquette, vous pouvez s√©lectionner la classe qui correspond √† la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">r√©ponse maximale</a> .  Cependant, une telle solution ne fonctionnera √©videmment pas dans le cas de machines multi-√©tiquettes / multi-couleurs, car argmax produit une couleur, tr√®s probablement.  La m√©trique <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">L1</a> d√©pend du nombre de classes, par cons√©quent, elle ne pouvait pas non plus √™tre utilis√©e pour comparer tous les r√©sultats.  Par cons√©quent, il a √©t√© d√©cid√© de s'attarder sur la m√©trique de l'aire sous la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">courbe</a> ROC (ROC AUC - aire sous la courbe) comme universelle et universellement reconnue. <br><br>  Nous avons travaill√© dans deux espaces colorim√©triques.  Le premier est le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RVB</a> standard, dans lequel nous avons choisi 8 classes: nous avons divis√© le cube RVB en 8 sous-cubes identiques: blanc, noir, rouge, vert, bleu, rose, jaune, cyan.  Une telle partition est tr√®s grossi√®re, mais simple. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vq/4z/pd/vq4zpd9edgxx4m9z0cnk-8jso2i.png" alt="image"></div><br>  <i>Divisez l'espace colorim√©trique RVB en 8 zones</i> <br><br>  De plus, nous avons men√© des √©tudes avec l'espace colorim√©trique LAB, qui a utilis√© la partition en 810 classes.  Pourquoi tant?  LAB a √©t√© introduit apr√®s que le scientifique am√©ricain <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">David MacAdam a</a> √©tabli qu'il existe des zones de couleurs qui ne sont pas visibles √† l'≈ìil nu ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ellipses de MacAdam</a> ).  LAB a √©t√© construit de telle sorte que ces ellipses avaient l'apparence de cercles (dans la section de luminosit√© L constante). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/-1/y5/q9/-1y5q9owfaqva2sd7sxy45auef0.png" alt="image"></div><br>  <i>Ellipses MacAdam et espace colorim√©trique LAB ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">source</a> )</i> <br><br>  Au total, il y a 81 cercles dans la section de ces cercles.Nous avons franchi l'√©tape 10 par rapport au param√®tre L (de 0 √† 100), obtenant 810 classes.  De plus, nous avons men√© une exp√©rience avec une classe L constante et, par cons√©quent, 81. <br><br><h2>  <font color="#0071c5">RGB et LAB</font> </h2><br>  Les r√©sultats suivants ont √©t√© obtenus pour le probl√®me de la classe 8 et l'espace RVB: <br><table><tbody><tr><th>  Fonction d'activation </th><th>  T√¢che √† √©tiquettes multiples </th><th>  ROC AUC </th></tr><tr><td>  softmax </td><td>  - </td><td>  0,97 </td></tr><tr><td>  sigmo√Øde </td><td>  ‚úì </td><td>  0,88 </td></tr></tbody></table>  <i>Tableau des r√©sultats de la reconnaissance des couleurs pour les machines dans un probl√®me de 8 classes</i> <br><br>  Il semble que le r√©sultat de la t√¢che multi-√©tiquettes soit d√©j√† assez bon.  Pour v√©rifier cette hypoth√®se, nous avons construit une matrice d'erreur, prenant 0,55 comme valeur seuil pour la probabilit√©.  C'est-√†-dire  si cette valeur est d√©pass√©e en probabilit√© pour la couleur correspondante, nous supposons que la machine est peinte dans cette couleur.  Malgr√© le fait que le seuil est choisi suffisamment bas, on peut voir des erreurs typiques dans la d√©termination de la couleur de la voiture et tirer des conclusions. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/5s/5q/9t/5s5q9tyt_8nbe4c0vb-mgxtoday.png" alt="image"></div><br>  <i>Tableau des r√©sultats de la reconnaissance des couleurs pour les voitures en 8e classe</i> <br><br>  Il suffit de regarder les lignes correspondant aux couleurs vertes ou roses pour vous assurer que le mod√®le est loin d'√™tre parfait.  Sur la question de savoir pourquoi, avec une grande valeur m√©trique, un r√©sultat aussi √©trange et infructueux est obtenu, nous reviendrons et indiquerons imm√©diatement: lorsque l'on consid√®re seulement 8 classes, un grand nombre de couleurs tombent dans les classes "blanc" et "noir", donc un tel r√©sultat . <br><br>  Par cons√©quent, nous allons passer √† l'espace colorim√©trique LAB et y mener des recherches. <br><table><tbody><tr><th>  Fonction d'activation </th><th>  T√¢che √† √©tiquettes multiples </th><th>  ROC AUC </th></tr><tr><td>  softmax </td><td>  - </td><td>  0,915 </td></tr><tr><td>  sigmo√Øde </td><td>  ‚úì </td><td>  0,846 </td></tr></tbody></table>  <i>Tableau des r√©sultats de la reconnaissance des couleurs de la machine dans le probl√®me de la classe 810</i> <br><br>  Le r√©sultat est moindre, ce qui est logique, car le nombre de classes a augment√© de deux ordres de grandeur.  Prenant le r√©sultat sigmo√Øde comme point de d√©part, nous avons essay√© d'am√©liorer notre mod√®le. <br><br><h2>  <font color="#0071c5">LAB: exp√©riences avec diff√©rents poids</font> </h2><br>  Avant cela, toutes les exp√©riences ont √©t√© effectu√©es avec des poids unitaires dans la fonction de <i>perte</i> ( <i>perte</i> ): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ox/u5/af/oxu5afajo-qngyg1t6tdml1sdxo.png" alt="image"></div><br><br>  Ici, GT est la v√©rit√© fondamentale, W est les poids. <br><br>  Vous pouvez entrer une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">distance dans l'</a> espace colorim√©trique LAB.  Disons que nous avons une unit√© en GT.  Il correspond alors √† un parall√©l√©pip√®de rectangulaire dans l'espace colorim√©trique LAB.  Ce parall√©l√©pip√®de (plus pr√©cis√©ment, son centre) est retir√© √† une distance diff√©rente de tous les autres parall√©l√©pip√®des (encore une fois, leurs centres).  En fonction de cette distance, vous pouvez exp√©rimenter avec les √©chelles suivantes: <br><br>  a) Z√©ro √† la place d'une unit√© en GT, et en s'√©loignant d'elle - une augmentation des poids; <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zs/in/ql/zsinql6ut3hucnr3ytrvkc0xxqi.png" alt="image"></div><br><br>  b) Inversement, √† la place d'une unit√© en GT, elle en est une; lorsqu'elle est retir√©e, c'est une baisse de poids; <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8v/-l/oo/8v-looj6mqsgrtzvz9elevykcak.png" alt="image"></div><br><br>  c) Option a) plus un petit additif gaussien d'une amplitude de ¬Ω √† la place d'une unit√© en GT; <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yx/qy/ac/yxqyac6ks3cvy10qh6lilp4ib0q.png" alt="image"></div><br><br>  d) Option a) plus un petit additif gaussien d'une amplitude de 1 √† la place d'une unit√© en GT; <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ep/0s/01/ep0s01rau7n0oiak71zjkp5vhxg.png" alt="image"></div><br><br>  e) Option b) avec un petit additif √† une distance maximale de l'unit√© en GT. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ff/9q/ft/ff9qftnoidusfhdhz1p9jjoqwi0.png" alt="image"></div><br><br>  La derni√®re version des √©chelles avec lesquelles nous avons men√© des exp√©riences est, comme nous l'avons appel√©, le triple Gauss, √† savoir trois distributions normales avec des centres √† la place des unit√©s dans le GT, ainsi qu'√† la plus grande distance d'eux. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qk/jr/kb/qkjrkbhyxschjibmya3xt3hik9y.png" alt="image"></div><br>  <i>Trois distributions normales centr√©es sur les unit√©s du GT et √† la plus grande distance de celles-ci</i> <br><br>  Il faudra l'expliquer plus en d√©tail.  Vous pouvez s√©lectionner les deux parall√©l√©pip√®des les plus √©loign√©s et, par cons√©quent, les classes, et les comparer dans l'√©loignement de l'original.  Pour la classe correspondant √† la lointaine, l'amplitude de distribution est fix√©e √† 0,8 et pour la seconde, elle est m fois plus petite, o√π m est le rapport de la distance de la source √† la lointaine √† la distance entre la source et la proche. <br><br>  Les r√©sultats sont pr√©sent√©s dans le tableau.  En raison du fait que dans les √©chelles de l'option a), il n'y avait aucun poids - juste pour les unit√©s en GT, le r√©sultat sur celles-ci √©tait encore pire que le point de d√©part, car le r√©seau ne tenait pas compte des d√©finitions de couleurs r√©ussies, apprenant pire.  Les variantes des poids b) et e) co√Øncidaient pratiquement, donc le r√©sultat sur elles co√Øncidait.  La plus forte augmentation de points de pourcentage par rapport au r√©sultat initial a √©t√© montr√©e par la variante des poids f) - triple gauss. <br><table><tbody><tr><th>  Fonction d'activation </th><th>  Nombre de cours </th><th>  Type de poids </th><th>  ROC AUC </th></tr><tr><td rowspan="5">  sigmo√Øde </td><td rowspan="5">  810 </td><td>  a) </td><td>  0,844 </td></tr><tr><td>  b), e) </td><td>  0,848 </td></tr><tr><td>  c) </td><td>  0,888 </td></tr><tr><td>  d) </td><td>  0,879 </td></tr><tr><td>  f) </td><td>  0,909 </td></tr></tbody></table>  <i>R√©sultats de la reconnaissance des couleurs des machines en probl√®me de classe 810 avec diff√©rentes options de poids</i> <br><br><h2>  <font color="#0071c5">LAB: exp√©rimenter de nouveaux labels</font> </h2><br>  Nous avons donc men√© des exp√©riences avec diff√©rents poids de <i>perte</i> .  Ensuite, nous avons d√©cid√© d'essayer de laisser les poids comme un, et de changer les √©tiquettes, qui sont transf√©r√©es √† la fonction de perte et utilis√©es pour optimiser le r√©seau.  Si avant cela les √©tiquettes co√Øncidaient avec GT, maintenant ils ont d√©cid√© de r√©utiliser les distributions gaussiennes avec des centres √† la place des unit√©s dans GT: <br><br>  La motivation de cette d√©cision est la suivante.  Le fait est qu'avec les √©tiquettes ordinaires, toutes les voitures des ensembles de donn√©es se r√©partissent en un nombre fixe de classes, moins de 810, de sorte que le r√©seau apprend √† d√©terminer la couleur des voitures de ces classes uniquement.  Avec de nouvelles √©tiquettes, les valeurs non nulles tombent dans toutes les classes, et nous pouvons nous attendre √† une augmentation de la pr√©cision de la d√©termination de la couleur de la voiture.  Nous avons exp√©riment√© deux sigma (√©carts-types) pour les distributions gaussiennes ci-dessus: 41,9 et 20,9.  Pourquoi  Le premier sigma est choisi comme suit: la distance minimale entre les classes (28) est prise et le sigma est d√©termin√© √† partir de la condition que la distribution diminue deux fois dans la classe adjacente au GT'noye.  Et le deuxi√®me sigma est juste deux fois plus petit que le premier. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jk/z4/xq/jkz4xqdkl-nwecfnttwzuhwgyuo.png" alt="image"></div><br>  <i>R√©partition des voitures de jeux de donn√©es d'entra√Ænement par classes avec diff√©rentes √©tiquettes en perte</i> <br><br>  En effet, il a √©t√© possible d'am√©liorer encore le r√©sultat en utilisant une telle astuce, comme le montre le tableau.  En cons√©quence, la pr√©cision de la d√©termination a atteint 0,955! <br><table><tbody><tr><th>  Fonction d'activation </th><th>  Nombre de cours </th><th>  Type d'√©tiquette </th><th>  Type de poids </th><th>  ROC AUC </th></tr><tr><td rowspan="4">  sigmo√Øde </td><td rowspan="4">  810 </td><td>  habituel </td><td>  ceux </td><td>  0,846 </td></tr><tr><td>  habituel </td><td>  trois gauss </td><td>  0,909 </td></tr><tr><td>  nouveau, œÉ <sub>1</sub> </td><td rowspan="2">  trois gauss </td><td>  0,955 </td></tr><tr><td>  nouveau, œÉ <sub>2</sub> </td><td>  0,946 </td></tr></tbody></table>  <i>R√©sultats de la reconnaissance des couleurs pour les machines du probl√®me de la classe 810: avec des √©tiquettes et des poids unitaires ordinaires, avec des √©tiquettes et des poids ordinaires sous forme de triple Gauss, avec de nouvelles √©tiquettes et des poids unitaires</i> <br><br><h2>  <font color="#0071c5">LAB: 81</font> </h2><br>  Si nous parlons d'exp√©riences infructueuses, nous devons mentionner la tentative de former un r√©seau avec 81 classes et un param√®tre constant L. Nous avons remarqu√© lors des exp√©riences pr√©c√©dentes que la luminosit√© est d√©termin√©e par le r√©seau assez pr√©cis√©ment, et nous avons d√©cid√© de ne former que les param√®tres a et b (donc appel√© les deux autres coordonn√©es dans LAB).  Malheureusement, malgr√© le fait que le r√©seau a pu parfaitement s'entra√Æner dans l'avion, montrant une plus grande valeur en termes de m√©trique, l'id√©e de d√©finir le param√®tre L √† la sortie du r√©seau comme moyenne pour la <i>bo√Æte de d√©limitation</i> de la <i>voiture</i> s'est √©cras√© et la couleur r√©elle et ainsi d√©finie √©tait tr√®s diff√©rente. <br><br><h2>  <font color="#0071c5">Comparaison avec la r√©solution d'un probl√®me sans utiliser de r√©seaux de neurones</font> </h2><br>  Revenons maintenant au tout d√©but et comparons ce qui s'est pass√© avec nous avec la reconnaissance de la couleur de la voiture sans utiliser de r√©seaux de neurones. <br>  Les r√©sultats sont pr√©sent√©s dans les figures ci-dessous.  On peut voir que le pic est devenu 3 fois plus, et le nombre de voitures avec une grande erreur entre le vrai et une certaine couleur a consid√©rablement diminu√©. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/l-/ir/o0/l-iro02-06n4ugotazhlmumisii.png" alt="image"></div><br>  <i>La r√©partition de la part des voitures avec la valeur d'erreur L2 dans l'espace LAB entre la zone de d√©limitation de la couleur de couleur d√©finie comme la m√©diane et la couleur de la zone de d√©limitation de la voiture de la valeur de cette erreur</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/6j/wr/b5/6jwrb5imhzh2rbvnaxrgzedf0p8.png" alt="image"></div><br>  <i>Distribution de la part des voitures avec la valeur d'erreur L2 dans l'espace LAB entre la couleur √† la sortie du r√©seau de neurones et la couleur du cadre de d√©limitation de la voiture de la valeur de cette erreur</i> <br><br><h2>  <font color="#0071c5">Des exemples</font> </h2><br>  Voici des exemples de reconnaissance des couleurs de la voiture.  La premi√®re est que la machine noire (un cas typique) est reconnue comme noire, et la distance dans l'espace LAB entre la vraie couleur et la couleur sp√©cifique (18.16) est inf√©rieure √† la distance minimale entre les classes (28).  Dans la deuxi√®me figure, le r√©seau a pu non seulement d√©terminer que la voiture √©tait √©clair√©e (il y a une forte probabilit√© qui correspond √† l'une des classes de couleurs blanches), mais aussi sa vraie couleur (argent).  Cependant, la machine de la figure suivante, √©galement √©clair√©e, n'a pas √©t√© d√©tect√©e par le r√©seau en rouge.  Le r√©seau n'a pas pu d√©terminer la couleur de la voiture indiqu√©e dans la figure ci-dessous, ce qui d√©coule du fait que les probabilit√©s pour toutes les couleurs sont trop faibles. <br><br>  √Ä bien des √©gards, la t√¢che √©tait due √† la n√©cessit√© de reconna√Ætre les voitures multicolores.  La derni√®re figure repr√©sente une voiture bicolore noire et jaune.  Le r√©seau √©tait le plus susceptible de reconna√Ætre la couleur noire, qui est probablement due √† la pr√©dominance de machines de cette couleur et de couleurs similaires dans l'ensemble de donn√©es de formation, et la couleur jaune, qui est presque vraie, est entr√©e dans le top 3. <br><table><tbody><tr><th width="200"><img src="https://habrastorage.org/webt/ro/l7/re/rol7re300p2hf30rtsvaiyfbi20.png" align="right" alt="image"></th><th><img src="https://habrastorage.org/webt/n8/ig/cl/n8igclilt4ep3qlmipvt9rmbt5w.png" align="left" alt="image"></th></tr></tbody></table><table><tbody><tr><th width="200"><img src="https://habrastorage.org/webt/o5/pf/fj/o5pffjzvnat7mouv8yhf-kuzs3g.png" align="right" alt="image"></th><th><img src="https://habrastorage.org/webt/vn/ml/wa/vnmlwawbhys7tkvrwquwc6bttsw.png" align="left" alt="image"></th></tr></tbody></table><table><tbody><tr><th width="200"><img src="https://habrastorage.org/webt/jh/mi/hs/jhmihs9rnoqounq2ostwq8iz1q0.png" align="right" alt="image"></th><th><img src="https://habrastorage.org/webt/pv/sg/ft/pvsgftesuo5lmmy_gvuzsj-rg4o.png" align="left" alt="image"></th></tr></tbody></table><table><tbody><tr><th width="200"><img src="https://habrastorage.org/webt/f7/uj/p3/f7ujp3uavgqz6aobfa_hbk6xpos.png" align="right" alt="image"></th><th><img src="https://habrastorage.org/webt/0c/mo/l1/0cmol16qj3ghtsc49jqag2dy8yc.png" align="left" alt="image"></th></tr></tbody></table><table><tbody><tr><th width="200"><img src="https://habrastorage.org/webt/dd/hi/th/ddhithwwjdez_q6sr8xa9cwcs-i.png" align="right" alt="image"></th><th><img src="https://habrastorage.org/webt/gg/hf/px/gghfpxgurqddwvldmop4t1zszfo.png" align="left" alt="image"></th></tr></tbody></table><br><h2>  <font color="#0071c5">Courbe ROC: visualisation et probl√®mes</font> </h2><br>  Donc, √† la sortie, nous avons obtenu un r√©sultat m√©trique assez √©lev√©.  La figure suivante montre les courbes ROC pour r√©soudre un probl√®me avec 8 classes et pour un probl√®me avec 810 classes, ainsi que des solutions sans utiliser de r√©seaux de neurones.  On peut voir que le r√©sultat est l√©g√®rement diff√©rent de celui qui a √©t√© √©crit plus t√¥t.  Les r√©sultats pr√©c√©dents ont √©t√© obtenus en utilisant TensorFlow, les graphiques ci-dessous ont √©t√© obtenus en utilisant le package scikit-learn. <br><table><tbody><tr><th><div style="text-align:center;"><img src="https://habrastorage.org/webt/yq/zm/ib/yqzmib4v_0jaco5torqqvu0fdmo.png" alt="image"></div></th><th><div style="text-align:center;"><img src="https://habrastorage.org/webt/k0/nb/gn/k0nbgn7ows7rcx-q3so38ugg_dw.png" alt="image"></div></th></tr></tbody></table>  <i>Courbe ROC pour plusieurs options pour r√©soudre le probl√®me.</i>  <i>√Ä droite, le coin sup√©rieur gauche du graphique de gauche</i> <br><br>  Vous pouvez prendre n'importe quel nombre fixe comme valeur de seuil (par exemple, Tensorflow, lorsque vous d√©finissez le param√®tre correspondant sur 50, prend le m√™me nombre de seuils de 0 √† 1 √† intervalles √©gaux), vous pouvez utiliser les valeurs √† la sortie du r√©seau, ou vous pouvez les limiter par le bas pour ne pas tenir compte des valeurs de l'ordre de 10 <sup>-4</sup> par exemple.  Le r√©sultat de cette derni√®re approche est illustr√© dans la figure suivante. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fb/2c/b2/fb2cb2dxnaxvjjtywmlbdb-xs54.png" alt="image"></div><br>  <i>Courbe ROC pour plusieurs options pour r√©soudre le probl√®me avec un seuil de 10 <sup>-4</sup></i> <br><br>  On peut voir que toutes les courbes correspondant √† la solution du probl√®me en utilisant des r√©seaux de neurones sont caract√©ristiquement meilleures (sup√©rieures) que la solution au probl√®me sans elles, mais vous ne pouvez pas choisir la meilleure courbe entre les premi√®res.  Selon le seuil choisi par l'utilisateur, diff√©rentes courbes correspondront √† diff√©rentes solutions optimales au probl√®me.  Par cons√©quent, d'une part, nous avons trouv√© une approche qui nous permet de d√©terminer avec pr√©cision la couleur de la machine et montre une m√©trique √©lev√©e, d'autre part, nous avons montr√© que la limite n'a pas encore √©t√© atteinte et que la m√©trique de la zone sous la courbe ROC a ses inconv√©nients. <br><br>  Pr√™t √† r√©pondre aux questions et √† √©couter les commentaires dans les commentaires. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr422689/">https://habr.com/ru/post/fr422689/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr422679/index.html">Probl√®mes imaginaires - la raison d'un mauvais logiciel</a></li>
<li><a href="../fr422681/index.html">Int√©gration SAP et Python ou comment r√©cup√©rer des donn√©es de SAP plus facilement</a></li>
<li><a href="../fr422683/index.html">Aux √âtats-Unis, deux commer√ßants ont cr√©√© une fausse soci√©t√© de courtage pour voler de l'argent √† des investisseurs novices</a></li>
<li><a href="../fr422685/index.html">Smart Watch Samsung Galaxy Watch: mise √† niveau d'Android Wear OS vers Tizen OS - exp√©rience personnelle</a></li>
<li><a href="../fr422687/index.html">Messagers en danger</a></li>
<li><a href="../fr422691/index.html">La cam√©ra hybride et le lidar am√©liorent les capacit√©s des robots, compl√©tant les informations sur le monde ext√©rieur</a></li>
<li><a href="../fr422693/index.html">√âquipe de plugins pour configurer les composants JavaFX dans une application de bureau</a></li>
<li><a href="../fr422697/index.html">Webpack 4 et division du fichier de configuration en modules</a></li>
<li><a href="../fr422699/index.html">Une √©chappatoire ferm√©e confirme l'irr√©alit√© du monde quantique</a></li>
<li><a href="../fr422701/index.html">Deep Learning et OpenVINO Toolkit. Poser une question √† un expert Intel</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>