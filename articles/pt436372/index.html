<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üàµ üë©üèº‚Äçü§ù‚Äçüë®üèæ üëß Plug-in isom√©trico para Unity3D üóÇÔ∏è üêê ‚óªÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="√â uma hist√≥ria de como escrever um plugin para a Unity Asset Store , resolver um problema isom√©trico bem conhecido nos jogos e ganhar um pouco de dinh...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Plug-in isom√©trico para Unity3D</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/436372/"><img src="https://habrastorage.org/files/032/000/6f4/0320006f472344e782f536c293e3099d.png"><br><p>  √â uma hist√≥ria de como escrever um plugin para a <strong>Unity Asset Store</strong> , resolver um problema isom√©trico bem conhecido nos jogos e ganhar um pouco de dinheiro com isso, al√©m de entender como o editor do Unity √© expans√≠vel.  Imagens, c√≥digo, gr√°ficos e pensamentos dentro. </p><a name="habracut"></a><br><h2 id="prologue">  Pr√≥logo </h2><br><p> Ent√£o, foi uma noite em que descobri que n√£o havia praticamente nada a fazer.  O pr√≥ximo ano n√£o foi realmente promissor na minha vida profissional (embora diferente da pessoal, mas essa √© outra hist√≥ria).  De qualquer forma, tive a ideia de escrever algo divertido para os velhos tempos, que seria bastante pessoal, algo por conta pr√≥pria, mas ainda teria uma pequena vantagem comercial (eu gosto dessa sensa√ß√£o calorosa quando seu projeto √© interessante para outra pessoa, exceto para o seu empregador).  E tudo isso andou de m√£os dadas com o fato de eu ter esperado muito tempo para verificar as possibilidades da extens√£o do editor do Unity e para ver se h√° alguma coisa boa em sua plataforma para vender as extens√µes do pr√≥prio mecanismo. </p><br><p>  Dediquei um dia a estudar a Asset Store: modelos, scripts, integra√ß√µes com v√°rios servi√ßos.  E, primeiro, parecia que tudo j√° havia sido escrito e integrado, tendo at√© v√°rias op√ß√µes de diferentes n√≠veis de qualidade e detalhe, tanto quanto pre√ßos e suporte.  Ent√£o, imediatamente reduzi-o a: </p><br><ul><li>  apenas c√≥digo (afinal, sou programador) </li><li>  Apenas 2D (j√° que eu adoro 2D e eles fizeram um suporte decente e pronto para isso no Unity) </li></ul><br><p>  E ent√£o me lembrei de quantos cactos eu comi e quantos ratos morreram quando est√°vamos fazendo um jogo isom√©trico antes.  Voc√™ n√£o vai acreditar quanto tempo perdemos na busca de solu√ß√µes vi√°veis ‚Äã‚Äãe quantas c√≥pias quebramos na tentativa de resolver essa isometria e desenh√°-la.  Ent√£o, lutando para manter minhas m√£os paradas, procurei por palavras-chave diferentes e n√£o muito-chave e n√£o consegui encontrar nada al√©m de uma enorme pilha de arte isom√©trica, at√© que finalmente decidi fazer um plugin isom√©trico do zero. </p><br><h2 id="setting-the-goals">  Estabelecendo as metas </h2><br><p>  A primeira que eu preciso foi descrever resumidamente quais problemas esse plugin deveria resolver e que uso o desenvolvedor de jogos isom√©tricos faria.  Portanto, os problemas de isometria s√£o os seguintes: </p><br><ul><li>  classifica√ß√£o de objetos por dist√¢ncia, a fim de desenh√°-los adequadamente </li><li>  extens√£o para cria√ß√£o, posicionamento e deslocamento de objetos isom√©tricos no editor </li></ul><br><p>  Assim, com os principais objetivos da primeira vers√£o formulada, estabeleci um prazo de 2-3 dias para a primeira vers√£o preliminar.  Portanto, n√£o pode ser adiado, como o entusiasmo √© uma coisa fr√°gil e, se voc√™ n√£o tem algo pronto nos primeiros dias, h√° uma grande chance de estrag√°-lo.  E as f√©rias de Ano Novo n√£o s√£o t√£o longas quanto parecem, mesmo na R√∫ssia, e eu queria lan√ßar a primeira vers√£o em dez dias. </p><br><h2 id="sorting">  Classifica√ß√£o </h2><br><p>  Para resumir, a isometria √© uma tentativa feita por sprites 2D de se parecer com modelos 3D.  Isso, √© claro, resulta em dezenas de problemas.  O principal √© que os sprites devem ser classificados na ordem em que foram desenhados para evitar problemas com sobreposi√ß√£o m√∫tua. </p><br><img src="https://habrastorage.org/files/60f/22b/db9/60f22bdb9ed3434888232416258f4b37.png"><br><blockquote>  <em>Na captura de tela, voc√™ pode ver como √© o sprite verde que √© desenhado primeiro (2,1) e depois o azul (1,1)</em> </blockquote><br><img src="https://habrastorage.org/files/9ba/a39/c6c/9baa39c6cd3b4584a57bbf1be169c050.png"><br><blockquote>  <em>A captura de tela mostra a classifica√ß√£o incorreta quando o sprite azul √© desenhado primeiro</em> </blockquote><p>  Nesse caso simples, a classifica√ß√£o n√£o ser√° um problema e haver√° op√ß√µes, por exemplo: </p><br><ul><li>  ordenando pela posi√ß√£o de Y na tela, que √© * <em>(isoX + isoY)</em> 0,5 + isoZ ** </li><li>  desenho da c√©lula de grade isom√©trica mais remota da esquerda para a direita, de cima para baixo <strong>[(3,3), (2,3), (3,2), (1,3), (2,2), (3, 1), ...]</strong> </li><li>  e um monte de outras maneiras interessantes e n√£o muito interessantes </li></ul><br><p>  Todos eles s√£o muito bons, r√°pidos e funcionais, mas apenas no caso de objetos ou colunas unicelulares estendidos na dire√ß√£o isoZ :) Afinal, eu estava interessado em uma solu√ß√£o mais comum que funcionaria para os objetos estendidos na dire√ß√£o de uma coordenada, ou mesmo as "cercas" que n√£o t√™m absolutamente nenhuma largura, mas s√£o estendidas na mesma dire√ß√£o que a altura necess√°ria. </p><br><img src="https://habrastorage.org/files/396/376/23d/39637623d1c147478ef0223501a0d240.png"><br><blockquote>  <em>A captura de tela mostra a maneira correta de classificar objetos estendidos <strong>3x1</strong> e <strong>1x3</strong> com "cercas" medindo <strong>3x0</strong> e <strong>0x3</strong></em> </blockquote><p>  E √© a√≠ que nossos problemas come√ßam e nos colocam no lugar onde precisamos decidir o caminho a seguir: </p><br><ul><li><p>  divida os objetos "multicelulares" em objetos "unicelulares", ou seja, para cort√°-lo verticalmente e, em seguida, classificar as listras surgidas </p><br></li><li><p>  pense no novo m√©todo de classifica√ß√£o, mais complicado e interessante </p><br></li></ul><br><p>  Eu escolhi a segunda op√ß√£o, n√£o tendo nenhum desejo particular de entrar no processamento complicado de cada objeto, no corte (mesmo autom√°tico) e na abordagem especial da l√≥gica.  Para o registro, eles usaram o primeiro caminho em alguns jogos famosos como <strong>Fallout 1</strong> e <strong>Fallout 2</strong> .  Voc√™ pode realmente ver essas tiras se entrar nos dados dos jogos. </p><br><p>  Portanto, a segunda op√ß√£o n√£o implica nenhum crit√©rio de classifica√ß√£o.  Isso significa que n√£o existe um valor pr√©-calculado pelo qual voc√™ possa classificar objetos.  Se voc√™ n√£o acredita em mim (e acho que muitas pessoas que nunca trabalharam com isometria n√£o), pegue um peda√ßo de papel e desenhe pequenos objetos medindo <strong>2x8</strong> e, por exemplo, <strong>2x2</strong> .  Se voc√™, de alguma forma, conseguir descobrir um valor para o c√°lculo de sua profundidade e classifica√ß√£o - basta adicionar um objeto <strong>8x2</strong> e tentar classific√°-los em posi√ß√µes diferentes entre si. </p><br><p>  Portanto, n√£o existe esse valor, mas ainda podemos usar depend√™ncias entre eles (grosso modo, qual deles se sobrep√µe) para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">classifica√ß√£o topol√≥gica</a> .  Podemos calcular as depend√™ncias dos objetos usando proje√ß√µes de coordenadas isom√©tricas no eixo isom√©trico. </p><br><img src="https://habrastorage.org/files/db0/1cd/835/db01cd8359494b35aaee399e197c972e.png"><br><blockquote>  <em>A captura de tela mostra o cubo azul que depende do vermelho</em> </blockquote><br><img src="https://habrastorage.org/files/eb3/af1/0d0/eb3af10d0cf04c6ba48a481a0b039f3c.png"><br><blockquote>  <em>A captura de tela mostra o cubo verde com depend√™ncia do azul</em> </blockquote><p>  Um pseudoc√≥digo para determina√ß√£o de depend√™ncia para dois eixos (o mesmo funciona com o eixo Z): </p><br><pre><code class="plaintext hljs">bool IsIsoObjectsDepends(IsoObject obj_a, IsoObject obj_b) { var obj_a_max_size = obj_a.position + obj_a.size; return obj_b.position.x &lt; obj_a_max_size.x &amp;&amp; obj_b.position.y &lt; obj_a_max_size.y; }</code> </pre> <br><p>  Com essa abordagem, constru√≠mos depend√™ncias entre todos os objetos, passando entre eles de forma recursiva e marcando a coordenada Z da exibi√ß√£o.  O m√©todo √© bastante universal e, mais importante, funciona.  Voc√™ pode ler a descri√ß√£o detalhada desse algoritmo, por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> .  Eles tamb√©m usam esse tipo de abordagem na popular biblioteca isom√©trica flash ( <a href="">as3isolib</a> ). </p><br><p>  E tudo foi √≥timo, exceto que a complexidade do tempo dessa abordagem √© <strong>O (N ^ 2),</strong> pois precisamos comparar todos os objetos com os outros para criar as depend√™ncias.  Eu deixei a otimiza√ß√£o para vers√µes posteriores, depois de adicionar apenas uma prorroga√ß√£o lenta, para que nada fosse classificado at√© que algo se movesse.  Ent√£o, falaremos sobre otimiza√ß√£o um pouco mais tarde. </p><br><h2 id="editor-extension">  Extens√£o do editor </h2><br><p>  A partir de agora, eu tinha os seguintes objetivos: </p><br><ul><li>  a classifica√ß√£o dos objetos teve que funcionar no editor (n√£o apenas em um jogo) </li><li>  tinha que haver outro tipo de Gizmos-Arrow (setas para mover objetos) </li><li>  opcionalmente, haveria um alinhamento com blocos quando o objeto √© movido </li><li>  os tamanhos dos ladrilhos seriam aplicados e definidos automaticamente no inspetor isom√©trico do mundo </li><li>  Objetos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">AABB</a> s√£o desenhados de acordo com seus tamanhos isom√©tricos </li><li>  sa√≠da de coordenadas isom√©tricas no inspetor de objetos, alterando a posi√ß√£o em que mudar√≠amos a posi√ß√£o do objeto no mundo do jogo </li></ul><br><p>  E todos esses objetivos foram alcan√ßados.  O Unity realmente permite expandir seu editor significativamente.  Voc√™ pode adicionar novas guias, janelas, bot√µes, novos campos no inspetor de objetos.  Se desejar, voc√™ pode at√© criar um inspetor personalizado para um componente do tipo exato de que precisa.  Voc√™ tamb√©m pode enviar informa√ß√µes adicionais na janela do editor (no meu caso, nos objetos AABB) e substituir os aparelhos de movimenta√ß√£o padr√£o de objetos tamb√©m.  O problema de classificar dentro do editor foi resolvido por meio dessa tag m√°gica <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ExecuteInEditMode</a> , que permite executar componentes do objeto no modo editor, ou seja, da mesma maneira que em um jogo. </p><br><p>  Tudo isso foi feito, √© claro, n√£o sem dificuldades e truques de todos os tipos, mas n√£o havia nenhum problema em que eu passasse mais de duas horas (o Google, f√≥runs e comunidades certamente me ajudaram a resolver todos os problemas surgidos que n√£o foram mencionados na documenta√ß√£o). </p><br><img src="https://habrastorage.org/files/df6/ae0/2ae/df6ae02aec294ca28d9a6ffcf1b81382.png"><br><blockquote>  <em>A captura de tela mostra meus aparelhos para objetos de movimento no mundo isom√©trico</em> </blockquote><br><h2 id="release">  Lan√ßamento </h2><br><p>  Ent√£o, eu preparei a primeira vers√£o, tirei a captura de tela.  Eu at√© desenhei um √≠cone e escrevi uma descri√ß√£o.  Est√° na hora.  Ent√£o, defino um pre√ßo nominal de US $ 5, carrego o plug-in na loja e espero que seja aprovado pelo Unity.  Eu n√£o pensei muito sobre o pre√ßo, j√° que realmente n√£o queria ganhar muito dinheiro ainda.  Meu objetivo era descobrir se existe uma demanda geral e, se houver, gostaria de estimar.  Tamb√©m queria ajudar os desenvolvedores de jogos isom√©tricos que de alguma forma acabavam absolutamente privados de oportunidades e acr√©scimos. </p><br><p>  Em cinco dias bastante dolorosos (passei quase o mesmo tempo escrevendo a primeira vers√£o, mas sabia o que estava fazendo, sem mais pensar e pensar demais, o que me proporcionou maior velocidade em compara√ß√£o com as pessoas que come√ßaram a trabalhar com isometria) Eu recebi uma resposta da Unity dizendo que o plug-in foi aprovado e eu j√° podia v√™-lo na loja, assim como suas zero (at√© agora) vendas.  Ele fez check-in no f√≥rum local, incorporou o Google Analytics na p√°gina do plug-in na loja e me preparou para esperar a grama crescer. </p><br><p>  N√£o demorou muito tempo antes das primeiras vendas, assim como surgiram feedbacks no f√≥rum e na loja.  Nos dias restantes de 12 de janeiro, c√≥pias do meu plugin foram vendidas, o que eu considerei como um sinal do interesse do p√∫blico e decidi continuar. </p><br><h2 id="optimization">  Otimiza√ß√£o </h2><br><p>  Ent√£o, eu estava descontente com duas coisas: </p><br><ul><li>  Complexidade temporal da classifica√ß√£o - O (N ^ 2) </li><li>  Problemas com coleta de lixo e desempenho geral </li></ul><br><h3 id="algorithm">  Algoritmo </h3><br><p>  Tendo 100 objetos e O (N ^ 2), eu tinha 10.000 itera√ß√µes para fazer apenas para encontrar depend√™ncias, e tamb√©m teria que passar por todos eles e marcar o display Z para classificar.  Deveria haver alguma solu√ß√£o para isso.  Ent√£o, eu tentei um grande n√∫mero de op√ß√µes, n√£o conseguia dormir pensando sobre este problema.  De qualquer forma, n√£o vou falar sobre todos os m√©todos que tentei, mas descreverei o que achei melhor at√© agora. </p><br><p>  Primeiro, √© claro, classificamos apenas objetos vis√≠veis.  O que isso significa √© que precisamos constantemente saber o que est√° em nosso caminho.  Se houver algum objeto novo, precisamos adicion√°-lo no processo de classifica√ß√£o e, se um dos antigos se for - ignor√°-lo.  Agora, o Unity n√£o permite determinar a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Caixa delimitadora</a> do objeto junto com seus filhos na √°rvore da cena.  Passar por cima das crian√ßas (sempre, a prop√≥sito, j√° que elas podem ser adicionadas e removidas) n√£o funcionaria - muito devagar.  Tamb√©m n√£o podemos usar o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">OnBecameVisible</a> e outros eventos, porque eles funcionam apenas para objetos pai.  Mas podemos obter todos os componentes do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Renderer a</a> partir do objeto necess√°rio e de seus filhos.  Claro, isso n√£o parece ser a nossa melhor op√ß√£o, mas n√£o consegui encontrar outra maneira, a mesma universal e aceit√°vel pelo desempenho. </p><br><pre> <code class="plaintext hljs">List&lt;Renderer&gt; _tmpRenderers = new List&lt;Renderer&gt;(); bool IsIsoObjectVisible(IsoObject iso_object) { iso_object.GetComponentsInChildren&lt;Renderer&gt;(_tmpRenderers); for ( var i = 0; i &lt; _tmpRenderers.Count; ++i ) { if ( _tmpRenderers[i].isVisible ) { return true; } } return false; }</code> </pre> <br><p>  <em>H√° um pequeno truque ao usar a fun√ß√£o <strong>GetComponentsInChildren</strong> que permite obter componentes sem aloca√ß√µes no buffer necess√°rio, diferente de outro que retorna uma nova matriz de componentes</em> </p><br><p>  Em segundo lugar, eu ainda tinha que fazer algo sobre <strong>O (N ^ 2)</strong> .  Eu tentei v√°rias t√©cnicas de divis√£o de espa√ßo antes de parar em uma grade bidimensional simples no espa√ßo de exibi√ß√£o onde projeto meus objetos isom√©tricos.  Cada setor cont√©m uma lista de objetos isom√©tricos que o atravessam.  Portanto, a ideia √© simples: se as proje√ß√µes dos objetos n√£o s√£o cruzadas, n√£o faz sentido construir depend√™ncias entre os objetos.  Em seguida, repassamos todos os objetos vis√≠veis e constru√≠mos depend√™ncias apenas nos setores em que √© necess√°rio, diminuindo a complexidade de tempo do algoritmo e aumentando o desempenho.  Calculamos o tamanho de cada setor como uma m√©dia entre os tamanhos de todos os objetos.  Achei o resultado mais do que satisfat√≥rio. </p><br><h3 id="general-performance">  Desempenho geral </h3><br><p>  Claro, eu poderia escrever um artigo separado sobre isso ... Ok, vamos tentar resumir isso.  Primeiro, estamos descontando os componentes (usamos o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">GetComponent</a> para encontr√°-los, o que n√£o √© r√°pido).  Eu recomendo a todos que se cuidem ao trabalhar com qualquer coisa relacionada ao <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Update</a> .  Voc√™ sempre deve ter em mente que isso acontece em todos os quadros, portanto, voc√™ deve ter muito cuidado.  H√° muitas coisas a serem lembradas, mas, no final, voc√™ conhece todas elas no criador de perfil incorporado.  Torna muito mais f√°cil memorizar e us√°-los :) </p><br><p>  Al√©m disso, voc√™ realmente entende a dor do coletor de lixo.  Precisa de desempenho superior?  Em seguida, esque√ßa qualquer coisa que possa alocar mem√≥ria, que em <strong>C #</strong> (especialmente no antigo compilador <strong>Mono</strong> ) pode ser feita por qualquer coisa, variando de <strong>foreach</strong> (!) A lambdas emergentes, sem falar no <strong>LINQ</strong> que agora √© proibido para voc√™, mesmo nos casos mais simples.  No final, em vez de <strong>C #</strong> com seu a√ß√∫car sint√°tico, voc√™ obt√©m uma apar√™ncia de <strong>C</strong> com capacidades rid√≠culas. </p><br><p>  Aqui vou dar alguns links sobre o t√≥pico que voc√™ pode achar √∫til: <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte1</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte2</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte3</a> . </p><br><h3 id="results">  Resultados </h3><br><p>  Eu nunca conheci algu√©m usando essa t√©cnica de otimiza√ß√£o antes, ent√£o fiquei particularmente feliz em ver os resultados.  E se nas primeiras vers√µes foram necess√°rios literalmente 50 objetos em movimento para o jogo transform√°-lo em uma apresenta√ß√£o de slides, agora funciona muito bem, mesmo quando h√° 800 objetos em um quadro: tudo est√° girando na velocidade m√°xima e reorganizando por apenas 3-6 ms, o que √© muito bom para esse n√∫mero de objetos em isometria.  Al√©m disso, ap√≥s a inicializa√ß√£o, quase n√£o alocamos mem√≥ria para um quadro :) </p><br><h2 id="further-opportunities">  Outras oportunidades </h2><br><p>  Depois de ler feedbacks e sugest√µes, alguns recursos foram adicionados nas vers√µes anteriores. </p><br><h3 id="2d3d-mixture">  Mistura 2D / 3D </h3><br><p>  A mistura de 2D e 3D em jogos isom√©tricos √© uma oportunidade interessante, que permite minimizar o desenho de diferentes op√ß√µes de movimento e rota√ß√µes (por exemplo, modelos 3D de personagens animados).  N√£o √© algo realmente dif√≠cil de fazer, mas requer integra√ß√£o dentro do sistema de classifica√ß√£o.  Tudo o que voc√™ precisa √© obter uma <strong>caixa delimitadora</strong> do modelo com todos os seus filhos e, em seguida, mover o modelo ao longo da exibi√ß√£o Z pela largura da caixa. </p><br><pre> <code class="plaintext hljs">Bounds IsoObject3DBounds(IsoObject iso_object) { var bounds = new Bounds(); iso_object.GetComponentsInChildren&lt;Renderer&gt;(_tmpRenderers); if ( _tmpRenderers.Count &gt; 0 ) { bounds = _tmpRenderers[0].bounds; for ( var i = 1; i &lt; _tmpRenderers.Count; ++i ) { bounds.Encapsulate(_tmpRenderers[i].bounds); } } return bounds; }</code> </pre> <br><p>  <em>esse √© um exemplo de como voc√™ pode obter o <strong>Bounding Box</strong> do modelo com todos os seus filhos</em> </p><br><img src="https://habrastorage.org/files/837/b52/c02/837b52c025b6485c95ede6c77a5b4ed3.gif"><br><blockquote>  <em>e √© assim que parece quando √© feito</em> </blockquote><br><h3 id="custom-isometric-settings">  Configura√ß√µes isom√©tricas personalizadas </h3><br><p>  Isso √© relativamente simples.  Pediram-me para possibilitar a defini√ß√£o do √¢ngulo isom√©trico, propor√ß√£o, altura do ladrilho.  Depois de sofrer alguma dor envolvida em matem√°tica, voc√™ obt√©m algo assim: </p><br><img src="https://habrastorage.org/files/02b/f56/35e/02bf5635e5df46778915d43caf2bd846.gif"><br><br><h3 id="physics">  F√≠sica </h3><br><p>  E aqui fica mais interessante.  Como a isometria simula o mundo 3D, a f√≠sica tamb√©m deve ser tridimensional, com altura e tudo mais.  Eu vim com esse truque fascinante.  Eu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">replico</a> todos os componentes da f√≠sica, como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Rigidbody</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Collider</a> e assim por diante, para o mundo isom√©trico.  De acordo com essas descri√ß√µes e configura√ß√µes, eu fa√ßo a c√≥pia do mundo tridimensional f√≠sico invis√≠vel usando o pr√≥prio mecanismo e o <strong>PhysX</strong> embutido.  Depois disso, pego os dados de simula√ß√£o calculados e consigo esses dados duplicados para o mundo isom√©trico.  Ent√£o fa√ßo o mesmo para simular eventos de colis√£o e acionamento. </p><br><img src="https://habrastorage.org/files/56c/c0b/199/56cc0b19987043bbb94baa257879b224.gif"><br><blockquote>  <em>O GIF de demonstra√ß√£o f√≠sica do conjunto de ferramentas</em> </blockquote><br><h2 id="epilogue-and-conclusions">  Ep√≠logo e conclus√µes </h2><br><p>  Depois de implementar todas as sugest√µes do f√≥rum, decidi aumentar o pre√ßo para 40 d√≥lares, para que n√£o parecesse mais um plugin barato com cinco linhas de c√≥digo :) Ficarei muito satisfeito em responder a perguntas e ou√ßa seus conselhos.  Como √© a primeira vez que escrevo algo sobre Habr, agrade√ßo todos os tipos de cr√≠ticas, obrigado!  E agora, algo que eu estava guardando por √∫ltimo, as estat√≠sticas de vendas do m√™s: </p><br><table border="1" width="200"><tbody><tr><th>  M√™s </th><th>  5 $ </th><th>  40 $ </th></tr><tr><td>  Janeiro </td><td>  12 </td><td>  0 0 </td></tr><tr><td>  Fevereiro </td><td>  22 </td><td>  0 0 </td></tr><tr><td>  Mar√ßo </td><td>  17 </td><td>  0 0 </td></tr><tr><td>  Abril </td><td>  9 </td><td>  0 0 </td></tr><tr><td>  Maio </td><td>  9 </td><td>  0 0 </td></tr><tr><td>  Junho </td><td>  9 </td><td>  0 0 </td></tr><tr><td>  Julho </td><td>  7 </td><td>  4 </td></tr><tr><td>  Agosto </td><td>  0 0 </td><td>  4 </td></tr><tr><td>  Setembro </td><td>  0 0 </td><td>  5 </td></tr></tbody></table><br><p>  Link da p√°gina da Unity Asset Store: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Isometric 2.5D Toolset</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt436372/">https://habr.com/ru/post/pt436372/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt436356/index.html">[Interessante por tr√°s da colina] Como paramos a depend√™ncia tecnol√≥gica?</a></li>
<li><a href="../pt436358/index.html">Por que os desenvolvedores seniores ensinam os alunos</a></li>
<li><a href="../pt436360/index.html">Preciso ir r√°pido: Criando velocidade no iOS. Parte 1</a></li>
<li><a href="../pt436364/index.html">O Liveprof mostrar√° quando e por que o desempenho do seu aplicativo PHP mudou</a></li>
<li><a href="../pt436370/index.html">Infraestrutura de chave p√∫blica Cadeia de certificados raiz X509 v.3</a></li>
<li><a href="../pt436374/index.html">Tend√™ncias de design da interface do usu√°rio e do UX 2019</a></li>
<li><a href="../pt436376/index.html">Vis√£o geral do rob√¥ todo-o-terreno EZ-Robot Roli Rover</a></li>
<li><a href="../pt436378/index.html">bobaos.pub - KNX TP / UART, Raspberry Pi e Redis</a></li>
<li><a href="../pt436380/index.html">In√≠cio r√°pido na impress√£o 3D: impressoras econ√¥micas para iniciantes ou tecnologia para as massas</a></li>
<li><a href="../pt436382/index.html">Antiguidades: dez anos de evolu√ß√£o do laptop usando o ThinkPad X301</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>