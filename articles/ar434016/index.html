<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐๐ป ๐ ุชุดุบูู ุงูุฃุฑุงูุจ (RabbitMQ) ูู ูุถุน "ุงูุจูุงุก ุนูู ููุฏ ุงูุญูุงุฉ ุจุฃู ุซูู" ๐ฉ๐ปโ๐ญ ๐จ๐ฝโโ๏ธ ๐ต๏ธ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="" ุงูุดุฑูุฉ " - ูุดุบู ุงูุงุชุตุงูุงุช PJSC "Megafon" 
 " Noda " ูู ุฎุงุฏู RabbitMQ. 
 " ุงููุชูุฉ " ูู ูุฒูุฌ ุ ูู ุญุงูุชูุง ุงูุซูุงุซุฉ ุ ูู ุนูุฏ RabbitMQ ููู. 
 " Contour " ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุชุดุบูู ุงูุฃุฑุงูุจ (RabbitMQ) ูู ูุถุน "ุงูุจูุงุก ุนูู ููุฏ ุงูุญูุงุฉ ุจุฃู ุซูู"</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/434016/" style=";text-align:right;direction:rtl">  " <b>ุงูุดุฑูุฉ</b> " - ูุดุบู ุงูุงุชุตุงูุงุช PJSC "Megafon" <br>  " <b>Noda</b> " ูู ุฎุงุฏู RabbitMQ. <br>  " <b>ุงููุชูุฉ</b> " ูู ูุฒูุฌ ุ ูู ุญุงูุชูุง ุงูุซูุงุซุฉ ุ ูู ุนูุฏ RabbitMQ ููู. <br>  " <b>Contour</b> " - ูุฌููุนุฉ ูู ูุฌููุนุงุช RabbitMQ ุ ููุงุนุฏ ุงูุนูู ุงูุชู ูุชู ุชุญุฏูุฏูุง ุนูู ุงูููุงุฒู ุฃูุงููู. <br>  " <b>ุงูููุงุฒู</b> " ุ " <b>hap</b> " - Haproxy - ุงูููุงุฒู ุงูุฐู ูุคุฏู ูุธููุฉ ุชุจุฏูู ุงูุญูู ุนูู ุงููุชู ุฏุงุฎู ุงูุญููุฉ.  ูุชู ุงุณุชุฎุฏุงู ุฒูุฌ ูู ุฎูุงุฏู Haproxy ุงูุชู ุชุนูู ุจุดูู ูุชูุงุฒ ููู ุญููุฉ. <br>  " <b>ุงููุธุงู ุงููุฑุนู</b> " - ูุงุดุฑ ู / ุฃู ูุณุชููู ุงูุฑุณุงุฆู ุงููุฑุณูุฉ ุนุจุฑ ุงูุฃุฑูุจ <br>  " <b>SYSTEM</b> " - ูุฌููุนุฉ ูู ุงูุฃูุธูุฉ ุงููุฑุนูุฉ ุ ููู ุนุจุงุฑุฉ ุนู ุญู ุจุฑูุฌู ูุงุญุฏ ููุฃุฌูุฒุฉ ุชุณุชุฎุฏูู ุงูุดุฑูุฉ ุ ูุชุชููุฒ ุจุงูุชูุฒูุน ูู ุฌููุน ุฃูุญุงุก ุฑูุณูุง ุ ูููู ูุน ุงูุนุฏูุฏ ูู ุงููุฑุงูุฒ ุญูุซ ุชุชุฏูู ุฌููุน ุงููุนูููุงุช ูุญูุซ ุชุฌุฑู ุงูุญุณุงุจุงุช ูุงูุญุณุงุจุงุช ุงูุฑุฆูุณูุฉ. <br>  <b>SYSTEM</b> - ูุธุงู ููุฒุน ุฌุบุฑุงููุง - ูู ุฎุงุจุงุฑููุณู ูููุงุฏูููุณุชูู ุฅูู ุณุงูุช ุจุทุฑุณุจุฑุบ ููุฑุงุณููุฏุงุฑ.  ูุนูุงุฑูุง ุ ูุฐู ูู ุงูุนุฏูุฏ ูู ููุงูุญ ุงููุฑูุฒูุฉ ุ ููุณููุง ุนูู ููุฒุงุช ุงููุธู ุงููุฑุนูุฉ ุงููุชุตูุฉ ุจูุง. <br><a name="habracut"></a><br><h3 style=";text-align:right;direction:rtl">  ูุง ูู ูููุฉ ุงูููู ูู ูุงูุน ุงูุงุชุตุงูุงุชุ </h3><br>  ุจุงุฎุชุตุงุฑ: ุชุชุจุน ุงุณุชุฌุงุจุฉ ุงูุฃูุธูุฉ ุงููุฑุนูุฉ ูุฅุฌุฑุงุกุงุช ูู ูุดุชุฑู ุ ูุงูุชู ุจุฏูุฑูุง ุชูุนูู ุงููุธู ุงููุฑุนูุฉ ุงูุฃุฎุฑู ุนู ุงูุฃุญุฏุงุซ ูุงูุชุบููุฑุงุช ุงููุงุญูุฉ.  ูุชู ุฅูุดุงุก ุงูุฑุณุงุฆู ูู ุฎูุงู ุฃู ุฅุฌุฑุงุกุงุช ูุน SYSTEM ุ ููุณ ููุท ูู ุงููุดุชุฑููู ุ ูููู ุฃูุถูุง ูู ุฌุงูุจ ููุธูู ุงูุดุฑูุฉ ููู ุงููุธู ุงููุฑุนูุฉ (ูุชู ุชูููุฐ ุนุฏุฏ ูุจูุฑ ุฌุฏูุง ูู ุงูููุงู ุชููุงุฆููุง). <br><br>  ููุฒุงุช ุงูููู ูู ุงูุงุชุตุงูุงุช: ูุจูุฑุฉ ุ ูุง ุฎุทุฃ ุ ุฏูู ูุจูุฑ ูู ุงูุจูุงูุงุช ุงููุชููุนุฉ ุงููููููุฉ ุนุจุฑ ุงูููู ุบูุฑ ุงููุชุฒุงูู. <br><br>  ุชุนูุด ุจุนุถ ุงูุฃูุธูุฉ ุงููุฑุนูุฉ ุนูู ูุฌููุนุงุช ูููุตูุฉ ุจุณุจุจ ุซูู ุชุฏููุงุช ุงูุฑุณุงุฆู - ุจุจุณุงุทุฉ ูุง ุชูุฌุฏ ููุงุฑุฏ ูุชุจููุฉ ุนูู ูุธุงู ุงููุฌููุนุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ ูุน ุชุฏูู ุงูุฑุณุงุฆู ูู 5-6 ุฃูู ุฑุณุงูุฉ ูู ุงูุซุงููุฉ ุ ูููู ุฃู ุชุตู ูููุฉ ุงูุจูุงูุงุช ุงููููููุฉ ุฅูู 170-190 ููุบุงุจุงูุช / ุซุงููุฉ.  ุจุงุณุชุฎุฏุงู ููู ุชุนุฑูู ุงูุชุญููู ูุฐุง ุ ุณุชุคุฏู ูุญุงููุฉ ุงููุจูุท ุนูู ุฃู ุดุฎุต ุขุฎุฑ ูู ูุฐู ุงููุฌููุนุฉ ุฅูู ุนูุงูุจ ูุญุฒูุฉ: ูุธุฑูุง ูุนุฏู ุชููุฑ ููุงุฑุฏ ูุงููุฉ ููุนุงูุฌุฉ ุฌููุน ุงูุจูุงูุงุช ูู ููุณ ุงูููุช ุ ุณูุจุฏุฃ ุงูุฃุฑูุจ ูู ุฏูุน ุงูุงุชุตุงูุงุช ุงููุงุฑุฏุฉ ุฅูู <b>ุงูุชุฏูู</b> - ุณุชุจุฏุฃ ุนูููุฉ ูุดุฑ ุจุณูุทุฉ ุ ูุน ูู ุงูุนูุงูุจ ุงููุชุฑุชุจุฉ ุนูู ุฌููุน ุงูุฃูุธูุฉ ุงููุฑุนูุฉ ูุงููุธุงู ูู ููู. <br><br>  ุงููุชุทูุจุงุช ุงูุฃุณุงุณูุฉ ููููู: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ูููู ุงููุตูู ุฅูู ุงููุฑูุจุงุช 99.99 ูช.  ูู ุงูููุงุฑุณุฉ ุงูุนูููุฉ ุ ูุชุฑุฌู ูุฐุง ุฅูู ูุชุทูุจุงุช ุชุดุบูููุฉ ุนูู ูุฏุงุฑ ุงูุณุงุนุฉ ูุทูุงู ุฃูุงู ุงูุฃุณุจูุน ูุงููุฏุฑุฉ ุนูู ุงูุงุณุชุฌุงุจุฉ ุชููุงุฆููุง ูุฃู ุญุงูุงุช ุทูุงุฑุฆ. </li><li style=";text-align:right;direction:rtl">  ุณูุงูุฉ ุงูุจูุงูุงุช: ุงููุณุจุฉ ุงููุฆููุฉ ููุฑุณุงุฆู ุงูููููุฏุฉ ุนูุฏ ุงูููู ูุฌุจ ุฃู ุชููู ุฅูู 0 </li></ol><br>  ุนูู ุณุจูู ุงููุซุงู ุ ุนูุฏ ุฅุฌุฑุงุก ููุงููุฉ ุ ุชูุชูู ุนุฏุฉ ุฑุณุงุฆู ูุฎุชููุฉ ุนุจุฑ ุงูููู ุบูุฑ ุงููุชุฒุงูู.  ุจุนุถ ุงูุฑุณุงุฆู ูุฎุตุตุฉ ููุฃูุธูุฉ ุงููุฑุนูุฉ ุงูุชู ุชุนูุด ูู ููุณ ุงูุฏุงุฆุฑุฉ ุ ูุงูุจุนุถ ุงูุขุฎุฑ ูุฎุตุต ููุฅุฑุณุงู ุฅูู ุงูุนูุฏ ุงููุฑูุฒูุฉ.  ูููู ุงููุทุงูุจุฉ ุจุงูุฑุณุงูุฉ ููุณูุง ุจูุงุณุทุฉ ุนุฏุฉ ุฃูุธูุฉ ูุฑุนูุฉ ุ ูุจุงูุชุงูู ุ ูู ูุฑุญูุฉ ูุดุฑ ุงูุฑุณุงูุฉ ูู ุงูุฃุฑูุจ ุ ูุชู ูุณุฎูุง ูุฅุฑุณุงููุง ุฅูู ูุณุชููููู ูุฎุชูููู.  ููู ุจุนุถ ุงูุญุงูุงุช ุ ูุชู ุชูููุฐ ูุณุฎ ุงูุฑุณุงุฆู ุจุดูู ุฅุฌุจุงุฑู ุนูู ุฏุงุฑุฉ ูุณูุทุฉ - ุนูุฏูุง ุชุญุชุงุฌ ุฅูู ุชุณููู ุงููุนูููุงุช ูู ุงูุฏุงุฆุฑุฉ ูู ุฎุงุจุงุฑููุณู ุฅูู ุงูุฏุงุฆุฑุฉ ูู ูุฑุงุณููุฏุงุฑ.  ูุชู ุงูุฅุฑุณุงู ูู ุฎูุงู ุฃุญุฏ ุงูุฎุทูุท ุงูููุชูุฑูุฉ ุงููุฑูุฒูุฉ ุ ุญูุซ ูุชู ุนูู ูุณุฎ ูู ุงูุฑุณุงุฆู ุ ูููุณุชูููู ุงููุฑูุฒููู. <br><br>  ุจุงูุฅุถุงูุฉ ุฅูู ุงูุฃุญุฏุงุซ ุงููุงุชุฌุฉ ุนู ุชุตุฑูุงุช ุงููุดุชุฑู ุ ุชูุฑ ุฑุณุงุฆู ุงูุฎุฏูุฉ ุงูุชู ุชุชุจุงุฏู ุงูุฃูุธูุฉ ุงููุฑุนูุฉ ุจุงูููู.  ูุจุงูุชุงูู ุ ูุชู ุงูุญุตูู ุนูู ุนุฏุฉ ุขูุงู ูู ุทุฑู ุงููุฑุงุณูุฉ ุงููุฎุชููุฉ ุ ุจุนุถูุง ูุชูุงุทุน ุ ุจุนุถูุง ููุฌูุฏ ุจูุนุฒู ุนู ุบูุฑู.  ูููู ุชุณููุฉ ุนุฏุฏ ูู ููุงุฆู ุงูุงูุชุธุงุฑ ุงููุดุงุฑูุฉ ูู ุงููุณุงุฑุงุช ุงูููุฌูุฏุฉ ุนูู ุฎุทูุท ูููุชูุฑ ูุฎุชููุฉ ูููู ุงูุญุฌู ุงูุชูุฑูุจู ูุฎุฑูุทุฉ ุงูููู: ุนูู ุงูุฏูุงุฆุฑ ุงููุฑูุฒูุฉ 600 ู 200 ู 260 ู 15 ... ูุนูู ุงูุฏูุงุฆุฑ ุงูุจุนูุฏุฉ 80-100 ... <br><br>  ูุน ูุฐู ุงููุดุงุฑูุฉ ูู ุงูููู ุ ูู ุชุนุฏ ูุชุทูุจุงุช ุฅููุงููุฉ ุงููุตูู ุจูุณุจุฉ 100ูช ูุฌููุน ุนูุฏ ุงูููู ููุฑุทุฉ.  ูุญู ููุชูู ุฅูู ุชูููุฐ ูุฐู ุงููุชุทูุจุงุช. <br><br><h3 style=";text-align:right;direction:rtl">  ููู ูุญู ุงูููุงู </h3><br>  ุจุงูุฅุถุงูุฉ ุฅูู <i>RabbitMQ ููุณูุง</i> ุ <i>ูุชู</i> ุงุณุชุฎุฏุงู <i>Haproxy</i> ูููุงุฒูุฉ ุงูุญูู ูุชูููุฑ ุงุณุชุฌุงุจุฉ ุชููุงุฆูุฉ ูุญุงูุงุช ุงูุทูุงุฑุฆ. <br><br>  ุจุนุถ ุงููููุงุช ุนู ุจูุฆุฉ ุงูุฃุฌูุฒุฉ ูุงูุจุฑุงูุฌ ุงูุชู ุชูุฌุฏ ูููุง ุฃุฑุงูุจูุง: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฌููุน ุฎูุงุฏู ุงูุฃุฑูุจ ุงูุชุฑุงุถูุฉ ุ ูุน ุงููุนููุงุช ูู 8-12 ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ุ 16 ุฌูุฌุงุจุงูุช ุบูุบุงุจุงูุช ุ 200 ุบูุบุงุจุงูุช ุงูุฃูุฑุงุต ุงูุตูุจุฉ.  ููุง ุฃูุถุญุช ุงูุชุฌุฑุจุฉ ุ ุญุชู ุงุณุชุฎุฏุงู ุงูุฎูุงุฏู ุบูุฑ ุงูุงูุชุฑุงุถูุฉ ุงูุฒุงุญูุฉ ูุน 90 ูุฑูุฒูุง ููุฌููุนุฉ ูู ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ูููุฑ ุฏูุนุฉ ุฃุฏุงุก ุตุบูุฑุฉ ุจุชูููุฉ ุฃุนูู ุจูุซูุฑ.  ุงูุฅุตุฏุงุฑุงุช ุงููุณุชุฎุฏูุฉ: 3.6.6 (ูู ุงูููุงุฑุณุฉ ุงูุนูููุฉ - ุงูุฃูุซุฑ ุงุณุชูุฑุงุฑูุง ูู 3.6) ูุน ุฅุฑูุงูุบ ูู 18.3 ุ 3.7.6 ูุน ุฅุฑูุงูุฌ ูู 20.1. </li><li style=";text-align:right;direction:rtl">  ุจุงููุณุจุฉ ุฅูู Haproxy ุ ุชููู ุงููุชุทูุจุงุช ุฃูู ุจูุซูุฑ: 2 ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ุ ู 4 ุฌูุฌุง ุจุงูุช Mem ุ ุฅุตุฏุงุฑ haproxy 1.8 ูุณุชูุฑ.  ูุง ูุชุฌุงูุฒ ุงูุชุญููู ุนูู ุงูููุงุฑุฏ ุนูู ูุงูุฉ ุฎูุงุฏู haproxy 15ูช โโCPU / Mem. </li><li style=";text-align:right;direction:rtl">  ุชูุน ุญุฏููุฉ ุงูุญููุงู ุจุฃููููุง ูู 14 ูุฑูุฒ ุจูุงูุงุช ูู 7 ููุงูุน ูู ุฌููุน ุฃูุญุงุก ุงูุจูุงุฏ ุ ูุชุญุฏุฉ ูู ุดุจูุฉ ูุงุญุฏุฉ.  ููุฌุฏ ูู ูู ูุฑูุฒ ูู ูุฑุงูุฒ ุงูุจูุงูุงุช ูุฌููุนุฉ ูู ุซูุงุซ ููุงุท ููุญูุฑ ูุงุญุฏ. </li><li style=";text-align:right;direction:rtl">  ุจุงููุณุจุฉ ููุฏูุงุฆุฑ ุงูุจุนูุฏุฉ ุ ูุชู ุงุณุชุฎุฏุงู ูุฑูุฒูู ููุจูุงูุงุช ุ ููู ุฏุงุฆุฑุฉ ูู ุงูุฏูุงุฆุฑ ุงููุฑูุฒูุฉ - 4. </li><li style=";text-align:right;direction:rtl">  ุชุชูุงุนู ุงูุฏูุงุฆุฑ ุงููุฑูุฒูุฉ ูุน ุจุนุถูุง ุงูุจุนุถ ููุฐูู ูุน ุงูุฏูุงุฆุฑ ุงูุจุนูุฏุฉ ุ ูุจุฏูุฑูุง ุ ุชุนูู ุงูุฏูุงุฆุฑ ุนู ุจูุนุฏ ููุท ูุน ุงูุฏูุงุฆุฑ ุงููุฑูุฒูุฉ ุ ููุง ููุฌุฏ ูุฏููุง ุงุชุตุงู ูุจุงุดุฑ ูุน ุจุนุถูุง ุงูุจุนุถ. </li><li style=";text-align:right;direction:rtl">  ุชููููุงุช Haps ู Clusters ุฏุงุฎู ููุณ ุงูุฏุงุฆุฑุฉ ูุชุทุงุจูุฉ ุชูุงููุง.  ููุทุฉ ุงูุฏุฎูู ููู ุฏุงุฆุฑุฉ ูู ุงุณู ูุณุชุนุงุฑ ูุณุฌูุงุช A-DNS ูุชุนุฏุฏุฉ.  ูุจุงูุชุงูู ุ ูููุน ุญุฏูุซ ุฐูู ุ ุณุชููู ููุงู ููุทุฉ ูุงุญุฏุฉ ุนูู ุงูุฃูู ููุงุญุฏุฉ ุนูู ุงูุฃูู ูู ุงููุฌููุนุงุช (ุนูุฏุฉ ูุงุญุฏุฉ ุนูู ุงูุฃูู ูู ุงููุฌููุนุฉ) ูู ูู ุฏุงุฆุฑุฉ.  ูุธุฑูุง ูุฃู ุญุงูุฉ ูุดู ุญุชู 6 ุฎูุงุฏู ูู ูุฑูุฒูู ููุจูุงูุงุช ูู ุงูููุช ููุณู ุฃูุฑ ูุณุชุจุนุฏ ููุบุงูุฉ ุ ููู ุงูููุชุฑุถ ุฃู ุชููู ุงูููุจูููุฉ ูุฑูุจุฉ ูู 100ูช. </li></ul><br>  ูุจุฏู ูููููุง (ูุชูููุฐูุง) ูู ูุฐุง ูุซู ูุฐุง: <br><br><img src="https://habrastorage.org/webt/f2/rm/9i/f2rm9i0kd5jk1ikaapl2vc63yhc.jpeg" alt="ุงูุตูุฑุฉ"><br><br><img src="https://habrastorage.org/webt/az/5t/ks/az5tkse8qkz0fl3ml6znbg4pz18.jpeg" alt="ุงูุตูุฑุฉ"><br><br>  ุงูุขู ุจุนุถ ุงูุชููููุงุช. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุชูููู ูุงุจุฑููุณู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td>  ุงููุงุฌูุฉ ุงูุฃูุงููุฉ center-rmq_5672 </td><td></td></tr><tr><td></td><td>  ุฑุจุท </td><td>  *: 5672 </td></tr><tr><td></td><td>  ุงููุถุน </td><td>  ุจุฑูุงูุฌ ุงูุชุนุงูู ุงูููู </td></tr><tr><td></td><td>  ูุงูุณููู </td><td>  10000 </td></tr><tr><td></td><td>  ุงูุนููู ุงููููุฉ </td><td>  3 ุณุงุนุงุช </td></tr><tr><td></td><td>  ุงูุฎูุงุฑ </td><td>  tcpka </td></tr><tr><td></td><td>  ุงูุฎูุงุฑ </td><td>  ุชูุจููุฌ </td></tr><tr><td></td><td>  default_backend </td><td>  ูุฑูุฒ rmq_5672 </td></tr><tr><td>  frontend center-rmq_5672_lvl_1 </td><td></td></tr><tr><td></td><td>  ุฑุจุท </td><td>  ูุถูู ูุญูู: 56721 </td></tr><tr><td></td><td>  ุงููุถุน </td><td>  ุจุฑูุงูุฌ ุงูุชุนุงูู ุงูููู </td></tr><tr><td></td><td>  ูุงูุณููู </td><td>  10000 </td></tr><tr><td></td><td>  ุงูุนููู ุงููููุฉ </td><td>  3 ุณุงุนุงุช </td></tr><tr><td></td><td>  ุงูุฎูุงุฑ </td><td>  tcpka </td></tr><tr><td></td><td>  ุงูุฎูุงุฑ </td><td>  ุชูุจููุฌ </td></tr><tr><td></td><td>  default_backend </td><td>  center-rmq_5672_lvl_1 </td></tr><tr><td>  ุงูุฎูููุฉ ูุฑูุฒ rmq_5672 </td></tr><tr><td></td><td>  ุงูุชูุงุฒู </td><td>  ุงูุฃูู ุดุฃูุง </td></tr><tr><td></td><td>  ุงููุถุน </td><td>  ุจุฑูุงูุฌ ุงูุชุนุงูู ุงูููู </td></tr><tr><td></td><td>  ูุงููููู </td><td>  10000 </td></tr><tr><td></td><td>  ูููุฉ </td><td>  ุงูุฎุงุฏู 3H </td></tr><tr><td></td><td>  ุงูุฎุงุฏู </td><td>  srv-rmq01 10/10/10/10/106767 ุงูุชุญูู ูู ุงุฑุชูุงุน 5 ููุงุท 2 ุณููุท 3 ุฌูุณุงุช ุฅููุงู ูุณุฎ ุงุญุชูุงุทู ููุญูุธุฉ </td></tr><tr><td></td><td>  ุงูุฎุงุฏู </td><td>  srv-rmq03 10/10/10/2011 11672 ุงุฑุชูุงุน ุงูุดููุงุช ุจูู 5s 2 ุณููุท 3 ุฌูุณุงุช ุฅููุงู ูุณุฎ ุงุญุชูุงุทู ููุญูุธุฉ </td></tr><tr><td></td><td>  ุงูุฎุงุฏู </td><td>  srv-rmq05 10/10/10/126767 ุชุญูู ุงุฑุชูุงุน ุงูุดููุงุช ุจูู 5s 2 ุณููุท 3 ุฌูุณุงุช ุฅููุงู ูุณุฎ ุงุญุชูุงุทู ููุญูุธุฉ </td></tr><tr><td></td><td>  ุงูุฎุงุฏู </td><td>  localhost 127.0.0.1 โ 6721 ุชุญูู ุงุฑุชูุงุน 5s ุจูู 2 ุณููุท 3 ุงููุณุฎ ุงูุงุญุชูุงุทู ุนูู ุฌูุณุงุช ุฅููุงู ุงูุชุดุบูู ุงูููุณููุฉ </td></tr><tr><td>  ูุฑูุฒ ุงูุฎูููุฉ - rmq_5672_lvl_1 </td></tr><tr><td></td><td>  ุงูุชูุงุฒู </td><td>  ุงูุฃูู ุดุฃูุง </td></tr><tr><td></td><td>  ุงููุถุน </td><td>  ุจุฑูุงูุฌ ุงูุชุนุงูู ุงูููู </td></tr><tr><td></td><td>  ูุงููููู </td><td>  10000 </td></tr><tr><td></td><td>  ูููุฉ </td><td>  ุงูุฎุงุฏู 3H </td></tr><tr><td></td><td>  ุงูุฎุงุฏู </td><td>  srv-rmq02 10/10/10/136767 ุชุญูู ุงุฑุชูุงุน ุงูุดููุงุช ุจูู 5s 2 ุณููุท 3 ุฌูุณุงุช ุฅููุงู ูุณุฎ ุงุญุชูุงุทู ููุญูุธุฉ </td></tr><tr><td></td><td>  ุงูุฎุงุฏู </td><td>  srv-rmq04 10/10/10/14/1067 ุชุญูู ุงุฑุชูุงุน ุงูุดููุงุช ุจูู 5s 2 ุณููุท 3 ุฌูุณุงุช ุฅููุงู ูุณุฎ ุงุญุชูุงุทู ููุญูุธุฉ </td></tr><tr><td></td><td>  ุงูุฎุงุฏู </td><td>  srv-rmq06 10.10.10.5:0767 ุชุญูู ูู ุงุฑุชูุงุน 5 ูุฑุงุช 2 ุณููุท 3 ุฌูุณุงุช ุฅููุงู ูุณุฎ ุงุญุชูุงุทู ููุญูุธุฉ </td></tr></tbody></table><br></div></div><br>  ูุตู ุงููุณู ุงูุฃูู ูู ุงูููุฏูุฉ ููุทุฉ ุงูุฏุฎูู - ุงููุคุฏูุฉ ุฅูู ุงููุฌููุนุฉ ุงูุฑุฆูุณูุฉ ุ ุชู ุชุตููู ุงููุณู ุงูุซุงูู ูููุงุฒูุฉ ูุณุชูู ุงูุงุญุชูุงุทู.  ุฅุฐุง ูุตูุช ุจุจุณุงุทุฉ ุฌููุน ุฎูุงุฏู ุงูุฃุฑูุจ ุงูุงุญุชูุงุทูุฉ ูู ูุณู ุงููุงุฌูุฉ ุงูุฎูููุฉ (ุชุนูููุงุช ุงููุณุฎ ุงูุงุญุชูุงุทู) ุ ูุณูู ุชุนูู ุจููุณ ุงูุทุฑููุฉ - ุฅุฐุง ูุงูุช ุงููุฌููุนุฉ ุงูุฑุฆูุณูุฉ ุบูุฑ ูุงุจูุฉ ูููุตูู ุชูุงููุง ุ ูุณุชุฐูุจ ุงูุงุชุตุงูุงุช ุฅูู ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ ุ ููุน ุฐูู ุ ุณุชุฐูุจ ุฌููุน ุงูุงุชุตุงูุงุช ุฅูู ุฎุงุฏู ุงููุณุฎ ุงูุงุญุชูุงุทู ุงูุฃูู ูู ุงููุงุฆูุฉ.  ูุถูุงู ููุงุฒูุฉ ุงูุชุญููู ุนูู ุฌููุน ุนูุฏ ุงููุณุฎ ุงูุงุญุชูุงุทู ุ ููุฏู ููุท ูุงุฌูุฉ ูุงุญุฏุฉ ุฃุฎุฑู ุ ูุงูุชู ูููุฑูุง ููุท ูุน ุงููุถูู ุงููุญูู ุ ููููู ุจุชุนููู ุฎุงุฏู ุงููุณุฎ ุงูุงุญุชูุงุทู ุนููู. <br><br>  ูุตู ุงููุซุงู ุฃุนูุงู ููุงุฒูุฉ Loop ุนู ุจูุนุฏ - ูุงูุชู ุชุนูู ุฏุงุฎู ูุฑูุฒูู ููุจูุงูุงุช: ุฎุงุฏู srv-rmq {01ุ03ุ05} - ูุจุงุดุฑ ูู ูุฑูุฒ ุงูุจูุงูุงุช ุฑูู 1 ุ srv-rmq {02ุ04ุ06} - ูู ูุฑูุฒ ุงูุจูุงูุงุช ุฑูู 2.  ูุจุงูุชุงูู ุ ูุชูููุฐ ุงูุญู ุงูุฐู ูุญุชูู ุนูู ุฃุฑุจุนุฉ ุตูุฏุง ุ ูุญุชุงุฌ ููุท ุฅูู ุฅุถุงูุฉ ุฌุจูุชูู ูุญููุชูู ููุณููู ุฎููููู ูุฎูุงุฏู ุงูุฃุฑุงูุจ ุงูููุงุจูุฉ. <br><br>  ุณููู ุงูููุงุฒู ูุน ูุฐุง ุงูุชูููู ููุง ููู: ุนูู ุงูุฑุบู ูู ูุฌูุฏ ุฎุงุฏู ุฑุฆูุณู ูุงุญุฏ ุนูู ุงูุฃูู ููุฏ ุงูุญูุงุฉ ุ ูุฅููุง ูุณุชุฎุฏูู.  ุฅุฐุง ูุงูุช ุงูุฎูุงุฏู ุงูุฑุฆูุณูุฉ ุบูุฑ ูุชููุฑุฉ ุ ูุฅููุง ูุนูู ูุน ุงุญุชูุงุทู.  ูู ุญุงูุฉ ุชููุฑ ุฎุงุฏู ุฃุณุงุณู ูุงุญุฏ ุนูู ุงูุฃูู ุ ูุชู ูุทุน ุงุชุตุงู ุฌููุน ุงูุงุชุตุงูุงุช ุจุฎูุงุฏู ุงููุณุฎ ุงูุงุญุชูุงุทู ุ ูุนูุฏูุง ุชุชู ุงุณุชุนุงุฏุฉ ุงูุงุชุตุงู ุ ูุฅููุง ุชูุน ุจุงููุนู ุนูู ูุธุงู ุงููุฌููุนุฉ ุงูุฃุณุงุณู. <br><br>  ุชูุธูุฑ ุชุฌุฑุจุฉ ุงูุชุดุบูู ููุซู ูุฐุง ุงูุชูููู ุชููุฑูุง ุจูุณุจุฉ 100ูช ุชูุฑูุจูุง ููู ุฏุงุฆุฑุฉ.  ูุชุทูุจ ูุฐุง ุงูุญู ุฃู ุชููู ุงููุธู ุงููุฑุนูุฉ ูุงููููุฉ ูุจุณูุทุฉ ุชูุงููุง: ูุชููู ูุงุฏุฑูุง ุนูู ุฅุนุงุฏุฉ ุงูุงุชุตุงู ุจุงูุฃุฑูุจ ุจุนุฏ ูุทุน ุงูุงุชุตุงู. <br><br>  ูุฐูู ุ ููุฏ ูุฏููุง โโููุงุฒูุฉ ุชุญููู ูุนุฏุฏ ุชุนุณูู ูู ุงููุฌููุนุงุช ูุงูุชุจุฏูู ุงูุชููุงุฆู ุจููููุง ุ ููุฏ ุญุงู ุงูููุช ููุฐูุงุจ ูุจุงุดุฑุฉ ุฅูู ุงูุฃุฑุงูุจ. <br><br>  ูุชู ุฅูุดุงุก ูู ูุฌููุนุฉ ูู ุซูุงุซ ููุงุท ุ ููุง ูุธูุฑ ูู ุฎูุงู ุงูููุงุฑุณุฉ - ุงูุนุฏุฏ ุงูุฃูุซู ููุนูุฏ ุ ูุงูุฐู ูุถูู ุงูุชูุงุฒู ุงูุฃูุซู ููุชูุณุฑ / ุงูุชุณุงูุญ ูุน ุงูุฎุทุฃ / ุงูุณุฑุนุฉ.  ูุธุฑูุง ูุฃู ุงูุฃุฑูุจ ูุง ูุชู ููุงุณู ุฃููููุง (ุฃุฏุงุก ุงููุชูุฉ ูุณุงูู ุฃุฏุงุก ุงูุฎุงุฏู ุงูุฃุจุทุฃ) ุ ููุญู ููุดุฆ ูู ุงูุนูุฏ ุจููุณ ุงููุนููุงุช ุงููุซุงููุฉ ููุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ / Mem / Hdd.  ูุญู ูุถุน ุงูุฎูุงุฏู ุนูู ููุฑุจุฉ ูู ุจุนุถูุง ุงูุจุนุถ ูุฏุฑ ุงูุฅููุงู - ูู ุญุงูุชูุง ุ ูููู ุจุฅูุฏุงุน ุฃุฌูุฒุฉ ุงูุชุฑุงุถูุฉ ุฏุงุฎู ุงููุฒุฑุนุฉ ููุณูุง. <br><br>  ุจุงููุณุจุฉ ููุดุฑูุท ุงููุณุจูุฉ ุ ูุงูุชู ูู ุฎูุงููุง ุณุชุถูู ุงูุฃูุธูุฉ ุงููุฑุนูุฉ ุงูุนูููุฉ ุงูุฃูุซุฑ ุงุณุชูุฑุงุฑูุง ูุงูููุงุก ุจูุชุทูุจุงุช ุญูุธ ุงูุฑุณุงุฆู ุงููุณุชููุฉ: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูุนูู ูุน ุงูุฃุฑูุจ ูููู ููุท ุนุจุฑ ุจุฑูุชูููู amqp / amqps - ูู ุฎูุงู ุงูููุงุฒูุฉ.  ุฅุฐู ุชุญุช ุงูุญุณุงุจุงุช ุงููุญููุฉ - ุฏุงุฎู ูู ูุฌููุนุฉ (ุญุณูุง ุ ูุงูุฏุงุฆุฑุฉ ุจุฃููููุง) </li><li style=";text-align:right;direction:rtl">  ุชุฑุชุจุท ุงูุฃูุธูุฉ ุงููุฑุนูุฉ ุจุงูุฃุฑูุจ ูู ุงููุถุน ุงูุณูุจู: ูุง ููุณูุญ ุจุฃู ูุนุงููุงุช ูุน ููุงูุงุช ุงูุฃุฑุงูุจ (ุฅูุดุงุก ููุงุฆู ุงูุชุธุงุฑ / eschendzhey / bind) ููุญุฏูุฏุฉ ุนูู ูุณุชูู ุญููู ุงูุญุณุงุจ - ูุญู ุจุจุณุงุทุฉ ูุง ูุนุทู ุญููููุง ููุชูููู. </li><li style=";text-align:right;direction:rtl">  ูุชู ุฅูุดุงุก ุฌููุน ุงูููุงูุงุช ุงููุงุฒูุฉ ูุฑูุฒูุง ุ ูููุณ ุนู ุทุฑูู ุงููุธู ุงููุฑุนูุฉ ุ ููุชู ุนูู ูู ูุฌููุนุงุช ุงููุชู ุจุงูุทุฑููุฉ ููุณูุง - ูุถูุงู ุงูุชุจุฏูู ุงูุชููุงุฆู ุฅูู ุงููุชูุฉ ุงูุงุญุชูุงุทูุฉ ูุงูุนูุณ.  ุฎูุงู ุฐูู ุ ูููููุง ุงูุญุตูู ุนูู ุตูุฑุฉ: ููุฏ ุชุญูููุง ุฅูู ุงูุงุญุชูุงุทู ุ ูููู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุฃู ุงูุฑุจุท ุบูุฑ ููุฌูุฏ ุ ููููููุง ุงูุญุตูู ุนูู ุงุฎุชูุงุฑ ุฎุทุฃ ูู ุงูุงุชุตุงู ุฃู ููุฏุงู ุงูุฑุณุงุฆู. </li></ol><br><h3 style=";text-align:right;direction:rtl">  ุงูุขู ุงูุฅุนุฏุงุฏุงุช ูุจุงุดุฑุฉ ุนูู ุงูุฃุฑุงูุจ: </h3><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุง ูููู ูููุถูููู ุงููุญูููู ุงููุตูู ุฅูู ูุงุฌูุฉ ุงูููุจ </li><li style=";text-align:right;direction:rtl">  ูุชู ุชูุธูู ุงููุตูู ุฅูู ุงูููุจ ูู ุฎูุงู LDAP - ูุญู ูุฏูุฌ ูุน ู ููุญุตู ุนูู ุชุณุฌูู ูู ูุฃูู ุฏุฎูุช ูุงููุฑุง ุงูููุจ.  ุนูู ูุณุชูู ุงูุชูููู ุ ูููุฏ ุญููู ุญุณุงุจุงุช ุงูุฅุนูุงูุงุช ุ ููุณ ููุท ุฃููุง ูุทูุจ ุฃู ูููู ูู ูุฌููุนุฉ ูุนููุฉ ุ ูููููุง ูุนุทู ุญููููุง ููุท "ููุฑุคูุฉ".  ูุฌููุนุงุช ุงูุฑุตุฏ ุฃูุซุฑ ูู ูุงููุฉ.  ููุนูู ุญููู ุงููุณุคูู ุนูู ูุฌููุนุฉ ุฃุฎุฑู ูู ู ุ ูุจุงูุชุงูู ูุฅู ุฏุงุฆุฑุฉ ุงูุชุฃุซูุฑ ุนูู ูุณุงุฆู ุงูููู ูุญุฏูุฏุฉ ููุบุงูุฉ. </li><li style=";text-align:right;direction:rtl">  ูุชุณููู ุงูุฅุฏุงุฑุฉ ูุงูุชุชุจุน: <br>  ุนูู ุฌููุน VHOSTs ุ ูุนูู ุนูู ุงูููุฑ ุณูุงุณุฉ ุงููุณุชูู 0 ูุน ุชุทุจูู ุนูู ุฌููุน ููุงุฆู ุงูุงูุชุธุงุฑ (ุงูููุท:. *): <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <b><i>ha-mode: ุงููู</i></b> - ุชุฎุฒูู ุฌููุน ุงูุจูุงูุงุช ุนูู ุฌููุน ุนูุฏ ุงููุฌููุนุฉ ุ ูุชูุงูุต ุณุฑุนุฉ ูุนุงูุฌุฉ ุงูุฑุณุงุฆู ุ ูููู ูุชู ุถูุงู ุณูุงูุชูุง ูุชูุงูุฑูุง. </li><li style=";text-align:right;direction:rtl">  <b><i>ha-sync-mode: ุชููุงุฆู</i></b> - ูุฑุดุฏ ุงูุฒุงุญู ููุฒุงููุฉ ุงูุจูุงูุงุช ุชููุงุฆููุง ุนูู ุฌููุน ุนูุฏ ุงููุฌููุนุฉ: ุชุฒุฏุงุฏ ุฃูุถูุง ุณูุงูุฉ ุงูุจูุงูุงุช ูุชูุงูุฑูุง. </li><li style=";text-align:right;direction:rtl">  <b><i>ุทุงุจูุฑ - ุงููุถุน: ูุณูู</i></b> - ุฑุจูุง ูุงุญุฏุฉ ูู ุฃูุซุฑ ุงูุฎูุงุฑุงุช ุงููููุฏุฉ ุงูุชู ุธูุฑุช ูู ุงูุฃุฑุงูุจ ููุฐ ุงูุฅุตุฏุงุฑ 3.6 - ุชุณุฌูู ููุฑู ููุฑุณุงุฆู ุนูู ุงูุฃูุฑุงุต ุงูุตูุจุฉ.  ูุฐุง ุงูุฎูุงุฑ ูููู ุจุดูู ูุจูุฑ ูู ุงุณุชููุงู ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ููุฒูุฏ ูู ุณูุงูุฉ ุงูุจูุงูุงุช ุฃุซูุงุก ุชููู / ุณููุท ุงูุนูุฏ ุฃู ุงููุชูุฉ ููู. </li></ul><br></li><li style=";text-align:right;direction:rtl">  ุงูุฅุนุฏุงุฏุงุช ูู ููู ุงูุชูููู ( <i>rabbitmq-main / conf / rabbitmq.config</i> ): <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุณู <b>ุงูุฃุฑุงูุจ</b> : <i>{vm_memory_high_watermark_paging_ratio ุ 0.5}</i> - ุงูุญุฏ ุงูุฃุฏูู ูุชูุฒูู ุงูุฑุณุงุฆู ุนูู ุงููุฑุต ุจูุณุจุฉ 50ูช.  <b>ุนูุฏ ุชุดุบูู ุงููุณู ุ ูุตุจุญ</b> ุงูุชุฃููู ุฃูุซุฑ ุนูุฏูุง ูุฑุณู ุจูููุตุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ ุงููุณุชูู 1 ุ ููุณู ููู ุชุถููู <b>ุงููุณู</b> . </li><li style=";text-align:right;direction:rtl">  <i>{vm_memory_high_watermarkุ 0.95}</i> - ููุตุฑ ุงูุฃุฑูุจ ุนูู 95ูช ูู ุฅุฌูุงูู ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ุ ูุธุฑูุง ูุฃู ุงูุฃุฑุงูุจ ููุท ุชุนูุด ุนูู ุงูุฎูุงุฏู ุ ููุณ ูู ุงูููุทูู ุฅุฏุฎุงู ูููุฏ ุฃูุซุฑ ุตุฑุงูุฉ.  5 ูช "ููุชุฉ ูุงุณุนุฉ" ููููู - ุงุชุฑู ูุธุงู ุงูุชุดุบูู ูุงููุฑุงูุจุฉ ูุบูุฑูุง ูู ุงูุฃุดูุงุก ุงูุตุบูุฑุฉ ุงููููุฏุฉ.  ูุธุฑูุง ูุฃู ูุฐู ุงููููุฉ ูู ุงูุญุฏ ุงูุฃุนูู ุ ููุฌุฏ ูุง ูููู ููุฌููุน. </li><li style=";text-align:right;direction:rtl">  <i>{cluster_partition_handlingุ pause_minority}</i> - ูุตู ุณููู ุงููุชูุฉ ุนูุฏ ุญุฏูุซ "ูุณู ุงูุดุจูุฉ" ุ ูุซูุงุซ ุฃู ุฃูุซุฑ ูู ูุฌููุนุงุช ุงูุนูุฏุฉ ุงูุชู ููุตุญ ุจูุง ูุฐู ุงูุนูุงูุฉ - ุฅููุง ุชุณูุญ ูููุชูุฉ ุจุงุณุชุฑุฏุงุฏ ููุณูุง. </li><li style=";text-align:right;direction:rtl">  <i>{disk_free_limit ุ "500 ููุฌุงุจุงูุช")</i> - ูู ุดูุก ุจุณูุท ุ ุนูุฏูุง ูููู ููุงู ูุณุงุญุฉ ุฎุงููุฉ ุนูู ุงููุฑุต 500 ููุฌุงุจุงูุช - ุณูุชู ุฅููุงู ูุดุฑ ุงูุฑุณุงุฆู ุ ููู ูุชููุฑ ุงูุทุฑุญ ุฅูุง. </li><li style=";text-align:right;direction:rtl">  <i>{auth_backends ุ [rabbit_auth_backend_internalุ rabbit_auth_backend_ldap]}</i> - ุชุฑุชูุจ ุงูุชูููุถ ููุฃุฑุงูุจ: ุฃููุงู ุ ูุชู ูุญุต ูุฌูุฏ ุงูููุฌุงุช ููู ุงูุตูุชูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุญููุฉ ุ ูุฅุฐุง ูู ููู ุงูุฃูุฑ ูุฐูู ุ ูุงูุชูู ุฅูู ุฎุงุฏู LDAP. </li><li style=";text-align:right;direction:rtl">  ูุณู <b>rabbitmq_auth_backend_ldap</b> - ุงูุชูููู ููุชูุงุนู ูุน AD: <i>{serversุ ["srv_dc1"ุ "srv_dc2"]}</i> - ูุงุฆูุฉ <i>ุจูุญุฏุงุช</i> ุงูุชุญูู ุจุงููุฌุงู ุงูุชู ุณุชุชู ุงููุตุงุฏูุฉ ุนูููุง. </li><li style=";text-align:right;direction:rtl">  ุงููุนููุงุช ุงูุชู ุชุตู ุงููุณุชุฎุฏู ูุจุงุดุฑุฉ ูู ู ุ ููููุฐ LDAP ููุง ุฅูู ุฐูู ูู ูุฑุฏูุฉ ุจุญุชุฉ ููุชู ูุตููุง ุจุงูุชูุตูู ูู ุงููุซุงุฆู. </li><li style=";text-align:right;direction:rtl">  ุฃูู ุดูุก ุจุงููุณุจุฉ ููุง ูู ูุตู ุงูุญููู ูุงููููุฏ ุงูููุฑูุถุฉ ุนูู ุงูุฅุฏุงุฑุฉ ูุงููุตูู ุฅูู ูุงุฌูุฉ ุงูููุจ ููุฃุฑุงูุจ: tag_queries: <br>  <i>[{adminุ {in_groupุ "cn = rabbitmq-adminsุ ou = GRPุ ou = GRP_MAINุ dc = My_domainุ dc = ru"}}ุ</i> <i><br></i>  <i>{ุงูุฑุตุฏ ุ</i> <i><br></i>  <i>{in_groupุ "cn = rabbitmq-webุ ou = GRPุ ou = GRP_MAINุ dc = My_domainุ dc = ru"}</i> <i><br></i>  <i>}]</i> - ูููุฑ ูุฐุง ุงูุชุตููู ุงูุชูุงุฒุงุช ุฅุฏุงุฑูุฉ ูุฌููุน ูุณุชุฎุฏูู ูุฌููุนุฉ rabbitmq-admins ูุญููู ุงููุฑุงูุจุฉ (ูุงููุฉ ูุญุฏ ุฃุฏูู ูุนุฑุถ ุงููุตูู) ููุฌููุนุฉ rabbitmq-web. <br></li><li style=";text-align:right;direction:rtl">  <b>resource_access_query</b> : <br>  <i>{ูู ุฃุฌู ุ</i> <i><br></i>  <i>[{ุฅุฐู ุ ุชูููู ุ {in_group ุ "cn = rabbitmq-admins ุ ou = GRP ุ ou = GRP_MAIN ุ dc = My_domain ุ dc = ru"}} ุ</i> <i><br></i>  <i>{ุฅุฐู ุ ูุชุงุจุฉ ุ {in_group ุ "cn = rabbitmq-admins ุ ou = GRP ุ ou = GRP_MAIN ุ dc = My_domainุ dc = ru"}}ุ</i> <i><br></i>  <i>{ุฅุฐู ุ ูุฑุงุกุฉ ุ {ุซุงุจุช ุ ุตุญูุญ}}</i> <i><br></i>  <i>]</i> <i><br></i>  <i>}</i> - ูุญู ูููุฑ ุญููู ุงูุชูููู ูุงููุชุงุจุฉ ููุท ููุฌููุนุฉ ูู ุงููุณุคูููู ุ ูููู ุดุฎุต ุขุฎุฑ ูุงู ุจุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ ุ ุชููู ุงูุญููู ูููุฑุงุกุฉ ููุท - ููููู ูุฑุงุกุฉ ุงูุฑุณุงุฆู ูู ุฎูุงู ูุงุฌูุฉ ุงูููุจ. <br></li></ul></li></ol><br>  ูุญุตู ุนูู ูุฌููุนุฉ (ุนูู ูุณุชูู ููู ุงูุชูููู ูุงูุฅุนุฏุงุฏุงุช ูู ุงูุฃุฑูุจ ููุณู) ุงูุชู ุชุฒูุฏ ูู ุชูุงูุฑ ูุณูุงูุฉ ุงูุจูุงูุงุช.  ุจูุฐุง ูููุฐ ุงููุชุทูุจ - ุถูุงู ุชูุงูุฑ ูุณูุงูุฉ ุงูุจูุงูุงุช ... ูู ูุนุธู ุงูุญุงูุงุช. <br><br>  ููุงู ุงูุนุฏูุฏ ูู ุงูููุงุท ุงูุชู ูุฌุจ ูุฑุงุนุงุชูุง ุนูุฏ ุชุดุบูู ูุฐู ุงูุฃูุธูุฉ ุงููุญููุฉ ููุบุงูุฉ: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูู ุงูุฃูุถู ุชูุธูู ุฌููุน ุฎุตุงุฆุต ููุงุฆู ุงูุงูุชุธุงุฑ ุงูุฅุถุงููุฉ (TTL ุ ุฃู ุงูุชูุงุก ุงูุตูุงุญูุฉ ุ ุฃู ุงูุญุฏ ุงูุฃูุตู ููุทูู ุ ููุง ุฅูู ุฐูู) ุจูุงุณุทุฉ ุงูุณูุงุณููู ุ ุจุฏูุงู ูู ุชุนููู ุงููุนููุงุช ุนูุฏ ุฅูุดุงุก ููุงุฆู ุงูุงูุชุธุงุฑ.  ููุฏ ุธูุฑ ูููู ูุงุจู ููุชุฎุตูุต ุจูุฑููุฉ ูููู ุชุฎุตูุตู ุณุฑูุนูุง ูุชุบูุฑ ุงูุญูุงุฆู. </li><li style=";text-align:right;direction:rtl">  ุจุงุณุชุฎุฏุงู TTL.  ุฃุทูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุ ูุงุฑุชูุงุน ุงูุญูู ุนูู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ.  ูููุน "ุงุฎุชุฑุงู ุงูุณูู" ุ ูู ุงูุฃูุถู ุชุญุฏูุฏ ุทูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุนุจุฑ ุงูุญุฏ ุงูุฃูุตู ููุทูู ุฃูุถูุง. </li><li style=";text-align:right;direction:rtl">  ุจุงูุฅุถุงูุฉ ุฅูู ุงูุฃุฑูุจ ููุณู ุ ููุงู ุนุฏุฏ ูู ุชุทุจููุงุช ุงูุฃุฏูุงุช ุงููุณุงุนุฏุฉ ุชุฏูุฑ ุนูู ุงูุฎุงุฏู ุ ุงูุฃูุฑ ุงูุฐู ูุชุทูุจ ุจุดูู ุบูุฑ ุทุจูุนู ููุงุฑุฏ ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ.  ูุฃุฎุฐ ุงูุฃุฑูุจ ุงูุดุฑุงุจู ุ ุงูุชุฑุงุถููุง ุ ุฌููุน ุงูููู ุงููุชุงุญุฉ ... ูุฏ ูุชุญูู ูุถุน ุบูุฑ ุณุงุฑุฉ: ุตุฑุงุน ุนูู ุงูููุงุฑุฏ ุ ูููู ุฃู ูุคุฏู ุจุณูููุฉ ุฅูู ูุจุญ ุงูุฃุฑูุจ.  ูุชุฌูุจ ุญุฏูุซ ูุซู ูุฐุง ุงููููู ุ ุนูู ุณุจูู ุงููุซุงู ุ ุนูู ุงููุญู ุงูุชุงูู: ุชุบููุฑ ูุนููุงุช ุฅุทูุงู erlang - ุฃุฏุฎู ุญุฏูุง ุฅูุฒุงูููุง ุนูู ุนุฏุฏ ุงูููู ุงููุณุชุฎุฏูุฉ.  ูููู ุจุฐูู ุนูู ุงููุญู ุงูุชุงูู: ุงุจุญุซ ุนู ููู <i>rabbitmq-env</i> ุ ูุงุจุญุซ ุนู SERVER_ERL_ARGS = ุงููุนููุฉ ูุฃุถู + sct L0-Xc0-X + SY: Y ุฅููู.  ุญูุซ X ูู ุนุฏุฏ ุงูููู -1 (ูุจุฏุฃ ุงูุนุฏ ูู 0) ุ Y - ุนุฏุฏ ุงูููู -1 (ุงูุนุฏ ูู 1).  + sct L0-Xc0-X - ูุบูุฑ ุงูุฑุจุท ุฅูู ุงูููุงุฉ ุ + SY: Y - ูุบูุฑ ุนุฏุฏ shedulers ุงูุชู ุฃุทููุชูุง erlang.  ูุฐูู ุจุงููุณุจุฉ ููุธุงู ูููู ูู 8 ููู ุ ุณุชุชุฎุฐ ุงููุนููุงุช ุงููุถุงูุฉ ุงูุดูู: + sct L0-6c0-6 + S 7: 7.  ูุจูุฐู ุงูุทุฑููุฉ ุ ูุง ููุฏู ููุฃุฑูุจ ุณูู 7 ููู ููุชููุน ุฃู ูุนูู ูุธุงู ุงูุชุดุบูู ุ ุนู ุทุฑูู ุฅุทูุงู ุนูููุงุช ุฃุฎุฑู ุ ุนูู ุงููุญู ุงูุฃูุซู ููุนูููุง ุนูู ููุงุฉ ุบูุฑ ูุญููุฉ. </li></ol><br><h3 style=";text-align:right;direction:rtl">  ุงููุฑูู ุงูุฏูููุฉ ูู ุชุดุบูู ุญุฏููุฉ ุงูุญููุงู ุงููุงุชุฌุฉ </h3><br>  ูุง ูุง ูููู ุญูุงูุฉ ุฃู ุฅุนุฏุงุฏ ููู ูู ุงููุงุนุฏุฉ ุงููููุงุฑุฉ - ูุณูุก ุงูุญุธ ุ ูุญุฏุซ ุฐูู ุจุงุญุชูุงู ุบูุฑ ุตูุฑู.  ูุฐู ุงููุชูุฌุฉ ุงููุงุฑุซูุฉ ูุง ุชูุชุฌ ุนู ุงููุดู ุงูุนุงููู (ุนูู ุณุจูู ุงููุซุงู ุ ุงููุดู ุงููุงูู ููุฑูุฒ ุงูุจูุงูุงุช ุจุฃูููู - ุงูุญูู ุณูุชุญูู ุจุจุณุงุทุฉ ุฅูู ูุชูุฉ ุฃุฎุฑู) ุ ูููู ุงููุฒูุฏ ูู ุงูุฅุฎูุงูุงุช ุงููุญููุฉ - ุฏุงุฎู ููุณ ูุทุงุน ุงูุดุจูุฉ. <br><br>  ุนูุงูุฉ ุนูู ุฐูู ุ ูุฅู ุฅุฎูุงูุงุช ุงูุดุจูุฉ ุงููุญููุฉ ูุฎููุฉ ูุฃู  ูู ูุคุฏู ุงูุฅุบูุงู ุงูุทุงุฑุฆ ูุนูุฏ ุฃู ุนูุฏุชูู ุฅูู ุนูุงูุจ ูุฎููุฉ - ุจุจุณุงุทุฉ ุณุชุฐูุจ ุฌููุน ุงูุทูุจุงุช ุฅูู ุนูุฏุฉ ูุงุญุฏุฉ ุ ูููุง ูุชุฐูุฑ ุ ูุนุชูุฏ ุงูุฃุฏุงุก ุนูู ุฃุฏุงุก ุงูุนูุฏุฉ ููุณูุง ููุท.  ุชุคุฏู ุญุงูุงุช ูุดู ุงูุดุจูุฉ (ูุง ูุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุงูุงููุทุงุนุงุช ุงูุตุบูุฑุฉ ูู ุงูุงุชุตุงูุงุช - ุญูุซ ุชุชู ููุงุฌูุชูุง ุฏูู ุฃูู) ุฅูู ูุถุน ุชุจุฏุฃ ููู ุงูุนูุฏ ูู ุนูููุฉ ุงููุฒุงููุฉ ูุน ุจุนุถูุง ุงูุจุนุถ ุซู ูููุทุน ุงูุงุชุตุงู ูุฑุงุฑูุง ูุชูุฑุงุฑูุง ูุจุถุน ุซูุงู. <br><br>  ุนูู ุณุจูู ุงููุซุงู ุ ูููุถ ูุชุนุฏุฏุฉ ููุดุจูุฉ ุ ูุจุชุฑุฏุฏ ุฃูุซุฑ ูู 5 ุซูุงู (ููุท ุชู ุชุนููู ูููุฉ ููุฐู ูู ุฅุนุฏุงุฏุงุช Hapov ุ ููููู ุจุงูุชุฃููุฏ ุชุดุบูููุง ุ ูููู ููุชุญูู ูู ุงููุนุงููุฉ ุณุชุญุชุงุฌ ุฅูู ุชูุฑุงุฑ ุงููุดู ุ ุงูุฐู ูุง ูุฑูุฏู ุฃุญุฏ). <br><br>  ูุง ูุฒุงู ุจุฅููุงู ุงููุฌููุนุฉ ุงูุตููุฏ ุฃูุงู ูุงุญุฏ ุฃู ุงุซููู ูู ูุฐู ุงูุชูุฑุงุฑุงุช ุ ููู ุฃูุซุฑ ูู ุฐูู - ูุงููุฑุต ุถุฆููุฉ ููุบุงูุฉ.  ูู ูุซู ูุฐู ุงูุญุงูุฉ ุ ูููู ุญูุธ ููุทุฉ ุชููู ููุนูุฏุฉ ุงูุณุงูุทุฉ ุ ููู ููุงุฏ ูููู ูู ุงููุณุชุญูู ุงูููุงู ุจุฐูู ูุฏูููุง.  ูู ูุซูุฑ ูู ุงูุฃุญูุงู ุ ูุฅู ุงููุชูุฌุฉ ููุณุช ูุฌุฑุฏ ููุฏุงู ุนูุฏุฉ ูู ุงููุชูุฉ ูุน ุงูุฑุณุงูุฉ <b>"Network Partition"</b> ุ ูููู ุฃูุถูุง ุงูุตูุฑุฉ ุนูุฏูุง ุนุงุดุช ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ ุนูู ููุงุฆู ุงูุงูุชุธุงุฑ ูุฐู ุงูุนูุฏุฉ ููุท ููู ููู ูุฏููุง ููุช ูููุฒุงููุฉ ูุน ุจุงูููุง.  ุจุตุฑูุง - ูู ุจูุงูุงุช ูุงุฆูุฉ ุงูุงูุชุธุงุฑ <b><i>NaN</i></b> . <br><br>  ูุงูุขู ูุฐู ุฅุดุงุฑุฉ ูุง ูุจุณ ูููุง - ูู ุจุงูุชุจุฏูู ุฅูู ุงููุชูุฉ ุงูุงุญุชูุงุทูุฉ.  ุงูุชุจุฏูู ุณูููุฑ hap ุ ุชุญุชุงุฌ ููุท ุฅูู ุฅููุงู ุงูุฃุฑุงูุจ ุนูู ุงููุชูุฉ ุงูุฑุฆูุณูุฉ - ูุณุฃูุฉ ุนุฏุฉ ุฏูุงุฆู.  ูุชูุฌุฉ ูุฐูู ุ ูุญุตู ุนูู ุงุณุชุนุงุฏุฉ ุงููุฏุฑุฉ ุงูุชุดุบูููุฉ ููููู ููููููุง ุงููุถู ูุฏูุง ุจุฃูุงู ูู ุชุญููู ุงูุญุงุฏุซ ูุงููุถุงุก ุนููู. <br><br>  ูู ุฃุฌู ุฅุฒุงูุฉ ูุชูุฉ ุชุงููุฉ ูู ุชุญุช ุงูุญูู ุ ูู ุฃุฌู ููุน ุงููุฒูุฏ ูู ุงูุชุฏููุฑ ุ ูุฅู ุฃุจุณุท ุดูุก ูู ุฌุนู ุงูุฃุฑุงูุจ ุชุนูู ุนูู ููุงูุฆ ุฃุฎุฑู ุบูุฑ 5672. ุจูุง ุฃููุง ูุฑุงูุจ ุงูุฃุฑุงูุจ ุนู ุทุฑูู ุงููููุฐ ุงูุนุงุฏู ุ ููุฒูุญู ุ ุนูู ุณุจูู ุงููุซุงู ุ ุจุญููู 5673 ูู ุฅุนุฏุงุฏุงุช ุงูุฃุฑูุจ ุ ุณูุณูุญ ูู ุจุชุดุบูู ุงููุฌููุนุฉ ุจุงููุงูู ุฏูู ุฃูู ููุญุงููุฉ ุงุณุชุนุงุฏุฉ ูุงุจููุฉ ุงูุชุดุบูู ูุงูุฑุณุงุฆู ุงููุชุจููุฉ ุนููู. <br><br>  ูุญู ููุนู ุฐูู ูู ุจุถุน ุฎุทูุงุช: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฃููู ุฌููุน ุนูุฏ ุงููุฌููุนุฉ ุงููุงุดูุฉ - ูููู hap ุจุชุจุฏูู ุงูุญูู ุฅูู ูุธุงู ูุฌููุนุฉ ุงููุณุฎ ุงูุงุญุชูุงุทู </li><li style=";text-align:right;direction:rtl">  RABBITMQ_NODE_PORT=5673   <i>rabbitmq-env</i> โ       ,   Web  -    15672. </li><li style=";text-align:right;direction:rtl">            . </li></ol><br>                .  ,            ,    โ       <i>msg_store_persistent</i> , <i>msg_store_transient</i> , <i>queues</i> (  3.6)  <i>msg_stores</i> (  3.7). <br><br>          ,   . <br><br>     (  ):    ,           . <br><br>            rpm,     cpio   (   ) .  :    /  root,     (     tgz)     .        (       โ          ,       ).      RabbitMQ    โ      โ       . <br><br>     cpio       :   rabbitmq-base (   โ  mnesia)  rabbimq-main โ          . <br><br>  rabbimq-main/bin โ            ( ). <br><br>  rabbimq-main/init.d โ  rabbitmq-server    // ;  lib โ  ;  lib64 โ erlang ( ,    ,  ). <br><br>          โ   rabbimq-main/lib  rabbimq-main/lib64        bin.       โ        . <br><br>     โ    โ  , ,     ,            . <br><br>       ,  ,        โ     (    ).    99%     ,  kill    ,           . <br><br>   3.6  3.7         . <br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title">  3.6</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"><code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/python import subprocess import os import datetime import zipfile def LastRow(fileName,MAX_ROW=200): with open(fileName,'rb') as f: f.seek(-min(os.path.getsize(fileName),MAX_ROW),2) return (f.read().splitlines())[-1] if os.path.isfile('/data/logs/rabbitmq/startup_log'): if b'FAILED' in LastRow('/data/logs/rabbitmq/startup_log'): proc = subprocess.Popen("ps x|grep rabbitmq-server|grep -v 'grep'", shell=True, stdout=subprocess.PIPE) out = proc.stdout.readlines() if str(out) == '[]': cur_dt=datetime.datetime.now() try: os.stat('/data/logs/rabbitmq/after_crush') except: os.mkdir('/data/logs/rabbitmq/after_crush') z=zipfile.ZipFile('/data/logs/rabbitmq/after_crush/repair_log'+'-'+str(cur_dt.day).zfill(2)+str(cur_dt.month).zfill(2)+str(cur_dt.year)+'_'+str(cur_dt.hour).zfill(2)+'-'+str(cur_dt.minute).zfill(2)+'-'+str(cur_dt.second).zfill(2)+'.zip','a') z.write('/data/logs/rabbitmq/startup_err','startup_err') proc = subprocess.Popen("~/rabbitmq-main/init.d/rabbitmq-server start", shell=True, stdout=subprocess.PIPE) out = proc.stdout.readlines() z.writestr('res_restart.log',str(out)) z.close() my_file = open("/data/logs/rabbitmq/run.time", "a") my_file.write(str(cur_dt)+"\n") my_file.close()</span></span></code> </pre> <br></div></div><br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ู 3.7 ุ ูุชู ุชุบููุฑ ุณุทุฑูู ููุท</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (os.path.isfile(<span class="hljs-string"><span class="hljs-string">'/data/logs/rabbitmq/startup_log'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> (os.path.isfile(<span class="hljs-string"><span class="hljs-string">'/data/logs/rabbitmq/startup_err'</span></span>)): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((<span class="hljs-string"><span class="hljs-string">b' OK '</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> LastRow(<span class="hljs-string"><span class="hljs-string">'/data/logs/rabbitmq/startup_log'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> (<span class="hljs-string"><span class="hljs-string">b'FAILED'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> LastRow(<span class="hljs-string"><span class="hljs-string">'/data/logs/rabbitmq/startup_log'</span></span>))) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> (<span class="hljs-string"><span class="hljs-string">b'Gracefully halting Erlang VM'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> LastRow(<span class="hljs-string"><span class="hljs-string">'/data/logs/rabbitmq/startup_err'</span></span>)):</code> </pre><br></div></div><br><br>  ููุฏ ุฃูุดุฃูุง ุญุณุงุจูุง crontab ูุนูู ุจููุฌุจู ุงูุฃุฑูุจ (ุงูุชุฑุงุถููุง rabbitmq) ุงูุฐู ูููุฐ ูุฐุง ุงูุจุฑูุงูุฌ ุงููุตู (ุงุณู ุงูุจุฑูุงูุฌ ุงููุตู: check_and_run) ูู ุฏูููุฉ (ุฃููุงู ุ ูุทูุจ ูู ุงููุณุคูู ููุญ ุงูุญุณุงุจ ุงูุญู ูู ุงุณุชุฎุฏุงู crontab ุ ูููู ุฅุฐุง ูุงู ูุฏููุง ุญููู ุงูุฌุฐุฑ ุ ููุญู ููุนู ุฐูู ุจุฃููุณูุง): <br>  <b><i>* / 1 * * * * ~ / rabbitmq-main / bin / check_and_run</i></b> <br><br>  ุงูููุทุฉ ุงูุซุงููุฉ ูู ุงุณุชุฎุฏุงู ุงูุฃุฑุงูุจ ุงููุนุงุฏ ุชุฌููุนูุง ูู ุฏูุฑุงู ุงูุณุฌูุงุช. <br><br>  ูุธุฑูุง ูุฃููุง ูุณูุง ูุฑุชุจุทูู ุจูุธุงู logrotate ุ ูุฅููุง ูุณุชุฎุฏู ุงููุธุงุฆู ุงูุชู ูููุฑูุง ุงููุทูุฑ: ุงูุจุฑูุงูุฌ ุงููุตู <b>rabbitmq-server</b> ูู init.d (ููุฅุตุฏุงุฑ 3.6) <br>  ุจุฅุฌุฑุงุก ุชุบููุฑุงุช ุตุบูุฑุฉ ุนูู <i>rotate_logs_rabbitmq ()</i> <br>  ุฃุถู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"> find <span class="hljs-variable"><span class="hljs-variable">${RABBITMQ_LOG_BASE}</span></span>/http_api/*.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>.* -maxdepth 0 -<span class="hljs-built_in"><span class="hljs-built_in">type</span></span> f ! -name <span class="hljs-string"><span class="hljs-string">"*.gz"</span></span> | xargs -i gzip --force {} find <span class="hljs-variable"><span class="hljs-variable">${RABBITMQ_LOG_BASE}</span></span>/*.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>.*.back -maxdepth 0 -<span class="hljs-built_in"><span class="hljs-built_in">type</span></span> f | xargs -i gzip {} find <span class="hljs-variable"><span class="hljs-variable">${RABBITMQ_LOG_BASE}</span></span>/*.gz -<span class="hljs-built_in"><span class="hljs-built_in">type</span></span> f -mtime +30 -delete find <span class="hljs-variable"><span class="hljs-variable">${RABBITMQ_LOG_BASE}</span></span>/http_api/*.gz -<span class="hljs-built_in"><span class="hljs-built_in">type</span></span> f -mtime +30 -delete</code> </pre><br>  ูุชูุฌุฉ ุชุดุบูู ุงูุจุฑูุงูุฌ ุงููุตู rabbitmq-server ุจุงุณุชุฎุฏุงู ุณุฌูุงุช ุชุฏููุฑ ุงูููุชุงุญ: ูุชู ุถุบุท ุงูุณุฌูุงุช ุจูุงุณุทุฉ gzip ุ ููุชู ุชุฎุฒูููุง ููุท ููุฏุฉ 30 ููููุง ุงููุงุถูุฉ.  <b>http_api</b> - ุงููุณุงุฑ ุงูุฐู ูุถุน ููู ุงูุฃุฑูุจ ุงูุณุฌูุงุช http - <i>ุงููููููุฉ ูู</i> ููู ุงูุชูููู: <i>{rabbitmq_management ุ [{rates_mode ุ ููุตูุฉ} ุ {http_log_dir ุ path_to_logs / http_api "}]}</i> <br><br>  ูู ุงูููุช ููุณู ุ ุฃูููู ุงูุชูุงููุง ูู <i>{rates_mode ุ <b>ููุตูุฉ</b> }</i> - ุงูุฎูุงุฑ ูุฒูุฏ ุงูุญูู ุจุดูู ุทููู ุ ูููู ูุณูุญ ูู ุจูุดุงูุฏุฉ ุงููุนูููุงุช ุญูู ูู ุงูุฐู ููุดุฑ ุงูุฑุณุงุฆู ูู EXCHENGE ุนูู ูุงุฌูุฉ WEB (ูุจุงูุชุงูู ููููู ุงููุตูู ุฅูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช).  ุงููุนูููุงุช ุถุฑูุฑูุฉ ููุบุงูุฉ ุ ูุฃู  ุฌููุน ุงูุงุชุตุงูุงุช ุชุฐูุจ ูู ุฎูุงู ุงูููุงุฒู - ุณูุฑู ููุท IP ููููุงุฒูุงุช ุฃููุณูู.  ูุฅุฐุง ููุช ุชุชุบูุจ ุนูู ุฌููุน ุงูุฃูุธูุฉ ุงููุฑุนูุฉ ุงูุชู ุชุนูู ูุน ุงูุฃุฑุงูุจ ุญุชู ุชููุฃ ูุนููุงุช ุฎุตุงุฆุต ุงูุนููู ูู ุฎุตุงุฆุต ุงุชุตุงูุงุชูู ุจุงูุฃุฑุงูุจ ุ ูุณูููู ูู ุงููููู ุงูุญุตูู ุนูู ูุนูููุงุช ููุตูุฉ ุนูู ูุณุชูู ุงูุงุชุตุงู ูู ุจุงูุถุจุท ุ ูุฃูู ูุจูุซุงูุฉ ูุง ุชูุดุฑ ุงูุฑุณุงุฆู. <br><br>  ูุน ุฅุตุฏุงุฑ ุงูุฅุตุฏุงุฑุงุช ุงูุฌุฏูุฏุฉ 3.7 ุ ูุงู ููุงู ุฑูุถ ูุงูู <b>ููุจุฑูุงูุฌ</b> ุงููุตู <b>rabbimq-server</b> ูู init.d.  ูู ุฃุฌู ุชุณููู ุงูุชุดุบูู (ุชูุญูุฏ ุฃูุงูุฑ ุงูุชุญูู ุจุบุถ ุงููุธุฑ ุนู ุฅุตุฏุงุฑ ุงูุฃุฑูุจ) ูุงูุชูุงู ุฃูุซุฑ ุณูุงุณุฉ ุจูู ุงูุฅุตุฏุงุฑุงุช ุ ูู ุงูุฃุฑุงูุจ ุงููุนุงุฏ ุชุฌููุนูุง ุ ููุงุตู ุงุณุชุฎุฏุงู ูุฐุง ุงูุจุฑูุงูุฌ ุงููุตู.  ุงูุญูููุฉ ูุฑุฉ ุฃุฎุฑู: ุณูุนูู ุนูู ุชุบููุฑ <i>rotate_logs_rabbitmq ()</i> ููููุงู ุ ูุธุฑูุง ูุฃู ุขููุฉ ุชุณููุฉ ุงูุณุฌูุงุช ุจุนุฏ ุงูุชุฏููุฑ ูุฏ ุชุบูุฑุช ูู 3.7: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"> mv <span class="hljs-variable"><span class="hljs-variable">${RABBITMQ_LOG_BASE}</span></span>/<span class="hljs-variable"><span class="hljs-variable">$NODENAME</span></span>.log.0 <span class="hljs-variable"><span class="hljs-variable">${RABBITMQ_LOG_BASE}</span></span>/<span class="hljs-variable"><span class="hljs-variable">$NODENAME</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>.$(date +%Y%m%d-%H%M%S).back mv <span class="hljs-variable"><span class="hljs-variable">${RABBITMQ_LOG_BASE}</span></span>/$(<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">$NODENAME</span></span>)_upgrade.log.0 <span class="hljs-variable"><span class="hljs-variable">${RABBITMQ_LOG_BASE}</span></span>/$(<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">$NODENAME</span></span>)_upgrade.log.$(date +%Y%m%d-%H%M%S).back find <span class="hljs-variable"><span class="hljs-variable">${RABBITMQ_LOG_BASE}</span></span>/http_api/*.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>.* -maxdepth 0 -<span class="hljs-built_in"><span class="hljs-built_in">type</span></span> f ! -name <span class="hljs-string"><span class="hljs-string">"*.gz"</span></span> | xargs -i gzip --force {} find <span class="hljs-variable"><span class="hljs-variable">${RABBITMQ_LOG_BASE}</span></span>/*.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>.* -maxdepth 0 -<span class="hljs-built_in"><span class="hljs-built_in">type</span></span> f ! -name <span class="hljs-string"><span class="hljs-string">"*.gz"</span></span> | xargs -i gzip --force {} find <span class="hljs-variable"><span class="hljs-variable">${RABBITMQ_LOG_BASE}</span></span>/*.gz -<span class="hljs-built_in"><span class="hljs-built_in">type</span></span> f -mtime +30 -delete find <span class="hljs-variable"><span class="hljs-variable">${RABBITMQ_LOG_BASE}</span></span>/http_api/*.gz -<span class="hljs-built_in"><span class="hljs-built_in">type</span></span> f -mtime +30 -delete</code> </pre><br>  ุงูุขู ูุจูู ููุท ุฅุถุงูุฉ ูููุฉ ุชุฏููุฑ ุงูุณุฌู ุฅูู crontab - ุนูู ุณุจูู ุงููุซุงู ุ ูู ููู ูู 23-00: <br>  <b><i>00 23 * * * ~ / rabbitmq-main / init.d / rabbitmq-server ุชุฏููุฑ ุณุฌูุงุช</i></b> <br><br>  ุฏุนูุง ููุชูู ุฅูู ุงูููุงู ุงูุชู ุชุญุชุงุฌ ุฅูู ุญู ูู ุฅุทุงุฑ ุชุดุบูู "ูุฒุฑุนุฉ ุงูุฃุฑุงูุจ": <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูุชูุงุนุจ ูุน ุงูููุงูุงุช ุงูุฃุฑุงูุจ - ุฅูุดุงุก / ุญุฐู ุงูููุงูุงุช ุงูุฃุฑุงูุจ: ekschendzhey ุ ููุงุฆู ุงูุงูุชุธุงุฑ ุ ูุฑุจุท ุ ูุนุงูู ุ ุงููุณุชุฎุฏููู ุ ูุงูุณูุงุณุงุช.  ูููููุงู ุจุฐูู ุ ูููู ุงูุฃูุฑ ูุชุทุงุจููุง ุชูุงููุง ูู ุฌููุน ุงููุฌููุนุงุช ุงูุนูููุฏูุฉ. </li><li style=";text-align:right;direction:rtl">  ุจุนุฏ ุงูุชุจุฏูู ุฅูู / ูู ุงููุชูุฉ ุงูุงุญุชูุงุทูุฉ ุ ููุฒู ููู ุงูุฑุณุงุฆู ุงูุชู ุจููุช ุนูููุง ุฅูู ุงููุชูุฉ ุงูุญุงููุฉ. </li><li style=";text-align:right;direction:rtl">  ุฅูุดุงุก ูุณุฎ ุงุญุชูุงุทูุฉ ูู ุชููููุงุช ุฌููุน ุงููุฌููุนุงุช ูู ุฌููุน ุงูุฏูุงุฆุฑ </li><li style=";text-align:right;direction:rtl">  ุชุฒุงูู ูุงูู ูุชููููุงุช ุงููุชู ุฏุงุฎู ุงูููุชูุฑ </li><li style=";text-align:right;direction:rtl">  ููู / ุจุฏุก ุงูุฃุฑุงูุจ </li><li style=";text-align:right;direction:rtl">  ูุชุญููู ุชุฏููุงุช ุงูุจูุงูุงุช ุงูุญุงููุฉ: ููุฐ ูู ุงูุฑุณุงุฆู ูุฅุฐุง ูุงูุช ุชุฐูุจ ุ ูุฃูู ูุฌุจ ุฃู ุชุฐูุจ ุฃู ... </li><li style=";text-align:right;direction:rtl">  ุงูุจุญุซ ุนู ุงูุฑุณุงุฆู ุงูุชู ุชู ุงุฌุชูุงุฒูุง ุจุฃู ูุนุงููุฑ </li></ol><br>  ูู ุงููููู ุชุดุบูู ุญุฏููุฉ ุงูุญููุงู ุงูุฎุงุตุฉ ุจูุง ูุญู ุงูููุงู ุงูุชู ูุชู ุงูุชุนุจูุฑ ุนููุง ุนู ุทุฑูู <i>ุงูููููู</i> ุงูุฅุถุงูู ุงูููุชุธู ูู <i>rabbitmq_management</i> ุ ููููู ุบูุฑ ูุฑูุญ ููุบุงูุฉ ุ ูููุฐุง ุงูุณุจุจ ุชู ุชุทููุฑ ูุชูููุฐ ูุฐููุฉ <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุณูุทุฑุฉ ุนูู ูุฌููุนุฉ ูุงููุฉ ูู ุงูุฃุฑุงูุจ</a></b> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar434016/">https://habr.com/ru/post/ar434016/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar434004/index.html">ููุตุฉ ุงูุฃูุนุงุจ: Hello World</a></li>
<li><a href="../ar434006/index.html">ูู ูุญุชุงุฌ ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท ูู ุนุตุฑ ุงููุงุชุฌ ุงููุญูู ุงูุฅุฌูุงููุ ูุญู ููุงูุด ุงููุถุน ููุชุทูุจุงุช ุงููุงููู</a></li>
<li><a href="../ar434008/index.html">ููููุฉ ุงูุชููู ุนู ุงูููู ูุงูุจุฏุก ูู ูุชุงุจุฉ ุงูุงุฎุชุจุงุฑุงุช ุงููุงุฆูุฉ ุนูู ุงูููุชููุงุช</a></li>
<li><a href="../ar434010/index.html">ูููุณู ูุฎุตุต ุฃู ูููุฆ ูููุงุก Nginx ูู Apache Tomcat ุนูู Ubuntu ูู 5 ุฏูุงุฆู ูุน https ูุฌุฏุงุฑ ุงูุญูุงูุฉ</a></li>
<li><a href="../ar434012/index.html">PVS- ุณุชูุฏูู ูุฌุงูู ูุฃููุฆู ุงูุฐูู ูุทูุฑูู ูุดุงุฑูุน ููุชูุญุฉ ุงููุตุฏุฑ</a></li>
<li><a href="../ar434018/index.html">ุงูุญุตูู ุนูู ุดูุงุฏุฉ ูุทูุฑ ุจุฑุงูุฌ Google Associate</a></li>
<li><a href="../ar434034/index.html">ุฏุฑูุณ ุฌูุฏุฉ ุนูู ููุชููุจ</a></li>
<li><a href="../ar434036/index.html">ุณุนูุฏ ูููุงูุฉ - ุงูุชููุช ุตูุงุฏูู ุงูุจุฑูุฏ ุนูู ูุทุงูุงุช ุจูุงุจุฉ Qip.ru ุฅูู ูุงูุฏูุณ</a></li>
<li><a href="../ar434038/index.html">ูุจูุนุงุช ุงูุณูุงุฑุงุช ุงูููุฑุจุงุฆูุฉ ูู ุงูุตูู ูุดูุฑ ููููุจุฑ 2018</a></li>
<li><a href="../ar434040/index.html">ููุฎุต ุฌุงูุนุฉ ITMO: ุชุญุฏุซ ุนู ูุดุงุฑูุน ุงูุฌุงูุนุฉ ููุฌุงุญุงุชูุง ูุฅูุฌุงุฒุงุช ุฎุฑูุฌููุง</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>