<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯСКЁЯП╗ ЁЯРе ЁЯТ░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░рд╡рд┐рд╣рд┐рдд: рдЕрдХреНрд╕рд░ рдкреВрдЫреЗ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдкреНрд░рд╢реНрди ЁЯджЁЯП╜ ЁЯдЮЁЯП╛ ЁЯСиЁЯП┐тАНЁЯМ╛</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдирдорд╕реНрдХрд╛рд░, рд╣реЗрдмреНрд░! рдореИрдВ рдЖрдкрдХреЗ рд▓рд┐рдП рд╕реНрдЯреАрдлрди рддрд╛рдЙрдм рджреНрд╡рд╛рд░рд╛ рдХрдиреНрдлрд┐рдЧрд░рдПрд╡рд╛рдЗрдЯ рдПрдлрдПрдХреНрдпреВ рд▓реЗрдЦ рдХрд╛ рдЕрдиреБрд╡рд╛рдж рдкреНрд░рд╕реНрддреБрдд рдХрд░рддрд╛ рд╣реВрдВред 



 Async / Async рдХреЛ рд╕рд╛рдд рд╕рд╛рд▓ рдкрд╣рд▓реЗ .NET await рдЬреЛ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдХреЙрдиреНрдлрд╝рд┐рдЧрд░рд╡рд┐рд╣рд┐рдд: рдЕрдХреНрд╕рд░ рдкреВрдЫреЗ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдкреНрд░рд╢реНрди</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482354/"> рдирдорд╕реНрдХрд╛рд░, рд╣реЗрдмреНрд░!  рдореИрдВ рдЖрдкрдХреЗ рд▓рд┐рдП рд╕реНрдЯреАрдлрди рддрд╛рдЙрдм рджреНрд╡рд╛рд░рд╛ рдХрдиреНрдлрд┐рдЧрд░рдПрд╡рд╛рдЗрдЯ <a href="https://devblogs.microsoft.com/dotnet/configureawait-faq/" rel="nofollow">рдПрдлрдПрдХреНрдпреВ</a> рд▓реЗрдЦ рдХрд╛ рдЕрдиреБрд╡рд╛рдж рдкреНрд░рд╕реНрддреБрдд рдХрд░рддрд╛ рд╣реВрдВред <br><br><img src="https://habrastorage.org/webt/ps/pj/sm/pspjsmmgsimr2lachonj6idmnj8.png" alt="рдЫрд╡рд┐"><br><br>  <code>Async</code> / <code>Async</code> рдХреЛ рд╕рд╛рдд рд╕рд╛рд▓ рдкрд╣рд▓реЗ .NET <code>await</code> рдЬреЛрдбрд╝рд╛ <code>await</code> рдерд╛ред  рдЗрд╕ рдирд┐рд░реНрдгрдп рдХрд╛ рди рдХреЗрд╡рд▓ .NET рдкрд╛рд░рд┐рд╕реНрдерд┐рддрд┐рдХреА рддрдВрддреНрд░ рдкрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкреНрд░рднрд╛рд╡ рдкрдбрд╝рд╛ рд╣реИ - рдпрд╣ рдХрдИ рдЕрдиреНрдп рднрд╛рд╖рд╛рдУрдВ рдФрд░ рд░реВрдкрд░реЗрдЦрд╛рдУрдВ рдореЗрдВ рднреА рдкрд░рд┐рд▓рдХреНрд╖рд┐рдд рд╣реЛрддрд╛ рд╣реИред  рд╡рд░реНрддрдорд╛рди рдореЗрдВ, .NET рдореЗрдВ рдХрдИ рд╕реБрдзрд╛рд░реЛрдВ рдХреЛ рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рдЕрддрд┐рд░рд┐рдХреНрдд рднрд╛рд╖рд╛ рдирд┐рд░реНрдорд╛рдгреЛрдВ рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рд╕рдорд░реНрдерди рд╡рд╛рд▓реЗ рдПрдкреАрдЖрдИ рдХреЛ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдмреБрдирд┐рдпрд╛рджреА рдврд╛рдВрдЪреЗ рдореЗрдВ рдореВрд▓рднреВрдд рд╕реБрдзрд╛рд░ рдХрд┐рдП рдЧрдП рд╣реИрдВ рдЬрд┐рд╕рдХреЗ рдХрд╛рд░рдг рдШрдбрд╝реА рдХреА рддрд░рд╣ <code>async</code> / <code>await</code> рдХрд╛рд░реНрдп (рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рдкреНрд░рджрд░реНрд╢рди рдФрд░ рдиреИрджрд╛рдирд┐рдХ тАЛтАЛрдХреНрд╖рдорддрд╛рдУрдВ рдореЗрдВ рд╕реБрдзрд╛рд░ рд╣реБрдЖ рд╣реИ) .NET рдХреЛрд░ рдореЗрдВ)ред <br><br>  <code>ConfigureAwait</code> <code>async</code> / <code>await</code> рдХрд╛ рдПрдХ рдкрд╣рд▓реВ рд╣реИ рдЬреЛ рдкреНрд░рд╢реНрди рдЙрдард╛рддрд╛ рд░рд╣рддрд╛ рд╣реИред  рдореБрдЭреЗ рдЙрдореНрдореАрдж рд╣реИ рдХрд┐ рдореИрдВ рдЙрдирдореЗрдВ рд╕реЗ рдХрдИ рдХрд╛ рдЬрд╡рд╛рдм рджреЗ рд╕рдХрддрд╛ рд╣реВрдВред  рдореИрдВ рдЗрд╕ рд▓реЗрдЦ рдХреЛ рд╢реБрд░реВ рд╕реЗ рдЕрдВрдд рддрдХ рдкрдардиреАрдп рдмрдирд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реВрдВрдЧрд╛, рдФрд░ рд╕рд╛рде рд╣реА рд╕рд╛рде рдЗрд╕реЗ рдЕрдХреНрд╕рд░ рдкреВрдЫреЗ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдкреНрд░рд╢реНрдиреЛрдВ (рдПрдлрдПрдХреНрдпреВ) рдХреЗ рдЙрддреНрддрд░ рдХреА рд╢реИрд▓реА рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддрд╛рдХрд┐ рдЗрд╕реЗ рднрд╡рд┐рд╖реНрдп рдореЗрдВ рд╕рдВрджрд░реНрднрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред <a name="habracut"></a><br><br>  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ <code>ConfigureAwait</code> рдирд┐рдкрдЯрдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдереЛрдбрд╝рд╛ рдкреАрдЫреЗ рдЬрд╛рдПрдВрдЧреЗред <br><br><h3>  рдПрдХ рд╕рд┐рдВрдХреНрд░реЛрдирд╛рдЗрдЬрд╝реЗрд╢рди рдХреЙрдирдЯреЗрдХреНрд╕реНрдЯ рдХреНрдпрд╛ рд╣реИ? </h3><br>  <a href="https://docs.microsoft.com/en-us/dotnet/api/system.threading.synchronizationcontext%3Fview%3Dnetframework-4.8" rel="nofollow">System.Threading.SynchronizationContext</a> рдкреНрд░рд▓реЗрдЦрди рдХреЗ рдЕрдиреБрд╕рд╛рд░ "рд╡рд┐рднрд┐рдиреНрди рд╕рд┐рдВрдХреНрд░реЛрдирд╛рдЗрдЬрд╝реЗрд╢рди рдореЙрдбрд▓ рдореЗрдВ рд╕рд┐рдВрдХреНрд░реЛрдирд╛рдЗрдЬрд╝реЗрд╢рди рд╕рдВрджрд░реНрдн рдХреЛ рд╡рд┐рддрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмреБрдирд┐рдпрд╛рджреА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред"  рдпрд╣ рдкрд░рд┐рднрд╛рд╖рд╛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╕реНрдкрд╖реНрдЯ рдирд╣реАрдВ рд╣реИред <br><br>  99.9% рдорд╛рдорд▓реЛрдВ рдореЗрдВ, <code>SynchronizationContext</code> рдХреЛ рдПрдХ рдкреНрд░рдХрд╛рд░ рд╕реЗ рд╡рд░реНрдЪреБрдЕрд▓ <code>Post</code> рд╡рд┐рдзрд┐ рдХреЗ рд╕рд╛рде рдкреНрд░рдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдХрд┐ рдПрд╕рд┐рдВрдХреНрд░реЛрдирд╕ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд▓рд┐рдП рдПрдХ рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ ( <code>SynchronizationContext</code> рдореЗрдВ рдЕрдиреНрдп рд╡рд░реНрдЪреБрдЕрд▓ рд╕рджрд╕реНрдп рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╡реЗ рдХрдо рд╕рд╛рдорд╛рдиреНрдп рд╣реИрдВ рдФрд░ рдЗрд╕ рдЖрд▓реЗрдЦ рдореЗрдВ рдЪрд░реНрдЪрд╛ рдирд╣реАрдВ рдХреА рдЬрд╛рдПрдЧреА)ред  рдЖрдзрд╛рд░ рдкреНрд░рдХрд╛рд░ рдХреА <code>Post</code> рд╡рд┐рдзрд┐ рд╢рд╛рдмреНрджрд┐рдХ <a href="" rel="nofollow">рд░реВрдк рд╕реЗ</a> <code>ThreadPool.QueueUserWorkItem</code> рдХреЛ <a href="" rel="nofollow">рдХреЙрд▓ рдХрд░рддреА рд╣реИ</a> рддрд╛рдХрд┐ рдкреНрд░рджрд╛рди рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдХреЛ рдПрд╕рд┐рдВрдХреНрд░реЛрдирд╕ рд░реВрдк рд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред  рд╡реНрдпреБрддреНрдкрдиреНрди рдкреНрд░рдХрд╛рд░ рдУрд╡рд░рд░рд╛рдЗрдб <code>Post</code> рддрд╛рдХрд┐ рдкреНрд░рддрд┐рдирд┐рдзрд┐ рд╕рд╣реА рд╕рдордп рдкрд░ рд╕рд╣реА рдЬрдЧрд╣ рдкрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХреЗред <br><br>  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, Windows рдкреНрд░рдкрддреНрд░ рдореЗрдВ рдПрдХ SynchronizationContext-рд╡реНрдпреБрддреНрдкрдиреНрди <a href="" rel="nofollow">рдкреНрд░рдХрд╛рд░ рд╣реИ</a> рдЬреЛ <code>Control.BeginInvoke</code> рдХреЗ рд╕рдорддреБрд▓реНрдп рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП <code>Post</code> рдХреЛ рдлрд┐рд░ рд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред <code>Control.BeginInvoke</code> ред  рдЗрд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдЗрд╕ <code>Post</code> рд╡рд┐рдзрд┐ рдХреЗ рд▓рд┐рдП рдХрд┐рд╕реА рднреА рдХреЙрд▓ рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рд╕рдВрдмрдВрдзрд┐рдд рдирд┐рдпрдВрддреНрд░рдг рдХреЗ рд╕рд╛рде рд╕рдВрдмрдВрдзрд┐рдд рдереНрд░реЗрдб рдореЗрдВ рдмрд╛рдж рдХреЗ рдЪрд░рдг рдореЗрдВ рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдХреЛ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ - рддрдерд╛рдХрдерд┐рдд рдпреВрдЖрдИ рдереНрд░реЗрдбред  рд╡рд┐рдВрдбреЛрдЬ рдлреЙрд░реНрдо рдХреЗ рджрд┐рд▓ рдореЗрдВ Win32 рд╕рдВрджреЗрд╢ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рд╣реИред  рд╕рдВрджреЗрд╢ рд▓реВрдк рдХреЛ рдПрдХ рдпреВрдЖрдИ рдереНрд░реЗрдб рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдмрд╕ рдирдП рд╕рдВрджреЗрд╢реЛрдВ рдХреЗ рд╕рдВрд╕рд╛рдзрд┐рдд рд╣реЛрдиреЗ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рддрд╛ рд╣реИред  рдпреЗ рд╕рдВрджреЗрд╢ рдорд╛рдЙрд╕ рдореВрд╡рдореЗрдВрдЯ, рдХреНрд▓рд┐рдХ, рдХреАрдмреЛрд░реНрдб рдЗрдирдкреБрдЯ, рд╕рд┐рд╕реНрдЯрдо рдИрд╡реЗрдВрдЯ, рдЬреЛ рдбреЗрд▓рд┐рдЧреЗрдЯреНрд╕ рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд▓рд┐рдП рдЙрдкрд▓рдмреНрдз рд╣реИрдВ, рдЖрджрд┐ рджреНрд╡рд╛рд░рд╛ рдЯреНрд░рд┐рдЧрд░ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ Windows рдлреЙрд░реНрдо рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ UI рдереНрд░реЗрдб рдХреЗ рд▓рд┐рдП рдПрдХ <code>SynchronizationContext</code> рдЙрджрд╛рд╣рд░рдг рд╣реИ, рддреЛ рдЖрдкрдХреЛ рдЗрд╕рдореЗрдВ рдСрдкрд░реЗрд╢рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <code>Post</code> рд╡рд┐рдзрд┐ рдореЗрдВ рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдХреЛ рдкрд╛рд╕ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред <br><br>  рд╡рд┐рдВрдбреЛрдЬ рдкреНрд░реЗрдЬреЗрдВрдЯреЗрд╢рди рдлрд╝рд╛рдЙрдВрдбреЗрд╢рди (WPF) рдореЗрдВ рдПрдХ рдУрд╡рд░рд░рд╛рдЗрдб <code>Post</code> рд╡рд┐рдзрд┐ рдХреЗ рд╕рд╛рде рдПрдХ <code>SynchronizationContext</code> рд╡реНрдпреБрддреНрдкрдиреНрди <a href="" rel="nofollow">рдкреНрд░рдХрд╛рд░</a> рднреА рд╣реИ рдЬреЛ UI рд╕реНрдЯреНрд░реАрдо ( <code>Dispatcher.BeginInvoke</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП) рдХреЛ "рдбрд╛рдпрд░реЗрдХреНрдЯ" рдХрд░рддрд╛ рд╣реИ, WPF рдбрд┐рд╕реНрдкреИрдЪрд░ рдирд┐рдпрдВрддреНрд░рдг рдХреЗ рд╕рд╛рде, рди рдХрд┐ рд╡рд┐рдВрдбреЛрдЬрд╝ рдлреЙрд░реНрдо рдХрдВрдЯреНрд░реЛрд▓ред <br><br>  рдФрд░ рд╡рд┐рдВрдбреЛрдЬ рд░рдирдЯрд╛рдЗрдо (WinRT) рдХрд╛ рдЕрдкрдирд╛ <code>SynchronizationContext</code> рд╡реНрдпреБрддреНрдкрдиреНрди <a href="" rel="nofollow">рдкреНрд░рдХрд╛рд░ рд╣реИ</a> , рдЬреЛ <code>CoreDispatcher</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ UI рдереНрд░реЗрдб <code>CoreDispatcher</code> рдореЗрдВ рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдХреЛ рднреА рд░рдЦрддрд╛ рд╣реИред <br><br>  рд╡рд╛рдХреНрдпрд╛рдВрд╢ "UI рдереНрд░реЗрдб рдореЗрдВ рдбреЗрд▓рд┐рдЧреЗрдЯ рд░рди" рдХреЗ рдкреАрдЫреЗ рдпрд╣реА рдирд┐рд╣рд┐рдд рд╣реИред  рдЖрдк рдЕрдкрдиреЗ <code>SynchronizationContext</code> рдХреЛ <code>Post</code> рд╡рд┐рдзрд┐ рдФрд░ рдХреБрдЫ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рд╕рд╛рде рднреА рд▓рд╛рдЧреВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдореБрдЭреЗ рдЗрд╕ рдмрд╛рд░реЗ рдореЗрдВ рдЪрд┐рдВрддрд╛ рдХрд░рдиреЗ рдХреА рдЬрд╝рд░реВрд░рдд рдирд╣реАрдВ рд╣реИ рдХрд┐ рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдХрд┐рд╕ рдереНрд░реЗрдб рдореЗрдВ рдЪрд▓ рд░рд╣рд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдореИрдВ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реВрдВ рдХрд┐ рдореЗрд░реЗ <code>SynchronizationContext</code> рдХреЙрдиреНрдЯреЗрдХреНрд╕реНрдЯ рдореЗрдВ рдХреЛрдИ рднреА <code>Post</code> рдкрджреНрдзрддрд┐ рдбреЗрд▓рд┐рдЧреЗрдЯ рдХреЗ рдХреБрдЫ рд╕реАрдорд┐рдд рдбрд┐рдЧреНрд░реА рдХреЗ рд╕рд╛рде рдЪрд▓реЗред  рдЖрдк рдЗрд╕ рддрд░рд╣ рд╕реЗ рдПрдХ рдХрд╕реНрдЯрдо <code>SynchronizationContext</code> рдХреЛ рд▓рд╛рдЧреВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">internal</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MaxConcurrencySynchronizationContext</span></span> : <span class="hljs-title"><span class="hljs-title">SynchronizationContext</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> SemaphoreSlim _semaphore; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MaxConcurrencySynchronizationContext</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> maxConcurrencyLevel</span></span></span><span class="hljs-function">)</span></span> =&gt; _semaphore = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SemaphoreSlim(maxConcurrencyLevel); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Post</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">SendOrPostCallback d, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> state</span></span></span><span class="hljs-function">)</span></span> =&gt; _semaphore.WaitAsync().ContinueWith(<span class="hljs-keyword"><span class="hljs-keyword">delegate</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { d(state); } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { _semaphore.Release(); } }, <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>, TaskContinuationOptions.None, TaskScheduler.Default); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Send</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">SendOrPostCallback d, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> state</span></span></span><span class="hljs-function">)</span></span> { _semaphore.Wait(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { d(state); } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { _semaphore.Release(); } } }</code> </pre> <br>  XUnit рдврд╛рдВрдЪреЗ рдореЗрдВ SynchronizationContext <a href="" rel="nofollow">рдХрд╛</a> рд╕рдорд╛рди <a href="" rel="nofollow">рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╣реИ</a> ред  рдпрд╣рд╛рдВ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рдорд╛рдирд╛рдВрддрд░ рдкрд░реАрдХреНрд╖рдгреЛрдВ рд╕реЗ рдЬреБрдбрд╝реЗ рдХреЛрдб рдХреА рдорд╛рддреНрд░рд╛ рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br>  рдпрд╣рд╛рдВ рдлрд╛рдпрджреЗ рдХрд┐рд╕реА рднреА рдЕрдореВрд░реНрдд рдХреЗ рд╕рд╛рде рд╕рдорд╛рди рд╣реИрдВ: рдПрдХ рдПрдХрд▓ рдПрдкреАрдЖрдИ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╡рд┐рд╡рд░рдг рдХреЛ рдЬрд╛рдирдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЗ рдмрд┐рдирд╛, рдкреНрд░реЛрдЧреНрд░рд╛рдорд░ рдХреА рдЗрдЪреНрдЫрд╛рдиреБрд╕рд╛рд░ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд▓рд┐рдП рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдХреЛ рдХрддрд╛рд░ рдореЗрдВ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдорд╛рди рд▓реАрдЬрд┐рдП рдореИрдВ рдПрдХ рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓рд┐рдЦрддрд╛ рд╣реВрдБ рдЬрд╣рд╛рдБ рдореБрдЭреЗ рдХреБрдЫ рдХрд╛рдо рдХрд░рдиреЗ рдХреА рдЬрд╝рд░реВрд░рдд рд╣реЛрддреА рд╣реИ рдФрд░ рдлрд┐рд░ рдПрдХ рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдХреЛ рдореВрд▓ рд╕рдВрджрд░реНрдн рдореЗрдВ рд╡рд╛рдкрд╕ рднреЗрдЬрдирд╛ рдЪрд╛рд╣рд┐рдПред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдореБрдЭреЗ рдЗрд╕рдХреЗ <code>SynchronizationContext</code> рдкрд░ рдХрдмреНрдЬрд╛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдФрд░ рдЬрдм рдореБрдЭреЗ рдкреВрд░рд╛ рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рддреЛ рдореБрдЭреЗ рдЗрд╕ рд╕рдВрджрд░реНрдн рдХреА <code>Post</code> рд╡рд┐рдзрд┐ рдХреЛ рдХреЙрд▓ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдЗрд╕реЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд▓рд┐рдП рдПрдХ рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдХреЛ рдкрд╛рд╕ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред  рдореБрдЭреЗ рдпрд╣ рдЬрд╛рдирдиреЗ рдХреА рдЬрд░реВрд░рдд рдирд╣реАрдВ рд╣реИ рдХрд┐ рд╡рд┐рдВрдбреЛрдЬ рдлреЙрд░реНрдо рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ <code>Dispatcher</code> рд╕реЗ <code>BeginInvoke</code> рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <code>Control</code> рдФрд░ рдЗрд╕рдХреЗ <code>BeginInvoke</code> рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдпрд╛ рдХрд┐рд╕реА рддрд░рд╣ рдПрдХреНрд╕рдпреВрдирд╛рдЗрдЯ рдХреЗ рд▓рд┐рдП рд╕рдВрджрд░реНрдн рдФрд░ рдЗрд╕рдХреА рдХрддрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред  рдореБрдЭреЗ рдХреЗрд╡рд▓ рд╡рд░реНрддрдорд╛рди <code>SynchronizationContext</code> рдХреЛ рд╣рдерд┐рдпрд╛рдиреЗ рдФрд░ рдмрд╛рдж рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, <code>SynchronizationContext</code> рдореЗрдВ <code>Current</code> рдЧреБрдг рд╣реЛрддрд╛ рд╣реИред  рдЗрд╕реЗ рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DoWork</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Action worker, Action completion</span></span></span><span class="hljs-function">)</span></span> { SynchronizationContext sc = SynchronizationContext.Current; ThreadPool.QueueUserWorkItem(_ =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { worker(); } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { sc.Post(_ =&gt; completion(), <span class="hljs-literal"><span class="hljs-literal">null</span></span>); } }); }</code> </pre> <br>  рдЖрдк <code>SynchronizationContext.SetSynchronizationContext</code> рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ <code>Current</code> рд╕рдВрдкрддреНрддрд┐ рд╕реЗ рдПрдХ рд╡рд┐рд╢реЗрд╖ рд╕рдВрджрд░реНрдн рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><h3>  рдХрд╛рд░реНрдп рдЕрдиреБрд╕реВрдЪрдХ рдХреНрдпрд╛ рд╣реИ? </h3><br>  <code>SynchronizationContext</code> "рдЕрдиреБрд╕реВрдЪрдХ" рдХреЗ рд▓рд┐рдП рдПрдХ рдЖрдо рдЕрдореВрд░реНрдд рд╣реИред  рдХреБрдЫ рдврд╛рдВрдЪреЗ рдЗрд╕рдХреЗ рд▓рд┐рдП рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдЕрдореВрд░реНрдд рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ <code>System.Threading.Tasks</code> рдХреЛрдИ рдЕрдкрд╡рд╛рдж рдирд╣реАрдВ рд╣реИред  рдЬрдм <code>Task</code> рдореЗрдВ рдкреНрд░рддрд┐рдирд┐рдзрд┐рдпреЛрдВ рдХреЛ рдХрддрд╛рд░рдмрджреНрдз рдФрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рд╡реЗ <code>System.Threading.Tasks.TaskScheduler</code> рдХреЗ рд╕рд╛рде рдЬреБрдбрд╝реЗ рд╣реЛрддреЗ рд╣реИрдВред  рдПрдХ рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдХреЛ рдкрдВрдХреНрддрд┐рдмрджреНрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЖрднрд╛рд╕реА <code>Post</code> рд╡рд┐рдзрд┐ рднреА рд╣реИ (рдорд╛рдирдХ рддрдВрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдХреЙрд▓ рдХреЛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ), <code>TaskScheduler</code> рдПрдХ рд╕рд╛рд░ <code>QueueTask</code> рд╡рд┐рдзрд┐ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ ( <code>QueueTask</code> рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдХрд╛рд░реНрдп рдХреЙрд▓ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ <code>ExecuteTask</code> рд╣реИ)ред <br><br>  рдХрд╛рд░реНрдп рд╢реЗрдбреНрдпреВрд▓рд░ <code>TaskScheduler.Default</code> рдХреЛ рд▓реМрдЯрд╛рдиреЗ <code>TaskScheduler.Default</code> рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╢реЗрдбреНрдпреВрд▓рд░ рдПрдХ рдереНрд░реЗрдб рдкреВрд▓ рд╣реИред  <code>TaskScheduler</code> рд╕реЗ <code>Task</code> рдХреЙрд▓ рдХреЗ рд╕рдордп рдФрд░ рд╕реНрдерд╛рди рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рддрд░реАрдХреЛрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдФрд░ рдУрд╡рд░рд░рд╛рдЗрдб рдХрд░рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдХреЛрд░ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдореЗрдВ <code>System.Threading.Tasks.ConcurrentExclusiveSchedulerPair</code> рдЯрд╛рдЗрдк рд╣реЛрддрд╛ рд╣реИред  рдЗрд╕ рд╡рд░реНрдЧ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рджреЛ <code>TaskScheduler</code> рдЧреБрдг рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ: <code>ExclusiveScheduler</code> рдФрд░ <code>TaskScheduler</code> ред  <code>ConcurrentScheduler</code> рдореЗрдВ рд╢реЗрдбреНрдпреВрд▓ рдХрд┐рдП рдЧрдП рдХрд╛рд░реНрдп рд╕рдорд╛рдирд╛рдВрддрд░ рдореЗрдВ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЬрдм рдпрд╣ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ ( <code>MaxConcurrencySynchronizationContext</code> рд╕рдорд╛рди) <code>ConcurrentExclusiveSchedulerPair</code> рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдкреНрд░рддрд┐рдмрдВрдз рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрддреЗ рд╣реБрдПред  рдпрджрд┐ <code>ExclusiveScheduler</code> рдореЗрдВ рдХрд╛рд░реНрдп рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдХреЛрдИ <code>ConcurrentScheduler</code> рдХрд╛рд░реНрдп рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рдХреЗрд╡рд▓ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдХрд╛рд░реНрдп рдХреЛ рдПрдХ рд╕рдордп рдореЗрдВ рдЪрд▓рд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИред  рдпрд╣ рд╡реНрдпрд╡рд╣рд╛рд░ рдмрд╣реБрдд рдХреБрдЫ рдкрдврд╝рдиреЗ / рд▓рд┐рдЦрдиреЗ рдХреЗ рддрд╛рд▓рд╛ рдХреЗ рд╕рдорд╛рди рд╣реИред <br><br>  <code>SynchronizationContext</code> <code>TaskScheduler</code> рдХреА рддрд░рд╣, <code>TaskScheduler</code> рдореЗрдВ рдПрдХ <code>Current</code> рдкреНрд░реЙрдкрд░реНрдЯреА рд╣реЛрддреА рд╣реИ рдЬреЛ рдХрд░рдВрдЯ <code>TaskScheduler</code> рд╡рд╛рдкрд╕ <code>TaskScheduler</code> ред  рд╣рд╛рд▓рд╛рдБрдХрд┐, <code>SynchronizationContext</code> рд╡рд┐рдкрд░реАрдд, рдЗрд╕рдореЗрдВ рд╡рд░реНрддрдорд╛рди рдЕрдиреБрд╕реВрдЪрдХ рдХреЛ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рдзрд┐ рдХрд╛ рдЕрднрд╛рд╡ рд╣реЛрддрд╛ рд╣реИред  рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, рд╢реЗрдбреНрдпреВрд▓рд░ рд╡рд░реНрддрдорд╛рди рдХрд╛рд░реНрдп рдХреЗ рд╕рд╛рде рдЬреБрдбрд╝рд╛ рд╣реБрдЖ рд╣реИред  рдЗрд╕рд▓рд┐рдП, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрд╣ рдкреНрд░реЛрдЧреНрд░рд╛рдо <code>True</code> рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░реЗрдЧрд╛, рдХреНрдпреЛрдВрдХрд┐ <code>StartNew</code> рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рд▓реИрдореНрдмреНрдбрд╛ рдХреЛ <code>ConcurrentExclusiveSchedulerPair</code> рдХреЗ <code>ExclusiveScheduler</code> рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ <code>TaskScheduler.Current</code> рдЗрд╕ рдЕрдиреБрд╕реВрдЪрдХ рдкрд░ рд╕реНрдерд╛рдкрд┐рдд рд╣реЛрддрд╛ рд╣реИ: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Threading.Tasks; <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cesp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConcurrentExclusiveSchedulerPair(); Task.Factory.StartNew(() =&gt; { Console.WriteLine(TaskScheduler.Current == cesp.ExclusiveScheduler); }, <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>, TaskCreationOptions.None, cesp.ExclusiveScheduler).Wait(); } }</code> </pre> <br>  рджрд┐рд▓рдЪрд╕реНрдк рдмрд╛рдд рдпрд╣ рд╣реИ рдХрд┐ <code>TaskScheduler</code> рдПрдХ рд╕реНрдерд┐рд░ <code>FromCurrentSynchronizationContext</code> рд╡рд┐рдзрд┐ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред  рдпрд╣ рд╡рд┐рдзрд┐ рдПрдХ рдирдпрд╛ <code>TaskScheduler</code> рдФрд░ рдпрд╣ <code>Post</code> рдкрджреНрдзрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓реМрдЯреЗ <code>SynchronizationContext.Current</code> рдХреЙрдиреНрдЯреЗрдХреНрд╕реНрдЯ.рдХрдВрдЯрд░реНрдирд▓ рд╕рдВрджрд░реНрдн рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд▓рд┐рдП рдХрд╛рд░реНрдпреЛрдВ рдХреЛ <code>TaskScheduler</code> рдХрд░рддреА рд╣реИред <br><br><h3>  SynchronizationContext рдФрд░ TaskScheduler рдХреИрд╕реЗ рдкреНрд░рддреАрдХреНрд╖рд╛ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИрдВ? </h3><br>  рдорд╛рди рд▓реАрдЬрд┐рдП рдХрд┐ рдЖрдкрдХреЛ рдПрдХ рдмрдЯрди рдХреЗ рд╕рд╛рде рдПрдХ рдпреВрдЖрдИ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд▓рд┐рдЦрдирд╛ рд╣реИред  рдмрдЯрди рджрдмрд╛рдиреЗ рд╕реЗ рд╡реЗрдмрд╕рд╛рдЗрдЯ рд╕реЗ рдЯреЗрдХреНрд╕реНрдЯ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рд╢реБрд░реВ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдпрд╣ <code>Content</code> рдмрдЯрди рдкрд░ рд╕реЗрдЯ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред  рдмрдЯрди рдХреЗрд╡рд▓ рдЙрд╕ рд╕реНрдЯреНрд░реАрдо рдХреЗ UI рд╕реЗ рд╕реБрд▓рдн рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕рдореЗрдВ рд╡рд╣ рд╕реНрдерд┐рдд рд╣реИ, рдЗрд╕рд▓рд┐рдП, рдЬрдм рд╣рдо рджрд┐рдирд╛рдВрдХ рдФрд░ рд╕рдордп рдХреЛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рд▓реЛрдб рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдмрдЯрди рдХреА <code>Content</code> рдореЗрдВ рд░рдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рдЙрд╕ рд╕реНрдЯреНрд░реАрдо рд╕реЗ рдпрд╣ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрд╕ рдкрд░ рдирд┐рдпрдВрддреНрд░рдг рд╣реИред  рдпрджрд┐ рдпрд╣ рд╢рд░реНрдд рдкреВрд░реА рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ, рддреЛ рд╣рдореЗрдВ рдПрдХ рдЕрдкрд╡рд╛рдж рдорд┐рд▓реЗрдЧрд╛: <br><br><pre> <code class="cs hljs">System.InvalidOperationException: <span class="hljs-string"><span class="hljs-string">'        ,     .'</span></span></code> </pre><br>  рд╣рдо <code>Content</code> рдХреЛ рд╕реНрд░реЛрдд рд╕рдВрджрд░реНрдн рдореЗрдВ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <code>SynchronizationContext</code> <code>TaskScheduler</code> рдЙрдкрдпреЛрдЧ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП <code>TaskScheduler</code> рдорд╛рдзреНрдпрдо рд╕реЗ: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> HttpClient s_httpClient = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpClient(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">downloadBtn_Click</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, RoutedEventArgs e</span></span></span><span class="hljs-function">)</span></span> { s_httpClient.GetStringAsync(<span class="hljs-string"><span class="hljs-string">"http://example.com/currenttime"</span></span>).ContinueWith(downloadTask =&gt; { downloadBtn.Content = downloadTask.Result; }, TaskScheduler.FromCurrentSynchronizationContext()); }</code> </pre> <br>  рдФрд░ рд╣рдо рд╕реАрдзреЗ <code>SynchronizationContext</code> рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> HttpClient s_httpClient = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpClient(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">downloadBtn_Click</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, RoutedEventArgs e</span></span></span><span class="hljs-function">)</span></span> { SynchronizationContext sc = SynchronizationContext.Current; s_httpClient.GetStringAsync(<span class="hljs-string"><span class="hljs-string">"http://example.com/currenttime"</span></span>).ContinueWith(downloadTask =&gt; { sc.Post(<span class="hljs-keyword"><span class="hljs-keyword">delegate</span></span> { downloadBtn.Content = downloadTask.Result; }, <span class="hljs-literal"><span class="hljs-literal">null</span></span>); }); }</code> </pre> <br>  рд╣рд╛рд▓рд╛рдБрдХрд┐, рдпреЗ рджреЛрдиреЛрдВ рд╡рд┐рдХрд▓реНрдк рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдХреЙрд▓рдмреИрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, рд╣рдо <code>async</code> / <code>await</code> рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> HttpClient s_httpClient = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpClient(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">downloadBtn_Click</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, RoutedEventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> text = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> s_httpClient.GetStringAsync(<span class="hljs-string"><span class="hljs-string">"http://example.com/currenttime"</span></span>); downloadBtn.Content = text; }</code> </pre> <br>  рдпрд╣ рд╕рдм "рдмрд╕ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ" рдФрд░ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдпреВрдЖрдИ рдереНрд░реЗрдб рдореЗрдВ <code>Content</code> рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдП рдЧрдП рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рдХрд╛рд░реНрдп рдХреЗ рд▓рд┐рдП рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рдирд╛ <code>SynchronizationContext.Current</code> <code>TaskScheduler.Current</code> рдФрд░ <code>TaskScheduler.Current</code> рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИред  рдЬрдм рдЖрдк C # рдореЗрдВ рдХреБрдЫ "рдЙрдореНрдореАрдж" рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╕рдВрдХрд▓рдХ рдорддрджрд╛рди рдХреЗ рд▓рд┐рдП рдХреЛрдб рдХреЛ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддрд╛ рд╣реИ ( <code>GetAwaiter</code> рдХреЛ рдХреЙрд▓ <code>GetAwaiter</code> ) "рдЕрдкреЗрдХреНрд╖рд┐рдд" (рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдХрд╛рд░реНрдп) рдХреЛ "рдкреНрд░рддреАрдХреНрд╖рд╛" ( <code>TaskAwaiter</code> )ред  "рдкреНрд░рддреАрдХреНрд╖рд╛" рдХреЙрд▓рдмреИрдХ рд╕рдВрд▓рдЧреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд╝рд┐рдореНрдореЗрджрд╛рд░ рд╣реИ (рдЬрд┐рд╕реЗ рдЕрдХреНрд╕рд░ "рдирд┐рд░рдВрддрд░рддрд╛" рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ) рдЬреЛ рдкреНрд░рддреАрдХреНрд╖рд╛ рдкреВрд░реА рд╣реЛрдиреЗ рдкрд░ рд░рд╛рдЬреНрдп рдорд╢реАрди рдХреЛ рд╡рд╛рдкрд╕ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИред  рд╡рд╣ рдХреЙрд▓рдмреИрдХ рдкрдВрдЬреАрдХрд░рдг рдХреЗ рджреМрд░рд╛рди рдХреИрдкреНрдЪрд░ рдХрд┐рдП рдЧрдП рд╕рдВрджрд░реНрдн / рдЕрдиреБрд╕реВрдЪрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕реЗ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИред  рд╣рдо рдЗрд╕реЗ рдереЛрдбрд╝рд╛ рдЕрдиреБрдХреВрд▓рд┐рдд рдФрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВрдЧреЗ, рдпрд╣ рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рд╣реИ: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">object</span></span> scheduler = SynchronizationContext.Current; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (scheduler <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; TaskScheduler.Current != TaskScheduler.Default) { scheduler = TaskScheduler.Current; }</code> </pre> <br>  рдпрд╣рд╛рдВ, рдпрд╣ рдкрд╣рд▓реЗ рдЪреЗрдХ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ <code>SynchronizationContext</code> <code>TaskScheduler</code> <code>SynchronizationContext</code> , рдФрд░ рдпрджрд┐ рдирд╣реАрдВ, рддреЛ рдХреНрдпрд╛ рдХреЛрдИ рдЧреИрд░-рдорд╛рдирдХ <code>TaskScheduler</code> ред  рдпрджрд┐ рдПрдХ рд╣реИ, рддреЛ рдЬрдм рдХреЙрд▓рдмреИрдХ рдХреЙрд▓ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд╣реИ, рддреЛ рдХреИрдкреНрдЪрд░ рдХрд┐рдП рдЧрдП рд╢реЗрдбреНрдпреВрд▓рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛;  рдпрджрд┐ рдирд╣реАрдВ, рддреЛ рдХреЙрд▓рдмреИрдХ рдСрдкрд░реЗрд╢рди рдХреЗ рд╣рд┐рд╕реНрд╕реЗ рдХреЗ рд░реВрдк рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдЬреЛ рдЕрдкреЗрдХреНрд╖рд┐рдд рдХрд╛рд░реНрдп рдкреВрд░рд╛ рдХрд░рддрд╛ рд╣реИред <br><br><h3>  рдХреЙрдиреНрдлрд╝рд┐рдЧрд░рд╡рд┐рдЯ рдХреНрдпрд╛ рдХрд░рддрд╛ рд╣реИ (рдЭреВрдард╛) </h3><br>  <code>ConfigureAwait</code> рд╡рд┐рдзрд┐ рд╡рд┐рд╢реЗрд╖ рдирд╣реАрдВ рд╣реИ: рдпрд╣ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рддрд░реАрдХреЗ рд╕реЗ рд╕рдВрдХрд▓рдХ рдпрд╛ рд░рдирдЯрд╛рдЗрдо рджреНрд╡рд╛рд░рд╛ рдорд╛рдиреНрдпрддрд╛ рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рд╣реИред  рдпрд╣ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рдзрд┐ рд╣реИ рдЬреЛ рдПрдХ рд╕рдВрд░рдЪрдирд╛ рд▓реМрдЯрд╛рддрд╛ рд╣реИ ( <code>ConfiguredTaskAwaitable</code> - рдореВрд▓ рдХрд╛рд░реНрдп рдХреЛ рд▓рдкреЗрдЯрддрд╛ рд╣реИ) рдФрд░ рдмреВрд▓рд┐рдпрди рдорд╛рди рд▓реЗрддрд╛ рд╣реИред  рдпрд╛рдж рд░рдЦреЗрдВ рдХрд┐ <code>await</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рд╕реА рднреА рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕рд╛рде рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рд╕рд╣реА рдкреИрдЯрд░реНрди рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИред  рдпрджрд┐ рджреВрд╕рд░рд╛ рдкреНрд░рдХрд╛рд░ рд▓реМрдЯрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЬрдм рд╕рдВрдХрд▓рдХ рдХреЛ <code>GetAwaiter</code> рд╡рд┐рдзрд┐ (рдкреИрдЯрд░реНрди рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛) рдХрд╛ рдЙрдкрдпреЛрдЧ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдХреНрдпрд╛ рдпрд╣ <code>ConfigureAwait</code> рдкреНрд░рдХрд╛рд░ рд╕реЗ рд▓реМрдЯрд╛рдП рдЧрдП рдкреНрд░рдХрд╛рд░ рд╕реЗ рд╣реИ, рдФрд░ рд╕реАрдзреЗ рдХрд╛рд░реНрдп рд╕реЗ рдирд╣реАрдВред  рдпрд╣ рдЖрдкрдХреЛ рдЗрд╕ рд╡рд┐рд╢реЗрд╖ рд╡реЗрдЯрд░ рдХреЗ рд▓рд┐рдП <code>await</code> рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рдмрджрд▓рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред <br><br>  <code>ConfigureAwait(continueOnCapturedContext: false)</code> рджреНрд╡рд╛рд░рд╛ рд▓реМрдЯрд╛рдП рдЧрдП рдкреНрд░рдХрд╛рд░ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп <code>Task</code> рд▓рд┐рдП рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рдиреЗ рд╕реЗ рд╕реАрдзреЗ рдКрдкрд░ рдЪрд░реНрдЪрд╛ рдХреА рдЧрдИ рд╕рдВрджрд░реНрдн / рдЕрдиреБрд╕реВрдЪрдХ рдХреИрдкреНрдЪрд░ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдкреНрд░рднрд╛рд╡рд┐рдд рд╣реЛрддрд╛ рд╣реИред  рддрд░реНрдХ рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рдмрдирддрд╛ рд╣реИ: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">object</span></span> scheduler = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (continueOnCapturedContext) { scheduler = SynchronizationContext.Current; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (scheduler <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; TaskScheduler.Current != TaskScheduler.Default) { scheduler = TaskScheduler.Current; } }</code> </pre> <br>  рджреВрд╕рд░реЗ рд╢рдмреНрджреЛрдВ рдореЗрдВ, <code>false</code> рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддреЗ <code>false</code> , рднрд▓реЗ рд╣реА рдХреЙрд▓рдмреИрдХ рдХреЗ рд▓рд┐рдП рд╡рд░реНрддрдорд╛рди рд╕рдВрджрд░реНрдн рдпрд╛ рд╢реЗрдбреНрдпреВрд▓рд░ рд╣реЛ, рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдпрд╣ рдЕрдиреБрдкрд╕реНрдерд┐рдд рд╣реИред <br><br><h3>  рдореБрдЭреЗ рдХрдиреНрдлрд┐рдЧрд░рдПрд╡рд┐рдЯ (рдЧрд▓рдд) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреНрдпреЛрдВ рд╣реИ? </h3><br>  <code>ConfigureAwait(continueOnCapturedContext: false)</code> рдЙрдкрдпреЛрдЧ рдХреЙрд▓рдмреИрдХ рдХреЛ рд╕реНрд░реЛрдд рд╕рдВрджрд░реНрдн рдпрд╛ рд╢реЗрдбреНрдпреВрд▓рд░ рдореЗрдВ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЗрд╕рд╕реЗ рд╣рдореЗрдВ рдХрдИ рдлрд╛рдпрджреЗ рдорд┐рд▓рддреЗ рд╣реИрдВ: <br><br>  <b>рдкреНрд░рджрд░реНрд╢рди рдореЗрдВ рд╕реБрдзрд╛рд░ред</b>  рдХреЙрд▓рд┐рдВрдЧ рдХреЛ рдкрдВрдХреНрддрд┐рдмрджреНрдз рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдУрд╡рд░рд╣реЗрдб рд╣реИ, рдХреЗрд╡рд▓ рдХреЙрд▓рд┐рдВрдЧ рдХреЗ рд╡рд┐рдкрд░реАрдд, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рдХреЗ рд▓рд┐рдП рдЕрддрд┐рд░рд┐рдХреНрдд рдХрд╛рдо (рдФрд░ рдЖрдорддреМрд░ рдкрд░ рдЕрддрд┐рд░рд┐рдХреНрдд рдЖрд╡рдВрдЯрди) рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╣рдо рд░рдирдЯрд╛рдЗрдо рдореЗрдВ рдЕрдиреБрдХреВрд▓рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рд╣рдо рдЕрдзрд┐рдХ рдЕрдиреБрдХреВрд▓рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрдм рд╣рдо рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рдХреЙрд▓рдмреИрдХ рдХреИрд╕реЗ рдХрд╣рд╛ рдЬрд╛рдПрдЧрд╛, рд▓реЗрдХрд┐рди рдЕрдЧрд░ рдпрд╣ рдЕрдореВрд░реНрдд рдХреЗ рдордирдорд╛рдиреЗ рдврдВрдЧ рд╕реЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рд▓рд┐рдП рдкрд╛рд░рд┐рдд рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдХрднреА-рдХрднреА рдпрд╣ рдкреНрд░рддрд┐рдмрдВрдз рд▓рдЧрд╛рддрд╛ рд╣реИ)ред  рднрд╛рд░реА рд▓реЛрдб рд╡рд╛рд▓реЗ рд╡рд░реНрдЧреЛрдВ рдХреЗ рд▓рд┐рдП, рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рд╡рд░реНрддрдорд╛рди <code>SynchronizationContext</code> <code>TaskScheduler</code> рдФрд░ рд╡рд░реНрддрдорд╛рди <code>TaskScheduler</code> (рджреЛрдиреЛрдВ рдЬрд┐рдирдореЗрдВ рд╕реЗ рд╕реНрдерд┐рд░ рдкреНрд░рд╡рд╛рд╣ рддрдХ рдкрд╣реБрдВрдЪ рд╣реЛрддреА рд╣реИ) рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреА рдЕрддрд┐рд░рд┐рдХреНрдд рд▓рд╛рдЧрдд рдХрд╛рдлреА рдЕрдзрд┐рдХ рдмрдврд╝ рд╕рдХрддреА рд╣реИред  рдпрджрд┐ <code>await</code> рдХреЗ рдмрд╛рдж рдХреЗ рдХреЛрдб рдХреЛ рдореВрд▓ рд╕рдВрджрд░реНрдн рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ, рддреЛ <code>ConfigureAwait(false)</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЗрди рд╕рднреА рдЦрд░реНрдЪреЛрдВ рд╕реЗ рдмрдЪрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕реЗ рдЕрдирд╛рд╡рд╢реНрдпрдХ рд░реВрдк рд╕реЗ рдкрдВрдХреНрддрд┐рдмрджреНрдз рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рд╕рднреА рдЙрдкрд▓рдмреНрдз рдЕрдиреБрдХреВрд▓рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рд╕реНрдЯреНрд░реАрдо рд╕реНрдЯреЗрдЯрд┐рдХреНрд╕ рддрдХ рдЕрдирд╛рд╡рд╢реНрдпрдХ рдкрд╣реБрдВрдЪ рднреА рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  <b>рдЧрддрд┐рд░реЛрдз рдирд┐рд╡рд╛рд░рдг</b>  рдЙрд╕ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд╡рд┐рдзрд┐ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ рдЬрд┐рд╕рдХрд╛ <code>await</code> рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗ рдХреБрдЫ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреЗ <code>await</code> рдХрд░рддрд╛ рд╣реИред  рдЖрдк рдЗрд╕ рд╡рд┐рдзрд┐ рдХреЛ рдХрд╣рддреЗ рд╣реИрдВ рдФрд░ рд╕рд┐рдВрдХреНрд░реЛрдирд╛рдЗрдЬрд╝реНрдб рдмреНрд▓реЙрдХ рдХрд░рддреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЯрд╛рд╕реНрдХ рдХреЗ рдкреВрд░рд╛ рд╣реЛрдиреЗ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░ рд░рд╣реЗ рд╣реИрдВред  рдЕрдм рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ рдХрд┐ рдХреНрдпрд╛ рд╣реЛрддрд╛ рд╣реИ рдпрджрд┐ рдХреЙрд▓ рддрдм рд╣реЛрддрд╛ рд╣реИ рдЬрдм рд╡рд░реНрддрдорд╛рди <code>SynchronizationContext</code> рдХреЙрдирдЯреЗрдХреНрд╕реНрдЯ рдЗрд╕рдореЗрдВ рдСрдкрд░реЗрд╢рди рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЛ 1 рддрдХ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ <code>MaxConcurrencySynchronizationContext</code> рдХреЙрдиреНрдЯреЗрдХреНрд╕реНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реАрдорд┐рдд рдХрд░рддрд╛ рд╣реИ, рдпрд╛ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рд░реВрдк рд╕реЗ, рдЕрдЧрд░ рдпрд╣ рдПрдХ рд╕рдВрджрд░реНрдн рдХреЗ рд▓рд┐рдП рдПрдХ рдПрдХрд▓ рдереНрд░реЗрдб рдХреЗ рд╕рд╛рде рдПрдХ рд╕рдВрджрд░реНрдн рд╣реИ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рдпреВрдЖрдИ рдереНрд░реЗрдб)ред  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдЖрдк рдПрдХ рдПрдХрд▓ рдереНрд░реЗрдб рдореЗрдВ рд╡рд┐рдзрд┐ рдХреЛ рдХреЙрд▓ рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ рдлрд┐рд░ рдЗрд╕реЗ рдмреНрд▓реЙрдХ рдХрд░рддреЗ рд╣реИрдВ, рдСрдкрд░реЗрд╢рди рдкреВрд░рд╛ рд╣реЛрдиреЗ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░ рд░рд╣реЗ рд╣реИрдВред  рдбрд╛рдЙрдирд▓реЛрдб рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдЗрд╕рдХреЗ рдкреВрд░рд╛ рд╣реЛрдиреЗ рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд░рддрд╛ рд╣реИред  рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, <code>Task</code> рд▓рд┐рдП рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рдиреЗ рд╕реЗ рд╡рд░реНрддрдорд╛рди <code>SynchronizationContext</code> (рдФрд░ рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ) рдкрд░ рдХрдмреНрдЬрд╛ <code>Task</code> , рдФрд░ рдЬрдм рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдкреВрд░рд╛ рд╣реЛ рдЬрд╛рдПрдЧрд╛, рддреЛ рдЗрд╕реЗ рд╡рд╛рдкрд╕ <code>SynchronizationContext</code> рдХреЙрдиреНрдЯреЗрдХреНрд╕реНрдЯ рдХреЙрд▓рдмреИрдХ рдореЗрдВ рдХрддрд╛рд░рдмрджреНрдз рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЬреЛ рдмрд╛рдХреА рдСрдкрд░реЗрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░реЗрдЧрд╛ред  рд▓реЗрдХрд┐рди рдПрдХрдорд╛рддреНрд░ рдзрд╛рдЧрд╛ рдЬреЛ рдХрддрд╛рд░ рдореЗрдВ рдХреЙрд▓рдмреИрдХ рдХреЛ рд╕рдВрднрд╛рд▓ рд╕рдХрддрд╛ рд╣реИ, рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдСрдкрд░реЗрд╢рди рдХреЗ рдкреВрд░рд╛ рд╣реЛрдиреЗ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рддреЗ рд╕рдордп рдЕрд╡рд░реБрджреНрдз рд╣реИред  рдФрд░ рдпрд╣ рдСрдкрд░реЗрд╢рди рддрдм рддрдХ рдкреВрд░рд╛ рдирд╣реАрдВ рд╣реЛрдЧрд╛ рдЬрдм рддрдХ рдХрд┐ рдХреЙрд▓рдмреИрдХ рд╕рдВрд╕рд╛рдзрд┐рдд рди рд╣реЛ рдЬрд╛рдПред  рдЧрддрд┐рд░реЛрдз!  рдпрд╣ рддрдм рднреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдЬрдм рд╕рдВрджрд░реНрдн рд╕рдВрдЧрд╛рдорд┐рддрд┐ рдХреЛ 1 рддрдХ рд╕реАрдорд┐рдд рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╕рдВрд╕рд╛рдзрди рдХрд┐рд╕реА рддрд░рд╣ рд╕реЗ рд╕реАрдорд┐рдд рд╣реИрдВред  рдЙрд╕реА рд╕реНрдерд┐рддрд┐ рдХреА рдХрд▓реНрдкрдирд╛ рдХрд░реЗрдВ, рдХреЗрд╡рд▓ <code>MaxConcurrencySynchronizationContext</code> рд▓рд┐рдП 4 рдХреЗ рдорд╛рди рдХреЗ рд╕рд╛рдеред  рдСрдкрд░реЗрд╢рди рдХреЛ рдПрдХ рдмрд╛рд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп, рд╣рдо рд╕рдВрджрд░реНрдн рдХреЗ рд▓рд┐рдП 4 рдХреЙрд▓ рдХреА рдХрддрд╛рд░ рд▓рдЧрд╛рддреЗ рд╣реИрдВред  рдкреНрд░рддреНрдпреЗрдХ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЗрд╕рдХреЗ рдкреВрд░рд╛ рд╣реЛрдиреЗ рдХреА рдкреНрд░рддреНрдпрд╛рд╢рд╛ рдореЗрдВ рддрд╛рд▓реЗред  рд╕рднреА рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдЕрдм рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рддрд░реАрдХреЛрдВ рдХреЗ рдкреВрд░рд╛ рд╣реЛрдиреЗ рдХреЗ рдЗрдВрддрдЬрд╛рд░ рдореЗрдВ рдЕрд╡рд░реБрджреНрдз рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдФрд░ рдХреЗрд╡рд▓ рдПрдХ рдЪреАрдЬ рдЬреЛ рдЙрдиреНрд╣реЗрдВ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧреА, рдпрджрд┐ рдЗрд╕ рд╕рдВрджрд░реНрдн рдореЗрдВ рдЙрдирдХреЗ рдХреЙрд▓рдмреИрдХ рд╕рдВрд╕рд╛рдзрд┐рдд рд╣реЛрддреЗ рд╣реИрдВред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╡рд╣ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдХрдмреНрдЬрд╛ рдХрд░ рд▓рд┐рдпрд╛ рд╣реИред  рдлрд┐рд░ рд╕реЗ рдЧрддрд┐рд░реЛрдзред  рдпрджрд┐ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд╡рд┐рдзрд┐ <code>ConfigureAwait(false)</code> рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИ, рддреЛ рдпрд╣ рдХреЙрд▓рдмреИрдХ рдХреЛ рдореВрд▓ рд╕рдВрджрд░реНрдн рдореЗрдВ рдкрдВрдХреНрддрд┐рдмрджреНрдз рдирд╣реАрдВ рдХрд░реЗрдЧрд╛, рдЬреЛ рдЧрддрд┐рд░реЛрдз рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕реЗ рдмрдЪрдирд╛ рд╣реЛрдЧрд╛ред <br><br><h3>  рдХреНрдпрд╛ рдореБрдЭреЗ рдХреЙрдиреНрдлрд┐рдЧрд░рдПрд╡рд┐рдЯ (рд╕рддреНрдп) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? </h3><br>  рдирд╣реАрдВ, рдЬрдм рддрдХ рдХрд┐ рдЖрдкрдХреЛ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рд╕рдВрдХреЗрдд рджреЗрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рди рд╣реЛ рдХрд┐ рдЖрдк <code>ConfigureAwait(false)</code> (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╕реНрдереИрддрд┐рдХ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдЪреЗрддрд╛рд╡рдиреА рдЖрджрд┐ рдХреЛ рдЫрд┐рдкрд╛рдиреЗ рдХреЗ рд▓рд┐рдП <code>ConfigureAwait(false)</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░ рд░рд╣реЗ рд╣реИрдВред  <code>ConfigureAwait(true)</code> рдорд╣рддреНрд╡рдкреВрд░реНрдг рдирд╣реАрдВ рд╣реИред  рдпрджрд┐ рдЖрдк <code>await task</code> рдФрд░ <code>await task</code> рддреБрд▓рдирд╛ рдХрд░рддреЗ рд╣реИрдВред <code>await task.ConfigureAwait(true)</code> , рддреЛ рд╡реЗ рдХрд╛рд░реНрдпрд╛рддреНрдордХ рд░реВрдк рд╕реЗ рд╕рдорд╛рди рд╣реЛрдВрдЧреЗред  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдпрджрд┐ <code>ConfigureAwait(true)</code> рдХреЛрдб рдореЗрдВ рдореМрдЬреВрдж рд╣реИ, рддреЛ рдЗрд╕реЗ рдмрд┐рдирд╛ рдХрд┐рд╕реА рдирдХрд╛рд░рд╛рддреНрдордХ рдкрд░рд┐рдгрд╛рдо рдХреЗ рд╣рдЯрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред <br><br>  <code>ConfigureAwait</code> рд╡рд┐рдзрд┐ рдПрдХ рдмреВрд▓рд┐рдпрди рдорд╛рди рд▓реЗрддреА рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдХреБрдЫ рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЪрд░ рдХреЛ рдкрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред  рд▓реЗрдХрд┐рди 99% рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдорд╛рди рдЧрд▓рдд, <code>ConfigureAwait(false)</code> рд╕реЗрдЯ рд╣реИред <br><br><h3>  рдХрдиреНрдлрд┐рдЧрд░рд╡рд╛рдЗрдЯ (рдЧрд▓рдд) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрдм рдХрд░реЗрдВ? </h3><br>  рдпрд╣ рдЗрд╕ рдмрд╛рдд рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЖрдк рдПрдкреНрд▓рд┐рдХреЗрд╢рди-рд╕реНрддрд░реАрдп рдХреЛрдб рдпрд╛ рд╕рд╛рдорд╛рдиреНрдп-рдЙрджреНрджреЗрд╢реНрдп рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЛрдб рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВ рдпрд╛ рдирд╣реАрдВред <br><br>  рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд▓рд┐рдЦрддреЗ рд╕рдордп, рдХреБрдЫ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  рдпрджрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЙрдбрд▓ / рд╡рд╛рддрд╛рд╡рд░рдг (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╡рд┐рдВрдбреЛрдЬ рдлреЙрд░реНрдо, рдбрдмреНрд▓реНрдпреВрдкреАрдПрдл, рдПрдПрд╕рдкреАред рдХреЛрд░) рдПрдХ рд╡рд┐рд╢реЗрд╖ <code>SynchronizationContext</code> рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ, рддреЛ рдЗрд╕рдХреЗ рд▓рд┐рдП рд▓рдЧрднрдЧ рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рдПрдХ рдЕрдЪреНрдЫрд╛ рдХрд╛рд░рдг рд╣реИ: рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдХреЛрдб рдЖрдкрдХреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЙрдбрд▓ / рдкрд░реНрдпрд╛рд╡рд░рдг рдХреЗ рд╕рд╛рде рдЙрдЪрд┐рдд рдмрд╛рддрдЪреАрдд рдХреЗ рд▓рд┐рдП рд╕рд┐рдВрдХреНрд░реЛрдирд╛рдЗрдЬрд╝реЗрд╢рди рд╕рдВрджрд░реНрдн рдХрд╛ рдзреНрдпрд╛рди рд░рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдЖрдк Windows рдкреНрд░рдкрддреНрд░ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдореЗрдВ рдХреЛрдИ рдИрд╡реЗрдВрдЯ рд╣реИрдВрдбрд▓рд░ рд▓рд┐рдЦрддреЗ рд╣реИрдВ, xUnit рдореЗрдВ рдПрдХ рдкрд░реАрдХреНрд╖рдг, рдпрд╛ ASP.NET MVC рдирд┐рдпрдВрддреНрд░рдХ рдореЗрдВ рдХреЛрдб, рдЪрд╛рд╣реЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЙрдбрд▓ рдиреЗ <code>SynchronizationContext</code> рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд┐рдпрд╛ рд╣реЛ, рддреЛ рдпрджрд┐ рдХреЛрдИ рдореМрдЬреВрдж рд╣реИ рддреЛ рдЖрдкрдХреЛ <code>SynchronizationContext</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред  рдЗрд╕рдХрд╛ рдорддрд▓рдм рдпрд╣ рд╣реИ рдХрд┐ рдпрджрд┐ <code>ConfigureAwait(true)</code> рдФрд░ <code>await</code> , рддреЛ рдХреЙрд▓рдмреИрдХ / рдирд┐рд░рдВрддрд░рддрд╛ рдХреЛ рдореВрд▓ рд╕рдВрджрд░реНрдн рдореЗрдВ рд╡рд╛рдкрд╕ рднреЗрдЬ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ - рд╕рдм рдХреБрдЫ рд╡реИрд╕рд╛ рд╣реА рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рдЬреИрд╕рд╛ рдХрд┐ рдЗрд╕реЗ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  рдпрд╣рд╛рдВ рд╕реЗ рдЖрдк рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдирд┐рдпрдо рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ: <b>рдпрджрд┐ рдЖрдк рдПрдкреНрд▓рд┐рдХреЗрд╢рди-рд╕реНрддрд░реАрдп рдХреЛрдб рд▓рд┐рдЦрддреЗ рд╣реИрдВ, <i>рддреЛ</i> <code>ConfigureAwait(false)</code> <i>рдЙрдкрдпреЛрдЧ рди рдХрд░реЗрдВ</i></b> ред  рдЖрдЗрдП рдХреНрд▓рд┐рдХ рд╣реИрдВрдбрд▓рд░ рдкрд░ рд╡рд╛рдкрд╕ рдЬрд╛рдПрдВ: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> HttpClient s_httpClient = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpClient(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">downloadBtn_Click</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, RoutedEventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> text = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> s_httpClient.GetStringAsync(<span class="hljs-string"><span class="hljs-string">"http://example.com/currenttime"</span></span>); downloadBtn.Content = text; }</code> </pre> <br>  <code>downloadBtn.Content = text</code> рдореВрд▓ рд╕рдВрджрд░реНрдн рдореЗрдВ <code>downloadBtn.Content = text</code> рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдпрджрд┐ рдХреЛрдб рдиреЗ рдЗрд╕ рдирд┐рдпрдо рдХрд╛ рдЙрд▓реНрд▓рдВрдШрди рдХрд┐рдпрд╛ рд╣реИ рдФрд░ рдЗрд╕рдХреЗ рдмрдЬрд╛рдп <code>ConfigureAwait (false)</code> рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рд╣реИ, рддреЛ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдореВрд▓ рд╕рдВрджрд░реНрдн рдореЗрдВ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> HttpClient s_httpClient = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpClient(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">downloadBtn_Click</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, RoutedEventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> text = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> s_httpClient.GetStringAsync(<span class="hljs-string"><span class="hljs-string">"http://example.com/currenttime"</span></span>).ConfigureAwait(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  downloadBtn.Content = text; }</span></span></code> </pre> <br>  рдЗрд╕рд╕реЗ рдЕрдиреБрдЪрд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░ рд╣реЛрдЧрд╛ред  рд╡рд╣реА рдПрдХ рдХреНрд▓рд╛рд╕рд┐рдХ ASP.NET рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдореЗрдВ рдХреЛрдб рдкрд░ рд▓рд╛рдЧреВ рд╣реЛрддрд╛ рд╣реИ рдЬреЛ <code>HttpContext.Current</code> рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред  <code>ConfigureAwait(false)</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп, <code>Context.Current</code> рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ <code>ConfigureAwait(false)</code> рдмрд╛рдж рдХрд╛ рдкреНрд░рдпрд╛рд╕ рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЛ рдЬрдиреНрдо рджреЗ рд╕рдХрддрд╛ рд╣реИред <br><br>  рдпрд╣ рд╡рд╣реА рд╣реИ рдЬреЛ рд╕рд╛рдорд╛рдиреНрдп рдЙрджреНрджреЗрд╢реНрдп рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЛ рдЕрд▓рдЧ рдХрд░рддрд╛ рд╣реИред  рд╡реЗ рднрд╛рдЧ рдореЗрдВ рд╕рд╛рд░реНрд╡рднреМрдорд┐рдХ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ рдЙрд╕ рдкрд░реНрдпрд╛рд╡рд░рдг рдХреА рдкрд░рд╡рд╛рд╣ рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рдЙрдирдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЖрдк рдЙрдиреНрд╣реЗрдВ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реЗ, рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реЗ рдпрд╛ рдкрд░реАрдХреНрд╖рдг рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ - рдЗрд╕рд╕реЗ рдХреЛрдИ рдлрд░реНрдХ рдирд╣реАрдВ рдкрдбрд╝рддрд╛, рдХреНрдпреЛрдВрдХрд┐ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЛрдб рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЙрдбрд▓ рдХреЗ рд▓рд┐рдП рдЕрдЬреНрдЮреЗрдп рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдЕрдЬреНрдЮреЗрдп рдХрд╛ рдпрд╣ рднреА рдЕрд░реНрде рд╣реИ рдХрд┐ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдореЙрдбрд▓ рдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рднреА рдирд╣реАрдВ рдХрд░реЗрдЧрд╛, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрд╣ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдирд┐рдпрдВрддреНрд░рдг рддрдХ рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рдХрд░реЗрдЧрд╛, рдХреНрдпреЛрдВрдХрд┐ рд╕рд╛рдорд╛рдиреНрдп рдкреНрд░рдпреЛрдЬрди рдкреБрд╕реНрддрдХрд╛рд▓рдп рдЙрдирдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреБрдЫ рднреА рдирд╣реАрдВ рдЬрд╛рдирддрд╛ рд╣реИред  рдЪреВрдВрдХрд┐ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдХреЛрдб рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреА рдХреЛрдИ рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рд╣рдо рдореВрд▓ рд╕рдВрджрд░реНрдн рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░рдВрддрд░рддрд╛ / рдХреЙрд▓рдмреИрдХ рд╕реЗ рдмрдЪ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рд╣рдо <code>ConfigureAwait(false)</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдРрд╕рд╛ рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рд╣рдореЗрдВ рдкреНрд░рджрд░реНрд╢рди рд▓рд╛рдн рджреЗрддрд╛ рд╣реИ рдФрд░ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдпрддрд╛ рдмрдврд╝рд╛рддрд╛ рд╣реИред  рдпрд╣ рд╣рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреА рдУрд░ рд▓реЗ рдЬрд╛рддрд╛ рд╣реИ: <b>рдпрджрд┐ рдЖрдк рд╕рд╛рдорд╛рдиреНрдп-рдЙрджреНрджреЗрд╢реНрдп рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЛрдб рд▓рд┐рдЦ рд░рд╣реЗ рд╣реИрдВ, рддреЛ <code>ConfigureAwait(false)</code> рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ</b> ред  рдпрд╣реА рдХрд╛рд░рдг рд╣реИ рдХрд┐ .NET рдХреЛрд░ рд░рдирдЯрд╛рдЗрдо рд▓рд╛рдЗрдмреНрд░реЗрд░реАрдЬрд╝ рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ (рдпрд╛ рд▓рдЧрднрдЧ рд╣рд░) рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рддрд╛ рд╣реИ, ConfigureAwait (рдЧрд▓рдд) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ;  рдХреБрдЫ рдЕрдкрд╡рд╛рджреЛрдВ рдХреЗ рд╕рд╛рде, рдЬреЛ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рд╕рдВрднрд╛рд╡рдирд╛ рдХреАрдбрд╝реЗ рд╣реИрдВ, рдЙрдиреНрд╣реЗрдВ рдареАрдХ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред , <a href="https://github.com/dotnet/corefx/pull/38610" rel="nofollow"> PR</a>    <code>ConfigureAwait(false)</code>  <code>HttpClient</code> . <br><br>      . ,     (,   , ,   )      ,     API,     .   ,         ,       тАЭ "  . , ,    Where LINQ: <code>public static async IAsyncEnumerable&lt;T&gt; WhereAsync(this IAsyncEnumerable&lt;T&gt; source, Func&lt;T, bool&gt; predicate)</code> .   <code>predicate</code>    <code>SynchronizationContext</code>  ?     <code>WhereAsync</code> ,   ,        <code>ConfigureAwait(false)</code> . <br><br>       :  <code>ConfigureAwait(false)</code>      /app-model-agnostic . <br><br><h3>   ConfigureAwait (false),         ? </h3><br> ,  ,          .    ,    <code>await</code>      .    ,      ,      . ,    ,      ,   ,   <code>ConfigureAwait(false)</code> ,            ,     . <br><br><h3>    ConfigureAwait (false)       ,    тАФ ? </h3><br>  , .   FAQ.  <code>await task.ConfigureAwait(false)</code>  ,       (      ),   <code>ConfigureAwait(false)</code>  ,           -    ,    . <br><br>     ,   <code>await</code>    ,         ,    <code>SynchronizationContext</code>  <code>TaskScheduler</code> . , <code>CryptoStream</code>     .NET ,                 .      <code><a href="" rel="nofollow">awaiter</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдкрд╣рд▓реЗ рдкреНрд░рддреАрдХреНрд╖рд╛ рдХреЗ рдмрд╛рдж рдХреЛрдб рдереНрд░реЗрдб рдкреВрд▓ рдереНрд░реЗрдб рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рднреА, рдЖрдк рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ рдЕрдЧрд▓рд╛ рдЗрдВрддрдЬрд╛рд░ рдЕрднреА рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИ </font></font><code>ConfigureAwait(false)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">рддрдХрдиреАрдХреА рд░реВрдк рд╕реЗ, рдпрд╣ рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдХреЛрдб рд╕рдореАрдХреНрд╖рд╛ рдХреЛ рдмрд╣реБрдд рд╕рд░рд▓ рдХрд░рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╕рдордЭрдиреЗ рдХреА рдХреЛрдИ рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреНрдпреЛрдВ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ </font></font><code>ConfigureAwait(false)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреНрдпрд╛ ConfigureAwait (рдЧрд▓рдд) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП Task.Run рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ? </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣рд╛рдВ, рдпрджрд┐ рдЖрдк рд▓рд┐рдЦрддреЗ рд╣реИрдВ: </font></font><br><br><pre> <code class="cs hljs">Task.Run(<span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-keyword"><span class="hljs-keyword">delegate</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> SomethingAsync(); <span class="hljs-comment"><span class="hljs-comment">//     });</span></span></code> </pre> <br>  <code>ConfigureAwait(false)</code>  <code>SomethingAsync()</code>  ,   ,   <code>Task.Run</code>      ,       , <code>SynchronizationContext.Current</code>   <code>null</code> .  , <code>Task.Run</code>   <code>TaskScheduler.Default</code> ,  <code>TaskScheduler.Current</code>      <code>Default</code> .  ,  <code>await</code>        ,    <code>ConfigureAwait(false)</code> .        ,       .     : <br><br><pre> <code class="cs hljs">Task.Run(<span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-keyword"><span class="hljs-keyword">delegate</span></span> { SynchronizationContext.SetSynchronizationContext(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SomeCoolSyncCtx()); <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> SomethingAsync(); <span class="hljs-comment"><span class="hljs-comment">//    SomeCoolSyncCtx });</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддрдм рдХреЛрдб рдЕрдВрджрд░ </font></font><code>SomethingAsync</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ </font></font><code>SynchronizationContext.Current</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрджрд╛рд╣рд░рдг </font><font style="vertical-align: inherit;">рджреЗрдЦреЗрдЧрд╛ </font></font><code>SomeCoolSyncCtx</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред рдФрд░ рдпрд╣ </font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдФрд░ SomeAsync рдХреЗ рдЕрдВрджрд░ рдХреЛрдИ рднреА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХреА рдЧрдИ рдЕрдкреЗрдХреНрд╖рд╛рдПрдБ рдЗрд╕ рд╕рдВрджрд░реНрдн рдореЗрдВ рд╡рд╛рдкрд╕ рдирд╣реАрдВ рдХреА рдЬрд╛рдПрдВрдЧреАред рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдЗрд╕ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдпрд╣ рд╕рдордЭрдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдХрд┐ рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдХрддрд╛рд░ рдореЗрдВ рд░рдЦреЗ рдЧрдП рд╕рднреА рдХреЛрдб рдХреНрдпрд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдХреНрдпрд╛ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдХреНрдпрд╛ рдЗрд╕рдХреЗ рдХрд╛рд░реНрдп рдПрдХ рдмрд╛рдзрд╛ рдмрди рд╕рдХрддреЗ рд╣реИрдВред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдЕрддрд┐рд░рд┐рдХреНрдд рдХрд╛рд░реНрдп рдСрдмреНрдЬреЗрдХреНрдЯ рдмрдирд╛рдиреЗ / рдХрддрд╛рд░ рдмрдирд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЗ рдХрд╛рд░рдг рднреА рд╣реЛрддрд╛ рд╣реИред рдкреНрд░рджрд░реНрд╢рди рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рдпрд╣ рдПрдкреНрд▓рд┐рдХреЗрд╢рди / рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВред</font></font><br><br>    ,        ,  ,     . ,       ,    <code>ConfigureAwait(false)</code> <a href="https://docs.microsoft.com/en-us/visualstudio/code-quality/ca2007%3Fview%3Dvs-2019" rel="nofollow">CA2007</a> .    ,         <code>ConfigureAwait</code> ,   ,    .        , ,      -  ,            ,       <code>ConfigureAwait(false)</code> . <br><br><h3>    SynchronizationContext.SetSynchronizationContext,    ConfigureAwait (false)? </h3><br>  рдирд╣реАрдВред , .      <br><br>    : <br><br><pre> <code class="cs hljs">Task t; SynchronizationContext old = SynchronizationContext.Current; SynchronizationContext.SetSynchronizationContext(<span class="hljs-literal"><span class="hljs-literal">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { t = CallCodeThatUsesAwaitAsync(); <span class="hljs-comment"><span class="hljs-comment">// await'      } finally { SynchronizationContext.SetSynchronizationContext(old); } await t; //  -    </span></span></code> </pre> <br><br>  ,      <code>CallCodeThatUsesAwaitAsync</code>     <code>null</code> .   .       ,  <code>await</code>  <code>TaskScheduler.Current</code> .       <code>TaskScheduler</code> , <code>await</code> '  <code>CallCodeThatUsesAwaitAsync</code>          <code>TaskScheduler</code> . <br><br>    <code>Task.Run</code> FAQ,      :     ,     <code>try</code>     ,    (       ). <br><br>          : <br><br><pre> <code class="cs hljs">SynchronizationContext old = SynchronizationContext.Current; SynchronizationContext.SetSynchronizationContext(<span class="hljs-literal"><span class="hljs-literal">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> t; } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { SynchronizationContext.SetSynchronizationContext(old); }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреЗрдЦрд┐рдП рдХреНрдпрд╛ рд╕рдорд╕реНрдпрд╛ рд╣реИ? </font><font style="vertical-align: inherit;">рдиреЛрдЯрд┐рд╕ рдХрд░рдирд╛ рдереЛрдбрд╝рд╛ рдХрдард┐рди рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдкреНрд░рднрд╛рд╡рд╢рд╛рд▓реА рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕ рдмрд╛рдд рдХреА рдХреЛрдИ рдЧрд╛рд░рдВрдЯреА рдирд╣реАрдВ рд╣реИ рдХрд┐ рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рдиреЗ рд╕реЗ рдореВрд▓ рдХреЙрд▓ рдореЗрдВ рдПрдХ рдХреЙрд▓рдмреИрдХ / рдЬрд╛рд░реА рд░рд╣реЗрдЧрд╛ред </font><font style="vertical-align: inherit;">рдЗрд╕рдХрд╛ рдорддрд▓рдм рдпрд╣ рд╣реИ рдХрд┐ </font></font><code>SynchronizationContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореВрд▓ </font><font style="vertical-align: inherit;">рдореЗрдВ рд╡рд╛рдкрд╕реА </font><font style="vertical-align: inherit;">рдореВрд▓ рдзрд╛рдЧреЗ рдореЗрдВ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреА рд╣реИ, рдЬреЛ рдЗрд╕ рддрдереНрдп рдХреЛ рдЬрдиреНрдо рджреЗ рд╕рдХрддреА рд╣реИ рдХрд┐ рдмрд╛рдж рдореЗрдВ рдЗрд╕ рдзрд╛рдЧреЗ рдореЗрдВ рдХрд╛рдо рдХреА рд╡рд╕реНрддреБрдУрдВ рдХреЛ рдЧрд▓рдд рд╕рдВрджрд░реНрдн рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛ред </font><font style="vertical-align: inherit;">рдЗрд╕рдХрд╛ рдкреНрд░рддрд┐рдХрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рд╡рд┐рд╢реЗрд╖ рд╕рдВрджрд░реНрдн рд╕реЗрдЯ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рд▓рд┐рдЦрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЙрдбрд▓ рдЖрдорддреМрд░ рдкрд░ рдХрд┐рд╕реА рднреА рдЕрддрд┐рд░рд┐рдХреНрдд рдХрд╕реНрдЯрдо рдХреЛрдб рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рд░реАрд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдб рдЬреЛрдбрд╝рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдФрд░ рдЕрдЧрд░ рдпрд╣ рдПрдХ рдзрд╛рдЧреЗ рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рднреА рдХреБрдЫ рд╕рдордп рд▓рдЧ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕рдХреЗ рджреМрд░рд╛рди рд╕рдВрджрд░реНрдн рдареАрдХ рд╕реЗ рдмрд╣рд╛рд▓ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдФрд░ рдЕрдЧрд░ рдпрд╣ рдПрдХ рдЕрд▓рдЧ рдзрд╛рдЧреЗ рдореЗрдВ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдЧрд▓рдд рд╕рдВрджрд░реНрдн рдХреА рд╕реНрдерд╛рдкрдирд╛ рдХреЛ рдЬрдиреНрдо рджреЗ рд╕рдХрддрд╛ рд╣реИред</font></font> рдФрд░ рдЗрд╕реА рддрд░рд╣ред<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЖрджрд░реНрд╢ рд╕реЗ рдмрд╣реБрдд рджреВрд░ред </font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпрджрд┐ рдореБрдЭреЗ GetAwaiter () .GetResult () рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИ рддреЛ рдХреНрдпрд╛ рдореБрдЭреЗ рдХреЙрдиреНрдлрд┐рдЧрд░рдПрд╡рд┐рдЯ (рдЧрд▓рдд) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? </font></font></h3><br>  рдирд╣реАрдВред <code>ConfigureAwait</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЗрд╡рд▓ рдХреЙрд▓рдмреИрдХ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рдЯреЗрдореНрдкрд▓реЗрдЯ рдХреЗ рд▓рд┐рдП </font></font><code>awaiter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдХрд┐ рдЖрдк </font></font><code>awaiter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдВрдкрддреНрддрд┐ </font></font><code>IsCompleted</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рд╡рд┐рдзрд┐рдпрд╛рдБ </font></font><code>GetResult</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ </font></font><code>OnCompleted</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡реИрдХрд▓реНрдкрд┐рдХ рд░реВрдк рд╕реЗ (рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рдХреИрдлреЗ рд╡рд┐рдзрд┐ рдХреЗ рд╕рд╛рде) рдкреНрд░рджрд╛рди рдХрд░реЗрдВред </font></font><code>ConfigureAwait</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЗрд╡рд▓ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рддрд╛ рд╣реИ </font></font><code>{Unsafe}OnCompleted</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рдЖрдк рд╕реАрдзреЗ рдХреЙрд▓ рдХрд░рддреЗ рд╣реИрдВ </font></font><code>GetResult()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рднрд▓реЗ рд╣реА рдЖрдк рдЗрд╕рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрд░рддреЗ рд╣реИрдВ </font></font><code>TaskAwaiter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╛ </font></font><code>ConfiguredTaskAwaitable.ConfiguredTaskAwaiter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡реНрдпрд╡рд╣рд╛рд░ рдореЗрдВ рдХреЛрдИ рдЕрдВрддрд░ рдирд╣реАрдВ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдк рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ </font></font><code>task.ConfigureAwait(false).GetAwaiter().GetResult()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдк рдЗрд╕реЗ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ </font></font><code>task.GetAwaiter().GetResult()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╕реЛрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдкрдХреЛ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЗрд╕ рддрд░рд╣ рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ)ред</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореБрдЭреЗ рдкрддрд╛ рд╣реИ рдХрд┐ рдХреЛрдб рдПрдХ рдРрд╕реЗ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдЪрд▓рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдХрднреА рднреА рдПрдХ рд╡рд┐рд╢реЗрд╖ рд╕рд┐рдВрдХреНрд░реЛрдирд╛рдЗрдЬрд╝реЗрд╢рди рдХреЙрдирдЯреЗрдХреНрд╕реНрдЯ рдпрд╛ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдЯрд╛рд╕реНрдХрд╕реНрдХрд┐рдбрд░ рдирд╣реАрдВ рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рдХреНрдпрд╛ рдореИрдВ рдХреЙрдиреНрдлрд┐рдЧрд░рдПрд╡рд┐рдЯ (рдЧрд▓рдд) рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛ рд╣реВрдВ?</font></font></h3><br>  рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ред    ,      ┬л┬╗.     ,  ,   ,    ,    <code>SynchronizationContext</code>        <code>TaskScheduler</code> ,  ,         .       ,     ,    . <br><br><h3>  ,   .NET Core    ConfigureAwait (false).   ? </h3><br>  рдРрд╕реЗ рдирд╣реАрдВред<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.NET рдХреЛрд░ рдореЗрдВ рдХрд╛рдо рдХрд░рдирд╛ рдЙрд╕реА рддрд░рд╣ рд╕реЗ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдЬреИрд╕реЗ .NET рдлреНрд░реЗрдорд╡рд░реНрдХ рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╕рдордпред рдЗрд╕ рд╕рдВрдмрдВрдз рдореЗрдВ рдХреБрдЫ рднреА рдирд╣реАрдВ рдмрджрд▓рд╛ рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рдмрджрд▓ рдЧрдпрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдХреБрдЫ рд╡рд╛рддрд╛рд╡рд░рдг рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд░рддреЗ рд╣реИрдВ </font></font><code>SynchronizationContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рдЬрдмрдХрд┐ .NET рдлреНрд░реЗрдорд╡рд░реНрдХ рдореЗрдВ рдХреНрд▓рд╛рд╕рд┐рдХ ASP.NET рдХрд╛ рдЕрдкрдирд╛ рд╣реИ </font></font><code><a href="" rel="nofollow">SynchronizationContext</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ASP.NET рдХреЛрд░ рдирд╣реАрдВ рд╣реИред рдЗрд╕рдХрд╛ рдорддрд▓рдм рдпрд╣ рд╣реИ рдХрд┐ ASP.NET рдХреЛрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдЪрд▓ рд░рд╣реЗ рдХреЛрдб рдХреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╡рд┐рд╢реЗрд╖ рдХреЛрдб рдирд╣реАрдВ рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛ </font></font><code>SynchronizationContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдЬреЛ </font></font><code>ConfigureAwait(false)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕ рд╡рд╛рддрд╛рд╡рд░рдг </font><font style="vertical-align: inherit;">рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ </font><font style="vertical-align: inherit;">рдХреЛ </font><font style="vertical-align: inherit;">рдХрдо рдХрд░рддрд╛ </font><font style="vertical-align: inherit;">рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрд╕рдХрд╛ рдорддрд▓рдм рдпрд╣ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдХреЛрдИ рдкреНрд░рдерд╛ </font></font><code>SynchronizationContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╛ </font><font style="vertical-align: inherit;">рдХрднреА рдирд╣реАрдВ рд╣реЛрдЧреА</font></font><code>TaskScheduler</code> .  -   (   ,  )             ,     ,  <code>await</code> '  ASP.NET Core      ,       <code>ConfigureAwait(false)</code> . ,  ,      (       -)             ,      <code>ConfigureAwait(false)</code> . <br><br><h3>     ConfigureAwait,  ┬л  foreach┬╗  IAsyncEnumerable? </h3><br>  рд╣рд╛рдВред  .  <a href="https://docs.microsoft.com/en-us/archive/msdn-magazine/2019/november/csharp-iterating-with-async-enumerables-in-csharp-8" rel="nofollow"> MSDN</a> . <br><br> <code>Await foreach</code>   ,  ,      <code>IAsyncEnumerable&lt;T&gt;</code> .       ,     API.    .NET   <a href="" rel="nofollow"></a> <code>ConfigureAwait</code>  <code>IAsyncEnumerable&lt;T&gt;</code> ,    ,   <code>IAsyncEnumerable&lt;T&gt;</code>  <code>Boolean</code>    .      <code>MoveNextAsync</code>  <code>DisposeAsync</code> .         ,    ,    . <br><br><h3>    ConfigureAwait,  'await using' IAsyncDisposable? </h3><br> ,     . <br><br>    <code>IAsyncEnumerable&lt;T&gt;</code> , .NET       <code>ConfigureAwait</code>  <code>IAsyncDisposable</code>  <code>await using</code> ,   ,      ( ,    <code>DisposeAsync</code> ): <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> c = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MyAsyncDisposableClass().ConfigureAwait(<span class="hljs-literal"><span class="hljs-literal">false</span></span>)) { ... }</code> </pre> <br>     ,   <code>c</code> тАФ   <code>MyAsyncDisposableClass</code> ,   <code>System.Runtime.CompilerServices.ConfiguredAsyncDisposable</code> ,      <code>ConfigureAwait</code>  <code>IAsyncDisposable</code> . <br><br>   ,   : <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> c = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MyAsyncDisposableClass(); <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (c.ConfigureAwait(<span class="hljs-literal"><span class="hljs-literal">false</span></span>)) { ... }</code> </pre> <br>   <code>c</code>    <code>MyAsyncDisposableClass</code> .         <code>c</code> ;  ,        . <br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореИрдВрдиреЗ рдХрдиреНрдлрд┐рдЧрд░рд╡рд╛рдЗрдЯ (рдЭреВрдард╛) рдХрд╛ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛, рд▓реЗрдХрд┐рди рдореЗрд░рд╛ рдПрд╕рд┐рдВрдХреНрд▓реЛрдХреНрдХрд▓ рдЗрдВрддрдЬрд╛рд░ рдХреЗ рдмрд╛рдж рднреА рдХреЛрдб рдореЗрдВ рдмрд╣рддрд╛ рд░рд╣рд╛ред </font><font style="vertical-align: inherit;">рдХреНрдпрд╛ рдпрд╣ рдПрдХ рдмрдЧ рд╣реИ?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирд╣реАрдВ, рдпрд╣ рдХрд╛рдлреА рдЕрдкреЗрдХреНрд╖рд┐рдд рд╣реИред </font><font style="vertical-align: inherit;">рдбреЗрдЯрд╛ рдкреНрд░рд╡рд╛рд╣ </font></font><code>AsyncLocal&lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд╣ рд╣рд┐рд╕реНрд╕рд╛ </font></font><code>ExecutionContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣реИ рдЬреЛ рдЗрд╕рд╕реЗ рдЕрд▓рдЧ рд╣реЛрддрд╛ рд╣реИ </font></font><code>SynchronizationContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЬрдм рддрдХ рдЖрдк рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ </font></font><code>ExecutionContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрдкрдпреЛрдЧ </font><font style="vertical-align: inherit;">рдХрд░рдиреЗ рд╡рд╛рд▓реА рдзрд╛рд░рд╛ рдХреЛ рдЕрдХреНрд╖рдо рдирд╣реАрдВ </font><font style="vertical-align: inherit;">рдХрд░рддреЗ рд╣реИрдВ </font></font><code>ExecutionContext.SuppressFlow()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>ExecutionContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(рдФрд░ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдбреЗрдЯрд╛ </font></font><code>AsyncLocal &lt;T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) рд╣рдореЗрд╢рд╛ рдЧреБрдЬрд░рддрд╛ рд░рд╣реЗрдЧрд╛ </font></font><code>awaits</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдЪрд╛рд╣реЗ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ </font></font><code>ConfigureAwait</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореВрд▓ рдкрд░ рдХрдмреНрдЬрд╛ </font><font style="vertical-align: inherit;">рдХрд░рдиреЗ </font><font style="vertical-align: inherit;">рд╕реЗ рдмрдЪрдиреЗ рдХреЗ </font><font style="vertical-align: inherit;">рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рдП </font></font><code>SynchronizationContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЗрд╕ </font></font><a href="https://devblogs.microsoft.com/pfxteam/executioncontext-vs-synchronizationcontext/" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓реЗрдЦ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдкрд░ рдЪрд░реНрдЪрд╛ рдХреА рдЧрдИ рд╣реИ </font><font style="vertical-align: inherit;">ред</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреНрдпрд╛ рднрд╛рд╖рд╛ рдЙрдкрдХрд░рдг рдореЗрд░реА рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЗрдВ рдХреЙрдиреНрдлрд┐рдЧрд░рдПрд╡рд┐рдЯ (рдЧрд▓рдд) рдХрд╛ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╕реЗ рдмрдЪрдиреЗ рдореЗрдВ рдореЗрд░реА рдорджрдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ? </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдбреЗрд╡рд▓рдкрд░ рдХрднреА-рдХрднреА </font></font><code>ConfigureAwait(false)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрдо рдЖрдХреНрд░рд╛рдордХ рд╡рд┐рдХрд▓реНрдк </font><font style="vertical-align: inherit;">рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ </font><font style="vertical-align: inherit;">рдФрд░ рдкреВрдЫрдиреЗ </font><font style="vertical-align: inherit;">рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╢рд┐рдХрд╛рдпрдд рдХрд░рддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд░реНрддрдорд╛рди рдореЗрдВ рд╡реЗ рдирд╣реАрдВ рд╣реИрдВ, рдХрдо рд╕реЗ рдХрдо рд╡реЗ рднрд╛рд╖рд╛ / рд╕рдВрдХрд▓рдХ / рд░рдирдЯрд╛рдЗрдо рдореЗрдВ рдирд╣реАрдВ рдмрдиреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХрдИ рд╕реБрдЭрд╛рд╡ рд╣реИрдВ рдХрд┐ рдЗрд╕реЗ рдХреИрд╕реЗ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: </font></font><a href="https://github.com/dotnet/csharplang/issues/645" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://github.com/dotnet/csharplang/issues/2542" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://github.com/dotnet/csharplang/issues/2649" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://github.com/dotnet/csharplang/issues/2746" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрджрд┐ рдЖрдк рдЬрд┐рд╕ рд╡рд┐рд╖рдп рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ, рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдирдП рдФрд░ рджрд┐рд▓рдЪрд╕реНрдк рд╡рд┐рдЪрд╛рд░ рд╣реИрдВ, рддреЛ </font></font><a href="https://devblogs.microsoft.com/dotnet/configureawait-faq/" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореВрд▓ рд▓реЗрдЦ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЗ рд▓реЗрдЦрдХ </font><font style="vertical-align: inherit;">рдЖрдкрдХреЛ рдЪрд░реНрдЪрд╛ рдХреЗ рд▓рд┐рдП рдЖрдордВрддреНрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВред</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi482354/">https://habr.com/ru/post/hi482354/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi482340/index.html">рдЬреВрдирд┐рдпрд░'рдП рд╕реЗ рдорд┐рдбрд▓'рдЖ: рдкрд╛рд░реНрд╕рд░ рддрдХ</a></li>
<li><a href="../hi482344/index.html">рд░реВрд╕ рдореЗрдВ рдПрдХ рд╕рд╛рдорд╛рдЬрд┐рдХ рд░реЗрдЯрд┐рдВрдЧ рдХреА рд╢реБрд░реВрдЖрдд рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд╣реЛ рдЬрд╛рдУ</a></li>
<li><a href="../hi482346/index.html">ASP.NET MVC - ADO.NET рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ MySQL рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░ рд░рд╣рд╛ рд╣реИ</a></li>
<li><a href="../hi482348/index.html">рдЯреЙрдкрд▓реЗрд╕ рд╡рд┐рдбрд┐рдпреЛ рдЧреЗрдо рдбреЗрд╡рд▓рдкрд░ рдХреЗ рд▓рд┐рдП рдЯреЛрдкреЛрд▓реЙрдЬреА рдФрд░ рд╡реНрдпрд╛рдкрдХ рд╡рд┐рд╢реНрд▓реЗрд╖рдг: рд╕рд┐рдВрдЧрд▓ 3 рдбреА рд╡реИрдХреНрдЯрд░ рдХреЛ рдХрдВрдкреНрд░реЗрд╕ рдХрд░рдирд╛</a></li>
<li><a href="../hi482352/index.html">рдЬреИрд╕рд╛ рдХрд┐ рдореИрдВрдиреЗ рд▓рдЧрднрдЧ 150k рд╣рд╡рд╛ рдореЗрдВ рдлреЗрдВрдХ рджрд┐рдпрд╛ рдпрд╛ рдЕрдкрд╛рд░реНрдЯрдореЗрдВрдЯ рдореЗрдВ рдордЬрдмреВрд░ рд╡реЗрдВрдЯрд┐рд▓реЗрд╢рди рдХреА рд╕реНрдерд╛рдкрдирд╛ рдХрд╛ рдЗрддрд┐рд╣рд╛рд╕</a></li>
<li><a href="../hi482356/index.html">рдПрдХ рдирд┐рдпрдорд┐рдд рд╡рд┐рдВрдбреЛрдЬ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╕реЗ рдПрдХреНрд╕рдкреНрд▓реЛрд░рд░ рдХреЗ рдмрд┐рдирд╛ рд╡рд┐рдВрдбреЛрдЬ рд╕рд░реНрд╡рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛</a></li>
<li><a href="../hi482358/index.html">рд░рд╕реНрдЯ рдореЗрдВ рдШрдмрд░рд╛рд╣рдЯ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддреА рд╣реИ</a></li>
<li><a href="../hi482360/index.html">рд╣рд╛рдмрд░рд╛ рдЬрд╛рд╕реВрд╕: рд╡реЗ рдпреВрдПрдлрдУ рдХреЗ рд╕рд╛рде рджреЛрд╕реНрдд рд╣реИрдВ</a></li>
<li><a href="../hi482362/index.html">рд▓рдЧрднрдЧ рдЕрд░рд╛рдЬрдХрддрд╛: рдлрд╝рд┐рдбреЛрдиреЗрдЯ рдХрд╛ рдПрдХ рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдЗрддрд┐рд╣рд╛рд╕, рдПрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдЬреЛ рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд░ рдЬреАрддрдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкрд░рд╡рд╛рд╣ рдирд╣реАрдВ рдХрд░рддреА рд╣реИ</a></li>
<li><a href="../hi482364/index.html">рдЪреАрдЬреЗрдВ рдЖрдк [рд╢рд╛рдпрдж] рдЬрд╛рд╡рд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдирд╣реАрдВ рдЬрд╛рдирддреЗ рдереЗ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>