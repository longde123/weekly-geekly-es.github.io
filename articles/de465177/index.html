<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§∞üèº üê¨ üë©üèΩ‚Äçü§ù‚Äçüë®üèø Not New Relic's One: Ein Blick auf Datadog und Atatus üë®üèæ‚Äçü§ù‚Äçüë®üèΩ üßõüèæ ‚ú¥Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In der Umgebung von SRE- / DevOps-Ingenieuren werden Sie nicht √ºberrascht sein, dass eines Tages ein Kunde (oder ein √úberwachungssystem) erscheint und...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Not New Relic's One: Ein Blick auf Datadog und Atatus</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/465177/"><img src="https://habrastorage.org/webt/rp/lp/ct/rplpctt6yzam8cvxnufgkygd3um.png"><br><br>  In der Umgebung von SRE- / DevOps-Ingenieuren werden Sie nicht √ºberrascht sein, dass eines Tages ein Kunde (oder ein √úberwachungssystem) erscheint und sagt, dass ‚Äûalles verloren ist‚Äú: Die Website funktioniert nicht, Zahlungen vergehen nicht, das Leben verf√§llt ... Egal wie ich in dieser Situation helfen m√∂chte Ohne ein einfaches und verst√§ndliches Werkzeug kann dies sehr schwierig sein.  Oft ist das Problem im Code der Anwendung selbst verborgen - Sie m√ºssen es nur lokalisieren. <br><br><h2>  Und in Trauer und Freude ... </h2><br>  So kam es, dass wir New Relic schon lange sehr mochten.  Es war und ist ein hervorragendes Tool zur √úberwachung der Anwendungsleistung und erm√∂glicht es Ihnen, die Microservice-Architektur (mithilfe Ihres Agenten) und vieles mehr zu instrumentieren.  Und alles k√∂nnte wunderbar sein, wenn nicht die √Ñnderungen in der Preispolitik des Dienstes: Die <b>Kosten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">haben</a> sich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">seit 2013</a> mehr als verdreifacht</b> .  Dar√ºber hinaus erfordert die Erlangung eines Testkontos seit letztem Jahr die Kommunikation mit einem pers√∂nlichen Manager, was es schwierig macht, das Produkt einem potenziellen Kunden zu pr√§sentieren. <a name="habracut"></a><br><br>  Die √ºbliche Situation: New Relic wird nicht ‚Äûlaufend‚Äú ben√∂tigt, es wird nur zu dem Zeitpunkt in Erinnerung gerufen, als die Probleme begannen.  Sie m√ºssen jedoch weiterhin regelm√§√üig zahlen (140 USD pro Server und Monat), und in der automatisch skalierbaren Cloud-Infrastruktur sind die Betr√§ge ziemlich hoch.  Es besteht zwar die M√∂glichkeit von "Pay-As-You-Go", aber um New Relic zu aktivieren, m√ºssen Sie die Anwendung neu starten, was zum Verlust der Problemsituation f√ºhren kann, f√ºr die alles gestartet wurde.  Vor nicht allzu langer Zeit hat New Relic einen neuen Tarifplan eingef√ºhrt - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Essentials</a> , der auf den ersten Blick als vern√ºnftige Alternative zu Professional erscheint. Bei n√§herer Betrachtung stellte sich jedoch heraus, dass einige wichtige Funktionen fehlen (insbesondere fehlen <i>wichtige Transaktionen</i> , <i>anwendungs√ºbergreifende R√ºckverfolgung</i> , <i>verteilte R√ºckverfolgung</i> ). . <br><br>  Infolgedessen haben wir dar√ºber nachgedacht, eine billigere Alternative zu finden, und unsere Wahl fiel auf die beiden Dienste Datadog und Atatus.  Warum genau auf ihnen? <br><br><h2>  √úber Wettbewerber </h2><br>  Ich muss sofort sagen, dass es andere L√∂sungen auf dem Markt gibt.  Wir haben sogar Open Source-Optionen in Betracht gezogen, aber nicht jeder Client verf√ºgt √ºber freie Kapazit√§t zum Hosten von selbst gehosteten L√∂sungen ... - Au√üerdem sind zus√§tzliche Wartungsarbeiten erforderlich.  Das Paar, das wir ausgew√§hlt haben, hat sich als am n√§chsten an <b>unseren Bed√ºrfnissen</b> erwiesen: <br><br><ul><li>  integrierte und entwickelte Unterst√ºtzung f√ºr PHP-Anwendungen (der Stack unserer Kunden ist sehr vielf√§ltig, aber er ist ein klarer Marktf√ºhrer bei der Suche nach einer Alternative zu New Relic); </li><li>  erschwingliche Kosten (weniger als 100 USD pro Monat und Host); </li><li>  automatische Instrumentierung; </li><li>  Kubernetes-Integration </li><li>  Die √Ñhnlichkeit mit der New Relic-Oberfl√§che ist ein sp√ºrbares Plus (weil unsere Ingenieure daran gew√∂hnt sind). </li></ul><br>  Daher haben wir in der Phase der Erstauswahl einige andere beliebte L√∂sungen eliminiert, insbesondere: <br><br><ul><li>  Tideways, AppDynamics und Dynatrace - f√ºr den Preis; </li><li>  Stapeln - ist in der Russischen F√∂deration blockiert und zeigt zu wenig Daten an. </li></ul><br>  Der nachfolgende Artikel ist so strukturiert, dass die betrachteten L√∂sungen kurz vorgestellt werden. Anschlie√üend werde ich √ºber unsere typische Interaktion mit New Relic und die Erfahrungen / Eindr√ºcke bei der Durchf√ºhrung √§hnlicher Vorg√§nge in anderen Diensten sprechen. <br><br><h3>  Pr√§sentation ausgew√§hlter Wettbewerber </h3><br><img src="https://habrastorage.org/webt/mu/el/kq/muelkqnuiwzgvaz_jtton8mrbzs.png"><br>  Wahrscheinlich hat jeder von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b>New Relic geh√∂rt</b></a> ?  Dieser Dienst begann seine Entwicklung vor mehr als 10 Jahren im Jahr 2008.  Wir verwenden es seit 2012 aktiv und hatten keine Integrationsprobleme mit einer wirklich gro√üen Anzahl von Anwendungen in PHP, Ruby und Python. Au√üerdem hatten wir Erfahrung mit der Integration in C # und Go.  Die Autoren des Dienstes bieten L√∂sungen f√ºr die √úberwachung von Anwendungen, Infrastrukturen, die Verfolgung von Mikroservice-Infrastrukturen, die Erstellung praktischer Anwendungen f√ºr Benutzerger√§te und vieles mehr. <br><br>  Der New Relic-Agent arbeitet jedoch mit propriet√§ren Protokollen und bietet keine OpenTracing-Unterst√ºtzung.  F√ºr die erweiterte Instrumentierung sind √Ñnderungen speziell f√ºr New Relic erforderlich.  Schlie√ülich hat die Unterst√ºtzung f√ºr Kubernetes bislang experimentellen Status. <br><br><img src="https://habrastorage.org/webt/4t/ae/fp/4taefp5hohou0ekzzmcrnduvzlu.png"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b>Datadog</b></a> , dessen Entwicklung im Jahr 2010 begann, sieht in Bezug auf seine Verwendung in Kubernetes-Umgebungen deutlich interessanter aus als New Relic.  Insbesondere unterst√ºtzt es die Integration in die Protokolle NGINX Ingress, Log Collection, Statsd und OpenTracing, mit denen Sie eine Benutzeranforderung ab dem Zeitpunkt der Verbindung zum Ende der Arbeit verfolgen und Protokolle f√ºr diese Anforderung finden k√∂nnen (sowohl auf der Webserverseite als auch auf der Seite Verbraucher). <br><br>  Bei der Verwendung von Datadog wurden wir mit der Tatsache konfrontiert, dass manchmal f√§lschlicherweise eine Microservice-Karte erstellt wurde, und mit einigen technischen Fehlern.  Zum Beispiel hat er die Art des Dienstes falsch bestimmt (er hat Django f√ºr einen Caching-Dienst genommen) und die 500. Fehler in einer PHP-Anwendung unter Verwendung der beliebten Predis-Bibliothek verursacht. <br><br><img src="https://habrastorage.org/webt/h5/te/m9/h5tem9e4arkqlsoed48qc0u9xha.png"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b>Atatus</b></a> ist das j√ºngste Instrument;  Service im Jahr 2014 gestartet.  Das Marketingbudget ist den aufgef√ºhrten Wettbewerbern deutlich unterlegen, Erw√§hnungen sind weitaus seltener.  Trotzdem ist das Tool selbst New Relic sehr √§hnlich und nicht nur in den Funktionen (APM, Browser√ºberwachung usw.), sondern auch im Erscheinungsbild. <br><br>  Ein wesentlicher Nachteil ist nur die Unterst√ºtzung von Node.js und PHP.  Andererseits ist es viel besser implementiert als Datadog.  Im Gegensatz zu letzterem ben√∂tigt Atatus keine Anwendungen, um zus√§tzliche Tags im Code zu √§ndern oder festzulegen. <br><br><h2>  Wie wir mit New Relic arbeiten </h2><br>  Lassen Sie uns nun herausfinden, wie wir New Relic im Allgemeinen verwenden.  Angenommen, wir haben ein Problem, das gel√∂st werden muss: <br><br><img src="https://habrastorage.org/webt/mk/_t/bv/mk_tbvlysng7--qgh2gvhjum4cg.png"><br><br>  Es ist leicht, einen <b>Anstieg</b> auf dem Diagramm zu bemerken - wir analysieren ihn.  In New Relic werden Webtransaktionen sofort f√ºr die Webanwendung ausgew√§hlt, alle Komponenten werden im Leistungsdiagramm angezeigt, es gibt Fehlerraten- und Anforderungsraten-Panels ... Am wichtigsten ist, dass Sie direkt von diesen Panels aus zwischen verschiedenen Teilen der Anwendung wechseln k√∂nnen (z. B. durch Klicken auf MySQL wird zum Datenbankabschnitt). <br><br>  Da in diesem Beispiel ein Anstieg der <b>PHP-</b> Aktivit√§t zu beobachten ist, klicken Sie auf dieses Diagramm und gehen Sie automatisch zu <b>Transaktionen</b> : <br><br><img src="https://habrastorage.org/webt/02/2v/b_/022vb_o0euwqk8jaf2qh1z4pges.png"><br><br>  Die Liste der Transaktionen, bei denen es sich im Wesentlichen um Controller aus dem MVC-Modell handelt, ist bereits nach <b>Zeitaufwendig</b> sortiert, was sehr praktisch ist: Wir sehen sofort, was die Anwendung tut.  Hier finden Sie Beispiele f√ºr lange Abfragen, die von New Relic automatisch erfasst werden.  Das Wechseln der Sortierung ist leicht zu finden: <br><br><ul><li>  der am meisten geladene Anwendungscontroller; </li><li>  Der am h√§ufigsten angeforderte Controller </li><li>  der langsamste der Controller. </li></ul><br>  Dar√ºber hinaus k√∂nnen Sie jede Transaktion erweitern und sehen, was die Anwendung zum Zeitpunkt der Codeausf√ºhrung tat: <br><br><img src="https://habrastorage.org/webt/vq/bz/sk/vqbzsk-cj4sp9prjqwx16hnzy4k.png"><br><br>  Schlie√ülich werden Beispiele f√ºr lange Abfragespuren (die l√§nger als 2 Sekunden funktionieren) in der Anwendung gespeichert.  Hier ist das Panel f√ºr eine lange Transaktion: <br><br><img src="https://habrastorage.org/webt/jk/b_/ux/jkb_uxm9a3tx9ed6wdtufrz5g6u.png"><br><br>  Es ist ersichtlich, dass zwei Methoden viel Zeit in Anspruch nehmen, und mit der Zeit, zu der die Anforderung ausgef√ºhrt wurde, werden auch deren URI und Dom√§ne angezeigt.  Sehr oft hilft dies, die Abfrage in den Protokollen zu finden.  In den <b>Trace-Details</b> k√∂nnen Sie sehen, woher diese Methoden stammen: <br><br><img src="https://habrastorage.org/webt/_1/m6/li/_1m6li8g6zgv8siatzj1mrqiclc.png"><br><br>  Und in <b>Datenbankabfragen</b> - bewerten Sie die Datenbankabfragen, die zum Zeitpunkt der Anwendung ausgef√ºhrt wurden: <br><br><img src="https://habrastorage.org/webt/ru/xv/k7/ruxvk7jbfe-93duilolwh3nj7p8.png"><br><br>  Mit diesem Wissen k√∂nnen wir die Ursache f√ºr die Verlangsamung der Anwendung beurteilen und gemeinsam mit dem Entwickler eine Strategie zur L√∂sung des Problems entwickeln.  In Wirklichkeit liefert New Relic nicht immer ein klares Bild, aber es hilft bei der Auswahl des Untersuchungsvektors: <br><br><ul><li>  das lange <code>PDO::Construct</code> f√ºhrte uns zu der seltsamen Funktionsweise von pgpoll; </li><li>  Instabilit√§t in der Zeit <code>Memcache::Get</code> falsche Konfiguration der virtuellen Maschine erhalten; </li><li>  Die verd√§chtig l√§ngere Zeit f√ºr die Verarbeitung der Vorlage f√ºhrte zu einer verschachtelten Schleife mit einer √úberpr√ºfung auf das Vorhandensein von 500 Avataren im Objektspeicher. </li><li>  usw‚Ä¶ </li></ul><br>  Es kommt auch vor, dass anstelle der Ausf√ºhrung von Code auf dem Hauptbildschirm etwas im Zusammenhang mit der externen Datenspeicherung w√§chst - und es spielt keine Rolle, was es sein wird: Redis oder PostgreSQL - alle sind auf der Registerkarte " <b>Datenbanken"</b> ausgeblendet. <br><br><img src="https://habrastorage.org/webt/ku/ke/xe/kukexe0cn79kgj_x_40dt79au5e.png"><br><br>  Sie k√∂nnen eine bestimmte Basis f√ºr die Recherche ausw√§hlen und die Abfragen sortieren - √§hnlich wie in Transaktionen.  Auf der Registerkarte "Anfrage" k√∂nnen Sie sehen, wie viel diese Anfrage in den einzelnen Anwendungscontrollern enthalten ist, und bewerten, wie oft sie aufgerufen wird.  Es ist sehr bequem: <br><br><img src="https://habrastorage.org/webt/ac/jm/xq/acjmxqt0dop9r1ncalo1enmrihq.png"><br><br>  Die Registerkarte <b>Externe Dienste</b> enth√§lt √§hnliche Daten, die Anforderungen f√ºr externe HTTP-Dienste verbergen, z. B. den Zugriff auf den Objektspeicher, das Senden von Ereignissen an den Wachposten oder dergleichen.  Die Registerkarte √§hnelt inhaltlich den Datenbanken: <br><br><img src="https://habrastorage.org/webt/vv/2h/al/vv2halrqjfjjpqltn7ty1had57y.png"><br><br><h2>  Wettbewerber: Chancen und Eindr√ºcke </h2><br>  Das Interessanteste ist nun, die Funktionen von New Relic mit denen der Wettbewerber zu vergleichen.  Leider konnten wir nicht alle drei Tools mit derselben Version einer Anwendung testen, die in der Produktion ausgef√ºhrt wird.  Trotzdem haben wir versucht, die identischsten Situationen / Konfigurationen zu vergleichen. <br><br><h3>  1. Datadog </h3><br>  Datadog begr√º√üt uns mit einem Panel mit einer Reihe von Diensten: <br><br><img src="https://habrastorage.org/webt/yt/vv/rt/ytvvrt5tlhegxiaoanulug0dwfu.png"><br><br>  Er versucht, Anwendungen in Komponenten / Microservices zu unterteilen. In der Beispielanwendung Django sehen wir zwei Verbindungen zu PostgreSQL ( <code>defaultdb</code> und <code>postgres</code> ) sowie zu Celery, Redis.  F√ºr die Arbeit mit Datadog m√ºssen Sie √ºber ein Mindestwissen √ºber die Prinzipien von MVC verf√ºgen: Sie m√ºssen verstehen, woher Benutzeranforderungen kommen.  Normalerweise hilft dabei <b>eine Service Map</b> : <br><br><img src="https://habrastorage.org/webt/t3/19/r9/t319r9yb96o3h0fjhdmi5wzdxbc.png"><br><br>  √úbrigens gibt es in New Relic etwas √Ñhnliches: <br><br><img src="https://habrastorage.org/webt/f8/sr/tq/f8srtq3vds1qmm2ddrp_g-d6pwo.png"><br><br>  ... und ihre Karte wird meiner Meinung nach einfacher und verst√§ndlicher: Sie zeigt nicht die Komponenten einer Anwendung an (was sie unn√∂tig detailliert machen w√ºrde, wie im Fall von Datadog), sondern nur bestimmte Dienste oder Mikrodienste. <br><br>  Zur√ºck zu Datadog: Aus der Service Map geht hervor, dass Benutzeranforderungen an Django gehen.  Gehen wir zum Django-Service und sehen endlich, was wir erwartet haben: <br><br><img src="https://habrastorage.org/webt/c3/ip/fk/c3ipfkqpsv9jxxr1m0y9lqz7fvw.png"><br><br>  Leider gibt es standardm√§√üig kein <b>Web-Transaktions-</b> Zeitdiagramm, das dem im New Relic-Hauptfenster √§hnelt.  Es kann jedoch anstelle des Diagramms <b>% der aufgewendeten Zeit</b> konfiguriert werden.  Es reicht aus, die <b>durchschnittliche Zeit pro Anfrage nach Typ</b> zu <b>√§ndern</b> ... und jetzt sieht uns das vertraute Diagramm an! <br><br><img src="https://habrastorage.org/webt/0l/jb/4m/0ljb4m2fh3_mbje9ihwvo6hlwge.png"><br><br>  Warum sich Datadog f√ºr einen anderen Zeitplan entschieden hat, ist uns ein R√§tsel.  Es war auch frustrierend, dass sich das System (im Gegensatz zu beiden Mitbewerbern) nicht an die Wahl des Benutzers erinnert und daher nur die Erstellung von benutzerdefinierten Panels spart. <br><br>  Ich war jedoch erfreut √ºber die M√∂glichkeit in Datadog, von diesen Diagrammen zu den Metriken verwandter Server zu wechseln, die Protokolle zu lesen und die Auslastung der Webserver-Handler (Gunicorn) zu bewerten.  Alles ist fast das gleiche wie in New Relic ... und sogar ein paar mehr (Protokolle)! <br><br>  Unter den Diagrammen befinden sich Transaktionen, die New Relic v√∂llig √§hnlich sind: <br><br><img src="https://habrastorage.org/webt/ln/pg/u5/lnpgu5fj2oclzdzlc1uwwjjtfkm.png"><br><br>  In Datadog werden Transaktionen als <b>Ressourcen bezeichnet</b> .  Sie k√∂nnen die Controller nach der Anzahl der Anforderungen, nach der durchschnittlichen Antwortzeit und nach der maximal verstrichenen Zeit f√ºr einen ausgew√§hlten Zeitraum sortieren. <br><br>  Sie k√∂nnen die Ressource erweitern und alles sehen, was wir bereits in New Relic beobachtet haben: <br><br><img src="https://habrastorage.org/webt/3s/c1/5k/3sc15ksmnyvw_e-gyfagahxtep8.png"><br><br>  Es gibt Statistiken √ºber die Ressource, eine allgemeine Liste interner Anrufe und Beispiele f√ºr Anforderungen, die nach dem Antwortcode sortiert werden k√∂nnen ... √úbrigens, unsere Ingenieure haben diese Sortierung wirklich gemocht. <br><br>  Jede Beispielressource in Datadog kann erweitert und untersucht werden: <br><br><img src="https://habrastorage.org/webt/k8/tm/j8/k8tmj8vcz91rwmv-_lvshtzd8qi.png"><br><br>  Die Abfrageparameter, ein zusammenfassendes Diagramm der verstrichenen Zeit f√ºr jede der Komponenten und ein Wasserfalldiagramm, in dem die Reihenfolge der Aufrufe angezeigt wird, werden angezeigt.  Sie k√∂nnen auch zur Baumansicht des Wasserfalldiagramms wechseln: <br><br><img src="https://habrastorage.org/webt/og/uu/ro/oguurozj3wo9vibezkytxmmc0c4.png"><br><br>  Am interessantesten ist es, die Last des Hosts anzuzeigen, auf dem die Anforderung ausgef√ºhrt wurde, und die Anforderungsprotokolle anzuzeigen. <br><br><img src="https://habrastorage.org/webt/vg/n6/be/vgn6belqdye20suvjgsq5kje3wu.png"><br><br>  Tolle Integration! <br><br>  M√∂glicherweise fragen Sie sich, wo sich die Registerkarten <b>Datenbanken</b> und <b>externe Dienste</b> befinden, wie in New Relic.  Sie sind nicht hier: Da Datadog die Anwendung in Komponenten analysiert, wird PostgreSQL als <b>separater Dienst betrachtet</b> , und anstelle von externen Diensten lohnt es sich, nach <code>aws.storage</code> zu suchen (dies gilt auch f√ºr alle anderen externen Dienste, auf die die Anwendung zugreifen kann). <br><br><img src="https://habrastorage.org/webt/qp/bp/ap/qpbpapt5pqxtre_bkspuob-myqe.png"><br><br>  Und hier ist ein Beispiel mit <code>postgres</code> : <br><br><img src="https://habrastorage.org/webt/nb/u6/ea/nbu6eaa6-6xlbkipsijjn4i9rxg.png"><br><br>  In der Tat gibt es alles, was wir wollten: <br><br><img src="https://habrastorage.org/webt/ww/r8/-c/wwr8-cpjbw26yv_chyaknlyolfe.png"><br><br>  Es ist ersichtlich, von welchem ‚Äã‚Äã"Service" die Anfrage kam. <br><br>  Es ist nicht √ºberfl√ºssig, sich daran zu erinnern, dass Datadog perfekt in NGINX Ingress integriert ist und eine End-to-End-Ablaufverfolgung ab dem Moment erm√∂glicht, in dem eine Anforderung im Cluster eintrifft. Au√üerdem k√∂nnen Sie Statistikmetriken akzeptieren, Protokolle sammeln und Metriken hosten. <br><br>  Ein gro√ües Plus von Datadog ist, dass sein Preis <i>aus</i> der √úberwachung der Infrastruktur, APM, Protokollverwaltung und Synthetik-Test besteht, d. H.  Sie k√∂nnen flexibel einen Plan ausw√§hlen. <br><br><h3>  2. Atatus </h3><br>  Das Atatus-Team behauptet, dass ihr Service "der gleiche wie bei New Relic ist, aber besser".  Mal sehen, ob das wirklich so ist. <br><br>  Die Titelleiste sieht wirklich gleich aus, aber es war nicht m√∂glich, die in der Anwendung verwendeten Redis und Memcached zu bestimmen. <br><br><img src="https://habrastorage.org/webt/-v/f8/9t/-vf89tugun8vmi3f8vc5upnswpq.png"><br><br>  APM w√§hlt standardm√§√üig alle Transaktionen aus, obwohl normalerweise nur das Web ben√∂tigt wird.  Wie in Datadog gibt es keine M√∂glichkeit, √ºber das Hauptfenster zum gew√ºnschten Dienst zu gelangen.  Dar√ºber hinaus werden Transaktionen nach Fehlern aufgelistet, was f√ºr APM nicht sehr logisch aussieht. <br><br>  Bei Atatus-Transaktionen ist alles New Relic so √§hnlich wie m√∂glich.  Minus - Sie k√∂nnen die Dynamik f√ºr jeden Controller nicht sofort sehen.  Sie m√ºssen in der Controller-Tabelle danach suchen und nach der am <b>meisten verbrauchten Zeit</b> sortieren: <br><br><img src="https://habrastorage.org/webt/1r/gm/df/1rgmdfhp2wi-etyz90cp-nhicne.png"><br><br>  Die √ºbliche Liste der Controller finden <b>Sie auf der</b> Registerkarte Durchsuchen: <br><br><img src="https://habrastorage.org/webt/n6/bm/4e/n6bm4epe4rgm1o0-j6gckbe5xcs.png"><br><br>  In gewisser Weise √§hnelt diese Tabelle Datadog und √§hnelt eher der in New Relic. <br><br>  Jede Transaktion kann bereitgestellt werden und sehen, was die Anwendung getan hat: <br><br><img src="https://habrastorage.org/webt/om/nj/jz/omnjjzghaohvdghitkkynauqwd8.png"><br><br>  Das Panel √§hnelt auch eher Datadog: Es gibt eine Reihe von Anfragen, ein Gesamtbild der Anrufe.  Der obere Bereich enth√§lt eine Registerkarte mit <b>HTTP-Fehlerfehlern</b> und Beispielen f√ºr langsame <b>Sitzungsablaufverfolgungsanforderungen</b> : <br><br><img src="https://habrastorage.org/webt/jc/cp/xo/jccpxoykxlwophfgejumdduui88.png"><br><br>  Wenn Sie eine Transaktion durchf√ºhren, sehen Sie ein Beispiel f√ºr eine Ablaufverfolgung. Sie k√∂nnen eine Liste der Abfragen an die Datenbank abrufen und die Anforderungsheader anzeigen.  Alles ist √§hnlich wie bei New Relic: <br><br><img src="https://habrastorage.org/webt/_c/lb/dn/_clbdnkiqpd-6spg325of0c09o0.png"><br><br>  Im Allgemeinen war Atatus mit detaillierten Spuren zufrieden - ohne das typische New Relic-Einkleben von Anrufen in einen Erinnerungsblock: <br><br><img src="https://habrastorage.org/webt/m5/ub/hk/m5ubhk5bxdzyqwg3oaidmflbmjc.png"><br><img src="https://habrastorage.org/webt/hv/3s/27/hv3s27-mped0zuubmx9qs-7b_7c.png"><br><br>  Es gibt jedoch nicht gen√ºgend Filter, die (wie in New Relic) ultraschnelle Anforderungen (&lt;5 ms) abschneiden w√ºrden.  Andererseits war es angenehm, die endg√ºltige Transaktionsantwort (erfolgreich oder fehlerhaft) anzuzeigen. <br><br>  Im Bereich " <b>Datenbanken"</b> k√∂nnen Sie die Anforderungen der Anwendung an externe Datenbanken untersuchen.  Ich m√∂chte Sie daran erinnern, dass Atatus nur PostgreSQL und MySQL gefunden hat, obwohl Redis und memcached ebenfalls an dem Projekt beteiligt sind. <br><br><img src="https://habrastorage.org/webt/rj/1z/vn/rj1zvn9n6wvmcbzcx1fj65x1mmg.png"><br><br>  Anfragen werden nach den √ºblichen Kriterien sortiert: Antworth√§ufigkeit, durchschnittliche Antwortzeit usw.  Ich m√∂chte auch die Registerkarte mit den langsamsten Abfragen beachten - dies ist sehr praktisch.  Dar√ºber hinaus stimmten die Daten auf dieser Registerkarte f√ºr PostgreSQL mit den Daten aus der Erweiterung <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">pg_stat_statements √ºberein</a> - ein hervorragendes Ergebnis! <br><br><img src="https://habrastorage.org/webt/-4/th/4c/-4th4c5ykhiikiwtmrk23rr7g7g.png"><br><br>  Die Registerkarte <b>Externe Anforderungen</b> ist identisch mit Datenbanken. <br><br><h2>  Schlussfolgerungen </h2><br>  Beide vorgestellten Tools zeigten in der Rolle von APM eine gute Leistung.  Jeder von ihnen kann das notwendige Minimum bieten.  Fassen Sie unsere Eindr√ºcke kurz wie folgt zusammen: <br><br><h3>  Datadog </h3><br>  Vorteile: <br><br><ul><li>  bequemer Tarifplan (APM kostet 31 USD pro Host); </li><li>  gut mit Python durchgef√ºhrt; </li><li>  Integrationsf√§higkeit in OpenTracing </li><li>  Kubernetes-Integration </li><li>  Integration mit NGINX Ingress. </li></ul><br>  Nachteile: <br><br><ul><li>  Der einzige APM, der aufgrund eines Modulfehlers (predis) zu einer Unzug√§nglichkeit der Anwendung gef√ºhrt hat. </li><li>  schwache PHP-Auto-Tools; </li><li>  teilweise seltsame Definition von Dienstleistungen und deren Zweck. </li></ul><br><h3>  Atatus </h3><br>  Vorteile: <br><br><ul><li>  tiefe Instrumentierung von PHP; </li><li>  Neue Relic-√§hnliche Benutzeroberfl√§che. </li></ul><br>  Nachteile: <br><br><ul><li>  funktioniert nicht unter √§lteren Betriebssystemen (Ubuntu 12.05, CentOS 5); </li><li>  schwache Autowerkzeuge; </li><li>  Unterst√ºtzung f√ºr nur zwei Sprachen (Node.js und PHP); </li><li>  langsamer Betrieb der Schnittstelle. </li></ul><br>  Angesichts des Atatus-Preises von 69 USD pro Monat und Server w√ºrden wir lieber Datadog verwenden, das sich perfekt in unsere Anforderungen einf√ºgt (Webanwendungen in K8s) und viele n√ºtzliche Funktionen bietet. <br><br><h2>  PS </h2><br>  Lesen Sie auch in unserem Blog: <br><br><ul><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Tools f√ºr Anwendungsentwickler, die auf Kubernetes ausgef√ºhrt werden</a> "; </li><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kubectl-Debug-Plugin zum Debuggen in Kubernetes-Pods</a> "; </li><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Microservices: Gr√∂√üe ist wichtig, auch wenn Sie Kubernetes haben</a> ." </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de465177/">https://habr.com/ru/post/de465177/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de465161/index.html">Quintett-Datenmodell und Hunderte von Gigabyte Daten</a></li>
<li><a href="../de465163/index.html">3D-Druck: erstaunliche F√§lle und etwas interessanter</a></li>
<li><a href="../de465167/index.html">Ressourcenplanung. Warum funktioniert es nicht? Teil 1</a></li>
<li><a href="../de465169/index.html">DIY von PVS-Studio: Gamification of Achievements</a></li>
<li><a href="../de465173/index.html">So √§ndern Sie die Kosten des erstellten Abonnements in Ihrer Anwendung. App Store Connect und Google Play Console</a></li>
<li><a href="../de465179/index.html">Wird die Automatisierung das manuelle Testen ersetzen?</a></li>
<li><a href="../de465181/index.html">Rutschige Stellen in C ++ 17</a></li>
<li><a href="../de465185/index.html">Neue Video√ºberwachungsstandards: Farbe bei Nacht, Rauschunterdr√ºckung, ePoE</a></li>
<li><a href="../de465187/index.html">6 englische S√§tze, die in Gehaltsverhandlungen mit ausl√§ndischen Unternehmen verwendet werden k√∂nnen</a></li>
<li><a href="../de465189/index.html">Workflow One Sprint-Entwicklungsteam</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>