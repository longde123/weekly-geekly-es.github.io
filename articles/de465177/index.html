<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤰🏼 🐬 👩🏽‍🤝‍👨🏿 Not New Relic's One: Ein Blick auf Datadog und Atatus 👨🏾‍🤝‍👨🏽 🧛🏾 ✴️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In der Umgebung von SRE- / DevOps-Ingenieuren werden Sie nicht überrascht sein, dass eines Tages ein Kunde (oder ein Überwachungssystem) erscheint und...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Not New Relic's One: Ein Blick auf Datadog und Atatus</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/465177/"><img src="https://habrastorage.org/webt/rp/lp/ct/rplpctt6yzam8cvxnufgkygd3um.png"><br><br>  In der Umgebung von SRE- / DevOps-Ingenieuren werden Sie nicht überrascht sein, dass eines Tages ein Kunde (oder ein Überwachungssystem) erscheint und sagt, dass „alles verloren ist“: Die Website funktioniert nicht, Zahlungen vergehen nicht, das Leben verfällt ... Egal wie ich in dieser Situation helfen möchte Ohne ein einfaches und verständliches Werkzeug kann dies sehr schwierig sein.  Oft ist das Problem im Code der Anwendung selbst verborgen - Sie müssen es nur lokalisieren. <br><br><h2>  Und in Trauer und Freude ... </h2><br>  So kam es, dass wir New Relic schon lange sehr mochten.  Es war und ist ein hervorragendes Tool zur Überwachung der Anwendungsleistung und ermöglicht es Ihnen, die Microservice-Architektur (mithilfe Ihres Agenten) und vieles mehr zu instrumentieren.  Und alles könnte wunderbar sein, wenn nicht die Änderungen in der Preispolitik des Dienstes: Die <b>Kosten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">haben</a> sich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">seit 2013</a> mehr als verdreifacht</b> .  Darüber hinaus erfordert die Erlangung eines Testkontos seit letztem Jahr die Kommunikation mit einem persönlichen Manager, was es schwierig macht, das Produkt einem potenziellen Kunden zu präsentieren. <a name="habracut"></a><br><br>  Die übliche Situation: New Relic wird nicht „laufend“ benötigt, es wird nur zu dem Zeitpunkt in Erinnerung gerufen, als die Probleme begannen.  Sie müssen jedoch weiterhin regelmäßig zahlen (140 USD pro Server und Monat), und in der automatisch skalierbaren Cloud-Infrastruktur sind die Beträge ziemlich hoch.  Es besteht zwar die Möglichkeit von "Pay-As-You-Go", aber um New Relic zu aktivieren, müssen Sie die Anwendung neu starten, was zum Verlust der Problemsituation führen kann, für die alles gestartet wurde.  Vor nicht allzu langer Zeit hat New Relic einen neuen Tarifplan eingeführt - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Essentials</a> , der auf den ersten Blick als vernünftige Alternative zu Professional erscheint. Bei näherer Betrachtung stellte sich jedoch heraus, dass einige wichtige Funktionen fehlen (insbesondere fehlen <i>wichtige Transaktionen</i> , <i>anwendungsübergreifende Rückverfolgung</i> , <i>verteilte Rückverfolgung</i> ). . <br><br>  Infolgedessen haben wir darüber nachgedacht, eine billigere Alternative zu finden, und unsere Wahl fiel auf die beiden Dienste Datadog und Atatus.  Warum genau auf ihnen? <br><br><h2>  Über Wettbewerber </h2><br>  Ich muss sofort sagen, dass es andere Lösungen auf dem Markt gibt.  Wir haben sogar Open Source-Optionen in Betracht gezogen, aber nicht jeder Client verfügt über freie Kapazität zum Hosten von selbst gehosteten Lösungen ... - Außerdem sind zusätzliche Wartungsarbeiten erforderlich.  Das Paar, das wir ausgewählt haben, hat sich als am nächsten an <b>unseren Bedürfnissen</b> erwiesen: <br><br><ul><li>  integrierte und entwickelte Unterstützung für PHP-Anwendungen (der Stack unserer Kunden ist sehr vielfältig, aber er ist ein klarer Marktführer bei der Suche nach einer Alternative zu New Relic); </li><li>  erschwingliche Kosten (weniger als 100 USD pro Monat und Host); </li><li>  automatische Instrumentierung; </li><li>  Kubernetes-Integration </li><li>  Die Ähnlichkeit mit der New Relic-Oberfläche ist ein spürbares Plus (weil unsere Ingenieure daran gewöhnt sind). </li></ul><br>  Daher haben wir in der Phase der Erstauswahl einige andere beliebte Lösungen eliminiert, insbesondere: <br><br><ul><li>  Tideways, AppDynamics und Dynatrace - für den Preis; </li><li>  Stapeln - ist in der Russischen Föderation blockiert und zeigt zu wenig Daten an. </li></ul><br>  Der nachfolgende Artikel ist so strukturiert, dass die betrachteten Lösungen kurz vorgestellt werden. Anschließend werde ich über unsere typische Interaktion mit New Relic und die Erfahrungen / Eindrücke bei der Durchführung ähnlicher Vorgänge in anderen Diensten sprechen. <br><br><h3>  Präsentation ausgewählter Wettbewerber </h3><br><img src="https://habrastorage.org/webt/mu/el/kq/muelkqnuiwzgvaz_jtton8mrbzs.png"><br>  Wahrscheinlich hat jeder von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b>New Relic gehört</b></a> ?  Dieser Dienst begann seine Entwicklung vor mehr als 10 Jahren im Jahr 2008.  Wir verwenden es seit 2012 aktiv und hatten keine Integrationsprobleme mit einer wirklich großen Anzahl von Anwendungen in PHP, Ruby und Python. Außerdem hatten wir Erfahrung mit der Integration in C # und Go.  Die Autoren des Dienstes bieten Lösungen für die Überwachung von Anwendungen, Infrastrukturen, die Verfolgung von Mikroservice-Infrastrukturen, die Erstellung praktischer Anwendungen für Benutzergeräte und vieles mehr. <br><br>  Der New Relic-Agent arbeitet jedoch mit proprietären Protokollen und bietet keine OpenTracing-Unterstützung.  Für die erweiterte Instrumentierung sind Änderungen speziell für New Relic erforderlich.  Schließlich hat die Unterstützung für Kubernetes bislang experimentellen Status. <br><br><img src="https://habrastorage.org/webt/4t/ae/fp/4taefp5hohou0ekzzmcrnduvzlu.png"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b>Datadog</b></a> , dessen Entwicklung im Jahr 2010 begann, sieht in Bezug auf seine Verwendung in Kubernetes-Umgebungen deutlich interessanter aus als New Relic.  Insbesondere unterstützt es die Integration in die Protokolle NGINX Ingress, Log Collection, Statsd und OpenTracing, mit denen Sie eine Benutzeranforderung ab dem Zeitpunkt der Verbindung zum Ende der Arbeit verfolgen und Protokolle für diese Anforderung finden können (sowohl auf der Webserverseite als auch auf der Seite Verbraucher). <br><br>  Bei der Verwendung von Datadog wurden wir mit der Tatsache konfrontiert, dass manchmal fälschlicherweise eine Microservice-Karte erstellt wurde, und mit einigen technischen Fehlern.  Zum Beispiel hat er die Art des Dienstes falsch bestimmt (er hat Django für einen Caching-Dienst genommen) und die 500. Fehler in einer PHP-Anwendung unter Verwendung der beliebten Predis-Bibliothek verursacht. <br><br><img src="https://habrastorage.org/webt/h5/te/m9/h5tem9e4arkqlsoed48qc0u9xha.png"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b>Atatus</b></a> ist das jüngste Instrument;  Service im Jahr 2014 gestartet.  Das Marketingbudget ist den aufgeführten Wettbewerbern deutlich unterlegen, Erwähnungen sind weitaus seltener.  Trotzdem ist das Tool selbst New Relic sehr ähnlich und nicht nur in den Funktionen (APM, Browserüberwachung usw.), sondern auch im Erscheinungsbild. <br><br>  Ein wesentlicher Nachteil ist nur die Unterstützung von Node.js und PHP.  Andererseits ist es viel besser implementiert als Datadog.  Im Gegensatz zu letzterem benötigt Atatus keine Anwendungen, um zusätzliche Tags im Code zu ändern oder festzulegen. <br><br><h2>  Wie wir mit New Relic arbeiten </h2><br>  Lassen Sie uns nun herausfinden, wie wir New Relic im Allgemeinen verwenden.  Angenommen, wir haben ein Problem, das gelöst werden muss: <br><br><img src="https://habrastorage.org/webt/mk/_t/bv/mk_tbvlysng7--qgh2gvhjum4cg.png"><br><br>  Es ist leicht, einen <b>Anstieg</b> auf dem Diagramm zu bemerken - wir analysieren ihn.  In New Relic werden Webtransaktionen sofort für die Webanwendung ausgewählt, alle Komponenten werden im Leistungsdiagramm angezeigt, es gibt Fehlerraten- und Anforderungsraten-Panels ... Am wichtigsten ist, dass Sie direkt von diesen Panels aus zwischen verschiedenen Teilen der Anwendung wechseln können (z. B. durch Klicken auf MySQL wird zum Datenbankabschnitt). <br><br>  Da in diesem Beispiel ein Anstieg der <b>PHP-</b> Aktivität zu beobachten ist, klicken Sie auf dieses Diagramm und gehen Sie automatisch zu <b>Transaktionen</b> : <br><br><img src="https://habrastorage.org/webt/02/2v/b_/022vb_o0euwqk8jaf2qh1z4pges.png"><br><br>  Die Liste der Transaktionen, bei denen es sich im Wesentlichen um Controller aus dem MVC-Modell handelt, ist bereits nach <b>Zeitaufwendig</b> sortiert, was sehr praktisch ist: Wir sehen sofort, was die Anwendung tut.  Hier finden Sie Beispiele für lange Abfragen, die von New Relic automatisch erfasst werden.  Das Wechseln der Sortierung ist leicht zu finden: <br><br><ul><li>  der am meisten geladene Anwendungscontroller; </li><li>  Der am häufigsten angeforderte Controller </li><li>  der langsamste der Controller. </li></ul><br>  Darüber hinaus können Sie jede Transaktion erweitern und sehen, was die Anwendung zum Zeitpunkt der Codeausführung tat: <br><br><img src="https://habrastorage.org/webt/vq/bz/sk/vqbzsk-cj4sp9prjqwx16hnzy4k.png"><br><br>  Schließlich werden Beispiele für lange Abfragespuren (die länger als 2 Sekunden funktionieren) in der Anwendung gespeichert.  Hier ist das Panel für eine lange Transaktion: <br><br><img src="https://habrastorage.org/webt/jk/b_/ux/jkb_uxm9a3tx9ed6wdtufrz5g6u.png"><br><br>  Es ist ersichtlich, dass zwei Methoden viel Zeit in Anspruch nehmen, und mit der Zeit, zu der die Anforderung ausgeführt wurde, werden auch deren URI und Domäne angezeigt.  Sehr oft hilft dies, die Abfrage in den Protokollen zu finden.  In den <b>Trace-Details</b> können Sie sehen, woher diese Methoden stammen: <br><br><img src="https://habrastorage.org/webt/_1/m6/li/_1m6li8g6zgv8siatzj1mrqiclc.png"><br><br>  Und in <b>Datenbankabfragen</b> - bewerten Sie die Datenbankabfragen, die zum Zeitpunkt der Anwendung ausgeführt wurden: <br><br><img src="https://habrastorage.org/webt/ru/xv/k7/ruxvk7jbfe-93duilolwh3nj7p8.png"><br><br>  Mit diesem Wissen können wir die Ursache für die Verlangsamung der Anwendung beurteilen und gemeinsam mit dem Entwickler eine Strategie zur Lösung des Problems entwickeln.  In Wirklichkeit liefert New Relic nicht immer ein klares Bild, aber es hilft bei der Auswahl des Untersuchungsvektors: <br><br><ul><li>  das lange <code>PDO::Construct</code> führte uns zu der seltsamen Funktionsweise von pgpoll; </li><li>  Instabilität in der Zeit <code>Memcache::Get</code> falsche Konfiguration der virtuellen Maschine erhalten; </li><li>  Die verdächtig längere Zeit für die Verarbeitung der Vorlage führte zu einer verschachtelten Schleife mit einer Überprüfung auf das Vorhandensein von 500 Avataren im Objektspeicher. </li><li>  usw… </li></ul><br>  Es kommt auch vor, dass anstelle der Ausführung von Code auf dem Hauptbildschirm etwas im Zusammenhang mit der externen Datenspeicherung wächst - und es spielt keine Rolle, was es sein wird: Redis oder PostgreSQL - alle sind auf der Registerkarte " <b>Datenbanken"</b> ausgeblendet. <br><br><img src="https://habrastorage.org/webt/ku/ke/xe/kukexe0cn79kgj_x_40dt79au5e.png"><br><br>  Sie können eine bestimmte Basis für die Recherche auswählen und die Abfragen sortieren - ähnlich wie in Transaktionen.  Auf der Registerkarte "Anfrage" können Sie sehen, wie viel diese Anfrage in den einzelnen Anwendungscontrollern enthalten ist, und bewerten, wie oft sie aufgerufen wird.  Es ist sehr bequem: <br><br><img src="https://habrastorage.org/webt/ac/jm/xq/acjmxqt0dop9r1ncalo1enmrihq.png"><br><br>  Die Registerkarte <b>Externe Dienste</b> enthält ähnliche Daten, die Anforderungen für externe HTTP-Dienste verbergen, z. B. den Zugriff auf den Objektspeicher, das Senden von Ereignissen an den Wachposten oder dergleichen.  Die Registerkarte ähnelt inhaltlich den Datenbanken: <br><br><img src="https://habrastorage.org/webt/vv/2h/al/vv2halrqjfjjpqltn7ty1had57y.png"><br><br><h2>  Wettbewerber: Chancen und Eindrücke </h2><br>  Das Interessanteste ist nun, die Funktionen von New Relic mit denen der Wettbewerber zu vergleichen.  Leider konnten wir nicht alle drei Tools mit derselben Version einer Anwendung testen, die in der Produktion ausgeführt wird.  Trotzdem haben wir versucht, die identischsten Situationen / Konfigurationen zu vergleichen. <br><br><h3>  1. Datadog </h3><br>  Datadog begrüßt uns mit einem Panel mit einer Reihe von Diensten: <br><br><img src="https://habrastorage.org/webt/yt/vv/rt/ytvvrt5tlhegxiaoanulug0dwfu.png"><br><br>  Er versucht, Anwendungen in Komponenten / Microservices zu unterteilen. In der Beispielanwendung Django sehen wir zwei Verbindungen zu PostgreSQL ( <code>defaultdb</code> und <code>postgres</code> ) sowie zu Celery, Redis.  Für die Arbeit mit Datadog müssen Sie über ein Mindestwissen über die Prinzipien von MVC verfügen: Sie müssen verstehen, woher Benutzeranforderungen kommen.  Normalerweise hilft dabei <b>eine Service Map</b> : <br><br><img src="https://habrastorage.org/webt/t3/19/r9/t319r9yb96o3h0fjhdmi5wzdxbc.png"><br><br>  Übrigens gibt es in New Relic etwas Ähnliches: <br><br><img src="https://habrastorage.org/webt/f8/sr/tq/f8srtq3vds1qmm2ddrp_g-d6pwo.png"><br><br>  ... und ihre Karte wird meiner Meinung nach einfacher und verständlicher: Sie zeigt nicht die Komponenten einer Anwendung an (was sie unnötig detailliert machen würde, wie im Fall von Datadog), sondern nur bestimmte Dienste oder Mikrodienste. <br><br>  Zurück zu Datadog: Aus der Service Map geht hervor, dass Benutzeranforderungen an Django gehen.  Gehen wir zum Django-Service und sehen endlich, was wir erwartet haben: <br><br><img src="https://habrastorage.org/webt/c3/ip/fk/c3ipfkqpsv9jxxr1m0y9lqz7fvw.png"><br><br>  Leider gibt es standardmäßig kein <b>Web-Transaktions-</b> Zeitdiagramm, das dem im New Relic-Hauptfenster ähnelt.  Es kann jedoch anstelle des Diagramms <b>% der aufgewendeten Zeit</b> konfiguriert werden.  Es reicht aus, die <b>durchschnittliche Zeit pro Anfrage nach Typ</b> zu <b>ändern</b> ... und jetzt sieht uns das vertraute Diagramm an! <br><br><img src="https://habrastorage.org/webt/0l/jb/4m/0ljb4m2fh3_mbje9ihwvo6hlwge.png"><br><br>  Warum sich Datadog für einen anderen Zeitplan entschieden hat, ist uns ein Rätsel.  Es war auch frustrierend, dass sich das System (im Gegensatz zu beiden Mitbewerbern) nicht an die Wahl des Benutzers erinnert und daher nur die Erstellung von benutzerdefinierten Panels spart. <br><br>  Ich war jedoch erfreut über die Möglichkeit in Datadog, von diesen Diagrammen zu den Metriken verwandter Server zu wechseln, die Protokolle zu lesen und die Auslastung der Webserver-Handler (Gunicorn) zu bewerten.  Alles ist fast das gleiche wie in New Relic ... und sogar ein paar mehr (Protokolle)! <br><br>  Unter den Diagrammen befinden sich Transaktionen, die New Relic völlig ähnlich sind: <br><br><img src="https://habrastorage.org/webt/ln/pg/u5/lnpgu5fj2oclzdzlc1uwwjjtfkm.png"><br><br>  In Datadog werden Transaktionen als <b>Ressourcen bezeichnet</b> .  Sie können die Controller nach der Anzahl der Anforderungen, nach der durchschnittlichen Antwortzeit und nach der maximal verstrichenen Zeit für einen ausgewählten Zeitraum sortieren. <br><br>  Sie können die Ressource erweitern und alles sehen, was wir bereits in New Relic beobachtet haben: <br><br><img src="https://habrastorage.org/webt/3s/c1/5k/3sc15ksmnyvw_e-gyfagahxtep8.png"><br><br>  Es gibt Statistiken über die Ressource, eine allgemeine Liste interner Anrufe und Beispiele für Anforderungen, die nach dem Antwortcode sortiert werden können ... Übrigens, unsere Ingenieure haben diese Sortierung wirklich gemocht. <br><br>  Jede Beispielressource in Datadog kann erweitert und untersucht werden: <br><br><img src="https://habrastorage.org/webt/k8/tm/j8/k8tmj8vcz91rwmv-_lvshtzd8qi.png"><br><br>  Die Abfrageparameter, ein zusammenfassendes Diagramm der verstrichenen Zeit für jede der Komponenten und ein Wasserfalldiagramm, in dem die Reihenfolge der Aufrufe angezeigt wird, werden angezeigt.  Sie können auch zur Baumansicht des Wasserfalldiagramms wechseln: <br><br><img src="https://habrastorage.org/webt/og/uu/ro/oguurozj3wo9vibezkytxmmc0c4.png"><br><br>  Am interessantesten ist es, die Last des Hosts anzuzeigen, auf dem die Anforderung ausgeführt wurde, und die Anforderungsprotokolle anzuzeigen. <br><br><img src="https://habrastorage.org/webt/vg/n6/be/vgn6belqdye20suvjgsq5kje3wu.png"><br><br>  Tolle Integration! <br><br>  Möglicherweise fragen Sie sich, wo sich die Registerkarten <b>Datenbanken</b> und <b>externe Dienste</b> befinden, wie in New Relic.  Sie sind nicht hier: Da Datadog die Anwendung in Komponenten analysiert, wird PostgreSQL als <b>separater Dienst betrachtet</b> , und anstelle von externen Diensten lohnt es sich, nach <code>aws.storage</code> zu suchen (dies gilt auch für alle anderen externen Dienste, auf die die Anwendung zugreifen kann). <br><br><img src="https://habrastorage.org/webt/qp/bp/ap/qpbpapt5pqxtre_bkspuob-myqe.png"><br><br>  Und hier ist ein Beispiel mit <code>postgres</code> : <br><br><img src="https://habrastorage.org/webt/nb/u6/ea/nbu6eaa6-6xlbkipsijjn4i9rxg.png"><br><br>  In der Tat gibt es alles, was wir wollten: <br><br><img src="https://habrastorage.org/webt/ww/r8/-c/wwr8-cpjbw26yv_chyaknlyolfe.png"><br><br>  Es ist ersichtlich, von welchem ​​"Service" die Anfrage kam. <br><br>  Es ist nicht überflüssig, sich daran zu erinnern, dass Datadog perfekt in NGINX Ingress integriert ist und eine End-to-End-Ablaufverfolgung ab dem Moment ermöglicht, in dem eine Anforderung im Cluster eintrifft. Außerdem können Sie Statistikmetriken akzeptieren, Protokolle sammeln und Metriken hosten. <br><br>  Ein großes Plus von Datadog ist, dass sein Preis <i>aus</i> der Überwachung der Infrastruktur, APM, Protokollverwaltung und Synthetik-Test besteht, d. H.  Sie können flexibel einen Plan auswählen. <br><br><h3>  2. Atatus </h3><br>  Das Atatus-Team behauptet, dass ihr Service "der gleiche wie bei New Relic ist, aber besser".  Mal sehen, ob das wirklich so ist. <br><br>  Die Titelleiste sieht wirklich gleich aus, aber es war nicht möglich, die in der Anwendung verwendeten Redis und Memcached zu bestimmen. <br><br><img src="https://habrastorage.org/webt/-v/f8/9t/-vf89tugun8vmi3f8vc5upnswpq.png"><br><br>  APM wählt standardmäßig alle Transaktionen aus, obwohl normalerweise nur das Web benötigt wird.  Wie in Datadog gibt es keine Möglichkeit, über das Hauptfenster zum gewünschten Dienst zu gelangen.  Darüber hinaus werden Transaktionen nach Fehlern aufgelistet, was für APM nicht sehr logisch aussieht. <br><br>  Bei Atatus-Transaktionen ist alles New Relic so ähnlich wie möglich.  Minus - Sie können die Dynamik für jeden Controller nicht sofort sehen.  Sie müssen in der Controller-Tabelle danach suchen und nach der am <b>meisten verbrauchten Zeit</b> sortieren: <br><br><img src="https://habrastorage.org/webt/1r/gm/df/1rgmdfhp2wi-etyz90cp-nhicne.png"><br><br>  Die übliche Liste der Controller finden <b>Sie auf der</b> Registerkarte Durchsuchen: <br><br><img src="https://habrastorage.org/webt/n6/bm/4e/n6bm4epe4rgm1o0-j6gckbe5xcs.png"><br><br>  In gewisser Weise ähnelt diese Tabelle Datadog und ähnelt eher der in New Relic. <br><br>  Jede Transaktion kann bereitgestellt werden und sehen, was die Anwendung getan hat: <br><br><img src="https://habrastorage.org/webt/om/nj/jz/omnjjzghaohvdghitkkynauqwd8.png"><br><br>  Das Panel ähnelt auch eher Datadog: Es gibt eine Reihe von Anfragen, ein Gesamtbild der Anrufe.  Der obere Bereich enthält eine Registerkarte mit <b>HTTP-Fehlerfehlern</b> und Beispielen für langsame <b>Sitzungsablaufverfolgungsanforderungen</b> : <br><br><img src="https://habrastorage.org/webt/jc/cp/xo/jccpxoykxlwophfgejumdduui88.png"><br><br>  Wenn Sie eine Transaktion durchführen, sehen Sie ein Beispiel für eine Ablaufverfolgung. Sie können eine Liste der Abfragen an die Datenbank abrufen und die Anforderungsheader anzeigen.  Alles ist ähnlich wie bei New Relic: <br><br><img src="https://habrastorage.org/webt/_c/lb/dn/_clbdnkiqpd-6spg325of0c09o0.png"><br><br>  Im Allgemeinen war Atatus mit detaillierten Spuren zufrieden - ohne das typische New Relic-Einkleben von Anrufen in einen Erinnerungsblock: <br><br><img src="https://habrastorage.org/webt/m5/ub/hk/m5ubhk5bxdzyqwg3oaidmflbmjc.png"><br><img src="https://habrastorage.org/webt/hv/3s/27/hv3s27-mped0zuubmx9qs-7b_7c.png"><br><br>  Es gibt jedoch nicht genügend Filter, die (wie in New Relic) ultraschnelle Anforderungen (&lt;5 ms) abschneiden würden.  Andererseits war es angenehm, die endgültige Transaktionsantwort (erfolgreich oder fehlerhaft) anzuzeigen. <br><br>  Im Bereich " <b>Datenbanken"</b> können Sie die Anforderungen der Anwendung an externe Datenbanken untersuchen.  Ich möchte Sie daran erinnern, dass Atatus nur PostgreSQL und MySQL gefunden hat, obwohl Redis und memcached ebenfalls an dem Projekt beteiligt sind. <br><br><img src="https://habrastorage.org/webt/rj/1z/vn/rj1zvn9n6wvmcbzcx1fj65x1mmg.png"><br><br>  Anfragen werden nach den üblichen Kriterien sortiert: Antworthäufigkeit, durchschnittliche Antwortzeit usw.  Ich möchte auch die Registerkarte mit den langsamsten Abfragen beachten - dies ist sehr praktisch.  Darüber hinaus stimmten die Daten auf dieser Registerkarte für PostgreSQL mit den Daten aus der Erweiterung <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">pg_stat_statements überein</a> - ein hervorragendes Ergebnis! <br><br><img src="https://habrastorage.org/webt/-4/th/4c/-4th4c5ykhiikiwtmrk23rr7g7g.png"><br><br>  Die Registerkarte <b>Externe Anforderungen</b> ist identisch mit Datenbanken. <br><br><h2>  Schlussfolgerungen </h2><br>  Beide vorgestellten Tools zeigten in der Rolle von APM eine gute Leistung.  Jeder von ihnen kann das notwendige Minimum bieten.  Fassen Sie unsere Eindrücke kurz wie folgt zusammen: <br><br><h3>  Datadog </h3><br>  Vorteile: <br><br><ul><li>  bequemer Tarifplan (APM kostet 31 USD pro Host); </li><li>  gut mit Python durchgeführt; </li><li>  Integrationsfähigkeit in OpenTracing </li><li>  Kubernetes-Integration </li><li>  Integration mit NGINX Ingress. </li></ul><br>  Nachteile: <br><br><ul><li>  Der einzige APM, der aufgrund eines Modulfehlers (predis) zu einer Unzugänglichkeit der Anwendung geführt hat. </li><li>  schwache PHP-Auto-Tools; </li><li>  teilweise seltsame Definition von Dienstleistungen und deren Zweck. </li></ul><br><h3>  Atatus </h3><br>  Vorteile: <br><br><ul><li>  tiefe Instrumentierung von PHP; </li><li>  Neue Relic-ähnliche Benutzeroberfläche. </li></ul><br>  Nachteile: <br><br><ul><li>  funktioniert nicht unter älteren Betriebssystemen (Ubuntu 12.05, CentOS 5); </li><li>  schwache Autowerkzeuge; </li><li>  Unterstützung für nur zwei Sprachen (Node.js und PHP); </li><li>  langsamer Betrieb der Schnittstelle. </li></ul><br>  Angesichts des Atatus-Preises von 69 USD pro Monat und Server würden wir lieber Datadog verwenden, das sich perfekt in unsere Anforderungen einfügt (Webanwendungen in K8s) und viele nützliche Funktionen bietet. <br><br><h2>  PS </h2><br>  Lesen Sie auch in unserem Blog: <br><br><ul><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Tools für Anwendungsentwickler, die auf Kubernetes ausgeführt werden</a> "; </li><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kubectl-Debug-Plugin zum Debuggen in Kubernetes-Pods</a> "; </li><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Microservices: Größe ist wichtig, auch wenn Sie Kubernetes haben</a> ." </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de465177/">https://habr.com/ru/post/de465177/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de465161/index.html">Quintett-Datenmodell und Hunderte von Gigabyte Daten</a></li>
<li><a href="../de465163/index.html">3D-Druck: erstaunliche Fälle und etwas interessanter</a></li>
<li><a href="../de465167/index.html">Ressourcenplanung. Warum funktioniert es nicht? Teil 1</a></li>
<li><a href="../de465169/index.html">DIY von PVS-Studio: Gamification of Achievements</a></li>
<li><a href="../de465173/index.html">So ändern Sie die Kosten des erstellten Abonnements in Ihrer Anwendung. App Store Connect und Google Play Console</a></li>
<li><a href="../de465179/index.html">Wird die Automatisierung das manuelle Testen ersetzen?</a></li>
<li><a href="../de465181/index.html">Rutschige Stellen in C ++ 17</a></li>
<li><a href="../de465185/index.html">Neue Videoüberwachungsstandards: Farbe bei Nacht, Rauschunterdrückung, ePoE</a></li>
<li><a href="../de465187/index.html">6 englische Sätze, die in Gehaltsverhandlungen mit ausländischen Unternehmen verwendet werden können</a></li>
<li><a href="../de465189/index.html">Workflow One Sprint-Entwicklungsteam</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>