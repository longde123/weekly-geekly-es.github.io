<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤧 👋🏽 🧑🏼‍🤝‍🧑🏻 Wie Verizon und BGP Optimizer sich offline hervorragend einrichten 👩🏽‍🍳 👩🏿‍🎤 👏</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ein großes Routenleck hat große Internetsektoren betroffen, einschließlich Cloudflare 
 Was ist passiert? 


 Am 24. Juni, um 10:30 UTC, brach das Int...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie Verizon und BGP Optimizer sich offline hervorragend einrichten</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/southbridge/blog/457712/"><p><img src="https://habrastorage.org/webt/eg/la/bv/eglabvr8m7jxhrj7eu2mv_uxghe.jpeg"></p><br><h2 id="krupnaya-utechka-marshrutov-povliyala-na-bolshie-sektory-interneta-vklyuchaya-cloudflare">  Ein großes Routenleck hat große Internetsektoren betroffen, einschließlich Cloudflare </h2><br><h3 id="chto-sluchilos">  Was ist passiert? </h3><br><p>  Am 24. Juni, um 10:30 UTC, brach das Internet zusammen: Ein kleines Unternehmen im Norden von Pennsylvania strömte einen Verkehrsstrom von vielen Strecken über einen großen Anbieter Verizon (AS701) - mit dem gleichen Erfolg konnte der Navigator einen Strom von Autos von einer mehrspurigen Autobahn auf eine schmale Straße schicken .  Infolgedessen haben viele Websites auf Cloudflare und viele andere Anbieter Zugriffsprobleme.  Dies hätte überhaupt nicht passieren dürfen, da Verizon diese Routen nicht an das gesamte Internet senden sollte.  Lesen Sie weiter, um herauszufinden, wie es passiert ist. </p><a name="habracut"></a><br><p> Wir haben bereits zuvor über solche <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Vorfälle geschrieben</a> , die von Zeit zu Zeit auftreten, aber diesmal haben wir die Konsequenzen auf der ganzen Welt gespürt.  Das Problem wurde durch den BGP-Optimierer von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Noction</a> verschärft.  Es hat eine Funktion, die die empfangenen IP-Präfixe in kleinere und spezifischere aufteilt.  Beispielsweise wurde unsere IPv4-Route 104.20.0.0/20 in 104.20.0.0/21 und 104.20.8.0/21 unterteilt.  Als ob der Wegweiser von Pennsylvania durch zwei andere ersetzt worden wäre: Pittsburgh, PA und Philadelphia, PA.  Durch die Aufteilung großer IP-Blöcke in kleine verwaltet das Netzwerk den Datenverkehr in sich selbst. Diese Trennung sollte jedoch nicht öffentlich verfügbar sein.  Andernfalls treten solche Probleme auf. </p><br><p>  Um zu erklären, was als nächstes geschah, erinnern wir uns zunächst an die Funktionsweise des Internets.  Im Wesentlichen ist das Internet ein Netzwerk, das aus Netzwerken besteht, die als autonome Systeme bezeichnet werden.  Jedes autonome System hat eine eigene eindeutige Kennung.  Alle Netzwerke sind über das Border Gateway Protocol (BGP) miteinander verbunden.  BGP verbindet diese Netzwerke und bildet die Internetstruktur, in der der Datenverkehr beispielsweise von Ihrem Internetprovider zu einer beliebten Website in einem anderen Teil der Welt geleitet wird. </p><br><p>  Über BGP tauschen Netzwerke Informationen über Routen aus, nämlich wie sie von überall zu ihnen gelangen.  Diese Routen können spezifisch (wie eine bestimmte Stadt auf der Karte) oder allgemein (wie ein Gebiet) sein.  Und dann passierte Ärger. </p><br><p>  Ein Internetdienstanbieter in Pennsylvania ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">AS33154</a> - DQE Communications) verwendete BGP Optimizer in seinem Netzwerk, was bedeutet, dass es in seinem Netzwerk viele spezifische Routen gab.  Bestimmte Routen haben Vorrang vor allgemeinen Routen (im selben Navigator ist beispielsweise die Route zum Buckingham Palace spezifischer als die Route nach London). </p><br><p>  DQE stellte diese spezifischen Routen seinem Kunden zur Verfügung ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">AS396531</a> - Allegheny Technologies Inc), und von dort gelangten sie zum Transitanbieter ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">AS701</a> - Verizon), der diese "optimalen" Routen über das Internet führte.  Sie scheinen optimal zu sein, weil sie mehr Details und Besonderheiten haben. </p><br><p>  Und das alles sollte nicht über Verizon hinausgehen.  Obwohl es wirksame Möglichkeiten gibt, sich vor solchen Fehlern zu schützen, hat das Fehlen von Filtern bei Verizon zu einem Zusammenbruch geführt, der viele Dienste wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Amazon, Linode und Cloudflare</a> betrifft. </p><br><p>  Infolgedessen stießen Verizon, Allegheny und DQE auf eine Welle von Benutzern, die versuchten, über ihr Netzwerk auf diese Dienste zuzugreifen.  Sie waren nicht für einen so starken Verkehr ausgelegt, der zu Unterbrechungen führte.  Und selbst wenn genügend Ressourcen vorhanden wären, hätten DQE, Allegheny und Verizon nicht jedem von der idealen Route zu Cloudflare, Amazon, Linode usw. erzählen sollen. </p><br><p><img src="https://habrastorage.org/webt/yb/he/ti/ybhetij-tbe3genbvvdyqwdd6_k.png"><br>  <em>BGP-Leckprozess mit BGP Optimizer.</em> </p><br><p>  In den schlimmsten Momenten des Ausfalls beobachteten wir einen Verlust von ungefähr 15% des weltweiten Verkehrs. </p><br><p> <a href=""><img src="https://habrastorage.org/webt/ih/1x/by/ih1xbyulz4o5z9yhi_pazwvysk8.png"></a> <br>  <em>Cloudflare-Verkehrsaufkommen während eines Vorfalls.</em> </p><br><h3 id="kak-mozhno-bylo-predotvratit-utechku">  Wie kann ein Leck verhindert werden? </h3><br><p>  <strong>Es gibt verschiedene Möglichkeiten.</strong> </p><br><p>  Für eine BGP-Sitzung können Sie ein festes Limit für akzeptierte Präfixe festlegen. Wenn die Anzahl der Präfixe den Schwellenwert überschreitet, beendet der Router die Sitzung.  Wenn Verizon eine solche Beschränkung für Präfixe hätte, wäre nichts passiert.  Für einen Anbieter wie Verizon wäre die Installation wertlos.  Warum gab es keine Grenzen?  Ich habe eine Version: Nachlässigkeit und Faulheit. </p><br><p>  Eine andere Möglichkeit, solche Lecks zu vermeiden, ist die Verwendung der IRR-Filterung.  IRR (Internet Routing Registry) ist eine verteilte Datenbank von Internetrouten, zu denen Netzwerke Einträge hinzufügen.  Andere Netzbetreiber verwenden diese IRR-Einträge, um Listen mit bestimmten Präfixen für BGP-Sitzungen mit anderen Netzen zu erstellen.  Wenn IRR-Filter verwendet würden, würde keines dieser Netzwerke fehlerhafte spezifische Routen akzeptieren.  Unglaublicherweise hatte Verizon diese Filterung in BGP-Sitzungen mit Allegheny Technologies überhaupt nicht, obwohl die IRR-Filterung seit mehr als 24 Jahren verwendet (und gut dokumentiert) wird.  IRR-Filter würden Verizon nichts kosten und ihren Service in keiner Weise einschränken.  Und wieder - Nachlässigkeit und Faulheit. </p><br><p>  Letztes Jahr haben wir die RPKI-Plattform implementiert und bereitgestellt, die solche Lecks nur verhindert.  Es setzt Filter entsprechend dem Quellnetzwerk und der Präfixgröße.  Cloudflare kündigt Präfixe mit einer maximalen Größe von 20 an. RPKI gibt an, dass spezifischere Präfixe unabhängig vom Pfad nicht akzeptiert werden können.  Damit dieser Mechanismus funktioniert, muss die BGP-Ursprungsvalidierung im Netzwerk aktiviert sein.  Viele Anbieter, zum Beispiel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">AT &amp; T, setzen RPKI bereits erfolgreich</a> in ihrem Netzwerk ein. </p><br><p>  Wenn Verizon RPKI verwendet, wird festgestellt, dass die vorgeschlagenen Routen nicht gültig sind, und der Router lehnt sie automatisch ab. </p><br><p>  Cloudflare empfiehlt allen Netzbetreibern, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">RPKI</a> sofort <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">bereitzustellen</a> ! </p><br><p> <a href=""><img src="https://habrastorage.org/webt/yq/-h/kg/yq-hkgdc4apbxmoah08pgatre_e.png"></a> <br>  <em>Routenleckverhütung mithilfe von IRR-, RPKI- und Präfix-Grenzwerten.</em> </p><br><p>  Alle diese Empfehlungen sind in MANRS (einvernehmlich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">vereinbarte Normen für die Routing-Sicherheit</a> ) ausführlich beschrieben. </p><br><h3 id="kak-reshili-problemu">  So lösen Sie das Problem </h3><br><p>  Das Cloudflare-Netzwerkteam kontaktierte die betroffenen Netze AS33154 (DQE Communications) und AS701 (Verizon).  Es war nicht einfach - vielleicht weil es zu Beginn ein früher Morgen an der Ostküste der Vereinigten Staaten war. </p><br><p> <a href=""><img src="https://habrastorage.org/webt/gl/q6/4p/glq64pqghwlgqmnuj-dakabotnc.png"></a> <br>  <em>Screenshot eines Briefes an Verizon.</em> </p><br><p>  Einer unserer Netzwerktechniker setzte sich schnell mit DQE Communications in Verbindung, und nach einer kurzen Verzögerung wurden wir mit demjenigen verbunden, der das Problem lösen konnte.  Dank unseres telefonischen Supports konnte DQE das Senden „optimierter“ Routen an Allegheny Technologies Inc. einstellen.  Wir sind ihnen für ihre Hilfe dankbar.  Alles stabilisierte sich und normalisierte sich wieder. </p><br><p><img src="https://habrastorage.org/webt/r7/sy/en/r7syendhc6ygx3y9dkybsrwouk0.png"><br>  <em>Screenshot der Versuche, DQE und Verizon Support Services zu kontaktieren</em> </p><br><p>  Leider hat uns trotz aller Versuche, Verizon per Telefon und E-Mail zu kontaktieren, zum Zeitpunkt des Schreibens (seit dem Vorfall sind mehr als 8 Stunden vergangen) niemand geantwortet, und wir wissen nicht, ob sie etwas unternehmen . </p><br><p>  Wir bei Cloudflare möchten dies nicht wiederholen, aber leider wird sehr wenig dafür getan.  Es ist an der Zeit, dass die Branche effektivere Maßnahmen ergreift, um die Routing-Sicherheit zu gewährleisten, beispielsweise bei Systemen wie RPKI.  Wir hoffen, dass große Anbieter Cloudflare, Amazon und AT &amp; T folgen und mit der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Überprüfung der Routen</a> beginnen.  Dies gilt insbesondere für Sie, Verizon.  Wir warten immer noch auf eine Antwort. </p><br><p>  Und obwohl wir nicht beeinflussen konnten, was passiert ist, entschuldigen wir uns für die Betriebsunterbrechung.  Wir kümmern uns um unsere Kunden, und Ingenieure in den USA, Großbritannien, Australien und Singapur haben uns einige Minuten nach der Entdeckung des Problems kontaktiert. </p><br><p>  Andere Artikel mit dem Tag <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">BGP</a> . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de457712/">https://habr.com/ru/post/de457712/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de457700/index.html">Node.js Authentifizierungshandbuch ohne passport.js und Dienste von Drittanbietern</a></li>
<li><a href="../de457702/index.html">Arbeiten Sie mit der KOMPAS-3D-API → Lektion 16 → Steuerzeichen</a></li>
<li><a href="../de457704/index.html">Wie GPUs mit Verzweigungen umgehen</a></li>
<li><a href="../de457706/index.html">Roboter testet SAP ERP</a></li>
<li><a href="../de457710/index.html">Die erstaunlichen Eigenschaften neuronaler Netze 2019</a></li>
<li><a href="../de457714/index.html">Stapelüberlauf in Englisch: Community Kill Guide</a></li>
<li><a href="../de457718/index.html">HyperCard, das verlorene Glied in der Entwicklung des Web</a></li>
<li><a href="../de457720/index.html">Autodesk Maya: Nützliche Grundfunktionen für die Arbeit mit 3D-Modellen</a></li>
<li><a href="../de457722/index.html">SQL: Zeiterfassung Problem: Nachbesprechung</a></li>
<li><a href="../de457724/index.html">OpenCV auf STM32F7-Discovery</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>