<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîá ü§ö üéæ L'√©dition de texte vous d√©teste aussi ü§õüèΩ üëõ üíÜüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'article d'Alexis Bingessner, ¬´Text Rendering Hates You¬ª, publi√© il y a un mois , est tr√®s proche de moi. 

 En 2017, je d√©veloppais un √©diteur de te...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>L'√©dition de texte vous d√©teste aussi</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/474036/">  L'article d'Alexis Bingessner, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">¬´Text Rendering Hates You¬ª,</a> publi√© il y a un mois <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">, est</a> tr√®s proche de moi. <br><br>  En 2017, je d√©veloppais un √©diteur de texte interactif dans un navigateur.  Insatisfait des biblioth√®ques ContentEditable existantes, je me suis dit: ¬´H√©, re-r√©alisons juste la s√©lection de texte!  C'est dur? "  J'√©tais jeune.  Na√Øf.  J'ai pens√© que je pourrais le g√©rer en deux semaines.  En fait, une tentative pour r√©soudre ce probl√®me a pris plusieurs ann√©es de ma vie, y compris un an de travail r√©mun√©r√© du matin au soir pour d√©velopper un √©diteur de texte pour le nouvel OS. <br><br>  Au travail, j'ai eu la chance d'apprendre beaucoup de <abbr title="comme toujours, gr√¢ce √† Raf Levien et Yokhey Yukawa qui m'ont appris tout ce que je sais sur la dactylographie">mentors ayant une vaste exp√©rience dans ce domaine</abbr> .  J'ai entendu beaucoup, beaucoup d'histoires effrayantes.  Y compris un ing√©nieur qui a pris en charge une application Windows avec une impl√©mentation personnalis√©e d'un champ de texte - et qui voulait passer d'une API de saisie de texte obsol√®te √† une nouvelle version.  Voici une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">liste des interfaces de</a> saisie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">de</a> texte dans cette nouvelle version: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/905/ade/db0/905adedb0a3bd875236bfadd2c9f533d.png"><br><a name="habracut"></a><br>  C'est vrai, 128 interfaces pour saisir du texte.  Je suis presque s√ªr qu‚Äôil existe huit (8!) Diff√©rents types de verrous pour r√©soudre les probl√®mes de concurrence, m√™me si je n‚Äôai honn√™tement pas lu leur documentation, alors ne me citez pas √† ce sujet.  Cet ing√©nieur d'un an et demi (√† plein temps!) A modifi√© son √©diteur, mais a finalement √©chou√© et est rest√© sur l'ancienne API. <br><br>  La dactylographie est difficile. <br><br>  Alexis mentionne parfois la s√©lection de texte, mais son exp√©rience personnelle est plus li√©e au rendu.  En tant que personne, d'autre part, je peux ajouter quelques points sur la contribution. <br><br><h3>  Mouvement vertical du curseur </h3><br>  J'ai d√©j√† couvert cela dans un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article pr√©c√©dent</a> , mais nous pouvons r√©p√©ter rapidement ici. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2d7/dcb/be8/2d7dcbbe886a8da0e23abaf51f092ced.png"></div><br><br>  Dans cet exemple, si vous appuyez vers le haut, le curseur se place au d√©but de la ligne, avant le mot <i>bonjour</i> .  Jusqu'√† pr√©sent, tout est assez raisonnable.  Mais si vous appuyez vers le haut puis vers le bas, le curseur sautera d'abord devant <i>bonjour</i> , puis se tiendra apr√®s <i>certains</i> . <br><br>  Cela peut ne pas sembler tr√®s logique.  Vous demandez pourquoi il saute √† droite?  Eh bien, avec les mouvements verticaux, chaque curseur se souvient de la position <i>x</i> en pixels, et il ne se met √† jour que lorsque vous appuyez sur la gauche ou la droite, et non vers le haut et vers le bas.  Le m√™me comportement emp√™che les curseurs de se d√©placer vers la gauche lors d'un d√©placement vertical sur de courtes lignes. <br><br><h3>  Proximit√© </h3><br>  Bon, maintenant nous savons que lorsque nous s√©lectionnons du texte, nous avons <i>deux</i> √©l√©ments d'√©tat: le d√©calage d'octet √† l'int√©rieur de la ligne et la coordonn√©e <i>x</i> en pixels, mentionn√©e ci-dessus.  Le probl√®me est-il r√©solu?  Et bien non. <br><br>  Consid√©rez deux positions de curseur sur une tr√®s longue ligne: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bf1/a02/0f5/bf1a020f5aa7512ad957b47717fd4bc2.png"></div><br><br>  Puisque <i>loooooooooong</i> est un mot, deux positions de curseur ont <i>exactement le m√™me d√©calage d'octet dans la cha√Æne</i> .  Il n'y a pas de nouvelle ligne entre eux, car la ligne est doucement envelopp√©e.  Nos curseurs ont besoin d'un bit suppl√©mentaire qui leur indique vers quelle ligne aller.  La plupart des syst√®mes appellent ce bit affinit√©.  Il est √©galement utilis√© dans le texte mixte bidirectionnel, dont nous parlerons bient√¥t. <br><br><h3>  Modificateurs Emoji </h3><br>  Supposons que j'envoie un message √† un ami.  Pour exprimer mes sentiments, je veux ajouter un emoji dr√¥le.  J'entre dans la zone de texte un pouce vers le haut, <code>a</code> lettre <code>a</code> et un modificateur d'emoji pour le teint.  Cela ressemble √† ceci: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4fd/f6b/1e8/4fdf6b1e84ddd2774b68d335e8b597b8.png"></div><br><br>  Oh, je ne voulais pas √©crire une lettre.  Je place le curseur apr√®s et clique sur Retour arri√®re.  Que va-t-il se passer?  J'ai vu plusieurs options, selon l'√©diteur. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/237/c58/054/237c580542b2d5921a07adbdfb2d32c5.png"></div><br><br><ul><li>  <b>Le mauvais num√©ro 1</b> peut <i>sembler</i> correct.  Mais c'est ainsi qu'un √©diteur de texte fonctionne avec la prise en charge du rendu d'emoji h√©rit√©, par exemple, Sublime Text.  C'est mauvais car les emoji √† doigts l√©gers sont encod√©s comme un doigt jaune, suivi imm√©diatement d'un modificateur de teint.  Ils ne sont pas combin√©s en un seul symbole, comme pr√©vu.  M√™me si je copie le doigt l√©ger d'une autre application, il ne s'affichera toujours pas correctement, comme ici. <br></li><li>  <b>Le mauvais # 2</b> est ce que fait Chrome 77 dans la barre d'adresse.  Pas sur les pages Web, mais uniquement dans la barre d'adresse.  Ce n'est pas un probl√®me de rendu, car les emoji copier-coller avec le teint fonctionnent.  Au lieu de cela, Chrome supprime la lettre, et apr√®s avoir remarqu√© le modificateur suivant la lettre, il le supprime √©galement.  Oups <br></li><li>  <b>Le mauvais num√©ro 3</b> correspond √† la sp√©cification Unicode de la fa√ßon dont les emoji doivent √™tre fusionn√©s.  Mais cela est assez incompr√©hensible pour les utilisateurs, et en passant, vous devez d√©placer le curseur pour qu'il ne reste pas coinc√© √† mi-chemin √† l'int√©rieur de l'emoji. </li></ul><br>  Toutes les options sont mauvaises, vous pouvez donc supposer qu'il existe probablement une quatri√®me option.  Voil√†!  De nombreux √©diteurs, tels que TextEdit, ne vous permettent m√™me pas de placer le curseur apr√®s la lettre, car le modificateur de teint est consid√©r√© comme une seule unit√© avec le caract√®re pr√©c√©dent.  Cela a du sens dans le contexte des emoji et fonctionne m√™me bien dans ce cas, mais que faire si le modificateur est indiqu√© par le premier caract√®re de la cha√Æne? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2ef/a2e/3ad/2efa2e3ad0396bd2362cd08694c841fc.png"></div><br><br>  Maintenant, le modificateur change le caract√®re de nouvelle ligne.  TextEdit ne vous permettra pas de placer le curseur au d√©but de la deuxi√®me ligne!  Personnellement, je consid√®re cette d√©cision ¬´aussi mauvaise¬ª. <br><br>  Vous avez peut-√™tre √©galement remarqu√© que le pouce vers le haut est devenu le pouce vers le bas.  Je l'ai fait moi-m√™me pour refl√©ter mes sentiments sur la situation dans son ensemble. <br><br>  Soit dit en passant, TextEdit rend le curseur sur la premi√®re ligne <i>tr√®s</i> bogu√©.  Par exemple, devinez ce qui se passe si j'appuie sur <code>4</code> ici? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1c8/988/687/1c898868781c9461aba7ab1e7cb74255.png"></div><br><br>  Ouais.  Vous pourriez √©galement penser qu'il y a des espaces entre les chiffres.  Ils ne sont pas l√†. <br><br><h3>  Texte bidirectionnel </h3><br>  Alexis mentionne les s√©lections fractionn√©es dans un texte bidirectionnel mixte, comme dans cet exemple de TextEdit: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/14b/dd3/8c3/14bdd38c366451ff768fc4aa15dc17b3.png"></div><br><br>  Cela a vraiment du sens, car la langue arabe dans les lignes est cod√©e de droite √† gauche, de sorte que la s√©lection semble √™tre divis√©e, mais les octets sont une plage continue. <br><br>  Par cons√©quent, il est un peu surprenant que nous puissions obtenir cette s√©lection: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/53d/d86/9aa/53dd869aa064eb6ebc8cac8114147800.png"></div><br><br>  Oui, il est visuellement continu, mais s√©par√© en octets.  Oui, c'est mauvais.  Certains √©diteurs le font si vous s√©lectionnez du texte avec les touches fl√©ch√©es au lieu de la souris.  Une alternative consiste √† √©changer les touches gauche / droite √† l'int√©rieur du texte avec la direction de droite √† gauche, ce qui est √©galement mauvais.  Il n'y a pas de bonnes options ici. <br><br>  En prime, essayez de comprendre ce qui se passe ici: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e88/2bb/b48/e882bbb480ea0a67812b862fc778d815.png"></div><br><br>  Seigneur ... je ne veux pas faire de commentaire √† ce sujet. <br><br><h3>  La chose sur les m√©thodes de saisie </h3><br>  Un logiciel qui traduit les frappes en entr√©e est appel√© m√©thode d'entr√©e ou √©diteur de m√©thode d'entr√©e.  Pour l'alphabet latin, ce n'est pas un logiciel tr√®s int√©ressant, car chaque frappe est directement associ√©e √† l'insertion d'un caract√®re.  Mais dans de nombreux scripts, les personnages ne tiennent pas sur le clavier, vous devez donc √™tre cr√©atif.  Par exemple, dans certaines m√©thodes de saisie pour la langue chinoise, l'utilisateur entre des sons - et obtient une liste de caract√®res similaires dans le son: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/257/4be/547/2574be547e63c1408db959a8bd107c90.png"></div><br><br>  Ce champ est parfois appel√© r√©gion de composition et appara√Æt souvent <abbr title="zone de composition">au-dessus du texte soulign√©</abbr> .  Parfois, la m√©thode d'entr√©e doit le styliser.  Par exemple, la m√©thode de saisie japonaise sur Android utilise la couleur d'arri√®re-plan pour cr√©er une zone de partage de phrases: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b27/583/4c2/b275834c23880b9375d4da714632f1cc.png"></div><br>  <i><font color="gray">(Merci √† Shae pour la capture d'√©cran!)</font></i> <br><br>  Toutes ces s√©lections et zones de composition interagissent-elles avec du texte bidirectionnel?  N'y pensons pas. <br><br>  Les m√©thodes de saisie devraient fonctionner partout, <i>m√™me √† l'int√©rieur du terminal</i> : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/24d/b76/f54/24db76f544a936d70edb9143a36fdba0.png"></div><br><br>  Rien n'ira √† Vim tant qu'un caract√®re chinois n'aura pas √©t√© s√©lectionn√© dans la liste.  Vous pensez probablement: "Mais comment √ßa marche en mode de commande Vim?"  Pas tr√®s bien.  C'est pourquoi, sur Internet, la saisie de texte et les frappes sont des √©v√©nements distincts.  Dans la console, ils se m√©langent, causant des probl√®mes. <br><br>  Ceci n'est qu'un exemple de nombreuses m√©thodes de saisie de texte diff√©rentes.  (N'oubliez pas les m√©thodes de saisie sans clavier telles que la voix et l'√©criture manuscrite!) Heureusement, le syst√®me d'exploitation vous fournit toutes ces m√©thodes.  Mais, malheureusement, votre zone de texte doit parler du protocole de saisie de texte g√©n√©ral utilis√© par toutes ces m√©thodes.  Pour Windows, ce sont les 128 interfaces r√©pertori√©es au d√©but de l'article.  Dans d'autres syst√®mes d'exploitation, les interfaces sont plus simples, mais elles sont toujours difficiles √† impl√©menter. <br><br>  Vous pouvez √©galement remarquer que la m√©thode d'entr√©e est un processus distinct, de sorte que la m√©thode d'entr√©e et l'application peuvent apporter des modifications √† l'√©tat du champ de texte.  Il s'agit en fait d'un protocole d'√©dition parall√®le.  Windows r√©sout le probl√®me avec huit (8!) Types de verrous.  Bien que le maintien d'un verrou au-del√† des limites du processus puisse sembler douteux, la plupart des autres plates-formes essaient d'utiliser des heuristiques imparfaites pour r√©soudre les probl√®mes de concurrence.  Ou ils esp√®rent simplement que la condition de course ne se produira pas.  D'apr√®s mon exp√©rience, la pri√®re n'est pas une primitive tr√®s efficace du parall√©lisme. <br><br><h3>  Pourquoi tout est-il si compliqu√© ?? </h3><br>  Jonathan Blow, dans une conf√©rence sur la d√©gradation des logiciels, mentionne l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√©diteur de texte Ken Thompson</a> , qu'il a √©crit en une semaine.  La plupart du code de cet article est une complexit√© introduite au hasard.  Windows a-t-il vraiment besoin de 128 interfaces et de 8 types de verrous pour la saisie de texte?  Pas question.  Les erreurs dans TextEdit sont-elles le r√©sultat d'un mod√®le d'√©dition complexe?  Oui  La dispersion des bogues dans les programmes modernes est-elle une source de pr√©occupation?  Du moins pour moi, √ßa l'est. <br><br>  Cependant, l'√©diteur de Ken Thompson √©tait √©galement beaucoup, beaucoup plus simple que ce que nous attendons des √©diteurs de texte modernes.  Unicode prend en charge presque toutes les langues vivantes dans le monde (il y en a environ 7 000) et beaucoup d'autres sont mortes.  Il existe diff√©rents scripts, directions de texte et m√©thodes de saisie, chacun imposant des restrictions complexes (et dans certains cas insolubles) √† tout √©diteur.  Mais il doit √©galement prendre en charge les lecteurs d'√©cran. <br><br>  Une √©norme complexit√© s'accumule <i>in√©vitablement</i> , et dans cet article, nous ne l'avons que l√©g√®rement touch√©e.  Il s'agit d'un v√©ritable miracle de programmation que vous pouvez simplement gifler <code>&lt;textarea&gt;</code> sur une page Web - et fournir instantan√©ment une entr√©e de texte √† chaque internaute du monde entier. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr474036/">https://habr.com/ru/post/fr474036/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr474020/index.html">Comment Methodius est devenue Anna: l'exp√©rience du d√©veloppement et du lancement de classificateurs de messages vocaux. 3e partie</a></li>
<li><a href="../fr474024/index.html">Nous transformons un robot aspirateur en soldat universel</a></li>
<li><a href="../fr474026/index.html">Histoires de consommateurs, Asos abandonne son magazine et TikTok</a></li>
<li><a href="../fr474028/index.html">De quelles comp√©tences g√©n√©rales les d√©veloppeurs ont-ils besoin? L'avis de Yandex</a></li>
<li><a href="../fr474032/index.html">Organisation des cellules standard (notes d'un √©tranger)</a></li>
<li><a href="../fr474038/index.html">Mises √† jour p√©riodiques des donn√©es</a></li>
<li><a href="../fr474040/index.html">Interview de Playboy: Steve Jobs, partie 1</a></li>
<li><a href="../fr474042/index.html">Comp√©tition! Histoires √† la lumi√®re de serveurs vacillants ...</a></li>
<li><a href="../fr474046/index.html">S√©minaires sur les services cloud, l'IA, la blockchain, la science des donn√©es, les microservices: maintenant √† Moscou et √† Saint-P√©tersbourg</a></li>
<li><a href="../fr474048/index.html">HILDACRYPT: un nouveau ransomware frappe les syst√®mes de sauvegarde et les solutions antivirus</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>