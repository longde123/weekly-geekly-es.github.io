<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ”– â›¸ï¸ ğŸ‘¨ğŸ¿â€ğŸ¤â€ğŸ‘¨ğŸ½ Design und Benennung von Warteschlangen ğŸ¤·ğŸ¾ ğŸ§– ğŸ†š</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Einige Regeln zum Organisieren von Punkten, Warteschlangen und zum korrekten Benennen, um dies zu vereinfachen. 



| exchange | type | binding_queue ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Design und Benennung von Warteschlangen</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/443722/">  Einige Regeln zum Organisieren von Punkten, Warteschlangen und zum korrekten Benennen, um dies zu vereinfachen. <br><br><pre><code class="plaintext hljs">| exchange | type | binding_queue | binding_key | |-------------------------------------------------------| | user.write | topic | user.created.app2 | user.created |</code> </pre> <a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Die Konzepte</b> <div class="spoiler_text">  <b>AMQP</b> (Advanced Message Queuing Protocol) ist ein offenes Protokoll zum Ãœbertragen von Nachrichten zwischen Systemkomponenten. <br>  <b>Provider</b> (Publishers / Producer) - ein Programm, das Nachrichten sendet. <br>  <b>Abonnent</b> (Verbraucher) - ein Programm, das Nachrichten akzeptiert.  In der Regel befindet sich der Teilnehmer in einem Nachrichtenwartezustand. <br>  <b>Warteschlange</b> - Eine Nachrichtenwarteschlange. <br>  <b>Exchange Point</b> (Exchange) - Der anfÃ¤ngliche Austauschpunkt der Warteschlange, die am Routing beteiligt ist. <br></div></div><br><h3>  Regel 1 </h3><br>  Jede Warteschlange sollte nur einen Jobtyp darstellen.  Mischen Sie nicht verschiedene Nachrichtentypen in derselben Warteschlange.  Und wenn diese Regel eingehalten wird, kÃ¶nnen wir die ihnen prÃ¤sentierte Aufgabenwarteschlange eindeutig benennen. <br><br><h3>  Regel 2 </h3><br>  Vermeiden Sie es, Nachrichten erneut an die Warteschlange zu senden.  Wenn Sie feststellen, dass Ihr Abonnent versucht, Nachrichten ohne echte Verarbeitung erneut an andere Warteschlangen zu senden, ist hÃ¶chstwahrscheinlich etwas nicht richtig gestaltet.  Das Routing liegt in der Verantwortung der Austauschpunkte und nicht der Warteschlangen. <br><br><h3>  Regel 3 </h3><br>  Lieferanten mÃ¼ssen nichts Ã¼ber Warteschlangen wissen.  Eine der Hauptideen von AMQP ist die Aufteilung der Verantwortlichkeiten zwischen Punkten und Warteschlangen, sodass sich die Lieferanten nicht darum kÃ¼mmern mÃ¼ssen, die Nachricht an den Abonnenten zu senden. <br><br><h3>  Beispiele und LÃ¶sungen </h3><br>  Angenommen, Sie mÃ¶chten Punkte und Warteschlangen fÃ¼r benutzerdefinierte Datensatzereignisse entwerfen.  Aufzeichnungsereignisse werden in einer oder mehreren Anwendungen ausgelÃ¶st, und diese Nachrichten werden von einigen anderen Anwendungen verwendet. <br><br><pre> <code class="plaintext hljs">| object | event | |------------------| | user | created | | user | updated | | user | deleted |</code> </pre><br>  Die erste Frage, die normalerweise gestellt wird, sind die verschiedenen Ereignisse eines Objekts (in diesem Beispiel das "Benutzer" -Objekt). Soll ich einen Austauschpunkt verwenden, um alle drei Ereignisse zu verÃ¶ffentlichen, oder 3 separate Punkte fÃ¼r jedes Ereignis verwenden?  Oder kurz gesagt, ein Austauschpunkt oder viele? <br><br>  Bevor ich diese Frage beantworte, mÃ¶chte ich noch eine Frage stellen: Brauchen wir wirklich einen separaten Punkt fÃ¼r diesen Fall?  Was ist, wenn wir alle drei Arten von Ereignissen als "Schreib" -Ereignis abstrahieren, dessen Untertypen "erstellt", "aktualisiert" und "gelÃ¶scht" sind? <br><br><pre> <code class="plaintext hljs">| object | event | sub-type | |-----------------------------| | user | write | created | | user | write | updated | | user | write | deleted |</code> </pre><br><h3>  LÃ¶sung 1 </h3><br>  Die einfachste LÃ¶sung besteht darin, die Warteschlange "user.write" zu erstellen und alle Nachrichten aus den Aufzeichnungsereignissen des Benutzers Ã¼ber den globalen Austauschpunkt in dieser Warteschlange zu verÃ¶ffentlichen. <br><br><h3>  Entscheidung 2 </h3><br>  Die einfachste LÃ¶sung kann nicht funktionieren, wenn es eine zweite Anwendung (mit einer anderen Verarbeitungslogik) gibt, die in der Warteschlange verÃ¶ffentlichte Nachrichten abonnieren mÃ¶chte.  Wenn mehrere Anwendungen signiert sind, benÃ¶tigen wir mindestens einen Punkt vom Typ â€Fanoutâ€œ mit Bindungen an mehrere Warteschlangen.  Somit werden Nachrichten an den Punkt gesendet und es werden die Nachrichten in jeder Warteschlange dupliziert.  Jede Warteschlange reprÃ¤sentiert einen Verarbeitungsjob fÃ¼r jede Anwendung. <br><br><pre> <code class="plaintext hljs">| queue | subscriber | |-------------------------------| | user.write.app1 | app1 | | user.write.app2 | app2 | | exchange | type | binding_queue | |---------------------------------------| | user.write | fanout | user.write.app1 | | user.write | fanout | user.write.app2 |</code> </pre><br>  Die zweite LÃ¶sung funktioniert einwandfrei, wenn wirklich jeder Abonnent alle Untertypen von "user.write" -Ereignissen verarbeiten mÃ¶chte.  Zum Beispiel, wenn die Anwendung des Abonnenten zum einfachen Speichern eines Transaktionsprotokolls ausgelegt ist. <br><br>  Andererseits ist es nicht sehr gut, wenn sich einige Abonnenten auÃŸerhalb Ihres Unternehmens befinden und Sie sie nur Ã¼ber bestimmte Ereignisse informieren mÃ¶chten. Beispielsweise sollte app2 eine Nachricht Ã¼ber die Benutzererstellung erhalten und nichts Ã¼ber Aktualisierungs- und LÃ¶schereignisse wissen. <br><br><h3>  Entscheidung 3 </h3><br>  Um das obige Problem zu lÃ¶sen, mÃ¼ssen wir das Ereignis "user.created" aus dem Typ "user.write" extrahieren.  Ein Austauschpunkt mit einem Thementyp kann uns helfen.  Beim VerÃ¶ffentlichen von Nachrichten verwenden wir user.created / user.updated / user.deleted an einem bestimmten Punkt als Routing-SchlÃ¼ssel, damit wir den KommunikationsschlÃ¼ssel "user. *" In die Warteschlange "user.write.app1" und den KommunikationsschlÃ¼ssel "user.created" stellen kÃ¶nnen. in der Warteschlange "user.created.app2". <br><br><pre> <code class="plaintext hljs">| queue | subscriber | |---------------------------------| | user.write.app1 | app1 | | user.created.app2 | app2 | | exchange | type | binding_queue | binding_key | |-------------------------------------------------------| | user.write | topic | user.write.app1 | user.* | | user.write | topic | user.created.app2 | user.created |</code> </pre><br><h3>  Entscheidung 4 </h3><br>  Der Themenartentyp des Austauschpunkts ist flexibler, falls mÃ¶glicherweise mehr Ereignistypen vorhanden sind.  Wenn Sie jedoch die genaue Anzahl der Ereignisse genau kennen, kÃ¶nnen Sie auch den Typ "direkt" verwenden, um die Leistung zu verbessern. <br><br><pre> <code class="plaintext hljs">| queue | subscriber | |---------------------------------| | user.write.app1 | app1 | | user.created.app2 | app2 | | exchange | type | binding_queue | binding_key | |--------------------------------------------------------| | user.write | direct | user.write.app1 | user.created | | user.write | direct | user.write.app1 | user.updated | | user.write | direct | user.write.app1 | user.deleted | | user.write | direct | user.created.app2 | user.created |</code> </pre><br>  Wir kehren zur Frage "Ein Punkt oder viel?" ZurÃ¼ck.  Solange alle LÃ¶sungen nur einen Punkt verwenden, funktioniert es gut, nichts schlechtes.  In welchen Situationen brauchen wir mehrere Punkte? <br><br><h3>  Entscheidung 5 </h3><br>  Schauen wir uns ein Beispiel an, in dem wir zusÃ¤tzlich zu den oben beschriebenen erstellten, aktualisierten und gelÃ¶schten Ereignissen eine weitere Gruppe von Ereignissen haben: Eingabe und Ausgabe - eine Gruppe von Ereignissen, die eher das â€Benutzerverhaltenâ€œ als die â€Datenaufzeichnungâ€œ beschreiben.  FÃ¼r verschiedene Ereignisgruppen sind mÃ¶glicherweise vÃ¶llig unterschiedliche Routing-Strategien und Vereinbarungen Ã¼ber die SchlÃ¼ssel und Namen von Warteschlangen erforderlich. Dazu sind separate Austauschpunkte erforderlich. <br><br><pre> <code class="plaintext hljs">| queue | subscriber | |----------------------------------| | user.write.app1 | app1 | | user.created.app2 | app2 | | user.behavior.app3 | app3 | | exchange | type | binding_queue | binding_key | |--------------------------------------------------------------| | user.write | topic | user.write.app1 | user.* | | user.write | topic | user.created.app2 | user.created | | user.behavior | topic | user.behavior.app3 | user.* |</code> </pre><br>  Kostenlose Ãœbersetzung des Artikels <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">RabbitMQ Exchange und Queue Design Trade-off</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de443722/">https://habr.com/ru/post/de443722/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de443710/index.html">Java Challengers # 4: Vergleichen von Objekten mit equals () und hashCode ()</a></li>
<li><a href="../de443714/index.html">ControlValueAccessor und contenteditable in Angular</a></li>
<li><a href="../de443716/index.html">"Ich habe ein Backup auf meinem Band." Ich-Geschichte</a></li>
<li><a href="../de443718/index.html">Fantasy-Spiel mit 300.000 Rennen</a></li>
<li><a href="../de443720/index.html">Details</a></li>
<li><a href="../de443724/index.html">AMD Radeon VII: High-End-Chip (Teil 1)</a></li>
<li><a href="../de443726/index.html">Setup-Funktionen von Palo Alto Networks: SSL VPN</a></li>
<li><a href="../de443728/index.html">Google Plus funktioniert nicht mehr. Na und?</a></li>
<li><a href="../de443730/index.html">Strg-Alt-Entf: Geplante Veralterung von Programmierern</a></li>
<li><a href="../de443734/index.html">Neuronale Netze haben eine erstaunlich einfache Bildklassifizierungsstrategie.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>