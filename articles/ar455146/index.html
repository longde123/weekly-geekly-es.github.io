<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฟ ๐ ๐จ๐ผโโ๏ธ ุงููุณุฎ ุงููุชูุงุซู ุฑููุน ุงููุณุชูู ูู Tarantool DBMS โ๏ธ ๐คน๐พ ๐จ๐ฟ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุฑุญุจูุง ุ ุฃูุง ุฃููู ุจุชุทููุฑ ุชุทุจููุงุช ูู Tarantool DBMS - ูุฐุง ูุธุงู ุฃุณุงุณู ุทูุฑุชู ูุฌููุนุฉ Mail.ru ูุงูุฐู ูุฌูุน ุจูู DBMS ุนุงูู ุงูุฃุฏุงุก ูุฎุงุฏู ุชุทุจููุงุช ุจูุบุฉ Lua. ูุชู ุช...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุงููุณุฎ ุงููุชูุงุซู ุฑููุน ุงููุณุชูู ูู Tarantool DBMS</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/455146/" style=";text-align:right;direction:rtl">  ูุฑุญุจูุง ุ ุฃูุง ุฃููู ุจุชุทููุฑ ุชุทุจููุงุช ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Tarantool</a> DBMS - ูุฐุง ูุธุงู ุฃุณุงุณู ุทูุฑุชู ูุฌููุนุฉ Mail.ru ูุงูุฐู ูุฌูุน ุจูู DBMS ุนุงูู ุงูุฃุฏุงุก ูุฎุงุฏู ุชุทุจููุงุช ุจูุบุฉ Lua.  ูุชู ุชุญููู ุงูุณุฑุนุฉ ุงูุนุงููุฉ ููุญููู ุงููุณุชูุฏุฉ ุฅูู Tarantool ุ ุนูู ูุฌู ุงูุฎุตูุต ุ ูู ุฎูุงู ุฏุนู ูุถุน DBMS ูู ุงูุฐุงูุฑุฉ ูุงููุฏุฑุฉ ุนูู ุชูููุฐ ููุทู ุชุทุจูู ุงูุฃุนูุงู ูู ูุณุงุญุฉ ุนููุงู ูุงุญุฏุฉ ูุน ุงูุจูุงูุงุช.  ูุฐุง ูุถูู ุงุณุชูุฑุงุฑ ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู ุงููุนุงููุงุช ACID (ูุชู ุงูุงุญุชูุงุธ ุจุณุฌู WAL ุนูู ุงููุฑุต).  ูุญุชูู Tarantool ุนูู ุฏุนู ุงููุณุฎ ุงููุชูุงุซู ูุงููุดุงุฑูุฉ ุงููุฏูุฌ.  ุจุฏุกูุง ูู ุงูุฅุตุฏุงุฑ 2.1 ุ ูุชู ุฏุนู ุงุณุชุนูุงูุงุช SQL.  Tarantool ููุชูุญ ุงููุตุฏุฑ ููุฑุฎุต ุจููุฌุจ BSD ุงููุจุณุทุฉ.  ููุงู ุฃูุถูุง ุฅุตุฏุงุฑ Enterprise ุชุฌุงุฑู. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4aa/22f/d04/4aa22fd046775dd3b44af444ddcde28d.jpg"><br>  <i>ุงุดุนุฑ ุจุงูููุฉ!</i>  <i>(... ููุนุฑู ุฃูุถุง ุจุงุณู ุงูุฃุฏุงุก)</i> <br><br>  ูู ูุง ุณุจู ูุฌุนู Tarantool ููุตุฉ ุฌุฐุงุจุฉ ูุฅูุดุงุก ุชุทุจููุงุช ููุงุนุฏ ุงูุจูุงูุงุช ุงููุญููุฉ ููุบุงูุฉ.  ูู ูุซู ูุฐู ุงูุชุทุจููุงุช ุ ูุตุจุญ ุชูุฑุงุฑ ุงูุจูุงูุงุช ุถุฑูุฑููุง ูู ูุซูุฑ ูู ุงูุฃุญูุงู. <br><a name="habracut"></a><br>  ููุง ุฐูุฑ ุฃุนูุงู ุ ูุญุชูู Tarantool ุนูู ุงููุณุฎ ุงููุชูุงุซู ููุจูุงูุงุช ุงููุถููู.  ูุจุฏุฃ ุนูููุง ูู ุงูุชูููุฐ ุงููุชุณูุณู ุนูู ุงููุณุฎ ุงููุชูุงุซูุฉ ููุงูุฉ ุงููุนุงููุงุช ุงูููุฌูุฏุฉ ูู ุณุฌู ุงููุนุงูุฌ (WAL).  ุนุงุฏุฉู ูุง ูุชู ุงุณุชุฎุฏุงู ูุซู ูุฐุง ุงููุณุฎ ุงููุชูุงุซู (ูุณูููุง <i>ุงููุณุชูู ุงูููุฎูุถ</i> ุฃุฏูุงู) ูุชูููุฑ ุงูุชุณุงูุญ ูุน ุงูุฎุทุฃ ููุชุทุจูู ู / ุฃู ูุชูุฒูุน ุนุจุก ุงููุฑุงุกุฉ ุจูู ุนูุฏ ุงููุชูุฉ. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d1c/31b/83b/d1c31b83b1c71220a514deebb7d49952.png"><br>  <i>ุงูุชูู.</i>  <i>1. ุงููุณุฎ ุงููุชูุงุซู ุฏุงุฎู ุงููุชูุฉ</i> <br><br>  ูุซุงู ุนูู ุณููุงุฑูู ุจุฏูู ูู ููู ุงูุจูุงูุงุช ุงูุชู ุชู ุฅูุดุงุคูุง ูู ูุงุนุฏุฉ ุจูุงูุงุช ูุงุญุฏุฉ ุฅูู ูุงุนุฏุฉ ุจูุงูุงุช ุฃุฎุฑู ูููุนุงูุฌุฉ / ุงูุฑุตุฏ.  ูู ุงูุญุงูุฉ ุงูุฃุฎูุฑุฉ ุ ูุฏ ูููู ุงูุญู ุงูุฃูุซุฑ ููุงุกูุฉ ูู ุงุณุชุฎุฏุงู ุงููุณุฎ ุงููุชูุงุซู <i>ุนุงูู ุงููุณุชูู</i> - ุงููุณุฎ ุงููุชูุงุซู ููุจูุงูุงุช ุนูู ูุณุชูู ููุทู ุงูุนูู ููุชุทุจูู.  ุฃู  ูุง ูุณุชุฎุฏู ุญูุงู ุฌุงูุฒูุง ูุฏูุฌูุง ูู ูุธุงู ุฅุฏุงุฑุฉ ููุงุนุฏ ุงูุจูุงูุงุช ุ ููููุง ูููุฐ ุนูููุฉ ุงููุณุฎ ุงููุชูุงุซู ุฏุงุฎู ุงูุชุทุจูู ุงูุฐู ูููู ุจุชุทููุฑู.  ูุฐุง ุงูููุฌ ูู ูุฒุงูุง ูุนููุจ.  ูุญู ูุงุฆูุฉ ุงูุงูุฌุงุจูุงุช. <br><br>  1. ุญูุธ ุญุฑูุฉ ุงููุฑูุฑ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุง ููููู ููู ุฌููุน ุงูุจูุงูุงุช ุ ูููู ููุท ุฌุฒุก ูููุง (ุนูู ุณุจูู ุงููุซุงู ุ ููููู ููุท ููู ุจุนุถ ุงูุฌุฏุงูู ุ ูุจุนุถ ุงูุฃุนูุฏุฉ ุฃู ุงูุณุฌูุงุช ุงูุชู ุชูู ุจูุนุงููุฑ ูุนููุฉ) ุ <br></li><li style=";text-align:right;direction:rtl">  ุนูู ุนูุณ ุงููุณุฎ ุงููุชูุงุซู ุงูููุฎูุถ ุงููุณุชูู ุ ูุงูุฐู ูุชู ุชูููุฐู ุจุดูู ูุณุชูุฑ ูู ุบูุฑ ูุชุฒุงูู (ูุชู ุชูููุฐู ูู ุงูุฅุตุฏุงุฑ ุงูุญุงูู ูู Tarantool - 1.10) ุฃู ูุชุฒุงูู (ูุชู ุชูููุฐู ูู ุงูุฅุตุฏุงุฑุงุช ุงููุณุชูุจููุฉ ูู Tarantool) ุ ูููู ุฅุฌุฑุงุก ุงููุณุฎ ุงููุชูุงุซู ุนุงูู ุงููุณุชูู ุจูุงุณุทุฉ ุงูุฌูุณุงุช (ุนูู ุณุจูู ุงููุซุงู ุ ูููู ุงูุชุทุจูู ุฃููุงู ุจูุฒุงููุฉ ุงูุจูุงูุงุช - ุฌูุณุฉ ุงูุชุจุงุฏู ุงูุจูุงูุงุช ุ ุซู ููุงู ุชููู ูุคูุช ูู ุงููุณุฎ ุงููุชูุงุซู ุ ูุจุนุฏูุง ุชุญุฏุซ ุฌูุณุฉ ุงูุชุจุงุฏู ุงูุชุงููุฉ ุ ููุง ุฅูู ุฐูู) ุ <br></li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ุชู ุชุบููุฑ ุงูุณุฌู ุนุฏุฉ ูุฑุงุช ุ ูููููู ููู ุงูุฅุตุฏุงุฑ ุงูุฃุฎูุฑ ููุท (ุนูู ุนูุณ ุงููุณุฎ ุงููุชูุงุซู ุงูููุฎูุถ ุงููุณุชูู ุ ุญูุซ ุณูุชู ุชุดุบูู ุฌููุน ุงูุชุบููุฑุงุช ุงูุชู ุชู ุฅุฌุฑุงุคูุง ุนูู ุงููุนุงูุฌ ุจุงูุชุณูุณู ุนูู ุงููุณุฎ ุงููุชูุงุซูุฉ). <br></li></ul><br>  2. ูุง ุชูุฌุฏ ุตุนูุจุงุช ูู ุชูููุฐ ุงูุชุจุงุฏู ุนุจุฑ HTTP ุ ูุงูุฐู ูุณูุญ ูู ุจูุฒุงููุฉ ููุงุนุฏ ุงูุจูุงูุงุช ุนู ุจุนุฏ. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/551/551/7aa/5515517aaa739f6260023c5e8ff30bf0.png"><br>  <i>ุงูุชูู.</i>  <i>2. ุชูุฑุงุฑ HTTP</i> <br><br>  3. ูุง ูุชุนูู ุฃู ุชููู ููุงูู ููุงุนุฏ ุงูุจูุงูุงุช ุงูุชู ูุชู ููู ุงูุจูุงูุงุช ุจูููุง ูู ููุณูุง (ุนูุงูุฉ ุนูู ุฐูู ุ ูู ุงูุญุงูุฉ ุงูุนุงูุฉ ุ ูููู ุญุชู ุงุณุชุฎุฏุงู ููุงุนุฏ ุจูุงูุงุช ููุงุนุฏ ุงูุจูุงูุงุช ููุบุงุช ุงูุจุฑูุฌุฉ ูุงูุฃูุธูุฉ ุงูุฃุณุงุณูุฉ ููุง ุฅูู ุฐูู). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/830/85a/64b/83085a64b69ff5dba2431db97213fa82.png"><br>  <i>ุงูุชูู.</i>  <i>3. ุงูุชูุฑุงุฑ ูู ุงููุธู ุบูุฑ ุงููุชุฌุงูุณุฉ</i> <br><br>  ุงูุฌุงูุจ ุงูุณูุจู ูู ุฃู ุงูุจุฑูุฌุฉ ูู ุงููุชูุณุท โโุฃูุซุฑ ุชุนููุฏูุง / ุฃูุซุฑ ุชูููุฉ ูู ุงูุชูููู ุ ูุจุฏูุงู ูู ุฅุนุฏุงุฏ ุงููุธููุฉ ุงููุถููุฉ ุ ุณูุชุนูู ุนููู ุชูููุฐ ุนููู. <br><br>  ุฅุฐุง ูุนุจุช ุงููุฒุงูุง ุงููุฐููุฑุฉ ุฃุนูุงู ูู ููููู ุฏูุฑูุง ุญุงุณููุง (ุฃู ุดุฑุทูุง ุถุฑูุฑููุง) ุ ููู ุงูููุทูู ุงุณุชุฎุฏุงู ุงููุณุฎ ุงููุชูุงุซู ุนุงูู ุงููุณุชูู.  ุฏุนูุง ูููุฑ ูู ุนุฏุฉ ุทุฑู ูุชุทุจูู ุงููุณุฎ ุงููุชูุงุซู ููุจูุงูุงุช ุนูู ูุณุชูู ุนุงูู ูู Tarantool DBMS. <br><br><h2 style=";text-align:right;direction:rtl">  ุชูููู ุญุฑูุฉ ุงููุฑูุฑ </h2><br>  ูุฐูู ุ ูุงุญุฏุฉ ูู ููุงุฆุฏ ุงููุณุฎ ุงููุชูุงุซู ุฑููุน ุงููุณุชูู ูู ุชูููุฑ ุญุฑูุฉ ุงููุฑูุฑ.  ููู ุชุธูุฑ ูุฐู ุงูููุฒุฉ ุจุงููุงูู ุ ูู ุงูุถุฑูุฑู ุชูููู ููุฏุงุฑ ุงูุจูุงูุงุช ุงููุฑุณูุฉ ุฎูุงู ูู ุฌูุณุฉ ุชุจุงุฏู.  ุจุงูุทุจุน ุ ูุง ููุจุบู ูุฃุญุฏ ุฃู ููุณู ุฃูู ูู ููุงูุฉ ุงูุฌูุณุฉ ูุฌุจ ูุฒุงููุฉ ูุณุชูุจูู ุงูุจูุงูุงุช ูุน ุงููุตุฏุฑ (ุนูู ุงูุฃูู ุจุงููุณุจุฉ ูุฌุฒุก ุงูุจูุงูุงุช ุงููุชุถููุฉ ูู ุงููุณุฎ ุงููุชูุงุซู). <br><br>  ููููุฉ ุชูููู ูููุฉ ุงูุจูุงูุงุช ุงููููููุฉ ุฃุซูุงุก ุงููุณุฎ ุงููุชูุงุซู ุฑููุน ุงููุณุชููุ  ูุฏ ูููู ุงูุญู "ูู ุงูุฌุจูุฉ" ูู ุงุฎุชูุงุฑ ุงูุจูุงูุงุช ุญุณุจ ููุช ุงูุชุงุฑูุฎ.  ููููุงู ุจุฐูู ุ ููููู ุงุณุชุฎุฏุงู ุญูู ููุช ุงูุชุงุฑูุฎ ุงูููุฌูุฏ ุจุงููุนู ูู ุงูุฌุฏูู (ุฅู ูุฌุฏ).  ุนูู ุณุจูู ุงููุซุงู ุ ูุฏ ูุญุชูู ุงููุณุชูุฏ "ุชุฑุชูุจ" ุนูู ุญูู "ุงูููุช ุงููุทููุจ ูุชูููุฐ ุงูุฃูุฑ" - <code>delivery_time</code> .  ุงููุดููุฉ ูู ูุฐุง ุงูุญู ูู ุฃู ุงูููู ูู ูุฐุง ุงูุญูู ูุง ูุฌุจ ุฃู ุชููู ุจุงูุชุณูุณู ุงููุทุงุจู ูุฅูุดุงุก ุงูุทูุจุงุช.  ูุจุงูุชุงูู ุ ูุง ูููููุง ุชุฐูุฑ ุงูุญุฏ ุงูุฃูุตู ููููุฉ ุญูู <code>delivery_time</code> ุงููุฑุณูุฉ ุฃุซูุงุก ุฌูุณุฉ ุงูุชุจุงุฏู ุงูุณุงุจูุฉ ุ ููู ุฌูุณุฉ ุงูุชุจุงุฏู ุงูุชุงููุฉ ุ ุญุฏุฏ ุฌููุน ุงูุณุฌูุงุช ุฐุงุช ุงููููุฉ ุงูุฃุนูู ูุญูู <code>delivery_time</code> .  ูู ุงููุชุฑุฉ ุงููุงุตูุฉ ุจูู ุฌูุณุงุช ุงูุชุจุงุฏู ุ ูููู ุฅุถุงูุฉ ุงูุณุฌูุงุช ุฐุงุช ุงููููุฉ ุงูุฃุตุบุฑ ูุญูู <code>delivery_time</code> .  ุฃูุถูุง ุ ูุฏ ูุฎุถุน ุงูุฃูุฑ ููุชุบููุฑุงุช ุ ูุงูุชู ูู ุชุคุซุฑ ุนูู ุญูู <code>delivery_time</code> .  ูู ููุชุง ุงูุญุงูุชูู ุ ูู ูุชู ููู ุงูุชุบููุฑุงุช ูู ุงููุตุฏุฑ ุฅูู ุงููุชููู.  ูุญู ูุฐู ุงููุดููุงุช ุ ุณูุญุชุงุฌ ุฅูู ููู ุงูุจูุงูุงุช "ุชุฏุงุฎู".  ุฃู  ุฃุซูุงุก ูู ุฌูุณุฉ ุชุจุงุฏู ุ ุณูููู ุจููู ุฌููุน ุงูุจูุงูุงุช ุจูููุฉ ุญูู ุงูุชุณููู_ุชุฌุงูุฒ ููุทุฉ ูู ุงููุงุถู (ุนูู ุณุจูู ุงููุซุงู ุ N ุณุงุนุฉ ูู ุงููุญุธุฉ ุงูุญุงููุฉ).  ููุน ุฐูู ุ ููู ุงููุงุถุญ ุฃูู ุจุงููุณุจุฉ ููุฃูุธูุฉ ุงููุจูุฑุฉ ุ ูุฐุง ุงูููุฌ ูุง ูุฒูู ูู ููุบุงูุฉ ููููู ุฃู ูููู ูู ูููุฑุงุช ุญุฑูุฉ ุงููุฑูุฑ ุงูุชู ููุฏู ุฅูููุง.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุฏ ูุง ูุญุชูู ุงูุฌุฏูู ุงููุฑุณู ุนูู ุญูู ููุช ููุชุงุฑูุฎ. <br><br>  ุญู ุขุฎุฑ ุ ุฃูุซุฑ ุชุนููุฏูุง ูู ุญูุซ ุงูุชูููุฐ ุ ูู ุงูุงุนุชุฑุงู ุจุงุณุชูุงู ุงูุจูุงูุงุช.  ูู ูุฐู ุงูุญุงูุฉ ุ ูู ูู ุฌูุณุฉ ุชุจุงุฏู ุ ูุชู ุฅุฑุณุงู ุฌููุน ุงูุจูุงูุงุช ุ ูุงูุชู ูู ูุชู ุชุฃููุฏ ุงุณุชูุงููุง ูู ูุจู ุงููุณุชูู.  ููุชูููุฐ ุ ุชุญุชุงุฌ ุฅูู ุฅุถุงูุฉ ุนููุฏ ููุทูู ุฅูู ุงูุฌุฏูู ุงููุตุฏุฑ (ุนูู ุณุจูู ุงููุซุงู ุ <code>is_transferred</code> ).  ุฅุฐุง ุฃูุฏ ุงููุณุชูู ุงุณุชูุงู ุงูุณุฌู ุ ูุณูุชู ุชุนููู ุงูุญูู ุงูููุงุจู ุนูู <code>true</code> ุ ูุจุนุฏ ุฐูู ูู ูุนุฏ ุงูุณุฌู ูุดุชุฑููุง ูู ุนูููุงุช ุงูุชุจุงุฏู.  ูุญุชูู ุฎูุงุฑ ุงูุชูููุฐ ูุฐุง ุนูู ุงูุนููุจ ุงูุชุงููุฉ.  ุฃููุงู ุ ููู ุณุฌู ูุชู ูููู ุ ูู ุงูุถุฑูุฑู ุฅูุดุงุก ุชุฃููุฏ ูุฅุฑุณุงูู.  ุจูุนูู ุชูุฑูุจู ุ ูููู ุฃู ูููู ูุฐุง ูุดุงุจููุง ููุถุงุนูุฉ ูููุฉ ุงูุจูุงูุงุช ุงููููููุฉ ููุง ูุคุฏู ุฅูู ูุถุงุนูุฉ ุนุฏุฏ ุงูุฑุญูุงุช ุฐูุงุจูุง ูุฅูุงุจูุง.  ุซุงููุงู ุ ูุง ุชูุฌุฏ ุฅููุงููุฉ ูุฅุฑุณุงู ุงูุณุฌู ููุณู ุฅูู ุนุฏุฉ ุฃุฌูุฒุฉ ุงุณุชูุจุงู (ุณูุคูุฏ ุงููุณุชูุจู ุงูุฃูู ุงูุฅูุตุงู ูุฃููุณูู ููุตุงูุญ ุงูุฌููุน). <br><br>  ุชุชูุซู ุงูุทุฑููุฉ ุ ุงูุฎุงููุฉ ูู ุงูุนููุจ ุงููุฐููุฑุฉ ุฃุนูุงู ุ ูู ุฅุถุงูุฉ ุฃุนูุฏุฉ ุฅูู ุงูุฌุฏูู ุงููุทููุจ ุฅุฑุณุงููุง ูุชุชุจุน ุงูุชุบููุฑุงุช ูู ุตููููุง.  ูููู ุฃู ูููู ูุฐุง ุงูุนููุฏ ูู ููุน ุงูุชุงุฑูุฎ ูุงูููุช ููุฌุจ ุชุนูููู / ุชุญุฏูุซู ูู ูุจู ุงูุชุทุจูู ููููุช ุงูุญุงูู ูู ูู ูุฑุฉ ุชููู ุจุฅุถุงูุฉ / ุชุบููุฑ ุงูุณุฌูุงุช (ุชููุงุฆููุง ูุน ุฅุถุงูุฉ / ุชุบููุฑ).  ููุซุงู ุ ุฏุนูุง ูุณูู ุงูุนููุฏ <code>update_time</code> .  ุจุนุฏ ุญูุธ ุงูุญุฏ ุงูุฃูุตู ููููุฉ ุญูู ูุฐุง ุงูุนููุฏ ููุณุฌูุงุช ุงููููููุฉ ุ ูููููุง ุจุฏุก ุฌูุณุฉ ุงูุชุจุงุฏู ุงูุชุงููุฉ ูู ูุฐู ุงููููุฉ (ุญุฏุฏ ุงูุณุฌูุงุช ุงูุชู ุชุฒูุฏ ูููุฉ ุญูู <code>update_time</code> ุนู ุงููููุฉ ุงููุญููุธุฉ ูุณุจููุง).  ุงููุดููุฉ ูู ุงูุฃุณููุจ ุงูุฃุฎูุฑ ูู ุฃู ุชุบููุฑุงุช ุงูุจูุงูุงุช ูููู ุฃู ุชุญุฏุซ ูู ูุถุน ุงูุฏููุนุงุช.  ูุชูุฌุฉู ูุฐูู ุ <code>update_time</code> ูุง ุชููู ููู ุงูุญูู ูู ุนููุฏ <code>update_time</code> ูุฑูุฏุฉ.  ูุจุงูุชุงูู ุ ูุง ูููู ุงุณุชุฎุฏุงู ูุฐุง ุงูุนููุฏ ูู ุฅุฎุฑุงุฌ ุจูุงูุงุช ุงูุฏููุนุงุช (ุงูุตูุญุฉ).  ุจุงููุณุจุฉ ูุฅุฎุฑุงุฌ ุจูุงูุงุช ุงูุตูุญุฉ ุจุตูุญุฉ ุ ุณูููู ูู ุงูุถุฑูุฑู ุงุฎุชุฑุงุน ุขููุงุช ุฅุถุงููุฉ ูู ุงููุญุชูู ุฃู ุชููู ุฐุงุช ููุงุกุฉ ููุฎูุถุฉ ููุบุงูุฉ (ุนูู ุณุจูู ุงููุซุงู ุ ุงุณุชุฑุฌุงุน ุฌููุน ุงูุณุฌูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู ุฎูุงู <code>update_time</code> ุฃุนูู ูู ุงููููุฉ ุงููุญุฏุฏุฉ ูุฅุตุฏุงุฑ ุนุฏุฏ ูุนูู ูู ุงูุณุฌูุงุช ุ ุจุฏุกูุง ูู ุฅุฒุงุญุฉ ูุนููุฉ ูู ุจุฏุงูุฉ ุงูุนููุฉ). <br><br>  ููููู ุฒูุงุฏุฉ ููุงุกุฉ ููู ุงูุจูุงูุงุช ุนู ุทุฑูู ุชุญุณูู ุงูููุฌ ุงูุณุงุจู ุจุดูู ุทููู.  ููููุงู ุจุฐูู ุ ุณูู ูุณุชุฎุฏู ููุนูุง ุตุญูุญูุง (ุนุฏุฏูุง ุตุญูุญูุง ุทููููุง) ูููู ูุญููู ุงูุนููุฏ ูุชุชุจุน ุงูุชุบููุฑุงุช.  <code>row_ver</code> ุงูุนููุฏ <code>row_ver</code> .  ูุง ูุฒุงู ูุฌุจ ุชุนููู / ุชุญุฏูุซ ูููุฉ ุงูุญูู ููุฐุง ุงูุนููุฏ ูู ูู ูุฑุฉ ูุชู ูููุง ุฅูุดุงุก / ุชุนุฏูู ุณุฌู.  ูููู ูู ูุฐู ุงูุญุงูุฉ ุ ุณูุชู ุชุฎุตูุต ุงูุญูู ููุณ ููููุช ุงูุญุงูู ููุชุงุฑูุฎ ุ ูููู ูููุฉ ุจุนุถ ุงูุนุฏุงุฏุงุช ุชุฒุฏุงุฏ ุจูุงุญุฏ.  ูุชูุฌุฉู ูุฐูู ุ <code>row_ver</code> ุนููุฏ <code>row_ver</code> ุนูู ููู ูุฑูุฏุฉ ููููู ุงุณุชุฎุฏุงูู ููุณ ููุท ูุฅุฎุฑุงุฌ ุจูุงูุงุช "ุฏูุชุง" (ุงูุจูุงูุงุช ุงููุถุงูุฉ / ุงูุชู ุชู ุชุบููุฑูุง ุจุนุฏ ููุงูุฉ ุฌูุณุฉ ุงูุชุจุงุฏู ุงูุณุงุจูุฉ) ุ ูููู ุฃูุถูุง ุจุงููุณุจุฉ ูุตูุญุงุช ุชุฑููู ุงูุตูุญุงุช ุงูุจุณูุทุฉ ูุงููุนุงูุฉ. <br><br>  ูุจุฏู ุฃู ุงูุทุฑููุฉ ุงูุฃุฎูุฑุฉ ุงูููุชุฑุญุฉ ูุชูููู ูููุฉ ุงูุจูุงูุงุช ุงููููููุฉ ูุฌุฒุก ูู ุงููุณุฎ ุงููุชูุงุซู ุงูุฑููุน ุงููุณุชูู ูู ุงูุฃูุซุฑ ูุซุงููุฉ ูุนุงูููุฉ.  ุฏุนููุง ูุชูุงูููุง ุจูุฒูุฏ ูู ุงูุชูุงุตูู. <br><br><h2 style=";text-align:right;direction:rtl">  ููู ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู ุตู ุงูุฅุตุฏุงุฑ ุงูุนุฏุงุฏ </h2><br><h4 style=";text-align:right;direction:rtl">  ุงูุฎุงุฏู / ุงูุชูููุฐ ุงูุฑุฆูุณู </h4><br>  ูู MS SQL Server ุ ูุชุทุจูู ูุฐุง ุงูููุฌ ุ ููุงู ููุน ุนููุฏ ุฎุงุต - <code>rowversion</code> .  ุชุญุชูู ูู ูุงุนุฏุฉ ุจูุงูุงุช ุนูู ุนุฏุงุฏ ุ ูุงูุฐู ูุฒูุฏ ุจููุฏุงุฑ ูุงุญุฏ ูู ูู ูุฑุฉ ุชููู ูููุง ุจุฅุถุงูุฉ / ุชุบููุฑ ุณุฌู ูู ุฌุฏูู ูุญุชูู ุนูู ุนููุฏ ูู ุงูููุน <code>rowversion</code> .  ูุชู ุชุนููู ูููุฉ ูุฐุง ุงูุนุฏุงุฏ ุชููุงุฆููุง ุฅูู ุญูู ูุฐุง ุงูุนููุฏ ูู ุงูุณุฌู ุงูููุถุงู / ุงูููุบููุฑ.  ูุง ูุญุชูู Tarantool DBMS ุนูู ุขููุฉ ูุถููุฉ ูุดุงุจูุฉ.  ููุน ุฐูู ุ ูู Tarantool ุ ููุณ ูู ุงูุตุนุจ ุชูููุฐู ูุฏูููุง.  ุงููุธุฑ ูู ููููุฉ ุงูููุงู ุจุฐูู. <br><br>  ุฃููุงู ุ ูุตุทูุญุงุช ุตุบูุฑุฉ: ุชุณูู ุงูุฌุฏุงูู ูู Tarantool ุงููุณุงุญุฉ ุ ูุชุณูู ุงูุณุฌูุงุช tuple.  ูู Tarantool ุ ููููู ุฅูุดุงุก ุชุณูุณูุงุช.  ุงูุชุณูุณูุงุช ููุณุช ุฃูุซุฑ ูู ุงููููุฏุงุช ุงููุณูุงุฉ ููููู ุงูุตุญูุญุฉ ููุฃุนุฏุงุฏ ุงูุตุญูุญุฉ.  ุฃู  ูุฐุง ูู ุจุงูุถุจุท ูุง ูุญุชุงุฌู ูุฃุบุฑุงุถูุง.  ุฃุฏูุงู ุณูููู ุจุฅูุดุงุก ูุซู ูุฐุง ุงูุชุณูุณู. <br><br>  ูุจู ุชูููุฐ ุฃู ุนูููุฉ ูุงุนุฏุฉ ุจูุงูุงุช ูู Tarantool ุ ูุฌุจ ุชุดุบูู ุงูุฃูุฑ ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs">box.cfg{}</code> </pre> <br>  ูุชูุฌุฉ ูุฐูู ุ ุณูุจุฏุฃ Tarantool ูู ูุชุงุจุฉ ุงูููุทุงุช ูุณุฌู ุงููุนุงููุงุช ุฅูู ุงูุฏููู ุงูุญุงูู. <br><br>  ุฅูุดุงุก ุชุณูุณู <code>row_version</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs">box.schema.sequence.<span class="hljs-built_in"><span class="hljs-built_in">create</span></span>(<span class="hljs-string"><span class="hljs-string">'row_version'</span></span>, { if_not_exists = <span class="hljs-literal"><span class="hljs-literal">true</span></span> })</code> </pre> <br>  ูุชูุญ <code>if_not_exists</code> ุงูุฎูุงุฑ <code>if_not_exists</code> ุชุดุบูู ุงูุจุฑูุงูุฌ ุงููุตู <code>if_not_exists</code> ุนุฏุฉ ูุฑุงุช: ุฅุฐุง ูุงู ุงููุงุฆู ููุฌูุฏูุง ุ ููู ูุญุงูู Tarantool ุฅุนุงุฏุฉ ุฅูุดุงุฆู.  ุณูุชู ุงุณุชุฎุฏุงู ูุฐุง ุงูุฎูุงุฑ ูู ุฌููุน ุฃูุงูุฑ DDL ุงููุงุญูุฉ. <br><br>  ูููู ุจุฅูุดุงุก ูุณุงุญุฉ ููุซุงู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs">box.schema.space.<span class="hljs-built_in"><span class="hljs-built_in">create</span></span>(<span class="hljs-string"><span class="hljs-string">'goods'</span></span>, { <span class="hljs-built_in"><span class="hljs-built_in">format</span></span> = { { name = <span class="hljs-string"><span class="hljs-string">'id'</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> = <span class="hljs-string"><span class="hljs-string">'unsigned'</span></span> }, { name = <span class="hljs-string"><span class="hljs-string">'name'</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> = <span class="hljs-string"><span class="hljs-string">'string'</span></span> }, { name = <span class="hljs-string"><span class="hljs-string">'code'</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> = <span class="hljs-string"><span class="hljs-string">'unsigned'</span></span> }, { name = <span class="hljs-string"><span class="hljs-string">'row_ver'</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> = <span class="hljs-string"><span class="hljs-string">'unsigned'</span></span> } }, if_not_exists = <span class="hljs-literal"><span class="hljs-literal">true</span></span> })</code> </pre> <br>  ููุง ูููู ุจุชุนููู ุงุณู ุงููุณุงูุฉ ( <code>goods</code> ) ุ ุฃุณูุงุก ุงูุญููู ูุฃููุงุนูุง. <br><br>  ูุชู ุฅูุดุงุก ุญููู ุฒูุงุฏุฉ ุชููุงุฆูุฉ Tarantool ุฃูุถูุง ุจุงุณุชุฎุฏุงู ุชุณูุณูุงุช.  ูู ุจุฅูุดุงุก ููุชุงุญ ุฃุณุงุณู ุชููุงุฆู ุงูุฒูุงุฏุฉ ูู ุญูู <code>id</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs">box.schema.sequence.<span class="hljs-built_in"><span class="hljs-built_in">create</span></span>(<span class="hljs-string"><span class="hljs-string">'goods_id'</span></span>, { if_not_exists = <span class="hljs-literal"><span class="hljs-literal">true</span></span> }) box.space.goods:create_index(<span class="hljs-string"><span class="hljs-string">'primary'</span></span>, { parts = { <span class="hljs-string"><span class="hljs-string">'id'</span></span> }, sequence = <span class="hljs-string"><span class="hljs-string">'goods_id'</span></span>, unique = <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> = <span class="hljs-string"><span class="hljs-string">'HASH'</span></span>, if_not_exists = <span class="hljs-literal"><span class="hljs-literal">true</span></span> })</code> </pre> <br>  ูุฏุนู Tarantool ุนุฏุฉ ุฃููุงุน ูู ุงูููุงุฑุณ.  ูู ูุนุธู ุงูุฃุญูุงู ุ ูุชู ุงุณุชุฎุฏุงู ููุงุฑุณ ูู ุฃููุงุน TREE ู HASH ุ ูุงูุชู ุชุณุชูุฏ ุฅูู ุงูููุงูู ุงูููุงุจูุฉ ููุงุณู.  TREE ูู ููุน ุงูููุฑุณ ุงูุฃูุซุฑ ุชููุนูุง.  ุงููุง ุชุณูุญ ูู ูุงุณุชุนุงุฏุฉ ุงูุจูุงูุงุช ุจุทุฑููุฉ ูุฑุชุจุฉ.  ูููู ูุงุฎุชูุงุฑ ุงููุณุงูุงุฉ ุ HASH ูู ุฃูุซุฑ ููุงุกูุฉ.  ููููุง ูุฐูู ุ ูู ุงููุณุชุญุณู ุงุณุชุฎุฏุงู HASH ููููุชุงุญ ุงูุฃุณุงุณู (ููู ูุง ูุนููุงู). <br><br>  ูุงุณุชุฎุฏุงู ุนููุฏ <code>row_ver</code> ูููู ุงูุจูุงูุงุช ุงูุชู ุชู ุชุบููุฑูุง ุ ูุฌุจ ุนููู ุฑุจุท ููู ุชุณูุณู <code>row_ver</code> ุจุงูุญููู ูู ูุฐุง ุงูุนููุฏ.  ูููู ุนูู ุนูุณ ุงูููุชุงุญ ุงูุฃุณุงุณู ุ ูุฌุจ ุฒูุงุฏุฉ ูููุฉ ุงูุญูู ูู ุนููุฏ <code>row_ver</code> ุจูุงุญุฏ ุ ููุณ ููุท ุนูุฏ ุฅุถุงูุฉ ุณุฌูุงุช ุฌุฏูุฏุฉ ุ ูููู ุฃูุถูุง ุนูุฏ ุชุบููุฑ ุงูุณุฌูุงุช ุงูุญุงููุฉ.  ููููุงู ุจุฐูู ุ ููููู ุงุณุชุฎุฏุงู ุงููุดุบูุงุช.  ูุญุชูู Tarantool ุนูู ููุนูู ูู ุงููุดุบููุงุช ูููุณุงูุงุช: <code>before_replace</code> ู <code>on_replace</code> .  ูุชู ุชุดุบูู ุงููุดุบููุงุช ูู ูู ูุฑุฉ ูุชู ูููุง ุชุบููุฑ ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ ูู ุงููุณุงุญุฉ (ููู ูุธููุฉ ุชุชุฃุซุฑ ุจุงูุชุบููุฑุงุช ุ ูุชู ุชุดุบูู ูุธููุฉ ุงููุดุบู).  ุนูู ุนูุณ <code>on_replace</code> ุ ุชุชูุญ ูู ุงููุดุบูุงุช <code>before_replace</code> ุชุนุฏูู ุจูุงูุงุช ุงููุฌููุนุฉ ุงูุชู ุชู ุชูููุฐ ุงููุดุบู ูู ุฃุฌููุง.  ูููุง ูุฐูู ุ ูุฅู ุงูููุน ุงูุฃุฎูุฑ ูู ุงููุดุบูุงุช ููุงุณุจูุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs">box.space.goods:before_replace(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(old, new)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> box.tuple.new({new[<span class="hljs-number"><span class="hljs-number">1</span></span>], new[<span class="hljs-number"><span class="hljs-number">2</span></span>], new[<span class="hljs-number"><span class="hljs-number">3</span></span>], box.sequence.row_version:<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>()}) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>)</code> </pre> <br>  ูุณุชุจุฏู ูุฐุง ุงููุดุบู ูููุฉ ุงูุญูู <code>row_ver</code> ูู tuple ุงููุฎุฒูุฉ <code>row_version</code> ุชุณูุณู <code>row_version</code> ุงูุชุงูู. <br><br>  ูุชุชููู ูู ุงุณุชุฎุฑุงุฌ ุงูุจูุงูุงุช ูู ูุณุงุญุฉ <code>goods</code> ูู ุนููุฏ <code>row_ver</code> ุ ูู ุจุฅูุดุงุก ููุฑุณ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs">box.space.goods:create_index(<span class="hljs-string"><span class="hljs-string">'row_ver'</span></span>, { parts = { <span class="hljs-string"><span class="hljs-string">'row_ver'</span></span> }, unique = <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> = <span class="hljs-string"><span class="hljs-string">'TREE'</span></span>, if_not_exists = <span class="hljs-literal"><span class="hljs-literal">true</span></span> })</code> </pre> <br>  ููุน ุงูููุฑุณ ูู ุดุฌุฑุฉ ( <code>TREE</code> ) ุ ูุฃู  ูุญุชุงุฌ ุฅูู ุงุณุชุฑุฏุงุฏ ุงูุจูุงูุงุช ุจุชุฑุชูุจ ุชุตุงุนุฏู ููููู ูู ุงูุนููุฏ <code>row_ver</code> . <br><br>  ุฃุถู ุจุนุถ ุงูุจูุงูุงุช ุฅูู ุงููุถุงุก: <br><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs">box.space.goods:<span class="hljs-built_in"><span class="hljs-built_in">insert</span></span>{<span class="hljs-literal"><span class="hljs-literal">nil</span></span>, <span class="hljs-string"><span class="hljs-string">'pen'</span></span>, <span class="hljs-number"><span class="hljs-number">123</span></span>} box.space.goods:<span class="hljs-built_in"><span class="hljs-built_in">insert</span></span>{<span class="hljs-literal"><span class="hljs-literal">nil</span></span>, <span class="hljs-string"><span class="hljs-string">'pencil'</span></span>, <span class="hljs-number"><span class="hljs-number">321</span></span>} box.space.goods:<span class="hljs-built_in"><span class="hljs-built_in">insert</span></span>{<span class="hljs-literal"><span class="hljs-literal">nil</span></span>, <span class="hljs-string"><span class="hljs-string">'brush'</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>} box.space.goods:<span class="hljs-built_in"><span class="hljs-built_in">insert</span></span>{<span class="hljs-literal"><span class="hljs-literal">nil</span></span>, <span class="hljs-string"><span class="hljs-string">'watercolour'</span></span>, <span class="hljs-number"><span class="hljs-number">456</span></span>} box.space.goods:<span class="hljs-built_in"><span class="hljs-built_in">insert</span></span>{<span class="hljs-literal"><span class="hljs-literal">nil</span></span>, <span class="hljs-string"><span class="hljs-string">'album'</span></span>, <span class="hljs-number"><span class="hljs-number">101</span></span>} box.space.goods:<span class="hljs-built_in"><span class="hljs-built_in">insert</span></span>{<span class="hljs-literal"><span class="hljs-literal">nil</span></span>, <span class="hljs-string"><span class="hljs-string">'notebook'</span></span>, <span class="hljs-number"><span class="hljs-number">800</span></span>} box.space.goods:<span class="hljs-built_in"><span class="hljs-built_in">insert</span></span>{<span class="hljs-literal"><span class="hljs-literal">nil</span></span>, <span class="hljs-string"><span class="hljs-string">'rubber'</span></span>, <span class="hljs-number"><span class="hljs-number">531</span></span>} box.space.goods:<span class="hljs-built_in"><span class="hljs-built_in">insert</span></span>{<span class="hljs-literal"><span class="hljs-literal">nil</span></span>, <span class="hljs-string"><span class="hljs-string">'ruler'</span></span>, <span class="hljs-number"><span class="hljs-number">135</span></span>}</code> </pre> <br>  ูุฃู  ุงูุญูู ุงูุฃูู ุนุจุงุฑุฉ ุนู ุนุฏุงุฏ ุฒูุงุฏุฉ ุชููุงุฆูุฉ ุ ููุฑูุฑ ุตูุฑุงู ุจุฏูุงู ูู ุฐูู.  ุณูููู Tarantool ุจุงุณุชุจุฏุงู ุงููููุฉ ุงูุชุงููุฉ ุชููุงุฆููุง.  ูุจุงููุซู ุ ููููู ุชูุฑูุฑ ูููุฉ nil ููููุฉ ููุญููู ูู ุงูุนููุฏ <code>row_ver</code> - ุฃู ุนุฏู ุชุญุฏูุฏ ุงููููุฉ ุนูู ุงูุฅุทูุงู ุ ูุฃู  ูุฐุง ุงูุนููุฏ ูุฃุฎุฐ ุงูููุถุน ุงูุฃุฎูุฑ ูู ุงููุถุงุก. <br><br>  ุชุญูู ูู ูุชูุฌุฉ ุงูุฅุฏุฑุงุฌ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs">tarantool&gt; box.space.goods:<span class="hljs-built_in"><span class="hljs-built_in">select</span></span>() <span class="hljs-comment"><span class="hljs-comment">--- - - [1, 'pen', 123, 1] - [2, 'pencil', 321, 2] - [3, 'brush', 100, 3] - [4, 'watercolour', 456, 4] - [5, 'album', 101, 5] - [6, 'notebook', 800, 6] - [7, 'rubber', 531, 7] - [8, 'ruler', 135, 8] ...</span></span></code> </pre> <br>  ููุง ุชุฑูู ุ ุชู ููุก ุงูุญูู ุงูุฃูู ูุงูุฃุฎูุฑ ุชููุงุฆููุง.  ุงูุขู ุณูููู ูู ุงูุณูู ูุชุงุจุฉ ูุธููุฉ ูุชุฑุญูู ุชูุฑูุบ <code>goods</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs"><span class="hljs-keyword"><span class="hljs-keyword">local</span></span> page_size = <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_goods</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(row_ver)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> index = box.space.goods.index.row_ver <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> goods = {} <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> counter = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> _, tuple <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> index:<span class="hljs-built_in"><span class="hljs-built_in">pairs</span></span>(row_ver, { iterator = <span class="hljs-string"><span class="hljs-string">'GT'</span></span> }) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> obj = tuple:tomap({ names_only = <span class="hljs-literal"><span class="hljs-literal">true</span></span> }) <span class="hljs-built_in"><span class="hljs-built_in">table</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">insert</span></span>(goods, obj) counter = counter + <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> counter &gt;= page_size <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> goods <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br>  ุชุฃุฎุฐ ุงููุธููุฉ ููุนููุฉ ูููุฉ <code>row_ver</code> ููุณุฌู ุงูุฃุฎูุฑ ุงููุณุชูู (0 ููููุงููุฉ ุงูุฃููู) ูุชูุฑุฌุน ุงููุฌููุนุฉ ุงูุชุงููุฉ ูู ุงูุจูุงูุงุช ุงูุชู ุชู ุชุบููุฑูุง (ุฅุฐุง ูุงู ููุงู ูุงุญุฏูุง ุ ูุฅูุง ุตููู ูุงุฑุบ). <br><br>  ูุชู ุงุณุชุฑุฏุงุฏ ุงูุจูุงูุงุช ูู Tarantool ูู ุฎูุงู ุงูููุงุฑุณ.  ุชุณุชุฎุฏู ุงูุฏุงูุฉ <code>row_ver</code> ููุฑุณ <code>row_ver</code> ูุงุณุชุฑุฏุงุฏ ุงูุจูุงูุงุช ุงูุชู ุชู ุชุบููุฑูุง.  ููุน ุงูุชูุฑุงุฑ ูู GT (ุฃูุจุฑ ูู ุ ุฃูุซุฑ ูู).  ูุฐุง ูุนูู ุฃู ุงูุชูุฑุงุฑ ุณูู ูุฌุชุงุฒ ููู ุงูููุฑุณ ุจุงูุชุชุงุจุน ุจุฏุกูุง ูู ุงููููุฉ ุงูุชุงููุฉ ุจุนุฏ ุงูููุชุงุญ ุงูุฐู ุชู ุชูุฑูุฑู. <br><br>  ุฅุฑุฌุงุน ุงูุชูุฑุงุฑ tuples.  ููู ุชุชููู ูุงุญููุง ูู ููู ุงูุจูุงูุงุช ุนุจุฑ HTTP ุ ูู ุงูุถุฑูุฑู ุชุญููู ุงููุฌููุนุงุช ุฅูู ูููู ููุงุณุจ ููุชุณูุณู ุงููุงุญู.  ูู ุงููุซุงู ุ ูุชู ุงุณุชุฎุฏุงู ูุธููุฉ <code>tomap</code> ุงูููุงุณูุฉ ููุฐุง ุงูุบุฑุถ.  ุจุฏูุง ูู ุงุณุชุฎุฏุงู <code>tomap</code> ููููู ูุชุงุจุฉ <code>tomap</code> ุงูุฎุงุตุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ูุฏ ูุฑุบุจ ูู ุฅุนุงุฏุฉ ุชุณููุฉ ุญูู <code>name</code> ุ ูููุณ ุงุฌุชูุงุฒ ุญูู <code>code</code> ุ ูุฅุถุงูุฉ ุญูู <code>comment</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs"><span class="hljs-keyword"><span class="hljs-keyword">local</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unflatten_goods</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(tuple)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> obj = {} obj.id = tuple.id obj.goods_name = tuple.name obj.comment = <span class="hljs-string"><span class="hljs-string">'some comment'</span></span> obj.row_ver = tuple.row_ver <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> obj <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br>  ูุชู ุชุญุฏูุฏ ุญุฌู ุตูุญุฉ ุจูุงูุงุช ุงููุฎุฑุฌุงุช (ุนุฏุฏ ุงูุณุฌูุงุช ูู ุฌุฒุก ูุงุญุฏ) ุจูุงุณุทุฉ ูุชุบูุฑ <code>page_size</code> .  ูู ุงููุซุงู ุ ูููุฉ <code>page_size</code> ูู 5. ูู ุงูุจุฑูุงูุฌ ุงูุญูููู ุ ูููู ุญุฌู ุงูุตูุญุฉ ุนุงุฏุฉู ุฃูุซุฑ ุฃูููุฉ.  ุฐูู ูุนุชูุฏ ุนูู ูุชูุณุท โโุญุฌู tuple ุงููุถุงุก.  ูููู ุชุญุฏูุฏ ุญุฌู ุงูุตูุญุฉ ุงูุฃูุซู ุจุดูู ุชุฌุฑูุจู ุนู ุทุฑูู ููุงุณ ููุช ููู ุงูุจูุงูุงุช.  ูููุง ุฒุงุฏ ุญุฌู ุงูุตูุญุฉ ุ ูู ุนุฏุฏ ุงูุฑุญูุงุช ุฐูุงุจูุง ูุฅูุงุจูุง ุจูู ุฌุงูุจู ุงูุฅุฑุณุงู ูุงูุงุณุชูุจุงู.  ุญุชู ุชุชููู ูู ุชูููู ุงูููุช ุงูุฅุฌูุงูู ูุชุญููู ุงูุชุบููุฑุงุช.  ููุน ุฐูู ุ ุฅุฐุง ูุงู ุญุฌู ุงูุตูุญุฉ ูุจูุฑูุง ุฌุฏูุง ุ ูุณูุฃุฎุฐ ุงูุฎุงุฏู ููุชูุง ุฃุทูู ูู ุงููุงุฒู ูุฅุฌุฑุงุก ุชุณูุณู ุงูุชุญุฏูุฏ.  ูุชูุฌุฉ ูุฐูู ุ ูุฏ ูููู ููุงู ุชุฃุฎูุฑ ูู ูุนุงูุฌุฉ ุงูุทูุจุงุช ุงูุฃุฎุฑู ุงูุชู ุชุฃุชู ุฅูู ุงูุฎุงุฏู.  ูููู ุชุญููู ุงููุนููุฉ <code>page_size</code> ูู ููู ุงูุชูููู.  ููู ูุณุงุญุฉ ูุฑุณูุฉ ุ ููููู ุถุจุท ุงููููุฉ ุงูุฎุงุตุฉ ุจู.  ููุน ุฐูู ุ ุจุงููุณุจุฉ ููุนุธู ุงููุณุงูุงุช ุ ูุฏ ุชููู ุงููููุฉ ุงูุงูุชุฑุงุถูุฉ (ุนูู ุณุจูู ุงููุซุงู ุ 100) ููุงุณุจุฉ. <br><br>  <code>get_goods</code> ูุธููุฉ <code>get_goods</code> ูู ุงููุญุฏุฉ ุงูููุทูุฉ.  ูู ุจุฅูุดุงุก ููู repl.lua ูุญุชูู ุนูู ูุตู ูุชุบูุฑ <code>get_goods</code> ููุธููุฉ <code>get_goods</code> .  ูู ููุงูุฉ ุงูููู ุ ุฃุถู ูุธููุฉ ุงูุชุตุฏูุฑ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { get_goods = get_goods }</code> </pre><br>  ูุชุญููู ุงููุญุฏุฉ ุ ูู ุจุชูููุฐ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs">tarantool&gt; repl = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'repl'</span></span>) <span class="hljs-comment"><span class="hljs-comment">--- ...</span></span></code> </pre><br>  ุฏุนูุง ูููุฐ ูุธููุฉ <code>get_goods</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs">tarantool&gt; repl.get_goods(<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-comment"><span class="hljs-comment">--- - - row_ver: 1 code: 123 name: pen id: 1 - row_ver: 2 code: 321 name: pencil id: 2 - row_ver: 3 code: 100 name: brush id: 3 - row_ver: 4 code: 456 name: watercolour id: 4 - row_ver: 5 code: 101 name: album id: 5 ...</span></span></code> </pre> <br>  ุฎุฐ ูููุฉ ุงูุญูู <code>row_ver</code> ูู ุงูุตู ุงูุฃุฎูุฑ <code>row_ver</code> ุจุงููุธููุฉ ูุฑุฉ ุฃุฎุฑู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs">tarantool&gt; repl.get_goods(<span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-comment"><span class="hljs-comment">--- - - row_ver: 6 code: 800 name: notebook id: 6 - row_ver: 7 code: 531 name: rubber id: 7 - row_ver: 8 code: 135 name: ruler id: 8 ...</span></span></code> </pre> <br>  ููุฑุฉ ุฃุฎุฑู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs">tarantool&gt; repl.get_goods(<span class="hljs-number"><span class="hljs-number">8</span></span>) <span class="hljs-comment"><span class="hljs-comment">--- - [] ...</span></span></code> </pre> <br>  ููุง ุชุฑู ุ ุจูุฐุง ุงูุงุณุชุฎุฏุงู ุ ุชููู ุงูุฏุงูุฉ ุตูุญุฉ ุชูู ุงูุฃุฎุฑู ุจุฅุฑุฌุงุน ูุงูุฉ ุณุฌูุงุช ูุณุงุญุฉ <code>goods</code> .  ูุชุจุน ุงูุตูุญุฉ ุงูุฃุฎูุฑุฉ ุชุญุฏูุฏ ูุงุฑุบ. <br><br>  ุณูููู ุจุฅุฌุฑุงุก ุชุบููุฑุงุช ุนูู ุงููุถุงุก: <br><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs">box.space.goods:update(<span class="hljs-number"><span class="hljs-number">4</span></span>, {{<span class="hljs-string"><span class="hljs-string">'='</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-string"><span class="hljs-string">'copybook'</span></span>}}) box.space.goods:<span class="hljs-built_in"><span class="hljs-built_in">insert</span></span>{<span class="hljs-literal"><span class="hljs-literal">nil</span></span>, <span class="hljs-string"><span class="hljs-string">'clip'</span></span>, <span class="hljs-number"><span class="hljs-number">234</span></span>} box.space.goods:<span class="hljs-built_in"><span class="hljs-built_in">insert</span></span>{<span class="hljs-literal"><span class="hljs-literal">nil</span></span>, <span class="hljs-string"><span class="hljs-string">'folder'</span></span>, <span class="hljs-number"><span class="hljs-number">432</span></span>}</code> </pre> <br>  ูููุง ุจุชุบููุฑ ูููุฉ ุญูู <code>name</code> ูุณุฌู ูุงุญุฏ ููููุง ุจุฅุถุงูุฉ ุณุฌููู ุฌุฏูุฏูู. <br><br>  ูุฑุฑ ุงุณุชุฏุนุงุก ุงููุธููุฉ ุงูุฃุฎูุฑุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs">tarantool&gt; repl.get_goods(<span class="hljs-number"><span class="hljs-number">8</span></span>) <span class="hljs-comment"><span class="hljs-comment">--- - - row_ver: 9 code: 800 name: copybook id: 6 - row_ver: 10 code: 234 name: clip id: 9 - row_ver: 11 code: 432 name: folder id: 10 ...</span></span></code> </pre> <br>  ุฃุฑุฌุนุช ุงูุฏุงูุฉ ุงูุณุฌูุงุช ุงูุชู ุชู ุชุบููุฑูุง ูุฅุถุงูุชูุง.  ูุจุงูุชุงูู ุ ุชุชูุญ <code>get_goods</code> ูุธููุฉ <code>get_goods</code> ุงูุญุตูู ุนูู ุงูุจูุงูุงุช ุงูุชู ุชุบูุฑุช ููุฐ ุขุฎุฑ ููุงููุฉ ููุง ุ ูุงูุชู ูู ุฃุณุงุณ ุทุฑููุฉ ุงููุณุฎ ุงููุชูุงุซู ููุฏ ุงููุธุฑ. <br><br>  ูุชุฑู ูุชุงุฆุฌ ุงููุชุงุฆุฌ ุนุจุฑ HTTP ูู ุดูู JSON ุฎุงุฑุฌ ูุทุงู ูุฐู ุงูููุงูุฉ.  ููููู ุฃู ุชูุฑุฃ ุนููุง ููุง: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://habr.com/ru/company/mailru/blog/272141/</a> <br><br><h4 style=";text-align:right;direction:rtl">  ุชูููุฐ ุฌุฒุก ุงูุนููู / ุงูุนุจุฏ </h4><br>  ุงููุธุฑ ูู ูุง ูุจุฏู ุชูููุฐ ุงูุฌุงูุจ ุงููุชููู.  ูู ุจุฅูุดุงุก ูุณุงุญุฉ ุนูู ุฌุงูุจ ุงูุงุณุชูุจุงู ูุชุฎุฒูู ุงูุจูุงูุงุช ุงูุชู ุชู ุชูุฒูููุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs">box.schema.space.<span class="hljs-built_in"><span class="hljs-built_in">create</span></span>(<span class="hljs-string"><span class="hljs-string">'goods'</span></span>, { <span class="hljs-built_in"><span class="hljs-built_in">format</span></span> = { { name = <span class="hljs-string"><span class="hljs-string">'id'</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> = <span class="hljs-string"><span class="hljs-string">'unsigned'</span></span> }, { name = <span class="hljs-string"><span class="hljs-string">'name'</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> = <span class="hljs-string"><span class="hljs-string">'string'</span></span> }, { name = <span class="hljs-string"><span class="hljs-string">'code'</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> = <span class="hljs-string"><span class="hljs-string">'unsigned'</span></span> } }, if_not_exists = <span class="hljs-literal"><span class="hljs-literal">true</span></span> }) box.space.goods:create_index(<span class="hljs-string"><span class="hljs-string">'primary'</span></span>, { parts = { <span class="hljs-string"><span class="hljs-string">'id'</span></span> }, sequence = <span class="hljs-string"><span class="hljs-string">'goods_id'</span></span>, unique = <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> = <span class="hljs-string"><span class="hljs-string">'HASH'</span></span>, if_not_exists = <span class="hljs-literal"><span class="hljs-literal">true</span></span> })</code> </pre> <br>  ุชุดุจู ุจููุฉ ุงููุณุงุญุฉ ุจููุฉ ุงููุณุงุญุฉ ูู ุงููุตุฏุฑ.  ูููู ูุธุฑูุง ูุฃููุง ูู ูููู ุงูุจูุงูุงุช ุงููุณุชููุฉ ูู ููุงู ุขุฎุฑ ุ ูุฅู ุนููุฏ <code>row_ver</code> ูู ูุณุงุญุฉ ุฌูุงุฒ ุงูุงุณุชูุจุงู.  ูู ุญูู <code>id</code> ุณูุชู ูุชุงุจุฉ ูุนุฑูุงุช ุงููุตุฏุฑ.  ูุฐูู ุ ุนูู ุฌุงูุจ ุงููุชููู ุ ููุณุช ููุงู ุญุงุฌุฉ ูุฌุนูู ุฒูุงุฏุฉ ุชููุงุฆูุฉ. <br><br>  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุญุชุงุฌ ุฅูู ูุณุงุญุฉ ูุญูุธ ููู <code>row_ver</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs">box.schema.space.<span class="hljs-built_in"><span class="hljs-built_in">create</span></span>(<span class="hljs-string"><span class="hljs-string">'row_ver'</span></span>, { <span class="hljs-built_in"><span class="hljs-built_in">format</span></span> = { { name = <span class="hljs-string"><span class="hljs-string">'space_name'</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> = <span class="hljs-string"><span class="hljs-string">'string'</span></span> }, { name = <span class="hljs-string"><span class="hljs-string">'value'</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> = <span class="hljs-string"><span class="hljs-string">'string'</span></span> } }, if_not_exists = <span class="hljs-literal"><span class="hljs-literal">true</span></span> }) box.space.row_ver:create_index(<span class="hljs-string"><span class="hljs-string">'primary'</span></span>, { parts = { <span class="hljs-string"><span class="hljs-string">'space_name'</span></span> }, unique = <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> = <span class="hljs-string"><span class="hljs-string">'HASH'</span></span>, if_not_exists = <span class="hljs-literal"><span class="hljs-literal">true</span></span> })</code> </pre> <br>  ููู ูุณุงุญุฉ ูุญููุฉ (field <code>space_name</code> ) ุ ุณูููุฑ ููุง <code>row_ver</code> ุขุฎุฑ ูููุฉ ูุญููุฉ ( <code>value</code> ุงูุญูู).  ุงูููุชุงุญ ุงูุฃุณุงุณู ูู ุนููุฏ <code>space_name</code> . <br><br>  ูููู ุจุฅูุดุงุก ูุธููุฉ ูุชุญููู ุจูุงูุงุช ูุณุงุญุฉ <code>goods</code> ุนุจุฑ HTTP.  ููููุงู ุจุฐูู ุ ูุญุชุงุฌ ุฅูู ููุชุจุฉ ุชููุฐ ุนููู HTTP.  ูุญููู ุงูุณุทุฑ ุงูุชุงูู ุงูููุชุจุฉ ูููุดุฆ ุนููู HTTP: <br><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs"><span class="hljs-keyword"><span class="hljs-keyword">local</span></span> http_client = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'http.client'</span></span>).new()</code> </pre> <br>  ูุญุชุงุฌ ุฃูุถูุง ุฅูู ููุชุจุฉ ูุฅูุบุงุก ุชุณูุณู json: <br><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs"><span class="hljs-keyword"><span class="hljs-keyword">local</span></span> json = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'json'</span></span>)</code> </pre> <br>  ูุฐุง ูููู ูุฅูุดุงุก ูุธููุฉ ุชุญููู ุงูุจูุงูุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs"><span class="hljs-keyword"><span class="hljs-keyword">local</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">load_data</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(url, row_ver)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> url = (<span class="hljs-string"><span class="hljs-string">'%s?rowVer=%s'</span></span>):<span class="hljs-built_in"><span class="hljs-built_in">format</span></span>(url, <span class="hljs-built_in"><span class="hljs-built_in">tostring</span></span>(row_ver)) <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> body = <span class="hljs-literal"><span class="hljs-literal">nil</span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> data = http_client:request(<span class="hljs-string"><span class="hljs-string">'GET'</span></span>, url, body, { keepalive_idle = <span class="hljs-number"><span class="hljs-number">1</span></span>, keepalive_interval = <span class="hljs-number"><span class="hljs-number">1</span></span> }) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json.decode(data.body) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br>  ุชููู ุงูุฏุงูุฉ ุจุชูููุฐ ุทูุจ HTTP ุนูู ุนููุงู url ุ ูุชูุฑุฑ <code>row_ver</code> ููู ููุนููุฉ ุ ูุชูุฑุฌุน ุงููุชูุฌุฉ <code>row_ver</code> ูู ุงูุทูุจ. <br><br>  ูุธููุฉ ุญูุธ ุงูุจูุงูุงุช ุงููุณุชููุฉ ูู ููุง ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs"><span class="hljs-keyword"><span class="hljs-keyword">local</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">save_goods</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(goods)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> n = #goods box.atomic(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>, n <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> obj = goods[i] box.space.goods:put( obj.id, obj.name, obj.code) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br>  ูุชู ูุถุน ุฏูุฑุฉ ุชุฎุฒูู ุงูุจูุงูุงุช ูู ูุณุงุญุฉ <code>goods</code> ูู ุงููุนุงููุงุช (ูุชู ุงุณุชุฎุฏุงู ุงูุฏุงูุฉ <code>box.atomic</code> ููุฐุง) ูุชูููู ุนุฏุฏ ุนูููุงุช ุงููุฑุต. <br><br>  ุฃุฎูุฑูุง ุ ูููู ุชูููุฐ ูุธููุฉ ุชุฒุงูู <code>goods</code> ุงููุถุงุฆูุฉ ุงููุญููุฉ ูุน ุงููุตุฏุฑ ุนูู ุงููุญู ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs"><span class="hljs-keyword"><span class="hljs-keyword">local</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sync_goods</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> tuple = box.space.row_ver:get(<span class="hljs-string"><span class="hljs-string">'goods'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> row_ver = tuple <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> tuple.value <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">-- set your url here: local url = 'http://127.0.0.1:81/test/goods/list' while true do local goods = load_goods(url, row_ver) local count = #goods if count == 0 then return end save_goods(goods) row_ver = goods[count].rowVer box.space.row_ver:put({'goods', row_ver}) end end</span></span></code> </pre> <br>  ุฃููุงู ุ ููุฑุฃ ูููุฉ <code>row_ver</code> ุงููุญููุธุฉ ูุณุจููุง <code>row_ver</code> <code>goods</code> .  ุฅุฐุง ูุงูุช ุบุงุฆุจุฉ (ุฌูุณุฉ ุงูุชุจุงุฏู ุงูุฃููู) ุ <code>row_ver</code> ุงูุตูุฑ ูู <code>row_ver</code> .  ุจุนุฏ ุฐูู ุ ูู ุงูุญููุฉ ุ ูููู ุจุชุฑููู ุงูุตูุญุงุช ุงููุนุฏูุฉ ูู ุงููุตุฏุฑ ุฅูู ุนููุงู url ุงููุญุฏุฏ.  ูู ูู ุชูุฑุงุฑ ุ ูููู ุจุญูุธ ุงูุจูุงูุงุช ุงููุณุชููุฉ ูู ุงููุณุงุญุฉ ุงููุญููุฉ ุงูููุงุจูุฉ ูุชุญุฏูุซ ูููุฉ <code>row_ver</code> (ูู <code>row_ver</code> row_ver ููู ูุชุบูุฑ <code>row_ver</code> ) - ูุฃุฎุฐ ูููุฉ <code>row_ver</code> ูู ุงูุตู ุงูุฃุฎูุฑ ูู ุงูุจูุงูุงุช ุงููุญููุฉ. <br><br>  ููุญูุงูุฉ ูู ุงูุญููุงุช ุงูุนุฑุถูุฉ (ูู ุญุงูุฉ ุญุฏูุซ ุฎุทุฃ ูู ุงูุจุฑูุงูุฌ) ุ ูููู ุงุณุชุจุฏุงู <code>while</code> ุจู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> _ = <span class="hljs-number"><span class="hljs-number">1</span></span>, max_req <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> ...</code> </pre> <br>  ูุชูุฌุฉ ููุธููุฉ <code>sync_goods</code> ุ <code>sync_goods</code> <code>goods</code> ูู ุงููุณุชูุจู ุนูู ุฃุญุฏุซ ุฅุตุฏุงุฑุงุช ุฌููุน ุณุฌูุงุช ูุณุงุญุฉ <code>goods</code> ูู ุงููุตุฏุฑ. <br><br>  ูู ุงููุงุถุญ ุฃู ุญุฐู ุงูุจูุงูุงุช ูุง ูููู ุจุซู ุจูุฐู ุงูุทุฑููุฉ.  ูู ุญุงูุฉ ูุฌูุฏ ูุฐู ุงูุญุงุฌุฉ ุ ููููู ุงุณุชุฎุฏุงู ุนูุงูุฉ ุงูุญุฐู.  <code>is_deleted</code> ุงูุญูู ุงูููุทูู <code>is_deleted</code> ูุณุงุญุฉ <code>goods</code> ูุจุฏูุงู ูู ุญุฐู ุงูุณุฌู ูุนูููุง ุ ุงุณุชุฎุฏู ุงูุญุฐู ุงูููุทูู - <code>is_deleted</code> ูููุฉ ุงูุญูู <code>is_deleted</code> ุฅูู <code>true</code> .  ูู ุจุนุถ ุงูุฃุญูุงู ุ ุจุฏูุงู ูู ุงูุญูู ุงูููุทูู <code>is_deleted</code> ุ <code>is_deleted</code> ุฃูุซุฑ ููุงุกูุฉ ูุงุณุชุฎุฏุงู ุงูุญูู <code>deleted</code> ุ ุงูุฐู ูุฎุฒู ููุช ุชุงุฑูุฎ ุงูุญุฐู ุงูููุทูู ููุณุฌู.  ุจุนุฏ ุฅุฌุฑุงุก ุงูุญุฐู ุงูููุทูู ุ ุณูุชู ููู ุงูุณุฌู ุงููุญุฏุฏ ููุญุฐู ูู ุงููุตุฏุฑ ุฅูู ุฌูุงุฒ ุงูุงุณุชูุจุงู (ููููุง ููููุทู ุงูุฐู ุชูุช ููุงูุดุชู ุฃุนูุงู). <br><br>  ูููู ุงุณุชุฎุฏุงู ุชุณูุณู <code>row_ver</code> ูููู ุงูุจูุงูุงุช ูู ูุณุงูุงุช ุฃุฎุฑู: ููุณุช ููุงู ุญุงุฌุฉ ูุฅูุดุงุก ุชุณูุณู ูููุตู ููู ูุณุงุญุฉ ูุฑุณูุฉ. <br><br>  ุฏุฑุณูุง ุทุฑููุฉ ูุนุงูุฉ ูุชูุฑุงุฑ ุงูุจูุงูุงุช ุนุงููุฉ ุงููุณุชูู ูู ุงูุชุทุจููุงุช ุงูุชู ุชุณุชุฎุฏู Tarantool DBMS. <br><br><h2 style=";text-align:right;direction:rtl">  ุงููุชุงุฆุฌ </h2><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุนุชุจุฑ Tarantool DBMS ููุชุฌูุง ุฌุฐุงุจูุง ูุงุนุฏูุง ูุฅูุดุงุก ุชุทุจููุงุช ูุญููุฉ ููุบุงูุฉ. <br></li><li style=";text-align:right;direction:rtl">  ูููุฑ ุงููุณุฎ ุงููุชูุงุซู ุนุงูู ุงููุณุชูู ุทุฑููุฉ ุฃูุซุฑ ูุฑููุฉ ูููู ุงูุจูุงูุงุช ููุงุฑูุฉ ุจุงููุณุฎ ุงููุชูุงุซู ุงูููุฎูุถ ุงููุณุชูู. <br></li><li style=";text-align:right;direction:rtl">  ุชุณูุญ ุทุฑููุฉ ุงููุณุฎ ุงููุชูุงุซู ุนุงููุฉ ุงููุณุชูู ุงูุชู ุชู ุจุญุซูุง ูู ุงูููุงูุฉ ูุฃุญุฏ ุชูููู ูููุฉ ุงูุจูุงูุงุช ุงููุฑุณูุฉ ุนู ุทุฑูู ููู ุงูุณุฌูุงุช ุงูุชู ุชุบูุฑุช ููุท ููุฐ ุขุฎุฑ ุฌูุณุฉ ุชุจุงุฏู. <br></li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar455146/">https://habr.com/ru/post/ar455146/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar455132/index.html">ุงูุขุซุงุฑ: Philips Velo 1 ุ ูุงุจูุณ ุนุดุงู ุงูุชูููููุฌูุง</a></li>
<li><a href="../ar455134/index.html">ูุง ุงูุฐู ุชู ุชุฐูุฑู ูู Heisenbug ูู ุงููุงุถู ุ ููุงุฐุง ุณูุญุฏุซ ุจุนุฏ ุฐููุ</a></li>
<li><a href="../ar455136/index.html">ููุงุฐุง ููุท ุถุฎ ุงูุชุฑููุฒ ูู ูุฌุนูู ูุทูุฑูุง ุฃูุถู</a></li>
<li><a href="../ar455138/index.html">JetBrains ูููุฉ ููุณูู: ููู ูุงู</a></li>
<li><a href="../ar455144/index.html">ุงูุงุณุชุนุฏุงุฏ ูุนุงู 2020: 8 ุงุชุฌุงูุงุช ูู ุชุทููุฑ ุฌุงูุง ุณูุฑูุจุช ูู ุฌุงูุจ ุงูุนููู ุชุญุชุงุฌ ุฅูู ูุนุฑูุชูุง</a></li>
<li><a href="../ar455148/index.html">ูุญู ูุญู ููุงู ุตูุน ุงููุฑุงุฑ ุงููุงุฆูุฉ ุนูู ุงูุจูุงูุงุช</a></li>
<li><a href="../ar455152/index.html">ุชุญุณูู ุชุทุจูู ุงููุญููู ุงูุฎุงุต ุจู ุจุงุณุชุฎุฏุงู ุชูููููุฌูุง ุงูุชุนูู ุงูุขูู</a></li>
<li><a href="../ar455156/index.html">ููุงู ุงูุชุณูุณู ุงููุญูู (ููููู ุ 2019)</a></li>
<li><a href="../ar455158/index.html">ุนุฌุงุฆุจ ูููุฌูุฉ ุงููุญุงุณุจุฉ: ุตูุฏูู ุงูุงุณุชููุงู</a></li>
<li><a href="../ar455160/index.html">ุฅุทุงุฑ ุนูู ุงูููุงู 6 ูุน ุงูุจุญุซ ุนู ุงููุต ุงููุงูู ุนุจุฑ LINQ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>