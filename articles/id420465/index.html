<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎰 💇 👵🏻 Variabel nginx dengan njs: sederhana, tidak menyakitkan dan melalui JavaScript 👨‍👨‍👦 🐲 🌘</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="njs adalah penerjemah JavaScript di server web yang ringan yang dengannya Anda dapat membuat variabel nginx baru dan meminta penangan tahap. Apa manfa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Variabel nginx dengan njs: sederhana, tidak menyakitkan dan melalui JavaScript</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/420465/">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">njs</a> adalah penerjemah JavaScript di server web yang ringan yang dengannya Anda dapat membuat variabel nginx baru dan meminta penangan tahap.  Apa manfaatnya?  Apa yang tidak bisa?  Dan mengapa mereka melakukannya?  Pertanyaan-pertanyaan ini dan lainnya akan dijawab oleh Dmitry Volyntsev ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link">xeioex</a> ), pengembang nginx dan pengembang utama interpreter njs. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e34/80a/672/e3480a6727d8a79621d2888997cb2d28.jpg"><br><br><h3>  - Dmitry, mengapa Anda perlu skrip di konfigurasi nginx? </h3><br>  - Alasan pertama adalah <code>if</code> direktif.  Orang-orang yang melihatnya untuk pertama kali berpikir bahwa mereka dapat digunakan secara imperatif.  Sebenarnya tidak demikian - konfigurasi nginx bersifat deklaratif.  Pada contoh di bawah ini, Anda mungkin berpikir bahwa respons akan memiliki dua header: X-First dan X-Second.  Tetapi hanya header kedua yang akan mendapatkan jawabannya, karena nginx sudah diatur: jika kita menulis dua jika arahan, maka yang terakhir akan dipilih. <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">location</span></span> /only-one-if { <span class="hljs-attribute"><span class="hljs-attribute">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$true</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$true</span></span>) { <span class="hljs-attribute"><span class="hljs-attribute">add_header</span></span> X-First <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$true</span></span>) { <span class="hljs-attribute"><span class="hljs-attribute">add_header</span></span> X-Second <span class="hljs-number"><span class="hljs-number">2</span></span>; }</code> </pre> <a name="habracut"></a><br>  Alasan kedua adalah apa yang nginx lakukan sekarang.  Sebelumnya, ini digunakan untuk men-cache statika dan permintaan, serta load balancing - satu set proxy klasik.  Proliferasi layanan-layanan mikro telah mengikis lingkup nginx.  Jika pengaturan konfigurasi sebelumnya berakhir dengan sepasang lokasi pada beberapa backend dalam beberapa bahasa, maka dengan arsitektur layanan mikro kami memiliki lebih banyak bagian yang bergerak.  Backend telah menjadi banyak komponen kecil.  Logika otorisasi, misalnya, perlu diduplikasi pada setiap layanan-mikro atau diambil, misalnya, di frontend.  Untuk menerapkan otorisasi tingkat lanjut, tidak selalu cukup mekanisme solusi bawaan di nginx. <br><br>  Ketiga, dalam nginx banyak arahan menerima ekspresi yang dihitung secara dinamis, misalnya: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">proxy</span></span> cache bypass <span class="hljs-variable"><span class="hljs-variable">$cookie_nocache</span></span> <span class="hljs-variable"><span class="hljs-variable">$arg_nocache</span></span>;</code> </pre> <br>  Anda dapat menggabungkan variabel satu sama lain atau dengan string literal.  Tapi ini tidak cukup, dan saya ingin memiliki alat yang lebih kuat, misalnya, untuk menghitung hash, untuk bekerja dengan data numerik, untuk digunakan pada huruf besar dan kecil. <br><br>  Untuk memperluas semua hambatan di nginx, Anda harus mengembangkan sintaks Anda sendiri atau menggunakan sesuatu yang sudah jadi.  Kami sampai pada kesimpulan bahwa yang terbaik adalah mengambil bahasa pemrograman scripting yang ada.  Dengan demikian, pengembang tidak perlu mempelajari bahasa baru, yang juga akan menghemat waktu dan menurunkan ambang entri.  Kami memilih JavaScript. <br><br><h3>  - Dan mengapa JavaScript? </h3><br>  - Kami memilih JavaScript karena beberapa alasan: <br><br><ul><li>  Dialek modern, yang bagus untuk pengembang yang beralih dari bahasa lain. <br></li><li>  Gaya seperti C.  Ini penting karena konfigurasi nginx menggunakan kurung kurawal, dan di masa depan kami ingin menambahkan kemampuan untuk menulis kode JS tepat di dalam konfigurasi.  Kawat gigi akan membantu kita dengan ini.  Di Lua, misalnya, peran kawat gigi keriting dilakukan dengan mulai dan akhir - ini tidak nyaman. <br></li><li>  Model JavaScript sangat cocok dengan arsitektur nginx. <br></li></ul><br><h3>  "Jadi Lua juga dipertimbangkan?"  Apakah karena awal dan akhir? </h3><br>  - Sudah ada proyek pihak ketiga yang sudah jadi, OpenResty.  Jika Anda tidak masuk ke detail, maka ini pada dasarnya adalah nginx + Lua, tetapi memiliki arsitektur yang berlawanan dengan nginx.  Kami ingin menghindari persimpangan dengan ekosistem ini.  Selain itu, ada beberapa alasan lain: <br><br><ul><li>  Lua memiliki sintaksis seperti pascal. <br></li><li>  Array diindeks dari 1. <br></li><li>  Lua masih merupakan bahasa pemrograman khusus. <br></li></ul><br><h3>  - Bagaimana njs dibandingkan dengan pesaing? </h3><br>  - Kami memberi peringkat njs dibandingkan dengan mesin yang terkenal - V8 dan SpiderMonkey.  Mereka tidak efektif untuk tugas-tugas di dalam nginx, karena mereka dipertajam oleh browser dan sangat kelas berat, dan nginx membutuhkan kecepatan tinggi.  Selain itu, kedua mesin ini berkembang pesat, API mereka tidak stabil.  Akhirnya, njs dapat diintegrasikan secara lebih efisien ke dalam nginx: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/196/af8/62e/196af862e5247dbd85029b36f2cffb0c.png"><br>  <i>Jumlah konteks yang dibuat per detik</i> <br><br><h3>  - Standar apa yang didukung njs? </h3><br>  - Saat ini, hampir semua elemen dasar dari spesifikasi ECMAScript 5.1 diimplementasikan dengan beberapa elemen berselang dari spesifikasi 6 dan 7. Yaitu, objek standar seperti Objek, Array, String, Nomor, Tanggal, RegExp, JSON.  Penutupan, fungsi anonim, dan bekerja dengan pengecualian didukung sepenuhnya. <br><br>  Kami tidak menetapkan sebagai tujuan utama kami kepatuhan penuh dengan spesifikasi bahasa.  Jadi saat ini tidak ada dukungan untuk <i>eval ()</i> , dan sejauh ini kami tidak berencana untuk menambahkannya.  Tetapi kami berencana untuk menambahkan dukungan untuk const dan membiarkan kata kunci, serta fungsi panah. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6d9/5ec/ff9/6d95ecff9b1f8b55d8eaffd910d8bb9b.png"><br>  <i>Apa yang mampu dan apa yang tidak dapat dilakukan saat ini</i> <br><br>  Penting untuk menyebutkan satu hal lagi: kurangnya pengumpulan sampah.  Sebagian besar bahasa modern secara mandiri memonitor masa pakai objek.  Jika objek tidak lagi digunakan, itu secara otomatis dihapus.  Anda tidak dapat melakukannya tanpa mekanisme ini, tetapi biasanya Anda harus mengorbankan sesuatu untuk itu - pekerjaan program melambat atau bahkan berhenti.  Dalam njs, memori tidak dibebaskan sampai objek permintaan dibebaskan. <br><br>  Pendekatan ini memiliki pro dan kontra.  Kerugian utama adalah tidak memungkinkan Anda untuk bekerja secara efektif dengan permintaan panjang.  Karenanya, di masa mendatang kami berencana untuk menambahkan pengumpulan sampah sebagai opsi untuk mengaktifkannya sesuai kebutuhan. <br><br><h3>  - Apa yang bukan? </h3><br>  - Sebelum menjawab pertanyaan ini, saya ingin mengulangi sekali lagi bahwa tugas utama njs adalah untuk mengembangkan kemampuan untuk konfigurasi fleksibel nginx dan menyelesaikan tugas-tugas di sisi proxy. <br><br>  Sekarang pertanyaannya sendiri.  Apa yang harus dipertimbangkan terlebih dahulu? <br><ul><li>  njs bukan pengganti untuk Node.js. <br></li><li>  Bundel nginx + njs bukan server aplikasi. <br></li><li>  njs tidak sepenuhnya mengimplementasikan standar ECMAScript, karena tidak ada dukungan untuk eval (). <br></li></ul><br><hr><br>  Jika topik ini sangat relevan untuk Anda dan Anda membutuhkan lebih banyak detail, kami sarankan Anda menonton rekaman video laporan Dmitry Volintsev di HighLoad ++ Siberia 2018, tempat ia mengungkapkannya dari semua sisi. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/zq9IDngR5pk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Kami juga mengundang semua pro untuk mengirimkan laporan mereka ke konferensi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">HighLoad ++ 2018</a> November, yang akan diadakan di Skolkovo pada 8 dan 9 November.  Jika Anda memiliki pengalaman yang unik dan menarik dan Anda siap untuk membagikannya - daftar sebelum 1 September dan isi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">formulir</a> . <br><br>  Jika Anda takut untuk berbicara di depan umum, kami memiliki apa yang disebut <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sekolah pembicara</a> , di mana kami membantu memompa keterampilan ini secara gratis. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id420465/">https://habr.com/ru/post/id420465/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id420455/index.html">[Javawatch Live] Kisah satu permintaan tarik. `os.versi 'dalam SubstrateVM</a></li>
<li><a href="../id420457/index.html">Ikhtisar Perangkat Lunak Pencetakan 3D Simplify3D</a></li>
<li><a href="../id420459/index.html">Ikon dengan penghitung di bilah alat atas: contoh berbagai pendekatan untuk satu tugas</a></li>
<li><a href="../id420461/index.html">10 kutipan dari desainer yang buruk</a></li>
<li><a href="../id420463/index.html">ICO sepatutnya dalam penurunan, tetapi mereka memiliki kesempatan untuk berubah</a></li>
<li><a href="../id420467/index.html">Wrapper C ++ untuk "semua" Sistem Operasi Real-Time untuk CortexM4</a></li>
<li><a href="../id420469/index.html">Fitur menggunakan Druid pada contoh Classmates</a></li>
<li><a href="../id420471/index.html">Tiga laporan teknis RIT 2018 oleh Plesk</a></li>
<li><a href="../id420473/index.html">Buku untuk eksekutif pemula atau mengapa sangat penting untuk dibaca</a></li>
<li><a href="../id420475/index.html">Perbandingan mesin pemotong laser Raylogic 11G dan Raylogic V12</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>