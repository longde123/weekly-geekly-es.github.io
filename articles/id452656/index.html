<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📝 👩🏽‍💻 👨🏼‍🎨 Pengembangan "firmware" paling sederhana untuk FPGA yang dipasang di Redd, dan debugging menggunakan tes memori sebagai contoh 🤷 💸 👩🏻‍⚕️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Entah bagaimana saya tidak bisa mengungkapkan pikiran saya secara singkat. Musim gugur yang lalu, ada keinginan untuk menceritakan secara lebih rinci ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pengembangan "firmware" paling sederhana untuk FPGA yang dipasang di Redd, dan debugging menggunakan tes memori sebagai contoh</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/452656/">  Entah bagaimana saya tidak bisa mengungkapkan pikiran saya secara singkat.  Musim gugur yang lalu, ada keinginan untuk menceritakan secara lebih rinci tentang arsitektur PSoC yang saya kuasai, yang menghasilkan serangkaian artikel tentang itu.  Sekarang saya terlibat dalam menyiapkan perangkat keras untuk kompleks debugging jarak jauh Redd kami, yang telah dijelaskan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> , dan saya ingin membuang akumulasi pengalaman dalam bentuk teks.  Saya belum yakin, tetapi bagi saya sepertinya itu bukan hanya satu artikel, tetapi sebuah siklus.  Pertama, ini adalah bagaimana saya akan mendokumentasikan metode pengembangan yang dikembangkan yang mungkin berguna bagi seseorang baik ketika bekerja dengan kompleks, dan secara umum, dan kedua, konsepnya masih baru, belum cukup mapan.  Mungkin, dalam proses membahas artikel, beberapa komentar akan muncul, dari mana orang dapat menggambar sesuatu untuk memperluas (atau bahkan mengubahnya).  Karena itu, kami melanjutkan. <br><img src="https://habrastorage.org/webt/lk/xe/c9/lkxec9ijefezvvydvjbmi49ahny.jpeg"><br><a name="habracut"></a><br><br><h2>  Pengantar panjang </h2><br>  Saya tidak terlalu suka berteori, lebih suka menata beberapa hal praktis sekaligus.  Namun di awal artikel pertama, tanpa perkenalan panjang di mana saja.  Di dalamnya, saya membenarkan pendekatan pembangunan saat ini.  Dan semuanya akan berputar di sekitar satu hal: jam kerja adalah sumber daya yang sangat mahal.  Dan masalahnya tidak hanya dalam ketentuan yang diberikan untuk proyek.  Secara fisik dia mahal.  Jika dihabiskan untuk pengembangan produk akhir, yah, apa yang bisa Anda lakukan tanpanya?  Tetapi ketika dihabiskan untuk pekerjaan tambahan, ini, menurut saya, itu buruk.  Saya ingat bahwa saya memiliki perselisihan dengan satu pengembang yang mengatakan bahwa setelah membuat prototipe sendiri, ia akan menghemat uang untuk perusahaan asalnya.  Saya membuat argumen bahwa dia akan menghabiskan sekitar 3 hari untuk pembuatan.  Itu 24 jam kerja.  Kami mengambil gajinya untuk jam-jam ini, menambahkan pajak sosial yang "dibayar majikan", serta sewa kantor untuk jam-jam ini.  Dan kami terkejut melihat bahwa memesan papan di samping, Anda bisa mendapatkan biaya lebih rendah.  Tapi itu aku, aku melebih-lebihkan.  Secara umum, jika biaya tenaga kerja dapat dihindari, mereka harus dihindari. <br><br>  Apa pengembangan "firmware" untuk kompleks Redd?  Ini adalah pekerjaan tambahan.  Proyek utama akan hidup bahagia selamanya, itu harus dilakukan seefisien mungkin, dengan optimasi yang sangat baik, dll.  Tetapi menghabiskan waktu dan energi untuk hal-hal tambahan yang akan pergi ke arsip setelah pengembangan adalah sia-sia.  Dengan memperhatikan prinsip ini maka pengembangan peralatan Redd dilakukan.  Semua fungsi, jika mungkin, diimplementasikan sebagai hal-hal standar.  Bus SPI, I2C, dan UART diimplementasikan pada sirkuit mikro FTDI standar dan diprogram melalui driver standar, tanpa embel-embel.  Manajemen gulungan diimplementasikan dalam format port COM virtual.  Itu dapat dimodifikasi, tetapi setidaknya semuanya telah dilakukan sehingga keinginan seperti itu tidak muncul.  Secara umum, semua standar, jika mungkin, diimplementasikan dengan cara standar.  Dari proyek ke proyek, pengembang hanya perlu dengan cepat menulis kode khas untuk PC untuk mengakses bus ini.  Teknik pengembangan dalam C ++ harus jelas bagi mereka yang mengembangkan program untuk mikrokontroler (kita akan berbicara tentang beberapa detail teknis dalam artikel lain). <br><br>  Tetapi FPGA berdiri sendiri di kompleks.  Ini ditambahkan ke sistem untuk kasus ketika perlu untuk mengimplementasikan protokol non-standar dengan persyaratan kinerja tinggi.  Jika itu diperlukan, Anda harus melakukan "firmware" untuk itu.  Itu tentang pemrograman FPGA dan saya ingin berbicara secara khusus, semuanya untuk tujuan yang sama - untuk mengurangi waktu pengembangan hal-hal tambahan. <br><br>  Agar tidak membingungkan pembaca, saya akan merumuskan pemikiran dalam bingkai: <br><blockquote>  Tidak perlu melakukan pengembangan untuk FPGA di setiap proyek.  Jika ada cukup pengontrol bus yang terhubung langsung ke prosesor pusat untuk bekerja dengan perangkat target, Anda harus menggunakannya. <br>  FPGA ditambahkan ke kompleks untuk implementasi protokol non-standar. </blockquote><br><br><h2>  Blok diagram kompleks </h2><br>  Mari kita lihat diagram blok kompleks <br><br><img src="https://habrastorage.org/webt/vf/hv/da/vfhvda1kmsax-zkxaue4xu_ysmk.png"><br><br>  Di bagian bawah sirkuit adalah "kalkulator".  Sebenarnya, ini adalah PC standar dengan Linux.  Pengembang dapat menulis program reguler dalam C, C ++, Python, dll., Yang akan dieksekusi oleh komputer.  Di bagian kanan atas adalah port standar ban standar.  Di sebelah kiri adalah sakelar untuk perangkat standar (SPI Flash, kartu SD, dan beberapa relay solid-state arus rendah, yang dapat, misalnya, mensimulasikan penekanan tombol).  Dan di tengah justru bagian yang direncanakan untuk dipertimbangkan dalam seri artikel ini.  Jantungnya adalah FPGA kelas FPGA, dari mana garis lurus keluar (dapat digunakan sebagai pasangan diferensial atau garis biasa), jalur GPIO dengan tingkat logika yang dapat dikonfigurasi, serta bus USB 2.0 diimplementasikan melalui chip ULPI. <br><br><h2>  Kelanjutan dari pengantar tentang pendekatan pemrograman FPGA </h2><br>  Ketika mengembangkan logika kontrol kinerja tinggi untuk FPGA, biasanya Yang Mulia dimainkan biola pertama oleh mesin negara.  Pada mesin itulah dimungkinkan untuk mengimplementasikan logika berkecepatan tinggi namun kompleks.  Tetapi di sisi lain, otomat dikembangkan lebih lambat daripada program untuk prosesor, dan modifikasinya adalah proses lain.  Ada sistem yang menyederhanakan pengembangan dan perawatan mesin.  Salah satunya bahkan dikembangkan oleh perusahaan kami, tetapi tetap saja, proses desain untuk segala jenis logika yang rumit tidak cepat.  Ketika sistem yang dikembangkan adalah produk akhir, masuk akal untuk menyiapkan, merancang mesin kontrol yang baik, dan menghabiskan waktu untuk penerapannya.  Tapi seperti yang sudah disebutkan, pengembangan untuk Redd adalah pekerjaan tambahan.  Ini dirancang untuk memfasilitasi proses, bukan mempersulitnya.  Oleh karena itu, diputuskan bahwa pengembangan tidak akan otomatis, tetapi sistem prosesor. <br><br>  Tetapi di sisi lain, ketika mengembangkan perangkat keras, opsi paling modis hingga saat ini, FPGA dengan inti ARM, ditolak.  Pertama, karena alasan harga.  Papan prototipe yang berbasiskan Cyclone V SoC cukup mahal, tetapi anehnya, FPGA terpisah jauh lebih mahal.  Kemungkinan besar, harga papan prototyping dibuang untuk memikat pengembang untuk menggunakan data FPGA, dan papan dijual secara terpisah.  Seri ini harus mengambil chip individual.  Namun selain itu, ada juga yang "kedua".  Kedua, ketika saya bereksperimen dengan Cyclone V SoC, ternyata sistem prosesor ini tidak begitu dan produktif dalam hal akses tunggal ke port.  Batch - ya, ada pekerjaan yang cepat.  Dan dalam kasus akses tunggal pada frekuensi clock inti prosesor 925 MHz, Anda bisa mendapatkan akses ke port pada frekuensi beberapa megahertz.  Kepada semua orang, saya mengusulkan untuk memanggil fungsi standar memasukkan data dalam FIFO dari blok UART, yang memeriksa antrian yang meluap, tetapi memanggilnya ketika antrian itu jelas kosong, artinya, tidak ada yang mengganggu operasi.  Produktivitas saya meningkat dari satu juta menjadi lima ratus ribu panggilan per detik (tentu saja, bekerja dengan memori berjalan dengan kecepatan normal, semua cache disetel, bahkan varian fungsi yang tidak memeriksa FIFO untuk overflow bekerja lebih cepat, hanya fungsi yang sedang dibahas telah sangat beragam tulis dan baca dari porta).  Ini FIFO!  Bahkan, FIFO diciptakan untuk menjatuhkan data di sana dan lupakan!  Cepat berhenti!  Dan tidak dengan kinerja, kurang dari satu mega-operasi per detik pada frekuensi prosesor 925 MHz ... <br><br>  Latensi yang harus disalahkan.  Antara inti prosesor dan peralatan terletak dari tiga jembatan atau lebih.  Selain itu, kecepatan akses ke port tergantung pada konteks (beberapa catatan dalam satu baris akan berjalan dengan cepat, tetapi pembacaan pertama akan menghentikan proses sampai data yang di-cache sepenuhnya dibongkar, terlalu banyak catatan dalam satu baris juga akan melambat, karena buffer penulisan telah habis).  Akhirnya, memeriksa jejak yang terakumulasi dalam buffer debugging menunjukkan bahwa arsitektur <b>Cortex A</b> dapat mengeksekusi bagian yang sama untuk jumlah siklus clock yang berbeda karena sistem cache yang kompleks.  Singkatnya, melihat semua faktor ini (harga, penurunan kinerja ketika bekerja dengan peralatan, ketidakstabilan kecepatan akses ke peralatan, ketergantungan umum pada konteks), diputuskan untuk tidak meletakkan chip seperti itu di kompleks. <br><br>  Eksperimen dengan PSoC Cypress menunjukkan bahwa di sana inti <b>Cortex M</b> memberikan hasil yang lebih dapat diprediksi dan berulang, tetapi kapasitas logis dan frekuensi operasi maksimum dari pengontrol ini tidak sesuai dengan spesifikasi teknis, sehingga mereka juga dibuang. <br><br>  Diputuskan untuk menginstal FPGA Cyclone IV yang murah dan merekomendasikan penggunaan inti prosesor NIOS II yang disintesis.  Nah, dan jika perlu - untuk melakukan pengembangan menggunakan metode lain (mesin otomatis, logika keras, dll). <br><br><blockquote>  Saya akan menyebutkan secara terpisah (dan bahkan menyoroti paragraf ini) bahwa prosesor utama kompleks adalah x86 (x64).  Dialah yang merupakan pusat prosesor sistem.  Di sinilah logika utama kompleks dijalankan.  Sistem prosesor, yang akan dibahas di bawah, dirancang untuk sekadar menyediakan logika pengoperasian peralatan yang "di-flash" di FPGA.  Selain itu, peralatan ini hanya dijual jika pengembang tidak memiliki modul penuh waktu yang terhubung langsung ke prosesor pusat. </blockquote><br><br><h2>  Proses pengembangan dan debugging "firmware" </h2><br>  Jika kompleks Redd menjalankan Linux, ini tidak berarti bahwa pengembangan harus dilakukan dalam OS ini.  Redd adalah pelaksana jarak jauh, dan pengembangan harus dilakukan pada komputer Anda, apa pun OSnya.  Siapa pun yang memiliki Linux lebih mudah, tetapi siapa yang terbiasa dengan Windows (Saya dulu sangat tidak menyukai WIN 3.1, tetapi saya terpaksa bekerja, tetapi di suatu tempat pada saat WIN95 OSR2 saya terbiasa, dan sekarang tidak ada gunanya untuk menghadapinya, lebih mudah untuk menerimanya) , mereka dapat terus memimpin pengembangan di dalamnya. <br><br>  Karena pertemanan saya dengan Linux tidak berhasil, saya tidak akan memberikan petunjuk langkah demi langkah untuk mengatur lingkungan di bawahnya, tetapi saya akan membatasi diri pada kata-kata umum.  Siapa yang bekerja dengan OS ini akan cukup untuk itu, dan untuk yang lain ... Percayalah, lebih mudah untuk menghubungi administrator sistem.  Pada akhirnya, saya melakukan hal itu.  Namun demikian. <br><br>  Anda harus mengunduh dan menginstal Quartus Prime Programmer dan Tools dengan versi yang sama dengan lingkungan pengembangan Anda.  Jika versi tidak cocok, mungkin ada kejutan.  Saya menghabiskan sepanjang malam untuk memahami fakta ini.  Oleh karena itu, cukup unduh alat versi yang sama dengan lingkungan pengembangan. <br><br>  Setelah instalasi, masukkan direktori tempat program diinstal, subdirektori bin.  Secara umum, file yang paling penting adalah jtagconfig.  Jika Anda menjalankannya tanpa argumen (omong-omong, saya terus-menerus diminta untuk masuk ./jtagconfig dan hanya itu), maka daftar programmer yang tersedia dalam sistem dan FPGA yang terhubung dengannya akan ditampilkan.  Seharusnya ada USB Blaster.  Dan masalah pertama bahwa sistem muntah tidak cukup hak akses untuk bekerja dengan USB.  Cara mengatasinya tanpa menggunakan sudo dijelaskan di sini: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">radiotech.kz/threads/nastrojka-altera-usb-blaster-v-ubuntu-16-04.1244</a> <br><br>  Namun berikut adalah daftar perangkat yang ditampilkan.  Sekarang Anda harus menulis: <br><pre><code class="plaintext hljs">./jtagconfig --enableremote &lt;password&gt;</code> </pre> <br>  setelah itu server diluncurkan, dapat diakses dari mana saja dari jaringan. <br><br>  Semuanya akan baik-baik saja, tetapi sistem firewall tidak akan membiarkan siapa pun melihat server ini.  Pemeriksaan di Google menunjukkan bahwa untuk setiap jenis Linux (yang jumlahnya banyak), port di firewall terbuka dengan caranya sendiri, dan begitu banyak mantra yang harus dilemparkan sehingga saya lebih suka menghubungi admin. <br>  Perlu juga dipertimbangkan bahwa jika jtagd tidak terdaftar di autorun, maka ketika Anda membuka akses jarak jauh, Anda akan diberitahu bahwa tidak mungkin untuk mengatur kata sandi.  Untuk mencegah hal ini terjadi, jtagd harus dimulai bukan dengan jtagconfig itu sendiri, tetapi sebelum itu. <br><br>  Secara umum, perdukunan adalah perdukunan.  Biarkan saya memperbaiki tesis: <br><ul><li>  port masuk 1309 harus terbuka di sistem. Protokol apa, saya tidak sepenuhnya mengerti, untuk keandalan, Anda dapat membuka tcp dan udp; </li><li>  ketika memulai jtagconfig tanpa argumen, USB Blaster dan FPGA yang terhubung dengannya harus ditampilkan, dan bukan pesan kesalahan; </li><li>  Sebelum membuka pekerjaan jarak jauh, jtagd dengan hak yang memadai harus dijalankan.  Jika jtagd dengan hak yang tidak mencukupi telah diluncurkan, prosesnya harus diselesaikan sebelum awal yang baru, jika tidak, awal yang baru tidak akan terjadi; </li><li>  sebenarnya akses jarak jauh dibuka dengan saluran <pre> <code class="plaintext hljs">jtagconfig --enableremote &lt;password&gt;</code> </pre> </li></ul><br>  Tentu saja ada jalur serupa yang melewati antarmuka GUI, tetapi lebih logis untuk melakukan semuanya dalam batch.  Oleh karena itu, saya menjelaskan versi batch.  Ketika semua tesis ini telah selesai (dan administrator sistem telah menyelesaikannya), kami meluncurkan programmer di mesin kami, kami melihat pesan tentang kurangnya peralatan.  Klik Pengaturan Perangkat Keras: <br><img src="https://habrastorage.org/webt/cj/bq/jh/cjbqjhzydanq__godqnyhq8_ah8.png"><br><br>  Buka tab Pengaturan JTAG dan klik Tambah Server: <br><img src="https://habrastorage.org/webt/xn/36/8a/xn368ajq_d5kjx-nxyyvculmpus.png"><br><br>  Kami memasukkan alamat jaringan Redd (bagi saya itu adalah 192.168.1.100) dan kata sandi: <br><img src="https://habrastorage.org/webt/kd/ro/7y/kdro7ya9kr8od0uwvcv6hycn0eu.png"><br><br>  Kami memastikan bahwa koneksi berhasil. <br><br>  Saya menghabiskan tiga liburan Mei untuk mencapai ini, dan kemudian administrator memutuskan segalanya. <br><img src="https://habrastorage.org/webt/8h/gp/x0/8hgpx0r19klfwbp7fqd0atfesvq.png"><br><br>  Beralih ke tab Pengaturan Perangkat Keras, buka daftar turun bawah dan pilih pemrogram jarak jauh di sana: <br><img src="https://habrastorage.org/webt/-2/cf/te/-2cfteubqycs6lr1h8bniz92epi.png"><br><br>  Semuanya, sekarang bisa digunakan.  Tombol Mulai tidak terkunci. <br><img src="https://habrastorage.org/webt/a_/9m/t9/a_9mt9509lhs8muotyfcxh9wwtw.png"><br><br><h2>  "Firmware" pertama </h2><br>  Baiklah kalau begitu.  Agar artikel memiliki nilai praktis nyata, mari kita menganalisis "firmware" paling sederhana yang dibuat menggunakan metode di atas.  Hal paling sederhana yang benar-benar berhasil saya implementasikan untuk kompleks adalah tes chip SDRAM.  Berikut ini contoh dan praktiknya. <br><br>  Ada sejumlah core amatir untuk mendukung SDRAM, tetapi mereka semua ternyata agak rumit.  Dan akuntansi untuk semua trik adalah tenaga kerja.  Kami akan mencoba menggunakan solusi siap pakai yang dapat dimasukkan ke dalam sistem komputasi NIOS II, jadi kami akan menggunakan Core Pengontrol SDRAM standar.  Inti itu sendiri dijelaskan dalam dokumen <b>Embedded Peripherals IP User Guide</b> , dan banyak ruang dalam deskripsi dikhususkan untuk pergeseran jam untuk SDRAM relatif ke jam inti.  Perhitungan dan formula teoritis yang rumit diberikan, tetapi apa yang harus dilakukan tidak dilaporkan secara khusus.  Apa yang harus dilakukan dapat ditemukan dalam dokumen <b>Menggunakan SDRAM pada Papan DE0 Altera dengan Desain Verilog</b> .  Dalam proses analisis, saya akan menerapkan pengetahuan dari dokumen ini. <br><br>  Saya akan mengembangkan versi gratis dari Quartus Prime 17.0.  Saya fokus pada hal ini, karena selama pertemuan, mereka memberi tahu saya bahwa di masa depan, inti dari <b>Pengontrol SDRAM</b> akan dikeluarkan dari versi gratis.  Jika ini sudah terjadi di lingkungan pengembangan Anda, tidak ada yang mau mengunduh versi 17 gratis dan menginstalnya di mesin virtual.  Pekerjaan utama dilakukan di mana pun Anda terbiasa, dan firmware untuk Redd dengan SDRAM ada di versi ke-17.  Nah, itu jika Anda menggunakan opsi gratis.  Belum ada yang mengancam akan membuangnya dari yang sudah dibayar.  Tapi saya terganggu.  Buat proyek baru: <br><img src="https://habrastorage.org/webt/qv/sw/eq/qvsweqv-lktrkcs5keaxu8q_5se.png"><br><br>  Sebut saja SDRAM_DEMO.  Nama harus diingat: Saya akan melakukan pengembangan supercepat, sehingga sistem prosesor itu sendiri harus di tingkat atas, tanpa Verilog-layers.  Dan agar ini terjadi, nama sistem prosesor harus cocok dengan nama proyek.  Jadi ingatlah itu. <br><img src="https://habrastorage.org/webt/fv/yf/-p/fvyf-p3vwrjspjlvvd5tqdm2ndi.png"><br><br>  Setuju dengan nilai default dalam beberapa langkah, kita sampai pada pilihan kristal.  Kami memilih EP4CE10E22C7 yang digunakan di kompleks. <br><img src="https://habrastorage.org/webt/n6/du/8e/n6du8ejpw_xysdx7dui4f_rc2qi.png"><br><br>  Pada langkah berikutnya, karena kebiasaan, saya memilih pemodelan di ModelSim-Altera.  Hari ini kita tidak akan memodelkan apa pun, tetapi semuanya bisa berguna.  Lebih baik mengembangkan kebiasaan seperti itu dan mengikutinya: <br><img src="https://habrastorage.org/webt/ym/on/v2/ymonv28mmot9o4frulumjznujk8.png"><br><br>  Proyek ini dibuat.  Segera pergi ke penciptaan sistem prosesor (Tools-&gt; Platform Designer): <br><img src="https://habrastorage.org/webt/qv/tb/t8/qvtbt8vbulg78qybfcpdb1jqaja.png"><br><br>  Kami telah membuat sistem yang berisi modul jam dan reset: <br><img src="https://habrastorage.org/webt/xg/bz/o3/xgbzo3yoi-jrtmaiqhd_fz1vp_q.png"><br><br>  Tapi seperti yang sudah saya sebutkan, clocking khusus diperlukan untuk inti SDRAM.  Oleh karena itu, modul standar dibuang dengan kejam <br><img src="https://habrastorage.org/webt/2e/yv/_0/2eyv_0ufhrwtnap8vdyryftspus.png"><br><br>  Dan sebagai gantinya, tambahkan Program Universitas-&gt; Sistem dan Jam SDRAM untuk blok papan DE-series: <br><img src="https://habrastorage.org/webt/ho/tf/nd/hotfndwnreutxuoycv3rh-lhz_m.png"><br><br>  Di properti, pilih DE0-Nano, karena inspirasi untuk sirkuit switching SDRAM diambil dari papan tempat memotong roti ini: <br><img src="https://habrastorage.org/webt/lc/0f/tl/lc0ftl82cyh0yjpj4baklxmyddc.png"><br><br>  Kami mulai mengisi sistem prosesor kami.  Tentu saja, hal pertama yang ditambahkan adalah inti prosesor itu sendiri.  Biarlah Prosesor Dan Periferal-&gt; Prosesor Tertanam-&gt; Prosesor NIOS II. <br><img src="https://habrastorage.org/webt/28/sl/n4/28sln4t0khej0gnfh9v9honohu4.png"><br><br>  Baginya, kami belum mengisi properti apa pun.  Cukup klik Selesai, meskipun kami telah membentuk serangkaian pesan kesalahan.  Sejauh ini, tidak ada peralatan yang akan menghilangkan kesalahan ini. <br><br>  Sekarang tambahkan SDRAM yang sebenarnya.  Memory Interfaces and Controllers-&gt; SDRAM-&gt; SDRAM Controller. <br><img src="https://habrastorage.org/webt/ov/ro/fk/ovrofkityrsnw3vcttpjnwcwhzw.png"><br><br>  Di sini kita harus bertahan untuk mengisi properti.  Pilih sirkuit mikro terdekat di organisasi dari daftar dan klik Apppy.  Sifat-sifatnya jatuh ke dalam bidang Memory Profile: <br><img src="https://habrastorage.org/webt/de/hv/e_/dehve_t_smpdsm3ailji3mhf0u8.png"><br><br>  Sekarang kita mengubah lebar bus data menjadi 16, jumlah baris alamat menjadi 13, dan kolom menjadi 9. <br><img src="https://habrastorage.org/webt/2m/7h/0o/2m7h0otrg1pjp_jchcdmfa1uzvg.png"><br><br>  Saya belum memperbaiki waktu, mungkin di masa depan rekomendasi ini akan berubah. <br>  Sistem prosesor menyiratkan suatu program.  Program harus disimpan di suatu tempat.  Kami akan menguji chip SDRAM.  Saat ini, kami tidak bisa mempercayainya.  Karena itu, untuk menyimpan program, tambahkan memori berdasarkan blok RAM FPGA.  Fungsi Dasar-&gt; Memori On Chip-&gt; Memori On-Chip (RAM atau ROM): <br><img src="https://habrastorage.org/webt/ry/ot/-e/ryot-emahnalpamwnkyn1xwcihc.png"><br><br>  Volume ... Baiklah, biarlah 32 kilobyte. <br><img src="https://habrastorage.org/webt/mk/jc/gb/mkjcgbjb57ibhy0xeob8mg84nfo.png"><br><br>  Memori ini harus memuat dari suatu tempat.  Agar ini terjadi, centang kotak Aktifkan file inisialisasi non-default dan masukkan beberapa nama file yang bermakna.  Katakanlah firmware.hex: <br><img src="https://habrastorage.org/webt/bh/mf/7a/bhmf7ajkwxp8gixms4bgvy9cp08.png"><br><br>  Artikel ini sudah rumit, jadi kami tidak akan membebani secara berlebihan.  Kami hanya akan menampilkan hasil fisik dari tes dalam bentuk PASS / FAIL (dan kami akan melihat hasil logis dengan debug JTAG favorit saya).  Untuk melakukan ini, tambahkan port GPIO.  Prosesor dan Periferal-&gt; Periferal-&gt; PIO (Paralel IO): <br><img src="https://habrastorage.org/webt/_p/qn/tw/_pqntwmv-ivkyl3zkrwnxcb5wum.png"><br><br>  Dalam properti yang kita atur 2 bit, saya juga suka memberi centang pada kotak untuk kontrol individual dari bit.  Juga hanya kebiasaan. <br><img src="https://habrastorage.org/webt/a7/bk/j4/a7bkj4ophwwlkeog2laba81emds.png"><br><br>  Kami mendapat sistem seperti itu dengan banyak kesalahan: <br><img src="https://habrastorage.org/webt/w_/4p/o2/w_4po2omowqkf35ge_6-ygmdpl4.png"><br><br>  Kami mulai menghilangkannya.  Untuk memulainya, kita akan memecahkan jam dan mengatur ulang.  Pada jam dan unit reset, input harus dibuang.  Untuk melakukan ini, ada bidang yang mengatakan "Klik dua kali untuk mengekspor": <br><img src="https://habrastorage.org/webt/bw/gx/w1/bwgxw1cczmqvwzfy3iruazvzzn8.png"><br><br>  Kami mengklik, tetapi memberikan nama pendek lebih atau kurang. <br><img src="https://habrastorage.org/webt/be/xc/id/bexcidwci8wqdctpttm_uqnsgwo.png"><br><br>  Anda juga harus membuang output jam SDRAM: <br><img src="https://habrastorage.org/webt/bs/bp/6j/bsbp6j_uz7vlmsnpwvg17cbcqko.png"><br><br>  Sekarang kita membagi sys_clk ke semua input jam, dan reset_source ke semua baris reset.  Anda dapat dengan lembut menekan titik yang menghubungkan garis yang sesuai dengan "mouse", atau Anda dapat pergi ke pintu keluar yang sesuai, klik tombol kanan mouse, dan kemudian pergi ke submenu Connections di menu drop-down dan pilih koneksi di sana. <br><img src="https://habrastorage.org/webt/8t/2q/v4/8t2qv4btxo3ygqw6q3bjqa23hae.png"><br><br><img src="https://habrastorage.org/webt/ag/as/sz/agasszsc45aobhbaephagupfwja.png"><br><br>  Lalu kami menghubungkan ban bersama.  Kami menghubungkan Data Master ke semua bus dari semua perangkat, dan Master Inctruction - ke hampir semua.  Tidak perlu menghubungkannya ke bus PIO_0.  Dari sana, instruksi pasti tidak akan dibaca. <br><img src="https://habrastorage.org/webt/rb/fl/av/rbflavgwws5gsdpmtqrrqlp-v0s.png"><br><br>  Sekarang Anda dapat menyelesaikan konflik alamat.  Untuk melakukan ini, pilih item menu Sistem-&gt; Tetapkan Alamat Pangkalan: <br><img src="https://habrastorage.org/webt/ri/pk/te/ripkteta-ftnbrdgjtyj8cabtq8.png"><br><br>  Dan ketika kami mendapat alamat, kami juga dapat menetapkan vektor.  Untuk melakukan ini, buka properti dari inti prosesor (arahkan ke itu, tekan tombol kanan mouse dan pilih item menu Edit) dan konfigurasikan vektor pada Memori Onchip di sana.  Cukup pilih jenis memori ini di daftar drop-down, angkanya akan diganti sendiri. <br><img src="https://habrastorage.org/webt/aj/om/nn/ajomnnjye5kuskwbtquacdxqbkw.png"><br><br>  Tidak ada kesalahan yang tersisa.  Namun ada dua peringatan yang tersisa.  Saya lupa mengekspor jalur SDRAM dan PIO. <br><img src="https://habrastorage.org/webt/gn/ux/2m/gnux2mk6ikcgsuzin6xbpmyoiwe.png"><br><br>  Seperti yang telah kami lakukan untuk reset dan blok jam, klik dua kali pada kaki yang diperlukan dan beri mereka nama terpendek (tapi bisa dimengerti): <br><img src="https://habrastorage.org/webt/ea/bp/pq/eabppqnnarmd3fqbtytqbfoxteg.png"><br><br>  Semuanya, tidak ada lagi kesalahan atau peringatan.  Simpan sistem.  Selain itu, nama harus bertepatan dengan nama proyek, sehingga sistem prosesor menjadi elemen tingkat atas dalam proyek.  Belum lupa apa sebutannya? <br><img src="https://habrastorage.org/webt/hc/gh/7v/hcgh7vmhtfvsziy7idu7pdgbbuo.png"><br><br><img src="https://habrastorage.org/webt/3w/pl/rr/3wplrrqclfbkfquzndakoonrmdw.png"><br><br>  Kami menekan tombol yang paling penting - menghasilkan HDL. <br><img src="https://habrastorage.org/webt/1t/hm/im/1thmimhmf_xc3taykvi8ct1t6ae.png"><br><br>  Semuanya, bagian prosesor dibuat.  Klik Selesai.  Kami diingatkan bahwa akan senang menambahkan sistem prosesor ini ke proyek: <br><img src="https://habrastorage.org/webt/d1/cf/lv/d1cflvqskri1-jrh1ybgflbmglg.png"><br><br>  Tambahkan: <br><img src="https://habrastorage.org/webt/3n/yj/gl/3nyjglrcg5dxdngcghpufpgmot8.png"><br><br>  Dan di sana, menggunakan tombol Add, kita mencapai gambar berikut: <br><img src="https://habrastorage.org/webt/wm/jl/p8/wmjlp82jua7ilcvlosa65g98iqy.png"><br><br>  File SIP belum dibuat.  Ya, dan kami tidak membutuhkannya dalam kerangka artikel ini. <br><br>  Uhhhh  Langkah pertama telah diambil.  Kami menyusun proyek sehingga sistem mengetahui hierarki proyek dan kaki yang digunakan.  Kesalahan kompilasi tidak menakutkan.  Hanya di versi gratis dari lingkungan, kernel dibuat yang berfungsi hanya saat adaptor JTAG terhubung.  Tetapi di kompleks Redd, itu selalu terhubung, karena diceraikan di papan bersama, yaitu, kita tidak perlu takut.  Jadi kami mengabaikan kesalahan ini. <br><img src="https://habrastorage.org/webt/0b/hk/jo/0bhkjo904iqlqnjcpaf-iinssba.png"><br><br>  Sekarang kembali ke deskripsi kernel SDRAM.  Dikatakan bahwa jalur CKE tidak digunakan dan selalu terhubung ke unit.  Bahkan, dalam kerangka kompleks, kaki FPGA bukan hanya mahal, tetapi sumber daya berharga.  Dan bodoh untuk menyebarkan kaki, yang selalu ada di unit (dan di papan DE0-NANO juga tidak bercerai).  Akan ada Verilog-layer, rantai yang sesuai bisa terputus di sana, tapi saya menghemat waktu (tawa gugup, melihat volume dokumen yang sudah diperoleh, tetapi tanpa menyimpannya akan menjadi lebih banyak lagi).  Karena itu, tidak ada lapisan.  Bagaimana menjadi  Pergi ke Editor Penugasan.  Itu ada di dalamnya, karena di Pin Planner, dilihat dari deskripsi, tidak ada fungsi yang serupa. <br><img src="https://habrastorage.org/webt/wa/mn/li/wamnlimpfzqz8n4xguihx3jciwe.png"><br><br>  Masih belum ada garis.  Bagus  Buat yang baru <br><img src="https://habrastorage.org/webt/nd/hr/b_/ndhrb_1xgzvlhllnqj2zjrrq50i.png"><br><br>  Kami memilih ikon berikut: <br><img src="https://habrastorage.org/webt/_c/mg/o5/_cmgo53jkcsq4z4i5lzfdvn_s-a.png"><br><br>  Dalam sistem pencarian yang kami atur, klik Daftar dan dalam hasil pencarian kami menemukan CKE kami: <br><img src="https://habrastorage.org/webt/s2/r8/9t/s2r89tiymksz4ohpxv_6mudnqoy.png"><br><br>  Tambahkan ke kolom kanan, klik OK. <br><img src="https://habrastorage.org/webt/xv/fd/jy/xvfdjyxtnasndf8a_xara0wzpom.png"><br><br>  Kami mendapatkan daftar berikut: <br><img src="https://habrastorage.org/webt/g7/qn/-k/g7qn-kbokf172_5s4o0gvyjk2fk.png"><br><br>  Di bidang kuning, klik pada daftar drop-down dan temukan Pin Virtual.  Kami memilih.  Yellowness pindah ke sel lain: <br><img src="https://habrastorage.org/webt/x0/1h/4a/x01h4aaksdrgol8_wyoe3cnwaji.png"><br><br>  Di sana kami memilih On: <br><img src="https://habrastorage.org/webt/qw/5b/bl/qw5bblpjq2fswujalhmvlcgpew0.png"><br><br>  Semua kekuningan hilang.  Dan rantai sekarang ditandai sebagai virtual, yang artinya tidak memerlukan kaki fisik.  Karena itu, kami tidak dapat menetapkannya pada kesimpulan fisik FPGA.  Tutup Editor Penugasan, buka Perencana Pin.  Anda dapat menetapkan kaki, merujuk pada gambar, atau Anda dapat mengambil daftar dari file * .qsf, yang merupakan bagian dari proyek, yang akan saya lampirkan ke artikel. <br><br><img src="https://habrastorage.org/webt/wn/aj/kc/wnajkcjd97ko1cd7hmasi67ifq0.png"><br><br>  Itu dia, tutup Pin Planner, kami melakukan kompilasi akhir proyek.  Perangkat keras sudah siap, kami melanjutkan ke pengembangan perangkat lunak untuk sistem prosesor yang dihasilkan.  Tetapi artikel itu ternyata sangat besar sehingga kita akan melakukannya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">lain kali</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id452656/">https://habr.com/ru/post/id452656/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id452642/index.html">Kekuatan kerumunan. Bagaimana Chicago mengembangkan robot sampah - pembersih sungai</a></li>
<li><a href="../id452644/index.html">Konferensi Pengembang Web DevConf X - 21 Juni</a></li>
<li><a href="../id452646/index.html">Apa yang dilihat jaringan saraf di foto pertama sebuah lubang hitam</a></li>
<li><a href="../id452648/index.html">PHP: Cara mem-parsing file XML yang kompleks dan tidak tenggelam dalam kode asli</a></li>
<li><a href="../id452652/index.html">Security Week 21: lubang di Whatsapp, kerentanan baru dalam prosesor Intel, Zero-Day di Windows</a></li>
<li><a href="../id452662/index.html">Server HPE di Selectel</a></li>
<li><a href="../id452664/index.html">Saya menagih $ 18.000 untuk halaman web statis ... dan saya lolos begitu saja</a></li>
<li><a href="../id452666/index.html">Cara memungkinkan pembayaran mikro di aplikasi Anda</a></li>
<li><a href="../id452668/index.html">Cara memeriksa cookie untuk kepatuhan GDPR - alat terbuka baru akan membantu</a></li>
<li><a href="../id452670/index.html">Siapa insinyur data, dan bagaimana mereka menjadi?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>