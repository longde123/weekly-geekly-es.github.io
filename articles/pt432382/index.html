<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèΩ üïµÔ∏è üèéÔ∏è AI em Hase und Igel: minimax para tr√™s ‚òîÔ∏è üö£üèø üë©‚Äçüë©‚Äçüë¶‚Äçüë¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ap√≥s o verdadeiro boom de jogos de tabuleiro do final dos anos 2000, a fam√≠lia deixou v√°rias caixas com jogos. Um deles √© o jogo "Hare and Hedgehog" n...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>AI em Hase und Igel: minimax para tr√™s</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/432382/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/in/z2/ng/inz2ngydxteyo76jh1r9du9oxx8.jpeg"></div><br>  Ap√≥s o verdadeiro boom de jogos de tabuleiro do final dos anos 2000, a fam√≠lia deixou v√°rias caixas com jogos.  Um deles √© o jogo "Hare and Hedgehog" na vers√£o original em alem√£o.  Um jogo para v√°rios jogadores, no qual o elemento aleat√≥rio √© minimizado, e o c√°lculo s√≥brio e a capacidade do jogador de "olhar para frente" em v√°rios passos vencem. <br><br>  Minhas derrotas frequentes no jogo me levaram a escrever "intelig√™ncia" de computador para escolher a melhor jogada.  Intelig√™ncia, idealmente capaz de combater o grande mestre de Hare e Hedgehog (e o que, ch√°, n√£o xadrez, o jogo ser√° mais f√°cil).  O restante do artigo descreve o processo de desenvolvimento, a l√≥gica da IA ‚Äã‚Äãe um link para a fonte. <br><a name="habracut"></a><br><h1>  Regras do jogo Hare and Hedgehog </h1><br>  No campo de jogo de 65 c√©lulas, existem v√°rias fichas de jogador, de 2 a 6 participantes (meu desenho, n√£o can√¥nico, parece, √© claro, mais ou menos): <br><br><img src="https://habrastorage.org/webt/rf/8w/8x/rf8w8xapxkminuwc_r78qrwlr_c.png"><br><br>  Al√©m das c√©lulas com √≠ndices 0 (in√≠cio) e 64 (t√©rmino), apenas um jogador pode ser colocado em cada uma das c√©lulas.  O objetivo de cada jogador √© avan√ßar para a c√©lula de chegada, √† frente dos rivais. <br><br>  O "combust√≠vel" para avan√ßar √© a cenoura - a " <b>moeda</b> " do jogo.  No in√≠cio, cada jogador recebe 68 cenouras, que ele d√° (e √†s vezes recebe) enquanto se move. <br><br>  Al√©m das cenouras, no in√≠cio o jogador recebe 3 cartas de salada.  Salada √© um "artefato" especial do qual um jogador deve <b>se livrar</b> antes do final.  Livrar-se de alface (e isso s√≥ pode ser feito em uma gaiola especial de alface, assim: <br><img src="https://habrastorage.org/webt/yk/ie/c9/ykiec9ojz0bdaawaedp8yo2lsy4.png" align="left"><br>  ), o jogador, inclusive, recebe cenouras adicionais.  Antes disso, pule sua jogada.  Quanto mais jogadores na frente da salada deixarem o cart√£o, mais cenouras esse jogador receber√°: 10 x (posi√ß√£o do jogador no campo em rela√ß√£o a outros jogadores).  Ou seja, o jogador em p√© no segundo campo receber√° 20 cenouras, deixando a gaiola da salada. <br><br>  C√©lulas com n√∫meros 1 - 4 podem trazer v√°rias dezenas de cenouras se a posi√ß√£o do jogador coincidir com o n√∫mero na c√©lula (1 - 4, a c√©lula com n√∫mero 1 tamb√©m √© adequada para as 4¬™ e 6¬™ posi√ß√µes no campo), por analogia com a c√©lula de alface. <br><br>  O jogador pode pular a jogada, permanecendo na gaiola com a imagem de cenouras e receber ou dar 10 cenouras para esta a√ß√£o.  Por que um jogador deveria dar "combust√≠vel"?  O fato √© que um jogador pode terminar com apenas 10 cenouras ap√≥s o lance final (20 se voc√™ terminar em segundo, 30 se terminar em terceiro, etc.). <br><br>  Finalmente, o jogador pode obter 10 x N cenouras dando N passos no ouri√ßo <b>livre mais pr√≥ximo</b> (se o ouri√ßo mais pr√≥ximo estiver ocupado, tal movimento √© imposs√≠vel). <br><br>  O custo do avan√ßo √© calculado n√£o proporcionalmente ao n√∫mero de movimentos, de acordo com a f√≥rmula (com arredondamentos para cima): <br><br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.388ex" height="2.78ex" viewBox="0 -935.7 6194.9 1197.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMATHI-63" x="1781" y="0"></use><g transform="translate(2215,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMATHI-4E" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-2B" x="1110" y="0"></use><g transform="translate(2111,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMATHI-4E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-32" x="1292" y="513"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-32" x="5694" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> \ frac {N + N ^ 2} {2} </script>  , <br>  onde N √© o n√∫mero de etapas a seguir. <br><br>  Ent√£o, para avan√ßar uma c√©lula, o jogador d√° 1 cenoura, 3 cenouras para 2 c√©lulas, 6 cenouras para 3 c√©lulas, 10 para 4, ..., 210 cenouras para mover 20 c√©lulas para frente. <br><br>  A √∫ltima c√©lula - a c√©lula com a imagem de uma lebre - introduz um elemento aleat√≥rio no jogo.  Tendo ficado em uma jaula com uma lebre, o jogador tira uma carta especial da pilha, ap√≥s a qual alguma a√ß√£o √© realizada.  Dependendo da carta e da situa√ß√£o do jogo, o jogador pode perder algumas cenouras, obter cenouras extras ou pular um turno.  Vale ressaltar que entre as cartas com ‚Äúefeitos‚Äù existem v√°rios cen√°rios negativos para o jogador, o que incentiva o jogo a ser cuidadoso e calculado. <br><br><h2>  <font color="#3050ff">Implementa√ß√£o sem IA</font> </h2><br>  Na primeira implementa√ß√£o, que se tornar√° a base para o desenvolvimento do "intelecto" do jogo, me limitei √† op√ß√£o pela qual cada jogador faz um movimento - uma pessoa. <br><br>  Decidi implementar o jogo como cliente - um site est√°tico de uma p√°gina, cuja ‚Äúl√≥gica‚Äù √© implementada no JS e no servidor - o aplicativo da API WEB.  O servidor est√° escrito no .NET Core 2.1 e produz um artefato de montagem - um arquivo dll, que pode ser executado no Windows / Linux / Mac OS. <br><br>  A ‚Äúl√≥gica‚Äù da parte do cliente √© minimizada (assim como o UX, pois a GUI √© puramente utilit√°ria).  Por exemplo, o Web client n√£o realiza a verifica√ß√£o para verificar se as regras solicitadas pelo player s√£o aceit√°veis.  Essa verifica√ß√£o √© realizada no servidor.  O servidor informa ao cliente o que o jogador pode fazer a partir da posi√ß√£o atual do jogo. <br><br>  O servidor √© uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">m√°quina</a> cl√°ssica de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Moore</a> .  A l√≥gica do servidor n√£o possui conceitos como "cliente conectado", "sess√£o de jogo" etc. <br><br>  Tudo o que o servidor faz √© processar o comando recebido (HTTP POST).  O <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">padr√£o de "comando" √©</a> implementado no servidor.  O cliente pode solicitar a execu√ß√£o de um dos seguintes comandos: <br><br><ul><li>  iniciar um novo jogo, ou seja,  "Coloque" fichas do n√∫mero especificado de jogadores em um tabuleiro "limpo" </li><li>  fa√ßa o movimento indicado no comando </li></ul><br>  Para a segunda equipe, o cliente envia ao servidor a posi√ß√£o atual do jogo (objeto da classe Disposition), ou seja, uma descri√ß√£o da seguinte forma: <br><br><ul><li>  posi√ß√£o, n√∫mero de cenouras e alface para cada lebre, al√©m de um campo booleano adicional indicando que a lebre est√° perdendo sua vez </li><li>  √≠ndice da lebre fazendo a jogada. </li></ul><br>  O servidor n√£o precisa enviar informa√ß√µes adicionais - por exemplo, informa√ß√µes sobre o campo de jogo.  Assim como para gravar um desenho de xadrez, n√£o √© necess√°rio pintar o arranjo de c√©lulas em preto e branco no quadro - essas informa√ß√µes s√£o consideradas constantes. <br><br>  Em resposta, o servidor indica se o comando foi conclu√≠do com √™xito.  Tecnicamente, um cliente pode, por exemplo, solicitar uma movimenta√ß√£o inv√°lida.  Ou tente criar um novo jogo para um √∫nico participante, o que obviamente n√£o faz sentido. <br><br>  Se a equipe for bem-sucedida, a resposta conter√° uma nova <b>posi√ß√£o no</b> jogo, bem como uma lista de jogadas que podem ser feitas pelo pr√≥ximo jogador na fila (atual para a nova posi√ß√£o). <br><br>  Al√©m disso, a resposta do servidor cont√©m alguns campos de servi√ßo.  Por exemplo, o texto de uma carta de uma lebre √© "puxado" por um jogador em uma etapa na gaiola correspondente. <br><br><h4>  Turno do jogador </h4><br>  A vez do jogador √© codificada como um n√∫mero inteiro: <br><br><ol><li>  0, se o jogador for for√ßado a permanecer na c√©lula atual, <br>  1, 2, ... N para 1, ... N d√° um passo √† frente, </li><li>  -1, -2, ... -M para mover as c√©lulas 1 ... M de volta para o ouri√ßo livre mais pr√≥ximo, </li><li>  1001, 1002 - c√≥digos especiais para o jogador que decidiu ficar na c√©lula de cenoura e receber (1001) ou dar (1002) 10 cenouras para isso. </li></ol><br><h3>  Implementa√ß√£o de software </h3><br>  O servidor recebe o JSON do comando solicitado, o analisa em uma das classes de solicita√ß√£o correspondentes e executa a a√ß√£o solicitada. <br><br>  Se o cliente (jogador) solicitou uma mudan√ßa com o c√≥digo CMD da posi√ß√£o (POS) transferida para a equipe, o servidor executou as seguintes a√ß√µes: <br><br><ul><li>  verifica se tal movimento √© poss√≠vel </li><li>  cria uma nova posi√ß√£o a partir da atual, aplicando as modifica√ß√µes correspondentes, <br>  recebe muitos movimentos poss√≠veis para uma nova posi√ß√£o.  Deixe-me lembr√°-lo de que o √≠ndice do jogador que est√° fazendo a jogada j√° est√° inclu√≠do no objeto que descreve a <abbr title="Estado espec√≠fico, alinhamento de for√ßas, 'instant√¢neo' do jogo">posi√ß√£o</abbr> , </li><li>  retorna ao cliente uma resposta com uma nova posi√ß√£o, poss√≠veis movimentos ou o sinalizador de sucesso igual a falso e uma descri√ß√£o do erro. </li></ul><br>  A l√≥gica de verificar a admissibilidade do movimento solicitado (CMD) e construir uma nova posi√ß√£o acabou por estar um pouco mais pr√≥xima do que gostar√≠amos.  Com essa l√≥gica, o m√©todo de encontrar movimentos aceit√°veis ‚Äã‚Äãtem algo em comum.  Toda essa funcionalidade √© implementada pela classe TurnChecker. <br><br>  Na entrada dos m√©todos de verifica√ß√£o / execu√ß√£o, o TurnChecker recebe um objeto da classe da posi√ß√£o do jogo (Disposi√ß√£o).  O objeto Disposition cont√©m uma matriz com dados do jogador (Haze [] haze), o √≠ndice do jogador que faz a jogada + algumas informa√ß√µes de servi√ßo preenchidas durante a opera√ß√£o do objeto TurnChecker. <br><br>  O campo de jogo descreve a classe FieldMap, que √© implementada como um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">singleton</a> .  A classe cont√©m uma matriz de c√©lulas + algumas informa√ß√µes gerais usadas para simplificar / acelerar os c√°lculos subseq√ºentes. <br><br><div class="spoiler">  <b class="spoiler_title">Considera√ß√µes de desempenho</b> <div class="spoiler_text">  Na implementa√ß√£o da classe TurnChecker, tentei evitar loops o m√°ximo poss√≠vel.  O fato √© que os m√©todos para obter o conjunto de movimentos permitidos / execu√ß√£o de um movimento ser√£o posteriormente chamados milhares (dezenas de milhares) de vezes durante o procedimento de busca de um movimento quase ideal. <br><br>  Assim, por exemplo, calculo quantas c√©lulas um jogador pode avan√ßar com N cenouras, usando a f√≥rmula: <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)Math.Pow(<span class="hljs-number"><span class="hljs-number">8</span></span> * N + <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>) - <span class="hljs-number"><span class="hljs-number">1</span></span>) / <span class="hljs-number"><span class="hljs-number">2</span></span>;</code> </pre> <br>  Verificando se a c√©lula i est√° ocupada por um dos jogadores, n√£o analiso a lista de jogadores (j√° que essa a√ß√£o provavelmente ter√° que ser executada v√°rias vezes), mas <i>recorro</i> o dicion√°rio do formul√°rio preenchido antecipadamente com o formul√°rio <i>[cell_index, busy_cage_ flag]</i> . <br><br>  Ao verificar se a c√©lula de ouri√ßo especificada √© a mais pr√≥xima (atr√°s) da c√©lula atual ocupada pelo jogador, tamb√©m comparo a posi√ß√£o solicitada com um valor de um dicion√°rio do formato <i>[cell_index, closest_back_dezh] _index]</i> - informa√ß√µes est√°ticas. <br></div></div><br><h2>  <font color="#3050ff">Implementa√ß√£o com IA</font> </h2><br>  Um comando √© adicionado √† lista de comandos processados ‚Äã‚Äãpelo servidor: execute uma movimenta√ß√£o quase ideal selecionada pelo programa.  Essa equipe √© uma pequena modifica√ß√£o do comando "movimento do jogador", do qual, de fato, o campo de movimento ( <abbr title="O c√≥digo num√©rico do comando, por exemplo, 4 para mover 4 c√©lulas para a frente, 0 para esperar, 1002 - d√™ 10 cenouras ...">CMD</abbr> ) foi removido. <br><br>  A primeira decis√£o que vem √† mente √© usar heur√≠sticas para selecionar a melhor op√ß√£o poss√≠vel.  Por analogia com o xadrez, podemos avaliar cada uma das posi√ß√µes de jogo obtidas com a nossa jogada, definindo algum tipo de classifica√ß√£o para essa posi√ß√£o. <br><br><h3>  Avalia√ß√£o da posi√ß√£o heur√≠stica </h3><br>  Por exemplo, no xadrez, fazer uma avalia√ß√£o (sem se arrastar para a selva das aberturas) √© bastante simples: no m√≠nimo, voc√™ pode calcular o "custo" total das pe√ßas, levando o valor do cavaleiro / bispo para 3 pe√µes, o valor de uma torre para 5 pe√µes, a rainha para 9 e o rei para <i>int</i> Pe√µes <i>.MaxValue</i> .  √â f√°cil melhorar a estimativa, por exemplo, adicionando-a (com um fator de corre√ß√£o - fator / expoente ou outra fun√ß√£o): <br><br><ul><li>  o n√∫mero de movimentos poss√≠veis da posi√ß√£o atual, </li><li>  propor√ß√£o de amea√ßas para figuras inimigas / amea√ßas do inimigo. </li></ul><br>  √â feita uma avalia√ß√£o especial da posi√ß√£o do tapete: <i>int.MaxValue</i> , se o xeque-mate colocar o computador, <i>int.MinValue</i> se o xeque-mate colocar a pessoa. <br><br>  Se voc√™ solicitar que o processador de xadrez escolha a pr√≥xima jogada, guiado apenas por essa avalia√ß√£o, o processador provavelmente escolher√° n√£o as piores.  Em particular: <br><br><ul><li>  N√£o perca a oportunidade de pegar um peda√ßo maior ou xeque-mate, </li><li>  provavelmente, ele n√£o conduzir√° os n√∫meros pelos cantos, </li><li>  Ele n√£o coloca o n√∫mero sob ataque novamente (dado o n√∫mero de amea√ßas na avalia√ß√£o). </li></ul><br>  Naturalmente, tais movimentos do computador n√£o lhe dar√£o uma chance de sucesso com um oponente que faz seus movimentos no menor sentido.  O computador ignorar√° qualquer um dos plugues.  Al√©m disso, ele provavelmente n√£o hesita em trocar a rainha por um pe√£o. <br><br>  No entanto, o algoritmo para avalia√ß√£o heur√≠stica da atual posi√ß√£o de jogo no xadrez (sem reivindicar os louros do programa campe√£o) √© bastante transparente.  Voc√™ n√£o pode dizer sobre o jogo Hare and Hedgehog. <br><br>  No caso geral, no jogo Hare e Hedgehog, uma m√°xima um tanto emba√ßada funciona: ‚Äú <b><i>√© melhor ir al√©m com mais cenouras e menos alface</i></b> ‚Äù.  No entanto, nem tudo √© t√£o simples.  Digamos, se um jogador tiver 1 carta de salada no meio do jogo, essa op√ß√£o pode ser bastante boa.  Mas o jogador que est√° na linha de chegada com uma carta de salada obviamente estar√° em uma situa√ß√£o perdida.  Al√©m do algoritmo de avalia√ß√£o, eu tamb√©m gostaria de "dar uma espiada" um passo al√©m, assim como as amea√ßas √†s pe√ßas podem ser contadas em uma avalia√ß√£o heur√≠stica de uma posi√ß√£o no xadrez.  Por exemplo, vale a pena considerar o b√¥nus de cenoura recebido por um jogador que sai da c√©lula de alface / c√©lula de posi√ß√£o (1 ... 4), levando em considera√ß√£o o n√∫mero de jogadores √† frente. <br><br>  Deduzi a nota final como uma fun√ß√£o: <br><br>  <abbr title="E (estimativa), nota final">E</abbr> = Ks * S + Kc * C + Kp * P, <br><br>  onde S, C, P s√£o notas calculadas usando cart√µes de salada (S) e cenouras ¬© nas m√£os do jogador, P s√£o as notas dadas ao jogador pela dist√¢ncia percorrida. <br><br>  Ks, Kc, Kp s√£o os fatores de corre√ß√£o correspondentes (ser√£o discutidos mais adiante). <br><br>  A maneira mais f√°cil √© determinar a marca <b>do caminho percorrido</b> : <br>  P = i * 3, onde i √© o √≠ndice da c√©lula na qual o player est√° localizado. <br><br>  A classifica√ß√£o C (cenoura) j√° √© mais dif√≠cil. <br><br>  Para obter um valor C espec√≠fico, escolho uma das 3 fun√ß√µes <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.216ex" height="2.419ex" viewBox="0 -780.1 4398.6 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-30" x="1011" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-2C" x="1169" y="0"></use><g transform="translate(1614,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-31" x="1011" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-2C" x="2783" y="0"></use><g transform="translate(3229,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-32" x="1011" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-2"> C_0, C_1, C_2 </script>  de um argumento (o n√∫mero de cenouras nas m√£os).  O √≠ndice da fun√ß√£o C ([0, 1, 2]) √© determinado pela posi√ß√£o relativa do jogador no campo de jogo: <br><br><ul><li>  [0] se o jogador tiver completado menos da metade do campo de jogo, </li><li>  [2] se um jogador tiver cenouras suficientes (mb, at√© abundantes) para terminar, </li><li>  [1] em outros casos. </li></ul><br><img src="https://habrastorage.org/webt/fo/cv/hr/focvhrlzpl_xuxxd8dmuw9atok8.png"><br><br>  As fun√ß√µes 0 e 1 s√£o semelhantes: o "valor" de cada cenoura nas m√£os do jogador diminui gradualmente com o aumento do n√∫mero de cenouras nas m√£os.  O jogo raramente incentiva os Plyushkins.  No caso 1 (metade do campo passou), o valor das cenouras diminui um pouco mais r√°pido. <br><br>  A fun√ß√£o 2 (o jogador pode terminar), pelo contr√°rio, imp√µe uma multa grande (valor do coeficiente negativo) a cada cenoura nas m√£os do jogador - quanto mais cenouras, maior o coeficiente de penalidade.  Como com um excesso de cenouras, o acabamento √© proibido pelas regras do jogo. <br><br>  Antes de calcular a quantidade de cenouras nas m√£os do jogador, √© especificado levando em considera√ß√£o as cenouras por movimento da c√©lula de alface / c√©lula n√∫mero 1 ... 4. <br><br>  Uma classe de ‚Äú <b>alface</b> ‚Äù S √© deduzida de maneira semelhante.  Dependendo da quantidade de salada nas m√£os do jogador (0 ... 3), uma fun√ß√£o √© selecionada <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.505ex" height="2.419ex" viewBox="0 -780.1 4092.6 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-30" x="867" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-2C" x="1067" y="0"></use><g transform="translate(1512,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-31" x="867" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-2C" x="2579" y="0"></use><g transform="translate(3025,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-32" x="867" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-3"> S_0, S_1, S_2 </script>  ou <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.479ex" height="2.419ex" viewBox="0 -780.1 1067.4 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-33" x="867" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> S_3 </script>  .  Argumento de fun√ß√£o <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.799ex" height="2.419ex" viewBox="0 -780.1 3357.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-30" x="867" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-2212" x="1289" y="0"></use><g transform="translate(2290,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-33" x="867" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-5"> S_0 - S_3 </script>  .  - novamente, o caminho "relativo" percorrido pelo jogador.  Ou seja, o n√∫mero de c√©lulas com salada restante na frente (em rela√ß√£o √† c√©lula ocupada pelo jogador): <br><br><img src="https://habrastorage.org/webt/91/as/ra/91asraqadihe0n0dgtruyw1efuc.png"><br><br>  A curva <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.479ex" height="2.419ex" viewBox="0 -780.1 1067.4 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-30" x="867" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> S_0 </script>  - fun√ß√£o de avalia√ß√£o (S) do n√∫mero de c√©lulas de alface na frente do jogador (0 ... 5), para um jogador com 0 cartas de alface na m√£o, <br>  a curva <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.479ex" height="2.298ex" viewBox="0 -780.1 1067.4 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-31" x="867" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> S_1 </script>  - a mesma fun√ß√£o para um jogador com uma carta de salada na m√£o, etc. <br><br>  A classifica√ß√£o final (E = Ks * S + Kc * C + Kp * P) leva em considera√ß√£o: <br><br><ul><li>  a quantidade extra de cenouras que o jogador receber√° imediatamente antes de sua pr√≥pria jogada, </li><li>  o caminho do jogador </li><li>  a quantidade de cenoura e alface nas m√£os que afetam n√£o linearmente a pontua√ß√£o. </li></ul><br>  E aqui est√° como um computador √© executado, escolhendo a pr√≥xima jogada com a pontua√ß√£o heur√≠stica m√°xima: <br><br><img src="https://habrastorage.org/webt/nz/ze/4g/nzze4g5o3vbfug20cspijmdmnlg.gif"><br><br>  Em princ√≠pio, a estr√©ia n√£o √© t√£o ruim.  No entanto, n√£o se deve esperar um bom jogo dessa IA: no meio do jogo, o ‚Äúrob√¥‚Äù verde come√ßa a fazer movimentos repetidos e, no final, faz v√°rias itera√ß√µes de movimentos para a frente - para tr√°s para o ouri√ßo, at√© que finalmente termine.  Em parte devido ao acaso, ele terminar√° atr√°s do jogador - uma pessoa por uma d√∫zia de jogadas. <br><br><div class="spoiler">  <b class="spoiler_title">Notas de implementa√ß√£o</b> <div class="spoiler_text">  O c√°lculo da avalia√ß√£o √© gerenciado por uma classe especial - EstimationCalculator.  As fun√ß√µes para avaliar a posi√ß√£o em rela√ß√£o aos cart√µes de salada de cenoura s√£o carregadas em matrizes no construtor <b>est√°tico</b> da classe da calculadora.  Na entrada, o m√©todo de estimativa de posi√ß√£o recebe o pr√≥prio objeto de posi√ß√£o e o √≠ndice do jogador, do "ponto de vista" do qual a posi√ß√£o √© avaliada pelo algoritmo.  Ou seja, a mesma posi√ß√£o do jogo pode receber v√°rias classifica√ß√µes diferentes, dependendo de qual jogador os pontos virtuais s√£o considerados. <br></div></div><br><h2>  <font color="#3050ff">√Årvore de Decis√£o e Algoritmo Minimax</font> </h2><br>  Usamos o algoritmo de tomada de decis√£o no jogo antag√¥nico Minimax.  Muito bom, na minha opini√£o, o algoritmo √© descrito <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">neste post (tradu√ß√£o)</a> . <br><br>  Ensinamos o programa a "olhar" alguns passos √† frente.  Suponha que, a partir da posi√ß√£o atual (e o plano de fundo n√£o seja importante para o algoritmo - como lembramos, o programa funciona como <abbr title="O algoritmo n√£o possui 'estado interno'">um aut√¥mato de Moore</abbr> ), numerado pelo n√∫mero 1, o programa pode fazer dois movimentos.  Temos duas posi√ß√µes poss√≠veis, 2 e 3. A seguir vem a vez do jogador - a pessoa (no caso geral - o inimigo).  A partir da 2¬™ posi√ß√£o, o oponente tem 3 jogadas, da terceira - apenas duas jogadas.  A seguir, a vez de fazer um movimento novamente recai no programa, que, no total, pode fazer 10 movimentos em 5 posi√ß√µes poss√≠veis: <br><br><img src="https://habrastorage.org/webt/j8/1p/yf/j81pyfcci31ot27y3xgfafiuqc4.gif"><br><br>  Suponha que, ap√≥s o segundo movimento do computador, o jogo termine e cada uma das posi√ß√µes recebidas seja avaliada do ponto de vista do primeiro e do segundo jogadores.  E j√° implementamos o algoritmo de avalia√ß√£o.  Vamos avaliar cada uma das posi√ß√µes finais (folhas da √°rvore 9 ... 18) na forma de um vetor <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.691ex" height="2.66ex" viewBox="0 -832 2881 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-5B" x="0" y="0"></use><g transform="translate(278,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-30" x="686" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-2C" x="1217" y="0"></use><g transform="translate(1663,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-31" x="686" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-5D" x="2602" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> [v_0, v_1] </script>  , <br>  onde <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.182ex" height="1.817ex" viewBox="0 -520.7 939.4 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-30" x="686" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9"> v_0 </script>  - pontua√ß√£o calculada para o primeiro jogador, <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.182ex" height="1.696ex" viewBox="0 -520.7 939.4 730.2" role="img" focusable="false" style="vertical-align: -0.487ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-31" x="686" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-10"> v_1 </script>  - pontua√ß√£o do segundo jogador: <br><br><img src="https://habrastorage.org/webt/xk/g5/yw/xkg5ywgzotdosiz4e4soubsrava.png"><br><br>  Como o computador faz a √∫ltima jogada, obviamente escolher√° as op√ß√µes em cada uma das sub√°rvores ([9, 10], [11], [12, 13], [14, 15, 16], [17, 18]) o que lhe d√° uma classifica√ß√£o melhor.  A quest√£o imediatamente se coloca: por qual princ√≠pio se deve escolher a melhor posi√ß√£o? <br><br>  Por exemplo, existem dois movimentos, ap√≥s os quais temos posi√ß√µes com classifica√ß√µes [5;  5] e [2;  1]  Avalia o primeiro jogador.  Duas alternativas s√£o √≥bvias: <br><br><ul><li>  sele√ß√£o de posi√ß√£o com o valor <b>absoluto</b> m√°ximo da i-√©sima pontua√ß√£o para o i-√©simo jogador.  Em outras palavras, o nobre piloto Leslie, ansioso pela vit√≥ria, sem considerar os concorrentes.  Nesse caso, uma posi√ß√£o com uma estimativa de [5;  5] </li><li>  a escolha de uma posi√ß√£o com a classifica√ß√£o m√°xima em <b>rela√ß√£o √†s estimativas dos concorrentes</b> √© o esperto professor Faith, que n√£o perde a oportunidade de infligir truques sujos ao inimigo.  Por exemplo, fique intencionalmente atr√°s de um jogador que planeja come√ßar da segunda posi√ß√£o.  Um item com classifica√ß√£o [2;  1] </li></ul><br>  Na minha implementa√ß√£o de software, criei o algoritmo de sele√ß√£o de notas (uma fun√ß√£o que mapeia o vetor de notas para um valor escalar para o i-√©simo jogador) um par√¢metro personalizado.  Outros testes mostraram, para minha surpresa, a superioridade da primeira estrat√©gia - a escolha da posi√ß√£o pelo valor absoluto m√°ximo <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.927ex" height="1.817ex" viewBox="0 -520.7 829.8 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMATHI-69" x="686" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-11"> v_i </script>  . <br><br><div class="spoiler">  <b class="spoiler_title">Recursos de implementa√ß√£o de software</b> <div class="spoiler_text">  Se a primeira op√ß√£o para escolher a melhor nota for especificada nas configura√ß√µes da AI (classe TurnMaker), o c√≥digo do m√©todo correspondente assumir√° a forma: <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ContractEstimateByAbsMax</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] estimationVector, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> playerIndex</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> estimationVector[playerIndex]; }</code> </pre><br>  O segundo m√©todo - o m√°ximo em rela√ß√£o √†s posi√ß√µes dos concorrentes - √© implementado um pouco mais complicado: <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ContractEstimateByRelativeNumber</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">[]eVector, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> player</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>? min = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pVal = eVector[player]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; eVector.Length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i == player) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> val = pVal - eVector[i]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!min.HasValue || min.Value &gt; val) min = val; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> min.Value; }</code> </pre><br></div></div><br>  As estimativas selecionadas (sublinhadas na figura) s√£o transferidas para o n√≠vel superior.  Agora o inimigo precisa escolher uma posi√ß√£o, sabendo qual posi√ß√£o subsequente o algoritmo escolher√°: <br><br><img src="https://habrastorage.org/webt/hf/pr/ox/hfproxjzdo7-_7ll2f90na7p5ky.png"><br><br>  O advers√°rio, obviamente, escolher√° a posi√ß√£o com a melhor classifica√ß√£o para si (aquela em que a <b>segunda coordenada do</b> vetor tiver o maior valor).  Essas estimativas est√£o novamente sublinhadas no gr√°fico. <br><br>  Finalmente, voltamos ao primeiro passo.  O computador seleciona e ele prefere a movimenta√ß√£o com a maior primeira coordenada do vetor: <br><br><img src="https://habrastorage.org/webt/dr/f1/y-/drf1y-8s_h-orz173pj8fx2tam0.png"><br><br>  Assim, o problema est√° resolvido - um movimento quase √≥timo √© encontrado.  Suponha que uma pontua√ß√£o heur√≠stica de 100% nas posi√ß√µes das folhas em uma √°rvore indique um futuro vencedor.  Ent√£o, nosso algoritmo escolher√° inequivocamente a melhor jogada poss√≠vel. <br><br>  No entanto, a pontua√ß√£o heur√≠stica √© 100% precisa somente quando a posi√ß√£o <b>final</b> do jogo √© avaliada - um (ou v√°rios) jogadores terminaram, o vencedor √© determinado.  Portanto, tendo a oportunidade de olhar para frente com N movimentos - o suficiente para vencer rivais com for√ßa igual, voc√™ pode escolher o movimento ideal. <br><br>  Mas um jogo t√≠pico para 2 jogadores dura em m√©dia cerca de 30 a 40 movimentos (para tr√™s jogadores - cerca de 60 movimentos, etc.).  De cada posi√ß√£o, um jogador geralmente pode fazer cerca de 8 movimentos.  Consequentemente, uma √°rvore completa de posi√ß√µes poss√≠veis para 30 movimentos consistir√° em aproximadamente <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.039ex" height="2.419ex" viewBox="0 -935.7 1308.3 1041.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-38" x="0" y="0"></use><g transform="translate(500,393)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-33"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-30" x="500" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-12"> 8 ^ {30} </script>  = 1237940039285380274899124224 picos! <br><br>  Na pr√°tica, construir e "analisar" uma √°rvore de aproximadamente 100.000 posi√ß√µes no meu PC leva cerca de 300 milissegundos.  O que nos d√° um limite na profundidade da √°rvore em 7 a 8 n√≠veis (movimentos), se queremos esperar uma resposta do computador n√£o mais que um segundo. <br><br><div class="spoiler">  <b class="spoiler_title">Recursos de implementa√ß√£o de software</b> <div class="spoiler_text">  Obviamente, √© necess√°rio um m√©todo recursivo para construir uma √°rvore de posi√ß√µes e encontrar a melhor jogada.  Na entrada do m√©todo - a posi√ß√£o atual (na qual, como lembramos, o jogador j√° est√° fazendo um movimento) e o n√≠vel atual da √°rvore (n√∫mero do movimento).  Assim que descermos ao n√≠vel m√°ximo permitido pelas configura√ß√µes do algoritmo, a fun√ß√£o retornar√° um vetor de estimativa de posi√ß√£o heur√≠stica do "ponto de vista" de cada um dos jogadores. <br><br>  <b><font color="#ff0000">Uma adi√ß√£o importante</font></b> : a descida abaixo da √°rvore tamb√©m deve ser interrompida quando o jogador atual terminar.  Caso contr√°rio (se o algoritmo para selecionar a melhor posi√ß√£o em rela√ß√£o √†s posi√ß√µes de outros jogadores for selecionado), o programa poder√° "pisar" no final por um longo tempo, "zombando" do oponente.  Al√©m disso, dessa forma, reduziremos um pouco o tamanho da √°rvore no final do jogo. <br><br>  Se ainda n√£o estamos no n√≠vel final de recurs√£o, selecionamos os movimentos poss√≠veis, criamos uma nova posi√ß√£o para cada movimento e passamos para a chamada recursiva do m√©todo atual. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Por que o Minimax?</b> <div class="spoiler_text">  Na interpreta√ß√£o original dos jogadores s√£o sempre dois.  O programa calcula a pontua√ß√£o exclusivamente a partir da posi√ß√£o do primeiro jogador.  Assim, ao escolher a melhor posi√ß√£o, o jogador com o √≠ndice 0 procura uma posi√ß√£o com uma classifica√ß√£o m√°xima, o jogador com o √≠ndice 1 procura um m√≠nimo. <br><br>  No nosso caso, a classifica√ß√£o deve ser um vetor para que cada um dos N jogadores possa avali√°-la do seu "ponto de vista", √† medida que a classifica√ß√£o sobe na √°rvore. <br></div></div><br><h2>  <font color="#3050ff">Tuning AI</font> </h2><br>  Minha pr√°tica de jogar contra o computador mostrou que o algoritmo n√£o √© t√£o ruim, mas ainda inferior aos humanos.  Decidi melhorar a IA de duas maneiras: <br><br><ul><li>  otimizar a constru√ß√£o / travessia da √°rvore de decis√£o, </li><li>  melhorar heur√≠sticas. </li></ul><br><h3>  Otimiza√ß√£o do algoritmo Minimax </h3><br>  No exemplo acima, poder√≠amos nos recusar a considerar a posi√ß√£o 8 e "salvar" 2 - 3 v√©rtices da √°rvore: <br><br><img src="https://habrastorage.org/webt/-h/ce/hb/-hcehbcs1t-bcynqfe7j_cmnjp4.png"><br><br>  Andamos em torno da √°rvore de cima para baixo, da esquerda para a direita.  Ignorando a sub√°rvore come√ßando na posi√ß√£o 2, deduzimos a melhor estimativa para o movimento 1 -&gt; 2: [3, 2].  Ignorando a sub√°rvore com a raiz na posi√ß√£o 7, determinamos a classifica√ß√£o atual (melhor para o movimento 3 -&gt; 7): [2, 4].  Do ponto de vista do computador (primeiro jogador), a pontua√ß√£o [2, 4] √© pior que a pontua√ß√£o [3, 2].  E como o oponente do computador escolhe a jogada da posi√ß√£o 3, qualquer que seja a pontua√ß√£o da posi√ß√£o 8, a pontua√ß√£o final da posi√ß√£o 3 ser√° a priori pior que a pontua√ß√£o obtida na terceira posi√ß√£o.  Por conseguinte, a sub√°rvore com a raiz na posi√ß√£o 8 n√£o pode ser constru√≠da e n√£o avaliada. <br><br>  A vers√£o otimizada do algoritmo Minimax, que permite cortar o excesso de sub√°rvores, √© chamada de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">algoritmo de recorte alfa-beta</a> .  A implementa√ß√£o desse algoritmo exigir√° pequenas modifica√ß√µes no c√≥digo-fonte. <br><br><div class="spoiler">  <b class="spoiler_title">Recursos de implementa√ß√£o de software</b> <div class="spoiler_text">  Al√©m disso, dois par√¢metros inteiros s√£o passados ‚Äã‚Äãpara o m√©todo CalcEstimate da classe TurnMaker - alfa, que √© igual a int.MinValue inicialmente e beta, que √© int.MaxValue.  Al√©m disso, depois de receber uma estimativa da movimenta√ß√£o atual em considera√ß√£o, um pseudoc√≥digo do formul√°rio √© executado: <br><br><pre> <code class="1c hljs"> e = _[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-comment"><span class="hljs-comment">//        (  )  (e &gt; alpha) alpha = e   (e &lt; beta) beta = e  (beta &lt;= alpha)    </span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Uma caracter√≠stica importante da implementa√ß√£o de software</b> <div class="spoiler_text">  o m√©todo de recorte alfa-beta, por defini√ß√£o, leva √† mesma solu√ß√£o que o algoritmo Minimax "limpo".  Para verificar se a l√≥gica da tomada de decis√£o mudou (ou melhor, os resultados s√£o jogadas), escrevi um teste de unidade no qual o rob√¥ fez 8 jogadas para cada um dos 2 oponentes (16 jogadas no total) e salvou a s√©rie de jogadas resultante - com op√ß√£o de recorte <b>desativado</b> . <br><br>  Em seguida, no mesmo teste, o procedimento foi repetido com <b>a</b> op√ß√£o de recorte <b>ativada</b> .  Depois disso, a sequ√™ncia de movimentos foi comparada.  A discrep√¢ncia nos movimentos indica um erro na implementa√ß√£o do algoritmo de corte alfa-beta (falha no teste). <br></div></div><br><h3>  Menor otimiza√ß√£o de recorte alfa-beta </h3><br>  Com a op√ß√£o de recorte ativada nas configura√ß√µes de AI, o n√∫mero de v√©rtices na √°rvore de posi√ß√µes foi reduzido em m√©dia 3 vezes.  Este resultado pode ser um pouco melhorado. <br><br>  No exemplo acima: <br><br><img src="https://habrastorage.org/webt/-h/ce/hb/-hcehbcs1t-bcynqfe7j_cmnjp4.png"><br><br>  "coincidiu" com tanto sucesso que, antes da sub√°rvore com o v√©rtice na posi√ß√£o 3, examinamos a sub√°rvore com o v√©rtice na posi√ß√£o 2. Se a sequ√™ncia fosse diferente, poder√≠amos come√ßar com a "pior" sub√°rvore e n√£o concluir que n√£o havia sentido em considerar a pr√≥xima posi√ß√£o . <br><br>  Como regra geral, o recorte em uma √°rvore acaba sendo mais "econ√¥mico", seus v√©rtices descendentes no mesmo n√≠vel (isto √©, todos os movimentos poss√≠veis da posi√ß√£o i) j√° s√£o classificados pela estimativa da posi√ß√£o atual (sem olhar profundamente).  Em outras palavras, supomos que o melhor movimento (do ponto de vista heur√≠stico) tem maior probabilidade de obter uma nota final melhor.  Assim, n√≥s, com alguma probabilidade, classificamos a √°rvore para que a sub√°rvore ‚Äúmelhor‚Äù seja considerada antes da ‚Äúpior‚Äù, o que nos permitir√° cortar mais op√ß√µes. <br><br>  A avalia√ß√£o da posi√ß√£o atual √© um procedimento caro.  Se anteriormente bastava avaliar apenas as posi√ß√µes terminais (folhas), agora a avalia√ß√£o √© feita para todos os v√©rtices da √°rvore.  No entanto, como os testes mostraram, o n√∫mero total de estimativas feitas ainda era um pouco menor do que na variante sem a classifica√ß√£o inicial de poss√≠veis movimentos. <br><br><div class="spoiler">  <b class="spoiler_title">Recursos de implementa√ß√£o de software</b> <div class="spoiler_text">  O algoritmo de corte alfa-beta retorna o mesmo movimento que o algoritmo Minimax original.  Isso verifica o teste de unidade que escrevemos, comparando duas seq√º√™ncias de movimentos (para um algoritmo com recorte e sem).  O recorte alfa-beta <b>com classifica√ß√£o</b> , em geral, pode indicar um <b>movimento diferente do</b> quase ideal. <br><br>  Para testar a opera√ß√£o correta do algoritmo modificado, voc√™ precisa de um novo teste.  Apesar da modifica√ß√£o, um algoritmo com classifica√ß√£o deve produzir exatamente o mesmo <b>vetor de estimativa final</b> ([3, 2] no exemplo da figura) que o algoritmo sem classifica√ß√£o como o algoritmo Minimax original. <br><br>  No teste, criei uma s√©rie de posi√ß√µes de teste e as selecionei de acordo com a ‚Äúmelhor‚Äù jogada, ativando e desativando a op√ß√£o de classifica√ß√£o.  Em seguida, ele comparou o vetor de avalia√ß√£o obtido de duas maneiras. <br></div></div><br>  Al√©m disso, como as posi√ß√µes de cada um dos movimentos poss√≠veis no v√©rtice atual da √°rvore s√£o classificadas por avalia√ß√£o heur√≠stica, √© impl√≠cito a id√©ia de descartar imediatamente algumas das piores op√ß√µes.  Por exemplo, um jogador de xadrez pode considerar um movimento no qual substitui sua torre por um golpe de pe√£o.  No entanto, "desenrolando" a situa√ß√£o em profundidade por 3, 4 ... movimentos para frente, ele notar√° imediatamente as op√ß√µes quando, por exemplo, o oponente colocar o bispo de sua rainha sob ataque. <br><br>  Nas configura√ß√µes de IA, defino o vetor "recorte das piores op√ß√µes".  Por exemplo, um vetor no formato [0, 0, 8, 8, 4] significa que: <br><br><ul><li>  olhando para um [0] e dois [0] passos adiante, o programa considerar√° todos os movimentos poss√≠veis, porque 0   , </li><li>    [8]   [8]  ,    8 ‚Äú‚Äù ,    , , </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> olhando cinco ou mais passos adiante [4], o programa avaliar√° n√£o mais do que 4 ‚Äúmelhores‚Äù movimentos. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Com a classifica√ß√£o ativada para o algoritmo de recorte alfa-beta e um vetor semelhante nas configura√ß√µes de recorte, o programa come√ßou a gastar cerca de 300 milissegundos para selecionar um movimento quase ideal, ‚Äúavan√ßando mais‚Äù 8 passos √† frente. </font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Otimiza√ß√£o Heur√≠stica </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apesar da quantidade decente de posi√ß√µes de v√©rtices repetidas na √°rvore e ‚Äúprofundas‚Äù, olhando para o futuro em busca de um movimento quase ideal, a IA tinha v√°rias fraquezas. </font><font style="vertical-align: inherit;">Eu defini um deles como uma " </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">armadilha de coelho</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ".</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Armadilha de lebre</font></font></b> <div class="spoiler_text">       .   ( 8 ‚Äî 10   15),     .     ‚Äú‚Äù          (   !): <br><br><ul><li>           7, </li><li>    ,    ,  .   ,  ,    ,      . </li></ul><br>        .  : <br><br><img src="https://habrastorage.org/webt/qn/y-/wr/qny-wrq0dgtlr16wwj1ibekhk5g.png"><br><br>     54   (43),      ‚Äî   10     55 .  AI,   ,      (61),  28 .       ,   6          9 (      10 ). <br><br>   ,       ( ),         ,        4 ‚Äî 6 .   , ,          , AI     ? <br><br>   ,     <b> </b> ,   . AI      .            ,      ,    .      ‚Äú ‚Äù  : <br><br>                  65 ‚Äî    ‚Äú‚Äù  , ,      .         ,            ,  ,    ()    . <br></div></div><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Fatores de corre√ß√£o </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anteriormente, fornecendo uma f√≥rmula para a estimativa heur√≠stica da posi√ß√£o atual </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E = Ks * S + Kc * C + Kp * P, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mencionei, mas n√£o descrevi, os fatores de corre√ß√£o. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O fato √© que tanto a f√≥rmula em si quanto os conjuntos de fun√ß√µes</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , foram deduzidos por mim intuitivamente, com base nos chamados </font><font style="vertical-align: inherit;">"Bom senso". </font><font style="vertical-align: inherit;">No m√≠nimo, gostaria de selecionar esses coeficientes Ks, Kc e Kp para que a estimativa seja o mais adequada poss√≠vel. </font><font style="vertical-align: inherit;">Como avaliar a "adequa√ß√£o" da avalia√ß√£o? </font><font style="vertical-align: inherit;">A avalia√ß√£o √© uma quantidade sem dimens√£o e s√≥ pode ser comparada com outra estimativa. </font><font style="vertical-align: inherit;">Consegui encontrar a √∫nica maneira de refinar os coeficientes de corre√ß√£o:</font><font style="vertical-align: inherit;">coloquei no programa uma s√©rie de ‚Äúestudos‚Äù armazenados em um arquivo CSV com dados do formul√°rio</font></font><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.56ex" height="2.419ex" viewBox="0 -780.1 6699.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-30" x="1011" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-2E" x="1169" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-2E" x="1614" y="0"></use><g transform="translate(2059,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-32" x="1011" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-2C" x="3229" y="0"></use><g transform="translate(3674,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-30" x="867" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-2E" x="4741" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-2E" x="5186" y="0"></use><g transform="translate(5632,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-35" x="867" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-13">C_0 .. C_2, S_0 .. S_5</script><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><pre> <code class="cs hljs"> <span class="hljs-number"><span class="hljs-number">45</span></span>;<span class="hljs-number"><span class="hljs-number">26</span></span>;<span class="hljs-number"><span class="hljs-number">2</span></span>;f;<span class="hljs-number"><span class="hljs-number">29</span></span>;<span class="hljs-number"><span class="hljs-number">19</span></span>;<span class="hljs-number"><span class="hljs-number">0</span></span>;f;<span class="hljs-number"><span class="hljs-number">2</span></span> ...</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Essa linha significa literalmente o seguinte: </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o primeiro jogador est√° no quadrado 45, ele tem 26 cartas de cenoura e 2 cartas de salada nas m√£os, o jogador n√£o perde um movimento (f = falso). </font><font style="vertical-align: inherit;">O direito de mudar √© sempre o primeiro jogador.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> o segundo jogador na cela 29, com 19 cartas de cenoura e sem cartas de salada, n√£o perde nenhum movimento. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a figura dois significa que, ‚Äúdecidindo‚Äù o estudo, presumi que o segundo jogador estivesse em uma situa√ß√£o vencedora. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Depois de colocar 20 esbo√ßos no programa, eu os "baixei" no cliente web do jogo e, em seguida, classifiquei cada um esbo√ßado. </font><font style="vertical-align: inherit;">Analisando o esbo√ßo, alternadamente fiz movimentos para cada um dos jogadores, at√© que decidi sobre o "vencedor". </font><font style="vertical-align: inherit;">Depois de concluir a avalia√ß√£o, enviei-a em uma equipe especial para o servidor. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Depois de avaliar 20 estudos (√© claro, valeria a pena analisar mais deles), avaliei cada um dos estudos pelo programa. </font><font style="vertical-align: inherit;">Na avalia√ß√£o, os valores de cada um dos fatores de corre√ß√£o, de 0,5 a 2, em incrementos de 0,1 - total</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = 4096 variantes de triplos de coeficientes. </font><font style="vertical-align: inherit;">Se a pontua√ß√£o do primeiro jogador for superior √† pontua√ß√£o do segundo jogador e uma instru√ß√£o semelhante foi armazenada na linha do registro de estudo (o √∫ltimo valor da linha √© 1), o "acerto" foi contado. </font><font style="vertical-align: inherit;">Da mesma forma para uma situa√ß√£o de espelho. </font><font style="vertical-align: inherit;">Caso contr√°rio, uma nota foi contada. </font><font style="vertical-align: inherit;">Como resultado, escolhi aqueles triplos para os quais a porcentagem de "acertos" era m√°xima (16 em 20). </font><font style="vertical-align: inherit;">Foram lan√ßados cerca de 250 de 4096 vetores, dos quais selecionei o ‚Äúmelhor‚Äù, novamente, ‚Äúa olho‚Äù e o instalei nas configura√ß√µes de IA.</font></font><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.379ex" height="2.419ex" viewBox="0 -935.7 1454.9 1041.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-36" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhheGAtBcxs4IupzTovTaqafD5yvyw#MJMAIN-33" x="1415" y="557"></use></g></svg></span><script type="math/tex" id="MathJax-Element-14">16^3</script><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sum√°rio </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como resultado, recebi um programa de trabalho que, em regra, me supera na vers√£o individual contra o computador. Estat√≠sticas s√©rias de vit√≥rias e derrotas para a vers√£o atual do programa ainda n√£o foram acumuladas. Talvez o ajuste f√°cil subsequente da IA ‚Äã‚Äãtorne minhas vit√≥rias imposs√≠veis. Ou quase imposs√≠vel, j√° que o fator das c√©lulas da lebre ainda permanece. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por exemplo, na l√≥gica de escolher classifica√ß√µes (m√°ximo absoluto ou m√°ximo em rela√ß√£o a outros jogadores), eu definitivamente tentaria uma op√ß√£o intermedi√°ria. No m√≠nimo, se o valor absoluto da i-√©sima pontua√ß√£o do jogador for igual, √© razo√°vel escolher a jogada que leva √† posi√ß√£o com um valor relativo maior da pontua√ß√£o (um h√≠brido da nobre Leslie e da trai√ßoeira Feith).</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O programa √© totalmente funcional para a vers√£o com 3 jogadores. </font><font style="vertical-align: inherit;">No entanto, h√° suspeitas de que a "qualidade" da IA ‚Äã‚Äãse mova para jogar com tr√™s jogadores √© menor do que para jogar com dois jogadores. </font><font style="vertical-align: inherit;">No entanto, durante o √∫ltimo teste, perdi para o computador - talvez por neglig√™ncia, avaliando casualmente a quantidade de cenouras em minhas m√£os e chegando √† linha de chegada com um excesso de "combust√≠vel". </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">At√© agora, o desenvolvimento futuro da IA ‚Äã‚Äã√© dificultado pela falta de uma pessoa - um "testador", ou seja, um oponente vivo de um "g√™nio" do computador. </font><font style="vertical-align: inherit;">Eu pr√≥prio toquei o suficiente de Hare e Hedgehog para n√°usea e fui for√ßado a interromper no est√°gio atual. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí Link para o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reposit√≥rio com fonte</font></font></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt432382/">https://habr.com/ru/post/pt432382/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt432370/index.html">AlphaZero venceu Stockfish em uma partida de 1.000 jogos</a></li>
<li><a href="../pt432372/index.html">A Microsoft confirmou oficialmente que o Edge muda para o mecanismo Chromium</a></li>
<li><a href="../pt432374/index.html">Elasticsearch altamente acess√≠vel e escal√°vel em Kubernetes</a></li>
<li><a href="../pt432378/index.html">Um aluno da 10¬™ s√©rie da Sib√©ria quer se tornar um designer de processadores. Por que n√£o fazer um acelerador neural FPGA?</a></li>
<li><a href="../pt432380/index.html">Seis anos de vida com um iPhone que n√£o me distrai</a></li>
<li><a href="../pt432384/index.html">Estudo: 22% dos usu√°rios do Tumblr v√£o a um site porn√¥, especialmente meninas</a></li>
<li><a href="../pt432386/index.html">Mesa redonda ‚ÄúArquiteto do projeto de TI‚Äù, setembro de 2018</a></li>
<li><a href="../pt432392/index.html">Tivemos jogos da velha escola e alguns cogumelos: miss√£o conclu√≠da</a></li>
<li><a href="../pt432394/index.html">9 Voltas de Automa√ß√£o de Armaz√©m Lamoda</a></li>
<li><a href="../pt432398/index.html">Modo DFU do carregador de inicializa√ß√£o STM32 usando CubeMX. Instru√ß√µes passo a passo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>