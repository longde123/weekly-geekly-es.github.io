<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìô üï¥üèº üêò Desenvolvimento de um bot de bate-papo com uma determinada personalidade. Palestra em Yandex ü§πüèø ü§¶üèø üôçüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Uma caracter√≠stica importante das tarefas de aprendizado de m√°quina √© que resultados igualmente bons podem ser alcan√ßados usando m√©todos diferentes. I...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Desenvolvimento de um bot de bate-papo com uma determinada personalidade. Palestra em Yandex</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/422717/">  Uma caracter√≠stica importante das tarefas de aprendizado de m√°quina √© que resultados igualmente bons podem ser alcan√ßados usando m√©todos diferentes.  Isso empolga os concursos de ML: mesmo tendo outras compet√™ncias al√©m de um oponente obviamente forte, voc√™ ainda pode vencer.  As equipes de Tensorborne e Neurobotics tiveram chances quase iguais de ganhar o hackathon DeepHack e, eventualmente, ocuparam os dois primeiros lugares.  No <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">treinamento</a> da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Yandex,</a> representantes de ambas as equipes fizeram um relat√≥rio volumoso.  Na decodifica√ß√£o, voc√™ encontrar√° an√°lises detalhadas de solu√ß√µes e dicas para os concorrentes iniciantes. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/qSehSTWMXaY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><blockquote>  E, claro, tire f√©rias de hackathon.  Quando voc√™ participa de um hackathon semanal e tamb√©m trabalha ao mesmo tempo, √© ruim.  Voc√™ chega √†s 19h, depois de trabalhar um pouco, senta e compila o Docker com o TensorFlow, Keras, para que tudo isso comece em alguns servidores remotos aos quais voc√™ nem sequer tem acesso.  Em algum lugar em duas noites, voc√™ pega a catarse e funciona para voc√™ - sem o Docker, sem tudo, porque voc√™ entendeu que √© poss√≠vel e assim. </blockquote><br><a name="habracut"></a>  Vitaly Davydov: <br>  - Ol√° pessoal!  Dever√≠amos ter dois relat√≥rios, mas decidimos combin√°-los em um grande, porque estamos falando do primeiro e do segundo lugar na competi√ß√£o DeepHack.  N√≥s representamos duas equipes.  Nossa equipe de Tensorborne ficou em 2¬∫ lugar, e a equipe de Gregory Neurobotics - a primeira. <br><br><img src="https://habrastorage.org/webt/hp/da/wx/hpdawx6cghpeiebf6nkmnxwieno.jpeg"><br>  O relat√≥rio consistir√° em tr√™s partes principais.  Na introdu√ß√£o, falarei sobre a hist√≥ria do DeepHack, o que √©, quais eram as m√©tricas, etc. Em seguida, os caras falar√£o sobre solu√ß√µes, sobre quais problemas, exemplos etc. <br><br>  Antes de falar sobre o DeepHack, deve-se notar que √© um pequeno subconjunto de outra grande competi√ß√£o global ConvAI2, que lan√ßou o Facebook no ano passado.  Este ano √© a segunda itera√ß√£o.  Em algum momento, o Facebook patrocinou o Instituto de F√≠sica e Tecnologia de Moscou, e o concurso DeepHack foi criado com base no laborat√≥rio PhysTech. <br><br><img src="https://habrastorage.org/webt/k7/de/a-/k7dea-py5v-x3gr47seesnhpfge.jpeg"><br>  Leia mais sobre o pr√≥prio ConvAI.  Que problema ele est√° tentando resolver?  Ele √© especialista em sistemas interativos.  O problema com os sistemas de di√°logo √© que n√£o existe uma √∫nica ferramenta de avalia√ß√£o, uma ferramenta de avalia√ß√£o, para entender a qualidade dos di√°logos.  Isso √© muito subjetivo de pessoa para pessoa: algu√©m pode gostar da conversa, algu√©m n√£o.  A tarefa global geral do ConvAI √© criar uma m√©trica unificada comum para avaliar di√°logos, que ainda n√£o est√° dispon√≠vel.  Pr√™mio - US $ 20.000 para o AWS Mechanical Turk.  Estes n√£o s√£o empr√©stimos para a Amazon, s√£o apenas empr√©stimos para o Mechanical Turk, que na verdade √© um an√°logo do Yandex.Tolki.  Este √© um servi√ßo de crowdsourcing que permite fazer marca√ß√µes nos dados. <br><br>  A tarefa, criada no ConvAI, √© criar um chit-chat-bot com o qual voc√™ possa fazer algum tipo de di√°logo.  Eles escolheram tr√™s m√©tricas: Perplexidade, Hits @ 1 e F1.  A seguir, mostrarei a tabela que estava no momento da nossa submiss√£o. <br><br>  A avalia√ß√£o pela qual eles tentaram fazer isso passou por tr√™s etapas.  O primeiro est√°gio s√£o as m√©tricas autom√°ticas, a avalia√ß√£o do AWS Mechanical Turk e o bate-papo ao vivo com volunt√°rios. <br><br>  Como o ConvAI √© patrocinado pelo Facebook, ele est√° promovendo ativamente sua biblioteca para a cria√ß√£o de sistemas de conversa√ß√£o do ParlAI.  √â bastante complicado, mas acho que todos os participantes usaram esta biblioteca.  N√≥s lidamos com isso por um bom tempo, n√£o √© compat√≠vel com o Python 3.6, por exemplo, e h√° v√°rios problemas com ele. <br><br><img src="https://habrastorage.org/webt/yp/xk/ew/ypxkewtucztkiznh_vqrienqxoe.jpeg"><br><br>  Nestas poucas linhas, voc√™ pode ver quais posi√ß√µes ocupamos no momento da submiss√£o.  Em geral, o ConvAI √© estranhamente organizado no sentido de que existem tr√™s m√©tricas e n√£o est√° muito claro como est√° indo a classifica√ß√£o nesta tabela.  Pode-se observar que, para algumas m√©tricas, algumas equipes s√£o mais altas, para outras mais baixas.  A organiza√ß√£o de todo o ConvAI foi um pouco estranha. <br><br>  Mas existem tr√™s linhas de base b√°sicas.  Para se qualificar para o DeepHack, foi necess√°rio quebrar essa linha de base, e as 10 melhores equipes chegaram √† final.  Em segredo, direi que apenas 8 equipes enviaram decis√µes e todos chegaram √† final.  N√£o foi muito dif√≠cil. <br><br><img src="https://habrastorage.org/webt/vb/ra/mg/vbramgip1a-tkhp33opnd0nxiic.jpeg"><br><br>  A tarefa do DeepHack era um pouco mais compreens√≠vel e direta.  Tivemos que construir novamente um rob√¥ falador, mas que simularia uma certa personalidade.  Ou seja, o rob√¥ recebeu uma descri√ß√£o de uma pessoa na entrada e, durante uma conversa com ele, ele teve que revelar.  O pr√™mio foi bastante interessante - uma viagem ao NIPS neste outono, que √© totalmente patrocinada. <br><br>  A m√©trica, diferente da ConvAI, j√° era diferente.  Havia duas m√©tricas e a m√©trica total √© ponderada entre as duas.  A primeira m√©trica √© a qualidade geral, uma avalia√ß√£o de como o bot respondeu adequadamente, o qu√£o interessante foi se comunicar com ele, se estava escrevendo algum lixo etc. A segunda m√©trica √© a interpreta√ß√£o de pap√©is, 0 ou 1. Isso significa O bot entrou na descri√ß√£o que lhe foi dada.  A pessoa que se comunica com o bot n√£o v√™ a descri√ß√£o.  A avalia√ß√£o ocorreu no Telegram, ou seja, havia um √∫nico bot de Telegram e, quando o usu√°rio come√ßou a se comunicar com ele, ele recebeu um bot aleat√≥rio de todas as inscri√ß√µes, para ser honesto.  Yandex e MIPT, aparentemente, despejaram um pouco de tr√°fego l√°, e havia cerca de 10 mil di√°logos, pelo que me lembro. <br><br>  Eu j√° falei sobre a rodada de qualifica√ß√£o.  A final foi em tempo integral.  Ocorreu durante sete dias de trabalho no Instituto de F√≠sica e Tecnologia de Moscou, um aglomerado foi fornecido, um local, onde nos sentamos e trabalhamos l√°.  A avalia√ß√£o era de fato todos os dias, e a pontua√ß√£o final, a classifica√ß√£o do bot no final, era calculada dessa maneira.  A competi√ß√£o come√ßou na segunda-feira, a primeira finaliza√ß√£o foi na ter√ßa-feira e a avalia√ß√£o ocorreu no dia seguinte.  A solu√ß√£o que voc√™ postou na ter√ßa-feira foi avaliada na quarta-feira com um peso de 1,5.  O que voc√™ enviou na quarta-feira - com um peso de 1,4 etc. <br><br><img src="https://habrastorage.org/webt/1x/4m/mc/1x4mmcu5p_2jo49ppvjceah0yhc.jpeg"><br><br>  Sobre o conjunto de dados que o Facebook forneceu para treinamento.  Chama-se Persona-Chat e √© uma descri√ß√£o de duas personalidades e um conjunto de di√°logos.  H√° uma descri√ß√£o da primeira pessoa e da segunda.  No processo de descrever o di√°logo, eles tentam se revelar.  Isso √© tudo o que foi dado.  No entanto, como sempre, na competi√ß√£o n√£o era proibido o uso de outros conjuntos de dados de terceiros. <br><br><img src="https://habrastorage.org/webt/my/jx/hn/myjxhn7rt6krkci69o_vqwtpguq.jpeg"><br><br>  Um exemplo do di√°logo da nossa equipe.  Se voc√™ ler com aten√ß√£o, fica claro que o bot resultante funciona adequadamente e responde corretamente. <br><br>  Gregory vai falar sobre o primeiro lugar. <br><br>  Grigory Rashkov: <br>  - Gostaria de falar sobre nossa experi√™ncia em participar da competi√ß√£o, nossa estrat√©gia e nossa decis√£o. <br><br><img src="https://habrastorage.org/webt/rc/an/5v/rcan5v9ajugvnsojkpgrgactbv4.jpeg"><br><br>  Em primeiro lugar, a peculiaridade da competi√ß√£o √© que √© uma longa dura√ß√£o, n√£o tivemos dois dias, como em um hackathon comum, mas cinco dias, pelos quais poder√≠amos tomar muitas decis√µes. <br><br><img src="https://habrastorage.org/webt/v_/t7/4_/v_t74_uw45cd7shzhtaog-frdnu.jpeg"><br><br>  Avalia√ß√µes muito subjetivas, porque pessoas completamente diferentes com seus crit√©rios avaliaram, em particular, o organizador do hackathon Mikhail Bubtsev disse que se ele adivinhava qual perfil estava falando, mas o bot em algum momento contradiz seu perfil, ele respondeu √† pergunta n√£o t√£o , como est√° escrito, ele escolheu um perfil diferente, mesmo que soubesse do que se tratava. <br><br>  E o terceiro √© a falta de valida√ß√£o.  Os participantes n√£o puderam fazer uma pequena altera√ß√£o e receber feedback imediatamente. <br><br>  Como em todos os filmes de terror, nossa equipe desde o in√≠cio decidiu se separar.  O primeiro grupo participou da nossa solu√ß√£o principal, com base no Wasserstein GAN, o segundo grupo participou do bot, o painel de administra√ß√£o do bot com base na linha de base.  Porque tivemos que enviar algo no primeiro e no segundo dia. <br><br><img src="https://habrastorage.org/webt/za/ij/6e/zaij6evz4_vpbuepprwokz1pylq.jpeg"><br><h5>  <sub><sup><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Link do slide</a></sup></sub> </h5><br>  Brevemente sobre a linha de base: Seq2Seq mais aten√ß√£o, que √© ligeiramente adaptada para esta tarefa espec√≠fica.  Como exatamente?  Uma frase √© enviada para a entrada, a incorpora√ß√£o √© obtida do GloVe, mas a apresenta√ß√£o de cada frase como uma incorpora√ß√£o ponderada √© considerada ainda mais.  Os pesos s√£o selecionados com base na frequ√™ncia inversa da palavra.  Quanto mais raramente uma palavra aparece, mais peso ela traz. <br><br><img src="https://habrastorage.org/webt/t_/go/g_/t_gog_ke6ovdcl7sblmigcnxdcm.jpeg"><br><h5>  <sub><sup><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Link do slide</a></sup></sub> </h5><br>  Isso √© necess√°rio para refletir a singularidade dessas caracter√≠sticas.  Tudo estava indo para um conjunto, uma matriz, uma m√°scara foi constru√≠da com base nesse conjunto e um estado oculto, em seguida, essa m√°scara foi sobreposta ao conjunto, um contexto foi obtido e, em seguida, foi conectado, por n√£o linearidade, foi alimentado √† entrada dos decodificadores. <br><br><img src="https://habrastorage.org/webt/en/x-/ht/enx-htbfplt1is1kptc43ir_jh8.jpeg"><br><br>  No primeiro dia, ainda n√£o escrevemos nossa decis√£o, tivemos que enviar alguma coisa, por isso escrevemos um agente com base na linha de base, mas nos propusemos a tarefa de, de alguma forma, nos destacar da massa cinzenta de agentes.  Para fazer isso, usamos heur√≠sticas simples, nosso bot foi o primeiro a iniciar um di√°logo e ele sorriu nessa frase.  E funcionou. <br><br><img src="https://habrastorage.org/webt/iv/om/qv/ivomqvl3tvsedmrb0bnj7dyqg40.jpeg"><br>  Naturalmente, no dia seguinte, todos os bots come√ßaram a ser feitos primeiro e todos tinham emoticons.  No segundo dia, os moradores de Vilabaggio continuaram trabalhando com o GAN, os moradores de Vilaribo tentaram outras heur√≠sticas. <br><br><img src="https://habrastorage.org/webt/qe/pw/w-/qepww-mi4akk5qpehjzs2lmxjn4.jpeg"><br><br>  Como resultado, a pontua√ß√£o na qualidade do di√°logo melhorou um pouco, mas fomos superados pela pessoa.  Estes s√£o os resultados do terceiro dia, restavam apenas dois dias.  Entendemos que n√£o haveria tempo suficiente para escrevermos um GAN e test√°-lo normalmente, porque ele estuda h√° muito tempo, muito, temos que selecionar muitos hiperpar√¢metros.  Ent√£o, decidimos mudar para a linha de base, porque funciona muito bem. <br><br><img src="https://habrastorage.org/webt/a3/m5/cw/a3m5cw5nw_wfsgc9tk9kaxskxi4.jpeg"><br>  Nossa tarefa era melhorar o reconhecimento do perfil do usu√°rio.  Propusemos uma heur√≠stica.  Qual foi o problema?  O usu√°rio conversou alegremente com o bot, perguntando que tipo de trabalho ele tinha, hobbies, que tipo de carro ele dirigia, o bot respondeu tudo isso bem, porque o bot geralmente respondia bem.  Como resultado, no final do di√°logo, o usu√°rio viu dois perfis que nada tinham a ver com o que estava no di√°logo, simplesmente porque outras coisas foram indicadas l√° al√©m daquelas que o usu√°rio solicitou.  Portanto, decidimos que era necess√°rio fornecer de alguma forma informa√ß√µes do perfil. <br><br>  Como fazer isso da maneira mais l√≥gica?  Se uma pessoa tem algum interesse, provavelmente ele falar√° sobre ela, procure interesses em comum.  Portanto, decidimos que o bot em alguns momentos far√° perguntas com base em seu perfil.  Houve um efeito interessante de que o gerador, que foi escrito simplesmente de acordo com as regras ling√º√≠sticas de G, usa algum fato A do perfil, como resultado, G (A) √© inserido no di√°logo, tudo isso √© enviado para a mem√≥ria do bot e, na pr√≥xima vez em que o modelo gerar informa√ß√µes, procedendo tanto do perfil quanto desse di√°logo, ou seja, com maior probabilidade ele dir√° algo relacionado ao perfil. <br><br><img src="https://habrastorage.org/webt/t0/vu/xu/t0vuxufzqe-c-whihwkby1isxpe.jpeg"><br><br>  Como era na realidade?  O bot no perfil diz que est√° encantado com a poesia, e durante a conversa ele pergunta se eu gosto de poesia.  Eu digo que sim, e mais adiante no modelo dele, n√£o no gerador que constru√≠mos de acordo com as regras, diz que ele gosta de escrever poesia.  Assim, o bot focou em seu perfil e funcionou. <br><br><img src="https://habrastorage.org/webt/ls/tt/ku/lsttkui4jcn6v60olkqym-vbnvy.jpeg"><br><br>  Voltamos ao primeiro lugar novamente.  O √∫ltimo dia permaneceu.  Percebemos que, no entanto, estamos perdendo como um di√°logo. <br><br><img src="https://habrastorage.org/webt/cz/yz/wl/czyzwlynpgq0fl-k5e_ntgwzhbo.jpeg"><br>  Aproveitamos v√°rias outras solu√ß√µes.  Primeiro, eles usaram a par√°frase, analisaram o que as outras pessoas disseram, porque os organizadores criaram esse banco de dados e perceberam que muitas pessoas se comunicam com o bot n√£o est√° totalmente correto. <br><br><img src="https://habrastorage.org/webt/qy/tn/j-/qytnj-tpdkh8tsrza2iwwjpydgq.jpeg"><br><h5>  <sub><sup><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Link do slide</a></sup></sub> </h5><br>  Existe um m√≠nimo local interessante no bot: ele responde muito bem a qualquer insulto, ele concorda com eles e, para consertar isso, decidimos usar a competi√ß√£o Kaggle para analisador de coment√°rios t√≥xicos, escrevemos um classificador muito simples, tamb√©m com aten√ß√£o na RNN.  Nesse conjunto de dados, havia as seguintes classes, sobrepostas: insultos, amea√ßas ... Decidimos n√£o estudar o modelo separadamente, quem ir√° falar, porque esse problema foi encontrado, mas n√£o foi muito frequente.  Portanto, acabamos de escrever algum tipo de piada que o bot respondeu e todos ficaram felizes. <br><br><img src="https://habrastorage.org/webt/gc/vh/by/gcvhbyftcrlzu-f3sqzmkdenews.jpeg"><br>  Al√©m disso, usamos a par√°frase para enriquecer o discurso do nosso bot.  Isso tamb√©m n√£o foi muito dif√≠cil, substitu√≠mos as palavras da frase por sin√¥nimos, examinamos os n-gramas resultantes na frase, para que n√£o diferissem muito daqueles que eram originalmente e, em seguida, escolhemos a combina√ß√£o mais adequada para a frase com maior probabilidade. <br><br><img src="https://habrastorage.org/webt/of/je/dm/ofjedmtylm9iyyx76jwudzg6zxw.jpeg"><br><br>  Como exemplo do que aconteceu, o bot aqui diz que gosta de ouvir m√∫sica, diz curtir no perfil, foi substitu√≠do por gostar conosco.  N√£o temos certeza se o modelo em si ou o nosso Paraphraser o geraram, mas isso passou.  Outra observa√ß√£o de que era imposs√≠vel enviar apenas dados do perfil.  Pentagramas foram comparados l√°.  Se os pentagramas coincidiram com sua observa√ß√£o e seu perfil, simplesmente essa frase n√£o passou, os organizadores a organizaram.  Al√©m disso, entre outras coisas, adicionamos um dicion√°rio de smiley. <br><br><img src="https://habrastorage.org/webt/xk/5z/tx/xk5ztxz1m61eiqhjk0cm9tgcef4.jpeg"><br><br>  O segundo exemplo, temos muitos sorrisos.  Havia heur√≠sticas, quando o bot reagiu ao seu comportamento que voc√™ n√£o escreveu por muito tempo.  Parafraseador tamb√©m trabalhou aqui, e deu um bom resultado. <br><img src="https://habrastorage.org/webt/hk/sg/uj/hksgujdi_dp2pt0uny6qhme2saw.jpeg"><br>  A qualidade do di√°logo foi a melhor, a qualidade de desempenhar o papel tamb√©m. <br><br>  Tentamos fazer o modelo gerar um conjunto de op√ß√µes e as comparamos com o perfil.  Mas me pareceu que, nesse caso, o bot funciona pior, n√£o poder√≠amos realizar a valida√ß√£o, apenas avalia√ß√µes subjetivas em duas ou tr√™s conversas.  Portanto, eles decidiram n√£o colocar isso, porque o perfil j√° era bem reconhecido. <br><br>  Em seguida, escrevemos uma solu√ß√£o para o problema inverso, o segundo modelo, que selecionou o perfil desejado no di√°logo.  Planejamos us√°-lo inicialmente para treinamento, a fim de ler a fun√ß√£o de perda e distribu√≠-la ainda mais na grade.  Mas isso poderia piorar o falador, ent√£o eles decidiram n√£o colocar dessa maneira.  Tamb√©m pensamos em usar isso para o comportamento do bot, mas n√£o tivemos tempo para testar tudo e decidimos recusar.  Al√©m disso, decidimos colocar emoticons com base na colora√ß√£o emocional da frase, escrevemos um modelo, mas n√£o encontramos um conjunto de dados adequado, e os que foram usados ‚Äã‚Äãn√£o s√£o um pouco sobre isso. <br><br><img src="https://habrastorage.org/webt/-l/yu/xq/-lyuxqic47g_15ubzyeedifcwza.jpeg"><br>  Nossa equipe <br><br>  Mesmo que seu modelo principal, que voc√™ espera, n√£o consiga escrev√™-lo ou d√™ um resultado ruim, n√£o desista imediatamente, voc√™ precisa tentar algumas coisas mais simples, o que √© bastante natural.  E a segunda coisa, √†s vezes vale a pena observar o que falta ao seu modelo e pensar em tarefas espec√≠ficas, decomp√¥-las e resolver √°reas problem√°ticas espec√≠ficas, o que fizemos.  Obrigado pela aten√ß√£o. <br><br>  Sergey Kolesnikov: <br>  - Meu nome √© Sergey Kolesnikov, representarei a decis√£o de Tensorborne. <br><br><img src="https://habrastorage.org/webt/0t/mb/o8/0tmbo89jriohlxqgahftrd4zi2y.jpeg"><br><br>  Criamos um nome bonito, fomos ao concurso, criamos v√°rias pe√ßas diferentes para lan√ßar dois artigos depois disso, mas n√£o vencemos o hackathon.  Portanto, ser√° chamado: "Como n√£o ganhar o hackathon, mas ainda publicar os malditos dois artigos".  Acad√™micos, senhor. <br><br>  As caracter√≠sticas da competi√ß√£o em que participamos excederam nossa motiva√ß√£o.  Devido ao fato de a avalia√ß√£o ser realizada diariamente, os pacotes tamb√©m precisavam ser feitos diariamente, e a recompensa final era determinada, como gostamos na RL, pelo somat√≥rio descontado.  Tudo isso se transformou no fato de que tivemos que enviar pelo menos algo todos os dias para que funcionasse, e obtivemos pelo menos algum tipo de pontua√ß√£o.  Como resultado, ele realmente cresceu para o que voc√™ quer - voc√™ n√£o quer, mas teve que remar. <br><br><img src="https://habrastorage.org/webt/4l/uf/qk/4lufqkldav6-3iemerr1lxqd8rk.jpeg"><br><br>  O que n√≥s t√≠nhamos?  Visualiza√ß√£o para toda a semana. <br><br>  Apesar do hackathon dizer que ele era semanal, tudo foi decidido em quatro dias, o que parece n√£o ser suficiente para esta tarefa ConvAI. <br><br>  Inicialmente, √©ramos cinco de n√≥s, todos bons graduados acad√™micos, ou seja, Fiztekh. Ent√£o, na segunda-feira, viemos apresentar muitas sugest√µes, id√©ias que voc√™ pode tentar e quais modelos de aprendizado profundo tentar.  √â verdade que n√£o experimentamos o GAN, porque j√° o experimentamos para textos e isso n√£o funciona, por isso tomamos algo mais simples, al√©m disso, havia competi√ß√µes muito semelhantes e t√≠nhamos modelos pr√©-treinados.  Na ter√ßa-feira, conseguimos lan√ßar algo sobre aprendizado profundo, ML sempre que poss√≠vel, lan√ßamos dockers maravilhosos com suporte a GPU e outras coisas para o Tensorflow e Keras, precisamos dar uma medalha separada por isso, j√° que isso n√£o √© t√£o trivial como eu gostaria. <br><br>  De acordo com os resultados de ter√ßa-feira, eles foram promissores e decidimos melhorar levemente nosso ML com pequenas heur√≠sticas e similares, e falh√°mos em s√©timo lugar.  Mas, gra√ßas aos nossos colegas de equipe, algu√©m encontrou o ElasticSearch e o experimentou.  Houve um momento muito embara√ßoso em que o ElasticSearch funcionou bem, e os modelos DL e ML, e assim por diante, eram um pouco menos robustos.  O fim do concurso estava pr√≥ximo.  E, como observado pelo orador anterior, decidimos remar na dire√ß√£o que funciona.  Adotamos o ElasticSearch, pequenas heur√≠sticas e achamos isso bom o suficiente, e realmente bom o suficiente, porque ficamos em segundo lugar. <br><br><img src="https://habrastorage.org/webt/yf/4p/2a/yf4p2avf9hrxd-dyy3bkgely3a0.jpeg"><br><br>  Mais detalhes.  Na verdade, havia v√°rias solu√ß√µes de DL.  A primeira solu√ß√£o de DL foi bastante simples.  Quem se lembra, no ano anterior ao √∫ltimo ou no ano passado, houve um concurso de detec√ß√£o de par√°frase do Quora, e este ano houve um concurso do Yandex para Alice para criar di√°logos e muito mais.  Voc√™ pode perceber que as tarefas s√£o muito pr√≥ximas.  No primeiro, era necess√°rio dizer se essas duas frases eram par√°frases e, no segundo, era necess√°rio continuar o di√°logo.  Pensamos que, uma vez que estamos desenvolvendo sistemas de di√°logo, vamos tamb√©m continuar bem o di√°logo.  E funcionou perfeitamente, o di√°logo com o Quora foi muito pessoal. <br><br>  Basicamente, tudo parecia ter algum codificador, geralmente todos treinamos em nossas RNNs habituais e, de prefer√™ncia, LSTM com aten√ß√£o e outras coisas.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E ent√£o usamos normalmente a perda de incorpora√ß√£o de cosa√≠na, apresentada abaixo no slide, ou outra perda de incorpora√ß√£o do tipo Tripler Loss ou qualquer outra coisa que incorpora par√°frase ou respostas a um di√°logo espec√≠fico re√∫ne, e n√£o atrasos de par√°frase, e assim por diante. </font><font style="vertical-align: inherit;">Esta foi a primeira solu√ß√£o, foi no Tensorflow, Keras, estava pronta, tentamos e foi muito boa.</font></font><br><br>          .     ,   DL  ML  ,      ,         ,         FastAI.     PyTorch,      PyTorch,      .   ,      ,           ,    LSTM       FastAI,   ,      ,   SOTA   . <br><br>       PyTorch,  -      FastAI, ,   ,     PyTorch,         .        ,  ,        ,        .      answer,  .          FastAI,  Universal Language Model ‚Äî    ‚Äî Encoder. <br><br>     , , ,   1   ,     seq2seq.        .           ,     ,     FastAI ‚Äî Concat poolling.   ?         seq2seq,    attention.   maxpool  minpool     ,         ,      . <br><br>   ,      ,       ,     ,     maxpool  minpool,   .     ,     ‚Äî    H, Hc  Ha.       ,   feedforward ,    .  ,     ,   ,  ,  metric learning.         ‚Äî CosineEmbedding Loss,    PyTorch. <br><br>           ,  loss         .   ,  contrastive loss,    ,       .     ,        . <br><br>   DL-. ElasticSearch,   . <br><br><img src="https://habrastorage.org/webt/yf/4p/2a/yf4p2avf9hrxd-dyy3bkgely3a0.jpeg"><br><br>    ?   ,   -  ElasticSearch  . -         - Persona Dataset  ,   ,   Facebook,  ,   ,    - .      -    .        ,     ,  ,  ,        ,  Persona Dataset      ,      Amazon Mechanical Turk     ,   . <br><br>         ElasticSearch,            ,    .  ,   Persona Dataset    ,   , 10 . ,        . , , ,   ,     . <br><br>   - .        ,    Persona     ,  ,     ,  ,    ,    evaluation.    heuristic solutions. <br><br> ,   ,   ,          ,   .    .    ,  ,   ,     ,    ,     .    . <br><br>       ‚Äî    .        ,        ‚Äî    -,      -,   ,   . <br><br>      dirty hack.    ,         ,        .       .   ‚Äî    ,       . <br><br><img src="https://habrastorage.org/webt/yy/9p/fw/yy9pfw8lc-tssoygftcrfsatfxy.jpeg"><br><br>  ?        ,   -DL-       ,   DL,    .   ,    ,    ,   .          .  ,   -,     ,  ,   .  ,   ,     .     .  ,  ,    .    DL        ,  ElasticSearch  . <br><br>  ,     personality score.  ,  -,     0,25‚Äì0,3 ,       .   ,    ,   -    . <br><br><img src="https://habrastorage.org/webt/av/rt/t7/avrtt73yerc1ckh6tyv3swowuzk.jpeg"><br><br> .     ‚Äî           ,   ,  ,       Docker ElasticSearch,       .   ,  .  .     .     Also, try to guess‚Ä¶  ,    ‚Äî , funny you.  ,     general,  .    ,     ,    . <br><br> ,  ,       .            . ,          ‚Äî    ,         ,  .  ,     Docker,      . <br><br><img src="https://habrastorage.org/webt/jj/zy/9r/jjzy9r5zcnzogxejadhvfhehoyg.jpeg"><br><br>         ? ConvAI   ,     NIPS,       -  . <br><br> -, ElasticSearch   . ,    ,   .   ,      ,  ElasticSearch   . ,   DL. <br><br> -,     DL-. :       ,     ,     ,     .    ,  , , ,    . <br><br>    ,     .   ,        .     ,      .    ‚Äî    pre-trained- ( ‚Äî . .), .  . <br><br> ,   proposals   ,    RL bandits     .     ,  .     ‚Äî      .  ,    . ,    ,        ,  ,     toxic-     .   . <br><br>         ‚Äî   .         ,       DeepHacks    .   NLP,    DeepHack    , , ¬´ ¬ª.  ,  .     .      , , ,   ,         ,     . <br><br>   ‚Äî       .        distributed-       ,       .   ,       DeepHack.     -   .   .  ,     ,    ,        ,     . <br><br>   ! .      pre-trained-.   , , . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E, claro, tire f√©rias de hackathon. </font><font style="vertical-align: inherit;">Quando voc√™ participa de um hackathon semanal e tamb√©m trabalha ao mesmo tempo, √© ruim. </font><font style="vertical-align: inherit;">Voc√™ chega √†s 19h, depois de trabalhar um pouco, senta e compila o Docker com o TensorFlow, Keras, para que tudo isso comece em alguns servidores remotos aos quais voc√™ nem sequer tem acesso. </font><font style="vertical-align: inherit;">Em algum lugar em duas noites, voc√™ pega a catarse e funciona para voc√™ - sem o Docker, sem tudo, porque voc√™ entendeu que √© poss√≠vel e assim. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parece que se voc√™ participar de uma grande competi√ß√£o, reserve um pouco mais de tempo do que n√£o consegue dormir em uma semana e participe. </font><font style="vertical-align: inherit;">V√° e ganhe.</font></font> Obrigada </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt422717/">https://habr.com/ru/post/pt422717/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt422705/index.html">O livro sobre "Par√°grafo" em Habr√©. Um novo cap√≠tulo √© sobre programadores cooperativos: Beta</a></li>
<li><a href="../pt422709/index.html">Os cientistas descobriram uma se√ß√£o do c√©rebro humano que √© respons√°vel pelo tom do nosso discurso</a></li>
<li><a href="../pt422711/index.html">Leitura de fim de semana: recursos de nuvem e infraestrutura de TI</a></li>
<li><a href="../pt422713/index.html">O resumo de materiais interessantes para o desenvolvedor m√≥vel 269 (de 3 a 9 de setembro)</a></li>
<li><a href="../pt422715/index.html">A n√£o discrimina√ß√£o √© o valor principal do c√≥digo aberto</a></li>
<li><a href="../pt422719/index.html">Os invasores comprometeram milhares de roteadores MikroTik para criar uma botnet</a></li>
<li><a href="../pt422721/index.html">KivyMD - a vida continua</a></li>
<li><a href="../pt422723/index.html">GAN ensinou a criar rostos com textura e geometria realistas</a></li>
<li><a href="../pt422725/index.html">390k. sites com pasta .git aberta</a></li>
<li><a href="../pt422729/index.html">Como um provedor de nuvem pode gerenciar licen√ßas de software e quais solu√ß√µes de blockchain podem fornecer aqui</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>