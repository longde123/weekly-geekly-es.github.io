<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎏 🐂 🙏 Kami menulis pemuat FPGA di LabVIEW. Bagian 1 👁‍🗨 🕙 🥌</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sebagian besar programmer "normal", secara sederhana, memiliki sikap ambigu terhadap teknologi LabVIEW . Di sini Anda dapat berdebat untuk waktu yang ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kami menulis pemuat FPGA di LabVIEW. Bagian 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/427529/"><img src="https://habrastorage.org/webt/2m/nu/6l/2mnu6ljkhtj-pydr_chsebgpp_i.jpeg"><br><p><br>  Sebagian besar programmer "normal", secara sederhana, memiliki sikap ambigu terhadap teknologi <strong>LabVIEW</strong> .  Di sini Anda dapat berdebat untuk waktu yang lama dan tidak berhasil.  Situasi ini diperburuk oleh kenyataan bahwa ada banyak contoh program LabVIEW di jaringan, tetapi semuanya berorientasi pada pemula dan bermuara pada “oh, lihat betapa sederhananya, hubungkan putaran ke indikator, putar kenop, perubahan digit”, atau paling tidak, pada grafik dalam siklus nomor acak atau sinus ditampilkan, semua ini disertai dengan antarmuka yang marah dalam bentuk sakelar toggle raksasa, tombol putar dan indikator dial.  Secara pribadi, pendekatan penyederhanaan sadar ini mengganggu saya.  Dalam serangkaian artikel singkat saya akan mencoba memperkenalkan pembaca pada proses pengembangan perangkat lunak aplikasi di LabVIEW.  Agar tidak mencurahkan banyak waktu untuk bidang subjek, kami akan menggunakan algoritma terperinci untuk mengunggah file konfigurasi ke FPGA melalui FTDI dalam mode MPSSE ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Mengunduh konfigurasi ke FPGA melalui USB atau membongkar FTDI MPSSE</a> ).  Pada artikel ini saya akan menunjukkan bagaimana mengimplementasikan loader FPGA yang sama, tetapi dalam bahasa LabVIEW. </p><a name="habracut"></a><br><p>  Seperti disebutkan di atas, algoritma pemuatan FPGA dalam mode Serial Passive (SP) dan prinsip operasi FTDI dijelaskan dengan baik dalam artikel sebelumnya.  Saya tidak akan mengulangi lagi.  Kami percaya bahwa algoritme diuji dan diakui sebagai kecocokan.  Dan ya, anggap pembaca setidaknya secara dangkal akrab dengan konsep LabVIEW dan berpengalaman dalam pemrograman klasik. </p><br><p>  Meskipun proses pembuatan bootloader tidak memakan banyak waktu, deskripsi proses tidak berhasil masuk ke dalam volume satu artikel, jadi akan ada seri kecil.  Karena tahap percobaan telah selesai, dan saya yakin dengan pengoperasian algoritma, saya akan membiarkan diri saya memulai pengembangan dari antarmuka pengguna.  Pada artikel pertama, kami akan membuat antarmuka pengguna loader dan menerapkan struktur program.  Dalam yang kedua - melalui dll driver FTDI, kami menerapkan pemuatan file * .rbf ke dalam FPGA. </p><br><p>  Untuk produktivitas percakapan, tidak berlebihan untuk mengingat terminologi yang diadopsi di LabVIEW.  Dalam LabVIEW, program aplikasi disebut Instrumen Virtual, juga dikenal sebagai VI, juga dikenal sebagai instrumen Virtual atau singkatnya VI.  VP memiliki dua "sisi": Panel Depan, di mana kontrol dan indikator berada, dan diagram blok (Block Diagram), di mana elemen-elemen ini saling berhubungan dan fungsi serta aliran pemrosesan data diimplementasikan.  Sebagai aturan, VP memiliki struktur hirarkis, semua VP di VP tingkat atas biasanya disebut subdevice atau SubVI. </p><br><h2 id="interfeys-polzovatelya">  Antarmuka pengguna </h2><br><p>  Aplikasi kita harus memuat file konfigurasi ke dalam FPGA.  Pada saat yang sama, kami maksudkan bahwa beberapa FTDI dapat dihubungkan ke komputer secara bersamaan, dan beberapa di antaranya berpotensi digunakan untuk mengonfigurasi FPGA.  Saya sarankan membuat pilihan perangkat dari daftar drop-down, memilih file melalui tombol dengan output path.  Untuk memulai unduhan, tambahkan tombol "program".  LED virtual akan menunjukkan status operasi.  Luncurkan LabVIEW. </p><br><p>  Tambahkan elemen yang diperlukan ke panel depan (Panel Depan).  Saya akan menggunakan gaya "Perak" untuk VP.  Gambar di bawah ini menunjukkan hasilnya, semua elemen dalam kondisi murni mereka.  Dengan nama, jika perlu, mereka cukup mudah ditemukan di palet. </p><br><img src="https://habrastorage.org/webt/qq/os/bt/qqosbtkepb8n5fe2l3_qnz309q8.png"><br><p><br>  Kami mengedit elemen: kami mentransfer, meregangkan, kami menambahkan prasasti - kami membawa ke formulir yang diperlukan.  Di sini, pada kenyataannya, tangan desainer diperlukan, tetapi yang saya bisa: </p><br><img src="https://habrastorage.org/webt/wd/sp/iz/wdspizcngovsuygvcmkofpnepjw.png"><br><p><br>  Dan diagram blok: </p><br><img src="https://habrastorage.org/webt/l0/g_/hi/l0g_hij_xwkzm3n-sfrqe6pfypg.png"><br><p><br>  Saya menarik perhatian Anda.  Setiap elemen memiliki dua properti yang menentukan nama - Label dan Keterangan. </p><br><img src="https://habrastorage.org/webt/pi/xi/r9/pixir9kcyslk2iscflmbtfxtpmq.png"><br><p><br>  Properti pertama menetapkan nama elemen, di bawah nama ini akan ditampilkan pada diagram blok.  Label, tidak seperti Keterangan, tidak dapat diubah selama pelaksanaan VI.  Sehubungan dengan fitur ini, saya sarankan Anda menyembunyikan Label di VI Anda di panel depan dan menampilkan Keterangan.  Untuk Label, buatlah nama yang bermakna, sebagai variabel dalam bahasa pemrograman klasik, lebih disukai dalam tata letak Latin.  Untuk Caption, kami akan memperkenalkan nama yang berorientasi pada manusia, bisa sangat panjang, termasuk spasi dan, jika perlu, dalam bahasa Rusia.  Menggunakan LabVIEW, Anda dapat menyesuaikan font tampilan untuk Keterangan.  Saya harus mengatakan bahwa tidak ada yang memaksa kita untuk mengacaukan Keterangan: setiap prasasti dapat dibuat langsung di <abbr title="Panel depan">FP</abbr> di tempat bebas apa pun. </p><br><p> Kami menerapkan operasi VP sesuai dengan skema klasik: While dan event handler.  Tambahkan loop <code>While</code> (Pemrograman -&gt; Struktur -&gt; Loop Sementara) ke diagram blok, dan struktur pengendali acara (Pemrograman -&gt; Struktur -&gt; Struktur Acara). </p><br><div class="spoiler">  <b class="spoiler_title">Bantuan Singkat tentang Struktur Acara</b> <div class="spoiler_text"><p>  Struktur menunggu peristiwa terjadi, kemudian pawang yang sesuai mengeksekusi.  Struktur peristiwa memiliki satu atau beberapa subdiagram - penangan peristiwa, yang disebut kasus, salah satunya dieksekusi ketika suatu peristiwa terjadi.  Menggunakan terminal di sudut kiri atas, Anda dapat menentukan jumlah milidetik selama struktur mengharapkan suatu peristiwa.  Jika selama waktu ini tidak ada peristiwa yang terjadi, sub-diagram "Batas Waktu" akan dieksekusi.  Nilai default adalah minus 1, yang berarti batas waktu tidak pernah berakhir. </p><br><img src="https://habrastorage.org/webt/ol/qj/uo/olqjuooy0reae8un_fyw5bs2l78.png"><br><br><ol><li>  Label pemilih acara menunjukkan acara mana yang memicu kasus saat ini.  Untuk melihat penangan lain, Anda dapat mengklik panah bawah di sebelah nama acara. </li><li>  Terminal <code>timeout</code> menetapkan jumlah milidetik untuk menunggu suatu peristiwa.  Jika nilainya selain -1, maka subdiagram Timeout harus diimplementasikan. </li><li>  Terminal untuk memasuki acara dinamis.  Terminal ini tidak ditampilkan secara default.  Untuk menampilkannya, pilih "Show Dynamic Event Terminal" di menu konteks. </li><li>  Simpul data acara.  Ketika suatu peristiwa terjadi, LabVIEW menghasilkan data yang terkait dengan acara ini.  Node ini menyediakan data ini ke handler.  Anda dapat menggunakan mouse untuk mengubah ukuran simpul secara vertikal dan memilih elemen yang diperlukan.  Beberapa data, seperti <code>Type</code> dan <code>Time</code> , umum untuk semua peristiwa, yang lain, seperti <code>Char</code> dan <code>VKey</code> , tergantung pada jenis acara yang dikonfigurasi. </li><li>  Node filter peristiwa menentukan data peristiwa yang dapat Anda modifikasi sebelum antarmuka pengguna memproses data ini.  Node ini hanya ditampilkan pada penangan yang menyediakan penyaringan.  Anda bisa menghubungkan dan mengubah item dari node data acara ke simpul filter acara.  Anda juga dapat mengubah peristiwa ini dengan menghubungkan nilai-nilai baru ke terminal simpul.  Bisakah saya sepenuhnya membatalkan reaksi antarmuka ke acara jika saya mengirimkan <code>true</code> ke terminal <code>Discard?</code>  .  Jika Anda tidak menghubungkan nilai ke elemen filter, maka elemen data ini tetap tidak berubah. </li><li>  Seperti struktur <code>Case</code> , struktur acara mendukung terowongan.  Jika Anda menambahkan sebuah terowongan dalam satu kasus, itu akan secara otomatis dibuat untuk setiap penangan.  Namun, secara default tidak perlu menghubungkan terowongan output dari struktur acara di setiap handler.  Semua terowongan yang tidak terhubung menggunakan nilai default untuk tipe data terowongan.  Secara potensial, ini dapat menyebabkan kesalahan yang sulit dideteksi.  Anda dapat mengembalikan mode di mana terowongan harus ditransfer di semua penangan, untuk ini, pilih "Gunakan Default Jika Tidak Dikabel" dalam menu konteks. </li></ol></div></div><br><p>  Pertama-tama, kami akan mengurus bagaimana siklus berakhir dan keluar dari program.  Cara termudah adalah menambahkan tombol stop, yang akan menghentikan siklus, tetapi, menurut pendapat saya, adalah kebiasaan untuk mengakhiri program dengan palang merah di sudut atas jendela. <br>  Tambahkan handler yang sesuai ke <code>Event Structure</code> .  Di menu konteks, pilih "Tambah Kasus Acara".  Sebagai sumber acara, pilih "VI ini", acara menunjukkan "Panel Tutup?" </p><br><div class="spoiler">  <b class="spoiler_title">Edit acara</b> <div class="spoiler_text"><p> <a href=""><img src="https://habrastorage.org/webt/bt/xo/qv/btxoqvdb2l67eohk78xrvwnhgcg.png"></a> <br>  <em>Gambar yang dapat diklik</em> </p></div></div><br><p>  Harap dicatat, jika Anda memilih "Panel Close" (tanpa pertanyaan), maka acara ini tanpa filter, tidak dapat dibatalkan.  Dan jika dengan sebuah pertanyaan, maka ketika Anda mengklik tanda salib, kita dapat mengambil kendali dan menyelesaikan program dengan benar secara independen.  Di "Panel Close?"  melalui terowongan kita menghubungkan konstanta Boolean <code>true</code> dengan terminal untuk menghentikan <code>while</code> .  Input "Buang?"  juga melayani dengan <code>true</code> . </p><br><p>  Sekarang tidak ada nuansa yang jelas: jika VI saat ini diluncurkan bukan di lingkungan LabVIEW, tetapi dalam bentuk aplikasi yang dikompilasi, maka mengklik salib tidak menutup jendela, tetapi menghentikan aplikasi, yang tidak kita butuhkan.  Untuk mengatasi masalah ini, setelah selesainya siklus utama, kami akan memeriksa apakah kami berada dalam lingkungan pengembangan atau dalam mode program, jika masih dalam mode program, maka kami akan mengakhiri aplikasi.  Untuk memahami di mana VI saat ini berjalan, gunakan simpul properti (Pemrograman -&gt; Kontrol Aplikasi -&gt; Node Properti).  Node ini menyediakan akses ke properti dari suatu objek dengan merujuk ke objek ini.  Dalam hal ini, kita harus mendapatkan tautan ke seluruh aplikasi secara keseluruhan.  Pilih konstanta <code>VI Server Reference</code> dari palet yang sama.  Setelah konstanta diset ke diagram blok, Anda perlu mengubah tipenya menjadi <code>This Application</code> (tombol kiri mouse).  Kami menghubungkan tautan yang dihasilkan dengan simpul properti.  Pilih properti <code>Application:Kind Property</code> - mengembalikan jenis sistem LabVIEW di mana VI saat ini berjalan.  Kami menghubungkan output properti ke Struktur Kasus, tambahkan kasus "Run Time System", di mana kami mengakhiri aplikasi ( <code>Quit LabVIEW</code> ).  Agar blok ini dapat dieksekusi setelah siklus, dan bukan sebelumnya, kami menghubungkan <code>error in</code> terminal input ke siklus melalui terowongan. </p><br><p> <a href=""><img width="720" src="https://habrastorage.org/webt/il/nm/ty/ilnmtyv89c3yv-nogcksavitbnu.png"></a> <br>  <em>Gambar yang dapat diklik</em> </p><br><p>  Sekarang ketika Anda memulai program, Anda dapat menghentikannya dengan mengklik tanda silang jendela.  Program yang diluncurkan terlihat seperti ini: </p><br><img src="https://habrastorage.org/webt/pv/9e/za/pv9ezax9jrro78shza6coogtu_4.png"><br><p><br>  Menurut saya, banyak yang berlebihan.  Pergi ke properti VI (File -&gt; menu VI Properties), pilih kategori "Window Appearance", atur Custom. </p><br><p>  Matikan tampilan menu (tetap dalam mode editing), matikan bilah gulir, sembunyikan bilah alat ketika aplikasi sedang berjalan (Tampilkan bilah alat saat menjalankan).  Kami melarang mengubah ukuran jendela, kami memungkinkan meminimalkan dan meminimalkan jendela.  Itu lebih baik: </p><br><img src="https://habrastorage.org/webt/a9/mg/u-/a9mgu-7km4wqkzj_rgdmc4mgfse.png"><br><p><br>  Tentu saja, ada baiknya menghapus prasasti "Instrumen Nasional. Perangkat Lunak Evaluasi LabVIEW", tetapi saya tidak ingin membeli lisensi untuk komputer di rumah, kami akan memasang prasasti dan mengelola masa uji coba 45 hari. </p><br><p>  Secara alami, Anda dapat menyesuaikan warna latar belakang dan setiap elemen, memilih font, tapi saya bukan seorang desainer, tetapi sesuatu memberitahu saya bahwa saya hanya akan memperburuknya. </p><br><h2 id="spisok-priborov">  Daftar Instrumen </h2><br><p>  VP harus menawarkan kepada pengguna daftar perangkat yang terhubung ke komputer yang sesuai untuk firmware FPGA sehingga pengguna dapat memilih yang diinginkan.  Di perpustakaan FTD2XX, fungsi <code>FT_CreateDeviceInfoList</code> dan <code>FT_GetDeviceInfoDetail</code> untuk tujuan ini dimaksudkan.  Seperti dibahas dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">artikel sebelumnya</a> , pustaka driver dapat digunakan untuk menggunakan API FTD2XX.  LabVIEW memiliki mekanisme yang nyaman untuk berinteraksi dengan pustaka dinamis - simpul Simpul Fungsi Pustaka Panggilan, Anda dapat menemukannya di palet "Konektivitas -&gt; Perpustakaan &amp; Eksekusi".  Node panggilan fungsi harus dikonfigurasi: pertama, tentukan jalur ke dll (tab "Function"), setelah itu sistem memindai perpustakaan dan meminta Anda untuk memilih nama fungsi dalam daftar "Function Name" - pilih <code>FT_CreateDeviceInfoList</code> , konvensi pemanggilan - pilih <strong>stdcall (WINAPI)</strong> .  Kedua, pada tab "Parameter", Anda harus memasukkan daftar parameter fungsi, di mana elemen pertama dari daftar adalah nilai balik.  Di sini akan lebih baik untuk mengingat dokumentasi untuk API, atau file header.  Saat mengatur parameter di area "Function prototype", prototipe dari fungsi yang diimpor ditampilkan.  Ketika tanda tangan dari dokumentasi cocok dengan prototipe yang dikonfigurasi, klik OK. </p><br><p>  Misalkan pemindaian harus dilakukan sekali per detik.  Kami menempatkan simpul panggilan dalam struktur event handler pada tab "Timeout", mengatur waktu tunggu hingga 1000 ms.  Kami menambahkan indikator ke pin node, dan jika semuanya dilakukan dengan benar, maka ketika memulai VI, jumlah perangkat yang terhubung dengan FTDI harus ditampilkan: </p><br><div class="spoiler">  <b class="spoiler_title">Panel depan dan diagram blok</b> <div class="spoiler_text"><p> <a href=""><img width="720" src="https://habrastorage.org/webt/sc/pg/fr/scpgfrpwkg3gi5hepnez6b8l_nc.png"></a> <br>  <em>Gambar yang dapat diklik</em> </p><br><img src="https://habrastorage.org/webt/v7/cy/fu/v7cyfuon36rdj3wxlwoaotzt_2c.png"></div></div><br><p>  Demikian pula, buat simpul untuk fungsi <code>FT_GetDeviceInfoDetail</code> .  Prototipe fungsi adalah: </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">FTD2XX_API FT_STATUS WINAPI </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FT_GetDeviceInfoDetail</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( DWORD dwIndex, LPDWORD lpdwFlags, LPDWORD lpdwType, LPDWORD lpdwID, LPDWORD lpdwLocId, LPVOID lpSerialNumber, LPVOID lpDescription, FT_HAN</span></span></span></span></code> </pre> <br><p>  Saat menjelaskan parameter, harus dicatat bahwa <code>lpdwFlags</code> , <code>lpdwType</code> , <code>lpdwID</code> , <code>lpdwLocId</code> diteruskan sebagai pointer ke <code>uint32</code> .  Parameter <code>lpSerialNumber</code> dan <code>lpDescription</code> adalah inti dari byte string ( <code>char</code> array dengan terminator nol).  Parameter semacam ini di simpul panggilan dapat diformat dengan berbagai cara, Anda dapat memasukkannya ke dalam susunan kata 8-bit, tetapi saya pikir paling mudah untuk segera menunjukkan bahwa ini adalah string dan mengatur ukuran yang diharapkan.  Dalam hal ini, output akan langsung menjadi garis "labirin" yang valid dan tidak ada transformasi tambahan yang diperlukan. </p><br><img src="https://habrastorage.org/webt/zi/n8/8t/zin88t8hl5je5csuxcq7l_bbk9c.png"><br><p>  Panggil fungsi perpustakaan </p><br><p>  Fungsi ini mengembalikan informasi dengan nomor seri <code>dwIndex</code> .  Jika beberapa FTDI terhubung ke komputer, untuk membaca informasi untuk setiap konverter, fungsinya harus dipanggil dalam satu lingkaran.  Jumlah iterasi dari loop akan diberikan kepada kami oleh fungsi <code>FT_CreateDeviceInfoList</code> sebelumnya. </p><br><div class="spoiler">  <b class="spoiler_title">Panel depan dan diagram blok</b> <div class="spoiler_text"><p> <a href=""><img width="720" src="https://habrastorage.org/webt/sr/2a/gq/sr2agqtusiwcn3tcttwqbncllgk.png"></a> <br>  <em>Gambar yang dapat diklik</em> </p><br><img src="https://habrastorage.org/webt/t9/dg/tl/t9dgtlw3lapeklhbi4y3tzca0lm.png"></div></div><br><p>  Ada fitur yang tidak menyenangkan: semua port node panggilan harus terhubung setidaknya di satu sisi.  Oleh karena itu, sebuah terowongan dibuat dalam loop untuk terminal-terminal output yang tidak akan kita gunakan. </p><br><p>  <code>Types</code> array berisi tipe chip FTDI, kami membutuhkannya untuk membatasi pilihan hanya pada mereka yang mendukung MPSSE dan berpotensi dapat digunakan untuk pemrograman FPGA.  Namun, beroperasi dengan "angka ajaib" tidak nyaman - saya mengusulkan untuk mengatur tipe FTDI dalam bentuk <code>enum</code> .  Selain itu, <code>enum</code> seperti <code>enum</code> sudah ada dalam file header ftd2xx.h.  Di LabVIEW, Anda bisa menggunakan dua kontrol untuk membuat enumerasi: Cincin Teks dan Enum itu sendiri.  Keduanya berisi daftar string dengan nilai numerik di antaranya Anda dapat beralih.  Perbedaan utama adalah bahwa "Enum" mensyaratkan bahwa nilai numerik menjadi bilangan bulat berturut-turut, sedangkan "Teks Cincin" memiliki lebih banyak kebebasan - Anda dapat menentukan nilai apa pun. </p><br><div class="spoiler">  <b class="spoiler_title">Enum.</b>  <b class="spoiler_title">Ciptaan</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/v9/ye/ik/v9yeik6iwgvetbpoa2wcf9b0kn8.png"><br><p>  <em>Kami memasukkan nilai secara manual, sangat disayangkan tidak ada fungsi untuk mengimpor <code>enum</code> dari C</em> </p><br><img src="https://habrastorage.org/webt/en/jd/4r/enjd4rvd8snxw6fhtstrinlcvey.png"><br><p>  <em>Di panel depan indikator ini terlihat seperti ini</em> </p><br><img src="https://habrastorage.org/webt/yc/t6/er/yct6erqkpta8o-a4mnp7vfbty7w.png"><br><p>  <em>Memilih nilai dengan mengklik kiri</em> </p></div></div><br><p>  Untuk menautkan dan menyinkronkan semua instance daftar yang dibuat di masa mendatang, akan lebih mudah menggunakan "Make Type Def."  (pemilihan melalui menu konteks item).  Akibatnya, tipe data khusus akan dibuat.  Tipe baru ditempatkan di file terpisah dengan ekstensi * .ctl.  Mengedit file ini akan mengubah semua instance elemen ini.  Saya pikir tidak ada gunanya menjelaskan betapa nyamannya hal ini.  Akses ke file definisi dapat diperoleh dari menu konteks instance dengan memilih "Open Type Def", di menu yang sama Anda harus memperhatikan item "Auto-Update from Type Def."  dan "Putus dari Jenis Def". </p><br><p>  Kami mengubah indikator <code>Types</code> menjadi array indikator dari <code>FTDI Type</code> dan sebagai hasilnya, ketika VI mulai, tipe konverter yang terhubung ditampilkan: </p><br><img src="https://habrastorage.org/webt/zy/07/zy/zy07zy2phqs7mc_q8a4hur1hunw.png"><br><p>  <em>Tiga perangkat ditemukan</em> </p><br><p>  Sangat mudah untuk melihat bahwa fungsionalitas kode yang dihasilkan dalam kasus "Timeout" selesai, oleh karena itu dapat dipindahkan ke SubVI yang terpisah.  Pilih elemen yang ingin kita transfer ke subdevice dan pilih "Buat SubVI" dari menu utama Edit. </p><br><div class="spoiler">  <b class="spoiler_title">diagram blok dengan sub-instrumen yang dibuat</b> <div class="spoiler_text"><p>  Semua indikator tetap ada, dan VI baru dengan ikon standar dibentuk menggantikan node panggilan. <br> <a href=""><img src="https://habrastorage.org/webt/wz/oo/ba/wzoobavcvisx9kmmntke3m_2pxe.png"></a> <br>  <em>Gambar yang dapat diklik</em> </p></div></div><br><p>  Mengklik dua kali pada subVI baru akan meluncurkan jendela pengeditannya.  Pertama-tama, kami menyimpannya dan memberikan nama yang bermakna, misalnya, "FT_GetDeviceInfo".  Siapkan terminal I / O.  Untuk melakukan ini, gunakan Panel Connector: </p><br><img src="https://habrastorage.org/webt/1e/fs/gw/1efsgw6lcoaoauj-qguyus4fbn4.png"><br><p>  Panel adalah seperangkat terminal yang sesuai dengan kontrol dan indikator VI. </p><br><p>  Jika Anda memilih terminal pada panel koneksi, elemen yang sesuai pada panel depan disorot.  Jika Anda memilih terminal kosong dan kemudian mengklik elemen di panel depan, maka elemen tersebut akan dilampirkan ke terminal, tetapi sebelum itu tidak boleh ditugaskan ke terminal lain.  Dalam menu konteks, Anda dapat secara individu atau sekaligus memutuskan terminal dari elemen, Anda dapat mengubah pola panel secara keseluruhan. </p><br><p>  Saya tidak suka bagaimana terminal ditugaskan saat membuat subVI saat ini, jadi saya pilih "Putuskan Semua Terminal" dan tandai secara manual.  Saya merekomendasikan menempatkan terminal input di sebelah kiri, dan output di sebelah kanan, input opsional dapat ditempatkan di atas, dan output opsional di bagian bawah.  Ini akan memastikan pembacaan kode dan tatanan visual yang baik dalam diagram blok. </p><br><p>  Untuk mengontrol kesalahan, buat dua elemen tambahan, <code>Error in</code> dan <code>Error out</code> .  Topik kesalahan kontrol LabVIEW sangat luas dan melampaui ruang lingkup artikel ini, jadi kami akan membatasi diri pada penjelasan minimum dan mematuhi prinsip "do as I".  Jadi, kami membuat dua terminal untuk kesalahan - input dan output. </p><br><div class="spoiler">  <b class="spoiler_title">Lebih mudah untuk membuatnya menggunakan menu konteks</b> <div class="spoiler_text"><p>  Klik kanan pada terminal kesalahan dari sembarang simpul: </p><br><img src="https://habrastorage.org/webt/ul/ew/re/ulewre7rct2swn34bhqejv3kg24.png"></div></div><br><p>  Di LabVIEW, sudah biasa menempatkan terminal input dari kesalahan pada panel koneksi di kiri bawah, dan terminal output di kanan bawah. </p><br><p>  Akan lebih mudah untuk menggabungkan output ke dalam suatu struktur.  Untuk output, kita akan membuat dua array: array pertama akan berisi semua perangkat FTDI yang ditemukan, array kedua hanya akan berisi yang bisa MPSSE dan secara teoritis dapat digunakan untuk mengkonfigurasi FPGA. </p><br><p>  Sentuhan terakhir saat membuat sub-instrumen adalah mengkonfigurasi ikon.  Mengklik dua kali pada ikon di sudut kanan atas jendela akan meluncurkan editor.  Kami mencoba untuk membuat semacam gambar yang bermakna yang memungkinkan kami untuk menafsirkan tujuan perangkat secara jelas dalam diagram blok. </p><br><div class="spoiler">  <b class="spoiler_title">FT_GetDeviceInfo.vi</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/l1/hy/sd/l1hysdhgshztti7xczw7tjmbex0.png"><br><p>  <em>Panel depan</em> </p><br><img src="https://habrastorage.org/webt/a4/ba/5w/a4ba5wwquuv-coxuxpxzjo8xwio.png"><br><p>  <em>Diagram blok</em> </p><br><p>  Dan ini adalah bagaimana kasus "Timeout" terlihat setelah membereskan semuanya: <br> <a href=""><img src="https://habrastorage.org/webt/ea/yu/6d/eayu6ddx32eq_easysclsqqp7pg.png"></a> <br>  <em>Gambar yang dapat diklik</em> </p></div></div><br><p>  Hingga saat ini, daftar drop-down dengan nama "Select a device" kosong, sekarang kami memiliki data untuk mengisinya.  Kami membuat simpul properti untuk daftar dengan properti "Strings []" (menu konteks -&gt; Buat -&gt; Properti Node -&gt; Strings []).  Setiap properti dapat ditulis dan dibaca, mode saat ini dipilih dalam menu konteks dari Property Node.  Saat membuat simpul secara default, properti dikonfigurasikan untuk membaca.  Ubah untuk menulis: "Ubah Untuk Menulis". </p><br><p>  Dari array struktur, pilih array dengan deskripsi dan berikan ke <code>Strings[]</code> .  Anda dapat memilih array menggunakan <code>For Loop</code> . </p><br><p>  Setelah memulai VI, menekan tombol kiri pada elemen "Pilih perangkat", Anda dapat menentukan perangkat untuk konfigurasi.  Dalam hal ini, daftar perangkat diperbarui dua kali per detik.  Tentu saja, akan mungkin untuk memperbarui properti hanya jika daftar telah diperbarui, tetapi sejauh ini akan menghasilkan kekacauan yang tidak perlu dari diagram blok. </p><br><div class="spoiler">  <b class="spoiler_title">Apa yang terjadi</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/_t/gh/i7/_tghi7fjgo0hhb6thtdcosvfp1m.png"><br><p>  <em>Panel depan</em> </p><br><p> <a href=""><img src="https://habrastorage.org/webt/x6/wo/3v/x6wo3v0sqbdvwzhksbg4kghoeho.png"></a> <br>  <em>Gambar yang dapat diklik</em> </p><br><p>  Sebelumnya, saya lupa menyebutkan fitur yang menarik, loop For tidak harus menentukan jumlah iterasi secara eksplisit, cukup membuat terowongan input array dan loop akan mengeksekusi untuk setiap elemen, perilaku ini menyerupai <strong><code>foreach</code></strong> di C ++ 11.  Namun, Anda harus berhati-hati ketika lebih dari satu array tiba di input loop. </p></div></div><br><p>  Dalam struktur acara, tambahkan penangan untuk menekan tombol "program".  Meskipun kami tidak memiliki VI yang bertanggung jawab untuk memuat file ke FPGA, kami akan membuat sub-perangkat "rintisan".  Misalkan dibutuhkan path ke file konfigurasi dan deskriptor FTDI sebagai input, dan menurut hasil operasi itu mengembalikan status firmware: berhasil atau tidak.  Dan untuk membuatnya lebih menarik untuk menguji antarmuka program, kami akan membuat status ini acak. </p><br><div class="spoiler">  <b class="spoiler_title">Stub FT_MPSSE_SP_FPGA.vi</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/gy/xl/qf/gyxlqf-hzbjik3667nmzga5bf6g.png"><br><p>  <em>Panel depan</em> </p><br><img src="https://habrastorage.org/webt/f_/qz/kw/f_qzkwjrp7nqvo9yfgl0o9ovidw.png"><br><p>  <em>Diagram blok</em> </p></div></div><br><p>  Kami akan meneruskan deskriptor FTDI ke input rintisan melalui properti daftar (menu konteks -&gt; Buat -&gt; Properti Node -&gt; Teks Dering -&gt; Teks), untuk mentransfer path file ke elemen "File Path", membuat variabel lokal (menu konteks -&gt; Buat -&gt; Lokal Variabel) dan atur untuk membaca (Change To Read).  Dan hubungkan output status langsung ke indikator <code>Status</code> .  Tombol <code>Programm</code> diseret ke pengendali acara.  Merupakan praktik yang baik untuk menempatkan elemen-elemen yang peristiwanya dikonfigurasikan dalam penangan - sekarang mengklik dua kali pada elemen ini di panel depan tidak hanya akan menunjukkan elemen yang sesuai dalam diagram blok, tetapi juga penangan peristiwa yang terkait dengan elemen ini. </p><br><p>  Sekarang, dengan menekan tombol "Program", indikator menjadi hijau (sukses) atau hijau gelap (tidak berhasil).  Tidak terlalu jelas.  Di properti indikator, ubah warna "Mati" menjadi merah.  Itu lebih baik.  Jika indikator berwarna hijau, maka kita dapat mengatakan bahwa FPGA pada perangkat yang dipilih dikonfigurasi oleh file, jalur yang ditunjukkan di jendela: </p><br><img src="https://habrastorage.org/webt/wl/le/re/wllerexz4zkxjzemfyspv_3yyoo.png"><br><p>  <em>Panel depan</em> </p><br><p>  Tetapi pernyataan ini menjadi salah jika kita mengubah file atau memilih perangkat lain.  Pada saat yang sama, kami tidak dapat mewarnai indikator merah, karena kesalahan pemrograman tidak terjadi.  Dalam hal perubahan file atau perangkat, akan lebih mudah untuk menekankan bahwa nilai indikator tidak relevan - menggelapkannya.  Untuk ini, Anda dapat menggunakan properti indikator <code>Disabled</code> .  Properti ini dapat mengambil tiga nilai. <code>Enabled</code> - tampilan normal, pengguna dapat mengontrol objek;  <code>Disabled</code> - objek ditampilkan di panel depan seperti biasa, tetapi pengguna tidak dapat mengontrol objek;  <code>Disabled and Grayed Out</code> - objek ditampilkan pada panel depan yang gelap, dan pengguna tidak dapat mengontrol objek. </p><br><p>  Kami membuat penangan acara untuk <code>Devices list</code> dan <code>File Path</code> , dan di dalamnya kami menggelapkan indikator status, dan di penangan kami menetapkan tombol "Program" untuk properti <code>Enabled</code> . </p><br><div class="spoiler">  <b class="spoiler_title">Apa yang terjadi</b> <div class="spoiler_text"><p> <a href=""><img src="https://habrastorage.org/webt/59/xl/da/59xldabidafiphelnavil1h3iue.png"></a> <br>  <em>Handler "Programm": Perubahan Nilai.</em> </p><br><p> <a href=""><img src="https://habrastorage.org/webt/i4/xm/sx/i4xmsxdxklfiusfqfamtyqxpoog.png"></a> <br>  <em>Penangan daftar perangkat: Perubahan Nilai</em> </p><br><img src="https://habrastorage.org/webt/w3/58/dn/w358dn13xtxn61o6o5frte7-gsk.png"><br><p>  <em>Ini adalah bagaimana indikator yang gelap terlihat</em> </p></div></div><br><p>  Mari kita cari file konfigurasi dengan nyaman bagi pengguna - kita akan mengonfigurasi jendela tampilan file.  Pergi ke properti elemen <code>File Path</code> , pada tab "Browse Options", isi Prompt, Label Pola, tentukan filter jenis file (Pola) dan nama untuk tombol (Teks Tombol). </p><br><div class="spoiler">  <b class="spoiler_title">Jendela pemilihan file</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/vf/i2/yc/vfi2ycpuj_lhydbcp1jebbjb0ni.png"><br><p>  <em>Hanya file rbf yang ditampilkan</em> </p><br><img src="https://habrastorage.org/webt/1-/w3/e8/1-w3e8dg3uauxccfq8-buzrs75y.png"></div></div><br><p>  Membuat antarmuka pengguna dapat dianggap lengkap. </p><br><img src="https://habrastorage.org/webt/tm/5w/oq/tm5woq3kwnfgmo38klp_5qxenug.png"><br><p>  <em>Menjalankan bootloader</em> </p><br><h2 id="s-chem-poznakomilis-segodnya">  Apa yang kamu temui hari ini? </h2><br><p>  Pada artikel ini, sebagai contoh membuat aplikasi lengkap fungsional dengan antarmuka minimalis, saya mencoba untuk menunjukkan berbagai pendekatan untuk bekerja di LabVIEW. </p><br><p>  Sebagai hasilnya, kami menyentuh mereka: </p><br><ul><li>  Mengatur properti alat virtual.       . </li><li>   :   . </li><li>    . </li><li>  . </li><li>    dll. </li><li>    . </li></ul><br><p>         API FTD2XX   MPSSE.     . </p><br><h2 id="materialy-po-teme">    </h2><br><ol><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">     USB   FTDI MPSSE</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">labview_mpsse</a> .   . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">   </a> .    </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Software Application Development D2XX Programmer's Guide</a> .   API D2XX. </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id427529/">https://habr.com/ru/post/id427529/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id427519/index.html">@Kubernetes Meetup di Mail.Ru Group: 29 Oktober dan selalu</a></li>
<li><a href="../id427521/index.html">Hadiah Terobosan 2019. Pemenang Milner, Brin, dan Zuckerberg Science Award diumumkan.</a></li>
<li><a href="../id427523/index.html">Keberhasilan lindung nilai</a></li>
<li><a href="../id427525/index.html">Intel Core 9th Gen dalam jumlah dan tolok ukur</a></li>
<li><a href="../id427527/index.html">10 trik untuk dasbor tingkat lanjut di Splunk. Bagian 2</a></li>
<li><a href="../id427531/index.html">Dari Siberia ke Siprus dan kembali - kisah seorang imigran yang gagal</a></li>
<li><a href="../id427533/index.html">Jam tangan pintar yang tidak memerlukan pengisian daya. Apakah mereka banyak?</a></li>
<li><a href="../id427535/index.html">Kami meluncurkan pilihan solusi kolektif</a></li>
<li><a href="../id427537/index.html">Bagaimana menjadi manajer produk yang sukses: kursus di mana Anda dilatih sekarang</a></li>
<li><a href="../id427539/index.html">Eropa terakhir kali mengatur jam untuk waktu musim dingin</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>