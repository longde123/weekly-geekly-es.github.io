<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧖 🔍 👩🏻‍🌾 Obtenez des extraits du registre sur le site Web de FTS en utilisant python 🙏🏼 👨🏿‍🍳 👩🏼‍🏫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Le site Web du Service fédéral des impôts à egrul.nalog.ru/index.html offre un merveilleux service pour vérifier les entrepreneurs ou leurs propres en...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Obtenez des extraits du registre sur le site Web de FTS en utilisant python</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/455808/"> Le site Web du Service fédéral des impôts à <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">egrul.nalog.ru/index.html</a> offre un merveilleux service pour vérifier les entrepreneurs ou leurs propres entreprises. <br><br>  L'essence du contrôle est de soumettre une demande au Registre d'État unifié des entités juridiques (un registre unifié des faits des coordonnées des entités juridiques) et de recevoir un extrait du registre directement sur le site, en ligne. <br><br>  Travailler avec le service ne pose aucune difficulté: je l'ai ajouté au PSRN, j'ai cliqué sur le bouton "Rechercher" et j'ai cliqué sur le bouton "Télécharger" ci-dessous.  Tout, l'extrait est reçu. <br><br>  Comment l'automatisation peut-elle aider ici?  Très simple. <br><br>  Si votre exploitation se compose d'un nombre n d'entités juridiques, même un travail tel que la copie OGRN dans une chaîne de recherche de service peut s'ennuyer. <br><br>  Nous allons nous débarrasser de la routine et automatiser le processus de classement et de téléchargement des extraits du registre! <br><a name="habracut"></a><br>  Dans notre cas, le programme «récupérera» un OGRN dans un tableau Excel pré-préparé, saisira la valeur dans la ligne de service, appuyez sur les boutons nécessaires. <br><br>  Idéalement, le programme ressemblera à ceci: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/4SFv-qA7nnE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Commençons. <br><br>  Tout d'abord, préparez le tableau Excel, où nous ajouterons l'ORGRN, sur lequel nous travaillerons, dans la colonne: <br><br><img src="https://habrastorage.org/webt/4-/q9/jo/4-q9jowp4ndp03msxj8z_0ionxg.jpeg"><br><br>  Le nombre d'OGRN n'a pas d'importance (vous pouvez même télécharger l'intégralité de USRLE), l'essentiel est qu'ils soient tous dans la colonne A. <br><br>  Nous nommerons le fichier d'extractionEGRUL.xlsx et l'enregistrerons dans le répertoire de travail python. <br><br>  Créez maintenant le fichier avec le programme lui-même - egrul.py. <br><br>  Les premières lignes du programme, comme d'habitude, commencent par l'importation des modules nécessaires, puis nous sélectionnons le navigateur (dans mon cas Chrome) et «allons» sur le site: <br><br><img src="https://habrastorage.org/webt/6a/3z/ef/6a3zefaigfnu2dxzhmu8jheluxo.png"><br><br>  Ensuite, nous exécutons une boucle à travers tous les PSRN dans le tableau Excel: <br><br><img src="https://habrastorage.org/webt/bu/lj/lg/buljlghlss8pktru_uily7tpz30.png"><br><br>  Ici, vous devez faire attention aux valeurs x au début du cycle: <br><br><img src="https://habrastorage.org/webt/yg/dh/bv/ygdhbvi-abyjioabexasn-ewhmy.png"><br><br>  2- c'est la cellule initiale avec OGRN (start), qui correspond à A2 dans le tableau Excel.  La cellule finale sera A9, bien que le nombre 10 soit indiqué dans la boucle. <br><br>  Il faut garder à l'esprit que tous les OGRN ont été traités et que la dernière valeur n'a pas été perdue. <br>  Le programme résiste à une pause de 30 secondes entre le dépôt d'une demande auprès de l'USRLE.  Cela peut sembler inacceptablement long et cette période devra être raccourcie.  Cela peut être fait en modifiant la valeur de la ligne time.sleep (30) en, par exemple, time.sleep (10).  Cependant, dans ce cas, vous pouvez tomber sous le coup des sanctions du Service fédéral des impôts et obtenir du captcha.  Vous pouvez contourner ce captcha, mais c'est un sujet pour un article séparé.  Et dans ce programme, il est préférable de laisser un délai entre les demandes de dépôt de 30 secondes et d'aller tranquillement boire du thé pendant que le programme fonctionne pour vous. <br><br>  Le lien vers le programme est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  Lien vers le tableau des tests Excel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr455808/">https://habr.com/ru/post/fr455808/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr455794/index.html">Introduction à Spring, ou quoi faire si l'ensemble du projet est @Autowired et @Component, mais vous ne comprenez pas de quoi il s'agit</a></li>
<li><a href="../fr455796/index.html">Programmation orientée objet en Java et Python: similitudes et différences</a></li>
<li><a href="../fr455800/index.html">Matrix 1.0 - Version du protocole de messagerie décentralisée</a></li>
<li><a href="../fr455802/index.html">Comment assembler l'Olympic par le biais de newsletters par e-mail. Case Black Star</a></li>
<li><a href="../fr455806/index.html">Naissance et mort d'un album: nous comprenons comment les formats musicaux ont changé au cours des 100 dernières années</a></li>
<li><a href="../fr455812/index.html">Construire une architecture de microservices sur Golang et gRPC, partie 2 (docker)</a></li>
<li><a href="../fr455816/index.html">Comment créer une action sympa pour Google Assistant. Lifehacks de Just AI</a></li>
<li><a href="../fr455820/index.html">Analyse des performances des machines virtuelles dans VMware vSphere. Partie 2: Mémoire</a></li>
<li><a href="../fr455826/index.html">Arrosage automatique télécommandé</a></li>
<li><a href="../fr455828/index.html">Les scientifiques ont découvert de nouvelles formes de synchronisation exotiques</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>