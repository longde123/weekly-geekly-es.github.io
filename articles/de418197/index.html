<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöÇ üßìüèæ üçú MIT-Kurs "Computer Systems Security". Vorlesung 4: ‚ÄûPrivilegien teilen‚Äú, Teil 2 üë©üèª‚Äçüíº ‚ö±Ô∏è üõåüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Massachusetts Institute of Technology. Vorlesung # 6.858. "Sicherheit von Computersystemen." Nikolai Zeldovich, James Mickens. 2014 Jahr 
 Computer Sy...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>MIT-Kurs "Computer Systems Security". Vorlesung 4: ‚ÄûPrivilegien teilen‚Äú, Teil 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/418197/"><h3>  Massachusetts Institute of Technology.  Vorlesung # 6.858.  "Sicherheit von Computersystemen."  Nikolai Zeldovich, James Mickens.  2014 Jahr </h3><br>  Computer Systems Security ist ein Kurs zur Entwicklung und Implementierung sicherer Computersysteme.  Die Vortr√§ge behandeln Bedrohungsmodelle, Angriffe, die die Sicherheit gef√§hrden, und Sicherheitstechniken, die auf j√ºngsten wissenschaftlichen Arbeiten basieren.  Zu den Themen geh√∂ren Betriebssystemsicherheit, Funktionen, Informationsflussmanagement, Sprachsicherheit, Netzwerkprotokolle, Hardwaresicherheit und Sicherheit von Webanwendungen. <br><br>  Vorlesung 1: ‚ÄûEinf√ºhrung: Bedrohungsmodelle‚Äú <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <br>  Vorlesung 2: ‚ÄûKontrolle von Hackerangriffen‚Äú <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <br>  Vorlesung 3: ‚ÄûPuffer√ºberl√§ufe: Exploits und Schutz‚Äú <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <br>  Vorlesung 4: ‚ÄûTrennung von Privilegien‚Äú <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <a name="habracut"></a><br><br>  Was hatten wir sonst noch auf dieser Liste?  Prozesse.  Ged√§chtnis geschieht gleichzeitig mit dem Prozess.  Wenn Sie sich also nicht in diesem Prozess befinden, k√∂nnen Sie nicht auf den Speicher zugreifen.  Der virtuelle Speicher verbessert diese Isolation f√ºr uns perfekt.  Dar√ºber hinaus k√∂nnen Sie mit dem Debugging-Mechanismus in den Speicher eines anderen Prozesses "springen", wenn Sie dieselbe Benutzer-ID haben <br><br>  Als n√§chstes haben wir das Netzwerk.  Netzwerke in <b>Unix</b> entsprechen nicht ganz dem oben beschriebenen Modell, was teilweise darauf zur√ºckzuf√ºhren ist, dass das <b>Unix-</b> Betriebssystem zuerst entwickelt wurde und dann ein Netzwerk erschien, das bald popul√§r wurde.  Es gibt ein etwas anderes Regelwerk.  Daher m√ºssen wir wirklich jemanden mit dem Netzwerk verbinden, wenn Sie das Netzwerk verwalten, oder einen Port abh√∂ren, wenn Sie als Server fungieren.  M√∂glicherweise m√ºssen Sie Daten √ºber diese Verbindung lesen oder schreiben oder Rohpakete senden und empfangen. <br><br><img src="https://habrastorage.org/webt/dw/gn/zv/dwgnzva6txwuj_esllvdnx3uexg.jpeg"><br><br>  Daher sind Netzwerke unter <b>Unix</b> meist nicht mit der <b>Benutzer-ID verbunden</b> .  Die Regeln lauten, dass jeder jederzeit eine Verbindung zu einem Computer oder einer IP-Adresse herstellen oder eine Verbindung herstellen kann.  Wenn Sie einen Port abh√∂ren m√∂chten, gibt es in diesem Fall einen Unterschied: Den meisten Benutzern ist es verboten, Ports mit einer Zahl unter dem ‚Äûmagischen Wert‚Äú von 1024 abzuh√∂ren. Grunds√§tzlich k√∂nnen Sie solche Ports abh√∂ren, in diesem Fall sollten Sie dies jedoch tun Sei ein spezieller Benutzer namens <b>"Super User"</b> mit <b>uid = 0</b> . <br><br>  Im Allgemeinen gibt es unter Unix das Konzept des Administrators oder Superusers, der durch die Kennung uid = 0 dargestellt wird und fast alle diese √úberpr√ºfungen umgehen kann. Wenn Sie also mit Root-Rechten arbeiten, k√∂nnen Sie Dateien lesen und schreiben und die Zugriffsrechte darauf √§ndern.  Das Betriebssystem erm√∂glicht Ihnen dies, da es der Meinung ist, dass Sie alle Berechtigungen haben sollten.  Und Sie brauchen wirklich solche Privilegien, um Ports mit der Nummer &lt;1024 abzuh√∂ren. Was halten Sie von einer so seltsamen Einschr√§nkung? <br><br>  <b>Zielgruppe:</b> Es identifiziert bestimmte Portnummern f√ºr bestimmte Verbindungen, z. B. f√ºr <b>http</b> an Port 80. <br><br>  <b>Professor:</b> Ja, standardm√§√üig verwendet das <b>HTTP-Protokoll</b> Port 80. Andererseits k√∂nnen andere Dienste Ports mit einer Nummer √ºber 1024 verwenden. Warum ist diese Einschr√§nkung erforderlich?  Was n√ºtzt das hier? <br><br>  <b>Zielgruppe:</b> Sie m√∂chten nicht, dass jemand versehentlich auf Ihr <b>HTTP</b> h√∂rt. <br><br>  <b>Professor:</b> Ja.  Ich denke, der Grund daf√ºr ist, dass Sie fr√ºher viele Benutzer auf demselben Computer hatten.  Sie haben sich mit ihren Anmeldungen angemeldet und ihre Anwendungen gestartet. Sie wollten also sicherstellen, dass ein zuf√§lliger Benutzer, der sich am Computer angemeldet hat, nicht auf den darauf laufenden Webserver zugreifen kann.  Da Benutzer, die von au√üen eine Verbindung herstellen, nicht wissen, wer an diesem Port arbeitet, und nur eine Verbindung zu Port 80 herstellen. Wenn ich diesen Computer betreten und meinen eigenen Webserver starten m√∂chte, √ºbertrage ich einfach den gesamten Webserververkehr an dieses Auto.  Dies ist wahrscheinlich kein sehr guter Plan, aber auf diese Weise verhindert das Unix-Netzwerksubsystem, dass zuf√§llige Benutzer bekannte Dienste steuern, die auf diesen niedrigen Portnummern ausgef√ºhrt werden.  Das ist der Grund f√ºr eine solche Einschr√§nkung. <br><br><img src="https://habrastorage.org/webt/ba/0o/qn/ba0oqn2qgabud4-_hmizsks086s.jpeg"><br><br>  Wenn Sie unter dem Gesichtspunkt des Lesens und Schreibens von Verbindungsdaten eine Deskriptordatei f√ºr einen bestimmten Socket haben, k√∂nnen Sie mit <b>Unix</b> alle Daten in dieser <b>TCP-</b> oder <b>uTP-Verbindung</b> lesen und schreiben.  Beim Senden <b>von</b> Rohpaketen verh√§lt sich <b>Unix</b> wie ein Paranoiker, sodass Sie keine beliebigen Pakete √ºber das Netzwerk senden k√∂nnen.  Dies sollte im Kontext der speziellen Verbindung erfolgen, es sei denn, Sie haben <b>root - das</b> Recht und k√∂nnen tun, was Sie wollen. <br><br>  Eine interessante Frage, die Sie sich stellen k√∂nnten, ist, woher all diese <b>Benutzer-IDs</b> stammen. <br><br>  Wir sprechen √ºber Prozesse mit <b>Benutzer-</b> oder <b>Gruppen-</b> <b>ID</b> .  Wenn Sie <b>PS</b> auf Ihrem Computer starten, werden Sie definitiv eine Reihe von Prozessen mit unterschiedlichen <b>UID-</b> Werten sehen.  Woher kamen sie? <br><br>  Wir ben√∂tigen einen Mechanismus, um alle diese <b>Benutzer-ID-</b> Werte zu laden.  <b>Unix</b> verf√ºgt √ºber mehrere Systemaufrufe, die daf√ºr ausgelegt sind.  Um diese Bezeichnerwerte zu <b>booten</b> , gibt es daher eine Funktion namens <b>setuid (uid)</b> , sodass Sie diesem Wert die <b>UID-</b> Nummer eines aktuellen Prozesses zuweisen k√∂nnen.  Dies ist tats√§chlich eine gef√§hrliche Operation, wie alles andere in der <b>Unix-</b> Tradition, da Sie dies nur tun k√∂nnen, wenn Ihre <b>UID = 0 ist</b> .  In jedem Fall sollte es so sein. <br><br>  Wenn Sie also ein Benutzer mit Root-Rechten sind und <b>uid = 0 haben</b> , k√∂nnen Sie <b>setuid (uid) aufrufen</b> und den Benutzer zu einem beliebigen Prozess wechseln.  Es gibt einige √§hnliche Systemaufrufe zum Initialisieren prozessbezogener <b>GIDs</b> : <b>Setgid</b> und <b>Setgroups</b> .  Daher k√∂nnen Sie mit diesen Systemaufrufen Prozessberechtigungen konfigurieren. <br><br><img src="https://habrastorage.org/webt/qs/6m/bk/qs6mbkc520bn-n_vlpznivx1z0q.jpeg"><br><br>  Die Tatsache, dass Ihre Prozesse die richtigen Zugriffsrechte erhalten, wenn Sie sich am <b>Unix-</b> Computer anmelden, tritt nicht auf, weil Sie dieselbe <b>ID</b> wie die Prozesse haben, weil das System noch nicht wei√ü, wer Sie sind.  Stattdessen gibt es unter <b>Unix</b> eine Art Anmeldeverfahren, wenn das <b>SSH</b> Secure Shell- <b>Protokoll</b> den Prozess f√ºr jeden startet, der eine Verbindung zum Computer herstellt und versucht, den Benutzer zu authentifizieren. <br><br>  Daher beginnt dieser Anmeldevorgang zun√§chst mit <b>uid = 0</b> wie f√ºr einen Benutzer mit Root-Rechten. Wenn er einen bestimmten Benutzernamen und ein bestimmtes Kennwort erh√§lt, √ºberpr√ºft er diese in seiner eigenen Kontodatenbank.  Unter <b>Unix werden</b> diese Daten in der Regel in zwei Dateien gespeichert: <b>/ etc / password</b> (aus historischen Gr√ºnden werden Kennw√∂rter nicht mehr in dieser Datei gespeichert) und in der Datei <b>/ etc / shadow</b> , in der Kennw√∂rter gespeichert sind.  In der Datei <b>/ etc / password</b> befindet sich jedoch eine Tabelle, in der jeder Benutzername im System als ganzzahliger Wert angezeigt wird. <br><br>  Daher wird Ihr Benutzername einer bestimmten Ganzzahl in dieser <b>/ etc / password-</b> Datei zugeordnet, und der Anmeldevorgang pr√ºft, ob Ihr Passwort gem√§√ü dieser Datei korrekt ist.  Wenn es Ihre ganzzahlige <b>UID findet</b> , setzt es die <b>Setuid-</b> Funktionen auf diesen <b>UID-</b> Wert und startet die Shell mit dem Befehl <b>exec (/ bin / sh)</b> .  Jetzt k√∂nnen Sie mit der Shell interagieren, diese funktioniert jedoch unter Ihrer <b>UID</b> , sodass Sie diese Maschine nicht versehentlich besch√§digen k√∂nnen. <br><br><img src="https://habrastorage.org/webt/oa/vi/t8/oavit8bjjn_skjz8-n1k5dhc6co.jpeg"><br><br>  <b>Zielgruppe:</b> <b>Ist</b> es m√∂glich, einen neuen Prozess mit <b>uid = 0</b> zu starten, wenn Ihre <b>uid</b> nicht wirklich 0 ist? <br><br>  <b>Professor:</b> Wenn Sie Root-Rechte haben, k√∂nnen Sie sich auf eine andere <b>UID beschr√§nken</b> , Ihre Autorit√§t <b>verringern</b> , aber in jedem Fall k√∂nnen Sie einen Prozess mit nur derselben <b>UID</b> wie Ihrer erstellen.  Es kommt jedoch vor, dass Sie aus verschiedenen Gr√ºnden Ihre Berechtigungen erh√∂hen m√∂chten.  Angenommen, Sie m√ºssen ein Paket installieren, f√ºr das Sie <b>Root-</b> Rechte ben√∂tigen. <br><br>  Es gibt zwei M√∂glichkeiten, Berechtigungen f√ºr <b>Unix festzulegen</b> .  Eine, die wir bereits erw√§hnt haben, ist ein Dateideskriptor.  Wenn Sie also Ihre Berechtigungen wirklich erh√∂hen m√∂chten, k√∂nnen Sie mit jemandem sprechen, der unter Root-Rechten arbeitet, und ihn bitten, diese Datei f√ºr Sie zu √∂ffnen.  Oder Sie m√ºssen eine neue Schnittstelle installieren, dann √∂ffnet dieser Assistent eine Datei f√ºr Sie und gibt Ihnen mithilfe der <b>fd-</b> √úbertragung einen Dateideskriptor zur√ºck.  Dies ist eine M√∂glichkeit, Ihre Berechtigungen zu erh√∂hen, ist jedoch unpraktisch, da in einigen F√§llen Prozesse mit einer gro√üen Anzahl von Berechtigungen ausgef√ºhrt werden.  Daf√ºr verf√ºgt <b>Unix</b> √ºber einen intelligenten, aber gleichzeitig problematischen Mechanismus namens <b>"setuid binaries"</b> .  Dieser Mechanismus ist eine regul√§re ausf√ºhrbare Datei in einem <b>Unix-</b> Dateisystem, es sei denn, Sie f√ºhren <b>exec</b> auf der <b>setuid-</b> Bin√§rdatei aus, z. B. <b>/ bin / su</b> auf den meisten Computern oder <b>sudo</b> beim Start. <br><br>  Ein typisches <b>Unix-</b> System verf√ºgt √ºber eine Reihe von <b>Setuid-</b> Bin√§rdateien.  Der Unterschied besteht darin, dass beim Ausf√ºhren einer dieser Bin√§rdateien die <b>Benutzer-ID des</b> Prozesses tats√§chlich auf den Eigent√ºmer dieser Bin√§rdatei umgeschaltet wird.  Dieser Mechanismus scheint seltsam, wenn Sie ihn zum ersten Mal sehen.  In der Regel besteht die M√∂glichkeit darin, dass diese "Bin√§rdatei" h√∂chstwahrscheinlich eine Eigent√ºmer- <b>UID von</b> 0 hat, da Sie wirklich viele Berechtigungen wiederherstellen m√∂chten. <br><br><img src="https://habrastorage.org/webt/zt/s5/8d/zts58db83nchnbo1a6qqobpbpuw.jpeg"><br><br>  Sie m√∂chten die Superuser-Rechte wiederherstellen, damit Sie diesen Befehl <b>su</b> ausf√ºhren k√∂nnen, und der Kernel schaltet beim Ausf√ºhren dieser Bin√§rdatei die Prozess- <b>UID</b> auf 0, sodass dieses Programm nun einige privilegierte <b>Aktionen</b> ausf√ºhrt. <br><br>  <b>Zielgruppe:</b> Wenn Sie <b>uid = 0 haben</b> und die <b>uid</b> all dieser <b>setuid-</b> Bin√§rdateien auf etwas anderes als 0 √§ndern, k√∂nnen Sie Ihre Berechtigungen wiederherstellen? <br><br>  <b>Professor:</b> Nein, viele Prozesse k√∂nnen beim Verringern der Zugriffsebene keine Berechtigungen wiederherstellen, sodass Sie m√∂glicherweise an dieser Stelle stecken bleiben.  Dieser Mechanismus ist nicht an <b>uid = 0</b> gebunden.  Wie jeder Benutzer eines <b>Unix-</b> Systems k√∂nnen Sie eine beliebige Bin√§rdatei erstellen, ein Programm erstellen, kompilieren und dieses <b>Setuid-</b> Bit auf das Programm selbst setzen.  Es geh√∂rt Ihnen, dem Benutzer, Ihrer Benutzer-ID.  Und das bedeutet, dass jeder, der Ihr Programm ausf√ºhrt, diesen Code mit Ihrer Benutzer-ID ausf√ºhrt.  Gibt es ein Problem damit?  Was muss getan werden? <br><br>  <b>Zielgruppe:</b> Wenn also ein Fehler in Ihrer Bewerbung aufgetreten ist, kann jemand etwas damit anfangen und mit Ihren Privilegien handeln? <br><br>  <b>Professor:</b> Richtig, es passiert, wenn meine Anwendung "fehlerhaft" ist oder wenn Sie damit alles ausf√ºhren k√∂nnen, was Sie wollen.  Angenommen, ich k√∂nnte die System-Shell kopieren und f√ºr mich <b>setuid</b> machen, aber dann kann jeder diese Shell unter meinem Konto ausf√ºhren.  Dies ist wahrscheinlich nicht der beste Aktionsplan.  Ein solcher Mechanismus verursacht jedoch kein Problem, da die einzige Person, die das <b>setuid-</b> Bit f√ºr eine Bin√§rdatei setzen kann, der Eigent√ºmer dieser Datei ist.  Sie als Eigent√ºmer der Datei haben das <b>UID-</b> Privileg, sodass Sie Ihr Konto auf eine andere Person √ºbertragen k√∂nnen. Diese andere Person kann die <b>setuid-</b> Bin√§rdatei jedoch nicht mit Ihrer <b>Benutzer-ID</b> erstellen. <br><br>  Dieses Setuid-Bit wird neben diesen Berechtigungsbits gespeichert, <b>dh</b> in jedem <b>Inode</b> befindet sich auch ein <b>Setuid-</b> Bit, das <b>angibt</b> , ob diese ausf√ºhrbare Datei w√§hrend der Ausf√ºhrung auf die Eigent√ºmer- <b>UID</b> umgeschaltet werden soll oder nicht. <br><br><img src="https://habrastorage.org/webt/4d/o0/cf/4do0cfauri7y6g94omunnrdyv14.jpeg"><br><br>  Es stellt sich heraus, dass dies bei korrekter Verwendung ein sehr kniffliger Mechanismus ist, und dank dessen implementiert der Kernel das Programm korrekt.  Dies ist eigentlich recht einfach, da nur eine Pr√ºfung durchgef√ºhrt wird: Wenn dieses <b>Setuid-</b> Bit vorhanden ist, wechselt der Prozess zu <b>UID</b> .  Es ist ziemlich einfach. <br><br>  Die sichere Verwendung ist jedoch recht schwierig, da Sie, wie bereits erw√§hnt, unter <b>uid = 0</b> oder unter einer anderen <b>uid</b> beliebige <b>Aktionen ausf√ºhren k√∂nnen</b> , wenn dieses Programm Fehler enth√§lt oder unerwartete <b>Aktionen</b> <b>ausf√ºhrt</b> .  Unter <b>Unix</b> erben Sie beim Ausf√ºhren eines Programms viele Dinge von Ihrem √ºbergeordneten Prozess. <br><br>  Beispielsweise k√∂nnen Sie Umgebungsvariablen an <b>setuid-</b> Bin√§rdateien √ºbergeben.  Tatsache ist, dass Sie unter <b>Unix</b> angeben k√∂nnen, welche gemeinsam genutzte Bibliothek f√ºr den Prozess verwendet werden soll, indem Sie die Umgebungsvariable festlegen. <b>Setuid-</b> Bin√§rdateien k√ºmmern sich nicht um das Filtern dieser Umgebungsvariablen. <br><br>  Sie k√∂nnen beispielsweise <b>bin / su</b> ausf√ºhren, aber gemeinsam genutzte Bibliotheken f√ºr die Funktion <b>printf</b> verwenden, sodass Ihre <b>printf</b> startet, wenn <b>bin / su</b> etwas druckt, und Sie k√∂nnen die Shell anstelle von <b>printf</b> ausf√ºhren. <br><br>  Es gibt viele Feinheiten, die Sie in Bezug auf das Misstrauen des Programms gegen√ºber den vom Benutzer eingegebenen Daten richtig verstehen m√ºssen.  Da Sie normalerweise Benutzereingaben vertrauen, war <b>setuid</b> nie der sicherste Teil eines gesamten <b>Unix-</b> Systems.  Haben Sie Fragen dazu? <br><br>  <b>Zielgruppe:</b> <b>Gilt setuid</b> auch f√ºr Gruppen oder nur f√ºr den Benutzer? <br><br>  <b>Professor:</b> Es gibt ein <b>Setgid-</b> Bit, das symmetrisch zum <b>Setuid-</b> Bit ist und das Sie auch setzen k√∂nnen.  Wenn die Datei eine bestimmte <b>GID hat</b> und dieses <b>Setgid-</b> Bit beim <b>Starten</b> des Programms gesetzt ist, erhalten Sie es. <br><br>  <b>Setgid wird</b> nicht besonders verwendet, kann jedoch in F√§llen n√ºtzlich sein, in denen Sie ganz bestimmte Berechtigungen bereitstellen m√∂chten.  Zum Beispiel ben√∂tigt <b>bin / su</b> wahrscheinlich viele Berechtigungen, aber vielleicht gibt es ein Programm, das einige zus√§tzliche Berechtigungen ben√∂tigt, um beispielsweise etwas in eine spezielle Protokolldatei zu schreiben.  Daher m√∂chten Sie ihr wahrscheinlich eine bestimmte Gruppe zur Verf√ºgung stellen und eine Protokolldatei f√ºr sie erstellen, die von dieser Gruppe geschrieben werden kann.  Selbst wenn das Programm "fehlerhaft" ist, verlieren Sie nichts anderes als diese Gruppe.  Dies ist n√ºtzlich als Mechanismus, der aus irgendeinem Grund nicht zu oft verwendet wird, da die Benutzer schlie√ülich mehr Root-Rechte verwenden sollten. <br><br>  <b>Zielgruppe:</b> Gibt es Einschr√§nkungen, wer den Zugriff √§ndern kann? <br><br>  <b>Professor:</b> Ja.  Unterschiedliche <b>Unix-</b> Implementierungen haben hierf√ºr unterschiedliche Pr√ºfungen.  Die allgemeine Regel lautet, dass nur root den Eigent√ºmer der Datei √§ndern kann, da Sie keine Dateien erstellen m√∂chten, die jemand anderem geh√∂ren, und nat√ºrlich nicht die Dateien anderer Personen verwenden m√∂chten.  Wenn Ihre <b>UID also</b> nicht 0 ist, stecken Sie fest.  Sie k√∂nnen den Besitz einer Datei nicht √§ndern.  Wenn Ihre <b>UID = 0 ist</b> , haben Sie Root-Rechte und k√∂nnen den Eigent√ºmer in einen beliebigen √§ndern.  Es gibt einige Komplikationen, wenn Sie eine bin√§re <b>Setuid haben</b> und von einer <b>UID</b> zu einer anderen wechseln. Dies ist ziemlich schwierig, aber im Grunde k√∂nnen Sie den Dateibesitzer nicht grunds√§tzlich √§ndern, wenn Sie keine Root-Rechte haben. <br><br>  In jedem Fall ist dies ein leicht veraltetes System.  Sie k√∂nnen sich wahrscheinlich viele M√∂glichkeiten vorstellen, die oben beschriebenen Prozesse zu vereinfachen, aber tats√§chlich sehen die meisten fortschrittlichen Systeme so aus, weil sie sich im Laufe der Zeit weiterentwickeln.  Sie k√∂nnen diese Mechanismen jedoch perfekt als "Sandbox" verwenden. <br><br>  Dies sind nur einige grundlegende <b>Unix-</b> Prinzipien, die in fast jedem Unix-√§hnlichen Betriebssystem vorkommen: <b>Mac OS X</b> , <b>Linux</b> , <b>FreeBSD</b> , <b>Solaris</b> , wenn jemand anderes sie verwendet, und so weiter.  Jedes dieser Systeme verf√ºgt jedoch √ºber ausgefeiltere Mechanismen, die Sie verwenden k√∂nnen.  Unter <b>Linux</b> gibt es beispielsweise ein "Sandbox" <b>-Set COMP</b> , <b>Mac OS X</b> verwendet den "Sandbox" <b>-Sicherheitsgurt</b> .  N√§chste Woche werde ich Ihnen Beispiele f√ºr <b>Sandboxen</b> geben, die auf jedem <b>Unix-</b> basierten System verf√ºgbar sind. <br><br>  Einer der letzten Mechanismen, die wir vor dem <b>Eintauchen</b> in <b>OKWS ber√ºcksichtigen werden</b> , erkl√§rt, wie Sie mit <b>Setuid-</b> Bin√§rdateien umgehen m√ºssen, und zeigt, wie Sie sich vor vorhandenen Sicherheitsl√ºcken sch√ºtzen k√∂nnen.  Das Problem ist, dass Sie zwangsl√§ufig einige <b>Setuid-</b> Bin√§rdateien auf Ihrem System haben, wie z. B. <b>/ bin / su</b> oder <b>sudo</b> oder etwas anderes, und es ist wahrscheinlich, dass Ihre Programme Fehler aufweisen.  Aus diesem Grund kann jemand die <b>setuid-</b> Bin√§rdatei ausf√ºhren und der Prozess kann <b>Root-</b> Zugriff erhalten, den Sie nicht zulassen m√∂chten. <br><br><img src="https://habrastorage.org/webt/gy/nt/aa/gyntaadl0kgyfcku6ncq8v334kg.jpeg"><br><br>  Der <b>Unix-</b> Mechanismus, der h√§ufig verwendet wird, um die Ausf√ºhrung eines potenziell b√∂swilligen Prozesses mithilfe von <b>Setuid-</b> Bin√§rdateien zu verhindern, besteht darin, ihn mithilfe des Dateisystem-Namespace mithilfe des <b>Chroot-</b> Systemaufrufs zu √§ndern. Dabei wird das Stammverzeichnis ge√§ndert.  <b>OKWS</b> als Webserver, der sich auf die Erstellung schneller und sicherer Webdienste spezialisiert hat, nutzt dies in gro√üem <b>Umfang</b> . <br><br><img src="https://habrastorage.org/webt/m3/x1/xr/m3x1xrg_tmht2b2l8rwd8kzzy7s.jpeg"><br><br>  Unter <b>Unix k√∂nnen</b> Sie <b>chroot also</b> in einem bestimmten Verzeichnis ausf√ºhren. Vielleicht k√∂nnen Sie auch <b>chroot ("/ foo")</b> ausf√ºhren. <br><br>  Es gibt 2 Erkl√§rungen daf√ºr, was <b>Chroot</b> macht.  Das erste ist nur intuitiv, <b>dh</b> nach dem Ausf√ºhren von <b>chroot entspricht</b> das Stammverzeichnis oder das Verzeichnis hinter dem Schr√§gstrich im Wesentlichen dem, was <b>/ foo verwendet hat,</b> bevor Sie <b>chroot</b> aufgerufen haben.  Es sieht so aus, als w√ºrde der Namespace unter Ihrem <b>/ foo eingeschr√§nkt</b> .  Wenn Sie also eine Datei haben, die fr√ºher <b>/ foo / x genannt</b> wurde <b>,</b> k√∂nnen Sie diese Datei nach dem Aufruf von <b>chroot</b> einfach durch √ñffnen von <b>/ x abrufen</b> .  Beschr√§nken Sie Ihren Namespace also einfach auf ein Unterverzeichnis.  Hier ist die intuitive Version. <br><br><img src="https://habrastorage.org/webt/2w/58/wf/2w58wflgecku62k-urraxwggxcc.jpeg"><br><br>  Aus Sicherheitsgr√ºnden ist nat√ºrlich nicht die intuitive Version von Bedeutung, aber was genau macht der Kernel mit diesem Systemaufruf?  Und es macht im Grunde zwei Dinge.  Erstens √§ndert sich der Wert dieses Schr√§gstrichs. Wenn Sie also auf den Verzeichnisnamen zugreifen oder ihn mit einem Schr√§gstrich beginnen, enth√§lt der Kernel alle Dateien, die Sie mit <b>Chroot-</b> Operationen bereitgestellt haben.  In unserem Beispiel ist dies die Datei <b>/ foo,</b> bevor Sie <b>chroot</b> aufgerufen haben, <b>dh</b> wir erhalten diese <b>/ = / foo</b> . <br><br><img src="https://habrastorage.org/webt/gn/yx/-t/gnyx-tksd5brn4avys0dhppaw6c.jpeg"><br><br>  Das n√§chste, was der Kernel versuchen wird, ist, Sie <b>davor zu</b> sch√ºtzen, aus Ihrem <b>/</b> "entkommen" zu k√∂nnen, wenn Sie dies tun <b>/../</b> .  Denn unter <b>Unix</b> k√∂nnte ich Sie bitten, mir zum Beispiel <b>/../etc/password zu geben</b> .  Wenn ich diese Zeile also wie <b>folgt</b> erg√§nzen w√ºrde: <b>/foo/../etc/password</b> , w√§re das nicht gut, da ich einfach <b>/ foo beenden</b> und <b>/ etc / password</b> <b>abrufen</b> k√∂nnte. <br><br>  Das zweite, was der Kernel mit einem <b>Unix-</b> Systemaufruf macht, ist, dass wenn Sie <b>chroot</b> f√ºr diesen bestimmten Prozess aufrufen, sich die Art und Weise √§ndert, wie <b>/../</b> in diesem Verzeichnis ausgewertet wird.  Daher √§ndert es <b>/../</b> so, dass <b>/ foo</b> auf sich selbst zeigt.  Auf diese Weise k√∂nnen Sie nicht ‚Äûentkommen‚Äú, und diese √Ñnderung gilt nur f√ºr diesen Prozess und wirkt sich nicht auf den Rest aus.  Welche Ideen haben Sie, wie Sie mit ihrer Implementierung aus der <b>Chroot-</b> Umgebung ‚Äûentkommen‚Äú k√∂nnen? <br><br>  Interessanterweise √ºberwacht der Kernel nur ein <b>Chroot-</b> Verzeichnis, sodass Sie wahrscheinlich die Operation <b>chroot = (/ foo)</b> ausf√ºhren k√∂nnten, aber Sie w√ºrden an dieser Stelle <b>h√§ngen</b> bleiben.  Sie m√∂chten <b>/ etc / password erhalten</b> , aber wie geht das?  Sie k√∂nnen das Stammverzeichnis jetzt <b>√∂ffnen,</b> indem Sie <b>open (* / *)</b> eingeben.  Dadurch erhalten Sie einen Dateideskriptor, der beschreibt, was <b>/ foo ist</b> .  Dann k√∂nnen Sie <b>chroot</b> erneut aufrufen und <b>chroot (`/ bar)</b> ausf√ºhren. <br><br><img src="https://habrastorage.org/webt/er/ce/o6/erceo6xadygvj95nuy8fj-zn1bi.jpeg"><br><br> ,    : <b>root</b>   <b>/foo</b> ,  <b>/foo/bar</b>   <b>/../</b>     <b>/foo / bar/..</b> <br><br><img src="https://habrastorage.org/webt/gi/vb/zy/givbzygict7u1xirzzwneycl3sw.jpeg"><br><br>  ,          <b>/foo</b> .            <b>fchdir (fd)</b>     <b>(*/*)</b> ,      <b>chdir (..)</b> . <br><br><img src="https://habrastorage.org/webt/lb/qz/mx/lbqzmxnz8308avfwfyaxxprq7d8.jpeg"><br><br><img src="https://habrastorage.org/webt/gu/cn/kd/gucnkdez6q9ntda3zwtotnc4igg.jpeg"><br><br>       <b>/foo</b> ,     <b>/../</b> .     <b>/foo</b>        ,       <b>root</b> ,       . <br><br> ,    ,       .       .   <b>Unix</b>    root-   <b>chroot</b> ,  <b>chroot</b>     .  ,  <b>Unix</b>    <b>uid = 0</b>  ,      <b>chroot</b> .   .           ,         ,    <b>chroot</b> ,   <b>userid</b>   .   ,     <b>Unix</b> ,     ,    <b>root</b> ,    . <br><br>       ,  , ,     .      <b>chroot</b>       ‚Äî      .    . <br><br> <b>:</b>  ,       <b>inod</b> ,      ? <br><br> <b>:</b>    !              ,  , , : ¬´   <b>inode</b>  23¬ª,      -        <b>hroot</b> .  ,  <b>Unix</b>     <b>inode</b>   <b>inode</b> ,  , ,   root-. <br><br>  ,      ,  ,   <b>OKWS</b> .  ,      <b>OKWS</b> . <br><br>  ,     -,   ,      -  ,      .          , , <b>httpd</b> , ,  <b>Apache</b> . <br><br>        <b>userid</b>   <b>www</b>  <b>/etc/password</b> .     ,   ,     <b>SSL</b> ,      <b>PHP</b>   ,        .   ,       , , <b>MySQL</b> ,           .    <b>MySQL</b>     .      <b>MySQL</b> , , ,      . <br><br><img src="https://habrastorage.org/webt/sx/tx/gd/sxtxgdpf7q9jr3q_tfxyzi6zgdc.jpeg"><br><br> ,  ,    ,    <b>MySQL</b>    ,        ,             . <br><br>         ,       ,  ,         ,   .    ,      , ,     <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apache</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder in </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSL</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder vielleicht im Anwendungscode oder im </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PHP-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Interpreter </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Und da es Fehler gibt, k√∂nnen Sie sie verwenden, um den gesamten Inhalt der Anwendung abzurufen. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">52:30 min </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fortsetzung:</font></font><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">MIT-Kurs "Computer Systems Security".</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vorlesung 4: ‚ÄûPrivilegien teilen‚Äú, Teil 2</font></font></a> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/dNl22h1kW1k" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Vollversion des Kurses finden Sie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br>  Vielen Dank f√ºr Ihren Aufenthalt bei uns.  Gef√§llt dir unser Artikel?  M√∂chten Sie weitere interessante Materialien sehen?  Unterst√ºtzen Sie uns, indem Sie eine Bestellung <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">aufgeben</a> oder sie Ihren Freunden empfehlen. <b>Habr-Benutzer erhalten 30% Rabatt auf ein einzigartiges Analogon von Einstiegsservern, das wir f√ºr Sie erfunden haben:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die ganze Wahrheit √ºber VPS (KVM) E5-2650 v4 (6 Kerne) 10 GB DDR4 240 GB SSD 1 Gbit / s $ 20 oder wie teilt man den Server?</a>  (Optionen sind mit RAID1 und RAID10, bis zu 24 Kernen und bis zu 40 GB DDR4 verf√ºgbar). <br><br>  <b>Dell R730xd 2 mal g√ºnstiger?</b>  Nur wir haben <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">2 x Intel Dodeca-Core Xeon E5-2650v4 128 GB DDR4 6 x 480 GB SSD 1 Gbit / s 100 TV von 249 US-Dollar</a> in den Niederlanden und den USA!</b>  Lesen Sie mehr √ºber <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">den Aufbau eines Infrastrukturgeb√§udes.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Klasse mit Dell R730xd E5-2650 v4 Servern f√ºr 9.000 Euro f√ºr einen Cent?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de418197/">https://habr.com/ru/post/de418197/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de418187/index.html">In Amerika wurde vorgeschlagen, alle Bibliotheken durch Amazon-Hubs zu ersetzen. Die √ñffentlichkeit ist emp√∂rt</a></li>
<li><a href="../de418189/index.html">Erbe des Zeus: Warum der IcedID-Trojaner f√ºr Bankkunden gef√§hrlich ist</a></li>
<li><a href="../de418191/index.html">Analoge in Python und JavaScript. Teil drei</a></li>
<li><a href="../de418193/index.html">Wie f√ºhlt es sich an, 2017 ein Spiel f√ºr Game Boy zu erstellen?</a></li>
<li><a href="../de418195/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 4: ‚ÄûPrivilegien teilen‚Äú, Teil 1</a></li>
<li><a href="../de418199/index.html">Wie man eine einfache technische Aufgabe macht und nicht Geld und Nerven verliert</a></li>
<li><a href="../de418201/index.html">K√∂nnen wir Duck Hunt wiederbeleben?</a></li>
<li><a href="../de418203/index.html">GraphQL API (CRUD) f√ºr unterwegs</a></li>
<li><a href="../de418205/index.html">Space Language Vol. 2: Willkommen, GJ273b</a></li>
<li><a href="../de418207/index.html">√úberpr√ºfung der Gaming-Laptops ASUS ROG Strix GL504GS SCAR II und ASUS ROG Strix GL504GM HERO II</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>