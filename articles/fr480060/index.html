<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôã ‚úåüèø üà∑Ô∏è Classificateur P300 simple sur donn√©es ouvertes üö∂üèæ üì± üë®‚Äç‚öñÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mon coll√®gue Rafael Grigoryan eegdude a r√©cemment √©crit un article sur les raisons pour lesquelles l'humanit√© avait besoin d'EEG et quels ph√©nom√®nes i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Classificateur P300 simple sur donn√©es ouvertes</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/480060/"><p>  Mon coll√®gue Rafael Grigoryan <a href="https://habr.com/ru/users/eegdude/" class="user_link">eegdude a</a> <a href="https://m.habr.com/ru/post/479164/">r√©cemment √©crit</a> un article sur les raisons pour lesquelles l'humanit√© avait besoin d'EEG et quels ph√©nom√®nes importants peuvent y √™tre enregistr√©s.  Aujourd'hui, dans la continuit√© du sujet des interfaces neuronales, nous utilisons l'un des ensembles de donn√©es ouverts enregistr√©s sur un jeu utilisant la m√©canique P300 pour visualiser le signal EEG, voir la structure des potentiels appel√©s, construire les principaux classificateurs, √©valuer la qualit√© avec laquelle nous pouvons pr√©dire la pr√©sence d'un tel potentiel appel√©. </p><br><p>  Permettez-moi de vous rappeler que P300 est un potentiel appel√© (VP), une r√©ponse sp√©cifique du cerveau associ√©e √† la prise de d√©cision et √† des stimuli distinctifs (que nous verrons ci-dessous).  Il est g√©n√©ralement utilis√© pour construire des BCI modernes. </p><br><p><img src="https://habrastorage.org/webt/l5/xn/iy/l5xniylmkybexkk6cym8dbhrmjq.png"></p><br><p>  Pour faire la classification EEG, vous pouvez appeler des amis, √©crire un jeu sur les ratons laveurs et les d√©mons en VR, √©crire vos propres r√©actions et √©crire un article scientifique (j'en parlerai une autre fois), mais heureusement, des scientifiques du monde entier men√© quelques exp√©riences pour nous et il ne reste plus qu'√† t√©l√©charger les donn√©es. </p><br><p>  Une analyse de la fa√ßon de construire une interface neuronale sur le P300 avec du code √©tape par √©tape et des visualisations, ainsi qu'un lien vers le r√©f√©rentiel se trouvent sous le chat. </p><a name="habracut"></a><br><p>  L'article ne montre que les principaux points du code, la version enti√®rement reproductible dans le cahier jupyter <a href="https://gitlab.com/impulse-neiry_public/posts">√† rechercher ici</a> </p><br><p>  Du point de vue d'un EEG, le P300 n'est qu'une rafale √† un certain moment dans certains canaux.  Il existe de nombreuses fa√ßons de l'appeler, par exemple, si vous vous concentrez sur un seul objet et qu'il est activ√© √† un moment al√©atoire (change de forme, de couleur, de luminosit√© ou saute quelque part).  Voici comment il a √©t√© mis en ≈ìuvre dans les temps anciens. </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/wKDimrzvwYA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  D'une mani√®re g√©n√©rale, le sch√©ma est le suivant: il existe plusieurs (g√©n√©ralement de 3 √† 7) stimuli dans le champ de vision d'une personne.  Une personne en choisit une et se concentre dessus (une bonne fa√ßon est de compter le nombre d'activations), puis chaque objet clignote dans un ordre al√©atoire.  Connaissant le temps d'activation de chaque stimulus, nous pouvons maintenant regarder le prochain EEG et d√©terminer s'il y avait un pic caract√©ristique (nous le verrons dans les visualisations ci-dessous).  √âtant donn√© que la personne s'est concentr√©e sur un seul stimulus, le pic devrait √™tre de un.  Ainsi, dans ces interfaces neuronales, l'une des nombreuses options est s√©lectionn√©e (lettres pour l'√©criture, actions dans le jeu, et Dieu sait quoi d'autre).  S'il y a plus de sept options, vous pouvez les placer sur la grille et r√©duire la t√¢che √† la s√©lection d'une ligne + colonne.  C'est ainsi que l'orthographe P300 √† matrice classique, illustr√©e ci-dessus. </p><br><p>  Dans le cas de l'ensemble de donn√©es consid√©r√© aujourd'hui, la partie visuelle (ainsi que le nom) a √©t√© emprunt√©e aux fameux <a href="https://en.wikipedia.org/wiki/Space_Invaders">inviders de l'espace de</a> jeu.  Cela ressemblait √† quelque chose comme √ßa </p><br><p><img src="https://habrastorage.org/webt/xg/yb/du/xgybdulftmr0dpr4muypl7avlro.png" alt="Le gameplay de Brain inviders"></p><br><p>  En fait, c'est la m√™me orthographe, seules les lettres sont remplac√©es par des extraterrestres de jeu. <br>  La <a href="https://www.youtube.com/watch%3Fv%3Ds73l8ZfQcWw">vid√©o du processus de jeu</a> et <a href="https://arxiv.org/ftp/arxiv/papers/1905/1905.05182.pdf">les rapports techniques ont</a> √©galement <a href="https://arxiv.org/ftp/arxiv/papers/1905/1905.05182.pdf">√©t√©</a> conserv√©s. </p><br><p>  D'une mani√®re ou d'une autre, les donn√©es collect√©es √† l'aide de ce jeu sont apparues sur Internet et nous pouvons y acc√©der.  Les donn√©es se composent de 16 canaux EEG et d'un canal d'√©v√©nement, montrant √† quels moments les incitations cibles (faites par le joueur) et non cibles ont √©t√© activ√©es, et nous travaillerons avec eux. </p><br><p> La plupart des ensembles de donn√©es pour BCI ont √©t√© enregistr√©s par des neurophysiologistes, et ce sont des gars qui ne se soucient pas vraiment de la compatibilit√©, donc les formats de donn√©es sont tr√®s divers: des diff√©rentes versions des fichiers <code>.mat</code> aux formats "standard" <a href="https://en.wikipedia.org/wiki/European_Data_Format"><code>.edf</code></a> et <a href="https://en.wikipedia.org/wiki/General_Data_Format_for_Biomedical_Signals"><code>.gdf</code></a> . <br>  La chose la plus importante que vous devez savoir sur ces formats est que vous ne voulez pas les analyser ou travailler directement avec eux. <br>  Heureusement, un groupe de passionn√©s de <a href="https://neurotechx.com/">NeuroTechX a</a> √©crit des t√©l√©chargeurs pour certains jeux de donn√©es directement dans numpy. <br>  Ces bootloaders font partie du projet <a href="https://github.com/NeuroTechX/moabb/tree/master/moabb">moabb</a> qui pr√©tend √™tre une solution universelle pour BCI. </p><br><h2 id="zagruzka-syrogo-dataseta">  T√©l√©charger le jeu de donn√©es brutes </h2><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> moabb.datasets sampling_rate = <span class="hljs-number"><span class="hljs-number">512</span></span> m_dataset = moabb.datasets.bi2013a( NonAdaptive=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, Adaptive=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, Training=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, Online=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, ) m_dataset.download() m_data = m_dataset.get_data()</code> </pre> <br><p>  √Ä ce stade, nous avons obtenu une structure <a href="https://mne.tools/stable/generated/mne.io.Raw.html">RawEDF</a> contenant des enregistrements EEG.  Il s'agit d'une structure du package <a href="https://mne.tools/stable/index.html"><code>mne</code></a> , les biologistes l'utilisent g√©n√©ralement pour interagir avec les signaux: cette structure a des m√©thodes int√©gr√©es pour filtrer, visualiser, stocker les √©tiquettes, et on ne sait jamais.  Mais nous n'irons pas de cette fa√ßon puisque  l'interface du package a tendance √† √™tre instable (la version actuelle est <code>0.19</code> , mais nous utiliserons <code>0.17</code> puisque le jeu de donn√©es n'est plus lu par la nouvelle version) et mal document√©, √† travers cela nos r√©sultats peuvent devenir irreproductibles. </p><br><p>  Ce que nous prenons de la structure r√©sultante sont les √©tiquettes de canaux dans <a href="https://en.wikipedia.org/wiki/10%25E2%2580%259320_system_(EEG)">le syst√®me 10-20</a> .  Il s'agit d'un arrangement international d'√©lectrodes sur la t√™te d'une personne, cr√©√© pour que les scientifiques puissent corr√©ler les zones du cerveau et l'emplacement des canaux EEG.  Vous trouverez ci-dessous la disposition des √©lectrodes dans le syst√®me 10-10 (diff√®re de 10-20 par deux fois la densit√© de marquage) et les canaux qui ont √©t√© enregistr√©s dans ce jeu de donn√©es sont marqu√©s en rouge. <br><img src="https://habrastorage.org/webt/j0/x0/uq/j0x0uq27-vjl277bgamcuuz3qpy.jpeg" alt="syst√®me 10-10"></p><br><pre> <code class="python hljs">print(m_data[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-string"><span class="hljs-string">'session_1'</span></span>][<span class="hljs-string"><span class="hljs-string">'run_1'</span></span>]) <span class="hljs-comment"><span class="hljs-comment"># &lt;RawEDF | 1.gdf, n_channels x n_times : 17 x 159232 (311.0 sec), ~20.7 MB, data loaded&gt; channels = m_data[1]['session_1']['run_1'].ch_names[:-1] channels # ['FP1', 'FP2', 'F5', 'AFz', 'F6', 'T7', 'Cz', 'T8', 'P7', 'P3', 'Pz', 'P4', 'P8', 'O1', 'Oz', 'O2']</span></span></code> </pre><br><p>  Tout d'abord, √† partir des donn√©es t√©l√©charg√©es pour chaque sujet, nous allouons des tableaux d'EEG continu pendant 16 secondes et toutes les √©tiquettes pour cet intervalle (dans les donn√©es, c'est juste un autre canal dans lequel les d√©buts des √©v√©nements qui nous int√©ressent sont not√©s). </p><br><p>  √Ä ce stade, nous conservons la longueur maximale de l'EEG continu afin de ne pas rencontrer d'effets de bord lors d'un filtrage ult√©rieur. </p><br><pre> <code class="python hljs">raw_dataset = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> _, sessions <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> sorted(m_data.items()): eegs, markers = [], [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> item, run <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> sorted(sessions[<span class="hljs-string"><span class="hljs-string">'session_1'</span></span>].items()): data = run.get_data() eegs.append(data[:<span class="hljs-number"><span class="hljs-number">-1</span></span>]) markers.append(data[<span class="hljs-number"><span class="hljs-number">-1</span></span>]) raw_dataset.append((eegs, markers))</code> </pre> <br><h2 id="filtraciya-i-razdelenie-na-epohi">  Filtrage et s√©paration </h2><br><p>  En g√©n√©ral, pour revoir les m√©thodes de pr√©traitement et de classification de l'EEG, je peux recommander <a href="https://iopscience.iop.org/article/10.1088/1741-2552/aab2f2/meta">une excellente vue</a> d' <a href="https://iopscience.iop.org/article/10.1088/1741-2552/aab2f2/meta">ensemble</a> des ma√Ætres des interfaces de neuro-ordinateurs.  Il n'y a pas si longtemps, une <a href="https://iopscience.iop.org/article/10.1088/1741-2552/ab0ab5">revue</a> plus <a href="https://iopscience.iop.org/article/10.1088/1741-2552/ab0ab5">r√©cente des</a> tests de r√©seau neuronal a √©t√© publi√©e. </p><br><p>  Le pr√©traitement minimum du signal EEG pour la classification comprend 3 √©tapes: </p><br><ul><li>  d√©cimation </li><li>  filtrage </li><li>  mise √† l'√©chelle </li></ul><br><p>  Pour impl√©menter ces √©tapes, nous utiliserons le bon vieux <code>sklearn</code> et son paradigme pour les transformateurs et les pipelines afin que notre pr√©traitement puisse √™tre facilement extensible. <br>  Le code des transformateurs est plac√© dans un fichier s√©par√©, ci-dessous, nous d√©crirons quelques d√©tails. </p><br><p>  <strong>D√©cimation</strong> </p><br><p>  Pour une raison quelconque, dans certains articles et exemples de traitement, j'ai rencontr√© une diminution de la fr√©quence du signal en jetant simplement des √©chantillons dans le style <code>eeg = eeg[:, ::10]</code> .  C'est compl√®tement incorrect (pourquoi - voir n'importe quel livre sur le traitement du signal).  Nous utilisons l' <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.decimate.html"><code>  scipy</code></a> standard <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.decimate.html"><code>  scipy</code></a> . </p><br><p>  <strong>Filtrage</strong> </p><br><p>  Ici, nous nous appuyons √©galement sur des filtres <code>scipy</code> en s√©lectionnant un filtre passe-bande Butterworth de 4 ordres et en l'appliquant dans le sens avant et arri√®re ( <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.filtfilt.html"><code>filtfilt</code></a> ) pour maintenir la phase.  Fr√©quences de coupure - de 0,5 √† 20 Hz, c'est la plage standard pour notre t√¢che. </p><br><p>  <strong>Mise √† l'√©chelle</strong> </p><br><p>  Nous avons utilis√© un <code>StandardScaler</code> par canal (soustrait la moyenne, divise par l'√©cart-type), qui voit tous les signaux de l'√©chantillon.  En fait, une petite fuite de donn√©es est introduite √† ce stade.  formellement, le scaler voit √©galement les donn√©es de l'√©chantillon de test, mais avec des volumes de donn√©es suffisamment importants, la moyenne et l'√©cart sont les m√™mes. <br>  La masturbation est effectu√©e canal par canal afin qu'au sein d'un m√™me ensemble de donn√©es, il soit possible d'agr√©ger les donn√©es de diff√©rents capteurs ayant des ordres de grandeur et de nature diff√©rents (par exemple, <a href="https://ru.wikipedia.org/wiki/%25D0%25AD%25D0%25BB%25D0%25B5%25D0%25BA%25D1%2582%25D1%2580%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B0%25D1%258F_%25D0%25B0%25D0%25BA%25D1%2582%25D0%25B8%25D0%25B2%25D0%25BD%25D0%25BE%25D1%2581%25D1%2582%25D1%258C_%25D0%25BA%25D0%25BE%25D0%25B6%25D0%25B8">r√©action galvanique cutan√©e (RAG)</a> ) </p><br><p>  En plus des op√©rations ci-dessus, il √©tait √©galement possible de distinguer des artefacts dans l'EEG (clignotement, mouvements de mastication, mouvements de t√™te), mais cet ensemble de donn√©es est d√©j√† tr√®s propre, alors laissons-le jusqu'√† la prochaine fois. </p><br><pre> <code class="python hljs">reload(transformers) decimation_factor = <span class="hljs-number"><span class="hljs-number">10</span></span> final_rate = sampling_rate // decimation_factor epoch_duration = <span class="hljs-number"><span class="hljs-number">0.9</span></span> <span class="hljs-comment"><span class="hljs-comment"># seconds epoch_count = int(epoch_duration * final_rate) eeg_pipe = make_pipeline( transformers.Decimator(decimation_factor), transformers.ButterFilter(sampling_rate // decimation_factor, 4, 0.5, 20), transformers.ChannellwiseScaler(StandardScaler()), ) markers_pipe = transformers.MarkersTransformer(labels_mapping, decimation_factor)</span></span></code> </pre> <br><p>  Ensuite, nous appliquerons le pipeline de pr√©traitement √† nos donn√©es et couperons le signal EEG continu en √©poques.  Nous appellerons l'√©poque la p√©riode de temps imm√©diatement apr√®s l'activation du stimulus avec une dur√©e caract√©ristique de 0,5 √† 1 seconde, dans notre cas, la dur√©e est de 900 ms, bien qu'elle puisse √™tre raccourcie. </p><br><p>  Dans notre ensemble de donn√©es, il y a 16 canaux EEG, apr√®s application de la d√©cimation, la fr√©quence tombera √† 50 Hz, donc une √©poque sera d√©crite par une matrice <code>(16, 45)</code> - 900 ms √† 50 Hz correspondent √† 45 √©chantillons de temps. </p><br><p>  Les balises de cet ensemble de donn√©es ne sont que des binaires - elles marquent les signaux cible (masqu√©s par le joueur, actifs, 1) et non cibles (vides, 0). </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> eegs, _ <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> raw_dataset: eeg_pipe.fit(eegs) dataset = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> eegs, markers <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> raw_dataset: epochs = [] labels = [] filtered = eeg_pipe.transform(eegs) markups = markers_pipe.transform(markers) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> signal, markup <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> zip(filtered, markups): epochs.extend([signal[:, start:(start + epoch_count)] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> start <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> markup[:, <span class="hljs-number"><span class="hljs-number">0</span></span>]]) labels.extend(markup[:, <span class="hljs-number"><span class="hljs-number">1</span></span>]) dataset.append((np.array(epochs), np.array(labels)))</code> </pre> <br><pre> <code class="python hljs">dataset[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>].shape, dataset[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>].shape <span class="hljs-comment"><span class="hljs-comment"># ((1308, 16, 45), (1308,))</span></span></code> </pre> <br><p>  Nous avons donc obtenu un <code>Pytorch</code> de <code>Pytorch</code> style Pytorch dans lequel le premier indice compte diff√©rentes personnes.  Avec une telle structure, nous pouvons √† la fois effectuer une validation crois√©e dans les donn√©es d'une personne et tester la tol√©rance du classificateur entre diff√©rentes personnes (ce que l'on appelle l'apprentissage par transfert, la pr√©diction sans calibration).  Les donn√©es d'une personne se composent d'un tableau d'√©poques et d'√©tiquettes de classe.  Le nombre d'√©poques pour chaque personne varie l√©g√®rement en raison des caract√©ristiques de l'enregistrement. </p><br><h2 id="issledovanie-i-vizualizaciya-dannyh">  Recherche et visualisation de donn√©es </h2><br><p>  Tout d'abord, jetez un ≈ìil √† l'un des signaux continus avant de d√©couper les √©poques. </p><br><p>  Malgr√© le fait qu'il ait d√©j√† √©t√© filtr√©, il ne montre aucune activation sur l'≈ìil et ressemble plus √† une sorte de bruit. </p><br><p><img src="https://habrastorage.org/webt/mb/xy/js/mbxyjsh7g4ch3an8smi2wtpujpw.png" alt="Signal EEG filtr√© d'une manche du jeu"></p><br><p>  Si nous consid√©rons une seule √©poque cible de notre ensemble de donn√©es, nous verrons alors une augmentation caract√©ristique de l'intervalle 400-600 ms.  C'est notre potentiel recherch√© P300. </p><br><p><img src="https://habrastorage.org/webt/eu/v9/k-/euv9k-t6w0nss44m2fnvt_mrhxs.png" alt="√©poque p300"></p><br><p>  Au total, dans notre ensemble de donn√©es, il y a environ 35 000 √©poques, c'est-√†-dire l'activation du stimulus.  Chaque personne en a environ 1300 √† 1750 (cela est d√ª au fait que quelqu'un a abattu des extraterrestres plus rapidement et plus lentement). </p><br><p>  Il existe √©galement un d√©s√©quilibre notable dans les classes: 1 √† 5 en faveur des stimuli vides.  nous avons 6 lignes et colonnes dans la matrice et une seule d'entre elles est la cible.  Plus tard, nous y reviendrons lorsque nous discuterons des mesures obtenues. </p><br><p><img src="https://habrastorage.org/webt/ed/7n/jb/ed7njbim3sdcge3lpb-_ll8ucls.png" alt="√©quilibre de classe"></p><br><p>  Il est maintenant temps de regarder la diff√©rence entre le signal cible et le non cible </p><br><p><img src="https://habrastorage.org/webt/c5/tx/oa/c5txoadzfwl8qzg8t-29siuftnw.png" alt="r√©ponse moyenne du jeu de donn√©es"></p><br><p>  Sur le graphique de gauche, vous pouvez voir que les signaux moyens varient beaucoup, et les deux ont une r√©ponse non sp√©cifique dans la r√©gion de 180 ms, mais celle cible est beaucoup plus d'amplitude, la cible a √©galement une bosse caract√©ristique de 250 √† 500 ms - c'est le fameux P300. </p><br><p>  Avec une telle diff√©rence dans le signal, notre t√¢che peut sembler insignifiante, mais si nous ajoutons l'√©cart type √† chaque point du graphique, nous verrons que l'image n'est pas si rose - le signal est assez bruyant.  Et cela malgr√© le fait que le rapport signal / bruit pour le P300 est consid√©r√© comme l'un des plus √©lev√©s en neurophysiologie. </p><br><p>  (En fait, ces graphiques ne sont pas construits assez honn√™tement, car le signal vide est moyenn√© sur cinq fois plus d'√©chantillons diff√©rents, donc les √©carts al√©atoires sont supprim√©s davantage, mais comme nous pouvons le voir √† partir de la dispersion du m√™me ordre, cela n'aide pas trop) </p><br><p><img src="https://habrastorage.org/webt/7b/nw/hw/7bnwhwdx7xrbkvwgqiw9jc5um5g.png" alt="R√©ponse moyenne de la personne"></p><br><p>  Il est √©galement utile de regarder les signaux moyens d'une personne. </p><br><p>  Ici se trouve la remarque pr√©c√©dente sur la moyenne ¬´malhonn√™te¬ª - le signal vide est sensiblement plus d'amplitude qu'avec la moyenne sur tous.  En outre, le pic de P300 chez une personne est plus √©lev√© en raison d'une moyenne moindre. </p><br><p>  Il est important de noter une autre caract√©ristique du signal d'une personne - il a une forme l√©g√®rement diff√©rente de celle g√©n√©ralis√©e.  La variabilit√© interpersonnelle des r√©actions neurophysiologiques est assez √©lev√©e, on verra encore l'influence de ce facteur dans le travail des classificateurs.  Cependant, les diff√©rences intrapersonnelles (une personne d'humeur diff√©rente, niveau de stress, fatigue) sont √©galement assez importantes. </p><br><p><img src="https://habrastorage.org/webt/jt/kj/sj/jtkjsjbgmym86-unjyshdxgtd80.png" alt="png"></p><br><p>  Ensuite, nous voyons le balayage canal par canal des signaux.  Le point de vue ici co√Øncide avec l'image ci-dessus, qui repr√©sente la position des √©lectrodes - nez au-dessus, etc. </p><br><p>  La r√©ponse de chaque partie de la t√™te est diff√©rente.  √Ä Fp1,2, deux pics n√©gatifs pr√©c√©dant le pic positif sont prononc√©s.  De plus, dans certains canaux, il y a deux pics positifs et dans certains - un ou quelque chose de transition entre les deux. </p><br><p>  Diff√©rents canaux ont une importance diff√©rente pour d√©terminer la pr√©sence de P300, elle peut √™tre estim√©e en utilisant diff√©rentes m√©thodes - en calculant des informations mutuelles ou en ajoutant-supprimant (aka r√©gression pas √† pas).  L'application de ces m√©thodes nous traiterons une autre fois. </p><br><p>  Il convient de rappeler que nous mesurons la diff√©rence de potentiel entre les √©lectrodes avec des √©lectrodes, ce qui signifie que nous pouvons construire des cartes de tension pour la t√™te enti√®re √† certains moments dans le temps en utilisant des changements de tension √† des points individuels.  Il est clair que s'il y a 16 √©lectrodes, la pr√©cision d'une telle carte laisse beaucoup √† d√©sirer, mais une certaine compr√©hension doit √™tre acquise.  (par d√©faut, <code>mne</code> s'attend √† voir des microvolts, mais nous avons d√©j√† appliqu√© une mise √† l'√©chelle, donc les valeurs absolues ne sont pas correctes) </p><br><p><img src="https://habrastorage.org/webt/zq/2y/kz/zq2ykzbpc6oxqz2woyizwuswod4.png" alt="png"></p><br><p><img src="https://habrastorage.org/webt/l5/xn/iy/l5xniylmkybexkk6cym8dbhrmjq.png" alt="png"></p><br><h2 id="klassifikaciya">  Classification </h2><br><p>  Enfin, il est temps d'appliquer des m√©thodes d'apprentissage automatique √† notre √©chantillon. </p><br><p>  Plusieurs √©l√©ments de base ont √©t√© choisis comme classificateurs - un journal.  r√©gression, la m√©thode des vecteurs de support (SVM) et plusieurs m√©thodes utilisant l'analyse de corr√©lation du package <a href="https://github.com/alexandrebarachant/pyRiemann"><code>pyriemann</code></a> (les d√©tails de chaque m√©thode peuvent √™tre trouv√©s dans la documentation), il convient de noter que ces m√©thodes ont √©t√© sp√©cialement d√©velopp√©es pour √™tre appliqu√©es √† l'EEG et avec leur aide, <a href="https://www.kaggle.com/c/inria-bci-challenge/discussion/12819">plusieurs</a> <a href="https://www.kaggle.com/c/grasp-and-lift-eeg-detection/discussion/16479">concours</a> ont √©t√© remport√©s. kaggle. </p><br><pre> <code class="python hljs">clfs = { <span class="hljs-string"><span class="hljs-string">'LR'</span></span>: ( make_pipeline(Vectorizer(), LogisticRegression()), {<span class="hljs-string"><span class="hljs-string">'logisticregression__C'</span></span>: np.exp(np.linspace(<span class="hljs-number"><span class="hljs-number">-4</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>))}, ), <span class="hljs-string"><span class="hljs-string">'LDA'</span></span>: ( make_pipeline(Vectorizer(), LDA(shrinkage=<span class="hljs-string"><span class="hljs-string">'auto'</span></span>, solver=<span class="hljs-string"><span class="hljs-string">'eigen'</span></span>)), {}, ), <span class="hljs-string"><span class="hljs-string">'SVM'</span></span>: ( make_pipeline(Vectorizer(), SVC()), {<span class="hljs-string"><span class="hljs-string">'svc__C'</span></span>: np.exp(np.linspace(<span class="hljs-number"><span class="hljs-number">-4</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>))}, ), <span class="hljs-string"><span class="hljs-string">'CSP LDA'</span></span>: ( make_pipeline(CSP(), LDA(shrinkage=<span class="hljs-string"><span class="hljs-string">'auto'</span></span>, solver=<span class="hljs-string"><span class="hljs-string">'eigen'</span></span>)), {<span class="hljs-string"><span class="hljs-string">'csp__n_components'</span></span>: (<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>), <span class="hljs-string"><span class="hljs-string">'csp__cov_est'</span></span>: (<span class="hljs-string"><span class="hljs-string">'concat'</span></span>, <span class="hljs-string"><span class="hljs-string">'epoch'</span></span>)}, ), <span class="hljs-string"><span class="hljs-string">'Xdawn LDA'</span></span>: ( make_pipeline(Xdawn(<span class="hljs-number"><span class="hljs-number">2</span></span>, classes=[<span class="hljs-number"><span class="hljs-number">1</span></span>]), Vectorizer(), LDA(shrinkage=<span class="hljs-string"><span class="hljs-string">'auto'</span></span>, solver=<span class="hljs-string"><span class="hljs-string">'eigen'</span></span>)), {}, ), <span class="hljs-string"><span class="hljs-string">'ERPCov TS LR'</span></span>: ( make_pipeline(ERPCovariances(estimator=<span class="hljs-string"><span class="hljs-string">'oas'</span></span>), TangentSpace(), LogisticRegression()), {<span class="hljs-string"><span class="hljs-string">'erpcovariances__estimator'</span></span>: (<span class="hljs-string"><span class="hljs-string">'lwf'</span></span>, <span class="hljs-string"><span class="hljs-string">'oas'</span></span>)}, ), <span class="hljs-string"><span class="hljs-string">'ERPCov MDM'</span></span>: ( make_pipeline(ERPCovariances(), MDM()), {<span class="hljs-string"><span class="hljs-string">'erpcovariances__estimator'</span></span>: (<span class="hljs-string"><span class="hljs-string">'lwf'</span></span>, <span class="hljs-string"><span class="hljs-string">'oas'</span></span>)}, ), }</code> </pre> <br><p><img src="https://habrastorage.org/webt/3x/yb/qc/3xybqcusgidyxfs5lfcilxqn-gs.png" alt="enregistrement de validation crois√©e"></p><br><p>  Le sch√©ma d'interfaces neuronales le plus courant est "√©talonnage + travail", c'est-√†-dire  Tout d'abord, il est n√©cessaire qu'une personne se concentre sur les stimuli pr√©c√©demment indiqu√©s pendant un certain temps, et seulement apr√®s cela, nous pr√©disons son choix.  Cette approche pr√©sente l'inconv√©nient √©vident d'une √©tape initiale ennuyeuse. </p><br><p>  Pour √©valuer les performances de nos m√©thodes dans ce mode, nous proc√©derons √† une validation crois√©e au sein des √©poques d'une seule personne. <br>  La m√©trique de pr√©cision dans ce cas n'est pas pertinente en raison du d√©s√©quilibre de l'ensemble de donn√©es (la ligne de base est ici de 5/6 ~ 83%), donc je pr√©f√®re regarder la pr√©cision-rappel-f1 trois. </p><br><p>  Pour examiner l'int√©gralit√© de l'ensemble de donn√©es, nous faisons la moyenne des r√©sultats d'une telle validation crois√©e entre toutes les personnes.  En g√©n√©ral, les performances des meilleurs mod√®les sont assez √©lev√©es par rapport √† ce que nous avons chez <a href="https://impulse-neiry.com/">Neiry</a> dans les conditions "terrain" d'un parc d'attractions (je rappelle que cet ensemble de donn√©es a √©t√© enregistr√© en laboratoire). </p><br><p>  Dans cet ensemble de donn√©es, il n'y a que des √©tiquettes binaires pour les donn√©es.  En g√©n√©ral, nous devons r√©soudre le probl√®me multiclasse de choisir l'un des stimuli (soit dit en passant, il est √©quilibr√© puisque chaque stimulus est activ√© le m√™me nombre de fois).  Pour le r√©soudre, le nombre d'activations de chaque stimulus est g√©n√©ralement fixe (par exemple, 6 stimuli de 5 activations chacun) et tous les stimuli sont activ√©s al√©atoirement (30 fois), 30 √©poques sont obtenues et les probabilit√©s de ses activations sont ajout√©es pour √™tre cibl√©es, apr√®s quoi le stimulus qui a atteint le maximum le montant est reconnu comme cible.  Nous d√©montrerons la mise en ≈ìuvre de cette approche dans un prochain article sur un ensemble de donn√©es appropri√©. </p><br><p><img src="https://habrastorage.org/webt/zx/-o/lm/zx-olmert9y5wdjpebgqa1dy8zm.png" alt="crossvalidate_dataset"></p><br><p>  Le deuxi√®me sch√©ma est appel√© apprentissage par transfert, c'est-√†-dire le transfert du classificateur entre les personnes.  Le fait est que lorsque nous proc√©dons √† l'√©talonnage, nous nous recyclons en fait √† la forme maximale d'une personne, de sorte que nous pouvons bien le pr√©dire dans les tests ult√©rieurs.  En l'absence d'√©talonnage, un classificateur pr√©-form√© devrait √™tre capable d'isoler le concept P300 sans conna√Ætre √† l'avance la forme d'onde d'une personne en particulier. </p><br><p>  Nous allons mener deux exp√©riences - nous formerons le classificateur sur une personne et nous en pr√©dirons cinq, puis nous augmenterons l'√©chantillon de formation √† 10 personnes et comparerons les r√©sultats pour nous assurer que les mod√®les ont pu augmenter leur capacit√© de g√©n√©ralisation </p><br><p>  Formation pour 1 personne <br><img src="https://habrastorage.org/webt/fk/n5/5w/fkn55wh6yl7hfpjtjrqesq8gm8e.png" alt="transfer_validate_1"></p><br><p>  Formation pour 10 personnes <br><img src="https://habrastorage.org/webt/in/ol/kq/inolkqy3-fezzcavmstah4vwhic.png" alt="transfer_valiidate_10"></p><br><p>  Donc f1 est pass√© de 0,23 √† 0,4 pour un meilleur classifieur (dans les deux cas c'est une r√©gression logarithmique avec la m√™me r√©gularisation). </p><br><p>  Cela signifie que la capacit√© de pr√©diction est pass√©e de ¬´non¬ª √† ¬´acceptable¬ª.  D'apr√®s notre exp√©rience, avec de telles m√©triques du probl√®me binaire, 5 activations de chaque stimulus suffisent pour atteindre la pr√©cision du probl√®me multiclasse d'environ 75%. </p><br><p>  En fin de compte, je tiens √† noter que la m√©thode ci-dessus est assez primitive, ce qui peut √™tre vu, par exemple, √† partir du haut degr√© de r√©gularisation de la r√©gression logarithmique - les canaux dans les donn√©es sont assez fortement corr√©l√©s et il existe plusieurs approches pour r√©soudre cette circonstance. </p><br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  Aujourd'hui, nous nous sommes familiaris√©s avec le potentiel √©voqu√© du P300 et avons construit un pipeline simple pour l'interface neuronale.  Je recommande aux personnes int√©ress√©es d'ouvrir un ordinateur portable par elles-m√™mes (situ√© dans le <a href="https://gitlab.com/impulse-neiry_public/posts">r√©f√©rentiel</a> ) et d'exp√©rimenter avec des options de visualisation et des classificateurs. </p><br><p>  Ayant une compr√©hension de base des m√©thodes de travail avec le signal EEG, nous serons en mesure d'approfondir ce sujet plus en profondeur - d'appliquer des m√©thodes de pr√©traitement avanc√©es, ainsi que des r√©seaux de neurones, pour r√©soudre les probl√®mes de construction d'interfaces neuronales.  √Ä suivre ... </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr480060/">https://habr.com/ru/post/fr480060/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr480048/index.html">D√©mystifier le nouveau service de travail .NET Core 3</a></li>
<li><a href="../fr480050/index.html">√âtudes sur le terrain du concept de ¬´documentation en tant que code¬ª</a></li>
<li><a href="../fr480052/index.html">SEO vs PPC - Quoi de mieux pour votre entreprise?</a></li>
<li><a href="../fr480056/index.html">Activation de la cam√©ra cach√©e par les navigateurs: Big Brother ou erreur de calcul technologique?</a></li>
<li><a href="../fr480058/index.html">Transformer star sur l'arbre de No√´l</a></li>
<li><a href="../fr480062/index.html">10 syst√®mes de contr√¥le. O√π est-il plus pratique de communiquer sur les t√¢ches et de partager des fichiers?</a></li>
<li><a href="../fr480064/index.html">Mots d'apprentissage regroup√©s par th√®me</a></li>
<li><a href="../fr480068/index.html">[Mise √† jour] Nos gens sont battus et nous nous tairons?</a></li>
<li><a href="../fr480070/index.html">Avantages React: une b√©n√©diction pour les entreprises?</a></li>
<li><a href="../fr480072/index.html">Kubernetes: pourquoi est-il si important de configurer la gestion des ressources syst√®me?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>