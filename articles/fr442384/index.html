<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•§ üóª üòñ Extension des fonctionnalit√©s du syst√®me audio standard üßöüèº üçÉ üßëüèΩ‚Äçü§ù‚Äçüßëüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour √† tous. Je suis le propri√©taire d'un Japonais de dix ans, en qui tout me convenait, √† l'exception du syst√®me audio standard - il n'y avait pas...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Extension des fonctionnalit√©s du syst√®me audio standard</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/442384/">  Bonjour √† tous.  Je suis le propri√©taire d'un Japonais de dix ans, en qui tout me convenait, √† l'exception du syst√®me audio standard - il n'y avait pas de Bluetooth dedans.  Il existe trois fa√ßons possibles de r√©soudre ce probl√®me: <br><br>  1. Achetez une prise dans l'allume-cigare et ne vous montrez pas. <br><br>  Inconv√©nients: <br><br><ul><li>  Qualit√© sonore </li><li>  Pas de gestion </li><li>  Aucune sortie de titre de chanson </li></ul><br>  Il n'y a aucun avantage. <br><br>  2. Pour acheter lors d'une √©preuve de force pour beaucoup d'argent une unit√© Bluetooth r√©guli√®re + une t√™te plus r√©cente. <br><br>  Inconv√©nients: <br><br><ul><li>  Bloquer les probl√®mes de compatibilit√© </li><li>  Sortie audio mono (sur certaines unit√©s) </li><li>  Le prix avec le remplacement de la t√™te et du c√¢blage est presque √©gal √† la radio d'urgence </li><li>  En plus de l'alphabet latin, il n'y a pas de support </li></ul><br>  Avantages: <br><br><ul><li>  Equipement standard </li></ul><br>  3. Faites quelque chose vous-m√™me, mais pour ne pas r√©duire les fonctionnalit√©s existantes. <br><br>  Inconv√©nients: <br><br><ul><li>  Besoin de temps </li><li>  Plus d'argent a √©t√© d√©pens√© que de choisir ensemble les deux premi√®res options </li></ul><br>  Avantages: <br><br><ul><li>  Satisfaction au travail </li><li>  Prise en charge audio sans perte </li><li>  Le support cyrillique, bien que translitt√©r√©,  L'√©cran ne sait pas comment. </li></ul><br>  Comme vous l'avez compris par le nom, j'ai choisi le chemin num√©ro 3. <br><a name="habracut"></a><br>  Donn√©es sources. <br><br>  Le syst√®me audio natif, qui se compose d'une unit√© principale et d'un panneau qui ressemble √† ceci: <br><br><img src="https://habrastorage.org/webt/4v/sk/5e/4vsk5evoi6jnzafseqly1stypdu.jpeg" alt="image"><br><br>  Il a le mode AUX, qui vous permet de connecter des appareils externes pour √©couter de la musique.  Pourquoi ne pas l'utiliser √† vos propres fins?  Assurez-vous qu'avec une certaine combinaison de touches, le mode AUX d√©marre, mais en m√™me temps toutes les donn√©es sur l'√©cran passent compl√®tement sous notre contr√¥le et le son dans AUX est redirig√© depuis le module Bluetooth. <br>  Heureusement, dans le domaine public, vous pouvez trouver un manuel avec un circuit, √† partir duquel il devient clair que l'interface entre la t√™te et le panneau est un UART normal. <br><br><img src="https://habrastorage.org/webt/sy/0z/oc/sy0zoczxvww01fma26rdsxi3-d8.png" alt="image"><br><br>  √Ä l'aide d'un analyseur logique, la vitesse et le protocole de l'√©change entre la t√™te et le panneau ont √©t√© d√©termin√©s.  (Taux de rafra√Æchissement de l'√©cran de 10 images par seconde, fr√©quence de clic 30 ms, 14400E2).  Avec l'arduinka, un r√©sultat a √©t√© obtenu sous la forme de Hello World. <br><br><img src="https://habrastorage.org/webt/vs/gg/p2/vsggp28tpcikb1vprsgfsbuv0aq.jpeg" alt="image"><br><br>  L'√©tape suivante a √©t√© l'√©tape du choix d'un microcontr√¥leur pour la mise en ≈ìuvre.  Le choix s'est port√© sur le STM32F103, √† bord duquel jusqu'√† 3 UART sont pris en charge pour le bus CAN (pourquoi ne pas l'ajouter).  Le CSR8645 a √©t√© initialement achet√© en tant que module Bluetooth, la premi√®re version √©tait avec, mais il ne pouvait pas afficher les noms des pistes (ou je ne l'ai pas compris compl√®tement), et n'avait pas non plus de contr√¥le de bus num√©rique, donc un module appel√© Bluegiga a √©t√© achet√© directement aux √âtats-Unis. WT32i, dans lequel il y avait tout ce qui √©tait n√©cessaire et encore plus - prise en charge de la sortie audio num√©rique et du codec AptX.  Pendant quelques mois, quand il y avait du temps libre, le d√©veloppement d'un prototype a √©t√© effectu√©.  Toutes les horreurs de HAL et les charmes de SPL √©taient connus.  √âtudi√© √† fond UART et DMA dans le microcontr√¥leur, car  il √©tait n√©cessaire de tout lier ensemble pour qu'il fonctionne sans freins ni d√©faillances. <br><br><div class="spoiler">  <b class="spoiler_title">Quelques photos du processus</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/_h/kd/n2/_hkdn2sdmrg4sbs9nt-hbfj3_gs.jpeg" alt="image"><br><img src="https://habrastorage.org/webt/ma/vx/cn/mavxcnga0mh5nyo4tjabxhddeoq.jpeg" alt="image"><br></div></div><br>  Ensuite, tout cela a √©t√© introduit dans l'unit√© principale, mais afin qu'il puisse √™tre flash√© et retir√© sans aucun probl√®me de r√©vision.  Un c√¢ble HDMI et un connecteur d'un ordinateur portable mort ont √©t√© utilis√©s comme interface. <br><br><div class="spoiler">  <b class="spoiler_title">Photos au moment du d√©bogage, il vaut mieux ne pas regarder</b> <div class="spoiler_text">  Vue int√©rieure: <br><br><img src="https://habrastorage.org/webt/sv/dn/hg/svdnhgx22mh2ud4joto7-kp2rby.jpeg" alt="image"><br><br>  Vue ext√©rieure: <br><br><img src="https://habrastorage.org/webt/go/fl/ff/goflffoe8hbevkscvrrg3g_pfpy.jpeg" alt="image"><br><br>  Le bo√Ætier a √©t√© fabriqu√© par une ancienne alimentation pour ordinateur portable. <br></div></div><br>  Le moment est venu de placer la carte de circuit imprim√© sous cette activit√©, ainsi que de tout retirer de la t√™te, afin qu'√† tout moment vous puissiez supprimer cette ferme collective et ne pas perturber le fonctionnement de la machine.  Le r√©sultat a √©t√© une telle beaut√©: <br><br><img src="https://habrastorage.org/webt/iw/ln/k4/iwlnk4u8lbrludjqjuphd79imbe.jpeg" alt="image"><br><br>  J'ai √©lev√© la planche pour la premi√®re fois de ma vie, vous pouvez critiquer, mais avec mod√©ration.  La soir√©e a √©t√© soud√©e et cela a fonctionn√© la premi√®re fois, ce qui m'a beaucoup surpris. <br><br><img src="https://habrastorage.org/webt/ys/qq/sc/ysqqscjostb7asl5h7l955idgo4.jpeg" alt="image"><br><br>  Ensuite, a √©t√© ajout√© l'√©metteur-r√©cepteur CAN TJA1051, avec lequel vous pouvez obtenir un tas de donn√©es int√©ressantes et peu volumineuses du bus CAN du v√©hicule.  Pour l'instant, je n'utilise que la sortie de consommation de carburant par heure, car  bk r√©gulier n'a pas une telle fonction. <br><br><img src="https://habrastorage.org/webt/9t/4u/pz/9t4upz_0ggt3iwkn3_sro19la34.jpeg" alt="image"><br><br>  Vid√©o comment cela fonctionne: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/7zL-TJ1qteM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Comme vous l'avez peut-√™tre remarqu√©, le texte russe est affich√© en translitt√©ration, plus ou moins intelligent.  Par exemple, la lettre <b>h</b> est remplac√©e par ch, etc., ce qui n'a pas pu √™tre r√©alis√© par des moyens r√©guliers.  Eh bien, en plus, la prise en charge de l'audio sans perte. <br><br>  Pour ceux qui ont soif de d√©tails.  Les 3 UART sont impliqu√©s.  Un sur l'√©cran, un sur les touches et un sur le module Bluetooth.  Le flux sonore est commut√© par un multiplexeur analogique.  CAN est √©galement utilis√© √† partir de STM32.  Il y a un DAC externe PCM5102, le son est tr√®s bon.  Se connecte entre la t√™te et le c√¢blage de la voiture.  Les connecteurs ont √©t√© trouv√©s lors du d√©montage. <br><br>  Il s'est av√©r√© √™tre plus cher que l'achat d'un syst√®me Bluetooth classique, mais il a apport√© beaucoup plus de plaisir au d√©veloppement. <br><br>  Il est pr√©vu de permettre de personnaliser les fonctions de personnalisation automobile (les propri√©taires de Mitsubishi 2008+ comprendront de quoi il s'agit), le protocole est d√©j√† l√†, tout est v√©rifi√©, il reste √† impl√©menter dans le firmware. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Vous pouvez obtenir le code ici.</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr442384/">https://habr.com/ru/post/fr442384/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr442372/index.html">Programmation fiable dans le contexte des langages. Partie 2 - Challengers</a></li>
<li><a href="../fr442374/index.html">D√©veloppement de boost boost sur DSP: principe de fonctionnement, calculs, prototypage</a></li>
<li><a href="../fr442376/index.html">Densit√© de parcelle au d√©tail</a></li>
<li><a href="../fr442378/index.html">Un clic dans l'interface de Booking com peut g√¢cher des vacances ou pourquoi un syst√®me de notation fonctionnel est important</a></li>
<li><a href="../fr442380/index.html">Sort Chaos</a></li>
<li><a href="../fr442386/index.html">Thymeleaf: Disposition des dialectes + Spring Boot 2</a></li>
<li><a href="../fr442392/index.html">La journalisation NodeJS est bien faite</a></li>
<li><a href="../fr442396/index.html">√âv√©nements num√©riques √† Moscou du 04 mars au 10 mars</a></li>
<li><a href="../fr442402/index.html">Le plus important. Int√©gration avec des services externes</a></li>
<li><a href="../fr442404/index.html">Le plus important. Int√©gration avec des services externes (partie 2)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>