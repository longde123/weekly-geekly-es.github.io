<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßìüèæ üßòüèø ‚õèÔ∏è √Ä propos de la m√©thode d'authentification tr√®s espion üà∑Ô∏è üóÉÔ∏è ‚óºÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Donc, nous envoyons des agents super secrets Alice et Bob dans un pays ennemi sous couverture. Au cours de la mission, ils devront contacter et travai...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>√Ä propos de la m√©thode d'authentification tr√®s espion</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/456670/"><p> Donc, nous envoyons des agents super secrets Alice et Bob dans un pays ennemi sous couverture.  Au cours de la mission, ils devront contacter et travailler ensemble, √©changer des informations, des affaires d'espionnage ordinaires.  Bien s√ªr, tout cela doit √™tre fait dans le respect de toutes les r√®gles et proc√©dures de s√©curit√© possibles. </p><br><p>  En effet, au dernier tour, nous voulons les r√©v√©ler: tant la mission elle-m√™me que les agents eux-m√™mes et toute la s√©curit√© nationale sont menac√©s.  Par cons√©quent, il est dans notre int√©r√™t de donner aux espions le minimum d'informations n√©cessaires.  En particulier, moins ils se connaissent et connaissent les techniques de communication, mieux c'est. </p><br><p>  Mais comment identifieront-ils alors leur camarade de quartier g√©n√©ral? </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/ceb/454/721/ceb4547217be4972a9e5f8fe323cf257.gif" alt="KDPV"></p><br><p>  TL; DR - inventer un m√©canisme d'authentification des utilisateurs utilisant la st√©ganographie pour une agence imaginaire √† trois caract√®res d'un pays inexistant. </p><a name="habracut"></a><br><h2 id="o-volkah-i-ovechih-shkurah">  √Ä propos des peaux de loups et de moutons </h2><br><p>  Une couverture est une couverture, donc ni Alice ni Bob ne doivent √©veiller les soup√ßons de leurs actions.  Une bonne planification implique une parano√Øa quant √† leur suivi constant √† tous les niveaux possibles.  Cet article ne traitera pas de la t√¢che d'√©change direct d'informations (il m√©rite sa propre s√©rie s√©par√©e), mais seulement d'un moyen de s'assurer qu'il est transmis par ceux qui en ont besoin √† quiconque en a besoin. </p><br><p>  Tr√®s probablement, les deux espions auront une histoire sous la forme de citoyens ordinaires, en outre, aucunement li√©s l'un √† l'autre.  Par cons√©quent, vous devez imm√©diatement opposer votre veto √† l'utilisation d'outils cryptographiques classiques et de canaux s√©curis√©s - chaque agent de contre-espionnage sait que les personnes honn√™tes qui n'ont pas de connexion √©troite n'ont rien √† cacher. </p><br><h2 id="chto-delat">  Que faire </h2><br><p>  Bien s√ªr, une telle t√¢che n'est pas nouvelle, elle a heureusement exist√© et a √©t√© r√©solue bien avant l'av√®nement de celles de votre Internet.  Et non seulement cela a √©t√© d√©cid√©, mais certaines d√©cisions ont √©t√© renforc√©es dans la culture et se retrouvent toujours dans les livres, les films et les jeux. </p><br><p>  Regardons une telle sc√®ne: deux personnes en longs manteaux convergent dans un lieu public et √©changent des phrases tr√®s √©tranges.  Si la phrase et la r√©ponse initiales sont correctes, l'authentification a r√©ussi et les gens √©changent des dossiers marqu√©s "Top Secret" et divergent dans des directions inconnues. </p><br><p>  L'inconv√©nient d'un tel sch√©ma est imm√©diatement √©vident - les phrases doivent √™tre gard√©es secr√®tes et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">souvent modifi√©es</a> , ce qui n'est pas tr√®s simple en territoire ennemi.  Dans le m√™me temps, afin de ne pas √™tre parl√©s au hasard et de ne pas conduire au cas du KDPV, ils deviennent assez importants et al√©atoires, ce qui signifie qu'ils peuvent donner des agents qui les prononcent. </p><br><p><img src="https://habrastorage.org/webt/pl/pe/sh/plpeshe7ifcmijrxlaziosekgey.png"></p><br><p>  √Ä l'√®re du num√©rique, nous n'aimons pas cette m√©thode.  Surtout si vous vous souvenez que presque tous les canaux de communication sont contr√¥l√©s par quelqu'un et sont exploit√©s √† la fois pour de bons et de mauvais motifs.  Et peu importe ce qu'ils nous assurent, la vie des gens ne doit pas faire confiance √† la politique de confidentialit√© de Facebook. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/984/c5d/c5d/984c5dc5dae5cba450b58907693ceed6.png"></p><br><h2 id="steganografiya-opyat">  St√©ganographie (encore?) </h2><br><p>  H√©risson, il est clair que la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">capacit√© de se cacher</a> dans une telle situation semble plus attrayante que jamais.  Et en fait, m√™me la m√©thode d√©crite est sa sous-esp√®ce - les phrases de code peuvent √™tre consid√©r√©es comme des conteneurs avec seulement un bit d'information √† l'int√©rieur. </p><br><p>  Le m√™me mammif√®re du d√©tachement insectivore comprend qu'il ne s'agit pas simplement de se jeter des st√©goconteneurs.  Un tel √©change provoquera presque plus de suspicion qu'un cryptage PGP commun, nous ne sommes donc pas int√©ress√©s. </p><br><h3 id="a-o-chem-togda">  Et alors? </h3><br><p>  Contrairement aux cryptogrammes, les stegocontainers ont un avantage √©vident - le contexte de l'application.  Tout texte, image, fichier audio, etc., en plus du contenu √©vident, comporte √©galement la possibilit√© de sa discussion <strong>naturelle</strong> et peut √™tre envoy√© non seulement depuis la baie, mais dans le processus d'un dialogue qui ne provoque pas de soup√ßons. </p><br><p>  Arm√©s de telles id√©es, nous pouvons d√©j√† √©laborer un protocole d'authentification st√©ganographique simple bas√© sur une cl√© commune: </p><br><ul><li>  A -&gt; B: un joli message demandant un conteneur st√©ganographique de certains param√®tres; </li><li>  B: s√©lectionne le conteneur <em>C</em> qui correspond au contexte et aux param√®tres demand√©s; </li><li>  B: cr√©e de mani√®re similaire un message <em>M</em> ; </li><li>  B -&gt; A: <em>C '= Embed (C, M, K)</em> ; </li><li>  A: v√©rifie <em>la</em> conformit√© de <em>C '</em> avec les param√®tres d√©finis; </li><li>  A -&gt; B: <em>M '= extrait (C', K)</em> ; </li><li>  B: v√©rifie si <em>M</em> et <em>M '</em> correspondent. </li></ul><br><p>  Un tel protocole pr√©sente des inconv√©nients √©vidents - Alice et Bob doivent avoir √† la fois une cl√© commune et des fonctions d'int√©gration et d'extraction.  Leur compromis peut conduire √† la possibilit√© d'une analyse d√©taill√©e de la m√©thode d'authentification de l'ennemi et mettre en danger les autres utilisateurs et le quartier g√©n√©ral.  Quelque chose doit √™tre r√©par√©. </p><br><h2 id="ispolnitel-ne-cherepashka">  L'artiste n'est pas un bug </h2><br><p>  Si le lecteur est all√© √† l'√©cole apr√®s l'av√®nement des cours d'informatique, il devrait se souvenir d'avoir appris les bases de l'algorithmisation en utilisant l'interpr√®te d'une tortue, d'une fourmi et autres.  Leur id√©e √©tait de d√©montrer les possibilit√©s d'optimiser un grand nombre d'actions individuelles manuelles en cr√©ant des programmes simples.  Pour r√©soudre notre probl√®me, nous devons aller dans la direction oppos√©e. </p><br><p><img src="https://habrastorage.org/webt/nc/lo/lo/nclolotljunb2zzbkgr2-4qo0ri.png" alt="Eh bien, n'est-ce pas mignon?"></p><br><p>  Puisque nous pouvons simplifier l'√©criture de l'algorithme final de la s√©quence des √©tapes √† leur description proc√©durale en fonction des param√®tres donn√©s, nous pouvons effectuer le processus inverse.  Si vous imaginez un conteneur comme un tableau de certains de ses composants, l'incorporation d'un message par cl√© peut √™tre √©crite comme une s√©quence ordonn√©e d'op√©rations sur des √©l√©ments de conteneur √† des indices sp√©cifiques avec divers param√®tres constants. </p><br><p>  C'est l√† que les math√©matiques ne commencent pas, alors je demande aux timides de parcourir simplement les paragraphes difficiles √† regarder jusqu'√† la section des op√©rations ou m√™me un peu plus loin.  Il ne se passera rien de terrible, je le promets. </p><br><p>  Pour int√©grer les donn√©es, nous avons besoin d'une s√©quence de la forme: <em>(f1, S1, i, D1), (f2, S2, j, D2) ...</em> , o√π: </p><br><ul><li>  <em>Di</em> - une partie des donn√©es int√©gr√©es; </li><li>  <em>i, j</em> sont les indices des √©l√©ments du conteneur; </li><li>  <em>fi: (State, Element, D) -&gt; (State, Element)</em> - fonction d'int√©gration; </li><li>  <em>Si</em> est un certain √©tat, le contexte de l'op√©ration, <em>(El ', S [i + 1]) = fi (Si, El, Di)</em> . </li></ul><br><p>  Pour l'extraire, vous n'avez pas besoin de stocker des parties des donn√©es (K.O.), donc il y a suffisamment de triplets: <em>(g1, S1, I1), (g2, S2, I2) ...</em> avec les m√™mes valeurs, seulement <em>gi: (State, Element) -&gt; (√âtat, D)</em> . </p><br><p>  Tout cela peut √™tre repr√©sent√© par le diagramme sym√©trique ci-dessous.  Si pour une raison quelconque je n'ai pas r√©ussi √† atteindre la clart√©, alors ce n'est pas effrayant, lisez la suite. </p><br><p><img src="https://habrastorage.org/webt/l7/yk/pk/l7ykpkwfi8sfkcebwxryswzo1r0.png" alt="Eh bien ou pas plus"></p><br><p>  On peut voir que la fonction d'int√©gration a un plus grand nombre de degr√©s de libert√©.  Contrairement √† sa s≈ìur, elle modifie le conteneur, tout en le faisant sur la base de deux √©l√©ments ind√©pendants - les donn√©es int√©gr√©es et l'√©l√©ment.  Merci, ou plus pr√©cis√©ment √† cause de cela, deux approches globales de la mise en ≈ìuvre de l'algorithme de st√©ganographie par un tel syst√®me sont possibles: </p><br><ol><li>  Choisissez les indices les plus appropri√©s des √©l√©ments √† modifier en fonction de la fonction d'int√©gration (moins perceptible ou ne l'exigeant pas du tout) et transf√©rez la s√©quence form√©e li√©e √† un conteneur sp√©cifique.  Avec cette approche, ils doivent √™tre isol√©s les uns des autres avant qu'il ne soit n√©cessaire de les int√©grer √† l'aide de m√©thodes classiques telles que le chiffrement et d'autres supports s√©curis√©s; </li><li>  Trouvez une telle m√©thode de division du conteneur en √©l√©ments et la fonction d'int√©gration que tout changement attendu par celui-ci sera √©galement invisible.  Dans ce cas, la s√©quence est ind√©pendante du conteneur et peut √™tre cr√©√©e m√™me par un g√©n√©rateur compl√®tement al√©atoire.  Moins de flexibilit√© et un manque de contr√¥le du pire des cas.  D'un autre c√¥t√©, cette approche est plus simple et plus pratique lorsqu'elle est appliqu√©e sur le terrain, je vais donc l'utiliser ci-dessous. </li></ol><br><p>  Si l'√©tat n'est pas requis pour l'algorithme, alors tout ce qui pr√©c√®de reste valide, simplement sans une seule lettre et un bloc sur le diagramme.  Sans cela, c'est encore plus facile, en fait. </p><br><h2 id="i-zachem-ono-nam">  Et pourquoi en avons-nous besoin? </h2><br><p>  Maintenant, si vous savez √† l'avance quels conteneurs avec quels messages et cl√©s seront utilis√©s, au lieu de r√©v√©ler compl√®tement les parties de l'algorithme, vous pouvez g√©n√©rer et donner aux agents √† utiliser uniquement ces s√©quences et un interpr√®te pour elles.  Eh bien, ok, pas seulement donner, bien s√ªr, mais plus sur cela plus tard. </p><br><h3 id="dobavlyaem-asimmetrichnost">  Ajouter une asym√©trie </h3><br><p>  M√™me un artiste tortue peut dessiner un carr√© de centaines de fa√ßons diff√©rentes, en changeant simplement l'ordre des op√©rations et en en ajoutant de nouvelles.  Cela signifie que personne ne nous d√©range et ne fait de m√™me avec les s√©quences d√©crites pour les donn√©es d'entr√©e fixes. </p><br><p>  Autrement dit, nous pouvons prendre la s√©quence d'int√©gration, ajouter de nouvelles op√©rations, tout m√©langer, et pour que le r√©sultat reste le m√™me.  Sauf en pr√©sence d'un √©tat, il sera n√©cessaire de le suivre et d'ajouter s√©par√©ment les modifications n√©cessaires √† la s√©quence.  C'est pourquoi sans cela, c'est plus facile, oui. </p><br><p>  D'une mani√®re ou d'une autre, apr√®s un tel p√©trissage et un tel bruit, m√™me le plongeur lui-m√™me ne pourra plus comprendre ce qu'il int√®gre r√©ellement: toute s√©quence de <em>N</em> op√©rations repr√©sentera <em>N!</em>  messages potentiellement int√©gr√©s - un pour chaque permutation des parties int√©gr√©es.  En m√™me temps, <em>N</em> lui-m√™me est une grande question.  Par cons√©quent, on peut appeler de telles s√©quences ouvertes - elles ne fournissent aucune information ni sur le message incorpor√©, ni sur l'algorithme et la cl√© utilis√©s. </p><br><p>  Lors de l'extraction d'informations, il est tr√®s important pour nous √† la fois l'ordre (pour restaurer le message correct de tous les possibles) et le nombre de pi√®ces √† extraire, de sorte que les s√©quences d'extraction restent inchang√©es depuis le moment de la naissance.  Comme ils contiennent implicitement des informations sur la cl√©, le g√©n√©rateur et l'algorithme utilis√©s, ils doivent, comme les animaux du livre rouge, √™tre stock√©s et prot√©g√©s.  Et gardez le secret. </p><br><p>  Qu'est-ce que l'asym√©trie a √† voir avec cela?  Le fait est que d√©sormais chaque s√©quence d'extraction est associ√©e √† un nombre infini de plongeurs.  Et restaurer l'un √† partir de l'autre est, dans le cas g√©n√©ral, une t√¢che insoluble. </p><br><h3 id="ekspluatiruem">  Nous op√©rons </h3><br><p>  Nous oublions toutes les quasi-math√©matiques et revenons √† la t√¢che d'origine - comment pouvons-nous envoyer Alice et Bob en territoire ennemi afin de: </p><br><ul><li>  ils ne se connaissaient pas </li><li>  n'avait aucun algorithme secret sous la main </li><li>  mais pourriez-vous vous v√©rifier tout en communiquant sur un canal ouvert? </li></ul><br><p>  Eh bien, avec le premier paragraphe, tout est clair, nous ne leur donnons simplement aucune information explicite les uns sur les autres, pas de cl√©s partag√©es.  Pour la seconde, vous devez vous souvenir de la description du protocole ci-dessus.  Maintenant, nous pouvons exclure directement les algorithmes d' <em>int√©gration</em> et d' <em>extraction</em> qui repr√©sentent des secrets d'√©tat potentiels et tout cela.  Et, en tenant compte de cela, pour le troisi√®me, il est possible d'√©laborer le protocole en deux √©tapes suivant. </p><br><p>  G√©n√©ration d'informations d'authentification <strong>avant le d√©but de la mission</strong> avec le si√®ge en tant que partie de confiance de Trent: </p><br><ul><li>  T: s√©lectionne l'algorithme secret et la cl√© secr√®te K, cr√©e avec leur aide: <br><ul><li>  Extraire la s√©quence <em>Ex</em> ; </li><li>  adapt√© √† l'authentification (ci-dessous) Contexte <em>Ctx</em> ; </li></ul></li><li>  T -&gt; A: <em>Ctx, Ex</em> ; </li><li>  T: en utilisant <em>Ex</em> et le contexte cr√©√©, g√©n√®re: <br><ul><li>  message <em>M</em> non utilis√© pr√©c√©demment pour les agents s√©lectionn√©s parmi les pi√®ces <em>| Ex |</em>  ; </li><li>  une s√©quence unique de <em>Em</em> , la rendant ouverte comme d√©crit ci-dessus; </li></ul></li><li>  T -&gt; B: <em>Em, h (M)</em> , si vous le souhaitez, cr√©e des ensembles suppl√©mentaires. </li></ul><br><p>  Ainsi, Alice n'a qu'une seule s√©quence pour toutes les occasions et le contexte des contacts futurs, et Bob devient l'heureux propri√©taire d'un ensemble de s√©quences uniques et de hachages de messages qu'ils int√®grent. </p><br><p>  Le protocole d'authentification d√©j√† <strong>pendant la mission</strong> ressemble √† ceci: </p><br><ul><li>  A -&gt; B: un message <em>IM</em> initiateur bas√© sur le contexte <em>Ctx</em> avec une description du conteneur; </li><li>  B: s√©lectionne le <em>C ~ IM</em> appropri√©; </li><li>  B -&gt; A: <em>C '= Em (C)</em> ; </li><li>  R: v√©rifie la conformit√© avec <em>C '~ IM</em> (puisque les modifications sont invisibles, elles doivent √™tre enregistr√©es); </li><li>  A -&gt; B: <em>M '= Ex (C')</em> , marque M 'comme utilis√©; </li><li>  B: v√©rifie, <em>h (M ') == h (M)</em> , d√©truit <em>Em, h (M)</em> . </li></ul><br><p>  Un lecteur attentif remarquera qu'avant le protocole, Alice et Bob ne disposent que d'un ensemble d'informations, ce qui en soi ne signifie rien pour eux, ni pour un adversaire potentiel, et uniquement pendant le "jeu avec les couleurs". </p><br><p>  Chaque ensemble ouvert de Bob n'est utilis√© qu'une seule fois, ce qui est contr√¥l√© par l'avant-derni√®re √©tape d'Alice.  Lorsqu'elle rencontre un <em>M</em> pr√©c√©demment utilis√© (et, par cons√©quent, un <em>Em</em> invisible <em>par</em> elle) par une autre personne, elle se rend compte que l'un de ses ¬´associ√©s¬ª est un faux. </p><br><p>  L'utilisation r√©p√©t√©e par la m√™me personne lui dit qu'elle n'est pas au courant des subtilit√©s du protocole et n'est certainement pas celle avec qui elle a d√ª entrer en contact.  Eh bien, mieux vaut tard que jamais. </p><br><p><img src="https://habrastorage.org/webt/bv/6v/0h/bv6v0hcim8kmzndrvn5__thsp1y.png"></p><br><p>  D'accord, voil√† √† quoi tout cela semble trop compliqu√© et incompr√©hensible.  Quelqu'un est arriv√© ici? </p><br><p>  Mieux vaut le d√©montrer dans la pratique, car m√™me les espions eux-m√™mes n'ont pas besoin de conna√Ætre les d√©tails du protocole √† utiliser, encore moins les pauvres lecteurs.  Tout d'abord un peu sur la fa√ßon dont tout cela a √©t√© mis en ≈ìuvre. </p><br><h2 id="vysokie-tehnologii">  Haute technologie </h2><br><p>  Il ne reste donc qu'√† √©crire tout ce qui est n√©cessaire au protocole.  Eh bien, vous ne faites pas tout avec vos mains (m√™me si vous le pouvez).  Et aujourd'hui, la victime de mon code va ... faire <em>tourner la roue de la fortune</em> ... Java?  Et bien, en m√™me temps, tout en STL sera, vous n'aurez rien √† chercher. </p><br><p>  Commen√ßons par l'API requise.  Pour fonctionner, il vous suffit de d√©terminer la classe du tableau d'√©l√©ments de conteneur avec la possibilit√© de recevoir et de modifier des √©l√©ments par index: </p><br><pre><code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyContainer</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StegoContainer</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyElement</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> MyElement </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> i)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//  i-  } public void set(int i, MyElement v) { //  i-  } public int size() { //    } }</span></span></code> </pre> <br><p>  Une utilisation ult√©rieure est r√©duite √† la cr√©ation d'une enveloppe d'un automate st√©ganographique sur le conteneur n√©cessaire et √† la fourniture des fonctions d'incorporation et d'extraction √† son entr√©e: </p><br><pre> <code class="java hljs">StegoMachine&lt;MyState, MyElement&gt; myMachine = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StegoMachine( initialState, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MyContainer&lt;MyElement&gt;(<span class="hljs-comment"><span class="hljs-comment">/*   */</span></span>) ); <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> StegoEmbed myEmbed = (st, el, dp) -&gt; { <span class="hljs-comment"><span class="hljs-comment">//    dp   el   st }; final StegoExtract myExtract = (st, el) -&gt; { //     el   st return dp; }; //    MyDataPart part = /*    */; myMachine.exec(1337, myEmbed, part); //... //    /,   //      State currState = myMachine.getState(); //... //    part = myMachine.exec(80085, myExtract); //... //        MyContainer container = (MyContainer) myMachine.getContainer();</span></span></code> </pre> <br><p>  Les classes avec le suffixe Stateless sont utilis√©es de la m√™me mani√®re, si la mise en ≈ìuvre de l'algorithme ne n√©cessite pas de maintenir l'√©tat interne. </p><br><p>  Les g√©n√©rateurs de s√©quences peuvent fonctionner comme vous le souhaitez et n'ont pas d'API commune.  Dans le cas g√©n√©ral, tout peut faire partie des donn√©es en g√©n√©ral, des bits isol√©s √† l'art rupestre dans un codage s√©par√©. </p><br><h3 id="primer-realizacii">  Exemple d'impl√©mentation </h3><br><h4 id="o-metode">  √Ä propos de la m√©thode </h4><br><p>  √Ä titre d'exemple d'impl√©mentation, en utilisant les interfaces cr√©√©es, j'ai impl√©ment√© un algorithme simple de la famille LSB pour les images bitmap avec compression sans perte.  Leurs √©l√©ments sont des pixels qui n'ont pas de voisins dans le bit le moins significatif de tous les composants RVB.  La fonction d'int√©gration fonctionne avec des bits uniques des donn√©es source et modifie simplement le bit de poids faible de la valeur de l'un des composants (vers lequel l'index pointera). </p><br><p>  C'est assez simple, mais c'est g√©nial pour impl√©menter le protocole, car changer un √©l√©ment est √©galement imperceptible selon son choix, donc les indices des √©l√©ments √† changer sont g√©n√©r√©s √† l'aide d'un g√©n√©rateur al√©atoire.  Dans le cas de Java, en utilisant <em>SecureRandom</em> , mais si vous le souhaitez, il passe facilement √† sa source d'entropie. </p><br><p>  <em>N√©anmoins, c'est une m√©thode tr√®s simple, je ne recommande pas de l'utiliser pour de vrais espions.</em> </p><br><h4 id="o-heshah">  √Ä propos des hachages </h4><br><p>  √âtant donn√© que le texte a tendance √† √™tre d√©form√© en fonction de l'identit√© simul√©e de l'agent (certains ne mettent pas de majuscules, d'autres aiment mettre des √©motic√¥nes, etc., d'autres sont g√©n√©ralement analphab√®tes), je sugg√®re d'utiliser sha256 pour calculer le hachage, mais uniquement √† partir de mots imprim√©s en minuscules: </p><br><pre> <code class="plaintext hljs">h("Hello world?...") == h("hello, world!11")</code> </pre> <br><h4 id="ob-interfeyse">  √Ä propos de l'interface </h4><br><p>  Le progiciel se compose de deux parties - l'une pour g√©n√©rer des s√©quences et d'autres hachages pour Trent, l'autre pour int√©grer et v√©rifier la conformit√© des messages re√ßus. </p><br><p>  Le travail avec les deux se produit √† partir de la ligne de commande via ses arguments et ses flux d'entr√©e-sortie; aucune autre interface n'a √©t√© fournie (peur et horreur).  Pourtant, √™tre cet employ√© du quartier g√©n√©ral, que l'espion - signifie avoir une sorte de qualification.  Eh bien, sinon, je vais toujours montrer un exemple. </p><br><div class="spoiler">  <b class="spoiler_title">Voici une aide</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/yx/1m/ge/yx1mge8ligshzbsv7hxi3olw__g.png" alt="Capture d'√©cran d'utilisation"></p><br></div></div><br><h3 id="chto-im-vsem-delat-to">  Que font-ils tous? </h3><br><p>  Pour commencer, Trent au si√®ge doit √©laborer des informations d'authentification.  En particulier, r√©fl√©chir √† l'avance √† une situation dans laquelle les agents travailleront. </p><br><p>  Par exemple, laissez Bob √™tre un graphiste ind√©pendant et Alice son client.  L'authentification aura lieu sous le couvert d'une commande pour cr√©er des graphiques / design / autre chose. </p><br><p>  Nous rapportons ces informations utiles aux deux et revenons au protocole lui-m√™me.  Nous pr√©parerons √† l' <em>avance</em> un message int√©gr√© <em>M.txt</em> appropri√©, en minimisant le nombre de caract√®res qu'il <em>contient</em> : "cela me convient bien o√π transf√©rer de l'argent."  G√©n√©rez <em>Em</em> et <em>Ex</em> √† l'aide de l'utilitaire pour Trent: </p><br><pre> <code class="bash hljs">Trent@HQWorkstation:~$ java -jar HQUtil.jar -ex $(<span class="hljs-built_in"><span class="hljs-built_in">stat</span></span> -c%s <span class="hljs-string"><span class="hljs-string">"M.txt"</span></span>) 4096 &gt; Ex.txt Trent@HQWorkstation:~$ cat Ex.txt | java -jar HQUtil.jar -em <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$(cat M.txt)</span></span></span><span class="hljs-string">"</span></span> 0.25 4096 &gt; Em.txt Trent@HQWorkstation:~$ cat M.txt | java -jar HQUtil.jar -h &gt; hash.bin</code> </pre> <br><p>  Ici <code>$(stat -c%s "M.txt")</code> renvoie la taille du message en octets, et 4096 - la restriction sur la plage d'index g√©n√©r√©s (pour permettre l'utilisation de conteneurs plus petits).  De m√™me, <code>$(cat M.txt)</code> utilis√© pour passer le message lui-m√™me au param√®tre de ligne de commande.  En principe, vous pouvez vous passer de la bash, en utilisant votre propre travail manuel, mais pour qui c'est plus pratique. </p><br><p>  <em>Ex.txt</em> est transmis √† Alice, <em>Em.txt</em> et <em>hash.bin</em> √† Bob.  Imaginez maintenant que les agents se sont d√©ploy√©s avec succ√®s et souhaitent communiquer entre eux - nous proc√©dons √† l'ex√©cution du protocole.  Bob place son curriculum vitae ou offre d'emploi sur un √©change, et Alice commence la communication: </p><br><pre> <code class="plaintext hljs">: ,     %_% :        ,   .  ? : ,   </code> </pre> <br><p>  Bob cherche une image d'un parapluie, peut-√™tre m√™me le dessine lui-m√™me si l'√¢me est cr√©ative, compresse / impose un filigrane un peu (ou ce que les pigistes y font maintenant) et le fait: </p><br><pre> <code class="bash hljs">Bob@PC:~$ cat Em.txt | java -jar SpyUtil.jar -e umbrella.png</code> </pre> <br><p>  Apr√®s avoir attendu un moment, faisant semblant de travailler, si en r√©alit√© il ne l'a pas fait, il envoie naturellement √† Alice le conteneur re√ßu, en gardant √† l'esprit le contexte: </p><br><pre> <code class="plaintext hljs">: ,  ,     </code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Transmet un parapluie avec un message, 670kb</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/qw/nk/in/qwnkinuhpppynf6ve9gkrmpnehm.png"></p></div></div><br><p>  Cela, √† son tour, r√©cup√®re le message stock√© en interne: </p><br><pre> <code class="bash hljs">Alice@PC:~$ cat Ex.txt | java -jar SpyUtil.jar -e umbrella.png      </code> </pre> <br><p>  Transforme un ensemble de mots en une phrase normale et l'envoie √† Bob: </p><br><pre> <code class="plaintext hljs">: ,  ,   ?</code> </pre><br><p>  Il v√©rifie l'exactitude du message: </p><br><pre> <code class="java hljs">Bob<span class="hljs-meta"><span class="hljs-meta">@PC</span></span>:~$ java -jar SpyUtil.jar -c hash.bin <span class="hljs-string"><span class="hljs-string">",  ,   ?"</span></span> ,  ,   ? - Correct</code> </pre><br><p>  Et continue une communication facile, si tout va bien.  L'ensemble du dialogue de la part de l'observateur ressemble √† ceci: </p><br><div class="spoiler">  <b class="spoiler_title">500 kilo-octets gif</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/ff/ye/he/ffyeheonv4qo9dxdjygalg8kvtq.gif"></p></div></div><br><p>  Il est clair que le contre-espionnage ne trouvera rien de suspect dans tout cela intercept√©.  En fait, m√™me les m√©thodes d'analyse st√©ganique dans ce cas ne seront pas toujours appliqu√©es - eh bien, quelqu'un a command√© une photo d'un parapluie pour 5 dollars, il a trouv√© quelque chose pour surprendre Internet.  Les ressources informatiques et les personnes ne sont pas interminables pour v√©rifier chacune de ces situations.  L'authentification a r√©ussi, le rideau. </p><br><p>  -&gt; <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr456670/">https://habr.com/ru/post/fr456670/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr456658/index.html">Growth up: comment nous √©valuons les comp√©tences en √©quipe</a></li>
<li><a href="../fr456662/index.html">Comment √©conomiser de l'argent sur un th√©rapeute en utilisant le d√©veloppement pilot√© par les tests</a></li>
<li><a href="../fr456664/index.html">Qui poursuivre lorsqu'un robot perd votre argent</a></li>
<li><a href="../fr456666/index.html">WebTotem ou comment nous voulons rendre Internet plus s√ªr</a></li>
<li><a href="../fr456668/index.html">Microsoft ML Spark: une extension Spark qui rend SparkML plus humain et LightGBM en bonus</a></li>
<li><a href="../fr456672/index.html">Recettes Nginx: notifications asynchrones de PostgreSQL vers websocket</a></li>
<li><a href="../fr456674/index.html">De nouvelles opportunit√©s de promotion sur Facebook que vous ne connaissiez pas</a></li>
<li><a href="../fr456676/index.html">Connexion √† une application PHP distribu√©e</a></li>
<li><a href="../fr456680/index.html">Huit lois de d√©nomination dans la conception UX (partie 2)</a></li>
<li><a href="../fr456682/index.html">Comportement ind√©fini avec des d√©clarations de fonctions obsol√®tes dans ANSI C</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>