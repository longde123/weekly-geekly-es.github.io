<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐲 👩🏽 👍🏾 WiFi Radio WOLNA. Wie ein kleines Startup erstellt wurde 👑 🤒 📄</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vor nicht allzu langer Zeit habe ich ein Gerät meines eigenen Designs, das letztes Jahr entwickelt wurde, vor ein öffentliches Gericht gestellt. Dies ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>WiFi Radio WOLNA. Wie ein kleines Startup erstellt wurde</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/403239/"> Vor nicht allzu langer Zeit habe ich ein Gerät meines eigenen Designs, das letztes Jahr entwickelt wurde, vor ein öffentliches Gericht gestellt.  Dies ist ein Internetradio mit WLAN. <br><br><img src="https://habrastorage.org/files/f54/afe/69e/f54afe69e5d844a494f9a0dfec8604c4.png" alt="Bild"><br><br>  Es wird vorgeschlagen, an einer der Crowdfunding-Sites für oder gegen Menschen in Rubel zu stimmen.  Das Gerät sorgte nicht für Furore, obwohl es bereits Sponsoren gibt.  Seitdem gab es jedoch viele technische Fragen und Anforderungen, um die Schaltung und Firmware zu gestalten.  Jeder, der daran interessiert ist, wie das Gerät geboren wurde und woraus es besteht, ist unter Katze willkommen. <br>  <i>Spoiler:</i> Es wird keine Firmware geben. <br><a name="habracut"></a><br>  Alles begann mit der Notwendigkeit, ein Radio in der Küche zu Hause zu haben.  Natürlich habe ich als Elektronikentwickler sofort die Möglichkeit abgelehnt, einfach in den Laden zu gehen und zu kaufen.  Aus diesem Grund habe ich übrigens immer noch keine normale Türklingel. <br><br>  Das UKW-Radio wurde aufgrund der langweiligen Implementierung eingestellt.  Und es wurde beschlossen, ein Internetradio zu machen.  Mit Blick auf die Zukunft möchte ich zeigen, dass sich hier ein solcher Empfänger herausgestellt hat. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/wiW4ZcnPw18" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  <b>Eisenauswahl</b> <br><br>  Zunächst musste eine Plattform ausgewählt werden, auf der Sie ein Internetradio aufbauen können.  Es gibt viele Möglichkeiten, aber ich habe aus den verfügbaren Optionen ausgewählt: <br><br>  1. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Odroid W</a> + LCD <br>  2. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">STM32F4DISCOVERY</a> + <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ESP8266</a> + <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">VS1053B</a> <br><br>  Bei einem Odroid würde der Entwicklungsprozess weniger Zeit in Anspruch nehmen, aber die Nachteile, in meinem speziellen Fall (viele stimmen mir nicht zu), haben sich durchgesetzt: <br><br>  - Das Laden des Betriebssystems dauert einige Zeit <br>  - Eine wachsende Tendenz, IoT-Geräte mit Viren zu infizieren <br>  - Ich habe schlechte Kenntnisse der Linux-Entwicklung <br>  - Preis <br><br>  Trotzdem bat ich einen meiner guten Freunde, einen Softink für Odroid W zu schreiben, der beim Start des Systems starten und Internetradio spielen würde.  Aber die Unfähigkeit, das Projekt richtig zu bearbeiten, ohne einen Kameraden zu ruckeln, begrub diese Option und brachte mich zum zweiten. <br><br>  Und ich habe das folgende Diagramm auf einem Steckbrett zusammengestellt: <br><br><img src="https://habrastorage.org/files/c09/207/c4d/c09207c4d0bb40d589c165e8493d4d7e.png" alt="Bild"><br><br>  <b>Wie man mit Internetradio arbeitet</b> <br><br>  Danach begann ich zu sehen, wie das Internetradio funktioniert.  Es stellte sich heraus, dass die überwiegende Mehrheit der Sender <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Icecast</a> für die Ausstrahlung verwendet.  Es dreht sich irgendwo auf einem Server mit einer festen IP und wartet auf eine Verbindung.  In der Regel bei 8000 oder 8080 Port.  Obwohl es viele Ausnahmen gibt.  Nach dem Herstellen der Verbindung müssen Sie eine Anfrage dieses Typs senden und den Namen des Streams und des Servers darin ersetzen: <br><br><pre><code class="hljs powershell">GET /stream HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> Icy<span class="hljs-literal"><span class="hljs-literal">-MetaData</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> User<span class="hljs-literal"><span class="hljs-literal">-Agent</span></span>: Mozilla/<span class="hljs-number"><span class="hljs-number">5.0</span></span> (X11; U; Linux i686; en<span class="hljs-literal"><span class="hljs-literal">-US</span></span>; rv:<span class="hljs-number"><span class="hljs-number">1.6</span></span>) Gecko/<span class="hljs-number"><span class="hljs-number">20040413</span></span> Epiphany/<span class="hljs-number"><span class="hljs-number">1.2</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> Host: internetradioserver.ru Cache<span class="hljs-literal"><span class="hljs-literal">-Control</span></span>: no<span class="hljs-literal"><span class="hljs-literal">-cache</span></span></code> </pre> <br>  Als Reaktion darauf beginnt ein <s>endloser</s> MP3-Stream zu fallen, der bereits dekodiert und abgespielt werden kann. <br><br>  Das Öffnen einer TCP-Verbindung und andere Freuden bei der Arbeit mit dem ESP8266 erfolgen mithilfe von AT-Befehlen.  Ich werde nicht auf sie eingehen, die Informationen im Internet sind voll.  In der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">russischsprachigen Gemeinschaft esp8266</a> ist alles sehr gut gemalt.  Das Verfahren zum Arbeiten ist einfach: <br><br>  1. Wir warten auf eine WiFi-Verbindung. Wenn diese nicht vorhanden ist, wählen Sie ein Netzwerk aus und geben Sie das Passwort ein. <br>  2. Wir öffnen die TCP-Verbindung mit dem Server des Radiosenders.  Serveradressen, Ports und Streamnamen werden direkt im Flash-Speicher des Mikrocontrollers gespeichert, dazu später mehr. <br>  3. Senden Sie die obige GET-Anfrage. <br>  4. Wir erhalten als Antwort einen kontinuierlichen MP3-Stream. <br>  5. Wenn Sie die Station wechseln müssen, schließen Sie die TCP-Verbindung und wiederholen Sie den Vorgang ab Schritt 2. <br><br>  Ich erzähle Ihnen ein wenig darüber, wie Stationen in den Flash-Speicher des Mikrocontrollers gelangen.  In der Überprüfungsphase habe ich zunächst einfach Adressen, Portnummern und Streamnamen auf eine der Programmspeicherseiten geschrieben.  Aber im Laufe der Zeit, als sich die Geräte unter Verwandten und Freunden verteilten, musste ich die Möglichkeit hinzufügen, die Liste zentral zu aktualisieren.  Es wurde beschlossen, einen Server mit einer festen IP zu erstellen, auf dem eine Datei mit einer Liste von Stationen gespeichert wird.  Bei einer Verbindung über TCP wartet der Server auf ein Kennwort und gibt eine Datei aus, und der Mikrocontroller schreibt sie in seinen Flash-Speicher.  Als ich zum ersten Mal auf die Schaffung von „etwas im Internet“ stieß, war ich angenehm überrascht, dass sich herausstellt, dass die Miete einer virtuellen Maschine mit einer festen IP nur 100 Rubel pro Monat kostet.  Wunder :) <br><br>  <b>Schaltung</b> <br><br>  Nachdem ich genug mit STM32F4Discovery gespielt hatte, entschied ich mich, meine eigene Karte zu erstellen, auf der sich alle Elemente des Empfängers befinden, und ich muss weder die Drähte zum Display noch zu den Anschlüssen ziehen.  Dies verbessert die Zuverlässigkeit und Herstellbarkeit erheblich <s>und jeder träumt davon</s> . <br><br>  Das Schema kann hier heruntergeladen werden.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">[DIAGRAMM]</a> .  Ich habe sie nicht speziell für die Veröffentlichung dekoriert oder gekämmt.  Dies ist eine funktionierende Option, und dies sollte für diejenigen ausreichen, die wirklich interessiert sind. <br><br>  Das Schema besteht aus den Hauptteilen: <br><br>  1. MK STM32F415 mit einem Kabelbaum - zwei Quarze und eine Batterie für eine Echtzeituhr. <br>  2. ESP8266 <br>  3. VS1053 mit strikter Umreifung auf dem Datenblatt.  Begonnen auf MK durch SPI. <br>  4. Leistung - zwei Linearregler LM1117 bei 3,3 und 1,8 Volt. <br>  5. Display, Anschlüsse, Tasten, Potentiometer.  All dies wird auf dem GPIO-Mikrocontroller eingerichtet. <br><br>  Außerdem wird der Klasse-D-Verstärker <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PAM8403</a> nicht im Diagramm angezeigt, da er ein separat erworbenes Modul kostet. <br><br>  <b>Gebühr</b> <br><br>  Bevor Sie die Platine herstellen, müssen Sie die Position der Elemente bestimmen, die aus dem Gehäuse herausragen - Tasten, Anschlüsse, Anzeige.  Also habe ich es getan, aber über den Fall später. <br><br>  Das Board ist so geworden.  Vorsicht Geek Erdbeere! <br><br><img src="https://habrastorage.org/files/2b5/487/9d8/2b54879d8f6d4bf98a54004cccaf298b.JPG" alt="Bild"><br><br><img src="https://habrastorage.org/files/c9b/e26/4f7/c9be264f79f147428eed3b0bab40d95b.JPG" alt="Bild"><br><br><img src="https://habrastorage.org/files/819/d14/f09/819d14f09d91481785ce9787f32160a2.JPG" alt="Bild"><br><br>  Die Platte ist zweischichtig und hat eine Dicke von 1,5 mm.  Alle smd-Komponenten befinden sich auf einer Seite, was die automatische Installation erleichtert.  Es ist ihm jedoch noch nicht gekommen. <br><br>  Ich wurde bereits von mehreren Experten wegen kleiner Fehler in der Verkabelung auf Pikabu gescholten.  Das Board funktioniert jedoch und es funktioniert so, wie es sollte.  Ich sehe den Wert nicht in den Tafelzeichnungen, daher poste ich ihn nicht.  Wenn es Anfragen gibt, werde ich es posten.  Wie auch immer, ich werde es wiederholen.  Und begründete Kritik ist natürlich sehr willkommen! <br><br>  <b>Gehäuse</b> <br><br>  Der Fall ist ein Schmerz aller Amateur-Elektronikingenieure.  Und selbst wenn Sie kein Amateur sind und sich für Ihr Geld einsetzen, werden Sie daraus. <br><br>  In kleinen Chargen ist das Fräsen oder Laserschneiden die günstigste Option.  Mit Metalloptionen kann es immer noch Blech biegen, aber das ist nicht mein Fall.  Deshalb habe ich mich für das Fräsen von Holzteilen + das Laserschneiden von Paneelen entschieden.  In Bezug auf den Klang ist eine Holzkiste auch ein großes Plus. <br><br>  Das Ergebnis war dieser Teilesatz: <br><br><img src="https://habrastorage.org/files/0a9/510/970/0a9510970e2d4339982a28f32bdf729a.JPG" alt="Bild"><br><br>  Besondere Aufmerksamkeit verdient die Inschrift.  Nach langem Überlegen, wie man sie anwendet, wurde beschlossen, sie durch Verfugen auszuführen.  Das heißt, zuerst wird mit einer dünnen Mühle die Inschrift auf der Tafel ausgewählt und dann wird dort Farbe gegossen.  Nachdem die Farbe getrocknet ist, wird ihr Überschuss entfernt.  Eine sehr teure Operation, aber ich hörte nicht mehr auf.  Darüber hinaus eine der langlebigsten Möglichkeiten.  Wenn jemand Erfahrung mit anderen Methoden zum Anbringen von Etiketten hat, teilen Sie diese bitte mit. <br><br>  So sehen die resultierenden Inschriften aus. <br><br><img src="https://habrastorage.org/files/05b/6e7/48c/05b6e748cb9e43aa9df7d02b72686eb8.JPG" alt="Bild"><br><br>  Und hier ist das zusammengebaute Radio von innen: <br><br><img src="https://habrastorage.org/files/02e/abe/567/02eabe56732143659518590266241998.JPG" alt="Bild"><br><br>  Und noch ein Foto draußen: <br><br><img src="https://habrastorage.org/files/e3c/f6b/ab8/e3cf6bab85ca4789ae85310c6257eee8.JPG" alt="Bild"><br><br>  Fazit  In diesem Artikel wurden die Details der Entwicklung des Geräts mit breiten Strichen beschrieben.  Es ist ziemlich schwierig, über die Details zu schreiben, einerseits durch die Tatsache, dass ihr Meer andererseits alle einzeln offensichtlich erscheinen.  Ich könnte auf einem separaten Artikel über Schaltkreise, eine Leiterplatte, Firmware, die mit esp8266 und vs1053b arbeitet, schreiben, wenn ich genug Interesse bekomme, werde ich definitiv schreiben.  Denn ich möchte wirklich, dass Internetradio populär wird. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de403239/">https://habr.com/ru/post/de403239/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de403229/index.html">Computerkartenspiele: Streamer zum Anschauen</a></li>
<li><a href="../de403231/index.html">Backspace Invaders oder wie man ein 64x64 LED-Display an Arduino anschließt</a></li>
<li><a href="../de403233/index.html">NASA: Enceladus hat alle Voraussetzungen für die Entstehung und Erhaltung des Lebens</a></li>
<li><a href="../de403235/index.html">Warum ist die zweite interessanter als die erste: ein Hinweis auf die neuen Xiaomi-Skalen</a></li>
<li><a href="../de403237/index.html">Hinzufügen eines SDM-220-Zählers zu OpenHab</a></li>
<li><a href="../de403241/index.html">Fragen Sie Ethan: Wie interagiert dunkle Materie mit Schwarzen Löchern?</a></li>
<li><a href="../de403245/index.html">Wie Anfänger einen Quadrocopter ZMR250 / QAV250 mit Aliexpress zusammenbauen (1 Teil)</a></li>
<li><a href="../de403247/index.html">Microsoft hat Zero-Day-Schwachstellen in seiner Software behoben, lange bevor sie von Shadow Brokers aufgedeckt wurden</a></li>
<li><a href="../de403249/index.html">Die Pläne der NASA ändern sich: Die schweren Raketenstarts der NASA werden wahrscheinlich darunter leiden</a></li>
<li><a href="../de403253/index.html">Ist die Sache vernünftig: Warum spiegelt sich das Hauptproblem der Neurobiologie in der Physik wider?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>