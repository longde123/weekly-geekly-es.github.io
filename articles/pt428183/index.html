<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßÄ ‚úäüèΩ üõ¨ Implementa√ß√£o do algoritmo Levenberg-Marquardt para otimizar redes neurais no TensorFlow üë©üèº ü§∞üèΩ üëπ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Este √© um tutorial da biblioteca TensorFlow. Considere um pouco mais profundo do que nos artigos sobre reconhecimento de n√∫meros manuscritos. Este √© u...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Implementa√ß√£o do algoritmo Levenberg-Marquardt para otimizar redes neurais no TensorFlow</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428183/"><p>  Este √© um tutorial da biblioteca TensorFlow.  Considere um pouco mais profundo do que nos artigos sobre reconhecimento de n√∫meros manuscritos.  Este √© um tutorial sobre m√©todos de otimiza√ß√£o.  Aqui voc√™ n√£o pode prescindir da matem√°tica.  Tudo bem se voc√™ esqueceu completamente.  Lembre-se.  N√£o haver√° evid√™ncia formal e conclus√µes complexas, apenas o m√≠nimo necess√°rio para a compreens√£o intuitiva.  Para come√ßar, um pequeno hist√≥rico de como esse algoritmo pode ser √∫til para otimizar uma rede neural. </p><br><img src="https://habrastorage.org/webt/ka/vv/kh/kavvkhi2wic8-bj1_-6i4zjvkpe.jpeg"><br><br><p>  Seis meses atr√°s, um amigo me pediu para mostrar como criar uma rede neural em Python.  Sua empresa produz instrumentos para medi√ß√µes geof√≠sicas.  V√°rias sondas diferentes durante a perfura√ß√£o medem um conjunto de sinais associados aos par√¢metros do ambiente ao redor do po√ßo.  Em alguns casos complexos, calcule com precis√£o os par√¢metros ambientais dos sinais por um longo tempo, mesmo em um computador potente, e √© necess√°rio interpretar os resultados das medi√ß√µes em campo.  Havia uma id√©ia de contar centenas de milhares de casos em um cluster e treinar uma rede neural neles.  Como a rede neural √© muito r√°pida, ela pode ser usada para determinar par√¢metros consistentes com os sinais medidos, exatamente no processo de perfura√ß√£o.  Os detalhes est√£o no artigo: </p><br><p>  Kushnir, D., Velker, N., Bondarenko, A., Dyatlov, G., &amp; Dashevsky, Y. (2018, 29 de outubro).  Simula√ß√£o em tempo real da ferramenta de resistividade azimutal profunda no modelo de falhas 2D usando redes neurais (russo).  Sociedade de Engenheiros de Petr√≥leo.  doi: 10.2118 / 192573-RU </p><br><p>  Uma noite, mostrei como as keras poderiam implementar uma rede neural simples, e um amigo no trabalho come√ßou a treinar nos dados contados.  Depois de alguns dias, discutimos o resultado.  Do meu ponto de vista, ele parecia promissor, mas um amigo disse que precisava de c√°lculos com a precis√£o do dispositivo.  E se o <em>erro quadr√°tico m√©dio</em> fosse em torno de 1, seria necess√°rio 1e-3.  3 pedidos menos.  Mil vezes. </p><a name="habracut"></a><br><p>  Experimentos com arquitetura de rede neural, normaliza√ß√£o de dados e abordagens de otimiza√ß√£o renderam quase nada.  Depois de algumas semanas, um amigo ligou e disse que instalou o MatLab e resolveu o problema pelo m√©todo <em>Levenberg-Marquardt</em> (a seguir, chamaremos <em>LM</em> ).  Foi otimizado por um longo tempo (v√°rios dias), n√£o funcionou na GPU, mas o resultado foi o correto.  Pareceu um desafio. </p><br><p>  A pesquisa r√°pida de um otimizador LM pronto para keras ou TensorFlow falhou.  Encontrei apenas a biblioteca pyrenn, mas sua funcionalidade me pareceu fraca.  Eu decidi implement√°-lo eu mesmo.  √Ä primeira vista, tudo parecia simples, e duas noites deveriam ter sido suficientes.  Demorou mais tempo.  Havia dois problemas: </p><br><ol><li>  TensorFlow.  Um monte de artigos, mas quase todos os n√≠veis ", mas vamos escrever um <s>ol√° mundo</s> reconhecimento de d√≠gitos manuscritos". </li><li>  Matem√°tica  Eu esqueci muito, e os autores de artigos matem√°ticos n√£o se importam com pessoas como eu: f√≥rmulas s√≥lidas sem explica√ß√£o, ‚Äúobviamente!‚Äù  e assim por diante. </li></ol><br><p>  Como resultado, ele escreveu um artigo para aqueles que esqueceram a matem√°tica e querem entender o TensorFlow um pouco mais fundo, mas sem hardcore.  O artigo tem muito texto e pouco c√≥digo.  A op√ß√£o oposta, quando h√° pouco texto e muito c√≥digo, √© aqui o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Jupyter Notebook Levenberg-Marquardt</a> . </p><br><h4>  Conhe√ßa o recurso Rosenbrock </h4><br><p>  <em>Geraremos</em> dados de treinamento <em>pela fun√ß√£o Rosenbrock</em> , que geralmente √© usada como refer√™ncia para algoritmos de otimiza√ß√£o: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></span><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-5" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><span class="MJXp-mo" id="MJXp-Span-7" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-8" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mo" id="MJXp-Span-9" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mo" id="MJXp-Span-11" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-13"><span class="MJXp-mo" id="MJXp-Span-14" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-15" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-16" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mo" id="MJXp-Span-18" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><span class="MJXp-mo" id="MJXp-Span-20" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-21"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-23" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-24"><span class="MJXp-mo" id="MJXp-Span-25" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-26" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span><script type="math/tex;mode=display" id="MathJax-Element-1"> f (x, y) = (a-x) ^ 2 + b (y-x ^ 2) ^ 2 </script></p><br><img src="https://habrastorage.org/webt/cr/by/_v/crby_vv7ldxutqj5dxfaehtfnlk.jpeg"><br><br><p>  Por que ela √© boa? </p><br><ul><li>  Hor√°rio bonito.  √â chamado Vale de Rosenbrock e a <i>fun√ß√£o banana</i> intraduz√≠vel de <i>Rosenbrock</i> . </li><li>  O m√≠nimo global est√° dentro de um vale longo, estreito e parab√≥lico.  Encontrar um vale √© trivial e um m√≠nimo global √© dif√≠cil. </li><li>  Existe uma op√ß√£o multidimensional.  N√£o √© t√£o f√°cil criar uma boa fun√ß√£o para muitas vari√°veis. </li></ul><br><p>  Come√ßaremos a escrever o c√≥digo dele, conectando as bibliotecas necess√°rias para mais trabalhos: </p><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> math <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rosenbrock</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, y, a, b)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (a - x)**<span class="hljs-number"><span class="hljs-number">2</span></span> + b*(y - x**<span class="hljs-number"><span class="hljs-number">2</span></span>)**<span class="hljs-number"><span class="hljs-number">2</span></span></code> </pre> <br><h4>  Afirmamos o problema </h4><br><p>  Como est√°vamos falando de um dispositivo de medi√ß√£o, vamos continuar usando a analogia.  Nosso dispositivo em um mundo fict√≠cio pode medir coordenadas <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-27"><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-30" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><span class="MJXp-mo" id="MJXp-Span-32" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><script type="math/tex" id="MathJax-Element-2"> (x, y) </script>  e altura <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-33"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z</font></font></span></span></span><script type="math/tex" id="MathJax-Element-3"> z </script>  .  Os f√≠sicos estudaram o mundo e disseram: " <em>Sim, √© Rosenbrock! Conhecendo as coordenadas, voc√™ pode calcular com precis√£o a altura, n√£o √© necess√°rio medi-la</em> ".  Em outras palavras, os cientistas nos deram um modelo <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-35"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z </font></font></span><span class="MJXp-mo" id="MJXp-Span-37" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k </font></font></span><span class="MJXp-mo" id="MJXp-Span-48" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-50" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mo" id="MJXp-Span-54" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mo" id="MJXp-Span-56" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><script type="math/tex" id="MathJax-Element-4"> z = rosenbrock (x, y, a, b) </script>  que depende dos par√¢metros <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-57"><span class="MJXp-mo" id="MJXp-Span-58" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mo" id="MJXp-Span-60" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mo" id="MJXp-Span-62" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><script type="math/tex" id="MathJax-Element-5"> (a, b) </script>  .  Esses par√¢metros, embora constantes em um mundo fict√≠cio, s√£o desconhecidos.  Eles precisam ser encontrados. </p><br><p>  Realizamos uma s√©rie de experimentos que deram <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-63"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span></span></span><script type="math/tex" id="MathJax-Element-6"> m </script>  pontos <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-65"><span class="MJXp-mo" id="MJXp-Span-66" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-67"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-69" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-70" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-71"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-73" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-74" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-75"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-76" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-77" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-78" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-79" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-80" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-81"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-83" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-84" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-85"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-87" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-88" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-89"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-91" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-92" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-93" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-94" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-95" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-96" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-97" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-98" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-99"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-101" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-102" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-105" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-106" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-109" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-110" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-7"> (x_1, y_1, z_1), (x_2, y_2, z_2), ..., (x_m, y_m, z_m) </script>  : </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># (2.5, 2.5) -   ,  ,     data_points = np.array([[x, y, rosenbrock(x, y, 2.5, 2.5)] for x in np.arange(-2, 2.1, 2) for y in np.arange(-2, 2.1, 2)]) m = data_points.shape[0]</span></span></code> </pre> <br><p>  A primeira maneira de otimizar √© tentar adivinhar os par√¢metros.  Usamos a biblioteca Numpy: </p><br><pre> <code class="python hljs">x, y = data_points[:, <span class="hljs-number"><span class="hljs-number">0</span></span>], data_points[:, <span class="hljs-number"><span class="hljs-number">1</span></span>] z = data_points[:, <span class="hljs-number"><span class="hljs-number">2</span></span>] <span class="hljs-comment"><span class="hljs-comment">#   =5  b=5? a_guess, b_guess = 5., 5. #  -hat   ,   , #   ,   ,   .   #     ^   - # .    hat. z_hat = rosenbrock(x, y, a_guess, b_guess)</span></span></code> </pre> <br><p>  Como entender como estamos errados?  Contagem de <em>res√≠duos</em> - tamanhos de erro. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">m</span></span></span><script type="math/tex" id="MathJax-Element-8"> m </script>  pontos d√£o <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-113"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">m</span></span></span><script type="math/tex" id="MathJax-Element-9"> m </script>  res√≠duos - voc√™ precisa de um indicador integral.  N√≥s quadrado cada res√≠duo em um quadrado e calculamos a m√©dia: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-115"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">E</span><span class="MJXp-mo" id="MJXp-Span-119" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120">a</span><span class="MJXp-mo" id="MJXp-Span-121" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122">b</span><span class="MJXp-mo" id="MJXp-Span-123" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-124" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-125">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">c</span><span class="MJXp-mrow" id="MJXp-Span-130"><span class="MJXp-mn" id="MJXp-Span-131">1</span></span><span class="MJXp-mrow" id="MJXp-Span-132"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">m</span></span><span class="MJXp-mtext" id="MJXp-Span-134">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136">u</span><span class="MJXp-msubsup" id="MJXp-Span-137"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-143"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">m</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-139"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">i</span><span class="MJXp-mo" id="MJXp-Span-141">=</span><span class="MJXp-mn" id="MJXp-Span-142">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-145" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-146"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147" style="margin-right: 0.05em;">z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-148" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-150" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-151">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158">t</span><span class="MJXp-mrow" id="MJXp-Span-159"><span class="MJXp-msubsup" id="MJXp-Span-160"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161" style="margin-right: 0.05em;">z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-162" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163">i</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-164"><span class="MJXp-mo" id="MJXp-Span-165" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-166" style="vertical-align: 0.5em;">2</span></span></span></span><script type="math/tex;mode=display" id="MathJax-Element-10"> MSE (a, b) = \ frac {1} {m} \ sum_ {i = 1} ^ {m} (z_ {i} - \ widehat {z_ {i}}) ^ 2 </script></p><br><p>  Essa medida de proximidade √© chamada de <em>erro m√©dio quadr√°tico</em> (a seguir denominado <em>mse</em> ): </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># r - residuals () r = z - z_hat # mse loss = np.mean(r**2) print(loss)</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: 3868.2291666666665</code> </pre> <br><p>  Ao minimizar o <em>mse</em> , resolvemos o <em>problema dos m√≠nimos quadrados</em> ( <em>minimiza√ß√£o de quadrados n√£o lineares</em> ): </p><br><img src="https://habrastorage.org/webt/lt/qk/su/ltqksu80eo7y4h91xedhj8w0djy.png"><br><p>  Pode-se ver que os par√¢metros n√£o foram adivinhados. </p><br><h4>  Formulamos o problema no TensorFlow </h4><br><p>  O modelo tem a forma <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-167"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">z</span><span class="MJXp-mo" id="MJXp-Span-169" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">k</span><span class="MJXp-mo" id="MJXp-Span-180" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181">x</span><span class="MJXp-mo" id="MJXp-Span-182" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">y</span><span class="MJXp-mo" id="MJXp-Span-184" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">a</span><span class="MJXp-mo" id="MJXp-Span-186" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">b</span><span class="MJXp-mo" id="MJXp-Span-188" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-11"> z = rosenbrock (x, y, a, b) </script>  .  Trazemos para o formul√°rio <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-189"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-190">y</span><span class="MJXp-mo" id="MJXp-Span-191" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">f</span><span class="MJXp-mo" id="MJXp-Span-193" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-194">x</span><span class="MJXp-mo" id="MJXp-Span-195" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196">p</span><span class="MJXp-mo" id="MJXp-Span-197" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-12"> y = f (x, p) </script>  (geralmente matem√°tica escreve <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-198"><span class="MJXp-mtext" id="MJXp-Span-199">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203">a</span></span></span><script type="math/tex" id="MathJax-Element-13"> \ beta </script>  em vez de <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-204"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205">p</span></span></span><script type="math/tex" id="MathJax-Element-14"> p </script>  mas os programadores n√£o usam beta).  Agora o modelo tem a forma <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-206"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">y</span><span class="MJXp-mo" id="MJXp-Span-208" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-211">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-213">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218">k</span><span class="MJXp-mo" id="MJXp-Span-219" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">x</span><span class="MJXp-mo" id="MJXp-Span-221" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">p</span><span class="MJXp-mo" id="MJXp-Span-223" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-15"> y = rosenbrock (x, p) </script>  onde <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">y</span></span></span><script type="math/tex" id="MathJax-Element-16"> y </script>  - altura <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-226"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">x</span></span></span><script type="math/tex" id="MathJax-Element-17"> x </script>  √â <em>o vetor</em> de coordenadas de dois elementos (componente) e <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-228"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">p</span></span></span><script type="math/tex" id="MathJax-Element-18"> p </script>  - <em>vetor de</em> par√¢metros. </p><br><p>  Os programadores costumam pensar em vetores como matrizes unidimensionais.  Isso n√£o est√° totalmente correto.  Uma matriz de n√∫meros √© um meio de <em>representar um</em> vetor.  Voc√™ pode representar um vetor como uma matriz de dimens√£o <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-230"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231">N</span></span></span><script type="math/tex" id="MathJax-Element-19"> N </script>  matriz bidimensional <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-232"><span class="MJXp-mn" id="MJXp-Span-233">1</span><span class="MJXp-mtext" id="MJXp-Span-234">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237">z</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240">N</span></span></span><script type="math/tex" id="MathJax-Element-20"> 1 \ vezes N </script>  e at√© uma matriz <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-241"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">N</span><span class="MJXp-mtext" id="MJXp-Span-243">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">z</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248">s</span><span class="MJXp-mn" id="MJXp-Span-249">1</span></span></span><script type="math/tex" id="MathJax-Element-21"> N \ vezes 1 </script>  nos casos em que o fato de o vetor ser um <em>vetor de coluna</em> (por exemplo, multiplicar uma matriz por ele) √© importante: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-250"><span class="MJXp-mtext" id="MJXp-Span-251">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-254">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">n</span><span class="MJXp-mrow" id="MJXp-Span-257"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">x</span></span><span class="MJXp-msubsup" id="MJXp-Span-265"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-267" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mspace" id="MJXp-Span-268" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-269">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-272">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-274">s</span><span class="MJXp-mspace" id="MJXp-Span-275" style="width: 0em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-276"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-278" style="vertical-align: -0.4em;">N</span></span><span class="MJXp-mtext" id="MJXp-Span-279">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282">d</span><span class="MJXp-mrow" id="MJXp-Span-283"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">x</span></span></span></span><script type="math/tex;mode=display" id="MathJax-Element-22"> \ begin {bmatrix} x_1 \\\ vdots \\ x_N \ end {bmatrix} </script></p><br><p>  O TensorFlow usa o conceito de <em>tensor</em> .  <em>Um tensor</em> , como uma matriz, pode ser unidimensional (para representar um <em>vetor</em> ), bidimensional (para um <em>vetor de</em> <em>matriz</em> ou <em>coluna</em> ) e qualquer dimens√£o maior. </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    ('placeholder' ,    #      ) x = tf.placeholder(tf.float64, shape=[m, 2]) y = tf.placeholder(tf.float64, shape=[m]) #   ('variable' ,    ) #     (5, 5) p = tf.Variable([5., 5.], dtype=tf.float64) #  y_hat = rosenbrock(x[:, 0], x[:, 1], p[0], p[1]) #  r = y - y_hat # mse (mean squared error) loss = tf.reduce_mean(r**2)</span></span></code> </pre> <br><p>  O c√≥digo TensorFlow n√£o √© diferente no c√≥digo Numpy.  O conte√∫do √© enorme.  O c√≥digo numpy calcula <em>o valor</em> mse.  O c√≥digo TensorFlow n√£o realiza nenhum c√°lculo, forma <em>um</em> <em>gr√°fico de</em> <em>fluxo de dados</em> que mse <em>pode calcular</em> .  Um momento muito <em>tolerante ao</em> c√©rebro √© o trabalho da fun√ß√£o <em>rosenbrock</em> .  Usamos nos dois casos.  Mas quando passamos as matrizes Numpy, ele executa os c√°lculos pela f√≥rmula e retorna os n√∫meros.  E quando transferimos os tensores para o TensorFlow, ele forma um <em>subgr√°fico do fluxo de dados</em> e retorna sua <em>borda</em> na forma de um tensor.  Milagres de polimorfismo, mas n√£o os abuse: </p><br><img src="https://habrastorage.org/webt/cw/6u/nz/cw6unzjtqsl_uvl3auasc-x46zq.jpeg"><br><p>  Gra√ßas √† presen√ßa de um gr√°fico de fluxo de dados, o TensorFlow, em particular, pode calcular <em>derivadas</em> automaticamente (usando <em>a</em> t√©cnica de <em>diferencia√ß√£o autom√°tica no modo reverso</em> ). </p><br><p>  Um momento de matem√°tica.  Blocos "para quem esqueceu" ser√£o escondidos em um spoiler. </p><br><div class="spoiler">  <b class="spoiler_title">Derivada (n√∫mero digitado - n√∫mero restante)</b> <div class="spoiler_text"><p>  Muito provavelmente voc√™ se lembra da defini√ß√£o da derivada de uma fun√ß√£o escalar (retornando um n√∫mero) de uma vari√°vel: para <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-291"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">f</span><span class="MJXp-mo" id="MJXp-Span-293" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mtext" id="MJXp-Span-294">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">b</span><span class="MJXp-mrow" id="MJXp-Span-301"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">R</span></span><span class="MJXp-mtext" id="MJXp-Span-303">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">w</span><span class="MJXp-mtext" id="MJXp-Span-314">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320">b</span><span class="MJXp-mrow" id="MJXp-Span-321"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322">R</span></span></span></span><script type="math/tex" id="MathJax-Element-23"> f: \ mathbb {R} \ rightarrow \ mathbb {R} </script>  derivado <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324">f</span></span></span><script type="math/tex" id="MathJax-Element-24"> f </script>  no ponto <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-325"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">x</span><span class="MJXp-mtext" id="MJXp-Span-327">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">n</span><span class="MJXp-mtext" id="MJXp-Span-330">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">b</span><span class="MJXp-mrow" id="MJXp-Span-337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338">R</span></span></span></span><script type="math/tex" id="MathJax-Element-25"> x \ in \ mathbb {R} </script>  definido como: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-339"><span class="MJXp-msup" id="MJXp-Span-340"><span class="MJXp-mrow" id="MJXp-Span-341" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342">f</span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-343" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-344" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345">x</span><span class="MJXp-mo" id="MJXp-Span-346" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-347" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-348">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">i</span><span class="MJXp-msubsup" id="MJXp-Span-351"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-353" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354">h</span><span class="MJXp-mtext" id="MJXp-Span-355">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357">o</span><span class="MJXp-mn" id="MJXp-Span-358">0</span></span></span><span class="MJXp-mtext" id="MJXp-Span-359">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-361">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363">c</span><span class="MJXp-mrow" id="MJXp-Span-364"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">f</span><span class="MJXp-mo" id="MJXp-Span-366" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367">x</span><span class="MJXp-mo" id="MJXp-Span-368" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369">h</span><span class="MJXp-mo" id="MJXp-Span-370" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-371" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372">f</span><span class="MJXp-mo" id="MJXp-Span-373" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-374">x</span><span class="MJXp-mo" id="MJXp-Span-375" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-376"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-377">h</span></span><span class="MJXp-mrow" id="MJXp-Span-378"><span class="MJXp-mo" id="MJXp-Span-379" style="margin-left: 0em; margin-right: 0em;">$</span></span></span></span><script type="math/tex;mode=display" id="MathJax-Element-26"> {f} '(x) = \ lim_ {h \ to 0} \ frac {f (x + h) -f (x)} {h} $ </script></p><br><p>  Derivados s√£o uma maneira de medir <i>mudan√ßas</i> .  No caso escalar, a derivada mostra quanto a fun√ß√£o mudar√° <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-380"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381">f</span></span></span><script type="math/tex" id="MathJax-Element-27"> f </script>  se <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-382"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">x</span></span></span><script type="math/tex" id="MathJax-Element-28"> x </script>  mude para um valor pequeno <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-384"><span class="MJXp-mtext" id="MJXp-Span-385">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-391">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">n</span></span></span><script type="math/tex" id="MathJax-Element-29"> \ varepsilon </script>  : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-396"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">f</span><span class="MJXp-mo" id="MJXp-Span-398" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399">x</span><span class="MJXp-mo" id="MJXp-Span-400" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-401">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-408">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-410">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-411">n</span><span class="MJXp-mo" id="MJXp-Span-412" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-413">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-414">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-417">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419">f</span><span class="MJXp-mo" id="MJXp-Span-420" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421">x</span><span class="MJXp-mo" id="MJXp-Span-422" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-423" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-424">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-427">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-428">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-430">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-434">n</span><span class="MJXp-msup" id="MJXp-Span-435"><span class="MJXp-mrow" id="MJXp-Span-436" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-437">f</span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-438" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-439" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440">x</span><span class="MJXp-mo" id="MJXp-Span-441" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-30"> f (x + \ varepsilon) \ aprox f (x) + \ varepsilon {f} '(x) </script></p><br><p>  Por conveni√™ncia, denotamos <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-442"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443">y</span><span class="MJXp-mo" id="MJXp-Span-444" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-445">f</span><span class="MJXp-mo" id="MJXp-Span-446" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447">x</span><span class="MJXp-mo" id="MJXp-Span-448" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-31"> y = f (x) </script>  e o derivado <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-449"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-450">y</span></span></span><script type="math/tex" id="MathJax-Element-32"> y </script>  por <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-451"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">x</span></span></span><script type="math/tex" id="MathJax-Element-33"> x </script>  vamos escrever como <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-453"><span class="MJXp-mtext" id="MJXp-Span-454">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-456">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458">c</span><span class="MJXp-mrow" id="MJXp-Span-459"><span class="MJXp-mtext" id="MJXp-Span-460">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-461">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-462">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-465">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-468">y</span></span><span class="MJXp-mrow" id="MJXp-Span-469"><span class="MJXp-mtext" id="MJXp-Span-470">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-471">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-472">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-473">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-474">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-477">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-478">x</span></span></span></span><script type="math/tex" id="MathJax-Element-34"> \ frac {\ parcial y} {\ parcial x} </script>  .  Esse registro enfatiza que <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-479"><span class="MJXp-mtext" id="MJXp-Span-480">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-481">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-482">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484">c</span><span class="MJXp-mrow" id="MJXp-Span-485"><span class="MJXp-mtext" id="MJXp-Span-486">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-492">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-493">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494">y</span></span><span class="MJXp-mrow" id="MJXp-Span-495"><span class="MJXp-mtext" id="MJXp-Span-496">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-497">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-500">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-501">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-504">x</span></span></span></span><script type="math/tex" id="MathJax-Element-35"> \ frac {\ parcial y} {\ parcial x} </script>  - <i>taxa de varia√ß√£o</i> entre vari√°veis <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-505"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506">x</span></span></span><script type="math/tex" id="MathJax-Element-36"> x </script>  e <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-507"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-508">y</span></span></span><script type="math/tex" id="MathJax-Element-37"> y </script>  .  Mais especificamente, se <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510">x</span></span></span><script type="math/tex" id="MathJax-Element-38"> x </script>  mude para <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-511"><span class="MJXp-mtext" id="MJXp-Span-512">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-518">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-519">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-520">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-521">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-522">n</span></span></span><script type="math/tex" id="MathJax-Element-39"> \ varepsilon </script>  ent√£o <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-523"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-524">y</span></span></span><script type="math/tex" id="MathJax-Element-40"> y </script>  mude para aproximadamente <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-525"><span class="MJXp-mtext" id="MJXp-Span-526">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-527">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-528">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-530">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-532">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-534">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-536">n</span><span class="MJXp-mtext" id="MJXp-Span-537">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-539">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-540">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541">c</span><span class="MJXp-mrow" id="MJXp-Span-542"><span class="MJXp-mtext" id="MJXp-Span-543">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-546">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-547">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-548">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-549">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-550">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-551">y</span></span><span class="MJXp-mrow" id="MJXp-Span-552"><span class="MJXp-mtext" id="MJXp-Span-553">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-555">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-556">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-557">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-558">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-560">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-561">x</span></span></span></span><script type="math/tex" id="MathJax-Element-41"> \ varepsilon \ frac {\ parcial y} {\ parcial x} </script>  .  Voc√™ tamb√©m pode escrever assim: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-562"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-563">x</span><span class="MJXp-mtext" id="MJXp-Span-564">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-567">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-568">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-570">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-571">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-572">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-573">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-574">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-575">x</span><span class="MJXp-mo" id="MJXp-Span-576" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-577">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-578">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-579">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-580">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-582">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-583">x</span><span class="MJXp-mtext" id="MJXp-Span-584">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-585">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-587">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-588">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-589">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-590">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-591">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-592">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-594">w</span><span class="MJXp-mtext" id="MJXp-Span-595">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-596">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-597">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-598">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-600">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-601">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-602">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-603">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-604">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-605">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-606">w</span><span class="MJXp-mtext" id="MJXp-Span-607">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-608">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-610">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-611">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-612">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-613">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-614">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-615">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-616">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-617">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-619">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-620">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-621">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623">y</span><span class="MJXp-mo" id="MJXp-Span-624" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-625">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-626">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-627">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-628">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-629">c</span><span class="MJXp-mrow" id="MJXp-Span-630"><span class="MJXp-mtext" id="MJXp-Span-631">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-634">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-635">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-636">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-638">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-639">y</span></span><span class="MJXp-mrow" id="MJXp-Span-640"><span class="MJXp-mtext" id="MJXp-Span-641">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-642">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-643">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-645">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-646">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-647">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-649">x</span></span><span class="MJXp-mtext" id="MJXp-Span-650">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-652">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-654">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-655">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-656">x</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-42"> x \ rightarrow x + \ Delta x \ rightarrow \ \ rightarrow \ aproximadamente y + \ frac {\ parcial y} {\ parcial x} \ Delta x </script></p><br><p>  L√™ como: "mudando <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-657"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-658">x</span></span></span><script type="math/tex" id="MathJax-Element-43"> x </script>  em <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-659"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660">x</span><span class="MJXp-mo" id="MJXp-Span-661" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-662">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-663">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-664">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-665">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-666">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-668">x</span></span></span><script type="math/tex" id="MathJax-Element-44"> x + \ Delta x </script>  mudar <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-669"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-670">y</span></span></span><script type="math/tex" id="MathJax-Element-45"> y </script>  aproximadamente <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-671"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672">y</span><span class="MJXp-mo" id="MJXp-Span-673" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-674">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-676">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-677">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-678">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-679">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-680">x</span><span class="MJXp-mtext" id="MJXp-Span-681">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-682">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-684">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-685">c</span><span class="MJXp-mrow" id="MJXp-Span-686"><span class="MJXp-mtext" id="MJXp-Span-687">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-688">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-689">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-690">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-691">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-693">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-694">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-695">y</span></span><span class="MJXp-mrow" id="MJXp-Span-696"><span class="MJXp-mtext" id="MJXp-Span-697">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-698">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-699">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-700">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-701">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-702">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-704">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-705">x</span></span></span></span><script type="math/tex" id="MathJax-Element-46"> y + \ Delta x \ frac {\ parcial y} {\ parcial x} </script>  ". Esse registro destaca claramente o v√≠nculo entre a mudan√ßa <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-706"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-707">x</span></span></span><script type="math/tex" id="MathJax-Element-47"> x </script>  e mudar <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-708"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709">y</span></span></span><script type="math/tex" id="MathJax-Element-48"> y </script>  . </p></div></div><br><p>  Constru√≠mos um gr√°fico de fluxo de dados, vamos executar o c√°lculo do mse: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#        #      placeholder (  ) feed_dict = {x: data_points[:,0:2], y: data_points[:,2]} #       TensorFlow session = tf.Session() #     session.run(tf.global_variables_initializer()) #   ()  loss (mse) current_loss = session.run(loss, feed_dict) print(current_loss)</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: 3868.2291666666665</code> </pre> <br><p>  O resultado √© o mesmo que com o Numpy.  Ent√£o eles n√£o estavam enganados. </p><br><h4 id="nachnyom-optimizirovat">  Comece a otimizar </h4><br><p>  Infelizmente, n√£o foi poss√≠vel adivinhar os par√¢metros.  Mas ent√£o n√≥s: </p><br><ol><li>  Definimos o crit√©rio de otimiza√ß√£o - o valor m√≠nimo de mse. </li><li>  Os par√¢metros vari√°veis ‚Äã‚Äãforam determinados: vetor <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-710"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-711">p</span></span></span><script type="math/tex" id="MathJax-Element-49"> p </script>  com componentes <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-712"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-713">a</span></span></span><script type="math/tex" id="MathJax-Element-50"> a </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-714"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715">b</span></span></span><script type="math/tex" id="MathJax-Element-51"> b </script>  Fun√ß√µes Rosenbrock. </li><li>  Ainda n√£o pensamos em limita√ß√µes, mas elas n√£o est√£o l√°. </li></ol><br><p>  Na √∫ltima etapa, constru√≠mos um gr√°fico de fluxo de dados com um tensor de <em>perda</em> finita ( <em>fun√ß√£o de</em> <em>perda</em> ).  O objetivo da otimiza√ß√£o √© encontrar o valor do vetor de par√¢metros <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-716"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-717">p</span></span></span><script type="math/tex" id="MathJax-Element-52"> p </script>  em que o valor da fun√ß√£o de perda √© m√≠nimo.  Tivemos sorte, o gr√°fico desta fun√ß√£o √© muito simples (c√¥ncavo e sem m√≠nimos locais): </p><br><img src="https://habrastorage.org/webt/vf/do/hr/vfdohrpseaocd_vpe6e7sp_6f0u.png"><br><p>  Introdu√ß√£o √† otimiza√ß√£o.  Para come√ßar, escrevemos um ciclo generalizado: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># :   mse,   ,  #   mse,        placeholder def train(target_loss, max_steps, loss_tensor, train_step_op, inputs): step = 0 current_loss = session.run(loss_tensor, inputs) #           while current_loss &gt; target_loss and step &lt; max_steps: step += 1 #    1, 2, 4, 8, 16...  if math.log(step, 2).is_integer(): print(f'step: {step}, current loss: {current_loss}') #    session.run(train_step_op, inputs) current_loss = session.run(loss_tensor, inputs) print(f'ENDED ON STEP: {step}, FINAL LOSS: {current_loss}')</span></span></code> </pre> <br><h4 id="optimiziruem-metodom-naiskoreyshego-gradientnogo-spuska-sgd">  Otimizamos pelo m√©todo da descida de gradiente mais r√°pida (SGD) </h4><br><p>  As a√ß√µes desse m√©todo podem ser comparadas ao montar um esquiador ousado, que sempre desce a ladeira (na dire√ß√£o mais √≠ngreme).  Nesse caso, apenas a inclina√ß√£o no ponto de localiza√ß√£o √© levada em considera√ß√£o.  E se a inclina√ß√£o for forte, o esquiador voa uma longa dist√¢ncia antes da pr√≥xima mudan√ßa.  Com uma inclina√ß√£o fraca, ele se move em pequenos passos.  Talvez como voar para longe <del>  em uma √°rvore </del>  (o <em>algoritmo diverge</em> ) e fica preso em um po√ßo ( <em>m√≠nimo local</em> ). </p><br><img src="https://habrastorage.org/webt/oe/et/ij/oeetijkwervilr42jsjl9wsgsey.jpeg"><br><p>  Voc√™ pode escrever da seguinte forma (alterar <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-718"><span class="MJXp-mtext" id="MJXp-Span-719">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-720">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-721">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-722">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-723">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-724">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-725">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-726">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-728">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729">l</span><span class="MJXp-mrow" id="MJXp-Span-730"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-731">p</span></span></span></span><script type="math/tex" id="MathJax-Element-53"> \ boldsymbol {p} </script>  em <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-732"><span class="MJXp-mtext" id="MJXp-Span-733">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-734">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-735">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-736">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-737">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-739">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-740">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-741">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-742">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-743">l</span><span class="MJXp-mrow" id="MJXp-Span-744"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-745">p</span></span><span class="MJXp-mo" id="MJXp-Span-746" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mo" id="MJXp-Span-747" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-748" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-749" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><script type="math/tex" id="MathJax-Element-54"> \ boldsymbol {p} - ... </script>  ): </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-750"><span class="MJXp-mtext" id="MJXp-Span-751">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-753">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-754">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-755">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-758">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-759">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-761">l</span><span class="MJXp-mrow" id="MJXp-Span-762"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-763">p</span></span><span class="MJXp-mtext" id="MJXp-Span-764">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-765">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-766">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-767">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-768">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-769">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-770">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-771">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-772">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-773">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-774">w</span><span class="MJXp-mtext" id="MJXp-Span-775">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-776">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-777">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-778">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-780">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-781">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-782">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-783">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-784">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-785">l</span><span class="MJXp-mrow" id="MJXp-Span-786"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787">p</span></span><span class="MJXp-mo" id="MJXp-Span-788" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-789">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-790">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-791">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-793">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-794">a</span><span class="MJXp-mo" id="MJXp-Span-795" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-796">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-797">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-798">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-799">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-800">l</span><span class="MJXp-msubsup" id="MJXp-Span-801"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-802" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-803" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-804">p</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-805">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-806">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-807">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-808">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809">a</span><span class="MJXp-mo" id="MJXp-Span-810" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-811">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-813">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-814">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-815">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-818">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-819">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-820">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-821">l</span><span class="MJXp-mrow" id="MJXp-Span-822"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-823">p</span></span><span class="MJXp-mo" id="MJXp-Span-824" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-825" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-55"> \ boldsymbol {p} \ rightarrow \ boldsymbol {p} - \ alpha [\ nabla_ {p} perda (\ boldsymbol {p})] </script></p><br><p>  Gorduroso <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-826"><span class="MJXp-mtext" id="MJXp-Span-827">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-828">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-829">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-830">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-831">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-832">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-833">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-834">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-835">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-836">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-837">l</span><span class="MJXp-mrow" id="MJXp-Span-838"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839">p</span></span></span></span><script type="math/tex" id="MathJax-Element-56"> \ boldsymbol {p} </script>  enfatiza que este √© o ponto da localiza√ß√£o real - o valor do vetor de par√¢metro na etapa atual.  No primeiro passo, esse √© o nosso palpite (5, 5).  Existem dois pontos interessantes na f√≥rmula: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-840"><span class="MJXp-mtext" id="MJXp-Span-841">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-842">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-843">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-844">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-845">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-846">a</span></span></span><script type="math/tex" id="MathJax-Element-57"> \ alpha </script>  - <em>taxa de aprendizagem</em> ( <em>taxa de aprendizagem</em> ), <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-847"><span class="MJXp-mtext" id="MJXp-Span-848">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-849">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-850">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-851">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-852">l</span><span class="MJXp-msubsup" id="MJXp-Span-853"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-854" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-855" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-856">p</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-857">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-858">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-859">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-860">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-861">a</span></span></span><script type="math/tex" id="MathJax-Element-58"> \ nabla_ {p} perda </script>  - <em>gradiente</em> ( <em>gradiente</em> ) da fun√ß√£o de perda pelo vetor de par√¢metros. </p><br><img src="https://habrastorage.org/webt/qx/1h/em/qx1hem1cns_udmg0gucq1h9vs9k.jpeg"><br><div class="spoiler">  <b class="spoiler_title">Gradiente (vetor inserido - n√∫mero restante)</b> <div class="spoiler_text"><p>  Considere uma fun√ß√£o que recebe um vetor como entrada e produz um escalar: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-862"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-863">f</span><span class="MJXp-mo" id="MJXp-Span-864" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mtext" id="MJXp-Span-865">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-866">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-868">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-869">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-870">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871">b</span><span class="MJXp-msubsup" id="MJXp-Span-872"><span class="MJXp-mrow" id="MJXp-Span-873" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-875" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-876">N</span></span></span><span class="MJXp-mtext" id="MJXp-Span-877">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-878">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-879">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-880">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-881">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-883">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-885">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-886">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-887">w</span><span class="MJXp-mtext" id="MJXp-Span-888">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-889">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-891">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-892">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-893">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-894">b</span><span class="MJXp-mrow" id="MJXp-Span-895"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-896">R</span></span></span></span><script type="math/tex" id="MathJax-Element-59"> f: \ mathbb {R} ^ {N} \ rightarrow \ mathbb {R} </script>  .  Derivada <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-897"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898">f</span></span></span><script type="math/tex" id="MathJax-Element-60"> f </script>  no ponto <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-899"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-900">x</span><span class="MJXp-mtext" id="MJXp-Span-901">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-902">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903">n</span><span class="MJXp-mtext" id="MJXp-Span-904">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-905">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-906">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-907">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-908">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-909">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910">b</span><span class="MJXp-msubsup" id="MJXp-Span-911"><span class="MJXp-mrow" id="MJXp-Span-912" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-913">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-914" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915">N</span></span></span></span></span><script type="math/tex" id="MathJax-Element-61"> x \ in \ mathbb {R} ^ {N} </script>  agora chamado de <i>gradiente</i> e √© um vetor <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-916"><span class="MJXp-mo" id="MJXp-Span-917" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-918">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-919">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-920">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-921">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-922">l</span><span class="MJXp-msubsup" id="MJXp-Span-923"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-924" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-925" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-927">f</span><span class="MJXp-mo" id="MJXp-Span-928" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-929">x</span><span class="MJXp-mo" id="MJXp-Span-930" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-931" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mtext" id="MJXp-Span-932">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-933">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-934">n</span><span class="MJXp-mtext" id="MJXp-Span-935">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-936">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-937">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-938">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-941">b</span><span class="MJXp-msubsup" id="MJXp-Span-942"><span class="MJXp-mrow" id="MJXp-Span-943" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-944">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-945" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-946">N</span></span></span></span></span><script type="math/tex" id="MathJax-Element-62"> [\ nabla_ {x} f (x)] \ in \ mathbb {R} ^ {N} </script>  (lido como "nabla") composto por <em>derivadas parciais</em> : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-947"><span class="MJXp-mtext" id="MJXp-Span-948">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-949">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-950">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-951">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952">l</span><span class="MJXp-msubsup" id="MJXp-Span-953"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-954" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-955" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-956">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957">y</span><span class="MJXp-mo" id="MJXp-Span-958" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-959" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-960">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-961">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-963">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-964">c</span><span class="MJXp-mrow" id="MJXp-Span-965"><span class="MJXp-mtext" id="MJXp-Span-966">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-971">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-972">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-973">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974">y</span></span><span class="MJXp-mrow" id="MJXp-Span-975"><span class="MJXp-mtext" id="MJXp-Span-976">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-977">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-978">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-981">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-983">l</span><span class="MJXp-msubsup" id="MJXp-Span-984"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-985" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-986" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-987">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-988" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-989">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-991">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-992">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-993">c</span><span class="MJXp-mrow" id="MJXp-Span-994"><span class="MJXp-mtext" id="MJXp-Span-995">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-996">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-997">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-998">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1000">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1001">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1002">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1003">y</span></span><span class="MJXp-mrow" id="MJXp-Span-1004"><span class="MJXp-mtext" id="MJXp-Span-1005">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1006">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1007">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1008">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1010">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1012">l</span><span class="MJXp-msubsup" id="MJXp-Span-1013"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1015" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-1016">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1017" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1018" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1019" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1020" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1021" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1022">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1025">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1026">c</span><span class="MJXp-mrow" id="MJXp-Span-1027"><span class="MJXp-mtext" id="MJXp-Span-1028">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1029">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1031">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1033">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1034">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1035">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1036">y</span></span><span class="MJXp-mrow" id="MJXp-Span-1037"><span class="MJXp-mtext" id="MJXp-Span-1038">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1039">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1040">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1042">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1043">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1045">l</span><span class="MJXp-msubsup" id="MJXp-Span-1046"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1047" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1048" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1049">N</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1050" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-63"> \ nabla_ {x} y = (\ frac {\ parcial y} {\ parcial x_ {1}}, \ frac {\ parcial y} {\ parcial x_ {2}}, ..., \ frac {\ parcial y} {\ parcial x_ {N}}) </script></p><br><p>  Nesse caso, o registro da depend√™ncia da altera√ß√£o da fun√ß√£o na altera√ß√£o do argumento tem a seguinte forma: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1051"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1052">x</span><span class="MJXp-mtext" id="MJXp-Span-1053">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1054">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1055">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1056">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1057">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1058">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1059">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1060">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1062">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1063">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064">x</span><span class="MJXp-mo" id="MJXp-Span-1065" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1066">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1068">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1069">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1070">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1072">x</span><span class="MJXp-mtext" id="MJXp-Span-1073">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1074">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1076">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1077">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1078">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1079">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1080">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1081">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1082">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1083">w</span><span class="MJXp-mtext" id="MJXp-Span-1084">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-1085">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1087">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1089">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1090">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1091">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1093">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1095">w</span><span class="MJXp-mtext" id="MJXp-Span-1096">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1097">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1098">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1100">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1101">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1102">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1103">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1104">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1105">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1106">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1107">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1108">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1109">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1110">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1111">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1112">y</span><span class="MJXp-mo" id="MJXp-Span-1113" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1114">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1116">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1117">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118">l</span><span class="MJXp-msubsup" id="MJXp-Span-1119"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1121" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1122">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1123">y</span><span class="MJXp-mtext" id="MJXp-Span-1124">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1126">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1127">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1128">t</span><span class="MJXp-mtext" id="MJXp-Span-1129">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1131">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1132">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1133">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1134">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1135">x</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-64"> x \ rightarrow x + \ Delta x \ rightarrow \ \ rightarrow \ aproximadamente y + \ nabla_ {x} y \ cdot \ Delta x </script></p><br><p>  O registro mudou bastante para levar em conta que <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1136"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1137">x</span></span></span><script type="math/tex" id="MathJax-Element-65"> x </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1138"><span class="MJXp-mtext" id="MJXp-Span-1139">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1140">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1141">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1143">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1145">x</span></span></span><script type="math/tex" id="MathJax-Element-66"> \ Delta x </script>  e <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1146"><span class="MJXp-mtext" id="MJXp-Span-1147">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1148">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1149">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1150">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1151">l</span><span class="MJXp-msubsup" id="MJXp-Span-1152"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1154" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1155">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1156">y</span></span></span><script type="math/tex" id="MathJax-Element-67"> \ nabla_ {x} y </script>  - vetores em <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1157"><span class="MJXp-mtext" id="MJXp-Span-1158">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1159">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1160">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1161">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1162">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1163">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1164">b</span><span class="MJXp-msubsup" id="MJXp-Span-1165"><span class="MJXp-mrow" id="MJXp-Span-1166" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1168" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169">N</span></span></span></span></span><script type="math/tex" id="MathJax-Element-68"> \ mathbb {R} ^ {N} </script>  e <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1170"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1171">y</span></span></span><script type="math/tex" id="MathJax-Element-69"> y </script>  - escalar.  Ao multiplicar vetores <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1172"><span class="MJXp-mtext" id="MJXp-Span-1173">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1174">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1175">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1176">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1177">l</span><span class="MJXp-msubsup" id="MJXp-Span-1178"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1179" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1180" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1181">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1182">y</span></span></span><script type="math/tex" id="MathJax-Element-70"> \ nabla_ {x} y </script>  e <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1183"><span class="MJXp-mtext" id="MJXp-Span-1184">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1185">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1186">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1187">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1188">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1189">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1190">x</span></span></span><script type="math/tex" id="MathJax-Element-71"> \ Delta x </script>  o <i>produto escalar √© usado</i> (a soma dos produtos dos componentes). </p></div></div><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#        grad = tf.gradients(loss, p)[0] #   learning_rate = 0.0005 #   ,     apply_gradients - #         opt = tf.train.GradientDescentOptimizer(learning_rate=1) #           sgd = opt.apply_gradients([(learning_rate*grad, p)]) #   ,    40000  session.run(tf.global_variables_initializer()) train(1e-10, 40000, loss, sgd, feed_dict) print('PARAMETERS:', session.run(p))</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, current loss: 3868.2291666666665 step: 2, current loss: 1381.5379689135807 [...] ENDED ON STEP: 582, FINAL LOSS: 9.698531012270816e-11 PARAMETERS: [2.50000205 2.49999959]</code> </pre> <br><p>  Foram necess√°rias 582 etapas: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/b2/j3/jb/b2j3jbxzfk6_ll66vpr83vklwjs.jpeg"></div><br><div class="spoiler">  <b class="spoiler_title">Movimento na dire√ß√£o do anti-gradiente</b> <div class="spoiler_text"><p>  Por que estamos nos movendo na dire√ß√£o oposta ao gradiente?  Lembre-se da entrada com o produto escalar: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1191"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1192">x</span><span class="MJXp-mtext" id="MJXp-Span-1193">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1195">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1196">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1197">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1198">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1199">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1201">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1202">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1203">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1204">x</span><span class="MJXp-mo" id="MJXp-Span-1205" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1206">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1207">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1208">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1209">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1210">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1211">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1212">x</span><span class="MJXp-mtext" id="MJXp-Span-1213">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1214">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1215">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1216">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1218">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1219">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1220">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1221">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1222">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1223">w</span><span class="MJXp-mtext" id="MJXp-Span-1224">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-1225">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1226">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1227">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1228">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1229">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1230">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1231">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1232">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1233">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1234">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1235">w</span><span class="MJXp-mtext" id="MJXp-Span-1236">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1237">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1238">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1239">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1240">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1241">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1242">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1243">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1244">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1245">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1246">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1247">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1248">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1249">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1250">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1251">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252">y</span><span class="MJXp-mo" id="MJXp-Span-1253" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1254">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1255">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1256">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1257">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">l</span><span class="MJXp-msubsup" id="MJXp-Span-1259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1261" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1262">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263">y</span><span class="MJXp-mtext" id="MJXp-Span-1264">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1266">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1267">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1268">t</span><span class="MJXp-mtext" id="MJXp-Span-1269">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1270">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1271">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1272">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1273">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1274">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1275">x</span></span></span><script type="math/tex" id="MathJax-Element-72"> x \ rightarrow x + \ Delta x \ rightarrow \ \ rightarrow \ aproximadamente y + \ nabla_ {x} y \ cdot \ Delta x </script>  .  Minimizar <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1276"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1277">y</span></span></span><script type="math/tex" id="MathJax-Element-73"> y </script>  .  Como o comportamento da fun√ß√£o √© conhecido apenas em uma vizinhan√ßa pequena por meio da derivada, √© necess√°rio avan√ßar em etapas pequenas, por√©m √≥timas, minimizando o produto <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1278"><span class="MJXp-mtext" id="MJXp-Span-1279">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1280">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1281">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1282">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283">l</span><span class="MJXp-msubsup" id="MJXp-Span-1284"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1285" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1286" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1287">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1288">y</span><span class="MJXp-mtext" id="MJXp-Span-1289">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1290">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1291">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1292">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1293">t</span><span class="MJXp-mtext" id="MJXp-Span-1294">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1295">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1296">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1297">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1298">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1299">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300">x</span></span></span><script type="math/tex" id="MathJax-Element-74"> \ nabla_ {x} y \ cdot \ Delta x </script>  .  Por defini√ß√£o de escola, o <i>produto escalar de dois vetores √© o n√∫mero igual ao produto dos comprimentos desses vetores pelo cosseno do √¢ngulo entre eles</i> : <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1301"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1302">a</span><span class="MJXp-mtext" id="MJXp-Span-1303">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1304">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1305">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1306">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1307">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1308">b</span><span class="MJXp-mo" id="MJXp-Span-1309" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1310">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1311">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1312">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1313">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1314">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1315">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1317">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1318">a</span><span class="MJXp-mrow" id="MJXp-Span-1319"><span class="MJXp-mo" id="MJXp-Span-1320" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1321">a</span><span class="MJXp-mtext" id="MJXp-Span-1322">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1323">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1324">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1325">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1326">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1327">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1328">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1329">a</span><span class="MJXp-mrow" id="MJXp-Span-1330"><span class="MJXp-mo" id="MJXp-Span-1331" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1332">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1333">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1334">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1335">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1336">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1337">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1338">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1339">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1340">a</span><span class="MJXp-mrow" id="MJXp-Span-1341"><span class="MJXp-mo" id="MJXp-Span-1342" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1343">b</span><span class="MJXp-mtext" id="MJXp-Span-1344">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1345">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1346">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1347">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1348">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1349">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1350">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1351">a</span><span class="MJXp-mrow" id="MJXp-Span-1352"><span class="MJXp-mo" id="MJXp-Span-1353" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1354">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1355">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1356">s</span><span class="MJXp-mtext" id="MJXp-Span-1357">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1358"><span class="MJXp-mo" id="MJXp-Span-1359" style="margin-left: 0em; margin-right: 0em;">√¢</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1360">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1361">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1362">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1363">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1364">o</span><span class="MJXp-mo" id="MJXp-Span-1365" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366">a</span><span class="MJXp-mo" id="MJXp-Span-1367" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1368">b</span><span class="MJXp-mo" id="MJXp-Span-1369" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-75"> a \ cdot b = \ esquerda | a \ direita | \ esquerda | b \ direita | cos \ √¢ngulo (a, b) </script>  .  Para um comprimento fixo de vetores, este produto atinge um m√≠nimo com um cosseno de -1, ou seja,  em um √¢ngulo de 180 graus, quando os vetores s√£o direcionados em dire√ß√µes opostas.  Consequentemente, o produto escalar m√≠nimo <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1370"><span class="MJXp-mtext" id="MJXp-Span-1371">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1372">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1373">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1374">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1375">l</span><span class="MJXp-msubsup" id="MJXp-Span-1376"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1377" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1378" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1379">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1380">y</span><span class="MJXp-mtext" id="MJXp-Span-1381">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1382">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1383">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1384">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1385">t</span><span class="MJXp-mtext" id="MJXp-Span-1386">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1387">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1388">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1389">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1390">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1391">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1392">x</span></span></span><script type="math/tex" id="MathJax-Element-76"> \ nabla_ {x} y \ cdot \ Delta x </script>  alcan√ßado quando <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1393"><span class="MJXp-mtext" id="MJXp-Span-1394">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1395">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1396">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1397">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1398">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1399">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1400">x</span></span></span><script type="math/tex" id="MathJax-Element-77"> \ Delta x </script>  na dire√ß√£o do <i>anti-gradiente</i> . </p></div></div><br><h4 id="optimiziruem-metodom-adam">  Otimizamos pelo m√©todo Adam </h4><br><p>  N√£o vamos avan√ßar nos m√©todos de gradiente, mas h√° muitas varia√ß√µes.  Voc√™ pode ler sobre eles no artigo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">M√©todos de otimiza√ß√£o de redes neurais</a> .  No TensorFlow, muitos otimizadores j√° est√£o implementados.  Por exemplo, Adam: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#       , #      adm = tf.train.AdamOptimizer(15).minimize(loss) #   ,    40000  session.run(tf.global_variables_initializer()) train(1e-10, 40000, loss, adm, feed_dict) print('PARAMETERS:', session.run(p))</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, current loss: 3868.2291666666665 step: 2, current loss: 34205.72916492336 [...] ENDED ON STEP: 317, FINAL LOSS: 2.424142714263483e-12 PARAMETERS: [2.49999969 2.50000008]</code> </pre> <br><p>  Gerenciado em 317 etapas.  Muito mais rapido </p><br><h4 id="optimiziruem-metodom-nyutona">  Otimizamos pelo m√©todo de Newton </h4><br><p>  As a√ß√µes dos m√©todos de segunda ordem podem ser comparadas √† pilotagem de um snowboardista de freeride racional que pondera o pr√≥ximo ponto de sua rota por um longo tempo e leva em considera√ß√£o n√£o apenas a inclina√ß√£o do local, mas tamb√©m a curvatura. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/p_/iu/kf/p_iukfzoa0idjm_cbycfmlye4mw.jpeg"></div><br><p>  De fato, os m√©todos de descida de gradiente e os de segunda ordem tentam adivinhar ( <em>aproximar</em> ) a fun√ß√£o no ponto atual.  Os m√©todos de gradiente focam apenas a <em>inclina√ß√£o do</em> gr√°fico da fun√ß√£o no ponto - a primeira derivada.  Os m√©todos de segunda ordem, al√©m do vi√©s, levam em considera√ß√£o a <em>curvatura</em> , a segunda derivada: "se a curvatura persistir, onde ser√° o m√≠nimo?"  N√≥s calculamos e vamos l√°: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xb/sn/nb/xbsnnb1o5cui4x10wspkrgjinaw.jpeg"></div><br><p>  Para construir essa aproxima√ß√£o e calcular o ponto m√≠nimo estimado, voc√™ pode usar a <em>s√©rie de Taylor</em> .  Para o caso unidimensional, a aproxima√ß√£o por um polin√¥mio de segunda ordem no ponto <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1401"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1402"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span></span></span><script type="math/tex" id="MathJax-Element-78"> a </script>  √© assim: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1450"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1451">f</span><span class="MJXp-mo" id="MJXp-Span-1452" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1453">x</span><span class="MJXp-mo" id="MJXp-Span-1454" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1455">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1456">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1457">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1458">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1459">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1460">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1461">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1462">f</span><span class="MJXp-mo" id="MJXp-Span-1463" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1464">a</span><span class="MJXp-mo" id="MJXp-Span-1465" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1466" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1467">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1468">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1469">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1470">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1471">c</span><span class="MJXp-mrow" id="MJXp-Span-1472"><span class="MJXp-msup" id="MJXp-Span-1473"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474" style="margin-right: 0.05em;">f</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1475" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-1476" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1477">a</span><span class="MJXp-mo" id="MJXp-Span-1478" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1479" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1480">x</span><span class="MJXp-mo" id="MJXp-Span-1481" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482">a</span><span class="MJXp-mo" id="MJXp-Span-1483" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-1484"><span class="MJXp-mn" id="MJXp-Span-1485">1</span><span class="MJXp-mo" id="MJXp-Span-1486" style="margin-left: 0.111em; margin-right: 0em;">!</span></span><span class="MJXp-mo" id="MJXp-Span-1487" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1488">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1489">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1490">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1491">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1492">c</span><span class="MJXp-mrow" id="MJXp-Span-1493"><span class="MJXp-msup" id="MJXp-Span-1494"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1495" style="margin-right: 0.05em;">f</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1496" style="vertical-align: 0.5em;">‚Ä≥</span></span><span class="MJXp-mo" id="MJXp-Span-1497" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1498">a</span><span class="MJXp-mo" id="MJXp-Span-1499" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1500" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1501">x</span><span class="MJXp-mo" id="MJXp-Span-1502" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1503">a</span><span class="MJXp-msubsup" id="MJXp-Span-1504"><span class="MJXp-mo" id="MJXp-Span-1505" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1506" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1507"><span class="MJXp-mn" id="MJXp-Span-1508">2</span><span class="MJXp-mo" id="MJXp-Span-1509" style="margin-left: 0.111em; margin-right: 0em;">!</span></span></span></span><script type="math/tex;mode=display" id="MathJax-Element-79"> f (x) \ approx f (a) + \ frac {f '(a) (x-a)} {1!} + \ frac {f' '(a) (x-a) ^ 2} {2!} </script></p><br><p>  O m√≠nimo √© atingido em <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1510"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1511">x</span><span class="MJXp-mo" id="MJXp-Span-1512" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1513">a</span><span class="MJXp-mo" id="MJXp-Span-1514" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1515">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1516">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1517">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1518">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1519">c</span><span class="MJXp-mrow" id="MJXp-Span-1520"><span class="MJXp-msup" id="MJXp-Span-1521"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1522" style="margin-right: 0.05em;">f</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1523" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-1524" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1525">a</span><span class="MJXp-mo" id="MJXp-Span-1526" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-1527"><span class="MJXp-msup" id="MJXp-Span-1528"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1529" style="margin-right: 0.05em;">f</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1530" style="vertical-align: 0.5em;">‚Ä≥</span></span><span class="MJXp-mo" id="MJXp-Span-1531" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1532">a</span><span class="MJXp-mo" id="MJXp-Span-1533" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><script type="math/tex" id="MathJax-Element-80"> x = a - \ frac {f '(a)} {f' '(a)} </script>  .  O caso multidimensional parece mais s√©rio: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dv/pd/31/dvpd31r1vt2cbts_a5oamiiwgoc.jpeg"></div><br><div class="spoiler">  <b class="spoiler_title">Matriz Hessiana (vetor inserido - n√∫mero √† esquerda)</b> <div class="spoiler_text"><p>  <em>A</em> <em>matriz hessiana</em> √© uma matriz quadrada composta de segundas derivadas: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1534"><span class="noError" id="MJXp-Span-1535" style="display: inline-block;">\&nbsp;boldsymbol&nbsp;{H}&nbsp;y_&nbsp;{x}&nbsp;=&nbsp;\&nbsp;begin&nbsp;{bmatrix}&nbsp;\&nbsp;frac&nbsp;{\&nbsp;parcialmente&nbsp;^&nbsp;2y}&nbsp;{\&nbsp;parcial&nbsp;x_1&nbsp;^&nbsp;2}&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{\&nbsp;parcial&nbsp;^&nbsp;2y}&nbsp;{\&nbsp;parcial&nbsp;x_1&nbsp;\&nbsp;parcial&nbsp;x_2}&nbsp;&amp;&nbsp;\&nbsp;cdots&nbsp;e&nbsp;\&nbsp;frac&nbsp;{\&nbsp;parcial&nbsp;^&nbsp;2y}&nbsp;{\&nbsp;parcial&nbsp;x_1&nbsp;\&nbsp;parcial&nbsp;x_N}&nbsp;\\&nbsp;\&nbsp;frac&nbsp;{\&nbsp;parcial&nbsp;^&nbsp;2y}&nbsp;{\&nbsp;parcial&nbsp;x_2&nbsp;\&nbsp;parcial&nbsp;x_1}&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{\&nbsp;parcial&nbsp;^&nbsp;2y}&nbsp;{\&nbsp;parcial&nbsp;x_2&nbsp;^&nbsp;2}&nbsp;&amp;&nbsp;\&nbsp;cdots&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{\&nbsp;parcial&nbsp;^&nbsp;2y}&nbsp;{\&nbsp;parcial&nbsp;x_2&nbsp;\&nbsp;parcial&nbsp;x_N}&nbsp;\\&nbsp;\&nbsp;vdots&nbsp;e&nbsp;\&nbsp;vdots&nbsp;e&nbsp;\&nbsp;ddots&nbsp;e&nbsp;\&nbsp;vdots&nbsp;\\&nbsp;\&nbsp;frac&nbsp;{\&nbsp;parcial&nbsp;^&nbsp;2y}&nbsp;{\&nbsp;parcial&nbsp;x_N&nbsp;\&nbsp;parcial&nbsp;x_1}&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{\&nbsp;parcial&nbsp;^&nbsp;2y}&nbsp;{\&nbsp;parcial&nbsp;x_N&nbsp;\&nbsp;parcial&nbsp;x_2}&nbsp;&amp;&nbsp;\&nbsp;cdots&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{\&nbsp;parcial&nbsp;^&nbsp;2y}&nbsp;{\&nbsp;parcial&nbsp;x_N&nbsp;^&nbsp;2}&nbsp;\&nbsp;end&nbsp;{bmatrix}</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-81"> \ boldsymbol {H} y_ {x} = \ begin {bmatrix} \ frac {\ parcialmente ^ 2y} {\ parcial x_1 ^ 2} & \ frac {\ parcial ^ 2y} {\ parcial x_1 \ parcial x_2} & \ cdots e \ frac {\ parcial ^ 2y} {\ parcial x_1 \ parcial x_N} \\ \ frac {\ parcial ^ 2y} {\ parcial x_2 \ parcial x_1} & \ frac {\ parcial ^ 2y} {\ parcial x_2 ^ 2} & \ cdots & \ frac {\ parcial ^ 2y} {\ parcial x_2 \ parcial x_N} \\ \ vdots e \ vdots e \ ddots e \ vdots \\ \ frac {\ parcial ^ 2y} {\ parcial x_N \ parcial x_1} & \ frac {\ parcial ^ 2y} {\ parcial x_N \ parcial x_2} & \ cdots & \ frac {\ parcial ^ 2y} {\ parcial x_N ^ 2} \ end {bmatrix} </script></p></div></div><br><p>  Aproxima√ß√£o de um polin√¥mio de segunda ordem para uma fun√ß√£o de um vetor por meio de um gradiente e uma matriz Hessiana em um ponto <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1536"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537">a</span></span></span><script type="math/tex" id="MathJax-Element-82"> a </script>  √© assim: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1538"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1539">f</span><span class="MJXp-mo" id="MJXp-Span-1540" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1541">x</span><span class="MJXp-mo" id="MJXp-Span-1542" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1543">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1544">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1545">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1546">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1547">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1548">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1549">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1550">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1551">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1552">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1553">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1554">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1555">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1556">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1557">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1558">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1559">f</span><span class="MJXp-mo" id="MJXp-Span-1560" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1561">a</span><span class="MJXp-mo" id="MJXp-Span-1562" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1563" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1564" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1565">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1566">a</span><span class="MJXp-msubsup" id="MJXp-Span-1567"><span class="MJXp-mo" id="MJXp-Span-1568" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1569" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1570">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1571">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1572">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1573">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1574">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1575">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1576">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1577">l</span><span class="MJXp-mo" id="MJXp-Span-1578" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1579">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1580">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1581">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1582">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1583">l</span><span class="MJXp-msubsup" id="MJXp-Span-1584"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1585" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1586" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1587">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1588">f</span><span class="MJXp-mo" id="MJXp-Span-1589" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1590">a</span><span class="MJXp-mo" id="MJXp-Span-1591" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1592" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1593" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1594">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1595">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1596">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1597">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1598">c</span><span class="MJXp-mrow" id="MJXp-Span-1599"><span class="MJXp-mn" id="MJXp-Span-1600">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1601"><span class="MJXp-mn" id="MJXp-Span-1602">2</span><span class="MJXp-mo" id="MJXp-Span-1603" style="margin-left: 0.111em; margin-right: 0em;">!</span></span><span class="MJXp-mo" id="MJXp-Span-1604" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1605">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1606">a</span><span class="MJXp-msubsup" id="MJXp-Span-1607"><span class="MJXp-mo" id="MJXp-Span-1608" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1609" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1610">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1611">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1612">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1613">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1614">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1615">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1616">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1617">l</span><span class="MJXp-mo" id="MJXp-Span-1618" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1619">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1620">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1621">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1622">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1623">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1624">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1625">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1626">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1627">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1628">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1629">l</span><span class="MJXp-mrow" id="MJXp-Span-1630"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1631">H</span></span><span class="MJXp-msubsup" id="MJXp-Span-1632"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1633" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1634" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1635">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-1636" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1637">a</span><span class="MJXp-mo" id="MJXp-Span-1638" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1639" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1640" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1641">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1642">a</span><span class="MJXp-mo" id="MJXp-Span-1643" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-83"> f (x) \ aproximadamente f (a) + (xa) ^ \ intercal [\ nabla_ {x} f (a)] + \ frac {1} {2!} (xa) ^ \ intercal [\ boldsymbol {H } f_ {x} (a)] (xa) </script></p><br><p>  O m√≠nimo √© atingido em <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1644"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1645">x</span><span class="MJXp-mo" id="MJXp-Span-1646" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1647">a</span><span class="MJXp-mo" id="MJXp-Span-1648" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mo" id="MJXp-Span-1649" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1650">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1651">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1652">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1653">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1654">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1655">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1656">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1657">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1658">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1659">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1660">l</span><span class="MJXp-mrow" id="MJXp-Span-1661"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1662">H</span></span><span class="MJXp-msubsup" id="MJXp-Span-1663"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1664" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1665" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1666">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-1667" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1668">a</span><span class="MJXp-mo" id="MJXp-Span-1669" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-1670"><span class="MJXp-mo" id="MJXp-Span-1671" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1672" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1673">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1674">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1675" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1676">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1677">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1678">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1679">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1680">l</span><span class="MJXp-msubsup" id="MJXp-Span-1681"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1682" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1683" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1684">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1685">f</span><span class="MJXp-mo" id="MJXp-Span-1686" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1687">a</span><span class="MJXp-mo" id="MJXp-Span-1688" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1689" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-84"> x = a - [\ boldsymbol {H} f_ {x} (a)] ^ {- 1} [\ nabla_ {x} f (a)] </script>  .  A forma praticamente coincide com o caso unidimensional: substitu√≠mos a primeira derivada por um gradiente, a segunda por uma matriz Hessiana e fizemos uma corre√ß√£o para trabalhar com vetores.  √â imposs√≠vel dividir um vetor por uma matriz, portanto, a multiplica√ß√£o pela matriz <em>inversa</em> √© usada.  <em>T</em> significa <em>transpor</em> .  A f√≥rmula implica que, por padr√£o, um vetor √© uma coluna.  Transpose transforma <em>um</em> <em>vetor de</em> <em>coluna</em> em <em>um vetor de linha</em> .  Ao implementar no TensorFlow, isso deve ser levado em considera√ß√£o, mas na dire√ß√£o oposta: por padr√£o, o vetor √© uma sequ√™ncia (tensor unidimensional).  Apenas no caso: a transposi√ß√£o n√£o √© uma rota√ß√£o de 90 graus, √© a transforma√ß√£o de linhas em colunas na mesma ordem. </p><br><p>  Portanto, a etapa do m√©todo Newton tem a seguinte forma: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1690"><span class="MJXp-mtext" id="MJXp-Span-1691">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1692">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1693">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1694">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1695">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1696">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1697">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1698">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1699">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1700">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1701">l</span><span class="MJXp-mrow" id="MJXp-Span-1702"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1703">p</span></span><span class="MJXp-mtext" id="MJXp-Span-1704">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1705">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1706">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1707">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1708">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1709">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1710">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1711">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1712">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1713">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1714">w</span><span class="MJXp-mtext" id="MJXp-Span-1715">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1716">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1717">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1718">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1719">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1720">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1721">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1722">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1723">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1724">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1725">l</span><span class="MJXp-mrow" id="MJXp-Span-1726"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1727">p</span></span><span class="MJXp-mo" id="MJXp-Span-1728" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mo" id="MJXp-Span-1729" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1730">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1731">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1732">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1733">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1734">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1735">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1736">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1737">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1738">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1739">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1740">l</span><span class="MJXp-mrow" id="MJXp-Span-1741"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1742">H</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1743">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1744">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1745">s</span><span class="MJXp-msubsup" id="MJXp-Span-1746"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1747" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1748" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1749">p</span></span></span><span class="MJXp-mo" id="MJXp-Span-1750" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1751">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1752">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1753">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1754">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1755">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1756">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1757">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1758">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1759">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1760">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1761">l</span><span class="MJXp-mrow" id="MJXp-Span-1762"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1763">p</span></span><span class="MJXp-mo" id="MJXp-Span-1764" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-1765"><span class="MJXp-mo" id="MJXp-Span-1766" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1767" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1768">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1769">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1770" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1771">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1772">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1773">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1774">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1775">l</span><span class="MJXp-msubsup" id="MJXp-Span-1776"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1777" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1778" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1779">p</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1780">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1781">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1782">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1783">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1784">a</span><span class="MJXp-mo" id="MJXp-Span-1785" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1786">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1787">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1788">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1789">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1790">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1791">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1792">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1793">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1794">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1795">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1796">l</span><span class="MJXp-mrow" id="MJXp-Span-1797"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1798">p</span></span><span class="MJXp-mo" id="MJXp-Span-1799" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1800" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-85"> \ boldsymbol {p} \ rightarrow \ boldsymbol {p} - [\ boldsymbol {H} loss_ {p} (\ boldsymbol {p})] ^ {- 1} [\ nabla_ {p} perda (\ boldsymbol {p} )] </script></p><br><p>  O TensorFlow tem tudo para implementar este m√©todo: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#        hess = tf.hessians(loss, p)[0] #    - grad_col = tf.expand_dims(grad, -1) # ,      dp = tf.matmul(tf.linalg.inv(hess), grad_col) #  -  - dp = tf.squeeze(dp) #  p  dp    newton = opt.apply_gradients([(dp, p)]) #   ,    40000  session.run(tf.global_variables_initializer()) train(1e-10, 40000, loss, newton, feed_dict) print('PARAMETERS:', session.run(p))</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, current loss: 3868.2291666666665 step: 2, current loss: 105.04357496954218 step: 4, current loss: 9.96663526704236 ENDED ON STEP: 6, FINAL LOSS: 5.882202372519996e-20 PARAMETERS: [2.5 2.5]</code> </pre> <br><p>  Bastante 6 etapas: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/to/4-/eo/to4-eorewt5uoh_sdhokzqx0kuq.jpeg"></div><br><h4 id="optimiziruem-algoritmom-gaussa-nyutona">  Otimizado pelo algoritmo de Gauss-Newton </h4><br><p>  O m√©todo de Newton tem uma desvantagem - a matriz hessiana.  Gra√ßas ao TensorFlow, podemos cont√°-lo em uma linha de c√≥digo.  Segundo o wiki, <em>Johann Karl Friedrich Gauss</em> fez a primeira men√ß√£o de seu m√©todo em 1809.  O c√°lculo da matriz de Hessian para v√°rios par√¢metros para o m√©todo dos m√≠nimos quadrados pode levar muito tempo.  Agora podemos assumir que o algoritmo de Gauss-Newton usa a aproxima√ß√£o da <em>matriz de</em> <em>Hessian</em> atrav√©s <em>da matriz de Jacobi</em> para simplificar os c√°lculos.  Mas, do ponto de vista da hist√≥ria, n√£o √© assim: <em>Ludwig Otto Hesse</em> (que desenvolveu a matriz com o nome dele) nasceu em 1811 - 2 anos ap√≥s a primeira men√ß√£o do algoritmo.  E <em>Carl Gustav Jacobi</em> tinha 5 anos. </p><br><p>  O algoritmo de Gauss-Newton n√£o funciona com a fun√ß√£o de perda.  Funciona com a <em>fun√ß√£o residual</em> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1801"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1802">r</span><span class="MJXp-mo" id="MJXp-Span-1803" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1804">p</span><span class="MJXp-mo" id="MJXp-Span-1805" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-86"> r (p) </script>  .  Esta fun√ß√£o aceita um vetor de entrada de par√¢metros <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1806"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1807">p</span></span></span><script type="math/tex" id="MathJax-Element-87"> p </script>  e retorna <em>um vetor de res√≠duos</em> .  No nosso caso, o vetor <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1808"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1809">p</span></span></span><script type="math/tex" id="MathJax-Element-88"> p </script>  consiste em 2 componentes (par√¢metros <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1810"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1811">a</span></span></span><script type="math/tex" id="MathJax-Element-89"> a </script>  e <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1812"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1813">b</span></span></span><script type="math/tex" id="MathJax-Element-90"> b </script>  Fun√ß√µes de Rosenbrock) e o vetor residual de <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1814"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1815">m</span></span></span><script type="math/tex" id="MathJax-Element-91"> m </script>  componente (de acordo com o n√∫mero de experi√™ncias).  A fun√ß√£o vetorial do argumento vetorial √© obtida.  Sua derivada: </p><br><div class="spoiler">  <b class="spoiler_title">Matriz Jacobi (vetor inserido - vetor liberado)</b> <div class="spoiler_text"><p>  Considere uma fun√ß√£o que recebe um vetor como entrada e tamb√©m produz um vetor: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1816"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1817">f</span><span class="MJXp-mo" id="MJXp-Span-1818" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mtext" id="MJXp-Span-1819">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1820">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1821">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1822">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1823">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1824">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1825">b</span><span class="MJXp-msubsup" id="MJXp-Span-1826"><span class="MJXp-mrow" id="MJXp-Span-1827" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1828">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1829" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1830">N</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1831">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1832">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1833">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1834">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1835">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1836">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1837">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1838">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1839">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1840">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1841">w</span><span class="MJXp-mtext" id="MJXp-Span-1842">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1843">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1844">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1845">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1846">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1847">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1848">b</span><span class="MJXp-msubsup" id="MJXp-Span-1849"><span class="MJXp-mrow" id="MJXp-Span-1850" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1851">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1852" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1853">M</span></span></span></span></span><script type="math/tex" id="MathJax-Element-92"> f: \ mathbb {R} ^ {N} \ rightarrow \ mathbb {R} ^ {M} </script>  .  Derivada <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1854"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1855">f</span></span></span><script type="math/tex" id="MathJax-Element-93"> f </script>  no ponto <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1856"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1857">x</span></span></span><script type="math/tex" id="MathJax-Element-94"> x </script>  agora tem tamanho <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1858"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1859">N</span><span class="MJXp-mtext" id="MJXp-Span-1860">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1861">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1862">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1863">z</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1864">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1865">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1866">M</span></span></span><script type="math/tex" id="MathJax-Element-95"> N \ vezes M </script>  , chamada <i>matriz de Jacobi</i> , e consiste em todas as combina√ß√µes de derivadas parciais: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1867"><span class="noError" id="MJXp-Span-1868" style="display: inline-block;">\&nbsp;boldsymbol&nbsp;{J}&nbsp;y_&nbsp;{x}&nbsp;=&nbsp;\&nbsp;begin&nbsp;{pmatrix}&nbsp;\&nbsp;frac&nbsp;{\&nbsp;parcial&nbsp;y_&nbsp;{1}}&nbsp;{\&nbsp;parcial&nbsp;x_&nbsp;{1}}&nbsp;&amp;&nbsp;\&nbsp;cdots&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{\&nbsp;parcial&nbsp;y_&nbsp;{1}}&nbsp;{\&nbsp;x_&nbsp;parcial&nbsp;{N}}&nbsp;\\&nbsp;\&nbsp;vdots&nbsp;e&nbsp;\&nbsp;pontos&nbsp;e&nbsp;\&nbsp;vdots&nbsp;\\&nbsp;\&nbsp;frac&nbsp;{\&nbsp;parcial&nbsp;y_&nbsp;{M}}&nbsp;{\&nbsp;parcial&nbsp;x_&nbsp;{1}}&nbsp;&amp;&nbsp;\&nbsp;cdots&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{\&nbsp;parcial&nbsp;y_&nbsp;{M}}&nbsp;{\&nbsp;parcial&nbsp;x_&nbsp;{N}}&nbsp;\&nbsp;end&nbsp;{pmatrix}</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-96"> \ boldsymbol {J} y_ {x} = \ begin {pmatrix} \ frac {\ parcial y_ {1}} {\ parcial x_ {1}} & \ cdots & \ frac {\ parcial y_ {1}} {\ x_ parcial {N}} \\ \ vdots e \ pontos e \ vdots \\ \ frac {\ parcial y_ {M}} {\ parcial x_ {1}} & \ cdots & \ frac {\ parcial y_ {M}} {\ parcial x_ {N}} \ end {pmatrix} </script></p><br><p>  Voc√™ pode perceber que as linhas da <i>matriz Jacobi</i> s√£o os <i>gradientes dos</i> componentes <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1869"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1870">y</span></span></span><script type="math/tex" id="MathJax-Element-97"> y </script>  .  Item <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1871"><span class="MJXp-mo" id="MJXp-Span-1872" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1873">i</span><span class="MJXp-mo" id="MJXp-Span-1874" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1875">j</span><span class="MJXp-mo" id="MJXp-Span-1876" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-98"> (i, j) </script>  matrizes <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1877"><span class="MJXp-mtext" id="MJXp-Span-1878">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1879">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1880">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1881">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1882">c</span><span class="MJXp-mrow" id="MJXp-Span-1883"><span class="MJXp-mtext" id="MJXp-Span-1884">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1885">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1886">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1887">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1888">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1889">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1890">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1891">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1892">y</span></span><span class="MJXp-mrow" id="MJXp-Span-1893"><span class="MJXp-mtext" id="MJXp-Span-1894">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1895">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1896">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1897">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1898">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1899">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1900">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1901">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1902">x</span></span></span></span><script type="math/tex" id="MathJax-Element-99"> \ frac {\ parcial y} {\ parcial x} </script>  √© igual a <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1903"><span class="MJXp-mtext" id="MJXp-Span-1904">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1905">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1906">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1907">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1908">c</span><span class="MJXp-mrow" id="MJXp-Span-1909"><span class="MJXp-mtext" id="MJXp-Span-1910">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1911">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1912">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1913">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1914">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1915">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1916">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1917">l</span><span class="MJXp-msubsup" id="MJXp-Span-1918"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1919" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1920" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1921">i</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1922"><span class="MJXp-mtext" id="MJXp-Span-1923">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1924">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1925">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1926">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1927">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1928">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1929">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1930">l</span><span class="MJXp-msubsup" id="MJXp-Span-1931"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1932" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1933" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1934">j</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-100"> \ frac {\ parcial y_ {i}} {\ parcial x_ {j}} </script>  e nos diz quanto vai mudar <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1935"><span class="MJXp-msubsup" id="MJXp-Span-1936"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1937" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1938" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1939">i</span></span></span></span></span><script type="math/tex" id="MathJax-Element-101"> y_ {i} </script>  quando mudar <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1940"><span class="MJXp-msubsup" id="MJXp-Span-1941"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1942" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1943" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1944">j</span></span></span></span></span><script type="math/tex" id="MathJax-Element-102"> x_ {j} </script>  em um pequeno valor.  Como nos casos anteriores, voc√™ pode escrever: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1945"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1946">x</span><span class="MJXp-mtext" id="MJXp-Span-1947">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1948">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1949">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1950">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1951">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1952">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1953">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1954">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1955">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1956">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1957">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1958">x</span><span class="MJXp-mo" id="MJXp-Span-1959" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1960">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1961">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1962">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1963">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1964">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1965">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1966">x</span><span class="MJXp-mtext" id="MJXp-Span-1967">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1968">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1969">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1970">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1971">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1972">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1973">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1974">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1975">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1976">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1977">w</span><span class="MJXp-mtext" id="MJXp-Span-1978">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-1979">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1980">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1981">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1982">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1983">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1984">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1985">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1986">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1987">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1988">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1989">w</span><span class="MJXp-mtext" id="MJXp-Span-1990">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1991">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1992">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1993">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1994">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1995">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1996">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1997">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1998">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1999">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2000">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2001">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2002">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2003">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2004">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2005">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2006">y</span><span class="MJXp-mo" id="MJXp-Span-2007" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-2008">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2009">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2010">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2011">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2012">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2013">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2014">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2015">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2016">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2017">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2018">l</span><span class="MJXp-mrow" id="MJXp-Span-2019"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2020">J</span></span><span class="MJXp-msubsup" id="MJXp-Span-2021"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2022" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2023" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2024">x</span></span></span><span class="MJXp-mtext" id="MJXp-Span-2025">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2026">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2027">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2028">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2029">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2030">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2031">x</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-103"> x \ rightarrow x + \ Delta x \ rightarrow \ \ rightarrow \ aproximadamente y + \ boldsymbol {J} y_ {x} \ Delta x </script></p><br><p>  Aqui <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2032"><span class="MJXp-mtext" id="MJXp-Span-2033">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2034">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2035">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2036">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2037">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2038">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2039">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2040">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2041">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2042">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2043">l</span><span class="MJXp-mrow" id="MJXp-Span-2044"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2045">J</span></span><span class="MJXp-msubsup" id="MJXp-Span-2046"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2047" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2048" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2049">x</span></span></span></span></span><script type="math/tex" id="MathJax-Element-104"> \ boldsymbol {J} y_ {x} </script>  matriz <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2050"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2051">N</span><span class="MJXp-mtext" id="MJXp-Span-2052">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2053">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2054">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2055">z</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2056">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2057">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2058">M</span></span></span><script type="math/tex" id="MathJax-Element-105"> N \ vezes M </script>  e <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2059"><span class="MJXp-mtext" id="MJXp-Span-2060">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2061">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2062">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2063">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2064">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2065">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2066">x</span></span></span><script type="math/tex" id="MathJax-Element-106"> \ Delta x </script>  tamanho do vetor <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2067"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2068">N</span></span></span><script type="math/tex" id="MathJax-Element-107"> N </script>  assim o produto <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2069"><span class="MJXp-mtext" id="MJXp-Span-2070">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2071">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2072">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2073">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2074">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2075">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2076">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2077">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2078">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2079">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2080">l</span><span class="MJXp-mrow" id="MJXp-Span-2081"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2082">J</span></span><span class="MJXp-msubsup" id="MJXp-Span-2083"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2084" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2085" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2086">x</span></span></span><span class="MJXp-mtext" id="MJXp-Span-2087">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2088">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2089">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2090">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2091">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2092">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2093">x</span></span></span><script type="math/tex" id="MathJax-Element-108"> \ boldsymbol {J} y_ {x} \ Delta x </script>  √â o produto da matriz pelo vetor, resultando em um vetor de tamanho <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2094"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2095">M</span></span></span><script type="math/tex" id="MathJax-Element-109"> M </script>  . </p></div></div><br><p>  Para n√£o nos confundirmos com a abund√¢ncia de caracteres, assumimos que <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2096"><span class="MJXp-mtext" id="MJXp-Span-2097">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2098">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2099">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2100">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2101">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2102">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2103">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2104">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2105">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2106">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2107">l</span><span class="MJXp-msubsup" id="MJXp-Span-2108"><span class="MJXp-mrow" id="MJXp-Span-2109" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2110">J</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2111" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2112">r</span></span></span></span></span><script type="math/tex" id="MathJax-Element-110"> \ boldsymbol {J} _ {r} </script>  - matriz de Jacobi de fun√ß√µes residuais no ponto atual <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2113"><span class="MJXp-mtext" id="MJXp-Span-2114">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2115">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2116">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2117">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2118">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2119">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2120">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2121">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2122">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2123">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2124">l</span><span class="MJXp-mrow" id="MJXp-Span-2125"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2126">p</span></span></span></span><script type="math/tex" id="MathJax-Element-111"> \ boldsymbol {p} </script>  .  Ent√£o o algoritmo de Gauss-Newton pode ser escrito da seguinte maneira: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2127"><span class="MJXp-mtext" id="MJXp-Span-2128">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2129">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2130">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2131">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2132">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2133">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2134">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2135">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2136">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2137">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2138">l</span><span class="MJXp-mrow" id="MJXp-Span-2139"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2140">p</span></span><span class="MJXp-mtext" id="MJXp-Span-2141">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2142">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2143">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2144">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2145">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2146">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2147">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2148">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2149">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2150">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2151">w</span><span class="MJXp-mtext" id="MJXp-Span-2152">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2153">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2154">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2155">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2156">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2157">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2158">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2159">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2160">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2161">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2162">l</span><span class="MJXp-mrow" id="MJXp-Span-2163"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2164">p</span></span><span class="MJXp-mo" id="MJXp-Span-2165" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mo" id="MJXp-Span-2166" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-2167">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2168">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2169">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2170">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2171">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2172">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2173">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2174">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2175">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2176">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2177">l</span><span class="MJXp-msubsup" id="MJXp-Span-2178"><span class="MJXp-mrow" id="MJXp-Span-2179" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2180">J</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mtext" id="MJXp-Span-2183">&nbsp;</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2181"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2182">r</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2184">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2185">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2186">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2187">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2188">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2189">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2190">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2191">l</span><span class="MJXp-mtext" id="MJXp-Span-2192">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2193">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2194">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2195">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2196">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2197">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2198">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2199">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2200">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2201">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2202">l</span><span class="MJXp-msubsup" id="MJXp-Span-2203"><span class="MJXp-mrow" id="MJXp-Span-2204" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2205">J</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2206" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2207">r</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2208"><span class="MJXp-mo" id="MJXp-Span-2209" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2210" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2211">‚àí</span><span class="MJXp-mn" id="MJXp-Span-2212">1</span></span></span><span class="MJXp-mtext" id="MJXp-Span-2213">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2214">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2215">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2216">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2217">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2218">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2219">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2220">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2221">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2222">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2223">l</span><span class="MJXp-msubsup" id="MJXp-Span-2224"><span class="MJXp-mrow" id="MJXp-Span-2225" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2226">J</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mtext" id="MJXp-Span-2229">&nbsp;</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2227"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2228">r</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2230">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2231">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2232">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2233">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2234">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2235">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2236">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2237">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2238">r</span><span class="MJXp-mo" id="MJXp-Span-2239" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-2240">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2241">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2242">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2243">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2244">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2245">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2246">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2247">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2248">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2249">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2250">l</span><span class="MJXp-mrow" id="MJXp-Span-2251"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2252">p</span></span><span class="MJXp-mo" id="MJXp-Span-2253" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-112"> \ boldsymbol {p} \ rightarrow \ boldsymbol {p} - [\ boldsymbol {J} _ {r} ^ \ intercal \ boldsymbol {J} _ {r}] ^ {- 1} \ boldsymbol {J} _ {r } ^ \ intercal r (\ boldsymbol {p}) </script></p><br><p>  A grava√ß√£o na forma coincide completamente com a grava√ß√£o do m√©todo de Newton.  Somente em vez da matriz Hessiana √© usada <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2254"><span class="MJXp-mtext" id="MJXp-Span-2255">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2256">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2257">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2258">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2259">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2260">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2261">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2262">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2263">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2264">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2265">l</span><span class="MJXp-msubsup" id="MJXp-Span-2266"><span class="MJXp-mrow" id="MJXp-Span-2267" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2268">J</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mtext" id="MJXp-Span-2271">&nbsp;</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2270">r</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2272">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2273">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2274">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2275">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2276">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2277">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2278">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2279">l</span><span class="MJXp-mtext" id="MJXp-Span-2280">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2281">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2282">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2283">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2284">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2285">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2286">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2287">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2288">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2289">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2290">l</span><span class="MJXp-msubsup" id="MJXp-Span-2291"><span class="MJXp-mrow" id="MJXp-Span-2292" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2293">J</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2294" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2295">r</span></span></span></span></span><script type="math/tex" id="MathJax-Element-113"> \ boldsymbol {J} _ {r} ^ \ intercal \ boldsymbol {J} _ {r} </script>  em vez do gradiente <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2296"><span class="MJXp-mtext" id="MJXp-Span-2297">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2298">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2299">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2300">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2301">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2302">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2303">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2304">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2305">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2306">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2307">l</span><span class="MJXp-msubsup" id="MJXp-Span-2308"><span class="MJXp-mrow" id="MJXp-Span-2309" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2310">J</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mtext" id="MJXp-Span-2313">&nbsp;</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2311"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2312">r</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2314">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2315">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2316">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2317">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2318">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2319">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2320">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2321">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2322">r</span><span class="MJXp-mo" id="MJXp-Span-2323" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-2324">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2325">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2326">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2327">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2328">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2329">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2330">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2331">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2332">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2333">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2334">l</span><span class="MJXp-mrow" id="MJXp-Span-2335"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2336">p</span></span><span class="MJXp-mo" id="MJXp-Span-2337" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-114"> \ boldsymbol {J} _ {r} ^ \ intercal r (\ boldsymbol {p}) </script>  .  A seguir, veremos por que essa aproxima√ß√£o pode ser usada.  Enquanto isso, vamos prosseguir com a implementa√ß√£o no TensorFlow: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  ,  TensorFlow     , #   ,        #  .  ,   : # 1)       tf.unstack(r) # 2)      tf.gradients(r_i, p) # 3)       tf.stack #      ,     #       j = tf.stack([tf.gradients(r_i, p)[0] for r_i in tf.unstack(r)]) jT = tf.transpose(j) #     - r_col = tf.expand_dims(r, -1) #      hess_approx = tf.matmul(jT, j) grad_approx = tf.matmul(jT, r_col) # ,      dp = tf.matmul(tf.linalg.inv(hess_approx), grad_approx) #  -  - dp = tf.squeeze(dp) #  p  dp    ng = opt.apply_gradients([(dp, p)]) #   ,    40000  session.run(tf.global_variables_initializer()) train(1e-10, 40000, loss, ng, feed_dict)</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, current loss: 3868.2291666666665 step: 2, current loss: 14.653025157673625 step: 4, current loss: 4.3918079172783016e-07 ENDED ON STEP: 4, FINAL LOSS: 3.374364957618591e-17 PARAMETERS: [2.5 2.5]</code> </pre> <br><p>  Suficiente 4 etapas.  Menor que para o m√©todo de Newton. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/iq/ns/5l/iqns5lhcfqamjgy_f6isppnaxo4.jpeg"></div><br><p>  Como pode ser visto no c√≥digo, a fun√ß√£o de perda n√£o √© usada na otimiza√ß√£o, apenas nos crit√©rios de parada e registro.  Como o algoritmo de otimiza√ß√£o sabe qual fun√ß√£o minimizar?  A resposta √© surpreendente: de jeito nenhum!  Gauss-Newton minimiza apenas o <em>erro quadr√°tico m√©dio</em> . </p><br><h4 id="zakrepim-matematicheskuyu-chast-stati">  Corrija a parte matem√°tica do artigo </h4><br><p>  Repetimos toda a matem√°tica que precis√°vamos.  Vamos corrigi-lo um pouco para focar ainda mais a programa√ß√£o e o TensorFlow.  Voc√™ pode precisar de um l√°pis para rastrear a sequ√™ncia de a√ß√µes matem√°ticas. </p><br><p>  Existe um modelo <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2338"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2339">y</span><span class="MJXp-mo" id="MJXp-Span-2340" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2341">f</span><span class="MJXp-mo" id="MJXp-Span-2342" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2343">x</span><span class="MJXp-mo" id="MJXp-Span-2344" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2345">p</span><span class="MJXp-mo" id="MJXp-Span-2346" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-115"> y = f (x, p) </script>  onde <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2347"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2348">x</span></span></span><script type="math/tex" id="MathJax-Element-116"> x </script>  - vetor <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2349"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2350">p</span></span></span><script type="math/tex" id="MathJax-Element-117"> p </script>  - vetor de par√¢metros de dimens√£o <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2351"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2352">n</span></span></span><script type="math/tex" id="MathJax-Element-118"> n </script>  e <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2353"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2354">y</span></span></span><script type="math/tex" id="MathJax-Element-119"> y </script>  - escalar.  Das experi√™ncias recebidas <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2355"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2356">m</span></span></span><script type="math/tex" id="MathJax-Element-120"> m </script>  pontos <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2357"><span class="MJXp-mo" id="MJXp-Span-2358" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2359"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2360" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2361" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2362">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2363" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2364"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2365" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2366" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2367">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2368" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2369" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2370" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2371" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2372" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2373" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2374" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2375"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2376" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2377" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2378">m</span></span></span><span class="MJXp-mo" id="MJXp-Span-2379" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2380"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2381" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2382" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2383">m</span></span></span><span class="MJXp-mo" id="MJXp-Span-2384" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-121"> (x_ {1}, y_ {1}), ..., (x_ {m}, y_ {m}) </script>  ( <em>pares de dados</em> ).  A fun√ß√£o residual do vetor depende apenas do vetor de par√¢metro: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2385"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2386">r</span><span class="MJXp-mo" id="MJXp-Span-2387" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2388">p</span><span class="MJXp-mo" id="MJXp-Span-2389" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2390" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2391" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2392"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2393" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2394" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2395">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2396" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2397">p</span><span class="MJXp-mo" id="MJXp-Span-2398" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2399" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2400" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2401" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2402" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-msubsup" id="MJXp-Span-2403"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2404" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2405" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2406">m</span></span></span><span class="MJXp-mo" id="MJXp-Span-2407" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2408">p</span><span class="MJXp-mo" id="MJXp-Span-2409" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2410" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-122"> r (p) = (r_ {1} (p), ... r_ {m} (p)) </script>  onde <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2411"><span class="MJXp-msubsup" id="MJXp-Span-2412"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2413" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2414" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2415">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2416" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2417">p</span><span class="MJXp-mo" id="MJXp-Span-2418" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2419" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2420"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2421" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2422" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2423">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2424" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-2425">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2426">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2427">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2428">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2429">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2430">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2431">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2432">t</span><span class="MJXp-mrow" id="MJXp-Span-2433"><span class="MJXp-msubsup" id="MJXp-Span-2434"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2435" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2436" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2437">k</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2438" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2439"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2440" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2441" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2442">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2443" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2444">f</span><span class="MJXp-mo" id="MJXp-Span-2445" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2447" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2448" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2449">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2450" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2451">p</span><span class="MJXp-mo" id="MJXp-Span-2452" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-123"> r_ {k} (p) = y_ {k} - \ widehat {y_ {k}} = y_ {k} - f (x_ {k}, p) </script>  .   ,       <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2453"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2454">p</span></span></span><script type="math/tex" id="MathJax-Element-124">p</script> ,      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2455"><span class="MJXp-msubsup" id="MJXp-Span-2456"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2457" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2458" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2459">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2460" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2461"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2462" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2463" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2464">k</span></span></span></span></span><script type="math/tex" id="MathJax-Element-125">x_{k}, y_{k}</script>  ?   ,  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2465"><span class="MJXp-msubsup" id="MJXp-Span-2466"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2467" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2468" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2469">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2470" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2471"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2472" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2473" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2474">k</span></span></span></span></span><script type="math/tex" id="MathJax-Element-126">x_{k}, y_{k}</script>      ,      . </p><br><p>       <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2475"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2476">p</span></span></span><script type="math/tex" id="MathJax-Element-127">p</script> ,  <em>  </em> ( <em>sum of squared error</em> ‚Äî <em>sse</em>  <em>residual sum-of-squares</em> ‚Äî <em>rss</em> )  .    <em>mse</em>    <em>sse</em> ,       <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2478">m</span></span></span><script type="math/tex" id="MathJax-Element-128"> m </script>  .             .     : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2479"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2480">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2481">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2482">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2483">s</span><span class="MJXp-mo" id="MJXp-Span-2484" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2485">p</span><span class="MJXp-mo" id="MJXp-Span-2486" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2487" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2488"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2489" style="margin-right: 0.05em;">r</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-2492">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2490"><span class="MJXp-mn" id="MJXp-Span-2491">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2493" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2494">p</span><span class="MJXp-mo" id="MJXp-Span-2495" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2496" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-2497" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span><span class="MJXp-mo" id="MJXp-Span-2498" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2499"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2500" style="margin-right: 0.05em;">r</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-2503">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2502">m</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2504" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2505">p</span><span class="MJXp-mo" id="MJXp-Span-2506" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2507" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-2508"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2514" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2515">m</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-2509" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2510" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2511">k</span><span class="MJXp-mo" id="MJXp-Span-2512">=</span><span class="MJXp-mn" id="MJXp-Span-2513">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2516"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2517" style="margin-right: 0.05em;">r</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-2520">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2518"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2519">k</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2521" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2522">p</span><span class="MJXp-mo" id="MJXp-Span-2523" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-129">loss(p) = r_{1}^2(p) + \cdots + r_{m}^2(p) = \sum_{k=1}^{m} r_{k}^2(p)</script></p><br><p>        <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2524"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2525">p</span></span></span><script type="math/tex" id="MathJax-Element-130">p</script>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2526"><span class="MJXp-mo" id="MJXp-Span-2527" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2528">p</span><span class="MJXp-mo" id="MJXp-Span-2529" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-131">(p)</script>  . </p><br><p>    ,        .  ‚Äî    .   ‚Äî   ,     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2530"><span class="MJXp-msubsup" id="MJXp-Span-2531"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2532" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2533" style="vertical-align: 0.5em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-132">r^2</script>  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2534"><span class="MJXp-mn" id="MJXp-Span-2535">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2536">r</span><span class="MJXp-mfrac" id="MJXp-Span-2537" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2538">‚àÇ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2539">r</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2540">‚àÇ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2541">p</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-133">2r \frac{\partial r}{\partial p}</script>  .   : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2542"><span class="MJXp-msubsup" id="MJXp-Span-2543"><span class="MJXp-mi" id="MJXp-Span-2544" style="margin-right: 0.05em;">‚àá</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2545" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2546">p</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2547">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2548">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2549">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2550">s</span><span class="MJXp-mo" id="MJXp-Span-2551" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2552" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-munderover" id="MJXp-Span-2553"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2559" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2560">m</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-2554" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2555" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2556">k</span><span class="MJXp-mo" id="MJXp-Span-2557">=</span><span class="MJXp-mn" id="MJXp-Span-2558">1</span></span></span></span><span class="MJXp-mn" id="MJXp-Span-2561">2</span><span class="MJXp-msubsup" id="MJXp-Span-2562"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2563" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2564" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2565">k</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-2566" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2567">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2568"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2569" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2570" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2571">k</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2572">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2573"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2574" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2575" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2576">1</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2577" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2578" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span><span class="MJXp-mo" id="MJXp-Span-2579" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-munderover" id="MJXp-Span-2580"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2586" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2587">m</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-2581" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2582" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2583">k</span><span class="MJXp-mo" id="MJXp-Span-2584">=</span><span class="MJXp-mn" id="MJXp-Span-2585">1</span></span></span></span><span class="MJXp-mn" id="MJXp-Span-2588">2</span><span class="MJXp-msubsup" id="MJXp-Span-2589"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2590" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2591" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2592">k</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-2593" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2594">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2595"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2596" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2597" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2598">k</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2599">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2600"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2601" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2602" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2603">n</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2604" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-134">\nabla_{p}loss = (\sum_{k=1}^{m}2r_{k}\frac{\partial r_{k}}{\partial p_{1}}, \cdots, \sum_{k=1}^{m}2r_{k}\frac{\partial r_{k}}{\partial p_{n}}) </script></p><br><p>        .      : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2605"><span class="MJXp-mo" id="MJXp-Span-2606" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2607">H</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2608">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2609">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2610">s</span><span class="MJXp-msubsup" id="MJXp-Span-2611"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2612" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2613" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2614">p</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2615"><span class="MJXp-mo" id="MJXp-Span-2616" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2617" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2618">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2619">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-2620" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2621" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-2622"><span class="MJXp-mi" id="MJXp-Span-2623" style="margin-right: 0.05em;">‚àÇ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2624" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2625">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2626">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2627">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2628">s</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2629">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2630"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2631" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2632" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2633">i</span></span></span><span class="MJXp-mi" id="MJXp-Span-2634">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2635"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2636" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2637" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2638">j</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2639" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-2640"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2646" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2647">m</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-2641" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2642" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2643">k</span><span class="MJXp-mo" id="MJXp-Span-2644">=</span><span class="MJXp-mn" id="MJXp-Span-2645">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2648" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2649">2</span><span class="MJXp-mfrac" id="MJXp-Span-2650" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2651">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2652"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2653" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2654" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2655">k</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2656">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2657"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2658" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2659" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2660">i</span></span></span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-2661" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2662">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2663"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2664" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2665" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2666">k</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2667">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2668"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2669" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2670" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2671">j</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2672" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2673">2</span><span class="MJXp-msubsup" id="MJXp-Span-2674"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2675" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2676" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2677">k</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-2678" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-2679"><span class="MJXp-mi" id="MJXp-Span-2680" style="margin-right: 0.05em;">‚àÇ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2681" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-2682"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2683" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2684" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2685">k</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2686">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2687"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2688" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2689" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2690">i</span></span></span><span class="MJXp-mi" id="MJXp-Span-2691">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2692"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2693" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2694" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2695">j</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2696" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-135">[\boldsymbol{H}loss_{p}]_{ij} = \frac{\partial^2 loss}{\partial p_{i} \partial p_{j}} = \sum_{k=1}^{m}(2\frac{\partial r_{k}}{\partial p_{i}}\frac{\partial r_{k}}{\partial p_{j}} + 2r_{k}\frac{\partial^2 r_{k}}{\partial p_{i}\partial p_{j}})</script></p><br><p>    .        ,     ,    <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2697"><span class="MJXp-msup" id="MJXp-Span-2698"><span class="MJXp-mrow" id="MJXp-Span-2699" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-2700" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2701">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2702">v</span><span class="MJXp-mo" id="MJXp-Span-2703" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2704" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-2705" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msup" id="MJXp-Span-2706"><span class="MJXp-mrow" id="MJXp-Span-2707" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2708">u</span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2709" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2710">v</span><span class="MJXp-mo" id="MJXp-Span-2711" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2712">u</span><span class="MJXp-msup" id="MJXp-Span-2713"><span class="MJXp-mrow" id="MJXp-Span-2714" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2715">v</span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2716" style="vertical-align: 0.5em;">‚Ä≤</span></span></span></span><script type="math/tex" id="MathJax-Element-136">{(uv)}'={u}'v+u{v}'</script>  . <br>  √ìtimo!     . </p><br><p> ,        ,       , ‚Äî  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2717"><span class="MJXp-mn" id="MJXp-Span-2718">2</span><span class="MJXp-msubsup" id="MJXp-Span-2719"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2720" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2721" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2722">k</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-2723" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-2724"><span class="MJXp-mi" id="MJXp-Span-2725" style="margin-right: 0.05em;">‚àÇ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2726" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-2727"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2728" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2729" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2730">k</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2731">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2732"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2733" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2734" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2735">i</span></span></span><span class="MJXp-mi" id="MJXp-Span-2736">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2737"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2738" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2739" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2740">j</span></span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-137">2r_{k}\frac{\partial^2 r_{k}}{\partial p_{i}\partial p_{j}}</script>  .    ,   ,   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2741"><span class="MJXp-msubsup" id="MJXp-Span-2742"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2743" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2744" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2745">k</span></span></span></span></span><script type="math/tex" id="MathJax-Element-138">r_{k}</script> ,     .          ‚Äî     .   ,    ?    -. </p><br><p>     : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2746"><span class="MJXp-msubsup" id="MJXp-Span-2747"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2748" style="margin-right: 0.05em;">J</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2749" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2750">r</span></span></span><span class="MJXp-mo" id="MJXp-Span-2751" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-2752"><span class="MJXp-mo" id="MJXp-Span-2753" style="margin-left: 0em; margin-right: 0em; vertical-align: -2.183em;"><span class="MJXp-right MJXp-scale2" style="font-size: 9.733em; margin-left: -0.25em;">(</span></span><span class="MJXp-mtable" id="MJXp-Span-2754"><span><span class="MJXp-mtr" id="MJXp-Span-2755" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2756" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-2757" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2758">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2759"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2760" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2761" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2762">1</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2763">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2764"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2765" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2766" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2767">1</span></span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-2768" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2769" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-2770" style="padding-left: 1em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-2771" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2772">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2773"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2774" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2775" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2776">1</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2777">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2778"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2779" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2780" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2781">n</span></span></span></span></span></span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-2782" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2783" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2784" style="margin-left: 0.333em; margin-right: 0.333em;">‚ãÆ</span></span><span class="MJXp-mtd" id="MJXp-Span-2785" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2786" style="margin-left: 0.333em; margin-right: 0.333em;">‚ã±</span></span><span class="MJXp-mtd" id="MJXp-Span-2787" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2788" style="margin-left: 0.333em; margin-right: 0.333em;">‚ãÆ</span></span></span><span class="MJXp-mtr" id="MJXp-Span-2789" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2790" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-2791" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2792">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2793"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2794" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2795" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2796">m</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2797">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2798"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2799" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2800" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2801">1</span></span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-2802" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2803" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-2804" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-2805" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2806">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2807"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2808" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2809" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2810">m</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2811">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2812"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2813" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2814" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2815">n</span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2816" style="margin-left: 0em; margin-right: 0em; vertical-align: -2.183em;"><span class="MJXp-right MJXp-scale2" style="font-size: 9.733em; margin-left: -0.25em;">)</span></span></span></span></span><script type="math/tex;mode=display" id="MathJax-Element-139">\boldsymbol{J}_{r} = \begin{pmatrix} \frac{\partial r_{1}}{\partial p_{1}} & \cdots & \frac{\partial r_{1}}{\partial p_{n}}\\ \vdots & \ddots & \vdots \\ \frac{\partial r_{m}}{\partial p_{1}} & \cdots & \frac{\partial p_{m}}{\partial p_{n}} \end{pmatrix}</script></p><br><p> ,    ,     .  Note que: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2817"><span class="MJXp-mn" id="MJXp-Span-2818">2</span><span class="MJXp-msubsup" id="MJXp-Span-2819"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2820">J</span><span class="MJXp-mrow" id="MJXp-Span-2821"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2822">r</span></span><span class="MJXp-mo" id="MJXp-Span-2823">‚ä∫</span></span></span></span><script type="math/tex;mode=display">2\boldsymbol{J}_{r}^\intercal\boldsymbol{J}_{r} \approx \boldsymbol{H}loss_{p}</script></p><br><p>   ""     .         (   ).    ,   ‚Äî        <math></math><script type="math/tex">2r_{k}\frac{\partial^2 r_{k}}{\partial p_{i}\partial p_{j}}</script> ,     . <br>     (    ): </p><br><p></p><p><math></math><script type="math/tex;mode=display">2\boldsymbol{J}_{r}^\intercal r = \nabla_{p}loss</script></p><br><p>  ,    ,   - ‚Äî          ,       <em>mse</em> . </p><br><h4 id="pereformuliruem-i-uslozhnim-zadachu">     </h4><br><p>      .    ,   ,   .  <math></math><script type="math/tex"> m </script>  <math></math><script type="math/tex">(x_{1}, y_{1}), ..., (x_{m}, y_{m})</script> ,    <math></math><script type="math/tex">y = rosenbrock(x, p)</script>  .          <math></math><script type="math/tex">p</script> ,      . </p><br><p>   ,     : " <em>       .  - !</em> ".  ,      ,     ,        ( <em>supervised learning</em> ). ,    .     :  ( <em>training set</em> ) ‚Äî   ;   ‚Äî      ( <em>prediction model</em> )    ;   ‚Äî          ,    . </p><br><p>     <em> </em> ( <em>multi-layer perceptron neural network</em>  <em>mlp</em> ).  ,      ,       : </p><br><ul><li> <em> </em> ( <em>starting values</em> ) .     Xavier'a,       . </li><li> <em></em> ( <em>overfitting</em> ).   ‚Äî  .     ,    .    ‚Äî   . </li><li> <em>  </em> ( <em>scaling of the input</em> ).   ,      . </li></ul><br><p>     9 .     500: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    def get_random_rosenbrock_data_points(m): result = np.zeros((m, 3)) result[:, 0] = np.random.uniform(-2, 2, m) result[:, 1] = np.random.uniform(-2, 2, m) result[:, 2] = rosenbrock(result[:, 0], result[:, 1], 2.5, 2.5) return result m = 500 data_points = get_random_rosenbrock_data_points(m) # overfitting   ,      validation_data_points = get_random_rosenbrock_data_points(m)</span></span></code> </pre> <br><p>    500 .   ‚Äî         ( <em>learner</em> ),     ( <em>outcome measurement</em> )   ( <em>features</em> )     . </p><br><h4 id="realizuem-odnosloynyy-perceptron">    </h4><br><p>          ( <em>network diagram</em> ).        MatLab: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/np/nt/xk/npntxk7brhnpkk7p5v1p4bjur-a.png"></div><br><p>        ( <em>input</em> ).      <math></math><script type="math/tex">W</script> ( <em>weights</em> )  2x10,      <math></math><script type="math/tex">b</script> ( <em>bias</em> )  10,       ( <em>activation</em> ).    ()   ( <em>hidden layer</em> )  10 .         ,   ,         ( <em>output</em> ). </p><br><p>   ,   ,  (  <math></math><script type="math/tex">tanh</script>  ): </p><br><p></p><p><math></math><script type="math/tex;mode=display">\begin{matrix} h_{1} = tanh(xW_{1} + b_{1})\\ \widehat{y} = h_{1}W_{2} + b_{2} \end{matrix} </script></p><br><p>  : </p><br><p></p><p><math></math><script type="math/tex;mode=display">h_1 = tanh(\begin{bmatrix} x_1 & x_2 \end{bmatrix}\begin{bmatrix} w^{(1)}_{1,1} & \cdots& w^{(1)}_{1,10} \\ w^{(1)}_{2,1} &\cdots& w^{(1)}_{2,10} \end{bmatrix} + \begin{bmatrix} b^{(1)}_1 & \cdots & b^{(1)}_{10} \end{bmatrix}) \\ \widehat{y} = \begin{bmatrix}h^{(1)}_1 & \cdots & h^{(1)}_{10}\end{bmatrix} \begin{bmatrix} w^{(2)}_{1,1} \\ \vdots \\ w^{(2)}_{1,10} \\ \end{bmatrix} + b_2 </script></p><br><p>    .  <math></math><script type="math/tex">W_{1}</script>        ""   <math></math><script type="math/tex">h_{1}</script> ,       - <math></math><script type="math/tex">W_{2}</script>  .  41 .       ,    . </p><br><p>       <math></math><script type="math/tex">m \times 2</script> ,          .   - <math></math><script type="math/tex">\widehat{y}</script>  de <math></math><script type="math/tex"> m </script> : </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#     10 "" n_hidden = 10 #      Xavier'a initializer = tf.contrib.layers.xavier_initializer() #    x = tf.placeholder(tf.float64, shape=[m, 2]) y = tf.placeholder(tf.float64, shape=[m, 1]) #         W1 = tf.Variable(initializer([2, n_hidden], dtype=tf.float64)) b1 = tf.Variable(initializer([1, n_hidden], dtype=tf.float64)) #   ,  tanh   h1 = tf.nn.tanh(tf.matmul(x, W1) + b1) #        W2 = tf.Variable(initializer([n_hidden, 1], dtype=tf.float64)) b2 = tf.Variable(initializer([1], dtype=tf.float64)) #   y_hat = tf.matmul(h1, W2) + b2 #  r = y - y_hat #   mse     loss = tf.reduce_mean(tf.square(r)) #      placeholder feed_dict = {x: data_points[:,0:2], y: data_points[:,2:3]} validation_feed_dict = {x: validation_data_points[:,0:2], y: validation_data_points[:,2:3]}</span></span></code> </pre> <br><h4 id="obuchim-neyroset-metodom-adam">    Adam </h4><br><p>     Adam         <math></math><script type="math/tex">rosenbrock</script>  .   mse     : </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    adm = tf.train.AdamOptimizer(1e-2).minimize(loss) session.run(tf.global_variables_initializer()) #   ,    40000  train(1e-10, 40000, loss, adm, feed_dict) print('VALIDATION LOSS: '+str(session.run(loss, validation_feed_dict)))</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, current loss: 671.4242576535694 [...] ENDED ON STEP: 40000, FINAL LOSS: 0.22862158574440725 VALIDATION LOSS: 0.29000289644978866</code> </pre> <br><p>       .      :   ,  ,   . </p><br><h4 id="vychislim-matricu-yakobi-dlya-neyronnoy-seti">       </h4><br><p>   <math></math><script type="math/tex">rosenbrock</script>     2  .    : </p><br><ul><li> .   9 ,  500.        . </li><li> .   -  <math></math><script type="math/tex">p</script> ,        . </li></ul><br><p>    : </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#      y   x def jacobian(y, x): loop_vars = [ tf.constant(0, tf.int32), tf.TensorArray(tf.float64, size=m), ] #  -   #      _, jacobian = tf.while_loop( lambda i, _: i &lt; m, #           #   (-),   x     lambda i, res: (i+1, res.write(i, tf.reshape(tf.gradients(y[i], x), (-1,)))), loop_vars) #       return jacobian.stack() #       r_flat = tf.squeeze(r) #        #       parms = [W1, b1, W2, b2] parms_sizes = [tf.size(p) for p in parms] j = tf.concat([jacobian(r_flat, p) for p in parms], 1) jT = tf.transpose(j) #           hess_approx = tf.matmul(jT, j) grad_approx = tf.matmul(jT, r)</span></span></code> </pre> <br><p>   <math></math><script type="math/tex">\boldsymbol{J}r_{p}</script>       .       ,   4  <math></math><script type="math/tex">W_1, b_1, W_2, b_2</script>  .  4  <math></math><script type="math/tex">\boldsymbol{J}r_{W_1}, \boldsymbol{J}r_{b_1}, \boldsymbol{J}r_{W_2}, \boldsymbol{J}r_{b_2}</script>      <em>tf.concat</em> . </p><br><p>         . <em>tf.while_loop</em>    ,      <math></math><script type="math/tex">r_i</script> ,        ,       <em>stack</em> . </p><br><p>   <math></math><script type="math/tex">r_i</script>   <math></math><script type="math/tex">W_1</script>  : <math></math><script type="math/tex">\begin{bmatrix} \frac{\partial r_i}{\partial w^{(1)}_{1,1}} & \cdots& \frac{\partial r_i}{\partial w^{(1)}_{1,10}} \\ \frac{\partial r_i}{\partial w^{(1)}_{2,1}} & \cdots& \frac{\partial r_i}{\partial w^{(1)}_{2,10}} \end{bmatrix}</script>  .  <em>tf.reshape</em>   <em>(-1,)</em>     <math></math><script type="math/tex">\begin{bmatrix} \frac{\partial r_i}{\partial w^{(1)}_{1,1}} & \cdots& \frac{\partial r_i}{\partial w^{(1)}_{1,10}} & \frac{\partial r_i}{\partial w^{(1)}_{2,1}} & \cdots& \frac{\partial r_i}{\partial w^{(1)}_{2,10}} \end{bmatrix}</script>  . </p><br><p>        .           -     .    ‚Äî TensorFlow             .   ‚Äî  -    -     <math></math><script type="math/tex">W_1, b_1, W_2, b_2</script>  .        -.     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Levenberg-Marquardt Jupyter Notebook</a>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">rosenbrock_train.py</a> .       ,   TensorFlow       .  - ,      ( ) , , . </p><br><h4 id="obuchim-neyroset-metodom-gaussa-nyutona">    - </h4><br><p>  <em>hess_approx</em>  <em>grad_approx</em>       -.      <math></math><script type="math/tex">rosenbrock</script>   ,               .   : </p><br><ol><li>    : <math></math><script type="math/tex">\Delta \boldsymbol{p} = \begin{bmatrix}\Delta w^{(1)}_{1,1} & \cdots & \Delta w^{(1)}_{2,10} & \Delta b^{(1)}_1 & \cdots & \Delta b^{(1)}_{10} & \Delta w^{(2)}_{1,1} & \cdots & \Delta w^{(2)}_{1,10} & \Delta b_2\end{bmatrix}</script></li><li>        : <br><math></math><script type="math/tex">\Delta W_{1} = \begin{bmatrix}\Delta w^{(1)}_{1,1} & \cdots & \Delta w^{(1)}_{2,10} \end{bmatrix}</script>  , <math></math><script type="math/tex">\Delta b_{1} = \begin{bmatrix} \Delta b^{(1)}_1 & \cdots & \Delta b^{(1)}_{10} \end{bmatrix}</script>  , <math></math><script type="math/tex">\Delta W_{2} = \begin{bmatrix} \Delta w^{(2)}_{1,1} & \cdots & \Delta w^{(2)}_{1,10} \end{bmatrix}</script>  , <math></math><script type="math/tex">\Delta b_{2} = \begin{bmatrix} \Delta b_2\end{bmatrix}</script>  . </li><li>   ,      : <br><math></math><script type="math/tex">\Delta W_{1} = \begin{bmatrix} \Delta w^{(1)}_{1,1} & \cdots & \Delta w^{(1)}_{1,10} \\ \Delta w^{(1)}_{2,1} &\cdots & \Delta w^{(1)}_{2,10} \end{bmatrix}</script>  , <math></math><script type="math/tex">\Delta W_{2} = \begin{bmatrix} \Delta w^{(2)}_{1,1} \\ \vdots \\ \Delta w^{(2)}_{1,10} \\ \end{bmatrix}</script></li><li>  . </li></ol><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># 1.     dp_flat = tf.matmul(tf.linalg.inv(hess_approx), grad_approx) # 2.     dps = tf.split(dp_flat, parms_sizes, 0) # 3.     for i in range(len(dps)): dps[i] = tf.reshape(dps[i], parms[i].shape) # 4.  :       gn = opt.apply_gradients(zip(dps, parms)) #   session.run(tf.global_variables_initializer()) train(1e-10, 100, loss, gn, feed_dict)</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, current loss: 548.8468777701685 step: 2, current loss: 49648941.340197295 InvalidArgumentError: Input is not invertible.</code> </pre> <br><p> -   .      ,       .  -  ,      . </p><br><p>      ,        . </p><br><h4 id="obuchim-neyroset-metodom-levenberga-markvadta">    - </h4><br><p>     .          Matlab <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">   trainlm</a> .       .     MathWorks. </p><br><p>    - : <math></math><script type="math/tex">\boldsymbol{p} \rightarrow \boldsymbol{p}-[\boldsymbol{J}_{r}^\intercal\boldsymbol{J}_{r}]^{-1}\boldsymbol{J}_{r}^\intercal r(\boldsymbol{p})</script>  .  -    : </p><br><p></p><p><math></math><script type="math/tex;mode=display">\boldsymbol{p} \rightarrow \boldsymbol{p}-[\boldsymbol{J}_{r}^\intercal\boldsymbol{J}_{r}+\mu \boldsymbol{I}]^{-1}\boldsymbol{J}_{r}^\intercal r(\boldsymbol{p})</script></p><br><p>   <math></math><script type="math/tex"> \ mu </script>      <math></math><script type="math/tex"> I </script>  <math></math><script type="math/tex"> n </script> (  ).   <math></math><script type="math/tex"> \ mu </script>  ,       -.   ,    .  ,  LM       -. </p><br><p>        : </p><br><pre> <code class="python hljs">mu = tf.placeholder(tf.float64, shape=[<span class="hljs-number"><span class="hljs-number">1</span></span>]) n = tf.add_n(parms_sizes) I = tf.eye(n, dtype=tf.float64) <span class="hljs-comment"><span class="hljs-comment"># 1.     dp_flat = tf.matmul(tf.linalg.inv(hess_approx + tf.multiply(mu, I)), grad_approx) # 2.     dps = tf.split(dp_flat, parms_sizes, 0) # 3.     for i in range(len(dps)): dps[i] = tf.reshape(dps[i], parms[i].shape) # 4.  :       lm = opt.apply_gradients(zip(dps, parms))</span></span></code> </pre> <br><p>      <math></math><script type="math/tex"> \ mu </script>  ?  LM     -   .   ,     . ,      <math></math><script type="math/tex"> \ mu </script> ,     .     ‚Äî   ,     <em>mse</em> .       ,   : </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#       store = [tf.Variable(tf.zeros(p.shape, dtype=tf.float64)) for p in parms] #  TensorFlow       save_parms = [tf.assign(s, p) for s, p in zip(store, parms)] restore_parms = [tf.assign(p, s) for s, p in zip(store, parms)] #   mu    3. feed_dict[mu] = np.array([3.]) step = 0 session.run(tf.global_variables_initializer()) #    mse current_loss = session.run(loss, feed_dict) #    100   while current_loss &gt; 1e-10 and step &lt; 100: step += 1 #  1, 2, 4...   if math.log(step, 2).is_integer(): print(f'step: {step}, mu: {feed_dict[mu][0]} current loss: {current_loss}') #    session.run(save_parms) # ,     mse while True: #    session.run(lm, feed_dict) new_loss = session.run(loss, feed_dict) if new_loss &gt; current_loss: #  -  mu  10     feed_dict[mu] *= 10 session.run(restore_parms) else: #  -  mu  10     feed_dict[mu] /= 10 current_loss = new_loss break print(f'ENDED ON STEP: {step}, FINAL LOSS: {current_loss}') print('VALIDATION LOSS: '+str(session.run(loss, validation_feed_dict)))</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, mu: 3.0 current loss: 692.6211687622557 [...] ENDED ON STEP: 100, FINAL LOSS: 0.012346989371823602 VALIDATION LOSS: 0.01859463694102034</code> </pre> <br><p>  100  LM  mse    10  ,   40  . </p><br><p>       .   ,         .  ,        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">rosenbrock_train.py</a> . </p><br><h4 id="poznakomimsya-s-mnogomernym-variantom-funkcii-rozenbroka">       </h4><br><p>    2D   .         .      .          ,     " " ( <em>curse of dimentionality</em> , Bellman, 1961).     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> .      </a> . </p><br><p>      : </p><br><p></p><p><math></math><script type="math/tex;mode=display">f(\boldsymbol{x}) = \sum_{i=1}^{N-1}\left [ 100(x_{i+1} - x_{i}^2)^2 + (1-x_{i})^2 \right ], \boldsymbol{x}=[x_1 \cdots x_{N}]\in \mathbb{R}^N</script></p><br><p>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">rosenbrock_train.py</a>   <em>get_rand_rosenbrock_points</em> . </p><br><h4 id="polnocenno-proverim-algoritm-levenberga-markvadta">    - </h4><br><p>     - : " <em>!    4 ,     300!</em> ".   ,   ( <em></em> )    -. , ,  .  -   .  .  :       ?  ,          .   .          ,      - : </p><br><ol><li> 10 000  6D  . </li><li>    3   12, 10, 8 (311 ). </li><li>   . </li><li> 3.5    . </li></ol><br><p>              .     -   2 .      LM       .      20 . </p><br><img src="https://habrastorage.org/webt/nl/b1/-u/nlb1-ut2rftvgoleqzsl4o1e2ze.jpeg"><br><p>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">rosenbrock_train.py</a> .   .         ,      . </p><br><h4 id="zaklyuchenie">  Conclus√£o </h4><br><p>  ,        .  " ",    ,     .      ,      .   ,    273 .  - ,        . </p><br><p>   ,   : </p><br><ol><li>    . </li><li>    (   )  -: <br> [1] Petros Drineas, Ravi Kannan, and Michael W. Mahoney. 2006. Fast Monte Carlo Algorithms for Matrices I: Approximating Matrix Multiplication. SIAM J. Comput. 36, 1 (July 2006), 132-157. DOI= <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http://dx.doi.org/10.1137/S0097539704442684</a> <br> [2] Adelman, M., &amp; Silberstein, M. (2018). Faster Neural Network Training with Approximate Tensor Operations. CoRR, abs/1805.08079. </li></ol><br><p> ,  -     .      ,      .      "". </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt428183/">https://habr.com/ru/post/pt428183/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt428173/index.html">Prettier, ESLint, Husky, Lint-Staged e EditorConfig: Ferramentas para escrever c√≥digo organizado</a></li>
<li><a href="../pt428175/index.html">Implementa√ß√£o de √°rvore C de prefixo astuto</a></li>
<li><a href="../pt428177/index.html">Ent√£o, o que h√° de errado com a procura de emprego / trabalhadores em TI?</a></li>
<li><a href="../pt428179/index.html">Em um leil√£o japon√™s, um prot√≥tipo do Wii-Controller, desenvolvido para o GameCube</a></li>
<li><a href="../pt428181/index.html">M√°quina moral: impiedosa ou sem sentido?</a></li>
<li><a href="../pt428187/index.html">Como escrever uma extens√£o para o Shell do GNOME: Modo N√£o perturbe</a></li>
<li><a href="../pt428189/index.html">Quem √© um paladino?</a></li>
<li><a href="../pt428191/index.html">O que devemos organizar um hackathon ou Como conduzimos um hackathon interno</a></li>
<li><a href="../pt428193/index.html">Sobre fazer passeios</a></li>
<li><a href="../pt428197/index.html">Finan√ßas pessoais eficazes. N√≠vel 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>