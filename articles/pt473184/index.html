<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ôâÔ∏è üèÆ üé£ Docker + php-fpm + PhpStorm + Xdebug ü§µüèæ üë©‚Äçüë©‚Äçüë¶ üë´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="H√° pouco tempo, o l√≠der da equipe disse: pessoal, quero que todos tenham o mesmo ambiente de desenvolvimento para nossos projetos de combate + precisa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Docker + php-fpm + PhpStorm + Xdebug</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/473184/">  H√° pouco tempo, o l√≠der da equipe disse: pessoal, quero que todos tenham o mesmo ambiente de desenvolvimento para nossos projetos de combate + precisamos depurar tudo - aplicativos da web e solicita√ß√µes de API e scripts de console para economizar nossos nervos e tempo.  E nos ajude com esta janela de encaixe. <br><br>  Mal disse o que fez.  Detalhes sob o corte. <br><a name="habracut"></a><br>  Existem muitos manuais de conteineriza√ß√£o na rede, mas como aplic√°-los ao desenvolvimento real de combate?  Para cada projeto, escreva seu pr√≥prio docker-compose.yml?  Mas todos os nossos projetos se comunicam atrav√©s da API, todos eles usam a pilha de tecnologia padr√£o: nginx + php-fpm + mysql. <br><br>  Portanto, vamos esclarecer as condi√ß√µes do problema: <br><br><ol><li>  Trabalhamos em uma empresa, em equipe, acompanhamos v√°rios projetos de combate.  Todos n√≥s trabalhamos com o Ubuntu + PhpStorm </li><li>  Para desenvolvimento local, queremos usar a janela de encaixe, para ter o mesmo ambiente de desenvolvimento para cada membro da equipe e tamb√©m para que, quando um novo desenvolvedor chegar, ele possa implantar rapidamente um ambiente de trabalho. </li><li>  Queremos desenvolver com conforto, queremos estrear tudo: aplicativos da web, scripts de console e solicita√ß√µes de API. </li></ol><br>  Mais uma vez: queremos trazer <b>v√°rios</b> projetos de trabalho para a janela de encaixe. <br><br>  Em servidores de combate, o pacote nginx + php-fpm + mysql padr√£o √© usado.  E qual √© o problema? <br><br>  Implementamos exatamente o mesmo ambiente + Xdebug na m√°quina local, configuramos nossos projetos no PhpStorm e trabalhamos.  Para depura√ß√£o, ligue o "tube" no PhpStorm, tudo funciona imediatamente, tudo est√° bem. <br><br><img src="https://habrastorage.org/webt/4m/tv/4e/4mtv4efpe_tiqc8mnwskabrxoqu.png"><br><br>  Tudo isso √© verdade - tudo funciona imediatamente.  Mas, vamos tentar olhar sob o cap√¥ do nosso ambiente de trabalho. <br><br>  O Nginx + php-fpm se comunica atrav√©s do soquete, o xdebug escuta na porta 9000, o PhpStorm tamb√©m, por padr√£o, escuta na porta 9000 a depura√ß√£o e tudo parece estar bem.  E se tivermos v√°rios aplicativos abertos no PhpStorm, e a escuta telef√¥nica ("tubo)" estiver ativada para v√°rios aplicativos?  O que o PhpStorm far√°?  Ele come√ßar√° a jurar que uma nova conex√£o para o Xdebug foi detectada, voc√™ deseja ignor√°-la ou n√£o? <br><br>  Ou seja, com as configura√ß√µes padr√£o do PhpStorm, em um determinado momento, posso iniciar apenas um aplicativo.  Para todos os outros aplicativos abertos, a depura√ß√£o deve estar desativada.  Porra, mas √© inconveniente.  Quero ouvir todos os aplicativos para depura√ß√£o e, se houver um ponto de interrup√ß√£o em um deles, quero que o PhpStorm pare nesse aplicativo, na linha em que eu preciso. <br><br>  E o que √© necess√°rio para isso?  Mas voc√™ precisa que cada aplicativo inicie com suas pr√≥prias configura√ß√µes para o Xdebug.  Para que cada aplicativo ou√ßa sua porta, procure seu servidor e n√£o como se tiv√©ssemos tudo em comum, tudo de uma s√≥ vez. <br><br>  E para isso, h√° uma estivadora maravilhosa!  Podemos iniciar cada um de nossos aplicativos de combate em um cont√™iner separado, com base em uma imagem comum, por exemplo, php: 7.1-fpm.  Gra√ßas √† tecnologia docker, podemos isolar nossos aplicativos com o m√≠nimo de sobrecarga. <br><br>  Ok, vamos come√ßar nossos projetos de combate na janela de encaixe, executar cada projeto em um cont√™iner separado, configurar cada projeto no PhpStorm para depurar individualmente, tudo deve ficar bem. <br><br>  E, opa, o primeiro problema: os cont√™ineres na janela de encaixe s√£o executados como raiz e, localmente, trabalhamos, geralmente como um usu√°rio com uid 1000, gid 1000. Os aplicativos est√£o lutando, e dar a cada aplicativo 777 direitos sobre tudo n√£o √© uma op√ß√£o.  Nossas aplica√ß√µes est√£o sob o git, e se dermos os direitos 777 localmente, o git registrar√° tudo isso e o transferir√° para o servidor de batalha. <br><br>  Muletas, aqui est√° um exemplo de imagem php: 7.1-fpm que ser√° compilada. <br><br><h4>  Update </h4><br>  Como a comunidade corretamente apontou, n√£o h√° absolutamente nenhuma necessidade de se segurar. <br>  Por exemplo, 1novrovert <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">habrozer</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">no coment√°rio</a> <br><br><div class="spoiler">  <b class="spoiler_title">Exemplo inicial de imagem php: 7.1-fpm (uid e gid s√£o codificados)</b> <div class="spoiler_text"><pre><code class="php hljs">FROM php:<span class="hljs-number"><span class="hljs-number">7.1</span></span>-fpm RUN apt-get update &amp;&amp; apt-get install -y \ git \ curl \ wget \ libfreetype6-dev \ libjpeg62-turbo-dev \ libmcrypt-dev \ libpng-dev zlib1g-dev libicu-dev g++ libmagickwand-dev libxml2-dev \ &amp;&amp; docker-php-ext-configure intl \ &amp;&amp; docker-php-ext-install intl \ &amp;&amp; docker-php-ext-install mbstring zip xml gd mcrypt pdo_mysql \ &amp;&amp; docker-php-ext-configure gd --with-freetype-dir=/usr/<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>/ --with-jpeg-dir=/usr/<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>/ \ &amp;&amp; docker-php-ext-install -j$(nproc) gd \ &amp;&amp; pecl install imagick \ &amp;&amp; docker-php-ext-enable imagick \ &amp;&amp; pecl install xdebug \ &amp;&amp; docker-php-ext-enable xdebug ADD ./php.ini /usr/local/etc/php/php.ini RUN wget https:<span class="hljs-comment"><span class="hljs-comment">//getcomposer.org/installer -O - -q \ | php -- --install-dir=/bin --filename=composer --quiet RUN usermod -u 1000 www-data &amp;&amp; groupmod -g 1000 www-data WORKDIR /var/www USER 1000:1000 CMD ["php-fpm"]</span></span></code> </pre> <br></div></div><br><br>  Exemplo corrigido do Dockerfile <br><br><pre> <code class="bash hljs">FROM php:7.1-fpm ARG USER_ID ARG GROUP_ID RUN apt-get update &amp;&amp; apt-get install -y \ git \ curl \ wget \ libfreetype6-dev \ libjpeg62-turbo-dev \ libmcrypt-dev \ libpng-dev zlib1g-dev libicu-dev g++ libmagickwand-dev --no-install-recommends libxml2-dev \ &amp;&amp; docker-php-ext-configure intl \ &amp;&amp; docker-php-ext-install intl \ &amp;&amp; docker-php-ext-install mbstring zip xml gd mcrypt pdo_mysql \ &amp;&amp; pecl install imagick \ &amp;&amp; docker-php-ext-enable imagick \ &amp;&amp; pecl install xdebug-2.5.0 \ &amp;&amp; docker-php-ext-enable xdebug ADD ./php.ini /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/etc/php/php.ini RUN wget https://getcomposer.org/installer -O - -q \ | php -- --install-dir=/bin --filename=composer --quiet RUN usermod -u <span class="hljs-variable"><span class="hljs-variable">${USER_ID}</span></span> www-data &amp;&amp; groupmod -g <span class="hljs-variable"><span class="hljs-variable">${GROUP_ID}</span></span> www-data WORKDIR /var/www USER <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${USER_ID}</span></span></span><span class="hljs-string">:</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${GROUP_ID}</span></span></span><span class="hljs-string">"</span></span> CMD [<span class="hljs-string"><span class="hljs-string">"php-fpm"</span></span>]</code> </pre><br><br>  <s>Ao iniciar um cont√™iner a partir desta imagem, o usu√°rio www-data obt√©m uid = 1000, gid = 1000.</s>  <s>Normalmente, o primeiro usu√°rio criado no Linux possui esses direitos.</s>  <s>E, exatamente com esses direitos, nossos cont√™ineres php-fpm funcionar√£o.</s>  <s>Ficaria muito grato se algu√©m me dissesse como trabalhar sem muletas com direitos de acesso √† janela de encaixe.</s> <br><br>  Ao iniciar um cont√™iner a partir desta imagem, o usu√°rio www-data fica uid e gid, que ser√° transferido de fora. <br><br>  <b>Tamb√©m nos coment√°rios, o t√≥pico foi levantado</b> : por que alterar os direitos do usu√°rio www-data, por que os direitos padr√£o n√£o se adequam a 33. Apenas uma coisa: quando entrarmos no cont√™iner e criarmos, por exemplo, um arquivo de migra√ß√£o, n√£o seremos o propriet√°rio do arquivo na m√°quina host.  E cada vez ser√° necess√°rio executar algo como <pre> <code class="bash hljs"> sudo chown -R user:user ./</code> </pre> <br><br>  E o segundo pequeno problema: para que o Xdebug funcione corretamente, voc√™ deve registrar o endere√ßo IP correto para a m√°quina host.  Cada membro da equipe √© diferente.  127.0.0.1 n√£o rola.  E aqui o pr√≥prio estivador vem em nosso aux√≠lio.  Por exemplo, podemos configurar explicitamente a rede - 192.168.220.0/28.  E ent√£o nossa m√°quina sempre ter√° o endere√ßo 192.168.220.1.  Usaremos esse endere√ßo para configurar o PhpStorm, bem como para configurar outros aplicativos.  Por exemplo, ao trabalhar com o MySql. <br><br>  O pr√≥prio Docker-compose.yml, depois de considerar os coment√°rios, fica assim: <br><br><pre> <code class="python hljs">version: <span class="hljs-string"><span class="hljs-string">'3'</span></span> services: php71-first: build: context: ./images/php71 args: - USER_ID - GROUP_ID volumes: - ./www:/var/www - ./aliases/php71/bash.bashrc:/etc/bash.bashrc environment: XDEBUG_CONFIG: <span class="hljs-string"><span class="hljs-string">"remote_host=192.168.220.1 remote_enable=1 remote_autostart=off remote_port=9008"</span></span> PHP_IDE_CONFIG: <span class="hljs-string"><span class="hljs-string">"serverName=first"</span></span> networks: - test-network php71-two: build: context: ./images/php71 args: - USER_ID - GROUP_ID volumes: - ./www:/var/www - ./aliases/php71/bash.bashrc:/etc/bash.bashrc environment: XDEBUG_CONFIG: <span class="hljs-string"><span class="hljs-string">"remote_host=192.168.220.1 remote_enable=1 remote_autostart=off remote_port=9009"</span></span> PHP_IDE_CONFIG: <span class="hljs-string"><span class="hljs-string">"serverName=two"</span></span> networks: - test-network nginx-test: image: nginx volumes: - ./hosts:/etc/nginx/conf.d - ./www:/var/www - ./logs:/var/log/nginx ports: - <span class="hljs-string"><span class="hljs-string">"8080:80"</span></span> depends_on: - php71-first - php71-two networks: test-network: aliases: <span class="hljs-comment"><span class="hljs-comment">#         . ,    api - first.loc - two.loc # mysql: # image: mysql:5.7 # ports: # - "3306:3306" # volumes: # - ./mysql/data:/var/lib/mysql # environment: # MYSQL_ROOT_PASSWORD: secret # networks: # - test-network networks: test-network: driver: bridge ipam: driver: default config: - subnet: 192.168.220.0/28</span></span></code> </pre><br><br>  Vemos que nesta configura√ß√£o s√£o criados dois cont√™ineres php71-first e php71-two, com base em uma imagem php: 7.1-fpm.  Cada cont√™iner possui suas pr√≥prias configura√ß√µes para o Xdebug.  Cada cont√™iner individual escutar√°, para depura√ß√£o, sua porta e seu servidor. <br><br>  Al√©m disso, chamo sua aten√ß√£o para as diretrizes <br><pre> <code class="python hljs"> args: - USER_ID - GROUP_ID</code> </pre><br><br>  Sem essas vari√°veis, a imagem php-fpm n√£o ser√° iniciada.  Pergunta: como pass√°-los para o docker-compose.yml?  Resposta: como √© mais conveniente para voc√™.  Voc√™ pode na inicializa√ß√£o: <br><pre> <code class="bash hljs">USER_ID=$(id -u) GROUP_ID=$(id -g) docker-compose up -d</code> </pre> <br>  Voc√™ pode gravar essas vari√°veis ‚Äã‚Äãno arquivo .env, que fica no mesmo n√≠vel do arquivo docker-compose.yml <br> <code>USER_ID=1000 <br> GROUP_ID=1000 <br></code> <br>  Eu gosto mais da vers√£o com o arquivo .env.  Claro, voc√™ pode usar o Makefile.  Como voc√™ gosta mais. <br><br>  O c√≥digo completo da vers√£o demo est√° publicado no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">github</a> . <br><br>  Listagem do projeto de demonstra√ß√£o: <br><br><img src="https://habrastorage.org/webt/-k/ky/wz/-kkywzcbln7nintf6fbwgpagv_k.png"><br><br>  Consulte brevemente a lista do projeto. <br><br>  Aliases -&gt; php71 -&gt; diret√≥rio bash.bashrc.  Momento controverso.  Prefiro me comunicar com cont√™ineres php-fpm por meio de aliases. <br><br>  Este arquivo √© encaminhado para docker-compose.yml: - ./aliases/php71/bash.bashrc:/etc/bash.bashrc <br>  Ferramenta padr√£o do Linux. <br><br>  O diret√≥rio hosts - arquivos de configura√ß√£o para o Nginx.  Cada configura√ß√£o possui seu pr√≥prio cont√™iner php-fpm.  Um exemplo: <br><br><pre> <code class="php hljs">server { listen <span class="hljs-number"><span class="hljs-number">80</span></span>; index index.php; server_name first.loc; error_log /<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>/log/nginx/first_error.log; root /<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>/www/first.loc; location / { try_files $uri /index.php?$args; } location ~ \.php$ { fastcgi_split_path_info ^(.+\.php)(/.+)$; <span class="hljs-comment"><span class="hljs-comment">#  php-fpm fastcgi_pass php71-first:9000; fastcgi_index index.php; fastcgi_read_timeout 1000; include fastcgi_params; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; fastcgi_param PATH_INFO $fastcgi_path_info; } }</span></span></code> </pre><br>  O diret√≥rio images - instru√ß√µes para montar imagens php-fpm, o diret√≥rio mysql - armazena bancos de dados, o diret√≥rio www - todos os nossos projetos web, em nosso exemplo first.loc e two.loc. <br><br>  <b>Vamos resumir os resultados intermedi√°rios</b> : usando os recursos da janela de encaixe, lan√ßamos todos os nossos projetos de trabalho em um ambiente.  Todos os nossos projetos se v√™em, configura√ß√µes exclusivas para o Xdebug s√£o registradas para cada um dos projetos. <br><br>  Resta configurar corretamente o PhpStorm para cada um dos projetos.  Ao configurar, devemos registrar a porta para depura√ß√£o e o nome do servidor em v√°rios locais. <br><br>  Crie um projeto no PhpStorm <br><br><img src="https://habrastorage.org/webt/_j/8p/is/_j8piswn2nem_vwbnj08oh8i7uu.png"><br><br><img src="https://habrastorage.org/webt/wl/3k/yd/wl3kydjytydrmthhcpzsfe3v85m.png"><br><br><img src="https://habrastorage.org/webt/_j/np/ra/_jnpranostnhpzg7l2hecdbsgb8.png"><br><br>  Vamos configurar as se√ß√µes do menu <br>  - PHP (voc√™ deve registrar corretamente o interpretador CLI), <br>  - Depura√ß√£o (altere a porta para 9008, como no arquivo docker-compose.yml), <br>  <s>- proxy DBGp (chave IDE, host, porta),</s> <br>  <b>atualizar</b> Obrigado ao <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">navegador do</a> hub CrazyLazy pelo ponto importante.  O item de menu proxy DBGp n√£o precisa ser configurado. <br>  - Servidores (voc√™ deve especificar corretamente o nome do servidor, como no arquivo docker-compose.yml, e usar mapeamentos de caminho) <br><br><img src="https://habrastorage.org/webt/lj/k1/qi/ljk1qiesnz_oqzeoi-i0ytmxgey.png"><br><br>  Vou esconder todas as outras capturas de tela sob o spoiler. <br><br><div class="spoiler">  <b class="spoiler_title">Configurando o interpretador da CLI a partir do arquivo docker-compose.yml</b> <div class="spoiler_text">  N√£o h√° nada complicado - √© importante, ao configurar, selecionar a imagem desejada e registrar corretamente o nome do servidor.  Por padr√£o, o nome do servidor Docker, n√≥s o temos. <br><br><img src="https://habrastorage.org/webt/qn/ot/08/qnot080fzz-bymkgbtsevyzwkla.png"><br><br><img src="https://habrastorage.org/webt/-r/e-/wn/-re-wnhsmpa5xowhv9y0hc4zqjg.png"><br><br><img src="https://habrastorage.org/webt/o7/rd/ah/o7rdahdcbjltlgvgksjdymqb92w.png"><br><br><img src="https://habrastorage.org/webt/bu/eh/md/buehmdu3ohudyx_9ezu9wz7mk-u.png"><br><br><img src="https://habrastorage.org/webt/1i/xi/qh/1ixiqhy2psmqjjhiftuttkk8nhu.png"><br><br><img src="https://habrastorage.org/webt/3b/_t/17/3b_t17w1nt6ju_86gddfmxkzo-y.png"><br><br><img src="https://habrastorage.org/webt/bs/6m/_v/bs6m_vv-zfuhuqrddsqh1d1zwic.png"><br><br><img src="https://habrastorage.org/webt/ml/va/ch/mlvach925rq-t52s3s6nnajlzlm.png"><br><br><img src="https://habrastorage.org/webt/rf/zg/5n/rfzg5n1utpkmtq3bbcucqtkfla0.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Configure a se√ß√£o do menu Debug</b> <div class="spoiler_text">  Novamente, prescrevemos tudo, desde as configura√ß√µes do docker-compose.yml para um cont√™iner espec√≠fico.  Na mesma etapa, validamos como nossa depura√ß√£o funciona. <br><br><img src="https://habrastorage.org/webt/t8/76/d3/t876d3mggafgcrw6vn_prztxowa.png"><br><br><img src="https://habrastorage.org/webt/h9/sz/e3/h9sze3ekrkttlvs1mxqlccinqxk.png"><br><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Configure a se√ß√£o do menu Servidores</b> <div class="spoiler_text">  √â importante registrar corretamente o uso de mapeamentos de caminhos, novamente pegamos o nome do servidor nas configura√ß√µes <br><br><img src="https://habrastorage.org/webt/qf/7-/on/qf7-onhf100vot3sqjs0zpminpy.png"><br><br><img src="https://habrastorage.org/webt/qb/p7/7x/qbp77xg1h1usxej75fua3o-2mm8.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Deixamos a se√ß√£o do menu Arquivo -&gt; Configura√ß√µes, v√° para a se√ß√£o do menu Executar -&gt; Editar configura√ß√£o, crie uma p√°gina da Web Php</b> <div class="spoiler_text">  Selecionamos nosso servidor, criado na etapa anterior. <br><br><img src="https://habrastorage.org/webt/y4/df/hh/y4dfhhqmp_20nf5-eqkfateeepw.png"><br><br><img src="https://habrastorage.org/webt/9e/xm/b4/9exmb4ftet-yw1798zr1-qxse-s.png"><br><br><img src="https://habrastorage.org/webt/0s/wy/r8/0swyr8zrk65k0-jcilaqjjyqjtw.png"><br></div></div><br><h4>  Bem, isso √© tudo.  Est√° escrito muitas letras, parece que tudo n√£o √© f√°cil </h4><br>  De fato, o principal √© entender uma coisa muito simples.  Gra√ßas √† tecnologia docker, podemos executar todos os nossos aplicativos de trabalho em um √∫nico espa√ßo, mas com configura√ß√µes diferentes para o Xdebug.  Cada aplicativo funciona em seu pr√≥prio cont√™iner, e precisamos prescrever cuidadosamente as configura√ß√µes de cada aplicativo no PhpStorm. <br><br>  E na sa√≠da temos uma imagem maravilhosa. <br><br>  1. Clonamos um reposit√≥rio no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">github</a> .  Crie um arquivo .env com vari√°veis <br> <code>USER_ID= uid <br> GROUP_ID= gid <br></code> <br><br>  2. Registramos os n√≥s first.loc e two.loc no arquivo / etc / hosts <br><br><pre> <code class="plaintext hljs">127.0.0.1 first.loc 127.0.0.1 two.loc</code> </pre> <br>  3. Na pasta git, execute o <code>docker-compose up -d</code> <br><br>  4. Configuramos os dois projetos first.loc e two.loc no PhpStorm, conforme descrito acima, e executamos os dois projetos no PhpStorm.  I.e.  temos duas janelas PhpStorm abertas, com dois projetos, cada um deles escutando as conex√µes de entrada (o telefone est√° ligado). <br><br>  5. No projeto two.loc, colocamos um ponto de interrup√ß√£o na segunda linha, por exemplo.  No primeiro projeto first.loc, iniciamos a solicita√ß√£o http a partir do arquivo http.http <br><br>  E eis que eis!  Somos lan√ßados no segundo projeto, no nosso ponto de interrup√ß√£o. <br><br>  Para depurar scripts do console, fazemos exatamente a mesma coisa.  Ativamos a escuta telef√¥nica para escutas telef√¥nicas, definimos um ponto de interrup√ß√£o, vamos para o cont√™iner certo, executamos o script certo. <br><br>  Algo como: <br><br><pre> <code class="bash hljs">alex@alex-Aspire-ES1-572 ~ $ php71first www-data@a0e771cfac72:~$ cdf www-data@a0e771cfac72:~/first.loc$ php index.php I<span class="hljs-string"><span class="hljs-string">'am first host www-data@a0e771cfac72:~/first.loc$</span></span></code> </pre><br>  Onde php71first √© o alias na m√°quina host: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">alias</span></span> php71first=<span class="hljs-string"><span class="hljs-string">"cd ~/docker_git &amp;&amp; docker-compose exec php71-first bash"</span></span></code> </pre> <br>  <code>cdf</code> - um alias que funciona em um cont√™iner.  Eu escrevi acima que prefiro usar aliases para se comunicar com cont√™ineres. <br><br>  Isso √© tudo, cr√≠ticas construtivas, coment√°rios s√£o bem-vindos. <br><br>  PS: Gostaria de expressar minha profunda gratid√£o a Denis Bondar por seu artigo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">PhpStorm + Docker + Xdebug</a> , que foi o ponto de partida para escrever este tutorial. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt473184/">https://habr.com/ru/post/pt473184/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt473146/index.html">Servidor Blazor nos cen√°rios e desempenho do .NET Core 3.0</a></li>
<li><a href="../pt473154/index.html">JS Open Space amig√°vel: renderiza√ß√£o do lado do cliente e cria√ß√£o de wrapper</a></li>
<li><a href="../pt473158/index.html">Como √© quando 75% de seus funcion√°rios s√£o autistas</a></li>
<li><a href="../pt473160/index.html">Marca pessoal para ajudar os neg√≥cios: 8 etapas para criar um conceito</a></li>
<li><a href="../pt473166/index.html">Compilando o FFmpeg no WebAssembly (= ffmpeg.js): Parte 3 - Convertendo avi para mp4</a></li>
<li><a href="../pt473186/index.html">Layout n√£o trivial de elementos no flexbox sem solicita√ß√µes de m√≠dia</a></li>
<li><a href="../pt473188/index.html">Pr√≥s e contras das ferramentas Atlassian. Use em neg√≥cios que n√£o s√£o de TI</a></li>
<li><a href="../pt473192/index.html">A eletricidade pode ser obtida da neve.</a></li>
<li><a href="../pt473194/index.html">Resumo de telecomunica√ß√µes: na constru√ß√£o de redes de operadoras, protocolos de Internet e seguran√ßa da informa√ß√£o</a></li>
<li><a href="../pt473196/index.html">Transformando scripts em belas ferramentas de aprendizado de m√°quina</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>