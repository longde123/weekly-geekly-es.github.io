<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèª‚Äçüé§ üìÖ üéø Puis-je utiliser Redux sur un serveur? üëçüèª üë≠ üÖ∞Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Redux est un excellent outil pour g√©rer l'√©tat des applications frontales complexes. L'auteur du document, dont nous publions la traduction aujourd'hu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Puis-je utiliser Redux sur un serveur?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/437804/">  Redux est un excellent outil pour g√©rer l'√©tat des applications frontales complexes.  L'auteur du document, dont nous publions la traduction aujourd'hui, va trouver la r√©ponse √† la question de savoir s'il est possible de profiter des fonctionnalit√©s de Redux dans l'environnement serveur. <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/4ff/f8d/685/4fff8d685687bacff24db95abaadd05b.png" alt="image"></a> <a name="habracut"></a><br><h2>  <font color="#3AC1EF">Pourquoi ai-je besoin d'une biblioth√®que Redux?</font> </h2><br>  La <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">page d'accueil de la</a> biblioth√®que Redux indique qu'il s'agit d'un ¬´conteneur d'√©tat pr√©visible pour les applications JavaScript¬ª.  Redux est g√©n√©ralement appel√© un outil pour g√©rer l'√©tat d'une application, et bien que cette biblioth√®que soit principalement utilis√©e avec React, elle peut √™tre utilis√©e dans tous les projets bas√©s sur JavaScript. <br><br>  Nous avons d√©j√† mentionn√© que Redux est utilis√© pour contr√¥ler l'√©tat d'une application.  Parlons maintenant de ce qu'est une ¬´condition¬ª.  Ce concept est assez difficile √† d√©finir, mais nous essayons toujours de le d√©crire. <br><br>  En consid√©rant l '"√©tat", si nous parlons de personnes ou d'objets du monde mat√©riel, nous cherchons √† d√©crire, en fait, leur √©tat au moment o√π nous en parlons, en consid√©rant √©ventuellement un ou plusieurs param√®tres.  Par exemple, nous pouvons dire au sujet du lac: "L'eau est tr√®s chaude" ou: "L'eau est gel√©e".  Dans ces d√©clarations, nous d√©crivons l'√©tat du lac en termes de temp√©rature de l'eau. <br><br>  Quand quelqu'un dit de lui-m√™me: ¬´Je suis √©chou√©¬ª, il consid√®re le montant d'argent dont il dispose.  Il est clair que dans chacun de ces exemples, nous ne parlons que d'un aspect de l'√©tat des objets.  Mais, dans l'exemple de l'argent, la d√©claration peut √™tre celle qui d√©crit plusieurs param√®tres: "Je suis √©chou√©, je n'ai pas mang√© depuis longtemps, mais je suis heureux!".  Il est tr√®s important de noter ici que l'√âtat est quelque chose d'impermanent.  Cela signifie que cela peut changer.  Par cons√©quent, lorsque nous apprenons l'√©tat actuel d'un certain objet, nous comprenons que son √©tat r√©el peut changer quelques secondes ou minutes apr√®s que nous en ayons pris connaissance. <br><br>  Lorsque nous traitons de programmes, certaines fonctionnalit√©s sont associ√©es au concept d '¬´√©tat¬ª.  Premi√®rement, l'√©tat de l'application est repr√©sent√© par des donn√©es stock√©es quelque part.  Par exemple, ces donn√©es peuvent √™tre stock√©es en m√©moire (par exemple, en tant qu'objet JavaScript), mais elles peuvent √™tre stock√©es dans un fichier, dans une base de donn√©es et en utilisant un m√©canisme de mise en cache comme Redis.  Deuxi√®mement, l'√©tat d'une application est g√©n√©ralement li√© √† son instance sp√©cifique.  Par cons√©quent, lorsque nous parlons de l'√©tat de l'application, nous entendons une instance sp√©cifique de cette application, un processus, un environnement de travail organis√© dans l'application pour un utilisateur sp√©cifique.  Un √©tat d'application peut inclure, par exemple, les informations suivantes: <br><br><ul><li>  L'utilisateur est-il connect√© ou non?  Si oui, combien de temps dure la session et quand va-t-elle expirer? </li><li>  Combien de points l'utilisateur a-t-il marqu√©s?  Une telle question est pertinente, par exemple, pour un certain jeu. </li><li>  O√π l'utilisateur a-t-il mis la vid√©o en pause?  Cette question peut √™tre pos√©e sur l'application du lecteur vid√©o. </li></ul><br>  Si nous parlons de l'√©tat des applications √† un niveau inf√©rieur, cela peut inclure, par exemple, les informations suivantes: <br><br><ul><li>  Quelles variables sont d√©finies dans l'environnement actuel dans lequel l'application s'ex√©cute (il s'agit des ¬´variables d'environnement¬ª). </li><li>  Quels fichiers le programme utilise-t-il actuellement? </li></ul><br>  En regardant le ¬´snapshot¬ª (ils sont souvent appel√©s ¬´snapshots¬ª - √† partir d'un instantan√©) du statut de l'application √† tout moment, nous pouvons en apprendre davantage sur les conditions dans lesquelles l'application a fonctionn√© √† ce moment et, si n√©cessaire, recr√©er ces conditions en application √† l'√©tat dans lequel il se trouvait au moment de la r√©ception de l'instantan√©. <br><br>  L'√©tat peut √™tre modifi√© lors de l'ex√©cution de certaines actions par l'utilisateur.  Par exemple, si l'utilisateur d√©place correctement le personnage du jeu dans un jeu simple, cela peut augmenter le nombre de points.  Dans des applications assez complexes, l'approche de modification d'un √©tat peut devenir plus compliqu√©e; les changements d'√©tat peuvent provenir de diff√©rentes sources. <br><br>  Par exemple, dans une partie multijoueur, le nombre de points qu'un utilisateur marque d√©pend non seulement de ses actions, mais aussi des actions de ceux qui jouent avec lui dans la m√™me √©quipe.  Et si un personnage contr√¥l√© par ordinateur attaque avec succ√®s un personnage de jeu que l'utilisateur contr√¥le, l'utilisateur peut perdre un certain nombre de points. <br><br>  Imaginez que nous d√©veloppons une application frontale comme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PWA Twitter</a> .  Il s'agit d'une application d'une page qui comporte plusieurs onglets, par exemple - Accueil, Recherche, Notifications et Messages.  Chacun de ces onglets poss√®de son propre espace de travail, qui est destin√© √† la fois √† l'affichage de certaines informations et √† sa modification.  Toutes ces donn√©es constituent l'√©tat de l'application.  Ainsi, de nouveaux tweets, notifications et messages arrivent dans l'application toutes les quelques secondes.  L'utilisateur peut travailler avec le programme et avec ces donn√©es.  Par exemple, il peut cr√©er un tweet ou le supprimer, il peut retweeter un tweet, il peut lire des notifications, envoyer des messages √† quelqu'un, etc.  Tout ce qui vient d'√™tre discut√© modifie l'√©tat de l'application. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f01/221/468/f01221468374f7a04c099abb43513871.png"></div><br>  <i><font color="#999999">Tous ces onglets ont leur propre ensemble de composants d'interface utilisateur utilis√©s pour afficher et modifier les donn√©es.</font></i>  <i><font color="#999999">L'√©tat de l'application peut √™tre affect√© par les donn√©es entrant dans l'application de l'ext√©rieur et les actions de l'utilisateur</font></i> <br><br>  Il est clair que dans une telle application, les sources de changements d'√©tat peuvent √™tre diff√©rentes entit√©s, tandis que les changements initi√©s par diff√©rentes sources peuvent se produire presque simultan√©ment.  Si nous g√©rons l'√©tat manuellement, il peut s'av√©rer difficile pour nous de surveiller ce qui se passe.  Ces difficult√©s conduisent √† des contradictions.  Par exemple, un tweet peut √™tre supprim√©, mais il sera toujours affich√© dans le flux de tweet.  Ou, disons, l'utilisateur peut lire la notification ou le message, mais il sera toujours affich√© dans le programme comme non visualis√©. <br><br>  L'utilisateur peut aimer le tweet, un c≈ìur appara√Ætra dans l'interface du programme, mais une requ√™te r√©seau qui envoie des informations similaires au serveur ne fonctionnera pas.  Par cons√©quent, ce que l'utilisateur voit sera diff√©rent de ce qui est stock√© sur le serveur.  C'est pour √©viter de telles situations que Redux peut √™tre n√©cessaire. <br><br><h2>  <font color="#3AC1EF">Comment fonctionne Redux?</font> </h2><br>  Dans la biblioth√®que Redux, il existe trois concepts principaux qui visent √† rendre la gestion de l'√©tat des applications simple et directe: <br><br><ol><li>  Stockage (magasin).  Un r√©f√©rentiel Redux est un objet JavaScript qui repr√©sente l'√©tat d'une application.  Il joue le r√¥le de "la seule source de donn√©es fiables".  Cela signifie que l'application enti√®re doit s'appuyer sur le stockage comme seule entit√© responsable de la repr√©sentation de l'√âtat. </li><li>  Actions  Le magasin d'√©tat est en lecture seule.  Cela signifie qu'il ne peut pas √™tre modifi√© en y acc√©dant directement.  La seule fa√ßon de modifier le contenu du r√©f√©rentiel est d'utiliser des actions.  Tout composant qui souhaite changer d'√©tat doit prendre les mesures appropri√©es. </li><li>  R√©ducteurs (r√©ducteurs), √©galement appel√©s "convertisseurs".  Un r√©ducteur est une fonction pure qui d√©crit comment un √©tat est modifi√© par des actions.  Le r√©ducteur prend l'√©tat et l'action actuels, dont l'ex√©cution a √©t√© demand√©e par un certain composant de l'application, apr√®s quoi il retourne l'√©tat transform√©. </li></ol><br>  L'utilisation de ces trois concepts signifie que l'application ne doit plus surveiller directement les √©v√©nements qui sont des sources de changements d'√©tat (actions de l'utilisateur, r√©ponses API, l'occurrence d'√©v√©nements associ√©s √† la r√©ception de certaines donn√©es via le protocole WebSocket, etc.) et prendre des d√©cisions sur la fa√ßon dont ces √©v√©nements affecteront la condition. <br><br>  En utilisant le mod√®le Redux, ces √©v√©nements peuvent d√©clencher des actions qui changeront d'√©tat.  Les composants qui ont besoin d'utiliser des donn√©es stock√©es dans l'√©tat de l'application peuvent simplement s'abonner aux changements d'√©tat et recevoir des informations qui les int√©ressent.  En utilisant tous ces m√©canismes, Redux s'engage √† apporter des changements pr√©visibles √† l'√©tat de l'application. <br><br>  Voici un exemple sch√©matique qui montre comment organiser un syst√®me de gestion d'√©tat simple √† l'aide de Redux dans notre application fictive: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { createStore } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux'</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  const tweets = (state = {tweets: []}, action) =&gt; {  switch (action.type) {    //     ,     .    case 'SHOW_NEW_TWEETS':      state.numberOfNewTweets = action.count;      return state.tweets.concat([action.tweets]);    default:      return state;  } }; //  ,     . SHOW_NEW_TWEETS const newTweetsAction = (tweets) =&gt; {  return {      type: 'SHOW_NEW_TWEETS',      tweets: tweets,      count: tweets.length  }; }; const store = createStore(tweets); twitterApi.fetchTweets()  .then(response =&gt; {    //  ,        ,    //    Redux.    store.dispatch(newTweetsAction(response.data));  }); //  ,    SHOW_NEW_TWEETS     //         . const postTweet = (text) =&gt; {  twitterApi.postTweet(text)  .then(response =&gt; {    store.dispatch(newTweetsAction([response.data]));  }); }; // ,  ,   WebSocket,   . //         . SHOW_NEW_TWEETS socket.on('newTweets', (tweets) =&gt; { store.dispatch(newTweetsAction(tweets)); }; //     ,  React,       , // ,         . //         , //    . store.subscribe(() =&gt; {  const { tweets } = store.getSTate();  render(tweets); });</span></span></code> </pre> <br>  En prenant ce code comme base, nous pouvons √©quiper notre syst√®me de gestion de l'√©tat de l'application avec des actions suppl√©mentaires et les envoyer depuis diff√©rents endroits de l'application sans risquer de confusion d√©sesp√©r√©e. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Voici le</a> mat√©riel √† partir duquel vous pouvez en apprendre davantage sur les trois principes fondamentaux de Redux. <br><br>  Parlons maintenant de l'utilisation de Redux dans un environnement de serveur. <br><br><h2>  <font color="#3AC1EF">Migration des principes Redux vers l'environnement du serveur</font> </h2><br>  Nous avons explor√© les fonctionnalit√©s de Redux utilis√©es dans le d√©veloppement d'applications clientes.  Mais, √©tant donn√© que Redux est une biblioth√®que JavaScript, elle peut th√©oriquement √©galement √™tre utilis√©e dans un environnement de serveur.  Nous r√©fl√©chirons √† la fa√ßon dont les principes ci-dessus peuvent √™tre appliqu√©s sur le serveur. <br><br>  Vous vous souvenez de la fa√ßon dont nous avons parl√© de l'√©tat de l'application client?  Il convient de noter qu'il existe des diff√©rences conceptuelles entre les applications client et serveur.  Ainsi, les applications clientes ont tendance √† maintenir l'√©tat entre divers √©v√©nements, par exemple, entre l'ex√©cution des demandes au serveur.  Ces applications sont appel√©es applications avec √©tat. <br><br>  S'ils ne s'effor√ßaient pas de stocker l'√©tat, alors, par exemple, lorsqu'il travaille avec un certain service Web qui n√©cessite un identifiant et un mot de passe, l'utilisateur devrait effectuer cette proc√©dure chaque fois qu'il acc√®de √† une nouvelle page de l'interface Web correspondante. <br><br>  Les applications dorsales, en revanche, s'efforcent de ne pas stocker l'√©tat (elles sont √©galement appel√©es applications sans √©tat).  Ici, en parlant d '¬´applications backend¬ª, nous entendons principalement des projets bas√©s sur certaines API distinctes des applications frontales.  Cela signifie que des informations sur l'√©tat du syst√®me doivent √™tre fournies √† des applications similaires √† chaque acc√®s.  Par exemple, l'API ne contr√¥le pas si l'utilisateur est connect√© ou non.  Il d√©termine son √©tat en analysant le jeton d'authentification dans ses demandes √† cette API. <br><br>  Cela nous am√®ne √† une raison importante pour laquelle Redux ne serait gu√®re utilis√© sur des serveurs sous la forme dans laquelle nous avons d√©crit ses capacit√©s ci-dessus. <br><br>  Le fait est que Redux a √©t√© con√ßu pour stocker l'√©tat temporaire de l'application.  Mais l'√©tat de l'application stock√©e sur le serveur doit g√©n√©ralement exister suffisamment longtemps.  Si vous utilisiez le r√©f√©rentiel Redux dans votre application Node.js c√¥t√© serveur, l'√©tat de cette application serait effac√© √† chaque arr√™t du processus de <code>node</code> .  Et si nous parlons d'un serveur PHP qui impl√©mente un sch√©ma de gestion d'√©tat similaire, alors l'√©tat sera effac√© lorsque chaque nouvelle demande arrivera sur le serveur. <br><br>  La situation est encore plus compliqu√©e si l'on consid√®re les applications serveur en termes d'√©volutivit√©.  Si vous deviez faire √©voluer l'application horizontalement, en augmentant le nombre de serveurs, vous auriez alors de nombreux processus Node.js en cours d'ex√©cution en m√™me temps, et chacun aurait sa propre option d'√©tat.  Cela signifie qu'avec la r√©ception simultan√©e de deux demandes identiques au backend, des r√©ponses diff√©rentes auraient pu √™tre donn√©es. <br><br>  Comment appliquer les principes de gestion des √©tats dont nous avons discut√© sur le serveur?  Jetons un autre regard sur les concepts Redux et voyons comment ils sont g√©n√©ralement utilis√©s dans un environnement de serveur: <br><br><ol><li>  D√©p√¥t.  Sur le backend, ¬´la seule source de donn√©es fiables¬ª est g√©n√©ralement une base de donn√©es.  Parfois, afin de faciliter l'acc√®s aux donn√©es qui sont souvent n√©cessaires, ou pour une autre raison, une copie d'une partie de cette base de donn√©es peut √™tre faite - sous la forme d'un cache ou sous la forme d'un fichier.  En r√®gle g√©n√©rale, ces copies sont en lecture seule.  Les m√©canismes qui les contr√¥lent sont abonn√©s aux modifications dans le r√©f√©rentiel principal et, lorsque ces modifications se produisent, mettent √† jour le contenu des copies. </li><li>  Actions et r√©ducteurs.  Ce sont les seuls m√©canismes utilis√©s pour changer d'√©tat.  Dans la plupart des applications backend, le code est √©crit dans un style imp√©ratif, ce qui n'est pas particuli√®rement propice √† l'utilisation de concepts d'action et de r√©ducteurs. </li></ol><br>  Consid√©rons deux mod√®les de conception qui, par leur nature, sont similaires √† ce que la biblioth√®que Redux vise √† faire.  Ce sont CQRS et Event Sourcing.  En fait, ils ont comparu devant Redux, leur mise en ≈ìuvre peut √™tre extr√™mement difficile, nous allons donc en parler tr√®s bri√®vement. <br><br><h2>  <font color="#3AC1EF">CQRS et sour√ßage d'√©v√©nements</font> </h2><br>  CQRS (Command Query Responsibility Segregation) est un mod√®le de conception, dans la mise en ≈ìuvre duquel l'application lit les donn√©es du magasin uniquement √† l'aide de requ√™tes et √©crit uniquement √† l'aide de commandes. <br><br>  Lorsque vous utilisez CQRS, la seule fa√ßon de changer l'√©tat d'une application est d'envoyer une commande.  Les commandes sont similaires aux actions Redux.  Par exemple, dans Redux, vous pouvez √©crire du code qui correspond √† ce sch√©ma: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> action = { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'CREATE_NEW_USER'</span></span>, <span class="hljs-attr"><span class="hljs-attr">payload</span></span>: ... }; store.dispatch(action); <span class="hljs-comment"><span class="hljs-comment">//      const createUser = (state = {}, action) =&gt; { // };</span></span></code> </pre> <br>  Lorsque vous utilisez CQRS, quelque chose comme ceci ressemblerait √† ceci: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//      class Command { handle() { } } class CreateUserCommand extends Command { constructor(user) {   super();   this.user = user; } handle() {   //        } } const createUser = new CreateUserCommand(user); //   (   handle()) dispatch(createUser); //      CommandHandler commandHandler.handle(createUser);</span></span></code> </pre> <br>  Les requ√™tes sont des m√©canismes de lecture de donn√©es dans le mod√®le CQRS.  Ils sont √©quivalents √† la construction <code>store.getState()</code> .  Dans une impl√©mentation CQRS simple, les requ√™tes interagiront directement avec la base de donn√©es, r√©cup√©rant les enregistrements de celle-ci. <br><br>  Le mod√®le Event Sourcing est con√ßu pour enregistrer toutes les modifications de l'√©tat de l'application sous la forme d'une s√©quence d'√©v√©nements.  Ce mod√®le est mieux adapt√© aux applications qui doivent conna√Ætre non seulement leur √©tat actuel, mais √©galement l'historique de ses modifications, la fa√ßon dont l'application a atteint son √©tat actuel.  √Ä titre d'exemples, vous pouvez citer l'historique des op√©rations avec les comptes bancaires, le suivi des colis, le traitement des commandes dans les magasins en ligne, l'organisation du transport de marchandises, la logistique. <br><br>  Voici un exemple d'impl√©mentation du mod√®le Event Sourcing: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//    Event Sourcing function transferMoneyBetweenAccounts(amount, fromAccount, toAccount) {   BankAccount.where({ id: fromAccount.id })     .decrement({ amount });   BankAccount.where({ id: toAccount.id })     .increment({ amount }); } function makeOnlinePayment(account, amount) {   BankAccount.where({ id: account.id })     .decrement({ amount }); } //    Event Sourcing function transferMoneyBetweenAccounts(amount, fromAccount, toAccount) {   dispatchEvent(new TransferFrom(fromAccount, amount, toAccount));   dispatchEvent(new TransferTo(toAccount, amount, fromAccount)); } function makeOnlinePayment(account, amount) {   dispatchEvent(new OnlinePaymentFrom(account, amount)); } class TransferFrom extends Event {   constructor(account, amount, toAccount) {     this.account = account;     this.amount = amount;     this.toAccount = toAccount;   }     handle() {     //    OutwardTransfer        OutwardTransfer.create({ from: this.account, to: this.toAccount, amount: this.amount, date: Date.now() });         //          BankAccount.where({ id: this.account.id })       .decrement({ amount: this.amount });   } } class TransferTo extends Event {   constructor(account, amount, fromAccount) {     this.account = account;     this.amount = amount;     this.fromAccount = fromAccount;   }     handle() {     //    InwardTransfer        InwardTransfer.create({ from: this.fromAccount, to: this.account, amount: this.amount, date: Date.now() });         //          BankAccount.where({ id: this.account.id })       .increment({ amount: this.amount });   } } class OnlinePaymentFrom extends Event {   constructor(account, amount) {     this.account = account;     this.amount = amount;   }     handle() {     //    OnlinePayment        OnlinePayment.create({ from: this.account, amount: this.amount, date: Date.now() });         //          BankAccount.where({ id: this.account.id })       .decrement({ amount: this.amount });   } }</span></span></code> </pre> <br>  Ce qui se passe ici ressemble √©galement √† l'utilisation des actions Redux. <br><br>  Cependant, le m√©canisme d'enregistrement des √©v√©nements organise √©galement le stockage √† long terme des informations sur chaque changement d'√©tat, et pas seulement le stockage de l'√©tat lui-m√™me.  Cela nous permet de reproduire ces modifications au point dans le temps dont nous avons besoin, r√©tablissant ainsi le contenu de l'√©tat de l'application √† ce moment.  Par exemple, si nous devons comprendre combien d'argent √©tait dans le compte bancaire pour une certaine date, nous devons seulement reproduire les √©v√©nements qui se sont produits avec le compte bancaire jusqu'√† ce que nous arrivions √† la bonne date.  Les √©v√©nements dans ce cas sont repr√©sent√©s par des entr√©es de fonds sur le compte et par leur d√©bit, par le d√©bit de la commission bancaire et d'autres op√©rations similaires.  Si des erreurs se produisent (c'est-√†-dire lorsque des √©v√©nements contenant des donn√©es incorrectes se produisent), nous pouvons invalider l'√©tat actuel de l'application, corriger les donn√©es correspondantes et revenir √† l'√©tat actuel de l'application, d√©sormais form√© sans erreur. <br><br>  Les mod√®les CQRS et Event Sourcing sont souvent utilis√©s ensemble.  Et, fait int√©ressant, Redux, en fait, est en partie bas√© sur ces mod√®les.  Les commandes peuvent √™tre √©crites de mani√®re √† ce qu'elles soient envoy√©es, lorsqu'elles sont appel√©es.  Ensuite, les √©v√©nements interagissent avec le r√©f√©rentiel (base de donn√©es) et mettent √† jour l'√©tat.  Dans les applications en temps r√©el, les objets de requ√™te peuvent √©galement √©couter les √©v√©nements et recevoir des informations d'√©tat mises √† jour du r√©f√©rentiel. <br><br>  L'utilisation de l'un de ces mod√®les dans une application simple peut compliquer inutilement la t√¢che.  Cependant, dans le cas d'applications con√ßues pour r√©soudre des probl√®mes commerciaux complexes, CQRS et Event Sourcing sont de puissantes abstractions qui aident √† mieux mod√©liser le domaine de ces applications et √† am√©liorer leur gestion d'√©tat. <br><br>  Veuillez noter que les mod√®les CQRS et Event Sourcing peuvent √™tre impl√©ment√©s de diff√©rentes mani√®res, tandis que certaines de leurs impl√©mentations sont plus complexes que d'autres.  Nous n'avons consid√©r√© que des exemples tr√®s simples de leur mise en ≈ìuvre.  Si vous √©crivez des applications serveur dans Node.js, jetez un ≈ìil √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">wolkenkit</a> .  Ce cadre, parmi ce qui a √©t√© trouv√© dans ce domaine, fournit au d√©veloppeur l'une des interfaces les plus simples pour impl√©menter les mod√®les CQRS et Event Sourcing. <br><br><h2>  <font color="#3AC1EF">R√©sum√©</font> </h2><br>  Redux est un excellent outil pour g√©rer l'√©tat d'une application, afin de rendre les changements d'√©tat pr√©visibles.  Dans cet article, nous avons parl√© des concepts cl√©s de cette biblioth√®que et constat√© que, bien que l'utilisation de Redux dans un environnement de serveur ne soit probablement pas une bonne id√©e, vous pouvez appliquer des principes similaires sur un serveur √† l'aide des mod√®les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CQRS</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Event Sourcing</a> . <br><br>  <b>Chers lecteurs!</b>  Comment organisez-vous la gestion de l'√©tat des applications client et serveur? <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr437804/">https://habr.com/ru/post/fr437804/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr437792/index.html">Les G√©meaux ont obtenu des r√©sultats ¬´myst√©rieux¬ª en v√©rifiant 5 services de recherche d'anc√™tres ADN</a></li>
<li><a href="../fr437794/index.html">Sauvegarde rapide et fiable des donn√©es dans le cloud 2</a></li>
<li><a href="../fr437796/index.html">AlphaStar a-t-il impl√©ment√© la vitesse surhumaine en tant que patch pour l'erreur d'entra√Ænement √† la simulation?</a></li>
<li><a href="../fr437800/index.html">ScrumBut dans l'√©quipe d'analyse: avant le d√©collage</a></li>
<li><a href="../fr437802/index.html">Innovate Cloud Technology: Catastrophic Cloud</a></li>
<li><a href="../fr437806/index.html">EcmaScript 10 - JavaScript de cette ann√©e (ES2019)</a></li>
<li><a href="../fr437808/index.html">Perf et graphes de flamme</a></li>
<li><a href="../fr437810/index.html">R√©alit√© d'entreprise</a></li>
<li><a href="../fr437812/index.html">Xcode 10.2, macOS Mojave 10.14.4, iOS 12.1 et autres b√™tas</a></li>
<li><a href="../fr437814/index.html">Xcode 10.2, macOS Mojave 10.14.4, iOS 12.1 et autres versions b√™ta</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>