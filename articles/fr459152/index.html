<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎙️ 👐🏼 👩🏻‍🌾 Remplissez des documents dans Microsoft Word à l'aide de Python. 2e partie 🍑 😕 👈🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nous propageons des documents  . 
 Dans un article précédent, nous avons examiné comment remplir une requête dans Word en utilisant Python. Cette fois...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Remplissez des documents dans Microsoft Word à l'aide de Python. 2e partie</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/459152/"><h3>  Nous propageons des documents </h3>  . <br>  Dans un article précédent, nous avons examiné comment remplir une requête dans Word en utilisant Python.  Cette fois, il sera démontré comment remplir simultanément plusieurs documents Word avec les données du tableau Excel. <br><br>  Avant de travailler avec le programme, nous devons préparer un fichier Excel, qui contiendra les données source.  Créons un fichier Excel avec de telles données ou utilisons un fichier prêt à l'emploi: <br><br><img src="https://habrastorage.org/webt/yp/eb/ni/ypebnibmgckd5u4tyb59xwuutma.jpeg" alt="image"><br><br>  Passons maintenant au programme. <br><a name="habracut"></a><br>  Comme nous devons lire le fichier Excel, nous devons importer le module correspondant: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> openpyxl</code> </pre> <br>  Ensuite, nous devons parcourir le tableau et lire toutes les données ligne par ligne.  Cela ressemblera à ceci: <br><br><pre> <code class="python hljs">test=[] wb = openpyxl.load_workbook(<span class="hljs-string"><span class="hljs-string">'zaprosi.xlsx'</span></span>) sheet=wb.get_active_sheet() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> row <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> sheet[<span class="hljs-string"><span class="hljs-string">'B3'</span></span>:<span class="hljs-string"><span class="hljs-string">'F7'</span></span>]: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> cellObj <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> row: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> cellObj.value==<span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> cellObj.value==<span class="hljs-string"><span class="hljs-string">" "</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> <span class="hljs-comment"><span class="hljs-comment">#print(cellObj.value) test.append(cellObj.value)</span></span></code> </pre> <br>  Nous avons créé une liste vide, où nous ajouterons les valeurs de la table à l'avenir.  L'ajout se produit uniquement s'il y a des entrées dans la cellule (non annulées). <br><br>  Après les manipulations effectuées, nous ajouterons les données collectées au modèle Word: <br><br><pre> <code class="python hljs">doc = DocxTemplate(<span class="hljs-string"><span class="hljs-string">".docx"</span></span>) context = { <span class="hljs-string"><span class="hljs-string">'emitent'</span></span> : test[<span class="hljs-number"><span class="hljs-number">0</span></span>],<span class="hljs-string"><span class="hljs-string">'address1'</span></span> : test[<span class="hljs-number"><span class="hljs-number">1</span></span>],<span class="hljs-string"><span class="hljs-string">''</span></span> : test[<span class="hljs-number"><span class="hljs-number">2</span></span>],<span class="hljs-string"><span class="hljs-string">'_'</span></span> : test[<span class="hljs-number"><span class="hljs-number">3</span></span>],<span class="hljs-string"><span class="hljs-string">'director'</span></span> : test[<span class="hljs-number"><span class="hljs-number">4</span></span>] } doc.render(context) doc.save(<span class="hljs-string"><span class="hljs-string">'-final.docx'</span></span>)</code> </pre> <br>  En conséquence, nous aurons un fichier Word fini avec les données de la table.  Seulement ici, il est seul, et c'est ce qu'on appelle le modèle final.  Comment alors distinguer les documents les uns des autres? <br><br>  Commençons par un simple.  Pour enregistrer des fichiers sous des noms différents à chaque fois, vous devez modifier les éléments suivants à la fin du code: <br><br><pre> <code class="python hljs">doc.save(test[x]+<span class="hljs-string"><span class="hljs-string">'.docx'</span></span>)</code> </pre> <br>  Maintenant, le fichier enregistré portera le nom de la société qui envoie la demande. <br><br>  Une erreur peut se produire lors de l'exécution du programme: <br><br><img src="https://habrastorage.org/webt/_r/p6/fj/_rp6fjjjdexrc-zruwdyq1h3gkk.jpeg" alt="image"><br><br>  Cette erreur est due au fait que le nom de l'entreprise contient des guillemets.  Si vous supprimez les guillemets du tableau Excel, le fichier Word sera enregistré avec succès sous le nom Company-1.docx. <br><br>  Il reste à "dupliquer" le document en saisissant les données restantes du tableau. <br><br>  Ici aussi, tout est simple.  Nous créons un cycle en fonction de nos données collectées: <br><br><pre> <code class="python hljs">x=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> x&lt;len(test): doc = DocxTemplate(<span class="hljs-string"><span class="hljs-string">".docx"</span></span>) context = { <span class="hljs-string"><span class="hljs-string">'emitent'</span></span> : test[x],<span class="hljs-string"><span class="hljs-string">'address1'</span></span> : test[x+<span class="hljs-number"><span class="hljs-number">1</span></span>],<span class="hljs-string"><span class="hljs-string">''</span></span> : test[x+<span class="hljs-number"><span class="hljs-number">2</span></span>],<span class="hljs-string"><span class="hljs-string">'_'</span></span> : test[x+<span class="hljs-number"><span class="hljs-number">3</span></span>],<span class="hljs-string"><span class="hljs-string">'director'</span></span> : test[x+<span class="hljs-number"><span class="hljs-number">4</span></span>] } doc.render(context) doc.save(test[x]+<span class="hljs-string"><span class="hljs-string">'.docx'</span></span>) x+=<span class="hljs-number"><span class="hljs-number">5</span></span></code> </pre> <br>  À la fin du cycle, «sautez» jusqu'au nom de la colonne avec le nom de l'entreprise afin que le fichier de mots soit enregistré avec le nom correct. <br><br>  Le programme est prêt!  Il ne reste plus qu'à créer une table Excel avec les entreprises en service. <br><br>  Téléchargez le programme terminé <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  Téléchargez le tableau Excel avec les données de test - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  Le modèle de document Word est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br><h3>  --- Mise à jour --- 11/08/2019 </h3>  . <br>  <b>Ajouté</b> : <br>  - le modèle Word de la réponse du bénéficiaire; <br>  - le modèle de demande de mots a été élargi par le nombre de champs (poste de directeur); <br>  - maintenant dans le tableau, vous pouvez remplir les noms des entreprises avec des devis, <br>  le programme va digérer; <br>  - lors de l'enregistrement des fichiers de sortie des demandes, le programme enregistre «magnifiquement»: le chef d'entreprise, qui ajoute de la clarté lors de l'utilisation d'un grand nombre de fichiers; <br>  - lors de l'enregistrement des fichiers de réponses de sortie, le programme enregistre: le participant-réalisateur-qui a répondu (car généralement le participant peut répondre à plusieurs sociétés à la fois et les noms de fichiers sont dupliqués) <br><br>  Téléchargez le programme de demande de bénéficiaire - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> <br>  Téléchargez le programme de réponses - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> <br>  Téléchargez la feuille de calcul Excel avec les données de test - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> <br>  Modèle Word de demande de bénéficiaire - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> <br>  Modèle de réponse Word - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr459152/">https://habr.com/ru/post/fr459152/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr459140/index.html">Pose d'implants: comment cela se fait-il?</a></li>
<li><a href="../fr459142/index.html">Création d'un graphique linéaire moyen animé animé dans R. Récupération de données via l'API NBA</a></li>
<li><a href="../fr459144/index.html">Frontend Weekly Digest (1-7 juillet 2019)</a></li>
<li><a href="../fr459146/index.html">Food Design Digest juin 2019</a></li>
<li><a href="../fr459150/index.html">Le condensé de matières fraîches du monde du front-end de la dernière semaine n ° 372 (1 - 7 juillet 2019)</a></li>
<li><a href="../fr459154/index.html">Réseau pour les petites entreprises utilisant des équipements Cisco. Partie 1</a></li>
<li><a href="../fr459156/index.html">VNIITE de la planète de l'ensemble: comment en URSS ils ont mis au point le système de la «maison intelligente»</a></li>
<li><a href="../fr459158/index.html">Comment l'artefact devient le plus gros échec de Valve</a></li>
<li><a href="../fr459160/index.html">Comment choisissez-vous les produits en magasin?</a></li>
<li><a href="../fr459162/index.html">"Pour gagner les championnats, l'équipe doit respirer à l'unisson." Entretien avec le formateur ICPC des ateliers de Moscou</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>