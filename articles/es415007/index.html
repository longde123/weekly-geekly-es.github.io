<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëçüèΩ üñ•Ô∏è üëÇüèæ C√≥mo configurar Bluetooth en Linux de una manera complicada üßìüèΩ üêá üê®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En preparaci√≥n para el foro anual de TI, surgi√≥ la idea de crear un manipulador simple controlado por un gamepad inal√°mbrico para demostrar las capaci...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C√≥mo configurar Bluetooth en Linux de una manera complicada</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415007/"><p><img src="https://habrastorage.org/webt/wq/9u/sv/wq9usvb7w6-8_c5p_dhrrkom_qa.jpeg"></p><br><p> En preparaci√≥n para el foro anual de TI, surgi√≥ la idea de crear un manipulador simple controlado por un gamepad inal√°mbrico para demostrar las capacidades de los microcontroladores y las computadoras de una sola placa.  A la mano hab√≠a un controlador TRIC, varios servomotores, un constructor de hierro y un mes antes del inicio del foro. </p><br><p>  "Todo va seg√∫n lo planeado", pero no en este caso. </p><a name="habracut"></a><br><h1 id="etap-1-podgotovka">  Etapa 1. Preparaci√≥n </h1><br><p>  El TRIC a bordo de Linux fue un fracaso para tal manipulador, pero "la cosa es la usabilidad y el mantenimiento banales" (cita de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">ClusterM</a> sobre Linux en un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">intercomunicador inteligente</a> ). </p><br><p>  Despu√©s de leer la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">especificaci√≥n</a> , se descubri√≥ que tiene Bluetooth.  Si trabaj√≥ con este controlador, entonces sabe que la transferencia de programas se realiza a trav√©s de Wi-Fi y que no hay otras formas convenientes de comunicarse con √©l.  No hay menci√≥n de Bluetooth en el men√∫.  Pero como es eso? </p><br><p>  Armado con SSH, un destornillador y curiosidad, comenc√© a buscar Bluetooth.  El sistema inclu√≠a hcitool, hciconfig y el demonio bluetoothd.  Todos dijeron que √©l no estaba all√≠. </p><br><pre><code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># hcitool dev Devices:</span></span></code> </pre> <br><pre> <code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># hciconfig hci0 Can't get device info: No such device</span></span></code> </pre> <br><pre> <code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># bluetoothd -n &amp; [1] 5449 root@trik-7dda93:~# bluetoothd[5449]: Bluetooth daemon 4.101 bluetoothd[5449]: Starting SDP server bluetoothd[5449]: Bluetooth Management interface initialized</span></span></code> </pre> <br><p>  Llamando a amigos en busca de un m√≥dulo USB externo, continu√© buscando. </p><br><p>  Despu√©s de desmontar el controlador, se encontr√≥ el m√≥dulo Jorjin WG7311-0A.  La <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">especificaci√≥n</a> establece que realmente hay Wi-Fi, Bluetooth e incluso una radio FM.  La interfaz para comunicarse con Bluetooth es UART, y se activa a trav√©s de BT_EN. </p><br><p><img src="https://habrastorage.org/webt/de/5d/qh/de5dqhz_nocaef_cwt0fh_d5umc.jpeg"></p><br><p>  Despu√©s de leer c√≥mo se conecta el m√≥dulo Bluetooth a trav√©s de UART a trav√©s de hcitool, prob√© suerte y nada.  Dos de los tres puertos UART libres estaban en silencio. </p><br><p>  Pero tenemos contacto BT_EN!  Es posible que el m√≥dulo simplemente est√© apagado y no responda a las solicitudes.  Despu√©s de examinar el dispositivo del kernel de Linux para dispositivos ARM, se encontr√≥ un archivo donde se registran todos los contactos utilizados por SoC.  Al abrir <code>arch/arm/mach-davinci/board-da850-trik.c</code> en el c√≥digo fuente del n√∫cleo, se encontr√≥ un contacto GPIO para Bluetooth.  Victoria!  Pens√© </p><br><pre> <code class="hljs objectivec"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> da850_trik_bluetooth_pins[] __initconst = { DA850_GPIO6_11, <span class="hljs-comment"><span class="hljs-comment">/*BT_EN_33 */</span></span> DA850_GPIO6_10, <span class="hljs-comment"><span class="hljs-comment">/*BT_WU_33*/</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span> };</code> </pre> <br><h1 id="etap-2-nastuplenie">  Etapa 2. Ofensiva </h1><br><p>  Para habilitar un contacto a trav√©s de GPIO, debe encontrar su n√∫mero de serie de extremo a extremo.  Encontramos la siguiente l√≠nea en el c√≥digo del kernel con una solicitud para inicializar el contacto BT_EN_33 en <code>arch/arm/mach-davinci/board-da850-trik.c</code> : </p><br><pre> <code class="hljs lisp">ret = gpio_request_one(<span class="hljs-name"><span class="hljs-name">GPIO_TO_PIN</span></span>(<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>), GPIOF_OUT_INIT_LOW, <span class="hljs-string"><span class="hljs-string">"BT_EN_33"</span></span>)<span class="hljs-comment"><span class="hljs-comment">;</span></span></code> </pre> <br><p>  Utiliza la macro GPIO_TO_PIN.  Consulte la descripci√≥n de la macro en <code>arch/arm/mach-davinci/include/mach/gpio-davinci.h</code> : </p><br><pre> <code class="hljs cs"><span class="hljs-comment"><span class="hljs-comment">/* Convert GPIO signal to GPIO pin number */</span></span> <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> GPIO_TO_PIN(bank, gpio) (16 * (bank) + (gpio))</span></span></code> </pre> <br><p>  Utiliz√°ndolo, puede encontrar el n√∫mero de contacto de extremo a extremo.  Obtenemos que 16 * 6 + 11 = 107. Ahora pasamos a la inclusi√≥n del contacto. </p><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> 1 &gt;&gt; /sys/devices/virtual/gpio/gpio107/value</code> </pre> <br><p>  0 o 1 en el comando echo es el estado del contacto. </p><br><p>  Ejecute el comando para conectarse y ... </p><br><pre> <code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># hciattach /dev/ttyS0 texas Found a Texas Instruments' chip! Firmware file : /lib/firmware/TIInit_7.6.15.bts can't open firmware file: No such file or directory Warning: cannot find BTS file: /lib/firmware/TIInit_7.6.15.bts Device setup complete</span></span></code> </pre> <br><p>  incomprensible para nosotros (por el momento) mensajes de error.  Intentamos configurar el dispositivo a trav√©s de hcitool: </p><br><pre> <code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># hcitool dev Devices:</span></span></code> </pre> <br><p>  No hay dispositivos, aunque la inicializaci√≥n supuestamente pas√≥.  Intentamos conectarnos por segunda vez, pero con un tipo diferente de adaptador: </p><br><pre> <code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># hciattach /dev/ttyS0 texasalt Texas module LMP version : 0x06 Texas module LMP sub-version : 0x1f0f internal version freeze: 15 software version: 6 chip: wl1271 (7) Opening firmware file: /etc/firmware/wl1271.bin Could not open firmware file /etc/firmware/wl1271.bin: No such file or directory (2). Device setup complete</span></span></code> </pre> <br><p>  Y de nuevo, nada.  Volvamos al primer error y apliquemos el conocimiento del ingl√©s: </p><br><pre> <code class="bash hljs">Warning: cannot find BTS file: /lib/firmware/TIInit_7.6.15.bts</code> </pre> <br><p>  Abrimos la carpeta / lib / firmware con firmware y no encontramos el archivo que necesitamos.  Despu√©s de una larga b√∫squeda en Internet, encontramos el archivo deseado en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">el repositorio de TI</a> y lo descargamos.  Otras versiones del mismo archivo se negaron a funcionar. </p><br><pre> <code class="bash hljs">curl -k https://git.ti.com/wilink8-bt/ti-bt-firmware/blobs/raw/45897a170bc30afb841b1491642e774f0c89b584/TIInit_7.6.15.bts &gt; TIInit_7.6.15.bts cp TIInit_7.6.15.bts /lib/firmware/TIInit_7.6.15.bts</code> </pre> <br><p>  Reiniciamos el controlador y volvemos a conectar: </p><br><pre> <code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># echo 1 &gt;&gt; /sys/devices/virtual/gpio/gpio107/value root@trik-7dda93:~# hciattach /dev/ttyS0 texas Found a Texas Instruments' chip! Firmware file : /lib/firmware/TIInit_7.6.15.bts Loaded BTS script version 1 Device setup complete</span></span></code> </pre> <br><p>  ¬°Hurra!  El firmware ha arrancado.  Comprobando hciconfig: </p><br><pre> <code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># hciconfig hci0: Type: BR/EDR Bus: UART BD Address: 78:**:**:**:**:B3 ACL MTU: 1021:4 SCO MTU: 180:4 DOWN RX bytes:509 acl:0 sco:0 events:21 errors:0 TX bytes:388 acl:0 sco:0 commands:21 errors:0</span></span></code> </pre> <br><p>  Iniciamos el servicio bluetoothd, buscamos dispositivos y detectamos nuestro m√≥dulo: </p><br><pre> <code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># bluetoothd -n &amp; [1] 4689 bluetoothd[4689]: Bluetooth daemon 4.101 bluetoothd[4689]: Starting SDP server bluetoothd[4689]: Bluetooth Management interface initialized bluetoothd[4689]: Parsing /etc/bluetooth/serial.conf failed: No such file or directory bluetoothd[4689]: Could not get the contents of DMI chassis type bluetoothd[4689]: Adapter /org/bluez/4689/hci0 has been enabled root@trik-7dda93:~# hciconfig hci0 piscan</span></span></code> </pre> <br><p>  Una b√∫squeda en la computadora encuentra un dispositivo: </p><br><p><img src="https://habrastorage.org/webt/vs/bz/mb/vsbzmb32vz8tbechhhpuroku9qs.png"></p><br><p>  Para habilitar Bluetooth, puede hacer un script: </p><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash case "$1" in start) echo 1 &gt;&gt; /sys/devices/virtual/gpio/gpio107/value bluetoothd -n &amp; hciattach /dev/ttyS0 texas hciconfig hci0 piscan ;; stop) ;; restart) ;; status) ;; *) ;;</span></span></code> </pre> <br><p>  Y agr√©guelo a la ejecuci√≥n autom√°tica: </p><br><pre> <code class="bash hljs">cp init-bluetooth /etc/init.d/init-bluetooth update-rc.d init-bluetooth <span class="hljs-built_in"><span class="hljs-built_in">enable</span></span> 99</code> </pre> <br><p>  El reinicio y el apagado del m√≥dulo se comportan de manera impredecible, por lo tanto, las opciones de detenci√≥n y reinicio no tienen comandos. </p><br><h1 id="etap-3-proverka-svyazi">  Etapa 3. Verificaci√≥n de comunicaci√≥n </h1><br><p>  La forma m√°s f√°cil de verificar la comunicaci√≥n en ambas direcciones es el servicio del puerto COM.  Con unos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">pocos comandos,</a> enci√©ndalo: </p><br><pre> <code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># sdptool add --channel=3 SP Serial Port service registered root@trik-7dda93:~# mknod -m 666 /dev/rfcomm0 c 216 0 root@trik-7dda93:~# rfcomm watch /dev/rfcomm0 3 /sbin/getty rfcomm0 115200 linux Waiting for connection on channel 3</span></span></code> </pre> <br><p>  Nos conectamos desde el tel√©fono y vemos una invitaci√≥n para ingresar al sistema: </p><br><p><img src="https://habrastorage.org/webt/0i/lw/p9/0ilwp9kassasp_xfmvc3xhcwvl8.png"></p><br><p>  Ninguno de los terminales probados permiti√≥ ingresar una contrase√±a de usuario vac√≠a, por lo que tuve que enviar informaci√≥n de inicio de sesi√≥n utilizando la redirecci√≥n de hilos en una sesi√≥n SSH. </p><br><h1 id="etap-4-configure--make">  Etapa 4. ./configure &amp;&amp; make </h1><br><p>  Siguiendo las instrucciones <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">para conectar un gamepad a Linux,</a> encontramos los siguientes problemas: </p><br><ul><li>  BlueZ en la distribuci√≥n est√° desactualizado y no entiende los comandos del sixad daemon, que establece una conexi√≥n con el gamepad </li><li>  La nueva versi√≥n de BlueZ de la fuente se niega a compilar debido a muchas dependencias </li><li>  FreshZian BlueZ requiere udev y systemd, que faltan en la distribuci√≥n actual </li></ul><br><p>  La √∫nica dependencia que pudo satisfacer fue el m√≥dulo del n√∫cleo uinput. </p><br><p>  Para hacer esto: </p><br><ul><li>  obtener la configuraci√≥n del n√∫cleo actual en el dispositivo </li></ul><br><pre> <code class="bash hljs">cp /proc/config.gz config.gz gunzip config.gz</code> </pre> <br><ul><li>  descargar el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">c√≥digo del kernel</a> </li><li>  descargar e instalar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">toolchain</a> </li><li>  copie la configuraci√≥n del kernel a la carpeta con el c√≥digo del kernel </li><li>  agregue el m√≥dulo uinput a la configuraci√≥n </li></ul><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"CONFIG_INPUT_UINPUT=m"</span></span> &gt;&gt; config</code> </pre> <br><ul><li>  comience el ensamblaje encendiendo primero la cadena de herramientas </li></ul><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">source</span></span> /opt/trik-sdk/environment-setup-arm926ejste-oe-linux-gnueabi make</code> </pre> <br><ul><li>  copie los m√≥dulos del n√∫cleo a la tarjeta de memoria </li></ul><br><pre> <code class="bash hljs">make INSTALL_MOD_PATH=/mnt/trik-sd modules_install</code> </pre> <br><ul><li>  construya la imagen uBoot y c√≥piela en / boot </li></ul><br><pre> <code class="bash hljs">make uImage cp arch/arm/boot/uImage /mnt/trik-sd/boot/uImage-3.6.7</code> </pre> <br><p>  Ahora el programa no jura por la falta de un m√≥dulo de kernel, pero entonces no podemos hacer nada.  Las instrucciones para el gamepad ser√°n √∫tiles m√°s tarde. </p><br><h1 id="etap-5-varim-kashu-iz-topora">  Etapa 5. Cocine las gachas del hacha </h1><br><p>  Llegando al plan "tyap-blooper".  Como no hay una manera conveniente de poner los programas necesarios en la distribuci√≥n original, pondremos algo popular.  El procesador tiene una arquitectura ARMv5TE, lo que significa que hay distribuciones para √©l. </p><br><p>  Intentamos desempaquetar y ejecutar Arch Linux universal para ARM y al cargar en la consola vemos que systemd requiere una versi√≥n de kernel m√°s nueva, que no tenemos.  Los intentos de transferir el kernel 4.16 no tuvieron √©xito y tom√≥ demasiado tiempo. </p><br><p>  Pasamos a otra opci√≥n: Debian.  Existe una imagen de disco con un sistema instalado para ARM, pero es mejor poner un sistema limpio con los paquetes y configuraciones necesarias para nosotros. </p><br><h2 id="ustanovka-v-qemu">  Instalaci√≥n en QEMU </h2><br><p>  Descargue la imagen de instalaci√≥n (enlace a <a href="">.iso</a> ) e instale QEMU. <br>  Tambi√©n necesitamos el n√∫cleo y la imagen initrd para iniciar la instalaci√≥n, que se puede descargar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">desde aqu√≠</a> . </p><br><p>  Cree una imagen de una tarjeta de memoria con el tama√±o de una tarjeta de memoria real (en este caso, 4 GB): </p><br><pre> <code class="bash hljs">qemu-img create -f raw debian.img 4G</code> </pre> <br><p>  Comenzamos la instalaci√≥n: </p><br><pre> <code class="bash hljs">qemu-system-arm -M versatilepb -kernel vmlinuz-3.2.0-4-versatile -initrd initrd.gz -hda debian.img -cdrom debian-7.11.0-armel-CD-1.iso</code> </pre> <br><p>  Si va a hacer un dise√±o de disco de una distribuci√≥n original relativa no est√°ndar, primero deje la partici√≥n ra√≠z, de lo contrario tendr√° que cambiar los par√°metros de arranque del n√∫cleo en uBoot.  Existe el n√∫mero de la partici√≥n en la que se encuentra el sistema de archivos ra√≠z. </p><br><p>  El marcado est√°ndar contiene: </p><br><ol><li>  Partici√≥n EXT4 para root 1.3 GB del sistema de archivos ra√≠z </li><li>  Partici√≥n FAT32 para almacenar datos de usuario ‚âà 500 MB de tama√±o </li></ol><br><p>  La salida de fdisk para la imagen de la distribuci√≥n original: </p><br><pre> <code class="hljs powershell">Disk: trik<span class="hljs-literal"><span class="hljs-literal">-distro</span></span>.img geometry: <span class="hljs-number"><span class="hljs-number">893</span></span>/<span class="hljs-number"><span class="hljs-number">64</span></span>/<span class="hljs-number"><span class="hljs-number">63</span></span> [<span class="hljs-number"><span class="hljs-number">3604478</span></span> <span class="hljs-type"><span class="hljs-type">sectors</span></span>] Signature: <span class="hljs-number"><span class="hljs-number">0</span></span>xAA55 Starting Ending <span class="hljs-comment"><span class="hljs-comment">#: id cyl hd sec - cyl hd sec [ start - size] ------------------------------------------------------------------------ 1: 83 1023 3 32 - 1023 3 32 [ 1040382 - 2564096] Linux files* 2: 0C 64 0 1 - 1023 3 32 [ 8192 - 1032190] Win95 FAT32L 3: 00 0 0 0 - 0 0 0 [ 0 - 0] unused 4: 00 0 0 0 - 0 0 0 [ 0 - 0] unused</span></span></code> </pre><br><p>  Despu√©s de configurar los par√°metros, dejamos tomar unas tazas de t√©, porque  El emulador no es mucho m√°s r√°pido que un procesador ARM real. </p><br><p>  Para iniciar el sistema instalado, necesita otra imagen initrd, que se puede tomar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">desde aqu√≠</a> . </p><br><p>  Iniciamos el sistema: </p><br><pre> <code class="bash hljs">qemu-system-arm -M versatilepb -kernel vmlinuz-3.2.0-4-versatile -initrd initrd.img-3.2.0-4-versatile -hda debian.img -append <span class="hljs-string"><span class="hljs-string">"root=/dev/sda1"</span></span></code> </pre> <br><h2 id="nastroyka-sistemy">  Configuraci√≥n del sistema </h2><br><p>  Despu√©s de comenzar, ingresamos al superusuario, verificamos la conexi√≥n a Internet, actualizamos los repositorios y el sistema, colocamos el conjunto m√≠nimo de programas: </p><br><pre> <code class="bash hljs">apt-get update apt-get upgrade apt-get install curl git mc htop joystick</code> </pre> <br><h3 id="terminaly">  Terminales </h3><br><p>  Editamos <code>/etc/inittab</code> , eliminamos terminales innecesarios, activamos el UART que necesitamos para nosotros y agregamos la entrada autom√°tica para el usuario correcto (use root solo cuando depure).  La entrada autom√°tica es √∫til si planea ejecutar el shell para el control en el controlador. </p><br><pre> <code class="hljs ruby"><span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">2345</span></span><span class="hljs-symbol"><span class="hljs-symbol">:respawn</span></span><span class="hljs-symbol"><span class="hljs-symbol">:/sbin/getty</span></span> <span class="hljs-number"><span class="hljs-number">38400</span></span> tty1 --autologin root <span class="hljs-comment"><span class="hljs-comment">#2:23:respawn:/sbin/getty 38400 tty2 #3:23:respawn:/sbin/getty 38400 tty3 #4:23:respawn:/sbin/getty 38400 tty4 #5:23:respawn:/sbin/getty 38400 tty5 #6:23:respawn:/sbin/getty 38400 tty6 uart:12345:respawn:/sbin/getty -L 115200 ttyS1</span></span></code> </pre> <br><h3 id="bluetooth-i-wi-fi">  Bluetooth y wifi </h3><br><p>  Instale bluez-utils y wpasupplicant para acceder a Wi-Fi y Bluetooth. </p><br><pre> <code class="bash hljs">apt-get install bluez-utils wpasupplicant</code> </pre> <br><p>  Desactivamos la interfaz eth0 y configuramos la interfaz wlan1 en <code>/etc/network/interfaces</code> : </p><br><pre> <code class="hljs kotlin"># /etc/network/interfaces -- configuration file <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ifup(<span class="hljs-number"><span class="hljs-number">8</span></span>), ifdown(<span class="hljs-number"><span class="hljs-number">8</span></span>) # The loopback <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">auto</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">lo</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">iface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">lo</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">inet</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">loopback</span></span></span><span class="hljs-class"> # </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Wireless</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">interfaces</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">auto</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wlan1</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">iface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wlan1</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">inet</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dhcp</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wireless_mode</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">managed</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wireless_essid</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">any</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wpa</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">driver</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wext</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wpa</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">conf</span></span></span><span class="hljs-class"> /</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">etc</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wpa_supplicant</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">conf</span></span></span></span></code> </pre> <br><p>  Agregue la red por adelantado a <code>/etc/wpa_supplicant.conf</code> , porque  hacer esto en el controlador en s√≠ no es tan conveniente: </p><br><pre> <code class="bash hljs">wpa_passphrase ssid password &gt;&gt; /etc/wpa_supplicant.conf</code> </pre> <br><p>  Si no tiene acceso a Wi-Fi, puede usar UART para una configuraci√≥n adicional, pero tenga en cuenta que, de forma predeterminada, el n√∫cleo muestra todos los errores en este terminal.  Por lo tanto, durante la operaci√≥n, un mensaje repentino del n√∫cleo o servicio puede interrumpirlo. </p><br><p>  Agregue un script para habilitar Bluetooth.  Esta vez, modifique <code>/etc/init.d/bluetooth</code> : </p><br><pre> <code class="bash hljs"> 139: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-variable"><span class="hljs-variable">$1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> start) <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> 1 &gt;&gt; /sys/devices/virtual/gpio/gpio107/value  168: hciattach /dev/ttyS0 texas log_end_msg 0 ;;</code> </pre><br><p>  Por lo tanto, todos los servicios que requieren el servicio Bluetooth ejecutar√°n los comandos necesarios para inicializar. </p><br><h3 id="vzmah-vlevo-vzmah-vpravo">  Deslizar hacia la izquierda, deslizar hacia la derecha </h3><br><p>  Eliminamos programas y servicios innecesarios que se pueden ver usando htop, porque ocupan un lugar precioso en la RAM: </p><br><p><img src="https://habrastorage.org/webt/4e/rg/av/4ergavw2trhiiyvvlnmdtc1luhk.png"></p><br><p>  En este caso, el servicio ConsoleKit tiene <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">muchos procesos</a> .  Mueva el archivo de este servicio a la carpeta ra√≠z en caso de recuperaci√≥n: </p><br><pre> <code class="bash hljs">mv /usr/share/dbus-1/system-services/org.freedesktop.ConsoleKit.service /root/</code> </pre> <br><p>  Antes de cerrar el servicio, el consumo de RAM era de 19 MB y, despu√©s, de 16 MB. </p><br><h3 id="razdely-sistemy">  Secciones del sistema </h3><br><p>  Aunque uBoot transfiere al n√∫cleo el dispositivo en el que se encuentra la partici√≥n ra√≠z, vale la pena escribirlo en <code>/etc/fstab</code> para mayor confiabilidad.  Cambiamos la primera l√≠nea responsable de la secci√≥n ra√≠z: </p><br><pre> <code class="hljs mel">/dev/mmcblk0p1 / auto defaults <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">proc</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">proc</span></span> <span class="hljs-keyword"><span class="hljs-keyword">proc</span></span> defaults <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> devpts /dev/pts devpts mode=<span class="hljs-number"><span class="hljs-number">0620</span></span>,gid=<span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> usbdevfs /<span class="hljs-keyword"><span class="hljs-keyword">proc</span></span>/bus/usb usbdevfs noauto <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> tmpfs /run tmpfs mode=<span class="hljs-number"><span class="hljs-number">0755</span></span>,nodev,nosuid,strictatime <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> tmpfs /var/volatile tmpfs defaults <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br><p>  Si no hizo la partici√≥n ra√≠z la primera, no olvide especificar el n√∫mero de partici√≥n deseado. </p><br><p>  Si dej√≥ la segunda partici√≥n FAT para datos de usuario, entonces necesita crear una carpeta para montar la partici√≥n en ella </p><br><pre> <code class="bash hljs">mkdir /usr/share/trik</code> </pre> <br><p>  y escriba la secci√≥n en <code>/etc/fstab</code> : </p><br><pre> <code class="bash hljs">/dev/mmcblk0p2 /usr/share/trik vfat defaults 0 0</code> </pre> <br><h1 id="etap-6-probuem-nashu-kashu">  Etapa 6. Probamos nuestras gachas </h1><br><p>  Despu√©s de configurar la imagen del sistema, debe montarla para instalar los m√≥dulos del n√∫cleo y el n√∫cleo mismo: </p><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># ,     (start) fdisk -l debian.img mount -o loop,offset=NNNN debian.img /mnt/debian</span></span></code> </pre> <br><p>  donde, NNNN = tama√±o del sector * inicio de secci√≥n.  El tama√±o de sector predeterminado es 512 bytes. </p><br><p>  Tambi√©n montamos la distribuci√≥n original: </p><br><pre> <code class="bash hljs">fdisk -l trik-distro.img mount -o loop,offset=NNNN trik-distro.img /mnt/trik-clean</code> </pre> <br><p>  Eliminamos el kernel para QEMU y sus m√≥dulos, como  No est√°n destinados a nuestra plataforma.  Copiamos el nuevo n√∫cleo y los m√≥dulos, al igual que en la distribuci√≥n original. </p><br><pre> <code class="hljs powershell">rm <span class="hljs-literal"><span class="hljs-literal">-rf</span></span> /mnt/debian/boot/ rm <span class="hljs-literal"><span class="hljs-literal">-rf</span></span> /mnt/debian/lib/modules/<span class="hljs-number"><span class="hljs-number">3.2</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-literal"><span class="hljs-literal">-4</span></span><span class="hljs-literal"><span class="hljs-literal">-versatile</span></span> rm <span class="hljs-literal"><span class="hljs-literal">-rf</span></span> /mnt/debian/lib/modules/<span class="hljs-number"><span class="hljs-number">3.2</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-literal"><span class="hljs-literal">-5</span></span><span class="hljs-literal"><span class="hljs-literal">-versatile</span></span> mkdir /mnt/debian/boot/ cp arch/arm/boot/uImage /mnt/debian/boot/ make INSTALL_MOD_PATH=/mnt/debian modules_install</code> </pre> <br><p>  Necesitaremos firmware para el m√≥dulo Wi-Fi, que se encuentra en la distribuci√≥n original en la carpeta / lib / firmware y el firmware de Bluetooth que encontramos anteriormente. </p><br><pre> <code class="hljs ruby">cp /mnt/trik-clean/lib/firmware/* <span class="hljs-regexp"><span class="hljs-regexp">/mnt/debian</span></span><span class="hljs-regexp"><span class="hljs-regexp">/lib/firmware</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ cp TIInit_7.6.15.bts /mnt</span></span><span class="hljs-regexp"><span class="hljs-regexp">/debian/lib</span></span><span class="hljs-regexp"><span class="hljs-regexp">/firmware/</span></span></code> </pre> <br><p>  Desconectar im√°genes de disco: </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">umount</span></span> /mnt/trik-clean umount /mnt/debian</code> </pre> <br><p>  Y comience a copiar la imagen a la tarjeta de memoria usando dd: </p><br><pre> <code class="hljs cs"><span class="hljs-meta"><span class="hljs-meta">#    ( ) lsblk dd </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta">=debian.img of=/dev/sdX bs=4M</span></span></code> </pre> <br><h1 id="etap-7-finishnaya-pryamaya">  Etapa 7. La l√≠nea de meta. </h1><br><p>  Compilamos los programas para conectar el gamepad en el nuevo sistema e instalamos el demonio sixad. </p><br><p>  Conectamos el gamepad por USB al controlador y ejecutamos el programa para crear un par: </p><br><pre> <code class="bash hljs">root@trik:~/bt<span class="hljs-comment"><span class="hljs-comment"># ./sixpair Current Bluetooth master: 78:**:**:**:**:b9 Setting master bd_addr to 78:**:**:**:**:b9</span></span></code> </pre> <br><p>  Cuando el gamepad est√° conectado, no pasa nada y el servicio sixad est√° en silencio: </p><br><pre> <code class="bash hljs">sixad-bin[2675]: started sixad-bin[2675]: sixad started, press the PS button now sixad-bin[2675]: unable to connect to sdp session</code> </pre> <br><p>  Pero la comunidad Raspberry Pi ya ha hecho una "muleta" para arreglar la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">conexi√≥n</a> . </p><br><p>  Reconstruimos el programa y nos regocijamos. </p><br><pre> <code class="hljs powershell">sixad<span class="hljs-literal"><span class="hljs-literal">-bin</span></span>[<span class="hljs-number"><span class="hljs-number">2833</span></span>]: started sixad<span class="hljs-literal"><span class="hljs-literal">-bin</span></span>[<span class="hljs-number"><span class="hljs-number">2833</span></span>]: sixad started, press the PS button now sixad<span class="hljs-literal"><span class="hljs-literal">-bin</span></span>[<span class="hljs-number"><span class="hljs-number">2833</span></span>]: unable to connect to sdp session sixad<span class="hljs-literal"><span class="hljs-literal">-sixaxis</span></span>[<span class="hljs-number"><span class="hljs-number">2836</span></span>]: started sixad<span class="hljs-literal"><span class="hljs-literal">-sixaxis</span></span>[<span class="hljs-number"><span class="hljs-number">2836</span></span>]: Connected <span class="hljs-string"><span class="hljs-string">'PLAYSTATION(R)3 Controller (00:**:**:**:**:09)'</span></span> [<span class="hljs-type"><span class="hljs-type">Battery</span></span> <span class="hljs-number"><span class="hljs-number">02</span></span>]</code> </pre> <br><p>  Ahora el gamepad est√° disponible para el sistema como dispositivo de entrada y el programa jstest mostrar√° el estado de todos los botones y sensores anal√≥gicos: </p><br><pre> <code class="hljs apache"><span class="hljs-attribute"><span class="hljs-attribute">root</span></span>@trik:~# ls /dev/input/ by-path event0 event1 event2 event3 js0 js1 js2 mice root@trik:~# jstest --normal /dev/input/jsX Driver version is 2.1.0. Joystick (PLAYSTATION(R)3 Controller (00:**:**:**:**:09)) has 29 axes (X, Y, Z, Rx, Ry, Rz, Throttle, Rudder, Wheel, Gas, Brake, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, (null), (null), (null), (null), (null), (null), (null), (null)) and 17 buttons (Trigger, ThumbBtn, ThumbBtn2, TopBtn, TopBtn2, PinkieBtn, BaseBtn, BaseBtn2, BaseBtn3, BaseBtn4, BaseBtn5, BaseBtn6, BtnDead, BtnA, BtnB, BtnC, BtnX). Testing ... (interrupt to exit) Axes: 0: 0 1: 0 2: 0 3: 0 4: -7150 5: -7746 6:-32767 7: 0 8: 0 9: 0 10: 0 11: 0 12: 0 13: 0 14: 0 15: 0 16: 0 17: 0 18: 0 19: 0 20: 0 21: 0 22: 0 23: 0 24: 0 25: 0 26: 0 27: 0 28: 0 Buttons: 0:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 1:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 2:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 3:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 4:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 5:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 6:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 7:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 8:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 9:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 10:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 11:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 12:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 13:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 14:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 15:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 16:<span class="hljs-literal"><span class="hljs-literal">off</span></span></code> </pre> <br><p>  donde X es el n√∫mero de dispositivo en el sistema, por defecto - 2. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Aqu√≠</a> se puede ver la cantidad de botones y ejes. </p><br><h1 id="ispolzuem-na-praktike">  Usar en la pr√°ctica </h1><br><p>  Video que muestra el gamepad en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">YouTube</a> . </p><br><div class="spoiler">  <b class="spoiler_title">Fotos de la distribuci√≥n.</b> <div class="spoiler_text"><p>  Kernel cargando: <br><img src="https://habrastorage.org/webt/aj/mx/xt/ajmxxtarcapbe4hwfefj5-v83ws.jpeg"><br>  Terminal que se ejecuta en X11: <br><img src="https://habrastorage.org/webt/bi/gn/vk/bignvkyajckcuobz8rzgyf5priw.jpeg"></p><br><p><img src="https://habrastorage.org/webt/cp/6k/pu/cp6kpumd7uxcxnlyc3jg7mpmn2m.jpeg"><br>  Y seg√∫n la tradici√≥n: <br><img src="https://habrastorage.org/webt/9f/et/xk/9fetxkfu74mdacfatuwnaodrmj8.jpeg"></p><br><p><img src="https://habrastorage.org/webt/qw/mi/1h/qwmi1hncq77acchz8dfjfpzs334.jpeg"></p></div></div><br><h3 id="poleznye-ssylki">  Enlaces utiles </h3><br><p>  Programas para conectar el gamepad Dualshock 3: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sixpair</a> y <a href="">sixad</a> . </p><br><p>  Para gamepads y otros dispositivos de entrada, hay una biblioteca C ligera: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">libenjoy</a> . </p><br><p>  El c√≥digo fuente del programa para controlar servomotores y motores es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">el repositorio de GitHub</a> . </p><br><p>  Todos los archivos de configuraci√≥n del art√≠culo para un kit de distribuci√≥n improvisado son <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">el repositorio de GitHub</a> . </p><br><p>  La fuente del n√∫cleo es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">el repositorio de GitHub</a> . </p><br><h1 id="interesnye-fakty-o-kontrollere">  Datos interesantes sobre el controlador </h1><br><ul><li>  La especificaci√≥n establece que la RAM es de 256 MB.  Pero si ejecuta htop, ver√° que solo 128 MB est√°n disponibles.  Esto est√° limitado por las opciones del kernel que se pueden ver en la consola uBoot: </li></ul><br><pre> <code class="bash hljs">mem=128M console=ttyS1,115200n8 rw noinitrd rootwait root=/dev/mmcblk0p1 vt.global_cursor_default=0 consoleblank=0</code> </pre> <br><p>  El chip de memoria est√° marcado 3PC22 D9MTD fabricado por Micron.  No fue posible encontrar informaci√≥n sobre su volumen actual. </p><br><ul><li>  uBoot se almacena en la memoria flash SPI en la que el n√∫cleo tambi√©n est√° conectado y no se usa.  Puede intentar usar este lugar para sus tareas o copiar un nuevo kernel y reconfigurar uBoot para que lo use. </li></ul><br><p>  Direcciones de im√°genes de dmesg: </p><br><pre> <code class="bash hljs">[ 11.598170] 0x000000000000-0x000000040000 : <span class="hljs-string"><span class="hljs-string">"uboot"</span></span> [ 11.642985] 0x000000040000-0x000000080000 : <span class="hljs-string"><span class="hljs-string">"uboot-env1"</span></span> [ 11.706256] 0x000000080000-0x0000000c0000 : <span class="hljs-string"><span class="hljs-string">"uboot-env2"</span></span> [ 11.761827] 0x0000000c0000-0x000000100000 : <span class="hljs-string"><span class="hljs-string">"config-periph"</span></span> [ 11.805129] 0x000000100000-0x000000400000 : <span class="hljs-string"><span class="hljs-string">"kernel"</span></span> [ 11.861864] 0x000000400000-0x000001000000 : <span class="hljs-string"><span class="hljs-string">"RootFS"</span></span></code> </pre> <br><ul><li>  La pantalla del controlador, aunque peque√±a, en realidad tiene un sensor resistivo.  Se desconoce si el sensor est√° conectado. </li><li>  Dualshock 3 tiene LED en el conector USB que muestra el n√∫mero del gamepad / joystick.  Hay un gamepad en el video, pero su n√∫mero es 3. Esto no es un error, porque  Hay dos "joysticks" m√°s en el sistema: un aceler√≥metro y un giroscopio. </li></ul><br><h1 id="problemy-voznikshie-pri-ispolzovanii">  Problemas encontrados al usar </h1><br><ul><li>  El robot a veces se cuelga con fuerza, sin apagar los servomotores, lo que les permite cambiar su posici√≥n del ruido en la l√≠nea de datos.  Esto se ha visto incluso en una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">distribuci√≥n est√°ndar</a> . </li><li>  La inclusi√≥n de controladores PWM es diferente de lo que est√° escrito en la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">documentaci√≥n</a> .  Al menos en C puro esto no funcion√≥. </li><li>  USB a veces deja de funcionar en Debian. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es415007/">https://habr.com/ru/post/es415007/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es414997/index.html">ML-Blitz: an√°lisis de las tareas de la primera ronda de clasificaci√≥n</a></li>
<li><a href="../es414999/index.html">Probador 3D de vigilancia y termistor</a></li>
<li><a href="../es415001/index.html">El operador del autom√≥vil rob√≥tico Uber, que derrib√≥ a un ciclista, vio el espect√°culo de Voz en el momento de la colisi√≥n.</a></li>
<li><a href="../es415003/index.html">Carga de archivos sin restricciones en Apple.com</a></li>
<li><a href="../es415005/index.html">Paneles solares, comandos de voz y carreras off-road: el presente y el futuro de las bicicletas el√©ctricas.</a></li>
<li><a href="../es415009/index.html">¬øQui√©n es ese en el reclutamiento de Am√©rica del Norte? Parte 1</a></li>
<li><a href="../es415011/index.html">Informe del Club de Roma 2018, Cap√≠tulo 3.10: ‚ÄúImpuesto sobre los ritmos‚Äù</a></li>
<li><a href="../es415015/index.html">Calificaci√≥n de los empleadores de TI en Nizhny Novgorod: un estudio de las preferencias de los estudiantes de especialidades t√©cnicas</a></li>
<li><a href="../es415017/index.html">Producto .NET que salva vidas</a></li>
<li><a href="../es415019/index.html">Comercializaci√≥n Casi complicado</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>