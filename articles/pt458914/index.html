<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©‚Äç‚úàÔ∏è üï∫üèø üîü O que (n√£o) voc√™ precisa saber para criar jogos no Unity ü§≤ ‚óÄÔ∏è üëÑ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O Unity √© um mecanismo de jogo com um limite de entrada longe de zero (comparando com o mesmo Game Maker Studio) e, neste artigo, mostrarei quais prob...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>O que (n√£o) voc√™ precisa saber para criar jogos no Unity</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/458914/"><img width="100%" src="https://habrastorage.org/webt/tf/uv/8n/tfuv8nnybrkzyxholyzuoaasafo.png"><br><br>  O Unity √© um mecanismo de jogo com um limite de entrada longe de zero (comparando com o mesmo Game Maker Studio) e, neste artigo, mostrarei quais problemas encontrei ao come√ßar a estud√°-lo e quais solu√ß√µes encontrei.  Descreverei esses momentos com o exemplo do meu jogo de quebra-cabe√ßa 2D para Android (que espero que seja lan√ßado em breve no Play Market). <a name="habracut"></a><br><br>  Eu n√£o finjo ser verdade, e n√£o exorto que voc√™ repita o processo, se voc√™ souber o melhor caminho, apenas mostrarei como faz√™-lo, e talvez algu√©m que esteja come√ßando a se familiarizar com o Unity crie sua pr√≥pria obra-prima independente com menos trabalho. <br><br>  Sou engenheiro de projeto de usina, mas sempre me interessei por codifica√ß√£o e conhe√ßo algumas linguagens de programa√ß√£o.  Portanto, concordamos que, para criar jogos no Unity: <br><ul><li>  Voc√™ precisa conhecer um pouco de C # ou JavaScript (pelo menos a sintaxe em forma de C). <br></li></ul><br>  Tudo o que ser√° escrito abaixo n√£o √© um tutorial do Unity, do qual foram criados suficientes na rede sem mim.  A seguir, ser√£o coletados os momentos dif√≠ceis que podem ocorrer ao criar seu primeiro projeto no Unity. <br><br>  Vale a pena advertir que os scripts fornecidos omitem a maior parte da l√≥gica do jogo (representando "segredos comerciais"), mas seu desempenho como exemplos foi verificado. <br><br><h3>  Problema Um - Orienta√ß√£o </h3><br><img align="left" width="40%" src="https://habrastorage.org/webt/-f/za/hw/-fzahwdptbht2vwe1qm4xswgqkm.png"><br>  <b>Trava de orienta√ß√£o</b> <br>  A primeira dificuldade que surgiu em mim foi n√£o prestar a devida aten√ß√£o √† otimiza√ß√£o da interface visual para orienta√ß√£o da tela.  A solu√ß√£o √© a mais simples - se voc√™ n√£o precisar alterar a orienta√ß√£o da tela para jogar, √© melhor bloque√°-la.  N√£o h√° necessidade de flexibilidade excessiva, voc√™ est√° escrevendo um jogo independente, n√£o um projeto do outro lado de um milh√£o de d√≥lares.  Por que toneladas de transi√ß√µes condicionais e mudan√ßa de √¢ncoras se o jogo parece melhor em Retrato (por exemplo).  Voc√™ pode bloquear a orienta√ß√£o da tela aqui: <br>  <b>Editar&gt; Configura√ß√µes do projeto&gt; Player</b> <br clear="all"><br clear="all"><img align="right" width="40%" src="https://habrastorage.org/webt/jb/3u/ot/jb3uotkehyw_t2pa2e__yw0n2ng.png"><br>  <b>Permiss√µes diferentes</b> <br>  Tamb√©m √© importante testar a interface visual em diferentes resolu√ß√µes na orienta√ß√£o selecionada e, ao testar, n√£o se esque√ßa da exist√™ncia de dispositivos com propor√ß√µes de 4: 3 (bom ou 3: 4), para que possamos adicionar com seguran√ßa 768x1024 (ou 1024x768). <br><br>  <b>Melhor posicionamento</b> <br>  √â melhor usar o Rect Transform para ajustar o posicionamento e a escala dos objetos do jogo. <img align="left" width="40%" src="https://habrastorage.org/webt/rm/gk/ao/rmgkao3ttyvdkj3dbs8zmtxrm2o.png"><br><br clear="all"><br clear="all"><h3>  Problema Dois - COMUNICA√á√ÉO </h3><br>  Eu tive um problema semelhante devido ao fato de ter conhecido o desenvolvedor do jogo pelo Game Maker Studio, onde o script √© uma parte completa do objeto do jogo e ele tem acesso total a todos os componentes do objeto imediatamente.  O Unity possui scripts comuns, e apenas inst√¢ncias deles s√£o adicionados ao objeto.  Falando de maneira simplista e figurativa, o script n√£o sabe diretamente em qual objeto est√° executando no momento.  Portanto, ao escrever scripts, voc√™ deve levar em considera√ß√£o a inicializa√ß√£o das interfaces para trabalhar com os componentes de um objeto ou com os componentes de outros objetos. <br><br>  <b>N√≥s treinamos em gatos</b> <br>  No meu jogo, h√° um objeto GameField; no palco, h√° apenas uma inst√¢ncia, h√° tamb√©m um script com o mesmo nome.  O objeto √© respons√°vel por exibir a pontua√ß√£o do jogo e por reproduzir todo o som do jogo, portanto, na minha opini√£o, √© mais econ√¥mico para a mem√≥ria (em geral, o jogo possui apenas tr√™s fontes de √°udio - uma m√∫sica de fundo e dois outros efeitos sonoros).  O script resolve os problemas de armazenamento de uma conta de jogo, escolhendo o AudioClip para reproduzir som e para alguma l√≥gica do jogo. <br><br>  Vamos nos debru√ßar sobre o som com mais detalhes, pois este exemplo mostra facilmente a intera√ß√£o do script com os componentes do objeto. <br><br><img width="40%" align="left" src="https://habrastorage.org/webt/2y/ll/ab/2yllabokihsyqwabiwnod3tiqyc.png">  Naturalmente, o objeto deve ter o pr√≥prio script GameField.cs e o componente AudioSource, no meu caso, dois inteiros (mais tarde ficar√° claro o porqu√™). <br clear="all"><br clear="all">  Como mencionado anteriormente, o script "n√£o sabe" que o objeto possui um componente AudioSource, portanto, declaramos e inicializamos a interface (por enquanto, consideramos que o AudioSource √© apenas um): <br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> AudioSource Sound; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ Sound = GetComponent&lt;AudioSource&gt; (); }</code> </pre> <br>  O m√©todo GetComponent &lt;component_type&gt; () retornar√° o primeiro componente do tipo especificado do objeto. <br><br>  Al√©m do AudioSource, voc√™ precisar√° de v√°rios AudioClip: <br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">Header (</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Audio clips"</span></span></span><span class="hljs-meta">)</span></span>] [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> AudioClip OnStart; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> AudioClip OnEfScore; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> AudioClip OnHighScore; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> AudioClip OnMainTimer; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> AudioClip OnBubbMarker; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> AudioClip OnScoreUp;</code> </pre><br>  A seguir, os comandos entre colchetes s√£o necess√°rios para o Inspector`a, mais detalhes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br><img width="40%" align="left" src="https://habrastorage.org/webt/wk/t-/k7/wkt-k7spezw5hanfme5xchxexzk.png"><br><br>  Agora, o script no Inspector possui novos campos nos quais arrastamos os sons necess√°rios. <br><br clear="all"><br clear="all">  Em seguida, crie um m√©todo SoundPlay no script que recebe o AudioClip: <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PlaySound</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">AudioClip Clip = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">null</span></span></span></span></span><span class="hljs-function">)</span></span>{ Sound.clip = Clip; Sound.Play (); }</code> </pre><br>  Para reproduzir som no jogo, chamamos no momento certo esse m√©todo com o clipe. <br><br>  H√° um ponto negativo menos significativo dessa abordagem, apenas um som pode ser reproduzido por vez, mas durante o jogo pode ser necess√°rio reproduzir dois ou mais sons, com exce√ß√£o da m√∫sica de fundo tocando constantemente. <br><br>  Para evitar a cacofonia, eu recomendo evitar a possibilidade de reprodu√ß√£o simult√¢nea de mais de 4-5 sons (de prefer√™ncia um m√°ximo de 2-3). Quero dizer sons breves de primeira ordem do jogo (salto, moeda, tiro do jogador ...); para o ru√≠do de fundo, √© melhor criar sua pr√≥pria fonte som no objeto que produz esse ru√≠do (se voc√™ precisar de som 2d-3d) ou em um objeto respons√°vel por todo o ru√≠do de fundo (se ‚Äúvolume‚Äù n√£o for necess√°rio). <br><br>  No meu jogo, n√£o h√° necessidade de reproduzir simultaneamente mais de dois clipes de √°udio.  Para uma reprodu√ß√£o garantida dos dois sons hipot√©ticos, adicionei dois AudioSource ao objeto GameField.  Para determinar os componentes no script, usamos o m√©todo <br><pre> <code class="cs hljs">GetComponents&lt;_&gt;()</code> </pre><br>  que retorna uma matriz de todos os componentes do tipo especificado do objeto. <br><br>  O c√≥digo ficar√° assim: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> AudioSource[] Sound; <span class="hljs-comment"><span class="hljs-comment">//    void Start(){ Sound = GetComponents&lt;AudioSource&gt; (); //  GetComponents }</span></span></code> </pre><br>  A maioria das altera√ß√µes afetar√° o m√©todo PlaySound.  Eu vejo duas vers√µes desse m√©todo: ‚Äúuniversal‚Äù (para qualquer n√∫mero de AudioSource em um objeto) e ‚Äúdesajeitado‚Äù (para 2-3 AudioSource, n√£o o mais elegante, mas com menos recursos). <br><br>  A op√ß√£o "desajeitada" para dois AudioSource (eu usei) <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PlaySound</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">AudioClip Clip = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">null</span></span></span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!Sound [<span class="hljs-number"><span class="hljs-number">0</span></span>].isPlaying) { Sound [<span class="hljs-number"><span class="hljs-number">0</span></span>].clip = Clip; Sound [<span class="hljs-number"><span class="hljs-number">0</span></span>].Play (); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Sound [<span class="hljs-number"><span class="hljs-number">1</span></span>].clip = Clip; Sound [<span class="hljs-number"><span class="hljs-number">1</span></span>].Play (); } }</code> </pre><br>  Voc√™ pode estender para tr√™s ou mais AudioSource, mas o n√∫mero de condi√ß√µes consumir√° toda a economia de desempenho. <br><br>  Op√ß√£o "universal" <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PlaySound</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">AudioClip Clip = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">null</span></span></span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (AudioSource _Sound <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Sound) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!_Sound.isPlaying) { _Sound.clip = Clip; _Sound.Play (); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } }</code> </pre><br><br>  <b>Acesso a um componente externo</b> <br>  No campo de jogo, h√° v√°rias inst√¢ncias da pr√©-fabricada Fishka, como um chip de jogo.  √â constru√≠do assim: <br><ul><li>  Objeto pai com seu SpriteRenderer; <ul><li>  Objetos filho com seu SpriteRenderer. </li></ul></li></ul><br>  Os objetos filhos s√£o respons√°veis ‚Äã‚Äãpor desenhar o corpo do chip, sua cor, elementos mut√°veis ‚Äã‚Äãadicionais.  O pai desenha uma borda de marcador ao redor do chip (o chip ativo deve ser destacado no jogo).  O script est√° apenas no objeto pai.  Portanto, para gerenciar sprites filhos, o script pai precisa especificar esses sprites.  Organizei assim - no script, criei interfaces para acessar os filhos SpriteRenderer: <br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">Header (</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Graphic objects"</span></span></span><span class="hljs-meta">)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> SpriteRenderer Marker; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> SpriteRenderer Base; [Space] [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> SpriteRenderer Center_Red; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> SpriteRenderer Center_Green; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> SpriteRenderer Center_Blue;</code> </pre><br>  Agora, o script no Inspector possui campos adicionais: <br><img src="https://habrastorage.org/webt/mq/w9/kp/mqw9kpst-fen-bkdtgp_8jycpck.png"><br><br clear="all">  Arrastar e soltar filhos nos campos correspondentes nos d√° acesso a eles no script. <br><br clear="all">  Exemplo de uso: <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnMouseDown</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">//        Marker.enabled = !Marker.enabled; }</span></span></code> </pre><br><br clear="all">  <b>Chamando o script de outra pessoa</b> <br>  Al√©m de manipular componentes externos, voc√™ tamb√©m pode acessar o script de um objeto de terceiros, trabalhar com suas vari√°veis ‚Äã‚ÄãP√∫blicas, m√©todos e subclasses. <br><br>  Vou dar um exemplo do j√° conhecido objeto GameField. <br><br>  O script GameField possui o m√©todo p√∫blico FishkiMarkerDisabled (), necess√°rio para "remover" um marcador de todos os chips no campo e √© usado no processo de definir um marcador ao clicar em um chip, pois s√≥ pode haver um ativo. <br><br>  No script Fishka.cs, ‚Äã‚Äão SpriteRenderer Marker √© p√∫blico, ou seja, pode ser acessado de outro script.  Para fazer isso, adicione a declara√ß√£o e a inicializa√ß√£o de interfaces para todas as inst√¢ncias da classe Fishka no script GameField.cs (ao criar um script, a classe com o mesmo nome √© criada nele), semelhante √† maneira como √© feita para v√°rios AudioSource: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Fishka[] Fishki; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ Fishki = GameObject.FindObjectsOfType (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Fishka)) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Fishka[]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FishkiMarkerDisabled</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (Fishka _Fishka <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Fishki) { _Fishka .Marker.enabled = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } }</code> </pre><br>  No script Fishka.cs, ‚Äã‚Äãadicione a declara√ß√£o e a inicializa√ß√£o da interface da inst√¢ncia da classe GameField e, quando clicarmos no objeto, chamaremos o m√©todo FishkiMarkerDisabled () dessa classe: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> GameField gf; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ gf = GameObject.FindObjectOfType (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(GameField)) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> GameField; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnMouseDown</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ gf.FishkiMarkerDisabled(); Marker.enabled = !Marker.enabled; }</code> </pre><br>  Assim, voc√™ pode interagir entre scripts (ou melhor, classes) de diferentes objetos. <br><br clear="all"><br clear="all"><h3>  Problema Tr√™s - MANTENADORES </h3><br>  <b>Detentor de conta</b> <br>  Assim que algo parecido com uma conta aparece no jogo, o problema imediato √© o armazenamento, tanto durante o jogo quanto fora dele, tamb√©m quero manter um registro para incentivar o jogador a super√°-lo. <br><br>  N√£o considerarei op√ß√µes quando todo o jogo (menu, jogo, retirada de conta) for constru√≠do em uma cena, porque, em primeiro lugar, essa n√£o √© a melhor maneira de criar o primeiro projeto e, em segundo lugar, na minha opini√£o, a cena de carregamento inicial deve ser .  Portanto, concordamos que h√° quatro cenas no projeto: <br><ol><li>  loader - uma cena na qual o objeto de m√∫sica de fundo √© inicializado (mais ser√° mais tarde) e carregando as configura√ß√µes do salvamento; <br></li><li>  menu - uma cena com um menu; <br></li><li>  cena do jogo; <br></li><li>  score - a cena da pontua√ß√£o, registro e placar. <br></li></ol><br><img width="40%" align="right" src="https://habrastorage.org/webt/dy/yl/4t/dyyl4tkmtx6a0ijbnjiy1jgkr9q.png"><br>  <i>Nota: A ordem de carregamento da cena √© definida em Arquivo&gt; Configura√ß√µes da compila√ß√£o.</i> <br clear="all"><br clear="all">  Os pontos acumulados durante o jogo s√£o armazenados na vari√°vel Score da classe GameField.  Para ter acesso aos dados ao ir para a cena de pontua√ß√µes, crie uma classe est√°tica p√∫blica ScoreHolder, na qual declaramos uma vari√°vel para armazenar o valor e uma propriedade para obter e definir o valor dessa vari√°vel (o m√©todo foi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">espionado</a> por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">apocatastas</a> ): <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ScoreHolder</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _Score = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Score { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _Score; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>{ _Score = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; } } }</code> </pre><br>  Uma classe est√°tica p√∫blica n√£o precisa ser adicionada a nenhum objeto; ela est√° dispon√≠vel imediatamente em qualquer cena de qualquer script. <br><br>  Exemplo de uso na classe GameField nas pontua√ß√µes do m√©todo de transi√ß√£o de cena: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine.SceneManagement; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">GameField</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Score = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//     ,         Scores void GotoScores(){ ScoreHolder.Score = Score; //   ScoreHolder.Score   SceneManager.LoadScene (‚Äúscores‚Äù); } }</span></span></code> </pre><br>  Da mesma forma, voc√™ pode adicionar uma conta de registro ao ScoreHolder durante o jogo, mas ela n√£o ser√° salva na sa√≠da. <br><br clear="all">  <b>Guarda-redes</b> <br>  Considere o exemplo de salvar o valor da vari√°vel booleana SoundEffectsMute, dependendo do estado em que o jogo tem ou n√£o efeitos sonoros. <br><br>  A vari√°vel em si √© armazenada na classe est√°tica p√∫blica SettingsHolder: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SettingsHolder</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> _SoundEffectsMute = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> SoundEffectsMute{ <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _SoundEffectsMute; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>{ _SoundEffectsMute = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; } } }</code> </pre><br>  A classe √© semelhante ao ScoreHolder, voc√™ pode at√© combin√°-los em um, mas, na minha opini√£o, isso √© falta de educa√ß√£o. <br><br>  Como voc√™ pode ver no script, por padr√£o _SoundEffectsMute √© declarado falso, portanto, toda vez que o jogo √© iniciado, SettingsHolder.SoundEffectsMute retornar√° false, independentemente de o usu√°rio o ter alterado antes ou n√£o (√© alterado usando o bot√£o na cena do menu). <br><br clear="all">  <b>Salvando Vari√°veis</b> <br>  O melhor para um aplicativo Android ser√° usar o m√©todo PlayerPrefs.SetInt para salvar (para mais detalhes, consulte a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">documenta√ß√£o oficial</a> ).  Existem duas op√ß√µes para manter o valor de SettingsHolder.SoundEffectsMute no PlayerPrefs, vamos cham√°-los de "simples" e "elegantes". <br><br clear="all">  A maneira "simples" (para mim assim) est√° no m√©todo OnMouseDown () da classe do bot√£o acima mencionado.  O valor armazenado √© carregado na mesma classe, mas no m√©todo Start (): <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ButtonSoundMute</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">//    ,  PlayerPrefs    bool switch (PlayerPrefs.GetInt ("SoundEffectsMute")) { case 0: SettingsHolder.SoundEffectsMute = false; break; case 1: SettingsHolder.SoundEffectsMute = true; break; default: //    default SettingsHolder.SoundEffectsMute = true; break; } } void OnMouseDown(){ SettingsHolder.SoundEffectsMute = !SettingsHolder.SoundEffectsMute; //    ,  PlayerPrefs    bool if (SettingsHolder.SoundEffectsMute) PlayerPrefs.SetInt ("SoundEffectsMute", 1); else PlayerPrefs.SetInt ("SoundEffectsMute", 0); } }</span></span></code> </pre><br><br clear="all">  O m√©todo "elegante", na minha opini√£o, n√£o √© o mais correto, porque  complicar a manuten√ß√£o do c√≥digo, mas h√° algo nele, e n√£o posso deixar de compartilh√°-lo.  Um recurso desse m√©todo √© que o configurador da propriedade SettingsHolder.SoundEffectsMute √© chamado em um momento que n√£o requer alto desempenho e pode ser carregado (oh, horror) usando PlayerPrefs (leitura / grava√ß√£o em um arquivo).  Altere a classe est√°tica p√∫blica SettingsHolder: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SettingsHolder</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> _SoundEffectsMute = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> SoundEffectsMute{ <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _SoundEffectsMute; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>{ _SoundEffectsMute = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_SoundEffectsMute) PlayerPrefs.SetInt (<span class="hljs-string"><span class="hljs-string">"SoundEffectsMute"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> PlayerPrefs.SetInt (<span class="hljs-string"><span class="hljs-string">"SoundEffectsMute"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); } } }</code> </pre><br>  O m√©todo OnMouseDown da classe ButtonSoundMute ser√° simplificado para: <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnMouseDown</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ SettingsHolder.SoundEffectsMute = !SettingsHolder.SoundEffectsMute; }</code> </pre><br><br clear="all">  N√£o vale a pena carregar o getter com a leitura de um arquivo, pois ele est√° envolvido em um processo cr√≠tico de desempenho - no m√©todo PlaySound () da classe GameField: <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PlaySound</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">AudioClip Clip = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">null</span></span></span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!SettingsHolder.SoundEffectsMute) { <span class="hljs-comment"><span class="hljs-comment">//      ‚Äú‚Äù  (. ) if (!Sound [0].isPlaying) { Sound [0].clip = Clip; Sound [0].Play (); } else { Sound [1].clip = Clip; Sound [1].Play (); } } }</span></span></code> </pre><br><br clear="all">  Da maneira acima, voc√™ pode organizar o armazenamento no jogo de quaisquer vari√°veis. <br><br clear="all"><br clear="all"><h3>  Quinto Problema - UM POR TODOS </h3><br>  <b>Essa m√∫sica ser√° eterna</b> <br>  Cedo ou tarde, todos enfrentam esse problema, e eu n√£o fui exce√ß√£o.  Conforme planejado, a m√∫sica de fundo come√ßa a tocar mesmo na cena do menu e, se n√£o estiver desativada, toca o menu, o jogo e as pontua√ß√µes nas cenas sem interrup√ß√£o.  Mas se o objeto "tocando" a m√∫sica de fundo estiver instalada na cena do menu, quando voc√™ for para a cena do jogo, ela ser√° destru√≠da e o som desaparecer√°. Se voc√™ colocar o mesmo objeto na cena do jogo, depois da transi√ß√£o, a m√∫sica ser√° reproduzida primeiro.  A solu√ß√£o acabou sendo o uso do m√©todo DontDestroyOnLoad (Object target) colocado no m√©todo Start () da classe cuja inst√¢ncia de script o objeto de m√∫sica possui.  Para fazer isso, crie o script DontDestroyThis.cs: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">DontDestroyThis</span></span>: <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ DontDestroyOnLoad(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.gameObject); } }</code> </pre><br><img width="40%" align="left" src="https://habrastorage.org/webt/ee/cj/hn/eecjhn5uyzoclq7ywnqztl1untu.png">  Para que tudo funcione, o objeto ‚Äúmusical‚Äù deve ser raiz (no mesmo n√≠vel hier√°rquico da c√¢mera principal). <br clear="all"><br clear="all">  <b>Por que m√∫sica de fundo no carregador</b> <br>  A captura de tela mostra que o objeto ‚Äúmusical‚Äù n√£o est√° localizado na cena do menu, mas na cena do carregador.  Essa √© uma medida causada pelo fato de que a cena do menu pode ser carregada mais de uma vez (ap√≥s a cena das partituras, a transi√ß√£o para a cena do menu) e, cada vez que √© carregada, outro objeto ‚Äúmusical‚Äù ser√° criado e o antigo n√£o ser√° exclu√≠do.  Isso pode ser feito como no exemplo da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">documenta√ß√£o oficial</a> , mas eu decidi aproveitar o fato de que a cena do carregador √© garantida para carregar apenas uma vez. <br><br>  Com isso, os principais problemas que encontrei ao desenvolver meu primeiro jogo no Unity, antes de fazer o upload para o Play Market (ainda n√£o registrei uma conta de desenvolvedor), foram encerrados com √™xito. <br><br>  <b>PS</b> <br>  <i>Se a informa√ß√£o foi √∫til, voc√™ pode apoiar o autor e ele finalmente registrar√° uma conta de desenvolvedor do Android.</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt458914/">https://habr.com/ru/post/pt458914/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt458904/index.html">Visualiza√ß√£o do n√∫mero de vit√≥rias para equipes da NBA usando gr√°ficos de barras animados em R</a></li>
<li><a href="../pt458906/index.html">[Ecaterimburgo, an√∫ncio] Flutteron - um workshop sobre desenvolvimento em Flutter</a></li>
<li><a href="../pt458908/index.html">Digitalizando documentos pela rede</a></li>
<li><a href="../pt458910/index.html">Compara√ß√£o do PostgreSQL com grandes p√°ginas do Linux</a></li>
<li><a href="../pt458912/index.html">Migrando para o Zimbra com o imapsync</a></li>
<li><a href="../pt458916/index.html">Sob o cap√¥ do React. Escrevemos nossa implementa√ß√£o do zero</a></li>
<li><a href="../pt458918/index.html">O que voc√™ pode aprender com o design de jogos hiper-casuais</a></li>
<li><a href="../pt458920/index.html">Confer√™ncia para f√£s do DevOps</a></li>
<li><a href="../pt458922/index.html">Como passar do ESXi para o KVM / LXD e n√£o enlouquecer</a></li>
<li><a href="../pt458924/index.html">Acidentes ajudam voc√™ a aprender</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>