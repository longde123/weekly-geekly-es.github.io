<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üê≠ üëâ üë®üèæ Comment prendre le contr√¥le de votre infrastructure r√©seau. Chapitre quatre Automatisation Mod√®les üîÜ üî® üôÖüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cet article est le sixi√®me d'une s√©rie d'articles intitul√©e ¬´Comment prendre l'infrastructure r√©seau sous votre contr√¥le¬ª. Le contenu de tous les arti...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment prendre le contr√¥le de votre infrastructure r√©seau. Chapitre quatre Automatisation Mod√®les</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/453920/">  <i>Cet article est le sixi√®me d'une s√©rie d'articles intitul√©e ¬´Comment prendre l'infrastructure r√©seau sous votre contr√¥le¬ª.</i>  <i>Le contenu de tous les articles de la s√©rie et les liens peuvent √™tre trouv√©s <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a></i> . <br><br>  Laissant quelques sujets de c√¥t√©, j'ai d√©cid√© de commencer un nouveau chapitre. <br><br>  Je serai de retour en s√©curit√© un peu plus tard.  Ici, je veux discuter d'une approche simple mais efficace qui, j'en suis s√ªr, sous une forme ou une autre, peut √™tre utile √† beaucoup.  Il s'agit plut√¥t d'une courte histoire sur la fa√ßon dont l'automatisation peut changer la vie d'un ing√©nieur.  Il s'agira de l'utilisation des temlates.  √Ä la fin est une liste de mes projets, o√π vous pouvez voir comment tout ce qui est d√©crit ici fonctionne. <br><br><h2>  DevOps pour le Web </h2><br>  Cr√©ation d'une configuration avec un script, utilisation de GIT pour contr√¥ler les changements dans l'infrastructure informatique, ¬´remplissage¬ª √† distance - ces id√©es viennent en premier lorsque vous pensez √† la mise en ≈ìuvre technique de l'approche DevOps.  Les avantages sont √©vidents.  Mais il y a malheureusement aussi des inconv√©nients. <br><br>  Il y a plus de 5 ans, nos d√©veloppeurs sont venus vers nous, les networkers, avec ces offres, nous n'√©tions pas enthousiastes. <br><a name="habracut"></a><br>  Je dois dire que nous avons h√©rit√© d'un r√©seau plut√¥t h√©t√©roclite compos√© de l'√©quipement d'une dizaine de fournisseurs diff√©rents.  Quelque chose √©tait pratique √† configurer via notre interface utilisateur pr√©f√©r√©e, mais quelque part, nous avons pr√©f√©r√© utiliser l'interface graphique.  De plus, un long travail sur les √©quipements "sous tension" a √©t√© enseign√© au contr√¥le en temps r√©el.  Par exemple, lorsque je fais des changements, je me sens beaucoup plus √† l'aise de travailler directement via cli.  Je peux donc rapidement voir que quelque chose s'est mal pass√© et ¬´annuler¬ª les changements.  Tout cela √©tait en contradiction avec leurs id√©es. <br><br>  D'autres questions se posent, par exemple, de la version √† la version du logiciel, l'interface peut varier l√©g√®rement.  En fin de compte, votre script cr√©era la mauvaise ¬´configuration¬ª.  Je ne voudrais pas utiliser la production pour une effraction. <br><br>  Ou, comment comprendre que les commandes de configuration ont √©t√© appliqu√©es correctement et que faire en cas d'erreur? <br><br>  Je ne veux pas dire que toutes ces questions sont insolubles.  Il suffit de dire ¬´A¬ª, il est probablement judicieux de dire ¬´B¬ª, et si vous souhaitez utiliser les m√™mes processus de contr√¥le des modifications qu'en d√©veloppement, vous devez disposer d'environnements de d√©veloppement et de transfert en plus de la production.  Cette approche semble alors compl√®te.  Mais combien cela co√ªtera-t-il? <br><br>  Mais il y a une situation o√π les inconv√©nients sont presque √©galis√©s, et seuls les avantages restent.  Je parle de travail de conception. <br><br><h2>  Projet </h2><br>  Au cours des deux derni√®res ann√©es, j'ai particip√© √† un projet de construction d'un centre de donn√©es pour un fournisseur majeur.  Je suis responsable du F5 et du Palo Alto dans ce projet.  Du point de vue de Cisco, il s'agit de ¬´l'√©quipement tiers¬ª. <br><br>  Pour moi personnellement, il y a deux √©tapes distinctes dans ce projet. <br><br><h3>  Premi√®re √©tape </h3><br>  La premi√®re ann√©e, j'√©tais infiniment occup√©e, je travaillais la nuit et le week-end.  Je n'ai pas pu lever la t√™te.  La pression de la direction et du client √©tait forte et continue.  Dans une routine constante, je ne pouvais m√™me pas essayer d'optimiser le processus.  Ce n'√©tait pas seulement et pas tant la configuration des √©quipements que la pr√©paration de la documentation de conception. <br><br>  Les premiers tests ont donc commenc√© et je serais √©tonn√© du nombre d'erreurs et d'inexactitudes mineures commises.  Bien s√ªr, tout a fonctionn√©, mais la lettre dans le nom manquait, la ligne dans l'√©quipe manquait ici ... Les tests continuaient et continuaient, et j'√©tais d√©j√† dans une lutte constante et quotidienne avec les erreurs, les tests et la documentation. <br><br>  Cela a dur√© un an.  Le projet, si je comprends bien, n'a pas √©t√© facile pour tout le monde, mais progressivement le client est devenu de plus en plus satisfait, ce qui a permis d'engager des ing√©nieurs suppl√©mentaires qui ont pu assumer une partie de la routine. <br><br>  Maintenant, il √©tait possible de regarder un peu autour. <br>  Et ce fut le d√©but de la deuxi√®me √©tape. <br><br><h3>  Deuxi√®me √©tape </h3><br>  J'ai d√©cid√© d'automatiser le processus. <br><br>  Ce que j'ai compris de la communication avec les d√©veloppeurs √† l'√©poque (et nous devons rendre hommage, nous avions une √©quipe solide) est que le format texte, bien qu'il semble √† premi√®re vue quelque chose du monde du syst√®me d'exploitation DOS, poss√®de un certain nombre de propri√©t√©s pr√©cieuses . <br>  Par exemple, un format texte sera utile si vous souhaitez profiter pleinement de GIT et de tous ses d√©riv√©s.  Je le voulais. <br><br>  Eh bien, il semblerait que vous puissiez simplement stocker une configuration ou une liste de commandes, mais faire des changements est plut√¥t g√™nant.  De plus, lors de la conception, il y a une autre t√¢che importante.  Vous devez disposer d'une documentation d√©crivant votre conception globale (conception de bas niveau) et sa mise en ≈ìuvre sp√©cifique (plan de mise en ≈ìuvre du r√©seau).  Et dans ce cas, l'utilisation de mod√®les semble √™tre une option tr√®s appropri√©e. <br><br>  Ainsi, lorsque vous utilisez YAML et Jinja2, le fichier YAML avec des param√®tres de configuration, tels que les adresses IP, les num√©ros BGP AS, ... remplit parfaitement le r√¥le de NIP, tandis que les mod√®les Jinja2 incluent la syntaxe appropri√©e √† la conception, c'est-√†-dire, en fait, le reflet du LLD. <br><br>  Il a fallu deux jours pour apprendre les langues YAML et Jinja2.  Quelques bons exemples suffisent pour comprendre comment cela fonctionne.  Ensuite, il a fallu environ deux semaines pour cr√©er tous les mod√®les qui correspondent √† notre conception: une semaine pour Palo Alto et une autre semaine pour F5.  Tout cela a √©t√© publi√© sur Corporate Githab. <br><br>  Maintenant, le processus de changement √©tait le suivant: <br><br><ul><li>  fichier yaml modifi√© </li><li>  cr√©√© un fichier de configuration √† l'aide d'un mod√®le (Jinja2) </li><li>  enregistr√© dans un r√©f√©rentiel distant </li><li>  t√©l√©charg√© la configuration cr√©√©e sur l'√©quipement </li><li>  vu une erreur </li><li>  fichier YAML ou mod√®le Jinja2 modifi√© </li><li>  cr√©√© un fichier de configuration √† l'aide d'un mod√®le (Jinja2) </li><li>  ... </li></ul><br>  Il est clair qu'au d√©but, beaucoup de temps a √©t√© consacr√© √† l'√©dition, mais apr√®s une semaine ou deux, c'√©tait d√©j√† plus probablement une raret√©. <br><br>  Un bon test et la capacit√© de tout d√©boguer √©taient le d√©sir du client de changer la convention de d√©nomination.  Qui a travaill√© avec F5 comprend le piquant de la situation.  Mais pour moi, c'√©tait assez simple.  J'ai chang√© les noms dans le fichier YAML, supprim√© toute la configuration de l'√©quipement, g√©n√©r√© un nouveau et t√©l√©charg√©.  Tout, en tenant compte des corrections de bugs, a pris 4 jours: deux jours pour chaque technologie.  Apr√®s cela, j'√©tais pr√™t pour la prochaine √©tape, √† savoir la cr√©ation des centres de donn√©es DEV et Staging. <br><br><h3>  Dev et mise en sc√®ne </h3><br>  La mise en sc√®ne r√©p√®te en fait compl√®tement la production.  Dev est une copie fortement all√©g√©e construite principalement sur du mat√©riel virtuel.  Situation id√©ale pour une nouvelle approche.  Si j'isoler le temps que j'ai pass√© du processus g√©n√©ral, alors le travail, je pense, n'a pas pris plus de 2 semaines.  Le temps principal est le temps d'attente de l'autre c√¥t√© et une recherche commune des probl√®mes.  La mise en ≈ìuvre de la 3e partie √©tait presque invisible pour les autres.  Il y avait m√™me du temps pour enseigner quelque chose et √©crire quelques articles sur Habr√© :) <br><br><h2>  Pour r√©sumer </h2><br>  Alors qu'est-ce que j'ai en bout de ligne? <br><br><ul><li>  tout ce qui est n√©cessaire pour moi de changer la configuration est de modifier un fichier YAML simple, clairement structur√© avec des param√®tres de configuration.  Je ne change jamais le script python et tr√®s rarement (seulement s'il y a une erreur) je change Jinja2 </li><li>  du point de vue de la documentation, on obtient une situation presque id√©ale.  Vous modifiez la documentation (les fichiers YAML agissent comme NIP) et t√©l√©chargez cette configuration sur l'√©quipement.  Ainsi, votre documentation est toujours √† jour. </li></ul><br>  Tout cela a conduit au fait que <br><br><ul><li>  le pourcentage d'erreurs est pass√© √† presque 0 </li><li>  il a fallu 90 pour cent de la routine </li><li>  la vitesse de mise en ≈ìuvre a consid√©rablement augment√© </li></ul><br><h2>  PAYER, F5Y, ACY </h2><br>  J'ai dit que quelques exemples suffisent pour comprendre comment cela fonctionne. <br>  Voici une version br√®ve (et bien s√ªr modifi√©e) de ce qui a √©t√© cr√©√© au cours de mon travail. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PAY</a> = d√©ploiement <b>P</b> alo <b>A</b> lto de <b>Y</b> aml = Palo Alto de Yaml <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">F5Y</a> = d√©ploiement <b>F5</b> de <b>Y</b> aml = <b>F5</b> de <b>Y</b> aml (√† venir bient√¥t) <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ACY</a> = d√©ploiement <b>AC</b> i de <b>Y</b> aml = <b>F5</b> de <b>Y</b> aml <br><br>  J'ajouterai quelques mots sur ACY (√† ne pas confondre avec ACI). <br><br>  Ceux qui ont travaill√© avec ACI savent que ce miracle (et dans le bon sens aussi) n'a pas √©t√© cr√©√© par des networkers :).  Oubliez tout ce que vous saviez sur le r√©seau - il ne vous sera pas utile! <br>  C'est un peu exag√©r√©, mais cela donne √† peu pr√®s le sentiment que je ressens constamment depuis 3 ans maintenant, en travaillant avec ACI. <br><br>  Et dans ce cas, ACY n'est pas seulement une opportunit√© de construire un processus de contr√¥le des changements (ce qui est particuli√®rement important dans le cas d'ACI, car il est suppos√© qu'il s'agit de la partie centrale et la plus critique de votre centre de donn√©es), mais vous offre √©galement une interface conviviale pour cr√©er une configuration. <br><br>  Les ing√©nieurs de ce projet utilisent Excel pour utiliser ACI au lieu de YAML dans le m√™me but.  Bien s√ªr, l'utilisation d'Excel pr√©sente certains avantages: <br><br><ul><li>  votre pincement dans un seul fichier </li><li>  beaux signes que le client est content de regarder </li><li>  vous pouvez utiliser des outils Excel </li></ul><br>  Mais il y a un inconv√©nient, et √† mon avis, il l'emporte sur les avantages.  Contr√¥ler les changements et coordonner le travail d'√©quipe devient beaucoup plus difficile. <br><br>  ACY applique en fait les m√™mes approches que celles que j'ai utilis√©es pour les tiers pour configurer ACI. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr453920/">https://habr.com/ru/post/fr453920/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr453904/index.html">D√©barrassez-vous de "vk.com/away.php" ou suivez les liens d'une personne en bonne sant√©</a></li>
<li><a href="../fr453906/index.html">Qu'est-ce qu'un "mod√®le de domaine"?</a></li>
<li><a href="../fr453908/index.html">RTOS Neutrino dans les ordinateurs industriels</a></li>
<li><a href="../fr453914/index.html">Instructions d'installation du client de test TON</a></li>
<li><a href="../fr453916/index.html">Comment vous prot√©ger contre les escrocs mobiles</a></li>
<li><a href="../fr453926/index.html">Fonctionnement et fonctionnement du service d'autopartage</a></li>
<li><a href="../fr453930/index.html">Comparaison et s√©lection de syst√®mes de migration de donn√©es</a></li>
<li><a href="../fr453932/index.html">Quelques mots pour d√©fendre le monolithe</a></li>
<li><a href="../fr453934/index.html">11 questions √† discuter avant de commencer √† travailler</a></li>
<li><a href="../fr453938/index.html">Suivi des v√©los vol√©s NB-IoT</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>