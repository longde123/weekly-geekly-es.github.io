<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚ÄçüöÄ „ÄΩÔ∏è üåë Dados principais em detalhes ü§¨ üë®‚Äçüî¨ ü¶ë</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recentemente, comecei a trabalhar em um grande projeto usando o Core Data. O habitual √© que as pessoas nos projetos mudem, a experi√™ncia seja perdida ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Dados principais em detalhes</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/436510/">  Recentemente, comecei a trabalhar em um grande projeto usando o Core Data.  O habitual √© que as pessoas nos projetos mudem, a experi√™ncia seja perdida e as nuances sejam esquecidas.  √â imposs√≠vel aprofundar todos no estudo de uma estrutura espec√≠fica - todos t√™m seus pr√≥prios problemas de trabalho.  Portanto, preparei uma breve apresenta√ß√£o, a partir desses pontos que considero importantes ou insuficientemente abordados nos tutoriais.  Compartilho com todos e espero que isso ajude a escrever um c√≥digo eficaz e n√£o cometer erros.  Sup√µe-se que voc√™ j√° esteja um pouco no assunto. <br><br>  Vou come√ßar com o banal. <br><br>  Dados Principais √© uma estrutura que gerencia e armazena dados em um aplicativo.  Voc√™ pode considerar o Core Data como um inv√≥lucro em um armazenamento relacional f√≠sico que representa dados na forma de objetos, enquanto o Core Data em si n√£o √© um banco de dados. <br><br><h2>  Objetos de dados principais </h2><br><img src="https://habrastorage.org/webt/aq/ka/bk/aqkabk_js9w9knvyat6xp_u4u5a.png" alt="imagem"><br><a name="habracut"></a><br>  Para criar armazenamento, o aplicativo usa as <b>classes NSPersistentStoreCoordinator</b> ou <b>NSPersistentContainer</b> .  O NSPersistentStoreCoordinator cria um armazenamento do tipo especificado com base no modelo, voc√™ pode especificar o local e op√ß√µes adicionais.  O NSPersistentContainer pode ser usado com o iOS10, fornece a capacidade de criar com uma quantidade m√≠nima de c√≥digo. <br><br>  Funciona da seguinte maneira: se um banco de dados existe no caminho especificado, o coordenador verifica sua vers√£o e, se necess√°rio, faz uma migra√ß√£o.  Se o banco de dados n√£o existir, ele ser√° criado com base no modelo NSManagedObjectModel.  Para que tudo isso funcione corretamente, antes de fazer altera√ß√µes no modelo, crie uma nova vers√£o no Xcode atrav√©s do menu Editor -&gt; Adicionar vers√£o do modelo.  Se voc√™ encontrar o caminho, poder√° encontrar e abrir a base no emulador. <br><br><div class="spoiler">  <b class="spoiler_title">Exemplo com NSPersistentStoreCoordinator</b> <div class="spoiler_text"><pre><code class="objectivec hljs">var persistentCoordinator: <span class="hljs-built_in"><span class="hljs-built_in">NSPersistentStoreCoordinator</span></span> = { let modelURL = Bundle.main.url(forResource: <span class="hljs-string"><span class="hljs-string">"Test"</span></span>, withExtension: <span class="hljs-string"><span class="hljs-string">"momd"</span></span>) let managedObjectModel = <span class="hljs-built_in"><span class="hljs-built_in">NSManagedObjectModel</span></span>(contentsOf: modelURL!) let persistentCoordinator = <span class="hljs-built_in"><span class="hljs-built_in">NSPersistentStoreCoordinator</span></span>(managedObjectModel: managedObjectModel!) let documentsPath = <span class="hljs-built_in"><span class="hljs-built_in">NSSearchPathForDirectoriesInDomains</span></span>(.documentDirectory, .userDomainMask, <span class="hljs-literal"><span class="hljs-literal">true</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>] let storeURL = URL(fileURLWithPath: documentsPath.appending(<span class="hljs-string"><span class="hljs-string">"/Test.sqlite"</span></span>)) print(<span class="hljs-string"><span class="hljs-string">"storeUrl = \(storeURL)"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { try persistentCoordinator.addPersistentStore(ofType: <span class="hljs-built_in"><span class="hljs-built_in">NSSQLiteStoreType</span></span>, configurationName: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, at: storeURL, options: [<span class="hljs-built_in"><span class="hljs-built_in">NSSQLitePragmasOption</span></span>: [<span class="hljs-string"><span class="hljs-string">"journal_mode"</span></span>:<span class="hljs-string"><span class="hljs-string">"MEMORY"</span></span>]]) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> persistentCoordinator } catch { abort() } } ()</code> </pre> <br></div></div><div class="spoiler">  <b class="spoiler_title">Exemplo de NSPersistentContainer</b> <div class="spoiler_text"><pre> <code class="objectivec hljs">var persistentContainer: <span class="hljs-built_in"><span class="hljs-built_in">NSPersistentContainer</span></span> = { let container = <span class="hljs-built_in"><span class="hljs-built_in">NSPersistentContainer</span></span>(name: <span class="hljs-string"><span class="hljs-string">"CoreDataTest"</span></span>) container.loadPersistentStores(completionHandler: { (storeDescription, error) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> print(<span class="hljs-string"><span class="hljs-string">"storeDescription = \(storeDescription)"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> let error = error as <span class="hljs-built_in"><span class="hljs-built_in">NSError</span></span>? { fatalError(<span class="hljs-string"><span class="hljs-string">"Unresolved error \(error), \(error.userInfo)"</span></span>) } }) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> container } ()</code> </pre><br></div></div><br>  O Core Data usa 4 tipos de armazenamento: <br><br>  - SQLite <br>  - bin√°rio <br>  - na mem√≥ria <br>  - XML ‚Äã‚Äã(apenas Mac OS) <br><br>  Se, por exemplo, por motivos de seguran√ßa, voc√™ n√£o desejar armazenar dados em um formato de arquivo, mas ao mesmo tempo desejar usar o cache durante a sess√£o e dados em forma de objetos, o armazenamento do tipo "In-Memory" √© bastante adequado.  Na verdade, n√£o √© proibido ter v√°rios tipos diferentes de armazenamento em um aplicativo. <br><br>  Quero dizer algumas palavras sobre o objeto <b>NSManagedObjectContext</b> .  Em geral, a Apple fornece uma formula√ß√£o muito vaga para o NSManagedObjectContext - um ambiente para trabalhar com objetos do Core Data.  Tudo isso com o desejo de se dissociar das associa√ß√µes com os bancos de dados relacionais e de apresentar o Core Data como uma ferramenta f√°cil de usar que n√£o requer um entendimento de chaves, transa√ß√µes e outros atributos do Bazdan.  Mas na linguagem dos bancos de dados relacionais, o NSManagedObjectContext pode, em certo sentido, ser chamado de gerenciador de transa√ß√µes.  Voc√™ provavelmente notou que ele tem m√©todos de salvamento e revers√£o, embora provavelmente use apenas o primeiro. <br><br>  Um mal-entendido desse fato simples leva ao uso de um modelo de contexto √∫nico, mesmo em situa√ß√µes em que n√£o √© suficiente.  Por exemplo, voc√™ est√° editando um documento grande e, ao mesmo tempo, teve que baixar alguns diret√≥rios.  Em que momento voc√™ chama salvar?  Se estiv√©ssemos trabalhando com um banco de dados relacional, n√£o haveria d√∫vida, pois cada opera√ß√£o seria executada em sua pr√≥pria transa√ß√£o.  Os Dados Principais tamb√©m t√™m uma maneira muito conveniente de resolver esse problema - esse √© um ramo do contexto filho.  Infelizmente, por algum motivo, isso raramente √© usado.  Aqui h√° um bom <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo</a> sobre esse t√≥pico. <br><br><h2>  Heran√ßa </h2><br>  Por alguma raz√£o que eu n√£o entendo, h√° um n√∫mero muito grande de manuais e exemplos em que a heran√ßa para Entity / NSManagedObject (tabelas) n√£o √© usada de forma alguma.  Enquanto isso, √© uma ferramenta muito conveniente.  Se voc√™ n√£o usar heran√ßa, poder√° atribuir valores a atributos (campos) apenas atrav√©s do mecanismo KVC, que n√£o verifica os nomes e tipos de atributos, e isso pode facilmente levar a erros de tempo de execu√ß√£o. <br><br>  A redefini√ß√£o de classe para NSManagedObject √© feita no designer de Dados Principais: <br><br><img src="https://habrastorage.org/webt/ce/52/_p/ce52_pz39mzguhyiotm5rvhh00k.png" alt="imagem"><br><br><h2>  Heran√ßa e gera√ß√£o de c√≥digo </h2><br>  Depois de especificar o nome da classe para Entity, voc√™ pode usar a gera√ß√£o de c√≥digo e obter uma classe com c√≥digo pronto: <br><br><img src="https://habrastorage.org/webt/al/dn/7a/aldn7aozwsnv-l7sjv8vau4iwmi.png" alt="imagem"><br><br><img src="https://habrastorage.org/webt/kj/ra/kh/kjrakhjgijvth5obsls22g6vtjk.png" alt="imagem"><br><br>  Se voc√™ deseja ver o c√≥digo gerado automaticamente, mas n√£o deseja adicionar arquivos ao projeto, pode usar outra maneira: defina a op√ß√£o ‚ÄúCodegen‚Äù para Entity.  Nesse caso, o c√≥digo deve ser pesquisado em ../ DerivedData / ... <br><br><img src="https://habrastorage.org/webt/zg/vw/9e/zgvw9e3sulaf6g7qici-uitdsei.png" alt="imagem"><br><br>  Use a gera√ß√£o de c√≥digo para criar classes, erros de digita√ß√£o em nomes de vari√°veis ‚Äã‚Äãpodem levar a erros de tempo de execu√ß√£o. <br><br>  Aqui est√° um c√≥digo como este: <br><br><pre> <code class="objectivec hljs">@objc public <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Company: <span class="hljs-built_in"><span class="hljs-built_in">NSManagedObject</span></span> {    @<span class="hljs-built_in"><span class="hljs-built_in">NSManaged</span></span> public var inn: String?  @<span class="hljs-built_in"><span class="hljs-built_in">NSManaged</span></span> public var name: String?  @<span class="hljs-built_in"><span class="hljs-built_in">NSManaged</span></span> public var uid: String?  @<span class="hljs-built_in"><span class="hljs-built_in">NSManaged</span></span> public var employee: <span class="hljs-built_in"><span class="hljs-built_in">NSSet</span></span>? }</code> </pre><br>  Em breve, @NSManaged tem o mesmo significado que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">din√¢mico</a> no objetivo C. <br>  O pr√≥prio Core Data cuida do recebimento de dados (possui acessadores internos) para os atributos de suas classes.  Se voc√™ tiver campos de tr√¢nsito, precisar√° adicionar fun√ß√µes para calcul√°-los. <br><br>  As classes herdadas do NSManagedObject (tabelas) n√£o tinham um construtor "regular" antes do IOS10, ao contr√°rio de outras classes.  Para criar um objeto do tipo Company, era necess√°rio escrever uma constru√ß√£o bastante desajeitada usando o NSEntityDescription.  Agora, h√° um m√©todo mais conveniente de inicializa√ß√£o por meio do contexto (NSManagedObjectContext).  O c√≥digo est√° abaixo.  Observe a vantagem da heran√ßa ao atribuir atributos sobre o mecanismo KVC: <br><br><pre> <code class="objectivec hljs"><span class="hljs-comment"><span class="hljs-comment">// 1 -    NSEntityDescription,    KVO let company1 = NSEntityDescription.insertNewObject(forEntityName: "Company", into: moc) company1.setValue("077456789111", forKey: "inn") company1.setValue(" ", forKey: "name") // 2 -    NSEntityDescription,     let company2 = NSEntityDescription.insertNewObject(forEntityName: "Company", into: moc) as! Company company2.inn = "077456789222" company2.name = " " // 3 -     (IOS10+),     let company3 = Company(context: moc) company3.inn = "077456789222" company3.name = " "</span></span></code> </pre><br><h2>  Espa√ßo para nome para NSManagedObject </h2><br>  Outra coisa que vale a pena mencionar √© o espa√ßo para nome. <br><br><img src="https://habrastorage.org/webt/fk/a7/wl/fka7wlfqlf4cvi1ezcqst4kiiyi.png" alt="imagem"><br><br>  Voc√™ n√£o ter√° dificuldade se estiver trabalhando no ObjectiveC ou no Swift.  Normalmente, esse campo √© preenchido corretamente por padr√£o.  Mas em projetos mistos, pode ser uma surpresa para voc√™ que, para as aulas de Swift e ObjectiveC, voc√™ precise definir op√ß√µes diferentes.  No Swift, o "M√≥dulo" deve ser preenchido.  Se esse campo n√£o for preenchido, um prefixo com o nome do projeto ser√° adicionado ao nome da classe, o que causar√° um erro de tempo de execu√ß√£o.  No Objetivo C, deixe o ‚ÄúM√≥dulo‚Äù vazio, caso contr√°rio o NSManagedObject n√£o ser√° encontrado ao acess√°-lo atrav√©s do nome da classe. <br><br><h2>  Links entre objetos </h2><br>  Em princ√≠pio, o t√≥pico de relacionamentos √© bem abordado, mas quero focar em como adicionar entidades filhas ao pai.  Portanto, primeiro, um lembrete r√°pido do mecanismo para criar links.  Considere um exemplo tradicional, a empresa √© funcion√°rios, a conex√£o √© uma para muitos: <br><br><ul><li>  Crie uma conex√£o de cada lado (tabela) </li><li>  Depois disso, o campo Inverso fica dispon√≠vel, ele deve ser preenchido em cada tabela. </li></ul><br><img src="https://habrastorage.org/webt/_m/fx/si/_mfxsi_lcnxt8t3zlhh0vbrbsus.png" alt="imagem"><br><br><img src="https://habrastorage.org/webt/kb/uo/my/kbuomy1etksutabvijrvxlztiyy.png" alt="imagem"><br><br>  A Apple insiste em especificar relacionamentos inversos.  Ao mesmo tempo, a invers√£o n√£o fortalece a coer√™ncia, mas ajuda os Dados Principais a rastrear altera√ß√µes nos dois lados da conex√£o, √© importante para armazenar em cache e atualizar as informa√ß√µes. <br><br>  Tamb√©m √© importante especificar a regra de exclus√£o corretamente.  Uma regra de exclus√£o √© uma a√ß√£o que ser√° executada com esse objeto quando o objeto pai for exclu√≠do. <br><br><ul><li>  Cascata - exclus√£o de todos os objetos filhos, quando o pai √© exclu√≠do. </li><li>  Negar - proibi√ß√£o de excluir um pai, se houver um filho </li><li>  Nullify - anula a refer√™ncia do pai </li><li>  Nenhuma a√ß√£o - nenhuma a√ß√£o especificada, ele emitir√° um aviso na compila√ß√£o </li></ul><br>  Neste exemplo, quando uma empresa √© exclu√≠da, todos os funcion√°rios ser√£o exclu√≠dos (em cascata).  Quando voc√™ exclui um funcion√°rio, o link para ele na empresa √© redefinido (pr√©-tela) <br><br><h2>  Maneiras de adicionar entidades filhas ao pai </h2><br>  <b>1)</b> O primeiro m√©todo √© adicionar via NSSet.  Por exemplo, adicione 2 funcion√°rios √† empresa: <br><br><pre> <code class="objectivec hljs">let set = <span class="hljs-built_in"><span class="hljs-built_in">NSMutableSet</span></span>();    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> let employee1 = <span class="hljs-built_in"><span class="hljs-built_in">NSEntityDescription</span></span>.insertNewObject(forEntityName: <span class="hljs-string"><span class="hljs-string">"Employee"</span></span>, into: moc) as? Employee { employee1.firstName = <span class="hljs-string"><span class="hljs-string">""</span></span> employee1.secondName = <span class="hljs-string"><span class="hljs-string">""</span></span> set.add(employee1) } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> let emploee2 = <span class="hljs-built_in"><span class="hljs-built_in">NSEntityDescription</span></span>.insertNewObject(forEntityName: <span class="hljs-string"><span class="hljs-string">"Employee"</span></span>, into: moc) as? Employee { employee2.firstName = <span class="hljs-string"><span class="hljs-string">""</span></span> employee2.secondName = <span class="hljs-string"><span class="hljs-string">""</span></span> set.add(employee2) }    company.employee = set</code> </pre><br>  Este m√©todo √© conveniente para inicializar o objeto ou preencher o banco de dados.  H√° uma ligeira nuance.  Se a empresa j√° tiver funcion√°rios e voc√™ tiver atribu√≠do um novo conjunto, os ex-funcion√°rios redefinir√£o o link para a empresa, mas eles n√£o ser√£o exclu√≠dos.  Como alternativa, voc√™ pode obter uma lista de funcion√°rios e trabalhar j√° com este conjunto. <br><br><pre> <code class="objectivec hljs">let set = company.mutableSetValue(forKey: <span class="hljs-string"><span class="hljs-string">"employee"</span></span>)</code> </pre> <br>  <b>2)</b> Adicionando objetos filhos via ID pai <br><br><pre> <code class="objectivec hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> let employee = <span class="hljs-built_in"><span class="hljs-built_in">NSEntityDescription</span></span>.insertNewObject(forEntityName: <span class="hljs-string"><span class="hljs-string">"Employee"</span></span>, into: moc) as? Employee { employee.firstName = <span class="hljs-string"><span class="hljs-string">""</span></span> employee.secondName = <span class="hljs-string"><span class="hljs-string">""</span></span> employee.company = company }</code> </pre><br>  O segundo m√©todo √© conveniente ao adicionar ou editar um objeto filho no <br>  formul√°rio separado. <br><br>  <b>3)</b> Adicionando objetos filho atrav√©s de m√©todos gerados automaticamente <br><br><pre> <code class="objectivec hljs">extension Company {    @objc(addEmployeeObject:)  @<span class="hljs-built_in"><span class="hljs-built_in">NSManaged</span></span> public func addEmployee(_ value: Employee)    @objc(removeEmployeeObject:)  @<span class="hljs-built_in"><span class="hljs-built_in">NSManaged</span></span> public func removeFromEmployee(_ value: Employee)    @objc(addEmployee:)  @<span class="hljs-built_in"><span class="hljs-built_in">NSManaged</span></span> public func addEmployee(_ values: <span class="hljs-built_in"><span class="hljs-built_in">NSSet</span></span>)    @objc(removeEmployee:)  @<span class="hljs-built_in"><span class="hljs-built_in">NSManaged</span></span> public func removeFromEmployee(_ values: <span class="hljs-built_in"><span class="hljs-built_in">NSSet</span></span>) }</code> </pre><br>  Por uma quest√£o de exaustividade, √© √∫til conhecer esse m√©todo, mas de alguma forma n√£o foi √∫til para mim, e excluo o c√≥digo extra para n√£o atrapalhar o projeto. <br><br><h2>  Consultas de cl√°usulas filho </h2><br>  No Core Data, voc√™ n√£o pode fazer uma consulta arbitr√°ria entre nenhum dado, como podemos fazer no SQL.  Mas entre objetos dependentes, √© f√°cil rastrear usando um predicado padr√£o.  Abaixo est√° um exemplo de consulta que seleciona todas as empresas nas quais h√° um funcion√°rio com o nome especificado: <br><br><pre> <code class="objectivec hljs">public <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> func getCompanyWithEmployee(name: String) -&gt; [Company] { let request = <span class="hljs-built_in"><span class="hljs-built_in">NSFetchRequest</span></span>&lt;<span class="hljs-built_in"><span class="hljs-built_in">NSFetchRequestResult</span></span>&gt;(entityName: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.className()) request.predicate = <span class="hljs-built_in"><span class="hljs-built_in">NSPredicate</span></span>(format: <span class="hljs-string"><span class="hljs-string">"ANY employee.firstName = %@"</span></span>, name) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> let result = try moc.fetch(request) as? [Company] { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result } } catch { } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [Company]() }</code> </pre><br>  A chamada do m√©todo no c√≥digo ficar√° assim: <br><br><pre> <code class="objectivec hljs"><span class="hljs-comment"><span class="hljs-comment">//  ,    let companies = Company.getCompanyWithEmployee(name: "")</span></span></code> </pre><br>  N√£o use campos de tr√¢nsito nas consultas; seus valores n√£o s√£o definidos no momento em que a consulta √© executada.  Nenhum erro ocorrer√°, mas o resultado estar√° incorreto. <br><br><h2>  Definindo atributos (campos) </h2><br>  Voc√™ provavelmente percebeu que os atributos de entidade t√™m v√°rias op√ß√µes. <br>  Com opcional, tudo fica claro a partir do nome. <br><br>  A op√ß√£o de usar o tipo escalar apareceu em swif.  O Objective-C n√£o usa tipos escalares para atributos, pois eles n√£o podem ser nulos.  Tentar atribuir um valor escalar a um atributo atrav√©s do KVC causar√° um erro de tempo de execu√ß√£o.  Isso deixa claro por que os tipos de atributo no Core Data n√£o possuem uma correspond√™ncia estrita com os tipos do idioma.  Em projetos r√°pidos e mistos, os atributos do tipo escalar podem ser usados. <br><br>  Atributos de transporte p√∫blico s√£o campos calculados que <b>n√£o</b> s√£o armazenados no banco de dados.  Eles podem ser usados ‚Äã‚Äãpara criptografia.  Esses atributos recebem valores por meio de um acessador substitu√≠do ou pela atribui√ß√£o de primitivas conforme necess√°rio (por exemplo, willSave e awakeFromFetch substitu√≠dos). <br><br><h2>  Acessadores de atributo: </h2><br>  Se voc√™ n√£o precisar usar campos calculados, por exemplo, para criptografia ou outra coisa, n√£o precisar√° pensar no que s√£o os acess√≥rios de atributo.  Enquanto isso, as opera√ß√µes de obten√ß√£o e atribui√ß√£o de valores a atributos n√£o s√£o "at√¥micas".  Para entender o que quero dizer, consulte o c√≥digo abaixo: <br><br><pre> <code class="objectivec hljs"><span class="hljs-comment"><span class="hljs-comment">//  let name = company.name //  company.willAccessValue(forKey: "name") let name = company.primitiveValue(forKey: "name") company.didAccessValue(forKey: "name") //  company.name = " " //  company.willChangeValue(forKey: "name") company.setPrimitiveValue(" ", forKey: "name") company.didChangeValue(forKey: "name")</span></span></code> </pre><br>  Use primitivas nos eventos NSManagedObject em vez da atribui√ß√£o usual para evitar o loop.  Um exemplo: <br><br><pre> <code class="objectivec hljs">override func willSave() {   let nameP = encrypt(field: primitiveValue(forKey: <span class="hljs-string"><span class="hljs-string">"name"</span></span>), password: password)   setPrimitiveValue(nameP, forKey: <span class="hljs-string"><span class="hljs-string">"nameC"</span></span>)   <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.willSave() }  override func awakeFromFetch() {   let nameP = decrypt(field: primitiveValue(forKey: <span class="hljs-string"><span class="hljs-string">"nameC"</span></span>), password: password)   setPrimitiveValue(nameP, forKey: <span class="hljs-string"><span class="hljs-string">"name"</span></span>)   <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.awakeFromFetch() }</code> </pre><br>  Se de repente, em algum momento, voc√™ precisar parafusar a fun√ß√£o awakeFromFetch em um projeto, ficar√° surpreso que ela funcione de maneira muito estranha, mas, na verdade, ela n√£o √© chamada quando voc√™ executa a solicita√ß√£o.  Isso ocorre porque o Core Data possui um mecanismo de armazenamento em cache muito inteligente e, se a sele√ß√£o j√° estiver na mem√≥ria (por exemplo, porque voc√™ acabou de preencher esta tabela), o m√©todo n√£o ser√° chamado.  No entanto, meus experimentos mostraram que, em termos de valores calculados, voc√™ pode confiar com seguran√ßa no uso do awakeFromFetch, conforme a documenta√ß√£o da Apple.  Se, para teste e desenvolvimento, voc√™ precisar for√ßar o awakeFromFetch, adicione managedObjectContext.refreshAllObjects () antes da solicita√ß√£o. <br><br>  S√≥ isso. <br><br>  Obrigado a todos que leram at√© o fim. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt436510/">https://habr.com/ru/post/pt436510/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt436500/index.html">Como o quadro de Rise of the Tomb Raider √© renderizado</a></li>
<li><a href="../pt436502/index.html">Pampers de assinatura ou como vender mais para os mesmos clientes</a></li>
<li><a href="../pt436504/index.html">Sistema no pacote ou O que h√° sob a cobertura do pacote de chips?</a></li>
<li><a href="../pt436506/index.html">Como criar um racista de IA sem muito esfor√ßo</a></li>
<li><a href="../pt436508/index.html">US $ 10 milh√µes em investimentos e elogios de Wozniak - criando um computador educacional para crian√ßas</a></li>
<li><a href="../pt436512/index.html">Como encontramos lan√ßamentos problem√°ticos com o Graphite e o Moira. Experimente o Yandex.Money</a></li>
<li><a href="../pt436514/index.html">Criando hist√≥rias para Instagram a partir do PHP</a></li>
<li><a href="../pt436518/index.html">Haiku Œ≤1 - torne o / b / OS √≥timo novamente</a></li>
<li><a href="../pt436520/index.html">N√£o use os servi√ßos de verifica√ß√£o online ao vazar dados pessoais</a></li>
<li><a href="../pt436522/index.html">Ao contr√°rio das instru√ß√µes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>