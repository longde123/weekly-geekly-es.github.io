<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🈁 👋🏼 🚺 Varonis仪表板中的7个主要Active Directory风险指标 🙅🏿 🤵🏼 📑</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="攻击者需要的只是时间和动机来渗透您的网络。 但是我们与您的合作是防止他执行此操作，或者至少使该任务复杂化。 您需要首先确定Active Directory（以下称为AD）中的弱点，攻击者可以利用这些弱点来获取访问权限并在网络中四处移动，而未被发现。 今天，在本文中，我们将以AD Varonis仪表板...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Varonis仪表板中的7个主要Active Directory风险指标</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/varonis/blog/463703/"><img src="https://habrastorage.org/webt/9w/zd/ut/9wzdutk6dodooxj8jf-d972yx78.png"><br><br> 攻击者需要的只是时间和动机来渗透您的网络。 但是我们与您的合作是防止他执行此操作，或者至少使该任务复杂化。 您需要首先确定Active Directory（以下称为AD）中的弱点，攻击者可以利用这些弱点来获取访问权限并在网络中四处移动，而未被发现。 今天，在本文中，我们将以AD Varonis仪表板为例，研究反映贵组织网络防御中现有漏洞的风险指标。 <br><a name="habracut"></a><br><h2> 攻击者在域中使用特定的配置 </h2><br> 攻击者使用许多技巧和漏洞来渗透公司网络并增加特权。 这些漏洞中的一些是域配置参数，在识别它们之后可以轻松更改。 <br><br> 如果您（或您的系统管理员）上个月没有更改KRBTGT密码，或者有人通过内置的默认管理员帐户（管理员）进行了身份验证，则AD仪表板会立即通知您。 这两个帐户提供对您的网络的无限访问权限：攻击者将尝试获取对它们的访问权限，以自由绕过特权和访问权限之间的任何区别。 因此，可以访问他们感兴趣的任何数据。 <br><br> 当然，您可以自己检测到这些漏洞：例如，设置日历提醒以进行验证或运行PowerShell脚本来收集此信息。 <br><br>  Varonis仪表板会<strong>自动</strong>更新，以快速查看和分析突出显示潜在漏洞的关键指标，因此您可以立即采取行动。 <br><br><h3> 域级别的3个关键风险指标 </h3><br> 以下是Varonis仪表板上可用的许多小部件，这些小部件的使用将显着增强对整个公司网络和IT基础结构的保护。 <br><br>  <strong>1. Kerberos帐户密码没有显着更改的域数</strong> <br><br>  KRBTGT帐户是AD中的特殊帐户，用于对所有<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Kerberos票证进行</a>签名。 获得域控制器（DC）访问权限的攻击者可以使用此帐户创建<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">黄金票</a> ，这将使他们不受限制地访问公司网络上的几乎所有系统。 我们面临的情况是，攻击者成功获得金票后，便可以访问组织的网络两年。 如果您公司中的KRBTGT帐户的密码在最近四十天内没有更改，则该小部件将通知您。 <br><br> 对于攻击者而言，四十天足够的时间来访问网络。 但是，如果您定期提供并标准化更改密码的过程，这将使攻击者渗透到公司网络的任务大大复杂化。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kl/c7/lj/klc7ljtzudkxz1yjbnchn8tvdhk.jpeg"></div><br> 请记住，根据Microsoft实施的Kerberos协议，您需要两次<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">更改</a> KRBTGT <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">密码</a> 。 <br><br> 将来，此AD小部件将提醒您何时该为网络上的所有域再次更改KRBTGT密码。 <br><br>  <strong>2.最近使用内置管理员帐户的域数</strong> <br><br> 根据<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">最小特权原则，</a>为系统管理员提供了两个帐户：第一个帐户用于日常使用，第二个帐户用于计划的管理工作。 这意味着没有人可以使用默认的管理员帐户。 <br><br> 内置管理员帐户通常用于简化系统管理过程。 这可能是一个坏习惯，从而导致黑客入侵。 如果这在您的组织中发生，那么您将很难区分此帐户的正确使用与潜在的恶意访问。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/_p/ru/tn/_prutnq-pofmz5eccutuxgkz9p4.jpeg"></div><br> 如果窗口小部件显示的非零值，则表示某人无法正确使用管理帐户。 在这种情况下，您必须采取措施纠正和限制对内置管理员帐户的访问。 <br> 一旦您将小部件的价值设置为零，并且系统管理员不再使用该帐户进行工作，那么将来，如果对其进行任何更改，都将表明潜在的网络攻击。 <br><br>  <strong>3.没有受保护的用户（受保护的用户）组的域数</strong> <br><br>  AD的旧版本支持弱加密类型-RC4。 黑客很多年前破解了RC4，现在，对于攻击者来说，破解仍然使用RC4的帐户是一项微不足道的任务。  Windows Server 2012中引入的Active Directory版本引入了一组新类型的用户，称为“受保护的用户组”。 它提供了其他安全工具，并阻止了使用RC4加密的用户身份验证。 <br><br> 此小部件将演示在组织的任何域中是否没有这样的组，以便您可以对其进行修复，即 启用安全的用户组并使用它来保护基础结构。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/tz/ym/a1/tzyma13-jsxx5fpr59tqs_hbxcs.jpeg"></div><br><h2> 攻击者的轻目标 </h2><br> 用户帐户是攻击者的第一大目标-从首次尝试渗透到不断升级的特权并隐藏其行为。 攻击者使用基本的PowerShell命令在网络上寻找简单目标，这些目标通常很难检测到。 尽可能多地从AD移除这些轻目标。 <br><br> 攻击者将寻找没有限制密码的用户（或不需要密码的用户），作为管理员的技术帐户以及使用旧RC4加密的帐户。 <br><br> 这些帐户中的任何一个都不容易访问，或者通常不会受到监视。 攻击者可以劫持这些帐户并在基础架构内自由移动。 <br><br> 一旦攻击者侵入安全范围，他们就有可能获得至少一个帐户的访问权限。 在检测并终止攻击之前，是否可以阻止它们访问敏感数据？ <br><br>  Varonis AD仪表板将指向易受攻击的用户帐户，以便您可以提前解决问题。 进入您的网络越困难，则在攻击者造成严重破坏之前抵消其攻击的可能性就越大。 <br><br><h3> 用户帐户的4个关键风险指标 </h3><br> 以下是Varonis AD仪表板中指示最易受攻击的用户帐户的窗口小部件示例。 <br><br>  <strong>1.具有永不过期密码的活动用户数</strong> <br><br> 对于任何攻击者而言，访问此类帐户始终是一个巨大的成功。 由于密码永不过期，因此攻击者会在网络内获得永久性立足点，然后可用于<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">增加特权</a>或在基础架构内移动。 <br> 攻击者拥有可用于凭据替换攻击的数百万个用户密码组合的列表，以及 <br> 用户使用“永恒”密码的组合在这些列表之一中，远远超过了零。 <br><br> 密码未过期的帐户易于管理，但不安全。 使用此小部件可查找具有这些密码的所有帐户。 更改此设置并更新密码。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/2n/9z/li/2n9zlijdxnpv_d-oejd64qbaj-8.jpeg"></div><br> 一旦此小部件的值变为零，使用此密码创建的任何新帐户都将出现在仪表板上。 <br><br>  <strong>2.具有SPN的管理帐户的数量</strong> <br><br>  SPN（服务主体名称）是服务实例的唯一标识符。 此小部件显示有多少个具有完全管理员权限的服务帐户。 小部件上的值必须为零。 出现具有管理员权限的SPN是因为授予此类权限对于软件提供商和应用程序管理员来说很方便，但这会带来安全风险。 <br><br> 通过授予服务帐户管理员特权，攻击者可以完全访问未使用的帐户。 这意味着有权访问SPN帐户的攻击者可以在基础结构内部自由采取行动，同时避免监视其行为。 <br><br> 您可以通过更改服务帐户的权限来解决此问题。 此类帐户必须遵守最小特权原则，并且仅具有其工作真正必需的访问权限。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ro/nz/vz/ronzvz9-hue_1o6qamdrpk4tm4g.jpeg"></div><br> 使用此小部件，您可以找到具有管理员权限的所有SPN，消除此类特权并进一步控制SPN，并遵循具有最少特权的相同访问原则。 <br><br> 新出现的SPN将显示在仪表板上，您可以控制此过程。 <br><br>  <strong>3.不需要Kerberos预身份验证的用户数</strong> <br><br> 理想情况下，Kerberos使用AES-256加密对身份验证票进行加密，该身份票至今仍未中断。 <br><br> 但是，较早版本的Kerberos使用RC4加密，现在可以在几分钟内破解它。 此小部件显示哪些用户帐户仍在使用RC4。  Microsoft仍支持RC4以实现向后兼容性，但这并不意味着您应该在AD中使用它。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ia/b3/iz/iab3izxlvovxr29lko7ctpkkz3e.jpeg"></div><br> 找到此类帐户后，您需要清除AD中的“不需要Kerberos预授权”复选框，以便这些帐户使用更复杂的加密。 <br><br> 在没有Varonis AD仪表板的情况下，这些帐户的自我发现非常耗时。 实际上，及时通知所有经过编辑以使用RC4加密的帐户是一项更加困难的任务。 <br><br> 如果窗口小部件上的值更改，则可能表明存在非法操作。 <br><br>  <strong>4.没有密码的用户数</strong> <br><br> 攻击者使用基本的PowerShell命令从帐户属性中的AD属性读取“ PASSWD_NOTREQD”标志。 使用此标志意味着不需要密码的存在或复杂性。 <br> 使用简单密码或空白密码窃取帐户有多容易？ 现在，假设这些帐户之一是管理员。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9q/2d/sk/9q2dskiiz2lxugt8ackzhatunym.jpeg"></div><br> 如果向所有人开放的数千个机密文件之一是即将发布的财务报告，该怎么办？ <br><br> 忽略强制密码输入要求是过去经常使用的系统管理的另一种快捷方式，但是今天它是不可接受且不安全的。 <br><br> 通过更新这些帐户的密码来解决此问题。 <br><br> 将来监视此小部件将有助于您避免使用没有密码的用户帐户。 <br><br><h2>  Varonis赔率均等 </h2><br> 过去，收集和分析文章中的指标的工作耗时数小时，并且需要对PowerShell的深入了解：安全专家必须每周或每月为此类任务分配资源。 但是，手动收集和处理此信息为攻击者提供了渗透和数据盗窃的先机。 <br><br> 使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Varonis，</a>您将花费一天的时间来部署AD仪表板和其他组件，以收集所有考虑的漏洞和许多其他漏洞。 将来，在操作过程中，仪表板将随着基础结构状态的变化而自动更新。 <br><br> 进行网络攻击始终是攻击者和防御者之间的竞赛，攻击者希望在安全专家阻止访问之前窃取数据。 尽早发现网络犯罪分子及其非法行为，再加上强大的网络防御能力，是确保数据安全的关键。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN463703/">https://habr.com/ru/post/zh-CN463703/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN463689/index.html">一位健康的IT专家的EDC：我随身携带一切</a></li>
<li><a href="../zh-CN463691/index.html">如何在Xamarin Android应用中通过便携式蓝牙EPS / POS打印机轻松连接并开始打印</a></li>
<li><a href="../zh-CN463693/index.html">带有“声学透镜”的声音投影仪-我们了解该技术的工作原理</a></li>
<li><a href="../zh-CN463697/index.html">模态控制磁悬浮系统的研究</a></li>
<li><a href="../zh-CN463701/index.html">古迹：诺基亚N900-与众不同的手机</a></li>
<li><a href="../zh-CN463707/index.html">沉浸式技术使我们沉浸在何处</a></li>
<li><a href="../zh-CN463709/index.html">DJI Osmo Mobile 3最佳12项创新</a></li>
<li><a href="../zh-CN463711/index.html">如何使员工学会自己在新系统中工作</a></li>
<li><a href="../zh-CN463717/index.html">在Intel Cyclone V上为绝对初学者构建裸机应用</a></li>
<li><a href="../zh-CN463719/index.html">项目管理方法工具（第2部分）</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>