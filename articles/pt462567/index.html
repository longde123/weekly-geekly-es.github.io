<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ò™Ô∏è üëÜüèª üå∫ Sodinokibi Ransomware: um estudo detalhado üí∏ üìû üëéüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O ransomware Sodinokibi foi mencionado recentemente nas not√≠cias, mas poucos se aprofundam nos detalhes desse malware. Hoje vamos tentar conhecer Sodi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sodinokibi Ransomware: um estudo detalhado</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/acronis/blog/462567/">  O ransomware Sodinokibi foi mencionado recentemente nas not√≠cias, mas poucos se aprofundam nos detalhes desse malware.  Hoje vamos tentar conhecer Sodinokibi mais de perto, considerar os princ√≠pios do ransomware para identificar vetores priorit√°rios para proteger os sistemas de informa√ß√£o de uma nova amea√ßa. <br><br><img src="https://habrastorage.org/webt/ow/o7/r6/owo7r6oqzz6yfcvxv_g0b7dpzs0.png"><br><a name="habracut"></a><br>  Autores do texto: Ravikant Tiwari e Alexander Koshelev <br><br><h3>  O que sabemos sobre Sodinokibi? </h3><br>  O Sodinokibi provavelmente est√° sendo espalhado pelos mesmos atacantes conhecidos por ataques de ransomware da fam√≠lia GandCrab, que, a julgar pelos relat√≥rios em f√≥runs clandestinos, n√£o ser√£o mais desenvolvidos. <br><br>  Sodinokibi usa a vulnerabilidade do Oracle WebLogic (CVE-2019-2725) para obter acesso ao computador da v√≠tima.  Uma vez no sistema, o malware tenta executar-se com direitos estendidos para obter acesso a todos os arquivos e recursos do PC sem restri√ß√£o ... <br>  Sodinokibi tenta n√£o infectar computadores no Ir√£, R√∫ssia e outros pa√≠ses da ex-URSS. <br><br>  O programa de ransomware usa os algoritmos AES e Salsa20 para criptografar arquivos do usu√°rio.  O AES √© usado para criptografar chaves de sess√£o, bem como dados enviados ao servidor de gerenciamento. <br><br>  Os arquivos do usu√°rio s√£o criptografados usando o Salsa20. <br><br>  Para gerar e distribuir chaves, Sodinokibi usa o algoritmo Diffie-Hellman em curvas el√≠pticas. <br><br>  Uma vez na m√°quina, o v√≠rus exclui instantaneamente todos os arquivos da pasta de backup. <br><br>  No momento, o ransomware est√° solicitando 0,32806964 BTC (‚âà $ 2.500) para restaurar o acesso aos arquivos criptografados.  Al√©m disso, se o resgate n√£o for pago dentro de 4 dias, os extorsionistas prometem dobrar o valor ... <br><br><h3>  Como funciona o Sodinokibi? </h3><br>  Estudamos uma inst√¢ncia de Sodinokibi em nosso laborat√≥rio.  O ransomware foi empacotado por um empacotador personalizado.  Ao mesmo tempo, mesmo ap√≥s a descompacta√ß√£o bem-sucedida, n√£o havia linhas leg√≠veis no c√≥digo.  Al√©m disso, o software n√£o importa nenhuma biblioteca ou API do sistema.  Portanto, ser√° muito dif√≠cil para antiv√≠rus est√°ticos que usam assinaturas baseadas em seq√º√™ncias de caracteres leg√≠veis e tabelas de APIs importadas para detect√°-lo. <br><br>  Os nomes de API e outros par√¢metros foram descriptografados enquanto o software estava em execu√ß√£o usando o algoritmo RC4.  Para tornar a detec√ß√£o ainda mais dif√≠cil para antiv√≠rus, este ransomware executa opera√ß√µes em seq√º√™ncias de caracteres usando um hash DJB em vez das pr√≥prias seq√º√™ncias ... <br><br><h3>  Inicializa√ß√£o </h3><br>  Sodinokibi come√ßa criando uma tabela de importa√ß√£o din√¢mica.  Primeiro de tudo, o programa est√° convencido de que √© a √∫nica c√≥pia no sistema pelo m√©todo de verifica√ß√£o de mutexes.  Ap√≥s a verifica√ß√£o, descriptografa a configura√ß√£o JSON usando RC4, que √© armazenado no arquivo de programa e verifica o valor booleano da chave ‚Äúexp‚Äù.  Se seu valor for "verdadeiro", Sodinokibi tenta iniciar uma explora√ß√£o.  Foi o que aconteceu em nossa amostra, e por isso ele executou a fun√ß√£o de explorar vulnerabilidades <br><br><img src="https://habrastorage.org/webt/zg/jl/1-/zgjl1-mazfcbijmbdjy-xzgwffw.png"><br><br><img src="https://habrastorage.org/webt/a3/mf/2d/a3mf2do1b2kblyq6nbu3us-vopi.png"><br>  <i><font color="#999999">Configura√ß√£o JSON descriptografada</font></i> <br><br>  O c√≥digo que executa a explora√ß√£o verifica se a atualiza√ß√£o de 11 de setembro de 2018 (KB4457138) foi instalada no computador.  Este patch corrige muitas das vulnerabilidades abaixo.  E se n√£o estiver na m√°quina, o Ransomware inicia o c√≥digo de shell de 32 ou 64 bits, dependendo da plataforma em que o malware √© executado.  Acreditamos que o ransomware est√° tentando elevar privil√©gios para um administrador usando o CVE-2018-8440. <br><br><img src="https://habrastorage.org/webt/ge/cd/uk/gecduk1m7ga29wiioqmee4k-sjk.png"><br>  <i><font color="#999999">Snippet 1</font></i> <br><br>  A lista de vulnerabilidades corrigidas pelo KB4457138 corrige: <br><br>  O patch KB4457138 corrige as vulnerabilidades: <br><br><ul><li>  CVE-2018-8457, CVE-2018-8335, CVE-2018-8424, CVE-2018-8455, CVE-2018-8468, CVE-2018-8447, CVE-2018-8475, CVE-2018-8271, CVE- 2018-8440, CVE-2018-8464, CVE-2018-8469, CVE-2018-8421, CVE-2018-8442, CVE-2018-8367, CVE-2018-8443, CVE-2018-8465, CVE-2018- 8419, CVE-2018-8466, CVE-2018-8410, CVE-2018-8467, CVE-2018-8462, CVE-2018-8452, CVE-2018-8446, CVE-2018-8449, CVE-2018-8420, CVE-2018-8433, CVE-2018-8438, CVE-2018-8435, CVE-2018-8456, CVE-2018-8354, CVE-2018-8434, CVE-2018-8470, CVE-2018-8332, CVE- 2018-0965, CVE-2018-8315, CVE-2018-8439, CVE-2018-8392, CVE-2018-8425, CVE-2018-8393. </li></ul><br><br>  Se uma vulnerabilidade n√£o for detectada no sistema e o processo continuar funcionando como usu√°rio comum, o comando RUNAS ser√° usado para iniciar outra inst√¢ncia, mas com direitos administrativos, e a atual que estiver trabalhando com privil√©gios limitados ser√° conclu√≠da.  O pseudoc√≥digo completo √© mostrado na captura de tela abaixo. <br><br><img src="https://habrastorage.org/webt/ge/cd/uk/gecduk1m7ga29wiioqmee4k-sjk.png"><br><br>  Depois que o Sodinokibi inicia com √™xito no modo administrador, o software executa uma verifica√ß√£o preliminar adicional e esclarece o valor da chave "bro" na configura√ß√£o JSON e descobre o pa√≠s da localiza√ß√£o.  Ele n√£o tentar√° infectar computadores dos seguintes pa√≠ses, se esses par√¢metros de localiza√ß√£o foram definidos nas configura√ß√µes do computador. <br><br><img src="https://habrastorage.org/webt/i5/yv/2m/i5yv2m2hqz8lpaztizkchsrek-4.png"><br>  <i><font color="#999999">Refinando IDs de Idioma</font></i> <br><br>  Lista de pa√≠ses de exce√ß√£o <br><br><ul><li>  Rom√™nia, R√∫ssia, Ucr√¢nia, Bielorr√∫ssia, Est√¥nia, Let√¥nia, Litu√¢nia, Tajiquist√£o, Ir√£, Arm√™nia, Azerbaij√£o, Ge√≥rgia, Cazaquist√£o, Quirguist√£o, Turquemenist√£o, Uzbequist√£o, Tartarist√£o </li></ul> <br>  * Nota do editor: por um motivo desconhecido, os autores destacam especificamente o local t√°rtaro na R√∫ssia <br><br>  Ap√≥s passar no teste, o malware finaliza o processo mysql.exe (se foi iniciado) para obter acesso aos arquivos MySQL e criptograf√°-los.  Depois disso, o ransomware remove c√≥pias de sombra do Windows usando o vssadmin e tamb√©m desativa o sistema de recupera√ß√£o do Windows usando o bcdedit: <br><br> <code>vssadmin.exe Delete Shadows /All /Quiet &amp; bcedit /set {default} <br> recoveryenabled No &amp; bcedit /set {default} bootstatuspolice ignorealfailures</code> <br> <br>  Antes de criptografar arquivos do usu√°rio, o Sodinokibi procura em todos os sistemas de arquivos, incluindo pastas de rede, para encontrar diret√≥rios com o nome "backup" e os exclui permanentemente.  √â interessante que, antes de excluir o pr√≥prio diret√≥rio, o malware substitua primeiro o conte√∫do de todas essas pastas por um conjunto aleat√≥rio de bytes para tornar a recupera√ß√£o imposs√≠vel em princ√≠pio.  Felizmente, os arquivos do Acronis Backup n√£o podem ser exclu√≠dos com tanta facilidade, porque eles est√£o protegidos no n√≠vel do kernel, especificamente para impedir que o ransomware execute essas a√ß√µes. <br><br><h3>  Gera√ß√£o de chaves </h3><br>  Sodinokibi usa o protocolo de gera√ß√£o e troca de curvas el√≠pticas Diffie - Hellman (ECDH).  As chaves de sess√£o geradas s√£o usadas em algoritmos de criptografia sim√©trica, e diferentes tipos de dados s√£o criptografados usando m√©todos diferentes - AES e Salsa20. <br><br>  O AES √© usado para criptografar uma chave privada de um par de chaves p√∫blicas e privadas geradas localmente na m√°quina do usu√°rio.  Ele tamb√©m criptografa os dados durante a transmiss√£o pela rede.  Salsa20 √© usado para criptografar arquivos do usu√°rio. <br><br>  Sodinokibi cont√©m duas chaves p√∫blicas diferentes, uma das quais faz parte da configura√ß√£o JSON e a segunda √© incorporada no bin√°rio.  Essas chaves p√∫blicas ser√£o usadas para criptografar a chave privada criada na m√°quina.  As etapas espec√≠ficas da gera√ß√£o e criptografia de chaves s√£o as seguintes: <br><br>  <b>Etapa 1.</b> Gera√ß√£o de um par de sess√µes a partir de uma chave privada (n√∫mero secreto, aleat√≥rio) e p√∫blica na m√°quina local. <br><br><img src="https://habrastorage.org/webt/ss/o7/s_/sso7s_-kmgvl8z8tqqecaufm7va.png"><br>  <i><font color="#999999">Gera√ß√£o local de chaves p√∫blicas e privadas</font></i> <br><br>  A criptografia da chave privada da Etapa 1 ocorre usando a chave p√∫blica da configura√ß√£o JSON <br><br>  <b>Etapa 2.</b> Gere outro par de chaves p√∫blicas e privadas. <br><br>  <b>Etapa 3.</b> Usando a chave privada da Etapa 2 e a chave p√∫blica (valor da chave pk), uma chave p√∫blica √© gerada a partir do JSON e, ap√≥s o hash, uma chave sim√©trica √© obtida. <br><br><img src="https://habrastorage.org/webt/lo/sp/af/lospafrq5cwhv1ucx8rq3cc6nem.png"><br>  <i><font color="#999999">Gere uma chave sim√©trica usando uma chave compartilhada</font></i> <br><br>  <b>Etapa 4.</b> Gera√ß√£o de um IV de 16 bits (vetor de inicializa√ß√£o). <br><br>  <b>Etapa 5.</b> Criptografe a chave privada gerada na Etapa 1 usando o AES com a chave e IV, que foram obtidas durante as Etapas 3 e 4. <br><br>  <b>Etapa 6.</b> C√°lculo do CRC32 para a chave privada criptografada, exibida na etapa 5. <br><br>  <b>Etapa 7.</b> Adicionando IV e CRC32 ao final do buffer que cont√©m a chave privada criptografada da Etapa 5. <br><br>  <b>Etapa 8.</b> Salvando o buffer no arquivo associado ao deslocamento (marcado ‚Äúsk_key‚Äù). <br><br><img src="https://habrastorage.org/webt/au/tu/tp/aututpoxj74jy0shog3h30cms4m.png"><br>  <i><font color="#999999">Criptografe a chave privada da Etapa 1 usando as chaves p√∫blicas do invasor</font></i> <i><font color="#999999"><br><br></font></i>  <i><font color="#999999">Criptografe a chave privada da Etapa 1 usando a chave p√∫blica contida no arquivo bin√°rio.</font></i> <br><br>  <b>Etapa 9.</b> Repita as etapas 2 a 7 usando outra chave p√∫blica que foi incorporada no arquivo bin√°rio na Etapa 3. <br><br>  <b>Etapa 10.</b> Salvar o buffer em um arquivo mapeado com um deslocamento na mem√≥ria (marque ‚Äú0_key‚Äù) <br>  sk_key, 0_key e pk_key s√£o gravados no registro de acordo, dependendo dos direitos de acesso recebidos pelo programa ... <br><br>  HKLM \ SOFTWARE \ recfg \ sk_key ou HKCU \ SOFTWARE \ recfg \ sk_key <br>  HKLM \ SOFTWARE \ recfg \ 0_key ou HKCU \ SOFTWARE \ recfg \ 0_key <br>  HKLM \ SOFTWARE \ recfg \ pk_key ou HKCU \ SOFTWARE \ recfg \ pk_key <br><br><img src="https://habrastorage.org/webt/ey/la/os/eylaoslusems6caly5ma0gwgez8.png">  <i><font color="#999999">Chave secreta criptografada no registro</font></i> <i><font color="#999999"><br></font></i>  <i><font color="#999999">Gera√ß√£o de chaves para arquivos individuais com Salsa20</font></i> <br><br>  <b>Etapa 11.</b> Gere um novo par a partir da chave p√∫blica e privada. <br><br>  <b>Etapa 12.</b> Gere uma chave compartilhada usando a chave p√∫blica da sess√£o criada na Etapa 2 e o hash para obter a pr√≥xima chave sim√©trica necess√°ria para gerar as chaves no Salsa20. <br><br>  <b>Etapa 13.</b> Instalando uma chave de 256 bits (32 bytes) no Salsa20 <br><br>  <b>Etapa 14.</b> Gere um IV de 8 bits para as chaves Salsa20 <br><br>  <b>Etapa 15.</b> Gera√ß√£o de chave Salsa20 <br><br>  <b>Etapa 16.</b> Usando o Salsa20 key_state para criptografar arquivos do usu√°rio com o Salsa20. <br><br><img src="https://habrastorage.org/webt/ej/xs/yq/ejxsyqwuteyfomfybfsrsdyolvc.png"><br>  <i><font color="#999999">Gera√ß√£o de chave Salsa20 para cada arquivo</font></i> <i><font color="#999999"><br></font></i>  <i><font color="#999999">Repita as etapas 11 a 16 para cada arquivo criptografado.</font></i> <br><br><h3>  Ilustra√ß√£o de criptografia e descriptografia </h3><br>  Para entender melhor como as chaves s√£o geradas e transmitidas entre os computadores do atacante e da v√≠tima, voc√™ precisa descobrir como o algoritmo Diffie Hellman funciona - isso √© f√°cil de fazer por ilustra√ß√£o. <br><br><h3>  Processo de criptografia </h3><br><img src="https://habrastorage.org/webt/h4/wy/v1/h4wyv1ghwh-gvjedkpk8r5efoa4.png"><br>  <i><font color="#999999">Troca de chaves de curva el√≠ptica de Diffie-Hellman (ECDH)</font></i> <br><br><img src="https://habrastorage.org/webt/_w/jh/j-/_wjhj-xhi3xqpklm437g5eicadu.png"><br>  <i><font color="#999999">Uma descri√ß√£o detalhada do processo de criptografia em Sodinokibi</font></i> <br><br>  Para descriptografar os dados, ser√£o necess√°rias as chaves privadas do invasor.  Mas eles n√£o s√£o publicados em nenhum lugar e, portanto, √© imposs√≠vel restaurar arquivos. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/155/103/aed/155103aedec3a0a2df481b585b12e0e5.png" alt="imagem"><br>  <i><font color="#999999">Processo de descriptografia (o segredo do invasor √© sua chave privada)</font></i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/533/3be/cc1/5333becc1ca07074b35d708cc402796f.png" alt="imagem"><br>  <i><font color="#999999">O processo simplificado de descriptografar arquivos do usu√°rio √© ilustrado abaixo.</font></i> <br><br><h3>  Criptografia de arquivo em discos r√≠gidos locais e pastas de rede </h3><br>  Para criptografar arquivos do usu√°rio, o Sodinokibi usa portas de conclus√£o de E / S e inicia v√°rios fluxos de criptografia, mas n√£o mais que o dobro do n√∫mero de n√∫cleos de processador na m√°quina, associando esses fluxos a uma porta de E / S especialmente criada.  Esses encadeamentos usam a fun√ß√£o API GetQueuedCompletionStatus Win para aguardar a chegada de um pacote na porta de E / S antes de iniciar a criptografia de arquivos. <br><br>  Assim que os fluxos s√£o criados e aguardam a chegada dos pacotes de E / S, Sodinokibi come√ßa a classificar os arquivos do usu√°rio em todas as unidades locais e em todas as pastas da rede, excluindo CDROM e RAMDISK e atribuindo-os √†s portas de conclus√£o de E / S correspondentes.  Para todos os arquivos que n√£o se enquadram na lista de exce√ß√µes nos nomes de pastas, arquivos e extens√µes, a fun√ß√£o AddFileToIoCompletionPort √© chamada e, em seguida, PostQueuedCompletionStatus Isso passa a execu√ß√£o para o fluxo de criptografia, que aguarda informa√ß√µes na porta de conclus√£o de E / S para iniciar a criptografia de arquivos. <br><br>  A fun√ß√£o AddFileToIoCompletionPort tamb√©m gera uma chave Salsa20 exclusiva para cada arquivo a ser criptografado e passa a chave Salsa20 para o fluxo de criptografia, juntamente com outros metadados que devem ser registrados ap√≥s a criptografia, usando o par√¢metro lpOverlapped da fun√ß√£o API PostQueuedCompletionStatus Win. <br><br>  Ap√≥s o processamento dos arquivos em cada diret√≥rio, exceto a exce√ß√£o, um arquivo √© criado com uma demanda de resgate.  Quando os arquivos a serem criptografados acabam, os encadeamentos entram em loop e aguardam at√© que o n√∫mero total de arquivos criptografados e renomeados atinja o n√∫mero total de arquivos transferidos para a porta de conclus√£o de E / S. <br><br>  Finalmente, o sistema define um sinalizador que reflete que n√£o h√° mais arquivos para criptografar e envia v√°rios pacotes de E / S sinalizando a conclus√£o do processo.  Gra√ßas a isso, a interrup√ß√£o de fluxos de criptografia adicionais que estavam aguardando dados √© alcan√ßada. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3ba/7a2/e30/3ba7a2e309a6402db2e6dd37adf44acc.png" alt="imagem"><br><br>  Lista de pastas de exce√ß√£o <br><br><ul><li>  "$ windows. ~ bt" </li><li>  "Intel" </li><li>  "Arquivos de programa (x86)" </li><li>  "Arquivos de programa" </li><li>  "Msocache" </li><li>  "$ recycle.bin" </li><li>  "$ windows. ~ ws" </li><li>  "Navegador Tor" </li><li>  "Boot" </li><li>  "Informa√ß√µes do volume do sistema" </li><li>  "Perflogs" </li><li>  Google </li><li>  "Dados do aplicativo" </li><li>  "Windows" </li><li>  "Dados do programa" </li><li>  "Windows.old" </li><li>  "Appdata" </li><li>  "Mozilla" </li><li>  Exce√ß√µes de arquivo </li><li>  "Bootfont.bin" </li><li>  "Boot.ini" </li><li>  "Ntuser.dat" </li><li>  "Desktop.ini" </li><li>  "Iconcache.db" </li><li>  Ntldr </li><li>  "Ntuser.dat.log" </li><li>  "Thumbs.db" </li><li>  "Bootsect.bak" </li><li>  "Ntuser.ini" </li><li>  "Autorun.inf" </li><li>  Exce√ß√µes de extens√£o </li><li>  "Themepack" </li><li>  Ldf </li><li>  Scr </li><li>  Icl </li><li>  "386" </li><li>  "Cmd" </li><li>  "Ani" </li><li>  "Adv" </li><li>  "Tema" </li><li>  "Msi" </li><li>  "RTP" </li><li>  "Diagcfg" </li><li>  "Msstyles" </li><li>  "Bin" </li><li>  Hlp </li><li>  Shs </li><li>  Drv </li><li>  "Wpx" </li><li>  "Deskthemepack" </li><li>  "Morcego" </li><li>  "Rom" </li><li>  "Msc" </li><li>  "Lnk" </li><li>  T√°xi </li><li>  "Spl" </li><li>  "Ps1" </li><li>  "Msu" </li><li>  Ics </li><li>  "Chave" </li><li>  "Msp" </li><li>  "Com" </li><li>  Sys </li><li>  "Diagpkg" </li><li>  "Nls" </li><li>  "Diagcab" </li><li>  Ico </li><li>  "Bloquear" </li><li>  "Ocx" </li><li>  "Mpa" </li><li>  "Cur" </li><li>  Cpl </li><li>  "Mod" </li><li>  Hta </li><li>  "Exe" </li><li>  "Icns" </li><li>  "Prf" </li><li>  "DLL" </li><li>  "Nomedia" </li><li>  Idx </li></ul><br>  O fluxo de criptografia pressup√µe a leitura do conte√∫do do arquivo, criptografia, grava√ß√£o no mesmo arquivo, adi√ß√£o de metadados, incluindo a chave privada da sess√£o criptografada, com a parte p√∫blica do ECDH para cada arquivo e o vetor de inicializa√ß√£o Salsa20 usado para criptografar o arquivo. <br><br>  Depois disso, o fluxo renomeia o arquivo, adicionando ao nome um nome gerado aleatoriamente.  Os arquivos s√£o criptografados com o algoritmo Salsa20 usando a fun√ß√£o EncryptAndWrite. <br><br>  A seguir, √© apresentado um exemplo de chamada √† fun√ß√£o EncryptingThreadRoutine. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/585/d44/fab/585d44fab868f9461a5963dc1f6a9f72.png" alt="imagem"><br>  <i><font color="#999999">Estrutura de arquivo ap√≥s criptografia</font></i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1ce/0a1/c4a/1ce0a1c4acd810503e66c32de66c0a93.png" alt="imagem"><br>  <i><font color="#999999">Estrutura de arquivos criptografados</font></i> <br><br><h3>  Atividade de rede </h3><br>  Ap√≥s a conclus√£o do processo de criptografia, o ransomware prepara os dados para o envio ao servidor de gerenciamento.  Os dados incluem v√°rios campos da configura√ß√£o JSON, informa√ß√µes do sistema e chaves de criptografia.  Os dados preparados tamb√©m s√£o gravados no registro com a chave "[HKLM | HKCU] \ SOFTWARE \ recfg \ stat" antes de serem criptografados pelo AES e enviados ao servidor do invasor ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/177/c79/75b/177c7975bd8ed873554686cd35085dee.png" alt="imagem"><br><br>  Dados de rede <br><br><img src="https://habrastorage.org/webt/_e/7-/nt/_e7-ntfpxprjff32wylpvkqbwou.jpeg"><br><br>  O nome do dom√≠nio consiste em: sochi-okna23 [.] Ru + parte do endere√ßo 1 <br><br><ul><li>  "Conte√∫do Wp" </li><li>  "Est√°tico" </li><li>  "Conte√∫do" </li><li>  "Incluir" </li><li>  "Uploads" </li><li>  "Not√≠cias" </li><li>  "Dados" </li><li>  "Admin" </li></ul><br>  e parte do endere√ßo 2 <br><br><ul><li>  "Imagens" </li><li>  "Imagens" </li><li>  "Imagem" </li><li>  "Temp" </li><li>  "Tmp" </li><li>  "Gr√°fico" </li><li>  "Ativos" </li><li>  Imagens </li><li>  "Jogo" </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/114/8c0/080/1148c0080da59e15820170215234c139.png" alt="imagem"><br>  <i><font color="#999999">Gera√ß√£o de URL</font></i> <br><br><h3>  Demanda de resgate </h3><br>  Sodinokibi tem um modelo para criar uma solicita√ß√£o de recompra, que deixa espa√ßo para dados do usu√°rio.  Eles substituem automaticamente o nome, o ID do usu√°rio (uid - descri√ß√£o acima) e a chave.  A solicita√ß√£o de resgate √© colocada em cada diret√≥rio, sem contar as exce√ß√µes. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/386/32b/bd6/38632bbd6f4f0aee82221e912141f581.png" alt="imagem"><br><br><h3>  Descriptografia </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/125/d73/54d/125d7354d290e43946bfdb96a5694c79.png" alt="imagem"><br><br>  N√£o h√° uma maneira livre de descriptografar os dados para este ransomware, e a √∫nica maneira de recuperar os dados √© usar o servi√ßo de descriptografia fornecido pelo invasor.  V√° para ele seguindo as instru√ß√µes na solicita√ß√£o de resgate ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/707/55b/adf/70755badfcf4a2f59b23e72cffc4cbec.png" alt="imagem"><br><br><h3>  Conclus√£o </h3><br>  Recomendamos que voc√™ use prote√ß√£o anti-ransomware avan√ßada e mantenha seus sistemas antiv√≠rus atualizados.  Todos os produtos Acronis cont√™m prote√ß√£o aprimorada de ransomware e podem proteg√™-lo contra esse ataque, minimizando o risco de perda de dados. <br><br>  A prote√ß√£o cibern√©tica est√° contida na solu√ß√£o pessoal Acronis True Image 2019, bem como nos sistemas comerciais Acronis Backup, que s√£o acompanhados por um m√≥dulo antimalware baseado em intelig√™ncia artificial chamado Acronis Active Protection.  Gra√ßas a isso, os dois sistemas s√£o capazes de proteger os usu√°rios do Sodinokibi. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt462567/">https://habr.com/ru/post/pt462567/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt462551/index.html">Perguntas populares do desenvolvedor sobre testes</a></li>
<li><a href="../pt462553/index.html">Um pouco sobre simples. Projeto de teste. Parte 1</a></li>
<li><a href="../pt462555/index.html">Discuss√£o: e se trabalhar sem cookies - informamos quais s√£o as alternativas</a></li>
<li><a href="../pt462563/index.html">Webinar "Como sobreviver √† conformidade?" A melhor abordagem para atender aos requisitos regulat√≥rios ‚Äù</a></li>
<li><a href="../pt462565/index.html">Como preparar dados para o SAP Process Mining by Celonis</a></li>
<li><a href="../pt462569/index.html">O sistema de transporte conosco e com eles ou "Esta√ß√µes de √¥nibus contra agregadores 2"</a></li>
<li><a href="../pt462571/index.html">As aventuras dos indescrit√≠veis Malvari: defesa vers√°til (pensamentos finais)</a></li>
<li><a href="../pt462573/index.html">Concursos em projetos: o que, por que e por qu√™?</a></li>
<li><a href="../pt462575/index.html">Semana 32 de seguran√ßa: falha no iMessage, privacidade da entrada de voz</a></li>
<li><a href="../pt462577/index.html">Minha experi√™ncia de desenvolvimento Nim</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>