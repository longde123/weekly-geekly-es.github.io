<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ¾â€ğŸ“ ğŸ‘¨ğŸ¾â€ğŸ”§ ğŸ‘¯ Bagaimana perpustakaan lingkungan virtual bekerja ğŸ‘ˆğŸ½ ğŸ“¨ ğŸ‰</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pernahkah Anda berpikir tentang bagaimana perpustakaan lingkungan virtual bekerja di Python? Dalam artikel ini, saya mengusulkan untuk berkenalan deng...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bagaimana perpustakaan lingkungan virtual bekerja</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/418579/"> Pernahkah Anda berpikir tentang bagaimana perpustakaan lingkungan virtual bekerja di Python?  Dalam artikel ini, saya mengusulkan untuk berkenalan dengan konsep utama yang digunakan semua perpustakaan untuk lingkungan, seperti virtualenv, virtualenvwrapper, conda, pipenv. <br><br>  Awalnya, dalam Python tidak ada kemampuan bawaan untuk membuat lingkungan, dan fitur ini diimplementasikan sebagai peretasan.  Ternyata, semua perpustakaan didasarkan pada fitur interpreter python yang sangat sederhana. <br><br>  Ketika Python memulai interpreter, ia mulai mencari direktori dengan modul (paket-situs).  Pencarian dimulai dengan direktori induk mengenai lokasi fisik dari interpreter executable (python.exe).  Jika folder modul tidak ditemukan, maka Python naik satu tingkat lebih tinggi dan melakukannya hingga direktori root tercapai.  Untuk memahami bahwa ini adalah direktori dengan modul, Python mencari modul os, yang harus ada dalam file os.py dan diperlukan agar python berfungsi. <br><a name="habracut"></a><br>  Mari kita bayangkan bahwa juru bahasa kita terletak di <code>/usr/dev/lang/bin/python</code> .  Maka jalur pencarian akan terlihat seperti ini: <br><br><pre> <code class="bash hljs">/usr/dev/lang/lib/python3.7/os.py /usr/dev/lib/python3.7/os.py /usr/lib/python3.7/os.py /lib/python3.7/os.py</code> </pre><br>  Seperti yang Anda lihat, Python menambahkan awalan khusus ( <code>lib/python$VERSION/os.py</code> ) ke jalur kami.  Segera setelah penerjemah menemukan kecocokan pertama (keberadaan file os.py), ia mengubah <code>sys.prefix</code> dan <code>sys.exec_prefix</code> ke jalur ini (dengan awalan dihapus).  Jika karena alasan tertentu tidak ada kecocokan yang ditemukan, maka jalur standar digunakan, yang dikompilasi ke dalam interpreter. <br><br>  Sekarang mari kita lihat bagaimana salah satu perpustakaan tertua dan paling terkenal, virtualenv, melakukannya. <br><br><pre> <code class="bash hljs">user@arb:/usr/home/<span class="hljs-built_in"><span class="hljs-built_in">test</span></span><span class="hljs-comment"><span class="hljs-comment"># virtualenv ENV Running virtualenv with interpreter /usr/bin/python3 New python executable in /usr/home/test/ENV/bin/python3 Also creating executable in /usr/home/test/ENV/bin/python Installing setuptools, pkg_resources, pip, wheel...done.</span></span></code> </pre><br>  Setelah eksekusi, itu membuat direktori tambahan: <br><br><pre> <code class="bash hljs">user@arb:/usr/home/<span class="hljs-built_in"><span class="hljs-built_in">test</span></span>/ENV<span class="hljs-comment"><span class="hljs-comment"># tree -L 3 . â”œâ”€â”€ bin â”‚ â”œâ”€â”€ activate â”‚ â”œâ”€â”€ activate.csh â”‚ â”œâ”€â”€ activate.fish â”‚ â”œâ”€â”€ activate_this.py â”‚ â”œâ”€â”€ easy_install â”‚ â”œâ”€â”€ easy_install-3.7 â”‚ â”œâ”€â”€ pip â”‚ â”œâ”€â”€ pip3 â”‚ â”œâ”€â”€ pip3.7 â”‚ â”œâ”€â”€ python â”‚ â”œâ”€â”€ python-config â”‚ â”œâ”€â”€ python3 -&gt; python â”‚ â”œâ”€â”€ python3.7 -&gt; python â”‚ â””â”€â”€ wheel â”œâ”€â”€ include â”‚ â””â”€â”€ python3.7m -&gt; /usr/include/python3.7m â”œâ”€â”€ lib â”‚ â””â”€â”€ python3.7 â”‚ â”œâ”€â”€ __future__.py -&gt; /usr/lib/python3.7/__future__.py â”‚ â”œâ”€â”€ __pycache__ â”‚ â”œâ”€â”€ _bootlocale.py -&gt; /usr/lib/python3.7/_bootlocale.py â”‚ â”œâ”€â”€ _collections_abc.py -&gt; /usr/lib/python3.7/_collections_abc.py â”‚ â”œâ”€â”€ _dummy_thread.py -&gt; /usr/lib/python3.7/_dummy_thread.py â”‚ â”œâ”€â”€ _weakrefset.py -&gt; /usr/lib/python3.7/_weakrefset.py â”‚ â”œâ”€â”€ abc.py -&gt; /usr/lib/python3.7/abc.py â”‚ â”œâ”€â”€ base64.py -&gt; /usr/lib/python3.7/base64.py â”‚ â”œâ”€â”€ bisect.py -&gt; /usr/lib/python3.7/bisect.py â”‚ â”œâ”€â”€ codecs.py -&gt; /usr/lib/python3.7/codecs.py â”‚ â”œâ”€â”€ collections -&gt; /usr/lib/python3.7/collections â”‚ â”œâ”€â”€ config-3.7m-darwin -&gt; /usr/lib/python3.7/config-3.7m-darwin â”‚ â”œâ”€â”€ copy.py -&gt; /usr/lib/python3.7/copy.py â”‚ â”œâ”€â”€ copyreg.py -&gt; /usr/lib/python3.7/copyreg.py â”‚ â”œâ”€â”€ distutils â”‚ â”œâ”€â”€ encodings -&gt; /usr/lib/python3.7/encodings â”‚ â”œâ”€â”€ enum.py -&gt; /usr/lib/python3.7/enum.py â”‚ â”œâ”€â”€ fnmatch.py -&gt; /usr/lib/python3.7/fnmatch.py â”‚ â”œâ”€â”€ functools.py -&gt; /usr/lib/python3.7/functools.py â”‚ â”œâ”€â”€ genericpath.py -&gt; /usr/lib/python3.7/genericpath.py â”‚ â”œâ”€â”€ hashlib.py -&gt; /usr/lib/python3.7/hashlib.py â”‚ â”œâ”€â”€ heapq.py -&gt; /usr/lib/python3.7/heapq.py â”‚ â”œâ”€â”€ hmac.py -&gt; /usr/lib/python3.7/hmac.py â”‚ â”œâ”€â”€ imp.py -&gt; /usr/lib/python3.7/imp.py â”‚ â”œâ”€â”€ importlib -&gt; /usr/lib/python3.7/importlib â”‚ â”œâ”€â”€ io.py -&gt; /usr/lib/python3.7/io.py â”‚ â”œâ”€â”€ keyword.py -&gt; /usr/lib/python3.7/keyword.py â”‚ â”œâ”€â”€ lib-dynload -&gt; /usr/lib/python3.7/lib-dynload â”‚ â”œâ”€â”€ linecache.py -&gt; /usr/lib/python3.7/linecache.py â”‚ â”œâ”€â”€ locale.py -&gt; /usr/lib/python3.7/locale.py â”‚ â”œâ”€â”€ no-global-site-packages.txt â”‚ â”œâ”€â”€ ntpath.py -&gt; /usr/lib/python3.7/ntpath.py â”‚ â”œâ”€â”€ operator.py -&gt; /usr/lib/python3.7/operator.py â”‚ â”œâ”€â”€ orig-prefix.txt â”‚ â”œâ”€â”€ os.py -&gt; /usr/lib/python3.7/os.py â”‚ â”œâ”€â”€ posixpath.py -&gt; /usr/lib/python3.7/posixpath.py â”‚ â”œâ”€â”€ random.py -&gt; /usr/lib/python3.7/random.py â”‚ â”œâ”€â”€ re.py -&gt; /usr/lib/python3.7/re.py â”‚ â”œâ”€â”€ readline.so -&gt; /usr/lib/python3.7/lib-dynload/readline.cpython-37m-darwin.so â”‚ â”œâ”€â”€ reprlib.py -&gt; /usr/lib/python3.7/reprlib.py â”‚ â”œâ”€â”€ rlcompleter.py -&gt; /usr/lib/python3.7/rlcompleter.py â”‚ â”œâ”€â”€ shutil.py -&gt; /usr/lib/python3.7/shutil.py â”‚ â”œâ”€â”€ site-packages â”‚ â”œâ”€â”€ site.py â”‚ â”œâ”€â”€ sre_compile.py -&gt; /usr/lib/python3.7/sre_compile.py â”‚ â”œâ”€â”€ sre_constants.py -&gt; /usr/lib/python3.7/sre_constants.py â”‚ â”œâ”€â”€ sre_parse.py -&gt; /usr/lib/python3.7/sre_parse.py â”‚ â”œâ”€â”€ stat.py -&gt; /usr/lib/python3.7/stat.py â”‚ â”œâ”€â”€ struct.py -&gt; /usr/lib/python3.7/struct.py â”‚ â”œâ”€â”€ tarfile.py -&gt; /usr/lib/python3.7/tarfile.py â”‚ â”œâ”€â”€ tempfile.py -&gt; /usr/lib/python3.7/tempfile.py â”‚ â”œâ”€â”€ token.py -&gt; /usr/lib/python3.7/token.py â”‚ â”œâ”€â”€ tokenize.py -&gt; /usr/lib/python3.7/tokenize.py â”‚ â”œâ”€â”€ types.py -&gt; /usr/lib/python3.7/types.py â”‚ â”œâ”€â”€ warnings.py -&gt; /usr/lib/python3.7/warnings.py â”‚ â””â”€â”€ weakref.py -&gt; /usr/lib/python3.7/weakref.py â””â”€â”€ pip-selfcheck.json</span></span></code> </pre><br>  Seperti yang Anda lihat, lingkungan virtual dibuat dengan menyalin biner Python ke folder lokal (ENV / bin / python).  Kami juga dapat memperhatikan bahwa folder induk berisi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tautan simbolis</a> ke file pustaka standar python.  Kami tidak dapat membuat tautan simbolis ke file yang dapat dieksekusi, karena  penerjemah masih akan mengganti nama ke jalur yang sebenarnya. <br><br>  Sekarang mari kita aktifkan lingkungan kita: <br><br><pre> <code class="bash hljs">user@arb:/usr/home/<span class="hljs-built_in"><span class="hljs-built_in">test</span></span><span class="hljs-comment"><span class="hljs-comment"># source ENV/bin/activate</span></span></code> </pre><br>  Perintah ini mengubah variabel lingkungan $ PATH sehingga perintah <code>python</code> menunjuk ke versi lokal kami dari python.  Ini dicapai dengan mengganti lintasan lokal folder bin pada awal baris $ PATH sehingga lintasan lokal didahulukan dari semua lintasan di sebelah kanan. <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">export</span></span> <span class="hljs-string"><span class="hljs-string">"/usr/home/test/ENV/bin:</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$PATH</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">$PATH</span></span></code> </pre><br>  Jika Anda menjalankan skrip dari lingkungan ini, skrip akan dieksekusi menggunakan biner di <code>/usr/home/test/ENV/bin/python</code> .  Penerjemah akan menggunakan jalur ini sebagai titik awal untuk menemukan modul.  Dalam kasus kami, modul-modul perpustakaan standar akan ditemukan di path <code>/usr/home/test/ENV/lib/python3.7/</code> . <br><br>  Ini adalah retasan utama, berkat semua pustaka untuk bekerja dengan lingkungan virtual bekerja. <br><br><h4>  Perbaikan dalam Python 3 </h4><br>  Dimulai dengan versi Python 3.3, standar baru telah muncul, disebut sebagai <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">PEP 405</a> , yang memperkenalkan mekanisme baru untuk lingkungan yang ringan. <br><br>  PEP ini menambahkan langkah ekstra untuk proses pencarian.  Jika Anda membuat <code>pyenv.cfg</code> konfigurasi <code>pyenv.cfg</code> , maka alih-alih menyalin biner Python dan semua modulnya, Anda bisa dengan mudah menunjukkan lokasinya di konfigurasi ini. <br><br>  Fitur ini secara aktif digunakan oleh modul <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">venv</a> standar, yang muncul dalam Python 3. <br><br><pre> <code class="bash hljs">user@arb:/usr/home/test2<span class="hljs-comment"><span class="hljs-comment"># python3 -m venv ENV user@arb:/usr/home/test2# tree -L 3 . â””â”€â”€ ENV â”œâ”€â”€ bin â”‚ â”œâ”€â”€ activate â”‚ â”œâ”€â”€ activate.csh â”‚ â”œâ”€â”€ activate.fish â”‚ â”œâ”€â”€ easy_install â”‚ â”œâ”€â”€ easy_install-3.7 â”‚ â”œâ”€â”€ pip â”‚ â”œâ”€â”€ pip3 â”‚ â”œâ”€â”€ pip3.5 â”‚ â”œâ”€â”€ python -&gt; python3 â”‚ â””â”€â”€ python3 -&gt; /usr/bin/python3 â”œâ”€â”€ include â”œâ”€â”€ lib â”‚ â””â”€â”€ python3.7 â”œâ”€â”€ lib64 -&gt; lib â”œâ”€â”€ pyvenv.cfg â””â”€â”€ share â””â”€â”€ python-wheels</span></span></code> </pre><br><pre> <code class="bash hljs">user@arb:/usr/home/test2<span class="hljs-comment"><span class="hljs-comment"># cat ENV/pyvenv.cfg home = /usr/bin include-system-site-packages = false version = 3.7.0 user@arb:/usr/home/test2# readlink ENV/bin/python3 /usr/bin/python3</span></span></code> </pre><br>  Berkat konfigurasi ini, alih-alih menyalin biner, venv hanya membuat tautan ke sana.  Jika parameter <code>include-system-site-packages</code> diubah menjadi <code>true</code> , maka semua modul perpustakaan standar akan secara otomatis dapat diakses dari lingkungan virtual. <br><br>  Terlepas dari perubahan ini, sebagian besar pustaka pihak ketiga untuk bekerja dengan lingkungan virtual menggunakan pendekatan lama. <br><br>  PS: Saya penulis artikel ini, kamu bisa bertanya. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id418579/">https://habr.com/ru/post/id418579/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id418567/index.html">Dell akan berhenti menjadi perusahaan swasta dan untuk pertama kalinya dalam 5 tahun akan menempatkan saham di bursa saham</a></li>
<li><a href="../id418569/index.html">Satelit baru - bug baru: Sensor inframerah satelit GOES-17 tidak sejuk</a></li>
<li><a href="../id418573/index.html">Waterius: Transfer pembacaan air ke telepon melalui Wi-Fi (4 tahun dengan baterai)</a></li>
<li><a href="../id418575/index.html">"Jangan lepas landas": 6 gadget audio yang tidak biasa</a></li>
<li><a href="../id418577/index.html">Kelola bookmark Anda dengan tag - untuk menyenangkan diri sendiri dan kolega Anda</a></li>
<li><a href="../id418581/index.html">React Basics (buku teks, edisi ke-2)</a></li>
<li><a href="../id418585/index.html">Membangun peta lintas negara dari robot</a></li>
<li><a href="../id418587/index.html">Klien 3CX baru untuk Android dan iOS dengan OPUS dan PUSH codec untuk beberapa perangkat</a></li>
<li><a href="../id418589/index.html">Intisari bahan-bahan segar dari dunia front-end untuk minggu terakhir No. 324 (23-29 Juli 2018)</a></li>
<li><a href="../id418591/index.html">Bug Bounty Kyivstar: hadiah untuk akses admin ke Jira, AWS, Apple, Pengembang Google, layanan Bitbucket - $ 50</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>