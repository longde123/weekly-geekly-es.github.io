<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòó üíë üò¨ Den genetischen Code der Kryptokotik verstehen üßîüèæ üë∑ üîÅ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="... und lernen Sie anhand eines realen Beispiels, mit Ethereum-Entwicklertools zu arbeiten. 

 Teil Null: Das Objekt kam in Sicht 
 Ich habe gerade me...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Den genetischen Code der Kryptokotik verstehen</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/wirex/blog/409345/">  ... und lernen Sie anhand eines realen Beispiels, mit Ethereum-Entwicklertools zu arbeiten. <br><br><h3>  Teil Null: Das Objekt kam in Sicht </h3><br>  Ich habe gerade meine Vorlesungen √ºber den Full-Stack-Kurs zur Entwicklung dezentraler Ethereum-basierter Anwendungen in Solidity auf Chinesisch beendet.  Ich habe es in meiner Freizeit gegeben, um den Wissensstand der chinesischen Entwicklergemeinschaft √ºber Blockchain und intelligente Vertr√§ge zu verbessern.  W√§hrend meiner Arbeit habe ich mich mit ein paar Studenten angefreundet. <br><br>  Und gerade am Ende des Kurses waren wir pl√∂tzlich von diesen Kreaturen umgeben: <br><br><img src="https://habrastorage.org/webt/ev/e-/ov/eve-ovga3bt6vx11ichn6jmkufm.png"><br><br>  <i>Bild von cryptokitties.co</i> <br><br>  Wie die meisten Menschen, die auf dieses Ph√§nomen gesto√üen sind, konnten auch wir diesen niedlichen Kryptokreationen nicht widerstehen und wurden schnell spiels√ºchtig.  Wir brachten gerne neue Katzen heraus und ersetzten sogar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">die Entleinmethode durch die Kryptokatzenmethode</a> .  Ich glaube, dass Spielsucht schlecht ist, aber nicht in diesem Fall, weil die Leidenschaft f√ºr die Zucht von K√§tzchen uns schnell zu der Frage f√ºhrte: <br><br><h3>  Wie bekommen bestimmte Kryptokatzen ihre Gene? </h3><br>  Wir haben uns entschlossen, am Samstagabend die Antwort darauf zu finden, und wir glauben, dass wir einige Fortschritte bei der Entwicklung von Software erzielt haben, mit der wir die genetische Mutation neugeborener Kryptok√§tzchen bestimmen k√∂nnen, bevor sie geboren werden.  Mit anderen Worten, dieses Programm kann Ihnen helfen, den geeigneten Zeitpunkt f√ºr die Befruchtung der Katzenmutter zu √ºberpr√ºfen und zu bestimmen und dadurch die interessanteste der m√∂glichen Mutationen zu erhalten. <br><br>  Wir ver√∂ffentlichen dieses Material in der Hoffnung, dass es allen als Einf√ºhrungsartikel dient, um sich mit sehr n√ºtzlichen Ethereum-Entwicklungstools vertraut zu machen, so wie die Kryptok√§tzchen selbst vielen mit der Blockchain nicht vertrauten Personen erlaubt haben, sich den Reihen der Kryptow√§hrungsbenutzer anzuschlie√üen. <a name="habracut"></a><br><br><h3>  Teil eins: Die Logik auf hoher Ebene, kleine K√§tzchen zu erzeugen </h3><br>  Zun√§chst haben wir uns gefragt: Wie ist die Geburt von Kryptok√§tzchen? <br><br>  Um diese Frage zu beantworten, haben wir den hervorragenden Etherscan-Blockchain-Leiter verwendet, mit dem wir viel mehr als nur ‚Äûdie Parameter und Inhalte der Bl√∂cke untersuchen‚Äú k√∂nnen.  Also haben wir den Quellcode f√ºr den CryptoKittiesCore-Vertrag entdeckt: <br><br><img src="https://habrastorage.org/webt/co/od/v1/coodv1ao8ns32llhof2bhbpp3h8.png"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://etherscan.io/address/0x06012c8cf97bead5deae237070f9587f8e7a266d#code</a> <br><br>  Bitte beachten Sie, dass sich der erweiterte Vertrag tats√§chlich geringf√ºgig von dem im Kopfgeldprogramm verwendeten unterscheidet.  Nach diesem Code wird ein Babyk√§tzchen in zwei Schritten gebildet: 1) Die Mutterkatze wird von der Katze befruchtet.  2) Wenig sp√§ter, wenn die Reifezeit des F√∂tus zu Ende ist, wird die Funktion giveBirth aufgerufen.  Diese Funktion wird normalerweise von einem bestimmten Prozessd√§mon aufgerufen. Um jedoch sp√§ter interessante Mutationen zu erhalten, m√ºssen Sie den Block, in dem Ihr K√§tzchen geboren wurde, korrekt ausw√§hlen. <br><br><pre><code class="java hljs"><span class="hljs-function"><span class="hljs-function">function </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">giveBirth</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(uint256 _matronId)</span></span></span><span class="hljs-function"> external whenNotPaused </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">returns</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(uint256)</span></span></span><span class="hljs-function"> </span></span>{ Kitty storage matron = kitties[_matronId]; <span class="hljs-comment"><span class="hljs-comment">// ,  - . require(matron.birthTime != 0); // ,       ! require(_isReadyToGiveBirth(matron)); //      -. uint256 sireId = matron.siringWithId; Kitty storage sire = kitties[sireId]; // ,         uint16 parentGen = matron.generation; if (sire.generation &gt; matron.generation) { parentGen = sire.generation; } //     . uint256 childGenes = geneScience.mixGenes(matron.genes, sire.genes, matron.cooldownEndBlock - 1);</span></span></code> </pre> <br>  Im obigen Code k√∂nnen Sie deutlich sehen, dass die Gene eines neugeborenen K√§tzchens direkt zum Zeitpunkt der Geburt bestimmt werden, indem Sie die mixGenes-Funktion aus dem externen Smart-Vertrag von geneScience aufrufen.  Diese Funktion verwendet drei Parameter: das Muttergen, das Vatergen und die Blocknummer, in der die Katze zur Geburt bereit ist. <br><br>  Sie werden wahrscheinlich eine logische Frage haben, warum Gene zum Zeitpunkt der Empf√§ngnis nicht bestimmt werden, wie dies in der realen Welt der Fall ist.  Wie Sie im Verlauf der nachfolgenden Erz√§hlung sehen werden, k√∂nnen Sie sich auf diese Weise elegant gegen Versuche verteidigen, Gene vorherzusagen und zu entschl√ºsseln.  Dieser Ansatz eliminiert die M√∂glichkeit einer 100% genauen Vorhersage von K√§tzchengenen, bevor die Tatsache der Katzen-Mutter-Schwangerschaft in der Blockchain aufgezeichnet wird.  Und selbst wenn Sie den genauen Code herausfinden k√∂nnten, der f√ºr das Mischen der Gene verantwortlich ist, w√ºrde dies Ihnen keinen Vorteil bringen. <br><br>  Wie dem auch sei, am Anfang wussten wir das noch nicht, also fahren wir fort.  Jetzt m√ºssen wir die Adresse des geneScience-Vertrags herausfinden.  Verwenden Sie dazu MyEtherWallet: <br><br> <a href=""><img src="https://habrastorage.org/webt/nf/fa/yl/nffaylnytgmybdkavya0so0ugmi.png"></a> <br><br>  <i>GeneScience-Vertragsadresse</i> <br><br>  So sieht der Vertragsbytecode aus: <br><br><pre> <code class="java hljs"><span class="hljs-number"><span class="hljs-number">0x60606040526004361061006c5763ffffffff7c01000000000000000000000000000000000000000000000000000000006000350416630d9f5aed81146100715780631597ee441461009f57806354c15b82146100ee57806361a769001461011557806377a74a201461017e575b600080fd5b341561007c57600080fd5b61008d6004356024356044356101cd565b604051908152602001604051809</span></span>........</code> </pre> <br>  An seinem Aussehen kann man nicht sagen, dass auf allem etwas so S√º√ües wie ein K√§tzchen auf allem erscheint, aber wir sind sehr gl√ºcklich, dass dies eine √∂ffentliche Adresse ist, und wir m√ºssen nicht im Repository danach suchen.  Tats√§chlich glauben wir, dass es nicht so leicht zug√§nglich gemacht werden sollte.  Wenn die Entwickler wirklich sicherstellen m√∂chten, dass die Adresse des Vertrags korrekt ist, sollten sie die Funktion checkScienceAddress verwenden, aber wir werden nicht gest√∂rt. <br><br><h3>  Teil zwei: Der Zusammenbruch einer einfachen Hypothese </h3><br>  Was wollen wir also am Ende erreichen?  Es versteht sich, dass wir uns nicht das Ziel gesetzt haben, den Bytecode vollst√§ndig zu kompilieren und ihn in einen f√ºr Menschen lesbaren Solidit√§tscode umzuwandeln.  Wir brauchen eine billige Methode (ohne f√ºr Transaktionen in der Kampfblockkette bezahlen zu m√ºssen) zur Bestimmung von K√§tzchengenen, vorausgesetzt wir wissen, wer seine Eltern sind.  Das werden wir tun. <br><br>  Verwenden Sie zun√§chst das Etherscan- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Opcode-Tool</a> f√ºr eine schnelle Analyse.  Es sieht so aus: <br><br> <a href=""><img src="https://habrastorage.org/webt/m6/nt/72/m6nt72740bwhn4qz6dlkz0pc6qi.png"></a> <br><br>  <i>Viel klarer</i> <br><br>  Wir folgen der goldenen Regel der Dekodierung des Assembler-Codes: Wir beginnen mit einer einfachen und k√ºhnen Hypothese √ºber das Verhalten des Programms und konzentrieren uns, anstatt zu versuchen, seine Arbeit als Ganzes zu verstehen, darauf, die getroffene Annahme zu best√§tigen.  Wir werden den Bytecode durchgehen, um einige Fragen zu beantworten: <br><br><ol><li>  Verwendet es Zeitstempel?  Nein, da der TIMESTAMP-Opcode fehlt.  Wenn es einen einfachen Unfall gibt, dann ist seine Quelle definitiv ein anderer Opcode. </li><li>  Wird ein Block-Hash verwendet?  Ja, BLOCKHASH tritt zweimal auf.  Daher kann sich aus ihren Opcodes eine etwaige Zuf√§lligkeit ergeben, √ºber die wir uns jedoch noch nicht sicher sind. </li><li>  Werden √ºberhaupt Hashes verwendet?  Ja, da ist SHA3.  Es ist jedoch nicht klar, was er tut. </li><li>  Wird msg.sender verwendet?  Nein, da der CALLER-Opcode fehlt.  Daher wird keine Zugriffskontrolle auf den Vertrag angewendet. </li><li>  Wird ein externer Vertrag verwendet?  Nein, es gibt keinen CALL-Opcode. </li><li>  Wird COINBASE verwendet?  Nein, und daher schlie√üen wir eine andere m√∂gliche Quelle der Zuf√§lligkeit aus. </li></ol><br>  Nachdem wir die Antwort auf diese Fragen erhalten haben, stellen wir eine einfache Hypothese auf und beabsichtigen sie zu testen: Das Ergebnis von mixGene wird durch drei und nur drei Eingabeparameter dieser Funktion bestimmt.  Wenn ja, k√∂nnten wir diesen Vertrag einfach lokal bereitstellen, diese Funktion weiterhin mit den Parametern aufrufen, an denen wir interessiert sind, und dann k√∂nnten wir vielleicht ein Kit mit K√§tzchengenen erhalten, noch bevor die Katzenmutter befruchtet wird. <br><br>  Um diese Annahme zu √ºberpr√ºfen, rufen wir die mixGene-Funktion im Hauptnetzwerk mit drei zuf√§lligen Parametern auf: 1111115, 80, 40 und erhalten ein Ergebnis X. Als n√§chstes stellen Sie diesen Bytecode mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Tr√ºffel und testrpc bereit</a> .  Unsere Faulheit f√ºhrte also zu einer etwas ungew√∂hnlichen Art, Tr√ºffel zu verwenden. <br><br><pre> <code class="java hljs">contract GeneScienceSkeleton { <span class="hljs-function"><span class="hljs-function">function </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mixGenes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(uint256 genes1, uint256 genes2, uint256 targetBlock)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">returns</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(uint256)</span></span></span><span class="hljs-function"> </span></span>{} }</code> </pre> <br>  Wir beginnen mit dem Vertragsskelett, f√ºgen es in die Ordnerstruktur des Tr√ºffel-Frameworks ein und f√ºhren die Tr√ºffel-Kompilierung aus.  Anstatt diesen leeren Vertrag direkt nach testrpc zu migrieren, ersetzen wir den Vertragsbytecode im Build-Ordner durch den tats√§chlich erweiterten Bytecode und den geneScience-Vertragsbytecode.  Dies ist ein atypischer, aber schneller Weg, wenn Sie einen Vertrag nur mit Bytecode und einer eingeschr√§nkten offenen Schnittstelle f√ºr lokale Tests bereitstellen m√∂chten.  Danach rufen wir Mixgenes direkt mit den Parametern 1111115, 80, 40 auf und erhalten leider einen Fehler, wenn die Antwort als Antwort zur√ºckgesetzt wird.  Ok, schau tiefer.  Wie wir wissen, lautet die Signatur der mixGene-Funktionen 0x0d9f5aed. Daher nehmen wir einen Stift und Papier und verfolgen die Bytecode-Ausf√ºhrung, beginnend mit dem Einstiegspunkt dieser Funktion, um √Ñnderungen im Stapel und im Speicher zu ber√ºcksichtigen.  Nach ein paar Spr√ºngen befinden wir uns hier: <br><br><pre> <code class="java hljs">[<span class="hljs-number"><span class="hljs-number">497</span></span>] DUP1 [<span class="hljs-number"><span class="hljs-number">498</span></span>] NUMBER [<span class="hljs-number"><span class="hljs-number">499</span></span>] DUP14 [<span class="hljs-number"><span class="hljs-number">500</span></span>] SWAP1 [<span class="hljs-number"><span class="hljs-number">501</span></span>] GT [<span class="hljs-number"><span class="hljs-number">504</span></span>] PUSH2 <span class="hljs-number"><span class="hljs-number">0x01fe</span></span> [<span class="hljs-number"><span class="hljs-number">505</span></span>] JUMPI [<span class="hljs-number"><span class="hljs-number">507</span></span>] PUSH1 <span class="hljs-number"><span class="hljs-number">0x00</span></span> [<span class="hljs-number"><span class="hljs-number">508</span></span>] DUP1 [<span class="hljs-number"><span class="hljs-number">509</span></span>] <span class="hljs-string"><span class="hljs-string">'fd'</span></span>(Unknown Opcode)</code> </pre> <br>  Nach dem Inhalt dieser Zeilen zu urteilen, wird revert () aufgerufen, wenn die Nummer des aktuellen Blocks kleiner als der dritte Parameter ist.  Nun, das ist ein ziemlich vern√ºnftiges Verhalten: Es ist unm√∂glich, eine echte Funktion in einem Spiel mit einer Blocknummer aus der Zukunft aufzurufen, und das ist logisch. <br><br>  Diese Eingabe√ºberpr√ºfung ist leicht zu umgehen: Wir bauen nur ein paar Bl√∂cke auf testrpc ab und rufen die Funktion erneut auf.  Dieses Mal gibt die Funktion erfolgreich Y zur√ºck. <br><br>  Aber leider X! = Y. <br><br>  Schade.  Dies bedeutet, dass das Ergebnis der Funktionsausf√ºhrung nicht nur von den Eingabeparametern abh√§ngt, sondern auch vom Status der Blockchain des Hauptnetzwerks, der sich nat√ºrlich vom Status des gef√§lschten Blockchain-Testrpc unterscheidet. <br><br><h3>  Teil drei: Krempeln Sie die √Ñrmel hoch und graben Sie in den Stapel </h3><br>  Okay.  Es ist also Zeit, die √Ñrmel hochzukrempeln.  Papier ist nicht mehr zur Verfolgung des Stapelstatus geeignet.  F√ºr ernstere Arbeiten werden wir einen sehr n√ºtzlichen EVM-Disassembler namens <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">evmdis starten</a> . <br><br>  Im Vergleich zu Papier und Stift ist dies ein greifbarer Fortschritt.  Fahren wir mit dem fort, bei dem wir im letzten Kapitel stehen geblieben sind.  Das Folgende ist eine ermutigende Schlussfolgerung mit evmdis: <br><br><pre> <code class="java hljs">............. :label22 # Stack: [@<span class="hljs-number"><span class="hljs-number">0x70E</span></span> @<span class="hljs-number"><span class="hljs-number">0x70E</span></span> @<span class="hljs-number"><span class="hljs-number">0x70E</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> @<span class="hljs-number"><span class="hljs-number">0x88</span></span> @<span class="hljs-number"><span class="hljs-number">0x85</span></span> @<span class="hljs-number"><span class="hljs-number">0x82</span></span> :label3 @<span class="hljs-number"><span class="hljs-number">0x34</span></span>] <span class="hljs-number"><span class="hljs-number">0x1EB</span></span> PUSH(<span class="hljs-number"><span class="hljs-number">0x0</span></span>) <span class="hljs-number"><span class="hljs-number">0x1ED</span></span> DUP1 <span class="hljs-number"><span class="hljs-number">0x1EE</span></span> DUP1 <span class="hljs-number"><span class="hljs-number">0x1EF</span></span> DUP1 <span class="hljs-number"><span class="hljs-number">0x1F0</span></span> DUP1 <span class="hljs-number"><span class="hljs-number">0x1F1</span></span> DUP1 <span class="hljs-number"><span class="hljs-number">0x1F3</span></span> DUP13 <span class="hljs-number"><span class="hljs-number">0x1F9</span></span> JUMPI(:label23, NUMBER() &gt; POP()) # Stack: [<span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> @<span class="hljs-number"><span class="hljs-number">0x70E</span></span> @<span class="hljs-number"><span class="hljs-number">0x70E</span></span> @<span class="hljs-number"><span class="hljs-number">0x70E</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> @<span class="hljs-number"><span class="hljs-number">0x88</span></span> @<span class="hljs-number"><span class="hljs-number">0x85</span></span> @<span class="hljs-number"><span class="hljs-number">0x82</span></span> :label3 @<span class="hljs-number"><span class="hljs-number">0x34</span></span>] <span class="hljs-number"><span class="hljs-number">0x1FA</span></span> PUSH(<span class="hljs-number"><span class="hljs-number">0x0</span></span>) <span class="hljs-number"><span class="hljs-number">0x1FC</span></span> DUP1 <span class="hljs-number"><span class="hljs-number">0x1FD</span></span> REVERT() :label23 # Stack: [<span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> @<span class="hljs-number"><span class="hljs-number">0x70E</span></span> @<span class="hljs-number"><span class="hljs-number">0x70E</span></span> @<span class="hljs-number"><span class="hljs-number">0x70E</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> @<span class="hljs-number"><span class="hljs-number">0x88</span></span> @<span class="hljs-number"><span class="hljs-number">0x85</span></span> @<span class="hljs-number"><span class="hljs-number">0x82</span></span> :label3 @<span class="hljs-number"><span class="hljs-number">0x34</span></span>] <span class="hljs-number"><span class="hljs-number">0x1FF</span></span> DUP13 <span class="hljs-number"><span class="hljs-number">0x200</span></span> PUSH(BLOCKHASH(POP())) <span class="hljs-number"><span class="hljs-number">0x201</span></span> SWAP11 <span class="hljs-number"><span class="hljs-number">0x202</span></span> POP() <span class="hljs-number"><span class="hljs-number">0x203</span></span> DUP11 <span class="hljs-number"><span class="hljs-number">0x209</span></span> JUMPI(:label25, !!POP()) # Stack: [<span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> @<span class="hljs-number"><span class="hljs-number">0x70E</span></span> @<span class="hljs-number"><span class="hljs-number">0x70E</span></span> @<span class="hljs-number"><span class="hljs-number">0x70E</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> @<span class="hljs-number"><span class="hljs-number">0x200</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> @<span class="hljs-number"><span class="hljs-number">0x88</span></span> @<span class="hljs-number"><span class="hljs-number">0x85</span></span> @<span class="hljs-number"><span class="hljs-number">0x82</span></span> :label3 @<span class="hljs-number"><span class="hljs-number">0x34</span></span>] <span class="hljs-number"><span class="hljs-number">0x20C</span></span> DUP13 <span class="hljs-number"><span class="hljs-number">0x213</span></span> PUSH((NUMBER() &amp; ~<span class="hljs-number"><span class="hljs-number">0xFF</span></span>) + (POP() &amp; <span class="hljs-number"><span class="hljs-number">0xFF</span></span>)) <span class="hljs-number"><span class="hljs-number">0x214</span></span> SWAP13 <span class="hljs-number"><span class="hljs-number">0x215</span></span> POP() <span class="hljs-number"><span class="hljs-number">0x217</span></span> DUP13 <span class="hljs-number"><span class="hljs-number">0x21E</span></span> JUMPI(:label24, !!(POP() &lt; NUMBER())) # Stack: [<span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> @<span class="hljs-number"><span class="hljs-number">0x70E</span></span> @<span class="hljs-number"><span class="hljs-number">0x70E</span></span> @<span class="hljs-number"><span class="hljs-number">0x70E</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> @<span class="hljs-number"><span class="hljs-number">0x200</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> @<span class="hljs-number"><span class="hljs-number">0x213</span></span> @<span class="hljs-number"><span class="hljs-number">0x85</span></span> @<span class="hljs-number"><span class="hljs-number">0x82</span></span> :label3 @<span class="hljs-number"><span class="hljs-number">0x34</span></span>] <span class="hljs-number"><span class="hljs-number">0x222</span></span> DUP13 <span class="hljs-number"><span class="hljs-number">0x223</span></span> PUSH(POP() - <span class="hljs-number"><span class="hljs-number">0x100</span></span>) <span class="hljs-number"><span class="hljs-number">0x224</span></span> SWAP13 <span class="hljs-number"><span class="hljs-number">0x225</span></span> POP() :label24 # Stack: [<span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> @<span class="hljs-number"><span class="hljs-number">0x70E</span></span> @<span class="hljs-number"><span class="hljs-number">0x70E</span></span> @<span class="hljs-number"><span class="hljs-number">0x70E</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> @<span class="hljs-number"><span class="hljs-number">0x200</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> [@<span class="hljs-number"><span class="hljs-number">0x223</span></span> | @<span class="hljs-number"><span class="hljs-number">0x213</span></span>] @<span class="hljs-number"><span class="hljs-number">0x85</span></span> @<span class="hljs-number"><span class="hljs-number">0x82</span></span> :label3 @<span class="hljs-number"><span class="hljs-number">0x34</span></span>] <span class="hljs-number"><span class="hljs-number">0x227</span></span> DUP13 <span class="hljs-number"><span class="hljs-number">0x228</span></span> PUSH(BLOCKHASH(POP())) <span class="hljs-number"><span class="hljs-number">0x229</span></span> SWAP11 <span class="hljs-number"><span class="hljs-number">0x22A</span></span> POP() :label25 # Stack: [<span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> @<span class="hljs-number"><span class="hljs-number">0x70E</span></span> @<span class="hljs-number"><span class="hljs-number">0x70E</span></span> @<span class="hljs-number"><span class="hljs-number">0x70E</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> [@<span class="hljs-number"><span class="hljs-number">0x200</span></span> | @<span class="hljs-number"><span class="hljs-number">0x228</span></span>] <span class="hljs-number"><span class="hljs-number">0x0</span></span> [@<span class="hljs-number"><span class="hljs-number">0x88</span></span> | @<span class="hljs-number"><span class="hljs-number">0x223</span></span> | @<span class="hljs-number"><span class="hljs-number">0x213</span></span>] @<span class="hljs-number"><span class="hljs-number">0x85</span></span> @<span class="hljs-number"><span class="hljs-number">0x82</span></span> :label3 @<span class="hljs-number"><span class="hljs-number">0x34</span></span>] <span class="hljs-number"><span class="hljs-number">0x22C</span></span> DUP11 <span class="hljs-number"><span class="hljs-number">0x22D</span></span> DUP16 <span class="hljs-number"><span class="hljs-number">0x22E</span></span> DUP16 ...........</code> </pre> <br>  Wof√ºr evmdis wirklich gut ist, ist seine N√ºtzlichkeit f√ºr die Analyse von JUMPDEST in die richtigen Labels, die nicht √ºbersch√§tzt werden k√∂nnen. <br><br>  Nachdem wir die anf√§ngliche Anforderung erf√ºllt haben, befinden wir uns auf Etikett 23. Wir sehen DUP13 und erinnern uns aus dem vorherigen Kapitel, dass die Nummer 13 auf dem Stapel unser dritter Parameter ist.  Wir versuchen also, den BLOCKHASH unseres dritten Parameters zu erhalten.  Die Aktion von BLOCKHASH ist jedoch auf 256 Bl√∂cke beschr√§nkt.  Aus diesem Grund folgt JUMPI (dies ist ein if-Konstrukt).  Wenn wir die Logik der Opcodes in die Sprache des Pseudocodes √ºbersetzen, erhalten wir ungef√§hr Folgendes: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-function">func </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">blockhash</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentBlockNumber - p &lt; <span class="hljs-number"><span class="hljs-number">256</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> hash(p); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> bhash = blockhash(thrid); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bhash == <span class="hljs-number"><span class="hljs-number">0</span></span>) { thirdProjection = (currentBlockNumber &amp; ~<span class="hljs-number"><span class="hljs-number">0xff</span></span>) + (thridParam &amp; <span class="hljs-number"><span class="hljs-number">0xff</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (thirdProjection &gt; currentBlockNumber) { thirdProjection -= <span class="hljs-number"><span class="hljs-number">256</span></span>; } thirdParam = thirdProjection; bhash = blockhash(thirdProjection); } label <span class="hljs-number"><span class="hljs-number">25</span></span> and beyond ..... some more stuff related to thirdParam and bhash</code> </pre> <br>  einige weitere Dinge im Zusammenhang mit ThirdParam und Bhash - anderer Code in Bezug auf ThirdParam und Block-Hash <br><br>  Jetzt glauben wir, dass wir einen Grund gefunden haben, warum sich unsere Ergebnisse von denen unterscheiden, die wir im Hauptnetzwerk beobachten.  Noch wichtiger ist, dass wir offenbar die Quelle des Zufalls entdeckt haben.  Das hei√üt, der Block-Hash wird basierend auf dem dritten Parameter oder der <i>Vorhersage des</i> dritten Parameters berechnet.  Es ist wichtig zu beachten, dass im Stapel auch der dritte Parameter durch diese vorhergesagte Blocknummer ersetzt wird. <br><br>  Offensichtlich haben wir w√§hrend der lokalen Ausf√ºhrung au√üerhalb des Hauptnetzwerks keine einfache Option, um eine BLOCKHASH-R√ºckgabe zu erzwingen, die den Werten des Hauptnetzwerks entspricht.  Wie auch immer, da wir alle drei Parameter kennen, k√∂nnen wir das Hauptnetzwerk leicht √ºberwachen und den Hash von Block H f√ºr den dritten Parameter sowie den Hash des vorhergesagten Blocks erhalten. <br><br>  Als n√§chstes k√∂nnen wir diesen Hash direkt in den Bytecode in unserer lokalen Testumgebung einf√ºgen. Wenn alles nach Plan verl√§uft, erhalten wir endlich den richtigen Satz von Genen. <br><br>  Es gibt jedoch einen Haken: DUP13 und BLOCKHASH sind nur 2 Bytes im Code, und wenn wir sie nur durch 33 Byte PUSH32 0x * Hash * ersetzen, √§ndert sich der Programmz√§hler vollst√§ndig und wir m√ºssen jeden JUMP und JUMPI reparieren.  Oder wir m√ºssen JUMP am Ende des Codes erstellen und die Anweisungen f√ºr den bereitgestellten Code ersetzen, und so weiter. <br><br>  Nun, da wir so weit gekommen sind, werden wir ein bisschen mehr schn√ºffeln.  Da wir den 32-Byte-Hash ungleich Null in den if-Zweig verschieben, ist die Bedingung immer wahr, und daher kann alles, was im else-Teil geschrieben ist, einfach weggeworfen werden, um Platz f√ºr unseren 32-Byte-Hash zu schaffen.  Im Allgemeinen haben wir Folgendes getan: <br><br> <a href=""><img src="https://habrastorage.org/webt/n1/xx/-x/n1xx-xl6ew1nlx-xjwzkgtk90cs.png"></a> <br><br>  Der entscheidende Punkt ist, dass wir, da wir den else-Teil der Bedingung aufgegeben haben, den dritten Eingabeparameter der mixGene-Funktion durch die Vorhersage des dritten Parameters ersetzen m√ºssen, bevor wir ihn aufrufen. <br><br>  Dies ist bis zu dem Punkt, an dem Sie versuchen, das Ergebnis einer Operation zu erhalten <br>  mixGene (X, Y, Z), wobei currentBlockNumber Z &lt;256 ist, m√ºssen Sie nur den PUSH32-Hash durch den Hash des Z-Blocks ersetzen. <br>  Wenn Sie jedoch Folgendes beabsichtigen <br>  mixGene (X, Y, Z), wobei currentBlockNumber Z ‚â• 256 ist, m√ºssen Sie den PUSH32-Hash durch den Hash des proj_Z-Blocks ersetzen, wobei proj_Z wie folgt definiert ist: <br><br><pre> <code class="java hljs">proj_Z = (currentBlockNumber &amp; ~<span class="hljs-number"><span class="hljs-number">0xff</span></span>) + (Z &amp; <span class="hljs-number"><span class="hljs-number">0xff</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (proj_Z &gt; currentBlockNumber) { proj_Z -= <span class="hljs-number"><span class="hljs-number">256</span></span>; } &lt;b&gt;    Z  proj_Z   ,   mixGene(X, Y, proj_Z).&lt;/b&gt;</code> </pre> <br>  Beachten Sie, dass proj_Z in einem bestimmten Bereich von Bl√∂cken unver√§ndert bleibt.  Wenn beispielsweise Z &amp; 0xff = 128 ist, √§ndert sich proj_Z nur f√ºr jeden Null- und 128. Block. <br><br>  Um diese Hypothese zu best√§tigen und zu √ºberpr√ºfen, ob noch Fallstricke <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">vorliegen</a> , haben wir den Bytecode ge√§ndert und ein anderes cooles Dienstprogramm namens <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hevm verwendet</a> . <br><br> <a href=""><img src="https://habrastorage.org/webt/ey/d5/cx/eyd5cxlyauklees28j70widdisg.png"></a> <br><br>  Wenn Sie hevm noch nie benutzt haben, empfehle ich Ihnen, es zu versuchen.  Das Tool ist zusammen mit einem eigenen Framework verf√ºgbar, aber vor allem in seinem Set sollte es als unverzichtbar n√ºtzlich angesehen werden, wie ein interaktiver Stack-Debugger. <br><br><pre> <code class="java hljs">Usage: hevm exec --code TEXT [--calldata TEXT] [--address ADDR] [--caller ADDR] [--origin ADDR] [--coinbase ADDR] [--value W256] [--gas W256] [--number W256] [--timestamp W256] [--gaslimit W256] [--gasprice W256] [--difficulty W256] [--debug] [--state STRING] Available options: -h,--help</code> </pre> <br>  Oben sind die Startoptionen aufgef√ºhrt.  Mit dem Dienstprogramm k√∂nnen Sie verschiedene Parameter angeben.  Darunter befindet sich --debug, mit dem Sie interaktiv debuggen k√∂nnen. <br><br>  Daher haben wir hier mehrere Aufrufe an den in der Hauptnetzwerk-Blockchain bereitgestellten geneScience-Vertrag get√§tigt und die Ergebnisse aufgezeichnet.  Dann haben wir hevm verwendet, um unseren defekten Bytecode mit Daten auszuf√ºhren, die unter Ber√ºcksichtigung der oben beschriebenen Regeln und ... <br><br>  Die Ergebnisse sind die gleichen! <br><br><h3>  Das letzte Kapitel: Abschluss und Fortsetzung der Arbeit (?) </h3><br>  Was konnten wir also erreichen? <br><br>  Mit unserer Hack-Software k√∂nnen Sie ein 256-Bit-Gen f√ºr ein neugeborenes K√§tzchen mit einer Wahrscheinlichkeit von 100% vorhersagen, wenn es im Bereich von Bl√∂cken geboren wird [coolDownEndBlock (wenn das Baby zum Erscheinen bereit ist), der aktuelle Block ist + 256 (ungef√§hr)].  Sie k√∂nnen dies folgenderma√üen begr√ºnden: Wenn sich das Baby im Mutterleib der Mutterkatze befindet, mutieren seine Gene im Laufe der Zeit aufgrund der Entropiequelle in Form eines Hash des vorhergesagten coolDownEndBlock-Blocks, der sich ebenfalls im Laufe der Zeit √§ndert.  Daher k√∂nnen Sie mit diesem Programm √ºberpr√ºfen, wie das Gen des Babys aussehen wird, wenn es gerade geboren wurde.  Und wenn Ihnen dieses Gen nicht gef√§llt, k√∂nnen Sie (durchschnittlich) weitere 256 Bl√∂cke warten und das neue Gen √ºberpr√ºfen. <br><br>  Jemand k√∂nnte sagen, dass dies nicht ausreicht, da nur eine 100% ige Genauigkeit der Vorhersage bereits vor der Schwangerschaft einer Mutter-Katze als idealer Hack angesehen werden kann.  Dies ist jedoch nicht m√∂glich, da das Gen des K√§tzchens nicht nur durch die Gene seiner Eltern bestimmt wird, sondern auch durch den vorhergesagten Hash des Blocks als Mutationsfaktor, der vor der Befruchtung einfach nicht bekannt sein kann. <br><br>  Was kann verbessert werden und was sind die Nuancen hier? <br><br>  Wir haben die √Ñnderungen, die im realen logischen Teil des Smart-Vertrags (Label 25 und alles danach) auf dem Stack auftreten, schnell durchgesehen und sind der Ansicht, dass dieser vorhersehbare Teil des mixGene-Codes einer Analyse und Untersuchung unterliegt.  Wir hoffen, dass der Block-Hash als Mutationsfaktor auch eine gewisse physikalische Bedeutung hat, um beispielsweise zu bestimmen, welches Gen mutiert werden soll.  Wenn wir das herausfinden, erhalten wir das urspr√ºngliche Gen ohne Mutationen.  Dies ist n√ºtzlich, denn wenn Sie kein gutes Quellgen haben, reicht m√∂glicherweise nicht einmal die beste Mutation aus. <br><br>  Wir haben auch die Korrelation zwischen dem 256-Bit-Gen und den K√§tzchenmerkmalen (Augenfarbe, Schwanztyp usw.) nicht gemessen, aber wir glauben, dass dies mit Hilfe eines Hochleistungsbot und eines einfachen Klassifikators durchaus m√∂glich ist. <br><br>  Im Allgemeinen verstehen wir die Absicht des CryptoKitties-Entwicklungsteams, die Mutation √ºber einen kurzen Zeitraum zu stabilisieren.  Die Kehrseite dieses Ansatzes ist jedoch die F√§higkeit, eine Analyse wie wir durchzuf√ºhren. <br><br>  Wir m√∂chten uns auch bei der wunderbaren Ethereum-Community f√ºr die Entwicklung von Tools wie Etherscan, Hevm, Evmdis, Tr√ºffel, Testrpc, Myetherwallet und Solidity bedanken.  Dies ist eine sehr coole Community und wir freuen uns, ein Teil davon zu sein. <br><br>  Und schlie√ülich der ge√§nderte Code <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://github.com/modong/GeneScienceCracked/</a> <br><br>  Denken Sie daran, $ CONSTBLOCKHASH $ in den Hash des vorhergesagten Blocks zu √§ndern. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/files/4bd/bf6/597/4bdbf659775744b1bdbb4d8a00a0a980.png" alt="Bild"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de409345/">https://habr.com/ru/post/de409345/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de409335/index.html">Wissenschaftler aus Cambridge haben mit der Implementierung des Szenarios f√ºr die Entwicklung einer starken KI einen Mod f√ºr Civilization V entwickelt</a></li>
<li><a href="../de409337/index.html">Verwendung von VR, AR und MR in Simulationen und Schulungen</a></li>
<li><a href="../de409339/index.html">√úbersicht √ºber den DVR mit GPS-Informator AdvoCam-FD Black-II GPS + GLONASS</a></li>
<li><a href="../de409341/index.html">Entwicklung einer elektronischen Steuereinheit f√ºr die Oriole-Waschmaschine</a></li>
<li><a href="../de409343/index.html">Neujahrsgeschenke, Teil drei: ob wir uns gut benommen haben</a></li>
<li><a href="../de409347/index.html">Edward Snowdens Haven Android App sch√ºtzt physische Objekte</a></li>
<li><a href="../de409349/index.html">Ben√∂tigen Sie einen ‚Äûintelligenten‚Äú Becher oder einen ziemlich gew√∂hnlichen oder wie schnell der Kaffee abk√ºhlt?</a></li>
<li><a href="../de409351/index.html">Wird der russische Weltraum 2018 explodieren?</a></li>
<li><a href="../de409355/index.html">Wie viel sollte Bitcoin kosten?</a></li>
<li><a href="../de409357/index.html">Dell Workstations: f√ºr kreative Aufgaben und extreme Produktivit√§t</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>