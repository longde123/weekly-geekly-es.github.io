<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëé ‚è∫Ô∏è üç± Watch Dogs dans la vraie vie, ou de graves vuln√©rabilit√©s dans ACS üñïüèº üßñüèæ üë®üèª‚Äç‚öïÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il me semble que beaucoup de gars, surtout √† un jeune √¢ge, voulaient √™tre des hackers sympas. Hacker des sites, des t√©l√©phones, des syst√®mes d'acc√®s. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Watch Dogs dans la vraie vie, ou de graves vuln√©rabilit√©s dans ACS</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/452458/"><p>  Il me semble que beaucoup de gars, surtout √† un jeune √¢ge, voulaient √™tre des hackers sympas.  Hacker des sites, des t√©l√©phones, des syst√®mes d'acc√®s.  J'ai donc un peu de cet enthousiasme enfantin.  Par cons√©quent, fouillant p√©riodiquement dans divers logiciels et n'a rien trouv√© de valable.  Mais un jour, la chance s'est pr√©sent√©e pour moi, et m√™me quoi!  ACS, plein de vuln√©rabilit√©s qui permettent d'acc√©der √† la gestion de l'ensemble du syst√®me (ouverture / fermeture des portes, ajout de votre carte d'acc√®s, etc.). </p><br><p>  Int√©ressant?  Alors bienvenue √† Kat! <a name="habracut"></a></p><br><p>  <em>Tout ce qui est d√©crit ci-dessous a √©t√© r√©alis√© sur un banc d'essai.</em>  <em>L'article a √©t√© √©crit uniquement √† des fins √©ducatives et en g√©n√©ral, tout cela est une invention de l'auteur.</em> </p><br><p>  <em>SKUD - syst√®me de contr√¥le et de gestion d'acc√®s</em> </p><br><p>  Il s'est av√©r√© qu'√† un moment donn√©, j'ai travaill√© dans une entreprise de construction et de voirie, o√π j'ai √©crit un ensemble de programmes pour d√©livrer des laissez-passer, d√©livrer de la nourriture pour ces laissez-passer et faire des rapports.  J'avais besoin d'int√©grer tout cela avec un ACS assez populaire.  Les d√©veloppeurs ont r√©pondu aux demandes de documentation pendant longtemps et les d√©lais ont √©t√© br√ªl√©s.  J'ai d√ª comprendre moi-m√™me leur logiciel. </p><br><p><img src="https://habrastorage.org/webt/0g/wf/ui/0gwfuitutvoja-8a8a4fmkpfmyq.jpeg" alt="image"><br>  <em>Sch√©ma de fonctionnement approximatif de l'ACS</em> </p><br><p>  J'ai commenc√© √† apprendre de la base de donn√©es.  Le serveur ACS fonctionne avec la base de donn√©es Firebird 2.5.  Le nom d'utilisateur et le mot de passe se sont av√©r√©s √™tre standard, ce qui est d√©j√† tr√®s alarmant, mais le mot de passe peut √™tre d√©fini dans les param√®tres du programme.  Les mots de passe dans la base de donn√©es vers les comptes sont hach√©s, mais sans sel, ce qui est mauvais, mais l√† encore non critique.  Il stocke toutes les zones de passage, les utilisateurs, leurs num√©ros de carte, les acc√®s et les adresses des contr√¥leurs. </p><br><p><img src="https://habrastorage.org/webt/s-/ia/jd/s-iajdlqzr1g3gnpqbkvycgolei.png" alt="image"><br>  <em>Db</em> </p><br><p>  Ensuite, nous prenons un programme pour renifler le trafic (j'ai pris "SmatrSniff", le premier qui peut regarder le trafic localhost) et voir ce que le client envoie au serveur.  Toutes les donn√©es passent par TCP et certaines par UDP sous forme non chiffr√©e.  Et ici, le plaisir commence.  Le serveur envoie d'abord le mot de passe clair de la base de donn√©es, son emplacement, et ensuite seulement v√©rifie le nom d'utilisateur et le mot de passe! </p><br><p><img src="https://habrastorage.org/webt/cl/wp/ea/clwpeapmkhgsvlbtwghlbtlzue4.png" alt="image"><br>  <em>Mot de passe de la base de donn√©es masterkey</em> </p><br><p>  Il s'av√®re que, sans conna√Ætre le nom d'utilisateur et le mot de passe, nous pouvons avoir un acc√®s complet √† la base de donn√©es, ce qui nous donne des possibilit√©s presque illimit√©es.  Nous pouvons nous donner une carte avec acc√®s √† n'importe quel objet.  Prescrivez votre carte √† un autre utilisateur et passez sous son nom.  Mais pour que ces donn√©es soient t√©l√©charg√©es sur les contr√¥leurs, vous devez donner une commande au serveur √† partir du client.  Bien que nous puissions apporter le mot de passe au client √† partir de la base de donn√©es, utilisez les bases de donn√©es MD5 ouvertes et essayez de trouver le mot de passe pour le hachage (je vous rappelle que les mots de passe dans la base de donn√©es sont sans sel), mais si le mot de passe est compliqu√©, alors tr√®s probablement rien ne fonctionnera.  Nous devrons attendre que quelqu'un clique sur le bouton de t√©l√©chargement complet. </p><br><p>  Puis j'ai regard√©, et l'autorisation affecte-t-elle quoi que ce soit.  Pour ce faire, j'ai essay√© de r√©p√©ter les requ√™tes au serveur en utilisant ¬´TCP / IP Builder¬ª.  Et oui, les requ√™tes ult√©rieures au serveur ne fonctionnent pas sans autorisation (envoie un refus en r√©ponse).  Ici, je suis un peu d√©prim√©, car pour l'int√©gration, je devrai impl√©menter une r√©p√©tition de toute la cha√Æne d'autorisation et ensuite envoyer un package pour charger les donn√©es dans le contr√¥leur. </p><br><p>  Enfin, j'ai d√©cid√© de r√©p√©ter la demande de transfert de la porte en mode ouvert.  Le serveur a r√©pondu ¬´ok¬ª et la porte bipait.  Sans aucune autorisation.  J'ai r√©p√©t√© la m√™me chose √† partir d'un autre ordinateur sur le r√©seau local et cela a fonctionn√© aussi. </p><br><p><img src="https://habrastorage.org/webt/cb/kg/zx/cbkgzxa4tjxpoqnn-5rjkb6iqt8.jpeg" alt="image"><br>  <em>Type approximatif de colis</em> </p><br><p>  Cela signifie que nous pouvons ouvrir / fermer n'importe quelle porte depuis n'importe quel ordinateur du r√©seau local.  Prescrivez-vous une carte et t√©l√©chargez imm√©diatement ces donn√©es sur les contr√¥leurs.  Parcourez ensuite calmement les objets et supprimez tous les journaux de notre visite. </p><br><p>  J'ai tu√© quelques heures pour apprendre le protocole de communication entre le contr√¥leur et le serveur afin de finalement le casser, mais je ne comprenais pas compl√®tement le format des donn√©es.  Mais je suis s√ªr qu'il n'y a pas de protection.  Les packages ont d√©finitivement les adresses mac du contr√¥leur et du serveur / passerelle (la liaison au serveur va √† l'adresse mac, il n'y a pas de cl√©s de chiffrement et autres dans la base de donn√©es, vous pouvez donc tr√®s probablement pr√©tendre √™tre le serveur du contr√¥leur connaissant le serveur mac).  Malheureusement, il n'y a pas de d√©charges ni d'acc√®s √† l'√©quipement, donc je ne peux pas le montrer. </p><br><p>  En cons√©quence, nous avons des vuln√©rabilit√©s de contr√¥le d'acc√®s complet, qui nous donnent un acc√®s illimit√© aux passages aux objets.  En raison du faible co√ªt des composants et des logiciels gratuits, cet ACS est tr√®s courant.  Elle se tient dans de nombreuses √©coles √† Moscou et je l'ai vue sur d'autres sites.  L'entreprise est fi√®re de prix lors de divers √©v√©nements.  Je ne nomme pas sp√©cifiquement l'organisation et je ne leur ai pas √©crit √† ce sujet.  Parce que je crois que de telles vuln√©rabilit√©s au niveau de l'architecture ne peuvent pas √™tre corrig√©es sans r√©√©crire tous les logiciels √† partir de z√©ro et mettre √† jour tout l'√©quipement des personnes qui ont achet√© ce syst√®me (il y a plusieurs trous plus graves au niveau de l'architecture, mais leur description aurait tripl√© l'article).  Pour ceux qui ont appris de l'√©cran ACS et qu'il est install√© en vous, je vous conseille d'isoler compl√®tement le r√©seau (qui est consid√©r√© comme les ¬´meilleures pratiques¬ª), dans lequel se trouvent tous les composants du syst√®me, et l'acc√®s √† la base de donn√©es pour ajouter des employ√©s se fait uniquement via un VPN.  Une configuration de routage appropri√©e peut √©galement aider. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr452458/">https://habr.com/ru/post/fr452458/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr452444/index.html">L'accord pour 39 millions de dollars: pourquoi les cr√©ateurs du SGBD open source ont d√©cid√© de faire du d√©veloppement mobile</a></li>
<li><a href="../fr452446/index.html">Comment nous sommes analys√©s dans les magasins et les restaurants - l'histoire continue</a></li>
<li><a href="../fr452450/index.html">Brillance et pauvret√©: un peu plus sur la fa√ßon dont les musiciens modernes gagnent leur vie</a></li>
<li><a href="../fr452454/index.html">Connexion √† Azure DevOps √† l'aide de vos informations d'identification GitHub</a></li>
<li><a href="../fr452456/index.html">Microsoft Kaizala permet √† Indian Railways de connecter ses trois millions d'employ√©s aux services de sant√©</a></li>
<li><a href="../fr452460/index.html">Pr√©sentation de Windows Terminal</a></li>
<li><a href="../fr452462/index.html">√Ä propos de la POO</a></li>
<li><a href="../fr452464/index.html">Si votre projet est "Th√©√¢tre", utilisez des acteurs</a></li>
<li><a href="../fr452466/index.html">Clavier braille</a></li>
<li><a href="../fr452468/index.html">"Si vous devez tuer quelqu'un, alors vous √™tes venu √† l'adresse"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>