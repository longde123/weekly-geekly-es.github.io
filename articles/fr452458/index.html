<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👎 ⏺️ 🍱 Watch Dogs dans la vraie vie, ou de graves vulnérabilités dans ACS 🖕🏼 🧖🏾 👨🏻‍⚕️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il me semble que beaucoup de gars, surtout à un jeune âge, voulaient être des hackers sympas. Hacker des sites, des téléphones, des systèmes d'accès. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Watch Dogs dans la vraie vie, ou de graves vulnérabilités dans ACS</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/452458/"><p>  Il me semble que beaucoup de gars, surtout à un jeune âge, voulaient être des hackers sympas.  Hacker des sites, des téléphones, des systèmes d'accès.  J'ai donc un peu de cet enthousiasme enfantin.  Par conséquent, fouillant périodiquement dans divers logiciels et n'a rien trouvé de valable.  Mais un jour, la chance s'est présentée pour moi, et même quoi!  ACS, plein de vulnérabilités qui permettent d'accéder à la gestion de l'ensemble du système (ouverture / fermeture des portes, ajout de votre carte d'accès, etc.). </p><br><p>  Intéressant?  Alors bienvenue à Kat! <a name="habracut"></a></p><br><p>  <em>Tout ce qui est décrit ci-dessous a été réalisé sur un banc d'essai.</em>  <em>L'article a été écrit uniquement à des fins éducatives et en général, tout cela est une invention de l'auteur.</em> </p><br><p>  <em>SKUD - système de contrôle et de gestion d'accès</em> </p><br><p>  Il s'est avéré qu'à un moment donné, j'ai travaillé dans une entreprise de construction et de voirie, où j'ai écrit un ensemble de programmes pour délivrer des laissez-passer, délivrer de la nourriture pour ces laissez-passer et faire des rapports.  J'avais besoin d'intégrer tout cela avec un ACS assez populaire.  Les développeurs ont répondu aux demandes de documentation pendant longtemps et les délais ont été brûlés.  J'ai dû comprendre moi-même leur logiciel. </p><br><p><img src="https://habrastorage.org/webt/0g/wf/ui/0gwfuitutvoja-8a8a4fmkpfmyq.jpeg" alt="image"><br>  <em>Schéma de fonctionnement approximatif de l'ACS</em> </p><br><p>  J'ai commencé à apprendre de la base de données.  Le serveur ACS fonctionne avec la base de données Firebird 2.5.  Le nom d'utilisateur et le mot de passe se sont avérés être standard, ce qui est déjà très alarmant, mais le mot de passe peut être défini dans les paramètres du programme.  Les mots de passe dans la base de données vers les comptes sont hachés, mais sans sel, ce qui est mauvais, mais là encore non critique.  Il stocke toutes les zones de passage, les utilisateurs, leurs numéros de carte, les accès et les adresses des contrôleurs. </p><br><p><img src="https://habrastorage.org/webt/s-/ia/jd/s-iajdlqzr1g3gnpqbkvycgolei.png" alt="image"><br>  <em>Db</em> </p><br><p>  Ensuite, nous prenons un programme pour renifler le trafic (j'ai pris "SmatrSniff", le premier qui peut regarder le trafic localhost) et voir ce que le client envoie au serveur.  Toutes les données passent par TCP et certaines par UDP sous forme non chiffrée.  Et ici, le plaisir commence.  Le serveur envoie d'abord le mot de passe clair de la base de données, son emplacement, et ensuite seulement vérifie le nom d'utilisateur et le mot de passe! </p><br><p><img src="https://habrastorage.org/webt/cl/wp/ea/clwpeapmkhgsvlbtwghlbtlzue4.png" alt="image"><br>  <em>Mot de passe de la base de données masterkey</em> </p><br><p>  Il s'avère que, sans connaître le nom d'utilisateur et le mot de passe, nous pouvons avoir un accès complet à la base de données, ce qui nous donne des possibilités presque illimitées.  Nous pouvons nous donner une carte avec accès à n'importe quel objet.  Prescrivez votre carte à un autre utilisateur et passez sous son nom.  Mais pour que ces données soient téléchargées sur les contrôleurs, vous devez donner une commande au serveur à partir du client.  Bien que nous puissions apporter le mot de passe au client à partir de la base de données, utilisez les bases de données MD5 ouvertes et essayez de trouver le mot de passe pour le hachage (je vous rappelle que les mots de passe dans la base de données sont sans sel), mais si le mot de passe est compliqué, alors très probablement rien ne fonctionnera.  Nous devrons attendre que quelqu'un clique sur le bouton de téléchargement complet. </p><br><p>  Puis j'ai regardé, et l'autorisation affecte-t-elle quoi que ce soit.  Pour ce faire, j'ai essayé de répéter les requêtes au serveur en utilisant «TCP / IP Builder».  Et oui, les requêtes ultérieures au serveur ne fonctionnent pas sans autorisation (envoie un refus en réponse).  Ici, je suis un peu déprimé, car pour l'intégration, je devrai implémenter une répétition de toute la chaîne d'autorisation et ensuite envoyer un package pour charger les données dans le contrôleur. </p><br><p>  Enfin, j'ai décidé de répéter la demande de transfert de la porte en mode ouvert.  Le serveur a répondu «ok» et la porte bipait.  Sans aucune autorisation.  J'ai répété la même chose à partir d'un autre ordinateur sur le réseau local et cela a fonctionné aussi. </p><br><p><img src="https://habrastorage.org/webt/cb/kg/zx/cbkgzxa4tjxpoqnn-5rjkb6iqt8.jpeg" alt="image"><br>  <em>Type approximatif de colis</em> </p><br><p>  Cela signifie que nous pouvons ouvrir / fermer n'importe quelle porte depuis n'importe quel ordinateur du réseau local.  Prescrivez-vous une carte et téléchargez immédiatement ces données sur les contrôleurs.  Parcourez ensuite calmement les objets et supprimez tous les journaux de notre visite. </p><br><p>  J'ai tué quelques heures pour apprendre le protocole de communication entre le contrôleur et le serveur afin de finalement le casser, mais je ne comprenais pas complètement le format des données.  Mais je suis sûr qu'il n'y a pas de protection.  Les packages ont définitivement les adresses mac du contrôleur et du serveur / passerelle (la liaison au serveur va à l'adresse mac, il n'y a pas de clés de chiffrement et autres dans la base de données, vous pouvez donc très probablement prétendre être le serveur du contrôleur connaissant le serveur mac).  Malheureusement, il n'y a pas de décharges ni d'accès à l'équipement, donc je ne peux pas le montrer. </p><br><p>  En conséquence, nous avons des vulnérabilités de contrôle d'accès complet, qui nous donnent un accès illimité aux passages aux objets.  En raison du faible coût des composants et des logiciels gratuits, cet ACS est très courant.  Elle se tient dans de nombreuses écoles à Moscou et je l'ai vue sur d'autres sites.  L'entreprise est fière de prix lors de divers événements.  Je ne nomme pas spécifiquement l'organisation et je ne leur ai pas écrit à ce sujet.  Parce que je crois que de telles vulnérabilités au niveau de l'architecture ne peuvent pas être corrigées sans réécrire tous les logiciels à partir de zéro et mettre à jour tout l'équipement des personnes qui ont acheté ce système (il y a plusieurs trous plus graves au niveau de l'architecture, mais leur description aurait triplé l'article).  Pour ceux qui ont appris de l'écran ACS et qu'il est installé en vous, je vous conseille d'isoler complètement le réseau (qui est considéré comme les «meilleures pratiques»), dans lequel se trouvent tous les composants du système, et l'accès à la base de données pour ajouter des employés se fait uniquement via un VPN.  Une configuration de routage appropriée peut également aider. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr452458/">https://habr.com/ru/post/fr452458/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr452444/index.html">L'accord pour 39 millions de dollars: pourquoi les créateurs du SGBD open source ont décidé de faire du développement mobile</a></li>
<li><a href="../fr452446/index.html">Comment nous sommes analysés dans les magasins et les restaurants - l'histoire continue</a></li>
<li><a href="../fr452450/index.html">Brillance et pauvreté: un peu plus sur la façon dont les musiciens modernes gagnent leur vie</a></li>
<li><a href="../fr452454/index.html">Connexion à Azure DevOps à l'aide de vos informations d'identification GitHub</a></li>
<li><a href="../fr452456/index.html">Microsoft Kaizala permet à Indian Railways de connecter ses trois millions d'employés aux services de santé</a></li>
<li><a href="../fr452460/index.html">Présentation de Windows Terminal</a></li>
<li><a href="../fr452462/index.html">À propos de la POO</a></li>
<li><a href="../fr452464/index.html">Si votre projet est "Théâtre", utilisez des acteurs</a></li>
<li><a href="../fr452466/index.html">Clavier braille</a></li>
<li><a href="../fr452468/index.html">"Si vous devez tuer quelqu'un, alors vous êtes venu à l'adresse"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>