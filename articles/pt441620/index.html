<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🥛 👩🏻 🔴 O Projeto Prometheus: Procurando fogo usando IA 🔏 🔅 ✳️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Projeto de tradução Prometheus - Uma solução de detecção de incêndio com IA 

 Meus colegas e eu estamos trabalhando no projeto Prometheus (Prometheus...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>O Projeto Prometheus: Procurando fogo usando IA</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/nix/blog/441620/"><img src="https://habrastorage.org/getpro/habr/post_images/afd/986/31a/afd98631a83cf3565ce69cd21d05cef6.png"><br><br>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Projeto de</a> tradução <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Prometheus - Uma solução de detecção de incêndio com IA</a></i> <br><br>  Meus colegas e eu estamos trabalhando no projeto Prometheus (Prometheus), uma solução de detecção precoce de incêndio que combina IA, visão computacional, drones automáticos e serviços de previsão do tempo.  Este complexo foi projetado para detectar incêndios antes que eles se transformem em um verdadeiro desastre.  Queremos falar sobre o projeto com mais detalhes, como ele funciona e que aparato teórico está em seu cerne.  O material será enviado o mais independente possível de tecnologias específicas, por isso, se você estiver interessado em recursos de implementação específicos (CNTK, Faster R-CNN, contêineres Docker, Python, estrutura .NET etc.), acesse nosso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">repositório GitHub</a> .  E aqui apenas mencionamos as tecnologias usadas. <br><br>  Uma pequena introdução: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/T9SSjgNqj08" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><a name="habracut"></a><br><h2>  Motivação </h2><br>  Em 2017, estimou-se que os incêndios florestais custam à economia dos EUA cerca de US $ 200 bilhões, o que representa um pouco menos de dano causado por furacões.  Mas a diferença é que, se você apagar os incêndios antes que eles cresçam, as perdas poderão ser bastante reduzidas.  No entanto, a tarefa de detectar incêndios é rotineira, difícil e requer a participação de pessoas: na maioria das vezes elas estão sentadas nas torres de observação com binóculos, tentando perceber o fogo a tempo ou sobrevoando o território em helicópteros ou drones guiados.  O projeto Prometheus foi projetado para automatizar toda essa rotina usando drones automáticos que detectarão incêndios em um estágio inicial; caso contrário, os recursos de vento, secura ou terreno ajudarão o fogo a se espalhar para acres da área em minutos.  Além disso, a maioria desses incêndios ocorre em áreas remotas, onde há poucas pessoas e ninguém para rastrear a ocorrência de focos. <br><br>  Se você enviar drones para patrulhar essas áreas remotas, eles ajudarão a detectar incêndio a tempo e minimizar os danos. <br><br><h2>  Projeto </h2><br>  Prometeu pode ser dividido em três partes: <br><br><ul><li>  O módulo de detecção de incêndio usa algoritmos de aprendizado profundo para identificar pequenos focos usando a câmera RGB do drone (implementada como um serviço REST na nuvem). </li><li>  O módulo de planejamento de vôo permite ao usuário selecionar e planejar zonas de patrulha (implementadas como um aplicativo do Windows e integradas aos serviços de mapeamento climático). </li><li>  O sistema de aviso permite que o usuário notifique rapidamente a equipe sobre um incêndio detectado (usando o Azure Functions e o Twilio). </li></ul><br><h2>  Detecção de incêndio </h2><br>  Usamos drones automatizados para procurar fogo em áreas remotas.  As câmeras RGB integradas são usadas para fotografar toda a área e as fotos são alimentadas com um modelo de aprendizado de máquina que procura por incêndios e notifica o usuário.  Obrigado a todos, todos são livres.  Embora, ei ... <br><br><h4>  Lição Um: O Tamanho É Importante </h4><br>  Determinar incêndios usando a visão computacional nas proporções necessárias era uma tarefa difícil e, portanto, usamos uma abordagem diferente.  Você provavelmente pensou que o uso de câmeras RGB não é prático porque as câmeras infravermelhas são preferíveis nesse caso.  Mas depois de conversar com os bombeiros, descobrimos que não é tão simples: lugares com alta temperatura do ar parecerão incêndios em câmeras infravermelhas e algumas partes da superfície parecerão fontes de calor apenas devido às peculiaridades do reflexo da luz.  Além disso, essas câmeras são significativamente mais caras.  Os bombeiros os usam principalmente à noite para ver se eles conseguiram apagar completamente o fogo. <br><br>  Em geral, se você quiser usar o aprendizado de máquina para classificar uma imagem em uma categoria específica - disparar / não disparar -, provavelmente usará as técnicas de classificação.  Simples assim.  Mas pode ser que as características necessárias para a classificação sejam muito pequenas em comparação com a imagem completa.  Por exemplo, uma pequena fonte típica de ignição se parece com isso: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f41/c0e/e84/f41c0ee84398a9711b097b59a77edcb6.png"><br><br>  Nesses casos, incluindo o nosso, o melhor desempenho na determinação de objetos pode ser alcançado se você não prestar atenção à sua localização específica ou contar o número na imagem.  Mas, na maioria das vezes, o sistema de dispositivos para determinar objetos é muito mais complicado.  Existem diferentes maneiras de resolver esse problema, e usamos a rede neural convolucional regional (R-CNN), ou melhor, a implementação do R-CNN mais rápido. <br><br>  Também são frequentemente utilizados o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">YoLo</a> e o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Detectron</a> (recentemente movidos para o código aberto). <br><br>  O processo consiste nas seguintes etapas: <br><br><ul><li>  Localização: você precisa gerar seções (amostras) de áreas na imagem que podem conter os objetos desejados.  Essas áreas são chamadas de regiões de interesse (ROIs).  São grandes conjuntos de quadros que cobrem a imagem inteira.  Geramos ROI usando a técnica descrita em Segmentação como Pesquisa seletiva por reconhecimento de objetos por Koen EA van de Sande e outros.  A técnica é implementada na biblioteca dlib Python. </li><li>  Classificação de objetos: além disso, as propriedades visuais são extraídas de cada quadro, sua avaliação é realizada e o sistema assume se existem objetos e o que são (mais sobre isso abaixo). </li><li>  Supressão não máxima: acontece que os quadros que representam o mesmo objeto se sobrepõem parcial ou completamente um sobre o outro.  Para evitar essa duplicação, os quadros de interseção são combinados em um.  Essa tarefa pode exigir muito poder de computação, mas algumas otimizações são implementadas na Intel Math Library. </li></ul><br><h4>  Lição dois: seus dados podem precisar de ajuda </h4><br>  O aprendizado de máquina precisa de dados.  Mas no aprendizado profundo (isto é, em um espaço de entrada multidimensional), você precisará de muitos dados para extrair as propriedades visuais de interesse.  Como você entende, é difícil encontrar um grande conjunto de dados de objetos que nos interessam (incêndios).  Para resolver esse problema, usamos a técnica de “transferência de aprendizado” com modelos de classificação de imagem de uso geral pré-treinados para extrair propriedades visuais, pois elas podem generalizar bem.  Simplificando, você pega um modelo pré-treinado para definir algo e o "configura" usando seu conjunto de dados.  Ou seja, esse modelo extrairá propriedades e você já tentará usar as representações aprendidas para a tarefa A (geralmente uma tarefa de alto nível) na solução do problema B (geralmente uma de nível inferior).  O sucesso da solução do Problema B indica quanto o modelo da tarefa A conseguiu aprender sobre a tarefa B. No nosso caso, a tarefa A foi a tarefa de classificar objetos do ImageNet e a tarefa B foi a identificação de incêndios. <br><br>  Essa técnica pode ser aplicada removendo a última camada de uma rede neural pré-treinada e substituindo-a por seu próprio classificador.  Em seguida, congelamos os pesos de todas as outras camadas e treinamos a rede neural da maneira usual. <br><br>  A rede neural resultante não está disponível no GitHub devido ao seu tamanho - cerca de 250 MB.  Se você precisar, escreva- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nos</a> . <br><br>  Existem muitos modelos já treinados para o ImageNet (AlexNet, VGG, Inception, RestNet, etc.).  Em cada um deles, os autores usaram diferentes compromissos em velocidade, precisão e estrutura.  Escolhemos o AlexNet, porque requer menos recursos computacionais, e os resultados em nossa tarefa diferem pouco de outras redes. <br><br><h4>  Lição três: os vídeos (especialmente os quadros individuais) são seus melhores amigos </h4><br>  Mas, apesar da transferência de treinamento, ainda precisamos de muitos dados para resolver o problema de classificação.  E então aproveitamos o vídeo.  Você pode extrair vários quadros de cada vídeo e obter rapidamente um grande conjunto de dados.  O vídeo tem outra propriedade útil: se um objeto ou câmera se move, você obtém imagens do objeto com iluminação diferente, em ângulos e posições diferentes, para que o conjunto de dados seja de alta qualidade. <br><br>  Também não carregamos nosso conjunto de imagens no repositório, devido ao tamanho, bater. <br><br>  Coletamos vídeos de drones de várias fontes e os rotulamos manualmente.  Existem várias ferramentas para rotular imagens em diferentes formatos, dependendo da estrutura de aprendizado profundo usada.  Eu recomendo o LabelImg para Linux / Windows e o RectLabel para Mac.  Como usamos o CNTK, optamos por uma ferramenta Microsoft VoTT que pode exportar para os formatos CNTK e TensorFlow. <br><br><h4>  Lição Quatro: compre uma placa de vídeo (ou alugue uma nuvem) </h4><br>  Treinar um modelo grande como o nosso exige um poder computacional considerável, e a GPU será uma grande ajuda.  Levamos cerca de 15 minutos para aprender a usar a NVIDIA GeForce GTX 1050. Mas, apesar do uso de uma placa de vídeo, definir parâmetros do modelo é uma grande dificuldade.  A Microsoft possui uma boa ferramenta chamada Serviço de Experimentação do Azure, que permite executar vários treinamentos com diferentes parâmetros na nuvem em paralelo e analisar a precisão obtida.  Veja também o AWS SageMaker. <br><br>  Nosso repositório contém <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">o script Sweep_parameters.py</a> , que limpará automaticamente o espaço paramétrico e iniciará as tarefas de treinamento. <br><br><h2>  Feito! </h2><br>  Então, treinamos nossa R-CNN e nos livramos dela com a transferência de treinamento, aprendizado profundo, placas de vídeo etc. Como agora compartilhar nosso trabalho com outras pessoas?  Primeiro, lançamos um serviço REST para interagir com o modelo.  A API permite enviar imagens para avaliação e retorna áreas de imagens, a presença de fogo para a qual o modelo determinou com alguma certeza.  Você também pode dizer à API se a imagem é realmente de fogo ou não.  Outros pontos de extremidade são usados ​​para feedback e aprimoramentos. <br>  O serviço da API REST é empacotado em um contêiner do Docker e publicado na nuvem, o que permite dimensionar a solução de forma barata.  No repositório, você pode encontrar o arquivo com a imagem do Docker. <br><br><h2>  Planejamento de vôo </h2><br><h4>  Avisos vermelhos </h4><br>  Como Prometheus sabe para onde enviar drones?  Integramos com os serviços meteorológicos nacionais para identificar "alertas vermelhos".  São áreas nas quais a temperatura do ar, direção e força do vento, umidade e pressão atmosférica aumentam a probabilidade de incêndio.  Como os serviços meteorológicos são orientados para seus países, dificilmente podem ser usados ​​para pesquisas no exterior.  Hoje trabalhamos com serviços americanos e argentinos. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d4a/6c8/fb8/d4a6c8fb8b8b62039efae04cd19089d6.png"><br><br><h4>  Informações meteorológicas </h4><br>  É muito importante ter dados meteorológicos precisos nas áreas de interesse.  Os bombeiros nos perguntaram sobre essa função.  Obtemos dados meteorológicos pesquisando estações meteorológicas através do servidor de mapas do Serviço Meteorológico Nacional e sobrepondo as informações recebidas no mapa.  Enfatizamos que essa não é uma previsão do tempo, mas medidas reais: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/331/bb6/6b5/331bb66b554e37f46196096e74e68a07.png"><br>  <i>Estações meteorológicas nos EUA</i> . <br><br>  Não entende como este cartão funciona?  Você não está sozinho nisso.  Levamos várias semanas para descobrir como usar isso.  Há pouca informação na rede.  Se você quiser experimentar dados de estações meteorológicas, precisará obter as chaves de API dos fornecedores, pois não temos o direito de compartilhá-las. <br><br><h4>  Sistema de aviso </h4><br>  Quando o sistema detecta incêndio, solicita ao operador que confirme o fato da detecção.  A interface fica assim: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/16d/f50/0a2/16df500a22c736685c3c09c3c7ccbc24.png"><br>  <i>Janela de confirmação de incêndio</i> . <br><br>  Como você pode ver, o sistema funciona com bastante precisão, mesmo em casos difíceis como este.  Uma pequena moldura vermelha descreve os limites do fogo com uma probabilidade de 67%.  De fato, Prometheus tenta detectar grandes incêndios e é instável ao calcular áreas em cenários como este.  Tudo está em ordem, como pretendido.  Simplesmente não estávamos interessados ​​nessas situações. <br><br>  O sistema de aviso envia uma notificação por SMS com coordenadas GPS do incêndio para números de telefone pré-registrados.  A distribuição é realizada usando o Twilio, uma plataforma em nuvem cujas APIs permitem, entre outras coisas, enviar e receber mensagens de texto programaticamente. <br><br><h2>  Quer dar uma olhada? </h2><br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O código fonte está aqui</a> <br><br><h2>  Agradecimentos </h2><br>  O Prometheus foi desenvolvido em colaboração com o Corpo de Bombeiros de Tempe, Arizona, o Corpo de Bombeiros da Argentina e o Instituto Nacional Argentino de Tecnologia Agrícola da Argentina. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt441620/">https://habr.com/ru/post/pt441620/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt441604/index.html">Sistemas de vigilância nacional da China: uma fonte não apenas de dados, mas também de uma renda estável</a></li>
<li><a href="../pt441608/index.html">Dualidade - um mecanismo fácil e rápido para o igrostroy no Windows (Ext.)</a></li>
<li><a href="../pt441610/index.html">Mentiras LED de proporções sem precedentes</a></li>
<li><a href="../pt441616/index.html">Likbez lança Istio</a></li>
<li><a href="../pt441618/index.html">Criação da barra de navegação inferior no Kotlin usando Anko</a></li>
<li><a href="../pt441626/index.html">Workshop sobre impressão 3D industrial: 1º de março no Caliber Technopark</a></li>
<li><a href="../pt441628/index.html">Classificação de empregadores de TI em São Petersburgo e Moscou 2018: resultados de uma pesquisa com desenvolvedores</a></li>
<li><a href="../pt441632/index.html">1 de março - Teamlead Meetup: avaliação e motivação dos funcionários</a></li>
<li><a href="../pt441634/index.html">Existe vida no Windows 98, parte dois - sobre software</a></li>
<li><a href="../pt441636/index.html">Linux Foundation anuncia plataforma ELISA de código aberto para o desenvolvimento de sistemas automatizados</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>