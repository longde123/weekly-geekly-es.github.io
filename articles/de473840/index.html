<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💿 💫 👩🏾‍🌾 Streamen Sie Videos vom Android-Gerät über UDP zur JAVA-Anwendung 🍩 👍🏼 👩‍⚖️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Also, geh bis zur Ziellinie. Wir haben bereits gelernt, wie man Videos vom Android zum VLC-Player streamen kann. Jetzt muss nur noch das Fenster mit d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Streamen Sie Videos vom Android-Gerät über UDP zur JAVA-Anwendung</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/473840/">  Also, geh bis zur Ziellinie.  Wir haben bereits <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gelernt, wie man</a> Videos vom Android zum VLC-Player streamen kann. Jetzt muss nur noch das Fenster mit dem Video in die JAVA-Anwendung integriert und der Roboter gesteuert werden. <br><br><img src="https://habrastorage.org/webt/u_/5w/i7/u_5wi7sg8iq82mfpoeulmxwmh8e.jpeg"><br><br>  Das Open-Source-Projekt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">VLCJ CAPRICA</a> wird uns dabei sehr helfen. <br><blockquote> Das vlcj-Projekt bietet ein Java-Framework, mit dem eine Instanz eines nativen VLC-Mediaplayers in eine Java-Anwendung eingebettet werden kann. </blockquote>  Die Idee der Jungs ist einfach, aber genial (wirklich Pfeffer).  Anstatt mit FFmpeg-Bibliotheken und mehr zu quälen, sollten Sie sofort einen <s>Spezialisten als</s> Kern eines normalen, funktionalen und professionellen VLC-Mediaplayers bezeichnen.  Und rufen Sie es direkt aus der JAVA-Anwendung auf. <br><br>  Wen kümmert es, wir bitten um eine Katze. <br><a name="habracut"></a><br>  Da es auf dieser Reise genügend Fallstricke gibt, werden wir wie üblich mit einer sehr einfachen beginnen und erst dann zum Trivialen übergehen. <br><br><h4>  Installieren Sie das VLCJ-Paket </h4><br>  Überprüfen Sie zunächst Ihre Version des VLC Media Players.  Wir brauchen keine neue Version, sie schneidet, was für den UDP-Stream erforderlich ist.  Dies wurde bereits in einem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">früheren Beitrag erwähnt</a> .  Daher laden wir die Version <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">2.2.6 von Umbrella</a> herunter und überprüfen gleichzeitig sorgfältig unser JAVA-Paket.  Sie müssen in der Bittiefe übereinstimmen.  Wenn der Player eine 64-Bit-Architektur verwendet, muss das JDK identisch sein.  Und es wird nicht abheben. <br><br>  Danach können Sie bereits das VLCJ- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bibliothekspaket</a> selbst herunterladen <br><br><img src="https://habrastorage.org/webt/vf/hy/wa/vfhywa19hua9z6wyuhrujhh3o_s.png"><br><br>  Bitte beachten Sie, dass wir das <b>Distributionspaket vlcj-3.12.1 (zip)</b> benötigen.  Er arbeitet mit der Spielerversion VLC 2.2.x.  Sie können es überall entpacken. Hauptsache, es befindet sich nicht im Ordner des VLC selbst, da zwei Dateien nach Namen übereinstimmen.  Und wenn Sie sie neu schreiben, wird dies alles zu einem völligen Misserfolg führen. <br><br>  Als Nächstes erstellen wir ein Projekt in der IntelliJ IDEA IDE (wenn Sie eine andere IDE haben, kann ich nichts helfen) und schreiben die erforderlichen Abhängigkeiten für die Integration von VLCJ-Bibliotheken. <br><br><img src="https://habrastorage.org/webt/st/so/41/stso41fizp2ufcupq_ug4wvydky.png"><br><br>  Wir machen genau das für Dateien: <br><br>  <b>jna-5.2.0</b> <b><br><br></b>  <b>jna-platform-5.2.0</b> <b><br><br></b>  <b>vlcj-3.12.1</b> <br><br>  Dann erstellen wir die einzige Klasse und schreiben das nächste kleine Programm darin. <br><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.awt.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.awt.event.WindowAdapter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.awt.event.WindowEvent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.swing.JFrame; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.swing.JPanel; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.swing.SwingUtilities; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uk.co.caprica.vlcj.component.EmbeddedMediaPlayerComponent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uk.co.caprica.vlcj.discovery.NativeDiscovery; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uk.co.caprica.vlcj.player.MediaPlayerFactory; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uk.co.caprica.vlcj.player.embedded.EmbeddedMediaPlayer; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uk.co.caprica.vlcj.player.embedded.videosurface.CanvasVideoSurface; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BasicPlayer</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> JFrame frame; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String mrl; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> MediaPlayerFactory mpf; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> EmbeddedMediaPlayer MediaPlayer; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> CanvasVideoSurface videoSurface; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Canvas canvas; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> String[] args)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NativeDiscovery().discover(); mrl = <span class="hljs-string"><span class="hljs-string">"D:\\ttt.mp4"</span></span>; SwingUtilities.invokeLater(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Runnable() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ BasicPlayer vp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BasicPlayer(); vp.start(mrl); } }); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BasicPlayer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ frame = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JFrame(<span class="hljs-string"><span class="hljs-string">"My First Media Player"</span></span>); frame.setBounds(<span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">540</span></span>, <span class="hljs-number"><span class="hljs-number">340</span></span>); frame.setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE); frame.addWindowListener(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WindowAdapter() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">windowClosing</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(WindowEvent e)</span></span></span><span class="hljs-function"> </span></span>{ System.out.println(e); MediaPlayer.release(); mpf.release(); System.exit(<span class="hljs-number"><span class="hljs-number">0</span></span>); } }); JPanel contentPane = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JPanel(); contentPane.setLayout(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BorderLayout()); canvas = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Canvas(); mpf = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MediaPlayerFactory(); videoSurface = mpf.newVideoSurface(canvas); MediaPlayer = mpf.newEmbeddedMediaPlayer(); MediaPlayer.setVideoSurface(videoSurface); contentPane.add(canvas, BorderLayout.CENTER); <span class="hljs-comment"><span class="hljs-comment">//        frame.setContentPane(contentPane); frame.setVisible(true); } public void start(String mrl) { MediaPlayer.playMedia(mrl); } }</span></span></code> </pre> <br>  Ja, während wir versuchen, nur eine Datei abzuspielen (wie aus dem Code ersichtlich).  Es ist besser, nicht mit udp zu beginnen - es wird nicht funktionieren.  Und die Datei wird vollständig abgespielt, wenn Sie natürlich nicht vergessen haben, sie bei Bedarf im Voraus mit dem entsprechenden Namen zu platzieren.  Ich denke, dass es selbst für den Anfänger Javista nicht schwierig sein wird, den obigen Code zu verstehen. <br><br>  Alles neu ist: <br><br>  <b>Anruf für VLCJ</b> <br><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NativeDiscovery().discover();</code> </pre><br>  <b>und Erstellen der Media Player-Instanz selbst</b> <br><br><pre> <code class="java hljs"> mpf = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MediaPlayerFactory(); videoSurface = mpf.newVideoSurface(canvas); MediaPlayer = mpf.newEmbeddedMediaPlayer(); MediaPlayer.setVideoSurface(videoSurface);</code> </pre><br>  Und dann fügen wir es einfach dem gewünschten Grafikfeld hinzu: <br><br><pre> <code class="java hljs">contentPane.add(canvas, BorderLayout.CENTER);</code> </pre><br>  Und alles, die Datei wird in diesem Fenster abgespielt. <br><br>  Versuchen Sie nun zu ersetzen <br><br><pre> <code class="plaintext hljs">mrl = "D:\\ttt.mp4";</code> </pre> <br>  auf <br><br><pre> <code class="plaintext hljs">mrl = "udp://@:40002";</code> </pre> <br>  wie wir es ruhig im letzten Beitrag für das Streaming von Videos über udp-Verbindung getan haben. <br>  Diese Nummer funktioniert hier nicht.  Das Fenster öffnet sich natürlich, aber es zeigt eine Feige im Sinne eines dunklen Bildschirms.  Es werden zwar keine Fehlerprotokolle angezeigt.  Es wird einfach nichts geben. <br><br><h4>  Ich muss es herausfinden </h4><br>  Möglicherweise fehlt der H264-Codec, den wir in den Einstellungen ausgewählt haben?  Stop, wie wurde dann die Datei ttt.mp4 gerade abgespielt?  Er kann mit dieser Einstellung nicht spielen, er ist mp4. <br><br>  Es entsteht sofort das Verständnis, dass in der VLCJ-Bibliothek nur der Kern des Players selbst ausgeführt wird.  Und was die Voreinstellungen dort waren, weiß sie nicht und will es nicht wissen.  Das heißt, wir müssen beim Starten der JAVA-Anwendung irgendwie den VLC-Player übergeben, den wir explizit mit dem H264-Codec verwenden möchten, oder wir möchten beispielsweise das Bild oder etwas anderes drehen. <br><br>  Es stellt sich heraus, dass dies mit der MediaPlayerFactory-Klasse erfolgen kann.  Nur wir haben es ohne Argumente oder sogar mit ihnen gestartet.  Auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">stackoverflow.com habe</a> ich sofort ein einfaches Beispiel für die Bildrotation gefunden: <br><br><pre> <code class="java hljs">String[] args = { <span class="hljs-string"><span class="hljs-string">"--video-filter"</span></span>, <span class="hljs-string"><span class="hljs-string">"rotate"</span></span>, <span class="hljs-string"><span class="hljs-string">"rotate-angle"</span></span>, <span class="hljs-string"><span class="hljs-string">"10"</span></span> }; mpf = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MediaPlayerFactory(args);</code> </pre><br>  Das heißt, wir übertragen dort etwas mit einem String-Array an die Media Factory und es wird dort für die verwendete Medienressource gespeichert. <br><br>  Ich habe diese Methode ausprobiert, um die Datei abzuspielen, und wie üblich hat nichts funktioniert.  Es stellt sich heraus, dass sie vergessen haben, zwei Striche hinzuzufügen und im ganzen Internet zu verbreiten.  Ich musste mit einer ähnlichen Transformationsmethode raten. <br><br>  Kurz gesagt sollte es sein: <br><br><pre> <code class="java hljs">String[] args = { <span class="hljs-string"><span class="hljs-string">"--video-filter"</span></span>, <span class="hljs-string"><span class="hljs-string">"rotate"</span></span>, <span class="hljs-string"><span class="hljs-string">"--rotate-angle"</span></span>, <span class="hljs-string"><span class="hljs-string">"10"</span></span> };</code> </pre><br>  Jetzt wurde unsere Referenzdatei wie gewünscht zurückgesetzt! <br><br><img src="https://habrastorage.org/webt/-f/xz/zw/-fxzzwjysqrfyxo2or4pqos075y.png"><br><br>  Weiter wird es ganz einfach sein: <br><br>  Um den Codec gemäß <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">der VLC-Befehlszeile</a> zu bestimmen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">,</a> fügen wir die Zeile dem Zeichenfolgenarray hinzu: <br><br><pre> <code class="java hljs"><span class="hljs-string"><span class="hljs-string">"--demux=h264"</span></span></code> </pre><br>  <b>Ich versuche es erneut mit dem udp-Kanal</b> <br><br><br>  mrl = "udp: // @: 40002"; <br><br>  Und diesmal funktioniert alles und zeigt den Sieg des menschlichen Geistes an.  Mit diesem oder mehreren solchen Fenstern können Sie nun problemlos auf die grafische Oberfläche Ihrer JAVA-Anwendung portieren. <br><br><h4>  Es scheint ein Sieg zu sein? </h4><br>  Nicht wirklich.  Eine leichte Verwirrung wurde durch vorübergehende Verzögerungen oder wissenschaftlich Verzögerungen verursacht.  Anfangs sind sie mehr oder weniger akzeptabel, aber wenn Sie die Geduld haben, das Video bis zum Ende anzusehen, werden Sie feststellen, dass die Verzögerung am Ende der ersten Minute der Sendung bis zu fünf Sekunden beträgt.  Ich hatte genug Geduld für 10 Minuten Drehzeit, aber seltsamerweise nahm die Verzögerung nicht mehr zu, sondern blieb innerhalb der gleichen Grenzen. <br><br><div class="spoiler">  <b class="spoiler_title">das Video</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/wy_GvVw9rF4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></div></div><br>  Um ein Video von der Kamera anzusehen, reicht dies natürlich aus, aber kaum, um einen Roboter zu steuern.  Sogar der Mondrover reagierte doppelt so schnell! <br><br>  Der Verdacht fiel sofort auf die Caching-Prozesse und sie (Verdächtigungen) erwiesen sich als wahr. <br><br>  Das arroganteste war: <br><br><pre> <code class="java hljs"> caching <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> network resources</code> </pre><br>  Es frisst standardmäßig fast alles auf, wenn es ihm nicht rechtzeitig gegeben wird. <br>  Kann eine Verzögerung arrangieren und: <br><br><pre> <code class="java hljs">caching <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> cameras and microphones</code> </pre><br>  Um Verzögerungen von mehreren Sekunden zu vermeiden, wird empfohlen, dem folgenden Zeichenfolgenarray die folgenden Zeilen hinzuzufügen, die durch Kommas getrennt sind: <br><br><pre> <code class="java hljs"> <span class="hljs-string"><span class="hljs-string">"--live-caching=100"</span></span>, <span class="hljs-string"><span class="hljs-string">"--network-caching=500"</span></span>,</code> </pre><br>  Die Parameter werden dort in Millisekunden eingestellt und können daher von jedem selbst ausgewählt werden. <br><br>  Sie können auch den Schlüssel verwenden: <br><br><pre> <code class="java hljs"><span class="hljs-string"><span class="hljs-string">"--clock-jitter=time in milliseconds"</span></span>,</code> </pre><br>  Dann versucht der Media Player, den Jitter zu optimieren und den Bildschirm zucken.  Aber je mehr Zeit eingestellt ist, desto besser wird sie optimiert, und dies ist verständlich, warum.  Hier bleibt es also nur, einen Konsens zu suchen und manchmal eine solche Schande in den Protokollen zu sehen: <br><br><img src="https://habrastorage.org/webt/zm/wk/xe/zmwkxesmreokc5rq6ptiygnvvda.png"><br><br>  Er wollte den Jitter beheben, und Sie haben das Zeitintervall zu klein eingestellt.  Jetzt ist es meine Schuld. <br><br>  Jetzt scheint alles so zu sein, wie es sollte.  Die Verzögerung wurde auf weniger als eine Sekunde reduziert (wenn auch etwas weniger). <br><br><div class="spoiler">  <b class="spoiler_title">das Video</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/F00YZjS_E4A" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></div></div><br>  <b>Als Ergebnis haben wir einen sehr kleinen Arbeitscode erhalten</b> <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.awt.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.awt.event.WindowAdapter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.awt.event.WindowEvent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.swing.JFrame; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.swing.JPanel; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.swing.SwingUtilities; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uk.co.caprica.vlcj.discovery.NativeDiscovery; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uk.co.caprica.vlcj.player.MediaPlayerFactory; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uk.co.caprica.vlcj.player.embedded.EmbeddedMediaPlayer; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uk.co.caprica.vlcj.player.embedded.videosurface.CanvasVideoSurface; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BasicVideoPlayer</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> JFrame frame; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String mrl; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> MediaPlayerFactory mpf; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> EmbeddedMediaPlayer MediaPlayer; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> CanvasVideoSurface videoSurface; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Canvas canvas; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> String[] args)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NativeDiscovery().discover(); mrl = <span class="hljs-string"><span class="hljs-string">"udp://@:40002"</span></span>; SwingUtilities.invokeLater(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Runnable() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ BasicVideoPlayer vp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BasicVideoPlayer(); vp.start(mrl); } }); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BasicVideoPlayer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ frame = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JFrame(<span class="hljs-string"><span class="hljs-string">"My First Media Player"</span></span>); frame.setBounds(<span class="hljs-number"><span class="hljs-number">200</span></span>,<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">540</span></span>, <span class="hljs-number"><span class="hljs-number">340</span></span>); frame.setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE); frame.addWindowListener(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WindowAdapter() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">windowClosing</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(WindowEvent e)</span></span></span><span class="hljs-function"> </span></span>{ System.out.println(e); MediaPlayer.release(); mpf.release(); System.exit(<span class="hljs-number"><span class="hljs-number">0</span></span>); } }); JPanel contentPane = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JPanel(); contentPane.setLayout(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BorderLayout()); canvas = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Canvas(); String[] args = { <span class="hljs-string"><span class="hljs-string">"--video-filter"</span></span>, <span class="hljs-string"><span class="hljs-string">"rotate"</span></span>, <span class="hljs-string"><span class="hljs-string">"--rotate-angle"</span></span>, <span class="hljs-string"><span class="hljs-string">"270"</span></span>, <span class="hljs-string"><span class="hljs-string">"--demux=h264"</span></span>, <span class="hljs-string"><span class="hljs-string">"--clock-jitter=100"</span></span>, <span class="hljs-string"><span class="hljs-string">"--live-caching=100"</span></span>, <span class="hljs-string"><span class="hljs-string">"--network-caching=500"</span></span>, }; mpf = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MediaPlayerFactory(args); videoSurface = mpf.newVideoSurface(canvas); MediaPlayer = mpf.newEmbeddedMediaPlayer(); MediaPlayer.setVideoSurface(videoSurface); contentPane.add(canvas, BorderLayout.CENTER); frame.setContentPane(contentPane); frame.setVisible(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String mrl)</span></span></span><span class="hljs-function"> </span></span>{ MediaPlayer.playMedia(mrl); } }</code> </pre><br>  Jetzt können Sie die Videoübertragung in mein Robotersteuerungsprogramm integrieren, in dem ich Videos in Teilen übertragen habe.  Und ich muss sagen, der Code wurde stark vereinfacht und die Qualität um eine Größenordnung verbessert.  Zusätzlich zu allem, was zum Videostream gehört, können wir Messwerte übertragen <br><br>  Beschleunigungsmesser <br>  Gyroskope <br>  Beleuchtungsstärke <br>  Luftdruck <br>  Kompassablesungen <br>  Temperatur <br>  und sogar Feuchtigkeit <br><br>  Vorausgesetzt natürlich, dass alle diese Sensoren auf Ihrem Smartphone verfügbar sind. <br><br>  Und sogar den Scheinwerfer einschalten!  Automatisch!  Wenn die Beleuchtungsstärke sinkt. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/1QDQQyOn6jw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Kaum jemand ist besonders interessiert, aber im Falle eines Links zu einem Github: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">für Wagen</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">für Smartphone</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de473840/">https://habr.com/ru/post/de473840/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de473826/index.html">OTP-Authentifizierung auf dem Apache-Webserver</a></li>
<li><a href="../de473828/index.html">Computer Vision als Alternative zu Büroausweisen</a></li>
<li><a href="../de473832/index.html">ShIoTiny: Updates und Benachrichtigungen</a></li>
<li><a href="../de473834/index.html">Blackbox-Überwachung in Clos-Netzwerken. Yandex-Bericht</a></li>
<li><a href="../de473838/index.html">DJI Mavic Mini: der leichteste zusammenklappbare Quadrocopter</a></li>
<li><a href="../de473842/index.html">Oktober Maschinelles Lernen und künstliche Intelligenz News Digest</a></li>
<li><a href="../de473844/index.html">Warum brauchen wir Bereiche von C ++ 20 in einem einfachen Brecher?</a></li>
<li><a href="../de473846/index.html">So messen Sie die Leistung von Blockchain-Netzwerken. Schlüsselkennzahlen</a></li>
<li><a href="../de473848/index.html">c.tech auf HighLoad ++ 2019</a></li>
<li><a href="../de473852/index.html">Vor- und Nachteile der Nachtarbeit</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>