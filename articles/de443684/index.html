<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÖüèæ üë©üèª‚Äç‚úàÔ∏è ‚Ü™Ô∏è Eine vollst√§ndige Liste der Unterschiede zwischen VB.NET und C #. Teil 1 üßúüèΩ üè† üßöüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Laut dem TIOBE- Rating von 2018 hat VB.NET die Popularit√§t von C # √ºbertroffen. Zufall oder nicht, aber im Februar forderte Eric Lippert, einer der Sc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Eine vollst√§ndige Liste der Unterschiede zwischen VB.NET und C #. Teil 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/443684/"><img src="https://habrastorage.org/webt/lv/zu/ex/lvzuexv-rlsyr8aeycle0f9r--4.png" alt="Bild"><br><br>  Laut <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dem</a> TIOBE- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Rating</a> von 2018 hat VB.NET die Popularit√§t von C # √ºbertroffen.  Zufall oder nicht, aber im Februar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">forderte</a> Eric Lippert, einer der Sch√∂pfer von C #, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">die</a> Leser auf, auf den Blog seines Freundes, eines ehemaligen Teamkollegen des Roslyn-Compilers und in Kombination eines begeisterten VB.NET-Fans, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Anthony Green</a> , zu achten.  "Solche Ressourcen sind detaillierte Details von Experten, die beim Lesen der Dokumentation nicht so leicht zu finden sind", schreibt Eric.  Wir pr√§sentieren Ihnen den ersten Teil der √úbersetzung von Anthony Green's Artikel "Eine vollst√§ndige Liste der Unterschiede zwischen VB.NET und C #".  Vielleicht liegt genau in diesen Unterschieden das Geheimnis der Dynamik der Bewertung dieser Sprachen. <br><a name="habracut"></a><br>  Fast die H√§lfte meines Lebens habe ich unz√§hlige Diskussionen dar√ºber miterlebt und daran teilgenommen, wie √§hnlich oder unterschiedlich die beiden beliebtesten .NET-Sprachen sind.  Zuerst als Amateur, dann als Profi und schlie√ülich als Kundenanwalt, Programmmanager und Sprachdesigner kann ich ohne √úbertreibung sagen, wie oft ich so etwas geh√∂rt oder gelesen habe: <br><blockquote>  <i>"... VB.NET ist wirklich nur eine d√ºnne Schicht auf IL, wie C # ..."</i> </blockquote>  oder <blockquote>  <i>"... VB.NET ist eigentlich nur C # ohne Semikolons ..."</i> </blockquote> Als ob die Sprachen eine XML-Konvertierung oder ein Stylesheet w√§ren. <br><br>  Und wenn ein begeisterter Besucher dies nicht in einen Kommentar schreibt, wird dies h√§ufig in Fragen wie <i>‚ÄûHallo, Anthony!</i>  <i>Ich bin an einem einzigen Ort auf einen so kleinen Unterschied gesto√üen - ist das ein Fehler?</i>  <i>Wie k√∂nnten sich diese beiden ansonsten identischen Sprachen, die im Namen aller Guten und Heiligen dieser Welt identisch sein sollten, an diesem einen Ort zerstreuen?</i>  <i>Warum brauchen wir solche Ungerechtigkeit ?!</i> <br><br>  " <b>Getrennt</b> ", als w√§ren sie bis zu einer Mutation gleich und w√ºrden <i>dann</i> zu getrennten Arten.  Hah! <br><br>  Aber das verstehe ich.  Bevor ich zu Microsoft kam, habe ich mich vielleicht auch vage an diese Idee gehalten und sie als Argument verwendet, um auf Gegner zu reagieren oder jemanden zu beruhigen.  Ich verstehe ihren Charme.  Es ist leicht zu verstehen und sehr leicht zu wiederholen.  Aber als ich 5 Jahre lang an Roslyn arbeitete (VB und C # komplett neu geschrieben), wurde mir klar, wie <b>eindeutig falsch diese Idee ist</b> .  Ich habe mit einem Team von Entwicklern und Testern zusammengearbeitet, um jeden Zentimeter beider Sprachen sowie deren Tools in einer riesigen Multiprojektl√∂sung mit Millionen von Codezeilen, die in beiden Sprachen geschrieben sind, neu zu implementieren.  Angesichts der gro√üen Anzahl von Entwicklern, die zwischen ihnen hin und her wechseln, der hohen Kompatibilit√§t mit den Ergebnissen und Erfahrungen fr√ºherer Versionen sowie der Notwendigkeit, das gigantische API-Volumen zuverl√§ssig und detailliert zu reproduzieren, musste ich die Unterschiede sehr genau kennenlernen.  Tats√§chlich schien es mir manchmal, dass ich jeden Tag etwas Neues √ºber VB.NET (meine Lieblingssprache) gelernt habe. <br><br>  Und schlie√ülich nahm ich mir die Zeit, mich hinzusetzen und ein Teil dessen, was ich in den letzten 15 Jahren mit VB.NET gelernt und erstellt habe, aus dem Gehirn zu entfernen, in der Hoffnung, dass ich beim n√§chsten Mal zumindest meine Zeit sparen kann. <br><br>  Bevor ich zur Liste √ºbergehe, werde ich die Grundregeln skizzieren: <br><br><ul><li>  Diese Liste ist im √ºblichen Sinne nicht vollst√§ndig.  Er ist ersch√∂pfend.  Dies sind nicht alle Unterschiede.  Dies sind nicht einmal alle Unterschiede, die ich allgemein kenne.  Dies sind nur die Unterschiede, an die ich mich zuerst erinnern kann, bis ich zu m√ºde werde, um fortzufahren.  bis mir die Kraft ausgeht.  Wenn ich oder einer von Ihnen auf andere Unterschiede st√∂√üt oder sich daran erinnert, werde ich diese Liste gerne aktualisieren. </li><li>  Ich werde am Anfang der VB 11-Spezifikation beginnen und mich anhand des Inhalts nach unten bewegen, um mich an die Unterschiede zu erinnern, die mir bei diesem Thema zuerst einfallen. </li><li>  <b>Dies ist KEINE Liste von Funktionen in VB, die nicht in C # enthalten sind.</b>  Also keine "XML-Literale versus Zeiger".  Dies ist zu allt√§glich, und es gibt bereits Unmengen solcher Listen im Internet (von denen einige von mir geschrieben wurden, und vielleicht werde ich in Zukunft mehr schreiben).  Ich werde mich haupts√§chlich auf Konstruktionen konzentrieren, die in beiden Sprachen ein Analogon haben und bei denen ein nicht informierter Beobachter vorschlagen kann, dass sich diese beiden Dinge gleich verhalten, bei denen es jedoch kleine oder gro√üe Unterschiede gibt.  Sie sehen zwar gleich aus, funktionieren jedoch anders oder generieren letztendlich unterschiedlichen Code. </li><li>  <b>Dies ist KEINE Liste syntaktischer Unterschiede zwischen VB und C #</b> (die unz√§hlig sind).  Ich werde haupts√§chlich √ºber semantische Unterschiede sprechen (was Dinge bedeuten) und nicht √ºber syntaktische Unterschiede (wie Dinge geschrieben werden).  Also keine Teile wie "VB startet Kommentare mit 'und C # verwendet //" oder "in C # _ ist eine g√ºltige Kennung, aber nicht in VB".  Aber ich werde diese Regel in mehreren F√§llen brechen.  Schlie√ülich geht es im ersten Abschnitt der Spezifikation um lexikalische Regeln. </li><li>  Sehr oft werde ich Beispiele nennen und manchmal begr√ºnden, warum Design in die eine oder andere Richtung gehen k√∂nnte.  Einige Designentscheidungen wurden vor meinen Augen getroffen, aber die √ºberwiegende Mehrheit ging meiner Zeit voraus, und ich kann nur raten, warum sie getroffen wurden. </li><li>  Bitte hinterlassen Sie einen Kommentar oder twittern Sie mich ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">@ThatVBGuy</a> ), um mir Ihre Lieblingsunterschiede und / oder diejenigen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">mitzuteilen</a> , √ºber die Sie mehr wissen m√∂chten. </li></ul><br>  Erwartungen definiert und ohne weitere Verz√∂gerungen ... <br><br><h2>  Inhalt </h2><br><div class="spoiler">  <b class="spoiler_title">Versteckter Text</b> <div class="spoiler_text"><h4>  Syntax und Vorverarbeitung </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">1. VB-Schl√ºsselw√∂rter und -Operatoren k√∂nnen Zeichen in voller Breite verwenden</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">2. VB unterst√ºtzt intelligente Anf√ºhrungszeichen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">3. Die Vorverarbeitungskonstanten k√∂nnen von einem beliebigen primitiven Typ (einschlie√ülich Datumsangaben) sein und einen beliebigen konstanten Wert enthalten</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">4. Arithmetische Operatoren k√∂nnen zur Vorverarbeitung von Ausdr√ºcken verwendet werden</a> </li></ul><br><h4>  Ank√ºndigungen usw. </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">5. VB √ºberspringt manchmal Deklarationen von Implementierungen in IL, um eine versehentliche implizite Implementierung einer Schnittstelle nach Namen zu verhindern</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">6. VB verbirgt standardm√§√üig Mitglieder der Basisklasse nach Namen (Shadows) und nicht nach Name und Signatur (Overloads).</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">7. VB11 und niedriger sind f√ºr gesch√ºtzte Mitglieder in Generika strenger</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">8. Die Syntax "Named argument" in Attributen initialisiert immer Eigenschaften / Felder</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">9. Alle Deklarationen der obersten Ebene befinden sich (normalerweise) implizit im Stammnamensraum des Projekts.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">10. Module werden in IL nicht als versiegelte abstrakte Klassen generiert, sodass sie nicht genau wie statische C # -Klassen aussehen und umgekehrt</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">11. Sie ben√∂tigen keine explizite Methode f√ºr den Einstiegspunkt (Sub Main) in WinForms-Anwendungen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">12. Wenn Sie einige √§ltere VB-Laufzeitmethoden aufrufen (z. B. FileOpen), wird die aufrufende Methode implizit mit einem Attribut gekennzeichnet, um das Inlining aus Gr√ºnden der Korrektheit zu deaktivieren</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">13. Wenn Ihr Typ mit dem DesignerGenerated-Attribut markiert ist und keine expliziten Konstruktordeklarationen enth√§lt, ruft der standardm√§√üig generierte Compiler InitializeComponent auf, wenn er f√ºr diesen Typ definiert ist.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">14. Das Fehlen des Modifikators Partial bedeutet NICHT, dass der Typ nicht partiell ist</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">15. In Standardklassen gilt die √∂ffentliche Zugriffsebene f√ºr alles au√üer Feldern und in √∂ffentlichen Strukturen auch f√ºr Felder</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">16. VB initialisiert die Felder NACH dem Aufruf des Basiskonstruktors, w√§hrend C # sie initialisiert, BEVOR der Basiskonstruktor aufgerufen wird</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">17. Das implizit deklarierte Sicherungsfeld von VB-Ereignissen hat einen anderen Namen als in C # und ist √ºber den Namen zug√§nglich</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">18. Das implizit deklarierte Hilfsfeld der VB-Autoeigenschaften hat einen gemeinsamen Namen und ist unter diesem Namen zug√§nglich</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">19. Das implizit deklarierte schreibgesch√ºtzte Hilfsfeld der automatischen Eigenschaften erm√∂glicht das Schreiben</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">20. Ereignisattribute werden manchmal auf ein Hilfsereignisfeld angewendet</a> </li></ul><br><h4>  Anleitung </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">21. Der Geltungsbereich des Etiketts ist der Hauptteil der gesamten Methode, die es enth√§lt.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sie k√∂nnen in Bl√∂cke springen (nicht alle)</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">22. Die Lebensdauer eines Bereichs einer lokalen Variablen &lt;&gt;</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">23. Variablen werden immer auf den Standardwert f√ºr den entsprechenden Typ initialisiert.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">24. RaiseEvent l√∂st KEINE Ausnahme aus, wenn das Hilfsfeld null ist</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">25. Aufgaben sind nicht immer gleich;</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Manchmal f√ºhrt eine Referenztypzuweisung einen flachen Klon durch</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">26. Select Case unterst√ºtzt kein Fall-Through.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Keine Pause erforderlich</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">27. Jeder Case-Block hat seinen eigenen G√ºltigkeitsbereich</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">28, 29, 30. Select Case funktioniert mit nicht primitiven Typen, kann beliebige nicht konstante Ausdr√ºcke in Pr√ºfungen verwenden und verwendet standardm√§√üig den Operator =</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">31. In Schleifen deklarierte Variablen behalten in irgendeiner Weise ihre Bedeutung zwischen den Iterationen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">32. Drei For-Schleifenausdr√ºcke werden am Anfang der Schleife nur einmal ausgewertet.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">33. F√ºr jede Schleife in VB kann die GetEnumerator-Erweiterungsmethode verwendet werden</a> </li></ul></div></div><br><h2>  Syntax und Vorverarbeitung </h2><br><a name="section1"></a><h3>  1. VB-Schl√ºsselw√∂rter und -Operatoren k√∂nnen Zeichen in voller Breite verwenden </h3><br>  Einige Sprachen (ich wei√ü nicht genau, wie viele, aber zumindest in einigen Formen von Chinesisch, Japanisch und Koreanisch) verwenden Zeichen in voller Breite.  Kurz gesagt bedeutet dies, dass bei Verwendung einer Monospace-Schriftart (wie die meisten Programmierer) das chinesische Schriftzeichen doppelt so viel horizontalen Platz einnimmt wie die lateinischen Schriftzeichen, die wir im Westen gesehen haben.  Zum Beispiel: <br><br><img src="https://habrastorage.org/webt/wl/j8/0u/wlj80uri5nr810dqgpwymj5eru0.png"><br><br>  Hier habe ich eine Variablendeklaration in Japanisch und eine Initialisierung mit einer Zeichenfolge, die ebenfalls in Japanisch geschrieben ist.  Laut dem Bing-√úbersetzer hei√üt die Variable "Begr√º√üung" und in der Zeile steht "Hallo Welt!"  Der Variablenname auf Japanisch ist nur 2 Zeichen lang, nimmt jedoch den Platz von 4 Zeichen halber Breite ein, den meine Tastatur normalerweise ausgibt, wie der erste Kommentar zeigt.  Es gibt Versionen von Zahlen in voller Breite und alle anderen gedruckten ASCII-Zeichen, die dieselbe Breite wie japanische haben.  Um dies zu demonstrieren, schrieb ich einen zweiten Kommentar mit den Zahlen ‚Äû1‚Äú und ‚Äû2‚Äú in voller Breite.  Dies sind nicht solche "1" und "2" wie im ersten Kommentar.  Zwischen den Zahlen stehen keine Leerzeichen.  Sie k√∂nnen auch sehen, dass die Gr√∂√üe der Zeichen nicht genau 2 Zeichen breit ist, es gibt einen leichten Versatz.  Dies liegt zum Teil daran, dass dieses Programm Zeichen voller und halber Breite in einer Zeile und in allen drei Zeilen mischt. <br><br>  Leerzeichen haben die halbe Breite, alphanumerische Zeichen die volle Breite.  Wir sind keine Programmierer, es sei denn, wir sind von der Textausrichtung besessen.  Und es scheint mir, dass diese geringf√ºgigen Ausrichtungsfehler √§rgerlich sind, wenn Sie Chinesisch, Japanisch oder Koreanisch sind (oder jemand anderes, der Zeichen in voller Gr√∂√üe f√ºr seine Sprache verwendet) und Bezeichner oder Zeichenfolgen verwenden, die in ihrer Muttersprache geschrieben sind. <br><br>  Soweit ich wei√ü, ist es je nach japanischer Tastatur einfach, zwischen Hieroglyphen und Latein zu wechseln. Es ist jedoch vorzuziehen, lateinische Zeichen in voller Breite zu verwenden.  VB unterst√ºtzt dies in Schl√ºsselw√∂rtern, Leerzeichen, Operatoren und sogar Anf√ºhrungszeichen.  Das alles kann also so geschrieben werden: <br><br><img src="https://habrastorage.org/webt/me/mq/ph/memqph465sxyx_tvxov6fglrjfw.png"><br><br>  Wie Sie sehen k√∂nnen, verwenden in dieser Version Schl√ºsselw√∂rter, Leerzeichen, Kommentare, Operatoren und sogar Anf√ºhrungszeichen ihre Vollversionen.  Ins Chaos brachte Ordnung. <br><br>  Ja  Die Japaner benutzen VB.  Trotz der Syntax √§hnlich der englischen Sprache (und vielleicht deshalb) ist Englisch f√ºr die meisten VB-Benutzer, die ich in den Foren sehe, nicht die Hauptsprache.  W√§hrend meiner Arbeit bei Microsoft traf ich mehrmals den japanischen VB MVP, von denen mindestens einer st√§ndig japanische S√º√üigkeiten mitbrachte.  Wenn Sie ein VB-Programmierer aus China, Japan oder Korea sind (oder aus einem anderen Land, das Zeichen in voller Breite verwendet), schreiben Sie bitte in die Kommentare.  (In den Kommentaren an den Autor haben sie geschrieben, dass die Japaner √ºberall im Code versuchen, ASCII zu verwenden - <i>ca. Per.</i> ) <br><br>  <i><b>Lustiger Moment:</b> Als ich anf√§nglich interpolierte Linien in VB implementierte, habe ich (zu meiner Schande) die M√∂glichkeit von geschweiften Klammern in voller Breite an den Substitutionsstellen nicht ber√ºcksichtigt.</i>  <i>Vladimir Reshetnikov ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">@vreshetnikov</a> ) entdeckte und korrigierte diesen Fehler, so dass die gro√üe Tradition der VB-Toleranz f√ºr Zeichenbreiten weiterhin g√ºltig war.</i> <br><br><a name="section2"></a><h3>  2. VB unterst√ºtzt intelligente Anf√ºhrungszeichen </h3><br>  Okay, das ist nat√ºrlich eine Kleinigkeit, aber erw√§hnenswert.  Haben Sie jemals Beispielcode in einem Textdokument wie diesem gesehen: <br><br><img src="https://habrastorage.org/webt/ls/8l/qc/ls8lqckokgku3b0raqiboefn9bc.png"><br><br>  Und nachdem Sie das Beispiel in Ihren Code kopiert haben, haben Sie festgestellt, dass keines der (hervorgehobenen) Anf√ºhrungszeichen funktioniert hat, weil Word alle √ºblichen ASCII-Anf√ºhrungszeichen durch <code>‚Äú</code> intelligente Anf√ºhrungszeichen <code>‚Äù</code> ? <br><br>  Ich nicht.  Okay, ich hatte es, aber nur, als ich die Beispiele nach C # kopierte.  In VB sind intelligente Anf√ºhrungszeichen g√ºltige Trennzeichen f√ºr Zeichenfolgen (es ist lustig, dass die russischen Anf√ºhrungszeichen <code>¬´¬ª</code> nicht funktionieren - ca. Per.): <br><br><img src="https://habrastorage.org/webt/l0/yk/wi/l0ykwi3ebeigkgrkkrzq8lfrwhm.png"><br><br>  Sie arbeiten auch in Saiten, wenn auch vielleicht auf seltsame Weise.  Wenn Sie die cleveren Anf√ºhrungszeichen f√ºr die Flucht verdoppeln, erhalten Sie zur Laufzeit nur das einfache (‚Äûdumme‚Äú) Anf√ºhrungszeichen.  Dies mag etwas seltsam erscheinen, ist aber dennoch sehr praktisch, da fast √ºberall in der Zeichenfolge intelligente Anf√ºhrungszeichen zul√§ssig sind.  Der Compiler l√§sst Sie mit Sicherheit NICHT mit einem intelligenten Zitat enden oder das richtige verwenden, wenn Sie mit einem intelligenten Zitat begonnen haben, sodass Sie es ohne Sorgen verwechseln k√∂nnen.  Und ja, dies funktioniert auch mit dem einfachen Anf√ºhrungszeichen, das f√ºr Kommentare verwendet wird: <br><br><img src="https://habrastorage.org/webt/4y/9j/8n/4y9j8n7mexmkyvtx_vmj-jesfak.png"><br><br>  Ich habe versucht, Paul Wick ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">@panopticoncntrl</a> ) dazu zu bringen, zuzugeben, dass er dies nur getan hat, weil er bei der Arbeit an der Spezifikation mit diesem Problem gequ√§lt wurde, aber er bestreitet jede Schuld.  Dies war in VB6 nicht der Fall, daher f√ºgte dies sp√§ter jemand hinzu. <br><br><a name="section3"></a><h3>  3. Die Vorverarbeitungskonstanten k√∂nnen von einem beliebigen primitiven Typ (einschlie√ülich Datumsangaben) sein und einen beliebigen konstanten Wert enthalten </h3><br><p><img src="https://habrastorage.org/webt/sd/0f/jv/sd0fjva0vsarlwmx7vgwn8yf8xq.png"></p><br><a name="section4"></a><h3>  4. Arithmetische Operatoren k√∂nnen zur Vorverarbeitung von Ausdr√ºcken verwendet werden </h3><br><p><img src="https://habrastorage.org/webt/hx/cw/0k/hxcw0k25imfieuvg_ncshwbizim.png"></p><br><br><h2>  Ank√ºndigungen usw. </h2><br><a name="section5"></a><h3>  5. VB √ºberspringt manchmal IL implementiert Implementierungen, um eine versehentliche implizite Implementierung einer Schnittstelle nach Namen zu verhindern. </h3><br>  Dieser Artikel geh√∂rt zur Kategorie der Esoterik.  In VB erfolgt die Implementierung einer Schnittstelle immer explizit.  Es stellt sich jedoch heraus, dass in Ermangelung einer expliziten Implementierung das Standardverhalten der CLR beim Aufrufen einer Schnittstellenmethode darin besteht, nach √∂ffentlichen Methoden nach Name und Signatur zu suchen.  In den meisten F√§llen ist dies normal, da Sie in VB <i>normalerweise</i> f√ºr jedes Mitglied der von Ihnen implementierten Schnittstelle eine Implementierung bereitstellen m√ºssen, mit Ausnahme eines Falls: <br><br><pre> <code class="vbscript hljs">Interface IFoo <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Bar() <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Baz() <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Interface <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Foo Implements IFoo <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Bar() Implements IFoo.Bar <span class="hljs-keyword"><span class="hljs-keyword">Exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> IFoo_Baz() Implements IFoo.Baz <span class="hljs-keyword"><span class="hljs-keyword">Exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> FooDerived Inherits Foo Implements IFoo <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Bar() Implements IFoo.Bar <span class="hljs-keyword"><span class="hljs-keyword">Exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Baz() <span class="hljs-comment"><span class="hljs-comment">' Does something unrelated to what an IFoo.Baz would do. End Sub End Class</span></span></code> </pre><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gist.github.com/AnthonyDGreen/39634fd98a0cacc093719ab62d7ab1e6#file-partial-re-implementation-vb</a> <br><br>  In diesem Beispiel m√∂chte die <code>FooDerived</code> Klasse <code>FooDerived</code> nur der neuen Methode neu <code>IFoo.Bar</code> , die verbleibenden Implementierungen jedoch unver√§ndert lassen.  Es stellt sich heraus, dass, wenn der Compiler einfach die Implementierungsanweisung f√ºr <code>FooDerived</code> , die CLR auch <code>FooDerived.Baz</code> als neue Implementierung von <code>IFoo.Baz</code> (obwohl es in diesem Beispiel nicht mit <code>IFoo</code> ).  In C # geschieht dies implizit (und ich bin nicht sicher, ob ich es ablehnen kann), aber in VB l√§sst der Compiler 'Implements' in der gesamten Deklaration weg, um dies zu vermeiden, und √ºberschreibt nur bestimmte Mitglieder, die erneut implementiert wurden.  Mit anderen Worten, wenn Sie <code>FooDerived</code> fragen, ob <code>IFoo</code> direkt <code>IFoo</code> wird, wird Nein gesagt: <br><p><img src="https://habrastorage.org/webt/kz/u7/fr/kzu7fr0j1zz4eadll-m5gto7f8q.png"></p><br>  Warum wei√ü ich das und warum ist es wichtig?  Seit vielen Jahren fordern VB-Benutzer Unterst√ºtzung f√ºr die implizite Implementierung einer Schnittstelle (ohne explizite Angabe von <code>Implements</code> in jeder Deklaration), normalerweise f√ºr die Codegenerierung.  Nur dies in die aktuelle Syntax zu integrieren, w√ºrde die √Ñnderung brechen, da <code>FooDerived.Baz</code> jetzt implizit <code>IFoo.Baz</code> implementiert, obwohl dies zuvor noch nicht geschehen ist.  In j√ºngerer Zeit habe ich jedoch mehr √ºber dieses Verhalten erfahren, als ich potenzielle Entwurfsprobleme mit der Funktion "Standardschnittstellenimplementierung" er√∂rtert habe, mit der Schnittstellen Standardimplementierungen einiger Mitglieder enthalten k√∂nnen und nicht in jeder Klasse erneut implementiert werden m√ºssen.  Dies ist beispielsweise bei √úberlastungen hilfreich, wenn die Implementierung wahrscheinlich f√ºr alle Implementierer gleich ist (Delegierung an die Haupt√ºberlastung).  Ein anderes Szenario ist die Versionierung.  Wenn eine Schnittstelle Standardimplementierungen enthalten kann, k√∂nnen Sie neue Mitglieder hinzuf√ºgen, ohne alte Implementierungen zu besch√§digen.  Aber es gibt ein Problem.  Da das Standardverhalten in der CLR darin besteht, nach √∂ffentlichen Implementierungen nach Name und Signatur zu suchen, implementieren die VB-Klasse diese Schnittstellenmitglieder implizit, auch wenn Sie dies vollst√§ndig tun, wenn die VB-Klasse keine Schnittstellenmitglieder mit Standardimplementierungen implementiert, sondern √∂ffentliche Mitglieder mit einem geeigneten Namen und einer geeigneten Signatur soll nicht.  Es gibt Dinge, die Sie tun k√∂nnen, um dies zu umgehen, wenn der vollst√§ndige Satz von Schnittstellenmitgliedern zur Kompilierungszeit bekannt ist.  Falls das Mitglied jedoch nach dem Kompilieren des Codes hinzugef√ºgt wurde, √§ndert es das Verhalten zur Laufzeit nur stillschweigend. <br><br><a name="section6"></a><h3>  6. VB verbirgt standardm√§√üig Mitglieder der Basisklasse nach Namen (Shadows) und nicht nach Name und Signatur (Overloads). </h3><br>  Ich denke, dieser Unterschied ist ziemlich bekannt.  Das Szenario lautet wie folgt: Sie erben die Basisklasse ( <code>DomainObject</code> ), m√∂glicherweise au√üerhalb Ihrer Kontrolle, und deklarieren eine Methode mit einem Namen, der im Kontext Ihrer Klasse sinnvoll ist, z. B. <code>Print</code> : <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> DomainObject <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Invoice Inherits DomainObject <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Print(copies As Integer) <span class="hljs-comment"><span class="hljs-comment">' Sends contents of invoice to default printer. End Sub End Class</span></span></code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gist.github.com/AnthonyDGreen/863cfd1e7536fe8bda7cd145795eaf9f#file-shadows-example-vb</a> <br><br>  Die Tatsache, dass eine Rechnung gedruckt werden kann, ist sinnvoll.  In der n√§chsten Version der API, in der Ihre Basisklasse deklariert ist, entscheiden sie sich f√ºr das Debuggen, um allen DomainObjects eine Methode hinzuzuf√ºgen, die den vollst√§ndigen Inhalt des Objekts im Debug-Fenster anzeigt.  Diese Methode wird hervorragend als Drucken bezeichnet.  Das Problem besteht darin, dass der Client Ihrer API m√∂glicherweise feststellt, dass das Invoice-Objekt √ºber <code>Print()</code> und <code>Print(Integer)</code> -Methoden verf√ºgt, und dass dies verwandte √úberladungen sind.  Vielleicht druckt der erste nur eine Kopie.  Dies ist jedoch keineswegs das, was Sie als Rechnungsautor gedacht haben.  Sie hatten keine Ahnung, dass <code>DomainObject.Print</code> .  Ja, das funktioniert in VB nicht.  Wenn diese Situation auftritt, wird eine Warnung angezeigt. Noch wichtiger ist jedoch, dass das Standardverhalten in VB darin besteht, sich nach Namen auszublenden.  Das hei√üt, bis Sie mit dem Schl√ºsselwort <code>Overloads</code> explizit angeben, dass Ihr <code>Print</code> eine √úberladung von <code>Print</code> Basisklasse ist, werden ein Mitglied der Basisklasse (und alle √úberladungen davon) vollst√§ndig ausgeblendet.  Nur die API, die Sie urspr√ºnglich deklariert haben, wird Ihren Klassenclients angezeigt.  Dies funktioniert standardm√§√üig, Sie k√∂nnen dies jedoch explizit √ºber das Schl√ºsselwort Shadows tun.  C # kann nur <code>Overloads</code> (obwohl es <code>Shadows</code> ber√ºcksichtigt, wenn es auf eine VB-Bibliothek verweist) und dies standardm√§√üig (unter Verwendung des <code>new</code> Schl√ºsselworts).  Dieser Unterschied tritt jedoch von Zeit zu Zeit auf, wenn einige Vererbungshierarchien in Projekten angezeigt werden, in denen eine Klasse in einer Sprache und eine andere in einer anderen definiert ist, und es √ºberladene Methoden gibt, die jedoch den Rahmen des aktuellen Elements in der Liste der Unterschiede sprengen. <br><br><a name="section7"></a><h3>  7. VB11 und niedriger sind f√ºr gesch√ºtzte Mitglieder in Generika strenger </h3><br>  Tats√§chlich haben wir dies zwischen VS2013 und VS2015 ge√§ndert.  Insbesondere haben wir uns entschlossen, uns nicht um die Neuimplementierung zu k√ºmmern.  Aber ich schreibe diese Unterscheidung, falls Sie die alte Version verwenden und es bemerken.  Kurz gesagt: Wenn ein gesch√ºtztes Mitglied im generischen Typ deklariert ist, kann der Erbe, der auch generisch ist, nur √ºber die geerbte Instanz mit denselben Typargumenten auf dieses gesch√ºtzte Mitglied zugreifen. <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Base(Of T) Protected x As T <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Derived</span></span>(Of T) Inherits Base(Of T) <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> F(y As <span class="hljs-built_in"><span class="hljs-built_in">Derived</span></span>(Of <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>)) <span class="hljs-comment"><span class="hljs-comment">' Error: Derived(Of T) cannot access Derived(Of String)'s ' protected members yx = "a" End Sub End Class</span></span></code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gist.github.com/AnthonyDGreen/ce12ac986219eb51d6c85fa02c339a2f#file-protected-in-generics-vb</a> <br><br><a name="section8"></a><h3>  8. Die Syntax "Named argument" in Attributen initialisiert immer Eigenschaften / Felder </h3><br>  VB verwendet dieselbe Syntax <code>:=</code> zum Initialisieren von Attributeigenschaften / -feldern wie zum √úbergeben von Methodenargumenten nach Namen.  Daher gibt es keine M√∂glichkeit, ein Argument namentlich an den Attributkonstruktor zu √ºbergeben. <br><br><a name="section9"></a><h3>  9. Alle Deklarationen der obersten Ebene befinden sich (normalerweise) implizit im Stammnamensraum des Projekts </h3><br>  Dieser Unterschied liegt fast in der Kategorie "Erweiterte Funktionen", aber ich habe ihn in die Liste aufgenommen, da er die Bedeutung des Codes √§ndert.  In den Eigenschaften des VB-Projekts befindet sich ein Feld: <br><br><p><img src="https://habrastorage.org/webt/0y/hy/7_/0yhy7_k2xkchvxq70v1duka5z4a.png"></p><br>  Standardm√§√üig ist dies einfach der Name Ihres Projekts zum Zeitpunkt der Erstellung.  Dies ist <b>NICHT</b> dasselbe Feld wie der "Standard-Namespace" in den Eigenschaften eines C # -Projekts.  Der Standard-Namespace legt einfach fest, welcher Code standardm√§√üig neuen Dateien in C # hinzugef√ºgt wird.  Der Root-Namespace in VB bedeutet jedoch, dass, sofern nicht anders angegeben, jede Deklaration der obersten Ebene in diesem Projekt implizit in diesem Namespace enthalten ist.  Aus diesem Grund enthalten VB-Dokumentvorlagen normalerweise keine Namespace-Deklarationen.  Wenn Sie eine Namespace-Deklaration hinzuf√ºgen, wird der Stamm nicht √ºberschrieben, sondern hinzugef√ºgt: <br><br><pre> <code class="vbscript hljs">Namespace Controllers <span class="hljs-comment"><span class="hljs-comment">' Child namespace. End Namespace Namespace Global.Controllers ' Top-level namespace End Namespace</span></span></code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gist.github.com/AnthonyDGreen/fd1e5e3a58aee862a5082e1d2b078084#file-root-namespace-vb</a> <br><br>  Daher deklariert der <code>Controllers</code> Namespace tats√§chlich den <code>VBExamples.Controllers</code> Namespace, es sei denn, Sie <code>VBExamples.Controllers</code> diesen Mechanismus, indem Sie <code>Global</code> explizit im Namespace deklarieren. <br><br>  Dies ist praktisch, da f√ºr jede VB-Datei eine Einr√ºckungsstufe und ein zus√§tzliches Konzept gespeichert werden.  Dies ist besonders n√ºtzlich, wenn Sie eine UWP-Anwendung erstellen (da sich in UWP alles im Namespace befinden muss), und es ist √§u√üerst praktisch, wenn Sie den Namespace der obersten Ebene f√ºr Ihr gesamtes Projekt beispielsweise von einem Codenamen wie Roslyn in √§ndern m√∂chten eine l√§ngere Version wie <code>Microsoft.CodeAnalysis</code> , da Sie nicht jede Datei in der L√∂sung manuell aktualisieren m√ºssen.  Es ist auch wichtig, dies zu ber√ºcksichtigen, wenn Sie mit Codegeneratoren, XAML-Namespaces und dem neuen <code>.vbproj</code> Dateiformat arbeiten. <br><br><a name="section10"></a><h3>  10. Module werden in IL nicht als versiegelte abstrakte Klassen generiert, sodass sie nicht genau wie statische C # -Klassen aussehen und umgekehrt. </h3><br>  Module in VB existierten vor den statischen C # -Klassen, obwohl wir 2010 versucht haben, sie in Bezug auf IL gleich zu machen.  Leider war dies eine bahnbrechende √Ñnderung, da der XML-Serializer (oder m√∂glicherweise eine Bin√§rdatei) f√ºr diese Version von .NET (ich glaube, sie haben ihn behoben) den verschachtelten Typ nicht in einen Typ serialisieren wollte, der nicht erstellt werden konnte (und eine abstrakte Klasse) kann nicht).  Er warf eine Ausnahme. <br><br>  Wir haben dies gefunden, nachdem wir die √Ñnderungen vorgenommen und zur√ºckgesetzt haben, da irgendwo in einem Code der im Modul eingebettete Aufz√§hlungstyp verwendet wurde.  Und da Sie nicht wissen, mit welcher Version des Serializers das kompilierte Programm funktioniert, kann es nie ge√§ndert werden, da es in einer Version der Anwendung funktioniert und in anderen F√§llen Ausnahmen ausl√∂st. <br><br><a name="section11"></a><h3>  11. Sie ben√∂tigen keine explizite Methode f√ºr den Einstiegspunkt (Sub Main) in WinForms-Anwendungen </h3><br>  Wenn Ihr Projekt Form als Startobjekt verwendet und nicht das ‚ÄûApplication Framework‚Äú verwendet (mehr dazu im n√§chsten Beitrag), generiert VB ein <code>Sub Main</code> , das Ihr Startformular erstellt und an <code>Application.Run</code> √ºbergibt, wodurch Sie entweder die gesamte Datei speichern Um diesen Prozess zu verwalten, entweder eine zus√§tzliche Methode in Ihrem <code>Form</code> oder sogar die Notwendigkeit, √ºber dieses Problem nachzudenken. <br><br><a name="section12"></a><h3>  12. Wenn Sie einige veraltete VB-Laufzeitmethoden aufrufen (z. B. FileOpen), wird die aufrufende Methode implizit mit einem Attribut gekennzeichnet, um das Inlining aus Gr√ºnden der Korrektheit zu deaktivieren </h3><br>  Kurz gesagt, Methoden zum Arbeiten mit Dateien im VB6-Stil wie <code>FileOpen</code> auf Kontexten, die f√ºr die Assembly spezifisch sind, in der sich der Code befindet.  Beispielsweise kann Datei 1 ein Protokoll in einem Projekt und eine Konfiguration in einem anderen sein.  Um festzustellen, welche Assembly ausgef√ºhrt wird, wird <code>Assembly.GetCallingAssembly()</code> aufgerufen.  Wenn die JIT Ihre Methode jedoch in den Aufrufer <i>einf√ºgt</i> , wird die VB-Laufzeitmethode aus Sicht des Stapels nicht von Ihrer Methode aufgerufen, sondern vom Aufrufer, der sich m√∂glicherweise in einer anderen Assembly befindet, wodurch Ihr Code auf den internen Status des Aufrufers zugreifen oder diesen verletzen kann Objekt.  Dies ist kein Sicherheitsproblem, da Sie bereits verloren haben, wenn der kompromittierende Code in Ihrem Prozess ausgef√ºhrt wird.  Dies ist eine Frage der Richtigkeit.  Wenn Sie diese Methoden verwenden, deaktiviert der Compiler daher das Inlining. <br><br>  Diese √Ñnderung wurde im letzten Moment im Jahr 2010 vorgenommen, da das x64-JIT beim Inlining / Optimieren des Codes SEHR aggressiv ist. Wir fanden es sehr sp√§t und es war die sicherste Option. <br><br><a name="section13"></a><h3>  13. Wenn Ihr Typ mit dem DesignerGenerated-Attribut markiert ist und keine expliziten Konstruktordeklarationen enth√§lt, ruft der standardm√§√üig generierte Compiler InitializeComponent auf, wenn er f√ºr diesen Typ definiert ist </h3><br>  In der Zeit vor dem Aufkommen von Partial-Typen f√ºhrte das VB-Team einen Krieg, um den Code f√ºr Boilerplates in WinForms-Projekten zu reduzieren.  Aber auch bei <code>Partial</code> dies n√ºtzlich, da die generierte Datei den Konstruktor vollst√§ndig weglassen kann und der Benutzer sie bei Bedarf manuell in seiner Datei deklarieren oder bei Bedarf nicht deklarieren kann.  Ohne dies w√§re der Designer gezwungen, einen Konstruktor hinzuzuf√ºgen, um nur <code>InitializeComponent</code> aufzurufen. Wenn der Benutzer auch hinzuf√ºgt, handelt es sich um Duplikate, oder das Toolkit sollte intelligent genug sein, um den Konstruktor aus der Designer-Datei in die Benutzerdatei zu verschieben und ihn nicht im Designer neu zu generieren, falls er dies bereits getan hat existiert in der Benutzerdatei. <br><br><a name="section14"></a><h3>  14. Das Fehlen des Modifikators Partial bedeutet NICHT, dass der Typ nicht partiell ist </h3><br>  Technisch gesehen sollte in VB nur eine Klasse als Teilweise markiert werden.  Dies ist normalerweise (in GUI-Projekten) eine generierte Datei. <br><br>  <b>Warum?</b>  Dies h√§lt die Benutzerdatei sch√∂n und sauber und kann sehr bequem nach dem Generieren oder Hinzuf√ºgen von benutzerdefiniertem Code zum generierten Code eingef√ºgt werden.  Es wird jedoch empfohlen, dass h√∂chstens eine Klasse keinen Teilmodifikator hat, da sonst eine Warnung ausgegeben wird. <br><br><a name="section15"></a><h3>  15. In Standardklassen gilt die √∂ffentliche Zugriffsebene f√ºr alles au√üer Feldern und in √∂ffentlichen Strukturen auch f√ºr Felder </h3><br>  Ich habe gemischte Gef√ºhle dazu.  In C # ist standardm√§√üig alles <code>private</code> (Prost, Kapselung!). Je nachdem, was Sie h√§ufig deklarieren, gibt es jedoch ein Argument: einen √∂ffentlichen Auftrag oder Details zur Implementierung.  Eigenschaften und Ereignisse sind im Allgemeinen f√ºr die externe ( <code>public</code> ) Verwendung vorgesehen, und auf Bediener kann nur <code>public</code> zugegriffen werden.  Ich verlasse mich jedoch selten auf die Standardzug√§nglichkeit (mit Ausnahme von Demos wie den Beispielen in diesem Artikel). <br><br><a name="section16"></a><h3>  16. VB initialisiert die Felder NACH dem Aufruf des Basiskonstruktors, w√§hrend C # sie initialisiert, BEVOR der Basiskonstruktor aufgerufen wird </h3><br>  Haben Sie geh√∂rt, wie "einige" sagen, dass das erste, was im Konstruktor passiert, ein Aufruf des Konstruktors der Basisklasse ist?  Nun, das ist zumindest in C # nicht der Fall.  In C # werden vor dem expliziten oder impliziten Aufruf von <code>base()</code> die Feldinitialisierer, dann der Konstruktoraufruf und dann Ihr Code ausgef√ºhrt.  Diese Entscheidung hat Konsequenzen, und ich glaube zu wissen, warum Sprachentwickler in die eine oder andere Richtung gehen k√∂nnten.  Ich glaube, eine dieser Konsequenzen ist, dass der folgende Code nicht direkt in C # √ºbersetzt werden kann: <br><br><pre> <code class="vbscript hljs">Imports System.Reflection <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> ReflectionFoo <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> StringType As Type = GetType(<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> StringLengthProperty As PropertyInfo = StringType.GetProperty(<span class="hljs-string"><span class="hljs-string">"Length"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> StringGetEnumeratorMethod As MethodInfo = StringType.GetMethod(<span class="hljs-string"><span class="hljs-string">"GetEnumerator"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> StringEnumeratorType As Type = StringGetEnumeratorMethod.ReturnType <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">New</span></span>() Console.WriteLine(StringType) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span></code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gist.github.com/AnthonyDGreen/37d01c8e7f085e06172bfaf6a1e567d4#file-field-init-me-reference-vb</a> <br><br>  In den Tagen, als ich mit Reflection besch√§ftigt war, habe ich oft solchen Code geschrieben.  Und ich erinnere mich vage an einen Kollegen vor Microsoft (Josh), der meinen Code in C # √ºbersetzt hat und sich manchmal √ºber die Notwendigkeit beschwert, alle meine Initialisierer auf den Konstruktor zu portieren.  In C # ist es verboten, auf ein Objekt zu verweisen, das vor dem Aufruf von <code>base()</code> wird.  Und da die Feldinitialisierer vor dem angegebenen Aufruf ausgef√ºhrt werden, k√∂nnen sie auch nicht auf andere Felder oder Mitglieder der Objektinstanz verweisen.  Dieses Beispiel funktioniert also auch nur in VB: <br><br><pre> <code class="vbscript hljs">MustInherit <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Base <span class="hljs-comment"><span class="hljs-comment">' OOP OP? Private Cached As Object = DerivedFactory() Protected MustOverride Function DerivedFactory() As Object End Class Class Derived Inherits Base Protected Overrides Function DerivedFactory() As Object Return New Object() End Function End Class</span></span></code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gist.github.com/AnthonyDGreen/fe5ca89e5a98efee97ffee93aa684e50#file-base-derived-init-vb</a> <br><br>  Hier haben wir eine Basisklasse, die angeblich viele Funktionen hat, aber ein Schl√ºsselobjekt f√ºr die Verwaltung ben√∂tigt, die Arbeit, die vom abgeleiteten Typ bestimmt wird.  Es gibt viele M√∂glichkeiten, eine solche Vorlage zu implementieren, aber ich verwende diese normalerweise, weil: <br><br><ul><li>  er ist klein; </li><li>  verlangt nicht, dass ich einen Konstruktor deklariere; </li><li>  Ich muss den Initialisierungscode nicht in den Konstruktor einf√ºgen, falls vorhanden. </li><li>  Erm√∂glicht mir das Zwischenspeichern des erstellten Objekts und erfordert keine abgeleiteten Typen zum Deklarieren und Verwalten des Speichers f√ºr das bereitgestellte Objekt, obwohl dies jetzt kein solches Problem mit automatischen Eigenschaften ist. </li></ul><br>  Au√üerdem war ich in beiden Situationen: Wenn ein Feld in einem abgeleiteten Typ eine in der Basisklasse deklarierte Methode aufrufen wollte und wenn der <code>MustOverride</code> das vom abgeleiteten Typ implementierte <code>MustOverride</code> Mitglied aufrufen <code>MustOverride</code> .  Beide sind in VB g√ºltig und keine in C #, und das ist sinnvoll.  Wenn der C # -Feldinitialisierer ein Mitglied der Basisklasse aufrufen k√∂nnte, k√∂nnte dieses Mitglied von den Feldern abh√§ngen, die im Basiskonstruktor initialisiert wurden (der noch nicht ausgef√ºhrt wird), und die Ergebnisse w√§ren mit ziemlicher Sicherheit falsch, und daran f√ºhrte kein Weg vorbei. <br><br>  Aber in VB hat der Basiskonstruktor bereits funktioniert, sodass Sie alles tun k√∂nnen!  Im umgekehrten <code>Overridable</code> ist alles etwas komplizierter, da das Aufrufen des <code>Overridable</code> vom Initialisierer (oder Konstruktor) der Basisklasse zum Zugriff auf die Felder f√ºhren kann, bevor sie "initialisiert" werden.  Aber nur Ihre Implementierung wei√ü, ob dies ein Problem ist.  In meinen Skripten passiert das einfach nicht.  Sie h√§ngen nicht vom Status der Instanz ab, k√∂nnen jedoch keine <code>Shared Overridable</code> Mitglieder sein, da Sie aus technischen Gr√ºnden, die √ºber den Umfang dieses Artikels hinausgehen, kein <code>Shared Overridable</code> Mitglied in einer Sprache haben k√∂nnen.  Dar√ºber hinaus ist klar definiert, was mit den Feldern geschieht, bevor benutzerdefinierte Initialisierer gestartet werden. Sie werden wie alle Variablen in VB mit Standardwerten initialisiert.  Keine √úberraschungen. <br><br>  <b>Warum also?</b>  Eigentlich wei√ü ich nicht, ob meine Skripte das waren, was das urspr√ºngliche VB.NET-Team bei der Entwicklung im Sinn hatte.  In meinem Fall funktioniert es einfach!  ,       :  VB ,         ,       .              .          . <br><br> <i> ,              ,    ,          C#  VB,       ,    VB  ,   C#.</i> <br><br><a name="section17"></a><h3> 17.     (backing field)  VB   ,   C#,     </h3><br>          (       ).        <code>E</code> ,  VB   (  IDE)    <code>EEvent</code> .  C#     <code>E</code> ,     ,   <code>E</code>   ,    . <br><br><a name="section18"></a><h3> 18.      VB         </h3><br>      <code>P</code> ,      <code>_P'</code> .    IntelliSense,      .  C#    ¬´¬ª ( <i>mangled</i> ) ,  ,            C#     . <br><br> <b> ?</b>  VB    , -,             ¬´WithEvents¬ª,  -,     ,   -     ,        . <br><br><a name="section19"></a><h3> 19.     read-only    </h3><br>    ,        ,  ‚Ä¶.   VB     ¬´ ¬ª    .    <code>WithEvents</code> -, non-Custom           ,       ,     .    IntelliSense,      ,     ,  .   FTW!  ,   VB  ,    private set;   C#. <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Alarm <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> ReadOnly Code As Integer ReadOnly <span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> Status As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> = <span class="hljs-string"><span class="hljs-string">"Disarmed"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">New</span></span>(code As Integer) <span class="hljs-keyword"><span class="hljs-keyword">Me</span></span>.Code = code <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Arm() <span class="hljs-comment"><span class="hljs-comment">' I'm motifying the value of this externally read-only property here. _Status = "Armed" End Sub Function Disarm(code As Integer) As Boolean If code = Me.Code Then ' And here. _Status = "Disarmed" Return True Else Return False End If End Function End Class</span></span></code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gist.github.com/AnthonyDGreen/57ce7962700c5498894ad417296f9066#file-read-only-auto-property-backing-field-is-writeable-vb</a> <br><br><a name="section20"></a><h3> 20.         </h3><br>  ,  <code>NonSerialized</code> . <br><br>   VB       (expanded) Custom-  2005  (?) <b></b>       ,         ,  ,   <code>NonSerialized</code> .  ,     ,   ,   ,       ¬´¬ª       ,    ¬´ ¬ª. <br><br>     ,   ,          ,  ,   . , , ,     ,     two-way bindable ( ,   <code>PropertyChanged</code> ),     ,    , , ,    . <br><br>   ,     ,       CLSA ¬´Expert Business Objects¬ª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  (Rocky Lhotka)</a> ,      undo/redo (    ,    ,   - ,  ,     ),       .  ,         .  ,  ,        ,    . <br><br><h2>  Anleitung </h2><br><a name="section21"></a><h3> 21.    ‚Äî    ,  ;      ( ) </h3><br>   ,      <code>GoTo</code>     .   ,        -   . ,       <code>For</code>  <code>For Each</code> ;  <code>Using</code> , <code>SyncLock</code>  <code>With</code> ,   ,     ,        <code>Finally</code> .   <code>If</code>  <code>Select Case</code> ,  <code>Do</code>  <code>While</code> ,    Try ‚Äî    ,        : <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> retryCount = <span class="hljs-number"><span class="hljs-number">0</span></span> Try Retry: <span class="hljs-comment"><span class="hljs-comment">' IO call. Catch ex As IO.IOException When retryCount &lt; 3 retryCount += 1 GoTo Retry End Try End Sub End Module</span></span></code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gist.github.com/AnthonyDGreen/b93adcf3c3705e4768dcab0b05b187a0#file-try-goto-retry-vb</a> <br><br>  ,  ,   ,   .NET  VB      ¬´¬ª.  VB6        Quick Basic  ( )       .      QB,      .     ,       ¬´ ¬ª,           .        GoTo,         ‚Äî   ,        . <br><br> <b></b> :    <code>Try</code>    ,  VB -   <code>await</code>   <code>Catch</code>  <code>Finally</code> ,  ,     <code>GoTo</code>    . <br><br><a name="section22"></a><h3> 22.     &lt;&gt;   </h3><br>    ,  VB   (     )  ( <code>static</code> )        (      ).    ,     .        <code>Catch</code>       3 .      <code>Try</code>      <code>Catch</code> ,      ,   ,       <code>Try</code>     . <br><br>  ,  VB.NET     ,     .       CLR      VB   .      :           ,    . <br><br> <i>, C# ,        ,       ¬´¬ª.   VB.NET     .</i> <br><br><a name="section22"></a><h3> 23.          </h3><br>       ,        ,    C#       ¬´ ¬ª ( <i>definite assignment</i> ).   ,    , ,         ¬´ ¬ª.   ,   ( )           ,   ,          .    C/C++.      , !   ,        .  ,        ,    , ‚Äî  .           ,     ,   ,         ,  ,         ,      ,          ,    .  ,  BASIC   ,          ,      ¬´¬ª ,       <code>= Nothing</code> , <code>= 0</code> , <code>= False</code>  .. <br><br> ,   ( <i>flow analysis</i> )  VB    ,    . <br><br>         ,    C#   ,  ,          ,            . VB    <i></i>  ,       ,        ,       .  Roslyn, , API       ¬´ ¬ª,       ,      . <br><br><a name="section24"></a><h3> 24. RaiseEvent   ,     null </h3><br>     ,  -     C#  VB. <code>RaiseEvent</code>  VB ‚Äî        ,     <code>null</code> ( ),    <code>null</code> - ‚Äî  ,      . <br><br><pre> <code class="vbscript hljs"><span class="hljs-comment"><span class="hljs-comment">' You don't have to write this: If PropertyChangedEvent IsNot Nothing Then RaiseEvent PropertyChanged(Me, e) End If ' You don't have to write this: Dim handlers = PropertyChangedEvent If handlers IsNot Nothing Then handlers(Me, e) End If ' You don't have to write this either: PropertyChangedEvent?(Me, e) ' Just write this: RaiseEvent PropertyChanged(Me, e)</span></span></code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gist.github.com/AnthonyDGreen/c3dea3d91ef4ffc50cfa92c41f967937#file-null-safe-event-raising-vb</a> <br><br> ,    null-conditional   C#  VS2015     C#   ,      VB (  ),       ,     ;   VB.NET    . <br><br><a name="section25"></a><h3> 25.    ;        (shallow clone) </h3><br>     , ,        17 , ,     .     (boxed)      Object,       <code>System.Runtime.CompilerServices.RuntimeHelper.GetObjectValue</code> .   ,   CLR.    ,    : <br><br><ul><li>     ,      . <br></li><li>       ,    (,     Integer ),      . <br></li><li>        ,            . <br></li></ul><br>    ,     ,  ,    ,       ( <i>late-bound situations</i> ). ,        ,     (    )  ,           ,   ,        ,      ( <i>caller's copy</i> ).          ,     ,  - , ‚Äî     . <br><br>          .     : <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> MyEventArgs <span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> Value As Object <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Structure MyStruct <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> X, Y As Integer <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Structure Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> defaultValue As Object = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> MyStruct <span class="hljs-keyword"><span class="hljs-keyword">With</span></span> {.X = <span class="hljs-number"><span class="hljs-number">3</span></span>, .Y = <span class="hljs-number"><span class="hljs-number">5</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> e = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> MyEventArgs <span class="hljs-keyword"><span class="hljs-keyword">With</span></span> {.Value = defaultValue} RaiseEvent DoSomething(<span class="hljs-literal"><span class="hljs-literal">Nothing</span></span>, e) <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> e.Value <span class="hljs-keyword"><span class="hljs-keyword">Is</span></span> defaultValue <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> <span class="hljs-comment"><span class="hljs-comment">' No handlers have changed anything. Console.WriteLine("Unchanged.") End If End Sub Event DoSomething(sender As Object, e As MyEventArgs) End Module</span></span></code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gist.github.com/AnthonyDGreen/422ac4574af92d9bbbf59f0fbc40b74d#file-get-object-value-vb</a> <br><br>      ,     WPF,               .    ,     . ,                     ,        .    ,    .   ,    -   ,  , ,              . <br><br> ,    ,   ¬´ ¬ª         .    IronRuby/Python,    <code>dynamic</code>  C# (  C#): C#    <code>GetObjectValue</code>     .         <code>object.ReferenceEquals</code> ,  ,    ,   <i></i>    -    <code>dynamic</code> C# (     ).       <code>==</code> ,    .   C#,    ,          . <br><br><a name="section26"></a><h3> 26. Select Case   ¬´¬ª (fall-through);   break </h3><br>     Friday    ,  Sunday ‚Äî  ,  5   . <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> Today.DayOfWeek <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Monday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Tuesday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Wednesday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Thursday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Friday: Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Weekday"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Saturday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Sunday: Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Weekend"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gist.github.com/AnthonyDGreen/7b7e136c71dd11b2417a6c7267bb3546#file-select-case-no-fallthrough-vb</a> <br><br>     Roslyn C#  ,  -      : <i>¬´,    ?   !¬ª</i>   <i>¬´,  ¬ª</i> .   . VS    ,    ,   ,    ,      ,     .    ! <br><br>       . C# ,        C,       C.       .  , C#     ,    case   .   -  ,     <code>goto</code> ,  <code>break</code> .     VB   <code>break</code> , <code>Exit Select</code> ,       ,    VB   . <br><br><a name="section27"></a><h3> 27.   Case     </h3><br>      ,      .           C#,   : <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> Today.DayOfWeek <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Monday, DayOfWeek.Tuesday, DayOfWeek.Wednesday, DayOfWeek.Thursday, DayOfWeek.Friday <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> message = <span class="hljs-string"><span class="hljs-string">"Get to work!"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Saturday, DayOfWeek.Sunday <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> message = <span class="hljs-string"><span class="hljs-string">"Funtime!"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gist.github.com/AnthonyDGreen/bd642061896246c9336255881fb78546#file-select-case-scopes-vb</a> <br><br>   ,  <code>message</code>        ,    C#   <code>switch</code>         <code>case</code> ‚Äî   .     . ,  ,  -    (  ,  C):        , , ,  ,     . <br><br><a name="section28to30"></a><h3> 28, 29, 30. Select Case    ,             = </h3><br> ,  ,     ,            ,     <code>Select Case</code>             . <br><br>             ,       ,     .    : <br><br><ul><li> <code>Select Case</code> ‚Äî  ,           , ‚Ä¶ <br></li><li> <code>switch</code> ‚Äî   / ,   ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a>   ¬ª. <br></li></ul><br>  ,    26-30. <code>switch</code>    ,    ,  , ,     <code>if</code> .  IL   <code>switch</code> ,   ,   <code>If</code> ,   VB        ,   .    switch       , ,    C   .  VB    . <br><br><a name="section31"></a><h3> 31. ,   ,         </h3><br>       <code>x</code>    ,      ,      -1, -2, -3: <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> x As Integer x -= <span class="hljs-number"><span class="hljs-number">1</span></span> Console.WriteLine(x) <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gist.github.com/AnthonyDGreen/cbc3a9c70677354973d64f1d993a3c5d#file-loop-variables-retain-their-values-vb</a> <br><br>    <i>¬´     ,    ,    ¬ª</i> ( ).   ,      VB2008  ,    -: <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> lambdas = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> List(Of Action) <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> x As Integer x -= <span class="hljs-number"><span class="hljs-number">1</span></span> lambdas.Add(<span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span>() Console.WriteLine(x)) <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Each</span></span> lambda <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> lambdas lambda() <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gist.github.com/AnthonyDGreen/2ef9ba3dfcf9a1abe0e94b0cde12faf1#file-loop-variables-captured-per-iteration-vb</a> <br><br>     -1, -2, -3.     <code>x</code> ‚Äî ¬´ ¬ª, -   <code>x</code>    ,      .          ,        <code>x</code>     .     flow analysis API ‚Äî ! ( <i>¬´‚Ä¶ ‚Ä¶  ?¬ª</i> ) <br><br>  <b>Warum?</b>   ,  ,      ,    ,      ,        #22.         ,        ,       -,         . <br><br> ,   VB  C#      ( <i>control variables</i> )  <code>For Each</code>  VS2012 (?),  -   ¬´ ¬ª.   10000%    ,    (  , VB      ,      ).  ,    VB         <code>For</code> ,        .            ,      .      ,   VB  <code>For</code>      <code>For Each</code> ,  <code>for</code>  <code>foreach</code>  C#.          ,   <code>For</code>  VB -  ,    ,      . <br><br><a name="section32"></a><h3> 32.    For        </h3><br>         <code>For</code> .        ,   ,       1,3,5,7,9,          ,     . <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> lower = <span class="hljs-number"><span class="hljs-number">1</span></span>, upper = <span class="hljs-number"><span class="hljs-number">9</span></span>, increment = <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> i = lower <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> upper <span class="hljs-keyword"><span class="hljs-keyword">Step</span></span> increment Console.WriteLine(i) upper += <span class="hljs-number"><span class="hljs-number">1</span></span> increment -= <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gist.github.com/AnthonyDGreen/1e48113be204f515c51e221858666ac7#file-for-loop-bounds-cached-vb</a> <br><br>    ,          (       ),   ,     ,    ,          <code>IndexOutOfRangeExceptions</code> ,    . <br><br>   ,   ,      , , ,       C,    VB .  - ,  VB ,  <code>For i = a To b Step c</code>   (  ,  <code>i&gt; b</code> )   (  ,  <code>i &lt;b</code> ),   <code>c</code>    ?    ,    ,      ,   <code>b</code>   ,   ‚Äî .    ,     , , ,       . <br><br><a name="section33"></a><h3> 33. For Each   VB     GetEnumerator </h3><br>       <code>For Each</code> ,     <code>IEnumerable</code> ,       <code>GetEnumerator</code>  ,    <code>For Each</code> . <br> ,   ,     <code>For Each</code>  <code>IEnumerator</code>  ,          , : <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> list = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> List(Of Integer) From {<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> info = list.FirstAndRest() <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> info.First IsNot <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Console.Write(info.First.GetValueOrDefault()) <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Each</span></span> other <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> info.Additional Console.Write(<span class="hljs-string"><span class="hljs-string">", "</span></span>) Console.Write(other) <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> Console.WriteLine() <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> &lt;Runtime.CompilerServices.Extension&gt; <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> FirstAndRest(Of T As Structure)(sequence As IEnumerable(Of T)) As (First As T?, Additional As IEnumerator(Of T)) <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> enumerator = sequence.GetEnumerator() <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> enumerator.MoveNext() <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Return (enumerator.Current, enumerator) <span class="hljs-keyword"><span class="hljs-keyword">Else</span></span> Return (<span class="hljs-literal"><span class="hljs-literal">Nothing</span></span>, enumerator) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> &lt;Runtime.CompilerServices.Extension&gt; <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> GetEnumerator(Of T)(enumerator As IEnumerator(Of T)) As IEnumerator(Of T) Return enumerator <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gist.github.com/AnthonyDGreen/d7dbb7a5b98a940765c4adc33e3eaeee#file-for-each-extension-get-enumerator-vb</a> <br><br>           F#        ,    <code>IEnumerator</code> ,     <code>For Each</code>    ,   . <br><br>  VB   ,            ( <i>well-known name</i> ),      .   , ,   Add,   . C#     ,          (. <code>async</code> / <code>await</code> ).      ,    C# Roslyn ()     ,     . <br><blockquote>  Minute der Werbung. 15-16   -    .NET- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">DotNext 2019 Piter</a> .   ,       .       ,      .     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  </a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a> . </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de443684/">https://habr.com/ru/post/de443684/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de443672/index.html">Risikobasiertes Testen</a></li>
<li><a href="../de443676/index.html">Vinyl statt Briefmarke: ungew√∂hnliche Seltenheit</a></li>
<li><a href="../de443678/index.html">Lesbarkeit des Codes</a></li>
<li><a href="../de443680/index.html">Viert√§gige Arbeitswoche. Russische Erfahrung</a></li>
<li><a href="../de443682/index.html">Monetarisierung der Cloud: Wie man Kunden anzieht und nicht pleite geht</a></li>
<li><a href="../de443686/index.html">30. - 31. M√§rz, SIBUR-HERAUSFORDERUNG in Nischni Nowgorod</a></li>
<li><a href="../de443690/index.html">Parallelen RAS: Was ist das und womit isst es?</a></li>
<li><a href="../de443692/index.html">Alchemie des 21. Jahrhunderts: Umwandlung von fl√ºssigem Metalldeuterium in Plasma</a></li>
<li><a href="../de443694/index.html">Wie der Browser Genosse Major hilft</a></li>
<li><a href="../de443698/index.html">Google hat aufgeh√∂rt, die Gans zu erw√ºrgen: DuckDuckGo ist in der Liste der Standard-Chrome-Suchmaschinen f√ºr 60 L√§nder enthalten</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>