<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📔 👂 🗼 Bagaimana green junior menulis hot-reloader-nya 🤮 🔘 👩🏽‍⚖️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Latar belakang 
 Beberapa baris tentang saya untuk pemahaman umum tentang tingkat penulis dan masalah yang diselesaikan.  Nama saya Eugene dan saya ad...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bagaimana green junior menulis hot-reloader-nya</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466237/"><h3>  Latar belakang </h3><br><div class="spoiler"> <b class="spoiler_title">Beberapa baris tentang saya untuk pemahaman umum tentang tingkat penulis dan masalah yang diselesaikan.</b> <div class="spoiler_text">  Nama saya Eugene dan saya adalah <s>pengembang web</s> frontend green junior developer. <br>  Beberapa tahun yang lalu, saya bekerja di bidang yang sama sekali berbeda dan hanya dalam teori berpikir tentang mengubah profesi saya, tetapi sekitar Desember 2018 saya menemukan jalan saya dan mulai bertindak. <br>  Setelah sekitar enam bulan pelatihan total, saya mendapatkan pekerjaan sebagai programmer frontend.  Saya telah belajar hal-hal mendasar (saya ingin berpikir begitu), js, interaksi dengan DOM, bereaksi + redux.  HTML dan CSS setidaknya + pemahaman umum tentang bootstrap dan assembly, bekerja dengan git, baris perintah. <br>  Selain teori, beberapa proyek pelatihan telah dibuat, termasuk obrolan tentang reaksi + reduks, serta beberapa upaya untuk mengimplementasikan beberapa ide mereka. <br>  Secara umum, standar pria modern ditetapkan untuk front'a pemula. <br>  Satu setengah minggu pertama saya membuat mesin virtual, ada banyak segalanya dan semuanya tidak saya kenal dan tidak bisa dipahami. <br>  Dalam prosesnya, saya berkenalan dengan alat-alat dan teknologi baru: dengan basis data (dan menempatkan sendiri bookmark lain dalam daftar "belajar"), dempul, wincsp, dll. <br>  Berhasil melewati rintangan ini dan pergi ke depan. <br></div></div><br><h3>  Kata Pengantar </h3><br>  Setelah menulis isi ulang saya dan artikel ini, saya menemukan analog, termasuk yang ada di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Habré</a> .  Namun, ia memutuskan untuk menerbitkan sepedanya. <br><br><h3>  Mulai </h3><br>  Kami memiliki proyek yang agak besar, diwariskan, ditulis dalam angularJS, dengan semua daya tariknya.  Setelah Bereaksi, dia tampak seperti dinosaurus bagi saya, tetapi tidak ada, saya membeli kursus sudut, dengan cepat masuk dan mulai mendapat manfaat. <br><br>  Kesan positif adalah bahwa proyek itu ditulis dengan baik, oleh orang-orang dengan lengan lurus yang jelas.  Variabel dengan penamaan yang jelas, strukturnya sama di mana-mana dan secara umum seluruh logikanya sangat mudah diakses dan diungkapkan. <br><br>  Tapi ada cukup banyak kekurangan. <br><a name="habracut"></a><br>  Masalah pertama: proyek sedang dibangun oleh beberapa minimizer kuno, dan tidak mungkin menggunakan sintaks js modern.  Tidak ada () =&gt; {}, const res = [... data, subRes], async / tunggu ... <br><br>  Masalah kedua: tidak ada webpack, atau bahkan setidaknya tegukan, dan karenanya juga tidak ada webpack-dev-server yang akrab bagi saya dengan isi ulang yang sangat baik. <br><br>  Menulis  Disimpan  F5.  Nyaman  Sakit?  Bukan rasa sakit langsung, tetapi sangat tidak nyaman. <br><br>  Masalah ketiga: membangun file .bat proyek, di mana bagian dari proyek hanya disalin, bagian dari perpustakaan dikumpulkan tanpa minimalisasi, sebagian diminimalkan ke dalam satu file, sisa file proyek ke yang lain.  Daftar perpustakaan di file ketiga.  Daftar file untuk membangun di keempat.  Dan sebagainya. <br><br>  Masalah keempat: semua perpustakaan rapi di folder libs dan terhubung oleh skrip di index.html.  Semua-semua, kecuali untuk mengekspresikan dan proksi untuk itu (mereka tidak terlibat dalam majelis, tetapi hanya untuk pengembangan). <br>  Dan jauh dari mana-mana ada versi atau indikasi perpustakaan tertentu. <br><br>  Saya tinggal dalam pelatihan di dunia pemrograman fungsional yang indah, penuh es6 +, webpack-dev-server, tdd, eslint, build otomatis, dan sebagainya. <br><br>  Dan di sini di dunia dewasa, semuanya benar-benar berbeda ... <br><br><h3>  Dasi </h3><br>  Tapi saya suka bekerja, saya menganggap hambatan sebagai peluang untuk pengembangan diri, perusahaan itu bagus, suasananya luar biasa, mata saya terbakar! <br><br>  Dalam jam kerja saya melakukan tugas kerja, di waktu luang saya mencoba meningkatkan sesuatu. <br><br>  Pertengahan Juni, saya mulai dengan upaya untuk mempercepat webpack, tetapi pendekatan pertama mengharapkan kegagalan total.  Saya telah disiksa selama seminggu, saya sangat lelah, untuk sementara ditunda. <br><br>  Saya memutuskan untuk memulai dari yang kecil - saya menghubungkan sintaks baru melalui babel.  Saya menambahkan pemrosesan awal dengan babel ke build.bat magis kami, tetapi ada sesuatu yang merusak idyll dan minificator lama kami tersandung.  Saya mencari masalah. <br><br>  Tersandung pada salah satu perpustakaan dari lib ayah yang rapi.  Saya melihat file perpustakaan: mereka sudah diperkecil dalam sintaks lama. <br><br>  Saya katakan babel - "Anda tidak pergi ke sini ... kepala akan mendapatkan kode, itu akan sangat buruk."  Saya periksa: semuanya berfungsi!  Hore!  Sekarang saya memiliki akses ke semua hal-hal muda trendi gaya baru yang bagus!  Kemenangan pertama.  Bagus  Saya pikir pada kesempatan ini untuk mengganti nama script di e.bat (e-Evgen), tetapi tidak bisa memutuskan. <br><br>  Sintaks baru sangat akrab dan menyenangkan, tetapi pikiran tentang bangunan yang bengkok tidak meninggalkan saya. <br><br>  Akhir Juni dan awal Juli.  Saya melakukan pendekatan kedua, lebih menyeluruh, tetapi sekali lagi saya mengalami kesalahan antara webpack dan angularjs.  Lagi-lagi penelitian seminggu. <br><br>  Setelah saya menghabiskan beberapa hari dan sebagian malam mencari solusi, saya menemukan pidato yang sangat menarik dari konferensi HolyJS, di mana orang-orang sudah menggali cukup dalam ke webpack.  Saya maju dalam pemahamannya, tapi saya masih tidak mengerti materi sampai akhir. <br><br>  Minat menguat. <br><br>  Seorang rekan berkata - lupakan saja, untuk menyerahkan proyek dalam beberapa bulan, tidak perlu lagi melakukan ini. <br>  Saya tidak palu, tapi saya menundanya - banyak pekerjaan, itu meremas saya segalanya, tidak ada waktu tersisa untuk kegiatan ekstrakurikuler. <br><br>  Pertengahan Juli, saya mendapatkan di tangan saya mirip dengan proyek kami dengan membangun disesuaikan.  Saya akan pergi dengannya untuk pendekatan ketiga dan saya praktis membuat webpack dengan kami, tetapi pada akhirnya saya menangkap kesalahan baru yang saya tidak punya cukup waktu untuk menyelesaikannya, pekerjaan berputar dengan intensitas baru + secara mental menghancurkan saya, saya menunda bisnis ini lagi. <br><br><h3>  Tubuh utama </h3><br>  Pertengahan agustus.  Akibatnya, seorang teman berbicara tentang belajar node.js dan keinginannya untuk menulis hot-reloader sendiri.  Pikiran tentang majelis kami menyala dengan semangat baru. <br><br>  Tugas: memuat ulang halaman saat ini ketika memperbarui file di proyek. <br>  Fitur: semua perpustakaan terhubung di index.html, Anda tidak dapat meminta, belum lagi impor.  Perakitan sebelum memuat ulang belum diperlukan, hanya memuat ulang.  Di server pengembangan yang proksi permintaan untuk dukungan kami, saya bisa menggunakan paket, dan saya juga bisa meminta! <br><br>  Semua ini terjadi pada hari Jumat dan saya memutuskan bahwa dalam versi yang disederhanakan untuk proyek kami, saya cukup mampu menerapkan teknologi yang akan menyelamatkan saya dan rekan-rekan saya dari F5. <br><br>  Proses pemikiran berlangsung dan visi solusi terbentuk di kepala. <br>  Server paling sederhana (seperti milik kami), di dalamnya saya akan berkeliling seluruh folder dan subfolder dan membentuk pohon dengan tanggal modifikasi dari setiap file. <br><br>  Kemudian, setelah setiap n milidetik, saya akan memintas lagi dan lagi dan membandingkan nilai waktu perubahan.  Diubah - memuat ulang.  Seorang teman memberi tahu Anda - “jangan menemukan kembali roda, ada sebuah arloji di node.js”.  Bagus, saya akan menggunakannya.  Di server.js, saya akan mengonfigurasi arloji di belakang folder proyek dan saya akan memanggil location.reload () untuk mengubah sesuatu di dalamnya. <br><br>  Iterasi pertama: <br><br><div class="spoiler">  <b class="spoiler_title">server.js</b> <div class="spoiler_text"><pre><code class="plaintext hljs">var express = require('express'); var app = express(); var server = require('http').Server(app); const port = 9080; server.listen(port); app.use(express.static(__dirname + '/src')); location.reload().</code> </pre> <br></div></div><br>  Masalah pertama adalah lokasi - ini bukan variabel node.js (saat ini saya mendapatkan pemahaman tentang mengapa upaya saya untuk mengakses process.env di depan juga tidak berhasil))). <br><br>  Masalah kedua adalah bagaimana membuat bagian depan mengerti apa yang perlu dilakukan ulang. <br><br>  Keluar - websocket!  Idenya menggoda + saya bekerja dengan mereka "setengah kerucut" ketika saya menulis obrolan, saya punya ide umum.  Pada saat yang sama, saya melakukan penghitung reboot per sesi, menambahkan variabel dan memproses permintaan yang memberikannya. <br><br>  Saya mencoba: <br><br><div class="spoiler">  <b class="spoiler_title">server.js</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">var express = require('express'); //  express var app = express(); var server = require('http').Server(app); //  http  app var io = require('socket.io')(server); //  socket.io     var fs = require('fs'); const port = 9080; server.listen(port); app.use(express.static(__dirname + '/src')); let count = 0; app.get('/data', (req, res) =&gt; { res.data = count; res.send(`${count}`); }) const dir = './src'; fs.watch(dir, () =&gt; { io.emit('change', {data: count}); count += 1; })</code> </pre><br></div></div><br>  Di depan saya sedang melakukan aplikasi paling sederhana di angularjs <br><br><div class="spoiler">  <b class="spoiler_title">app.js</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">angular.module('App', []) .controller('myAppCtrl',['$scope', '$timeout','$http', ($scope, $timeout, $http) =&gt; { $scope.title = '       '; $scope.count = 0; $scope.todo = [ '  ,  ', '   node.js watch   ', '     ,         ', ' , codeclimate  travis   ' ] $scope.marks = [ 'watcher      ' ] // var socket = io(); // socket.on('change', (data) =&gt; { // console.log(data.data); // $scope.count = data.data; // console.log('scope.count: ', $scope.count); // $scope.$digest();// // location.reload();//agfr // }) $http({method: 'GET',url: 'data'}) .then(response =&gt; { $scope.count = response.data;// }); }])</code> </pre><br></div></div><br>  Dan modul terpisah yang memuatnya kembali.  Terpisah, agar proyek tidak mendapat terlalu banyak. <br><br><div class="spoiler">  <b class="spoiler_title">watch.js</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">var socket = io(); socket.on('change', () =&gt; { location.reload(); })</code> </pre><br></div></div><br>  Itu berhasil!  Ia juga memonitor file selain js (Anda tidak pernah tahu!): Memeriksa .json, .css. <br>  Saya memeriksa subfolder - tidak berfungsi. <br><br>  Saya pikir, oke, sekarang saya akan memotongnya secara rekursif.  Untuk jaga-jaga, google dan - voila - siap <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">keputusan.</a> <br><br>  Tambahkan paket ini. <br><br><div class="spoiler">  <b class="spoiler_title">server.js</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">var express = require('express'); //  express var app = express(); var server = require('http').Server(app); //  http  app var io = require('socket.io')(server); //  socket.io     var fs = require('fs'); var watch = require('node-watch'); const port = 9080; server.listen(port); app.use(express.static(__dirname + '/src')); let count = 0; let changed = []; app.get('/data', (req, res) =&gt; { res.data = count; res.send({count, changed}); }) const translate = { remove: "", update: "" } watch('./', { recursive: true }, function(evt, name) { io.emit('change', {data: count}); count += 1; changed = [{name, evt}, ...changed]; });</code> </pre><br></div></div><br>  Hore, itu berhasil! <br><br>  Saya ingat eslint, codeclimate dan travis. <br>  Instal yang pertama, tambahkan sisanya. <br>  Saya membersihkan kode, semuanya var pada const dan seterusnya. <br><br>  Linter bersumpah bahwa sudut tidak didefinisikan, tetapi fitur saya menghubungkan perpustakaan dalam proyek menentukan perilaku ini, saya mematikannya.  Pada saat yang sama, saya sedikit mengacaukan variabel dari baris perintah, menjalankannya, semuanya berfungsi! <br><br>  Dia datang untuk bekerja pada hari Senin dan mengikat seluruh pertanian ke draft kerja.  Saya harus mengubah sedikit, pada saat yang sama membuat perubahan sehingga dimungkinkan untuk mengubah beberapa parameter startup dari baris perintah dan pengecualian, sehingga saya tidak membaca semuanya. <br><br>  Hasilnya, ternyata seperti ini: <br><br><div class="spoiler">  <b class="spoiler_title">server.js</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">const express = require('express'), http = require('http'), watch = require('node-watch'), proxy = require('http-proxy-middleware'), app = express(), server = http.createServer(app), io = require('socket.io').listen(server), exeptions = ['git', 'js_babeled', 'node_modules', 'build', 'hotreload'], // ,   ,    backPortObj = { /*  ,   back*/ }, address = process.argv[2] || /*    back*/, localHostPort = process.argv[3] || 9080, backMachinePort = backPortObj[address] || /*   back */, isHotReload = process.argv[4] || "y", // "n" || "y" target = `http://192.168.${address}:${backMachinePort}`, str = `Connected to machine: ${target}, hot reload: ${isHotReload === 'y' ? 'enabled' : 'disabled'}.`, link = `http://localhost:${localHostPort}/`; server.listen(localHostPort); app .use('/bg-portal', proxy({ target, changeOrigin: true, ws: true })) .use(express.static('.')); if (isHotReload === 'y') { watch('./', { recursive: true }, (evt, name) =&gt; { let include = false; exeptions.forEach(item =&gt; { if (`${name}`.includes(item)) include = true; }) if (!include) { console.log(name); io.emit('change', { evt, name, exeptions }); }; }); }; console.log(str); console.log(link);</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">app.js</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">var socket = io.connect(); socket.on('change', ({ evt, name, exeptions }) =&gt; { location.reload(); });</code> </pre><br></div></div><br>  skrip yang berjalan di package.json hanya memanggil server.js dari bawah node dan dimulai seperti ini: <br><br><pre> <code class="plaintext hljs">npm start 1.100 8080</code> </pre><br>  Menulis  Disimpan  <s>F5</s> <br><br>  Sebagai penutup, saya ingin mengucapkan terima kasih kepada Vanya, teman saya, di beberapa tempat dalang dan penendang utama, serta Sasha - pria yang saya anggap sebagai mentor saya! <br><br><h3>  Alih-alih kata penutup </h3><br>  Dan setelah 2 minggu, pada hari terakhir masa percobaan saya, saya mengacaukan webpack dan webpack-dev-server ke proyek kami, mengirimkan reloader panas saya ke debu di rak sejarah. <br><br>  Namun, 2 minggu ini kami menggunakannya setiap hari dan dia secara teratur melakukan tugasnya! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id466237/">https://habr.com/ru/post/id466237/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id466223/index.html">Bersihkan dekomposisi</a></li>
<li><a href="../id466227/index.html">Pemrograman Berorientasi Node</a></li>
<li><a href="../id466229/index.html">Cara membeli sepuluh kotak kapas dan tidak membuat kesalahan</a></li>
<li><a href="../id466231/index.html">ShIoTiny dan dunia sekitarnya: menghubungkan sensor ke input biner, pantulan kontak, dan masalah lainnya</a></li>
<li><a href="../id466235/index.html">Munch dalam pemindaian yang sama jauhnya dan Meyerhold, yang menghancurkan Red Square - Denis Semenov pada seni VR</a></li>
<li><a href="../id466247/index.html">Wawancara Introvert</a></li>
<li><a href="../id466249/index.html">Menulis ular untuk Android di Kivy, Python</a></li>
<li><a href="../id466251/index.html">Memompa proyek dari Soft Launch ke pendapatan $ 1 juta per bulan</a></li>
<li><a href="../id466253/index.html">Bagaimana saya merekonstruksi situs pendaratan ALS Luna-9 dan Luna-13</a></li>
<li><a href="../id466257/index.html">Conquering the Seas: Gudang Data Terapung</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>