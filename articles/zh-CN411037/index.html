<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏼‍🎨 🦗 🏒 Sochi.Camera：区域提供商如何建立一个视频广播站点，每月访问量为50万人 🙆🏻 👨🏻‍🎨 💱</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sochi.Camera-一个站点，它广播来自Sochi及其周围地区安装的300多个网络摄像机的流。 该网站和整个服务都是非营利性的，由本地互联网提供商“ Business Connection”自费创建和维护了将近10年。 

 创建一个项目后，我们尝试了多种型号的外部摄像机（固定式，旋转式，移动...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sochi.Camera：区域提供商如何建立一个视频广播站点，每月访问量为50万人</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/sochikamera/blog/411037/">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Sochi.Camera-</a>一个站点，它广播来自Sochi及其周围地区安装的300多个网络摄像机的流。 该网站和整个服务都是非营利性的，由本地互联网提供商<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“ Business Connection”</a>自费创建和维护了将近10年。 <br><br> 创建一个项目后，我们尝试了多种型号的外部摄像机（固定式，旋转式，移动式），并对其进行了修改和调整以适应我们的需求。 我们尝试了几种服务器解决方案，并将它们带给开发人员。 他们自己编写了适用于Android和iOS的移动应用程序。 事实证明，该项目非常困难，但是我们逐渐将系统的每个元素都设计成了高效的状态。 发展在继续，但是现在有话要说。 <br><br><img src="https://habrastorage.org/webt/km/lf/he/kmlfhesu65o6zvhro8fpv2qskjy.jpeg"><br><a name="habracut"></a><br><br> 这是第一篇评论文章。 在其中，我们将讨论该项目的启动和开发方式，技术解决方案的组成，如何在狮子的笼子中安装摄像头（扰流器-与狮子一起布置）以及为什么来自俄罗斯各地的人们都可以通过我们的网站查看索契。 如果这篇文章看起来有趣，我们可以更详细地讨论该项目。 <br><br> 从技术角度来说，是索契项目，相机分为三个部分： <br><br>  1）拍摄图像； <br><br>  2）将其传输到视频广播服务器； <br><br>  3）在网站上显示流。 <br><br> 所有这些都在播出。 <br><br> 让我们按顺序去。 <br><br> 相机。 <br><br> 网络上的摄像机不同。 近十年来，他们尝试了许多模型，其中一些经过测试的模型已在网络上。 摄像机是统一的，标准的，几乎所有标准型号都支持我们使用的协议-RTSP。 自2008年以来，相机的价格已大幅下降，图像质量也得到了大幅提高。 然后，一台简单的静态摄像机的成本约为4万卢布，今天，您只需花同样的钱就可以购买具有“按点巡逻”功能的旋转式全高清摄像机，并将其放在塔上，它将提供动态图像。 今天，一台普通的静态相机仅需花费5,000至7,000美元（不要忘了折扣）。 <br><br> 现代相机的图像质量几乎是电视，不是我们都习惯的网络摄像头中的图像-一个小暗正方形，每秒1帧的频率。 <br><br><img src="https://habrastorage.org/webt/vc/ij/zm/vcijzmgmnbel9ggxmy1-_pnjsrs.jpeg"><br><br> 最近确定了一对模型： <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">海康威视</a> <br> 和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SNR</a> <br><br> 由于采用现代矩阵，它们噪音低，具有良好的夜间拍摄效果。 <br> 每个摄像机提供两个流：全高清（速度4-6 Mbit / s）和标清（512 Kbit / s），该站点具有HD / SD开关。 这样做是为了使Internet速度较慢的用户可以启用备用SD模式。 它也用于我们的移动应用程序中，因为在小屏幕上，Full HD和SD之间的差异几乎不可察觉。 当然，市场上有许多分辨率高于全高清的摄像机，例如4MP。 我们试图使用它们，但实践表明，此类权限不适用于Internet上的在线广播。 首先，并非每个Internet通道都会无损失地传输此流，并且并非每个客户端设备都能毫不费力地显示此流。 结果，广播可能会带有抽搐和伪影，毕竟，Internet不是本地网络。 好吧，最重要的是，事实证明，绝大多数用户以窗口模式而不是全屏模式观看摄像机，也就是说，在输出端，他们根本看不到比特率和分辨率的差异。 结果，我们甚至将4百万像素的摄像头转移到2MP 1920x1080模式。 至于软件，通常在相机本身中是标准出厂固件，我们不在那里进行任何更改。 <br><br> 现在，大约有318台摄像机可供一般使用。 记录在约115-120台摄像机上进行，这与交通状况有关。 需要记录是因为需要分析事故，这经常发生。 我们不会记录看到自然，日落，山脉等的照相机。 记录服务器是一种昂贵的资源，徒劳地尝试不浪费它。 <br><br> 至于隐私-安装摄像头以使面部不可读。 我们设置了全景相机，以便可以看到一般的场景，例如，黄色的机器撞到蓝色的机器，交通信号灯在那儿燃烧，仅此而已。 但是，交警和警察经常每周，甚至有时每天都有警察：要求他们出示记录。 <br><br><img src="https://habrastorage.org/webt/1h/f1/an/1hf1anh0zn76tfj4yevzev6y4kg.jpeg"><br><br><img src="https://habrastorage.org/webt/hz/l7/d_/hzl7d_xswupqwzuy8vjrpntnv8a.jpeg"><br><br> 摄像机的安装和维护由承包商完成。 同时，如果有问题，请按照以下说明进行操作。 考虑到例如压力和温度差，有必要做更多的工作而不是按照说明进行操作。 在此过程中，有一些技巧，例如，将以太网电缆连接在摄像机主体内部，而不是在安装盒或标准连接的“枪管”中。 与常规方法相比，隔离网络摄像头更为重要，因此网络摄像头可以安静地工作数年而不会进入内部。 <br><br> 我们不为摆放相机而支付任何费用，这是一个基本点，因为我们的项目是非营利性的-图像属于公共领域，因此我们不会从中获得任何收益。 因此，如果有人不想免费发布，我们就不会在那发布。 这个城市有许多美丽的地方，许多人想放我们的相机。 建筑物所有者宁愿给予安装许可，仅因为我们在摄像机上免费宣传这些设施。 对于一个区域性站点，我们的出席率足够高，每月有500,000人，我们与大型本地新闻门户网站竞争。 因此，问题在于将频道带到有趣的地方，而不是实际放置摄像机。 <br><br><img src="https://habrastorage.org/webt/tz/j6/6t/tzj66tyvpnn8mliqmcr_m0djjjo.jpeg"><br><br> 通常，在找到适合不同安装情况的最佳解决方案后，摄像机大约占Sochi项目的10％。 最主要的不是它们，而是在视频传输通道和站点上广播的软件中。 <br><br> 视频传输通道。 <br><br>  “商务通信”是一家互联网提供商，电信运营商，我们拥有自己的城市网络，节点众多。 因此，我们不需要租用任何用于视频传输的频道，也不必租用“最后一英里”，中继线频道或Internet接入-我们已经拥有了一切。 <br><br> 我们服务的消费者是组织和个人。 如果查看其Internet流量的概况，则主要是传入流量，因为通常，标准用户会消耗（下载）流量，而产生的流量很少。 平均而言，传入流量与传出流量之比为10：1。我们租用/购买以从骨干网络运营商提供Internet服务的通道是同步的，传入和传出速度相同。 因此，通常来说，像我们这样的Internet提供商的回报（传出渠道）是空的。 对于大多数与人合作的操作员来说，这种情况很典型。 在托管提供商和社交网络的数据中心中，情况恰恰相反，主要是传出流量，但这不是我们的情况。 <br><br> 结果，从传输流量的成本来看，从摄像机收集视频并将其广播到Internet几乎不会花费我们什么。 同时，需要大量的信道，因为静态摄像机的速度约为4 Mbit / s，而枢轴摄像机的角度变化时高达10 Mbit / s。 <br><br><img src="https://habrastorage.org/webt/gp/il/8a/gpil8asew4--enzbeza-nfvow3a.jpeg"><br><br> 将其乘以同时使用的消费者数量，白天则是2,000或更多。 假设第三方组织而不是电信运营商想要创建一个类似Sochi.Kamer的项目。 在这种情况下，将需要从信号员那里租用所有必要的资源，而按当前价格，这将花费一分钱。 但是，如果您是电信运营商，那么该标志就在您手中。 <br><br> 但是，沟通渠道的组织仍然存在困难。 这是由于存在通信渠道的地方，即在市中心，基本上没有什么可看的。 在有趣的地方，没有紧密的沟通渠道，必须以某种方式组织，分配设备，消耗品和人力资源。 例如，现在我们正在组织与森林中浣熊洞穴的连接。 <br><br> 视频广播软件。 <br><br> 我们从2008-2009年开始我们的项目，当时没有可以简单地获取和复制的样本。 然后，有许多网络摄像头聚合器尽可能地寻找它们，并将它们呈现在一个据称属于自己的目录中。 但是，没有复杂的现成解决方案。 要接收如此多的摄像机并分发给不同设备上的许多人，您需要可靠且稳定的软件。 因此，我们开始自己做所有事情，这是从头开始的几年开发，从设计，布局到软件体系结构的开发。 他们没有从任何人那里复制它，而是尝试了该引擎的五个版本-从mjpeg上的原始LinuxDVR到Red 5，ffmpeg + nginx，Wowza。 顺便说一句，放弃后者不是出于技术原因，而是因为切换到新版本时许可条件的变化，以及美国开发商的新政策中没有终身许可。 也就是说，他们希望根据实际负载每月收款。 而且该项目不是以盈利为目的的事实并没有打扰任何人。 <br><br> 在开发和开发服务的过程中，我们去了Erlivideo公司，该公司正在开发Flussonic媒体服务器。 该项目团队来自莫斯科，很容易找到一种通用语言，总的说来，它在解决非同寻常的任务方面效果很好。 这并不是说一切总是很顺利，门框和耙子都掉了。 但是 当您发现开发人员希望改进其产品，聆听并考虑客户的意见并在下一次更新后看到此类交互的实际结果时，这是非常有价值的。 <br><br><img src="https://habrastorage.org/webt/oa/pf/zv/oapfzvfz_qvjowse7k74ufj-mnk.jpeg"><br><br>  Flussonic Media Server是视频流服务器平台。 在它的帮助下，您可以实时和按需组织各种视频流的捕获，将视频记录到存档中，并使用各种协议将其分发给客户端以及分发给任何设备。 可以以无限的磁带形式进行播放，可以随时观看。 分发可以通过RTMP，RTSP，HLS，HDS，HTTP MPEG-TS，DASH和WebRTC协议进行。 另外，Flussonic可以通过更改编解码器和视频参数来对视频进行转码。 支持的编解码器列表包括H.264，H.265，MPEG-2，AAC，AC3，MP3，VP6，Speex和G711a / u。 该平台可以从服务器组装群集，捕获1600多个流，并分发数十万个同时连接。 您可以使用内置工具和Web界面，也可以使用HTTP API来管理和监视活动和负载。 <br><br> 我们从摄像机中收集标准RTSP中的流。 直到最近才主要分发DASH（用于Flash播放器），UDP Multicast（用于内部网络）和HLS（用于移动应用程序）。 在过去的几年中，HTML5的革命和Adobe Flash的“附属产品”已经定期发布，因此我们必须使用一种整体设计，根据浏览器和客户端操作系统“提供”所需的播放器和流类型。 尽管围绕HTML5进行了大肆宣传，但当实时流式传输时，许多流行的浏览器对于video标签却非常笨拙。 相比之下，从播放预录视频开始，自HTML5发布以来，该视频已经足够稳定地运行。 <br><br> 现在我们可以说“浏览器湍流”已经结束，我们切换到浏览器中的本机html5广播，完全放弃了Flash插件。 因此，“现有”现在只有HLS和多播。 <br><br> 对于使用IPTV进行多播的订户，我们将这些摄像机广播到电视网络，也就是说，他们将所有网络摄像头视为电视上单独的电视频道。  IPTV中的网络摄像头是按主题进行分类的，是对客户提供的标准电视频道集的补充。 <br><br> 我们的另一个功能是嵌入式播放器的功能，例如YouTube或Vimeo。 通过我们的服务，我们将视频发送到一些非常著名的站点-这些是Krasnaya Polyana度假村和酒店。 同时，他们不会在自己的身边引发流，他们只需要插入代码。 嵌入式播放器可以打上商标，也可以不带有任何识别标记，这使我们的合作伙伴可以以正确的样式独立设计其页面。 范例： <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">一个</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">两个</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">三</a> <br><br> 我们的另一个功能是基于手机的移动网络摄像头。 我们从推视频流方法中将它们称为“绒毛”。 这是一个自定义的Android应用程序，以APK文件的形式分发。 在市场中，现在不是，将来也不会。 这个想法很简单：手机拥有视频广播所需的一切：相机，GPS定位，数据通道。 我们制作了一个处理视频的应用程序，并将其立即传输到Sochi。Camera。 可选地传输声音和坐标。 提供了“黑洞”的创建，一旦“绒毛”暂停了广播。  “ Cannon”类似物是众所周知的，例如，这是“ Instagram”的“ Periscope”。 曾经，我们曾打算在博客作者之间分发此应用程序，但出于多种原因却放弃了这一想法。 现在，“枪支”正在多辆城市公交车上工作，临近季节，观光船的广播将恢复工作。 <br><br><img src="https://habrastorage.org/webt/kv/ef/op/kvefop5veglgpcnp8meqevgafey.jpeg"><br><br><img src="https://habrastorage.org/webt/hz/9l/sh/hz9lsh2dmqlzi-hev9n1mwttm30.jpeg"><br><br> 索契本身，相机完全使用Javascript制作。 服务器-在Node.js上，浏览器部分-Angular.js <br><br> 适用于Android，iOS和Windows Phone的移动应用程序是使用标准开发人员工具编写的。 还值得补充的是，有一个适用于Windows桌面的应用程序，一些客户更喜欢它而不是浏览器，因为它运行速度更快，没有广告，并且通常存在一些简约功能，而没有以聊天和其他形式出现的“工具包”。 <br> 有趣的是，在过去的时间里，交钥匙集成解决方案并未出现。 现有的现成视频系统设计用于完全不同的目的，主要用于安全视频监视。 有一个视频墙，可以进行记录，查看，倒带等操作，但是它们经过了改进以用于安全视频监视，而不是一次用于数千人的工作。 通常这是一种不同的方法，一种不同的体系结构。 <br><br> 关于这一点，我想结束评论文章。 如上所述，可以更详细地描述系统的许多元素，这是值得的。 例如，关于在高湿度和大温差条件下在街上安装摄像机的技巧，在公共汽车和汽船上组织移动摄像机的方式，或有关智能手机及其服务器端应用程序的更多详细信息，或有关选择站点上视频流传输软件的详细信息。 我们还可以告诉您一些有关开发和维护此类项目的成本。 例如，最初几年用于开发的初始注资约为4,000,000卢布。 但这不是最终数字。 <br><br> 您可以问自己感兴趣的项目的哪一部分。 等待您的问题。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN411037/">https://habr.com/ru/post/zh-CN411037/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN411027/index.html">学校奥运会：绝地剑，喷气背包和传送到2035年</a></li>
<li><a href="../zh-CN411029/index.html">如何在Go中使用界面</a></li>
<li><a href="../zh-CN411031/index.html">全球首台便携式MEG扫描仪</a></li>
<li><a href="../zh-CN411033/index.html">“做”，“理解”，“同意”：英语中的同义词</a></li>
<li><a href="../zh-CN411035/index.html">也许您现在正在睡觉？</a></li>
<li><a href="../zh-CN411039/index.html">第二次接触，或者代替结尾</a></li>
<li><a href="../zh-CN411041/index.html">特斯拉工程师：Model 3输送机上40％的零件需要返工</a></li>
<li><a href="../zh-CN411043/index.html">新型太阳能装置即使从干燥的沙漠空气中也能抽水</a></li>
<li><a href="../zh-CN411045/index.html">棍子：人类进化的无名英雄</a></li>
<li><a href="../zh-CN411049/index.html">阅读什么。 鲜为人知且冻结的非小说文章和博客</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>