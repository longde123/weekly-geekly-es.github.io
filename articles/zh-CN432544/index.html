<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ“˜ ğŸˆ ğŸ›ï¸ Gamedevä¸­çš„æ•°å­¦å¾ˆç®€å•ã€‚ çŸ©é˜µå’Œä»¿å°„å˜æ¢ ğŸ‘Š ğŸ‘©ğŸ½â€ğŸ¤â€ğŸ‘¨ğŸ¾ ğŸ‘¨ğŸ¼â€ğŸš’</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å¤§å®¶å¥½ï¼ æˆ‘å«Grishaï¼Œæ˜¯CGDevsçš„åˆ›å§‹äººã€‚ ä»Šå¤©ï¼Œæˆ‘æƒ³ç»§ç»­æ¸¸æˆå¼€å‘ä¸­çš„æ•°å­¦ä¸»é¢˜ã€‚ åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ ï¼Œæˆ‘ä»¬å±•ç¤ºäº†åœ¨Unityé¡¹ç›®ä¸­ä½¿ç”¨å‘é‡å’Œç§¯åˆ†çš„åŸºæœ¬ç¤ºä¾‹ï¼Œç°åœ¨è®©æˆ‘ä»¬è®¨è®ºçŸ©é˜µå’Œä»¿å°„å˜æ¢ã€‚ å¦‚æœæ‚¨ç²¾é€šçŸ©é˜µç®—æœ¯ï¼› æ‚¨çŸ¥é“ä»€ä¹ˆæ˜¯TRSä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒã€‚ ä»€ä¹ˆæ˜¯Householderè½¬æ¢-æ‚¨å¯èƒ½ä¸ä¼šä¸º...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Gamedevä¸­çš„æ•°å­¦å¾ˆç®€å•ã€‚ çŸ©é˜µå’Œä»¿å°„å˜æ¢</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/432544/">å¤§å®¶å¥½ï¼ æˆ‘å«Grishaï¼Œæ˜¯CGDevsçš„åˆ›å§‹äººã€‚ ä»Šå¤©ï¼Œæˆ‘æƒ³ç»§ç»­æ¸¸æˆå¼€å‘ä¸­çš„æ•°å­¦ä¸»é¢˜ã€‚ åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸Šä¸€ç¯‡æ–‡ç« ä¸­</a> ï¼Œæˆ‘ä»¬å±•ç¤ºäº†åœ¨Unityé¡¹ç›®ä¸­ä½¿ç”¨å‘é‡å’Œç§¯åˆ†çš„åŸºæœ¬ç¤ºä¾‹ï¼Œç°åœ¨è®©æˆ‘ä»¬è®¨è®ºçŸ©é˜µå’Œä»¿å°„å˜æ¢ã€‚ å¦‚æœæ‚¨ç²¾é€šçŸ©é˜µç®—æœ¯ï¼› æ‚¨çŸ¥é“ä»€ä¹ˆæ˜¯TRSä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒã€‚ ä»€ä¹ˆæ˜¯Householderè½¬æ¢-æ‚¨å¯èƒ½ä¸ä¼šä¸ºè‡ªå·±æ‰¾åˆ°ä»»ä½•æ–°ä¸œè¥¿ã€‚ æˆ‘ä»¬å°†åœ¨3Då›¾å½¢çš„èƒŒæ™¯ä¸‹è¿›è¡Œè®¨è®ºã€‚ å¦‚æœæ‚¨å¯¹æ­¤ä¸»é¢˜æ„Ÿå…´è¶£-æ¬¢è¿æ¥åˆ°catã€‚ <br><br><img src="https://habrastorage.org/webt/uv/qk/z8/uvqkz8zsqguqq3sl4c_clkwknx8.jpeg"><br><a name="habracut"></a><br> è®©æˆ‘ä»¬ä»æ–‡ç« <i>ä»¿å°„è½¬æ¢</i>çš„ä¸Šä¸‹æ–‡ä¸­æœ€é‡è¦çš„æ¦‚å¿µå¼€å§‹ã€‚  <i>ä»¿å°„å˜æ¢</i>æœ¬è´¨ä¸Šæ˜¯é€šè¿‡å°†å‘é‡ä¹˜ä»¥ç‰¹æ®ŠçŸ©é˜µæ¥å˜æ¢åæ ‡ç³»ï¼ˆæˆ–ç©ºé—´ï¼‰ã€‚ ä¾‹å¦‚ï¼Œè¯¸å¦‚ç§»åŠ¨ï¼Œæ—‹è½¬ï¼Œç¼©æ”¾ï¼Œåå°„ä¹‹ç±»çš„å˜æ¢ã€‚ä»¿å°„å˜æ¢çš„ä¸»è¦å±æ€§æ˜¯æ‚¨åœç•™åœ¨åŒä¸€ç©ºé—´ä¸­ï¼ˆä¸å¯èƒ½ä»ä¸‰ç»´çŸ¢é‡ä¸­ç”ŸæˆäºŒç»´ï¼‰ï¼Œå¹¶ä¸”å¦‚æœçº¿ç›¸äº¤/å¹³è¡Œ/åœ¨è½¬æ¢å‰è¢«äº¤å‰ï¼Œé‚£ä¹ˆæ­¤å±æ€§å°†åœ¨è½¬æ¢åä¿ç•™ã€‚ æ­¤å¤–ï¼Œå®ƒä»¬å…·æœ‰è®¸å¤šæ•°å­¦ç‰¹æ€§ï¼Œéœ€è¦äº†è§£ç»„ï¼Œé›†åˆå’Œçº¿æ€§ä»£æ•°çš„ç†è®ºï¼Œè¿™ä½¿å¾—ä½¿ç”¨å®ƒä»¬æ›´åŠ å®¹æ˜“ã€‚ <br><br><h2>  TRSçŸ©é˜µ </h2><br> è®¡ç®—æœºå›¾å½¢å­¦ä¸­çš„ç¬¬äºŒä¸ªé‡è¦æ¦‚å¿µæ˜¯<i>TRSçŸ©é˜µ</i> ã€‚ ä½¿ç”¨å®ƒï¼Œæ‚¨å¯ä»¥æè¿°è®¡ç®—æœºå›¾å½¢å¤„ç†ä¸­æœ€å¸¸ç”¨çš„æ“ä½œã€‚  <i>TRSçŸ©é˜µ</i>æ˜¯ä¸‰ä¸ªå˜æ¢çŸ©é˜µçš„ç»„åˆã€‚ ä½ç§»çŸ©é˜µï¼ˆå¹³ç§»ï¼‰ï¼Œæ¯ä¸ªè½´ä¸Šçš„æ—‹è½¬ï¼ˆæ—‹è½¬ï¼‰å’Œç¼©æ”¾æ¯”ä¾‹ï¼ˆç¼©æ”¾ï¼‰ã€‚ <br> å¥¹çœ‹èµ·æ¥åƒè¿™æ ·ã€‚ <br><br><img src="https://habrastorage.org/webt/9p/cv/lp/9pcvlphst8r4db6bwww36jdwtuo.png"><br><br> å…¶ä¸­ï¼š <br>  <b>ç§»åŠ¨</b>ä¸º<i>t</i> =æ–°çš„Vector3ï¼ˆdï¼Œhï¼Œlï¼‰ã€‚ <br>  <b>ç¼©æ”¾</b> <i>-s</i> =æ–°çš„Vector3ï¼ˆæ–°çš„Vector3ï¼ˆaï¼Œeï¼Œiï¼‰ã€‚å¹…å€¼ï¼Œæ–°çš„Vector3ï¼ˆbï¼Œfï¼Œjï¼‰ã€‚å¹…å€¼ï¼Œæ–°çš„Vector3ï¼ˆcï¼Œgï¼Œkï¼‰ã€‚å¹…å€¼ï¼‰; <br><br>  <b>æ—‹è½¬</b>æ˜¯ä»¥ä¸‹å½¢å¼çš„çŸ©é˜µï¼š <br><br><img src="https://habrastorage.org/webt/in/4c/_n/in4c_nqanxcmlg4lah2colkjioo.png"><br><br> ç°åœ¨è®©æˆ‘ä»¬æ›´æ·±å…¥åœ°äº†è§£Unityä¸Šä¸‹æ–‡ã€‚ é¦–å…ˆï¼ŒTRSçŸ©é˜µæ˜¯å¾ˆæ–¹ä¾¿çš„äº‹æƒ…ï¼Œä½†ä¸åº”åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨ã€‚ ç”±äºç®€å•æŒ‡ç¤ºå•ä½ä¸­çŸ¢é‡çš„ä½ç½®æˆ–ç›¸åŠ ä¼šæ›´å¿«ï¼Œä½†æ˜¯åœ¨è®¸å¤šæ•°å­¦ç®—æ³•ä¸­ï¼ŒçŸ©é˜µæ¯”çŸ¢é‡æ›´æ–¹ä¾¿å¾ˆå¤šå€ã€‚  Unityä¸­çš„TRSåŠŸèƒ½ä¸»è¦åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Matrix4x4</a>ç±»ä¸­å®ç°ï¼Œä½†ä»åº”ç”¨ç¨‹åºè§’åº¦æ¥çœ‹å¹¶ä¸æ–¹ä¾¿ã€‚ å› ä¸ºé™¤äº†é€šè¿‡ä¹˜æ³•åº”ç”¨çŸ©é˜µå¤–ï¼Œå®ƒé€šå¸¸è¿˜å¯ä»¥å­˜å‚¨æœ‰å…³å¯¹è±¡æ–¹å‘çš„ä¿¡æ¯ï¼Œå¹¶ä¸”å¯¹äºæŸäº›å˜æ¢ï¼Œæˆ‘å¸Œæœ›ä¸ä»…èƒ½å¤Ÿè®¡ç®—ä½ç½®ï¼Œè€Œä¸”è¿˜å¯ä»¥æ•´ä½“ä¸Šæ›´æ”¹å¯¹è±¡çš„æ–¹å‘ï¼ˆä¾‹å¦‚ï¼ŒUnityä¸­æœªå®ç°çš„åå°„ï¼‰ <br><br> ä»¥ä¸‹æ˜¯å±€éƒ¨åæ ‡ç³»çš„æ‰€æœ‰ç¤ºä¾‹ï¼ˆå°†GameObjectçš„åŸç‚¹è§†ä¸ºå¯¹è±¡æ‰€åœ¨çš„åæ ‡çš„åŸç‚¹ã€‚å¦‚æœå¯¹è±¡æ˜¯å•ä½ä¸­å±‚æ¬¡ç»“æ„çš„æ ¹ï¼Œåˆ™åŸç‚¹ä¸ºworldï¼ˆ0,0,0ï¼‰ï¼‰ã€‚ <br><br> ç”±äºä½¿ç”¨TRSçŸ©é˜µï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šå¯ä»¥æè¿°ç‰©ä½“åœ¨ç©ºé—´ä¸­çš„ä½ç½®ï¼Œå› æ­¤éœ€è¦å°†TRSåˆ†è§£ä¸ºUnityçš„ä½ç½®ï¼Œæ—‹è½¬å’Œæ¯”ä¾‹çš„ç‰¹å®šå€¼ã€‚ ä¸ºæ­¤ï¼Œæ‚¨å¯ä»¥ä¸ºMatrix4x4ç±»ç¼–å†™æ‰©å±•æ–¹æ³•ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">è·å–ä½ç½®ï¼Œæ—‹è½¬å’Œæ¯”ä¾‹</b> <div class="spoiler_text"><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Vector3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExtractPosition</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Matrix4x4 matrix</span></span></span><span class="hljs-function">)</span></span> { Vector3 position; position.x = matrix.m03; position.y = matrix.m13; position.z = matrix.m23; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> position; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Quaternion </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExtractRotation</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Matrix4x4 matrix</span></span></span><span class="hljs-function">)</span></span> { Vector3 forward; forward.x = matrix.m02; forward.y = matrix.m12; forward.z = matrix.m22; Vector3 upwards; upwards.x = matrix.m01; upwards.y = matrix.m11; upwards.z = matrix.m21; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Quaternion.LookRotation(forward, upwards); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Vector3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExtractScale</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Matrix4x4 matrix</span></span></span><span class="hljs-function">)</span></span> { Vector3 scale; scale.x = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector4(matrix.m00, matrix.m10, matrix.m20, matrix.m30).magnitude; scale.y = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector4(matrix.m01, matrix.m11, matrix.m21, matrix.m31).magnitude; scale.z = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector4(matrix.m02, matrix.m12, matrix.m22, matrix.m32).magnitude; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> scale; }</code> </pre> <br></div></div><br> å¦å¤–ï¼Œä¸ºäº†æ–¹ä¾¿å·¥ä½œï¼Œæ‚¨å¯ä»¥å®ç°å‡ ä¸ªTransformç±»æ‰©å±•æ¥åœ¨å…¶ä¸­ä½¿ç”¨TRSã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">æ‰©å±•å˜æ¢</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ApplyLocalTRS</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Transform tr, Matrix4x4 trs</span></span></span><span class="hljs-function">)</span></span> { tr.localPosition = trs.ExtractPosition(); tr.localRotation = trs.ExtractRotation(); tr.localScale = trs.ExtractScale(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Matrix4x4 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExtractLocalTRS</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Transform tr</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Matrix4x4.TRS(tr.localPosition, tr.localRotation, tr.localScale); }</code> </pre> <br></div></div><br> åœ¨æ­¤æ–¹é¢ï¼Œç”±äºUnityä¸­çš„çŸ©é˜µåœ¨æ“ä½œä¸Šéå¸¸å·®ï¼Œå› æ­¤å®ç°äº†ç»Ÿä¸€ä¼˜åŠ¿ã€‚ è®¸å¤šç®—æ³•éœ€è¦çŸ©é˜µç®—æœ¯ï¼Œå³ä½¿åœ¨å®Œå…¨åŸºæœ¬çš„è¿ç®—ä¸­ï¼Œä¾‹å¦‚åœ¨çŸ©é˜µä¸­åŠ çŸ©é˜µå’Œå°†çŸ©é˜µä¹˜ä»¥æ ‡é‡ï¼Œä¹Ÿæ— æ³•åœ¨å•å…ƒä¸­å®ç°çŸ©é˜µç®—æ³•ã€‚ æ­¤å¤–ï¼Œç”±äºUnity3dä¸­çŸ¢é‡å®ç°çš„ç‰¹æ®Šæ€§ï¼Œå› æ­¤æ‚¨å¯ä»¥åˆ¶ä½œ4x4çŸ¢é‡ï¼Œä½†ä¸èƒ½ç›´æ¥åˆ¶ä½œ1x4ï¼Œè¿™ä¹Ÿå¸¦æ¥äº†è®¸å¤šä¸ä¾¿ã€‚ ç”±äºæˆ‘ä»¬å°†æ›´å¤šåœ°è®¨è®ºHouseholderçš„è½¬æ¢ä»¥è¿›è¡Œåæ€ï¼Œå› æ­¤æˆ‘ä»¬é¦–å…ˆä¸ºæ­¤æ‰§è¡Œå¿…è¦çš„æ“ä½œã€‚ <br><br> æ ‡é‡çš„åŠ /å‡å’Œä¹˜ç§¯å¾ˆç®€å•ã€‚ å®ƒçœ‹èµ·æ¥ç›¸å½“åºå¤§ï¼Œä½†æ˜¯è¿™é‡Œæ²¡æœ‰ä»€ä¹ˆå¤æ‚çš„ï¼Œå› ä¸ºç®—æœ¯å¾ˆç®€å•ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">åŸºæœ¬çŸ©é˜µè¿ç®—</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Matrix4x4 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MutiplyByNumber</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Matrix4x4 matrix, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> number</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Matrix4x4( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector4(matrix.m00 * number, matrix.m10 * number, matrix.m20 * number, matrix.m30 * number), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector4(matrix.m01 * number, matrix.m11 * number, matrix.m21 * number, matrix.m31 * number), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector4(matrix.m02 * number, matrix.m12 * number, matrix.m22 * number, matrix.m32 * number), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector4(matrix.m03 * number, matrix.m13 * number, matrix.m23 * number, matrix.m33 * number) ); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Matrix4x4 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DivideByNumber</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Matrix4x4 matrix, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> number</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Matrix4x4( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector4(matrix.m00 / number, matrix.m10 / number, matrix.m20 / number, matrix.m30 / number), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector4(matrix.m01 / number, matrix.m11 / number, matrix.m21 / number, matrix.m31 / number), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector4(matrix.m02 / number, matrix.m12 / number, matrix.m22 / number, matrix.m32 / number), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector4(matrix.m03 / number, matrix.m13 / number, matrix.m23 / number, matrix.m33 / number) ); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Matrix4x4 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Plus</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Matrix4x4 matrix, Matrix4x4 matrixToAdding</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Matrix4x4( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector4(matrix.m00 + matrixToAdding.m00, matrix.m10 + matrixToAdding.m10, matrix.m20 + matrixToAdding.m20, matrix.m30 + matrixToAdding.m30), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector4(matrix.m01 + matrixToAdding.m01, matrix.m11 + matrixToAdding.m11, matrix.m21 + matrixToAdding.m21, matrix.m31 + matrixToAdding.m31), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector4(matrix.m02 + matrixToAdding.m02, matrix.m12 + matrixToAdding.m12, matrix.m22 + matrixToAdding.m22, matrix.m32 + matrixToAdding.m32), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector4(matrix.m03 + matrixToAdding.m03, matrix.m13 + matrixToAdding.m13, matrix.m23 + matrixToAdding.m23, matrix.m33 + matrixToAdding.m33) ); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Matrix4x4 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Minus</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Matrix4x4 matrix, Matrix4x4 matrixToMinus</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Matrix4x4( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector4(matrix.m00 - matrixToMinus.m00, matrix.m10 - matrixToMinus.m10, matrix.m20 - matrixToMinus.m20, matrix.m30 - matrixToMinus.m30), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector4(matrix.m01 - matrixToMinus.m01, matrix.m11 - matrixToMinus.m11, matrix.m21 - matrixToMinus.m21, matrix.m31 - matrixToMinus.m31), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector4(matrix.m02 - matrixToMinus.m02, matrix.m12 - matrixToMinus.m12, matrix.m22 - matrixToMinus.m22, matrix.m32 - matrixToMinus.m32), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector4(matrix.m03 - matrixToMinus.m03, matrix.m13 - matrixToMinus.m13, matrix.m23 - matrixToMinus.m23, matrix.m33 - matrixToMinus.m33) ); }</code> </pre> <br></div></div><br> ä½†æ˜¯ä¸ºäº†åæ€ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç‰¹å®šæƒ…å†µä¸‹è¿›è¡ŒçŸ©é˜µä¹˜æ³•è¿ç®—ã€‚ å°†4x4çš„å‘é‡ä¹˜ä»¥1x4ï¼ˆè½¬ç½®ï¼‰çš„ä¹˜ç§¯ï¼ˆè½¬ç½®ï¼‰å¦‚æœæ‚¨ç†Ÿæ‚‰çŸ©é˜µæ•°å­¦ï¼Œåˆ™çŸ¥é“é€šè¿‡æ­¤ä¹˜ç§¯éœ€è¦æŸ¥çœ‹ç»´çš„ææ•°ï¼Œæ‚¨å°†åœ¨è¾“å‡ºå¤„è·å¾—çŸ©é˜µçš„ç»´ï¼Œå³æœ¬ä¾‹ä¸­ä¸º4x4ã€‚ æœ‰å…³å¦‚ä½•å°†çŸ©é˜µç›¸ä¹˜çš„è¶³å¤Ÿä¿¡æ¯ï¼Œå› æ­¤æˆ‘ä»¬å°†ä¸ä½œä»‹ç»ã€‚ è¿™æ˜¯ä¸€ä¸ªç‰¹å®šæ¡ˆä¾‹çš„ç¤ºä¾‹ï¼Œå®ƒå°†åœ¨å°†æ¥æ´¾ä¸Šç”¨åœºã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">å‘é‡ä¹˜ä»¥è½¬ç½®</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Matrix4x4 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MultiplyVectorsTransposed</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector4 vector, Vector4 transposeVector</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>[] vectorPoints = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>[] {vector.x, vector.y, vector.z, vector.w}, transposedVectorPoints = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>[] {transposeVector.x, transposeVector.y, transposeVector.z, transposeVector.w}; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> matrixDimension = vectorPoints.Length; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>[] values = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>[matrixDimension * matrixDimension]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; matrixDimension; i++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; matrixDimension; j++) { values[i + j * matrixDimension] = vectorPoints[i] * transposedVectorPoints[j]; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Matrix4x4( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector4(values[<span class="hljs-number"><span class="hljs-number">0</span></span>], values[<span class="hljs-number"><span class="hljs-number">1</span></span>], values[<span class="hljs-number"><span class="hljs-number">2</span></span>], values[<span class="hljs-number"><span class="hljs-number">3</span></span>]), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector4(values[<span class="hljs-number"><span class="hljs-number">4</span></span>], values[<span class="hljs-number"><span class="hljs-number">5</span></span>], values[<span class="hljs-number"><span class="hljs-number">6</span></span>], values[<span class="hljs-number"><span class="hljs-number">7</span></span>]), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector4(values[<span class="hljs-number"><span class="hljs-number">8</span></span>], values[<span class="hljs-number"><span class="hljs-number">9</span></span>], values[<span class="hljs-number"><span class="hljs-number">10</span></span>], values[<span class="hljs-number"><span class="hljs-number">11</span></span>]), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector4(values[<span class="hljs-number"><span class="hljs-number">12</span></span>], values[<span class="hljs-number"><span class="hljs-number">13</span></span>], values[<span class="hljs-number"><span class="hljs-number">14</span></span>], values[<span class="hljs-number"><span class="hljs-number">15</span></span>]) ); }</code> </pre> <br></div></div><br><h2> æˆ·ä¸»è½¬å‹ </h2><br> åœ¨å¯»æ‰¾å¦‚ä½•ç›¸å¯¹äºä»»ä½•è½´åå°„å¯¹è±¡æ—¶ï¼Œæˆ‘ç»å¸¸é‡åˆ°å»ºè®®åœ¨å¿…è¦çš„æ–¹å‘ä¸Šè®¾ç½®è´Ÿæ¯”ä¾‹ã€‚ åœ¨Unityä¸Šä¸‹æ–‡ä¸­ï¼Œè¿™æ˜¯éå¸¸ç³Ÿç³•çš„å»ºè®®ï¼Œå› ä¸ºå®ƒç ´åäº†å¼•æ“ä¸­çš„è®¸å¤šç³»ç»Ÿï¼ˆbutchingï¼Œç¢°æ’ç­‰ï¼‰ã€‚åœ¨æŸäº›ç®—æ³•ä¸­ï¼Œå¦‚æœæ‚¨éœ€è¦å¯¹Vector3.upæˆ–Vector3.forwardè¿›è¡Œå¾®ä¸è¶³é“çš„åæ˜ ï¼Œè¿™å°†å˜æˆéå¸¸å¹³å‡¡çš„è®¡ç®—ï¼Œä½†æœç€ä»»æ„æ–¹å‘å‘å±•ã€‚ å¼€ç®±å³ç”¨çš„å•å…ƒä¸­çš„åå°„æ–¹æ³•å°šæœªå®ç°ï¼Œå› æ­¤æˆ‘å®æ–½<i>äº†Householderæ–¹æ³•</i> ã€‚ <br><br>  <i>Householderå˜æ¢</i>ä¸ä»…åœ¨è®¡ç®—æœºå›¾å½¢å­¦ä¸­ä½¿ç”¨ï¼Œè€Œä¸”åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒæ˜¯ä¸€ç§çº¿æ€§å˜æ¢ï¼Œå®ƒç›¸å¯¹äºç©¿è¿‡â€œåŸç‚¹â€çš„å¹³é¢åæ˜ å¯¹è±¡ï¼Œå¹¶ç”±å¹³é¢çš„æ³•çº¿ç¡®å®šã€‚ å°½ç®¡å®ƒçš„å…¬å¼å¾ˆåŸºæœ¬ï¼Œä½†åœ¨è®¸å¤šèµ„æ–™ä¸­éƒ½å¯¹å®ƒè¿›è¡Œäº†ç›¸å½“å¤æ‚ä¸”éš¾ä»¥ç†è§£çš„æè¿°ã€‚ <br><br>  <i>H = I-2 * n *ï¼ˆn ^ Tï¼‰</i> <br><br> å…¶ä¸­<i>H</i>æ˜¯å˜æ¢çŸ©é˜µï¼Œåœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œ <i>æˆ‘</i>æ˜¯Matrix4x4.identityï¼Œå¹¶ä¸”<i>n</i> =æ–°çš„Vector4ï¼ˆplaneNormal.xï¼ŒplaneNormal.yï¼ŒplaneNormal.zï¼Œ0ï¼‰ã€‚ ç¬¦å·Tè¡¨ç¤ºæ¢ä½ï¼Œå³ä¹˜ä»¥<i>n *ï¼ˆn ^ Tï¼‰å</i>å¾—åˆ°4x4çŸ©é˜µã€‚ <br><br> å®æ–½çš„æ–¹æ³•å°†æ´¾ä¸Šç”¨åœºï¼Œå¹¶ä¸”å½•éŸ³å°†éå¸¸ç´§å‡‘ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">æˆ·ä¸»è½¬å‹</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Matrix4x4 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HouseholderReflection</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Matrix4x4 matrix4X4, Vector3 planeNormal</span></span></span><span class="hljs-function">)</span></span> { planeNormal.Normalize(); Vector4 planeNormal4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector4(planeNormal.x, planeNormal.y, planeNormal.z, <span class="hljs-number"><span class="hljs-number">0</span></span>); Matrix4x4 householderMatrix = Matrix4x4.identity.Minus( MultiplyVectorsTransposed(planeNormal4, planeNormal4).MutiplyByNumber(<span class="hljs-number"><span class="hljs-number">2</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> householderMatrix * matrix4X4; }</code> </pre> <br></div></div><br> é‡è¦äº‹é¡¹ï¼šåº”è¯¥å¯¹planeNormalè¿›è¡Œæ ‡å‡†åŒ–ï¼ˆè¿™æ˜¯é€»è¾‘ä¸Šçš„ï¼‰ï¼Œæœ€åä¸€ä¸ªåæ ‡nåº”è¯¥ä¸º0ï¼Œè¿™æ ·å°±ä¸ä¼šåœ¨æ–¹å‘ä¸Šè¿›è¡Œæ‹‰ä¼¸ï¼Œå› ä¸ºå®ƒå–å†³äºå‘é‡nçš„é•¿åº¦ã€‚ <br><br> ç°åœ¨ä¸ºæ–¹ä¾¿èµ·è§ï¼Œæˆ‘ä»¬åœ¨Unityä¸­å®ç°æ‰©å±•æ–¹æ³•è¿›è¡Œè½¬æ¢ <br><br><div class="spoiler">  <b class="spoiler_title">åœ¨å±€éƒ¨åæ ‡ç³»ä¸­åæ˜ å˜æ¢</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LocalReflect</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Transform tr, Vector3 planeNormal</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> trs = tr.ExtractLocalTRS(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> reflected = trs.HouseholderReflection(planeNormal); tr.ApplyLocalTRS(reflected); }</code> </pre> <br></div></div><br> ä»Šå¤©å°±è¿™äº›äº†ï¼Œå¦‚æœè¿™ä¸€ç³»åˆ—æ–‡ç« å°†ç»§ç»­å¼•èµ·äººä»¬çš„å…´è¶£ï¼Œæˆ‘è¿˜å°†ä»‹ç»æ•°å­¦åœ¨æ¸¸æˆå¼€å‘ä¸­çš„å…¶ä»–åº”ç”¨ã€‚ è¿™æ¬¡å°†æ²¡æœ‰é¡¹ç›®ï¼Œå› ä¸ºæ‰€æœ‰ä»£ç éƒ½æ”¾åœ¨äº†æ–‡ç« ä¸­ï¼Œä½†æ˜¯å…·æœ‰ç‰¹å®šåº”ç”¨ç¨‹åºçš„é¡¹ç›®å°†åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ã€‚ ä»å›¾ç‰‡ä¸­ï¼Œæ‚¨å¯ä»¥çŒœæµ‹ä¸‹ä¸€ç¯‡æ–‡ç« çš„å†…å®¹ã€‚ <br><br><img src="https://habrastorage.org/webt/ln/0u/iv/ln0uivbr1o7yxfbiwyyumcbbkc8.png"><br><br> æ„Ÿè°¢æ‚¨çš„å…³æ³¨ï¼ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN432544/">https://habr.com/ru/post/zh-CN432544/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN432526/index.html">æ–°é¡¹ç›®è¯„ä¼°</a></li>
<li><a href="../zh-CN432536/index.html">å†¬å­£æˆ¿å±‹çš„ç©ºæ°”è´¨é‡</a></li>
<li><a href="../zh-CN432538/index.html">æ™ºèƒ½å®¶å±…ï¼Œæˆ‘è¿˜æ˜¯è®©ä½ </a></li>
<li><a href="../zh-CN432540/index.html">50å¹´åã€‚ æ‰€æœ‰æ¼”ç¤ºä¹‹æ¯</a></li>
<li><a href="../zh-CN432542/index.html">ä¸­å›½ç§‘å­¦å®¶å¼€å‘äº†å®ç”¨çš„å¯é‡å†™çƒ­æ•çº¸</a></li>
<li><a href="../zh-CN432546/index.html">ï¼ƒ278ç§»åŠ¨å¼€å‘äººå‘˜çš„æœ‰è¶£ææ–™æ‘˜è¦ï¼ˆ12æœˆ3æ—¥è‡³9æ—¥ï¼‰</a></li>
<li><a href="../zh-CN432548/index.html">ä½¿ç”¨Javaåº“åˆ›å»ºTelegramæœºå™¨äººçš„ç¤ºä¾‹</a></li>
<li><a href="../zh-CN432550/index.html">å¼•å…¥3CX v16 Alphaå’Œæ›´æ–°çš„3CX WebMeeting</a></li>
<li><a href="../zh-CN432552/index.html">â€œå¤´è„‘åœ¨çº¿ã€‚â€ æ„è¯†å…¬å¼</a></li>
<li><a href="../zh-CN432554/index.html">é“æ ¼æ‹‰æ–¯Â·æ©æ ¼å°”å·´ç‰¹ï¼ˆDouglas Engelbartï¼‰ï¼šåŠ å¼ºâ€œé›†ä½“æ™ºå•†â€ç¤¾ä¼š</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>