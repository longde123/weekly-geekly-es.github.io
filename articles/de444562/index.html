<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßñüèæ üß¢ üè¥‚Äç‚ò†Ô∏è Modernisierung von GHIDRA. Lader f√ºr Rum Sega Mega Drive üòø üÜí üë®üèΩ‚Äçüé®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Gr√º√üe, Genossen. Ich habe noch nichts von dem noch nicht Open-Source- GHIDRA , wahrscheinlich nur einem taub / blind / dumm / kein Internet-Reverse En...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Modernisierung von GHIDRA. Lader f√ºr Rum Sega Mega Drive</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/444562/"><p><img src="https://habrastorage.org/webt/_v/rj/sh/_vrjshbx1kl_9rudbdgaly0wd8c.png"></p><br><p> Gr√º√üe, Genossen.  Ich habe noch nichts von dem noch nicht Open-Source- <code>GHIDRA</code> , wahrscheinlich nur einem taub / blind / dumm / kein Internet-Reverse Engineer.  Die sofort einsatzbereiten Funktionen sind erstaunlich: Dekompilierer f√ºr alle unterst√ºtzten Prozessoren, einfaches Hinzuf√ºgen neuer Architekturen (mit sofortiger aktiver Dekompilierung aufgrund kompetenter Konvertierung in IR), eine Reihe von Skripten, die das Leben vereinfachen, die M√∂glichkeit des <code>Undo</code> / <code>Redo</code> ... Und dies ist nur ein sehr kleiner Teil aller bereitgestellten Funktionen.  Zu sagen, dass ich beeindruckt war, bedeutet fast nichts zu sagen. <a name="habracut"></a></p><br><p>  In diesem Artikel m√∂chte ich Ihnen erz√§hlen, wie ich mein erstes Modul f√ºr <code>GHIDRA</code> - einen <code>GHIDRA</code> f√ºr Spiele f√ºr <code>Sega Mega Drive / Genesis</code> .  Um es zu schreiben, brauchte ich ... nur ein paar Stunden!  Lass uns gehen. </p><br><div class="spoiler">  <b class="spoiler_title">Aber was ist mit der IDA?</b> <div class="spoiler_text"><p>  Ich habe einige Tage damit verbracht, den Prozess des Schreibens von Downloadern f√ºr die <code>IDA</code> verstehen.  Dann war es anscheinend Version <code>6.5</code> , aber damals gab es viele Probleme mit der SDK-Dokumentation. </p></div></div><br><h2 id="podgotavlivaem-sredu-razrabotki">  Wir bereiten die Entwicklungsumgebung vor </h2><br><p>  <code>GHIDRA</code> Entwickler haben fast alles <em>durchdacht</em> ( <em>Ilfak</em> , wo waren Sie vorher?).  Um die Implementierung der neuen Funktionalit√§t zu vereinfachen, haben sie ein Plug-In f√ºr <code>Eclipse</code> - <code>GhidraDev</code> , das tats√§chlich <em>beim</em> Schreiben von Code " <em>hilft</em> ".  Das Plugin ist in die Entwicklungsumgebung integriert und erm√∂glicht es Ihnen, Projektvorlagen f√ºr Skripte, Loader, Prozessormodule und Erweiterungen f√ºr diese sowie Exportmodule (so wie ich es verstehe, ist dies eine Art Export von Daten aus einem Projekt) mit wenigen Klicks zu erstellen. </p><br><p>  Um das Plugin zu installieren, laden Sie <code>Eclipse</code> f√ºr <code>Java</code> herunter, klicken Sie auf <code>Help</code> -&gt; <code>Install New Software...</code> , klicken Sie auf die Schaltfl√§che <code>Add</code> und √∂ffnen Sie den Archivauswahldialog mit dem Plugin √ºber die Schaltfl√§che <code>Archive...</code>  Das Archiv mit <code>GhidraDev</code> befindet sich im <code>$(GHIDRA)/Extensions/Eclipse/GhidraDev</code> .  W√§hlen Sie es aus und klicken Sie auf die Schaltfl√§che <code>Add</code> . </p><br><p><img src="https://habrastorage.org/webt/iq/ox/e3/iqoxe3k8b5www3rqb6i0cy_xadg.png"></p><br><p>  Legen Sie in der angezeigten Liste eine Morgend√§mmerung f√ºr <code>Ghidra</code> , klicken Sie auf <code>Next &gt;</code> , stimmen Sie den Vereinbarungen zu, klicken <code>Install Anyway</code> auf Trotzdem <code>Install Anyway</code> (da das Plugin keine Signatur hat) und starten Sie <code>Eclipse</code> . </p><br><p><img src="https://habrastorage.org/webt/h_/5h/_a/h_5h_auzh5po7rvzaaywyvzxz9o.png"></p><br><p>  Insgesamt wird im IDE- <code>GhidraDev</code> ein neues <code>GhidraDev</code> Element <code>GhidraDev</code> , mit dem Sie Ihre Projekte bequem erstellen und verteilen k√∂nnen (nat√ºrlich k√∂nnen Sie es auch √ºber den √ºblichen Assistenten f√ºr neue <code>Eclipse</code> Projekte erstellen).  Dar√ºber hinaus haben wir die M√∂glichkeit, das entwickelte Plug-In oder Skript zu debuggen. </p><br><p><img src="https://habrastorage.org/webt/ka/3m/tg/ka3mtgmipvkbbmib3bilgamwe44.png"></p><br><div class="spoiler">  <b class="spoiler_title">Und wo ist der Anwendungsdebugger?</b> <div class="spoiler_text"><p>  Was die Situation bei <code>GHIDRA</code> wirklich w√ºtend <code>GHIDRA</code> sind die verdammt heiseren Hype-Artikel, die fast das gleiche Material enthalten, was im √úbrigen nicht stimmt.  Ein Beispiel?  Ja, bitte: </p><br><blockquote>  Die aktuelle Version des Tools ist 9.0.  Das Tool bietet Optionen f√ºr zus√§tzliche Funktionen wie Kryptoanalyse und Interaktion mit OllyDbg, dem Ghidra-Debugger. </blockquote><p>  Und wo ist das alles?  Nein! </p><br><p>  Der zweite Punkt: Offenheit.  In der Tat ist es fast da, aber es ist praktisch nicht vorhanden.  Die <code>GHIDRA</code> enth√§lt Quellcodes f√ºr Komponenten, die in <code>Java</code> wurden. Wenn Sie sich jedoch <code>Gradle</code> Skripte ansehen, k√∂nnen Sie feststellen, dass Abh√§ngigkeiten von einer Reihe externer Projekte von geheimen bestehen <del>  Laboratorien </del>  <code>NSA</code> Repositories. <br>  Zum Zeitpunkt des Schreibens gibt es keine Dekompiler- und <code>SLEIGH</code> (dies ist ein Dienstprogramm zum Kompilieren von Beschreibungen von Prozessormodulen und Konvertierungen in IR). </p><br><p>  Na ja, ich bin von etwas abgelenkt. </p></div></div><br><p>  Erstellen wir also ein neues Projekt in <code>Eclipse</code> . </p><br><h2 id="sozdayom-proekt-zagruzchika">  Erstellen Sie ein Loader-Projekt </h2><br><p>  <code>GhidraDev</code> -&gt; <code>New</code> -&gt; <code>Ghidra Module Project...</code> <code>GhidraDev</code> <code>Ghidra Module Project...</code> </p><br><p>  Wir geben den Namen des Projekts an (wir ber√ºcksichtigen, dass W√∂rter vom Typ <code>Loader</code> an die Dateinamen geklebt werden, und um so etwas wie <code>sega_loaderLoader.java</code> nicht zu erhalten, <code>sega_loaderLoader.java</code> wir sie entsprechend). </p><br><p><img src="https://habrastorage.org/webt/ok/iq/kx/okiqkxnztehs89bnjh3wzen848w.png"></p><br><p>  Klicken Sie auf <code>Next &gt;</code> .  Hier stellen wir die Morgend√§mmerung vor die Kategorien, die wir brauchen.  In meinem Fall ist dies nur ein <code>Loader</code> .  Klicken Sie auf <code>Next &gt;</code> . </p><br><p><img src="https://habrastorage.org/webt/3g/-c/_6/3g-c_6t4e10co47udy8txa7udiq.png"></p><br><p>  Hier geben wir den Pfad zum Verzeichnis mit <code></code> .  Klicken Sie auf <code>Next &gt;</code> . </p><br><p><img src="https://habrastorage.org/webt/9p/j6/kc/9pj6kcva-wqfiggwzf3itwssqm8.png"></p><br><p>  <code>GHIDRA</code> k√∂nnen <code>GHIDRA</code> Skripte in Python schreiben (√ºber <code>Jython</code> ).  Ich werde in <code>Java</code> schreiben, damit ich keine Morgenr√∂te mache.  Ich dr√ºcke auf <code>Finish</code> . </p><br><p><img src="https://habrastorage.org/webt/_d/dr/z5/_ddrz5hnlfc0g-fnztl248er0tw.png"></p><br><h2 id="pishem-kod">  Einen Code schreiben </h2><br><p>  Der leere Projektbaum sieht beeindruckend aus: </p><br><p><img src="https://habrastorage.org/webt/mn/vf/fx/mnvffx-jubdk6uqdcpw5njysqfe.png"></p><br><p>  Alle Dateien mit <code>java</code> Code befinden sich im Zweig <code>/src/main/java</code> : </p><br><p><img src="https://habrastorage.org/webt/xz/sx/6_/xzsx6_dw-avgpgufemblxrnbutm.png"></p><br><h3 id="getname">  getName () </h3><br><p>  W√§hlen Sie zun√§chst einen Namen f√ºr den Bootloader.  Die Methode <code>getName()</code> gibt <code>getName()</code> zur√ºck: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Sega Mega Drive / Genesis Loader"</span></span>; }</code> </pre> <br><h3 id="findsupportedloadspecs">  findSupportedLoadSpecs () </h3><br><p>  Die Methode <code>findSupportedLoadSpecs()</code> entscheidet (basierend auf den in der Bin√§rdatei enthaltenen Daten), welches Prozessormodul f√ºr die Demontage (sowie in der <code>IDA</code> ) verwendet werden soll.  In der <code>GHIDRA</code> Terminologie <code>GHIDRA</code> dies als <code>Compiler Language</code> .  Es enth√§lt: Prozessor, Endianness, Bitness und Compiler (falls bekannt). </p><br><p>  Diese Methode gibt eine Liste der unterst√ºtzten Architekturen und Sprachen zur√ºck.  Wenn die Daten im falschen Format vorliegen, geben wir einfach eine leere Liste zur√ºck. </p><br><p>  Im Fall von <code>Sega Mega Drive</code> ist das Wort " <code>SEGA</code> " am h√§ufigsten am Offset <code>0x100</code> Headers vorhanden (dies ist keine Voraussetzung, wird aber in 99% der F√§lle erf√ºllt).  Sie m√ºssen √ºberpr√ºfen, ob diese Zeile in der importierten Datei enthalten ist.  Zu diesem <code>ByteProvider provider</code> wird der <code>ByteProvider provider</code> <code>findSupportedLoadSpecs()</code> , mit der wir mit der Datei arbeiten. </p><br><p>  Wir erstellen ein <code>BinaryReader</code> Objekt, um das Lesen von Daten aus einer Datei zu <code>BinaryReader</code> : </p><br><pre> <code class="java hljs">BinaryReader reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryReader(provider, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>);</code> </pre> <br><p>  Das <code>false</code> Argument in diesem Fall weist auf die Verwendung von <code>Big Endian</code> beim Lesen hin.  Nun lesen wir die Zeile.  Verwenden Sie dazu die Methode <code>readAsciiString(offset, size)</code> des <code>reader</code> Objekts: </p><br><pre> <code class="java hljs">reader.readAsciiString(<span class="hljs-number"><span class="hljs-number">0x100</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>).equals(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String(<span class="hljs-string"><span class="hljs-string">"SEGA"</span></span>))</code> </pre> <br><p>  Wenn <code>equals()</code> <code>true</code> zur√ºckgibt, handelt es sich um Segov rum und in der Liste <code>List&lt;LoadSpec&gt; loadSpecs = new ArrayList&lt;&gt;();</code>  Es wird m√∂glich sein, Motorola <code>m68k</code> hinzuzuf√ºgen.  Erstellen Sie dazu ein neues Objekt vom Typ <code>LoadSpec</code> , dessen Konstruktor ein Loader-Objekt (in diesem Fall <code>this</code> ), <code>ImageBase</code> , in das das ROM geladen wird, ein Objekt vom Typ <code>LanguageCompilerSpecPair</code> und ein Flag <code>LoadSpec</code> dieses <code>LoadSpec</code> unter den anderen in der Liste <code>LoadSpec</code> (ja, in der Liste) <code>LoadSpec</code> Es kann mehr als eine <code>LoadSpec</code> . </p><br><p>  Das Konstruktorformat f√ºr <code>LanguageCompilerSpecPair</code> wie folgt: </p><br><ol><li>  Das erste Argument ist <code>languageID</code> , eine Zeichenfolge der Form " <em>ProcessorName: Endianness: Bits: ExactCpu</em> ".  In meinem Fall sollte es die Zeile " <em>68000: BE: 32: MC68020</em> " sein (leider ist genau der <code>MC68000</code> nicht im Lieferumfang enthalten, aber dies ist kein solches Problem).  <code>ExactCpu</code> m√∂glicherweise <code>default</code> </li><li>  Das zweite Argument, <code>compilerSpecID</code> , um zu finden, was Sie hier angeben m√ºssen, befindet sich im Verzeichnis mit den <code></code> Prozessorbeschreibungen ( <code>$(GHIDRA)/Ghidra/Processors/68000/data/languages</code> ) in der Datei <code>68000.opinion</code> .  Wir sehen, dass hier nur die <code>default</code> angegeben ist.  Eigentlich geben wir es an </li></ol><br><p>  Als Ergebnis haben wir den folgenden Code (wie Sie sehen k√∂nnen, bisher nichts Kompliziertes): </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Collection&lt;LoadSpec&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">findSupportedLoadSpecs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ByteProvider provider)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ List&lt;LoadSpec&gt; loadSpecs = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); BinaryReader reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryReader(provider, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (reader.readAsciiString(<span class="hljs-number"><span class="hljs-number">0x100</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>).equals(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String(<span class="hljs-string"><span class="hljs-string">"SEGA"</span></span>))) { loadSpecs.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LoadSpec(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LanguageCompilerSpecPair(<span class="hljs-string"><span class="hljs-string">"68000:BE:32:MC68020"</span></span>, <span class="hljs-string"><span class="hljs-string">"default"</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> loadSpecs; }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Der Unterschied zwischen IDA und GHIDRA in Bezug auf Module</b> <div class="spoiler_text"><p>  Es gibt einen Unterschied und es ist immer noch sehr stark.  In <code>GHIDRA</code> Sie ein Projekt schreiben, das unterschiedliche Architekturen, unterschiedliche Datenformate, einen Loader, ein Prozessormodul, eine Erweiterung der Decompiler-Funktionalit√§t und andere Extras versteht. </p><br><p>  In der <code>IDA</code> ist dies ein separates Projekt f√ºr jeden Add-On-Typ. </p><br><p>  Wie viel bequemer?  Meiner Meinung nach bei <code>GHIDRA</code> - manchmal! </p></div></div><br><h3 id="load">  load () </h3><br><p>  Bei dieser Methode erstellen wir Segmente, verarbeiten Eingabedaten, erstellen Code und zuvor bekannte Beschriftungen.  Dazu werden folgende Objekte eingereicht, um uns am Eingang zu helfen: </p><br><ol><li>  <code>ByteProvider provider</code> : Wir kennen ihn bereits.  Arbeiten mit Bin√§rdateidaten </li><li>  <code>LoadSpec loadSpec</code> : Angabe der Architektur, die w√§hrend der <code>findSupportedLoadSpecs</code> der Datei mit der Methode <code>findSupportedLoadSpecs</code> .  Es ist notwendig, wenn wir beispielsweise mit mehreren Datenformaten in einem Modul arbeiten k√∂nnen.  Bequem </li><li>  <code>List&lt;Option&gt; options</code> : Liste der Optionen (einschlie√ülich benutzerdefinierter Optionen).  Ich habe noch nicht gelernt, mit ihnen zu arbeiten </li><li>  <code>Program program</code> : Das Hauptobjekt, das Zugriff auf alle erforderlichen Funktionen bietet: Auflistung, Adressraum, Segmente, Beschriftungen, Erstellen von Arrays usw. </li><li>  <code>MemoryConflictHandler handler</code> und <code>TaskMonitor monitor</code> : Wir m√ºssen selten direkt mit ihnen arbeiten (normalerweise √ºbergeben wir diese Objekte nur an vorgefertigte Methoden). </li><li>  <code>MessageLog log</code> : Logger selbst </li></ol><br><p>  Lassen Sie uns zun√§chst einige Objekte erstellen, die unsere Arbeit mit <code>GHIDRA</code> Entit√§ten und vorhandenen Daten vereinfachen.  Nat√ºrlich brauchen wir auf jeden Fall <code>BinaryReader</code> : </p><br><pre> <code class="java hljs">BinaryReader reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryReader(provider, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>);</code> </pre> <br><p>  Weiter.  Es wird f√ºr uns sehr n√ºtzlich sein und fast das gesamte Objekt der <code>FlatProgramAPI</code> Klasse vereinfachen (Sie werden sp√§ter sehen, was Sie damit tun k√∂nnen): </p><br><pre> <code class="java hljs">FlatProgramAPI fpa = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FlatProgramAPI(program, monitor);</code> </pre> <br><h4 id="zagolovok-roma">  Rum √úberschrift </h4><br><p>  Zun√§chst werden wir bestimmen, wie die √úberschrift eines gew√∂hnlichen Sega-Rums lautet.  In den ersten <code>0x100</code> Bytes gibt es eine Tabelle mit 64 DWORD-Zeigern auf Vektoren, zum Beispiel: <code>Reset</code> , <code>Trap</code> , <code>DivideByZero</code> , <code>VBLANK</code> und andere. </p><br><p>  Als n√§chstes folgt die Struktur mit dem Namen der Roma, Regionen, Adressen des Anfangs und Endes der <code>ROM</code> und <code>RAM</code> Bl√∂cke, dem Kontrollk√§stchen (das Feld wird auf Anfrage der Entwickler und nicht dem Pr√§fix aktiviert) und anderen Informationen. </p><br><p>  Erstellen wir <code>java</code> Klassen, um mit diesen Strukturen zu arbeiten und die Datentypen zu implementieren, die der Liste der Strukturen hinzugef√ºgt werden. </p><br><h4 id="vectorstable">  VectorsTable </h4><br><p>  Wir erstellen eine neue Klasse <code>VectorsTable</code> und weisen darauf hin, dass sie die <code>StructConverter</code> Schnittstelle implementiert.  In dieser Klasse speichern wir die Adressen von Vektoren (f√ºr die zuk√ºnftige Verwendung) und deren Namen. </p><br><p><img src="https://habrastorage.org/webt/au/3c/m-/au3cm-qdnrviqcgqtn_asztwbao.png"></p><br><p>  Wir deklarieren eine Liste von Vektornamen und deren Nummer: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> VECTORS_SIZE = <span class="hljs-number"><span class="hljs-number">0x100</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> VECTORS_COUNT = VECTORS_SIZE / <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String[] VECTOR_NAMES = { <span class="hljs-string"><span class="hljs-string">"SSP"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reset"</span></span>, <span class="hljs-string"><span class="hljs-string">"BusErr"</span></span>, <span class="hljs-string"><span class="hljs-string">"AdrErr"</span></span>, <span class="hljs-string"><span class="hljs-string">"InvOpCode"</span></span>, <span class="hljs-string"><span class="hljs-string">"DivBy0"</span></span>, <span class="hljs-string"><span class="hljs-string">"Check"</span></span>, <span class="hljs-string"><span class="hljs-string">"TrapV"</span></span>, <span class="hljs-string"><span class="hljs-string">"GPF"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trace"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv0"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv1"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv2"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv4"</span></span>, <span class="hljs-string"><span class="hljs-string">"BadInt"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv10"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv11"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv12"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv13"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv14"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv15"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv16"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv17"</span></span>, <span class="hljs-string"><span class="hljs-string">"BadIRQ"</span></span>, <span class="hljs-string"><span class="hljs-string">"IRQ1"</span></span>, <span class="hljs-string"><span class="hljs-string">"EXT"</span></span>, <span class="hljs-string"><span class="hljs-string">"IRQ3"</span></span>, <span class="hljs-string"><span class="hljs-string">"HBLANK"</span></span>, <span class="hljs-string"><span class="hljs-string">"IRQ5"</span></span>, <span class="hljs-string"><span class="hljs-string">"VBLANK"</span></span>, <span class="hljs-string"><span class="hljs-string">"IRQ7"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap0"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap1"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap2"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap3"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap4"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap5"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap6"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap7"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap8"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap9"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap10"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap11"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap12"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap13"</span></span>,<span class="hljs-string"><span class="hljs-string">"Trap14"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap15"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv30"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv31"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv32"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv33"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv34"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv35"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv36"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv37"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv38"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv39"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3A"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3B"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3C"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3D"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3E"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3F"</span></span> };</code> </pre> <br><p>  Wir erstellen eine separate Klasse zum Speichern der Adresse und des Vektornamens: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> sega; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.model.address.Address; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VectorFunc</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Address address; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">VectorFunc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Address address, String name)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.address = address; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name = name; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAddress</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> address; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> name; } }</code> </pre> <br><p>  Die Liste der Vektoren wird im Vektorarray gespeichert: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> VectorFunc[] vectors;</code> </pre> <br><p>  Der Konstruktor f√ºr <code>VectorsTable</code> akzeptiert: </p><br><ol><li>  <code>FlatProgramAPI fpa</code> zum Konvertieren <code>long</code> Adressen in den <code>Address</code> von Hydra (tats√§chlich erg√§nzt dieser Datentyp den einfachen numerischen Wert der Adresse, indem er sie an einen anderen Chip bindet - den Adressraum). </li><li>  <code>BinaryReader reader</code> - Leseh√∂fe </li></ol><br><p>  Das <code>fpa</code> Objekt hat eine <code>toAddr()</code> -Methode, und der <code>reader</code> hat <code>setPointerIndex()</code> und <code>readNextUnsignedInt()</code> .  Grunds√§tzlich ist nichts mehr erforderlich.  Wir bekommen den Code: </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">VectorsTable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, BinaryReader reader)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (reader.length() &lt; VECTORS_COUNT) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } reader.setPointerIndex(<span class="hljs-number"><span class="hljs-number">0</span></span>); vectors = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> VectorFunc[VECTORS_COUNT]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; VECTORS_COUNT; ++i) { vectors[i] = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> VectorFunc(fpa.toAddr(reader.readNextUnsignedInt()), VECTOR_NAMES[i]); } }</code> </pre> <br><p>  Die <code>toDataType()</code> -Methode, die wir √ºberschreiben m√ºssen, um die Struktur zu implementieren, sollte ein <code>Structure</code> , in dem die Namen der Strukturfelder, ihre Gr√∂√üen und Kommentare zu jedem Feld deklariert werden sollten (Sie k√∂nnen <code>null</code> ): </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> DataType </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toDataType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Structure s = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StructureDataType(<span class="hljs-string"><span class="hljs-string">"VectorsTable"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; VECTORS_COUNT; ++i) { s.add(POINTER, <span class="hljs-number"><span class="hljs-number">4</span></span>, VECTOR_NAMES[i], <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s; }</code> </pre> <br><p>  Lassen Sie uns Methoden implementieren, um jeden der Vektoren oder die gesamte Liste (eine Reihe von Boilerplate-Code) abzurufen: </p><br><div class="spoiler">  <b class="spoiler_title">Andere Methoden</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> VectorFunc[] getVectors() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSSP</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">0</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">1</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getBusErr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">3</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">2</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAdrErr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">3</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getInvOpCode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">4</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDivBy0</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">6</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">5</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCheck</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">6</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrapV</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">7</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getGPF</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">9</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">8</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrace</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">9</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv0</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">11</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">10</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">12</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">11</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">13</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">12</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">14</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">13</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv4</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">15</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">14</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getBadInt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">16</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">15</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv10</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">17</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">16</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv11</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">18</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">17</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv12</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">19</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">18</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv13</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">20</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">19</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv14</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">21</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">20</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv15</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">22</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">21</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv16</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">23</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">22</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv17</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">24</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">23</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getBadIRQ</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">25</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">24</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIRQ1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">26</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">25</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getEXT</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">27</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">26</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIRQ3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">28</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">27</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getHBLANK</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">29</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">28</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIRQ5</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">30</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">29</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getVBLANK</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">31</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">30</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIRQ7</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">32</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">31</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap0</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">33</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">32</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">34</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">33</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">35</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">34</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">36</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">35</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap4</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">37</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">36</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap5</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">38</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">37</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap6</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">39</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">38</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap7</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">40</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">39</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap8</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">41</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">40</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap9</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">42</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">41</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap10</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">43</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">42</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap11</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">44</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">43</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap12</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">45</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">44</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap13</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">46</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">45</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap14</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">47</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">46</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap15</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">48</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">47</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv30</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">49</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">48</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv31</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">50</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">49</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv32</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">51</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">50</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv33</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">52</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">51</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv34</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">53</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">52</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv35</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">54</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">53</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv36</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">55</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">54</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv37</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">56</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">55</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv38</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">57</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">56</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv39</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">58</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">57</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3A</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">59</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">58</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3B</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">60</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">59</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3C</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">61</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">60</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3D</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">62</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">61</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3E</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">63</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">62</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3F</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">64</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">63</span></span>]; }</code> </pre> </div></div><br><h4 id="gameheader">  Gameheader </h4><br><p>  Wir werden dasselbe tun und eine <code>GameHeader</code> Klasse erstellen, die die <code>StructConverter</code> Schnittstelle implementiert. </p><br><div class="spoiler">  <b class="spoiler_title">Game Rum Header Struktur</b> <div class="spoiler_text"><table><thead><tr><th>  Offset starten </th><th>  Endversatz </th><th>  Beschreibung </th></tr></thead><tbody><tr><td>  100 $ </td><td>  $ 10F </td><td>  Konsolenname (normalerweise 'SEGA MEGA DRIVE' oder 'SEGA GENESIS') </td></tr><tr><td>  $ 110 </td><td>  $ 11F </td><td>  Erscheinungsdatum (normalerweise '¬© XXXX YYYY.MMM', wobei XXXX der Buchungskreis ist, YYYY das Jahr und MMM - Monat) </td></tr><tr><td>  120 $ </td><td>  $ 14F </td><td>  Inl√§ndischer Name </td></tr><tr><td>  $ 150 </td><td>  $ 17F </td><td>  Internationaler Name </td></tr><tr><td>  $ 180 </td><td>  $ 18D </td><td>  Version ('XX JJJJJJJJJJ' 'wobei XX der Spieltyp und JJ der Spielcode ist) </td></tr><tr><td>  $ 18E </td><td>  $ 18F </td><td>  Pr√ºfsumme </td></tr><tr><td>  190 $ </td><td>  $ 19F </td><td>  E / A-Unterst√ºtzung </td></tr><tr><td>  $ 1A0 </td><td>  $ 1A3 </td><td>  ROM-Start </td></tr><tr><td>  $ 1A4 </td><td>  $ 1A7 </td><td>  ROM-Ende </td></tr><tr><td>  $ 1A8 </td><td>  $ 1AB </td><td>  RAM-Start (normalerweise $ 00FF0000) </td></tr><tr><td>  $ 1AC </td><td>  $ 1AF </td><td>  RAM-Ende (normalerweise $ 00FFFFFF) </td></tr><tr><td>  $ 1B0 </td><td>  $ 1B2 </td><td>  'RA' und $ F8 aktivieren SRAM </td></tr><tr><td>  $ 1B3 </td><td>  ---- </td><td>  unbenutzt ($ 20) </td></tr><tr><td>  $ 1B4 </td><td>  $ 1B7 </td><td>  SRAM-Start (Standard $ 00200000) </td></tr><tr><td>  $ 1B8 </td><td>  $ 1BB </td><td>  SRAM-Ende (Standard $ 0020FFFF) </td></tr><tr><td>  $ 1BC </td><td>  $ 1FF </td><td>  Notizen (unbenutzt) </td></tr></tbody></table></div></div><br><p>  Wir richten die Felder ein, pr√ºfen, ob die Eingabedaten ausreichend lang sind, verwenden die beiden neuen Methoden <code>readNextByteArray()</code> , <code>readNextUnsignedShort()</code> des <code>reader</code> Objekts, um Daten zu lesen, und erstellen eine Struktur.  Der resultierende Code lautet wie folgt: </p><br><div class="spoiler">  <b class="spoiler_title">Gameheader</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> sega; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.app.util.bin.BinaryReader; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.app.util.bin.StructConverter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.flatapi.FlatProgramAPI; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.model.address.Address; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.model.data.DataType; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.model.data.Structure; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.model.data.StructureDataType; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GameHeader</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StructConverter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] consoleName = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] releaseDate = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] domesticName = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] internationalName = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] version = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> checksum = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] ioSupport = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Address romStart = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, romEnd = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Address ramStart = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, ramEnd = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] sramCode = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> unused = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Address sramStart = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, sramEnd = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] notes = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; FlatProgramAPI fpa; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GameHeader</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, BinaryReader reader)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.fpa = fpa; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (reader.length() &lt; <span class="hljs-number"><span class="hljs-number">0x200</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } reader.setPointerIndex(<span class="hljs-number"><span class="hljs-number">0x100</span></span>); consoleName = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x10</span></span>); releaseDate = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x10</span></span>); domesticName = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x30</span></span>); internationalName = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x30</span></span>); version = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x0E</span></span>); checksum = (<span class="hljs-keyword"><span class="hljs-keyword">short</span></span>) reader.readNextUnsignedShort(); ioSupport = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x10</span></span>); romStart = fpa.toAddr(reader.readNextUnsignedInt()); romEnd = fpa.toAddr(reader.readNextUnsignedInt()); ramStart = fpa.toAddr(reader.readNextUnsignedInt()); ramEnd = fpa.toAddr(reader.readNextUnsignedInt()); sramCode = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x03</span></span>); unused = reader.readNextByte(); sramStart = fpa.toAddr(reader.readNextUnsignedInt()); sramEnd = fpa.toAddr(reader.readNextUnsignedInt()); notes = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x44</span></span>); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> DataType </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toDataType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Structure s = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StructureDataType(<span class="hljs-string"><span class="hljs-string">"GameHeader"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-string"><span class="hljs-string">"ConsoleName"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-string"><span class="hljs-string">"ReleaseDate"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x30</span></span>, <span class="hljs-string"><span class="hljs-string">"DomesticName"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x30</span></span>, <span class="hljs-string"><span class="hljs-string">"InternationalName"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x0E</span></span>, <span class="hljs-string"><span class="hljs-string">"Version"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(WORD, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-string"><span class="hljs-string">"Checksum"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-string"><span class="hljs-string">"IoSupport"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"RomStart"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"RomEnd"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"RamStart"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"RamEnd"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x03</span></span>, <span class="hljs-string"><span class="hljs-string">"SramCode"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(BYTE, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-string"><span class="hljs-string">"Unused"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"SramStart"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"SramEnd"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x44</span></span>, <span class="hljs-string"><span class="hljs-string">"Notes"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getConsoleName() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> consoleName; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getReleaseDate() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> releaseDate; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getDomesticName() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> domesticName; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getInternationalName() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> internationalName; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getVersion() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> version; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getChecksum</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> checksum; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getIoSupport() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ioSupport; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRomStart</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> romStart; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRomEnd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> romEnd; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRamStart</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ramStart; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRamEnd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ramEnd; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getSramCode() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sramCode; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">byte</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUnused</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> unused; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSramStart</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sramStart; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSramEnd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sramEnd; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hasSRAM</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sramCode == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sramCode[<span class="hljs-number"><span class="hljs-number">0</span></span>] == <span class="hljs-string"><span class="hljs-string">'R'</span></span> &amp;&amp; sramCode[<span class="hljs-number"><span class="hljs-number">1</span></span>] == <span class="hljs-string"><span class="hljs-string">'A'</span></span> &amp;&amp; sramCode[<span class="hljs-number"><span class="hljs-number">2</span></span>] == <span class="hljs-number"><span class="hljs-number">0xF8</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getNotes() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> notes; } }</code> </pre> </div></div><br><p>  Erstellen Sie Objekte f√ºr den Header: </p><br><pre> <code class="java hljs">vectors = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> VectorsTable(fpa, reader); header = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GameHeader(fpa, reader);</code> </pre> <br><h4 id="segmenty">  Segmente </h4><br><p>  Sega hat eine bekannte Karte von Speicherbereichen, die ich hier vielleicht nicht in Form einer Tabelle angeben werde, sondern nur den Code, der zum Erstellen der Segmente verwendet wird. </p><br><p>  Das Objekt der <code>FlatProgramAPI</code> Klasse verf√ºgt also √ºber eine <code>createMemoryBlock()</code> -Methode, mit der bequem Speicherbereiche erstellt werden k√∂nnen.  Bei der Eingabe werden die folgenden Argumente verwendet: </p><br><ol><li>  <code>name</code> : Name der Region </li><li>  <code>address</code> : Startadresse der Region </li><li>  <code>stream</code> : Ein Objekt vom Typ <code>InputStream</code> , das die Basis f√ºr die Daten im Speicherbereich bildet.  Wenn Sie <code>null</code> angeben, wird ein nicht initialisierter Bereich erstellt (f√ºr <code>68K RAM</code> oder <code>Z80 RAM</code> ben√∂tigen wir genau das </li><li>  <code>size</code> : Gr√∂√üe der erstellten Region </li><li>  <code>isOverlay</code> : <code>isOverlay</code> <code>true</code> oder <code>false</code> und zeigt an, dass der Speicherbereich √ºberlagert ist.  Wo es neben ausf√ºhrbaren Dateien ben√∂tigt wird </li></ol><br><p>  In der Ausgabe gibt <code>createMemoryBlock()</code> ein Objekt vom Typ <code>MemoryBlock</code> , f√ºr das Sie optional Zugriffsrechte-Flags ( <code>Read</code> , <code>Write</code> , <code>Execute</code> ) setzen k√∂nnen. </p><br><p>  Als Ergebnis erhalten wir eine Funktion der folgenden Form: </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createSegment</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, InputStream stream, String name, Address address, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> size, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> read, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> write, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> execute)</span></span></span><span class="hljs-function"> </span></span>{ MemoryBlock block = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { block = fpa.createMemoryBlock(name, address, stream, size, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); block.setRead(read); block.setWrite(read); block.setExecute(execute); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, String.format(<span class="hljs-string"><span class="hljs-string">"Error creating %s segment"</span></span>, name)); } }</code> </pre> <br><p>  Hier haben wir zus√§tzlich die statische <code>error</code> der <code>Msg</code> Klasse aufgerufen, um eine Fehlermeldung anzuzeigen. </p><br><p>  Ein Segment mit <code>0x3FFFFF</code> kann eine maximale Gr√∂√üe von <code>0x3FFFFF</code> (alles andere geh√∂rt bereits zu anderen Regionen).  Lassen Sie es uns erstellen: </p><br><pre> <code class="java hljs">InputStream romStream = provider.getInputStream(<span class="hljs-number"><span class="hljs-number">0</span></span>); createSegment(fpa, romStream, <span class="hljs-string"><span class="hljs-string">"ROM"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0x000000</span></span>), Math.min(romStream.available(), <span class="hljs-number"><span class="hljs-number">0x3FFFFF</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>);</code> </pre> <br><p>    <code>InputStream</code>    ,    0. </p><br><p>       ,     ( <code>SegaCD</code>  <code>Sega32X</code> ).        <code>OptionDialog</code> . , <code>showYesNoDialogWithNoAsDefaultButton()</code>      <code>YES</code>  <code>NO</code>   -  <code>NO</code> . </p><br><p>    : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (OptionDialog.YES_OPTION == OptionDialog.showYesNoDialogWithNoAsDefaultButton(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Question"</span></span>, <span class="hljs-string"><span class="hljs-string">"Create Sega CD segment?"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (romStream.available() &gt; <span class="hljs-number"><span class="hljs-number">0x3FFFFF</span></span>) { InputStream epaStream = provider.getInputStream(<span class="hljs-number"><span class="hljs-number">0x400000</span></span>); createSegment(fpa, epaStream, <span class="hljs-string"><span class="hljs-string">"EPA"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0x400000</span></span>), <span class="hljs-number"><span class="hljs-number">0x400000</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"EPA"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0x400000</span></span>), <span class="hljs-number"><span class="hljs-number">0x400000</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (OptionDialog.YES_OPTION == OptionDialog.showYesNoDialogWithNoAsDefaultButton(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Question"</span></span>, <span class="hljs-string"><span class="hljs-string">"Create Sega 32X segment?"</span></span>)) { createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"32X"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0x800000</span></span>), <span class="hljs-number"><span class="hljs-number">0x200000</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); }</code> </pre> <br><p>      : </p><br><pre> <code class="java hljs">createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Z80"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA00000</span></span>), <span class="hljs-number"><span class="hljs-number">0x10000</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"SYS1"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10000</span></span>), <span class="hljs-number"><span class="hljs-number">16</span></span> * <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"SYS2"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11000</span></span>), <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Z802"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11100</span></span>), <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Z803"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11200</span></span>), <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"FDC"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA12000</span></span>), <span class="hljs-number"><span class="hljs-number">0x100</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"TIME"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA13000</span></span>), <span class="hljs-number"><span class="hljs-number">0x100</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"TMSS"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA14000</span></span>), <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"VDP"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00000</span></span>), <span class="hljs-number"><span class="hljs-number">2</span></span> * <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"RAM"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xFF0000</span></span>), <span class="hljs-number"><span class="hljs-number">0x10000</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (header.hasSRAM()) { Address sramStart = header.getSramStart(); Address sramEnd = header.getSramEnd(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sramStart.getOffset() &gt;= <span class="hljs-number"><span class="hljs-number">0x200000</span></span> &amp;&amp; sramEnd.getOffset() &lt;= <span class="hljs-number"><span class="hljs-number">0x20FFFF</span></span> &amp;&amp; sramStart.getOffset() &lt; sramEnd.getOffset()) { createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"SRAM"</span></span>, sramStart, sramEnd.getOffset() - sramStart.getOffset() + <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } }</code> </pre> <br><h4 id="massivy-metki-i-konkretnye-adresa"> ,     </h4><br><p>       <code>CreateArrayCmd</code> .   ,     : </p><br><ol><li> <code>address</code> : ,      </li><li> <code>numElements</code> :    </li><li> <code>dataType</code> :       </li><li> <code>elementSize</code> :    </li></ol><br><p>        <code>applyTo(program)</code> ,   . </p><br><p>        ,    ,  <code>BYTE</code> , <code>WORD</code> , <code>DWORD</code>  .  ,    <code>FlatProgramAPI</code>   <code>createByte()</code> , <code>createWord()</code> , <code>createDword()</code>  .. </p><br><p>  ,    ,       (,     <code>VDP</code> ).  ,    : </p><br><ol><li>    <code>Program</code>   <code>getSymbolTable()</code> ,       ,   .. </li><li>      <code>createLabel()</code> ,     ,    .      , ,     <code>SourceType.IMPORTED</code>      </li></ol><br><p>          ,   : </p><br><div class="spoiler"> <b class="spoiler_title">    </b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createNamedByteArray</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, Program program, Address address, String name, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> numElements)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (numElements &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { CreateArrayCmd arrayCmd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CreateArrayCmd(address, numElements, ByteDataType.dataType, ByteDataType.dataType.getLength()); arrayCmd.applyTo(program); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { fpa.createByte(address); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Cannot create byte. "</span></span> + e.getMessage()); } } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { program.getSymbolTable().createLabel(address, name, SourceType.IMPORTED); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InvalidInputException e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, String.format(<span class="hljs-string"><span class="hljs-string">"%s : Error creating array %s"</span></span>, getName(), name)); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createNamedWordArray</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, Program program, Address address, String name, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> numElements)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (numElements &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { CreateArrayCmd arrayCmd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CreateArrayCmd(address, numElements, WordDataType.dataType, WordDataType.dataType.getLength()); arrayCmd.applyTo(program); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { fpa.createWord(address); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Cannot create word. "</span></span> + e.getMessage()); } } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { program.getSymbolTable().createLabel(address, name, SourceType.IMPORTED); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InvalidInputException e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, String.format(<span class="hljs-string"><span class="hljs-string">"%s : Error creating array %s"</span></span>, getName(), name)); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createNamedDwordArray</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, Program program, Address address, String name, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> numElements)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (numElements &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { CreateArrayCmd arrayCmd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CreateArrayCmd(address, numElements, DWordDataType.dataType, DWordDataType.dataType.getLength()); arrayCmd.applyTo(program); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { fpa.createDWord(address); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Cannot create dword. "</span></span> + e.getMessage()); } } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { program.getSymbolTable().createLabel(address, name, SourceType.IMPORTED); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InvalidInputException e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, String.format(<span class="hljs-string"><span class="hljs-string">"%s : Error creating array %s"</span></span>, getName(), name)); } }</code> </pre> </div></div><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><pre> <code class="java hljs">createNamedDwordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA04000</span></span>), <span class="hljs-string"><span class="hljs-string">"Z80_YM2612"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10000</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_PCBVER"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10002</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT1_DATA"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10004</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT2_DATA"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10006</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_EXT_DATA"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10008</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT1_CTRL"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1000A</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT2_CTRL"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1000C</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_EXT_CTRL"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1000E</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT1_RX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10010</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT1_TX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10012</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT1_SMODE"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10014</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT2_RX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10016</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT2_TX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10018</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT2_SMODE"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1001A</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_EXT_RX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1001C</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_EXT_TX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1001E</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_EXT_SMODE"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11000</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_RAMMODE"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11100</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_Z80BUS"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11200</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_Z80RES"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedByteArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA12000</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_FDC"</span></span>, <span class="hljs-number"><span class="hljs-number">0x100</span></span>); createNamedByteArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA13000</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_TIME"</span></span>, <span class="hljs-number"><span class="hljs-number">0x100</span></span>); createNamedDwordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA14000</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_TMSS"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00000</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP_DATA"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00002</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP__DATA"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00004</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP_CTRL"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00006</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP__CTRL"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00008</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP_CNTR"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC0000A</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP__CNTR"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC0000C</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP___CNTR"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC0000E</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP____CNTR"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedByteArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00011</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP_PSG"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre> </div></div><br><h4 id="primenenie-struktur-zagolovka">    </h4><br><p>           <code>createData()</code>  <code>DataUtilities</code> .       : </p><br><ol><li> <code>program</code> :   <code>Program</code> </li><li> <code>address</code> : ,      </li><li> <code>dataType</code> :   </li><li> <code>dataLength</code> :  .   <code>-1</code>    </li><li> <code>stackPointers</code> :  <code>true</code> ,  -     .  <code>false</code> </li><li> <code>clearDataMode</code> :          ,     (,     ) </li></ol><br><p>    : ..      (,  ),         .      <code>FlatProgramAPI</code>    <code>createFunction()</code> ,       . </p><br><p>                 : </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">markVectorsTable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Program program, FlatProgramAPI fpa)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { DataUtilities.createData(program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0</span></span>), vectors.toDataType(), -<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, ClearDataMode.CLEAR_ALL_UNDEFINED_CONFLICT_DATA); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (VectorFunc func : vectors.getVectors()) { fpa.createFunction(func.getAddress(), func.getName()); } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (CodeUnitInsertionException e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Vectors mark conflict at 0x000000"</span></span>); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">markHeader</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Program program, FlatProgramAPI fpa)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { DataUtilities.createData(program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0x100</span></span>), header.toDataType(), -<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, ClearDataMode.CLEAR_ALL_UNDEFINED_CONFLICT_DATA); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (CodeUnitInsertionException e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Vectors mark conflict at 0x000100"</span></span>); } }</code> </pre> <br><h3 id="zavershaem-metod-load">   load() </h3><br><p>         <code>load()</code>    <code>setMessage()</code>   <code>TaskMonitor</code> ,     . </p><br><pre> <code class="java hljs">monitor.setMessage(String.format(<span class="hljs-string"><span class="hljs-string">"%s : Start loading"</span></span>, getName()));</code> </pre> <br><p>     ,     : </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">load</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ByteProvider provider, LoadSpec loadSpec, List&lt;Option&gt; options, Program program, MemoryConflictHandler handler, TaskMonitor monitor, MessageLog log)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> CancelledException, IOException </span></span>{ monitor.setMessage(String.format(<span class="hljs-string"><span class="hljs-string">"%s : Start loading"</span></span>, getName())); BinaryReader reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryReader(provider, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); FlatProgramAPI fpa = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FlatProgramAPI(program, monitor); vectors = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> VectorsTable(fpa, reader); header = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GameHeader(fpa, reader); createSegments(fpa, provider, program, monitor); markVectorsTable(program, fpa); markHeader(program, fpa); monitor.setMessage(String.format(<span class="hljs-string"><span class="hljs-string">"%s : Loading done"</span></span>, getName())); }</code> </pre> <br><h3 id="getdefaultoptions-i-validateoptions"> getDefaultOptions  validateOptions </h3><br><p>       ,      </p><br><h2 id="otlazhivaem-rezultaty-nashih-trudov">     </h2><br><p>        <code>Run</code> -&gt; <code>Debug As</code> -&gt; <code>1 Ghidra</code> .   . </p><br><p><img src="https://habrastorage.org/webt/fv/ua/ya/fvuaya-gohpzkoiiflp6v28eily.png"></p><br><h2 id="eksport-distributiva-i-ustanovka-v-ghidra">      GHIDRA </h2><br><p>     ,   -    .       <code>Eclipse</code>   <code>extension.properties</code> ,   : </p><br><pre> <code class="java hljs">description=Loader <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Sega Mega Drive / Genesis ROMs author=Dr. MefistO createdOn=<span class="hljs-number"><span class="hljs-number">20.03</span></span>.2019</code> </pre> <br><p>       <code>GhidraDev</code> -&gt; <code>Export</code> -&gt; <code>Ghidra Module Extension...</code>      : </p><br><p><img src="https://habrastorage.org/webt/4p/d-/4x/4pd-4xgokfhzsbfwdccrnzguqb0.png"></p><br><p><img src="https://habrastorage.org/webt/t2/gs/j3/t2gsj3lpwgtn-lueej69ostsil4.png"></p><br><p><img src="https://habrastorage.org/webt/z3/kn/ik/z3knik478dyvau73nau8j-rhiik.png"></p><br><p>      <code>dist</code>    zip- (-  <code>ghidra_9.0_PUBLIC_20190320_Sega.zip</code> )       <code>GHIDRA</code> . </p><br><p>     .  <code></code> ,  <code>File</code> -&gt; <code>Install Extensions...</code> ,     ,     . ... </p><br><p><img src="https://habrastorage.org/webt/ky/tk/uh/kytkuhf_3pciliw9ihhgthadbrs.png"></p><br><p><img src="https://habrastorage.org/webt/qj/bz/gf/qjbzgfycyjaeghezz_w1rehayo0.png"></p><br><h2 id="ishodniki-i-prochee">    </h2><br><p>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">github-</a> ,   . </p><br><p>     :   <code>IDA</code>  <code>GHIDRA</code>       .   . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de444562/">https://habr.com/ru/post/de444562/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de444552/index.html">TDMS Fairway. Arbeiten Sie mit Fachwissen</a></li>
<li><a href="../de444554/index.html">Die einfachste JSON RESTful API unter Elixir</a></li>
<li><a href="../de444556/index.html">Die Farbe des Mondes und der Sonne aus dem Weltraum in den Werten von RGB und Farbtemperatur</a></li>
<li><a href="../de444558/index.html">Was ist neu in CUBA 7?</a></li>
<li><a href="../de444560/index.html">Wir laden Sie zur Konferenz ‚ÄûClouds. Modetrends ‚Äù26. M√§rz 2019</a></li>
<li><a href="../de444564/index.html">Digitale Produktentwicklung mit mentalen Modellen</a></li>
<li><a href="../de444566/index.html">Sikorsky f√ºhrte eine Demonstration eines unbemannten Hubschraubers mit einem Mann an Bord durch</a></li>
<li><a href="../de444568/index.html">Top 10 Fehler von C ++ - Projekten im Jahr 2018 gefunden</a></li>
<li><a href="../de444570/index.html">Top 10 Fehler in C ++ - Projekten f√ºr 2018</a></li>
<li><a href="../de444572/index.html">Blinkende LED</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>