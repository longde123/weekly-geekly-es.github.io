<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©‚Äçüë©‚Äçüëß üíú üìΩÔ∏è Portage d'applications de bureau sur .NET Core üíÜüèø üåÜ üí∏</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Depuis que je travaille avec la communaut√© sur le portage d'applications de bureau de .NET Framework vers .NET Core, j'ai remarqu√© qu'il y a deux camp...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Portage d'applications de bureau sur .NET Core</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/microsoft/blog/455325/"><p>  Depuis que je travaille avec la communaut√© sur le portage d'applications de bureau de .NET Framework vers .NET Core, j'ai remarqu√© qu'il y a deux camps de personnes: certains veulent une liste d'instructions tr√®s simple et br√®ve pour que leurs applications soient port√©es .NET Core tandis que d'autres pr√©f√®rent une approche plus fond√©e sur des principes avec plus d'informations contextuelles.  Au lieu de r√©diger un document ¬´couteau suisse¬ª, nous allons publier deux articles de blog, un pour chaque camp: </p><br><ul><li>  <strong>Ce message est le cas simple</strong> .  Il se concentre sur des instructions simples et des applications plus petites et est le moyen le plus simple de d√©placer votre application vers .NET Core. </li><li>  <strong>Nous publierons un autre article pour les cas plus compliqu√©s</strong> .  Ce post se concentrera davantage sur les applications non triviales, telles que les applications WPF avec des d√©pendances sur WCF et les packages d'interface utilisateur tiers. </li></ul><br><p>  Si vous pr√©f√©rez regarder des vid√©os plut√¥t que de les lire, voici la vid√©o o√π je fais tout ce qui est d√©crit ci-dessous. </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/tp1EOFtnTmA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><a name="habracut"></a><br><h2>  √âtape 0 - Pr√©requis </h2><br><p>  Pour porter vos applications de bureau sur Core, vous aurez besoin de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">.NET Core 3</a> et Visual Studio 2019. </p><br><h2>  √âtape 1 - Ex√©cutez l'analyseur de portabilit√© </h2><br><p>  Avant le portage, vous devez v√©rifier la compatibilit√© de votre application avec .NET Core.  Pour ce faire, t√©l√©chargez et ex√©cutez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">.NET Portability Analyzer</a> . </p><br><ul><li>  Sur le premier onglet, R√©sum√© de la portabilit√©, si vous n'avez que 100% dans la colonne .NET Core (tout est surlign√© en vert), votre code est enti√®rement compatible, passez √† l'√©tape 2. </li><li>  Si vous avez des valeurs inf√©rieures √† 100%, examinez d'abord tous les assemblys qui ne font pas partie de votre application.  Pour ceux-ci, v√©rifiez si leurs auteurs fournissent des versions pour .NET Core ou .NET Standard. </li><li>  Regardez maintenant l'autre partie des assemblys qui proviennent de votre code.  Si aucun de vos assemblys n'est r√©pertori√© dans le rapport de portabilit√©, passez √† l'√©tape 2. Sinon, ouvrez l'onglet D√©tails, filtrez le tableau en cliquant sur la colonne Assemblage et concentrez-vous uniquement sur ceux qui proviennent de votre application.  Parcourez la liste et refactorisez votre code pour cesser d'utiliser l'API ou remplacez l'utilisation de l'API par des alternatives de .NET Core. </li></ul><br><p> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/4b0/588/322/4b05883226eaae0b7c4dd18a893f5741.png" width="615" height="232"></a> </p><br><h2>  √âtape 2 - Migrez vers .csproj de style SDK </h2><br><p>  Dans l' <strong>Explorateur de solutions</strong> , faites un clic droit sur votre projet (pas sur la solution!).  Voyez-vous <strong>Modifier le fichier de projet</strong> ?  Si vous le faites, vous utilisez d√©j√† le fichier de projet de style SDK, vous devez donc passer √† l' <strong>√©tape 3</strong> .  Sinon, proc√©dez comme suit. </p><br><ul><li> V√©rifiez dans l' <strong>Explorateur de solutions</strong> si votre projet contient un fichier <code>packages.config</code> .  Si vous ne le faites pas, aucune action n'est n√©cessaire, si vous le faites, faites un clic droit sur <code>packages.config</code> et choisissez <strong>Migrer packages.config vers PackageReference</strong> .  Cliquez ensuite sur <strong>OK</strong> . </li><li>  Ouvrez votre fichier de projet en cliquant avec le bouton droit sur le projet et choisissez <strong>D√©charger le projet</strong> .  Cliquez ensuite avec le bouton droit sur le projet et choisissez <strong>Modifier &lt;votre nom de projet&gt; .csproj</strong> . </li><li>  Copiez le contenu du fichier de projet quelque part, par exemple dans le Bloc-notes, afin de pouvoir le rechercher ult√©rieurement. </li><li>  Supprimez tout de votre fichier de projet ouvert dans Visual Studio (je sais que cela semble agressif, mais nous ajouterons uniquement le contenu n√©cessaire de la copie que nous venons de faire en quelques √©tapes).  Au lieu du texte que vous venez de supprimer, collez le code suivant. Pour une application WinForms: <br><br><pre> <code class="cs hljs">&lt;Project Sdk=<span class="hljs-string"><span class="hljs-string">"Microsoft.NET.Sdk.WindowsDesktop"</span></span>&gt; &lt;PropertyGroup&gt; &lt;OutputType&gt;WinExe&lt;/OutputType&gt; &lt;TargetFramework&gt;net472&lt;/TargetFramework&gt; &lt;UseWindowsForms&gt;<span class="hljs-literal"><span class="hljs-literal">true</span></span>&lt;/UseWindowsForms&gt; &lt;GenerateAssemblyInfo&gt;<span class="hljs-literal"><span class="hljs-literal">false</span></span>&lt;/GenerateAssemblyInfo&gt; &lt;/PropertyGroup&gt; &lt;/Project&gt;</code> </pre> <br>  Pour une application WPF: <br><br><pre> <code class="cs hljs">&lt;Project Sdk=<span class="hljs-string"><span class="hljs-string">"Microsoft.NET.Sdk.WindowsDesktop"</span></span>&gt; &lt;PropertyGroup&gt; &lt;OutputType&gt;WinExe&lt;/OutputType&gt; &lt;TargetFramework&gt;net472&lt;/TargetFramework&gt; &lt;UseWPF&gt;<span class="hljs-literal"><span class="hljs-literal">true</span></span>&lt;/UseWPF&gt; &lt;GenerateAssemblyInfo&gt;<span class="hljs-literal"><span class="hljs-literal">false</span></span>&lt;/GenerateAssemblyInfo&gt; &lt;/PropertyGroup&gt; &lt;/Project&gt;</code> </pre> </li><li>  Dans le Bloc-notes, recherchez <code>PackageReference</code> .  Si vous n'avez rien trouv√©, passez √† autre chose.  Si vous avez trouv√© <code>PackageReference</code> , copiez l'int√©gralit√© de <code>&lt;ItemGroup&gt;</code> qui contient <code>PackageReference</code> dans votre fichier de projet, ouvert dans Visual Studio, juste en dessous des lignes que vous avez coll√©es √† l'√©tape ci-dessus.  Faites-le pour chaque occurrence de <code>PackageReference</code> vous avez trouv√©e.  Le bloc copi√© devrait ressembler √† ceci. <br><br><pre> <code class="cs hljs">&lt;ItemGroup&gt; &lt;PackageReference Include=<span class="hljs-string"><span class="hljs-string">"NUnit"</span></span>&gt; &lt;Version&gt;<span class="hljs-number"><span class="hljs-number">3.11</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>&lt;/Version&gt; &lt;/PackageReference&gt; &lt;/ItemGroup&gt;</code> </pre> </li><li>  Faites maintenant la m√™me chose que ci-dessus pour <code>ProjectReference</code> .  Si vous n'avez rien trouv√©, passez √† autre chose.  Si vous avez trouv√© des √©l√©ments <code>ProjectReference</code> , ils ressembleraient √† ceci. <br><br><pre> <code class="cs hljs">&lt;ItemGroup&gt; &lt;ProjectReference Include=<span class="hljs-string"><span class="hljs-string">"..\WindowsFormsApp1\WindowsFormsApp1.csproj"</span></span>&gt; &lt;Project&gt;{<span class="hljs-number"><span class="hljs-number">7b</span></span>ce0d50<span class="hljs-number"><span class="hljs-number">-17f</span></span>e<span class="hljs-number"><span class="hljs-number">-4f</span></span>da-b6b7-e7960aed8ac2}&lt;/Project&gt; &lt;Name&gt;WindowsFormsApp1&lt;/Name&gt; &lt;/ProjectReference&gt; &lt;/ItemGroup&gt;</code> </pre> </li><li>  Vous pouvez supprimer des lignes avec les propri√©t√©s <code>&lt;Project&gt;</code> et <code>&lt;Name&gt;</code> , car elles ne sont pas n√©cessaires dans le nouveau style de fichier de projet.  Donc, pour chaque <code>ProjectReference</code> que vous avez trouv√© (le cas √©ch√©ant), copiez uniquement <code>ItemGroup</code> et <code>ProjectReference</code> comme ceci. <br><br><pre> <code class="cs hljs">&lt;ItemGroup&gt; &lt;ProjectReference Include=<span class="hljs-string"><span class="hljs-string">"..\WindowsFormsApp1\WindowsFormsApp1.csproj"</span></span> /&gt; &lt;/ItemGroup&gt;</code> </pre> <br>  Sauvegardez tout.  Fermez le fichier .csproj dans Visual Studio.  Cliquez avec le bouton droit sur votre projet dans l' <strong>Explorateur de solutions</strong> et s√©lectionnez <strong>Recharger le projet</strong> .  Reconstruisez et assurez-vous qu'il n'y a pas d'erreurs. <br><p>  Bonne nouvelle, vous venez de mettre √† jour votre fichier de projet vers le nouveau style SDK!  Le projet cible toujours .NET Framework, mais vous pourrez d√©sormais le recibler vers .NET Core. </p><br><h2>  √âtape 3 - Recibler vers .NET Core </h2><br><p>  Ouvrez votre fichier de projet en double-cliquant sur votre projet dans l' <strong>Explorateur de solutions</strong> .  Recherchez la propri√©t√© <code>&lt;TargetFramework&gt;</code> et remplacez la valeur par <code>netcoreapp3.0</code> .  Maintenant, votre fichier de projet devrait ressembler √† ceci: </p><br><pre> <code class="cs hljs">&lt;Project Sdk=<span class="hljs-string"><span class="hljs-string">"Microsoft.NET.Sdk.WindowsDesktop"</span></span>&gt; &lt;PropertyGroup&gt; &lt;OutputType&gt;WinExe&lt;/OutputType&gt; &lt;TargetFramework&gt;netcoreapp3<span class="hljs-number"><span class="hljs-number">.0</span></span>&lt;/TargetFramework&gt; ... &lt;/PropertyGroup&gt; ... &lt;/Project&gt;</code> </pre> <br><p>  Cr√©ez et ex√©cutez votre projet.  <strong>F√©licitations, vous avez port√© sur .NET Core 3!</strong> </p><br><h2>  Correction des erreurs </h2><br><p>  Si vous obtenez des erreurs comme </p><br><pre> <code class="cs hljs">The type or <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> &lt;<span class="hljs-title"><span class="hljs-title">some</span></span> <span class="hljs-title"><span class="hljs-title">name</span></span>&gt; <span class="hljs-title"><span class="hljs-title">could</span></span> <span class="hljs-title"><span class="hljs-title">not</span></span> <span class="hljs-title"><span class="hljs-title">be</span></span> <span class="hljs-title"><span class="hljs-title">found</span></span></code> </pre> <br><p>  ou </p><br><pre> <code class="cs hljs">The name &lt;some name&gt; does not exist <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the current context</code> </pre> <br><p>  et votre rapport de portabilit√© √©tait vert, il devrait √™tre facile √† corriger en ajoutant un package NuGet avec la biblioth√®que correspondante.  Si vous ne trouvez pas le package NuGet avec la biblioth√®que manquante, essayez de r√©f√©rencer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Microsoft.Windows.Compatibility</a> .  Ce package ajoute ~ 21K API .NET √† partir de .NET Framework. </p><br><h2>  Travailler avec des designers </h2><br><p>  M√™me s'il est possible de modifier l'interface utilisateur de votre application via du code, les d√©veloppeurs pr√©f√®rent g√©n√©ralement utiliser les concepteurs visuels.  Avec .NET Core, nous avons d√ª reconcevoir la fa√ßon dont les concepteurs travaillent avec les projets .NET Core: </p><br><ul><li>  Le concepteur WPF est d√©j√† en pr√©version et nous travaillons sur l'ajout de fonctionnalit√©s suppl√©mentaires. </li><li>  Le concepteur WinForms pour .NET Core sera disponible plus tard, et en attendant, vous pouvez utiliser le concepteur WinForms .NET Framework comme solution de contournement. </li></ul><br><p>  Voici comment utiliser le concepteur WinForms .NET Framework: </p><br><ol><li>  Copiez votre fichier .csproj (disons que vous avez <code>MyProject.csproj</code> ), donnez-lui un nom diff√©rent, par exemple <code>MyProject.NetFramework.csproj</code> et placez-le √† c√¥t√© de votre fichier de projet existant. </li><li>  Assurez-vous que votre projet est ferm√© dans Visual Studio, ouvrez le nouveau projet <code>MyProject.NetFramework.csproj</code> . <br>  Dans l' <strong>Explorateur de solutions,</strong> cliquez avec le bouton droit sur votre projet et s√©lectionnez <strong>Propri√©t√©s</strong> .  Dans l'onglet Application (doit √™tre ouvert par d√©faut), d√©finissez le <strong>nom de l'</strong> assembly et l' <strong>espace</strong> de <strong>noms par d√©faut</strong> sur les m√™mes valeurs que dans votre projet initial (supprimez ¬´.NetFramework¬ª des noms). <br>  Enregistrez cette solution √† c√¥t√© de votre solution existante. </li><li>  Ouvrez le nouveau fichier de projet et remplacez <code>&lt;TargetFramework&gt;</code> par <code>net472</code> . </li><li>  Maintenant, lorsque vous devez utiliser le concepteur WinForms, chargez votre projet avec le fichier de projet <code>MyProject.NetFramework.csproj</code> et vous obtiendrez l'exp√©rience compl√®te du concepteur .NET Framework.  Lorsque vous avez termin√© avec le concepteur, fermez et ouvrez votre projet avec le fichier de projet .NET Core. </li><li>  Il s'agit simplement d'une solution de contournement jusqu'√† ce que le concepteur WinForms pour .NET Core soit pr√™t. </li></ol><br><h2>  Pourquoi porter sur .NET Core </h2><br><p>  Regardez la vid√©o o√π Scott Hunter et moi parlons de toutes les nouveaut√©s √† venir avec le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">portage</a> .NET Core 3 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">vers .NET Core 3.0</a> . </p></li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr455325/">https://habr.com/ru/post/fr455325/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr455312/index.html">Additionneur complet un bit sur des puces inhabituelles</a></li>
<li><a href="../fr455314/index.html">Qu'est-ce qu'un r√©seau de services</a></li>
<li><a href="../fr455316/index.html">Nous modifions la pile Bluetooth pour am√©liorer le son des casques sans codecs AAC, aptX et LDAC</a></li>
<li><a href="../fr455318/index.html">Quels sont les domaines d'application de l'impression 3D?</a></li>
<li><a href="../fr455321/index.html">Domotique √† faire soi-m√™me</a></li>
<li><a href="../fr455329/index.html">Annonce de l'extension des outils Azure IoT Edge (pr√©version)</a></li>
<li><a href="../fr455331/index.html">Comment les ordinateurs ont appris √† reconna√Ætre incroyablement bien les images</a></li>
<li><a href="../fr455333/index.html">Qui a mis Python dans la mise √† jour de Windows 10 de mai 2019?</a></li>
<li><a href="../fr455335/index.html">Petty Petty Joy # 3: Po√©sie</a></li>
<li><a href="../fr455337/index.html">Qui a ajout√© Python √† la derni√®re mise √† jour de Windows?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>