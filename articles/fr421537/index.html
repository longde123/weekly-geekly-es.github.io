<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèº‚Äçü§ù‚Äçüë®üèª üíπ üëßüèª Fonctions d'ordre sup√©rieur dans JS: cours pour jeunes combattants üî∞ üéõÔ∏è üÜô</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cet article est destin√© √† une personne faisant ses premiers pas timides sur le chemin √©pineux de l'apprentissage de JavaScript. Malgr√© le fait qu'en 2...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Fonctions d'ordre sup√©rieur dans JS: cours pour jeunes combattants</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421537/">  <i>Cet article est destin√© √† une personne faisant ses premiers pas timides sur le chemin √©pineux de l'apprentissage de JavaScript.</i>  <i>Malgr√© le fait qu'en 2018, j'utilise la syntaxe ES5 pour que l'article puisse √™tre compris par les jeunes Padawans suivant le cours JavaScript niveau 1 √† HTML Academy.</i> <br><br>  L'une des caract√©ristiques qui distingue JS de nombreux autres langages de programmation est que dans ce langage une fonction est un ¬´objet de premi√®re classe¬ª.  Ou, en russe, une fonction est un sens.  Identique √† un nombre, une cha√Æne ou un objet.  Nous pouvons √©crire une fonction dans une variable, nous pouvons la mettre dans un tableau ou dans une propri√©t√© d'objet.  Nous pouvons m√™me additionner deux fonctions.  En fait, rien de significatif n'en r√©sultera, mais en fait - nous le pouvons! <br><br><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hello</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{}; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">world</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{}; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(hello + world); <span class="hljs-comment"><span class="hljs-comment">//  ,  ,   //   ,    </span></span></code> </pre> <br>  La chose la plus int√©ressante est que nous pouvons cr√©er des fonctions qui op√®rent sur d'autres fonctions - en les acceptant comme arguments ou en les renvoyant comme valeur.  Ces fonctions sont appel√©es <i>fonctions d'ordre sup√©rieur</i> .  Et aujourd'hui, nous, filles et gar√ßons, parlerons de la mani√®re d'adapter cette opportunit√© aux besoins de l'√©conomie nationale.  En cours de route, vous en apprendrez plus sur certaines fonctionnalit√©s utiles des fonctions de JS. <br><a name="habracut"></a><br><h3>  Pipeline </h3><br>  Disons que nous avons une chose avec laquelle vous devez faire beaucoup de pi√®ces.  Disons qu'un utilisateur a t√©l√©charg√© un fichier texte qui stocke des donn√©es au format JSON et que nous voulons traiter son contenu.  Premi√®rement, nous devons couper les caract√®res d'espaces suppl√©mentaires, qui pourraient "grossir" sur les bords en raison des actions de l'utilisateur ou du syst√®me d'exploitation.  V√©rifiez ensuite qu'il n'y a pas de code malveillant dans le texte (qui sait, ces utilisateurs).  <code>JSON.parse</code> ensuite du texte √† l'objet √† l'aide de la m√©thode <code>JSON.parse</code> .  Supprimez ensuite les donn√©es dont nous avons besoin de cet objet.  Et √† la fin - envoyez ces donn√©es au serveur.  Vous obtenez quelque chose comme √ßa: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trim</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-comment"><span class="hljs-comment">/*  */</span></span>}; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sanitize</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-comment"><span class="hljs-comment">/*  */</span></span>}; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">parse</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-comment"><span class="hljs-comment">/*  */</span></span>}; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">extractData</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-comment"><span class="hljs-comment">/*  */</span></span>}; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-comment"><span class="hljs-comment">/*  */</span></span>}; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> textFromFile = getTextFromFile(); send(extractData(parse(sanitize(trim(testFromFile))));</code> </pre><br>  Il semble si d'accord.  De plus, vous n'avez probablement pas remarqu√© qu'il manque un support de fermeture.  Bien s√ªr, l'EDI vous le dirait, mais il y a toujours un probl√®me.  Pour le r√©soudre, un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">nouvel op√©rateur |&gt; a</a> √©t√© r√©cemment propos√©.  En fait, ce n'est pas nouveau, mais honn√™tement emprunt√© aux langages fonctionnels, mais ce n'est pas la question.  En utilisant cet op√©rateur, la derni√®re ligne pourrait √™tre r√©√©crite comme suit: <br><br><pre> <code class="javascript hljs">textFromFile |&gt; trim |&gt; sanitize |&gt; parse |&gt; extractData |&gt; send;</code> </pre><br>  L'op√©rateur |&gt; prend son op√©rande gauche et le passe √† l'op√©rande droit comme argument.  Par exemple, <code>"Hello" |&gt; console.log</code> √©quivalent √† <code>console.log("Hello")</code> .  C'est tr√®s pratique pr√©cis√©ment pour les cas o√π plusieurs fonctions sont appel√©es le long de la cha√Æne.  Cependant, avant l'introduction de cet op√©rateur, beaucoup de temps passera (si cette proposition est accept√©e), mais vous devez vivre d'une mani√®re ou d'une autre maintenant.  Par cons√©quent, nous pouvons √©crire sur notre <s>v√©lo une</s> fonction qui simule ce comportement: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pipe</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> args = <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.from(<span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = args.shift(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(args.length){ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> f = args.shift(); result = f(result); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } pipe( textFromFile, trim, sanitize, parse, extractData, send );</code> </pre><br>  Si vous √™tes un novice javascriptist (javascript? Javascript?), La premi√®re ligne de la fonction peut vous sembler incompr√©hensible.  C'est simple: √† l'int√©rieur de la fonction, nous utilisons le mot-cl√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">arguments</a> pour acc√©der √† un objet de type tableau contenant tous les arguments pass√©s √† la fonction.  C'est tr√®s pratique lorsque nous ne savons pas √† l'avance combien d'arguments elle aura.  Un objet massif est comme un tableau, mais pas tout √† fait.  Par cons√©quent, nous le convertissons en un tableau normal √† l'aide de la m√©thode <code>Array.from</code> .  J'esp√®re que le code suppl√©mentaire est d√©j√† assez lisible: nous commen√ßons de gauche √† droite pour extraire les √©l√©ments du tableau et les appliquer les uns aux autres de la m√™me mani√®re que le ferait l'op√©rateur |&gt;. <br><br><h3>  Journalisation </h3><br>  Voici un autre exemple proche de la vraie vie.  Supposons que nous ayons d√©j√† une fonction <code>f</code> qui fait ... quelque chose d'utile.  Et dans le processus de test de notre code, nous voulons en savoir plus sur exactement comment <code>f</code> fait.  √Ä quels moments est appel√©, quels arguments lui sont pass√©s, quelles valeurs sont renvoy√©es. <br><br>  Bien s√ªr, √† chaque appel de fonction, nous pouvons √©crire ceci: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = f(a, b); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">" f     "</span></span> + a + <span class="hljs-string"><span class="hljs-string">"  "</span></span> + b + <span class="hljs-string"><span class="hljs-string">"   "</span></span> + result); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">" : "</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>.now());</code> </pre><br>  Mais, premi√®rement, c'est assez lourd.  Et deuxi√®mement, il est tr√®s facile de l‚Äôoublier.  Un jour, nous √©crirons simplement <code>f(a, b)</code> , et depuis lors, l'obscurit√© de l'ignorance s'installera dans nos esprits.  Il s'√©largira √† chaque nouveau d√©fi <code>f</code> , dont nous ne savons rien. <br><br>  Id√©alement, j'aimerais que la journalisation se fasse automatiquement.  Pour que chaque fois que vous appelez <code>f</code> , toutes les choses dont nous avons besoin soient √©crites sur la console.  Et, heureusement, nous avons un moyen de le faire.  D√©couvrez la nouvelle fonctionnalit√© d'ordre sup√©rieur! <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addLogger</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">f</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> args = <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.from(<span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = f.apply(<span class="hljs-literal"><span class="hljs-literal">null</span></span>, args); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">" "</span></span> + f.name + <span class="hljs-string"><span class="hljs-string">"     "</span></span> + args.join() + <span class="hljs-string"><span class="hljs-string">"    "</span></span> + result + <span class="hljs-string"><span class="hljs-string">"\n"</span></span> + <span class="hljs-string"><span class="hljs-string">" : "</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>.now()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sum</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a + b; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sumWithLogging = addLogger(sum); sum(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   sumWithLogging(1, 2) // </span></span></code> </pre><br>  Une fonction prend une fonction et renvoie une fonction qui appelle la fonction transmise √† la fonction lors de sa cr√©ation.  D√©sol√©, je ne pouvais pas arr√™ter d'√©crire ceci.  Maintenant en russe: la fonction <code>addLogger</code> cr√©e un <code>addLogger</code> autour de la fonction qui lui est pass√©e en argument.  L'emballage est √©galement une fonction.  Lorsqu'il est appel√©, il collecte un tableau de ses arguments de la m√™me mani√®re que dans l'exemple pr√©c√©dent.  Ensuite, √† l'aide de la m√©thode <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">apply</a> , il appelle une fonction encapsul√©e avec les m√™mes arguments et se souvient du r√©sultat.  Apr√®s cela, l'encapsuleur √©crit tout sur la console. <br><br>  Ici, nous avons le cas classique de l'attaque de l'homme au milieu.  Si vous utilisez un wrapper au lieu de <code>f</code> , alors du point de vue du code qui l'utilise, il n'y a pratiquement aucune diff√©rence.  Le code peut supposer qu'il communique directement avec <code>f</code> .  Pendant ce temps, le wrapper rapporte tout au camarade major. <br><br><h3>  Eins, zwei, drei, vier ... </h3><br>  Et encore une t√¢che proche de la pratique.  Supposons que nous devions num√©roter certaines entit√©s.  Chaque fois qu'une nouvelle entit√© appara√Æt, nous obtenons un nouveau num√©ro pour elle, un de plus que le pr√©c√©dent.  Pour ce faire, nous d√©marrons une fonction de la forme suivante: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lastNumber = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getNewNumber</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lastNumber++; }</code> </pre><br>  Et puis nous avons un nouveau type d'entit√©.  Disons, avant cela, nous avons num√©rot√© les lapins, et maintenant il y a aussi des lapins.  Si vous utilisez une fonction pour ceux-ci et pour les autres, alors chaque num√©ro attribu√© aux lapins fera un ¬´trou¬ª dans la s√©rie de num√©ros d√©livr√©s aux lapins.  Donc, nous avons besoin de la deuxi√®me fonction, et avec elle la deuxi√®me variable: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lastHareNumber = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getNewHareNumber</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lastHareNumber++; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lastRabbitNumber = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getNewRabbitNumber</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lastRabbitNumber++; }</code> </pre><br>  Vous sentez que ce code sent mauvais?  J'aimerais avoir quelque chose de mieux.  Premi√®rement, je voudrais pouvoir d√©clarer de telles fonctions moins verbeuses, sans dupliquer le code.  Et deuxi√®mement, je voudrais en quelque sorte "empaqueter" la variable que la fonction utilise dans la fonction elle-m√™me afin de ne pas obstruer √† nouveau l'espace de noms. <br><br><div class="spoiler">  <b class="spoiler_title">Et puis un homme fait irruption, familiaris√© avec le concept de POO, et dit:</b> <div class="spoiler_text">  "√âl√©mentaire, Watson."  Il est n√©cessaire de faire des g√©n√©rateurs de nombres non pas des objets, mais des objets.  Les objets sont juste con√ßus pour stocker des fonctions qui fonctionnent avec des donn√©es, avec ces m√™mes donn√©es.  Ensuite, nous pourrions √©crire quelque chose comme: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> numberGenerator = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NumberGenerator(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n = numberGenerator.get();</code> </pre><br>  A quoi je r√©pondrai: <br>  - Pour √™tre honn√™te, je suis enti√®rement d'accord avec vous.  Et en principe, c'est une approche plus correcte que ce que je vais maintenant proposer.  Mais ici, nous avons un article sur les fonctions, pas sur la POO.  Pourriez-vous vous taire un moment et me laisser finir? <br></div></div><br>  Ici (surprise!) La fonction d'ordre sup√©rieur nous aidera √† nouveau. <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createNumberGenerator</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> n++; } } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> getNewHareNumber = createNumberGenerator(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> getNewRabbitNumber = createNumberGenerator(); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log( getNewHareNumber(), getNewHareNumber(), getNewHareNumber(), getNewRabbitNumber(), getNewRabbitNumber(), ); <span class="hljs-comment"><span class="hljs-comment">//    0, 1, 2, 0, 1</span></span></code> </pre><br>  Et ici, certaines personnes peuvent avoir une question, peut-√™tre m√™me sous une forme obsc√®ne: que diable se passe-t-il?  Pourquoi cr√©ons-nous une variable qui n'est pas utilis√©e dans la fonction elle-m√™me?  Comment une fonction interne y acc√®de-t-elle si une fonction externe a termin√© son ex√©cution depuis longtemps?  Pourquoi deux fonctions cr√©√©es faisant r√©f√©rence √† la m√™me variable obtiennent-elles des r√©sultats diff√©rents?  Une r√©ponse √† toutes ces questions est la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cl√¥ture</a> . <br><br>  Chaque fois que la fonction <code>createNumberGenerator</code> est <code>createNumberGenerator</code> , l'interpr√©teur JS cr√©e une chose magique appel√©e "contexte d'ex√©cution".  En gros, c'est un tel objet dans lequel toutes les variables d√©clar√©es dans cette fonction sont stock√©es.  Nous ne pouvons pas y acc√©der en tant qu'objet javascript ordinaire, mais c'est n√©anmoins le cas. <br><br>  Si la fonction √©tait ¬´simple¬ª (par exemple, en ajoutant des nombres), alors apr√®s la fin de son travail, le contexte d'ex√©cution s'av√®re inutile.  Savez-vous ce qui arrive aux donn√©es inutiles dans JS?  Ils sont d√©vor√©s par un d√©mon insatiable nomm√© Garbage Collector.  Cependant, si la fonction √©tait ¬´compliqu√©e¬ª, il peut arriver que quelqu'un ait toujours besoin de son contexte m√™me apr√®s l'ex√©cution de cette fonction.  Dans ce cas, le Garbage Collector l'√©pargne, et il reste suspendu quelque part dans sa m√©moire, afin que ceux qui en ont besoin puissent toujours avoir acc√®s √† lui. <br><br>  Ainsi, la fonction retourn√©e par <code>createNumberGenerator</code> aura toujours acc√®s √† sa propre copie de la variable <code>n</code> .  Vous pouvez le consid√©rer comme un sac de tenue de D&amp;D.  Vous mettez votre main dans votre sac et vous vous retrouvez dans une ¬´poche¬ª interdimensionnelle personnelle o√π vous pouvez ranger tout ce que vous voulez. <br><br><h3>  Debounce </h3><br>  Il y a une chose telle que ¬´√©liminer le rebond¬ª.  C'est lorsque nous ne voulons pas qu'une fonction soit appel√©e trop souvent.  Supposons qu'il existe un certain bouton, en cliquant sur celui qui lance un processus ¬´co√ªteux¬ª (long, ou consommant beaucoup de m√©moire, ou Internet, ou sacrifiant des vierges).  Il peut arriver qu'un utilisateur impatient commence √† cliquer sur ce bouton avec une fr√©quence de plus de dix hertz.  De plus, le processus susmentionn√© a une nature telle qu'il est inutile de l'ex√©cuter dix fois de suite, car le r√©sultat final ne changera pas.  C'est alors que nous appliquons ¬´l'√©limination des bavardages¬ª. <br><br>  Son essence est tr√®s simple: nous effectuons la fonction non pas imm√©diatement, mais apr√®s un certain temps.  Si avant que ce temps ne soit √©coul√©, la fonction a √©t√© rappel√©e, nous ¬´remettons √† z√©ro la minuterie¬ª.  Ainsi, l'utilisateur peut cliquer sur le bouton au moins mille fois - une seule est n√©cessaire pour le sacrifice.  Cependant, moins de mots, plus de code: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">debounce</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">f, delay</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lastTimeout; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(lastTimeout){ clearTimeout(lastTimeout); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> args = <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.from(<span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>); lastTimeout = setTimeout(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ f.apply(<span class="hljs-literal"><span class="hljs-literal">null</span></span>, args); }, delay); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sacrifice</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(name + <span class="hljs-string"><span class="hljs-string">"     * *"</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sacrificeDebounced</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">debounce</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sacrifice, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">500</span></span></span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sacrificeDebounced</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sacrificeDebounced</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sacrificeDebounced</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span></span><span class="hljs-function">);</span></span></code> </pre><br>  Dans une demi-seconde, Lena sera sacrifi√©e, et Katya et Sveta survivront gr√¢ce √† notre fonction magique. <br><br>  Si vous lisez attentivement les exemples pr√©c√©dents, vous devez bien comprendre comment tout fonctionne ici.  La fonction wrapper cr√©√©e par <code>debounce</code> d√©clenche l'ex√©cution diff√©r√©e de la fonction d'origine √† l'aide de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">setTimeout</a> .  Dans ce cas, l'identifiant de d√©lai d'attente est stock√© dans la variable lastTimeout, qui est accessible √† l'encapsuleur en raison de la fermeture.  Si l'identificateur de d√©lai d'attente est d√©j√† dans cette variable, l'encapsuleur annule ce d√©lai d'expiration avec <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">clearTimeout</a> .  Si le d√©lai d'attente pr√©c√©dent est d√©j√† termin√©, rien ne se passe.  Sinon, tant pis pour lui. <br><br>  Sur ce point, je terminerai peut-√™tre.  J'esp√®re qu'aujourd'hui vous avez appris beaucoup de nouvelles choses, et surtout - vous avez compris tout ce que vous avez appris.  A bient√¥t. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr421537/">https://habr.com/ru/post/fr421537/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr421527/index.html">Lancement de la diffusion du projet "Serveur dans les nuages"</a></li>
<li><a href="../fr421529/index.html">Netflix, Uber, Google et vous au MBLT DEV 2018</a></li>
<li><a href="../fr421531/index.html">Comment int√©grer ReactJS dans 1C-Bitrix avec g√©n√©ration automatique de mod√®les sur le back-end en utilisant l'exemple du r√©seau Globus</a></li>
<li><a href="../fr421533/index.html">Choisir un langage de programmation: 3 conseils d'un programmeur d'Apple</a></li>
<li><a href="../fr421535/index.html">Aventure - Electronique. Sur une balan√ßoire ail√©e dans le monde informatique</a></li>
<li><a href="../fr421543/index.html">Clonez une carte sans contact √† l'aide d'une application mobile</a></li>
<li><a href="../fr421545/index.html">Examen du PocketBook 616 - le portefeuille le plus √©conomique 2018 avec fonction de r√©tro-√©clairage</a></li>
<li><a href="../fr421547/index.html">Acceptation du centre de donn√©es ind√©pendant</a></li>
<li><a href="../fr421549/index.html">Nous r√©digeons de la documentation technique: un guide pour le profane</a></li>
<li><a href="../fr421551/index.html">Ma√Ætriser Vuex - De z√©ro √† h√©ros</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>