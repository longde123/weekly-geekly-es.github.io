<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏼‍🤝‍👨🏻 💹 👧🏻 Fonctions d'ordre supérieur dans JS: cours pour jeunes combattants 🔰 🎛️ 🆙</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cet article est destiné à une personne faisant ses premiers pas timides sur le chemin épineux de l'apprentissage de JavaScript. Malgré le fait qu'en 2...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Fonctions d'ordre supérieur dans JS: cours pour jeunes combattants</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421537/">  <i>Cet article est destiné à une personne faisant ses premiers pas timides sur le chemin épineux de l'apprentissage de JavaScript.</i>  <i>Malgré le fait qu'en 2018, j'utilise la syntaxe ES5 pour que l'article puisse être compris par les jeunes Padawans suivant le cours JavaScript niveau 1 à HTML Academy.</i> <br><br>  L'une des caractéristiques qui distingue JS de nombreux autres langages de programmation est que dans ce langage une fonction est un «objet de première classe».  Ou, en russe, une fonction est un sens.  Identique à un nombre, une chaîne ou un objet.  Nous pouvons écrire une fonction dans une variable, nous pouvons la mettre dans un tableau ou dans une propriété d'objet.  Nous pouvons même additionner deux fonctions.  En fait, rien de significatif n'en résultera, mais en fait - nous le pouvons! <br><br><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hello</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{}; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">world</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{}; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(hello + world); <span class="hljs-comment"><span class="hljs-comment">//  ,  ,   //   ,    </span></span></code> </pre> <br>  La chose la plus intéressante est que nous pouvons créer des fonctions qui opèrent sur d'autres fonctions - en les acceptant comme arguments ou en les renvoyant comme valeur.  Ces fonctions sont appelées <i>fonctions d'ordre supérieur</i> .  Et aujourd'hui, nous, filles et garçons, parlerons de la manière d'adapter cette opportunité aux besoins de l'économie nationale.  En cours de route, vous en apprendrez plus sur certaines fonctionnalités utiles des fonctions de JS. <br><a name="habracut"></a><br><h3>  Pipeline </h3><br>  Disons que nous avons une chose avec laquelle vous devez faire beaucoup de pièces.  Disons qu'un utilisateur a téléchargé un fichier texte qui stocke des données au format JSON et que nous voulons traiter son contenu.  Premièrement, nous devons couper les caractères d'espaces supplémentaires, qui pourraient "grossir" sur les bords en raison des actions de l'utilisateur ou du système d'exploitation.  Vérifiez ensuite qu'il n'y a pas de code malveillant dans le texte (qui sait, ces utilisateurs).  <code>JSON.parse</code> ensuite du texte à l'objet à l'aide de la méthode <code>JSON.parse</code> .  Supprimez ensuite les données dont nous avons besoin de cet objet.  Et à la fin - envoyez ces données au serveur.  Vous obtenez quelque chose comme ça: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trim</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-comment"><span class="hljs-comment">/*  */</span></span>}; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sanitize</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-comment"><span class="hljs-comment">/*  */</span></span>}; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">parse</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-comment"><span class="hljs-comment">/*  */</span></span>}; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">extractData</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-comment"><span class="hljs-comment">/*  */</span></span>}; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-comment"><span class="hljs-comment">/*  */</span></span>}; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> textFromFile = getTextFromFile(); send(extractData(parse(sanitize(trim(testFromFile))));</code> </pre><br>  Il semble si d'accord.  De plus, vous n'avez probablement pas remarqué qu'il manque un support de fermeture.  Bien sûr, l'EDI vous le dirait, mais il y a toujours un problème.  Pour le résoudre, un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">nouvel opérateur |&gt; a</a> été récemment proposé.  En fait, ce n'est pas nouveau, mais honnêtement emprunté aux langages fonctionnels, mais ce n'est pas la question.  En utilisant cet opérateur, la dernière ligne pourrait être réécrite comme suit: <br><br><pre> <code class="javascript hljs">textFromFile |&gt; trim |&gt; sanitize |&gt; parse |&gt; extractData |&gt; send;</code> </pre><br>  L'opérateur |&gt; prend son opérande gauche et le passe à l'opérande droit comme argument.  Par exemple, <code>"Hello" |&gt; console.log</code> équivalent à <code>console.log("Hello")</code> .  C'est très pratique précisément pour les cas où plusieurs fonctions sont appelées le long de la chaîne.  Cependant, avant l'introduction de cet opérateur, beaucoup de temps passera (si cette proposition est acceptée), mais vous devez vivre d'une manière ou d'une autre maintenant.  Par conséquent, nous pouvons écrire sur notre <s>vélo une</s> fonction qui simule ce comportement: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pipe</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> args = <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.from(<span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = args.shift(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(args.length){ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> f = args.shift(); result = f(result); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } pipe( textFromFile, trim, sanitize, parse, extractData, send );</code> </pre><br>  Si vous êtes un novice javascriptist (javascript? Javascript?), La première ligne de la fonction peut vous sembler incompréhensible.  C'est simple: à l'intérieur de la fonction, nous utilisons le mot-clé <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">arguments</a> pour accéder à un objet de type tableau contenant tous les arguments passés à la fonction.  C'est très pratique lorsque nous ne savons pas à l'avance combien d'arguments elle aura.  Un objet massif est comme un tableau, mais pas tout à fait.  Par conséquent, nous le convertissons en un tableau normal à l'aide de la méthode <code>Array.from</code> .  J'espère que le code supplémentaire est déjà assez lisible: nous commençons de gauche à droite pour extraire les éléments du tableau et les appliquer les uns aux autres de la même manière que le ferait l'opérateur |&gt;. <br><br><h3>  Journalisation </h3><br>  Voici un autre exemple proche de la vraie vie.  Supposons que nous ayons déjà une fonction <code>f</code> qui fait ... quelque chose d'utile.  Et dans le processus de test de notre code, nous voulons en savoir plus sur exactement comment <code>f</code> fait.  À quels moments est appelé, quels arguments lui sont passés, quelles valeurs sont renvoyées. <br><br>  Bien sûr, à chaque appel de fonction, nous pouvons écrire ceci: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = f(a, b); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">" f     "</span></span> + a + <span class="hljs-string"><span class="hljs-string">"  "</span></span> + b + <span class="hljs-string"><span class="hljs-string">"   "</span></span> + result); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">" : "</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>.now());</code> </pre><br>  Mais, premièrement, c'est assez lourd.  Et deuxièmement, il est très facile de l’oublier.  Un jour, nous écrirons simplement <code>f(a, b)</code> , et depuis lors, l'obscurité de l'ignorance s'installera dans nos esprits.  Il s'élargira à chaque nouveau défi <code>f</code> , dont nous ne savons rien. <br><br>  Idéalement, j'aimerais que la journalisation se fasse automatiquement.  Pour que chaque fois que vous appelez <code>f</code> , toutes les choses dont nous avons besoin soient écrites sur la console.  Et, heureusement, nous avons un moyen de le faire.  Découvrez la nouvelle fonctionnalité d'ordre supérieur! <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addLogger</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">f</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> args = <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.from(<span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = f.apply(<span class="hljs-literal"><span class="hljs-literal">null</span></span>, args); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">" "</span></span> + f.name + <span class="hljs-string"><span class="hljs-string">"     "</span></span> + args.join() + <span class="hljs-string"><span class="hljs-string">"    "</span></span> + result + <span class="hljs-string"><span class="hljs-string">"\n"</span></span> + <span class="hljs-string"><span class="hljs-string">" : "</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>.now()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sum</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a + b; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sumWithLogging = addLogger(sum); sum(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   sumWithLogging(1, 2) // </span></span></code> </pre><br>  Une fonction prend une fonction et renvoie une fonction qui appelle la fonction transmise à la fonction lors de sa création.  Désolé, je ne pouvais pas arrêter d'écrire ceci.  Maintenant en russe: la fonction <code>addLogger</code> crée un <code>addLogger</code> autour de la fonction qui lui est passée en argument.  L'emballage est également une fonction.  Lorsqu'il est appelé, il collecte un tableau de ses arguments de la même manière que dans l'exemple précédent.  Ensuite, à l'aide de la méthode <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">apply</a> , il appelle une fonction encapsulée avec les mêmes arguments et se souvient du résultat.  Après cela, l'encapsuleur écrit tout sur la console. <br><br>  Ici, nous avons le cas classique de l'attaque de l'homme au milieu.  Si vous utilisez un wrapper au lieu de <code>f</code> , alors du point de vue du code qui l'utilise, il n'y a pratiquement aucune différence.  Le code peut supposer qu'il communique directement avec <code>f</code> .  Pendant ce temps, le wrapper rapporte tout au camarade major. <br><br><h3>  Eins, zwei, drei, vier ... </h3><br>  Et encore une tâche proche de la pratique.  Supposons que nous devions numéroter certaines entités.  Chaque fois qu'une nouvelle entité apparaît, nous obtenons un nouveau numéro pour elle, un de plus que le précédent.  Pour ce faire, nous démarrons une fonction de la forme suivante: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lastNumber = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getNewNumber</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lastNumber++; }</code> </pre><br>  Et puis nous avons un nouveau type d'entité.  Disons, avant cela, nous avons numéroté les lapins, et maintenant il y a aussi des lapins.  Si vous utilisez une fonction pour ceux-ci et pour les autres, alors chaque numéro attribué aux lapins fera un «trou» dans la série de numéros délivrés aux lapins.  Donc, nous avons besoin de la deuxième fonction, et avec elle la deuxième variable: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lastHareNumber = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getNewHareNumber</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lastHareNumber++; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lastRabbitNumber = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getNewRabbitNumber</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lastRabbitNumber++; }</code> </pre><br>  Vous sentez que ce code sent mauvais?  J'aimerais avoir quelque chose de mieux.  Premièrement, je voudrais pouvoir déclarer de telles fonctions moins verbeuses, sans dupliquer le code.  Et deuxièmement, je voudrais en quelque sorte "empaqueter" la variable que la fonction utilise dans la fonction elle-même afin de ne pas obstruer à nouveau l'espace de noms. <br><br><div class="spoiler">  <b class="spoiler_title">Et puis un homme fait irruption, familiarisé avec le concept de POO, et dit:</b> <div class="spoiler_text">  "Élémentaire, Watson."  Il est nécessaire de faire des générateurs de nombres non pas des objets, mais des objets.  Les objets sont juste conçus pour stocker des fonctions qui fonctionnent avec des données, avec ces mêmes données.  Ensuite, nous pourrions écrire quelque chose comme: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> numberGenerator = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NumberGenerator(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n = numberGenerator.get();</code> </pre><br>  A quoi je répondrai: <br>  - Pour être honnête, je suis entièrement d'accord avec vous.  Et en principe, c'est une approche plus correcte que ce que je vais maintenant proposer.  Mais ici, nous avons un article sur les fonctions, pas sur la POO.  Pourriez-vous vous taire un moment et me laisser finir? <br></div></div><br>  Ici (surprise!) La fonction d'ordre supérieur nous aidera à nouveau. <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createNumberGenerator</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> n++; } } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> getNewHareNumber = createNumberGenerator(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> getNewRabbitNumber = createNumberGenerator(); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log( getNewHareNumber(), getNewHareNumber(), getNewHareNumber(), getNewRabbitNumber(), getNewRabbitNumber(), ); <span class="hljs-comment"><span class="hljs-comment">//    0, 1, 2, 0, 1</span></span></code> </pre><br>  Et ici, certaines personnes peuvent avoir une question, peut-être même sous une forme obscène: que diable se passe-t-il?  Pourquoi créons-nous une variable qui n'est pas utilisée dans la fonction elle-même?  Comment une fonction interne y accède-t-elle si une fonction externe a terminé son exécution depuis longtemps?  Pourquoi deux fonctions créées faisant référence à la même variable obtiennent-elles des résultats différents?  Une réponse à toutes ces questions est la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">clôture</a> . <br><br>  Chaque fois que la fonction <code>createNumberGenerator</code> est <code>createNumberGenerator</code> , l'interpréteur JS crée une chose magique appelée "contexte d'exécution".  En gros, c'est un tel objet dans lequel toutes les variables déclarées dans cette fonction sont stockées.  Nous ne pouvons pas y accéder en tant qu'objet javascript ordinaire, mais c'est néanmoins le cas. <br><br>  Si la fonction était «simple» (par exemple, en ajoutant des nombres), alors après la fin de son travail, le contexte d'exécution s'avère inutile.  Savez-vous ce qui arrive aux données inutiles dans JS?  Ils sont dévorés par un démon insatiable nommé Garbage Collector.  Cependant, si la fonction était «compliquée», il peut arriver que quelqu'un ait toujours besoin de son contexte même après l'exécution de cette fonction.  Dans ce cas, le Garbage Collector l'épargne, et il reste suspendu quelque part dans sa mémoire, afin que ceux qui en ont besoin puissent toujours avoir accès à lui. <br><br>  Ainsi, la fonction retournée par <code>createNumberGenerator</code> aura toujours accès à sa propre copie de la variable <code>n</code> .  Vous pouvez le considérer comme un sac de tenue de D&amp;D.  Vous mettez votre main dans votre sac et vous vous retrouvez dans une «poche» interdimensionnelle personnelle où vous pouvez ranger tout ce que vous voulez. <br><br><h3>  Debounce </h3><br>  Il y a une chose telle que «éliminer le rebond».  C'est lorsque nous ne voulons pas qu'une fonction soit appelée trop souvent.  Supposons qu'il existe un certain bouton, en cliquant sur celui qui lance un processus «coûteux» (long, ou consommant beaucoup de mémoire, ou Internet, ou sacrifiant des vierges).  Il peut arriver qu'un utilisateur impatient commence à cliquer sur ce bouton avec une fréquence de plus de dix hertz.  De plus, le processus susmentionné a une nature telle qu'il est inutile de l'exécuter dix fois de suite, car le résultat final ne changera pas.  C'est alors que nous appliquons «l'élimination des bavardages». <br><br>  Son essence est très simple: nous effectuons la fonction non pas immédiatement, mais après un certain temps.  Si avant que ce temps ne soit écoulé, la fonction a été rappelée, nous «remettons à zéro la minuterie».  Ainsi, l'utilisateur peut cliquer sur le bouton au moins mille fois - une seule est nécessaire pour le sacrifice.  Cependant, moins de mots, plus de code: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">debounce</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">f, delay</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lastTimeout; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(lastTimeout){ clearTimeout(lastTimeout); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> args = <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.from(<span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>); lastTimeout = setTimeout(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ f.apply(<span class="hljs-literal"><span class="hljs-literal">null</span></span>, args); }, delay); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sacrifice</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(name + <span class="hljs-string"><span class="hljs-string">"     * *"</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sacrificeDebounced</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">debounce</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sacrifice, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">500</span></span></span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sacrificeDebounced</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sacrificeDebounced</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sacrificeDebounced</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span></span><span class="hljs-function">);</span></span></code> </pre><br>  Dans une demi-seconde, Lena sera sacrifiée, et Katya et Sveta survivront grâce à notre fonction magique. <br><br>  Si vous lisez attentivement les exemples précédents, vous devez bien comprendre comment tout fonctionne ici.  La fonction wrapper créée par <code>debounce</code> déclenche l'exécution différée de la fonction d'origine à l'aide de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">setTimeout</a> .  Dans ce cas, l'identifiant de délai d'attente est stocké dans la variable lastTimeout, qui est accessible à l'encapsuleur en raison de la fermeture.  Si l'identificateur de délai d'attente est déjà dans cette variable, l'encapsuleur annule ce délai d'expiration avec <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">clearTimeout</a> .  Si le délai d'attente précédent est déjà terminé, rien ne se passe.  Sinon, tant pis pour lui. <br><br>  Sur ce point, je terminerai peut-être.  J'espère qu'aujourd'hui vous avez appris beaucoup de nouvelles choses, et surtout - vous avez compris tout ce que vous avez appris.  A bientôt. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr421537/">https://habr.com/ru/post/fr421537/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr421527/index.html">Lancement de la diffusion du projet "Serveur dans les nuages"</a></li>
<li><a href="../fr421529/index.html">Netflix, Uber, Google et vous au MBLT DEV 2018</a></li>
<li><a href="../fr421531/index.html">Comment intégrer ReactJS dans 1C-Bitrix avec génération automatique de modèles sur le back-end en utilisant l'exemple du réseau Globus</a></li>
<li><a href="../fr421533/index.html">Choisir un langage de programmation: 3 conseils d'un programmeur d'Apple</a></li>
<li><a href="../fr421535/index.html">Aventure - Electronique. Sur une balançoire ailée dans le monde informatique</a></li>
<li><a href="../fr421543/index.html">Clonez une carte sans contact à l'aide d'une application mobile</a></li>
<li><a href="../fr421545/index.html">Examen du PocketBook 616 - le portefeuille le plus économique 2018 avec fonction de rétro-éclairage</a></li>
<li><a href="../fr421547/index.html">Acceptation du centre de données indépendant</a></li>
<li><a href="../fr421549/index.html">Nous rédigeons de la documentation technique: un guide pour le profane</a></li>
<li><a href="../fr421551/index.html">Maîtriser Vuex - De zéro à héros</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>