<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôÄ üÜé üñï Dar algo de espacio o un microcontrolador como un medidor de frecuencia üë®üèº‚Äçüéì üññüèª üöµüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Todo el mundo sabe acerca de los sistemas de coordenadas satelitales. Tambi√©n le permiten saber la velocidad y la hora actual. Sobre la base de tales ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Dar algo de espacio o un microcontrolador como un medidor de frecuencia</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/476442/"><p>  Todo el mundo sabe acerca de los sistemas de coordenadas satelitales.  Tambi√©n le permiten saber la velocidad y la hora actual.  Sobre la base de tales sistemas, se construyen servidores de tiempo exactos, que ya se han mencionado muchas veces aqu√≠, y no solo aqu√≠.  La precisi√≥n de estos sistemas est√° creciendo, el precio est√° cayendo, en resumen, el progreso no se detiene.  Parece que recientemente fue una cuesti√≥n de milisegundos, y ahora los microsegundos no sorprenden a nadie.  Y el d√≠a no est√° lejos cuando ... </p><br><p>  Honestamente, este d√≠a ya ha llegado para m√≠.  No hace mucho tiempo, me llam√≥ la atenci√≥n la informaci√≥n de que uno de los fabricantes de sus m√≥dulos promete una precisi√≥n del intervalo de se√±al de salida PPS del orden de decenas de nanosegundos. </p><br><p>  En otras palabras, apareci√≥ un segundo est√°ndar con una precisi√≥n muy decente.  Es cierto que no siempre est√° a la mano, y a menudo depende de circunstancias externas, pero puede lograr condiciones favorables y obtenerlo.  Y, lo m√°s importante, c√≥mo copiarse. </p><br><p>  Por si acaso, mir√© c√≥mo van las cosas con otros fabricantes de productos similares y encontr√© las mismas especificaciones t√©cnicas.  "Tendencia, sin embargo", un pensamiento cruz√≥ por mi mente, m√°s o menos, como el de Shtirlits.  Era necesario hacer algo. </p><a name="habracut"></a><br><p>  Aquellos lectores que saben c√≥mo soldar una resistencia desde una placa de circuito impreso o c√≥mo soldar un microcircuito e incluso saben c√≥mo hacerlo, mentalmente est√°n de acuerdo conmigo en que tener un medidor de frecuencia que proporcione una precisi√≥n de 7-8 caracteres nunca va a doler.  Especialmente si ocupa poco espacio y no tiene que pedir prestado mucho dinero para comprarlo.  Y aquellos a quienes no les gusta dejar de pensar pueden pensar en un reloj que se equivoca durante unos segundos al a√±o (en el s√©ptimo d√≠gito, Clara).  Los fan√°ticos de las comunicaciones de radioaficionados probablemente recordar√°n el dise√±o de un buen filtro de banda estrecha hecho en casa en resonadores de cuarzo. </p><br><p>  Lo primero que deb√≠a hacer era encontrar el hardware adecuado.  Me gust√≥ la placa de evaluaci√≥n simple con un peque√±o m√≥dulo Teseo-LIV3F de una empresa conocida.  A continuaci√≥n se muestra c√≥mo es ella. </p><br><p><img src="https://habrastorage.org/webt/js/mx/_d/jsmx_d6f5hgvdwnobhpcrubjc5s.jpeg"></p><br><p>  Esto se vende con una antena activa remota, que se puede instalar m√°s cerca de la ventana para que los sat√©lites puedan "ver" bien.  Los puentes se colocan en el tablero seg√∫n sea necesario para nuestra narraci√≥n y programaci√≥n exitosa.  La foto tambi√©n contiene mejoras en los circuitos en forma de un solo diodo con buena velocidad. </p><br><p>  El esquema de mejoras se mostrar√° a continuaci√≥n.  El fabricante siempre que esta placa se pueda insertar en una placa de evaluaci√≥n Nucleo adecuada con un microcontrolador incorporado (de hecho, estos son conectores para el Arduino, pero no quiero dejarlos con 32 bits).  En la descripci√≥n del propio m√≥dulo GPS / GNSS, encontr√© lo siguiente. </p><br><p><img src="https://habrastorage.org/webt/pp/a0/vw/ppa0vwykeian3mxsratvkynlzuk.jpeg"></p><br><p>  Esto es muy bueno y puede servir como una primera aproximaci√≥n a un buen contador de frecuencia.  Ahora tengo un segundo intervalo muy preciso y puedo calcular la frecuencia de las oscilaciones, por ejemplo, de mi propio oscilador de cristal con control termost√°tico.  E incluso, tal vez, sintonizarlo en la direcci√≥n necesaria para s√≠ mismo.  Ser√° m√°s tarde, probablemente.  Mientras tanto, quer√≠a medir las frecuencias de los resonadores de cuarzo acumulados en la econom√≠a. </p><br><p>  Una placa de la serie Nucleo adecuada est√° construida en el STM32L476RG.  Viene sin un resonador de cuarzo (el reloj no cuenta).  Debajo de la foto se muestran las flechas donde se tuvieron que soldar los elementos faltantes. </p><br><p><img src="https://habrastorage.org/webt/rh/0t/ly/rh0tlyerkgwb9rkg1rugucmereq.jpeg"></p><br><p>  Esta opci√≥n de tablero se selecciona por tres razones.  Primero, el generador de microcontrolador con un resonador externo opera de 4 a 48 MHz.  No todas las placas de microcontroladores Nucleo tienen tales tolerancias.  Vamos a ejecutar este generador con nuestro cuarzo.  En segundo lugar, el puerto serie (UART) puede sincronizarse desde un generador RC incorporado separado con una precisi√≥n del 1% a una frecuencia de 16 MHz.  Por lo tanto, no ser√° necesario cambiar la configuraci√≥n y los divisores en la configuraci√≥n de UART con un cambio en la frecuencia del generador externo.  Y lo m√°s importante, se proporciona un lugar para el montaje en la pared del resonador de cuarzo, donde puede instalar los conectores para no soldar el siguiente resonador cada vez. </p><br><p>  El puerto serie ya est√° conectado al puerto USB virtual en el depurador integrado.  Entonces puede usar el emulador de terminal para mostrar informaci√≥n.  Despu√©s de finalizar e instalar dos desechos para el cuarzo desde el conector del collar, la placa tiene el siguiente aspecto. </p><br><p><img src="https://habrastorage.org/webt/vp/xz/fj/vpxzfj8nws3p7jg5vb4egg_i4_w.jpeg"></p><br><p>  Ahora necesitamos iniciar el temporizador por exactamente un segundo, y contar√° los pulsos de su reloj del sistema, es decir, la frecuencia de nuestro resonador de cuarzo.  Afortunadamente, el temporizador proporciona un modo en el que se reinicia simult√°neamente y comienza desde el borde ascendente del pulso externo. </p><br><p>  Inmediatamente quise hacerlo para no promediar unas pocas mediciones de segundos, sino para medir la frecuencia en diez segundos, es decir, con mayor precisi√≥n.  Para esto, de hecho, se requer√≠a agregar un diodo al circuito y apoyar esta idea mediante programaci√≥n.  El refinamiento del circuito se muestra a continuaci√≥n. </p><br><p><img src="https://habrastorage.org/webt/rn/ln/ob/rnlnobsocqde8ehl8e7s5n1unfc.jpeg"></p><br><p>  Los siguientes diagramas muestran c√≥mo hacer un intervalo de diez segundos desde un segundo. </p><br><p><img src="https://habrastorage.org/webt/bf/5b/hr/bf5bhrse2teowwv6h2gu53yugs0.jpeg"></p><br><p>  La se√±al PPS se suministra al temporizador a trav√©s de un diodo y directamente a la entrada de interrupci√≥n externa adicional.  En la interrupci√≥n del temporizador, se permite una interrupci√≥n externa que, contando hasta diez, se proh√≠be a s√≠ misma y cambia la resistencia pull-up de arriba a abajo. </p><br><p>  Las flechas rojas indican los momentos de la operaci√≥n de interrupci√≥n del temporizador, y el verde indica los momentos del inicio de la interrupci√≥n externa, seg√∫n los cuales se consideran los segundos intervalos requeridos.  El azul muestra resistencias pull-up de encendido y apagado.  El proyecto se realiz√≥ en IAR y puedes verlo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> .  La foto a continuaci√≥n muestra el resultado del programa del controlador junto con el emulador de terminal, que muestra el estado estable. </p><br><p><img src="https://habrastorage.org/webt/5p/o1/lt/5po1ltzl4lnatggoioblytygzt8.jpeg"></p><br><p>  Para ver el gr√°fico, y no las l√≠neas secas de los valores de frecuencia, tuve que componer una peque√±a utilidad para Windows.  Su carcasa est√° en el mismo lugar que el proyecto de firmware. </p><br><p>  Todos los experimentos se realizaron de acuerdo con el mismo escenario.  Antes de las mediciones, la placa se dej√≥ durante quince a veinte minutos en el refrigerador, donde estaba ligeramente por debajo de cero.  Luego se calent√≥ naturalmente a temperatura ambiente durante media hora.  Luego, la placa y el resonador recibieron aire caliente del secador de pelo durante varios minutos (aqu√≠ las mismas condiciones no funcionaron). </p><br><p>  Los buenos resonadores se comportaron bien, es decir, de acuerdo con la dependencia de la temperatura del corte AT del cristal.  Estos gr√°ficos (¬øo copias m√∫ltiples?) Son f√°ciles de encontrar en la red.  Los resultados de las mediciones de tres resonadores a 16 MHz se muestran a continuaci√≥n. </p><br><p><img src="https://habrastorage.org/webt/a8/av/js/a8avjsmwtvw7psub1ch9c2ncxbq.jpeg"></p><br><p>  Luego result√≥ que hay excepciones a la imagen habitual del comportamiento.  Los datos a continuaci√≥n muestran dos cristales de cuarzo del mismo tipo y, muy probablemente, del mismo origen, que se comportaron de manera diferente. </p><br><p><img src="https://habrastorage.org/webt/x-/tl/ff/x-tlffruiqyfvtw8gbjersttc68.jpeg"></p><br><p>  En el resonador, que se comporta como siempre, solo respir√© un poco, y el segundo decidi√≥ calentar m√°s, porque se mostr√≥ de manera diferente.  Qu√© f√°cil es ver la dependencia de la temperatura de √©l o desplazado, o simplemente otro. </p><br><p>  Otra observaci√≥n interesante.  Despu√©s de la exposici√≥n a la temperatura, el resonador no vuelve a los valores de frecuencia pasados, o no tuve la paciencia para esperar.  En cualquier caso, no importa si no te importan los signos despu√©s del sexto. </p><br><p>  Aqu√≠ hay otra observaci√≥n.  Este es el mismo resonador, que tuvo que medirse dos veces, porque caus√≥ sorpresa.  Todav√≠a no he encontrado una explicaci√≥n para tal comportamiento y no se me ocurri√≥. </p><br><p><img src="https://habrastorage.org/webt/bd/av/1y/bdav1ynmfs4o1ebtqabyvtabhw4.jpeg"></p><br><p>  Ser√≠a √∫til eliminar la dependencia de la temperatura individual de la frecuencia para un resonador individual.  Luego puede hacer un generador de segundos intervalos altamente estable usando un buen sensor de temperatura y conociendo la curva de temperatura del resonador.  Sin embargo, esto ya requerir√° una c√°mara de calor.  Me pregunto qu√© sensores de temperatura pueden considerarse buenos hoy. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/476442/">https://habr.com/ru/post/476442/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../476424/index.html">Marcos: m√°s desventajas que ventajas</a></li>
<li><a href="../476428/index.html">Nginx VTS Stats, Mockify - simulacro de API, comparaci√≥n de Wiremock y Mockify</a></li>
<li><a href="../476430/index.html">C√≥mo crear el portafolio t√©cnico perfecto</a></li>
<li><a href="../476434/index.html">Escribimos controladores USB para dispositivos abandonados.</a></li>
<li><a href="../476436/index.html">Informes de la primera reuni√≥n en Rusia de desarrolladores de robots sobre Robot Operating System</a></li>
<li><a href="../476444/index.html">Desmitificaci√≥n de los principios de la computaci√≥n cu√°ntica.</a></li>
<li><a href="../476446/index.html">Complementos de Jira: algunos ejemplos de la invenci√≥n exitosa de la bicicleta</a></li>
<li><a href="../476448/index.html">Exploraci√≥n del sombreador de arena del juego Journey.</a></li>
<li><a href="../476450/index.html">Descripci√≥n general de cPanel: una consola basada en web para administrar sitios y hosting</a></li>
<li><a href="../476452/index.html">Almacenamiento de valor clave o c√≥mo nuestras aplicaciones se han vuelto m√°s convenientes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>