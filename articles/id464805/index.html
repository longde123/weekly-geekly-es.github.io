<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚖 🌩️ 🐔 Menulis ular di iPad (pythonista) 🕕 🐘 👨🏿‍✈️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="... atau cara menghabiskan waktu dengan iPad dan tidak lebih ... 

 Hai 

 Apa yang kamu bicarakan 
 Sayangnya, tablet belum menggantikan komputer. Te...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Menulis ular di iPad (pythonista)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/464805/">  <i>... atau cara menghabiskan waktu dengan iPad dan tidak lebih ...</i> <br><br>  Hai <br><br><h3>  Apa yang kamu bicarakan </h3><br>  Sayangnya, tablet belum menggantikan komputer.  Tetapi memiliki tumpangan / penerbangan sangat penting.  Oleh karena itu, saya mencari apa yang ada di bawah iPad, dan sebenarnya hari ini saya akan melakukan permainan di Pythonista. <br><br><h3>  Apa yang akan kita lakukan </h3><br>  Program yang paling sederhana, seperti kristal (ya, ya, yang Anda mainkan di kereta bawah tanah).  Tetris, ular, isi - pendatang baru, memiliki sedikit pemahaman, akan menulisnya dalam 30 menit.  Di bawah cutscene - tangkapan layar, tutorial, kode. <br><a name="habracut"></a><br>  Berikut adalah beberapa tangkapan layar dari apa yang saya buat kacau: <br><br><div class="spoiler">  <b class="spoiler_title">Banyak tangkapan layar</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/n5/t-/0l/n5t-0lksjmfrqpvj-hphcjrqgv4.png"><br><br><img src="https://habrastorage.org/webt/lv/a0/ay/lva0ay1p6xghjzuh60hbewak8-i.png"><br><br><img src="https://habrastorage.org/webt/az/ow/zh/azowzhphjmi5xju-ynvluvhot48.png"><br><br><img src="https://habrastorage.org/webt/pf/vq/yj/pfvqyj1em0bsun4ozseqvjl6458.png"><br><br><img src="https://habrastorage.org/webt/4k/lo/w9/4klow9qq74gspnkh888hsksgk7c.png"><br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">Penafian</b> <div class="spoiler_text">  Artikel ini tidak hanya khusus untuk pemula (tetapi mengetahui python) dan tidak akan memungkinkan Anda untuk membuat dunia tank dalam sepuluh menit atau aplikasi siap pakai pada umumnya, tetapi penulis tidak menjamin kode yang benar-benar indah dan benar dari sudut pandang pemrograman agama (walaupun ia mencoba) .  Dan juga ada sesuatu yang dicuri dari contoh dan dokumentasi pythonista. <br></div></div><br>  <i>Semua kode akan diberikan di akhir.</i> <br><br><h3>  Mengenal gambar dalam pythonista </h3><br><div class="spoiler">  <b class="spoiler_title">Impor</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scene <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random</code> </pre> <br></div></div><br>  Segera buat heboh: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.background_color = <span class="hljs-string"><span class="hljs-string">"green"</span></span> run(Game(), LANDSCAPE)</code> </pre><br>  Baiklah, mari kita mulai segera.  Anda harus memiliki layar hijau.  Mari kita lakukan beberapa hal keren dengan menambahkan metode pembaruan (yang disebut sistem itu sendiri) ke kelas Game, dan mengubah warna latar belakangnya. <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#    def update(self): self.background_color = (1.0, 1.0, (math.sin(self.t) + 1) / 2)</span></span></code> </pre><br>  Sekarang layar kita dengan lancar berubah dari kuning menjadi putih dan sebaliknya. <br><br><img src="https://habrastorage.org/webt/-h/h_/vu/-hh_vuqntwuqqpno4h_jtu0944m.png"><br><br>  Sekarang buat beberapa objek.  Kami juga membuatnya dalam metode pengaturan: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.background_color = <span class="hljs-string"><span class="hljs-string">"white"</span></span> mypath = ui.Path.rect(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>) self.obj = ShapeNode(mypath) self.obj.color = <span class="hljs-string"><span class="hljs-string">"purple"</span></span> <span class="hljs-comment"><span class="hljs-comment">#      html,  #FF00FF.   tuple,   (1.0, 0.0, 1.0).       alpha,    self.add_child(self.obj) def update(self): self.obj.position = (500 + 200 * math.sin(self.t), 500 + 200 * math.cos(self.t))</span></span></code> </pre><br>  Kami mengatur garis (mypath), membuat ShapeNode di atasnya, menunjukkan warnanya, dan kemudian menentukan induknya (pada dasarnya hal yang sama - tentukan induknya saat membuat, mis. ShapeNode (* ..., parent = self) atau self.add_child (obj)). <br><br>  Nah, di Game.update () kami mengubah posisi objek (tuple), dan itu dalam piksel dan dihitung dari sudut kiri bawah. <br><blockquote>  Perhatikan bahwa kita tidak perlu menggambar ulang adegan (meskipun dimungkinkan).  Objek dan node yang orang tuanya adalah adegan (atau beberapa objek anaknya) digambar ulang sendiri <br></blockquote>  Hal terakhir yang akan kita lalui di bagian ini adalah touch_began (dan juga touch_moved dan touch_ended).  Mudah ditebak, metode ini menangkap klik di layar.  Mari kita coba: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">touch_began</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, touch)</span></span></span><span class="hljs-function">:</span></span> mypath = ui.Path.oval(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>) obj = ShapeNode(mypath) obj.color = (<span class="hljs-number"><span class="hljs-number">0.5</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>, <span class="hljs-number"><span class="hljs-number">1.0</span></span>) self.add_child(obj) obj.position = touch.location</code> </pre><br><img src="https://habrastorage.org/webt/gp/1m/mu/gp1mmunnpgr5y6_c0ge8hpzqn8q.png"><br><br>  Setiap kali Anda mengklik pada layar, kami membuat lingkaran, tempat klik adalah touch.location. <br><br><h3>  Siap menulis ular </h3><br><div class="spoiler">  <b class="spoiler_title">Mekanisme permainan</b> <div class="spoiler_text">  Seekor ular adalah deretan kotak, ketika kepala bergerak - potongan kedua bergerak ke tempat yang pertama, yang ketiga ke tempat yang kedua, dll. Untuk mengetahui persimpangan kepala dengan ekor, kita akan membandingkannya dengan setiap potongan ekor <br></div></div><br>  Kami menghapus semua kode tertulis, karena kami ingin melakukannya dengan lebih atau kurang indah (tetapi, tentu saja, kami akan melakukan sepeda). <br><br>  Pertama, mari kita buat kelas PhyObj: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PhyObj</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, path, color, parent)</span></span></span><span class="hljs-function">:</span></span> self.graph_obj = ShapeNode(path, parent=parent) self.parent = parent self.graph_obj.color = color <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setpos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y)</span></span></span><span class="hljs-function">:</span></span> self.graph_obj.position = (x, y) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getpos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.graph_obj.position <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y)</span></span></span><span class="hljs-function">:</span></span> self.graph_obj.position += (x, y)</code> </pre><br>  Saya pikir semuanya sepele di sini.  Di dalam kelas itu sendiri, kami membuat simpul, dan juga menjelaskan beberapa metode yang akan membuat kode kami lebih mudah dibaca. <br><br><div class="spoiler">  <b class="spoiler_title">Holivary</b> <div class="spoiler_text">  Secara pribadi, saya lebih suka membuat kelas tingkat rendah yang memiliki banyak metode dan properti duplikat, tetapi kemudian kode di tingkat yang lebih tinggi menjadi sangat indah dan mudah dibaca. <br></div></div><br>  PhyObj adalah objek level terendah dalam game kami, bahkan itu adalah objek fisik abstrak. <br><br><h4>  Deskripsi ular </h4><br>  Sekarang kita perlu menggambarkan ular itu, dan karena itu terdiri dari potongan-potongan, pertama-tama kita akan menggambarkan satu: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Tile</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(PhyObj)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, parent, size, margin=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">4</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> super().__init__(ui.Path.rect(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, size[<span class="hljs-number"><span class="hljs-number">0</span></span>] - margin, size[<span class="hljs-number"><span class="hljs-number">1</span></span>] - margin), <span class="hljs-string"><span class="hljs-string">"#66FF66"</span></span>, parent) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">die</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.graph_obj.color = <span class="hljs-string"><span class="hljs-string">"red"</span></span></code> </pre><br>  Dalam konstruktor, kita memanggil metode induk kelas dan memberi diri kita bentuk dan warna.  margin diperlukan agar kotak tidak saling menempel dan membuat semacam jaring. <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.tile = Tile(self, (<span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>)) self.tile.setpos(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>)</code> </pre><br>  Seharusnya berubah: <br><br><img src="https://habrastorage.org/webt/dg/yl/tf/dgyltfilompjygqnrriiio1mhv8.png"><br><br>  Tapi misalnya, mengapa kita perlu margin: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> tile1 = Tile(self, (<span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>)) tile1.setpos(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>) tile2 = Tile(self, (<span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>)) tile2.setpos(<span class="hljs-number"><span class="hljs-number">140</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>)</code> </pre><br><img src="https://habrastorage.org/webt/0n/p8/i0/0np8i041mbo7udct2rsi3twsj18.png"><br><br>  Nah, sekarang dari potongan-potongan ini Anda perlu lem ular.  Kami membutuhkan metode inisialisasi dan metode bergerak. <br><br>  Pertama, buat inisialisasi: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Snake</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, length, width, initpos, parent)</span></span></span><span class="hljs-function">:</span></span> self.width = width <span class="hljs-comment"><span class="hljs-comment">#     self.tiles = [Tile(parent, (width, width)) for i in range(length)] #        for i, tile in enumerate(self.tiles): tile.setpos(initpos[0] + i * self.width, initpos[1]) #       </span></span></code> </pre><br>  Mari kita coba menggambarnya segera: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.snake = Snake(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>, (<span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span>), self)</code> </pre><br><img src="https://habrastorage.org/webt/gv/kl/gg/gvklgg1stltccf2hxsyyuae_rsu.png"><br><br>  Nah, tambahkan metode pindah. <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Snake</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(len(self.tiles) - <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>): self.tiles[i].setpos(*self.tiles[i - <span class="hljs-number"><span class="hljs-number">1</span></span>].getpos()) self.tiles[<span class="hljs-number"><span class="hljs-number">0</span></span>].move(x * self.width, y * self.width)</code> </pre><br>  Pertama kita memindahkan yang terakhir ke kedua dari belakang, lalu yang kedua dari belakang ke yang kedua ... kemudian yang kedua ke yang kedua.  Dan yang pertama di (x, y). <br><br>  Sebenarnya, ular kami bergerak dengan baik.  Mari kita coba: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(self)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def update(self): self.snake.move(0, 1)</span></span></code> </pre><br>  Jika Anda berhasil melihat, maka dia merangkak pergi sebagaimana mestinya.  Faktanya adalah bahwa pembaruan sangat sering dipanggil (dan omong-omong, secara opsional dengan interval yang sama), jadi kita perlu mempertimbangkan berapa banyak waktu yang telah berlalu sejak panggilan terakhir dan menunggu sampai "cukup" terakumulasi. <br><br>  Singkatnya, kami melakukan: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time_reset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.last_time = self.t <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time_gone</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, t)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.t - self.last_time &gt; t: res = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> self.time_reset() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: res = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.snake = Snake(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>, (<span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span>), self) self.time_reset() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.time_gone(<span class="hljs-number"><span class="hljs-number">0.3</span></span>): self.snake.move(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre><br>  time_gone mengembalikan True jika lebih banyak waktu telah berlalu daripada t.  Sekarang ular akan bergerak setiap 0,3 detik.  Apakah itu berhasil? <br><br><img src="https://habrastorage.org/webt/it/ew/cn/itewcnxtf37hx-bkj2-_tnrjnug.png"><br><br><h4>  Manajemen </h4><br>  Sekarang Anda perlu melakukan kontrol, yaitu, belokan di keempat arah: <br><br><img src="https://habrastorage.org/webt/5l/hw/mo/5lhwmoxex5c_lfafmihwivyw1ym.png"><br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def setup(self): # &lt;...&gt; self.dir = (0, 1) #     def update(self): if self.time_gone(0.3): self.snake.move(*self.dir)</span></span></code> </pre><br>  Dan sekarang kita perlu melakukan proses touch_began untuk memahami area yang ditusuk pengguna.  Sebenarnya, ternyata tidak semenarik yang saya kira, jadi di sini Anda cukup menyalin: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def touch_began(self, touch): ws = touch.location[0] / self.size.w hs = touch.location[1] / self.size.h aws = 1 - ws if ws &gt; hs and aws &gt; hs: self.dir = (0, -1) elif ws &gt; hs and aws &lt;= hs: self.dir = (1, 0) elif ws &lt;= hs and aws &gt; hs: self.dir = (-1, 0) else: self.dir = (0, 1)</span></span></code> </pre><br>  Nah, coba balik sekarang <br><br><img src="https://habrastorage.org/webt/-a/s5/8p/-as58pqevh1gfcxx4a556pttljo.png"><br><br>  Mekanisme utama berhasil, masih harus melakukan pemeriksaan untuk tabrakan dan apel. <br><br><h4>  Tabrakan ekor </h4><br>  Mari kita mulai dengan memeriksa dan menambahkan metode find_collisions ke ular <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Snake</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def find_collisions(self): for i in range(1, len(self.tiles)): if self.tiles[i].getpos() == self.tiles[0].getpos(): return self.tiles[i], self.tiles[0] return False</span></span></code> </pre><br>  Sekarang kita bisa mendapatkan sepasang sel yang berpotongan.  Saya ingin warna mereka merah, tambahkan metode die ke Tile: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Tile</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(PhyObj)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def die(self): self.graph_obj.color = "red"</span></span></code> </pre><br>  Tambahkan cek untuk memperbarui dan mengubah pengaturan: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def setup(self): self.snake = Snake(30, 40, (200, 200), self) #   self.time_reset() self.dir = (0, 1) self.game_on = True #   ? def update(self): if not self.game_on: #  ,  return col = self.snake.find_collisions() #  ? if col: for tile in col: tile.die() #     self.game_on = False #   if self.time_gone(0.3): self.snake.move(*self.dir)</span></span></code> </pre><br>  Apa yang terjadi pada saya: <br><br><img src="https://habrastorage.org/webt/zu/gx/n2/zugxn2bxvlbhj6cagawcjy-qsdi.png"><br><br>  Masih membuat apel. <br><br><h4>  Perpanjangan dan apel </h4><br>  Kami akan memperpanjang ular itu, dan agar terlihat indah, tautan baru akan ditambahkan sesuai dengan dua yang terakhir, yaitu: <br><br><img src="https://habrastorage.org/webt/kl/sg/uv/klsguvpmusyky4y78dvdmk_nvdu.png"><br><br>  Tambahkan metode ke ular: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Snake</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def find_dir(self, x1, y1, x2, y2): if x1 == x2 and y1 &gt; y2: return (0, 1) elif x1 == x2 and y1 &lt; y2: return (0, -1) elif y1 == y2 and x1 &gt; x2: return (1, 0) elif y1 == y2 and x1 &lt; x2: return (-1, 0) else: assert False, "Error!" def append(self): if len(self.tiles) &gt; 1: lastdir = self.find_dir(*self.tiles[-1].getpos(), *self.tiles[-2].getpos()) else: lastdir = (-self.parent.dir[0], -self.parent.dir[1]) self.tiles.append(Tile(self.parent, (self.width, self.width))) x_prev, y_prev = self.tiles[-2].getpos() self.tiles[-1].setpos(x_prev + lastdir[0] * self.width, y_prev + lastdir[1] * self.width)</span></span></code> </pre><br>  find_dir menemukan arah di mana ujung ekor pahlawan kita diarahkan.  tambahkan, mudah ditebak, menambahkan sel.  Tambahkan metode snake_lengthen lain ke Game: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def snake_lengthen(self): self.snake.append() self.time_reset()</span></span></code> </pre><br>  Baris terakhir diperlukan agar ular menunggu sedikit, dan pengguna punya waktu untuk melihat bahwa potongan telah ditambahkan. <br><br>  Untuk mengetahui apakah ada sesuatu yang bersilangan dengan ular, tambahkan metode perpotongan padanya. <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Snake</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def getpos(self): return self.tiles[0].getpos() def intersect(self, x, y): return self.getpos() == (x, y)</span></span></code> </pre><br>  Hore, tetap hanya untuk membuat apel.  Sebenarnya, kami menggambarkan apel dalam sekali jalan: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Apple</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(PhyObj)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, width, size, parent)</span></span></span><span class="hljs-function">:</span></span> super().__init__(ui.Path.oval(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, size[<span class="hljs-number"><span class="hljs-number">0</span></span>], size[<span class="hljs-number"><span class="hljs-number">1</span></span>]), <span class="hljs-string"><span class="hljs-string">"#55AAFF"</span></span>, parent) self.parent = parent self.width = width self.dislocate() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dislocate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> a = random.randint(<span class="hljs-number"><span class="hljs-number">2</span></span>, int(self.parent.size.w / self.width) - <span class="hljs-number"><span class="hljs-number">2</span></span>) b = random.randint(<span class="hljs-number"><span class="hljs-number">2</span></span>, int(self.parent.size.h / self.width) - <span class="hljs-number"><span class="hljs-number">2</span></span>) self.setpos(a * self.width, b * self.width)</code> </pre><br>  Keacakan yang aneh seperti itu diperlukan agar sesuai dengan mata banteng kita di grid.  Maka tidak perlu mencari jarak antara moncong dan apel dan membandingkan pyre-pyr-nya.  Hanya di ifas.  Mari kita perbarui dan tambahkan baris yang sangat sederhana ke akhir fungsi ini: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def setup(self): self.apple = Apple(40, (50, 50), self) # 40 -  ,       Snake() # &lt;...&gt; def update(self): # &lt;...&gt; if self.snake.intersect(*self.apple.getpos()): self.snake_lengthen() self.apple.dislocate()</span></span></code> </pre><br>  Nah, semuanya tampaknya, sekarang ular memanjang jika menabrak apel dan mati jika menabrak dirinya sendiri. <br><br><img src="https://habrastorage.org/webt/0r/de/gw/0rdegw0knuwccnbh6jz5oy5hova.png"><br><br><h4>  Bonus </h4><br>  Anda dapat membuat efek suara: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sound <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def snake_lengthen(self): self.snake.append() self.time_reset() sound.play_effect('arcade:Powerup_1', 0.25, 0.8)</span></span></code> </pre><br>  Lakukan gerakan halus: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def setup(self): self.game_on = False self.GLOBAL_TIMING = 0.2 self.GLOBAL_WIDTH = 40 self.apple = Apple(self.GLOBAL_WIDTH, (50, 50), self) self.snake = Snake(10, self.GLOBAL_WIDTH, (200, 200), self) self.time_reset() self.dir = (0, 1) self.game_on = True class Snake: # &lt;...&gt; def move(self, x, y): for i in range(len(self.tiles) - 1, 0, -1): self.tiles[i].setpos(*self.tiles[i - 1].getpos(), self.parent.GLOBAL_TIMING) self.tiles[0].move(x * self.width, y * self.width, self.parent.GLOBAL_TIMING) class PhyObj: def __init__(self, path, color, parent): self.graph_obj = ShapeNode(path, parent=parent) self.parent = parent self.graph_obj.color = color self.pos = self.graph_obj.position def setpos(self, x, y, t=0.0): self.pos = (x, y) self.graph_obj.run_action(Action.move_to(x, y, t)) #    x, y    t def getpos(self): return self.pos def move(self, x, y, t=0.0): self.pos = (self.pos[0] + x, self.pos[1] + y) self.graph_obj.run_action(Action.move_by(x, y, t))</span></span></code> </pre><br>  Dengan kata lain, kami mengubah logika posisi PhyObj.  Sebelumnya, kami fokus pada posisi elemen grafis, dan sekarang ada bidang terpisah untuk posisi logis (yaitu, yang digunakan untuk logika permainan), dan posisi elemen grafis sekarang bebas dan entah bagaimana dapat diubah dengan caranya sendiri.  Yaitu, menggunakan Action, kami meninggalkannya aliran paralel, di mana dia bergerak. <br><br>  Ternyata ular yang begitu halus: <br><br><img src="https://habrastorage.org/webt/8g/ma/4x/8gma4xndidknidevmnr49pleuyc.png"><br><br>  Dan akhirnya, label dengan panjang ular: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def setup(self): self.game_on = False self.GLOBAL_TIMING = 0.2 self.GLOBAL_WIDTH = 40 self.apple = Apple(self.GLOBAL_WIDTH, (50, 50), self) self.snake = Snake(30, self.GLOBAL_WIDTH, (200, 200), self) self.time_reset() self.dir = (0, 1) self.label = LabelNode("", font=("Chalkduster", 20), parent=self, position=(self.size.w / 2, self.size.h - 100)) #    self.update_labels() self.game_on = True def update_labels(self): self.label.text = "Length: " + str(len(self.snake.tiles)) def update(self): if not self.game_on: return col = self.snake.find_collisions() if col: for tile in col: tile.die() self.game_on = False if self.time_gone(self.GLOBAL_TIMING): self.snake.move(*self.dir) if self.snake.intersect(*self.apple.getpos()): self.snake_lengthen() self.apple.dislocate() self.update_labels() # </span></span></code> </pre><br><img src="https://habrastorage.org/webt/pu/vk/s5/puvks5yyrimbzdvzfbt4kwysml4.png"><br><br>  Teman-teman, terima kasih atas perhatian Anda!  Jika ada sesuatu yang tidak jelas, tanyakan.  Dan jika itu akan menarik - saya akan melanjutkan, masih ada sesuatu untuk diceritakan (tetapi artikel ini sudah agak panjang). <br><br><div class="spoiler">  <b class="spoiler_title">Semua kode ular</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scene <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> math <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sound <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PhyObj</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, path, color, parent)</span></span></span><span class="hljs-function">:</span></span> self.graph_obj = ShapeNode(path, parent=parent) self.parent = parent self.graph_obj.color = color self.pos = self.graph_obj.position <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setpos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y, t=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> self.pos = (x, y) self.graph_obj.run_action(Action.move_to(x, y, t)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getpos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.pos <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y, t=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> self.pos = (self.pos[<span class="hljs-number"><span class="hljs-number">0</span></span>] + x, self.pos[<span class="hljs-number"><span class="hljs-number">1</span></span>] + y) self.graph_obj.run_action(Action.move_by(x, y, t)) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Tile</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(PhyObj)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, parent, size, margin=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">4</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> super().__init__(ui.Path.rect(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, size[<span class="hljs-number"><span class="hljs-number">0</span></span>] - margin, size[<span class="hljs-number"><span class="hljs-number">1</span></span>] - margin), <span class="hljs-string"><span class="hljs-string">"#66FF66"</span></span>, parent) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">die</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.graph_obj.color = <span class="hljs-string"><span class="hljs-string">"red"</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Snake</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, length, width, initpos, parent)</span></span></span><span class="hljs-function">:</span></span> self.width = width self.tiles = [Tile(parent, (width, width)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(length)] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i, tile <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(self.tiles): tile.setpos(initpos[<span class="hljs-number"><span class="hljs-number">0</span></span>] + i * self.width, initpos[<span class="hljs-number"><span class="hljs-number">1</span></span>]) self.parent = parent <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(len(self.tiles) - <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>): self.tiles[i].setpos(*self.tiles[i - <span class="hljs-number"><span class="hljs-number">1</span></span>].getpos(), self.parent.GLOBAL_TIMING) self.tiles[<span class="hljs-number"><span class="hljs-number">0</span></span>].move(x * self.width, y * self.width, self.parent.GLOBAL_TIMING) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">find_collisions</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">1</span></span>, len(self.tiles)): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.tiles[i].getpos() == self.tiles[<span class="hljs-number"><span class="hljs-number">0</span></span>].getpos(): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.tiles[i], self.tiles[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">find_dir</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x1, y1, x2, y2)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> x1 == x2 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> y1 &gt; y2: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> x1 == x2 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> y1 &lt; y2: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> y1 == y2 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> x1 &gt; x2: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> y1 == y2 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> x1 &lt; x2: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">"Error!"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">append</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(self.tiles) &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>: lastdir = self.find_dir(*self.tiles[<span class="hljs-number"><span class="hljs-number">-1</span></span>].getpos(), *self.tiles[<span class="hljs-number"><span class="hljs-number">-2</span></span>].getpos()) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: lastdir = (-self.parent.dir[<span class="hljs-number"><span class="hljs-number">0</span></span>], -self.parent.dir[<span class="hljs-number"><span class="hljs-number">1</span></span>]) self.tiles.append(Tile(self.parent, (self.width, self.width))) x_prev, y_prev = self.tiles[<span class="hljs-number"><span class="hljs-number">-2</span></span>].getpos() self.tiles[<span class="hljs-number"><span class="hljs-number">-1</span></span>].setpos(x_prev + lastdir[<span class="hljs-number"><span class="hljs-number">0</span></span>] * self.width, y_prev + lastdir[<span class="hljs-number"><span class="hljs-number">1</span></span>] * self.width) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getpos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.tiles[<span class="hljs-number"><span class="hljs-number">0</span></span>].getpos() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">intersect</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.getpos() == (x, y) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Apple</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(PhyObj)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, width, size, parent)</span></span></span><span class="hljs-function">:</span></span> super().__init__(ui.Path.oval(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, size[<span class="hljs-number"><span class="hljs-number">0</span></span>], size[<span class="hljs-number"><span class="hljs-number">1</span></span>]), <span class="hljs-string"><span class="hljs-string">"#55AAFF"</span></span>, parent) self.parent = parent self.width = width self.dislocate() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dislocate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> a = random.randint(<span class="hljs-number"><span class="hljs-number">2</span></span>, int(self.parent.size.w / self.width) - <span class="hljs-number"><span class="hljs-number">2</span></span>) b = random.randint(<span class="hljs-number"><span class="hljs-number">2</span></span>, int(self.parent.size.h / self.width) - <span class="hljs-number"><span class="hljs-number">2</span></span>) self.setpos(a * self.width, b * self.width) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">snake_lengthen</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.snake.append() self.time_reset() sound.play_effect(<span class="hljs-string"><span class="hljs-string">'arcade:Powerup_1'</span></span>, <span class="hljs-number"><span class="hljs-number">0.25</span></span>, <span class="hljs-number"><span class="hljs-number">0.8</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time_reset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.last_time = self.t <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time_gone</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, t)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.t - self.last_time &gt; t: res = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> self.time_reset() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: res = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.game_on = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> self.GLOBAL_TIMING = <span class="hljs-number"><span class="hljs-number">0.2</span></span> self.GLOBAL_WIDTH = <span class="hljs-number"><span class="hljs-number">40</span></span> self.apple = Apple(self.GLOBAL_WIDTH, (<span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>), self) self.snake = Snake(<span class="hljs-number"><span class="hljs-number">30</span></span>, self.GLOBAL_WIDTH, (<span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span>), self) self.time_reset() self.dir = (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) self.label = LabelNode(<span class="hljs-string"><span class="hljs-string">""</span></span>, font=(<span class="hljs-string"><span class="hljs-string">"Chalkduster"</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>), parent=self, position=(self.size.w / <span class="hljs-number"><span class="hljs-number">2</span></span>, self.size.h - <span class="hljs-number"><span class="hljs-number">100</span></span>)) self.update_labels() self.game_on = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update_labels</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.label.text = <span class="hljs-string"><span class="hljs-string">"Length: "</span></span> + str(len(self.snake.tiles)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> self.game_on: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> col = self.snake.find_collisions() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> col: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> tile <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> col: tile.die() self.game_on = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.time_gone(self.GLOBAL_TIMING): self.snake.move(*self.dir) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.snake.intersect(*self.apple.getpos()): self.snake_lengthen() self.apple.dislocate() self.update_labels() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">touch_began</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, touch)</span></span></span><span class="hljs-function">:</span></span> ws = touch.location[<span class="hljs-number"><span class="hljs-number">0</span></span>] / self.size.w hs = touch.location[<span class="hljs-number"><span class="hljs-number">1</span></span>] / self.size.h aws = <span class="hljs-number"><span class="hljs-number">1</span></span> - ws <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ws &gt; hs <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> aws &gt; hs: self.dir = (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> ws &gt; hs <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> aws &lt;= hs: self.dir = (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> ws &lt;= hs <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> aws &gt; hs: self.dir = (<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: self.dir = (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) run(Game(), LANDSCAPE)</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Kode kristal Edisi WhiteBlackGoose</b> <div class="spoiler_text">  Sangat lucu bahwa setelah saya membuatnya, saya menemukan sesuatu yang SANGAT mirip dalam contoh-contoh dari pythonista itu sendiri.  Tapi saya punya lebih banyak fitur :) <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scene <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> math <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pi <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uniform <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> rnd, choice, randint <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random A = Action sys.setrecursionlimit(<span class="hljs-number"><span class="hljs-number">1000000</span></span>) colors = [<span class="hljs-string"><span class="hljs-string">'pzl:Green5'</span></span>, <span class="hljs-string"><span class="hljs-string">"pzl:Red5"</span></span>, <span class="hljs-string"><span class="hljs-string">"pzl:Blue5"</span></span>] + [<span class="hljs-string"><span class="hljs-string">"pzl:Purple5"</span></span>, <span class="hljs-string"><span class="hljs-string">"pzl:Button2"</span></span>] + [<span class="hljs-string"><span class="hljs-string">"plf:Item_CoinGold"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> inited inited = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Explosion</span></span></span><span class="hljs-class"> </span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Node)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, brick, *args, **kwargs)</span></span></span><span class="hljs-function">:</span></span> Node.__init__(self, *args, **kwargs) self.position = brick.position <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> dx, dy <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ((<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>), (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>), (<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)): p = SpriteNode(brick.texture, scale=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, parent=self) p.position = brick.size.w/<span class="hljs-number"><span class="hljs-number">4</span></span> * dx, brick.size.h/<span class="hljs-number"><span class="hljs-number">4</span></span> * dy p.size = brick.size d = <span class="hljs-number"><span class="hljs-number">0.6</span></span> r = <span class="hljs-number"><span class="hljs-number">30</span></span> p.run_action(A.move_to(rnd(-r, r), rnd(-r, r), d)) p.run_action(A.scale_to(<span class="hljs-number"><span class="hljs-number">0</span></span>, d)) p.run_action(A.rotate_to(rnd(-pi/<span class="hljs-number"><span class="hljs-number">2</span></span>, pi/<span class="hljs-number"><span class="hljs-number">2</span></span>), d)) self.run_action(A.sequence(A.wait(d), A.remove())) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Brick</span></span></span><span class="hljs-class"> </span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(SpriteNode)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, brick_type, *args, **kwargs)</span></span></span><span class="hljs-function">:</span></span> img = colors[brick_type] SpriteNode.__init__(self, img, *args, **kwargs) self.brick_type = brick_type self.is_on = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> self.lf = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> self.enabled = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">destroy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.remove_from_parent() self.is_on = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mark</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.lf = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">demark</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.lf = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">brickgetpos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, i, j)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (self.Woff + j * self.W, self.Hoff + i * self.H) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">brick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, ty, i, j)</span></span></span><span class="hljs-function">:</span></span> b = Brick(ty, size=(self.W, self.H), position=self.brickgetpos(i, j), parent=self.game_node) b.rotation = random.random() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> b <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">random_brick_type</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> random.random() &lt; <span class="hljs-number"><span class="hljs-number">0.992</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> random.randint(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> random.random() &lt; <span class="hljs-number"><span class="hljs-number">0.8</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> FONT = (<span class="hljs-string"><span class="hljs-string">'Chalkduster'</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>) self.score_label = LabelNode(<span class="hljs-string"><span class="hljs-string">'Score: 0'</span></span>, font=FONT, position=(self.size.w/<span class="hljs-number"><span class="hljs-number">2</span></span><span class="hljs-number"><span class="hljs-number">-100</span></span>, self.size.h<span class="hljs-number"><span class="hljs-number">-40</span></span>), parent=self) self.score = <span class="hljs-number"><span class="hljs-number">0</span></span> self.last_score_label = LabelNode(<span class="hljs-string"><span class="hljs-string">'Delta: +0'</span></span>, font=FONT, position=(self.size.w/<span class="hljs-number"><span class="hljs-number">2</span></span><span class="hljs-number"><span class="hljs-number">-300</span></span>, self.size.h<span class="hljs-number"><span class="hljs-number">-40</span></span>), parent=self) self.last_score = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">#self.avg_label = LabelNode('Speed: +0/s', font=FONT, position=(self.size.w/2+100, self.size.h-40), parent=self) #self.max_label = LabelNode('Peak: +0/s', font=FONT, position=(self.size.w/2+300, self.size.h-40), parent=self) #self.max_speed = 0 self.game_time = 120 self.timel = LabelNode('Time: ' + str(self.game_time) + "s", font=FONT, position=(self.size.w/2+300, self.size.h-40), parent=self) self.gems = [0 for i in colors] self.effect_node = EffectNode(parent=self) self.game_node = Node(parent=self.effect_node) self.l = [0 for i in colors] self.lt = [0 for i in colors] for i in range(len(colors)): R = 50 if i == 6 else 35 self.l[i] = Brick(i, size=(R, R), position=(40, self.size.h-100-i*40), parent=self.game_node) self.lt[i] = LabelNode(": 0", font=FONT, position=(self.l[i].position[0] + 40, self.l[i].position[1]), parent=self) self.WB = 30 self.HB = 30 self.W = 900 // self.WB self.H = 900 // self.HB self.colcount = 4 self.Woff = (int(self.size.w) - self.W * self.WB + self.W) // 2 self.Hoff = self.H + 10 self.net = [[self.brick(self.random_brick_type(), i, j) for i in range(self.HB)] for j in range(self.WB)] #self.touch_moved = self.touch_began self.start_time = self.t self.game_on = True global inited inited = True def demark(self): for bricks in self.net: for brick in bricks: brick.demark() def howfar(self, x, y): alt = 0 for i in range(y): if not self.net[x][i].is_on: alt += 1 return alt def update(self): global inited if not inited: return self.game_on = self.t - self.start_time &lt; self.game_time if self.game_on: self.timel.text = "Time: " + str(round(self.game_time - (self.t - self.start_time))) + "s" else: self.timel.text = "Game over" #if speed &gt; self.max_speed: # self.max_speed = speed # self.max_label.text = "Peak: +" + str(round(self.max_speed)) + "/s" def gravity(self, x, y): alt = self.howfar(x, y) if alt == 0: return self.net[x][y].destroy() self.net[x][y - alt] = self.brick(self.net[x][y].brick_type, y, x) self.net[x][y - alt].position = self.net[x][y].position self.net[x][y - alt].rotation = self.net[x][y].rotation self.net[x][y - alt].enabled = False self.net[x][y - alt].run_action(A.sequence(A.move_to(*self.brickgetpos(y - alt, x), 0.2 * alt ** 0.5, TIMING_EASE_IN_2), A.call(lambda: self.enable_cell(x, y - alt)))) def enable_cell(self, x, y): self.net[x][y].enabled = True def fall(self): for x in range(self.WB): for y in range(self.HB): if self.net[x][y].is_on: self.gravity(x, y) def update_scores(self): self.score += self.last_score self.score_label.text = "Score: " + str(self.score) self.last_score_label.text = "Delta: +" + str(self.last_score) self.last_score = 0 def update_cells(self): for i in range(self.WB): for j in range(self.HB): if not self.net[i][j].is_on: self.net[i][j] = self.brick(self.random_brick_type(), j + self.HB, i) self.net[i][j].enabled = True self.net[i][j].run_action(A.sequence(A.move_to(*self.brickgetpos(j, i), 0.2 * self.HB ** 0.5, TIMING_EASE_IN_2), A.call(lambda: self.enable_cell(i, j)))) def inbounds(self, x, y): return (x &gt;= 0) and (y &gt;= 0) and (x &lt; self.WB) and (y &lt; self.HB) def bomb(self, x, y, radius): score = 0 bc = 0 for i in range(round(4 * radius ** 2)): rad = random.random() * radius ang = random.random() * 2 * pi xp, yp = x + sin(ang) * rad, y + cos(ang) * rad xp, yp = int(xp), int(yp) if self.inbounds(xp, yp): score += self.explode(xp, yp) self.fall() self.give_score(round(score / 1.7), self.brickgetpos(y, x)) def laser(self, x, y): score = 0 coords = [] for i in range(self.HB): for j in range(-1, 1 + 1, 1): coords.append((x + j, i)) for i in range(self.WB): coords.append((i, y)) for i in range(-self.HB, self.HB): coords.append((x + i, y + i)) for i in range(-self.WB, self.WB): coords.append((x - i, y + i)) bc = 0 for x, y in coords: if not self.inbounds(x, y): continue score += self.explode(x, y) self.fall() self.give_score(score, self.brickgetpos(y, x)) def getty(self, x, y): if not self.inbounds(x, y) or not self.net[x][y].is_on: return -1 else: return self.net[x][y].brick_type def popupt(self, text, position_, font_=("Arial", 30), color_="white"): label = LabelNode(text, font=font_, color=color_, parent=self, position=position_) label.run_action(A.sequence(A.wait(1), A.call(label.remove_from_parent))) def give_score(self, count, xy): self.last_score = int(count ** 2.5) size = 10 if self.last_score &gt; 50000: size = 60 elif self.last_score &gt; 20000: size = 40 elif self.last_score &gt; 10000: size = 30 elif self.last_score &gt; 5000: size = 25 elif self.last_score &gt; 2000: size = 20 elif self.last_score &gt; 1000: size = 15 if self.last_score &gt; 0: self.popupt("+" + str(self.last_score), xy, font_=("Chalkduster", int(size * 1.5))) self.update_scores() def touch_began(self, touch): if not self.game_on: return x, y = touch.location x, y = x + self.W / 2, y + self.H / 2 W, H = get_screen_size() x, y = x, y x, y = int(x), int(y) x, y = x - self.Woff, y - self.Hoff x, y = x // self.W, y // self.H if not self.inbounds(x, y): return count = self.react(self.net[x][y].brick_type, x, y, True) self.demark() if self.getty(x, y) in [0, 1, 2, 3]: if count &gt;= 2: self.react(self.net[x][y].brick_type, x, y) self.fall() self.give_score(count, touch.location) elif self.getty(x, y) == 4: self.bomb(x, y, 5 * count) elif self.getty(x, y) == 5: self.explode(x, y) self.fall() self.update_cells() def explode(self, x, y): if self.net[x][y].is_on: self.net[x][y].destroy() self.gems[self.net[x][y].brick_type] += 1 s = str(self.gems[self.net[x][y].brick_type]) self.lt[self.net[x][y].brick_type].text = " " * len(s) + ": " + s self.game_node.add_child(Explosion(self.net[x][y])) return True else: return False def react(self, col, x, y, ignore=False): if self.inbounds(x, y) and self.net[x][y].brick_type == col and self.net[x][y].is_on and self.net[x][y].lf and self.net[x][y].enabled: if not ignore: self.explode(x, y) else: self.net[x][y].mark() r = 1 r += self.react(col, x + 1, y + 0, ignore) r += self.react(col, x - 1, y - 0, ignore) r += self.react(col, x + 0, y + 1, ignore) r += self.react(col, x - 0, y - 1, ignore) return r else: return 0 def destroy_brick(self, x, y): self.net[x][y].destroy() run(Game(), LANDSCAPE, show_fps=True)</span></span></code> </pre><br></div></div><br>  Demonstrasi karya kristal: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/PLTlEe3xsaU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id464805/">https://habr.com/ru/post/id464805/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id464785/index.html">Manfaat Langsung Menuju Yang Tidak Kompetitif</a></li>
<li><a href="../id464787/index.html">Saya yakin pengembang senior ponsel hanya akan datang berdasarkan rekomendasi</a></li>
<li><a href="../id464791/index.html">Kubernetes untuk mobil: cara membuka akses pengembang ke komputer yang terpasang dan membuatnya aman</a></li>
<li><a href="../id464795/index.html">Merry Quartusel, atau bagaimana prosesor telah hidup seperti itu</a></li>
<li><a href="../id464803/index.html">"Sembunyikan www": mengapa pengembang browser utama kembali menolak untuk menampilkan subdomain</a></li>
<li><a href="../id464809/index.html">Bagaimana kami menguji teknologi pengenalan wajah dan apa yang terjadi</a></li>
<li><a href="../id464811/index.html">Apple Music untuk pengembang</a></li>
<li><a href="../id464813/index.html">Mengganti Punto Switcher, tata letak Birman dengan skrip autohotkey</a></li>
<li><a href="../id464819/index.html">Hari keenam saya dengan Haiku: di bawah tenda sumber daya, ikon dan paket</a></li>
<li><a href="../id464823/index.html">Kami mempertimbangkan gaji rata-rata seorang "ahli data data." Parsim hh.ru menggunakan panda / python</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>