<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüëß üî© ü¶ó D√©placement du portail Web: de l'architecture monolithique √† l'architecture microservice üöØ üë≤üèΩ üë©üèø‚Äç‚úàÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nous partageons l'exp√©rience de la modernisation de l'architecture du portail web, qui a permis de rendre le produit pratique, stable et tol√©rant aux ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>D√©placement du portail Web: de l'architecture monolithique √† l'architecture microservice</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/simbirsoft/blog/449538/">  Nous partageons l'exp√©rience de la modernisation de l'architecture du portail web, qui a permis de rendre le produit pratique, stable et tol√©rant aux pannes: le trafic est pass√© de 350 mille √† 7 millions d'utilisateurs!  L'histoire sera utile √† ceux qui envisagent d'√©tendre leur produit.  Tout d'abord, nous examinerons quels facteurs peuvent interf√©rer avec le travail et le d√©veloppement du portail Web: <a name="habracut"></a><br><br><ul><li>  <b>Obsolescence.</b>  L'approche de l'utilisabilit√©, l'adaptation √† diff√©rents appareils, l'apparence √©l√©mentaire et la structure cessent de r√©pondre aux besoins du public au fil du temps. </li><li>  <b>Obsolescence technologique.</b>  Les normes et la technologie Web √©voluent constamment.  Les changements affectent √† la fois les outils de d√©veloppement (par exemple, les frameworks, les bases de donn√©es, les autres logiciels) et les fondements fondamentaux du Web.  Du relativement r√©cent - une transition massive de http √† https et l'abandon du support du DNS h√©rit√©. <br></li><li>  <b>Erreurs et plantages.</b>  Les d√©veloppeurs peuvent imparfaitement faire face √† leur t√¢che et permettre des failles.  En cons√©quence, des violations du site peuvent se produire - √† commencer par le fait que les boutons ne fonctionnent pas la premi√®re fois, jusqu'√† ce que les syst√®mes tombent compl√®tement en panne. <br></li></ul><br>  <b>Cas</b> <br><br>  Nous avons √©t√© approch√©s par un client dont le portail Web avait besoin d'√™tre d√©velopp√©.  √Ä un certain moment, un plafond de 350 000 visiteurs uniques a √©t√© atteint chaque mois.  Cela semblait insuffisant - le projet avait manifestement des perspectives, et nous devions trouver ce qui emp√™chait exactement une nouvelle augmentation de la ressource. <br><br>  <b>Audit</b> <br><br>  Il s'est av√©r√© que l'ancien moteur Bitrix n'√©tait pas adapt√© aux charges et √† la mise √† l'√©chelle.  Chaque composant du syst√®me se croisait √©troitement et d√©pendait les uns des autres.  La correction constante des bogues √©tait une t√¢che si atroce que nous avons propos√© une architecture de microservice flexible et compr√©hensible.  En eux, chaque composant est suffisamment ind√©pendant pour que les erreurs qu'il contient ne ¬´blessent¬ª pas les √©l√©ments restants du syst√®me. <br><br>  Bitrix est rest√© la base de l'architecture - au moins, l'autorisation y est li√©e, mais l√† o√π c'√©tait possible et promettait une grande efficacit√©, nous avons transf√©r√© la fonctionnalit√© aux microservices.  Ils sont devenus la pierre angulaire du projet. <br><br>  La nouvelle architecture combin√©e nous a fourni un fonctionnement stable et plus rapide des syst√®mes et une absence presque compl√®te d'erreurs sur certains modules.  Il a √©galement servi de base au travail efficace des sp√©cialistes du marketing.  Gr√¢ce √† l'architecture am√©lior√©e, les sp√©cialistes de la promotion ont r√©ussi √† multiplier par 20 la fr√©quentation de la ressource. <br><br><img src="https://habrastorage.org/webt/7d/bt/kv/7dbtkvfsxywcnuakaw_wdu92ebs.jpeg"><br><br>  <b>Microservices</b> <br><br>  Dans les microservices autonomes, nous avons distingu√© des modules tels qu'un chargeur de fichiers, une recherche et un fil d'actualit√©s.  En plus de ces √©l√©ments conviviaux et √©vidents, de nombreux autres √©l√©ments fonctionnels ont √©t√© mis en ≈ìuvre sous forme de microservices: <br><br><ul><li>  D√©chargement, stockage et gestion des donn√©es des projets open source; </li><li>  Cr√©ation dynamique de flux RSS; </li><li>  Cr√©ation dynamique d'un syst√®me de blocs, disposition des mat√©riaux de tous les services en blocs structurels; </li><li>  Ajout de donn√©es suppl√©mentaires aux documents de service; </li><li>  Service de support technique; </li><li>  Un catalogue unique de diverses donn√©es. </li></ul><br>  En plus de tout ce qui pr√©c√®de, nous avons cr√©√© de nombreux microservices pour un travail pratique avec le panneau d'administration. <br><br><img src="https://habrastorage.org/webt/mx/7t/e-/mx7te-grrfkdfydja2xll-yjc-w.png"><br><br>  Chaque bloc fonctionnel du site est devenu une unit√© assez autonome.  Un processus d√©di√© est utilis√© pour le chargement et le rendu, minimisant l'intersection avec d'autres services. <br><br>  D'accord, lorsqu'un utilisateur effectue un paiement, il ne voudra pas attendre longtemps pour charger le script responsable de la lecture de la vid√©o dont il n'a pas besoin dans une autre partie de la page.  En effet, c'est ce qui se passe dans les syst√®mes monolithiques - les fonctionnalit√©s lat√©rales interf√®rent parfois avec le travail de composants vraiment importants. <br><br>  Nous avons franchi la premi√®re √©tape et simplifi√© la vie des utilisateurs et des d√©veloppeurs, en publiant plus de 20 nouveaux services par an.  En cons√©quence: <br><br><ul><li>  Nous avons r√©solu le probl√®me de la mise √† l'√©chelle. </li><li>  Impl√©mentation d'un processus de d√©veloppement plus efficace par des √©quipes r√©parties. </li><li>  Configurez une gestion dynamique des ressources pour un fonctionnement du syst√®me fluide et rapide. </li></ul><br><br>  <b>Mise √† niveau de la pile technologique</b> <br><br>  En parall√®le, nous avons mis √† jour la pile technologique.  Si le portail √©tait √† l'origine bas√© sur php 5.6 et MySQL 5.6, alors au cours de l'am√©lioration du moteur, nous l'avons chang√© en php 7.0 et MySQL 5.7.  Impl√©mentation du framework Yii2, mise en cache memcache. <br><br><img src="https://habrastorage.org/webt/zc/zb/6b/zczb6baxnrskcroqim0i0ry1dt8.jpeg"><br><br>  <b>File d'attente des t√¢ches</b> <br><br>  Afin de mieux parall√©liser les t√¢ches, nous avons d√©plac√© les travailleurs Web - gestionnaires internes - vers la file d'attente RabbitMQ.  Il optimise la s√©quence des √©v√©nements de d√©clenchement, ce qui r√©duit la charge sur le syst√®me.  Travailler avec le site est devenu beaucoup plus rapide et plus confortable. <br><br>  <b>Int√©gration continue</b> <br><br>  Un processus de d√©veloppement transparent et g√©rable est pris en charge √† l'aide de GitLab CI.  Il s'agit d'un d√©veloppement sans faille vraiment continu qui laisse aux programmeurs et aux testeurs plus de temps avec des questions importantes au lieu de corriger les trous. <br><br>  Afin de minimiser les erreurs, nous avons introduit des boucles de d√©veloppement suppl√©mentaires.  La cha√Æne se compose de plusieurs boucles de test d'application et d'infrastructure: pr√©-version, o√π se d√©roulent les derniers tests d'assemblage (pr√©-prod), combat (prod), plusieurs boucles de test pour tester plusieurs builds √† la fois, ainsi qu'une boucle pour les d√©veloppeurs. <br><br>  <b>Syst√®me d'assemblage</b> <br><br>  Au stade initial, les builds sont cr√©√©s √† partir des sources du projet.  Au lieu d'un ensemble disparate de classes, de styles et de gestionnaires, des entit√©s combin√©es sont utilis√©es - chacune dans le shell d'un fichier ex√©cutable.  Seules les constructions n√©cessaires sont plac√©es dans l'assemblage pour effectuer des √©v√©nements sur la page.  Cela offre en outre la flexibilit√© et la vitesse du site. <br><br>  <b>Surveillance des erreurs</b> <br><br>  GitLab CI fournit des fonctionnalit√©s avanc√©es pour la validation de code et les tests automatis√©s.  √Ä la moindre divergence des assemblages avec les param√®tres donn√©s, le syst√®me avertit les d√©veloppeurs et ne permet pas de d√©marrer le processus ult√©rieur d'impl√©mentation des composants jusqu'√† la correction des bogues.  De plus, nous avons install√© Sentry, un outil complet de surveillance des erreurs. <br><br><img src="https://habrastorage.org/webt/it/ut/p8/itutp8xvbdiiouv1swb1idprlxe.png"><br><br>  <b>Optimisation des processus</b> <br><br>  Pour maintenir le syst√®me dans un √©tat de haute performance, nous avons constamment optimis√© les processus m√©tier et l'infrastructure.  Les biblioth√®ques partag√©es et les prototypes de services sont devenus la base de la mise en ≈ìuvre rapide de nouvelles fonctions - nous prenons des mod√®les pr√™ts √† l'emploi et en peu de temps nous obtenons un produit fonctionnel. <br><br>  <b>Surveillance et fonctionnement</b> <br><br>  Tous les processus sont bien visibles.  En surveillant l'√©tat de chaque n≈ìud, nous fournissons Zabbix - un syst√®me de suivi complet.  Nous avons eu l'occasion d'examiner le c≈ìur m√™me de la structure du projet et de le voir de mani√®re compacte. <br><br>  Nous avons √©galement connect√© la plate-forme Grafana, qui transforme les donn√©es s√®ches en un tableau de bord visuel pour la commodit√© des employ√©s des clients. <br><br>  <b>Stabilisation et refactoring</b> <br><br>  Au besoin, nous avons refactoris√© le syst√®me - le code est simplifi√© et devient concis.  Dans le m√™me temps, il y a toujours de la place pour se d√©velopper, car le dopage r√©gulier des syst√®mes acc√©l√®re le site.  En cons√©quence, la ressource est devenue plus conviviale pour les moteurs de recherche et les utilisateurs. <br><br>  <b>La nouvelle architecture est la base de la croissance</b> <br><br>  Au d√©but des travaux, la ressource avait un potentiel de promotion modeste et n'√©tait pas suffisamment pratique pour les clients, ce qui entravait les processus commerciaux de l'entreprise.  Pour am√©liorer le processus d'interaction des utilisateurs avec le site, nous avons presque enti√®rement mis √† jour l'architecture du portail et sa structure, cr√©√© un m√©canisme flexible qui s'int√®gre √† un grand nombre de services et d'applications, gr√¢ce √† notre propre API.  De nombreux services fonctionnent de mani√®re optimale depuis plus d'un an, sans n√©cessiter d'intervention - le nombre d'erreurs dans leur travail est tomb√© √† presque z√©ro. <br><br>  Le nouveau site est un puissant outil de d√©veloppement commercial, avec un potentiel de d√©veloppement √† plus grande √©chelle.  Gr√¢ce √† l'architecture mise √† jour de l'application Web, les responsables marketing du projet ont pu mettre en ≈ìuvre leur gamme d'activit√©s promotionnelles et augmenter le trafic de 350 000 visiteurs uniques par mois √† plus de 7 millions.  De plus, apr√®s une augmentation multiple d'audience, le portail continue de fonctionner de mani√®re stable. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr449538/">https://habr.com/ru/post/fr449538/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr449526/index.html">Pr√©sentation de Tartiflette: une impl√©mentation Open Source GraphQL pour Python 3.6+</a></li>
<li><a href="../fr449528/index.html">Sur la d√©composition de la r√©ponse multicanal d'un syst√®me en modes de vibration ¬´pseudo-propri√©taires¬ª</a></li>
<li><a href="../fr449532/index.html">ok.tech: Meetup Cassandra</a></li>
<li><a href="../fr449534/index.html">Concept car SLA: comment c'est fait en Chine</a></li>
<li><a href="../fr449536/index.html">iOS Digest n ¬∞ 4 (5 avril - 26 avril)</a></li>
<li><a href="../fr449540/index.html">Effet de shader Doodle</a></li>
<li><a href="../fr449542/index.html">La m√©decine se d√©place vers le Web, les forums de discussion et les applications mobiles. Conversation avec BestDoctor</a></li>
<li><a href="../fr449544/index.html">Le monde moderne repose sur l'API</a></li>
<li><a href="../fr449546/index.html">V8: un an avec Spectre</a></li>
<li><a href="../fr449548/index.html">Centre de donn√©es spatiales. Reportage vid√©o du lancement</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>