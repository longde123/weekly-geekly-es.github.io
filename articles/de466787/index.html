<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëçüèæ üê© üçø Volltextsuche in Android üòâ üóùÔ∏è üçô</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In mobilen Anwendungen ist die Suchfunktion sehr beliebt. Und wenn dies bei kleinen Produkten vernachl√§ssigt werden kann, k√∂nnen Sie in Anwendungen, d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Volltextsuche in Android</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/raiffeisenbank/blog/466787/">  In mobilen Anwendungen ist die Suchfunktion sehr beliebt.  Und wenn dies bei kleinen Produkten vernachl√§ssigt werden kann, k√∂nnen Sie in Anwendungen, die Zugriff auf eine gro√üe Menge an Informationen bieten, nicht auf eine Suche verzichten.  Heute werde ich Ihnen erkl√§ren, wie Sie diese Funktion in Programmen f√ºr Android korrekt implementieren. <br><br><img src="https://habrastorage.org/webt/qf/4e/cm/qf4ecmc9japqzpsmwfoajjrlozk.jpeg"><br><a name="habracut"></a><br><h3>  Ans√§tze zur Implementierung der Suche in einer mobilen Anwendung </h3><br><ol><li>  <b>Suche als Datenfilter</b> <br><br>  Normalerweise sieht es aus wie eine Suchleiste √ºber einer Liste.  Das hei√üt, wir filtern nur die fertigen Daten. </li><li>  <b>Serversuche</b> <br><br>  In diesem Fall geben wir die gesamte Implementierung an den Server weiter, und die Anwendung fungiert als Thin Client, von dem aus nur die Daten in der richtigen Form angezeigt werden m√ºssen. </li><li>  <b>Integrierte Suche</b> <br><br><ul><li>  Die Anwendung enth√§lt eine gro√üe Menge von Daten verschiedener Typen. </li><li>  Die Anwendung funktioniert offline. </li><li>  Die Suche wird als einzelner Zugriffspunkt auf Abschnitte / Inhalte der Anwendung ben√∂tigt. </li></ul></li></ol><br>  Im letzteren Fall hilft die in SQLite integrierte Volltextsuche.  Mit dieser Funktion k√∂nnen Sie sehr schnell √úbereinstimmungen in einer gro√üen Menge an Informationen finden, sodass wir mehrere Abfragen an verschiedene Tabellen durchf√ºhren k√∂nnen, ohne die Leistung zu beeintr√§chtigen. <br><br>  Betrachten Sie die Implementierung einer solchen Suche anhand eines bestimmten Beispiels. <br><br><h3>  Datenaufbereitung </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Angenommen</a> , wir m√ºssen eine Anwendung implementieren, die eine Liste der Filme von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">themoviedb.org anzeigt</a> .  Nehmen Sie zur Vereinfachung (um nicht online zu gehen) eine Liste von Filmen und erstellen Sie daraus eine JSON-Datei, legen Sie sie in Assets ab und f√ºllen Sie unsere Datenbank lokal. <br><br>  Beispiel f√ºr eine JSON-Dateistruktur: <br><br><pre><code class="kotlin hljs">[ { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">278</span></span>, <span class="hljs-string"><span class="hljs-string">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-string"><span class="hljs-string">"overview"</span></span>: <span class="hljs-string"><span class="hljs-string">"  ..."</span></span> }, { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">238</span></span>, <span class="hljs-string"><span class="hljs-string">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"overview"</span></span>: <span class="hljs-string"><span class="hljs-string">" , ..."</span></span> }, { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">424</span></span>, <span class="hljs-string"><span class="hljs-string">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"overview"</span></span>: <span class="hljs-string"><span class="hljs-string">"   ..."</span></span> } ]</code> </pre> <br><h3>  Datenbank f√ºllen </h3><br>  SQLite verwendet virtuelle Tabellen, um die Volltextsuche zu implementieren.  √Ñu√üerlich sehen sie wie normale SQLite-Tabellen aus, aber jeder Zugriff auf sie erledigt einige Backstage-Arbeiten. <br><br>  Mit virtuellen Tabellen k√∂nnen wir die Suche beschleunigen.  Neben den Vorteilen haben sie aber auch Nachteile: <br><br><ul><li>  Sie k√∂nnen keinen Trigger f√ºr eine virtuelle Tabelle erstellen. </li><li>  Sie k√∂nnen die Befehle ALTER TABLE und ADD COLUMN nicht f√ºr eine virtuelle Tabelle ausf√ºhren. </li><li>  Jede Spalte in der virtuellen Tabelle ist indiziert. Dies bedeutet, dass Ressourcen f√ºr die Indizierung von Spalten verschwendet werden k√∂nnen, die nicht an der Suche beteiligt sein sollten. </li></ul><br>  Um das letztere Problem zu l√∂sen, k√∂nnen Sie zus√§tzliche Tabellen verwenden, die einen Teil der Informationen enthalten, und Links zu Elementen einer regul√§ren Tabelle in einer virtuellen Tabelle speichern. <br><br>  Das Erstellen einer Tabelle unterscheidet sich geringf√ºgig vom Standard. Wir haben die Schl√ºsselw√∂rter <code>VIRTUAL</code> und <code>fts4</code> : <br><br><pre> <code class="kotlin hljs"> CREATE VIRTUAL TABLE movies USING fts4(id, title, overview);</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Kommentar zur fts5-Version</b> <div class="spoiler_text">  Es wurde bereits zu SQLite hinzugef√ºgt.  Diese Version ist produktiver, genauer und enth√§lt viele neue Funktionen.  Aufgrund der gro√üen Fragmentierung von Android k√∂nnen wir fts5 (verf√ºgbar mit API24) nicht auf allen Ger√§ten verwenden.  Sie k√∂nnen unterschiedliche Logik f√ºr verschiedene Versionen des Betriebssystems schreiben, dies erschwert jedoch die weitere Entwicklung und Unterst√ºtzung erheblich.  Wir haben uns f√ºr den einfacheren Weg entschieden und fts4 verwendet, das auf den meisten Ger√§ten unterst√ºtzt wird. </div></div><br>  Das Bef√ºllen unterscheidet sich nicht von √ºblich: <br><br><pre> <code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">populate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(context: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Context</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> movies: MutableList&lt;Movie&gt; = mutableListOf() context.assets.<span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(<span class="hljs-string"><span class="hljs-string">"movies.json"</span></span>).use { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> typeToken = <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> : TypeToken&lt;List&lt;Movie&gt;&gt;() {}.type movies.addAll(Gson().fromJson(InputStreamReader(it), typeToken)) } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { writableDatabase.beginTransaction() movies.forEach { movie -&gt; <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> values = ContentValues().apply { put(<span class="hljs-string"><span class="hljs-string">"id"</span></span>, movie.id) put(<span class="hljs-string"><span class="hljs-string">"title"</span></span>, movie.title) put(<span class="hljs-string"><span class="hljs-string">"overview"</span></span>, movie.overview) } writableDatabase.insert(<span class="hljs-string"><span class="hljs-string">"movies"</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, values) } writableDatabase.setTransactionSuccessful() } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { writableDatabase.endTransaction() } }</code> </pre> <br><h3>  Basisversion </h3><br>  Bei der Ausf√ºhrung der Abfrage wird anstelle von <code>LIKE</code> das Schl√ºsselwort <code>MATCH</code> verwendet: <br><br><pre> <code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">firstSearch</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(searchString: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: List&lt;Movie&gt; { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> query = <span class="hljs-string"><span class="hljs-string">"SELECT * FROM movies WHERE movies MATCH '</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$searchString</span></span></span><span class="hljs-string">'"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> cursor = readableDatabase.rawQuery(query, <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> result = mutableListOf&lt;Movie&gt;() cursor?.use { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!cursor.moveToFirst()) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (!cursor.isAfterLast) { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> id = cursor.getInt(<span class="hljs-string"><span class="hljs-string">"id"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> title = cursor.getString(<span class="hljs-string"><span class="hljs-string">"title"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> overview = cursor.getString(<span class="hljs-string"><span class="hljs-string">"overview"</span></span>) result.add(Movie(id, title, overview)) cursor.moveToNext() } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result }</code> </pre> <br>  Um die Verarbeitung von Texteingaben in der Benutzeroberfl√§che zu implementieren, verwenden wir <code>RxJava</code> : <br><br><pre> <code class="kotlin hljs">RxTextView.afterTextChangeEvents(findViewById(R.id.editText)) .debounce(<span class="hljs-number"><span class="hljs-number">500</span></span>, TimeUnit.MILLISECONDS) .map { it.editable().toString() } .filter { it.isNotEmpty() &amp;&amp; it.length &gt; <span class="hljs-number"><span class="hljs-number">2</span></span> } .map(dbHelper::firstSearch) .subscribeOn(Schedulers.computation()) .observeOn(AndroidSchedulers.mainThread()) .subscribe(movieAdapter::updateMovies)</code> </pre> <br>  Das Ergebnis ist eine grundlegende Suchoption.  Im ersten Element wurde das gew√ºnschte Wort in der Beschreibung und im zweiten Element sowohl im Titel als auch in der Beschreibung gefunden.  Offensichtlich ist in dieser Form nicht ganz klar, was wir gefunden haben.  Lass es uns reparieren. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wb/jq/vo/wbjqvon_lp-zpsc9_wnnlxey6e0.png"></div><br><h3>  Akzente setzen </h3><br>  Um die Offensichtlichkeit der Suche zu verbessern, verwenden wir die Hilfsfunktion <code>SNIPPET</code> .  Es wird verwendet, um ein formatiertes Textfragment anzuzeigen, in dem eine √úbereinstimmung gefunden wird. <br><br><pre> <code class="kotlin hljs">snippet(movies, <span class="hljs-string"><span class="hljs-string">'&lt;b&gt;'</span></span>, <span class="hljs-string"><span class="hljs-string">'&lt;/b&gt;'</span></span>, <span class="hljs-string"><span class="hljs-string">'...'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>)</code> </pre> <br><ul><li>  Filme - Tabellenname; </li><li>  &lt;b &amp; gt und &lt;/ b&gt; - Diese Argumente werden verwendet, um einen Textabschnitt hervorzuheben, der durchsucht wurde. </li><li>  ... - f√ºr die Gestaltung des Textes, wenn das Ergebnis ein unvollst√§ndiger Wert war; </li><li>  1 - Spaltennummer der Tabelle, aus der Textst√ºcke zugewiesen werden; </li><li>  15 ist eine ungef√§hre Anzahl von W√∂rtern, die im zur√ºckgegebenen Textwert enthalten sind. </li></ul><br>  Der Code ist identisch mit dem ersten, wobei die Anforderung nicht ber√ºcksichtigt wird: <br><br><pre> <code class="kotlin hljs">SELECT id, snippet(movies, <span class="hljs-string"><span class="hljs-string">'&lt;b&gt;'</span></span>, <span class="hljs-string"><span class="hljs-string">'&lt;/b&gt;'</span></span>, <span class="hljs-string"><span class="hljs-string">'...'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>) title, snippet(movies, <span class="hljs-string"><span class="hljs-string">'&lt;b&gt;'</span></span>, <span class="hljs-string"><span class="hljs-string">'&lt;/b&gt;'</span></span>, <span class="hljs-string"><span class="hljs-string">'...'</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>) overview FROM movies WHERE movies MATCH <span class="hljs-string"><span class="hljs-string">''</span></span></code> </pre> <br>  Wir versuchen es erneut: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/7u/wc/1x/7uwc1x11wt7dw4qdterexvd2y1a.png"></div><br>  Es stellte sich deutlicher heraus als in der vorherigen Version.  Dies ist jedoch nicht das Ende.  Lassen Sie uns unsere Suche "vollst√§ndiger" machen.  Wir werden die lexikalische Analyse verwenden und die wesentlichen Teile unserer Suchanfrage hervorheben. <br><br><h3>  Beende die Verbesserung </h3><br>  SQLite verf√ºgt √ºber integrierte Token, mit denen Sie eine lexikalische Analyse durchf√ºhren und die urspr√ºngliche Suchabfrage transformieren k√∂nnen.  Wenn wir beim Erstellen der Tabelle keinen bestimmten Tokenizer angegeben haben, wird "einfach" ausgew√§hlt.  Tats√§chlich konvertiert es nur unsere Daten in Kleinbuchstaben und verwirft unlesbare Zeichen.  Es passt nicht ganz zu uns. <br><br>  F√ºr eine qualitative Verbesserung der Suche m√ºssen wir <i>Stemming verwenden</i> - den Prozess, bei dem die Basis eines Wortes f√ºr ein bestimmtes Quellwort gefunden wird. <br><br>  SQLite verf√ºgt √ºber einen zus√§tzlichen integrierten Tokenizer, der den Porter Stemmer-Algorithmus verwendet.  Dieser Algorithmus wendet nacheinander eine Reihe bestimmter Regeln an und hebt wichtige Teile eines Wortes hervor, indem Endungen und Suffixe abgeschnitten werden.  Wenn wir beispielsweise nach "Schl√ºsseln" suchen, k√∂nnen wir eine Suche erhalten, bei der die W√∂rter "Schl√ºssel", "Schl√ºssel" und "Schl√ºssel" enthalten sind.  Ich werde am Ende einen Link zu einer detaillierten Beschreibung des Algorithmus hinterlassen. <br><br>  Leider funktioniert der in SQLite integrierte Tokenizer nur mit Englisch. F√ºr die russische Sprache m√ºssen Sie daher Ihre eigene Implementierung schreiben oder vorgefertigte Entwicklungen verwenden.  Wir werden die fertige Implementierung von der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">algorithmist.ru-</a> Site √ºbernehmen. <br><br>  Wir wandeln unsere Suchanfrage in die erforderliche Form um: <br><br><ol><li>  Entfernen Sie zus√§tzliche Zeichen. </li><li>  Brechen Sie die Phrase in W√∂rter. </li><li>  √úberspringen Sie den Stemmer. </li><li>  Sammeln Sie in einer Suchabfrage. </li></ol><br><div class="spoiler">  <b class="spoiler_title">Porter-Algorithmus</b> <div class="spoiler_text"><br><pre> <code class="kotlin hljs"> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> Porter { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> PERFECTIVEGROUND = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"((|||||)|((&lt;=[])(||)))$"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> REFLEXIVE = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"([])$"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> ADJECTIVE = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"(|||||||||||||||||||||||||)$"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> PARTICIPLE = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"((||)|((?&lt;=[])(||||)))$"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> VERB = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"((||||||||||||||||||||||||||||)|((?&lt;=[])(||||||||||||||||)))$"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> NOUN = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"(|||||||||||||||||||||||||||||||||||)$"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> RVRE = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"^(.*?[])(.*)$"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> DERIVATIONAL = Pattern.compile(<span class="hljs-string"><span class="hljs-string">".*[^]+[].*?$"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> DER = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"?$"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> SUPERLATIVE = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"(|)$"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> I = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"$"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> P = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"$"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> NN = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"$"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stem</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(words: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: String { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> word = words word = word.toLowerCase() word = word.replace(<span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> m = RVRE.matcher(word) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m.matches()) { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> pre = m.group(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rv = m.group(<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> temp = PERFECTIVEGROUND.matcher(rv).replaceFirst(<span class="hljs-string"><span class="hljs-string">""</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (temp == rv) { rv = REFLEXIVE.matcher(rv).replaceFirst(<span class="hljs-string"><span class="hljs-string">""</span></span>) temp = ADJECTIVE.matcher(rv).replaceFirst(<span class="hljs-string"><span class="hljs-string">""</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (temp != rv) { rv = temp rv = PARTICIPLE.matcher(rv).replaceFirst(<span class="hljs-string"><span class="hljs-string">""</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { temp = VERB.matcher(rv).replaceFirst(<span class="hljs-string"><span class="hljs-string">""</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (temp == rv) { rv = NOUN.matcher(rv).replaceFirst(<span class="hljs-string"><span class="hljs-string">""</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { rv = temp } } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { rv = temp } rv = I.matcher(rv).replaceFirst(<span class="hljs-string"><span class="hljs-string">""</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (DERIVATIONAL.matcher(rv).matches()) { rv = DER.matcher(rv).replaceFirst(<span class="hljs-string"><span class="hljs-string">""</span></span>) } temp = P.matcher(rv).replaceFirst(<span class="hljs-string"><span class="hljs-string">""</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (temp == rv) { rv = SUPERLATIVE.matcher(rv).replaceFirst(<span class="hljs-string"><span class="hljs-string">""</span></span>) rv = NN.matcher(rv).replaceFirst(<span class="hljs-string"><span class="hljs-string">""</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { rv = temp } word = pre + rv } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> word } }</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Algorithmus, bei dem wir die Phrase in W√∂rter zerlegen</b> <div class="spoiler_text"><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> words = searchString .replace(<span class="hljs-string"><span class="hljs-string">"\"(\\[\"]|.*)?\""</span></span>.toRegex(), <span class="hljs-string"><span class="hljs-string">" "</span></span>) .split(<span class="hljs-string"><span class="hljs-string">"[^\\p{Alpha}]+"</span></span>.toRegex()) .filter { it.isNotBlank() } .map(Porter::stem) .filter { it.length &gt; <span class="hljs-number"><span class="hljs-number">2</span></span> } .joinToString(separator = <span class="hljs-string"><span class="hljs-string">" OR "</span></span>, transform = { <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$it</span></span></span><span class="hljs-string">*"</span></span> })</code> </pre> </div></div><br>  Nach dieser Konvertierung sieht der Ausdruck "Innenh√∂fe und Geister" wie "Hof <b>* ODER</b> Geist <b>*</b> " aus. <br><br>  Das Symbol " <b>*</b> " bedeutet, dass die Suche durch das Auftreten eines bestimmten Wortes mit anderen Worten durchgef√ºhrt wird.  Der Operator " <b>ODER</b> " bedeutet, dass Ergebnisse angezeigt werden, die mindestens ein Wort aus der Suchphrase enthalten.  Wir schauen: <br><br><img src="https://habrastorage.org/webt/vw/c9/sx/vwc9sxcgklqvfinisn_yq3hx998.png"><br><br><h3>  Zusammenfassung </h3><br>  Die Volltextsuche ist nicht so kompliziert, wie es auf den ersten Blick erscheinen mag.  Wir haben ein spezielles Beispiel analysiert, das Sie schnell und einfach in Ihr Projekt implementieren k√∂nnen.  Wenn Sie etwas Komplizierteres ben√∂tigen, sollten Sie sich an die Dokumentation wenden, da es eine gibt und diese ziemlich gut geschrieben ist. <br><br><h3>  Referenzen: </h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Vollst√§ndige Quelle</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Stamming-Algorithmus</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Porter Stemmer f√ºr Russisch</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">FTS4-Dokumentation</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Informationen zu virtuellen Tabellen in SQLite</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de466787/">https://habr.com/ru/post/de466787/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de466775/index.html">So funktioniert es: Frequenzauswahl f√ºr 5G</a></li>
<li><a href="../de466777/index.html">Empfehlungen zum Erstellen von Anwendungen in React Native. Teil 1</a></li>
<li><a href="../de466779/index.html">Englisch lernen: 8 M√∂glichkeiten, h√∂flich Nein zu sagen</a></li>
<li><a href="../de466781/index.html">Neuronale Echtzeitnetze zur Handverfolgung</a></li>
<li><a href="../de466785/index.html">Was die Berge lehren: die Wahl eines IT-Spezialisten</a></li>
<li><a href="../de466793/index.html">Startups im russischen Fu√üball: Sie existieren</a></li>
<li><a href="../de466799/index.html">Maltego ist n√§her am K√∂rper. Teil 2</a></li>
<li><a href="../de466801/index.html">Umgehen des LinkedIn-Suchlimits durch Spielen mit der API</a></li>
<li><a href="../de466803/index.html">Slurm DevOps. 3. Tag. ELK, ChatOps, SRE. Und das geheime Gebet des Entwicklers</a></li>
<li><a href="../de466805/index.html">Warum in Zukunft Raumschiffe durch Extrusion hergestellt werden</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>