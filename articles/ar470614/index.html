<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌇 🗝️ 😸 كيف تم ترتيب الرسومات NES؟ 🏴󠁧󠁢󠁳󠁣󠁴󠁿 👩🏿‍🏫 🎊</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="تم إطلاق وحدة التحكم الرئيسية في نظام Nintendo Entertainment System (NES) عام 1983 ، وهي آلة رخيصة ولكنها حققت نجاحًا هائلاً. باستخدام وحدة معالجة الص...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>كيف تم ترتيب الرسومات NES؟</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/470614/" style=";text-align:right;direction:rtl"><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/9ad/f22/f28/9adf22f2804a300f6f3e9a98fe15c13b.gif" alt="صورة"></div><br>  تم إطلاق وحدة التحكم الرئيسية في نظام Nintendo Entertainment System (NES) عام 1983 ، وهي آلة رخيصة ولكنها حققت نجاحًا هائلاً.  باستخدام وحدة معالجة الصور (PPU) ، يمكن للنظام إنشاء رسومات رائعة للغاية لتلك الأوقات ، والتي تبدو حتى اليوم جيدة جدًا في السياق الصحيح.  كان الجانب الأكثر أهمية هو كفاءة الذاكرة - عند إنشاء الرسومات ، كان علينا إدارتها بأقل عدد ممكن من البايتات.  ومع ذلك ، إلى جانب هذا ، زود NES المطورين بميزات قوية وسهلة الاستخدام والتي سمحت له بالوقوف من لوحات المفاتيح المنزلية القديمة.  بعد فهم مبادئ إنشاء رسومات NES ، يمكنك الشعور بالكمال التقني للنظام وإدراك مدى سهولة مطوري الألعاب الحديثة في العمل. <br><br>  تم تجميع رسومات الخلفية NES من أربعة مكونات منفصلة ، والتي شكلت مجموعة من الصورة التي نراها على الشاشة.  كان كل مكون مسؤولاً عن جانب منفصل ؛  اللون ، التصميم ، رسومات البكسل الخام ، إلخ.  قد يبدو هذا النظام معقدًا ومرهقًا بشكل لا لزوم له ، ولكنه في النهاية استخدم الذاكرة بكفاءة أكبر بكثير وسمح بإنشاء تأثيرات بسيطة في مقدار صغير من التعليمات البرمجية.  إذا كنت ترغب في فهم رسومات NES ، فستكون هذه المكونات الأربعة هي المعلومات الأساسية. <br><br>  تفترض هذه المقالة أنك على دراية برياضيات الكمبيوتر ، وبصفة خاصة حقيقة أن 8 بتات = 1 بايت و 8 بتات يمكن أن تمثل 256 قيمة.  من الضروري فهم كيفية عمل التدوين السداسي عشري.  لكن حتى بدون هذه المعرفة التقنية ، قد تبدو المقالة مثيرة للاهتمام. <br><a name="habracut"></a><br><h1 style=";text-align:right;direction:rtl">  مراجعة قصيرة </h1><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/ca1/6f8/9a7/ca16f89a75e658d68c28f81e9794ff86.png" width="512" height="480"></div><br>  أعلاه صورة من المشهد الأول لـ Castlevania (1986): البوابة المؤدية إلى القلعة ، حيث ستقام اللعبة.  هذه الصورة بحجم 256 × 240 بكسل وتستخدم 10 ألوان مختلفة.  لوصف هذه الصورة في الذاكرة ، يجب علينا الاستفادة من لوحة الألوان المحدودة ، وتوفير مساحة عن طريق تخزين قدر ضئيل فقط من المعلومات.  تتمثل إحدى الطرق الساذجة في استخدام لوحة مفهرسة يكون لكل بكسل فيها وحدة تخزين من 4 بتات ، أي يتم وضع بكسلين في بايت.  سيتطلب ذلك 256 * 240/2 = 30720 بايت ، ولكن كما سنرى قريبًا ، تستطيع NES التعامل مع هذه المهمة بكفاءة أكبر. <br><br>  المفاهيم الرئيسية في موضوع الرسومات NES هي البلاط والكتل [1].  تبلغ مساحة البلاطة 8 × 8 بكسل ، والكتلة تبلغ 16 × 16 بكسل ، ويتم ربط كل منها بشبكة بنفس حجم الخلية.  بعد إضافة هذه الشبكات ، يمكننا أن نرى هيكل الرسومات.  هنا هو مدخل القلعة مع شبكة في التكبير المزدوج. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/uz/de/sk/uzdeskry1wkruscxe8xsyephbnc.png"></div><br>  في هذه الشبكة ، تظهر الكتل باللون الأخضر الفاتح ، والبلاط باللون الأخضر الداكن.  تحتوي المساطر على المحاور على قيم ست عشرية يمكن إضافتها للعثور على موضع ؛  على سبيل المثال ، يبلغ القلب في شريط الحالة 15 دولارًا + 60 دولارًا = 75 دولارًا ، والذي يتكون من رقم عشري 117. تحتوي كل شاشة على 16 × 15 كتل (240) و 32 × 30 بلاطة (960).  الآن دعونا نرى كيف يتم وصف هذه الصورة والبدء في الرسومات بكسل الخام. <br><br><h1 style=";text-align:right;direction:rtl">  لجنة حقوق الإنسان </h1><br>  تصف بنية CHR رسومات البكسل "الخام" بدون لونها وموضعها ، ويتم تعيينها في بلاطات.  تحتوي صفحة الذاكرة بالكامل على 256 وحدة تجميعة CHR ، ولكل مربع عمق 2 بت.  هنا هي الرسومات القلب: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/ad9/d14/fb3/ad9d14fb3cc4321c5ae65e1e7f61dd52.png" width="128" height="128"></div><br>  وإليك كيفية وصفها في CHR [2]: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/162/974/e0f/162974e0fe800447c8edecf9157d1763.png" alt="بكسل قلب مركز حقوق الإنسان" width="128" height="128"></div><br>  يأخذ هذا الوصف 2 بت لكل بكسل ، أي بحجم 8 × 8 ، يتضح 8 * 8 * 2 = 128 بت = 16 بايت.  ثم تأخذ الصفحة بأكملها 16 * 256 = 4096 بايت.  هنا جميع حقوق الإنسان المستخدمة في الصورة من Castlevania. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/5da/3ef/83d/5da3ef83d0e339ca2d91d799745157e9.png" width="271" height="101"></div><br>  تذكر أن ملء الصورة يتطلب 960 تجانبًا ، لكن CHR تسمح فقط 256. وهذا يعني أن معظم المربعات تتكرر ، في المتوسط ​​، 3.75 مرة ، ولكن في كثير من الأحيان يتم استخدام عدد صغير منها فقط (على سبيل المثال ، خلفية فارغة ، تجانب أحادي اللون أو تكرار الأنماط).  تستخدم الصورة من Castlevania العديد من البلاط الفارغ ، وكذلك اللون الأزرق الصلب.  لنرى كيف يتم تعيين البلاط ، ونحن نستخدم nametables. <br><br><h1 style=";text-align:right;direction:rtl">  NAMETABLE </h1><br>  يعين جدول الاسم ملف CHR لكل موضع على الشاشة ، ويبلغ إجماليه 960. يتم تحديد كل موضع في بايت واحد ، أي أن جدول الاسم بأكمله يستغرق ما يصل إلى 960 بايت.  يتم تعيين البلاط بالترتيب من اليسار إلى اليمين ، من أعلى إلى أسفل ، وتتوافق مع الموضع المحسوب الموجود عن طريق إضافة القيم من المساطر الموضحة أعلاه.  أي أن الموضع في الزاوية اليسرى العليا هو 0 دولار ، وعلى يمينه 1 دولار ، وأدناه 20 دولار. <br><br>  تعتمد القيم في nametable على الترتيب الذي يتم به تعبئة CHR.  إليك أحد الخيارات [3]: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/h_/vs/qc/h_vsqc5mxdu8ydb1o8cu4mflf9e.png"></div><br>  <i>في هذه الحالة ، تبلغ قيمة القلب (في الموضع 75 دولارًا) 13 دولارًا.</i> <br><br>  بعد ذلك ، لإضافة لون ، نحن بحاجة إلى تحديد لوحة. <br><br><h1 style=";text-align:right;direction:rtl">  لوحة </h1><br>  يحتوي NES على لوحة نظام من 64 لونًا [4] ، ومنه نختار اللوحات التي سيتم استخدامها في العرض.  تحتوي كل لوحة على 3 ألوان فريدة بالإضافة إلى لون الخلفية الكلي.  تحتوي الصورة على 4 لوحات بحد أقصى ، والتي تشغل 16 بايتًا في المجموع.  فيما يلي اللوحات الخاصة بالصورة من Castlevania: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/f03/59a/259/f0359a259c032b5f6c9048c0231ffb85.png" alt="عبة Castlevania بال" width="168" height="24"></div><br>  لا يمكن استخدام اللوحات بشكل تعسفي.  يتم تطبيق لوحة واحدة فقط لكل كتلة.  وبسبب هذه الحاجة إلى فصل كل مساحة 16 × 16 وفقًا للوحة الألوان الخاصة باللعبة التي تتمتع بـ NES لديها مثل هذا الشكل "البلوك".  يمكن تجنب الرسومات المنفذة ببراعة ، على سبيل المثال ، من شاشة البداية في Castlevania ، عن طريق مزج الألوان عند حواف الكتل ، والتي تخفي وجود الشبكة. <br><br>  يتم تنفيذ اختيار لوحة لكل كتلة باستخدام آخر مكون - السمات. <br><br><h1 style=";text-align:right;direction:rtl">  سمات </h1><br>  تشغل السمات 2 بت لكل كتلة.  أنها تحدد أي من لوحات 4 للاستخدام.  تعرض هذه الصورة أي اللوحات المعرفة بواسطة السمات تستخدم كتل مختلفة [5]: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/k4/kj/3i/k4kj3imqlxxbwnasjcz3t60abym.png"></div><br>  كما ترون ، يتم تقسيم اللوحات إلى أقسام ، ولكن هذا أمر صعب بسبب استخدام نفس الألوان في مناطق مختلفة.  الأحمر في منتصف البوابة يندمج مع الجدران المحيطة به ، وخلفية سوداء تطمس الخط الفاصل بين القلعة <br>  والبوابات. <br><br>  مع 2 بت لكل كتلة أو 4 كتل لكل بايت ، تشغل سمات الصورة فقط 240/4 = 60 بايت ، ولكن نظرًا لطريقة تشفيرها ، يتم إهدار 4 بايت أخرى ، أي في إجمالي 64 بايت.  هذا يعني أن الصورة بأكملها ، بما في ذلك CHR و nametable واللوحات والسمات ، تشغل 4096 + 960 + 16 + 64 = 5136 بايت - أفضل بكثير من 30720 المذكور أعلاه. <br><br><h1 style=";text-align:right;direction:rtl">  MAKECHR </h1><br>  يعد إنشاء هذه المكونات الأربعة لرسومات NES أصعب من استخدام واجهات برمجة التطبيقات النقطية العادية ، ولكن الأدوات تنقذ.  ربما كان لدى مطوري NES نوع من الأدوات ، لكن مهما كانت ، فإن القصة لم تحفظها.  اليوم ، عادةً ما يكتب المطورون برامج لتحويل الرسومات إلى تنسيق NES المطلوب. <br><br>  تم إنشاء جميع الصور في هذا <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">المنشور</a> باستخدام <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">makechr</a> ، وهي أداة معاد كتابتها تستخدمها <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Star Versus</a> .  هذه أداة لسطر الأوامر مصممة للبنيات الآلية وتهدف إلى السرعة ورسائل خطأ الجودة وسهولة الحمل والشمولية.  كما أنه يخلق تصورات مثيرة للاهتمام مثل تلك المستخدمة في المنشور. <br><br><h1 style=";text-align:right;direction:rtl">  المواد المرجعية </h1><br>  في الغالب المعرفة حول البرمجة لـ NES ، وخاصة حول إنشاء الرسومات ، لقد حصلت على من المصادر التالية: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Nintendo Age Nerdy Nights</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">NesDev ويكي</a> </li></ul><br><h1 style=";text-align:right;direction:rtl">  الملاحظات </h1><br>  [1] المصطلحات - في بعض الوثائق ، تسمى الكتل "بلاطات التلوي" ، والتي تبدو شخصياً أقل فائدة بالنسبة لي. <br><br>  [2] تشفير CHR - لا يتم تخزين 2 بت لكل بكسل بجانب بعضها البعض.  يتم حفظ الصورة الكاملة أولاً مع البتات المنخفضة فقط ، ثم يتم حفظها مرة أخرى فقط مع البتات العالية. <br><br>  وهذا هو ، سيتم تخزين القلب مثل هذا: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cc5/68c/f95/cc568cf959b148d1d11a408876806ae8.png" alt="بكسل القلب منخفضة" width="128" height="128"><img src="https://habrastorage.org/getpro/habr/post_images/f87/947/070/f879470703605322e98a2582241b071e.png" alt="بكسل القلب عالية" width="128" height="128"><br><br>  كل سطر هو بايت واحد.  وهذا هو ، 01100110 هو 66 دولار ، 01111111 هو 7f دولار.  في المجموع ، تبدو بايتات القلب كما يلي: <br><br>  $ 66 $ 7f $ ff $ ff $ ff $ 7e $ 3c $ 18 $ 66 $ 5f $ bf $ bf $ ff $ 7e $ 3c $ 18 <br><br>  [3] Nametable - في هذا المخطط في اللعبة ، يتم استخدام جدول الاسم بشكل مختلف.  عادة ، يتم حفظ الحروف الأبجدية في الذاكرة في الحي ، بما في ذلك Castlevania. <br><br>  [4] لا يستخدم نظام الألوان - NES لوحة ألوان RGB ، والألوان الفعلية التي يتم تقديمها تعتمد على جهاز تلفزيون معين.  عادةً ما تستخدم برامج محاكاة الألوان لوحات RGB مختلفة تمامًا.  الألوان في هذه المقالة تتوافق مع لوحة مكتوبة في makechr. <br><br>  [5] سمة ترميز - يتم تخزين السمات في ترتيب غريب.  لا ينتقلون من اليسار إلى اليمين ، من أعلى إلى أسفل - يتم تشفير منطقة الكتلة 2 × 2 مع بايت واحد ، في شكل الحرف Z. ولهذا السبب تُهدر 4 بايت ؛  خلاصة القول هي 8 بايت كامل. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/71a/951/0db/71a9510db28128bca1841689ce909c27.png" alt="PAL-كتلة مجموعة" width="64" height="64"></div><br>  على سبيل المثال ، يتم تخزين كتلة بقيمة 308 دولارات بـ 30 دولارًا و 348 دولارًا و 34 دولارًا أمريكيًا.  قيم لوح الألوان هي 1 و 2 و 3 و 3 ، ويتم تخزينها بالترتيب من أدنى موضع إلى أعلى موضع ، أو 11 :: 11 :: 10 :: 01 = 11111001. لذلك ، فإن قيمة البايت لهذه السمات هي f9 دولار. <br><br><h2 style=";text-align:right;direction:rtl">  الجزء 2 </h2><br>  في الجزء الأول ، تحدثنا عن مكونات رسومات الخلفية NES - CHR ، nametable ، اللوحات والسمات.  ولكن هذا ليس سوى نصف القصة. <br><br>  بادئ ذي بدء ، هناك بالفعل جدولان للاسم [6].  كل واحد منهم لديه سماته الخاصة لإعداد اللون ، ولكن لديهم نفس CHR.  تحدد معدات الخرطوشة موقعها: إما بجانب بعضها البعض ، أو واحد فوق الآخر.  فيما يلي أمثلة لنوعين مختلفين من المواقع - Lode Runner (1984) و Bubble Bobble (1988). <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/759/7ef/7c9/7597ef7c97f3e31ed3bb4198727dee37.png" width="512" height="500"></div><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/0e7/035/72a/0e703572ad771478c13bffa254a86579.png" alt="التمرير فقاعة مزركشة،" width="532" height="480"></div><br><h1 style=";text-align:right;direction:rtl">  التمرير </h1><br>  للاستفادة من وجود جدولين للاسماء ، تدعم PPU القدرة على التمرير بالبكسل في وقت واحد على طول محوري X و Y. يتم التحكم به بواسطة سجل به ذاكرة في 2005 دولار: كتابة وحدتي بايت فقط في هذا العنوان ينقل الشاشة بأكملها إلى العدد المطلوب من البكسلات [7] .  في وقت إصدار NES ، كانت هذه الميزة الرئيسية على غيرها من لوحات المفاتيح المنزلية ، والتي كان عليها في كثير من الأحيان للتمرير إعادة كتابة ذاكرة الفيديو بالكامل.  أدى مثل هذا المخطط سهل الاستخدام إلى ظهور عدد كبير من منصات اللعب والرماة ، وأصبح السبب الرئيسي لهذا النجاح الكبير للنظام. <br><br>  بالنسبة للعبة بسيطة ، حيث يبلغ عرض الشاشة شاشتين فقط ، على سبيل المثال ، Load Runner ، كان يكفي فقط ملء جدولي الأسماء وتغيير التمرير وفقًا لذلك.  ولكن في معظم ألعاب التمرير ، كان للمستويات عرض تعسفي.  لتنفيذها ، يجب أن تقوم اللعبة بتحديث الجزء الذي يظهر على الشاشة من جداول الأسماء قبل ظهورها على الشاشة.  يتم حل قيمة التمرير ، ولكن بما أن جدول الأسماء يتم تحديثه باستمرار ، فإن هذا يخلق وهمًا بالحجم اللانهائي. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/829/936/ab4/829936ab4b2855cd7f824ebd01941bb3.gif" width="512" height="500"></div><br><h1 style=";text-align:right;direction:rtl">  العفاريت </h1><br>  بالإضافة إلى التمرير خلال جداول الأسماء ، كان لدى NES أيضًا جانب مختلف تمامًا من الرسومات: العفاريت.  على عكس جداول الأسماء التي تحتاج إلى محاذاة في الشبكات ، يمكن وضع العفاريت بشكل تعسفي ، بحيث يمكن استخدامها لعرض شخصيات اللاعب والعقبات والمقذوفات وأي كائنات بحركة معقدة.  على سبيل المثال ، في المشهد أعلاه من Mega Man (1987) لعرض شخصية اللاعب.  يتم استخدام نقاط وشرائط الطاقة العفاريت ، والتي تتيح لهم الخروج من شبكة جداول الأسماء عند التمرير على الشاشة. <br><br>  Sprites لها صفحة CHR خاصة بها [8] ومجموعة من 4 لوحات.  بالإضافة إلى ذلك ، يشغلونها صفحة ذاكرة 256 بايت.  الذي يسرد موضع ومظهر كل العفريت (كما اتضح ، ذاكرة الفيديو NES أكبر مرتين ونصف من المذكورة في الجزء الأول من المقالة).  تنسيق هذه السجلات غير معتاد إلى حد ما - فهي تحتوي أولاً على موضع في Y ، ثم رقم تجانب ، ثم سمة ، ثم موضع في X [9].  نظرًا لأن كل سجل يستغرق 4 بايت ، هناك قيود صارمة: على الشاشة لا يمكن أن يكون هناك أكثر من 256/4 = 64 نقش في وقت واحد. <br><br>  تحدد البايتتان Y و X البيكسل العلوي الأيسر للعفريت المرسومة.  لذلك ، على الجانب الأيمن من الشاشة ، يمكن اقتصاص العفريت ، ولكن على الجانب الأيسر يترك مساحة فارغة.  تشبه بايت التجانب القيمة في جدول الاسم ، فقط لهذه التجانبات تستخدم العفاريت CHR الخاصة بها.  بايت السمة عبارة عن حزمة من البتات التي تنفذ ثلاث مهام: يتم تخصيص بتتين للوحة ، ويتم استخدام بتتين لعكس العفريت أفقياً أو رأسياً ، ويحدد بت واحد ما إذا كان سيتم عرض العفريت تحت جداول الأسماء [10]. <br><br><h1 style=";text-align:right;direction:rtl">  قيود </h1><br>  تسمح الأنظمة الحديثة بالعمل مع العفاريت من أي حجم تعسفي ، ولكن على NES ، كان يجب أن يكون حجم العفريت بسبب قيود CHR 8 × 8 [11].  تتكون الكائنات الأكبر حجمًا من عدة نقوش ، ويجب أن يتأكد البرنامج من أن جميع الأجزاء الفردية يتم تقديمها بجوار بعضها البعض.  على سبيل المثال ، يمكن أن يصل حجم حرف Megaman إلى 10 أشكال ، مما يسمح لك أيضًا باستخدام المزيد من الألوان ، خاصة لعينيه البيضاء ولون البشرة. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/dd8/fea/3dc/dd8fea3dc4880761b52885c8ff83acdd.png"></div><br>  القيد الرئيسي المرتبط باستخدام العفاريت هو أنه لا ينبغي أن يكون هناك أكثر من 8 عفاريت لكل خط نقطي.  إذا ظهرت أكثر من 8 رموز متحركة في أي خط أفقي من الشاشة ، فلن يتم عرض تلك التي ظهرت لاحقًا.  هذا هو سبب الخفقان في الألعاب مع الكثير من العفاريت.  يقوم البرنامج بتبديل عناوين العفاريت في الذاكرة بحيث يتم عرض كل منها على الأقل في بعض الأحيان. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/5f0/b67/13c/5f0b6713c1be1837d0da2d8213253932.gif" alt="المتعري وميض" width="332" height="128"></div><br>  أخيرًا ، لا يؤثر التمرير على العفاريت: يتم تحديد موضع العفريت على الشاشة حسب قيمتي Y و X ، بغض النظر عن موضع التمرير.  في بعض الأحيان تكون هذه علامة زائد ، على سبيل المثال ، عندما يتحرك المستوى بالنسبة للاعب أو تظل الواجهة في وضع ثابت.  ومع ذلك ، في حالات أخرى ، هذا ناقص - تحتاج إلى تحريك الكائن المتحرك ، ثم قم بتغيير موضعه بمقدار التغيير في التمرير. <br><br><h1 style=";text-align:right;direction:rtl">  الملاحظات </h1><br>  [6] من الناحية النظرية ، هناك في الواقع أربعة جداول أسماء ، لكنها معكوسة بطريقة تحتوي فقط 2 منها على رسومات فريدة.  عند وضعها جنبًا إلى جنب ، يُسمى ذلك النسخ المتطابق الرأسي ، وعندما توجد جداول الأسماء واحدة فوق الأخرى ، النسخ المتطابق الأفقي. <br><br>  [7] يوجد أيضًا سجل يحدد جدول الأسماء الذي سيبدأ التقديم به ، أي أن التمرير هو في الواقع قيمة 10 بت أو 9 بت ، مع مراعاة النسخ المتطابق. <br><br>  [8] ليس هذا هو الحال دائمًا.  يمكن تكوين PPU لاستخدام نفس الصفحة CHR لجداول الأسماء كما هو الحال مع العفاريت. <br><br>  [9] ربما تم استخدام هذا الترتيب لأنه يتوافق مع البيانات التي تحتاجها وحدة معالجة البرامج لمعالجة التقديم الفعال. <br><br>  [10] تُستخدم هذه القطعة في تأثيرات مختلفة ، على سبيل المثال ، لتحريك Mario أسفل الكتل البيضاء في Super Mario Bros 3 ، أو لتكوين ضباب فوق العفاريت في Castlevania 3. <br><br>  [11] تحتوي PPU أيضًا على خيار تمكين 8 × 16 sprites ، والذي يستخدم في ألعاب مثل Contra ، حيث توجد شخصيات طويلة.  ومع ذلك ، يتم تطبيق جميع القيود الأخرى. <br><br><h2 style=";text-align:right;direction:rtl">  الجزء 3 </h2><br>  في الأجزاء السابقة ، تحدثنا عن بيانات CHR والخلفيات استنادًا إلى جداول الأسماء والعفاريت والتمرير.  وهذا عمليا هو كل ما تستطيع خرطوشة NES البسيطة القيام به بدون أجهزة إضافية.  ولكن للمضي قدماً ، نحتاج إلى شرح كيفية عمل العرض بالتفصيل. <br><br><h1 style=";text-align:right;direction:rtl">  أداء </h1><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/12b/0d4/0ad/12b0d40ad74d27ce6d8ff2499c6df163.gif" width="200" height="200"></div><br>  <i>النقطية تقديم مع وقفة ل vblank</i> <br><br>  مثل أجهزة الكمبيوتر القديمة الأخرى ، تم تصميم NES للعمل مع أجهزة تلفزيون CRT.  يرسمون خطوط المسح على الشاشة ، واحدة في كل مرة ، من اليسار إلى اليمين ، من أعلى إلى أسفل ، باستخدام بندقية الإلكترون الذي ينتقل فعليا إلى نقطة على الشاشة حيث يتم رسم هذه الخطوط.  بعد الوصول إلى الزاوية السفلية ، تحدد فترة زمنية تسمى "الفراغ العمودي" (أو vblank): يعود مسدس الإلكترون إلى الزاوية اليسرى العليا للتحضير لرسم الإطار التالي.  داخل NES ، تقوم وحدة معالجة الصورة (PPU) بمعالجة عرض البيانات النقطية تلقائيًا ، في كل إطار ، ويقوم الكود الذي يعمل في وحدة المعالجة المركزية بجميع المهام التي يجب أن تؤديها اللعبة.  يسمح Vblank للبرنامج باستبدال البيانات الموجودة في ذاكرة PPU ، وإلا فسيتم استخدام هذه البيانات للتقديم.  في معظم الأحيان ، يتم إجراء تغييرات على جدول الأسماء ولوحات PPU أثناء هذه النافذة الصغيرة. <br><br>  ومع ذلك ، يمكن إجراء بعض التغييرات في حالة PPU أثناء تقديم الشاشة.  يطلق عليهم "الآثار النقطية".  الإجراء الأكثر شيوعًا الذي يتم تنفيذه أثناء عرض الشاشة هو تعيين موضع التمرير.  بفضل هذا ، يظل جزء من الصورة ثابتًا (على سبيل المثال ، واجهة اللعبة) ، ويستمر التمرير في كل شيء آخر.  لتحقيق هذا التأثير ، من الضروري تحديد وقت تغيير قيمة التمرير بدقة حتى يتم ذلك على الخط النقطي المطلوب.  هناك العديد من التقنيات لتطبيق هذا النوع من المزامنة بين رمز اللعبة و PPU. <br><br><h1 style=";text-align:right;direction:rtl">  تقسيم الشاشة </h1><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/36e/4bf/c1e/36e4bfc1e8e92ae1dbfb83225946dc0f.png" width="512" height="480"></div><br>  <i>التمرير المستوى ، والواجهة في الجزء العلوي من الشاشة لا تزال ثابتة</i> <br><br>  أولاً ، تحتوي وحدة PPU على أجهزة مضمنة تقوم بمعالجة sprite في موضع الذاكرة الصفرية بطريقة خاصة.  عند تقديم هذا العفريت ، إذا تداخل أحد وحدات البكسل الخاصة به مع الجزء المرئي من الخلفية ، يتم تعيين بت يسمى "إشارة sprite0".  يمكن لرمز اللعبة أولاً وضع هذا العفريت حيث يجب أن يحدث انقسام الشاشة ، ثم الانتظار في حلقة ، والتحقق من قيمة علامة sprite0.  لذلك ، عند الخروج من الحلقة ، ستعرف اللعبة بالتأكيد الخط النقطي الذي يتم تقديمه حاليًا.  تُستخدم هذه التقنية لتنفيذ مشاركة الشاشة البسيطة في العديد من ألعاب NES ، بما في ذلك Ninja Gaiden (1989) ، الموضح أعلاه [12] <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/66b/acd/f19/66bacdf196bab83b91ea70c2657dd497.png" alt="النينجا هود" width="256" height="240"></div><br>  <i>يقع Sprite0 عند Y $ 26 ، X $ a0.</i>  <i>عند تقديم صف البكسل السفلي ، يتم تعيين علامة sprite0</i> <br><br>  في بعض الألعاب ، يتم دمج إشارة sprite0 مع تقنية أخرى - حلقة ذات توقيت يمكن التنبؤ به ("دورة ذات توقيت يمكن التنبؤ به"): ينتظر البرنامج حتى يتم تقديم بضعة خطوط إضافية لتقسيم الشاشة إلى أجزاء أكثر.  على سبيل المثال ، يتم استخدام هذه التقنية في العديد من شاشات توقف Ninja Gaiden لإنشاء تأثيرات جذرية ، على سبيل المثال ، حقل يحركه الرياح أو صورة لقلعة في البعد.    ,       ,    ,   sprite0    ,      timed loops. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/cf9/19a/bfd/cf919abfdd1c0d786440e0af2c99bb24.gif" alt="ninjas-in-field" width="512" height="480"></div><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/f77/fab/d51/f77fabd51c4431db2c98ee1bf64e0eb2.gif" alt="قلعة عرض" width="512" height="480"></div><br>             ,    ,      .          ( ,         (memory mapping)),          [13],       .             ,     .      NES,      ,    . <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/618/9c3/f4f/6189c3f4fa79e5c31b80b2c14df75dcb.gif" alt="على مستوى القطار" width="512" height="480"></div><br>    Ninja Gaiden 2,           ,      ,     . ,         ;            .   ,           . <br><br><h1 style=";text-align:right;direction:rtl">   </h1><br>       ,        .  ,       ,      [14].        (        ),     CHR,      ,       .      ,       .                 .    Ninja Gaiden             ,     ,           CHR. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/69f/896/804/69f8968042bded347183e35af32c16ae.gif" alt="goofall-BG" width="512" height="480"></div><br> <i> ,     </i> <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/290/882/f90/290882f90bb731af9e98f7ee65b4e64f.png" alt="goofall-الشمالي" width="512" height="480"></div><br> <i>  ,        </i> <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/cf7/077/b23/cf7077b23ea5242b4f27d308b7514077.png" width="512" height="480"></div><br> <i>      CHR.     ,     </i> <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/7a2/335/28e/7a233528e53b01341d21112b3651310e.png" alt="الذين، هي، أنها القاع البنوك" width="512" height="480"></div><br> <i>      CHR.       </i> <br><br>        ,   (   ) .      ,     ,              .        ,      .               ,      [15].      ,           CHR. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/501/6b4/281/5016b4281a88523177dffef3f8de4250.gif" alt="المعادن عاصفة-BG" width="512" height="464"></div><br> <i>Metal Storm (1991 )      </i> <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/c05/7d4/6cb/c057d46cbf7f4d2cfb3e401d1658692f.png" alt="المعادن عاصفة الإقليم الشمالي" width="512" height="464"></div><br> <i>      </i> <br><br> CHR    —    ,     .       ,           ;       .  ,  CHR   ,     ,    . ,       ,        ,      . <br><br><h1 style=";text-align:right;direction:rtl">   </h1><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/9ad/f22/f28/9adf22f2804a300f6f3e9a98fe15c13b.gif" alt="نائب النار" width="512" height="480"></div><br> <i> Vice: Project Doom (1991 )    ,        .       ,     .</i> <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/253/25b/9b9/25325b9b935359508dc420aa35ef1748.gif" alt="السيف رئيسية" width="512" height="480"></div><br> <i>Sword Master (1990 )        ,            .</i> <br><br><h1 style=";text-align:right;direction:rtl">  شكر </h1><br>              ,   FCEUX.  ,      sprite0    NesDev: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">FCEUX</a> </li><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">NesDev wiki</a> </li></ul><br><h1 style=";text-align:right;direction:rtl">  الملاحظات </h1><br> [12]   ,   Ninja Gaiden  .     8×16 sprites —  ,  PPU,       .   sprite0  ,  sprite1      .    z-  ,      ,   . <br><br> [13]    .          .      PPU  , ,     .          (IRQ),      ,  ,        . <br><br> [14]      ,         ,    .   ,    , -      4   8 . <br><br> [15]     CHR        :      ,      .        , ,  1   ,     . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar470614/">https://habr.com/ru/post/ar470614/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar470602/index.html">كيف سيكون شكل مترو موسكو في عالم ثلاثي الأبعاد</a></li>
<li><a href="../ar470604/index.html">سرعة تحميل المواقع في التجارة الإلكترونية: تحليل 48 متجرا على الإنترنت في روسيا</a></li>
<li><a href="../ar470608/index.html">الوحدة UI الأمثل</a></li>
<li><a href="../ar470610/index.html">يوم واحد في حياة المطور</a></li>
<li><a href="../ar470612/index.html">ما يظهر الفولتميتر ، أو مآخذ الرياضيات</a></li>
<li><a href="../ar470616/index.html">حل جديد لمفارقة فيرمي (لماذا نحن وحدنا في الكون)</a></li>
<li><a href="../ar470618/index.html">النمذجة المواضيعية للأخبار باستخدام تحليل العوامل</a></li>
<li><a href="../ar470620/index.html">البنية التحتية كرمز: كيفية التغلب على مشاكل XP</a></li>
<li><a href="../ar470622/index.html">نظرة عامة على طرق اختيار الميزة</a></li>
<li><a href="../ar470628/index.html">سفينة الفضاء محاكاة بناء السفن</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>