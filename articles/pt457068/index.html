<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏽‍💻 🖊️ 👨🏿‍⚕️ Filas - o que é, por que e como usá-lo? Veja os recursos do AWS SQS 👃🏼 👩🏿‍🤝‍👨🏽 🚁</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Primeiro, vamos definir o conceito de "fila". 
 Leve em consideração o tipo de fila “FIFO” (primeiro a entrar , primeiro a sair). Se você pegar o valo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Filas - o que é, por que e como usá-lo? Veja os recursos do AWS SQS</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/457068/"><img src="https://habrastorage.org/webt/zw/yz/pq/zwyzpqk1p65bfsq6xzvqab7rt60.png"><br><h3>  <b>Primeiro, vamos definir o conceito de "fila".</b> </h3><br>  Leve em consideração o tipo de fila <b>“FIFO”</b> (primeiro a <b>entrar</b> , primeiro a sair).  Se você pegar o valor da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Wikipedia</a> - "esse é um tipo de dados abstrato com a disciplina de acesso a elementos".  Em resumo, isso significa que não podemos obter dados dele em uma ordem aleatória, mas apenas coletamos o que veio primeiro. <br><br><h3>  Em seguida, você precisa decidir por que eles são necessários? </h3><br>  <b>1. Para operações diferidas.</b>  Um exemplo clássico é o processamento de imagens.  Por exemplo, um usuário carregou uma imagem no site que precisamos processar, essa operação leva muito tempo, o usuário não quer esperar tanto.  Portanto, carregamos a imagem e depois a transferimos para a fila.  E será processado quando qualquer "trabalhador" conseguir. <br><br>  <b>2. Para lidar com cargas de pico.</b>  Por exemplo, há uma parte do sistema que às vezes causa muito tráfego e não requer uma resposta instantânea.  Como opção, gerando quaisquer relatórios.  Jogando esta tarefa na fila - damos a oportunidade de lidar com ela com uma carga uniforme no sistema. <br><br>  <b>3. Escalabilidade.</b>  E provavelmente o motivo mais importante, a fila torna possível <br>  ampliar.  Isso significa que você pode exibir vários serviços para processamento em paralelo, o que aumentará bastante a produtividade. <br><a name="habracut"></a><br><h3>  Agora, vamos examinar os problemas que enfrentaremos se criarmos a fila: </h3><br>  <b>1. Acesso paralelo.</b>  Somente um manipulador pode receber uma mensagem de uma fila.  Ou seja, se ao mesmo tempo dois serviços solicitarem mensagens, cada um deles deverá retornar um conjunto exclusivo de mensagens.  Caso contrário, verifica-se que uma mensagem é processada duas vezes.  O que poderia ser complicado. <br><br>  <b>2. O mecanismo da desduplicação.</b>  O serviço deve ter um sistema que proteja a fila de duplicatas.  Pode haver uma situação em que o mesmo conjunto de dados seja enviado à fila por acaso duas vezes.  Como resultado, processaremos a mesma coisa duas vezes.  O que novamente é preocupante. <br><br>  <b>3. Mecanismo de tratamento de erros.</b>  Digamos que nosso serviço tenha recebido três mensagens da fila.  Dois dos quais ele processou com êxito enviando solicitações de remoção da fila.  E o terceiro ele não conseguiu processar e morreu.  Uma mensagem que está no status de processamento não está disponível para outros serviços.  E não deve permanecer para sempre no status de processamento.  Essa mensagem deve ser passada para outro manipulador por alguma lógica.  Um exemplo da implementação dessa lógica será considerado em breve usando o AWS SQS (Simple Queue Service) como exemplo. <br><br><h3>  Amazon Web Services - Serviço de fila simples </h3><br><h4>  Agora vamos ver como o SQS resolve esses problemas e o que ele pode fazer. </h4><br>  <b>1. Acesso paralelo.</b>  Na fila, você pode definir o parâmetro de <b>tempo limite</b> da <b>visibilidade</b> .  Determina quanto tempo o processamento de uma mensagem pode levar o maior tempo possível.  Por padrão, são <b>30 segundos.</b>  Quando um serviço recebe uma mensagem, ele é transferido para o status <b>"Em Vôo"</b> por 30 segundos.  Se durante esse período não houver um comando para remover esta mensagem da fila, ela retornará ao início e o próximo serviço poderá recebê-la novamente para processamento. <br><br>  <b>Trabalho shemka pequeno.</b> <br><br><img src="https://habrastorage.org/webt/zx/wj/pd/zxwjpdw6hdsdw8qoinabmifuyzo.png"><br><blockquote>  <b>Aviso:</b> Tenha cuidado.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Em alguns casos, o SQS pode enviar uma mensagem duplicada (item "Entrega pelo menos uma vez").</a>  Portanto, seu serviço deve ser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">idempotente</a> para processamento. </blockquote><br>  <b>2. Mecanismo de tratamento de erros.</b>  No SQS, você pode configurar a segunda volta para mensagens "inativas" (fila de devoluções).  Ou seja, aqueles que não puderam processar nosso serviço serão enviados para uma fila separada, que você poderá descartar a seu critério.  Você também pode definir após o qual o número de tentativas sem êxito que a mensagem entrará na fila "inoperante".  Uma tentativa com falha é a expiração do "Tempo limite da visibilidade".  Ou seja, se nenhuma solicitação de exclusão tiver sido enviada durante esse período, essa mensagem será considerada não processada e retornará à fila principal ou será direcionada para "morto". <br><br>  <b>3. Desduplicação de mensagens.</b>  O SQS também possui um sistema de proteção duplicado.  Cada mensagem tem um <b>"ID de redução de redundância"</b> , o SQS não enfileira uma mensagem com <br>  repetido "ID de redução de redundância" por 5 minutos.  Você deve especificar um "ID de redução de redundância" em cada mensagem ou ativar a geração de ID com base em conteúdo.  Isso significa que um hash gerado com base no seu conteúdo será inserido no "ID de redução de redundância".  O parâmetro <b>"Desduplicação com base em conteúdo".</b>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Mais sobre desduplicação</a> <br><blockquote>  <b>Aviso:</b> tenha cuidado se enviar duas mensagens idênticas dentro de 5 minutos e você tiver <b>“Desduplicação baseada em conteúdo” ativada.O</b> SQS não adicionará uma segunda mensagem à fila. <br></blockquote><blockquote>  <b>Aviso:</b> tenha cuidado, por exemplo, se não houver conexão no dispositivo e ele não receber uma resposta e enviar uma segunda solicitação após 5 minutos, será criada uma duplicata. <br></blockquote>  <b>4. Enquete longa.</b>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Pesquisa longa</a> .  O SQS suporta esse tipo de conexão com um tempo limite máximo de 20 segundos.  O que nos permite economizar tráfego e "empurrões" do serviço. <br><br>  <b>5. Métricas.</b>  A Amazon também fornece métricas detalhadas da fila.  Como o número de mensagens recebidas / enviadas / excluídas, o tamanho em KB dessas mensagens e assim por diante.  Você também pode conectar o SQS ao serviço de log do CloudWatch.  Lá você pode ver ainda mais.  Também é possível configurar os chamados <b>“alarmes”</b> e configurar ações para qualquer evento.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Saiba mais sobre a conexão com o SQS.</a>  E <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">documentação do CloudWatch</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><br></a> <br><h3>  Agora vamos ver as configurações da fila: </h3><br><h4>  Os principais: </h4><br>  <b>Tempo limite de visibilidade padrão - o</b> número de segundos / minutos / horas durante o qual a mensagem após o recebimento não ficará visível para o recebimento.  O tempo máximo de processamento é de 12 horas. <br><br>  <b>Período de retenção de mensagens - o</b> número de segundos / minutos / horas / dias, o que significa quanto tempo as mensagens não processadas serão armazenadas na fila.  Máximo - 14 dias. <br><br>  <b>Tamanho</b> máximo da mensagem - tamanho máximo da mensagem em KB.  O valor é de 1 KB a 256 KB. <br><br>  <b>Atraso na entrega -</b> você pode definir o tempo de atraso para entrega de uma mensagem na fila.  De 0 segundos a 15 minutos (de fato, as mensagens estarão na fila, mas não estarão visíveis para receber). <br><br>  <b>Tempo de espera para recebimento de mensagens -</b> tempo, quanto tempo a conexão permanecerá no caso de usarmos "Pesquisa longa" para receber novas mensagens. <br><br>  <b>Desduplicação com base em conteúdo - um</b> sinalizador, se definido como true, um "ID de redução de redundância" será adicionado a cada mensagem na forma de um hash SHA-256 gerado a partir do conteúdo. <br><br><h4>  Configurações da fila inoperante </h4><br>  <b>Use Redrive Policy - um</b> sinalizador, se definido, as mensagens serão redirecionadas após várias tentativas. <br><br>  <b>Fila de</b> mensagens não entregues <b>- o</b> nome da fila "inativa" para a qual as mensagens brutas serão enviadas. <br><br>  <b>Número Máximo de Recebimentos - o</b> número de tentativas malsucedidas de processamento, após as quais a mensagem será enviada para a fila "inoperante" <br><blockquote>  <b>Aviso: Observe</b> também que podemos enviar todos os parâmetros principais juntamente com cada mensagem separadamente.  Por exemplo, cada mensagem individual pode ter seu próprio tempo <b>limite de visibilidade</b> ou <b>atraso de entrega.</b> </blockquote><h3>  Agora, um pouco sobre as próprias mensagens e suas propriedades: </h3><br>  Uma mensagem possui vários parâmetros: <br><br>  <b>1. Corpo da mensagem -</b> qualquer texto <br>  <b>2. O ID do grupo de mensagens é</b> algo como uma tag, canal, necessário para todas as mensagens.  É garantido que cada um desses grupos seja processado no modo FIFO. <br>  <b>3. ID de redução</b> de redundância de <b>mensagens -</b> string para identificar duplicatas.  Se o modo "Desduplicação baseada em conteúdo" estiver definido, o parâmetro será opcional. <br><br><h4>  Também existem atributos de mensagem </h4><br>  Os atributos consistem em um nome, tipo e valor. <br><br>  <b>1. Nome -</b> sequência <br>  <b>2. Tipo -</b> existem vários tipos: sequência, número, binário.  O tipo vem simplesmente como uma string e é possível adicionar um postfix ao tipo.  Nesse caso, o tipo virá com esse postfix através do ponto, por exemplo, string.example_postfix <br>  <b>3. Valor -</b> sequência <br><blockquote>  <b>Aviso:</b> Observe que o número máximo de atributos é <b>10</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Detalhes</a> </blockquote>  PS: Este artigo fornece uma breve descrição da fila, bem como um pouco sobre os recursos e a mecânica do SQS.  O artigo a seguir será dedicado à <b>AWS Lambda</b> e, em seguida, ao compartilhamento prático. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt457068/">https://habr.com/ru/post/pt457068/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt457058/index.html">Convertendo resultados de impressão em cliques para Google e Yandex em 2019</a></li>
<li><a href="../pt457060/index.html">Três vídeos para gravadores do iOS</a></li>
<li><a href="../pt457062/index.html">Centro de Treinamento Cosmonauta em Star City</a></li>
<li><a href="../pt457064/index.html">Para a questão dos módulos</a></li>
<li><a href="../pt457066/index.html">Como modificar o robô FEDOR e a cadeira de vôo da ISS</a></li>
<li><a href="../pt457070/index.html">Textolite em vez de papelão. Algumas palavras sobre o emblema interativo OFFZONE 2019</a></li>
<li><a href="../pt457072/index.html">Como resolver um problema antigo usando o ML em Python e .Net</a></li>
<li><a href="../pt457074/index.html">A evolução dos desenvolvedores: quais jogos devemos esperar no futuro</a></li>
<li><a href="../pt457078/index.html">Como transformar seu avatar do Telegram em um relógio</a></li>
<li><a href="../pt457082/index.html">Concessão imperceptível de direitos de administrador</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>