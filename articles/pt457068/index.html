<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèΩ‚Äçüíª üñäÔ∏è üë®üèø‚Äç‚öïÔ∏è Filas - o que √©, por que e como us√°-lo? Veja os recursos do AWS SQS üëÉüèº üë©üèø‚Äçü§ù‚Äçüë®üèΩ üöÅ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Primeiro, vamos definir o conceito de "fila". 
 Leve em considera√ß√£o o tipo de fila ‚ÄúFIFO‚Äù (primeiro a entrar , primeiro a sair). Se voc√™ pegar o valo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Filas - o que √©, por que e como us√°-lo? Veja os recursos do AWS SQS</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/457068/"><img src="https://habrastorage.org/webt/zw/yz/pq/zwyzpqk1p65bfsq6xzvqab7rt60.png"><br><h3>  <b>Primeiro, vamos definir o conceito de "fila".</b> </h3><br>  Leve em considera√ß√£o o tipo de fila <b>‚ÄúFIFO‚Äù</b> (primeiro a <b>entrar</b> , primeiro a sair).  Se voc√™ pegar o valor da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Wikipedia</a> - "esse √© um tipo de dados abstrato com a disciplina de acesso a elementos".  Em resumo, isso significa que n√£o podemos obter dados dele em uma ordem aleat√≥ria, mas apenas coletamos o que veio primeiro. <br><br><h3>  Em seguida, voc√™ precisa decidir por que eles s√£o necess√°rios? </h3><br>  <b>1. Para opera√ß√µes diferidas.</b>  Um exemplo cl√°ssico √© o processamento de imagens.  Por exemplo, um usu√°rio carregou uma imagem no site que precisamos processar, essa opera√ß√£o leva muito tempo, o usu√°rio n√£o quer esperar tanto.  Portanto, carregamos a imagem e depois a transferimos para a fila.  E ser√° processado quando qualquer "trabalhador" conseguir. <br><br>  <b>2. Para lidar com cargas de pico.</b>  Por exemplo, h√° uma parte do sistema que √†s vezes causa muito tr√°fego e n√£o requer uma resposta instant√¢nea.  Como op√ß√£o, gerando quaisquer relat√≥rios.  Jogando esta tarefa na fila - damos a oportunidade de lidar com ela com uma carga uniforme no sistema. <br><br>  <b>3. Escalabilidade.</b>  E provavelmente o motivo mais importante, a fila torna poss√≠vel <br>  ampliar.  Isso significa que voc√™ pode exibir v√°rios servi√ßos para processamento em paralelo, o que aumentar√° bastante a produtividade. <br><a name="habracut"></a><br><h3>  Agora, vamos examinar os problemas que enfrentaremos se criarmos a fila: </h3><br>  <b>1. Acesso paralelo.</b>  Somente um manipulador pode receber uma mensagem de uma fila.  Ou seja, se ao mesmo tempo dois servi√ßos solicitarem mensagens, cada um deles dever√° retornar um conjunto exclusivo de mensagens.  Caso contr√°rio, verifica-se que uma mensagem √© processada duas vezes.  O que poderia ser complicado. <br><br>  <b>2. O mecanismo da desduplica√ß√£o.</b>  O servi√ßo deve ter um sistema que proteja a fila de duplicatas.  Pode haver uma situa√ß√£o em que o mesmo conjunto de dados seja enviado √† fila por acaso duas vezes.  Como resultado, processaremos a mesma coisa duas vezes.  O que novamente √© preocupante. <br><br>  <b>3. Mecanismo de tratamento de erros.</b>  Digamos que nosso servi√ßo tenha recebido tr√™s mensagens da fila.  Dois dos quais ele processou com √™xito enviando solicita√ß√µes de remo√ß√£o da fila.  E o terceiro ele n√£o conseguiu processar e morreu.  Uma mensagem que est√° no status de processamento n√£o est√° dispon√≠vel para outros servi√ßos.  E n√£o deve permanecer para sempre no status de processamento.  Essa mensagem deve ser passada para outro manipulador por alguma l√≥gica.  Um exemplo da implementa√ß√£o dessa l√≥gica ser√° considerado em breve usando o AWS SQS (Simple Queue Service) como exemplo. <br><br><h3>  Amazon Web Services - Servi√ßo de fila simples </h3><br><h4>  Agora vamos ver como o SQS resolve esses problemas e o que ele pode fazer. </h4><br>  <b>1. Acesso paralelo.</b>  Na fila, voc√™ pode definir o par√¢metro de <b>tempo limite</b> da <b>visibilidade</b> .  Determina quanto tempo o processamento de uma mensagem pode levar o maior tempo poss√≠vel.  Por padr√£o, s√£o <b>30 segundos.</b>  Quando um servi√ßo recebe uma mensagem, ele √© transferido para o status <b>"Em V√¥o"</b> por 30 segundos.  Se durante esse per√≠odo n√£o houver um comando para remover esta mensagem da fila, ela retornar√° ao in√≠cio e o pr√≥ximo servi√ßo poder√° receb√™-la novamente para processamento. <br><br>  <b>Trabalho shemka pequeno.</b> <br><br><img src="https://habrastorage.org/webt/zx/wj/pd/zxwjpdw6hdsdw8qoinabmifuyzo.png"><br><blockquote>  <b>Aviso:</b> Tenha cuidado.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Em alguns casos, o SQS pode enviar uma mensagem duplicada (item "Entrega pelo menos uma vez").</a>  Portanto, seu servi√ßo deve ser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">idempotente</a> para processamento. </blockquote><br>  <b>2. Mecanismo de tratamento de erros.</b>  No SQS, voc√™ pode configurar a segunda volta para mensagens "inativas" (fila de devolu√ß√µes).  Ou seja, aqueles que n√£o puderam processar nosso servi√ßo ser√£o enviados para uma fila separada, que voc√™ poder√° descartar a seu crit√©rio.  Voc√™ tamb√©m pode definir ap√≥s o qual o n√∫mero de tentativas sem √™xito que a mensagem entrar√° na fila "inoperante".  Uma tentativa com falha √© a expira√ß√£o do "Tempo limite da visibilidade".  Ou seja, se nenhuma solicita√ß√£o de exclus√£o tiver sido enviada durante esse per√≠odo, essa mensagem ser√° considerada n√£o processada e retornar√° √† fila principal ou ser√° direcionada para "morto". <br><br>  <b>3. Desduplica√ß√£o de mensagens.</b>  O SQS tamb√©m possui um sistema de prote√ß√£o duplicado.  Cada mensagem tem um <b>"ID de redu√ß√£o de redund√¢ncia"</b> , o SQS n√£o enfileira uma mensagem com <br>  repetido "ID de redu√ß√£o de redund√¢ncia" por 5 minutos.  Voc√™ deve especificar um "ID de redu√ß√£o de redund√¢ncia" em cada mensagem ou ativar a gera√ß√£o de ID com base em conte√∫do.  Isso significa que um hash gerado com base no seu conte√∫do ser√° inserido no "ID de redu√ß√£o de redund√¢ncia".  O par√¢metro <b>"Desduplica√ß√£o com base em conte√∫do".</b>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Mais sobre desduplica√ß√£o</a> <br><blockquote>  <b>Aviso:</b> tenha cuidado se enviar duas mensagens id√™nticas dentro de 5 minutos e voc√™ tiver <b>‚ÄúDesduplica√ß√£o baseada em conte√∫do‚Äù ativada.O</b> SQS n√£o adicionar√° uma segunda mensagem √† fila. <br></blockquote><blockquote>  <b>Aviso:</b> tenha cuidado, por exemplo, se n√£o houver conex√£o no dispositivo e ele n√£o receber uma resposta e enviar uma segunda solicita√ß√£o ap√≥s 5 minutos, ser√° criada uma duplicata. <br></blockquote>  <b>4. Enquete longa.</b>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Pesquisa longa</a> .  O SQS suporta esse tipo de conex√£o com um tempo limite m√°ximo de 20 segundos.  O que nos permite economizar tr√°fego e "empurr√µes" do servi√ßo. <br><br>  <b>5. M√©tricas.</b>  A Amazon tamb√©m fornece m√©tricas detalhadas da fila.  Como o n√∫mero de mensagens recebidas / enviadas / exclu√≠das, o tamanho em KB dessas mensagens e assim por diante.  Voc√™ tamb√©m pode conectar o SQS ao servi√ßo de log do CloudWatch.  L√° voc√™ pode ver ainda mais.  Tamb√©m √© poss√≠vel configurar os chamados <b>‚Äúalarmes‚Äù</b> e configurar a√ß√µes para qualquer evento.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Saiba mais sobre a conex√£o com o SQS.</a>  E <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">documenta√ß√£o do CloudWatch</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><br></a> <br><h3>  Agora vamos ver as configura√ß√µes da fila: </h3><br><h4>  Os principais: </h4><br>  <b>Tempo limite de visibilidade padr√£o - o</b> n√∫mero de segundos / minutos / horas durante o qual a mensagem ap√≥s o recebimento n√£o ficar√° vis√≠vel para o recebimento.  O tempo m√°ximo de processamento √© de 12 horas. <br><br>  <b>Per√≠odo de reten√ß√£o de mensagens - o</b> n√∫mero de segundos / minutos / horas / dias, o que significa quanto tempo as mensagens n√£o processadas ser√£o armazenadas na fila.  M√°ximo - 14 dias. <br><br>  <b>Tamanho</b> m√°ximo da mensagem - tamanho m√°ximo da mensagem em KB.  O valor √© de 1 KB a 256 KB. <br><br>  <b>Atraso na entrega -</b> voc√™ pode definir o tempo de atraso para entrega de uma mensagem na fila.  De 0 segundos a 15 minutos (de fato, as mensagens estar√£o na fila, mas n√£o estar√£o vis√≠veis para receber). <br><br>  <b>Tempo de espera para recebimento de mensagens -</b> tempo, quanto tempo a conex√£o permanecer√° no caso de usarmos "Pesquisa longa" para receber novas mensagens. <br><br>  <b>Desduplica√ß√£o com base em conte√∫do - um</b> sinalizador, se definido como true, um "ID de redu√ß√£o de redund√¢ncia" ser√° adicionado a cada mensagem na forma de um hash SHA-256 gerado a partir do conte√∫do. <br><br><h4>  Configura√ß√µes da fila inoperante </h4><br>  <b>Use Redrive Policy - um</b> sinalizador, se definido, as mensagens ser√£o redirecionadas ap√≥s v√°rias tentativas. <br><br>  <b>Fila de</b> mensagens n√£o entregues <b>- o</b> nome da fila "inativa" para a qual as mensagens brutas ser√£o enviadas. <br><br>  <b>N√∫mero M√°ximo de Recebimentos - o</b> n√∫mero de tentativas malsucedidas de processamento, ap√≥s as quais a mensagem ser√° enviada para a fila "inoperante" <br><blockquote>  <b>Aviso: Observe</b> tamb√©m que podemos enviar todos os par√¢metros principais juntamente com cada mensagem separadamente.  Por exemplo, cada mensagem individual pode ter seu pr√≥prio tempo <b>limite de visibilidade</b> ou <b>atraso de entrega.</b> </blockquote><h3>  Agora, um pouco sobre as pr√≥prias mensagens e suas propriedades: </h3><br>  Uma mensagem possui v√°rios par√¢metros: <br><br>  <b>1. Corpo da mensagem -</b> qualquer texto <br>  <b>2. O ID do grupo de mensagens √©</b> algo como uma tag, canal, necess√°rio para todas as mensagens.  √â garantido que cada um desses grupos seja processado no modo FIFO. <br>  <b>3. ID de redu√ß√£o</b> de redund√¢ncia de <b>mensagens -</b> string para identificar duplicatas.  Se o modo "Desduplica√ß√£o baseada em conte√∫do" estiver definido, o par√¢metro ser√° opcional. <br><br><h4>  Tamb√©m existem atributos de mensagem </h4><br>  Os atributos consistem em um nome, tipo e valor. <br><br>  <b>1. Nome -</b> sequ√™ncia <br>  <b>2. Tipo -</b> existem v√°rios tipos: sequ√™ncia, n√∫mero, bin√°rio.  O tipo vem simplesmente como uma string e √© poss√≠vel adicionar um postfix ao tipo.  Nesse caso, o tipo vir√° com esse postfix atrav√©s do ponto, por exemplo, string.example_postfix <br>  <b>3. Valor -</b> sequ√™ncia <br><blockquote>  <b>Aviso:</b> Observe que o n√∫mero m√°ximo de atributos √© <b>10</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Detalhes</a> </blockquote>  PS: Este artigo fornece uma breve descri√ß√£o da fila, bem como um pouco sobre os recursos e a mec√¢nica do SQS.  O artigo a seguir ser√° dedicado √† <b>AWS Lambda</b> e, em seguida, ao compartilhamento pr√°tico. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt457068/">https://habr.com/ru/post/pt457068/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt457058/index.html">Convertendo resultados de impress√£o em cliques para Google e Yandex em 2019</a></li>
<li><a href="../pt457060/index.html">Tr√™s v√≠deos para gravadores do iOS</a></li>
<li><a href="../pt457062/index.html">Centro de Treinamento Cosmonauta em Star City</a></li>
<li><a href="../pt457064/index.html">Para a quest√£o dos m√≥dulos</a></li>
<li><a href="../pt457066/index.html">Como modificar o rob√¥ FEDOR e a cadeira de v√¥o da ISS</a></li>
<li><a href="../pt457070/index.html">Textolite em vez de papel√£o. Algumas palavras sobre o emblema interativo OFFZONE 2019</a></li>
<li><a href="../pt457072/index.html">Como resolver um problema antigo usando o ML em Python e .Net</a></li>
<li><a href="../pt457074/index.html">A evolu√ß√£o dos desenvolvedores: quais jogos devemos esperar no futuro</a></li>
<li><a href="../pt457078/index.html">Como transformar seu avatar do Telegram em um rel√≥gio</a></li>
<li><a href="../pt457082/index.html">Concess√£o impercept√≠vel de direitos de administrador</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>