<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ’ ğŸ‘©ğŸ¿â€ğŸ­ ğŸ¤› é€šè¿‡RF24Networké€šè¿‡Modbusçš„OpenHABæ— çº¿å®¶ç”¨ç©ºè°ƒæ§åˆ¶å™¨ ğŸ‘¨ğŸ¾â€ğŸ¤â€ğŸ‘¨ğŸ½ ğŸˆº ğŸš™</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="åœ¨æˆ‘å†™äº†ç¬¬ä¸€ç¯‡å…³äºç”¨æ§åˆ¶å™¨æ§åˆ¶ç©ºè°ƒçš„æ–‡ç« ä¹‹åï¼Œä»…ä»…ä¸¤å¹´å¤šäº†ã€‚åœ¨è¿™æ®µæ—¶é—´é‡Œï¼Œè¿œç¨‹æ§åˆ¶ç©ºè°ƒçš„æƒ³æ³•å¹¶æ²¡æœ‰è®©æˆ‘ç¦»å¼€ï¼Œè€Œæ˜¯å¤šæ¬¡é‡ç”Ÿã€‚ä¸»è¦æ¡ä»¶æ˜¯ç©ºè°ƒæ²¡æœ‰ç”µçº¿ã€‚
 
 å³ï¼Œæ§åˆ¶å™¨çš„æ§åˆ¶å¿…é¡»æ˜¯æ— çº¿çš„ã€‚
 
 èƒŒæ™¯
 ç¬¬ä¸€ä¸ªåŸå‹æ˜¯Arduino UNOã€‚å¥¹æ¥å—äº†UARTä¸Šçš„å›¢é˜Ÿï¼Œå¹¶ä¸”çŸ¥é“å¦‚ä½•æ‰“å¼€å’Œå…³é—­ç©ºè°ƒã€‚å› ä¸ºè¿æ¥åˆ°...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>é€šè¿‡RF24Networké€šè¿‡Modbusçš„OpenHABæ— çº¿å®¶ç”¨ç©ºè°ƒæ§åˆ¶å™¨</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/384243/"><img align="left" src="https://habrastorage.org/files/1d4/8ed/b4b/1d48edb4b2b24079a0e2a7e7d5d7e584.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨</font><font style="vertical-align: inherit;">æˆ‘å†™äº†</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬ä¸€</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¯‡å…³äºç”¨æ§åˆ¶å™¨æ§åˆ¶ç©ºè°ƒçš„æ–‡ç« </font><font style="vertical-align: inherit;">ä¹‹å</font><font style="vertical-align: inherit;">ï¼Œä»…ä»…ä¸¤å¹´å¤šäº†ã€‚</font><font style="vertical-align: inherit;">åœ¨è¿™æ®µæ—¶é—´é‡Œï¼Œè¿œç¨‹æ§åˆ¶ç©ºè°ƒçš„æƒ³æ³•å¹¶æ²¡æœ‰è®©æˆ‘ç¦»å¼€ï¼Œè€Œæ˜¯å¤šæ¬¡é‡ç”Ÿã€‚</font><font style="vertical-align: inherit;">ä¸»è¦æ¡ä»¶æ˜¯ç©ºè°ƒæ²¡æœ‰ç”µçº¿ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å³ï¼Œæ§åˆ¶å™¨çš„æ§åˆ¶å¿…é¡»æ˜¯æ— çº¿çš„ã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">èƒŒæ™¯</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç¬¬ä¸€ä¸ªåŸå‹æ˜¯Arduino UNOã€‚å¥¹æ¥å—äº†UARTä¸Šçš„å›¢é˜Ÿï¼Œå¹¶ä¸”çŸ¥é“å¦‚ä½•æ‰“å¼€å’Œå…³é—­ç©ºè°ƒã€‚å› ä¸ºè¿æ¥åˆ°å·¥ä½œè®¡ç®—æœºçš„arduinkaå‡ ä¹æ²¡æœ‰å®é™…æ„ä¹‰ï¼Œè´Ÿè´£äººä¸€ç›´åœ¨å¯»æ‰¾å°†åè€…è¿æ¥åˆ°å®¶åº­æœåŠ¡å™¨çš„æœºä¼šã€‚ä»æœåŠ¡å™¨åˆ°æ‰€æœ‰éš¾é¢˜çš„ç½ªé­ç¥¸é¦–éƒ½æ²¡æœ‰ç›´æ¥å¯è§æ€§ã€‚æœ€å¤§çš„æ˜¯åœ¨æ‰€æœ‰åŒä¸€å°å·¥ä½œè®¡ç®—æœºä¸Šéƒ½å¸¦æœ‰LANçš„æ’æ§½-å› ä¸ºå®ƒå‡ ä¹ä¸ç©ºè°ƒç›¸å¯¹ã€‚ä»¥å¤ªç½‘å±è”½ä¸å¯ç”¨ã€‚ä½†æ˜¯è¯·è®°ä½ï¼Œåœ¨zashashnikä¸­çš„æŸä¸ªåœ°æ–¹æœ‰ä¸€ä¸ªd-link DSL-2500U dslè°ƒåˆ¶è§£è°ƒå™¨ï¼Œè¯¥è°ƒåˆ¶è§£è°ƒå™¨å·²ç»ä½¿ç”¨å¾ˆé•¿æ—¶é—´äº†ï¼Œæ¿ä¸Šåªæœ‰ä¸€ä¸ªç«¯å£ã€‚èµ‹äºˆé“æ†ç¬¬äºŒæ¬¡ç”Ÿå‘½çš„æ„¿æœ›å¯¼è‡´äº†è°·æ­Œæœç´¢ï¼Œè¿™åè¿‡æ¥åˆå¥‡è¿¹èˆ¬åœ°å¯¼è‡´äº†ä¸€ç¯‡æ–‡ç« ï¼Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°†ADSLè°ƒåˆ¶è§£è°ƒå™¨å˜æˆArduino / CraftDuinoçš„ä»¥å¤ªç½‘å±è”½</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å‘å‰è·³è¿‡äº†åˆ›å»ºè‡ªå®šä¹‰å›ºä»¶çš„æœ‰è¶£è¿‡ç¨‹ï¼Œæˆ‘ä»ç„¶è®¾æ³•ä½¿è°ƒåˆ¶è§£è°ƒå™¨ä¾¦å¬æ‰€éœ€çš„ç«¯å£å¹¶é€šè¿‡å®ƒâ€œè½¬å‘â€ UARTã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼Œåœ¨å®¶åº­æœåŠ¡å™¨ä¸Šï¼Œæˆ‘å¯ä»¥å‘é€å‘½ä»¤æ‰“å¼€/å…³é—­ç«¯å£åˆ°æœ¬åœ°è°ƒåˆ¶è§£è°ƒå™¨åœ°å€ï¼Œè¯¥åœ°å€å°†è½¬åˆ°ä¸å…¶è¿æ¥çš„arduinoã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½†æ˜¯è¿™ç¯‡æ–‡ç« ä¸æ˜¯å…³äºè¿™ä¸ªçš„ã€‚</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ€ç»ˆçš„</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è§£å†³æ–¹æ¡ˆä½¿ç”¨Modbusåè®®å’Œ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">RF24Network</font></a><font style="vertical-align: inherit;">æ— çº¿ç½‘ç»œ</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ä¸€åˆ‡éƒ½åœ¨OpenHABä¸­æ§åˆ¶ã€‚</font></font><br>
<a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨è¿‡å»çš„ä¸¤å¹´ä¸­ï¼Œæˆ‘è®¾æ³•ä»ä¸­å›½è®¢è´­äº†è®¸å¤šnishtyakï¼Œå…¶ä¸­å¤§å¤šæ•°éƒ½åœ¨ç­‰å¾…ä¸­ã€‚</font><font style="vertical-align: inherit;">è¯¥æ¸…å•åŒ…æ‹¬NRF24L01 +æ¨¡å—ï¼Œç”±å°‘æ•°äººè´­ä¹°ä»¥è¿›è¡Œè¯•éªŒã€‚</font><font style="vertical-align: inherit;">å¦‚æœæœ‰ä¸€å¤©æˆ‘æ²¡æœ‰å¶ç„¶å‘ç°ä¸€ç³»åˆ—æ–‡ç« ï¼Œä»–å°†åœ¨å£æ©±é‡Œé—²æ•£çš„èµ°å¾—æ›´è¿œï¼š</font></font><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚ä½•äº¤æœ‹å‹OpenHABå’ŒArduino</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduinoå’ŒModbus</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduinoå’ŒOpenHAB</font></font></a></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»  </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åšé‡Œå¥‡</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è°¢è°¢ä½ ï¼</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¤šäºäº†ä»–ä»¬ï¼Œæˆ‘æ‰ç†Ÿæ‚‰Modbusåè®®ã€‚</font><font style="vertical-align: inherit;">ä½†æœ€é‡è¦çš„æ˜¯ï¼Œæˆ‘ä¸ºè‡ªå·±æ‰¾åˆ°äº†OpenHAB-æˆ‘å·²ç»å¯»æ‰¾äº†å¾ˆé•¿æ—¶é—´ã€‚</font><font style="vertical-align: inherit;">è¿™ä¿ƒä½¿æˆ‘å¼€å§‹å®æ–½é•¿æœŸçš„æƒ³æ³•ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨æµè§ˆäº†æ–‡ç« ä¸­çš„ç¤ºä¾‹ä¹‹åï¼Œæˆ‘å†³å®šå°è¯•ä½¿ç”¨ä»¥å¤ªç½‘å±è”½ä¸ä¸Šè¿°è°ƒåˆ¶è§£è°ƒå™¨åˆ†ç¦»æ§åˆ¶å™¨å’ŒæœåŠ¡å™¨ã€‚</font><font style="vertical-align: inherit;">è¯¥è§£å†³æ–¹æ¡ˆä½¿æˆ‘ä»¬èƒ½å¤Ÿå®Œæˆæ‘†åœ¨æ‚¨é¢å‰çš„ä»»åŠ¡-é˜²æŠ¤ç½©å’Œæ§åˆ¶å™¨ä½äºå°å¼æœºä¸Šï¼Œè€Œæ— éœ€ä½¿ç”¨å·¥ä½œè®¡ç®—æœºï¼ŒåŒæ—¶ï¼Œé˜²æŠ¤ç½©å§‹ç»ˆè¿æ¥åˆ°æœ¬åœ°ç½‘ç»œï¼Œå¹¶ä¸”å¯ä»¥ä»å®¶åº­æœåŠ¡å™¨è¿›è¡Œè®¿é—®ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½†æ˜¯è¿™ä¸ªå†³å®šæ³¨å®šè¦å¤±è´¥ã€‚</font></font></b><div class="spoiler_text">     ModbusRtu over TCP   .    modpoll,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Arduino &amp; Modbus</a>  .     â€”          192.168.1.110   3000  !<br>
<br>
    OpenHAB. ,  , Modbus Binding   Â«RTU over TCPÂ».        â€”     ModbusRtu   c      TCP.            OpenHAB-(ethernet)--(UART)-.<br>
<br>
 ,   ?      Item  .      1 Item     .      â€”      . ,   ,    TCP    Modbus Binding. ..              .<br>
<br>
   Modbus Binding     Item'   host-port-slaveID     .<br>
<br>
        ,     .                .       ,    .<br>
</div></div><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç†å¿µ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç„¶åï¼Œæˆ‘ç»ˆäºç¡®å®šè‡ªå·±éœ€è¦åˆ¶é€ ä¸€ä¸ªå¯ä»¥é€šè¿‡ç©ºä¸­æ“ä½œçš„æ§åˆ¶å™¨ã€‚</font><font style="vertical-align: inherit;">NRF24L01 +æ¨¡å—ä¸åº”æ¶ˆå¤±ï¼ã€‚çš„ç¡®ï¼Œè¿™è‡³å°‘éœ€è¦ä¸¤ä¸ªæ§åˆ¶å™¨-ä¸€ä¸ªèµ·ç›´æ¥ä½œç”¨ï¼Œç¬¬äºŒä¸ªèµ·è·¯ç”±å™¨çš„ä½œç”¨ã€‚</font><font style="vertical-align: inherit;">ç¬¬äºŒä¸ªåº”è¯¥è¿æ¥åˆ°æœåŠ¡å™¨ï¼Œå¹¶é€šè¿‡å®ƒä¸å…¶ä»–æœåŠ¡å™¨è¿›è¡Œæ— çº¿é€šä¿¡ã€‚</font><font style="vertical-align: inherit;">è¿æ¥åˆ°å®ƒæ—¶ï¼Œæˆ‘ä»¬æŒ‡å®šè¯¥åŒ…è¦ä½¿ç”¨çš„ä¸‹çº§çš„IDã€‚</font><font style="vertical-align: inherit;">äº‹å®è¯æ˜ï¼Œä¸€ä¸ªä¸²è¡Œç«¯å£ä¸Šæœ‰è®¸å¤šä»è®¾å¤‡ã€‚</font><font style="vertical-align: inherit;">æ˜¯çš„-è¿™æ˜¯åŸºäºModbusçš„æ— çº¿ç½‘ç»œã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é¡ºä¾¿è¯´ä¸€å¥ï¼ŒModbuså…è®¸ä¸€ä¸ªä¸»æœºå»ºç«‹ä¸€ä¸ªç½‘ç»œ-è®¸å¤šä¸‹å±ã€‚</font><font style="vertical-align: inherit;">ä»¥åŠ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RF24Network</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åº“</font><font style="vertical-align: inherit;">-ä½¿ä¸€åˆ‡å˜å¾—æ— çº¿ï¼Œç”šè‡³åœ¨ç½‘ç»œèŠ‚ç‚¹ä¹‹é—´è‡ªåŠ¨è·¯ç”±ã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduinoçš„åº“å¼€å‘</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºäº†å®ç°è¿™æ ·çš„è§£å†³æ–¹æ¡ˆï¼Œéœ€è¦èŠ±å¾ˆå¤šæ—¶é—´æ¥ä¿®æ”¹</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modbus-Master-Slave-for-Arduino</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åº“</font><font style="vertical-align: inherit;">ï¼Œä»¥ä¾¿èƒ½å¤Ÿä»ä¸­ç»§æ‰¿å¹¶é‡è½½ä¸€äº›æ–¹æ³•ã€‚</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘çš„å®ç°</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¹Ÿå·²æ›´æ–°ï¼ˆå·²æ·»åŠ library.propertiesï¼Œåº“æ–‡ä»¶åˆ†ä¸ºæ ‡å¤´å’Œæ­£æ–‡ï¼‰ä»¥é€‚ç”¨äºæœ€æ–°çš„Arduino IDE 1.6.5ã€‚</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">Arduino</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
çš„</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modbus-over-RF24Network-for-Arduino</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åº“</font><font style="vertical-align: inherit;">å…è®¸æ‚¨å®ç°ä¸¤ç§å¯èƒ½çš„è¡Œä¸º-ä»£ç†å’Œä»å±ã€‚</font><font style="vertical-align: inherit;">ç¤ºä¾‹ModbusRF24Proxyå®é™…ä¸Šæ˜¯â€œè·¯ç”±å™¨â€çš„å®ç°ï¼Œé™¤äº†è®¾ç½®å¿…è¦çš„å¼•è„šå¤–ï¼Œä¸éœ€è¦è¿›è¡Œä»»ä½•ä¿®æ”¹ã€‚</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modbusç¤ºä¾‹RF24Proxy</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;RF24Network.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;RF24.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;SPI.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;ModbusRtu.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;ModbusRtuRF24.h&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> stlPin  13  <span class="hljs-comment">//     (   Arduino)</span></span><font></font>
<font></font>
<span class="hljs-comment">// nRF24L01(+) radio attached using Getting Started board </span>
<span class="hljs-function">RF24 <span class="hljs-title">radio</span><span class="hljs-params">(<span class="hljs-number">9</span>, <span class="hljs-number">10</span>)</span></span>;<font></font>
<font></font>
<span class="hljs-comment">// Network uses that radio</span>
<span class="hljs-function">RF24Network <span class="hljs-title">network</span><span class="hljs-params">(radio)</span></span>;<font></font>
<font></font>
<span class="hljs-comment">// Address of our node</span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint16_t</span> this_node = <span class="hljs-number">0</span>;<font></font>
<font></font>
<span class="hljs-comment">//  ,   TX</span>
<span class="hljs-function">ModbusRF24 <span class="hljs-title">proxy</span><span class="hljs-params">(network, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)</span></span>;
<span class="hljs-keyword">int8_t</span> state = <span class="hljs-number">0</span>;
<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> tempus;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">//    </span><font></font>
    io_setup();<font></font>
    <span class="hljs-comment">//    </span><font></font>
<font></font>
    proxy.begin(<span class="hljs-number">57600</span>);<font></font>
<font></font>
    SPI.begin();<font></font>
    radio.begin();<font></font>
    network.begin(<span class="hljs-comment">/*channel*/</span> <span class="hljs-number">90</span>, <span class="hljs-comment">/*node address*/</span> this_node);<font></font>
<font></font>
    <span class="hljs-comment">//    100 </span>
    tempus = millis() + <span class="hljs-number">100</span>;<font></font>
    digitalWrite(stlPin, HIGH);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">io_setup</span><span class="hljs-params">()</span> </span>{<font></font>
    digitalWrite(stlPin, HIGH);<font></font>
    pinMode(stlPin, OUTPUT);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span> </span>{<font></font>
<font></font>
    <span class="hljs-comment">// Pump the network regularly</span><font></font>
    network.update();<font></font>
<font></font>
    <span class="hljs-comment">//  </span><font></font>
    state = proxy.proxy();<font></font>
<font></font>
    <span class="hljs-comment">//      -    50  </span>
    <span class="hljs-keyword">if</span> (state &gt; <span class="hljs-number">4</span>) {<font></font>
        tempus = millis() + <span class="hljs-number">50</span>;<font></font>
        digitalWrite(stlPin, HIGH);<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (millis() &gt; tempus) digitalWrite(stlPin, LOW);<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è·¯ç”±å™¨æˆ–ä»£ç†ä½¿ç”¨ç‰¹æ®Šçš„æ„é€ å‡½æ•°æ ¼å¼ï¼š</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-comment">//  ,   TX</span>
<span class="hljs-function">ModbusRF24 <span class="hljs-title">proxy</span><span class="hljs-params">(network, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)</span></span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å’ŒåŠŸèƒ½ </font></font><br>
<pre><code class="cpp hljs">proxy.proxy();
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¤„ç†ä¸²è¡Œç«¯å£ä¸Šçš„ä¼ å…¥æ•°æ®åŒ…ï¼Œå°†å…¶å‘é€åˆ°RF24Networkï¼Œä»ç½‘ç»œæ¥æ”¶å“åº”ï¼Œç„¶åå°†ç»“æœå‘é€å›ä¸²è¡Œç«¯å£ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨æ­¤å®ç°ä¸­ï¼Œä»£ç†çš„RF24Networkåœ°å€ä¸ºé›¶ï¼š</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-comment">// Address of our node</span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint16_t</span> this_node = <span class="hljs-number">0</span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -å³ </font><font style="vertical-align: inherit;">è¿™æ˜¯ç½‘ç»œçš„æ ¹è®¾å¤‡ã€‚</font><font style="vertical-align: inherit;">å¦‚æœ‰å¿…è¦ï¼Œå¯ä»¥æ›´æ”¹ä»£ç†æ§åˆ¶å™¨æ‹“æ‰‘ä¸­çš„ä½ç½®ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modbusç¤ºä¾‹RF24ä»ç«™</font></font></b><div class="spoiler_text">    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Arduino &amp; Modbus</a>:<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;RF24Network.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;RF24.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;SPI.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;ModbusRtu.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;ModbusRtuRF24.h&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ID   1      <span class="hljs-comment">//  </span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> btnPin  2   <span class="hljs-comment">//  ,   </span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ledPin  7  <span class="hljs-comment">//   </span></span><font></font>
<font></font>
<span class="hljs-comment">// nRF24L01(+) radio attached using Getting Started board </span>
<span class="hljs-function">RF24 <span class="hljs-title">radio</span><span class="hljs-params">(<span class="hljs-number">9</span>, <span class="hljs-number">10</span>)</span></span>;<font></font>
<font></font>
<span class="hljs-comment">// Network uses that radio</span>
<span class="hljs-function">RF24Network <span class="hljs-title">network</span><span class="hljs-params">(radio)</span></span>;<font></font>
<font></font>
<span class="hljs-comment">// Address of our node</span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint16_t</span> this_node = ID;<font></font>
<font></font>
<span class="hljs-comment">//  </span>
<span class="hljs-function">ModbusRF24 <span class="hljs-title">slave</span><span class="hljs-params">(network, ID)</span></span>;<font></font>
<font></font>
<span class="hljs-comment">//   modbus</span>
<span class="hljs-keyword">uint16_t</span> au16data[<span class="hljs-number">11</span>];<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">io_setup</span><span class="hljs-params">()</span> </span>{<font></font>
    digitalWrite(ledPin, LOW);<font></font>
    pinMode(ledPin, OUTPUT);<font></font>
    pinMode(btnPin, INPUT);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">io_poll</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">// Coil[1]  Discrete[0]</span>
    au16data[<span class="hljs-number">0</span>] = au16data[<span class="hljs-number">1</span>];
    <span class="hljs-comment">//   1.3   </span>
    digitalWrite(ledPin, bitRead(au16data[<span class="hljs-number">1</span>], <span class="hljs-number">3</span>));
    <span class="hljs-comment">//     0.3</span>
    bitWrite(au16data[<span class="hljs-number">0</span>], <span class="hljs-number">3</span>, digitalRead(btnPin));
    <span class="hljs-comment">// Holding[5,6,7]  Input[2,3,4]</span>
    au16data[<span class="hljs-number">2</span>] = au16data[<span class="hljs-number">5</span>];<font></font>
    au16data[<span class="hljs-number">3</span>] = au16data[<span class="hljs-number">6</span>];<font></font>
    au16data[<span class="hljs-number">4</span>] = au16data[<span class="hljs-number">7</span>];
    <span class="hljs-comment">//    </span>
    au16data[<span class="hljs-number">8</span>] = slave.getInCnt();<font></font>
    au16data[<span class="hljs-number">9</span>] = slave.getOutCnt();<font></font>
    au16data[<span class="hljs-number">10</span>] = slave.getErrCnt();<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">//    </span><font></font>
    io_setup();<font></font>
<font></font>
    Serial.begin(<span class="hljs-number">57600</span>);<font></font>
    Serial.println(<span class="hljs-string">"RF24Network/examples/modbus_slave/"</span>);<font></font>
<font></font>
    SPI.begin();<font></font>
    radio.begin();<font></font>
    network.begin(<span class="hljs-comment">/*channel*/</span> <span class="hljs-number">90</span>, <span class="hljs-comment">/*node address*/</span> this_node);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span> </span>{<font></font>
<font></font>
    <span class="hljs-comment">// Pump the network regularly</span><font></font>
    network.update();<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (network.available()) {<font></font>
        slave.poll(au16data, <span class="hljs-number">11</span>);<font></font>
    }<font></font>
    <span class="hljs-comment">//    Modbus    </span><font></font>
    io_poll();<font></font>
}<font></font>
</code></pre><br>
<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ„é€ å‡½æ•°å·²ç»ä¸åŒï¼š</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-comment">//  </span>
<span class="hljs-function">ModbusRF24 <span class="hljs-title">slave</span><span class="hljs-params">(network, ID)</span></span>;
</code></pre><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modbuså¯„å­˜å™¨ç»“æ„</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨ç¬¬ä¸€æ¬¡æˆåŠŸåœ°å°è¯•æ§åˆ¶ç©ºè°ƒçš„èƒ½åŠ›ä¹‹åï¼Œæˆ‘çš„é£Ÿæ¬²å´å¢åŠ äº†ã€‚</font><font style="vertical-align: inherit;">ç°åœ¨è¿™è¿˜ä¸å¤Ÿï¼Œå¹¶ä¸”ç”±äºæˆ‘çš„ç§»åŠ¨åº”ç”¨ç¨‹åºä¸­å…·æœ‰OpenHABåŠŸèƒ½ï¼Œå› æ­¤å®ƒè‡³å°‘åº”å…·æœ‰æœ¬æœºæ§åˆ¶é¢æ¿çš„æ‰€æœ‰åŠŸèƒ½ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™æ„å‘³ç€è¿™é‡Œè‡³å°‘æ˜¯åŠŸèƒ½åˆ—è¡¨ï¼š</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å½“å‰çŠ¶æ€æŒ‡ç¤º</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‰“å¼€å’Œå…³é—­ç©ºè°ƒï¼Œå„ç§æ¨¡å¼ï¼ˆO </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œç”µç¦»ï¼Œé™éŸ³æ¨¡å¼ï¼‰ï¼›</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å½“å‰æ¨¡å¼çš„é€‰æ‹©ï¼ˆè‡ªåŠ¨ï¼ŒåŠ çƒ­ï¼Œå†·å´ï¼Œæ’æ°´ï¼Œé£æ‰‡ï¼‰ï¼›</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æŒ‡ç¤ºæ¯ç§æ¨¡å¼çš„æ¸©åº¦å’Œé£æ‰‡é€Ÿåº¦ã€‚</font><font style="vertical-align: inherit;">å¯¹äºé£æ‰‡æ¨¡å¼ï¼Œåªæœ‰é€Ÿåº¦ï¼›</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‚ç›´çª—å¸˜è®¾ç½®ï¼ˆè‡ªåŠ¨ï¼Œ0Â°ï¼Œ15Â°ï¼Œ30Â°ï¼Œ45Â°ï¼Œ60Â°ï¼‰;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ°´å¹³çª—å¸˜è®¾ç½®ï¼ˆè‡ªåŠ¨ï¼Œâ€œ | |â€ï¼Œâ€œ / /â€ï¼Œâ€œ / |â€ï¼Œâ€œ | \â€ï¼Œâ€œ \ \â€ï¼‰ï¼›</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ—¶é—´è®¾ç½®ï¼ˆå°æ—¶ï¼Œåˆ†é’Ÿï¼‰ï¼›</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨è®¡æ—¶å™¨è®¾ç½®ä¸Šï¼›</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…³æœºå®šæ—¶å™¨è®¾ç½®ï¼›</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡†æ—¶è®¾ç½®ï¼ˆå°æ—¶ï¼Œåˆ†é’Ÿï¼‰ï¼›</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…³æœºæ—¶é—´è®¾ç½®ï¼ˆå°æ—¶ï¼Œåˆ†é’Ÿï¼‰ï¼›</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¯„å­˜å™¨çš„ç»“æ„å¯¹æˆ‘æ¥è¯´å·²ç»æ”¹å˜äº†å¾ˆå¤šæ¬¡ã€‚</font><font style="vertical-align: inherit;">å½“å‰ç‰ˆæœ¬åœ¨æ‰°æµæ¿ä¸‹æ–¹ã€‚</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modbuså¯„å­˜å™¨</font></font></b><div class="spoiler_text"><table>
<tbody><tr>
<th>Type</th>
<th>Byte</th>
<th>Bit</th>
<th>Name</th>
<th></th>
</tr>
<tr>
<td>Bit RO</td>
<td>0</td>
<td>0</td>
<td>CFG_OXYGEN</td>
<td>1 â€”   </td>
</tr>
<tr>
<td>Bit RO</td>
<td></td>
<td>1</td>
<td>CFG_ION</td>
<td>1 â€”   </td>
</tr>
<tr>
<td>Bit RO</td>
<td></td>
<td>2</td>
<td>CFG_QUIET</td>
<td>1 â€”   </td>
</tr>
<tr>
<td>Bit RO</td>
<td></td>
<td>3</td>
<td>CFG_TIMER</td>
<td>1 â€”  /   </td>
</tr>
<tr>
<td>Bit RO</td>
<td></td>
<td>4</td>
<td>CFG_DELAY</td>
<td>1 â€”   /</td>
</tr>
<tr>
<td>Bit RO</td>
<td></td>
<td>5</td>
<td>CFG_SWING</td>
<td>1 â€”   </td>
</tr>
<tr>
<td>Bit RO</td>
<td></td>
<td>6</td>
<td>CFG_SWINGH</td>
<td>1 â€”    </td>
</tr>
<tr>
<td>Bit RO</td>
<td></td>
<td>7</td>
<td>CFG_SWINGV</td>
<td>1 â€”    </td>
</tr>
<tr>
<td>Bit RO</td>
<td></td>
<td>8</td>
<td>CFG_CLOCK</td>
<td>1 â€”  </td>
</tr>
<tr>
<td>Bit RO</td>
<td></td>
<td>9</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Bit RO</td>
<td></td>
<td>10</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Bit RO</td>
<td></td>
<td>11</td>
<td>CFG_AUTO</td>
<td>1 â€”   AUTO</td>
</tr>
<tr>
<td>Bit RO</td>
<td></td>
<td>12</td>
<td>CFG_COOL</td>
<td>1 â€”   COOL</td>
</tr>
<tr>
<td>Bit RO</td>
<td></td>
<td>13</td>
<td>CFG_HEAT</td>
<td>1 â€”   HEAT</td>
</tr>
<tr>
<td>Bit RO</td>
<td></td>
<td>14</td>
<td>CFG_DRY</td>
<td>1 â€”   DRY</td>
</tr>
<tr>
<td>Bit RO</td>
<td></td>
<td>15</td>
<td>CFG_FAN</td>
<td>1 â€”   FAN</td>
</tr>
<tr>
<td>Integer RO</td>
<td>1</td>
<td></td>
<td>CFG_TEMP</td>
<td>.  . : Min + Max*256</td>
</tr>
<tr>
<td>Integer RO</td>
<td>2</td>
<td></td>
<td>CFG_FAN_SPEED</td>
<td>  FAN</td>
</tr>
<tr>
<td>Bit RO</td>
<td>3</td>
<td>0</td>
<td>STATE_POWER</td>
<td>:0 â€” , 1 â€” </td>
</tr>
<tr>
<td>Bit RO</td>
<td></td>
<td>1</td>
<td>STATE_OXYGEN</td>
<td>:0 â€” , 1 â€” </td>
</tr>
<tr>
<td>Bit RO</td>
<td></td>
<td>2</td>
<td>STATE_ION</td>
<td>:0 â€” , 1 â€” </td>
</tr>
<tr>
<td>Bit RO</td>
<td></td>
<td>3</td>
<td>STATE_QUIET</td>
<td>:0 â€” , 1 â€” </td>
</tr>
<tr>
<td>Bit RO</td>
<td></td>
<td>4</td>
<td>STATE_TIMER</td>
<td>:0 â€” , 1 â€” </td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Bit RW</td>
<td></td>
<td>8</td>
<td>CONTROL_POWER</td>
<td></td>
</tr>
<tr>
<td>Bit RW</td>
<td></td>
<td>9</td>
<td>CONTROL_OXYGEN</td>
<td></td>
</tr>
<tr>
<td>Bit RW</td>
<td></td>
<td>10</td>
<td>CONTROL_ION</td>
<td></td>
</tr>
<tr>
<td>Bit RW</td>
<td></td>
<td>11</td>
<td>CONTROL_QUIET</td>
<td></td>
</tr>
<tr>
<td>Integer RO</td>
<td>4</td>
<td></td>
<td>RTC_HR_MI</td>
<td>0x1308</td>
</tr>
<tr>
<td>Integer RW</td>
<td>5</td>
<td></td>
<td>RTCW_HR_MI</td>
<td>0x1308</td>
</tr>
<tr>
<td>Integer RO</td>
<td>6</td>
<td></td>
<td>TEMPERATURE1</td>
<td> . INT16,   </td>
</tr>
<tr>
<td>Integer RO</td>
<td>7</td>
<td></td>
<td>TEMPERATURE2</td>
<td> . INT16,   </td>
</tr>
<tr>
<td>Bit RW</td>
<td>8</td>
<td>0</td>
<td>MODE_AUTO</td>
<td></td>
</tr>
<tr>
<td>Bit RW</td>
<td></td>
<td>1</td>
<td>MODE_COOL</td>
<td></td>
</tr>
<tr>
<td>Bit RW</td>
<td></td>
<td>2</td>
<td>MODE_HEAT</td>
<td></td>
</tr>
<tr>
<td>Bit RW</td>
<td></td>
<td>3</td>
<td>MODE_DRY</td>
<td></td>
</tr>
<tr>
<td>Bit RW</td>
<td></td>
<td>4</td>
<td>MODE_FAN</td>
<td></td>
</tr>
<tr>
<td>Integer RW</td>
<td>9</td>
<td></td>
<td>TEMP_AUTO</td>
<td> AUTO</td>
</tr>
<tr>
<td>Integer RW</td>
<td>10</td>
<td></td>
<td>TEMP_COOL</td>
<td> COOL</td>
</tr>
<tr>
<td>Integer RW</td>
<td>11</td>
<td></td>
<td>TEMP_HEAT</td>
<td> HEAT</td>
</tr>
<tr>
<td>Integer RW</td>
<td>12</td>
<td></td>
<td>TEMP_DRY</td>
<td> DRY</td>
</tr>
<tr>
<td>Integer RW</td>
<td>13</td>
<td></td>
<td>FAN_AUTO</td>
<td> AUTO. 0: Auto</td>
</tr>
<tr>
<td>Integer RW</td>
<td>14</td>
<td></td>
<td>FAN_COOL</td>
<td> COOL. 0: Auto</td>
</tr>
<tr>
<td>Integer RW</td>
<td>15</td>
<td></td>
<td>FAN_HEAT</td>
<td> HEAT. 0: Auto</td>
</tr>
<tr>
<td>Integer RW</td>
<td>16</td>
<td></td>
<td>FAN_DRY</td>
<td> DRY. 0: Auto</td>
</tr>
<tr>
<td>Integer RW</td>
<td>17</td>
<td></td>
<td>FAN_SPEED</td>
<td> FAN. 0: Auto</td>
</tr>
<tr>
<td>Bit RW</td>
<td>18</td>
<td>0</td>
<td>SWING_AUTO</td>
<td> </td>
</tr>
<tr>
<td>Bit RW</td>
<td></td>
<td>1</td>
<td>SWINGV_0</td>
<td>   0Â°</td>
</tr>
<tr>
<td>Bit RW</td>
<td></td>
<td>2</td>
<td>SWINGV_15</td>
<td>   15Â°</td>
</tr>
<tr>
<td>Bit RW</td>
<td></td>
<td>3</td>
<td>SWINGV_30</td>
<td>   30Â°</td>
</tr>
<tr>
<td>Bit RW</td>
<td></td>
<td>4</td>
<td>SWINGV_45</td>
<td>   45Â°</td>
</tr>
<tr>
<td>Bit RW</td>
<td></td>
<td>5</td>
<td>SWINGV_60</td>
<td>   60Â°</td>
</tr>
<tr>
<td>Bit RW</td>
<td>19</td>
<td>0</td>
<td>SWINGH_AUTO</td>
<td> </td>
</tr>
<tr>
<td>Bit RW</td>
<td></td>
<td>1</td>
<td>SWINGH_VV</td>
<td>  | &nbsp;|</td>
</tr>
<tr>
<td>Bit RW</td>
<td></td>
<td>2</td>
<td>SWINGH_LL</td>
<td>  / &nbsp;/</td>
</tr>
<tr>
<td>Bit RW</td>
<td></td>
<td>3</td>
<td>SWINGH_LV</td>
<td>  / &nbsp;|</td>
</tr>
<tr>
<td>Bit RW</td>
<td></td>
<td>4</td>
<td>SWINGH_VR</td>
<td>  | &nbsp;\</td>
</tr>
<tr>
<td>Bit RW</td>
<td></td>
<td>5</td>
<td>SWINGH_RR</td>
<td>  \ &nbsp;\</td>
</tr>
<tr>
<td>Bit RW</td>
<td>20</td>
<td>0</td>
<td>TIMER_ON</td>
<td></td>
</tr>
<tr>
<td>Bit RW</td>
<td></td>
<td>1</td>
<td>TIMER_OFF</td>
<td></td>
</tr>
<tr>
<td>Integer RW</td>
<td>21</td>
<td></td>
<td>TIME_ON_HOUR</td>
<td> </td>
</tr>
<tr>
<td>Integer RW</td>
<td>22</td>
<td></td>
<td>TIME_ON_MINUTE</td>
<td> </td>
</tr>
<tr>
<td>Integer RW</td>
<td>23</td>
<td></td>
<td>TIME_OFF_HOUR</td>
<td> </td>
</tr>
<tr>
<td>Integer RW</td>
<td>24</td>
<td></td>
<td>TIME_OFF_MINUTE</td>
<td> </td>
</tr>
<tr>
<td>Integer RW</td>
<td>25</td>
<td></td>
<td>DS18B20_ENV</td>
<td>. </td>
</tr>
<tr>
<td>Integer RW</td>
<td>26</td>
<td></td>
<td>DS18B20_NOZ</td>
<td>. </td>
</tr>
</tbody></table><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯„å­˜å™¨çš„ç»„ç»‡æ–¹å¼æ˜¯ï¼Œå½“æ§åˆ¶å™¨å¯åŠ¨æ—¶ï¼Œæ•´ä¸ªæ•°æ®é˜µåˆ—ä»EEPROMåˆå§‹åŒ–ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å‰ä¸‰ä¸ªå¯„å­˜å™¨ï¼ˆCFG_ *ï¼‰åŒ…å«åŠŸèƒ½çš„é…ç½®ï¼Œå®ƒä»¬æ°¸ä¸æ›´æ”¹ï¼Œå¹¶ç”±EEPROMå›ºä»¶åˆå§‹åŒ–ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯„å­˜å™¨3-7å§‹ç»ˆæ˜¾ç¤ºæ§åˆ¶å™¨çš„å½“å‰çŠ¶æ€ã€‚å¯„å­˜å™¨3çš„é«˜ä½ç”¨äºæ”¹å˜çŠ¶æ€ã€‚ä»–ä»¬çš„æ›´æ”¹å¯åŠ¨äº†ç©ºè°ƒçš„å¼€/å…³å’Œç‰¹æ®Šæ¨¡å¼ã€‚æ‰§è¡Œè¯¥å‘½ä»¤åï¼Œè¯¥å¯„å­˜å™¨çš„ä½ä½å¤åˆ¶åˆ°é«˜ä½ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯„å­˜å™¨4åŒ…å«å½“å‰æ§åˆ¶å™¨æ—¶é—´ï¼Œå¯ä»RTCè¯»å–ã€‚è¯¥å€¼ä»¥BCDæ ¼å¼ä¿å­˜ï¼Œå› æ­¤å½“è¯¥å¯„å­˜å™¨ä»¥åå…­è¿›åˆ¶è¡¨ç¤ºæ—¶ï¼Œå°†æŒ‰åŸæ ·è¯»å–æ—¶é—´-12:34ä¸º0x1234ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯„å­˜å™¨5ç”¨äºæ›´æ”¹RTCæ—¶é—´ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯„å­˜å™¨6-7åŒ…å«DS18B20ä¼ æ„Ÿå™¨çš„æ¸©åº¦ã€‚</font><font style="vertical-align: inherit;">è¯¥å€¼åŒ…å«ä¸€ä¸ªæœ‰ç¬¦å·æ•´æ•°ï¼Œç­‰äºT * 100ï¼Œå³ </font><font style="vertical-align: inherit;">25.67Â°C = 2567ã€‚</font><font style="vertical-align: inherit;">æœ€å¤šæä¾›2ä¸ªä¼ æ„Ÿå™¨ï¼Œä½†æ˜¯é€šè¿‡æ‰©å±•å¯„å­˜å™¨è¡¨ä»¥å­˜å‚¨ä¼ æ„Ÿå™¨çš„åœ°å€åŠå…¶æ¸©åº¦å¯ä»¥è½»æ¾æ›´æ”¹æ•°é‡ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¼ æ„Ÿå™¨åœ°å€çš„æœ€å2ä¸ªå­—èŠ‚å­˜å‚¨åœ¨å¯„å­˜å™¨25-26ä¸­ã€‚</font><font style="vertical-align: inherit;">æ›´æ¢ä¼ æ„Ÿå™¨æ—¶ï¼Œè¯·é‡ç½®ç›¸åº”çš„åœ°å€å¯„å­˜å™¨ã€‚</font><font style="vertical-align: inherit;">å½“æ£€æµ‹åˆ°æ–°ä¼ æ„Ÿå™¨æ—¶ï¼Œå°†æ£€æŸ¥å…¶åœ°å€æ˜¯å¦åœ¨å¯„å­˜å™¨25-26ä¸­ã€‚</font><font style="vertical-align: inherit;">å¦‚æœåœ°å€åœ¨è¡¨ä¸­ï¼Œåˆ™ä¼ æ„Ÿå™¨çš„æ¸©åº¦å€¼è¾“å…¥åˆ°ç›¸åº”çš„å¯„å­˜å™¨6-7ä¸­ã€‚</font><font style="vertical-align: inherit;">å¦‚æœè¯¥åœ°å€ä¸åœ¨è¡¨ä¸­ï¼Œå¹¶ä¸”è¯¥è¡¨å…·æœ‰é›¶ä¸ªå•å…ƒæ ¼ï¼Œåˆ™å°†å½“å‰ä¼ æ„Ÿå™¨åœ°å€å†™å…¥ç©ºé—²å•å…ƒæ ¼ä¸­ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç”¨æˆ·ä¿®æ”¹åçš„å¯„å­˜å™¨8-26å°†ä¿å­˜åœ¨EEPROMä¸­ã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è…ºä½“</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç¡¬ä»¶åŒ…æ‹¬ä»¥ä¸‹ç»„ä»¶ï¼š</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduino Proè¿·ä½ ç‰ˆã€‚ </font></font><div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><img src="https://habrastorage.org/files/e8a/460/33b/e8a46033b9cf45609d87e9a08f9f4ba9.png" alt="Arduino Pro Mini NEW"></div></div></li>
<li>NRF24L01+ â€”   2.4</li>
<li>LM1117-3.3 â€”  3.3  NRF24L01+</li>
<li>DS1302 â€” RTC</li>
<li> 32768  RTC</li>
<li>DS18B20 â€”  . 2</li>
<li> â€” , , </li>
</ol><br>
<br>
<img src="https://habrastorage.org/files/b4f/6f2/357/b4f6f2357e044c78a3472d4d6b25ad07.jpg"><br>
<img src="https://habrastorage.org/files/025/6de/902/0256de902fed444682fc2e16f3e9be88.jpg"><br>
<img src="https://habrastorage.org/files/e45/604/4aa/e456044aabe0499c9b8016d908411434.jpg"><br>
<img src="https://habrastorage.org/files/3f2/818/d9a/3f2818d9af814ffba67ed9e271c1450d.jpg"><br>
<img src="https://habrastorage.org/files/f76/385/124/f76385124e4e4c2ca573b268365f5e40.jpg"><br>
<img src="https://habrastorage.org/files/be6/ded/b3c/be6dedb3c93a40fe9841a17dead1b723.jpg"><br>
<img src="https://habrastorage.org/files/80a/50c/1b7/80a50c1b7e154c87ae07296e704d6674.jpg"><br>
<img src="https://habrastorage.org/files/a5b/f61/96e/a5bf6196ee764f90bf535df517477363.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é€šè¿‡å°†å…‰è€¦åˆå™¨è¿æ¥åˆ°ç›¸åº”çš„LEDæ¥å®ç°ç©ºè°ƒçš„åé¦ˆã€‚å› æ­¤ï¼Œç¡®ä¿äº†ä¸ç©ºè°ƒçš„ç”µè·¯çš„ç”µæµéš”ç¦»ã€‚é€šè¿‡ä½¿ç”¨ç”µé˜»å™¨å®éªŒæ€§åœ°é€‰æ‹©äº†å…‰è€¦åˆå™¨è¾“å…¥çš„ç”µæµï¼Œä»¥ä½¿å…‰è€¦åˆå™¨çš„è¾“å‡ºæ‰“å¼€ï¼Œå¹¶ä¸”ç©ºè°ƒä¸Šçš„ä¸»LEDçš„äº®åº¦ä¸ä¼šé™ä½ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨ç©ºè°ƒçš„çº¢å¤–æ¥æ”¶å™¨æ—è¾¹å®‰è£…äº†ä¸€ä¸ªçº¢å¤–LEDã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¯¥æ§åˆ¶å™¨ç”±æ¥è‡ªä¸­å›½å¥‡è¿¹çš„mini-USBå……ç”µä¾›ç”µã€‚ä»å……ç”µç›’ä¸­ç§»é™¤äº†ä¸­å›½å¸‚ç”µç”µå‹è§¦ç‚¹ï¼Œå¹¶ç§»é™¤äº†ç”µçº¿ã€‚å……ç”µæœ¬èº«è½åœ¨ç©ºè°ƒæœºå¤–å£³çš„è‚ é“å†…ï¼Œå¹¶ä¸è¾“å…¥ç«¯220å¹¶è”ã€‚æ§åˆ¶å™¨ä½¿ç”¨å¸¸è§„USB ABç”µç¼†è¿æ¥è‡³å……ç”µã€‚</font></font><br>
<br>
 Â«Â»    Arduino Mega2560  NRF24L01+   LM1117-3.3.    3.3     (    470*16)   .      2560  3.3       ,    .           . <br>
 2560       USB     10 .<br>
<br>
<h4>OpenHAB</h4><br>
  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Arduino &amp; OpenHAB</a>    Modbus Binding,     ,     ,     .      .<br>
<br>
<div class="spoiler"><b class="spoiler_title">  Modbus Binding</b><div class="spoiler_text">#<br>
modbus:serial.ac_hall_state.connection=/dev/ttyACM0:57600:8:none:1:rtu<br>
modbus:serial.ac_hall_state.id=1<br>
modbus:serial.ac_hall_state.start=48<br>
modbus:serial.ac_hall_state.length=5<br>
modbus:serial.ac_hall_state.type=discrete<br>
<br>
#<br>
modbus:serial.ac_hall_power.connection=/dev/ttyACM0:57600:8:none:1:rtu<br>
modbus:serial.ac_hall_power.id=1<br>
modbus:serial.ac_hall_power.start=56<br>
modbus:serial.ac_hall_power.length=4<br>
modbus:serial.ac_hall_power.type=coil<br>
<br>
#<br>
modbus:serial.ac_hall_rtc.connection=/dev/ttyACM0:57600:8:none:1:rtu<br>
modbus:serial.ac_hall_rtc.id=1<br>
modbus:serial.ac_hall_rtc.start=4<br>
modbus:serial.ac_hall_rtc.length=1<br>
modbus:serial.ac_hall_rtc.type=holding<br>
<br>
# <br>
modbus:serial.ac_hall_temperature.connection=/dev/ttyACM0:57600:8:none:1:rtu<br>
modbus:serial.ac_hall_temperature.id=1<br>
modbus:serial.ac_hall_temperature.start=6<br>
modbus:serial.ac_hall_temperature.length=2<br>
modbus:serial.ac_hall_temperature.type=holding<br>
modbus:serial.ac_hall_temperature.valuetype=int16<br>
<br>
#<br>
modbus:serial.ac_hall_mode.connection=/dev/ttyACM0:57600:8:none:1:rtu<br>
modbus:serial.ac_hall_mode.id=1<br>
modbus:serial.ac_hall_mode.start=8<br>
modbus:serial.ac_hall_mode.length=1<br>
modbus:serial.ac_hall_mode.type=holding<br>
<br>
# <br>
modbus:serial.ac_hall_temp.connection=/dev/ttyACM0:57600:8:none:1:rtu<br>
modbus:serial.ac_hall_temp.id=1<br>
modbus:serial.ac_hall_temp.start=9<br>
modbus:serial.ac_hall_temp.length=4<br>
modbus:serial.ac_hall_temp.type=holding<br>
<br>
# <br>
modbus:serial.ac_hall_fan.connection=/dev/ttyACM0:57600:8:none:1:rtu<br>
modbus:serial.ac_hall_fan.id=1<br>
modbus:serial.ac_hall_fan.start=13<br>
modbus:serial.ac_hall_fan.length=5<br>
modbus:serial.ac_hall_fan.type=holding<br>
<br>
#<br>
modbus:serial.ac_hall_swing.connection=/dev/ttyACM0:57600:8:none:1:rtu<br>
modbus:serial.ac_hall_swing.id=1<br>
modbus:serial.ac_hall_swing.start=18<br>
modbus:serial.ac_hall_swing.length=2<br>
modbus:serial.ac_hall_swing.type=holding<br>
<br>
#<br>
modbus:serial.ac_hall_timer.connection=/dev/ttyACM0:57600:8:none:1:rtu<br>
modbus:serial.ac_hall_timer.id=1<br>
modbus:serial.ac_hall_timer.start=320<br>
modbus:serial.ac_hall_timer.length=2<br>
modbus:serial.ac_hall_timer.type=coil<br>
<br>
# <br>
modbus:serial.ac_hall_timer_time.connection=/dev/ttyACM0:57600:8:none:1:rtu<br>
modbus:serial.ac_hall_timer_time.id=1<br>
modbus:serial.ac_hall_timer_time.start=21<br>
modbus:serial.ac_hall_timer_time.length=4<br>
modbus:serial.ac_hall_timer_time.type=holding<br>
<br>
#  DS18B20<br>
modbus:serial.ac_hall_ds18b20.connection=/dev/ttyACM0:57600:8:none:1:rtu<br>
modbus:serial.ac_hall_ds18b20.id=1<br>
modbus:serial.ac_hall_ds18b20.start=25<br>
modbus:serial.ac_hall_ds18b20.length=2<br>
modbus:serial.ac_hall_ds18b20.type=holding<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"> items</b><div class="spoiler_text"><pre>Contact AC_HALL_STATE_POWER             "AC_HALL_STATE_POWER [MAP(air_cond.map):%s]"    (){modbus="ac_hall_state:0"}<font></font>
Contact AC_HALL_STATE_OXYGEN            "AC_HALL_STATE_OXYGEN [MAP(air_cond.map):%s]"   (){modbus="ac_hall_state:1"}<font></font>
Contact AC_HALL_STATE_ION               "AC_HALL_STATE_ION [MAP(air_cond.map):%s]"      (){modbus="ac_hall_state:2"}<font></font>
Contact AC_HALL_STATE_QUIET             "AC_HALL_STATE_QUIET [MAP(air_cond.map):%s]"    (){modbus="ac_hall_state:3"}<font></font>
Contact AC_HALL_STATE_TIMER             "[MAP(air_cond.map):%s]"                  (){modbus="ac_hall_state:4"}<font></font>
<font></font>
Switch  AC_HALL_CONTROL_POWER           ""                   &lt;climate&gt;       (){modbus="ac_hall_power:0"}<font></font>
Switch  AC_HALL_CONTROL_OXYGEN          " O2"                                  (){modbus="ac_hall_power:1"}<font></font>
Switch  AC_HALL_CONTROL_ION             ""                                     (){modbus="ac_hall_power:2"}<font></font>
Switch  AC_HALL_CONTROL_QUIET           " "                                   (){modbus="ac_hall_power:3"}<font></font>
<font></font>
Number  AC_HALL_RTC                     "RTC[%x]"                                       (){modbus="ac_hall_rtc:0"}<font></font>
String  AC_HALL_RTC_S                   " [%s]"         &lt;clock&gt;         ()<font></font>
<font></font>
Group   gAC_HALL_TEMPERATURE            "Living Room temp"<font></font>
<font></font>
Number  AC_HALL_TEMPERATURE_ENV         "[%d]"                                   (){modbus="ac_hall_temperature:0"}<font></font>
Number  AC_HALL_TEMPERATURE_NOZ         "[%d]"                                     (){modbus="ac_hall_temperature:1"}<font></font>
Number  AC_HALL_TEMPERATURE_ENVF        " [%.2f Â°C]"     &lt;temperature&gt;           (gAC_HALL_TEMPERATURE)<font></font>
Number  AC_HALL_TEMPERATURE_NOZF        " [%.2f Â°C]"       &lt;temperature&gt;           (gAC_HALL_TEMPERATURE)<font></font>
<font></font>
Number  AC_HALL_DS18B20_ENV             "ENV[%x]"                                       (){modbus="ac_hall_ds18b20:0"}<font></font>
Number  AC_HALL_DS18B20_NOZ             "NOZZLES[%x]"                                   (){modbus="ac_hall_ds18b20:1"}<font></font>
<font></font>
Number  AC_HALL_MODE                    ""                                              (){modbus="ac_hall_mode:0"}<font></font>
<font></font>
Number  AC_HALL_TEMP_AUTO               "[%d Â°C]"    &lt;temperature&gt;           (){modbus="ac_hall_temp:0"}<font></font>
Number  AC_HALL_TEMP_COOL               "[%d Â°C]"    &lt;temperature&gt;           (){modbus="ac_hall_temp:1"}<font></font>
Number  AC_HALL_TEMP_HEAT               "[%d Â°C]"    &lt;temperature&gt;           (){modbus="ac_hall_temp:2"}<font></font>
Number  AC_HALL_TEMP_DRY                "[%d Â°C]"    &lt;temperature&gt;           (){modbus="ac_hall_temp:3"}<font></font>
<font></font>
Number  AC_HALL_FAN_AUTO                "[%d]"                                  (){modbus="ac_hall_fan:0"}<font></font>
Number  AC_HALL_FAN_COOL                "[%d]"                                  (){modbus="ac_hall_fan:1"}<font></font>
Number  AC_HALL_FAN_HEAT                "[%d]"                                  (){modbus="ac_hall_fan:2"}<font></font>
Number  AC_HALL_FAN_DRY                 "[%d]"                                  (){modbus="ac_hall_fan:3"}<font></font>
Number  AC_HALL_FAN_SPEED               "[%d]"                                  (){modbus="ac_hall_fan:4"}<font></font>
<font></font>
Number  AC_HALL_SWINGV                  ""                                              (){modbus="ac_hall_swing:0"}<font></font>
Number  AC_HALL_SWINGH                  ""                                              (){modbus="ac_hall_swing:1"}<font></font>
<font></font>
Switch  AC_HALL_TIMER_ON                " "              &lt;clock&gt;         (){modbus="ac_hall_timer:0"}<font></font>
Switch  AC_HALL_TIMER_OFF               " "             &lt;clock&gt;         (){modbus="ac_hall_timer:1"}<font></font>
<font></font>
Number  AC_HALL_TIME_ON_HR              "[%02d]"                                     (){modbus="ac_hall_timer_time:0"}<font></font>
Number  AC_HALL_TIME_ON_MI              "[%02d]"                                  (){modbus="ac_hall_timer_time:1"}<font></font>
Number  AC_HALL_TIME_OFF_HR             "[%02d]"                                     (){modbus="ac_hall_timer_time:2"}<font></font>
Number  AC_HALL_TIME_OFF_MI             "[%02d]"                                  (){modbus="ac_hall_timer_time:3"}<font></font>
</pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è§„åˆ™ç”¨äºå°†æ•´æ•°æ¸©åº¦è½¬æ¢ä¸ºå®é™…æ¸©åº¦ï¼Œä»¥åŠå°†æ§åˆ¶å™¨æ—¶é—´æ ¼å¼åŒ–ä¸ºHHï¼šMMæ ¼å¼ã€‚</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è§„åˆ™è®¾å®š</font></font></b><div class="spoiler_text"><pre>import org.openhab.core.library.types.*<font></font>
import org.openhab.core.persistence.*<font></font>
import org.openhab.model.script.actions.*<font></font>
import java.io.File<font></font>
<font></font>
rule "Update AC_HALL ENV temp"<font></font>
        when<font></font>
                Item AC_HALL_TEMPERATURE_ENV received update<font></font>
        then<font></font>
                var Number T = AC_HALL_TEMPERATURE_ENV.state as DecimalType<font></font>
                var Number H = T/100<font></font>
                postUpdate(AC_HALL_TEMPERATURE_ENVF, H)<font></font>
end<font></font>
rule "Update AC_HALL NOZZLES temp"<font></font>
        when<font></font>
                Item AC_HALL_TEMPERATURE_NOZ received update<font></font>
        then<font></font>
                var Number T = AC_HALL_TEMPERATURE_NOZ.state as DecimalType<font></font>
                var Number H = T/100<font></font>
                postUpdate(AC_HALL_TEMPERATURE_NOZF, H)<font></font>
end<font></font>
rule "Update AC_HALL_RTC clock"<font></font>
        when<font></font>
                Item AC_HALL_RTC received update<font></font>
        then<font></font>
                var Number T = AC_HALL_RTC.state as DecimalType<font></font>
                var H = T.intValue / 256<font></font>
                var M = T.intValue % 256<font></font>
                var S = String::format("%02x:%02x",H,M)<font></font>
                postUpdate(AC_HALL_RTC_S, S)<font></font>
end<font></font>
</pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç«™ç‚¹åœ°å›¾è®¾ç½®</font></font></b><div class="spoiler_text"><pre>sitemap demo label="Demo House"{<font></font>
        Frame label="HOME"{<font></font>
                Text label=" " icon="ac_cond"{<font></font>
                        Frame label="" {<font></font>
                                Switch item= AC_HALL_CONTROL_POWER labelcolor=[AC_HALL_STATE_POWER==OPEN="blue"]<font></font>
                                Switch item= AC_HALL_CONTROL_OXYGEN labelcolor=[AC_HALL_STATE_OXYGEN==OPEN="blue"]<font></font>
                                Switch item= AC_HALL_CONTROL_ION labelcolor=[AC_HALL_STATE_ION==OPEN="blue"]<font></font>
                                Switch item= AC_HALL_CONTROL_QUIET labelcolor=[AC_HALL_STATE_QUIET==OPEN="blue"]<font></font>
                                Text item=AC_HALL_STATE_TIMER labelcolor=[AC_HALL_STATE_TIMER==OPEN="blue"] icon="clock-on"<font></font>
                                Text item=AC_HALL_RTC_S<font></font>
                                Text item=AC_HALL_TEMPERATURE_ENVF<font></font>
                                Text item=AC_HALL_TEMPERATURE_NOZF<font></font>
                        }<font></font>
<font></font>
                        Frame label=""{<font></font>
                                Selection item=AC_HALL_MODE label="" mappings=[1=AUTO, 2=COOL, 4=HEAT, 8=DRY, 16=FAN]<font></font>
                                Text item=AC_HALL_TEMP_AUTO visibility=[AC_HALL_MODE==1]<font></font>
                                Text item=AC_HALL_TEMP_COOL visibility=[AC_HALL_MODE==2]<font></font>
                                Text item=AC_HALL_TEMP_HEAT visibility=[AC_HALL_MODE==4]<font></font>
                                Text item=AC_HALL_TEMP_DRY visibility=[AC_HALL_MODE==8]<font></font>
<font></font>
                                Text item=AC_HALL_FAN_AUTO visibility=[AC_HALL_MODE==1]<font></font>
                                Text item=AC_HALL_FAN_COOL visibility=[AC_HALL_MODE==2]<font></font>
                                Text item=AC_HALL_FAN_HEAT visibility=[AC_HALL_MODE==4]<font></font>
                                Text item=AC_HALL_FAN_DRY visibility=[AC_HALL_MODE==8]<font></font>
                                Text item=AC_HALL_FAN_SPEED visibility=[AC_HALL_MODE==16]<font></font>
<font></font>
                                Selection item=AC_HALL_SWINGV label="" mappings=[1=AUTO, 2="0Â°", 4="15Â°", 8="30Â°", 16="45Â°", 32="60Â°"]<font></font>
                                Selection item=AC_HALL_SWINGH label="" mappings=[1=AUTO, 4="/   /", 8="/   |", 2="|   |", 16="|   \\", 32="\\   \\"]<font></font>
<font></font>
                                Text label="" icon="settings"{<font></font>
                                        Frame label="AUTO"{<font></font>
                                                Setpoint item=AC_HALL_TEMP_AUTO minValue=16 maxValue=30 step=1<font></font>
                                                Switch   item=AC_HALL_FAN_AUTO mappings=[0=AUTO, 1="1", 2="2", 3="3", 4="4", 5="5"]<font></font>
                                        }<font></font>
                                        Frame label="COOL"{<font></font>
                                                Setpoint item=AC_HALL_TEMP_COOL minValue=16 maxValue=30 step=1<font></font>
                                                Switch   item=AC_HALL_FAN_COOL mappings=[0=AUTO, 1="1", 2="2", 3="3", 4="4", 5="5"]<font></font>
                                        }<font></font>
                                        Frame label="HEAT"{<font></font>
                                                Setpoint item=AC_HALL_TEMP_HEAT minValue=16 maxValue=30 step=1<font></font>
                                                Switch   item=AC_HALL_FAN_HEAT mappings=[0=AUTO, 1="1", 2="2", 3="3", 4="4", 5="5"]<font></font>
                                        }<font></font>
                                        Frame label="DRY"{<font></font>
                                                Setpoint item=AC_HALL_TEMP_DRY minValue=16 maxValue=30 step=1<font></font>
                                                Switch   item=AC_HALL_FAN_DRY mappings=[0=AUTO, 1="1", 2="2", 3="3", 4="4", 5="5"]<font></font>
                                        }<font></font>
                                        Frame label="FAN"{<font></font>
                                                Switch item=AC_HALL_FAN_SPEED mappings=[0=AUTO, 1="1", 2="2", 3="3", 4="4", 5="5"]<font></font>
                                        }<font></font>
                                        Frame label=""{<font></font>
                                                Text item=AC_HALL_DS18B20_ENV<font></font>
                                                Text item=AC_HALL_DS18B20_NOZ<font></font>
                                        }<font></font>
                                }<font></font>
                        }<font></font>
                        Frame label="" {<font></font>
                                Switch item= AC_HALL_TIMER_ON labelcolor=[AC_HALL_STATE_TIMER==OPEN="blue"]<font></font>
                                Setpoint item=AC_HALL_TIME_ON_HR minValue=0 maxValue=23 step=1<font></font>
                                Setpoint item=AC_HALL_TIME_ON_MI minValue=0 maxValue=50 step=5<font></font>
<font></font>
                                Switch item= AC_HALL_TIMER_OFF labelcolor=[AC_HALL_STATE_TIMER==OPEN="blue"]<font></font>
                                Setpoint item=AC_HALL_TIME_OFF_HR minValue=0 maxValue=23 step=1<font></font>
                                Setpoint item=AC_HALL_TIME_OFF_MI minValue=0 maxValue=50 step=5<font></font>
                        }<font></font>
                }<font></font>
                Text item=AC_HALL_RTC_S<font></font>
                Text item=AC_HALL_TEMPERATURE_ENVF{<font></font>
                        Frame label=" "{<font></font>
                                Chart item=gAC_HALL_TEMPERATURE period=h refresh=60000<font></font>
                        }<font></font>
                        Frame label=" 4 " {<font></font>
                                Chart item=gAC_HALL_TEMPERATURE period=4h refresh=600000<font></font>
                        }<font></font>
                }<font></font>
        }<font></font>
}<font></font>
</pre><br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç»“æœé€šè¿‡æµè§ˆå™¨çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</font></font><br>
<img align="left" src="https://habrastorage.org/files/5c0/129/0f3/5c01290f365b47399e9b16123c21f6fa.png"><img align="left" src="https://habrastorage.org/files/634/45b/94b/63445b94b4ab47349482b85667313e10.png"><img align="left" src="https://habrastorage.org/files/09c/8cb/8ff/09c8cb8ffb8240349ce57e8c7ccc6629.png"><br clear="all">
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç»“è®º</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½œä¸ºå¤§è±¡ï¼Œæˆ‘å¯¹ç»“æœæ„Ÿåˆ°æ»¡æ„ã€‚ç°åœ¨ï¼Œæ— è®ºæœ‰ç§»åŠ¨äº’è”ç½‘è¿˜æ˜¯WiFIï¼Œéƒ½å¯ä»¥ä½¿ç”¨ç©ºè°ƒæ§åˆ¶ã€‚ä½¿ç”¨æ™ºèƒ½æ‰‹æœºä¸Šçš„VPNå®¢æˆ·ç«¯ï¼Œæˆ‘å¯ä»¥é€šè¿‡æµè§ˆå™¨å’Œç§»åŠ¨åº”ç”¨ç¨‹åºè®¿é—®æˆ‘çš„å®¶åº­æœåŠ¡å™¨ä¸Šçš„OpenHABã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ— çº¿è§£å†³æ–¹æ¡ˆä½¿å°†æ§åˆ¶å™¨ä¸ç©ºè°ƒç´§å¯†é›†æˆæˆä¸ºå¯èƒ½ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åé¦ˆçš„å­˜åœ¨ä½¿æ‚¨ç¡®ä¿¡æ‰€å‘é€çš„å‘½ä»¤å·²è¢«ç©ºè°ƒæ¥æ”¶ï¼Œå¹¶ä¸”æ¸©åº¦ä¼ æ„Ÿå™¨æ¸…æ¥šåœ°è¡¨æ˜äº†è¿™ä¸€ç‚¹-å‡ ç§’é’Ÿåï¼Œæ‚¨å¯ä»¥è§‚å¯Ÿåˆ°ç©ºè°ƒå‡ºå£å¤„çš„æ¸©åº¦è¯»æ•°å˜åŒ–ã€‚å¥½å§ï¼Œå‡ åˆ†é’Ÿå-å’Œç¯å¢ƒæ¸©åº¦ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨æ¥è¿‘ç»™å®šæ¡ä»¶æ—¶è§‚å¯Ÿç©ºè°ƒçš„è½®å»“å¾ˆæœ‰è¶£ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¯«æ— ç–‘é—®ï¼Œè¿™å°†ä¸æ˜¯æˆ‘è®¡åˆ’ä½¿ç”¨çš„å”¯ä¸€æ— çº¿æ§åˆ¶å™¨ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ‰è®¡åˆ’ä½¿ç”¨ç©ºè°ƒæœ¬èº«çš„IRæ¥æ”¶å™¨è¯»å–æœ¬åœ°é¥æ§å™¨çš„å‘½ä»¤ä»¥æ›´æ–°æ§åˆ¶å™¨ä¸­çš„è®¾ç½®ã€‚</font><font style="vertical-align: inherit;">æ­¤å¤–ï¼ŒIRæ¥æ”¶å™¨æœ¬èº«å·²ç»é€šè¿‡å…‰è€¦åˆå™¨è¿æ¥åˆ°æ§åˆ¶å™¨ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€åé˜…è¯»ç‰¹åˆ«çš„è°¢è°¢ï¼</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‚è€ƒæ–‡çŒ®</font></font></h4><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduinoåº“ModbusRtu </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modbus-Master-Slave-for-Arduino</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduinoåº“ModbusRtuRF24 </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">-</font></a><font style="vertical-align: inherit;"> RF24ä¸Šçš„</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modbus-Arduinoç½‘ç»œ</font></font></a></li>
</ol></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN384243/">https://habr.com/ru/post/zh-CN384243/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN384229/index.html">é˜…è¯»åé€‚ç”¨ã€‚ä¸ºæ¸¸æˆå¼€å‘è€…å‡†å¤‡çš„25æœ¬ä¹¦</a></li>
<li><a href="../zh-CN384231/index.html">å¦‚æœæ²¡äººéœ€è¦å¤©ç„¶é“€ï¼Œé‚£ä¹ˆå¦‚ä½•è¿›è¡Œæµ“ç¼©å‘¢ï¼Ÿ</a></li>
<li><a href="../zh-CN384235/index.html">æ— äººæœºå°†åœ¨2020å¹´æ‰“å¼€ä¿„ç½—æ–¯çš„å¤©ç©º</a></li>
<li><a href="../zh-CN384239/index.html">å›é¡¾ã€Šæ˜Ÿçƒå¤§æˆ˜ã€‹çš„æœºå™¨äººSphero BB-8</a></li>
<li><a href="../zh-CN384241/index.html">Emercoinï¼šåŠ å¯†è´§å¸å’Œæ•°å­—å¯†é’¥åˆè€Œä¸ºä¸€</a></li>
<li><a href="../zh-CN384247/index.html">æ„è§ï¼šTwitterå…±äº«æµ‹è¯•è½¯ä»¶</a></li>
<li><a href="../zh-CN384249/index.html">ä¸€ç³»åˆ—æœ‰ç”¨çš„è®¾å¤‡ï¼š5ä¸ªåœ¨åŠå…¬å®¤æœ‰ç”¨çš„å°å·¥å…·</a></li>
<li><a href="../zh-CN384251/index.html">æœºå™¨äººå’Œäººã€‚ä»å†…å®¹åˆ°å½¢å¼</a></li>
<li><a href="../zh-CN384253/index.html">é•¿é¢ˆé¹¿ç¥ç»ç½‘ç»œå­¦ä¼šäº†åœ¨72å°æ—¶å†…ä»¥å›½é™…FIDEå¤§å¸ˆçš„æ°´å¹³ä¸‹æ£‹</a></li>
<li><a href="../zh-CN384257/index.html">é¤é¦†å¦‚ä½•åˆ›å»ºç½‘ç«™ï¼š4ç§è®¾è®¡è§£å†³æ–¹æ¡ˆ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>