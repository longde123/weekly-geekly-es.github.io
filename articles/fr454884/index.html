<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôÖüèª üôÜüèº üíû Nom de test lisible dans JS et le mod√®le comportemental üèáüèº ‚ÜñÔ∏è üç¢</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Lors du prochain examen d'une requ√™te Pull √©paisse, je suis tomb√© sur des tests unitaires avec un nom incorrect des cas de test. La discussion du libe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nom de test lisible dans JS et le mod√®le comportemental</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/454884/"><p>  Lors du prochain examen d'une requ√™te Pull √©paisse, je suis tomb√© sur des tests unitaires avec un nom incorrect des cas de test.  La discussion du libell√© dans les cas de test s'est av√©r√©e similaire √† la conversation entre Yanychar et Legkostupov dans le film "72 m√®tres" ("si c'√©tait si intelligible √† l'√©cole ...").  La conversation a sonn√© l'id√©e que dans les ressources en langue russe, il est difficile de trouver un guide explicatif pr√©cis√©ment par des libell√©s textuels.  J'ai d√©cid√© de me chercher en russe (en g√©n√©ral, j'utilise uniquement des sources anglophones).  On a trouv√© plusieurs manuels sur les tests unitaires, mais tous contournent les d√©tails des formulations dans les cas de test.  Sous la coupe, ma tentative de combler cette lacune. </p><a name="habracut"></a><br><h3 id="disklemer">  Disclamer </h3><br><p>  Il y a une chance que je regarde mal / je lis trop en diagonale.  Voici un exemple de la fa√ßon dont le sujet de cet article est couvert dans ces articles qui ont attir√© mon attention. </p><br><p><img src="https://habrastorage.org/webt/xj/85/eu/xj85eux2nk1lxg3fjcdxhbo-0_y.png"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">TDD pour d√©butants</a> </p><br><p> √Ä la demande de coll√®gues qui ne sont pas √† l'aise avec la lecture de manuels en anglais, j'ai d√©cid√© de traduire et de compiler des manuels en anglais. </p><br><h3 id="ot-perevodchika">  Du traducteur </h3><br><p>  J'ai pris ces deux mat√©riaux comme base de l'article: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">5 conseils pour r√©diger de grands tests unitaires Javascript</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Un guide pour les tests unitaires en JavaScript</a> </li></ul><br><p>  Je dois √©galement noter que dans certains exemples de test, j'ai d√ª faire une traduction partielle en russe.  Le libell√© dans les blocs ¬´d√©crivent¬ª reste intentionnellement en anglais,  avec une forte probabilit√©, ils contiendront le nom des fonctions, des modules JS ou d'autres entit√©s dans le code, mais dans les blocs ¬´it¬ª, le texte est d√©j√† traduit pour plus de lisibilit√©. </p><br><p>  <em>Ma pr√©f√©rence personnelle est que tout dans le code soit en anglais.</em> </p><br><h3 id="imenovanie-testov">  Tests de d√©nomination </h3><br><p>  Le nom du test doit d√©crire son objectif aussi bri√®vement et explicitement que possible.  Le nom et la description du test est la premi√®re chose qui devrait indiquer la cause du dysfonctionnement.  Le r√©sultat du test dans la console doit √™tre lu correctement en termes de grammaire.  Les d√©veloppeurs tiers ne devraient pas r√©soudre d'√©nigmes dans leur t√™te, essayant de deviner √† quoi pensait l'auteur du test.  Les tests font partie de la documentation du programme et doivent √©galement √™tre correctement √©crits. </p><br><p>  Exemple <strong>MAUVAIS</strong> : </p><br><pre><code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">'discoveryService =&gt; initDiscoveries'</span></span>, () =&gt; { it(<span class="hljs-string"><span class="hljs-string">' discoveries ( ,    ..)'</span></span>, () =&gt; { <span class="hljs-comment"><span class="hljs-comment">// ... }); }); describe('MyGallery', () =&gt; { it('init      ( , - )', () =&gt; { }); // ... });</span></span></code> </pre> <br><p>  √Ä partir des exemples ci-dessus, il est difficile de comprendre √† quelle (s) action (s) sp√©cifique (s) est-elle ex√©cut√©e et √† quel r√©sultat concret l'action doit conduire. </p><br><p>  <strong>BON</strong> exemple: </p><br><pre> <code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">'discoveryService =&gt; initDiscoveries'</span></span>, () =&gt; { it(<span class="hljs-string"><span class="hljs-string">'   discoveries'</span></span>, () =&gt; { <span class="hljs-comment"><span class="hljs-comment">// ... }); it('     discoveries', () =&gt; { // ... }); }); describe(' Gallery', () =&gt; { it('       ', () =&gt; { }); it('       ', () =&gt; { }); // ... });</span></span></code> </pre> <br><p>  <em>Remarque</em>  <em>perev.</em>  <em># 1: notez que le bloc de texte <strong>qu'il</strong> contient commence par une majuscule, comme</em>  <em>est une continuation de la phrase qui a commenc√© en <strong>descibe</strong> .</em> </p><br><p>  <em>Remarque</em>  <em>perev.</em>  <em># 2: dans les exemples ci-dessus, "discoveryService =&gt; initDiscoveries" est n√©anmoins plus correctement divis√© en deux blocs de <strong>description</strong> (l'un est imbriqu√© dans l'autre).</em> </p><br><p>  <em>Remarque</em>  <em>perev.</em>  <em># 3: notez que dans les exemples de d√©couverte ci-dessus, il n'y a pas de deuxi√®me partie de la description du cas de test;</em>  <em>elle implique un texte de la forme ¬´lors de son invocation¬ª, ce qui n'est pas tr√®s bon du point de vue de la manifestation;</em>  <em>dans les cas simples, le copier-coller "quand on l'appelle" n'est pas particuli√®rement rentable, √† mon humble avis.</em> </p><br><p>  Dans le bloc de description, une description du travail √©l√©mentaire (Unit√© de travail, UoW) est g√©n√©ralement plac√©e.  Le libell√© du bloc informatique doit continuer avec le mod√®le " <strong>unit√© d'oeuvre - sc√©nario / contexte - comportement attendu</strong> " qui a commenc√© dans la description: <br> <code>[ ]  [  / ]  (  | ) [     ]</code> </p> <br><p>  ou comme code: </p><br><pre> <code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">'[unit of work]'</span></span>, () =&gt; { it(<span class="hljs-string"><span class="hljs-string">' [ ] / [/]'</span></span>, () =&gt; { }); });</code> </pre> <br><p>  Si plusieurs groupes de tests suivent le m√™me script ou s'inscrivent dans le m√™me contexte, vous pouvez utiliser les blocs <strong>d√©crits</strong> imbriqu√©s. </p><br><pre> <code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">'[unit of work]'</span></span>, () =&gt; { describe(<span class="hljs-string"><span class="hljs-string">'// [scenario/context]'</span></span>, () =&gt; { it(<span class="hljs-string"><span class="hljs-string">'/ [expected behaviour]'</span></span>, () =&gt; { }); }); }); describe(<span class="hljs-string"><span class="hljs-string">' Gallery'</span></span>, () =&gt; { describe(<span class="hljs-string"><span class="hljs-string">' '</span></span>, () =&gt; { it(<span class="hljs-string"><span class="hljs-string">'    '</span></span>, () =&gt; { }); it(<span class="hljs-string"><span class="hljs-string">'    '</span></span>, () =&gt; { }); }); <span class="hljs-comment"><span class="hljs-comment">// ... });</span></span></code> </pre> <br><h3 id="odin-test---odna-problema">  UN TEST - UN PROBL√àME </h3><br><p>  Chaque test doit se concentrer sur un sc√©nario sp√©cifique dans l'application.  Le test, responsable d'un aspect sp√©cifique, est capable d'identifier la cause sp√©cifique du dysfonctionnement.  Plus le test est sp√©cifique, moins il est probable qu'il puisse y avoir plusieurs raisons √† un comportement incorrect.  Essayez de placer un seul bloc <strong>expect</strong> dans un bloc <strong>it</strong> . </p><br><p>  Exemple <strong>MAUVAIS</strong> : </p><br><pre> <code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">'isUndefined function'</span></span>, ()=&gt; { it(<span class="hljs-string"><span class="hljs-string">'  true or false    undefined'</span></span>, () =&gt; { expect(isUndefined(<span class="hljs-literal"><span class="hljs-literal">undefined</span></span>)).toEqual(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); expect(isUndefined(<span class="hljs-literal"><span class="hljs-literal">true</span></span>)).toEqual(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); }); });</code> </pre> <br><p>  Le bloc <strong>it</strong> contient deux blocs <strong>expect</strong> .  Cela signifie que le d√©veloppeur, voyant un r√©sultat n√©gatif de ce test, ne pourra pas d√©terminer exactement ce qui est incorrect dans son code et comment y rem√©dier. </p><br><p>  <strong>BON</strong> exemple: </p><br><pre> <code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">'isUndefined function'</span></span>, ()=&gt; { it(<span class="hljs-string"><span class="hljs-string">'  true,    undefined'</span></span>, () =&gt; { expect(isUndefined(<span class="hljs-literal"><span class="hljs-literal">undefined</span></span>)).toEqual(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); }); it(<span class="hljs-string"><span class="hljs-string">'  false      '</span></span>, () =&gt; { expect(isUndefined(<span class="hljs-literal"><span class="hljs-literal">true</span></span>)).toEqual(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); }); });</code> </pre> <br><p>  Chaque test de l'exemple ci-dessus √©value un probl√®me sp√©cifique.  De plus, la description du test d√©crit clairement dans quel cas elle sera r√©ussie.  Dans les deux cas, dans la console, le d√©veloppeur lira une liste des r√©sultats attendus dans quelles actions / conditions de la fonctionnalit√© utilisateur test√©e. </p><br><h3 id="testiruem-povedenie">  Tester le comportement </h3><br><p>  Regardez l'image, ne regardez pas les traits.  Testez le script / comportement personnalis√©, pas les d√©tails d'impl√©mentation.  La modification des d√©tails d'impl√©mentation n'affectera pas les r√©sultats du test.  Un r√©sultat de test n√©gatif doit indiquer si le programme se comporte correctement du point de vue de l'utilisateur.  Le test ne doit pas contr√¥ler / limiter les d√©tails d'impl√©mentation. </p><br><p>  Exemple <strong>MAUVAIS</strong> : </p><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">'   discovery  '</span></span>, () =&gt; { discoveriesCache.addDiscovery(<span class="hljs-string"><span class="hljs-string">'57463'</span></span>, <span class="hljs-string"><span class="hljs-string">'John'</span></span>); expect(discoveriesCache._discoveries[<span class="hljs-number"><span class="hljs-number">0</span></span>].id).toBe(<span class="hljs-string"><span class="hljs-string">'57463'</span></span>); expect(discoveriesCache._discoveries[<span class="hljs-number"><span class="hljs-number">0</span></span>].name).toBe(<span class="hljs-string"><span class="hljs-string">'John'</span></span>); });</code> </pre> <br><p>  Qu'est-ce qui est mauvais ici?  Tout d'abord, deux <strong>attendent des</strong> blocs, mais ce n'est pas l'essentiel.  Deuxi√®mement, ce n'est pas le comportement qui est test√©, mais les d√©tails de l'impl√©mentation.  Les d√©tails de l'impl√©mentation changeront (les champs priv√©s sont renomm√©s) - le test deviendra invalide et devra √™tre r√©√©crit. </p><br><p>  <strong>BON</strong> exemple: </p><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">'   discovery  '</span></span>, () =&gt; { discoveriesCache.addDiscovery(<span class="hljs-string"><span class="hljs-string">'57463'</span></span>, <span class="hljs-string"><span class="hljs-string">'John'</span></span>); expect(discoveriesCache.isDiscoveryExist(<span class="hljs-string"><span class="hljs-string">'57463'</span></span>, <span class="hljs-string"><span class="hljs-string">'John'</span></span>)).toBe(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); });</code> </pre> <br><p>  Cet exemple teste une API publique qui doit √™tre aussi stable que possible. </p><br><h3 id="zaklyuchenie-ot-perevodchika">  CONCLUSION D'UN TRADUCTEUR </h3><br><p>  "Onegin √©tait un p√©dant ..." J'ai l'impression que la plupart des d√©veloppeurs pr√™tent peu d'attention √† la pr√©cision et √† la lisibilit√© des noms de test.  Souvent, j'observe des discussions assez longues comme ¬´Que fait ce code¬ª ou ¬´Pourquoi ce code¬ª.  Cela s'applique √† la fois au code principal de JS (noms flous et flous des modules, services, fonctions et variables) et aux tests (cas flous, d√©tails de l'impl√©mentation des tests, descriptions floues).  Tout cela conduit au fait que le code ne correspond pas tout √† fait √† ce qui est attendu. </p><br><p>  Dans l'une de ses interviews, David Heinemeier Hansson (cr√©ateur du framework Rails) a dit quelque chose comme ceci: <br>  "Les tests unitaires montrent seulement que votre programme fait la chose attendue%: o." </p><br><p>  Il voulait dire que le comportement devait √™tre test√©, pas les unit√©s de code.  Et le langage textuel devrait avoir un mod√®le comportemental.  C'est-√†-dire  "L'entit√© A doit se comporter de telle ou telle mani√®re dans telle ou telle condition."  Une cha√Æne de la forme <strong>d√©crire</strong> [- <strong>d√©crire</strong> ] - <strong>elle</strong> - devrait - devrait se transformer en une telle formulation pliante. </p><br><p>  Merci de votre attention! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr454884/">https://habr.com/ru/post/fr454884/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr454872/index.html">Space Invaders: maintenant en 512 octets (assembleur x86)</a></li>
<li><a href="../fr454874/index.html">Un peu sur le multit√¢che dans les microcontr√¥leurs</a></li>
<li><a href="../fr454876/index.html">A propos de la conception d'un syst√®me flexible de capacit√©s de personnage dans les jeux</a></li>
<li><a href="../fr454878/index.html">Nous √©tudions MITRE ATT & CK. Matrices mobiles: acc√®s aux appareils. 3e partie</a></li>
<li><a href="../fr454880/index.html">¬´Hors saison¬ª dans la vie d'un pigiste: comment survivre et survivre?</a></li>
<li><a href="../fr454886/index.html">Assis dans le foie. Pourquoi l'ablation des tumeurs du foie est un indicateur de la comp√©tence sup√©rieure du chirurgien</a></li>
<li><a href="../fr454892/index.html">Moto. Mock aws</a></li>
<li><a href="../fr454894/index.html">WWDC 2019 :: Que voir</a></li>
<li><a href="../fr454896/index.html">Pourquoi j'ai chang√© d'ind√©pendant pour une √©quipe √† distance</a></li>
<li><a href="../fr454898/index.html">La programmation est plus que du codage</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>