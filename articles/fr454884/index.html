<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙅🏻 🙆🏼 💞 Nom de test lisible dans JS et le modèle comportemental 🏇🏼 ↖️ 🍢</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Lors du prochain examen d'une requête Pull épaisse, je suis tombé sur des tests unitaires avec un nom incorrect des cas de test. La discussion du libe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nom de test lisible dans JS et le modèle comportemental</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/454884/"><p>  Lors du prochain examen d'une requête Pull épaisse, je suis tombé sur des tests unitaires avec un nom incorrect des cas de test.  La discussion du libellé dans les cas de test s'est avérée similaire à la conversation entre Yanychar et Legkostupov dans le film "72 mètres" ("si c'était si intelligible à l'école ...").  La conversation a sonné l'idée que dans les ressources en langue russe, il est difficile de trouver un guide explicatif précisément par des libellés textuels.  J'ai décidé de me chercher en russe (en général, j'utilise uniquement des sources anglophones).  On a trouvé plusieurs manuels sur les tests unitaires, mais tous contournent les détails des formulations dans les cas de test.  Sous la coupe, ma tentative de combler cette lacune. </p><a name="habracut"></a><br><h3 id="disklemer">  Disclamer </h3><br><p>  Il y a une chance que je regarde mal / je lis trop en diagonale.  Voici un exemple de la façon dont le sujet de cet article est couvert dans ces articles qui ont attiré mon attention. </p><br><p><img src="https://habrastorage.org/webt/xj/85/eu/xj85eux2nk1lxg3fjcdxhbo-0_y.png"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">TDD pour débutants</a> </p><br><p> À la demande de collègues qui ne sont pas à l'aise avec la lecture de manuels en anglais, j'ai décidé de traduire et de compiler des manuels en anglais. </p><br><h3 id="ot-perevodchika">  Du traducteur </h3><br><p>  J'ai pris ces deux matériaux comme base de l'article: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">5 conseils pour rédiger de grands tests unitaires Javascript</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Un guide pour les tests unitaires en JavaScript</a> </li></ul><br><p>  Je dois également noter que dans certains exemples de test, j'ai dû faire une traduction partielle en russe.  Le libellé dans les blocs «décrivent» reste intentionnellement en anglais,  avec une forte probabilité, ils contiendront le nom des fonctions, des modules JS ou d'autres entités dans le code, mais dans les blocs «it», le texte est déjà traduit pour plus de lisibilité. </p><br><p>  <em>Ma préférence personnelle est que tout dans le code soit en anglais.</em> </p><br><h3 id="imenovanie-testov">  Tests de dénomination </h3><br><p>  Le nom du test doit décrire son objectif aussi brièvement et explicitement que possible.  Le nom et la description du test est la première chose qui devrait indiquer la cause du dysfonctionnement.  Le résultat du test dans la console doit être lu correctement en termes de grammaire.  Les développeurs tiers ne devraient pas résoudre d'énigmes dans leur tête, essayant de deviner à quoi pensait l'auteur du test.  Les tests font partie de la documentation du programme et doivent également être correctement écrits. </p><br><p>  Exemple <strong>MAUVAIS</strong> : </p><br><pre><code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">'discoveryService =&gt; initDiscoveries'</span></span>, () =&gt; { it(<span class="hljs-string"><span class="hljs-string">' discoveries ( ,    ..)'</span></span>, () =&gt; { <span class="hljs-comment"><span class="hljs-comment">// ... }); }); describe('MyGallery', () =&gt; { it('init      ( , - )', () =&gt; { }); // ... });</span></span></code> </pre> <br><p>  À partir des exemples ci-dessus, il est difficile de comprendre à quelle (s) action (s) spécifique (s) est-elle exécutée et à quel résultat concret l'action doit conduire. </p><br><p>  <strong>BON</strong> exemple: </p><br><pre> <code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">'discoveryService =&gt; initDiscoveries'</span></span>, () =&gt; { it(<span class="hljs-string"><span class="hljs-string">'   discoveries'</span></span>, () =&gt; { <span class="hljs-comment"><span class="hljs-comment">// ... }); it('     discoveries', () =&gt; { // ... }); }); describe(' Gallery', () =&gt; { it('       ', () =&gt; { }); it('       ', () =&gt; { }); // ... });</span></span></code> </pre> <br><p>  <em>Remarque</em>  <em>perev.</em>  <em># 1: notez que le bloc de texte <strong>qu'il</strong> contient commence par une majuscule, comme</em>  <em>est une continuation de la phrase qui a commencé en <strong>descibe</strong> .</em> </p><br><p>  <em>Remarque</em>  <em>perev.</em>  <em># 2: dans les exemples ci-dessus, "discoveryService =&gt; initDiscoveries" est néanmoins plus correctement divisé en deux blocs de <strong>description</strong> (l'un est imbriqué dans l'autre).</em> </p><br><p>  <em>Remarque</em>  <em>perev.</em>  <em># 3: notez que dans les exemples de découverte ci-dessus, il n'y a pas de deuxième partie de la description du cas de test;</em>  <em>elle implique un texte de la forme «lors de son invocation», ce qui n'est pas très bon du point de vue de la manifestation;</em>  <em>dans les cas simples, le copier-coller "quand on l'appelle" n'est pas particulièrement rentable, à mon humble avis.</em> </p><br><p>  Dans le bloc de description, une description du travail élémentaire (Unité de travail, UoW) est généralement placée.  Le libellé du bloc informatique doit continuer avec le modèle " <strong>unité d'oeuvre - scénario / contexte - comportement attendu</strong> " qui a commencé dans la description: <br> <code>[ ]  [  / ]  (  | ) [     ]</code> </p> <br><p>  ou comme code: </p><br><pre> <code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">'[unit of work]'</span></span>, () =&gt; { it(<span class="hljs-string"><span class="hljs-string">' [ ] / [/]'</span></span>, () =&gt; { }); });</code> </pre> <br><p>  Si plusieurs groupes de tests suivent le même script ou s'inscrivent dans le même contexte, vous pouvez utiliser les blocs <strong>décrits</strong> imbriqués. </p><br><pre> <code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">'[unit of work]'</span></span>, () =&gt; { describe(<span class="hljs-string"><span class="hljs-string">'// [scenario/context]'</span></span>, () =&gt; { it(<span class="hljs-string"><span class="hljs-string">'/ [expected behaviour]'</span></span>, () =&gt; { }); }); }); describe(<span class="hljs-string"><span class="hljs-string">' Gallery'</span></span>, () =&gt; { describe(<span class="hljs-string"><span class="hljs-string">' '</span></span>, () =&gt; { it(<span class="hljs-string"><span class="hljs-string">'    '</span></span>, () =&gt; { }); it(<span class="hljs-string"><span class="hljs-string">'    '</span></span>, () =&gt; { }); }); <span class="hljs-comment"><span class="hljs-comment">// ... });</span></span></code> </pre> <br><h3 id="odin-test---odna-problema">  UN TEST - UN PROBLÈME </h3><br><p>  Chaque test doit se concentrer sur un scénario spécifique dans l'application.  Le test, responsable d'un aspect spécifique, est capable d'identifier la cause spécifique du dysfonctionnement.  Plus le test est spécifique, moins il est probable qu'il puisse y avoir plusieurs raisons à un comportement incorrect.  Essayez de placer un seul bloc <strong>expect</strong> dans un bloc <strong>it</strong> . </p><br><p>  Exemple <strong>MAUVAIS</strong> : </p><br><pre> <code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">'isUndefined function'</span></span>, ()=&gt; { it(<span class="hljs-string"><span class="hljs-string">'  true or false    undefined'</span></span>, () =&gt; { expect(isUndefined(<span class="hljs-literal"><span class="hljs-literal">undefined</span></span>)).toEqual(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); expect(isUndefined(<span class="hljs-literal"><span class="hljs-literal">true</span></span>)).toEqual(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); }); });</code> </pre> <br><p>  Le bloc <strong>it</strong> contient deux blocs <strong>expect</strong> .  Cela signifie que le développeur, voyant un résultat négatif de ce test, ne pourra pas déterminer exactement ce qui est incorrect dans son code et comment y remédier. </p><br><p>  <strong>BON</strong> exemple: </p><br><pre> <code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">'isUndefined function'</span></span>, ()=&gt; { it(<span class="hljs-string"><span class="hljs-string">'  true,    undefined'</span></span>, () =&gt; { expect(isUndefined(<span class="hljs-literal"><span class="hljs-literal">undefined</span></span>)).toEqual(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); }); it(<span class="hljs-string"><span class="hljs-string">'  false      '</span></span>, () =&gt; { expect(isUndefined(<span class="hljs-literal"><span class="hljs-literal">true</span></span>)).toEqual(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); }); });</code> </pre> <br><p>  Chaque test de l'exemple ci-dessus évalue un problème spécifique.  De plus, la description du test décrit clairement dans quel cas elle sera réussie.  Dans les deux cas, dans la console, le développeur lira une liste des résultats attendus dans quelles actions / conditions de la fonctionnalité utilisateur testée. </p><br><h3 id="testiruem-povedenie">  Tester le comportement </h3><br><p>  Regardez l'image, ne regardez pas les traits.  Testez le script / comportement personnalisé, pas les détails d'implémentation.  La modification des détails d'implémentation n'affectera pas les résultats du test.  Un résultat de test négatif doit indiquer si le programme se comporte correctement du point de vue de l'utilisateur.  Le test ne doit pas contrôler / limiter les détails d'implémentation. </p><br><p>  Exemple <strong>MAUVAIS</strong> : </p><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">'   discovery  '</span></span>, () =&gt; { discoveriesCache.addDiscovery(<span class="hljs-string"><span class="hljs-string">'57463'</span></span>, <span class="hljs-string"><span class="hljs-string">'John'</span></span>); expect(discoveriesCache._discoveries[<span class="hljs-number"><span class="hljs-number">0</span></span>].id).toBe(<span class="hljs-string"><span class="hljs-string">'57463'</span></span>); expect(discoveriesCache._discoveries[<span class="hljs-number"><span class="hljs-number">0</span></span>].name).toBe(<span class="hljs-string"><span class="hljs-string">'John'</span></span>); });</code> </pre> <br><p>  Qu'est-ce qui est mauvais ici?  Tout d'abord, deux <strong>attendent des</strong> blocs, mais ce n'est pas l'essentiel.  Deuxièmement, ce n'est pas le comportement qui est testé, mais les détails de l'implémentation.  Les détails de l'implémentation changeront (les champs privés sont renommés) - le test deviendra invalide et devra être réécrit. </p><br><p>  <strong>BON</strong> exemple: </p><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">'   discovery  '</span></span>, () =&gt; { discoveriesCache.addDiscovery(<span class="hljs-string"><span class="hljs-string">'57463'</span></span>, <span class="hljs-string"><span class="hljs-string">'John'</span></span>); expect(discoveriesCache.isDiscoveryExist(<span class="hljs-string"><span class="hljs-string">'57463'</span></span>, <span class="hljs-string"><span class="hljs-string">'John'</span></span>)).toBe(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); });</code> </pre> <br><p>  Cet exemple teste une API publique qui doit être aussi stable que possible. </p><br><h3 id="zaklyuchenie-ot-perevodchika">  CONCLUSION D'UN TRADUCTEUR </h3><br><p>  "Onegin était un pédant ..." J'ai l'impression que la plupart des développeurs prêtent peu d'attention à la précision et à la lisibilité des noms de test.  Souvent, j'observe des discussions assez longues comme «Que fait ce code» ou «Pourquoi ce code».  Cela s'applique à la fois au code principal de JS (noms flous et flous des modules, services, fonctions et variables) et aux tests (cas flous, détails de l'implémentation des tests, descriptions floues).  Tout cela conduit au fait que le code ne correspond pas tout à fait à ce qui est attendu. </p><br><p>  Dans l'une de ses interviews, David Heinemeier Hansson (créateur du framework Rails) a dit quelque chose comme ceci: <br>  "Les tests unitaires montrent seulement que votre programme fait la chose attendue%: o." </p><br><p>  Il voulait dire que le comportement devait être testé, pas les unités de code.  Et le langage textuel devrait avoir un modèle comportemental.  C'est-à-dire  "L'entité A doit se comporter de telle ou telle manière dans telle ou telle condition."  Une chaîne de la forme <strong>décrire</strong> [- <strong>décrire</strong> ] - <strong>elle</strong> - devrait - devrait se transformer en une telle formulation pliante. </p><br><p>  Merci de votre attention! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr454884/">https://habr.com/ru/post/fr454884/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr454872/index.html">Space Invaders: maintenant en 512 octets (assembleur x86)</a></li>
<li><a href="../fr454874/index.html">Un peu sur le multitâche dans les microcontrôleurs</a></li>
<li><a href="../fr454876/index.html">A propos de la conception d'un système flexible de capacités de personnage dans les jeux</a></li>
<li><a href="../fr454878/index.html">Nous étudions MITRE ATT & CK. Matrices mobiles: accès aux appareils. 3e partie</a></li>
<li><a href="../fr454880/index.html">«Hors saison» dans la vie d'un pigiste: comment survivre et survivre?</a></li>
<li><a href="../fr454886/index.html">Assis dans le foie. Pourquoi l'ablation des tumeurs du foie est un indicateur de la compétence supérieure du chirurgien</a></li>
<li><a href="../fr454892/index.html">Moto. Mock aws</a></li>
<li><a href="../fr454894/index.html">WWDC 2019 :: Que voir</a></li>
<li><a href="../fr454896/index.html">Pourquoi j'ai changé d'indépendant pour une équipe à distance</a></li>
<li><a href="../fr454898/index.html">La programmation est plus que du codage</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>