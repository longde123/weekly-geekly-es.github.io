<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐จโ๐ ๐ฃ๏ธ ๐ ููุฏูุฉ ูุณูุงุณุงุช ุดุจูุฉ Kubernetes ููุชุฎุตุตู ุงูุฃูู ๐ ๐คฃ โ๏ธ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุชูุฑูุจุง. perev. : ูุคูู ุงูููุงู - ุฑููู ูุงุฑูุณูู - ูุฏูู ุฃูุซุฑ ูู 20 ุนุงููุง ูู ุงูุฎุจุฑุฉ ูู ูุฌุงู ุชุทููุฑ ุงูุจุฑูุฌูุงุช ุ ูุงูููู ูู ุงููุฏูุฑ ุงูุชููู ูุงููุคุณุณ ุงููุดุงุฑู ูุดุฑูุฉ ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ููุฏูุฉ ูุณูุงุณุงุช ุดุจูุฉ Kubernetes ููุชุฎุตุตู ุงูุฃูู</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/443190/" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/dt/ya/kp/dtyakpb8umg8hkfvtfcrll8kc9y.png"><br><br>  <i><b>ุชูุฑูุจุง.</b></i>  <i><b>perev.</b></i>  <i>: ูุคูู ุงูููุงู - ุฑููู ูุงุฑูุณูู - ูุฏูู ุฃูุซุฑ ูู 20 ุนุงููุง ูู ุงูุฎุจุฑุฉ ูู ูุฌุงู ุชุทููุฑ ุงูุจุฑูุฌูุงุช ุ ูุงูููู ูู ุงููุฏูุฑ ุงูุชููู ูุงููุคุณุณ ุงููุดุงุฑู ูุดุฑูุฉ Tufin ุ ููู ุงูุดุฑูุฉ ุงูุชู ุชูุดุฆ ุญููู ุฅุฏุงุฑุฉ ุงูุณูุงุณุฉ ุงูุฃูููุฉ.</i>  <i>ูุธุฑูุง ูุณูุงุณุงุช ุดุจูุฉ Kubernetes ูุฃุฏุงุฉ ูููุฉ ุจูุง ูููู ูุชุฌุฒุฆุฉ ุงูุดุจูุฉ ูู ูุชูุฉ ูุง ุ ูุฅูู ูุนุชูุฏ ุฃูู ููุณ ูู ุงูุณูู ุชุทุจูููุง ูู ุงูููุงุฑุณุฉ ุงูุนูููุฉ.</i>  <i>ุชู ุชุตููู ูุฐู ุงูููุงุฏ (ุถุฎูุฉ ุฌุฏูุง) ูุชุญุณูู ูุนุฑูุฉ ุงููุชุฎุตุตูู ูู ูุฐุง ุงูุฃูุฑ ููุณุงุนุฏุชูู ูู ุฅูุดุงุก ุงูุชููููุงุช ุงูุถุฑูุฑูุฉ.</i> <a name="habracut"></a><br><br>  ุงูููู ุ ุงูุนุฏูุฏ ูู ุงูุดุฑูุงุช ุชุฎุชุงุฑ ุจุดูู ูุชุฒุงูุฏ Kubernetes ูุชุดุบูู ุชุทุจููุงุชูุง.  ุงูุงูุชูุงู ุจูุฐุง ุงูุจุฑูุงูุฌ ูุฑุชูุน ูุฏุฑุฌุฉ ุฃู ุงูุจุนุถ ูุทูู ุนููู Kubernetes "ูุธุงู ุงูุชุดุบูู ุงูุฌุฏูุฏ ููุฑูุฒ ุงูุจูุงูุงุช".  ุจุงูุชุฏุฑูุฌ ุ ูุจุฏุฃ ุงููุธุฑ ุฅูู Kubernetes (ุฃู k8s) ูุฌุฒุก ุฃุณุงุณู ูู ุงูุนูู ุ ุงูุฃูุฑ ุงูุฐู ูุชุทูุจ ุชูุธูู ุนูููุงุช ุงูุฃุนูุงู ุงููุงุถุฌุฉ ุ ุจูุง ูู ุฐูู ุฃูุงู ุงูุดุจูุฉ. <br><br>  ุจุงููุณุจุฉ ูููุชุฎุตุตูู ูู ูุฌุงู ุงูุฃูู ุงูุฐูู ูุดุนุฑูู ุจุงูุญูุฑุฉ ูู ุฎูุงู ุงูุนูู ูุน Kubernetes ุ ูุฏ ุชููู ุงูุณูุงุณุฉ ุงูุงูุชุฑุงุถูุฉ ููุฐุง ุงููุธุงู ุงูุฃุณุงุณู ุงูุชุดุงููุง ุญูููููุง: ุงุณูุญ ููุฌููุน. <br><br>  ุณูุณุงุนุฏู ูุฐุง ุงูุฏููู ุนูู ููู ุงูุจููุฉ ุงูุฏุงุฎููุฉ ูุณูุงุณุงุช ุงูุดุจูุฉ ุ  ููู ููู ุชุฎุชูู ุนู ููุงุนุฏ ุฌุฏุฑุงู ุงูุญูุงูุฉ ุงูุนุงุฏูุฉ.  ุณูุชู ุฃูุถูุง ูุตู ุจุนุถ ุงููุฒุงูู ูุณูุชู ุชูุฏูู ุชูุตูุงุช ุชุณุงุนุฏ ุนูู ุญูุงูุฉ ุงูุชุทุจููุงุช ูู Kubernetes. <br><br><h2 style=";text-align:right;direction:rtl">  ุณูุงุณุงุช ุดุจูุฉ Kubernetes </h2><br>  ุชุชูุญ ูู ุขููุฉ ุณูุงุณุฉ ุดุจูุฉ Kubernetes ุงูุชุญูู ูู ุชูุงุนู ุงูุชุทุจููุงุช ุงูููุดูุฑุฉ ุนูู ุงููุธุงู ุงูุฃุณุงุณู ุนูู ูุณุชูู ุงูุดุจูุฉ (ุงูุซุงูุซ ูู ูููุฐุฌ OSI).  ุชูุชูุฑ ุณูุงุณุงุช ุงูุดุจูุฉ ุฅูู ุจุนุถ ุงูููุฒุงุช ุงููุชูุฏูุฉ ููุฌุฏุฑุงู ุงููุงุฑูุฉ ุงูุญุฏูุซุฉ ุ ูุซู ูุฑุงูุจุฉ OSI ุงููุณุชูู 7 ูุงูุชุดุงู ุงูุชูุฏูุฏุงุช ุ ูููููุง ุชููุฑ ูุณุชูู ุฃุณุงุณููุง ูู ุฃูุงู ุงูุดุจูุฉ ุ ูุงูุฐู ูุนุฏ ููุทุฉ ุงูุทูุงู ุฌูุฏุฉ. <br><br><h2 style=";text-align:right;direction:rtl">  ุชุชุญูู ุณูุงุณุงุช ุงูุดุจูุฉ ูู ุงูุงุชุตุงูุงุช ุจูู ุงููุฑูู </h2><br>  ูุชู ุชูุฒูุน ุฃุญูุงู ุนูู Kubernetes ุนุจุฑ ุงููุฑูู ุงูุชู ุชุชููู ูู ุญุงููุฉ ูุงุญุฏุฉ ุฃู ุฃูุซุฑ ูุชู ูุดุฑูุง ูุนูุง.  Kubernetes ูุนูู ูู ุฌุฑุงุจ ุนููุงู IP ูููู ุงููุตูู ุฅูููุง ูู ุงููุฑูู ุงูุฃุฎุฑู.  ุชุญุฏุฏ ุณูุงุณุงุช ุดุจูุฉ Kubernetes ุฃุฐููุงุช ููุฌููุนุงุช pod ุจููุณ ุทุฑููุฉ ุงุณุชุฎุฏุงู ูุฌููุนุงุช ุงูุฃูุงู ูู ุงูุณุญุงุจุฉ ููุชุญูู ูู ุงููุตูู ุฅูู ูุซููุงุช ุงูุฌูุงุฒ ุงูุธุงูุฑู. <br><br><h2 style=";text-align:right;direction:rtl">  ุชุญุฏูุฏ ุณูุงุณุงุช ุงูุดุจูุฉ </h2><br>  ูุซู ููุงุฑุฏ Kubernetes ุงูุฃุฎุฑู ุ ูุชู ุชุนููู ุณูุงุณุงุช ุงูุดุจูุฉ ูู YAML.  ูู ุงููุซุงู ุฃุฏูุงู ุ ูุชู ููุญ <code>balance</code> ุญู ุงููุตูู ุฅูู <code>postgres</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: default.postgres namespace: default spec: podSelector: matchLabels: app: postgres ingress: - from: - podSelector: matchLabels: app: balance policyTypes: - Ingress</code> </pre> <br><img src="https://habrastorage.org/webt/ee/d3/wf/eed3wfhzcdtuhobly7r3wdhyvhk.png"><br><br>  <i>( <b>ููุงุญุธุฉ</b> : ูู ูุชู ุฅูุดุงุก ููุทุฉ ุงูุดุงุดุฉ ูุฐู ุ ูุซู ุฌููุน ุงูููุทุงุช ุงููุดุงุจูุฉ ุงููุงุญูุฉ ุ ุจุงุณุชุฎุฏุงู ุฃุฏูุงุช Kubernetes ุงูุฃุตููุฉ ุ ูููู ุจุงุณุชุฎุฏุงู ุฃุฏุงุฉ Tufin Orca ุ ุงูุชู ุทูุฑูุง ูุคูู ุงูููุงู ุงูุฃุตูู ูุฐูุฑุช ูู ููุงูุฉ ุงูููุงู.)</i> <br><br>  ุณูุชุทูุจ ุชุญุฏูุฏ ุณูุงุณุฉ ุงูุดุจูุฉ ุงูุฎุงุตุฉ ุจู ูุนุฑูุฉ YAML ุงูุฃุณุงุณูุฉ.  ุชุนุชูุฏ ูุฐู ุงููุบุฉ ุนูู ุงููุณุงูุฉ ุงูุจุงุฏุฆุฉ (ุงูุชู ุชุญุฏุฏูุง ุงููุณุงูุงุช ูููุณ ุนูุงูุงุช ุงูุชุจููุจ).  ููุชูู ุนูุตุฑ ุงููุณุงูุฉ ุงูุจุงุฏุฆุฉ ุฅูู ุฃูุฑุจ ุนูุตุฑ ูุณุงูุฉ ุจุงุฏุฆุฉ ูููู.  ูุจุฏุฃ ุนูุตุฑ ูุงุฆูุฉ ุฌุฏูุฏ ุจูุตู ุ ููู ุงูุนูุงุตุฑ ุงูุฃุฎุฑู <i>ุฐุงุช ูููุฉ ููุงุชูุญ</i> . <br><br>  ุจุนุฏ ูุตู ุงูุณูุงุณุฉ ูู YAML ุ ุงุณุชุฎุฏู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">kubectl</a> ูุฅูุดุงุฆูุง ูู ุงููุชูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubectl create -f policy.yaml</code> </pre> <br><h2 style=";text-align:right;direction:rtl">  ููุงุตูุงุช ุณูุงุณุฉ ุงูุดุจูุฉ </h2><br>  ุชุชุถูู ููุงุตูุงุช ุณูุงุณุฉ ุดุจูุฉ Kubernetes ุฃุฑุจุนุฉ ุนูุงุตุฑ: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>podSelector</code> : ูุญุฏุฏ ุงููุฑูู ุงููุชุฃุซุฑุฉ ุจูุฐู ุงูุณูุงุณุฉ (ุงูุฃูุฏุงู) - ุฅูุฒุงูู ุ </li><li style=";text-align:right;direction:rtl">  <code>policyTypes</code> : ูุดูุฑ ุฅูู ุฃููุงุน ุงูุณูุงุณุงุช ุงููุถููุฉ ูู ูุฐุง: ุงูุฏุฎูู ู / ุฃู ุงูุฎุฑูุฌ - ุงุฎุชูุงุฑู ุ ููุน ุฐูู ุ ุฃูุตู ุจุฃู ุชููู ุจุชุณุฌูููุง ุจูุถูุญ ูู ุฌููุน ุงูุญุงูุงุช ุ </li><li style=";text-align:right;direction:rtl">  <code>ingress</code> : ูุญุฏุฏ <b>ุญุฑูุฉ</b> ุงููุฑูุฑ <b>ุงููุงุฑุฏุฉ</b> ุงููุณููุญ ุจูุง ุฅูู ุงูุณููุงุช ุงููุณุชูุฏูุฉ - ุงุฎุชูุงุฑู ุ </li><li style=";text-align:right;direction:rtl">  <code>egress</code> : ูุญุฏุฏ ุญุฑูุฉ ุงููุฑูุฑ <b>ุงูุตุงุฏุฑุฉ</b> ุงููุณููุญ ุจูุง ูู ุงูุณููุงุช ุงููุณุชูุฏูุฉ - ุงุฎุชูุงุฑู. </li></ol><br>  ูุซุงู ูุณุชุนุงุฑ ูู ูููุน Kubernetes (ููุช ุจุงุณุชุจุฏุงู <code>role</code> <code>app</code> ) ููุถุญ ููููุฉ ุงุณุชุฎุฏุงู ุงูุนูุงุตุฑ ุงูุฃุฑุจุนุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: test-network-policy namespace: default spec: podSelector: # &lt;&lt;&lt; matchLabels: app: db policyTypes: # &lt;&lt;&lt; - Ingress - Egress ingress: # &lt;&lt;&lt; - from: - ipBlock: cidr: 172.17.0.0/16 except: - 172.17.1.0/24 - namespaceSelector: matchLabels: project: myproject - podSelector: matchLabels: role: frontend ports: - protocol: TCP port: 6379 egress: # &lt;&lt;&lt; - to: - ipBlock: cidr: 10.0.0.0/24 ports: - protocol: TCP port: 5978</code> </pre> <br><img src="https://habrastorage.org/webt/ln/sa/ni/lnsanisggaar5tf3lbda8njxaau.png"><br><img src="https://habrastorage.org/webt/bo/re/in/borein4ll_4hoovj6vdhlo_zfee.png"><br><br>  ูุฑุฌู ููุงุญุธุฉ ุฃู ุฌููุน ุงูุนูุงุตุฑ ุงูุฃุฑุจุนุฉ ุงุฎุชูุงุฑูุฉ.  <code>podSelector</code> ููุท ุ ูููู ุงุณุชุฎุฏุงู ุงููุนููุงุช ุงูุฃุฎุฑู ุญุณุจ ุงูุฑุบุจุฉ. <br><br>  ุฅุฐุง ุญุฐูุช <code>policyTypes</code> ุ ูุณูุชู ุชูุณูุฑ ุงูุณูุงุณุฉ ุนูู ุงููุญู ุงูุชุงูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุจุดูู ุงูุชุฑุงุถู ุ ูู ุงูููุชุฑุถ ุฃูู ูุญุฏุฏ ุฌุงูุจ ุงูุฏุฎูู.  ุฅุฐุง ูุงูุช ุงูุณูุงุณุฉ ูุง ุชุดูุฑ ุฅูู ุฐูู ุตุฑุงุญุฉ ุ ูุณูุฑู ุงููุธุงู ุฃู ูู ุญุฑูุฉ ุงููุฑูุฑ ูุญุธูุฑุฉ. </li><li style=";text-align:right;direction:rtl">  ุณูุชู ุชุญุฏูุฏ ุงูุณููู ุนูู ุฌุงูุจ ุงูุฎุฑูุฌ ูู ุฎูุงู ูุฌูุฏ ุฃู ุนุฏู ูุฌูุฏ ูุนููุฉ ุงูุฎุฑูุฌ ุงูููุงุจูุฉ. </li></ul><br>  ูุชุฌูุจ ุงูุฃุฎุทุงุก ุ ุฃูุตู <b>ุฏุงุฆููุง ุจุชุญุฏูุฏ <code>policyTypes</code> ุจุดูู ุตุฑูุญ</b> . <br><br>  ููููุง ููููุทู ุฃุนูุงู ุ ุฅุฐุง ุชู ุญุฐู <code>egress</code> <code>ingress</code> ู / ุฃู <code>egress</code> ุ ูุณุชุญุธุฑ ุงูุณูุงุณุฉ ูู ุญุฑูุฉ ุงููุฑูุฑ (ุงูุธุฑ "ูุงุนุฏุฉ ุงูุชุฌุฑูุฏ" ุฃุฏูุงู). <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุณูุงุณุฉ ุงูุงูุชุฑุงุถูุฉ ูู ุงูุณูุงุญ </h2><br>  ุฅุฐุง ูู ูุชู ุชุญุฏูุฏ ุณูุงุณุงุช ุ ูุฅู Kubernetes ุจุดูู ุงูุชุฑุงุถู ูุณูุญ ููู ุญุฑูุฉ ุงููุฑูุฑ.  ุฌููุน ุงููุฑูู ุฃุญุฑุงุฑ ูู ุชุจุงุฏู ุงููุนูููุงุช ูุน ุจุนุถูุง ุงูุจุนุถ.  ูู ูุฌูุฉ ูุธุฑ ุงูุฃูุงู ุ ูุฏ ูุจุฏู ูุฐุง ุบูุฑ ุจุฏููู ุ ูููู ุชุฐูุฑ ุฃู Kubernetes ุชู ุฅูุดุงุคู ูู ุงูุฃุตู ูู ูุจู ุงููุทูุฑูู ูุถูุงู ุงูุชุดุบูู ุงููุชุฏุงุฎู ููุชุทุจูู.  ุชู ุฅุถุงูุฉ ุณูุงุณุงุช ุงูุดุจูุฉ ูุงุญููุง. <br><br><h2 style=";text-align:right;direction:rtl">  ูุณุงุญุงุช ุงูุฃุณูุงุก </h2><br>  ูุณุงุญุงุช ุงูุฃุณูุงุก ูู ุขููุฉ ุชุนุงูููุฉ ูู Kubernetes.  ููู ูุตููุฉ ูุนุฒู ุงูุจูุฆุงุช ุงูููุทููุฉ ุนู ุจุนุถูุง ุงูุจุนุถ ุ ุจูููุง ููุณูุญ ุจุชุจุงุฏู ุงูุจูุงูุงุช ุจูู ุงููุณุงูุงุช ุงูุชุฑุงุถููุง. <br><br>  ูุซู ูุนุธู ููููุงุช Kubernetes ุ ุชูุฌุฏ ุณูุงุณุงุช ุงูุดุจูุฉ ูู ูุณุงุญุฉ ุงุณู ูุญุฏุฏุฉ.  ูู ูุชูุฉ <code>metadata</code> ุงูุฃูููุฉ ุ ููููู ุชุญุฏูุฏ ุงููุณุงุญุฉ ุงูุชู ุชูุชูู ุฅูููุง ุงูุณูุงุณุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: test-network-policy namespace: my-namespace # &lt;&lt;&lt; spec: ...</code> </pre> <br>  ุฅุฐุง ูู ุชุชู ูุชุงุจุฉ ูุณุงุญุฉ ุงูุงุณู ุจุดูู ูุงุถุญ ูู ุงูุจูุงูุงุช ุงูุฃูููุฉ ุ ูุณูุณุชุฎุฏู ุงููุธุงู ูุณุงุญุฉ ุงูุงุณู ุงููุญุฏุฏุฉ ูู kubectl (ุญุณุจ <code>namespace=default</code> ): <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubectl apply -n my-namespace -f namespace.yaml</code> </pre> <br>  ุฃูุตู <b>ุจุชุญุฏูุฏ ูุณุงุญุฉ ุงุณู ุตุฑุงุญุฉ</b> ูุง ูู ุชูู ุชูุชุจ ุณูุงุณุฉ ูุฎุตุตุฉ ููุณุงุญุงุช ุฃุณูุงุก ูุชุนุฏุฏุฉ ูุฑุฉ ูุงุญุฏุฉ. <br><br>  <code>podSelector</code> ุนูุตุฑ <code>podSelector</code> <b>ุงูุฑุฆูุณู</b> ูู ุงูุณูุงุณุฉ pods ูู ูุณุงุญุฉ ุงูุงุณู ุงูุชู ุชูุชูู ุฅูููุง ุงูุณูุงุณุฉ (ุชู ุฑูุถ ุงููุตูู ุฅูู pods ูู ูุณุงุญุฉ ุงุณู ุฃุฎุฑู). <br><br>  ูุจุงููุซู ุ ูุง ุชุณุชุทูุน podSelectors <b>ูู ูุชู ุงูุฏุฎูู ูุงูุฎุฑูุฌ</b> ุชุญุฏูุฏ pods ููุท ูู ูุณุงุญุฉ ุงูุงุณู ุงูุฎุงุตุฉ ุจูุง ุ ุฅูุง ุฅุฐุง ููุช ุ ุจุงูุทุจุน ุ ุจุฏูุฌูุง ูุน <code>namespaceSelector</code> (ุณุชุชู ููุงูุดุชูุง ูู ุงููุณู "ุชุตููุฉ ุญุณุจ ูุณุงุญุฉ ุงูุงุณู" ู "pods") . <br><br><h2 style=";text-align:right;direction:rtl">  ููุงุนุฏ ุชุณููุฉ ุงูุณูุงุณุฉ </h2><br>  ุฃุณูุงุก ุงูุณูุงุณุฉ ูุฑูุฏุฉ ูู ูุณุงุญุฉ ุงุณู ูุงุญุฏุฉ.  ูุง ูููู ุฃู ูููู ููุงู ุณูุงุณุชุงู ุจููุณ ุงูุงุณู ูู ูุณุงูุฉ ูุงุญุฏุฉ ุ ูููู ูููู ุฃู ูููู ููุงู ุณูุงุณุงุช ุจููุณ ุงูุงุณู ูู ูุณุงูุงุช ูุฎุชููุฉ.  ูููู ูุฐุง ูููุฏูุง ุนูุฏูุง ุชุฑูุฏ ุฅุนุงุฏุฉ ุชุทุจูู ููุณ ุงูุณูุงุณุฉ ุนุจุฑ ูุณุงูุงุช ูุชุนุฏุฏุฉ. <br><br>  ุฃูุง ูุง ุณููุง ุฃุญุจ ุทุฑููุฉ ูุงุญุฏุฉ ููุชุณููุฉ.  ูุชููู ูู ุฏูุฌ ุงุณู ูุณุงุญุฉ ุงูุงุณู ูุน ุงูุณููุงุช ุงููุณุชูุฏูุฉ.  ุนูู ุณุจูู ุงููุซุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: default.postgres # &lt;&lt;&lt; namespace: default spec: podSelector: matchLabels: app: postgres ingress: - from: - podSelector: matchLabels: app: admin policyTypes: - Ingress</code> </pre> <br><img src="https://habrastorage.org/webt/pp/rf/6a/pprf6aa0w2bysbuw6_-lbt926mi.png"><br><br><h2 style=";text-align:right;direction:rtl">  ุงูุชุณููุงุช </h2><br>  ูููู ุฅุฑูุงู ุงูููุตูุงุช ุงููุฎุตุตุฉ ุจูุงุฆูุงุช Kubernetes ุ ูุซู ุงููุฑูู ููุณุงุญุงุช ุงูุฃุณูุงุก.  ุงูุชุณููุงุช ูู ูุง ูุนุงุฏู ุงูุนูุงูุงุช ูู ุงูุณุญุงุจุฉ.  ุชุณุชุฎุฏู ุณูุงุณุงุช ุดุจูุฉ Kubernetes ุงูุชุตูููุงุช ูุชุญุฏูุฏ ุงูุฃููุงุฏ ุงูุชู ุชูุทุจู ุนูููุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">podSelector: matchLabels: role: db</code> </pre> <br>  ... ุฃู <b>ูุณุงุญุงุช ุงูุฃุณูุงุก</b> ุงูุชู ุชูุทุจู ุนูููุง.  ูู ูุฐุง ุงููุซุงู ุ ูุชู ุชุญุฏูุฏ ุฌููุน ุงููุฑูู ูู ูุณุงุญุงุช ุงูุฃุณูุงุก ูุน ุงูููุตูุงุช ุฐุงุช ุงูุตูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">namespaceSelector: matchLabels: project: myproject</code> </pre> <br>  ุชุญุฐูุฑ ูุงุญุฏ: ุนูุฏ ุงุณุชุฎุฏุงู <code>namespaceSelector</code> <b>ุชุฃูุฏ ูู ุฃู</b> <code>namespaceSelector</code> <b>ุงูุชู ุชุญุฏุฏูุง ุชุญุชูู ุนูู ุงูุชุณููุฉ ุงูุชู ุชุฑูุฏูุง</b> .  ุถุน ูู ุงุนุชุจุงุฑู ุฃู ูุณุงุญุงุช ุงูุฃุณูุงุก ุงููุฏูุฌุฉ ูุซู <code>default</code> ููุธุงู <code>kube-system</code> ูุง ุชุญุชูู ุนูู ุชุณููุงุช ุจุดูู ุงูุชุฑุงุถู. <br><br>  ููููู ุฅุถุงูุฉ ุชุณููุฉ ุฅูู ุงููุถุงุก ููุง ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubectl label namespace default namespace=default</code> </pre> <br>  ูู ูุฐู ุงูุญุงูุฉ ุ ูุฌุจ ุฃู ุชุดูุฑ ูุณุงุญุฉ ุงูุงุณู ูู ูุณู <code>metadata</code> ุงูุฃูููุฉ ุฅูู ุงูุงุณู ุงููุนูู ูููุณุงุญุฉ ุ ูููุณ ุฅูู ุงูุชุณููุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: test-network-policy namespace: default # &lt;&lt;&lt; spec: ...</code> </pre> <br><h2 style=";text-align:right;direction:rtl">  ุงููุตุฏุฑ ูุงููุฌูุฉ </h2><br>  ุชุชููู ุณูุงุณุงุช ุฌุฏุฑุงู ุงูุญูุงูุฉ ูู ููุงุนุฏ ูุน ูุตุงุฏุฑ ููุฌูุงุช.  ูุชู ุชุญุฏูุฏ ุณูุงุณุงุช ุดุจูุฉ Kubernetes ููุฐุง ุงูุบุฑุถ - ูุฌููุนุฉ ูู ุงูุฃููุงุฏ ุงูุชู ูุชู ุชุทุจูููุง ุนูููุง ุ ุซู ุชุถุน ููุงุนุฏ ูุญุฑูุฉ ุงููุฑูุฑ ุงููุงุฑุฏุฉ (ุฏุฎูู) ู / ุฃู ุงูุตุงุฏุฑุฉ (ุงูุฎุฑูุฌ).  ูู ูุซุงููุง ุ ุณูููู ุงููุฏู ูู ุงูุณูุงุณุฉ ูู ุฌููุน ุงูุจุฑุงูุฌ ูู ูุณุงุญุฉ ุงูุงุณู <code>default</code> ูุน ุชุณููุฉ ููุง ููุชุงุญ <code>app</code> ููููุฉ <code>db</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: test-network-policy namespace: default spec: podSelector: matchLabels: app: db # &lt;&lt;&lt; policyTypes: - Ingress - Egress ingress: - from: - ipBlock: cidr: 172.17.0.0/16 except: - 172.17.1.0/24 - namespaceSelector: matchLabels: project: myproject - podSelector: matchLabels: role: frontend ports: - protocol: TCP port: 6379 egress: - to: - ipBlock: cidr: 10.0.0.0/24 ports: - protocol: TCP port: 5978</code> </pre> <br><img src="https://habrastorage.org/webt/zd/un/wi/zdunwi6xxqfdkvd7tj0qqpmjxly.png"><br><img src="https://habrastorage.org/webt/se/dj/wp/sedjwp5-arw7sxn7hm4dblgqhku.png"><br><br>  ููุชุญ ุงููุณู ุงููุฑุนู <code>ingress</code> ูู ูุฐู ุงูุณูุงุณุฉ ุญุฑูุฉ ุงููุฑูุฑ ุงููุงุฑุฏุฉ ุฅูู ุงูุณููุงุช ุงููุณุชูุฏูุฉ.  ูุจุนุจุงุฑุฉ ุฃุฎุฑู ุ ุงูุฏุฎูู ูู ุงููุตุฏุฑ ุ ูุงููุฏู ูู ุงููุณุชูู ุงูููุงุณุจ.  ูุจุงููุซู ุ ุงูุฎุฑูุฌ ูู ุงููุฏู ุ ูุงููุฏู ูู ูุตุฏุฑู. <br><br><img src="https://habrastorage.org/webt/rs/nf/u9/rsnfu97eapuetrrhbwejb-awnas.png"><br><br>  <i>ูุฐุง ูุนุงุฏู ูุงุนุฏุชูู ูุฌุฏุงุฑ ุงูุญูุงูุฉ: Ingress โ Targetุ</i>  <i>ุงููุฏู โ ุงูุฎุฑูุฌ.</i> <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุฎุฑูุฌ ู DNS (ููู!) </h2><br>  ุนูุฏ ุงูุญุฏ ูู ุญุฑูุฉ ุงููุฑูุฑ ุงูุตุงุฏุฑุฉ ุ <b>ุงูุชุจู ุจุดูู ุฎุงุต ุฅูู DNS</b> - ูุณุชุฎุฏู Kubernetes ูุฐู ุงูุฎุฏูุฉ ูุชุนููู ุฎุฏูุงุช ูุนูุงููู IP.  ุนูู ุณุจูู ุงููุซุงู ุ ูู ุชุนูู ุงูุณูุงุณุฉ ุงูุชุงููุฉ ูุฃูู ูู ุชุณูุญ ูุชุทุจูู <code>balance</code> ุจุงููุตูู ุฅูู DNS: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: default.balance namespace: default spec: podSelector: matchLabels: app: balance egress: - to: - podSelector: matchLabels: app: postgres policyTypes: - Egress</code> </pre> <br><img src="https://habrastorage.org/webt/6w/dy/jf/6wdyjftwhfiynlxrx22vivumtli.png"><br><br>  ููููู ุฅุตูุงุญู ุนู ุทุฑูู ูุชุญ ุงููุตูู ุฅูู ุฎุฏูุฉ DNS: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: default.balance namespace: default spec: podSelector: matchLabels: app: balance egress: - to: - podSelector: matchLabels: app: postgres - to: # &lt;&lt;&lt; ports: # &lt;&lt;&lt; - protocol: UDP # &lt;&lt;&lt; port: 53 # &lt;&lt;&lt; policyTypes: - Egress</code> </pre> <br><img src="https://habrastorage.org/webt/z4/np/5m/z4np5m-afkmcbkqlgoxufjgc4fm.png"><br><br>  ุขุฎุฑ ุนูุตุฑ ูุงุฑุบ ุ ูุจุงูุชุงูู ูุฅูู ูุฎุชุงุฑ ุจุดูู ุบูุฑ ูุจุงุดุฑ <b>ุฌููุน ุงููุฑูู ูู ุฌููุน ูุณุงุญุงุช ุงูุฃุณูุงุก</b> ุ ููุง ูุณูุญ <code>balance</code> ุจุฅุฑุณุงู ุงุณุชุนูุงูุงุช DNS ุฅูู ุฎุฏูุฉ Kubernetes ุงูููุงุจูุฉ (ุชุนูู ุนุงุฏุฉู ูู ูุณุงุญุฉ <code>kube-system</code> ). <br><br>  ูุนูู ูุฐุง ุงูููุฌ ุ ูููู <b>ูุชุณุงูู ููุบุงูุฉ ูุบูุฑ ุขูู</b> ุ ูุฃูู ูุณูุญ ูู ุจุชูุฌูู ุงุณุชุนูุงูุงุช DNS ุฎุงุฑุฌ ุงููุฌููุนุฉ. <br><br>  ููููู ุชุญุณููู ูู ุซูุงุซ ุฎุทูุงุช ูุชุชุงููุฉ. <br><br>  1. ุงูุณูุงุญ ุจุงุณุชุนูุงูุงุช DNS ููุท <b>ุฏุงุฎู</b> ุงููุชูุฉ ุนู ุทุฑูู ุฅุถุงูุฉ <code>namespaceSelector</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: default.balance namespace: default spec: podSelector: matchLabels: app: balance egress: - to: - podSelector: matchLabels: app: postgres - to: - namespaceSelector: {} # &lt;&lt;&lt; ports: - protocol: UDP port: 53 policyTypes: - Egress</code> </pre> <br><img src="https://habrastorage.org/webt/a1/hk/8v/a1hk8vmrton9izmj1jwhxtz-q1e.png"><br><br>  2. ุงูุณูุงุญ ุจุงุณุชุนูุงูุงุช DNS ููุท ูู ูุณุงุญุฉ ุงุณู <code>kube-system</code> . <br><br>  ููููุงู ุจุฐูู ุ ุฃุถู ุชุณููุฉ ุฅูู <code>kubectl label namespace kube-system namespace=kube-system</code> <code>kube-system</code> : <code>kubectl label namespace kube-system namespace=kube-system</code> - ููู ุจุชุณุฌูููุง ูู ุงูุณูุงุณุฉ ุจุงุณุชุฎุฏุงู <code>namespaceSelector</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: default.balance namespace: default spec: podSelector: matchLabels: app: balance egress: - to: - podSelector: matchLabels: app: postgres - to: - namespaceSelector: # &lt;&lt;&lt; matchLabels: # &lt;&lt;&lt; namespace: kube-system # &lt;&lt;&lt; ports: - protocol: UDP port: 53 policyTypes: - Egress</code> </pre> <br><img src="https://habrastorage.org/webt/q6/e2/ed/q6e2edqwfz63nbamlvk2v5zpjhy.png"><br><br>  3. ูููู ููุฌููู ุงูุนุธูุฉ ุฃู ุชุฐูุจ ุฃุจุนุฏ ูู ุฐูู ูุชูุชุตุฑ ุงุณุชุนูุงูุงุช DNS ุนูู ุฎุฏูุฉ DNS ูุญุฏุฏุฉ ูู <code>kube-system</code> .  ูู ูุณู "ุงูุชุตููุฉ ุญุณุจ ูุณุงุญุงุช ุงูุฃุณูุงุก ูุงููุฑูู" ุ ุณูุดุฑุญ ููููุฉ ุชุญููู ุฐูู. <br><br>  ุฎูุงุฑ ุขุฎุฑ ูู ุญู DNS ุนูู ูุณุชูู ูุณุงุญุฉ ุงูุงุณู.  ูู ูุฐู ุงูุญุงูุฉ ุ ูู ุชุญุชุงุฌ ุฅูู ูุชุญ ููู ุฎุฏูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: default.dns namespace: default spec: podSelector: {} # &lt;&lt;&lt; egress: - to: - namespaceSelector: {} ports: - protocol: UDP port: 53 policyTypes: - Egress</code> </pre> <br>  ุชุญุฏูุฏ <code>podSelector</code> ูุงุฑุบุฉ ูุงูุฉ pods ูู ูุณุงุญุฉ ุงูุงุณู. <br><br><img src="https://habrastorage.org/webt/ua/hn/7t/uahn7tgfus08_yt1u-rsilqoi90.png"><br><br><h2 style=";text-align:right;direction:rtl">  ุงููุจุงุฑุงุฉ ุงูุฃููู ูุชุฑุชูุจ ุงููุงุนุฏุฉ </h2><br>  ูู ุฌุฏุฑุงู ุงูุญูุงูุฉ ุงูุนุงุฏูุฉ ุ ูุชู ุชุญุฏูุฏ ุงูุฅุฌุฑุงุก ("ุงูุณูุงุญ" ุฃู "ุงูุฑูุถ") ูุญุฒูุฉ ูุง ุจููุฌุจ ุงููุงุนุฏุฉ ุงูุฃููู ุงูุชู ุชุฑุถููุง.  <b>ูู Kubernetes ุ ุชุฑุชูุจ ุงูุณูุงุณุงุช ุบูุฑ ุฐู ุตูุฉ.</b> <br><br>  ุงูุชุฑุงุถููุง ุ ุนูุฏูุง ูุง ูุชู ุชุนููู ุงูุณูุงุณุงุช ุ ููุณูุญ ุจุงูุงุชุตุงู ุจูู ุงูุณููุงุช ููููููุง ุชุจุงุฏู ุงููุนูููุงุช ุจุญุฑูุฉ.  ุจูุฌุฑุฏ ุงูุจุฏุก ูู ุตูุงุบุฉ ุงูุณูุงุณุงุช ุ ูุตุจุญ ูู ูุฑูุฉ ุชุชุฃุซุฑ ุจูุงุญุฏุฉ ูููุง ุนูู ุงูุฃูู ูุนุฒููุฉ ููููุง ูููุตู (ุงูููุทูู ุฃู) ูุฌููุน ุงูุณูุงุณุงุช ุงูุชู ุงุฎุชุงุฑุชูุง.  ุงููุฑูู ูุง ุชุชุฃุซุฑ ุจุฃู ุณูุงุณุฉ ุชุจูู ููุชูุญุฉ. <br><br>  ููููู ุชุบููุฑ ูุฐุง ุงูุณููู ุจุงุณุชุฎุฏุงู ูุงุนุฏุฉ ุชุฌุฑูุฏ. <br><br><h2 style=";text-align:right;direction:rtl">  ูุงุนุฏุฉ ุชุฌุฑูุฏ (ุฑูุถ) </h2><br>  ุชุญุธุฑ ุณูุงุณุงุช ุฌุฏุงุฑ ุงูุญูุงูุฉ ุนููููุง ุฃู ุญุฑูุฉ ูุฑูุฑ ุบูุฑ ูุตุฑุญ ุจูุง ุตุฑุงุญุฉ. <br><br>  <b>ููุณ ูุฏู Kubernetes ุฅุฌุฑุงุก ุฑูุถ</b> ุ ููุน ุฐูู ุ ูููู ุชุญููู ุชุฃุซูุฑ ููุงุซู ุจุงุณุชุฎุฏุงู ุณูุงุณุฉ (ุงูุณูุงุญ) ููุชุธูุฉ ูู ุฎูุงู ุชุญุฏูุฏ ูุฌููุนุฉ ูุงุฑุบุฉ ูู ุงูุณููุงุช ุงููุตุฏุฑ (ุงูุฏุฎูู): <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: deny-all namespace: default spec: podSelector: {} policyTypes: - Ingress</code> </pre> <br><img src="https://habrastorage.org/webt/65/-s/au/65-sauxptvceaqgedw9xvsadlso.png"><br><br>  ุชุญุฏุฏ ูุฐู ุงูุณูุงุณุฉ ุฌููุน ุงููุฑูู ูู ูุณุงุญุฉ ุงูุงุณู ูุชุชุฑู ุงูุฏุฎูู ุบูุฑ ูุญุฏุฏ ุ ููุง ูุญุธุฑ ูู ุญุฑูุฉ ุงููุฑูุฑ ุงููุงุฑุฏุฉ. <br><br>  ูุจุงููุซู ุ ููููู ุชูููุฏ ูู ุญุฑูุฉ ุงููุฑูุฑ ุงูุตุงุฏุฑุฉ ูู ูุณุงุญุฉ ุงูุงุณู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: deny-all-egress namespace: default spec: podSelector: {} policyTypes: - Egress</code> </pre> <br><img src="https://habrastorage.org/webt/bn/fg/vq/bnfgvqcfwsgaj-jyompezzmhz6q.png"><br><br>  ูุงุญุธ ุฃู <b>ุฃู ุณูุงุณุงุช ุฅุถุงููุฉ ุชุณูุญ ูุญุฑูุฉ ุงููุฑูุฑ ุจูุฑุงุฑุงุช ูู ูุณุงุญุฉ ุงูุงุณู ุณุชููู ููุง ุงูุฃุณุจููุฉ ุนูู ูุฐู ุงููุงุนุฏุฉ</b> (ุนูู ุบุฑุงุฑ ุฅุถุงูุฉ ูุงุนุฏุฉ ุงูุณูุงุญ ุนูู ูุงุนุฏุฉ ุงูุฑูุถ ูู ุชูููู ุฌุฏุงุฑ ุงูุญูุงูุฉ). <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุณูุงุญ ููุฌููุน (ุฃู - ุฃู - ุฃู - ุณูุงุญ) </h2><br>  ูุฅูุดุงุก ุณูุงุณุฉ ุงูุณูุงุญ ูููู ุ ูุฌุจ ุนููู ุฅุถุงูุฉ ุณูุงุณุฉ ุงูุญุธุฑ ุฃุนูุงู ูุน ูุฌูุฏ ุนูุตุฑ ูุงุฑุบ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: allow-all namespace: default spec: podSelector: {} ingress: # &lt;&lt;&lt; - {} # &lt;&lt;&lt; policyTypes: - Ingress</code> </pre> <br><img src="https://habrastorage.org/webt/bl/x6/ed/blx6edy0ez8h-yrkil5vb0yeb5g.png"><br><br>  ูุณูุญ ุจุงููุตูู ูู <b>ุฌููุน ุงูุจุฑุงูุฌ ูู ุฌููุน ูุณุงุญุงุช ุงูุฃุณูุงุก (ูุฌููุน ุนูุงููู IP) ุฅูู ุฃู ูููุงุช ูู ูุณุงุญุฉ ุงูุงุณู <code>default</code></b> .  ูุชู ุชูููู ูุฐุง ุงูุณููู ุงูุชุฑุงุถููุง ุ ูุฐูู ุนุงุฏุฉ ูุง ูุญุชุงุฌ ุฅูู ุชุนุฑูู ุฅุถุงูู.  ููุน ุฐูู ุ ูู ุจุนุถ ุงูุฃุญูุงู ูุฏ ูููู ูู ุงูุถุฑูุฑู ุชุนุทูู ุจุนุถ ุงูุฃุฐููุงุช ุงููุญุฏุฏุฉ ูุคูุชูุง ูุชุดุฎูุต ุงููุดููุฉ. <br><br>  ูููู ุชุถููู ุงููุงุนุฏุฉ ูุงูุณูุงุญ ุจุงููุตูู ููุท ุฅูู ูุฌููุนุฉ <b>ูุนููุฉ ูู ุงููุฑูู</b> ( <code>app:balance</code> ) ูู ูุณุงุญุฉ ุงูุงุณู <code>default</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: allow-all-to-balance namespace: default spec: podSelector: matchLabels: app: balance ingress: - {} policyTypes: - Ingress</code> </pre> <br><img src="https://habrastorage.org/webt/ji/jn/ki/jijnkiy1fzkligxx9b2okk8arm8.png"><br><br>  ุชุณูุญ ุงูุณูุงุณุฉ ุงูุชุงููุฉ ููู ุญุฑูุฉ ูุฑูุฑ ุงูุฏุฎูู ูุงูุฎุฑูุฌ ุ ุจูุง ูู ุฐูู ุงููุตูู ุฅูู ุฃู IP ุฎุงุฑุฌ ุงููุชูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: allow-all spec: podSelector: {} ingress: - {} egress: - {} policyTypes: - Ingress - Egress</code> </pre> <br><img src="https://habrastorage.org/webt/yx/eq/c4/yxeqc4hamtqwvirrodsrym7y4iy.png"><br><img src="https://habrastorage.org/webt/bi/nu/ob/binuob-mafzfz6w_r-2fmdseu2c.png"><br><br><h2 style=";text-align:right;direction:rtl">  ุงูุฌูุน ุจูู ุณูุงุณุงุช ูุชุนุฏุฏุฉ </h2><br>  ูุชู ุงูุฌูุน ุจูู ุงูุณูุงุณุงุช ุจุงุณุชุฎุฏุงู OR ุงูููุทูู ุนูู ุซูุงุซุฉ ูุณุชููุงุช ุ  ูุชู ุชุนููู ุฃุฐููุงุช ูู ุฌุฑุงุจ ููููุง ููุตู ุฌููุน ุงูุณูุงุณุงุช ุงูุชู ุชุคุซุฑ ุนููู: <br><br>  1. ูู ุงูุญููู <code>from</code> ูุฅูู ุงูุญูู ุ ููููู ุชุญุฏูุฏ ุซูุงุซุฉ ุฃููุงุน ูู ุงูุนูุงุตุฑ (ูุชู ุฏูุฌ ูู ูููุง ุจุงุณุชุฎุฏุงู OR): <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>namespaceSelector</code> - ุชุญุฏูุฏ ูุณุงุญุฉ ุงูุงุณู ุจุงููุงูู ุ </li><li style=";text-align:right;direction:rtl">  <code>podSelector</code> - ูุฎุชุงุฑ ุงููุฑูู. </li><li style=";text-align:right;direction:rtl">  <code>ipBlock</code> - ูุฎุชุงุฑ ุดุจูุฉ ูุฑุนูุฉ. </li></ul><br>  ูู ุงูููุช ููุณู ุ ูุง ููุชุตุฑ ุนุฏุฏ ุงูุนูุงุตุฑ (ุญุชู ููุณูุง) ูู ุงููุณู ุงููุฑุนู <code>from</code> / <code>to</code> .  ุณูุชู ุฏูุฌ ูู ูููู ุจูุงุณุทุฉ OR ุงูููุทููุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: default.postgres namespace: default spec: ingress: - from: - podSelector: matchLabels: app: indexer - podSelector: matchLabels: app: admin podSelector: matchLabels: app: postgres policyTypes: - Ingress</code> </pre> <br><img src="https://habrastorage.org/webt/_y/pu/xy/_ypuxynlq6wslkjk65yyj5_zwsi.png"><br><br>  2. ุฏุงุฎู ุงูุณูุงุณุฉ ุ ูููู ุฃู ูุญุชูู ูุณู <code>ingress</code> ุนูู ุงูุนุฏูุฏ <code>from</code> ุงูุนูุงุตุฑ (ูุฏูุฌุฉ ุจูุงุณุทุฉ OR ุงูููุทูู).  ูุจุงููุซู ุ ูููู ุฃู ูุดุชูู ูุณู <code>egress</code> ุนูู ุงูุนุฏูุฏ ูู ุงูุนูุงุตุฑ (ูุฑุชุจุท ุฃูุถูุง ุจููุฑุฉ): <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: default.postgres namespace: default spec: ingress: - from: - podSelector: matchLabels: app: indexer - from: - podSelector: matchLabels: app: admin podSelector: matchLabels: app: postgres policyTypes: - Ingress</code> </pre> <br><img src="https://habrastorage.org/webt/4t/-l/f9/4t-lf9a8fm1f4whkitifyhgyfee.png"><br><br>  3. ูุชู ุงูุฌูุน ุจูู ุงูุณูุงุณุงุช ุงููุฎุชููุฉ ุฃูุถูุง ุนู ุทุฑูู ุงูููุทู ุงูููุทูู <br><br>  ูููู ุนูุฏ ุงูุฌูุน ุจููููุง ุ ููุงู ูููุฏ ูุงุญุฏุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃุดุงุฑ ุฅูููุง</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฑูุณ ูููู</a> : Kubernetes ูุง ูููููุง ุฅูุง ุงูุฌูุน ุจูู ุงูุณูุงุณุงุช ูุน ุฃููุงุน ุงูุณูุงุณุงุช ุงููุฎุชููุฉ ( <code>Ingress</code> ุฃู <code>policyTypes</code> ).  ุงูุณูุงุณุงุช ุงูุชู ุชุญุฏุฏ ุงูุฏุฎูู (ุฃู ุงูุฎุฑูุฌ) ุณุชุญู ูุญู ุจุนุถูุง ุงูุจุนุถ. <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุนูุงูุฉ ุจูู ูุณุงุญุงุช ุงูุฃุณูุงุก </h2><br>  ุงูุชุฑุงุถููุง ุ ููุณูุญ ุจุชุจุงุฏู ุงููุนูููุงุช ุจูู ูุณุงุญุงุช ุงูุฃุณูุงุก.  ูููู ุชุบููุฑ ูุฐุง ุจุงุณุชุฎุฏุงู ุณูุงุณุฉ ูุญุธูุฑุฉ ุชููุฏ ุญุฑูุฉ ุงููุฑูุฑ ุงูุตุงุฏุฑุฉ ู / ุฃู ุงููุงุฑุฏุฉ ุฅูู ูุณุงุญุฉ ุงูุงุณู (ุงูุธุฑ "ูุงุนุฏุฉ ุชุฌุฑูุฏ" ุฃุนูุงู). <br><br>  ุจููุน ุงููุตูู ุฅูู ูุณุงุญุฉ ุงูุงุณู (ุงูุธุฑ "ูุงุนุฏุฉ ุงูุชุนุฑูุฉ" ุฃุนูุงู) ุ ููููู ุฅุฌุฑุงุก ุงุณุชุซูุงุกุงุช ููุณูุงุณุฉ ุงูุชูููุฏูุฉ ูู ุฎูุงู ุงูุณูุงุญ ุจุงูุงุชุตุงูุงุช ูู ูุณุงุญุฉ ุงุณู ูุนููุฉ ุจุงุณุชุฎุฏุงู <code>namespaceSelector</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: database.postgres namespace: database spec: podSelector: matchLabels: app: postgres ingress: - from: - namespaceSelector: # &lt;&lt;&lt; matchLabels: namespace: default policyTypes: - Ingress</code> </pre> <br><img src="https://habrastorage.org/webt/gh/-0/ed/gh-0edsyfhl5st5_8nngwadmoai.png"><br><br>  ูุชูุฌุฉู ูุฐูู ุ ุณูููู ูุฌููุน ุงููุฑูู ูู ูุณุงุญุฉ ุงูุงุณู <code>default</code> ุญู ุงููุตูู ุฅูู ูุฑูู <code>postgres</code> ูู ูุณุงุญุฉ ุงุณู <code>database</code> .  ูููู ูุงุฐุง ูู ููุช ุชุฑูุฏ ูุชุญ ุงููุตูู ุฅูู <code>postgres</code> ููุท <code>postgres</code> ูุนููุฉ ูู ูุณุงุญุฉ ุงูุงุณู <code>default</code> ุ <br><br><h2 style=";text-align:right;direction:rtl">  ุชุตููุฉ ุญุณุจ ูุณุงุญุงุช ุงูุฃุณูุงุก ูุงููุฑูู </h2><br>  ูุณูุญ ูู ุงูุฅุตุฏุงุฑ 1.11 ูู Kubernetes ูุงูุฅุตุฏุงุฑุงุช ุงูุฃุญุฏุซ ุจุชุฌููุน <code>namespaceSelector</code> ูููุดุบูู <code>podSelector</code> ุจุงุณุชุฎุฏุงู ุงูููุทูู ุงูุฃูู. ูุจุฏู ููุง ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: database.postgres namespace: database spec: podSelector: matchLabels: app: postgres ingress: - from: - namespaceSelector: matchLabels: namespace: default podSelector: # &lt;&lt;&lt; matchLabels: app: admin policyTypes: - Ingress</code> </pre> <br><img src="https://habrastorage.org/webt/47/_b/op/47_bopr6mjii5-qkujgiwgs2bku.png"><br><br>  ููุงุฐุง ูุชู ุชูุณูุฑู ูู AND ุจุฏูุงู ูู OR ุงููุนุชุงุฏุ <br><br>  ูุงุญุธ ุฃู <code>podSelector</code> ูุง ูุจุฏุฃ <code>podSelector</code> .  ูู YAML ุ ูุฐุง ูุนูู ุฃู <code>podSelector</code> <code>namespaceSelector</code> ุฃูุงูู ุชุดูุฑ ุฅูู ุนูุตุฑ ุงููุงุฆูุฉ ููุณู.  ูุฐูู ุ ูุชู ุฏูุฌูุง ุจูุงุณุทุฉ ุงูููุทููุฉ ุงูุฃููู. <br><br>  <code>podSelector</code> ุฅุถุงูุฉ ูุงุตูุฉ ุฃูุงู <code>podSelector</code> ุฅูู ุนูุตุฑ ูุงุฆูุฉ ุฌุฏูุฏ ุณูุชู ุฏูุฌู ูุน <code>namespaceSelector</code> ุงูุณุงุจูุฉ ุงููุญุฏุฏุฉ ุจุงุณุชุฎุฏุงู OR ููุทูู. <br><br>  ูุชุญุฏูุฏ ุญุงูุธุงุช ูุน ุชุณููุฉ ูุญุฏุฏุฉ <b>ูู ุฌููุน ูุณุงุญุงุช ุงูุฃุณูุงุก</b> ุ ุฃุฏุฎู <code>namespaceSelector</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: database.postgres namespace: database spec: podSelector: matchLabels: app: postgres ingress: - from: - namespaceSelector: {} podSelector: matchLabels: app: admin policyTypes: - Ingress</code> </pre> <br><img src="https://habrastorage.org/webt/t9/lc/vn/t9lcvnyl17u39krw9vn1nc-5xmk.png"><br><br><h2 style=";text-align:right;direction:rtl">  ุชุชุญุฏ ุงูููุตูุงุช ุงููุชุนุฏุฏุฉ ูุน AND </h2><br>  ูุชู ุฏูุฌ ููุงุนุฏ ุฌุฏุงุฑ ุงูุญูุงูุฉ ูุน ุงูุนุฏูุฏ ูู ุงููุงุฆูุงุช (ุงููุถูููู ูุงูุดุจูุงุช ูุงููุฌููุนุงุช) ุจุงุณุชุฎุฏุงู OR ุงูููุทูู.  ุณุชุนูู ุงููุงุนุฏุฉ ุงูุชุงููุฉ ุฅุฐุง ูุงู ูุตุฏุฑ ุงูุญุฒูุฉ ูุทุงุจู <code>Host_1</code> ุฃู <code>Host_2</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">| Source | Destination | Service | Action | | ----------------------------------------| | Host_1 | Subnet_A | HTTPS | Allow | | Host_2 | | | | | ----------------------------------------|</code> </pre> <br>  ุนูู ุงูุนูุณ ูู ุฐูู ุ ูู Kubernetes ุ ูุชู ุงูุฌูุน ุจูู ุงูุชุณููุงุช ุงููุฎุชููุฉ ูู <code>podSelector</code> ุฃู <code>namespaceSelector</code> ุจูุงุณุทุฉ ุงูููุทู ุงูููุทูู I. ุนูู ุณุจูู ุงููุซุงู ุ ุณุชุญุฏุฏ ุงููุงุนุฏุฉ ุงูุชุงููุฉ <code>podSelector</code> ุงูุชู ุชุญุชูู ุนูู ููุชุง ุงูุชุณููุงุช ุ <code>role=db</code> AND <code>version=v2</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">podSelector: matchLabels: role: db version: v2</code> </pre> <br>  ููุทุจู ููุณ ุงูููุทู ุนูู ุฌููุน ุฃููุงุน ุงูุนูุงูู: ูุญุฏุฏุงุช ุฃูุฏุงู ุงูุณูุงุณุฉ ุ ูุญุฏุฏุงุช ุงูุญุงูุธุฉ ุ ูุญุฏุฏุงุช ูุณุงุญุฉ ุงูุงุณู. <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุดุจูุงุช ุงููุฑุนูุฉ ูุนูุงููู IP (IPBlocks) </h2><br>  ุชุณุชุฎุฏู ุฌุฏุฑุงู ุงูุญูุงูุฉ ุดุจูุงุช ูุญููุฉ ุธุงูุฑูุฉ ูุนูุงููู IP ูุดุจูุงุช ูุฑุนูุฉ ูุชูุณูู ุงูุดุจูุฉ. <br><br>  ูู Kubernetes ุ ูุชู ุชุนููู ุนูุงููู IP ูููุฑูู ุชููุงุฆููุง ููููู ุฃู ุชุชุบูุฑ ุจุดูู ูุชูุฑุฑ ุ ูุฐูู ูุชู ุงุณุชุฎุฏุงู ุงูููุตูุงุช ูุชุญุฏูุฏ ุงูุญุงูุธุงุช ููุณุงุญุงุช ุงูุฃุณูุงุก ูู ุณูุงุณุงุช ุงูุดุจูุฉ. <br><br>  <code>ipBlocks</code> ( <code>ipBlocks</code> ) ููุชุญูู ูู ุงูุงุชุตุงูุงุช ุงูุฎุงุฑุฌูุฉ (ุงูุฏุงุฎููุฉ) ุฃู ุงูุฎุงุฑุฌูุฉ (ุงูุฎุงุฑุฌูุฉ) (ุงูุดูุงููุฉ-ุงูุฌููุจูุฉ).  ุนูู ุณุจูู ุงููุซุงู ุ ุชููุฑ ูุฐู ุงูุณูุงุณุฉ ูุฌููุน ุงููุฑูู ูู ุงููุตูู <code>default</code> ููุณุงุญุฉ ุงูุงุณู ุฅูู ุฎุฏูุฉ Google DNS: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: egress-dns namespace: default spec: podSelector: {} policyTypes: - Egress egress: - to: - ipBlock: cidr: 8.8.8.8/32 ports: - protocol: UDP port: 53</code> </pre> <br><img src="https://habrastorage.org/webt/fm/uc/oa/fmucoaptwhse0i5yx-hsize1d0e.png"><br><br>  ูุนูู ูุญุฏุฏ ุงูุฌุฑุงุจ ุงููุงุฑุบ ูู ูุฐุง ุงููุซุงู "ุชุญุฏูุฏ ุฌููุน ุงูุญุงูุธุงุช ูู ูุณุงุญุฉ ุงูุงุณู." <br><br>  ุชููุฑ ูุฐู ุงูุณูุงุณุฉ ุงููุตูู ุฅูู 8.8.8.8 ููุท ุ  ุชู ุฑูุถ ุงููุตูู ุฅูู ุฃู IP ุขุฎุฑ.  ูุจุงูุชุงูู ุ ูู ุงูุฃุณุงุณ ุ ููุช ุจุญุธุฑ ุงููุตูู ุฅูู ุฎุฏูุฉ DNS ุงูุฏุงุฎููุฉ Kubernetes.  ุฅุฐุง ููุช ูุง ุชุฒุงู ุชุฑุบุจ ูู ูุชุญู ุ ูุญุฏุฏู ุจูุถูุญ. <br><br>  ุนุงุฏุฉู ูุง ุชููู <code>ipBlocks</code> ู <code>podSelectors</code> ุญุตุฑูุฉ ุจุดูู ูุชุจุงุฏู ุ ูุธุฑูุง ูุนุฏู ุงุณุชุฎุฏุงู ุนูุงููู IP ุงูุฏุงุฎููุฉ <code>ipBlocks</code> ูู <code>ipBlocks</code> .  <b>ูู ุฎูุงู</b> ุชุญุฏูุฏ <b>ุญุงูุธุงุช IP ุงูุฏุงุฎููุฉ</b> ุ ุณุชุณูุญ ูุนูููุง ุจุงูุงุชุตุงูุงุช ูู / ุฅูู ุงูุญุงูุธุงุช ุงูุชู ุชุญุชูู ุนูู ูุฐู ุงูุนูุงููู.  ูู ุงูููุงุฑุณุฉ ุงูุนูููุฉ ุ ูู ุชุนุฑู ุนููุงู IP ุงููุฑุงุฏ ุงุณุชุฎุฏุงูู ุ ููุฐุง ูู ุงูุณุจุจ ูู ุฃูู ูุง ููุจุบู ุงุณุชุฎุฏุงููุง ูุชุญุฏูุฏ ุงูุณููุงุช. <br><br>  ููุซุงู ูุถุงุฏ ุ ุชุดุชูู ุงูุณูุงุณุฉ ุงูุชุงููุฉ ุนูู ุฌููุน ุนูุงููู IP ุ ูุจุงูุชุงูู ุ ุชุชูุญ ุงููุตูู ุฅูู ุฌููุน ุงูุจุฑุงูุฌ ุงูุฃุฎุฑู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: egress-any namespace: default spec: podSelector: {} policyTypes: - Egress egress: - to: - ipBlock: cidr: 0.0.0.0/0</code> </pre> <br><img src="https://habrastorage.org/webt/yt/dt/ow/ytdtowaueimdgmppg5x9mp7y2ec.png"><br><br>  ููููู ูุชุญ ุงููุตูู ุฅูู ุนูุงููู IP ุงูุฎุงุฑุฌูุฉ ููุท ุนู ุทุฑูู ุงุณุชุจุนุงุฏ ุนูุงููู IP ุงูุฏุงุฎููุฉ ูููุฑูู.  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ูุงูุช ุงูุดุจูุฉ ุงููุฑุนูุฉ ุงูุฎุงุตุฉ ุจู pod ูู 10.16.0.0/14: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: egress-any namespace: default spec: podSelector: {} policyTypes: - Egress egress: - to: - ipBlock: cidr: 0.0.0.0/0 except: - 10.16.0.0/14</code> </pre> <br><img src="https://habrastorage.org/webt/9a/iz/c4/9aizc4r0bjzljsl0smkwaagpgfm.png"><br><br><h2 style=";text-align:right;direction:rtl">  ุงูููุงูุฆ ูุงูุจุฑูุชููููุงุช </h2><br>  ุงููุฑูู ุนุงุฏุฉ ุงูุงุณุชูุงุน ุนูู ูููุฐ ูุงุญุฏ.  ูุฐุง ูุนูู ุฃูู ููููู ุจุจุณุงุทุฉ ุญุฐู ุฃุฑูุงู ุงูููุงูุฐ ูู ุงูุณูุงุณุงุช ูุชุฑู ูู ุดูุก ุงูุชุฑุงุถููุง.  ููุน ุฐูู ุ ููุตู ุจูุถุน ุณูุงุณุงุช ุชูููุฏูุฉ ูุฏุฑ ุงูุฅููุงู ุ ูุฐูู ูู ุจุนุถ ุงูุญุงูุงุช ูุง ูุฒุงู ุจุฅููุงูู ุชุญุฏูุฏ ุงูููุงูุฐ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: default.postgres namespace: default spec: ingress: - from: - podSelector: matchLabels: app: indexer - podSelector: matchLabels: app: admin ports: # &lt;&lt;&lt; - port: 443 # &lt;&lt;&lt; protocol: TCP # &lt;&lt;&lt; - port: 80 # &lt;&lt;&lt; protocol: TCP # &lt;&lt;&lt; podSelector: matchLabels: app: postgres policyTypes: - Ingress</code> </pre> <br><img src="https://habrastorage.org/webt/ie/yo/og/ieyoogygmsewwwxtg0ncvsapxmw.png"><br><br>  ูุงุญุธ ุฃู ูุญุฏุฏ <code>ports</code> ููุทุจู ุนูู ุฌููุน ุงูุนูุงุตุฑ ุงูููุฌูุฏุฉ ูู ุงููุชูุฉ ุงูุชู ูุญุชูู ุนูููุง ุฃู ููู.  ูุชุญุฏูุฏ ููุงูุฐ ูุฎุชููุฉ ููุฌููุนุงุช ูุฎุชููุฉ ูู ุงูุนูุงุตุฑ ุ ูู ุจุชูุณูู <code>ingress</code> ุฃู <code>egress</code> ุฅูู ุนุฏุฉ ุฃูุณุงู ูุฑุนูุฉ ูุน ุฃู <code>from</code> <code>ingress</code> <code>egress</code> ูู ูู ูููุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: default.postgres namespace: default spec: ingress: - from: - podSelector: matchLabels: app: indexer ports: # &lt;&lt;&lt; - port: 443 # &lt;&lt;&lt; protocol: TCP # &lt;&lt;&lt; - from: - podSelector: matchLabels: app: admin ports: # &lt;&lt;&lt; - port: 80 # &lt;&lt;&lt; protocol: TCP # &lt;&lt;&lt; podSelector: matchLabels: app: postgres policyTypes: - Ingress</code> </pre> <br><img src="https://habrastorage.org/webt/bw/_a/8p/bw_a8p4luekpljv4c9zh6p4hw_y.png"><br><br>  ุงูููุงูุฐ ุงูุงูุชุฑุงุถูุฉ ุชุนูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฅุฐุง ุญุฐูุช ุชุนุฑูู ุงูููุงูุฐ ุชูุงููุง ุ ููุฐุง ูุนูู ุฌููุน ุงูุจุฑูุชููููุงุช ูุฌููุน ุงูููุงูุฐ ุ </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ุญุฐูุช ุชุนุฑูู ุงูุจุฑูุชูููู ุ ููุฐุง ูุนูู TCP ุ </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ุญุฐูุช ุชุนุฑูู ุงููููุฐ ุ ููุฐุง ูุนูู ุฌููุน ุงูููุงูุฐ. </li></ul><br>  ุฃูุถู ููุงุฑุณุฉ: ูุง ุชุนุชูุฏ ุนูู ุงูููู ุงูุงูุชุฑุงุถูุฉ ุ ุญุฏุฏ ูุง ุชุฑูุฏู ุตุฑุงุญุฉ. <br><br>  ูุฑุฌู ููุงุญุธุฉ ุฃูู ูู ุงูุถุฑูุฑู ุงุณุชุฎุฏุงู ููุงูุฐ pod ุ ูููุณ ุงูุฎุฏูุงุช (ุงููุฒูุฏ ุญูู ูุฐุง ุงูููุถูุน ูู ุงูููุฑุฉ ุงูุชุงููุฉ). <br><br><h2 style=";text-align:right;direction:rtl">  ูู ุชู ุชุนุฑูู ุงูุณูุงุณุงุช ุงูุฎุงุตุฉ ุจุงููุฑูู ุฃู ุงูุฎุฏูุงุชุ </h2><br>  ุนุงุฏุฉู ูุง ุชุชุตู ุงููุฑูู ูู Kubernetes ุจุจุนุถูุง ุงูุจุนุถ ูู ุฎูุงู ุฎุฏูุฉ - ููุงุฒู ุชุญููู ุงูุชุฑุงุถู ูุนูุฏ ุชูุฌูู ุญุฑูุฉ ุงููุฑูุฑ ุฅูู ูุฑูู ุชููุฐ ุงูุฎุฏูุฉ.  ูุฏ ุชุนุชูุฏ ุฃู ุณูุงุณุงุช ุงูุดุจูุฉ ุชุชุญูู ูู ุงููุตูู ุฅูู ุงูุฎุฏูุงุช ุ ูููู ูุฐุง ููุณ ูุฐูู.  <b>ุชุนูู ุณูุงุณุงุช ุดุจูุฉ Kubernetes ูุน ููุงูุฐ pod ุ ูููุณ ุงูุฎุฏูุงุช.</b> <br><br> ,    80- ,      8080  pod',       8080. <br><br>     :      (   pod')    . <br><br>      Service Mesh <i>(, .  Istio  โ . .)</i>     . <br><br><h2 style=";text-align:right;direction:rtl">     Ingress,   Egress? </h2><br>   โ ,  pod     pod' ,       (    egress-),  pod        ( , ,  ingress-). <br><br>         ,       . <br><br>   pod- <b></b>      <b>egress</b> -,        .         pod'- <b></b> .  pod   - ,   (egress)    . <br><br>    pod'- <b></b> ,     <b>ingress</b> -,    .           pod'-.  pod   - ,   (ingress)      . <br><br> .  ยซStateful  Statelessยป . <br><br><h2 style=";text-align:right;direction:rtl">  </h2><br>   Kubernetes    .    ,     ,       . <br><br><h2 style=";text-align:right;direction:rtl">       </h2><br>   Kubernetes       (DNS)   egress.             ,   IP- (  aws.com). <br><br><h2 style=";text-align:right;direction:rtl">   </h2><br>         . Kubernetes    .      kubectl Kubernetes  ,   ,    .    Kubernetes       .      : <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">kubernetes get networkpolicy &lt;policy-name&gt; -o yaml</code> </pre> <br>   ,    Kubernetes        . <br><br><h2 style=";text-align:right;direction:rtl">  </h2><br> Kubernetes      ,    API-,        ,  Container Networking Interface (CNI).     Kubernetes    CNI             .        CNI ,    Kubernetes,    <i>(     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a> โ . .)</i> ,   ,   CNI  . <br><br>  ,  Kubernetes   ,         CNI. <br><br><h3 style=";text-align:right;direction:rtl"> Stateful  Stateless? </h3><br>  CNI Kubernetes,     ,   (, Calico  Linux conntrack).   pod'      TCP-     .       Kubernetes,      (statefulness). <br><br><h2 style=";text-align:right;direction:rtl">     </h2><br>          Kubernetes: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">   Service Mesh  sidecar-           .      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Istio</a> . </li><li style=";text-align:right;direction:rtl">    CNI   ,        Kubernetes. </li><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Tufin Orca</a>       Kubernetes. </li></ol><br>  Tufin Orca    Kubernetes (   ,  ). <br><br><h2 style=";text-align:right;direction:rtl">   </h2><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">  ,  Ahmet Alp Balkan'  GKE</a> ; </li><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">    Kubernetes</a> ; </li><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">    Kubernetes</a> ; </li><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">    </a> . </li></ul><br><h2 style=";text-align:right;direction:rtl">  ุงูุฎุงุชูุฉ </h2><br>   Kubernetes       ,        .  ,  -        .             . <br><br> ,          ,     . <br><br><h2 style=";text-align:right;direction:rtl">  PS ูู ุงููุชุฑุฌู </h2><br>  ุงูุฑุฃ ุฃูุถูุง ูู ูุฏููุชูุง: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> ยซ     Istioยป: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="> 1 (   )</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="> 2 (,  )</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="> 3 ()</a> ; </li><li style=";text-align:right;direction:rtl"> ยซ      Kubernetesยป: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="> 1  2 ( ,  )</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="> 3 (   )</a> ; </li><li style=";text-align:right;direction:rtl"> ยซ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Docker  Kubernetes     </a> ยป; </li><li style=";text-align:right;direction:rtl"> ยซ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">9       Kubernetes</a> ยป; </li><li style=";text-align:right;direction:rtl"> ยซ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">11  ()     Kubernetes</a> ยป. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar443190/">https://habr.com/ru/post/ar443190/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar443180/index.html">ูุจูุท ุทุงูู ุงูุชููู ูุชุณุฌูู ููุฏูู ููููููุจ</a></li>
<li><a href="../ar443182/index.html">ุงุณุญุจ YPbPr ูู Commodore 64</a></li>
<li><a href="../ar443184/index.html">ูู ุงูุญุจ ููุณูุทุฑุฉ ุนูู ุฎุทูุฉ ูุงุญุฏุฉ</a></li>
<li><a href="../ar443186/index.html">3CX ุงูุฏุนู ุงูููู ูุณุชุฌูุจ - 5 IP PBX ููุงุนุฏ ุงูุฃูู</a></li>
<li><a href="../ar443188/index.html">ุซูุงุซ ุนููู ูุนููุฉ ุนูู ุนููุฏ ุ ุฃู ุญูุงูุฉ ุฃู ุฎูุณุฉ ุฃุฑุฌู ูู ATtiny13 ูุงููุฉ</a></li>
<li><a href="../ar443192/index.html">ุทุฑู ุฎุงุตุฉ ุฏูู ุชุณุทูุฑ ููุงุฌูุงุช ูู ุจูุซูู</a></li>
<li><a href="../ar443194/index.html">ุงุจุชูุฑ ูููุฏุณู WFIRM ุทุงุจุนุฉ ุญูููุฉ ุชุทุจุน ุงูุฌูุฏ ูุจุงุดุฑุฉ ุนูู ุงูุฌุฑุญ</a></li>
<li><a href="../ar443196/index.html">ููุณ ุฏูููุฉ ุญุงููุง - ุงุฎุชูุงุฑ ุฌูุงุฒ ุงูุชูุฌูู ุงูุตูุงุนู LTE</a></li>
<li><a href="../ar443198/index.html">ูููู ูุงุฑู ุฒููุฑุจูุฑุฌ ุฅู ูููุน Facebook ูุนูู ุนูู ูุงุฌูุฉ ุนุตุจูุฉ ููุฑุงุกุฉ ุงูุฃููุงุฑ</a></li>
<li><a href="../ar443200/index.html">ูุฑุงุตูุฉ ุฅูุฑุงูููู ูุณุฑููู ุชูุฑุงุจุงูุช ูู ุงูุจูุงูุงุช ูู ุณูุชุฑููุณ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>