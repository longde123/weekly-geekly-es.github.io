<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ½ï¸ ğŸ¥” ğŸ˜» ä½¿ç”¨pytestè¿›è¡ŒPythonæµ‹è¯•ã€‚ pytestå…¥é—¨ï¼Œç¬¬1ç«  ğŸ§˜ğŸ¿ ğŸ†” ğŸ¬</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="è¿”å› ä¸‹ä¸€ä¸ª 


 æˆ‘å‘ç°ä½¿ç”¨pytestè¿›è¡ŒPythonæµ‹è¯•æ˜¯pytestæµ‹è¯•ç¯å¢ƒçš„éå¸¸æœ‰ç”¨çš„å…¥é—¨æŒ‡å—ã€‚ å®ƒå·²ç»ç»™æˆ‘å¸¦æ¥äº†å…¬å¸çš„çº¢åˆ©ã€‚ 
 
 å…‹é‡Œæ–¯Â·å‰ƒé¡»åˆ€ 
 èµ·ä¹‰æŠ€æœ¯äº§å“å‰¯æ€»è£ 





 æœ¬ä¹¦ä¸­çš„ç¤ºä¾‹æ˜¯ä½¿ç”¨Python 3.6å’Œpytest 3.2ç¼–å†™çš„ã€‚ pytest 3.2æ”¯æŒPy...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ä½¿ç”¨pytestè¿›è¡ŒPythonæµ‹è¯•ã€‚ pytestå…¥é—¨ï¼Œç¬¬1ç« </h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/448782/"><p><img src="https://habrastorage.org/webt/jl/jn/bb/jljnbbjr-ejh473xy_eccsmknpk.png">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿”å›</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸‹ä¸€ä¸ª</a> <img src="https://habrastorage.org/webt/rw/dy/-g/rwdy-grsvbpcetjttrmecdkxtlk.png"></p><br><p> <em>æˆ‘å‘ç°ä½¿ç”¨pytestè¿›è¡ŒPythonæµ‹è¯•æ˜¯pytestæµ‹è¯•ç¯å¢ƒçš„éå¸¸æœ‰ç”¨çš„å…¥é—¨æŒ‡å—ã€‚</em>  <em>å®ƒå·²ç»ç»™æˆ‘å¸¦æ¥äº†å…¬å¸çš„çº¢åˆ©ã€‚</em> <em><br></em> <br> å…‹é‡Œæ–¯Â·å‰ƒé¡»åˆ€ <br> èµ·ä¹‰æŠ€æœ¯äº§å“å‰¯æ€»è£ </p><br><p><img src="https://habrastorage.org/webt/hd/--/9w/hd--9w134j0rxhmxftrflbbdopy.png"></p><a name="habracut"></a><br><p> æœ¬ä¹¦ä¸­çš„ç¤ºä¾‹æ˜¯ä½¿ç”¨Python 3.6å’Œpytest 3.2ç¼–å†™çš„ã€‚  pytest 3.2æ”¯æŒPython 2.6ã€2.7å’ŒPython 3.3+ã€‚ </p><br><blockquote> æœ¬ä¹¦ç½‘é¡µä¸Šçš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" title="https://pragprog.com/titles/bopytest/source_code">é“¾æ¥</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" title="https://pragprog.com/titles/bopytest">pragprog.com</a>ä¸Šæä¾›äº†Tasksé¡¹ç›®ä»¥åŠæœ¬ä¹¦ä¸­æ˜¾ç¤ºçš„æ‰€æœ‰æµ‹è¯•çš„æºä»£ç ã€‚ æ‚¨æ— éœ€ä¸‹è½½æºä»£ç å³å¯äº†è§£æµ‹è¯•ä»£ç ã€‚ ç¤ºä¾‹ä¸­ä»¥æ–¹ä¾¿çš„å½¢å¼æä¾›äº†æµ‹è¯•ä»£ç ã€‚ ä½†æ˜¯ï¼Œä¸ºäº†è·Ÿä¸Šé¡¹ç›®çš„ä»»åŠ¡ï¼Œæˆ–è€…æ”¹ç¼–æµ‹è¯•ç¤ºä¾‹æ¥æµ‹è¯•è‡ªå·±çš„é¡¹ç›®ï¼ˆä¸è´¹åŠ›æ°”ï¼ï¼‰ï¼Œæ‚¨å¿…é¡»è½¬åˆ°æœ¬ä¹¦çš„ç½‘é¡µå¹¶ä¸‹è½½å·¥ä½œã€‚ åœ¨è¯¥ä¹¦çš„ç½‘é¡µä¸Šï¼Œæœ‰ä¸€ä¸ª<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" title="https://pragprog.com/titles/bopytest/errata">å‹˜è¯¯</a>ä¿¡æ¯é“¾æ¥å’Œä¸€ä¸ª<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" title="https://forums.pragprog.com/forums/438">è®ºå›</a> ã€‚ </blockquote><p> åœ¨å‰§é€ä¸‹æ–¹æ˜¯è¯¥ç³»åˆ—æ–‡ç« çš„åˆ—è¡¨ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">ç›®å½•</b> <div class="spoiler_text"><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><strong>å¼•è¨€</strong></a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><strong>ç¬¬1ç« ï¼špytestå…¥é—¨</strong></a> ï¼ˆæœ¬æ–‡ï¼‰ </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><strong>ç¬¬2ç« ï¼šç¼–å†™æµ‹è¯•å‡½æ•°</strong></a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><strong>ç¬¬3ç« ï¼šPytestå›ºå®šè£…ç½®</strong></a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><strong>ç¬¬4ç« ï¼šå†…ç½®ç¯å…·</strong></a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><strong>ç¬¬5ç« ï¼šæ’ä»¶</strong></a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><strong>ç¬¬6ç« ï¼šé…ç½®</strong></a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><strong>ç¬¬7ç« ï¼šä¸å…¶ä»–å·¥å…·ä¸€èµ·ä½¿ç”¨pytest</strong></a> </li></ul></div></div><br><h2 id="poehali"> èµ°å§ </h2><br><p> è¿™æ˜¯æµ‹è¯•ï¼š </p><br><blockquote>  <strong>ch1 / test_one.py</strong> </blockquote><br><pre><code class="plaintext hljs">def test_passing(): assert (1, 2, 3) == (1, 2, 3)</code> </pre> <br><p> è¿™æ˜¯å¯åŠ¨æ—¶çš„æ ·å­ï¼š </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest test_one.py ===================== test session starts ====================== collected 1 items test_one.py . =================== 1 passed in 0.01 seconds ===================</code> </pre> <br><p><img src="https://habrastorage.org/webt/v0/ak/lu/v0aklucdm0i8nrqtk1v1dwb2oeg.png"></p><br><p>  <em>test_one.py</em>ä¹‹åçš„ç‚¹è¡¨ç¤ºå·²è¿è¡Œä¸€é¡¹æµ‹è¯•å¹¶é€šè¿‡äº†æµ‹è¯•ã€‚ å¦‚æœéœ€è¦æ›´å¤šä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨<code>-v</code>æˆ–<code>--verbose</code> ï¼š </p><br><pre> <code class="plaintext hljs">$ pytest -v test_one.py ===================== test session starts ====================== collected 1 items test_one.py::test_passing PASSED =================== 1 passed in 0.01 seconds ===================</code> </pre> <br><p><img src="https://habrastorage.org/webt/ss/rb/7i/ssrb7i7io-h6ikadzulg5yncvyw.png"></p><br><p> å¦‚æœæ‚¨æœ‰å½©è‰²ç«¯å­ï¼Œåˆ™â€œé€šè¿‡â€å’Œåº•çº¿ä¸ºç»¿è‰²ã€‚ å¤ªå¥½äº†ï¼ </p><br><p> è¿™æ˜¯ä¸€ä¸ªå¤±è´¥çš„æµ‹è¯•ï¼š </p><br><blockquote>  <strong>ch1 / test_two.py</strong> </blockquote><br><pre> <code class="plaintext hljs">def test_failing(): assert (1, 2, 3) == (3, 2, 1)</code> </pre> <br><p>  pytestæ˜¾ç¤ºæµ‹è¯•å¤±è´¥çš„æ–¹å¼æ˜¯å¼€å‘äººå‘˜å–œæ¬¢pytestçš„ä¼—å¤šåŸå› ä¹‹ä¸€ã€‚ è®©æˆ‘ä»¬çœ‹çœ‹ç»“æœå¦‚ä½•ï¼š </p><br><pre> <code class="plaintext hljs">$ pytest test_two.py ===================== test session starts ====================== collected 1 items test_two.py F =========================== FAILURES =========================== _________________________ test_failing _________________________ def test_failing(): &gt; assert (1, 2, 3) == (3, 2, 1) E assert (1, 2, 3) == (3, 2, 1) E At index 0 diff: 1 != 3 E Use -v to get the full diff test_two.py:2: AssertionError =================== 1 failed in 0.04 seconds ===================</code> </pre> <br><p><img src="https://habrastorage.org/webt/dr/sh/wu/drshwua2ie5btbcena-4xlewiz4.png"></p><br><p> å¤ªå¥½äº†ï¼ æµ‹è¯•test <em>test_failing</em>çš„éƒ¨åˆ†å‘æˆ‘ä»¬å±•ç¤ºäº†ä¸ºä»€ä¹ˆå¤±è´¥ã€‚ </p><br><p>  pytestå‡†ç¡®åœ°æŠ¥å‘Šäº†ç¬¬ä¸€æ¬¡å´©æºƒï¼šç´¢å¼•0ä¸åŒ¹é…ã€‚ </p><br><p> è¯¥æ¶ˆæ¯çš„å¾ˆå¤§ä¸€éƒ¨åˆ†æ˜¯çº¢è‰²ï¼Œè¿™ä½¿å®ƒçœŸæ­£è„±é¢–è€Œå‡ºï¼ˆå¦‚æœæ‚¨æœ‰å½©è‰²ç«¯å­ï¼‰ã€‚ </p><br><p> è¿™å·²ç»æ˜¯å¾ˆå¤šä¿¡æ¯ï¼Œä½†æ˜¯æœ‰ä¸€è¡Œæç¤ºè¯´ä½¿ç”¨<code>-v</code>å¯ä»¥å¾—åˆ°æ›´å¤šå…³äºå·®å¼‚çš„æè¿°ã€‚ </p><br><p> è®©æˆ‘ä»¬æŒ‚é’©è¿™ä¸ª<code>-v</code> ï¼š </p><br><pre> <code class="plaintext hljs">$ pytest -v test_two.py ===================== test session starts ====================== collected 1 items test_two.py::test_failing FAILED =========================== FAILURES =========================== _________________________ test_failing _________________________ def test_failing(): &gt; assert (1, 2, 3) == (3, 2, 1) E assert (1, 2, 3) == (3, 2, 1) E At index 0 diff: 1 != 3 E Full diff: E - (1, 2, 3) E ? ^ ^ E + (3, 2, 1) E ? ^ ^ test_two.py:2: AssertionError =================== 1 failed in 0.04 seconds ===================</code> </pre> <br><p><img src="https://habrastorage.org/webt/u9/8l/dn/u98ldncvvmy1ha0ygy6krwekhvm.png"></p><br><p> å“‡ï¼ <br>  pytestæ·»åŠ è„±å­—å·ï¼ˆ^ï¼‰å­—ç¬¦ï¼Œä»¥å‘æˆ‘ä»¬ç¡®åˆ‡æ˜¾ç¤ºå·®å¼‚ã€‚ <br> å¦‚æœæ‚¨å¯¹pytestçš„ç¼–å†™ï¼Œè¯»å–å’Œè¿è¡Œæµ‹è¯•çš„ç®€æ˜“æ€§ä»¥åŠå¯¹è¾“å‡ºè¯»å–ä»¥æŸ¥çœ‹å‘ç”Ÿæ•…éšœçš„ä½ç½®çš„ç®€æ˜“æ€§å°è±¡æ·±åˆ»ï¼Œé‚£ä¹ˆâ€¦â€¦æ‚¨è¿˜æ²¡æœ‰çœ‹åˆ°ä»»ä½•ä¸œè¥¿ã€‚ å®ƒæ¥è‡ªå“ªé‡Œï¼Œè¿˜æœ‰æ›´å¤šå¥‡è¿¹ã€‚ ç•™ä¸‹ï¼Œè®©æˆ‘å‘æ‚¨å±•ç¤ºä¸ºä»€ä¹ˆæˆ‘è®¤ä¸ºpytestç»å¯¹æ˜¯æœ€ä½³çš„æµ‹è¯•å¹³å°ã€‚ </p><br><p> åœ¨æœ¬ç« çš„å…¶ä½™éƒ¨åˆ†ï¼Œæ‚¨å°†å®‰è£…pytestï¼ŒæŸ¥çœ‹è¿è¡Œå®ƒçš„å„ç§æ–¹æ³•ï¼Œå¹¶éµå¾ªä¸€äº›æœ€å¸¸ç”¨çš„å‘½ä»¤è¡Œé€‰é¡¹ã€‚ åœ¨ä»¥åçš„ç« èŠ‚ä¸­ï¼Œæ‚¨å°†å­¦ä¹ å¦‚ä½•ç¼–å†™ä½¿pyteståŠŸèƒ½å‘æŒ¥æœ€å¤§ä½œç”¨çš„æµ‹è¯•å‡½æ•°ï¼Œå¦‚ä½•å°†å®‰è£…ä»£ç æ”¾å…¥è®¾ç½®å’Œæ‹†å¸éƒ¨åˆ†ï¼ˆç§°ä¸ºFixtureï¼‰ä¸­ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨Fixtureå’Œæ’ä»¶ä½¿è½¯ä»¶æµ‹è¯•çœŸæ­£è¿‡è½½ã€‚ </p><br><p> ä½†æ˜¯é¦–å…ˆæˆ‘è¦é“æ­‰ã€‚ å¾ˆæŠ±æ­‰æµ‹è¯•<code>assert (1, 2, 3) == (3, 2, 1)</code> ï¼Œè¿™å¾ˆæ— èŠã€‚ æˆ‘å¬åˆ°æ‰“äº†å—ï¼Ÿ æ²¡æœ‰äººä¼šåœ¨ç°å®ç”Ÿæ´»ä¸­ç¼–å†™è¿™æ ·çš„æµ‹è¯•ã€‚ è½¯ä»¶æµ‹è¯•ç”±æ£€æŸ¥å…¶ä»–è½¯ä»¶çš„ä»£ç ç»„æˆï¼Œè¿™äº›è½¯ä»¶å¯èƒ½æ°¸è¿œæ— æ³•æ­£å¸¸è¿è¡Œã€‚ å¹¶ä¸”<code>(1, 2, 3) == (1, 2, 3)</code>å°†å§‹ç»ˆæœ‰æ•ˆã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬åœ¨æœ¬ä¹¦çš„å…¶ä½™éƒ¨åˆ†ä¸­ä¸ä¼šä½¿ç”¨åƒè¿™æ ·çš„æ„šè ¢æµ‹è¯•çš„åŸå› ã€‚ æˆ‘ä»¬å°†è€ƒè™‘å¯¹çœŸå®è½¯ä»¶é¡¹ç›®çš„æµ‹è¯•ã€‚ æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªéœ€è¦æµ‹è¯•ä»£ç çš„ç¤ºä¾‹Tasksé¡¹ç›®ã€‚ å¸Œæœ›è¿™è¶³å¤Ÿç®€å•ä»¥è‡³äºæ˜“äºç†è§£ï¼Œä½†åˆä¸è‡³äºå˜å¾—æ— èŠã€‚ </p><br><p> è½¯ä»¶æµ‹è¯•çš„å¦ä¸€ä¸ªæœ‰ç”¨çš„åº”ç”¨ç¨‹åºæ˜¯æµ‹è¯•æ‚¨å¯¹è¢«æµ‹è½¯ä»¶å¦‚ä½•å·¥ä½œçš„å‡è®¾ï¼Œå…¶ä¸­å¯èƒ½åŒ…æ‹¬æµ‹è¯•æ‚¨å¯¹ç¬¬ä¸‰æ–¹æ¨¡å—å’Œè½¯ä»¶åŒ…çš„ç†è§£ï¼Œç”šè‡³æ„å»ºPythonæ•°æ®ç»“æ„ã€‚ </p><br><p>  Tasksé¡¹ç›®ä½¿ç”¨åŸºäºnamedtuple factoryæ–¹æ³•çš„Taskç»“æ„ï¼Œè¯¥æ–¹æ³•æ˜¯æ ‡å‡†åº“çš„ä¸€éƒ¨åˆ†ã€‚ ä»»åŠ¡ç»“æ„ç”¨ä½œåœ¨ç”¨æˆ·ç•Œé¢å’ŒAPIä¹‹é—´ä¼ è¾“ä¿¡æ¯çš„æ•°æ®ç»“æ„ã€‚ </p><br><p> åœ¨æœ¬ç« çš„å…¶ä½™éƒ¨åˆ†ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨Taskæ¥æ¼”ç¤ºå¦‚ä½•å¯åŠ¨pytestå¹¶ä½¿ç”¨ä¸€äº›å¸¸ç”¨çš„å‘½ä»¤è¡Œé€‰é¡¹ã€‚ </p><br><p> è¿™æ˜¯ä»»åŠ¡ï¼š </p><br><pre> <code class="plaintext hljs">from collections import namedtuple Task = namedtuple('Task', ['summary', 'owner', 'done', 'id'])</code> </pre> <br><p> åœ¨è¿›å…¥ç¤ºä¾‹ä¹‹å‰ï¼Œè®©æˆ‘ä»¬é€€åä¸€æ­¥ï¼Œè®¨è®ºå¦‚ä½•è·å–pytestå¹¶å®‰è£…å®ƒã€‚ </p><br><p> è‡ªPython 2.6èµ·ï¼Œå·¥å‚<em>namedtupleï¼ˆï¼‰</em>å‡½æ•°å°±å­˜åœ¨äº†ï¼Œä½†æˆ‘ä»ç„¶å‘ç°è®¸å¤šPythonå¼€å‘äººå‘˜éƒ½ä¸çŸ¥é“è¿™æœ‰å¤šé…·ã€‚ è‡³å°‘ï¼Œå°†ä»»åŠ¡ç”¨äºæµ‹è¯•ç”¨ä¾‹æ¯”<code>(1, 2, 3) == (1, 2, 3)</code>æˆ–<code>(1, 2)==3</code>æ›´æœ‰è¶£ã€‚ </p><br><p> åœ¨ç»§ç»­ç¤ºä¾‹ä¹‹å‰ï¼Œè®©æˆ‘ä»¬é€€åä¸€æ­¥ï¼Œè®¨è®ºåœ¨å“ªé‡Œè·å–pytestä»¥åŠå¦‚ä½•å®‰è£…å®ƒã€‚ </p><br><h2 id="dobyvaem-pytest"> æŒ–æ˜pytest </h2><br><p>  Pytestæ€»éƒ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://docs.pytest.org</a> ã€‚ è¿™æ˜¯å®˜æ–¹æ–‡æ¡£ã€‚ ä½†æ˜¯å®ƒé€šè¿‡PyPIï¼ˆPythonåŒ…ç´¢å¼•ï¼‰åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://pypi.python.org/pypi/pytestä¸Š</a>ä¼ æ’­ã€‚ </p><br><p> åƒé€šè¿‡PyPIåˆ†å‘çš„å…¶ä»–Pythonè½¯ä»¶åŒ…ä¸€æ ·ï¼Œä½¿ç”¨<strong>pip</strong>åœ¨ç”¨äºæµ‹è¯•çš„è™šæ‹Ÿç¯å¢ƒä¸­å®‰è£…pytestï¼š </p><br><pre> <code class="plaintext hljs">$ pip3 install -U virtualenv $ python3 -m virtualenv venv $ source venv/bin/activate $ pip install pytest</code> </pre> <br><p> å¦‚æœæ‚¨ä¸ç†Ÿæ‚‰virtualenvæˆ–pipï¼Œæˆ‘å°†ä¸ºæ‚¨ä»‹ç»ã€‚ è¯·å‚é˜…ç¬¬155é¡µçš„é™„å½•1â€œè™šæ‹Ÿç¯å¢ƒâ€å’Œç¬¬159é¡µçš„é™„å½•2ã€‚ </p><br><p>  <strong>Windowsï¼ŒPython 2å’Œvenvå‘¢ï¼Ÿ</strong> </p><br><p>  virtualenvå’Œpipç¤ºä¾‹åº”åœ¨è®¸å¤šPOSIXç³»ç»Ÿä¸Šè¿è¡Œï¼Œä¾‹å¦‚Linuxå’ŒmacOSï¼Œä»¥åŠåœ¨è®¸å¤šç‰ˆæœ¬çš„Pythonï¼ˆåŒ…æ‹¬Python 2.7.9å’Œæ›´é«˜ç‰ˆæœ¬ï¼‰ä¸Šéƒ½å¯ä»¥ä½¿ç”¨ã€‚ </p><br><p> è¯¥è¡Œä¸­çš„<em>venv / bin / activate</em>æºä¸é€‚ç”¨äºWindowsï¼Œè¯·æ”¹ç”¨<em>venv \ Scripts \ activate.bat</em> ã€‚ <br> è¿™æ ·åšï¼š </p><br><pre> <code class="plaintext hljs">C:\&gt; pip3 install -U virtualenv C:\&gt; python3 -m virtualenv venv C:\&gt; venv\Scripts\activate.bat (venv) C:\&gt; pip install pytest</code> </pre> <br><p> å¯¹äºPython 3.6åŠæ›´é«˜ç‰ˆæœ¬ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨venvä»£æ›¿virtualenvï¼Œå¹¶ä¸”ä¸å¿…æ‹…å¿ƒå…ˆå®‰è£…å®ƒã€‚ å®ƒåŒ…å«åœ¨Python 3.6åŠæ›´é«˜ç‰ˆæœ¬ä¸­ã€‚ ä½†æ˜¯ï¼Œæˆ‘å¬è¯´æŸäº›å¹³å°åœ¨ä½¿ç”¨virtualenvæ—¶ä»ç„¶è¡¨ç°æ›´å¥½ã€‚ </p><br><h2 id="zapuskaem-pytest"> è¿è¡Œpytest </h2><br><pre> <code class="plaintext hljs">$ pytest --help usage: pytest [options] [file_or_dir] [file_or_dir] [...] ...</code> </pre> <br><p> æ²¡æœ‰å‚æ•°ï¼Œpytestå°†æ£€æŸ¥æ‚¨çš„å½“å‰ç›®å½•å’Œæµ‹è¯•æ–‡ä»¶çš„æ‰€æœ‰å­ç›®å½•ï¼Œå¹¶è¿è¡Œæ‰¾åˆ°çš„æµ‹è¯•ä»£ç ã€‚ å¦‚æœç»™pytestæŒ‡å®šæ–‡ä»¶åï¼Œç›®å½•åæˆ–å®ƒä»¬çš„åˆ—è¡¨ï¼Œåˆ™ä¼šåœ¨æ­¤å¤„æ‰¾åˆ°å®ƒä»¬ï¼Œè€Œä¸æ˜¯å½“å‰ç›®å½•ã€‚ é€’å½’æ£€æŸ¥å‘½ä»¤è¡Œä¸ŠæŒ‡å®šçš„æ¯ä¸ªç›®å½•ä»¥æ‰¾åˆ°æµ‹è¯•ä»£ç ã€‚ </p><br><p> ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸ºtaskçš„å­ç›®å½•ï¼Œå¹¶ä»ä»¥ä¸‹æµ‹è¯•æ–‡ä»¶å¼€å§‹ï¼š </p><br><blockquote>  <strong>ch1 /ä»»åŠ¡/ test_three.py</strong> </blockquote><br><pre> <code class="plaintext hljs">"""   Task.""" from collections import namedtuple Task = namedtuple('Task', ['summary', 'owner', 'done', 'id']) Task.__new__.__defaults__ = (None, None, False, None) def test_defaults(): """  ,      .""" t1 = Task() t2 = Task(None, None, False, None) assert t1 == t2 def test_member_access(): """  .field () namedtuple.""" t = Task('buy milk', 'brian') assert t.summary == 'buy milk' assert t.owner == 'brian' assert (t.done, t.id) == (False, None)</code> </pre> <br><p>  test_member_accessï¼ˆï¼‰æµ‹è¯•æ—¨åœ¨æ¼”ç¤ºå¦‚ä½•é€šè¿‡åç§°ndè€Œä¸æ˜¯é€šè¿‡ç´¢å¼•è®¿é—®æˆå‘˜ï¼Œè¿™æ˜¯ä½¿ç”¨namedtuplesçš„ä¸»è¦åŸå› ä¹‹ä¸€ã€‚ </p><br><p> è®©æˆ‘ä»¬åœ¨ç¬¬äºŒä¸ªæ–‡ä»¶ä¸­è¿›è¡Œæ›´å¤šæµ‹è¯•ï¼Œä»¥æ¼”ç¤º_asdictï¼ˆï¼‰å’Œ_replaceï¼ˆï¼‰åŠŸèƒ½ </p><br><p> æ‚¨å¯ä»¥ä½¿ç”¨<em><code>__new __.__ defaults__</code></em>åˆ›å»ºTaskå¯¹è±¡ï¼Œè€Œæ— éœ€æŒ‡å®šæ‰€æœ‰å­—æ®µã€‚  <em>test_defaultsï¼ˆï¼‰</em>æµ‹è¯•æ—¨åœ¨æ¼”ç¤ºå’Œæµ‹è¯•é»˜è®¤è®¾ç½®çš„å·¥ä½œæ–¹å¼ã€‚ </p><br><p>  <em><code>test_member_access()</code></em>æµ‹è¯•åº”æ¼”ç¤ºå¦‚ä½•ä¸æŒ‰ç´¢å¼•è®¿é—®åä¸ºndçš„æˆå‘˜ï¼Œè¿™æ˜¯ä½¿ç”¨namedtuplesçš„ä¸»è¦åŸå› ä¹‹ä¸€ã€‚ <br> è®©æˆ‘ä»¬åœ¨ç¬¬äºŒä¸ªæ–‡ä»¶ä¸­æ·»åŠ æ›´å¤šæµ‹è¯•ï¼Œä»¥æ¼”ç¤º<em><code>_asdict()</code></em>å’Œ<em><code>_replace()</code></em>å‡½æ•° </p><br><blockquote>  <strong>ch1 /ä»»åŠ¡/ test_four.py</strong> </blockquote><br><pre> <code class="plaintext hljs">"""   Task.""" from collections import namedtuple Task = namedtuple('Task', ['summary', 'owner', 'done', 'id']) Task.__new__.__defaults__ = (None, None, False, None) def test_asdict(): """_asdict()   .""" t_task = Task('do something', 'okken', True, 21) t_dict = t_task._asdict() expected = {'summary': 'do something', 'owner': 'okken', 'done': True, 'id': 21} assert t_dict == expected def test_replace(): """    fields.""" t_before = Task('finish book', 'brian', False) t_after = t_before._replace(id=10, done=True) t_expected = Task('finish book', 'brian', True, 10) assert t_after == t_expected</code> </pre> <br><p> è¦è¿è¡Œpytestï¼Œæ‚¨å¯ä»¥é€‰æ‹©æŒ‡å®šæ–‡ä»¶å’Œç›®å½•ã€‚ å¦‚æœæ‚¨æœªæŒ‡å®šä»»ä½•æ–‡ä»¶æˆ–ç›®å½•ï¼Œåˆ™pytestå°†åœ¨å½“å‰å·¥ä½œç›®å½•å’Œå­ç›®å½•ä¸­æœç´¢æµ‹è¯•ã€‚ å®ƒæœç´¢ä»¥test_å¼€å¤´æˆ–ä»¥_testç»“å°¾çš„æ–‡ä»¶ã€‚ å¦‚æœä»ch1ç›®å½•è¿è¡Œpytestè€Œä¸ä½¿ç”¨å‘½ä»¤ï¼Œåˆ™å°†å¯¹å››ä¸ªæ–‡ä»¶è¿è¡Œæµ‹è¯•ï¼š </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest ===================== test session starts ====================== collected 6 items test_one.py . test_two.py F tasks/test_four.py .. tasks/test_three.py .. =========================== FAILURES =========================== _________________________ test_failing _________________________ def test_failing(): &gt; assert (1, 2, 3) == (3, 2, 1) E assert (1, 2, 3) == (3, 2, 1) E At index 0 diff: 1 != 3 E Use -v to get the full diff test_two.py:2: AssertionError ============== 1 failed, 5 passed in 0.08 seconds ==============</code> </pre> <br><p><img src="https://habrastorage.org/webt/ut/2o/kw/ut2okwbdqprgbriqvfswsjd-7ti.png"></p><br><p> è¦ä»…è¿è¡Œæˆ‘ä»¬çš„æ–°ä»»åŠ¡æµ‹è¯•ï¼Œå¯ä»¥ä¸ºpytestæä¾›è¦è¿è¡Œçš„æ‰€æœ‰æ–‡ä»¶åæˆ–ç›®å½•ï¼Œæˆ–è€…ä»æˆ‘ä»¬çš„æµ‹è¯•æ‰€åœ¨çš„ç›®å½•ä¸­è°ƒç”¨pytestï¼š </p><br><pre> <code class="plaintext hljs">$ pytest tasks/test_three.py tasks/test_four.py ===================== test session starts ====================== collected 4 items tasks/test_three.py .. tasks/test_four.py .. =================== 4 passed in 0.02 seconds =================== $ pytest tasks ===================== test session starts ====================== collected 4 items tasks/test_four.py .. tasks/test_three.py .. =================== 4 passed in 0.03 seconds =================== $ cd /path/to/code/ch1/tasks $ pytest ===================== test session starts ====================== collected 4 items test_four.py .. test_three.py .. =================== 4 passed in 0.02 seconds ===================</code> </pre> <br><p><img src="https://habrastorage.org/webt/or/77/t4/or77t4go_qqok-v8qnenx5rxcjy.png"></p><br><p>  pytesté€šè¿‡å¹¶æ‰¾åˆ°è¦è¿è¡Œçš„æµ‹è¯•çš„pytestæ‰§è¡Œéƒ¨åˆ†ç§°ä¸ºæµ‹è¯•å‘ç°ã€‚  pytestä¹‹æ‰€ä»¥èƒ½å¤Ÿæ‰¾åˆ°æˆ‘ä»¬è¦è¿è¡Œçš„æ‰€æœ‰æµ‹è¯•ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬æ ¹æ®pytestå‘½åçº¦å®šå¯¹å®ƒä»¬è¿›è¡Œäº†å‘½åã€‚ </p><br><p> ä»¥ä¸‹æ˜¯å‘½åçº¦å®šçš„ç®€è¦æ¦‚è¿°ï¼Œä»¥ä¾¿å¯ä»¥ä½¿ç”¨pytestæ£€æµ‹åˆ°æ‚¨çš„æµ‹è¯•ä»£ç ï¼š </p><br><ul><li> æµ‹è¯•æ–‡ä»¶åº”å‘½åä¸º<code>test_&lt;something&gt;.py</code>æˆ–<code>&lt;something&gt;_test.py</code> ã€‚ </li><li> æµ‹è¯•æ–¹æ³•å’ŒåŠŸèƒ½åº”ç§°ä¸º<code>test_&lt;something&gt;</code> ã€‚ </li><li> æµ‹è¯•ç±»åº”ç§°ä¸º<code>Test&lt;Something&gt;</code> ã€‚ </li></ul><br><p> ç”±äºæˆ‘ä»¬çš„æµ‹è¯•æ–‡ä»¶å’Œå‡½æ•°<code>test_</code> ï¼Œæ‰€ä»¥ä¸€åˆ‡éƒ½å¾ˆå¥½ã€‚ å¦‚æœæ‚¨æœ‰ä¸€å †åç§°ä¸åŒçš„æµ‹è¯•ï¼Œåˆ™æœ‰å¤šç§æ–¹æ³•å¯ä»¥æ›´æ”¹è¿™äº›å‘ç°è§„åˆ™ã€‚ <br> æˆ‘å°†åœ¨ç¬¬113é¡µçš„ç¬¬6ç« â€œé…ç½®â€ä¸­è¿›è¡Œä»‹ç»ã€‚ </p><br><p> è®©æˆ‘ä»¬ä»”ç»†çœ‹çœ‹åªè¿è¡Œä¸€ä¸ªæ–‡ä»¶çš„ç»“æœï¼š </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1/tasks $ pytest test_three.py ================= test session starts ================== platform darwin -- Python 3.6.2, pytest-3.2.1, py-1.4.34, pluggy-0.4.0 rootdir: /path/to/code/ch1/tasks, inifile: collected 2 items test_three.py .. =============== 2 passed in 0.01 seconds ===============</code> </pre> <br><p> ç»“æœå‘Šè¯‰äº†æˆ‘ä»¬å¾ˆå¤šã€‚ </p><br><blockquote>  =====æµ‹è¯•ä¼šè¯å¼€å§‹==== </blockquote><p>  ã€‚ </p><br><p>  pytestæä¾›äº†ä¸€ä¸ªä¼˜é›…çš„åˆ†éš”ç¬¦æ¥å¯åŠ¨æµ‹è¯•ä¼šè¯ã€‚ ä¼šè¯æ˜¯å•ä¸ªpytestè°ƒç”¨ï¼ŒåŒ…æ‹¬åœ¨å¤šä¸ªç›®å½•ä¸­è¿è¡Œçš„æ‰€æœ‰æµ‹è¯•ã€‚ å½“æˆ‘åœ¨ç¬¬56é¡µçš„å¤¹å…·åŒºåŸŸå®šä¹‰ä¸­è°ˆè®ºä¸pytestå¤¹å…·æœ‰å…³çš„ä¼šè¯åŒºåŸŸæ—¶ï¼Œè¯¥ä¼šè¯å®šä¹‰å˜å¾—å¾ˆé‡è¦ã€‚ </p><br><p> è¾¾å°”æ–‡å¹³å°-åœ¨æˆ‘çš„Macä¸Šã€‚ åœ¨Windowsè®¡ç®—æœºä¸Šï¼Œå¹³å°æ˜¯ä¸åŒçš„ã€‚ ä»¥ä¸‹æ˜¯Pythonå’Œpytestçš„ç‰ˆæœ¬ï¼Œä»¥åŠå¯¹pytestè½¯ä»¶åŒ…çš„ä¾èµ–ã€‚  pyå’Œpluggyéƒ½æ˜¯pytestå›¢é˜Ÿå¼€å‘çš„è½¯ä»¶åŒ…ï¼Œå¯å¸®åŠ©å®ç°pytestã€‚ </p><br><blockquote>  <strong>rootdirï¼š/è·¯å¾„/åˆ°/ä»£ç / ch1 /ä»»åŠ¡ï¼Œiniæ–‡ä»¶ï¼š</strong> </blockquote><p>  <code>rootdir</code>æ˜¯åœ¨å…¶ä¸­æœç´¢æµ‹è¯•ä»£ç çš„æ‰€æœ‰ç›®å½•çš„æœ€é¡¶å±‚å…±äº«ç›®å½•ã€‚  <code>inifile</code> ï¼ˆæ­¤å¤„ä¸ºç©ºï¼‰åˆ—å‡ºäº†ä½¿ç”¨çš„é…ç½®æ–‡ä»¶ã€‚ é…ç½®æ–‡ä»¶å¯ä»¥æ˜¯<code>pytest.ini</code> ï¼Œ <code>tox.ini</code>æˆ–<code>setup.cfg</code> ã€‚ æœ‰å…³é…ç½®æ–‡ä»¶çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…ç¬¬113é¡µç¬¬6ç« ï¼Œâ€œé…ç½®â€ã€‚ </p><br><blockquote>  <strong>æ”¶é›†äº†2ä¸ªé¡¹ç›®</strong> </blockquote><p> è¿™æ˜¯æ–‡ä»¶ä¸­çš„ä¸¤ä¸ªæµ‹è¯•åŠŸèƒ½ã€‚ </p><br><blockquote>  <strong>test_three.py ..</strong> </blockquote><p>  <code>test_three.py</code>æ˜¾ç¤ºæµ‹è¯•æ–‡ä»¶ã€‚ æ¯ä¸ªæµ‹è¯•æ–‡ä»¶åªæœ‰ä¸€è¡Œã€‚ ä¸¤ç‚¹è¡¨ç¤ºæµ‹è¯•å·²é€šè¿‡-æ¯ä¸ªæµ‹è¯•åŠŸèƒ½æˆ–æ–¹æ³•ä¸€ä¸ªç‚¹ã€‚ ç‚¹ä»…ç”¨äºé€šè¿‡æµ‹è¯•ã€‚ å¤±è´¥ï¼Œé”™è¯¯ï¼Œè·³è¿‡ï¼Œxfailså’Œxpassåˆ†åˆ«ç”¨Fï¼ŒEï¼Œsï¼Œxå’ŒXè¡¨ç¤ºã€‚ å¦‚æœè¦æŸ¥çœ‹æ›´å¤šé€šè¿‡æµ‹è¯•çš„è¦ç‚¹ï¼Œè¯·ä½¿ç”¨<code>-v</code>æˆ–<code>--verbose</code>é€‰é¡¹ã€‚ </p><br><blockquote>  == 2åœ¨0.01ç§’å†…é€šè¿‡== </blockquote><p> è¯¥è¡Œè¡¨ç¤ºé€šè¿‡çš„æµ‹è¯•æ•°å’Œæ•´ä¸ªæµ‹è¯•ä¼šè¯æ‰€èŠ±è´¹çš„æ—¶é—´ã€‚ å¦‚æœæœ‰é€šè¿‡æµ‹è¯•ï¼Œåˆ™æ¯ä¸ªç±»åˆ«çš„ç¼–å·ä¹Ÿä¼šåœ¨æ­¤å¤„æ˜¾ç¤ºã€‚ </p><br><p> æµ‹è¯•ç»“æœæ˜¯æ‰§è¡Œæµ‹è¯•æˆ–æŸ¥çœ‹ç»“æœçš„ç”¨æˆ·äº†è§£æµ‹è¯•è¿‡ç¨‹ä¸­å‘ç”Ÿçš„æƒ…å†µçš„ä¸»è¦æ–¹å¼ã€‚ åœ¨pytestä¸­ï¼Œæµ‹è¯•å‡½æ•°å¯ä»¥æœ‰å‡ ç§ä¸åŒçš„ç»“æœï¼Œè€Œä¸ä»…ä»…æ˜¯é€šè¿‡æˆ–å¤±è´¥ã€‚ è¿™æ˜¯æµ‹è¯•åŠŸèƒ½çš„å¯èƒ½ç»“æœï¼š </p><br><ul><li> é€šè¿‡ï¼ˆã€‚ï¼‰ï¼šæµ‹è¯•æˆåŠŸå®Œæˆã€‚ </li><li> å¤±è´¥ï¼ˆFï¼‰ï¼šæµ‹è¯•å¤±è´¥ï¼ˆæˆ–XPASS +ä¸¥æ ¼ï¼‰ã€‚ </li><li> è·³è¿‡ï¼šè·³è¿‡äº†æµ‹è¯•ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨<code>@pytest.mark.skip()</code>æˆ–<code>pytest.mark.skipif()</code>è£…é¥°å™¨<code>pytest.mark.skipif()</code>è·³è¿‡æµ‹è¯•ï¼Œå¦‚ç¬¬34é¡µçš„â€œè·³è¿‡æµ‹è¯•â€éƒ¨åˆ†æ‰€è¿°ã€‚ </li><li>  xfailï¼ˆxï¼‰ï¼šæµ‹è¯•ä¸åº”è¯¥é€šè¿‡ï¼Œå®ƒå·²ç»å¯åŠ¨å¹¶ä¸”å¤±è´¥ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨<code>@pytest.mark.xfail()</code>è£…é¥°å™¨<code>@pytest.mark.xfail()</code>ç¬¬37é¡µçš„æµ‹è¯•æ ‡è®°ä¸­å°†å…¶æè¿°ä¸ºé¢„æœŸå¤±è´¥<code>@pytest.mark.xfail()</code>æ¥å¼ºåˆ¶pytestæŒ‡ç¤ºæµ‹è¯•å¤±è´¥ã€‚ </li><li>  XPASSï¼ˆXï¼‰ï¼šæµ‹è¯•ä¸åº”è¯¥é€šè¿‡ï¼Œå®ƒå·²ç»å¯åŠ¨å¹¶é€šè¿‡ï¼ </li><li> é”™è¯¯ï¼ˆEï¼‰ï¼šåœ¨æµ‹è¯•åŠŸèƒ½ä¹‹å¤–å‘ç”Ÿäº†å¼‚å¸¸ï¼Œæ— è®ºæ˜¯åœ¨ç¬¬49ç« ç¬¬3ç« pytestå›ºå®šè£…ç½®ä¸­è®¨è®ºçš„å¤¹å…·ä¸­ï¼Œè¿˜æ˜¯åœ¨ç¬¬95ç« ç¬¬5ç« çš„æ’ä»¶ä¸­è®¨è®ºçš„é’©å­å‡½æ•°ä¸­éƒ½å‘ç”Ÿäº†å¼‚å¸¸ã€‚ </li></ul><br><h2 id="vypolnenie-tolko-odnogo-testa"> ä»…æ‰§è¡Œä¸€é¡¹æµ‹è¯• </h2><br><p> å¼€å§‹ç¼–å†™æµ‹è¯•åï¼Œå¯èƒ½è¦åšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯åªè¿è¡Œä¸€ä¸ªã€‚ ç›´æ¥æŒ‡å®šæ–‡ä»¶å¹¶æ·»åŠ åç§°<code>::test_name</code> ï¼š </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest -v tasks/test_four.py::test_asdict =================== test session starts =================== collected 3 items tasks/test_four.py::test_asdict PASSED ================ 1 passed in 0.01 seconds =================</code> </pre> <br><p> ç°åœ¨è®©æˆ‘ä»¬çœ‹ä¸€äº›é€‰é¡¹ã€‚ </p><br><h2 id="ispolzovanie-opciy"> ä½¿ç”¨é€‰é¡¹ </h2><br><p> æˆ‘ä»¬å·²ç»ä½¿ç”¨äº†verboseï¼Œ <code>-v</code>æˆ–<code>--verbose</code>é€‰é¡¹å‡ æ¬¡ï¼Œä½†æ˜¯è¿˜æœ‰è®¸å¤šå€¼å¾—äº†è§£çš„é€‰é¡¹ã€‚ åœ¨æœ¬ä¹¦ä¸­ï¼Œæˆ‘ä»¬å°†åªä½¿ç”¨å…¶ä¸­çš„ä¸€äº›ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨pytest <code>--help</code>é€‰é¡¹æŸ¥çœ‹å®Œæ•´åˆ—è¡¨ã€‚ </p><br><p> ä»¥ä¸‹æ˜¯ä¸€äº›åœ¨ä½¿ç”¨pytestæ—¶éå¸¸æœ‰ç”¨çš„é€‰é¡¹ã€‚ è¿™ä¸æ˜¯ä¸€ä¸ªå®Œæ•´çš„åˆ—è¡¨ï¼Œä½†æ˜¯è¿™äº›é€‰é¡¹è¶³ä»¥å¯åŠ¨ã€‚ </p><br><pre> <code class="plaintext hljs">$ pytest --help usage: pytest [options] [file_or_dir] [file_or_dir] [...] ... subset of the list ... positional arguments: file_or_dir general: -k EXPRESSION only run tests which match the given substring expression. An expression is a python evaluatable expression where all names are substring-matched against test names and their parent classes. Example: -k 'test_method or test_other' matches all test functions and classes whose name contains 'test_method' or 'test_other', while -k 'not test_method' matches those that don't contain 'test_method' in their names. Additionally keywords are matched to classes and functions containing extra names in their 'extra_keyword_matches' set, as well as functions which have names assigned directly to them. -m MARKEXPR only run tests matching given mark expression. example: -m 'mark1 and not mark2'. --markers show markers (builtin, plugin and per-project ones). -x, --exitfirst exit instantly on first error or failed test. --maxfail=num exit after first num failures or errors. ... --capture=method per-test capturing method: one of fd|sys|no. -s shortcut for --capture=no. ... --lf, --last-failed rerun only the tests that failed at the last run (or all if none failed) --ff, --failed-first run all tests but run the last failures first. This may re-order tests and thus lead to repeated fixture setup/teardown ... reporting: -v, --verbose increase verbosity. -q, --quiet decrease verbosity. --verbosity=VERBOSE set verbosity ... -l, --showlocals show locals in tracebacks (disabled by default). --tb=style traceback print mode (auto/long/short/line/native/no). ... --durations=N show N slowest setup/test durations (N=0 for all). ... collection: --collect-only only collect tests, don't execute them. ... test session debugging and configuration: --basetemp=dir base temporary directory for this test run.(warning: this directory is removed if it exists) --version display pytest lib version and import information. -h, --help show help message and configuration info</code> </pre><br><h3 id="--collect-only">  -ä»…æ”¶é›† </h3><br><p>  <code>--collect-only</code>æŒ‡ç¤ºå°†ä½¿ç”¨ç»™å®šçš„å‚æ•°å’Œé…ç½®æ‰§è¡Œå“ªäº›æµ‹è¯•ã€‚ é¦–å…ˆæ˜¾ç¤ºæ­¤å‚æ•°å¾ˆæ–¹ä¾¿ï¼Œä»¥ä¾¿å°†è¾“å‡ºç”¨ä½œå…¶ä»–ç¤ºä¾‹çš„å‚è€ƒã€‚ å¦‚æœæ‚¨ä»ch1ç›®å½•å¼€å§‹ï¼Œåˆ™åº”è¯¥çœ‹åˆ°åˆ°ç›®å‰ä¸ºæ­¢åœ¨æœ¬ç« ä¸­å·²ç»çœ‹åˆ°çš„æ‰€æœ‰æµ‹è¯•åŠŸèƒ½ï¼š </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest --collect-only =================== test session starts =================== collected 6 items &lt;Module 'test_one.py'&gt; &lt;Function 'test_passing'&gt; &lt;Module 'test_two.py'&gt; &lt;Function 'test_failing'&gt; &lt;Module 'tasks/test_four.py'&gt; &lt;Function 'test_asdict'&gt; &lt;Function 'test_replace'&gt; &lt;Module 'tasks/test_three.py'&gt; &lt;Function 'test_defaults'&gt; &lt;Function 'test_member_access'&gt; ============== no tests ran in 0.03 seconds ===============</code> </pre> <br><p>  <code>--collect-only</code>å¯¹äºéªŒè¯æ˜¯å¦æ­£ç¡®é€‰æ‹©äº†åœ¨è¿è¡Œæµ‹è¯•ä¹‹å‰é€‰æ‹©æµ‹è¯•çš„å…¶ä»–é€‰é¡¹å¾ˆæœ‰ç”¨ã€‚ æˆ‘ä»¬å°†å†æ¬¡ä½¿ç”¨å®ƒä¸<code>-k</code>ä¸€èµ·æ˜¾ç¤ºå…¶å·¥ä½œåŸç†ã€‚ </p><br><h3 id="-k-expression">  -kè¡¨è¾¾ </h3><br><p>  <code>-k</code>å…è®¸æ‚¨ä½¿ç”¨è¡¨è¾¾å¼æ¥å®šä¹‰æµ‹è¯•åŠŸèƒ½ã€‚ </p><br><p> ä¸€ä¸ªéå¸¸å¼ºå¤§çš„é€‰æ‹©ï¼ å¦‚æœåç§°æ˜¯å”¯ä¸€çš„ï¼Œå®ƒå¯ä»¥ç”¨ä½œè¿è¡Œå•ç‹¬æµ‹è¯•çš„å¿«æ·æ–¹å¼ï¼Œæˆ–è€…è¿è¡Œåç§°ä¸­å…·æœ‰é€šç”¨å‰ç¼€æˆ–åç¼€çš„ä¸€ç»„æµ‹è¯•ã€‚ å‡è®¾æ‚¨è¦è¿è¡Œæµ‹è¯•<code>test_asdict()</code>å’Œ<code>test_defaults()</code> ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•æ£€æŸ¥è¿‡æ»¤å™¨ï¼š-- <code>--collect-only</code> ï¼š </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest -k "asdict or defaults" --collect-only =================== test session starts =================== collected 6 items &lt;Module 'tasks/test_four.py'&gt; &lt;Function 'test_asdict'&gt; &lt;Module 'tasks/test_three.py'&gt; &lt;Function 'test_defaults'&gt; =================== 4 tests deselected ==================== ============== 4 deselected in 0.03 seconds ===============</code> </pre> <br><p> æ˜¯çš„ è¿™ç±»ä¼¼äºæˆ‘ä»¬æ‰€éœ€è¦çš„ã€‚ ç°åœ¨ï¼Œæ‚¨å¯ä»¥é€šè¿‡åˆ é™¤<code>--collect-only</code>æ¥è¿è¡Œå®ƒä»¬ï¼š </p><br><pre> <code class="plaintext hljs">$ pytest -k "asdict or defaults" =================== test session starts =================== collected 6 items tasks/test_four.py . tasks/test_three.py . =================== 4 tests deselected ==================== ========= 2 passed, 4 deselected in 0.03 seconds ==========</code> </pre> <br><p> ç³Ÿç³•ï¼ åªæ˜¯ç‚¹ã€‚ æ‰€ä»¥ä»–ä»¬è¿‡å»äº†ã€‚ ä½†æ˜¯ä»–ä»¬æ˜¯æ­£ç¡®çš„æµ‹è¯•å—ï¼Ÿ ä¸€ç§æ‰¾å‡ºæ–¹æ³•æ˜¯ä½¿ç”¨<code>-v</code>æˆ–<code>--verbose</code> ï¼š </p><br><pre> <code class="plaintext hljs">$ pytest -v -k "asdict or defaults" =================== test session starts =================== collected 6 items tasks/test_four.py::test_asdict PASSED tasks/test_three.py::test_defaults PASSED =================== 4 tests deselected ==================== ========= 2 passed, 4 deselected in 0.02 seconds ==========</code> </pre> <br><p> æ˜¯çš„ è¿™äº›æ˜¯æ­£ç¡®çš„æµ‹è¯•ã€‚ </p><br><h3 id="-m-markexpr">  -m MARKEXPR </h3><br><p> æ ‡è®°æ˜¯æ ‡è®°ä¸€éƒ¨åˆ†æµ‹è¯•åŠŸèƒ½ä»¥ä¸€èµ·è¿è¡Œçš„æœ€ä½³æ–¹æ³•ä¹‹ä¸€ã€‚ ä¾‹å¦‚ï¼Œå³ä½¿å®ƒä»¬åœ¨å•ç‹¬çš„æ–‡ä»¶ä¸­ï¼Œè¿è¡Œ<code>test_replace()</code>å’Œ<code>test_member_access()</code>ä¸€ç§æ–¹æ³•æ˜¯å¯¹å…¶è¿›è¡Œæ ‡è®°ã€‚ å¯ä»¥ä½¿ç”¨ä»»ä½•æ ‡è®°åç§°ã€‚ å‡è®¾æ‚¨è¦ä½¿ç”¨<code>run_these_please</code> ã€‚ ä½¿ç”¨<code>@pytest.mark.run_these_please</code>è£…é¥°å™¨è®°å½•æµ‹è¯•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pytest ... @pytest.mark.run_these_please <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_member_access</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> ...</code> </pre> <br><p> ç°åœ¨å¯¹<code>test_replace()</code>ç›¸åŒã€‚ ç„¶åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨<code>pytest -m run_these_please</code>ä½¿ç”¨ç›¸åŒçš„æ ‡è®°è¿è¡Œæ‰€æœ‰æµ‹è¯•ï¼š </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1/tasks $ pytest -v -m run_these_please ================== test session starts =================== collected 4 items test_four.py::test_replace PASSED test_three.py::test_member_access PASSED =================== 2 tests deselected =================== ========= 2 passed, 2 deselected in 0.02 seconds =========</code> </pre> <br><p> æ ‡è®°è¡¨è¾¾ä¸å¿…æ˜¯å•ä¸ªæ ‡è®°ã€‚ æ‚¨å¯ä»¥å°†<code>-m "mark1 and mark2"</code>ç­‰é€‰é¡¹ç”¨äºå¸¦æœ‰ä¸¤ä¸ªæ ‡è®°çš„æµ‹è¯•ï¼Œå°†<code>-m "mark1 and not mark2"</code>ç”¨äºå…·æœ‰æ ‡ç­¾1ä½†æ²¡æœ‰æ ‡ç­¾2çš„æµ‹è¯•ï¼Œ <code>-m "mark1 or mark2"</code>ç”¨äºæµ‹è¯•ä¸å…¶ä¸­ä¹‹ä¸€ç­‰ï¼Œæˆ‘å°†åœ¨ç¬¬31é¡µçš„â€œæ ‡è®°éªŒè¯æ–¹æ³•â€ä¸­æ›´è¯¦ç»†åœ°è®¨è®ºæ ‡è®°ã€‚ </p><br><h3 id="-x---exitfirst">  -xï¼Œ--exitfirst </h3><br><p>  <em>pytest</em>çš„æ­£å¸¸è¡Œä¸ºæ˜¯è¿è¡Œå®ƒæ‰¾åˆ°çš„æ‰€æœ‰æµ‹è¯•ã€‚ å¦‚æœæµ‹è¯•åŠŸèƒ½æ£€æµ‹åˆ°<em>æ–­è¨€</em>æˆ–<em>å¼‚å¸¸</em>å¤±è´¥ï¼Œåˆ™æ­¤æµ‹è¯•å°†åœæ­¢å¹¶ä¸”æµ‹è¯•å°†å¤±è´¥ã€‚ ç„¶å<em>pytest</em>è¿è¡Œä¸‹ä¸€ä¸ªæµ‹è¯•ã€‚ åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™å°±æ˜¯æ‚¨æ‰€éœ€è¦çš„ã€‚ ä½†æ˜¯ï¼Œå°¤å…¶æ˜¯åœ¨è°ƒè¯•é—®é¢˜æ—¶ï¼Œå¦‚æœæµ‹è¯•ä¸æ­£ç¡®ï¼Œå®ƒå°†ç«‹å³å¹²æ‰°æ•´ä¸ªæµ‹è¯•ä¼šè¯ã€‚ è¿™æ˜¯<code>-x</code>é€‰é¡¹çš„ä½œç”¨ã€‚ è®©æˆ‘ä»¬åœ¨ç›®å‰è¿›è¡Œçš„å…­ä¸ªæµ‹è¯•ä¸­å°è¯•ä¸€ä¸‹ï¼š </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest -x ====================== test session starts ==================== collected 6 items test_one.py . test_two.py F ============================ FAILURES ========================= __________________________ test_failing _______________________ def test_failing(): &gt; assert (1, 2, 3) == (3, 2, 1) E assert (1, 2, 3) == (3, 2, 1) E At index 0 diff: 1 != 3 E Use -v to get the full diff test_two.py:2: AssertionError =============== 1 failed, 1 passed in 0.38 seconds ============</code> </pre><br><p> åœ¨è¾“å‡ºçš„é¡¶éƒ¨ï¼Œæ‚¨çœ‹åˆ°æ‰€æœ‰å…­ä¸ªæµ‹è¯•ï¼ˆæˆ–â€œé¡¹ç›®â€ï¼‰å‡å·²æ”¶é›†ï¼Œåœ¨æœ€åº•è¡Œï¼Œæ‚¨çœ‹åˆ°ä¸€ä¸ªæµ‹è¯•å¤±è´¥å¹¶é€šè¿‡äº†ä¸€ä¸ªæµ‹è¯•ï¼Œè€Œ<em>pytest</em>æ˜¾ç¤ºäº†â€œ Interruptedâ€è¡Œè®©æˆ‘ä»¬çŸ¥é“ä»–å·²ç»åœæ­¢äº†ã€‚ å¦‚æœæ²¡æœ‰<code>-x</code>åˆ™å°†è¿è¡Œæ‰€æœ‰å…­ä¸ªæµ‹è¯•ã€‚ è®©æˆ‘ä»¬åœ¨æ²¡æœ‰<code>-x</code>æƒ…å†µä¸‹å†æ¬¡é‡å¤ã€‚ æˆ‘ä»¬è¿˜ä½¿ç”¨<code>--tb=no</code>æ¥ç¦ç”¨å †æ ˆè·Ÿè¸ªï¼Œå› ä¸ºæ‚¨å·²ç»çœ‹åˆ°äº†å®ƒï¼Œè€Œä¸å¿…å†æ¬¡çœ‹åˆ°å®ƒï¼š </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest --tb=no =================== test session starts =================== collected 6 items test_one.py . test_two.py F tasks/test_four.py .. tasks/test_three.py .. =========== 1 failed, 5 passed in 0.09 seconds ============</code> </pre> <br><p>   ,   <code>-x</code> , pytest    <em>test_two.py</em>    . </p><br><h3 id="--maxfailnum"> --maxfail=num </h3><br><p>  <code>-x</code>       .   ,      ,    ,   <code>--maxfail</code> ,  ,    .            ,      .     ,    <code>--maxfail = 2</code> ,    ,  <code>--maxfail = 1</code>    ,  <code>-x</code> : </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest --maxfail=2 --tb=no =================== test session starts =================== collected 6 items test_one.py . test_two.py F tasks/test_four.py .. tasks/test_three.py .. =========== 1 failed, 5 passed in 0.08 seconds ============ $ pytest --maxfail=1 --tb=no =================== test session starts =================== collected 6 items test_one.py . test_two.py F !!!!!!!!! Interrupted: stopping after 1 failures !!!!!!!!!! =========== 1 failed, 1 passed in 0.19 seconds ============</code> </pre> <br><p> E    <code>--tb=no</code> ,   . </p><br><h3 id="-s-and---capturemethod"> -s and --capture=method </h3><br><p>  <code>-s</code>    â€”    ,     <em>stdout</em> ,           .     <code>--capture=no</code> .   ,        .      ,      ,     ,      .  <code>-s</code>  <code>--capture=no</code>    .         <code>print()</code> ,       . </p><br><p>  ,           , <code>-l/--showlocals</code> ,      ,    . </p><br><p>     <code>--capture=fd</code>  <code>--capture=sys</code> . â€”  <code>--capture=sys</code>  <code>sys.stdout/stderr</code>  mem-.  <code>--capture=fd</code>    1  2   . </p><br><p>    <code>sys</code>  <code>fd</code>  . ,  ,        .    <code>-s</code> .    ,   <code>-s</code> ,      . </p><br><p>          ;    .   ,       ,      . </p><br><h3 id="-lf---last-failed"> -lf, --last-failed </h3><br><p>              .   <code>--lf</code>     : </p><br><p>  ,     <code>--tb</code> ,    ,         . </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest --lf =================== test session starts =================== run-last-failure: rerun last 1 failures collected 6 items test_two.py F ======================== FAILURES ========================= ______________________ test_failing _______________________ def test_failing(): &gt; assert (1, 2, 3) == (3, 2, 1) E assert (1, 2, 3) == (3, 2, 1) E At index 0 diff: 1 != 3 E Use -v to get the full diff test_two.py:2: AssertionError =================== 5 tests deselected ==================== ========= 1 failed, 5 deselected in 0.08 seconds ==========</code> </pre> <br><h3 id="ff---failed-first"> â€“ff, --failed-first </h3><br><p>  <code>--ff/--failed-first</code>     ,   <code>--last-failed</code> ,     ,    : </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest --ff --tb=no =================== test session starts =================== run-last-failure: rerun last 1 failures first collected 6 items test_two.py F test_one.py . tasks/test_four.py .. tasks/test_three.py .. =========== 1 failed, 5 passed in 0.09 seconds ============</code> </pre> <br><p>  <code>test_failing()</code>  <code>test\_two.py</code>   <code>test\_one.py</code> . ,  <code>test_failing()</code>     , <code>--ff</code>       </p><br><h3 id="-v---verbose"> -v, --verbose </h3><br><p>  <code>-v/--verbose</code>      .     ,       ,        . </p><br><p>      ,           <code>--ff</code>  <code>--tb=no</code> : </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest -v --ff --tb=no =================== test session starts =================== run-last-failure: rerun last 1 failures first collected 6 items test_two.py::test_failing FAILED test_one.py::test_passing PASSED tasks/test_four.py::test_asdict PASSED tasks/test_four.py::test_replace PASSED tasks/test_three.py::test_defaults PASSED tasks/test_three.py::test_member_access PASSED =========== 1 failed, 5 passed in 0.07 seconds ============</code> </pre> <br><p><img src="https://habrastorage.org/webt/bw/7f/_4/bw7f_4irv2astplpl5tobqp_xqs.png"></p><br><p>           FAILED   PASSED. </p><br><h3 id="-q---quiet"> -q, --quiet </h3><br><p>  <code>-q/--quiet</code>  <code>-v/--verbose</code> ;      .        <code>--tb=line</code> ,          . </p><br><p>  - <code>q</code> : </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest -q .F.... ======================== FAILURES ========================= ______________________ test_failing _______________________ def test_failing(): &gt; assert (1, 2, 3) == (3, 2, 1) E assert (1, 2, 3) == (3, 2, 1) E At index 0 diff: 1 != 3 E Full diff: E - (1, 2, 3) E ? ^ ^ E + (3, 2, 1) E ? ^ ^ test_two.py:2: AssertionError 1 failed, 5 passed in 0.08 seconds</code> </pre> <br><p>  <code>-q</code>    ,    .      <code>-q</code>     (  <code>--tb=no</code> ),    ,        . </p><br><h3 id="-l---showlocals"> -l, --showlocals </h3><br><p>    <code>-l/--showlocals</code>         <code>tracebacks</code>   . </p><br><p>            .     <code>test_replace()</code>   </p><br><pre> <code class="plaintext hljs">t_expected = Task('finish book', 'brian', True, 10)</code> </pre> <br><p> åœ¨ </p><br><pre> <code class="plaintext hljs">t_expected = Task('finish book', 'brian', True, 11)</code> </pre> <br><p> 10  11   .       .         <code>--l/--showlocals</code> : </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest -l tasks =================== test session starts =================== collected 4 items tasks/test_four.py .F tasks/test_three.py .. ======================== FAILURES ========================= ______________________ test_replace _______________________ @pytest.mark.run_these_please def test_replace(): """replace() should change passed in fields.""" t_before = Task('finish book', 'brian', False) t_after = t_before._replace(id=10, done=True) t_expected = Task('finish book', 'brian', True, 11) &gt; assert t_after == t_expected E AssertionError: assert Task(summary=...e=True, id=10) == Task(summary='...e=True, id=11) E At index 3 diff: 10 != 11 E Use -v to get the full diff t_after = Task(summary='finish book', owner='brian', done=True, id=10) t_before = Task(summary='finish book', owner='brian', done=False, id=None) t_expected = Task(summary='finish book', owner='brian', done=True, id=11) tasks\test_four.py:28: AssertionError =========== 1 failed, 3 passed in 0.08 seconds ============</code> </pre> <br><p><img src="https://habrastorage.org/webt/c1/f_/vk/c1f_vkcnpoeplpn9arlb-fgj85a.png"></p><br><p>   <code>t_after</code> , <code>t_before</code>  <code>t_expected</code>      ,       assert-. </p><br><h3 id="--tbstyle"> --tb=style </h3><br><p>  <code>--tb=style</code>       .    pytest        ,    ,    .  <em>tracebacks</em>    ,  ,   .    <code>--tb=style</code> . ,    ,  short, line  no. <code>short</code>    <em>assert</em>   <strong>E</strong>  ; <code>line</code>     ; <em>no</em>   . </p><br><p>     <code>test_replace()</code> ,    ,       . <code>--tb=no</code>    </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest --tb=no tasks =================== test session starts =================== collected 4 items tasks/test_four.py .F tasks/test_three.py .. =========== 1 failed, 3 passed in 0.04 seconds ============</code> </pre> <br><blockquote> --tb=line in many cases is enough to tell what's wrong. If you have a ton of failing tests, this option can help to show a pattern in the failures: </blockquote><p> <code>--tb=line</code>    ,  ,   .      ,        : </p><br><pre> <code class="plaintext hljs">$ pytest --tb=line tasks =================== test session starts =================== collected 4 items tasks/test_four.py .F tasks/test_three.py .. ======================== FAILURES ========================= /path/to/code/ch1/tasks/test_four.py:20: AssertionError: assert Task(summary=...e=True, id=10) == Task( summary='...e=True, id=11) =========== 1 failed, 3 passed in 0.05 seconds ============</code> </pre> <br><p>    verbose tracebacks <code>--tb=short</code> : </p><br><pre> <code class="plaintext hljs">$ pytest --tb=short tasks =================== test session starts =================== collected 4 items tasks/test_four.py .F tasks/test_three.py .. ======================== FAILURES ========================= ______________________ test_replace _______________________ tasks/test_four.py:20: in test_replace assert t_after == t_expected E AssertionError: assert Task(summary=...e=True, id=10) == Task( summary='...e=True, id=11) E At index 3 diff: 10 != 11 E Use -v to get the full diff =========== 1 failed, 3 passed in 0.04 seconds ============</code> </pre> <br><p>   ,   ,  . </p><br><p>     ,     . </p><br><p> pytest <code>--tb=long</code>       traceback. pytest <code>--tb=auto</code>         <em>tracebacks</em> ,      .    . pytest <code>--tb=native</code>     <em>traceback</em>   . </p><br><h3 id="--durationsn"> --durations=N </h3><br><p>  <code>--durations=N</code>  ,       .     ;    N  tests/setups/teardowns   .    <code>--durations=0</code> ,            . </p><br><p>      ,   <code>time.sleep(0.1)</code>    . , : </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest --durations=3 tasks ================= test session starts ================= collected 4 items tasks/test_four.py .. tasks/test_three.py .. ============== slowest 3 test durations =============== 0.10s call tasks/test_four.py::test_replace 0.00s setup tasks/test_three.py::test_defaults 0.00s teardown tasks/test_three.py::test_member_access ============== 4 passed in 0.13 seconds</code> </pre> <br><p>     <em>sleep</em>      ,      .        : call(), (setup)  (teardown).      ,                    ,  ,  ,  .       3, pytest Fixtures,  . 49. </p><br><h3 id="--version"> --version </h3><br><p>  <code>--version</code>   pytest  ,    : </p><br><pre> <code class="plaintext hljs">$ pytest --version This is pytest version 3.0.7, imported from /path/to/venv/lib/python3.5/site-packages/pytest.py</code> </pre> <br><p>    pytest   , pytest     site-packages   . </p><br><h3 id="-h---help"> -h, --help </h3><br><p>  <code>-h/--help</code>  ,   ,     pytest.     ,   stock- pytest,       ,      ,  . </p><br><p>  <code>-h</code> : </p><br><ul><li> : pytest [] [file_or_dir] [file_or_dir] [...] </li><li>      ,      </li><li>  ,   ini   ,        6, ,  . 113 </li><li>   ,      pytest (    6, ,  . 113) </li><li>   ,  pytest <code>--markers</code>      ,    2,   ,  . 23 </li><li>   ,  pytest <code>--fixtures</code>       ,    3,  pytest,  . 49 </li></ul><br><p>        : </p><br><pre> <code class="plaintext hljs">(shown according to specified file_or_dir or current dir if not specified)</code> </pre> <br><p>   ,  ,            .   ,         pytest    conftest.py,    - (hook functions),   ,     . </p><br><p>    pytest   conftest.py               .     conftest.py  ini,   pytest.ini   6 Â«Â»,   113. </p><br><h2 id="uprazhneniya"> ç»ƒä¹ é¢˜ </h2><br><ol><li><p>    ,  <code>python -m virtualenv</code>  <code>python -m venv</code> .    ,        ,    ,       ,   ,      .      ,      .   1,  ,  . 155,     . </p><br></li><li><p>        . </p><br><pre> <code class="plaintext hljs">- $ source venv/bin/activate - $ deactivate On Windows: - C:\Users\okken\sandbox&gt;venv\scripts\activate.bat - C:\Users\okken\sandbox&gt;deactivate</code> </pre> <br></li><li><p>  pytest    . .  2, pip,   159,     .    ,      pytest,       ,     . </p><br></li><li><p>    .    ,          .  pytest   . </p><br></li><li><p>   assert.    assert something == something_else;   , : </p><br><ul><li> assert 1 in [2, 3, 4] </li><li> assert a &lt; b </li><li> assert 'fizz' not in 'fizzbuzz' </li></ul><br></li></ol><br><h2 id="chto-dalshe"> æ¥ä¸‹æ¥æ˜¯ä»€ä¹ˆ </h2><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬ç ”ç©¶äº†åœ¨å“ªé‡Œè·å–pytestä»¥åŠå„ç§è¿è¡Œæ–¹å¼ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œæˆ‘ä»¬æ²¡æœ‰è®¨è®ºæµ‹è¯•åŠŸèƒ½ä¸­åŒ…å«çš„å†…å®¹ã€‚</font><font style="vertical-align: inherit;">åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†è€ƒè™‘ç¼–å†™æµ‹è¯•å‡½æ•°ï¼Œå¯¹å…¶è¿›è¡Œå‚æ•°åŒ–ï¼Œä»¥ä¾¿ä½¿ç”¨ä¸åŒçš„æ•°æ®è°ƒç”¨å®ƒä»¬ï¼Œå¹¶å°†æµ‹è¯•åˆ†ç»„ä¸ºç±»ï¼Œæ¨¡å—å’ŒåŒ…ã€‚</font></font></p><br><p><img src="https://habrastorage.org/webt/jl/jn/bb/jljnbbjr-ejh473xy_eccsmknpk.png">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿”å›</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸‹ä¸€ä¸ª</a> <img src="https://habrastorage.org/webt/rw/dy/-g/rwdy-grsvbpcetjttrmecdkxtlk.png"></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN448782/">https://habr.com/ru/post/zh-CN448782/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN448770/index.html">æ›´æ–°äº†Visual Studio Codeä¸­çš„Razoræ”¯æŒã€‚ ç°åœ¨æœ‰äº†çƒˆç„°</a></li>
<li><a href="../zh-CN448774/index.html">ä½¿ç”¨DBMS_SQLçš„SQLè‡³CSV</a></li>
<li><a href="../zh-CN448776/index.html">RxVMS-é€‚ç”¨äºFlutteråº”ç”¨ç¨‹åºçš„å®ç”¨æ¶æ„</a></li>
<li><a href="../zh-CN448778/index.html">ä¸ºVisual Studio Enterprise 2019å¼•å…¥æ—¶é—´æ—…è¡Œè°ƒè¯•</a></li>
<li><a href="../zh-CN448780/index.html">ä»€ä¹ˆä½¿è½¯ä»¶å¯ä»¥èµšé’±</a></li>
<li><a href="../zh-CN448786/index.html">ä½¿ç”¨pytestè¿›è¡ŒPythonæµ‹è¯•ã€‚ ç¬¬3ç« pytestå›ºå®šè£…ç½®</a></li>
<li><a href="../zh-CN448788/index.html">ä½¿ç”¨pytestè¿›è¡ŒPythonæµ‹è¯•ã€‚ ç¬¬2ç« ï¼Œç¼–å†™æµ‹è¯•å‡½æ•°</a></li>
<li><a href="../zh-CN448790/index.html">SpaceVIL-ç”¨äºåœ¨.Net Coreï¼Œ.Net Standardå’ŒJVMä¸Šå¼€å‘çš„è·¨å¹³å°GUIæ¡†æ¶</a></li>
<li><a href="../zh-CN448796/index.html">ä½¿ç”¨pytestè¿›è¡ŒPythonæµ‹è¯•ã€‚ é…ç½®ï¼Œç¬¬6ç« </a></li>
<li><a href="../zh-CN448798/index.html">ä½¿ç”¨pytestè¿›è¡ŒPythonæµ‹è¯•ã€‚ å°†pytestä¸å…¶ä»–å·¥å…·ç»“åˆä½¿ç”¨ï¼Œç¬¬7ç« </a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>