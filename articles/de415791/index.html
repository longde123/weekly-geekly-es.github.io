<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤘🏽 🛌🏿 🐴 Optimierung intelligenter Verträge. Wie sich Soliditätstypen auf die Transaktionskosten auswirken 👨🏾 🥝 🤱🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="„Programmierer verbringen viel Zeit damit, sich Gedanken über die Geschwindigkeit ihrer Programme zu machen, und Versuche, Effizienz zu erzielen, wirk...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Optimierung intelligenter Verträge. Wie sich Soliditätstypen auf die Transaktionskosten auswirken</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415791/"><blockquote>  <i>„Programmierer verbringen viel Zeit damit, sich Gedanken über die Geschwindigkeit ihrer Programme zu machen, und Versuche, Effizienz zu erzielen, wirken sich oft dramatisch negativ auf die Fähigkeit aus, sie zu debuggen und zu unterstützen.</i>  <i>Kleine Optimierungen müssen beispielsweise in 97% der Fälle vergessen werden.</i>  <i>Vorzeitige Optimierung ist die Wurzel allen Übels!</i>  <i>Aber wir dürfen die 3% nicht aus den Augen verlieren, bei denen es wirklich wichtig ist! “</i> <br>  <b>Donald Knut.</b> <br></blockquote><img src="https://habrastorage.org/webt/dw/wh/fv/dwwhfvvtvsgi2ilhvtjscuk8xyc.png" alt="Ethereum Gas"><br><br>  Bei der Prüfung intelligenter Verträge fragen wir uns manchmal, ob sich ihre Entwicklung auf diejenigen 97% bezieht, bei denen keine Überlegungen zur Optimierung erforderlich sind, oder ob es sich nur um die 3% der Fälle handelt, in denen dies wichtig ist.  Unserer Meinung nach eher die zweite.  Im Gegensatz zu anderen Anwendungen werden intelligente Verträge nicht aktualisiert und können nicht „unterwegs“ optimiert werden (vorausgesetzt, ihr Algorithmus ist nicht festgelegt, dies ist jedoch ein separates Thema).  Das zweite Argument für eine <i>frühzeitige</i> Vertragsoptimierung ist, dass im Gegensatz zu den meisten Systemen, bei denen sich die Suboptimalität nur auf einer Skala manifestiert, die sich auf die Besonderheiten der Hardware und Umgebung bezieht, anhand einer Vielzahl von Metriken gemessen wird, ein intelligenter Vertrag im Wesentlichen die einzige Leistungsmetrik hat - den Gasverbrauch. <br><br>  Daher ist es technisch einfacher, die Wirksamkeit eines Vertrags zu bewerten, aber Entwickler verlassen sich häufig weiterhin auf ihre Intuition und führen dieselbe blinde „vorzeitige Optimierung“ durch, über die Professor Knut gesprochen hat.  Wir werden anhand des Beispiels der Auswahl der Bittiefe einer Variablen überprüfen, wie intuitiv die Lösung der Realität entspricht.  In diesem Beispiel werden wir, wie in den meisten praktischen Fällen, keine Einsparungen erzielen, und sogar umgekehrt wird sich unser Vertrag im Hinblick auf den Gasverbrauch als teurer herausstellen. <br><a name="habracut"></a><br><h2>  Was für ein Gas? </h2><br>  Ethereum ist wie ein globaler Computer, dessen „Prozessor“ die virtuelle EVM-Maschine ist, dessen „Programmcode“ eine Folge von Befehlen und Daten ist, die in einem intelligenten Vertrag aufgezeichnet sind, und Anrufe sind Transaktionen von außen.  Transaktionen werden in verwandte Strukturen gepackt - Blöcke, die alle paar Sekunden auftreten.  Und da die Blockgröße per Definition begrenzt ist und das Verarbeitungsprotokoll deterministisch ist (eine einheitliche Verarbeitung aller Transaktionen im Block durch alle Knoten des Netzwerks erfordert), muss das System einen fairen Algorithmus für die Auswahl der zu bedienenden Anforderung bereitstellen, um eine potenziell unbegrenzte Nachfrage mit einer begrenzten Knotenressource zu befriedigen und vor DoS zu schützen. und dessen Ignorieren gibt es als Mechanismus in vielen öffentlichen Blockchains ein einfaches Prinzip: Der Absender kann die Höhe der Vergütung für den Bergmann für die Durchführung seiner Transaktion auswählen  ktsii und Bergmann wählt, deren Bedürfnisse umfassen einen Block, und dessen nicht, die profitabelsten für sich entschieden haben. <br><br>  In Bitcoin, wo der Block auf ein Megabyte begrenzt ist, entscheidet der Miner beispielsweise, ob die Transaktion in den Block aufgenommen werden soll oder nicht, basierend auf ihrer Länge und der vorgeschlagenen Provision (Auswahl derjenigen mit dem maximalen Verhältnis von Satoshis pro Byte). <br><br>  Für das komplexere Ethereum-Protokoll ist dieser Ansatz nicht geeignet, da ein einzelnes Byte sowohl das Fehlen einer Operation (z. B. des STOP-Codes) als auch die teure und langsame Schreiboperation in den Speicher (SSTORE) darstellen kann.  Daher wird für jeden in der Luft befindlichen Op-Code abhängig vom Ressourcenverbrauch ein eigener Preis angegeben. <br><br><div class="spoiler">  <b class="spoiler_title">Gebührenplan aus Protokollspezifikation</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/wb/to/i4/wbtoi4ymmqlobftzqqvykhau2iq.png" alt="Gebührenordnung für das Ethereum"><br>  Tabelle des Gasflusses für verschiedene Betriebsarten.  Aus der Protokollspezifikation des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ethereum Yellow Paper</a> . <br></div></div><br>  Im Gegensatz zu Bitcoin legt der Absender der Ethereum-Transaktion nicht die Provision in Kryptowährung fest, sondern die maximale Menge an Gas, die er bereit ist auszugeben - <b>startGas</b> und den Preis pro <b>Gaseinheit</b> - <b>gasPreis</b> .  Wenn die virtuelle Maschine den Code ausführt, wird die Gasmenge für jede nachfolgende Operation von startGas abgezogen, bis entweder der Ausgang des Codes erreicht ist oder das Gas ausgeht.  Anscheinend wird deshalb für diese Arbeitseinheit ein so seltsamer Name verwendet - die Transaktion ist wie ein Auto mit Benzin gefüllt und erreicht den Zielpunkt oder nicht, hängt davon ab, ob genügend Volumen im Tank gefüllt ist.  Nach Abschluss der Codeausführung wird die Luftmenge, die durch Multiplizieren des tatsächlich verbrauchten Gases mit dem vom Absender festgelegten Preis ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wei</a> pro Gas) empfangen wird, vom Transaktionssender abgebucht.  Im globalen Netzwerk geschieht dies zum Zeitpunkt des "Mining" des Blocks, der die entsprechende Transaktion enthält, und in der Remix-Umgebung wird die Transaktion sofort, kostenlos und ohne Bedingungen "abgebaut". <br><br><h2>  Unser Tool - Remix IDE </h2><br>  Für die „Profilerstellung“ des Gasverbrauchs verwenden wir die Online-Umgebung zur Entwicklung der Ethereum-Verträge der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Remix-IDE</a> .  Diese IDE enthält einen Syntax-Hervorhebungscode-Editor, einen Artefakt-Viewer, ein Rendering der Vertragsschnittstelle, einen visuellen Debugger für virtuelle Maschinen, JS-Compiler aller möglichen Versionen und viele andere wichtige Tools.  Ich empfehle dringend, mit ihm das Ätherstudium zu beginnen.  Ein weiteres Plus ist, dass keine Installation erforderlich ist - öffnen Sie es einfach in einem Browser von der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">offiziellen Website</a> . <br><br><h2>  Auswahl des Variablentyps </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die Spezifikation der Solidity-Sprache</a> bietet dem Entwickler bis zu zweiunddreißig Bits ganzzahliger Typen - von 8 bis 256 Bit.  Stellen Sie sich vor, Sie entwickeln einen intelligenten Vertrag, in dem das Alter einer Person in Jahren gespeichert wird.  Welche Bittiefe wählen Sie? <br><br>  Es wäre ganz natürlich, den für eine bestimmte Aufgabe ausreichend ausreichenden Typ zu wählen - uint8 würde hier mathematisch passen.  Es wäre logisch anzunehmen, dass je kleiner das Objekt ist, das wir in der Blockchain speichern, und je weniger Speicher wir für die Ausführung ausgeben, desto weniger Overhead haben wir, desto weniger zahlen wir.  In den meisten Fällen ist diese Annahme jedoch falsch. <br><br>  Für das Experiment nehmen wir den einfachsten Vertrag aus dem Angebot der offiziellen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Solidity-Dokumentation</a> und sammeln ihn in zwei Versionen - unter Verwendung des Variablentyps uint256 und des 32-mal kleineren Typs - uint8. <br><br><div class="spoiler">  <b class="spoiler_title">simpleStorage_uint256.sol</b> <div class="spoiler_text"><pre> <code class="hljs powershell"><code>pragma solidity ^<span class="hljs-number"><span class="hljs-number">0.4</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>; contract SimpleStorage { //uint is alias <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> uint256 uint storedData; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(uint x)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">public</span></span></span></span> { storedData = x; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">view</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">returns</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(uint)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> storedData; } }</code> <br></code> </pre> <code><code>pragma solidity ^0.4.0; contract SimpleStorage { //uint is alias for uint256 uint storedData; function set(uint x) public { storedData = x; } function get() public view returns (uint) { return storedData; } }</code> <br></code> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">simpleStorage_uint8.sol</b> <div class="spoiler_text"><pre> <code class="hljs powershell">pragma solidity ^<span class="hljs-number"><span class="hljs-number">0.4</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>; contract SimpleStorage { uint8 storedData; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(uint8 x)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">public</span></span></span></span> { storedData = x; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">view</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">returns</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(uint)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> storedData; } }</code> </pre> <br><br></div></div><br><h2>  Messung von „Einsparungen“ </h2><br>  Daher werden Verträge erstellt, in Remix geladen, bereitgestellt und Aufrufe von .set () -Methoden von Transaktionen ausgeführt.  Was sehen wir?  <b>Das Aufzeichnen eines langen Typs ist teurer als ein kurzer</b> - 20464 gegenüber 20205 Gaseinheiten!  Wie?  Warum?  Lass es uns herausfinden! <br><br><img src="https://habrastorage.org/webt/rq/7p/bo/rq7pbohiqrtea8mp2bem0hddqlu.png" alt="Ethereum-Gasverbrauch in Remix IDE"><br><br><h2>  Speichern Sie uint8 vs uint256 </h2><br>  Das Schreiben in einen dauerhaften Speicher ist aus offensichtlichen Gründen eine der teuersten Vorgänge im Protokoll: Erstens erhöht das Aufzeichnen des Status die Größe des vom vollständigen Knoten benötigten Speicherplatzes.  Die Größe dieses Speichers nimmt ständig zu. Je mehr Zustände an den Knoten gespeichert werden, desto langsamer erfolgt die Synchronisierung, desto höher ist die Infrastrukturanforderung (Partitionsgröße, Anzahl der Iops).  In Spitzenzeiten bestimmen die langsamen Festplatten-E / A-Vorgänge die Leistung des gesamten Netzwerks. <br><br>  Es wäre logisch zu erwarten, dass die Speicherung von uint8 zehnmal billiger sein sollte als die von uint256.  Im Debugger können Sie jedoch sehen, dass sich beide Werte im Speichersteckplatz genauso befinden wie ein 256-Bit-Wert. <br><br><img src="https://habrastorage.org/webt/7x/v-/e8/7xv-e8hrnzwrta4z0z7adgticm0.png"><br><br>  In diesem speziellen Fall bietet die Verwendung von uint8 keinen Vorteil bei den Kosten für das Schreiben in den Speicher. <br><br><h2>  Umgang mit uint8 vs uint256 </h2><br>  Vielleicht erhalten wir Vorteile bei der Arbeit mit uint8, wenn nicht während der Speicherung, dann zumindest bei der Bearbeitung von Daten im Speicher?  Im Folgenden werden die Anweisungen für dieselbe Funktion verglichen, die für verschiedene Arten von Variablen erhalten wurden. <br><br><img src="https://habrastorage.org/webt/wj/qq/4h/wjqq4hi8_gkc0lfxckcyhjygbu4.png"><br><br>  Sie können sehen, dass Operationen mit uint8 noch <b>mehr Anweisungen enthalten</b> als uint256.  Dies liegt daran, dass der Computer den 8-Bit-Wert in ein natives 256-Bit-Wort konvertiert und der Code daher von zusätzlichen Anweisungen umgeben ist, für die der Absender bezahlt.  In diesem Fall ist es teurer, nicht nur Code mit dem Typ uint8 zu schreiben, sondern auch auszuführen. <br><br><h2>  Wo kann die Verwendung von Kurztypen gerechtfertigt sein? </h2><br>  Unser Team befasst sich seit langem mit der Prüfung intelligenter Verträge, und bisher gab es keinen einzigen praktischen Fall, in dem die Verwendung eines kleinen Typs in dem für die Prüfung vorgesehenen Code zu Einsparungen führen würde.  In einigen sehr spezifischen Fällen sind Einsparungen theoretisch möglich.  Wenn Ihr Vertrag beispielsweise eine große Anzahl kleiner Statusvariablen oder -strukturen speichert, können diese in weniger Speichersteckplätze gepackt werden. <br><br>  Der Unterschied wird am deutlichsten im folgenden Beispiel deutlich: <br><br>  1. Vertrag mit 32 Variablen uint256 <br><br><div class="spoiler">  <b class="spoiler_title">simpleStorage_32x_uint256.sol</b> <div class="spoiler_text"><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">pragma</span></span> solidity<span class="hljs-regexp"><span class="hljs-regexp"> ^0.4.0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">contract</span></span> SimpleStorage { <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData1; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData2; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData3; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData4; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData5; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData6; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData7; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData8; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData9; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData10; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData11; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData12; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData13; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData14; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData15; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData16; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData17; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData18; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData19; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData20; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData21; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData22; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData23; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData24; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData25; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData26; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData27; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData28; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData29; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData30; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData31; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData32; <span class="hljs-attribute"><span class="hljs-attribute">function</span></span> set(uint x) public { <span class="hljs-attribute"><span class="hljs-attribute">storedData1</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData2</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData3</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData4</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData5</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData6</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData7</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData8</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData9</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData10</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData11</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData12</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData13</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData14</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData15</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData16</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData17</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData18</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData19</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData20</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData21</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData22</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData23</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData24</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData25</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData26</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData27</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData28</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData29</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData30</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData31</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData32</span></span> = x; } <span class="hljs-attribute"><span class="hljs-attribute">function</span></span> get() public view returns (uint) { <span class="hljs-attribute"><span class="hljs-attribute">return</span></span> storedData1; } }</code> </pre> <br><br></div></div><br>  2. Vertrag mit 32 uint8-Variablen <br><br><div class="spoiler">  <b class="spoiler_title">simpleStorage_32x_uint8.sol</b> <div class="spoiler_text"><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">pragma</span></span> solidity<span class="hljs-regexp"><span class="hljs-regexp"> ^0.4.0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">contract</span></span> SimpleStorage { <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData1; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData2; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData3; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData4; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData5; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData6; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData7; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData8; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData9; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData10; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData11; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData12; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData13; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData14; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData15; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData16; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData17; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData18; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData19; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData20; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData21; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData22; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData23; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData24; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData25; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData26; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData27; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData28; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData29; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData30; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData31; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData32; <span class="hljs-attribute"><span class="hljs-attribute">function</span></span> set(uint8 x) public { <span class="hljs-attribute"><span class="hljs-attribute">storedData1</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData2</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData3</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData4</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData5</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData6</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData7</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData8</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData9</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData10</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData11</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData12</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData13</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData14</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData15</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData16</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData17</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData18</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData19</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData20</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData21</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData22</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData23</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData24</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData25</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData26</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData27</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData28</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData29</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData30</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData31</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData32</span></span> = x; } <span class="hljs-attribute"><span class="hljs-attribute">function</span></span> get() public view returns (uint) { <span class="hljs-attribute"><span class="hljs-attribute">return</span></span> storedData1; } }</code> </pre> <br><br></div></div><br>  Die Bereitstellung des ersten Vertrags (32 uint256) kostet weniger - nur 89941 Gas, aber .set () ist seitdem viel teurer  Es wird 256 Speicherplätze belegen, was für jeden Anruf 640.639 Gas kostet.  Der zweite Vertrag (32 uint8) wird bei der Bereitstellung (221663 Gas) zweieinhalb Mal teurer sein, aber jeder Aufruf der .set () -Methode ist viel billiger, weil  ändert nur eine Zelle der Stufe (185291 Gas). <br><br><h2>  Sollte eine solche Optimierung angewendet werden? </h2><br>  Wie bedeutend der Effekt der Typoptimierung ist, ist ein strittiger Punkt.  Wie Sie sehen, haben wir selbst für einen solchen speziell ausgewählten synthetischen Fall <b>keine</b> mehrfachen Unterschiede festgestellt.  Die Wahl von uint8 oder uint256 ist eher ein Beispiel dafür, dass die Optimierung entweder sinnvoll angewendet werden sollte (mit Verständnis für Werkzeuge, Profilerstellung) oder überhaupt nicht darüber nachdenken sollte.  Hier sind einige allgemeine Richtlinien: <br><br><ul><li>  Wenn der Vertrag viele kleine Zahlen oder kompakte Strukturen im Repository enthält, können Sie über eine Optimierung nachdenken. </li><li>  Wenn Sie den Typ "abgekürzt" verwenden, denken Sie an <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Über- / Unterlauf-Schwachstellen</a> . </li><li>  Für Speichervariablen und Funktionsargumente, die nicht in das Repository geschrieben wurden, ist es immer besser, den nativen Typ uint256 (oder dessen Alias ​​uint) zu verwenden.  Zum Beispiel macht es keinen Sinn, den Listeniterator auf uint8 zu setzen - verlieren Sie einfach; </li><li>  Von großer Bedeutung für die korrekte Verpackung in Speicherplätzen für den Compiler ist die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Reihenfolge der Variablen im Vertrag</a> . </li></ul><br><h2>  Referenzen </h2><br>  Am Ende werde ich Ratschläge geben, die keine Kontraindikationen haben: Experimentieren Sie mit Entwicklungswerkzeugen, kennen Sie die Spezifikationen der Sprache, Bibliothek und Frameworks.  Hier sind meiner Meinung nach die nützlichsten Links, um mehr über die Ethereum-Plattform zu erfahren: <br><br><ul><li>  Die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Remix-</a> Vertragsentwicklungsumgebung ist eine sehr funktionale browserbasierte IDE. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bei der Angabe der Solidity-Sprache</a> wird der Link speziell auf den Abschnitt zum Layout von Statusvariablen verweisen. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ein sehr interessantes</a> Vertrags- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Repository</a> des berühmten OpenZeppelin-Teams.  Beispiele für die Implementierung von Token, Crowdsale-Verträgen und vor allem die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SafeMath-</a> Bibliothek, mit deren Hilfe sicher mit Typen gearbeitet werden kann; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ethereum Yellow Paper</a> , formale Spezifikation der virtuellen Ethereum-Maschine; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ethereum White Paper</a> , die Spezifikation der Ethereum-Plattform, ein allgemeineres und übergeordnetes Dokument mit einer großen Anzahl von Links; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ethereum in 25 Minuten</a> , eine kurze, aber dennoch umfangreiche technische Einführung in Ethereum durch den Schöpfer der Plattform, Vitalik Buterin; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Etherscan Blockchain Explorer</a> , ein Fenster in die reale <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ätherwelt</a> , ein Browser mit Blöcken, Transaktionen, Token und Verträgen im Hauptnetzwerk.  Auf Etherscan finden Sie Explorer für Testnetzwerke Rinkeby, Ropsten, Kovan (Netzwerke mit kostenlosem Broadcast, die auf verschiedenen Konsensprotokollen basieren). </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de415791/">https://habr.com/ru/post/de415791/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de415779/index.html">Implementierung einer sicheren NAS-Softwareplattform</a></li>
<li><a href="../de415781/index.html">Warum glauben Physiker, dass sich die Stringtheorie als "Theorie von allem" herausstellen könnte?</a></li>
<li><a href="../de415783/index.html">Sternscheiben enthüllen uns die Geheimnisse des Auftretens von Planeten</a></li>
<li><a href="../de415785/index.html">SpaceX sendet einen Roboter mit künstlicher Intelligenz an die ISS</a></li>
<li><a href="../de415789/index.html">Patentierungsalgorithmen für Computerprogramme</a></li>
<li><a href="../de415793/index.html">Vollständige Anleitung zur Domain-Nachbestellung</a></li>
<li><a href="../de415795/index.html">Schreiben einer Snapchat-Benutzeroberfläche auf Swift</a></li>
<li><a href="../de415797/index.html">Reguläre Ausdrücke + logische Programmierung. Was ist das Ergebnis?</a></li>
<li><a href="../de415801/index.html">Google: Unsere "Telefon" -KI ist nicht gut genug, um gefährlich zu sein</a></li>
<li><a href="../de415805/index.html">Modifikation des Doorhan GSM Barrier Moduls zur Internetsteuerung</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>