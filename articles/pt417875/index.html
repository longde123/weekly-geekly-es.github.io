<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚≠ïÔ∏è üêÄ üî° Saindo do SPA da toca do coelho com trilhos modernos üö§ ‚òùüèª üìÆ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="TL; DR: A trilha do SPA √© escura e cheia de horrores. Voc√™ pode enfrent√°-los sem medo ... ou escolher outro caminho que o levar√° ao lugar certo: Rails...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Saindo do SPA da toca do coelho com trilhos modernos</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/417875/"> TL; DR: A trilha do SPA √© escura e cheia de horrores.  Voc√™ pode enfrent√°-los sem medo ... ou escolher outro caminho que o levar√° ao lugar certo: Rails modernos. <br><br><img src="https://habrastorage.org/webt/bm/nz/o6/bmnzo6gdhrpqqdufks3kgylhxjw.jpeg"><br><br>  Lembro-me de pensar que o Rails estava focado no objetivo errado quando o DHH anunciou a Turbolinks em 2012.  Fiquei convencido de que o tempo de resposta instant√¢nea durante a intera√ß√£o do usu√°rio era a chave para o UX superior.  Devido a atrasos na rede, essa interatividade s√≥ √© poss√≠vel se voc√™ minimizar a depend√™ncia da rede e, em vez de chamadas de rede, manter a maior parte do estado no cliente. <br><br>  Eu pensei que era necess√°rio para os aplicativos que eu estava trabalhando.  E com essa opini√£o, tentei muitas abordagens e estruturas para implementar o mesmo modelo: Aplicativos de p√°gina √∫nica (SPA).  Eu acreditava que o SPA √© o futuro.  Alguns anos depois, n√£o tenho certeza do que √© o futuro, mas definitivamente quero encontrar uma alternativa. <br><a name="habracut"></a><br><h2>  SPA para coelhos </h2><br>  Um aplicativo de uma p√°gina √© um aplicativo JavaScript que, uma vez baixado, obt√©m controle total sem precisar recarregar a p√°gina: renderiza√ß√£o, recebimento de dados do servidor, processamento da intera√ß√£o do usu√°rio, atualiza√ß√£o da tela ... <br><br>  Esses aplicativos parecem mais nativos do que as p√°ginas da Web tradicionais, onde o aplicativo depende do servidor.  Por exemplo, se voc√™ usa o Trello, pode observar a rapidez com que os cart√µes s√£o criados. <br><br>  Obviamente, grande responsabilidade vem com grande for√ßa.  Nos aplicativos da Web tradicionais, o aplicativo do servidor inclui um modelo de dom√≠nio e regras de neg√≥cios, tecnologia de acesso a dados para trabalhar com um banco de dados e uma camada de controlador para controlar como as p√°ginas HTML s√£o montadas em resposta a solicita√ß√µes HTTP. <br><br>  C SPA √© um pouco mais complicado.  Voc√™ ainda precisa de um aplicativo de servidor que inclua seu modelo e regras de dom√≠nio, um servidor Web, um banco de dados e algum tipo de tecnologia de acesso a dados ... e v√°rias outras coisas adicionais: <br><br>  Para servidor: <br><br><ul><li>  Uma API que atende √†s necessidades de dados do seu cliente </li><li>  Um sistema de serializa√ß√£o JSON para troca de dados com o cliente e um sistema de cache que suporta esse </li></ul><br>  Para o novo cliente JavaScript: <br><br><ul><li>  Sistema de modelo para converter dados em HTML </li><li>  Apresenta√ß√£o do seu modelo e regras de dom√≠nio </li><li>  A camada de acesso a dados no aplicativo cliente para transferir dados para o servidor </li><li>  Sistema para atualizar visualiza√ß√µes quando os dados s√£o alterados </li><li>  Um sistema para vincular URLs e telas (espero que voc√™ n√£o use um endere√ßo para tudo, ele n√£o se parece com um aplicativo da web) </li><li>  Um sistema para colar todos os componentes necess√°rios para exibir telas e obter dados para este </li><li>  Novos modelos e arquitetura para organizar tudo quando </li><li>  Sistema para tratamento de erros, registro em log, rastreamento de exce√ß√µes, etc. </li><li>  Sistema para gerar JSON para solicita√ß√µes do servidor </li><li>  Estrutura de teste automatizada que suporta o seu SPA </li><li>  Um conjunto adicional de testes para escrever e dar suporte </li><li>  Um conjunto adicional de ferramentas para montar, empacotar e implantar um novo aplicativo </li></ul><br>  Em suma, com o SPA, voc√™ ter√° outro pedido de suporte.  E um novo conjunto de problemas para resolver.  E observe que voc√™ n√£o pode substituir um aplicativo por outro.  Voc√™ ainda precisa do aplicativo do servidor (agora ele renderizar√° JSON em vez de HTML). <br><br>  Se voc√™ nunca trabalhou com o SPA, pode subestimar as dificuldades que encontrar√°.  Eu sei disso porque cometi os mesmos erros no passado.  Renderizar JSON?  Eu posso lidar com isso.  Um modelo de objeto de dom√≠nio avan√ßado em JavaScript?  Isso parece engra√ßado.  E, voc√™ sabe, essa estrutura resolver√° todos esses problemas.  √ìtimo bolo! <br><br>  <b>Errado.</b> <br><br><h2>  API e troca de dados. </h2><br>  A comunica√ß√£o entre seu novo aplicativo e o servidor √© um problema complexo. <br><br>  Existem duas for√ßas opostas: <br><br><ul><li>  Voc√™ deseja fazer o menor n√∫mero poss√≠vel de solicita√ß√µes de servidor, a fim de melhorar o desempenho. </li><li>  A convers√£o de um √∫nico registro para JSON √© simples.  Mas misturar modelos grandes de v√°rios registros para minimizar o n√∫mero de consultas n√£o √© de todo.  Voc√™ precisar√° desenvolver cuidadosamente a l√≥gica de serializa√ß√£o para otimizar o n√∫mero de consultas ao banco de dados e manter o desempenho no n√≠vel. </li></ul><br>  Al√©m disso, voc√™ precisa pensar no que fazer o download e quando faz√™-lo em cada uma das telas.  Quero dizer, voc√™ precisa de um equil√≠brio entre o bootstrap, o que precisa imediatamente e o que pode ser carregado pregui√ßosamente, e desenvolver uma API que permita fazer isso. <br><br>  Alguns padr√µes podem ajudar aqui.  API JSON para padronizar o formato JSON;  ou GraphQL, para selecionar apenas os dados necess√°rios, t√£o complexos quanto necess√°rios, em uma consulta.  Mas nenhum deles salvar√° voc√™ de: <br><ul><li>  A elabora√ß√£o de cada troca de dados </li><li>  Implementando consultas para selecionar dados com efici√™ncia no servidor </li></ul><br>  E esses dois aspectos representam uma quantidade suficiente de trabalho adicional. <br><br><h2>  Tempo de inicializa√ß√£o </h2><br>  As pessoas est√£o acostumadas a associar SPAs com velocidade, mas a verdade √© que faz√™-los carregar rapidamente n√£o √© t√£o f√°cil.  Existem muitas raz√µes para isso: <br><br><ul><li>  Um aplicativo precisa de dados antes de renderizar algo e leva tempo para analisar uma quantidade suficientemente grande de JavaScript. </li><li>  Al√©m da solicita√ß√£o HTTP inicial para baixar o aplicativo, voc√™ geralmente precisa fazer uma ou mais solicita√ß√µes para obter os dados JSON necess√°rios para renderizar a tela. </li><li>  O cliente deve converter JSON em HTML para mostrar pelo menos alguma coisa.  Dependendo do dispositivo e da quantidade de JSON a ser convertida, isso pode causar atrasos vis√≠veis. </li></ul><br>  Isso n√£o significa que √© imposs√≠vel for√ßar o SPA a carregar rapidamente.  Eu apenas digo que √© dif√≠cil e voc√™ deve cuidar disso, porque n√£o vem com a arquitetura do SPA. <br><br>  Por exemplo, o Discourse, um SPA baseado em Ember, tem tempos de carregamento fant√°sticos, mas, entre outras coisas, pr√©-carrega uma grande quantidade de dados JSON como parte do HTML inicial, para n√£o fazer solicita√ß√µes adicionais.  E noto que a equipe do Discurso √© louca no bom senso de velocidade e suas habilidades est√£o bem acima da m√©dia.  Pense nisso antes de poder reproduzir facilmente o mesmo no seu SPA. <br><br>  Uma solu√ß√£o ambiciosa para esse problema √© o JavaScript isom√≥rfico: renderize sua p√°gina inicial no servidor e entregue-a rapidamente ao cliente, enquanto, no segundo plano do SPA, ele carrega e obt√©m controle total quando estiver pronto. <br><br>  Essa abordagem requer a execu√ß√£o do tempo de execu√ß√£o JavaScript no servidor e tamb√©m n√£o ocorre sem problemas t√©cnicos.  Por exemplo, os desenvolvedores devem considerar os eventos de carregamento do SPA √† medida que o processo de carregamento muda. <br><br>  Gosto da oportunidade de reutilizar o c√≥digo nessa ideia, mas n√£o vi uma implementa√ß√£o que me permitisse seguir na dire√ß√£o oposta.  Al√©m disso, esse processo de renderiza√ß√£o de p√°gina me parece muito engra√ßado: <br><br>  - Servidor: solicita√ß√£o √† API do servidor <br>  - Servidor: consulta ao banco de dados <br>  - Servidor: gera JSON <br>  - Servidor: converte JSON em HTML <br>  - Cliente: exibe HTML inicial <br>  - Cliente: download SPA <br>  - Cliente: analisa o HTML inicial e assina eventos DOM <br><br>  Voc√™ poderia apenas solicitar os dados do banco de dados, gerar o HTML e come√ßar a trabalhar? <br><br>  Isso n√£o √© totalmente justo, porque voc√™ n√£o ser√° o SPA e porque a maior parte dessa m√°gica est√° oculta por tr√°s da estrutura, mas ainda me parece errado. <br><br><h2>  Arquitetura </h2><br>  O desenvolvimento de aplicativos com uma interface de usu√°rio avan√ßada √© dif√≠cil.  Tudo isso porque esse √© um dos problemas que inspiraram o surgimento de uma abordagem orientada a objetos e de muitos padr√µes de design. <br><br>  Gerenciar o status do cliente √© dif√≠cil.  Os sites tradicionais geralmente se concentram em telas de responsabilidade √∫nica que perdem o estado quando s√£o reiniciadas.  No SPA, o aplicativo √© respons√°vel por garantir que todas as atualiza√ß√µes de estado e tela durante o uso sejam consistentes e passem sem problemas. <br><br>  Na pr√°tica, se voc√™ come√ßou a escrever JavaScript em pequenas por√ß√µes para melhorar a intera√ß√£o, no SPA ter√° que escrever toneladas de c√≥digo JavaScript adicional.  Aqui voc√™ deve ter certeza de que est√° fazendo tudo certo. <br><br>  Existem tantas arquiteturas diferentes quanto as estruturas do SPA: <br><br><ul><li>  A maioria das estruturas difere do modelo tradicional do MVC.  O Ember foi inspirado inicialmente pelo Cocoa MVC, mas mudou bastante seu modelo de programa√ß√£o nas vers√µes recentes. </li><li>  H√° uma tend√™ncia de que os desenvolvedores prefiram os componentes do que a separa√ß√£o tradicional do controlador e da apresenta√ß√£o (algumas estruturas, como Ember e Angular, passaram para essa abordagem nas vers√µes recentes).  Todas as estruturas implementam algum tipo de liga√ß√£o de dados unidirecional.  A liga√ß√£o frente e verso √© desencorajada devido aos efeitos colaterais que podem contribuir. </li><li>  A maioria das estruturas inclui um sistema de roteamento que permite mapear URLs e telas e determina como instanciar componentes para renderiza√ß√£o.  Essa √© uma abordagem da Web exclusiva que n√£o existe nas interfaces tradicionais da √°rea de trabalho. </li><li>  A maioria das estruturas separa os modelos HTML do c√≥digo JavaScript, mas o React mistura a gera√ß√£o HTML e o JavaScript e faz isso com bastante sucesso, devido ao seu uso generalizado.  Tamb√©m h√° um hype em torno da incorpora√ß√£o de CSS em JavaScript.  O Facebook, com sua arquitetura Flux, influenciou bastante o setor, e cont√™ineres como Redux, vuex etc. s√£o fortemente influenciados por ele. </li></ul><br>  De todas as estruturas que eu j√° vi, Ember √© o meu favorito.  Adoro a consist√™ncia dele e o fato de ele ser bastante teimoso.  Tamb√©m gosto do seu modelo de programa√ß√£o em vers√µes recentes, combinando MVC, componentes e roteamento tradicionais. <br><br>  Por outro lado, sou fortemente contra o campo Flux / Redux.  Vi tantas pessoas inteligentes usando-as que fiz todos os esfor√ßos para estud√°-lo e compreend√™-lo, e nem uma vez.  N√£o posso deixar de balan√ßar a cabe√ßa em frustra√ß√£o quando vejo o c√≥digo.  N√£o me vejo feliz ao escrever esse c√≥digo. <br><br>  Finalmente, n√£o consigo suportar a mistura de HTML e CSS em componentes cheios de l√≥gica JavaScript.  Entendo o problema que isso resolve, mas os problemas que essa abordagem traz n√£o fazem valer a pena. <br><br>  Vamos deixar as prefer√™ncias pessoais, a conclus√£o √© que, se voc√™ escolher o caminho do SPA, ter√° um problema muito dif√≠cil: criar a arquitetura do seu novo aplicativo corretamente.  E o setor est√° longe de concordar em como fazer isso.  Todos os anos, novas estruturas, modelos e vers√µes de estruturas s√£o exibidas, o que altera levemente o modelo de programa√ß√£o.  Voc√™ precisar√° escrever e manter uma tonelada de c√≥digo com base na sua escolha de arquitetura; portanto, pense corretamente. <br><br><h2>  Duplica√ß√£o de c√≥digo </h2><br>  Ao trabalhar com o SPA, voc√™ provavelmente encontrar√° duplica√ß√£o de c√≥digo. <br><br>  Para sua l√≥gica de SPA, voc√™ desejar√° criar um modelo rico de objetos que representam sua √°rea de dom√≠nio e l√≥gica de neg√≥cios.  E voc√™ ainda precisa da mesma coisa para a l√≥gica do servidor.  E √© uma quest√£o de tempo at√© voc√™ come√ßar a copiar o c√≥digo. <br><br>  Por exemplo, suponha que voc√™ esteja trabalhando com faturas.  Voc√™ provavelmente tem uma classe de fatura em JavaScript que cont√©m um m√©todo total que resume o pre√ßo de todos os elementos para poder renderizar o valor.  No servidor, voc√™ tamb√©m precisar√° da classe Invoice com o m√©todo total para calcular esse custo para envi√°-lo por email.  Voc√™ v√™?  As classes de cliente e servidor de fatura implementam a mesma l√≥gica.  Duplica√ß√£o de c√≥digo. <br><br>  Como dito acima, o JavaScript isom√≥rfico pode atenuar esse problema, facilitando a reutiliza√ß√£o de c√≥digo.  E digo a n√≠vel, porque a correspond√™ncia entre o cliente e o servidor nem sempre √© 1 para 1.  Voc√™ quer ter certeza de que algum c√≥digo nunca sai do servidor.  Uma grande quantidade de c√≥digo faz sentido apenas para o cliente.  Al√©m disso, alguns aspectos s√£o simplesmente diferentes (por exemplo, o elemento do servidor pode salvar dados no banco de dados e o cliente pode usar a API remota).  Reutilizar c√≥digo, mesmo se poss√≠vel, √© um problema complexo. <br><br>  Voc√™ pode apostar que n√£o precisa de um modelo rico em seu SPA e, em vez disso, trabalhar√° diretamente com objetos JSON / JavaScript, distribuindo a l√≥gica entre os componentes da interface do usu√°rio.  Agora voc√™ tem a mesma duplica√ß√£o de c√≥digo misturada com o c√≥digo da interface do usu√°rio, boa sorte com isso. <br><br>  E o mesmo acontece se voc√™ deseja modelos para renderizar HTML entre o servidor e o cliente.  Por exemplo, para SEO, que tal gerar p√°ginas no servidor para mecanismos de pesquisa?  Voc√™ precisar√° reescrever seus modelos no servidor e garantir que eles estejam sincronizados com o cliente.  Novamente duplica√ß√£o de c√≥digo. <br><br>  A necessidade de reproduzir a l√≥gica dos padr√µes no servidor e no cliente, na minha experi√™ncia, √© a fonte do infort√∫nio crescente dos programadores.  Fazer isso uma vez √© normal.  Quando voc√™ fizer isso pela 20¬™ vez, voc√™ apertar√° sua cabe√ßa.  Tendo feito isso pela 50¬™ vez, voc√™ pensar√° se todas essas pe√ßas do SPA s√£o necess√°rias. <br><br><h2>  Fragilidade </h2><br>  Na minha experi√™ncia, desenvolver bons SPAs √© uma tarefa muito mais complicada do que escrever aplicativos da Web com gera√ß√£o de servidores. <br><br>  Primeiro, n√£o importa qu√£o cuidadoso voc√™ seja, n√£o importa quantos testes voc√™ escreva.  Quanto mais c√≥digo voc√™ escrever, mais erros voc√™ ter√°.  E o SPA representa (desculpe, se eu for√ßar) uma enorme pilha de c√≥digo para escrever e dar suporte. <br><br>  Em segundo lugar, como mencionado acima, o desenvolvimento de uma GUI rica √© complicado e se traduz em sistemas complexos que consistem em muitos elementos interagindo entre si.  Quanto mais complexo o sistema voc√™ criar, mais erros voc√™ ter√°.  E comparado aos aplicativos da web tradicionais usando MVC, a complexidade do SPA √© simplesmente insana. <br><br>  Por exemplo, para manter a consist√™ncia no servidor, voc√™ pode usar restri√ß√µes no banco de dados, valida√ß√£o de modelo e transa√ß√µes.  Se algo der errado, voc√™ est√° respondendo com uma mensagem de erro.  No cliente, tudo √© um pouco mais complicado.  Muita coisa pode dar errado, porque muita coisa est√° acontecendo.  Pode ser que algum registro seja salvo com sucesso e outro n√£o.  Talvez voc√™ tenha ficado offline no meio de algum tipo de opera√ß√£o.  Voc√™ deve verificar se a interface do usu√°rio permanece consistente e se o aplicativo est√° se recuperando de um erro.  Tudo isso √© poss√≠vel, √© claro, apenas muito mais complicado. <br><br><h2>  Desafios organizacionais </h2><br>  Parece bobagem, mas para desenvolver um SPA, voc√™ precisa de desenvolvedores que saibam o que fazer com ele.  Ao mesmo tempo, voc√™ n√£o deve subestimar a complexidade do SPA, n√£o deve pensar que qualquer desenvolvedor web experiente, com a motiva√ß√£o e o entendimento certos, possa criar um √≥timo SPA do zero.  Voc√™ precisa das habilidades e experi√™ncia corretas ou espera que erros importantes sejam cometidos.  Eu sei disso porque √© exatamente o meu caso. <br><br>  Esse talvez seja um desafio mais importante para sua empresa do que voc√™ pensa.  A abordagem do SPA incentiva equipes altamente especializadas, em vez de equipes de generalistas: <br><br><ul><li>  As estruturas do SPA s√£o pe√ßas complexas de software que exigem in√∫meras horas de experi√™ncia para serem produtivas.  Somente as pessoas em sua empresa que passam essas horas no c√≥digo poder√£o oferecer suporte a esses aplicativos. </li><li>  As estruturas de SPA requerem APIs bem pensadas e produtivas.  O atendimento a esses requisitos requer um conjunto de habilidades completamente diferente daquelas que exigem trabalho com o SPA. </li></ul><br>  As chances s√£o de que voc√™ se encontre com pessoas que n√£o podem trabalhar com o SPA e que n√£o podem trabalhar no lado do servidor, simplesmente porque n√£o sabem como. <br><br>  Essa especializa√ß√£o pode ser ideal para o Facebook ou o Google e suas equipes, consistindo em v√°rias camadas de tropas de engenharia.  Mas ser√° bom para sua equipe de 6 pessoas? <br><br><h2>  Modern Rails </h2><br>  Existem tr√™s coisas que entram no Rails moderno que podem mudar de id√©ia sobre o desenvolvimento de aplicativos Web modernos: <br><ul><li>  um deles √© Turbolinks e esta √© uma explos√£o cerebral </li><li>  o outro √© um velho amigo que hoje √© esquecido: respostas de SJR e pedidos simples de renderiza√ß√£o de AJAX </li><li>  e o √∫ltimo foi adicionado recentemente: Est√≠mulo </li></ul><br>  √â dif√≠cil entender o que √© aplicar qualquer abordagem sem brincar com ela.  Portanto, farei algumas refer√™ncias ao Basecamp nas pr√≥ximas se√ß√µes.  N√£o tenho nada a ver com o Basecamp, exceto como um usu√°rio feliz.  Quanto a este artigo, este √© apenas um bom exemplo ao vivo do Rails moderno que voc√™ pode experimentar gratuitamente. <br><br><h2>  Turbolinks </h2><br>  A ideia por tr√°s do Turbolinks √© simples: acelere seu aplicativo substituindo completamente as recargas de p√°gina por solicita√ß√µes AJAX que substituem o elemento ``.  A bruxaria interna que faz esse trabalho est√° oculta.  Como desenvolvedor, voc√™ pode se concentrar na programa√ß√£o tradicional do lado do servidor. <br><br>  O Turbolinks √© inspirado no pjax e passou por v√°rias revis√µes. <br><br>  Eu costumava me preocupar com seu desempenho.  Eu estava errado.  A acelera√ß√£o √© enorme.  O que me convenceu foi como o usei no projeto, mas voc√™ pode apenas experimentar a vers√£o de teste no Basecamp e brincar com ela.  Tente criar um projeto com alguns elementos e navegue por eles clicando nas se√ß√µes.  Isso lhe dar√° uma boa id√©ia da apar√™ncia do Turbolinks. <br><br>  N√£o acho que Turbolinks seja simplesmente incr√≠vel com sua novidade (pjax - 8 anos).  Ou sua sofistica√ß√£o t√©cnica.  Surpreende-me como uma id√©ia simples pode aumentar sua produtividade em uma ordem de magnitude em compara√ß√£o com a alternativa ao SPA. <br><br>  Deixe-me destacar alguns dos problemas que ele corrige: <br><br><ul><li>  Troca de dados.  Voc√™ n√£o tem.  N√£o h√° necessidade de serializar JSON, criar APIs ou pensar em solicita√ß√µes de dados que atendam √†s necessidades do cliente em termos de desempenho. </li><li>  Carga inicial.  Ao contr√°rio do SPA, essa abordagem estimula tempos de carregamento r√°pidos (por design).  Para renderizar a tela, voc√™ pode obter os dados necess√°rios diretamente do banco de dados.           HTML ‚Äî    . </li><li> :         JavaScript-.           ,         SPA. </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O MVC no servidor, na vers√£o usada pelo Rails e muitas outras estruturas, √© muito mais simples do que qualquer um dos modelos usados ‚Äã‚Äãpara a rica arquitetura da GUI: obtenha uma solicita√ß√£o, trabalhe com o banco de dados para satisfaz√™-la e exiba a p√°gina HTML como resposta. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por fim, a limita√ß√£o que sempre √© substitu√≠da tem um efeito maravilhoso: voc√™ pode se concentrar na renderiza√ß√£o inicial das p√°ginas, em vez de atualizar determinadas se√ß√µes (ou atualizar algumas condi√ß√µes no mundo do SPA). </font><font style="vertical-align: inherit;">No caso geral, ele apenas faz tudo.</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Duplica√ß√£o de c√≥digo. </font><font style="vertical-align: inherit;">Existe apenas uma visualiza√ß√£o do seu aplicativo que reside no servidor. </font><font style="vertical-align: inherit;">Seu modelo de dom√≠nio, suas regras, telas de aplicativos etc. </font><font style="vertical-align: inherit;">N√£o h√° necessidade de duplicar conceitos no cliente.</font></font></li><li> .    SPA, JavaScript            ,    .  ,         ,    ,   . </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Observe que n√£o estou falando de problemas de nomea√ß√£o, mas de corrigi-los. Por exemplo, a reidrata√ß√£o GraphQL ou SPA s√£o solu√ß√µes super inteligentes para problemas muito complexos. Mas e se, em vez de tentar encontrar uma solu√ß√£o, voc√™ se colocar em uma situa√ß√£o em que esses problemas n√£o existem? Esta √© uma mudan√ßa na abordagem do problema. E levei anos para apreciar completamente a capacidade dessa abordagem para resolver problemas. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Claro, Turbolinks n√£o √© uma bala de prata sem complica√ß√µes. O maior problema √© que ele pode quebrar o c√≥digo JavaScript existente:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O Turbolinks √© enviado com seu evento personalizado de "carregamento da p√°gina", e os plug-ins existentes que dependem do carregamento regular da p√°gina n√£o funcionam. </font><font style="vertical-align: inherit;">Hoje existem maneiras melhores de adicionar comportamento ao DOM, mas os widgets herdados n√£o funcionar√£o se n√£o forem adaptados.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O c√≥digo JavaScript que modifica o DOM deve ser idempotente, pois pode ser executado v√°rias vezes. </font><font style="vertical-align: inherit;">Novamente, isso invalida muito JavaScript existente.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A velocidade √© excelente, mas n√£o √© exatamente como no SPA, que pode lidar com algumas intera√ß√µes sem carregar o servidor. </font><font style="vertical-align: inherit;">Falarei mais sobre compromissos mais tarde.</font></font></li></ul><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Respostas de renderiza√ß√£o AJAX e SJR </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lembra quando a renderiza√ß√£o de HTML pelo Ajax era uma tend√™ncia h√° 15 anos? </font><font style="vertical-align: inherit;">Adivinha o que? </font><font style="vertical-align: inherit;">Essa ainda √© uma √≥tima ferramenta no seu arsenal:</font></font><br><ul><li>   HTML       DOM,   ( 100 ). </li><li>    HTML  ,              . </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voc√™ pode ver como essa abordagem √© sentida no Basecamp, abrindo o menu do seu perfil clicando no bot√£o superior direito: </font></font><br><br><img src="https://habrastorage.org/webt/yc/6b/th/yc6bth2x9on2cvks1r34w937xey.gif"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abre instantaneamente. Do lado do desenvolvimento, voc√™ n√£o precisa se preocupar com a serializa√ß√£o JSON e o lado do cliente. Voc√™ pode simplesmente exibir este fragmento no servidor, usando todos os recursos do Rails. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uma ferramenta semelhante que o Rails incluiu ao longo dos anos s√£o as respostas JavaScript do lado do servidor (SJR). Eles permitem que voc√™ responda √†s solicita√ß√µes do Ajax (geralmente envios de formul√°rios) com JavaScript que √© executado pelo cliente. Ele oferece os mesmos benef√≠cios que a renderiza√ß√£o AJAX de trechos de HTML: √© executado muito r√°pido, voc√™ pode reutilizar o c√≥digo no lado do servidor e acessar diretamente o banco de dados para criar uma resposta.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voc√™ pode ver como isso acontece se voc√™ entrar no Basecamp e tentar criar um novo todo. </font><font style="vertical-align: inherit;">Depois de clicar em "Adicionar todo", o servidor salvar√° o todo e responder√° com um fragmento JavaScript que adiciona um novo todo ao DOM. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eu acho que muitos desenvolvedores hoje olham para a renderiza√ß√£o AJAX e as respostas SJR com desprezo. </font><font style="vertical-align: inherit;">Eu tamb√©m lembro disso. </font><font style="vertical-align: inherit;">Eles s√£o uma ferramenta e, como tal, podem ser abusados. </font><font style="vertical-align: inherit;">Mas quando usada corretamente, esta √© uma solu√ß√£o fant√°stica. </font><font style="vertical-align: inherit;">Permite oferecer excelente experi√™ncia de usu√°rio e interatividade por um pre√ßo muito baixo. </font><font style="vertical-align: inherit;">Infelizmente, como o Turbolinks, eles s√£o dif√≠ceis de avaliar se voc√™ ainda n√£o lutou com o SPA.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Est√≠mulo </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O est√≠mulo √© uma estrutura JavaScript publicada h√° alguns meses. </font><font style="vertical-align: inherit;">Ele n√£o se importa com renderiza√ß√£o ou gerenciamento de estado baseado em JavaScript. </font><font style="vertical-align: inherit;">Em vez disso, √© apenas uma maneira moderna e agrad√°vel de organizar o JavaScript, que voc√™ usa para adicionar HTML:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ele usa MutationObserver para vincular o comportamento ao DOM, o que significa que n√£o se importa com a apar√™ncia do HTML na p√°gina. </font><font style="vertical-align: inherit;">Obviamente, isso funciona muito bem com o Turbolinks.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Isso economizar√° uma tonelada de c√≥digo padr√£o para anexar o comportamento ao DOM, anexar manipuladores de eventos a eventos e colocar elementos no cont√™iner especificado. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Seu objetivo √© tornar seu c√≥digo HTML leg√≠vel e compreens√≠vel, o que √© bom se voc√™ j√° encontrou o problema de descobrir qual parte do JavaScript est√° agindo nesse maldito elemento. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Incentiva a persist√™ncia no DOM. </font><font style="vertical-align: inherit;">Novamente, isso significa que ele n√£o se importa com a forma como o HTML √© gerado, o que √© adequado para muitos cen√°rios, incluindo Turbolinks.</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se voc√™ aceitar o caminho do Rails, seu JavaScript se concentrar√° em modificar o c√≥digo HTML do servidor e melhorar a intera√ß√£o (com um pouco de JavaScript). </font><font style="vertical-align: inherit;">O est√≠mulo foi projetado para organizar esse c√≥digo. </font><font style="vertical-align: inherit;">Este n√£o √© um sistema de SPA e n√£o pretende ser um. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eu usei o Stimulus em v√°rios projetos e realmente gosto disso. </font><font style="vertical-align: inherit;">Ele elimina um monte de c√≥digo padr√£o, √© constru√≠do com os mais recentes padr√µes da web e l√™ muito bem. </font><font style="vertical-align: inherit;">E algo que eu particularmente amo: agora essa √© a maneira padr√£o de fazer algo que ainda precisava ser resolvido em todas as aplica√ß√µes.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Jogo de compromisso </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Turbolinks √© geralmente vendido como "Obtenha todos os benef√≠cios do SPA sem qualquer inconveniente". </font><font style="vertical-align: inherit;">Eu n√£o acho que isso seja completamente verdade:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Os aplicativos criados com o Rails moderno parecem r√°pidos, mas o SPA ainda responder√° mais rapidamente √†s intera√ß√µes independentes do servidor. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Existem cen√°rios em que o SPA faz mais sentido. </font><font style="vertical-align: inherit;">Se voc√™ precisar oferecer um alto n√≠vel de interatividade, precisar√° gerenciar um grande n√∫mero de estados, executar l√≥gica complexa no lado do cliente etc. A estrutura do SPA facilitar√° sua vida.</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agora o desenvolvimento √© um jogo de compromisso. </font><font style="vertical-align: inherit;">E neste jogo:</font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O Modern Rails permite criar aplicativos que s√£o r√°pidos o suficiente e com √≥tima apar√™ncia. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Para uma enorme variedade de aplica√ß√µes, o Rails permite implementar as mesmas fun√ß√µes com menos c√≥digo e menos complexidade. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acredito que com o Rails voc√™ pode obter 90% do que o SPA oferece com 10% de esfor√ßo. </font><font style="vertical-align: inherit;">Em termos de desempenho, o Rails mata o SPA. </font><font style="vertical-align: inherit;">Quanto ao UX, acho que muitos desenvolvedores cometem o mesmo erro que eu, assumindo que o SPA UX seja insuper√°vel.</font></font> Isto n√£o √© verdade.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> De fato, como discutido acima, √© melhor voc√™ saber o que est√° fazendo ao criar seu SPA ou o UX ser√° realmente pior. </font></font><br><br><h2>  Conclus√£o </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Observo as empresas massivamente aceitarem estruturas de SPA e vejo in√∫meros artigos sobre como fazer coisas sofisticadas no estilo de SPA. Eu acho que existem muitos "usos da ferramenta errada para o trabalho", pois acredito firmemente que os tipos de aplicativos que justificam o uso do SPA s√£o limitados. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E eu digo que eles justificam porque os SPAs s√£o complexos. De qualquer forma, espero ter convencido voc√™ disso. N√£o estou dizendo que √© imposs√≠vel criar excelentes aplicativos de SPA ou que os aplicativos modernos do Rails s√£o √≥timos por defini√ß√£o, apenas uma abordagem √© super complicada e a outra √© muito mais simples. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enquanto preparava este artigo, me deparei com este tweet:</font></font><br><br><img src="https://habrastorage.org/webt/px/54/rc/px54rc9odiplrsororeiozro--c.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Isso me fez rir, porque eu escolheria as primeiras op√ß√µes se a alternativa n√£o fosse justificada. Ele tamb√©m √© um representante do tipo de pensamento dos desenvolvedores que amam a complexidade e prosperam, mesmo pensando que outras pessoas com crit√©rios diferentes s√£o loucas. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Depois de muitos anos, percebi que a complexidade costuma ser uma escolha. Mas no mundo da programa√ß√£o, √© surpreendentemente dif√≠cil escolher a simplicidade. Valorizamos tanto a complexidade que aceitar a simplicidade geralmente nos faz pensar de maneira diferente, o que √© dif√≠cil por defini√ß√£o.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lembre-se de que voc√™ pode se livrar dos problemas. </font><font style="vertical-align: inherit;">Se voc√™ escolher o caminho do SPA, verifique se ele √© justificado e entenda os problemas. </font><font style="vertical-align: inherit;">Se voc√™ n√£o tiver certeza, experimente abordagens diferentes e veja por si mesmo. </font><font style="vertical-align: inherit;">Talvez o Facebook ou o Google, em sua escala, n√£o tenham o luxo de tomar essas decis√µes, mas voc√™ provavelmente pode. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E se voc√™ √© um desenvolvedor do Rails que deixou o Rails h√° muitos anos, recomendo que voc√™ retorne a ele. </font><font style="vertical-align: inherit;">Eu acho que voc√™ ficar√° encantado.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt417875/">https://habr.com/ru/post/pt417875/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt417865/index.html">Acessibilidade Android - um lobo em pele de cordeiro? Palestra Yandex</a></li>
<li><a href="../pt417867/index.html">Como avaliar a dura√ß√£o de um projeto de TI e quando n√£o vale a pena fazer nada</a></li>
<li><a href="../pt417869/index.html">Como depurar o WebRTC</a></li>
<li><a href="../pt417871/index.html">Na linha de chegada do turismo suborbital</a></li>
<li><a href="../pt417873/index.html">Maneiras de criar janelas pop-up</a></li>
<li><a href="../pt417877/index.html">Como o Tinder (ligeiramente) oculta sua localiza√ß√£o</a></li>
<li><a href="../pt417879/index.html">Como fazer exames da Microsoft gratuitamente [por exemplo, uma competi√ß√£o recente]</a></li>
<li><a href="../pt417881/index.html">O resumo de materiais frescos do mundo do front-end nas √∫ltimas duas semanas n ¬∞ 323 (8 a 22 de julho de 2018)</a></li>
<li><a href="../pt417883/index.html">Criando um di√°logo para escolher um toque</a></li>
<li><a href="../pt417885/index.html">Sobre M e sobre V e um pouco sobre C</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>