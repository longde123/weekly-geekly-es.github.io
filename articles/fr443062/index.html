<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëÉüèø üë©üèø‚Äçü§ù‚Äçüë©üèª üî§ Comment j'ai cr√©√© Recycle! VR üéÖüèæ üë∑üèª üôáüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans l' article pr√©c√©dent, nous avons essay√© de cr√©er une sc√®ne de base dans A-Frame afin d'essayer les concepts de base du cadre dans la pratique. Da...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment j'ai cr√©√© Recycle! VR</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/443062/"><img src="https://habrastorage.org/webt/zw/1k/9x/zw1k9xfuttgxodgleuo-ksko4nq.png"><br><br>  Dans l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article pr√©c√©dent,</a> nous avons essay√© de cr√©er une sc√®ne de base dans A-Frame afin d'essayer les concepts de base du cadre dans la pratique.  Dans cet article, je voudrais partager mon exp√©rience dans la cr√©ation d'un jeu sur A-Frame - Recycle!  VR  Le r√©f√©rentiel de projet est disponible sur le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">lien suivant</a> . <br><br><h2>  Recyclage!? </h2><br>  L'id√©e de cr√©er un jeu est venue presque imm√©diatement d√®s que j'ai d√©couvert le Web VR.  Bien qu'en g√©n√©ral, je pense que les jeux sur le web seront en tout cas inf√©rieurs aux bons projets m√™me pour les appareils mobiles, sans parler des ordinateurs personnels et des consoles.  Mais il me semble que le jeu est le test le plus difficile.  J'ai commenc√© √† penser exactement √† ce que je pouvais faire.  J'ai regard√© d'autres projets et j'ai √©t√© imm√©diatement frapp√© par l'opportunit√© de prendre quelque chose √† l'aide du contr√¥leur.  Et depuis que je suis connect√© √† une organisation qui s'occupe de la collecte s√©par√©e des d√©chets depuis un certain temps, la r√©ponse est venue d'elle-m√™me.  Le recyclage.  Nous prenons la poubelle et la jetons √† la poubelle.  Quoi de plus simple.  Mais tout s'est av√©r√© pas si simple, et cela, en fait, sera discut√© plus loin. <br><a name="habracut"></a><br><h2>  S√©lection du cadre </h2><br>  Lors du d√©marrage des travaux sur le jeu, je ne connaissais que 2 frameworks plus ou moins s√©rieux: React 360, A-Frame.  De toute √©vidence, A-Frame √©tait le plus appropri√© pour cr√©er le jeu.  Oui, maintenant je sais qu'il existe toujours un moteur de jeu PlayCanvas qui prend √©galement en charge la VR, mais il est trop tard.  De plus, il s'est av√©r√© que A-Frame n'est pas non plus mauvais pour cr√©er des jeux. <br><br><h2>  Par o√π commencer? </h2><br>  J'ai commenc√© par √©tudier des exemples de jeux officiels de d√©veloppeurs A-Frame.  L'avantage de tant de choses.  A-Blast, A-Painter, Museum, Super Craft et maintenant aussi Gunters of Oasis.  De tous les projets pr√©sent√©s, j'ai le plus aim√© A-Blast - un jeu de tir dans lequel vous devez vous battre avec les cr√©atures les plus mignonnes de l'univers.  Par cons√©quent, je voulais prendre ce jeu comme mod√®le pour le mien.  Mais √ßa n'a pas march√©.  Et la raison en √©tait la structure du jeu.  Il me semblait qu'elle √©tait trop encombr√©e et non r√©fl√©chie.  Il n'est peut-√™tre pas n√©cessaire d'en faire plus, mais je voulais faire quelque chose de plus pratique et plus facile √† comprendre. <br><br><h2>  La structure </h2><br>  La structure <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">A-Blast</a> ne repr√©sente qu'un seul point d'entr√©e - le fichier index.html, qui contient une sc√®ne avec tous les actifs, les entit√©s de jeu de base, les contr√¥les et tout en g√©n√©ral. <br><br><img src="https://habrastorage.org/webt/_t/gy/cv/_tgycvogik29i2jemys2srlpuuy.png"><br><br>  Comme vous pouvez le voir sur la capture d'√©cran, en plus des composants et des syst√®mes n√©cessaires (A-Frame utilise le mod√®le Entity Component System), il y a aussi des balles et des ennemis - essentiellement les m√™mes syst√®mes, mais pour une raison quelconque, ils ont leur propre wrapper.  Dites g√©n√©ralement que ce code n'est pas facile √† comprendre.  J'ai donc d√©cid√© de r√©fl√©chir √† la fa√ßon dont ce code peut √™tre structur√©.  La premi√®re id√©e est de d√©composer la sc√®ne en ses parties constituantes.  Pourquoi un routeur et des mod√®les seraient-ils utiles, qui rendraient telle ou telle partie de la sc√®ne?  Apr√®s avoir recherch√© la premi√®re et la seconde (non, pas cinq minutes), je n'ai rien trouv√©.  M√™me si je suis partisan de la r√®gle, n'√©crivez pas de v√©los, mais cette fois j'ai d√ª √©crire ma d√©cision.  Cependant, quelque part en 2-3 semaines, je suis tomb√© sur des mod√®les de Kevin Ngo.  Mais c'√©tait trop tard. <br><br><h2>  Routeur et mod√®les </h2><br><img src="https://habrastorage.org/webt/sp/bm/tn/spbmtnkznus5jjfffyvhjys6xvg.gif"><br><br>  Et donc, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">un mod√®le de routeur de trame</a> entre en sc√®ne.  Que peut-il faire?  Comme mentionn√© ci-dessus, sa t√¢che principale est de rendre les parties n√©cessaires du jeu, par exemple, l'√©cran de titre, le terrain de jeu, l'√©cran de fin du jeu, etc.  Comment faire  En principe, vous pouvez trouver tout ce dont vous avez besoin dans la documentation du module sur github, mais en bref, nous avons les √©l√©ments suivants: <br><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-scene</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">router</span></span></span><span class="hljs-tag">&gt;</span></span> ... <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Routes --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-route</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"start-screen"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">template</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"start-screen"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-route</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-route</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"game-field"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">template</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"game-field"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-route</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-route</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"game-over"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">template</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"game-over"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-route</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-route</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"how-to-play"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">template</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"how-to-play"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-route</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- End Routes --&gt;</span></span> ... <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Templates --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"controls"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- End Templates --&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-scene</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><ol><li>  Nous ajoutons le composant routeur √† la sc√®ne. </li><li>  Ajoutez un itin√©raire pour chaque partie de l'application (images de la sc√®ne).  Un itin√©raire pour l'√©cran d'accueil, un autre pour le terrain de jeu, etc. </li><li>  Rendre les mod√®les directement via a-templates </li><li>  Si n√©cessaire, nous changeons d'itin√©raire <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.el.systems.router.changeRoute(<span class="hljs-string"><span class="hljs-string">'game-field'</span></span>);</code> </pre> <br>  <b>Remarque</b> : cet exemple fait r√©f√©rence au code de sc√®ne, nous pouvons donc appeler directement le syst√®me de routeur. </li><li>  Nous d√©finissons et connectons les mod√®les, quelque chose comme ceci: <br><br><pre> <code class="javascript hljs">AFRAME.registerTemplate(<span class="hljs-string"><span class="hljs-string">'game-field'</span></span>, <span class="hljs-string"><span class="hljs-string">` &lt;a-sub-assets&gt; &lt;a-asset-item id="glass" src="/assets/models/glass_bottle.gltf"&gt;&lt;/a-asset-item&gt; ... &lt;audio id="fail" src="/assets/sounds/fail.wav" preload&gt;&lt;/audio&gt; &lt;/a-sub-assets&gt; &lt;a-template name="button" options="text: EXIT; position: 0 1 4; rotation: 0 180 0; event: stop-game"&gt;&lt;/a-template&gt; &lt;a-entity id="indicator" indicator visible="false" position="0 1 -2" text="align: center; width: 4; color: #00A105; value: -1" &gt;&lt;/a-entity&gt; &lt;a-entity game-field-manager&gt;&lt;/a-entity&gt; `</span></span>);</code> </pre><br>  <b>Remarque: les</b> sous-actifs vous permettent de charger des actifs ainsi que des actifs, mais seulement avec la diff√©rence qu'il y a une v√©rification par d√©faut et si l'actif est d√©j√† ajout√©, il ne sera pas ajout√© √† nouveau lorsque l'itin√©raire sera modifi√©. <br><br>  <b>Remarque 2:</b> Normalement, vous ne pouvez utiliser des mod√®les qu'avec la cha√Æne de mod√®le ES6.  Sinon, il peut se transformer en ¬´cha√Æne¬ª + var + ¬´cha√Æne¬ª, pas cool.  Kevin, par exemple, prend en charge les moteurs de mod√®le.  Mais pourquoi le compliquer, non? <br></li></ol><br>  Ainsi, vous pouvez cr√©er une structure d'application pratique qui contiendra les √©l√©ments suivants: <i>composants, syst√®mes, mod√®les, √©tats, biblioth√®ques</i> .  Rien de plus et tout est sur les √©tag√®res. <br><br><h2>  Manipulation d'objets </h2><br><img src="https://habrastorage.org/webt/zm/m1/i3/zmm1i3r-m5no1cptxljmjcwr88u.gif"><br><br>  La toute premi√®re t√¢che √† r√©soudre √©tait la manipulation d'objets.  J'avais besoin d 'un lancer fonctionnel.  Au d√©but, j'ai commenc√© √† r√©fl√©chir √† la fa√ßon de cr√©er un tel composant √† partir de z√©ro.  Purement au niveau philistin, une telle r√©flexion est admissible: nous avons un contr√¥leur (dans le cas d'un bureau c'est un curseur), il a une position.  Nous avons aussi certains objets, par exemple des cubes, ils ont aussi une position.  En changeant la position du contr√¥leur, nous devons changer la position de l'objet.  C'est simple?  Donc, en fait, oui, mais √ßa ne marchera pas.  Je mentionnerai quelques points d'une tr√®s longue liste pour vous en convaincre: <br><br><ul><li>  Le curseur dans A-Frame est un descendant d'une cam√©ra et a des coordonn√©es relatives; </li><li>  La position du contr√¥leur ne suffit pas, vous devez toujours tenir compte de l'orientation, de la distance √† l'objet, de la position de la cam√©ra (joueur); </li><li>  Pour les objets avec un corps physique, cela ne fonctionnera pas du tout, car les coordonn√©es de la g√©om√©trie sont li√©es aux coordonn√©es du corps. </li></ul><br>  C'est bien que le bon M. Wil Murphy et ses amis aient fait <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">un super-cadre</a> .  En substance, cette biblioth√®que contient tous les composants n√©cessaires: <br><br><ul><li>  <b>hoverable</b> .  Orientation.  Pointez le contr√¥leur ou le curseur sur la zone de collision de l'objet (g√©n√©ralement l'objet entier) </li><li>  <b>saisissable</b> : capture.  Saisissez un objet √† l'aide du bouton appropri√© et faites-le glisser </li><li>  <b>extensible</b> : saisir avec les deux mains et √©tirer \ presser </li><li>  <b>draggable \ dropable</b> : Essentiellement n√©cessaire pour d√©terminer l'√©v√©nement ¬´l'√©l√©ment a √©t√© lanc√© √† un emplacement sp√©cifique¬ª </li></ul><br>  Vous pouvez trouver tout ce dont vous avez besoin pour configurer et connecter des super-mains dans le r√©f√©rentiel mentionn√© ci-dessus.  Je veux juste attirer l'attention sur un certain nombre de nuances: <br><br><ul><li>  Cr√©ez des mixins s√©par√©s pour la main droite et la main gauche.  S√©parez les composants par type de p√©riph√©riques pris en charge.  Par exemple, la main droite, en plus des commandes oculus-touch, vive-controls, windows-motion-control, il peut √©galement y avoir des commandes oculus-go et des commandes gear-vr.  La main gauche doit √™tre cach√©e pour les casques mobiles BP.  Chaque contr√¥leur doit contenir √† la fois des mains mixin et un composant super-mains.  <a href="">Un exemple</a> ; </li><li>  Si vous avez sp√©cifi√© des objets: .clsname pour reycaster, n'oubliez pas de l'ajouter √† chaque √©l√©ment qui peut √™tre pris √† l'aide du contr√¥leur, sinon aucun √©v√©nement pour les super-mains √©chouera.  Bien s√ªr, si <i>colliderEvent: raycaster-intersection</i> ; </li><li>  Faire glisser avec la souris projette les coordonn√©es 2D dans le monde 3D, il est donc pr√©f√©rable d'utiliser le curseur pour le bureau. </li></ul><br><h2>  Ajouter de la physique </h2><br>  Ajouter de la physique √† un cadre est en fait tr√®s simple.  Il existe un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">syst√®me sp√©cial</a> pour cela.  Il est ajout√© √† la sc√®ne et le tour est jou√©, la physique est d√©j√† dans votre poche. <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-scene</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">physics</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"debug: false"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-box</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">dynamic-body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">position</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0 1 -2"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-box</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-box</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"floor"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">static-body</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-box</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a-scene</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  <b>Mark</b> : <i>debug: true</i> permet de visualiser les corps physiques li√©s √† la g√©om√©trie.  Il est pratique lorsque vous devez ¬´contourner¬ª un objet. <br><br>  En fait, c'est un wrapper pour <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cannon.js</a> qui fait tout le sale boulot de comparer la g√©om√©trie et les corps physiques pour vous.  Encore une fois, sur le fonctionnement de ce syst√®me, vous pouvez le trouver dans la description du r√©f√©rentiel.  Et je voudrais m'attarder sur un seul point important pour mon jeu. <br><br>  Je devais m'assurer qu'en appuyant sur le bouton de la corbeille, une certaine force √©tait d√©finie (plus vous maintenez le bouton enfonc√©, plus la force est grande).  Il s'est av√©r√© que cette t√¢che n'est pas aussi simple qu'il y para√Æt √† premi√®re vue.  Eh bien, qu'est-ce qui est si compliqu√©?  - vous dites, nous <i>appliquons Impluse</i> et le tour est jou√©.  Pas vraiment ... Il d√©finit la rotation d'un objet le long d'un vecteur appliqu√© au centre du corps.  En utilisant cette m√©thode, nous ne pouvons qu'√©muler un yule.  Cependant, si vous d√©finissez un vecteur avec l'angle correct par rapport au plan, vous pouvez obtenir quelque chose de similaire √† une pouss√©e.  Mais ce n'est pas ce dont j'avais besoin. <br><br>  Il s'est av√©r√© que j'avais besoin de vitesse lors du r√©glage de ce param√®tre, l'objet commence son mouvement dans une direction donn√©e.  Cette direction est sp√©cifi√©e par le vecteur.  Et ici, le plaisir commence.  Comment trouver ce vecteur?  J'ai trouv√© deux options: <br><br><ol><li>  Obtenez le quaternion du contr√¥leur (ou de la cam√©ra pour le bureau), qui d√©crit son orientation dans l'espace.  Cr√©ez un vecteur V1 = &lt;1,1,1&gt;, multipliez-le par la force de projection et appliquez l'orientation √† tout cela. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> velocityVector = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.Vector3(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>); velocityVector.multiplyScalar(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.force); velocityVector.applyQuaternion(controllerQuaternion); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.grabbed.body.velocity.set(velocityVector.x, velocityVector.y, velocityVector.z);</code> </pre></li><li>  Trouvez la position du contr√¥leur (curseur) et la position de l'objet lanc√©.  Calculez le vecteur de direction pour deux points.  Normalisez le vecteur.  Et multipliez-le par la force. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> directionX = (trashPosition.x - zeroPosition.x); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> directionZ = (trashPosition.z - zeroPosition.z); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> vectorsLength = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.sqrt(<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.pow(directionX, <span class="hljs-number"><span class="hljs-number">2</span></span>) + <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.pow(directionZ, <span class="hljs-number"><span class="hljs-number">2</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> x = (directionX / vectorsLength) * <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.force; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> y = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.force; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> z = (directionZ / vectorsLength) * <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.force; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.grabbed.body.velocity.set(x , y, z );</code> </pre></li></ol><br>  J'ai choisi la deuxi√®me option car je ne peux y compter que x et z.  Et placez-vous vous-m√™me, car j'avais besoin d'un lancer le long de l'arc pour que les d√©chets d√©vers√©s tombent dans le panier, malgr√© que l'utilisateur tienne le contr√¥leur. <br><br><h2>  Quelques mots sur le mod√®le </h2><br><img src="https://habrastorage.org/webt/vt/fl/e9/vtfle9xqpvbpak4i2su4fusxplk.png"><br><br>  D√®s le d√©but, j'ai d√©cid√© de faire un jeu de style <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">low-poly</a> .  Bien que WebGL soit capable de rendre des sc√®nes relativement complexes aujourd'hui, ses performances sont toujours inf√©rieures aux biblioth√®ques avanc√©es telles que DirectX, Vulkan, Mantle, etc. Tout d√©pend √©galement des performances de l'appareil de l'utilisateur.  Comme je voudrais me concentrer sur les casques mobiles BP plus abordables (Oculus Go, Gear VR), je pense que le low-poly est l'une des rares solutions pour cr√©er une application ou un jeu VR.  Bien s√ªr, tout d√©pend du volume. <br><br>  D'accord, le low-poly est tellement low-poly, mais comment faire tout cela?  Tout est tr√®s simple, il existe un bon outil open source - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Blender</a> .  Croyez-moi, il est capable de beaucoup, mais pour des t√¢ches simples, il ne convient pas tout √† fait.  Il existe de nombreux supports de formation li√©s √† la mod√©lisation dans Blender et il ne sera pas difficile de les trouver.  Je voulais juste concentrer votre attention sur un certain nombre de points li√©s au d√©veloppement web: <br><br><ol><li>  L'exportateur Three-js est obsol√®te.  Besoin de trouver et de fournir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">un exportateur GLTF</a> .  GLTF est un format sp√©cial con√ßu pour le Web.  Et oui, c'est JSON. </li><li>  GLTF ne prend pas en charge Cycles Renderer, vous devez donc utiliser Blender Renderer.  Et cela signifie qu'il n'y aura pas de n≈ìuds frais, de transformations de couleurs, de reflets m√©talliques (cela peut √™tre fait diff√©remment). </li><li>  Vous devez exporter uniquement l'√©l√©ment s√©lectionn√©.  Vous n'avez pas besoin de cam√©ras et de lumi√®res suppl√©mentaires?  Fichier&gt; Exporter&gt; gltf 2.0.  Dans le menu de gauche, Exporter GLTF 2.0&gt; Exporter uniquement s√©lectionn√©. </li><li>  Nous commen√ßons √† exporter √† partir de la position &lt;0, 0, 0&gt; dans Blender.  Il est pr√©f√©rable de mettre √† l'√©chelle au m√™me endroit, afin que plus tard vous n'utilisiez pas le composant d'√©chelle dans un cadre. </li><li>  Si vous dessinez un espace ouvert comme dans Recycle!  VR, vous devez ajouter des objets uniquement √† l'endroit o√π le joueur peut th√©oriquement regarder.  Derri√®re, derri√®re les maisons, dans le Recycle!  il y a quelques arbres et seulement √† l'endroit o√π l'utilisateur peut les voir.  Il n‚Äôest pas n√©cessaire de surcharger la sc√®ne. </li><li>  Si vous devez changer le mat√©riau du mod√®le, vous devez attendre qu'il se charge, obtenir le mod√®le lui-m√™me, en extraire tous les n≈ìuds (GLTF contient des informations non seulement sur les maillages) <br><br><pre> <code class="javascript hljs">e.detail.model.traverse(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">node</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (node.isMesh) { node.material.color = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.Color(someColor); } });</code> </pre></li></ol><br><h2>  En conclusion </h2><br>  Merci √† tous pour votre attention!  Je vous rappelle encore une fois que le r√©f√©rentiel du projet est disponible sur le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">lien suivant</a> .  Quiconque veut apporter quelque chose de nouveau √† ce jeu - bienvenue. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr443062/">https://habr.com/ru/post/fr443062/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr443052/index.html">Belle montre pr√©cise d'un vieux smartphone</a></li>
<li><a href="../fr443054/index.html">Une s√©lection d'utilitaires pour un programmeur sous Linux</a></li>
<li><a href="../fr443056/index.html">Un deuxi√®me patient atteint du VIH atteint une r√©mission</a></li>
<li><a href="../fr443058/index.html">Architecture √©pur√©e. Partie I - Introduction</a></li>
<li><a href="../fr443060/index.html">Est-ce que Starship atteindra Mars?</a></li>
<li><a href="../fr443064/index.html">Une sonde isra√©lienne vole vers la lune</a></li>
<li><a href="../fr443066/index.html">Socrate amoureux: qui a jet√© les bases de la philosophie occidentale</a></li>
<li><a href="../fr443070/index.html">Des id√©es pr√©matur√©es et opportunes sur l'exemple des fr√®res Gracchus</a></li>
<li><a href="../fr443080/index.html">Les disques durs des ordinateurs portables et des ordinateurs de bureau peuvent √™tre une source d'√©coute des conversations des personnes √† proximit√©</a></li>
<li><a href="../fr443082/index.html">Pourquoi vous ne devriez pas regarder les autres lorsque vous apprenez une langue</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>