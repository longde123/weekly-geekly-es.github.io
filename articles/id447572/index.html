<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👮 👆🏿 🚺 Energi, panas, dan air: bagian dua ⬇️ 🚿 👱</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pertimbangkan tahap selanjutnya dalam pengembangan skema rumah pintar dari cara improvisasi :) (lanjutan, artikel pertama di sini ). 

 Tugas yang har...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Energi, panas, dan air: bagian dua</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/447572/">  Pertimbangkan tahap selanjutnya dalam pengembangan skema rumah pintar dari cara improvisasi :) (lanjutan, artikel pertama di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> ). <br><br><h2>  Tugas yang harus diselesaikan: </h2><br><ol><li>  Perlindungan kebocoran <br><br>  + Remote control <br>  + Mengetahui keadaan input air (tersumbat atau terbuka) </li><li>  Ketahui tekanan dan suhu cairan pendingin di sirkuit pemanas </li><li>  Ketahui tekanan dalam sistem pasokan air </li></ol><br>  Pemantauan masih dalam tampilan antarmuka tunggal (Zabbix), pemberitahuan - melalui mekanisme peringatan tunggal.  Tetapi manajemen adalah sesuatu yang baru.  Tentang itu - selanjutnya. <br><br><h2>  1. Perlindungan kebocoran </h2><br>  <i>Ya, ini adalah topik yang usang, perangkat - selusin sepeser pun!</i>  <i>Semuanya bekerja di luar kotak!</i> <br><br>  Jadi saya berpikir dan salah lagi.  Sebenarnya ada banyak solusi siap pakai, tetapi untuk menemukan solusi komprehensif dengan kemampuan untuk mengontrol dan memantau dari jarak jauh, tetapi tanpa menggunakan "cloud" / akun pribadi seseorang, ternyata menjadi tugas yang hampir mustahil.  Baiklah, pertanian kolektif lagi, mari kita coba selesaikan masalah tanpa setrika dan pengkodean. <br><br>  Total yang saya butuhkan: <br><br><ol><li>  katup bola bermotor </li><li>  detektor kebocoran </li><li>  pengontrol tertentu dengan antarmuka pemantauan dan kontrol </li><li>  relay daya </li></ol><a name="habracut"></a><br>  Katup bola mencari kualitas yang lebih baik - bukan noname.  Saya memilih solusi utama gidrolock berdasarkan bugatti 3/4 crane.  Penggerak listrik bekerja dari 12V. <br><br>  Apa yang bisa mengendalikan derek 12V?  Ada beberapa opsi untuk pengendali yang menerapkan logika "Saya melihat sensor dipicu, saya melakukan tindakan."  Pada prinsipnya, apa yang Anda butuhkan, tetapi alangkah baiknya memiliki semacam API untuk kendali jarak jauh.  Pertama, ini akan memungkinkan untuk menggantung semua tempat yang mungkin dengan sensor kebocoran, dan memblokir air hanya di satu tempat (walaupun dengan beberapa penundaan untuk waktu mengumpulkan keadaan dan mengirim reaksi).  Kedua, prosedur akan menjadi jauh, yang berarti bahwa akan mungkin mematikan air, misalnya, jika tidak ada pemilik rumah.  Solusinya muncul tiba-tiba.  Saya ingat bahwa bahkan sekali saya “merasakan” alat dengan logika yang sama dan semua jenis pegangan, yang disebut netping.  Ternyata mereka bahkan memecahkan masalah yang sama.  Tautan ke deskripsi howto ada di akhir artikel. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1c9/bc7/2df/1c9bc72df62415b78ea24e13c9c2a4c7.jpg" alt="gambar"><br><br>  + Anda memerlukan catu daya 0,5A lainnya untuk menghidupkan perangkat netping (tidak termasuk).  Relay daya berfungsi untuk menutup / membuka kabel kontrol katup bola ke ground.  Ketika kabel terhubung ke tanah, keran menutup, ketika terbuka, itu terbuka. <br><br>  Kami menghubungkan semuanya sesuai dengan skema dari howto (misalnya, kami menempatkan relai pada garis netping pertama, dan sensor kebocoran pada baris keempat).  Kami menerjemahkan baris pertama ke mode keluaran berdasarkan pada logika.  Kami membuat ketergantungan dari baris pertama pada baris keempat.  Kami memeriksa sensor, menurunkannya menjadi genangan air.  Netping logika internal akan secara otomatis mematikan keran. <br><br>  Bagaimana mengelola sekarang dari jarak jauh? <br><br>  Netping memiliki server SNMP bawaan dengan kemampuan manajemen.  Untuk mengelola netping, saya menerapkan OID saya sendiri, tabel MIB untuk masing-masing perangkat tersedia di situs pengembang.  Ini juga memiliki server web dengan dukungan manajemen melalui perintah yang disandikan URL. <br><br>  Pertimbangkan kedua opsi: <br><br>  Periksa nilai logika untuk baris: <br><br><div class="spoiler">  <b class="spoiler_title">Status derek</b> <div class="spoiler_text"><blockquote><code>snmpget -v 2c -c SWITCH 192.168.8.5 .1.3.6.1.4.1.25728.8900.1.1.3.1 <br> SNMPv2-SMI::enterprises.25728.8900.1.1.3.1 = INTEGER: 1 <br>  <br> curl http:///&lt;_&gt;:&lt;&gt;@192.168.8.5/io.cgi?io1</code> </blockquote> <br></div></div><br>  Tetapkan nilai logika ke 0 (berikan voltase, tutup relai - katup terbuka): <br><br><div class="spoiler">  <b class="spoiler_title">Derek sedang menutup</b> <div class="spoiler_text"><blockquote> <code>snmpset -v 2c -c SWITCH 192.168.8.5 .1.3.6.1.4.1.25728.8900.1.1.3.1 i 0 <br>  <br> curl http:///&lt;_&gt;:&lt;&gt;@192.168.8.5/io.cgi?io1=0</code> </blockquote> <br></div></div><br>  Tetapkan nilai logika ke 1 (lepaskan tegangan, buka relai - katup terbuka): <br><br><div class="spoiler">  <b class="spoiler_title">Derek terbuka</b> <div class="spoiler_text"><blockquote> <code>snmpset -v 2c -c SWITCH 192.168.8.5 .1.3.6.1.4.1.25728.8900.1.1.3.1 i 1 <br>  <br> curl http://&lt;_&gt;:&lt;&gt;@192.168.8.5/io.cgi?io1=1</code> </blockquote> <br></div></div><br>  Dalam OID .1.3.6.1.4.1.25728.8900.1.1.3.N, N adalah nomor baris (1-4). <br><br>  Nuansa yang penting adalah bahwa peralihan hanya akan berfungsi jika saluran diatur ke mode "output".  Jika saluran dikonfigurasi dalam mode "logika keluaran" (misalnya, untuk dengan cepat merespons deteksi kebocoran oleh sensor), netping tidak akan mengontrol sinyal pada saluran di luar logikanya (yaitu, ia tidak akan menanggapi perintah eksternal).  Bagaimana menjadi?  Anda cukup mengganti mode garis sebelum memulai perintah manual.  Melalui HTTP, ini dilakukan seperti ini: <br><br><div class="spoiler">  <b class="spoiler_title">Kontrol mode garis</b> <div class="spoiler_text"><blockquote>  curl <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">192.168.8.5/io.cgi?ioN&amp;mode=0</a> <br>  curl <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">192.168.8.5/io.cgi?ioN&amp;mode=1</a> <br>  curl <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">192.168.8.5/io.cgi?ioN&amp;mode=2</a> <br></blockquote><br></div></div><br>  <b>Bonus:</b> <br><br><ul><li>  Bookmark yang bagus untuk masa depan adalah kemampuan untuk menghubungkan sebanyak mungkin sensor kebocoran jarak jauh aktif.  Hal utama adalah mencari cara memasukkan mereka ke dalam topologi umum.  Adalah mungkin untuk memblokir air lebih lanjut dengan logika pada openwrt yang sama. </li><li>  Karena dengan adanya 4 jalur yang dapat dikontrol di netping, Anda dapat menambahkan beberapa ketukan pada sistem (juga melalui relai).  Saya melakukan hal itu - saya membuat keran terpisah pada garis irigasi situs.  Sekarang Anda dapat menghidupkan / mematikan penyiraman dari jarak jauh. </li><li>  Netping memiliki template zabbix sendiri untuk semua perangkat.  Tersedia di situs mereka, menggunakan SNMP. </li></ul><br><h2>  2. Tekanan dan suhu pembawa panas di sirkuit pemanas </h2><br>  Tekanan - untuk mendeteksi kebocoran dengan cepat (termasuk sangat kecil / kumulatif). <br>  Temperatur - sensor yang dipasang saat kembali.  Menurut nilai-nilainya, misalnya, dapat ditarik kesimpulan tentang mode operasi saat ini dari boiler, pompa di sirkuit, dll. <br><br>  Sensor-sensor tersebut dipesan di aliexpress, contoh nama: "DC 5V G1 / 4 Pressure Sensor."  Ada rekan-rekan "non-Cina", tetapi jauh lebih mahal.  Mereka yang tidak mau mengambil risiko, saya akan merekomendasikan mengambil Honeywell, ada beberapa model, misalnya MLH200PSL01A.  Dalam kasus saya, seorang lelaki Cina telah hidup selama beberapa bulan di lingkungan dengan air di bawah tekanan 1 bar dengan suhu 20-60 celcius di sirkuit pemanas, dan bar 3-4 kedua di ceruk air (dingin).  Sensornya analog.  Sinyal dari itu masih perlu dikonversi.  Sirkuit DS2438AZ hadir untuk menyelamatkan.  Itu dapat mengkonversi sinyal analog ke sinyal digital dan mengirimkan bacaan menggunakan protokol 1wire.  Intinya - ADC.  Chip idealnya terintegrasi ke dalam topologi yang diterapkan pada artikel pertama.  Selain itu, Anda perlu menghubungkan terminal VCC (+ 5V) dan GND langsung ke sensor.  Tegangan muncul pada kabel ketiga sensor, yang dapat dikonversi menjadi tekanan sesuai dengan rumus - Vout = Vcc (0,8P + 0,1). <br><br>  Bonus tambahan dari chip DS2438 adalah ia juga menampilkan tegangan input jaringan, yang dapat berguna untuk debugging dan pengembangan lebih lanjut dari jaringan.  Juga, sensor suhu dibangun di dalamnya.  Poin penting - dalam utilitas digitemp, Anda harus secara eksplisit menunjukkan keberadaan chip ini dalam topologi menggunakan flag tambahan "-A". <br><br>  Dengan suhu, semuanya lebih sederhana.  Ebay / aliexpress: 1 sensor ulir kawat.  kami mendapatkan data di bus 1wire segera dalam bentuk yang tepat tanpa blackjack tambahan.  Sebagai contoh, saya memesan sensor dengan pipa ledeng 1/2 inci dan probe baja 6mm mencuat. <br><br>  Konstruktif: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6cd/314/a71/6cd314a716a07ec6b7db1710077a5441.jpg" alt="gambar"><br><br>  Kami menghubungkan kedua sensor ke topologi umum dan menambahkan item tambahan ke zabbix. <br><br><h3>  Terbang di salep </h3><br>  Bahkan, semuanya tidak lepas landas sekaligus.  Dengan diperkenalkannya kedua sensor ini, keajaiban mulai terjadi di seluruh topologi 1wire - mulai dari hilangnya sensor hingga pembacaan nilai batasnya.  Asumsi pertama adalah bahwa tidak ada cukup stres.  Mencoba mengganti hub USB, penggunaan hub aktif tidak berfungsi.  Akibatnya - saya memesan "master jaringan" baru, sekarang berdasarkan FTDI FT232 - semuanya mulai bekerja secara stabil dengannya.  Untuk bekerja dengan wizard semacam itu, Anda perlu menggunakan utilitas digitemp_DS9097U.  Tapi saya memutuskan untuk beralih ke owfs dalam bekerja dengan sensor, mengabaikan panggilan titik digitemp menggunakan zabbix_agent pada setiap item.  Ini mengurangi sakit kepala dari permintaan kompetitif, itulah sebabnya batas waktu diamati secara berkala.  Jika saya tidak salah, burung hantu bahkan memiliki semacam mekanisme caching bawaan. <br><br>  Di openwrt, paket owfs diinstal dan dipasang oleh perintah FS: <br><br>  owfs --allow_other -d / dev / ttyUSB0 / root / 1wire <br><br>  Mounting telah ditambahkan ke /etc/rc.local. <br><br><h2>  3. Tekanan dalam sistem pasokan air </h2><br>  Sekarang ini cukup sederhana - kami menduplikasi pendekatan yang dijelaskan dalam paragraf 1 untuk saluran air.  Namun, saya tidak bisa memasang sensor di saluran air tempat jaringan 1wire lewat.  Saya tidak menyeret kabel ke tempat baru, saya memutuskan untuk mencoba solusi pengambilan data jarak jauh menggunakan ADC dengan antarmuka wifi dari radioseti.  Solusinya dapat terhubung ke titik akses wifi, memiliki server web built-in dan mampu mengirimkan nilai-nilai sensor yang terhubung melalui protokol http.  Untuk perubahan - itu cocok.  Sebagai bonus - Anda dapat mengambil sensor lain (termasuk 1wire lainnya) ke perangkat ini, mis.  dalam teori, misalnya, mengatur segmen remote 1wire lain.  Perangkat ini ternyata cukup intuitif, pada awalnya ia mulai dalam mode titik akses.  Kami terhubung, masukkan pengaturan untuk menghubungkan ke wifi kami, lepaskan jumper dan letakkan di dalam jangkauan sinyal wifi.  Kami mengambil informasi, misalnya, melalui curl -s <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sensor_ip / sensor</a> atau langsung dengan polling HTTP di zabbix. <br><br>  Konstruktif: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fe2/7a9/38a/fe27a938a517a806663e930b774e0253.jpg" alt="gambar"><br><br><h2>  Komposisi kompleks saat ini: </h2><br>  <b>Segmen Sensor 1wire:</b> <br><br>  FTDI FT232 master jaringan berbasis <br>  3 chip sensor DS18B20 <br>  1 sensor probe untuk 1/2 DS18B20 <br>  1 ADC DS2438 <br>  1 sensor tekanan di bawah 1/2 <br>  1 penghitung pulsa DS2423 <br>  meteran air pulsa <br><br>  <b>Segmen sensor Wi-fi:</b> <br><br>  RS-20 <br>  1 sensor tekanan di bawah 1/2 <br><br>  <b>Segmen netping (koneksi LAN):</b> <br><br>  netping i / o v2 <br>  1 sensor kelembaban kontak kering <br>  2 crane gidrolock bugati ultimate + 2 relay BM8070D <br><br>  <b>Segmen UPS (koneksi USB):</b> <br><br>  PL2303 <br>  UPS Energy PN-750 <br><br><h2>  Skema: </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/0bb/f87/9c1/0bbf879c111f6d5cf7a44ba729cc13d6.jpg" alt="gambar"><br><br><h2>  Bagan: </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/f88/205/f7a/f88205f7a13ce5cc93f815b8e0bc4d68.png" alt="gambar"><br><img src="https://habrastorage.org/getpro/habr/post_images/de8/51d/a16/de851da16013b0acf129f248d40618d5.png" alt="gambar"><br><img src="https://habrastorage.org/getpro/habr/post_images/490/404/477/490404477a67d03040c77f296cbec29d.png" alt="gambar"><br><img src="https://habrastorage.org/getpro/habr/post_images/141/db0/60e/141db060e48225b4d1d00bc26e57fc33.png" alt="gambar"><br><br><h2>  Referensi: </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Netping Leakage Blog</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Dokumentasi Netping v2</a> (termasuk SNMP dan URL-Encoded) </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Paspor-deskripsi derek gidrolock</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">WIFI ADC radioseti</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id447572/">https://habr.com/ru/post/id447572/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id447562/index.html">Pengantar rekayasa terbalik: meretas format data game</a></li>
<li><a href="../id447564/index.html">Perubahan otorisasi repositori di GitLab.com</a></li>
<li><a href="../id447566/index.html">Para ilmuwan pertama kali menunjukkan "foto" nyata dari lubang hitam</a></li>
<li><a href="../id447568/index.html">Wawancara dengan astronot Alexander Laveikin tentang bioskop luar angkasa, kelebihan 20 unit dan pendaratan lunak</a></li>
<li><a href="../id447570/index.html">GoLand 2019.1: analisis kinerja kode, Smart Step Into, Refactoring Extract Interface, Nilness Analyzer, dan lainnya</a></li>
<li><a href="../id447574/index.html">Catatan Freelancer: Mengembangkan Aplikasi Asli Bereaksi Pertama</a></li>
<li><a href="../id447576/index.html">Pengembangan JavaScript yang Bertanggung Jawab Bagian 1</a></li>
<li><a href="../id447578/index.html">Mempercepat JavaScript menggunakan tipe data Set</a></li>
<li><a href="../id447580/index.html">Berburu Ancaman, atau Cara Bertahan Terhadap Ancaman 5%</a></li>
<li><a href="../id447582/index.html">Rusatom: pencetakan logam 3D di Rusia</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>