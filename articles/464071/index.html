<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©‚Äçüé® üõ∂ üë®üèΩ‚Äçü§ù‚Äçüë®üèª ¬øRevoluci√≥n o dolor? Informe Yandex React Hooks ‚óªÔ∏è üê± üçó</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mi nombre es Artyom Berezin, soy desarrollador de varios servicios internos de Yandex. Durante los √∫ltimos seis meses, he estado trabajando activament...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>¬øRevoluci√≥n o dolor? Informe Yandex React Hooks</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/464071/"> Mi nombre es Artyom Berezin, soy desarrollador de varios servicios internos de Yandex.  Durante los √∫ltimos seis meses, he estado trabajando activamente con React Hooks.  En el proceso, hubo algunas dificultades que tuvieron que ser combatidas.  Ahora quiero compartir esta experiencia contigo.  En el informe, examin√© la API React Hook desde un punto de vista pr√°ctico: ¬øpor qu√© necesitamos ganchos? ¬øVale la pena cambiarlo? Es mejor tenerlo en cuenta al portarlo.  Es f√°cil cometer errores durante la transici√≥n, pero evitarlos tampoco es tan dif√≠cil. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/xm/xa/7n/xmxa7ngpjx3l902ndjcetpyhsp0.jpeg"></a> <br><br>  - Los ganchos son solo otra forma de describir la l√≥gica de sus componentes.  Le permite agregar a los componentes funcionales algunas caracter√≠sticas que anteriormente eran inherentes solo a los componentes de las clases. <br><br><a name="habracut"></a><img src="https://habrastorage.org/webt/hd/r8/4b/hdr84b-fmfibqz-gwcb0k8feny8.jpeg"><br><br>  Primero que nada, es soporte para el estado interno, luego soporte para efectos secundarios.  Por ejemplo, solicitudes de red o solicitudes a WebSocket: suscripci√≥n, cancelaci√≥n de suscripci√≥n de algunos canales.  O, tal vez, estamos hablando de solicitudes a otras API de navegador as√≠ncronas o s√≠ncronas.  Adem√°s, los ganchos nos dan acceso al ciclo de vida del componente, a su inicio de vida, es decir, al montaje, a la actualizaci√≥n de sus accesorios y a su muerte. <br><br><img src="https://habrastorage.org/webt/9d/f4/lk/9df4lk5afueo28ftgmebxggxuw0.jpeg"><br><br>  Probablemente la forma m√°s f√°cil de ilustrar en comparaci√≥n.  Aqu√≠ est√° el c√≥digo m√°s simple que solo puede estar con un componente en las clases.  El componente est√° cambiando algo.  Este es un contador regular que se puede aumentar o disminuir, solo un campo en estado.  En general, creo que si est√° familiarizado con React, el c√≥digo es completamente obvio para usted. <br><br><img src="https://habrastorage.org/webt/iy/ms/2_/iyms2_hexuxc_nx5cnxwux8crva.jpeg"><br><br>  Un componente similar que realiza exactamente la misma funci√≥n, pero escrito en ganchos, parece mucho m√°s compacto.  Seg√∫n mis c√°lculos, en promedio, cuando se transfiere de componentes en clases a componentes en ganchos, el c√≥digo disminuye aproximadamente una vez y media, y lo complace. <br><br>  Algunas palabras sobre c√≥mo funcionan los ganchos.  Un enlace es una funci√≥n global que se declara dentro de React y se llama cada vez que se representa un componente.  React rastrea las llamadas a estas funciones y puede cambiar su comportamiento o decidir qu√© debe devolver. <br><br><img src="https://habrastorage.org/webt/yy/wy/xf/yywyxfylah95eiqs8saijtqbf-a.jpeg"><br><br>  Existen algunas restricciones en el uso de ganchos que los distinguen de las funciones ordinarias.  En primer lugar, no se pueden usar en componentes de clases, solo se aplica dicha restricci√≥n porque no est√°n creados para ellos, sino para componentes funcionales.  No se pueden llamar ganchos dentro de funciones internas, dentro de bucles, condiciones.  Solo en el primer nivel de anidamiento, dentro de las funciones del componente.  React impone esta restricci√≥n para poder rastrear qu√© ganchos se llamaron.  Y los apila en un cierto orden en su cerebro.  Entonces, si este orden cambia repentinamente o desaparece algo, es posible que se produzcan errores complejos, evasivos y dif√≠ciles de depurar. <br><br>  Pero si tiene una l√≥gica bastante complicada y le gustar√≠a usar, por ejemplo, ganchos dentro de ganchos, entonces lo m√°s probable es que sea una se√±al de que debe hacer un gancho.  Suponga que conecta varios ganchos entre s√≠ en un gancho personalizado separado.  Y dentro de √©l puede usar otros ganchos personalizados, creando as√≠ una jerarqu√≠a de ganchos, destacando la l√≥gica general all√≠. <br><br><img src="https://habrastorage.org/webt/wr/av/h_/wravh_lbocryqocrjlnwqs8rrr4.jpeg"><br><br>  Los ganchos proporcionan algunas ventajas sobre las clases.  En primer lugar, como se deduce del anterior, utilizando ganchos personalizados, puede buscar la l√≥gica mucho m√°s f√°cil.  Anteriormente, utilizando el enfoque con componentes de orden superior, presentamos alg√∫n tipo de l√≥gica compartida, y era una envoltura sobre el componente.  Ahora ponemos esta l√≥gica dentro de los ganchos.  Por lo tanto, el √°rbol de componentes se reduce: su anidamiento se reduce, y React se vuelve m√°s f√°cil para rastrear los cambios de componentes, recalcular el √°rbol, recalcular el DOM virtual, etc. Esto resuelve el problema del llamado infierno envoltorio.  Los que trabajan con Redux, creo, est√°n familiarizados con esto. <br><br>  El c√≥digo escrito usando ganchos es mucho m√°s f√°cil de minimizar con minimizadores modernos como Terser o el antiguo UglifyJS.  El hecho es que no necesitamos guardar los nombres de los m√©todos, no necesitamos pensar en prototipos.  Despu√©s de la transpilaci√≥n, si el objetivo es ES3 o ES5, generalmente obtenemos un mont√≥n de prototipos que parchan.  Aqu√≠ no es necesario hacer todo esto, por lo tanto, es m√°s f√°cil de minimizar.  Y, como resultado de no usar clases, no necesitamos pensar en esto.  Para los principiantes, este suele ser un gran problema y probablemente una de las principales razones de los errores: olvidamos que puede ser una ventana, que necesitamos vincular el m√©todo, por ejemplo, en el constructor o de alguna otra manera. <br><br>  Adem√°s, el uso de ganchos le permite resaltar la l√≥gica que controla cualquier efecto secundario.  Anteriormente, esta l√≥gica, especialmente cuando tenemos varios efectos secundarios para un componente, ten√≠a que dividirse en diferentes m√©todos del ciclo de vida del componente.  Y, desde que aparecieron los ganchos de minimizaci√≥n, apareci√≥ React.memo, ahora los componentes funcionales se prestan a la memorizaci√≥n, es decir, este componente no se recrear√° ni actualizar√° con nosotros si sus accesorios no han cambiado.  Esto no se pudo hacer antes, ahora es posible.  Todos los componentes funcionales se pueden envolver en memo.  Tambi√©n dentro del gancho useMemo apareci√≥, que podemos usar para calcular algunos valores pesados, o instanciar algunas clases de utilidad solo una vez. <br><br>  El informe estar√° incompleto si no hablo de algunos ganchos b√°sicos.  En primer lugar, estos son ganchos de gesti√≥n estatal. <br><br><img src="https://habrastorage.org/webt/ud/wg/vl/udwgvlovxonthzvnknxeewerxea.jpeg"><br><br>  En primer lugar, use State. <br><br><img src="https://habrastorage.org/webt/0c/xb/pk/0cxbpky3iayxkvaxutbik_ohbcw.jpeg"><br><br>  Un ejemplo es similar al del principio del informe.  useState es una funci√≥n que toma un valor inicial y devuelve una tupla del valor actual y la funci√≥n para cambiar ese valor.  Toda la magia es servida por React internamente.  Simplemente podemos leer este valor o cambiarlo. <br><br>  A diferencia de las clases, podemos usar tantos objetos de estado como necesitemos, divide el estado en partes l√≥gicas para no mezclarlos en un objeto, como en las clases.  Y estas piezas estar√°n completamente aisladas unas de otras: se pueden cambiar independientemente una de la otra.  El resultado, por ejemplo, de este c√≥digo: cambiamos dos variables, calculamos el resultado y visualizamos botones que nos permiten cambiar la primera variable aqu√≠ y all√°, y la segunda variable aqu√≠ y all√°.  Recuerde este ejemplo, porque m√°s adelante haremos algo similar, pero mucho m√°s complicado. <br><br><img src="https://habrastorage.org/webt/qh/cb/7r/qhcb7rezzu2hu5ymyqw8nw1bl9e.jpeg"><br><br>  Hay un uso de StateState en esteroides para los amantes de Redux.  Le permite cambiar el estado de manera m√°s consistente utilizando un reductor.  Creo que aquellos que est√°n familiarizados con Redux ni siquiera pueden explicar, para aquellos que no est√°n familiarizados, dir√©. <br><br>  Un reductor es una funci√≥n que acepta un estado y alg√∫n objeto, generalmente llamado acci√≥n, que describe c√≥mo deber√≠a cambiar este estado.  M√°s precisamente, pasa algunos par√°metros, y dentro del reductor ya decide, dependiendo de sus par√°metros, c√≥mo cambiar√° el estado y, como resultado, se debe devolver un nuevo estado, actualizado. <br><br><img src="https://habrastorage.org/webt/k6/5x/gd/k65xgdpidy6wnhmuxabw3sqqtk0.jpeg"><br><br>  Aproximadamente de esta manera se usa en el c√≥digo del componente.  Tenemos un gancho useReducer, toma una funci√≥n reductora y el segundo par√°metro es el valor inicial del estado.  Devuelve, como useState, el estado actual y la funci√≥n para cambiarlo es despachar.  Si pasa un objeto de acci√≥n para despachar, invocaremos un cambio de estado. <br><br><img src="https://habrastorage.org/webt/un/sl/ng/unslngsedmksssjrthxjmzhn7bu.jpeg"><br><br>  Uso muy importante Efecto gancho.  Le permite agregar efectos secundarios al componente, dando una alternativa al ciclo de vida.  En este ejemplo, usamos un m√©todo simple con useEffect: solo solicita algunos datos del servidor, con la API, por ejemplo, y muestra estos datos en la p√°gina. <br><br><img src="https://habrastorage.org/webt/bb/tc/gf/bbtcgfyw89tgu_jarnwwaagxmnq.jpeg"><br><br>  UseEffect tiene un modo avanzado, esto es cuando la funci√≥n pasada a useEffect devuelve alguna otra funci√≥n, luego se llamar√° a esta funci√≥n en el pr√≥ximo ciclo, cuando se aplicar√° este useEffect. <br><br>  Olvid√© mencionar que useEffect se llama de forma asincr√≥nica, justo despu√©s de que el cambio se aplica al DOM.  Es decir, garantiza que se ejecutar√° despu√©s de que se procese el componente, y puede conducir al siguiente renderizado si cambian algunos valores. <br><br><img src="https://habrastorage.org/webt/gl/yd/cj/glydcjxiui-c60mgjzhnfobsqcm.jpeg"><br><br>  Aqu√≠ nos encontramos por primera vez con un concepto como las dependencias.  Algunos ganchos, useEffect, useCallback, useMemo, toman una matriz de valores como segundo argumento, lo que nos permitir√° decir qu√© rastrear.  Los cambios en esta matriz conducen a alg√∫n tipo de efectos.  Por ejemplo, aqu√≠, hipot√©ticamente, tenemos alg√∫n tipo de componente para elegir un autor de alguna lista.  Y un plato con libros de este autor.  Y cuando el autor cambie, se llamar√° a useEffect.  Cuando se cambia este authorId, se llamar√° a una solicitud y se cargar√°n los libros. <br><br>  Tambi√©n menciono al pasar ganchos como useRef, esta es una alternativa a React.createRef, algo similar a useState, pero los cambios a ref no conducen a la representaci√≥n.  A veces conveniente para algunos hacks.  useImperativeHandle nos permite declarar ciertos "m√©todos p√∫blicos" en el componente.  Si usa useRef en el componente padre, puede extraer estos m√©todos.  Para ser sincero, lo intent√© una vez con fines educativos, en la pr√°ctica no fue √∫til.  useContext es algo bueno, le permite tomar el valor actual del contexto si el proveedor ha definido este valor en alg√∫n lugar m√°s alto en el nivel de jerarqu√≠a. <br><br>  Hay una forma de optimizar las aplicaciones React en ganchos; esta es la memorizaci√≥n.  La memorizaci√≥n se puede dividir en interna y externa.  Primero sobre el exterior. <br><br><img src="https://habrastorage.org/webt/ao/wq/-e/aowq-evnbye1bnr6lspo9sthw9y.jpeg"><br><br>  Esta es React.memo, pr√°cticamente una alternativa a la clase React.PureComponent, que rastre√≥ los cambios en los accesorios y los componentes cambiados solo cuando los accesorios o el estado cambiaron. <br><br>  Aqu√≠, una cosa similar, sin embargo, sin un estado.  Tambi√©n supervisa los cambios en los accesorios, y si los accesorios han cambiado, se produce un renderizador.  Si los accesorios no han cambiado, el componente no se actualiza y ahorramos en esto. <br><br><img src="https://habrastorage.org/webt/lk/0l/dn/lk0ldneyzriaeesmzxfnvvkl1h4.jpeg"><br><br>  M√©todos internos de optimizaci√≥n.  En primer lugar, esto es algo de bajo nivel: useMemo, rara vez se usa.  Le permite calcular alg√∫n valor y volver a calcularlo solo si los valores especificados en las dependencias han cambiado. <br><br><img src="https://habrastorage.org/webt/ve/fs/ml/vefsmlmbjqbg6-1lejt5_qofoow.jpeg"><br><br>  Hay un caso especial de useMemo para una funci√≥n llamada useCallback.  Se utiliza principalmente para memorizar el valor de las funciones del controlador de eventos que se pasar√°n a los componentes secundarios para que estos componentes secundarios no puedan representarse nuevamente.  Se usa simplemente.  Describimos una determinada funci√≥n, la envolvemos en useCallback e indicamos de qu√© variables depende. <br><br>  Mucha gente tiene una pregunta, pero ¬ønecesitamos esto?  ¬øNecesitamos ganchos?  ¬øNos mudamos o nos quedamos como antes?  No hay una respuesta √∫nica, todo depende de las preferencias.  En primer lugar, si est√° directamente vinculado r√≠gidamente a la programaci√≥n orientada a objetos, si sus componentes, est√° acostumbrado a ellos como una clase, tienen m√©todos que pueden extraerse, entonces, probablemente, esto puede parecerle superfluo.  En principio, cuando escuch√© por primera vez sobre ganchos, me pareci√≥ que era demasiado complicado, se estaba agregando alg√∫n tipo de magia, y no estaba claro por qu√©. <br><br>  Para los amantes de las funcionalidades, esto es, digamos, imprescindible, porque los ganchos son funciones, y las t√©cnicas de programaci√≥n funcional les son aplicables.  Por ejemplo, puede combinarlos o hacer cualquier cosa, utilizando, por ejemplo, bibliotecas como Ramda y similares. <br><br><img src="https://habrastorage.org/webt/du/k4/n7/duk4n7l_1_are_xjgrkf4vvbccy.jpeg"><br><br>  Como nos deshicimos de las clases, ya no necesitamos vincular este contexto a los m√©todos.  Si usa estos m√©todos como devoluciones de llamada.  Por lo general, esto era un problema, porque ten√≠a que recordar vincularlos en el constructor, o usar una extensi√≥n no oficial de la sintaxis del lenguaje, como las funciones de flecha como propiedad.  Pr√°ctica bastante com√∫n.  Us√© mi decorador, que tambi√©n es, en principio, experimentalmente, en m√©todos. <br><br><img src="https://habrastorage.org/webt/pn/ew/fi/pnewfifb1wwktxkbddh1zqqk-os.jpeg"><br><br>  Hay una diferencia en c√≥mo funciona el ciclo de vida, c√≥mo administrarlo.  Los ganchos asocian casi todas las acciones del ciclo de vida con el gancho useEffect, que le permite suscribirse tanto al nacimiento como a la actualizaci√≥n de un componente y a su muerte.  En las clases, para esto, tuvimos que redefinir varios m√©todos, como componentDidMount, componentDidUpdate y componentWillUnmount.  Adem√°s, el m√©todo shouldComponentUpdate ahora se puede reemplazar con React.memo. <br><br><img src="https://habrastorage.org/webt/7d/ae/qy/7daeqyxv0yh0on4i1wcdsraoaws.jpeg"><br><br>  Hay una diferencia bastante peque√±a en c√≥mo se maneja el estado.  Primero, las clases tienen un objeto de estado.  Tuvimos que meter algo all√≠.  En ganchos, podemos dividir el estado l√≥gico en algunas partes, lo que ser√≠a conveniente para nosotros operar por separado. <br><br>  setState () de componentes en clases permite especificar un parche de estado, cambiando as√≠ uno o m√°s campos del estado.  En los ganchos, tenemos que cambiar todo el estado como un todo, y esto es incluso bueno, porque est√° de moda usar todo tipo de cosas inmutables y nunca esperar que nuestros objetos muten.  Siempre son nuevos con nosotros. <br><br>  La caracter√≠stica principal de las clases que los ganchos no tienen: podr√≠amos suscribirnos a los cambios de estado.  Es decir, cambiamos el estado e inmediatamente nos suscribimos a sus cambios, procesando imperativamente algo inmediatamente despu√©s de que se aplican los cambios.  En ganchos, esto simplemente no funciona.  Esto debe hacerse de una manera muy interesante, te dir√© m√°s. <br><br>  Y un poco sobre la forma funcional de actualizaci√≥n.  Funciona tanto all√≠ como all√≠, cuando las funciones de cambio de estado aceptan otra funci√≥n, que este estado no deber√≠a cambiar, sino crear.  Y si en el caso del componente de clase puede devolvernos alg√∫n tipo de parche, entonces en los ganchos debemos devolver todo el nuevo valor. <br><br>  En general, es poco probable que obtenga una respuesta si se mueve o no.  Pero le aconsejo que al menos intente, al menos para el nuevo c√≥digo, sentirlo.  Cuando reci√©n comenc√© a trabajar con ganchos, inmediatamente identifiqu√© varios ganchos personalizados que son convenientes para mi proyecto.  B√°sicamente, intent√© reemplazar algunas de las caracter√≠sticas que hab√≠a implementado a trav√©s de componentes de orden superior. <br><br><img src="https://habrastorage.org/webt/d6/cs/1-/d6cs1-ebiop8wbrdgnrr93wskqm.jpeg"><br><br>  useDismounted: para aquellos que est√°n familiarizados con RxJS, existe la oportunidad de darse de baja en masa de todos los Observables dentro de un componente, o dentro de una funci√≥n, suscribiendo cada Observable a un objeto especial, Asunto, y cuando se cierra, todas las suscripciones se cancelan.  Esto es muy conveniente si el componente es complejo, si hay muchas operaciones asincr√≥nicas dentro del Observable, es conveniente darse de baja de todas a la vez, y no de cada una por separado. <br><br>  useObservable devuelve un valor de Observable cuando aparece uno nuevo all√≠.  Un gancho similar de useBehaviourSubject regresa de BehaviourSubject.  Su diferencia con Observable es que inicialmente tiene alg√∫n significado. <br><br>  El conveniente uso del gancho personalizadoDebouncedValue nos permite organizar, por ejemplo, un sujest para la cadena de b√∫squeda, de modo que no cada vez que presione una tecla, env√≠e algo al servidor, pero espere hasta que el usuario termine de escribir. <br><br>  Dos ganchos similares.  useWindowResize devuelve los valores actuales actuales para los tama√±os de ventana.  El siguiente gancho para la posici√≥n de desplazamiento es useWindowScroll.  Los uso para contar algunas ventanas emergentes o ventanas modales, si hay cosas complicadas que simplemente no se pueden hacer con CSS. <br><br>  Y un gancho tan peque√±o para implementar teclas de acceso r√°pido, que el componente, cuando est√° presente en la p√°gina, se suscribe a alguna tecla de acceso r√°pido.  Cuando muere, se produce una baja autom√°tica. <br><br>  ¬øPara qu√© son convenientes estos ganchos personalizados?  Que podemos anular una cancelaci√≥n de suscripci√≥n dentro del gancho, y no tenemos que pensar en cancelar la suscripci√≥n manual en alg√∫n lugar del componente donde se usa este gancho. <br><br>  No hace mucho tiempo, me lanzaron un enlace a la biblioteca de uso de reacci√≥n, y result√≥ que la mayor√≠a de estos ganchos personalizados ya estaban implementados all√≠.  Y escrib√≠ una bicicleta.  Esto a veces es √∫til, pero en el futuro, lo m√°s probable es que los tire y use react-use.  Y le aconsejo que tambi√©n vea si tiene la intenci√≥n de usar ganchos. <br><br><img src="https://habrastorage.org/webt/03/ls/_r/03ls_rryjcv9gax_wky56kv0hye.jpeg"><br><br>  En realidad, el objetivo principal del informe es mostrar c√≥mo escribir incorrectamente, qu√© problemas pueden ser y c√≥mo evitarlos.  Lo primero, probablemente lo que cualquiera que est√© estudiando estos ganchos y tratando de escribir algo, sea usar incorrectamente useEffect.  Aqu√≠ est√° el c√≥digo similar al que 100% todos escribieron si intentaron ganchos.  Se debe al hecho de que useEffect se percibe inicialmente mentalmente, como una alternativa a componentDidMount.  Pero, a diferencia de componentDidMount, que se llama solo una vez, useEffect se llama en cada render.  Y el error aqu√≠ es que cambia, digamos, la variable de datos, y al mismo tiempo cambiarla conduce a un procesador de componentes, como resultado, el efecto se volver√° a solicitar.  Por lo tanto, obtenemos una serie interminable de solicitudes AJAX al servidor, y el componente en s√≠ mismo se actualiza, actualiza, actualiza constantemente. <br><br><img src="https://habrastorage.org/webt/ds/jw/cl/dsjwclnhk6kvmnmkxjw04vdrqd8.jpeg"><br><br>  Arreglarlo es muy simple.  Debe agregar aqu√≠ una matriz vac√≠a de las dependencias de las que depende y los cambios en los que reiniciar√° el efecto.  Si tenemos una lista vac√≠a de dependencias especificadas aqu√≠, entonces el efecto, en consecuencia, no se reiniciar√°.  Este no es un tipo de pirateo, es una caracter√≠stica b√°sica del uso de useEffect. <br><br><img src="https://habrastorage.org/webt/tx/bw/it/txbwitnnldk_y5r-bf0f4pss7eg.jpeg"><br><br>  Digamos que lo arreglamos.  Ahora un poco complicado.  Tenemos un componente que representa algo que debe ser tomado del servidor para alg√∫n tipo de identificaci√≥n.  En este caso, en principio, todo funciona bien hasta que cambiemos el entityId en el padre, tal vez esto no sea relevante para su componente. <br><br><img src="https://habrastorage.org/webt/2e/pl/tx/2epltxjdup5yia7c6gsepl-o7xo.jpeg"><br><br>  Pero lo m√°s probable es que si cambia o es necesario cambiarlo, y si tiene un componente antiguo en su p√°gina y resulta que no se est√° actualizando, es mejor agregar entityId aqu√≠, como una dependencia, causando la actualizaci√≥n, actualizando los datos. <br><br><img src="https://habrastorage.org/webt/rd/lc/ep/rdlcepf4e8lzq8ersyffn8ydqgs.jpeg"><br><br>  Un ejemplo m√°s complejo con useCallback.  Aqu√≠, a primera vista, todo est√° bien.  Tenemos una p√°gina determinada que tiene alg√∫n tipo de temporizador de cuenta regresiva o, por el contrario, un temporizador que simplemente funciona.  Y, por ejemplo, una lista de hosts, y encima hay filtros que le permiten filtrar esta lista de hosts.  Bueno, el mantenimiento se ha agregado aqu√≠ solo para ilustrar un valor que cambia con frecuencia que se traduce en un renderizador. <br><br>    ,   ,    maintenance    ,   ,   ,      onChange.     onChange,        .  ,  HostFilters - , ,      dropdown,     .       ,    .  ,       . <br><br><img src="https://habrastorage.org/webt/bb/08/q1/bb08q1gwb5jzadcu0-bl1w0xsy0.jpeg"><br><br>     onChange    useCallback.         ,      . <br><br>    ,   . , ,  .      Facebook,   React.  , , ,  ,  '.     ,  ,  confusing . <br><br><img src="https://habrastorage.org/webt/xw/lv/et/xwlvetymaukrlaxd7t5cctegg-8.jpeg"><br><br>     ?        ‚Äî     ,   -  , ,     ,      ,  ,         .         . <br><br> ,    ,          ,     ,      ,     , .  , Garbage Collector      ,    .  , ,     ,    ,    .   , , ,       reducer,     ,          . ,      . <br><br>    ,     ,   .     - , ,   setValue  - ,            ,   setState     .   -       useEffect. <br><br>   useEffect   -  ,   -  , ,   ,    useEffect.     useEffect     ,   .        ,    ,  Backbone,  : ,     ,  ,        -  .      ,    ,  -   ,  .    -   . ,  ,      ,    ,    -  . ,  ,  ,   , ,    ,  .     . <br><br>   ,   ,  . ,        ,     .           ,      .        ,     .  ,    , , dropdown  .   ,     .    dropdown  pop-up,     useWindowScroll, useWindowResize         ,  .         ,      , ‚Äî  ,   . <br><br>        ,   ,  . ,       , ,   ,     ,       . , ,   ,      ,   ,         . <br><br><img src="https://habrastorage.org/webt/-r/tu/f_/-rtuf_bbscg5l9i4-oaeh-xpu80.jpeg"><br><br>   ,     ¬´¬ª,   . ,     ,   TypeScript    .      .    ,  reducer  Redux ,    action.  ,   action    ,     action.   ,   ,     ,  . <br><br>    .  ,        action.     ,     , IncrementA  0,  1, 2,   .         . ,    , ,  ,       .     action     action,   -     .   UnionType ‚ÄúAction‚Äù,         ,   ,    action.   . <br><br>   ‚Äî     . ,   initialState,  .   ,       -  .       TypeScript.     . ,    typeState   ,   initialState. <br><br><img src="https://habrastorage.org/webt/_i/fg/79/_ifg793-qpfaiwittpdhffve_zw.jpeg"><br><br>       reducer.   State, Action,    :   switch  action.type.  TypeScript      UnionType:       case,      - ,    type.           action   . <br><br> ,  :  ,    ,     .  . <br><br><img src="https://habrastorage.org/webt/6r/8v/or/6r8vordbm6xpl9og288kzvrgewk.jpeg"><br><br>   ?  ,     .      .      ,   reducer. ,   action creator  ,   ,       dispatch. <br><br><img src="https://habrastorage.org/webt/vg/tg/aw/vgtgawewmkwgpr5su4c24n7hgo8.jpeg"><br><br>     extension   Dev Tools.            .    . <br><br>  ,  ,    .   ,     ,     .      useDebugValue ,        -    Dev Tool.        useConstants,       - , loaded,  ,     ,  . <br><br><img src="https://habrastorage.org/webt/rt/cc/sg/rtccsggw9kekwpt75gmvnwd_w2u.jpeg"><br><br>   ‚Äî  .  ,     .     ,        .    ,   ,  ,    .     ,   ,          ‚Äî   -       ,   ‚Äî   . <br><br>   .  Facebook     ESLint,       .      ,  , .    ,   dependencies  .     ,    ,    ,     . <br><br>       ,  ,     ,  -   ,     .     ,   ,   ,       . .       ,    -   - . <br><br>    ‚Äî       , ,  - .   ,    ,    .      ,   ,  -      . ,             .      .  : <br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">¬´React hooks ‚Äî   ?¬ª</a> C     .       ,    ,    ,      ,    . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">   useEffect</a> .  ,   ,      ,   ,   ,     . . </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">¬´useReducer vs useState in React¬ª</a> ,    useReducer,      useState. :     ,  ,    ,    useReducer.    - ,   useState   . </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">React Hooks CheatSheets</a> c      . </li><li>   . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Usehooks.com</a> ‚Äî   , .     .     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">react-use</a> ‚Äî ,       ,     . </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/464071/">https://habr.com/ru/post/464071/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../464045/index.html">C√≥mo casi recorr√≠ carreras en tiempo real en 1997</a></li>
<li><a href="../464053/index.html">Nota: Selecci√≥n de pista y algoritmo de rotaci√≥n</a></li>
<li><a href="../464055/index.html">Estudiamos los datos recopilados por Xiaomi Mi Band para el a√±o</a></li>
<li><a href="../464057/index.html">Hilbert, Lebesgue ... y el vac√≠o</a></li>
<li><a href="../464063/index.html">Cortando el cable en 2019</a></li>
<li><a href="../464075/index.html">Introducci√≥n a C. Mensaje del siglo pasado</a></li>
<li><a href="../464077/index.html">No, no necesita 50 km / s delta ve. Necesita tecnolog√≠as aditivas (Parte 1)</a></li>
<li><a href="../464079/index.html">C√≥mo hacer una nave espacial horizontal de despegue y aterrizaje sin tecnolog√≠a milagrosa</a></li>
<li><a href="../464083/index.html">C√≥mo ITSM ayudar√° y qui√©n aplica esta metodolog√≠a</a></li>
<li><a href="../464089/index.html">Automatizar solicitudes HTTP en el contexto de Spring</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>