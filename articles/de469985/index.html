<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙅🏼 👉🏾 🙆 Beschleunigen eines Programms für einen synthetisierten Redd-Prozessor ohne Optimierung: Ersetzen einer Uhr 👅 🖖🏽 🦆</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bisher haben wir das Thema diskutiert, wie die Systemgeschwindigkeit mit einigen intensiven Methoden erhöht werden kann. Tatsächlich gibt es jedoch um...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Beschleunigen eines Programms für einen synthetisierten Redd-Prozessor ohne Optimierung: Ersetzen einer Uhr</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/469985/">  Bisher haben wir das Thema diskutiert, wie die Systemgeschwindigkeit mit einigen intensiven Methoden erhöht werden kann.  Tatsächlich gibt es jedoch umfangreiche Methoden.  Jetzt arbeiten wir mit einer Taktfrequenz von 50 MHz, die mit der Verwendung einer Komponente aus dem Set für ein Universitätsprogramm verbunden ist (und ohne diese ist es unmöglich, SDRAM zu takten, was erfordert, dass die zum Mikrokreislauf führenden Taktimpulse relativ zu den Hauptimpulsen verschoben werden).  Als ich diese Komponente in das Spiel einführte, warnte ich, dass diese Lösung nur vorübergehend ist.  Dann habe ich so viele neue Informationen auf den Leser geworfen, dass jede zusätzliche Langeweile zu einem Ausruf führen könnte: "Nun, diese FPGAs, hier ist alles so kompliziert!"  Jetzt bauen wir bereits einfach und natürlich Prozessorsysteme, all die schrecklichen Dinge liegen hinter uns.  Es ist Zeit herauszufinden, wie Sie Ihre eigene Komponente herstellen können, mit der Sie die Taktfrequenz sowohl des Prozessors als auch der daran angeschlossenen Peripheriegeräte erhöhen können. <br><br><img src="https://habrastorage.org/webt/cw/bq/hz/cwbqhzbsc0zb9fvgee5j7_7gyqw.png"><br><a name="habracut"></a><br><h4>  Frühere Artikel in der Reihe: </h4><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Entwicklung der einfachsten „Firmware“ für in Redd installierte FPGAs und Debugging am Beispiel des Speichertests.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Entwicklung der einfachsten „Firmware“ für in Redd installierte FPGAs.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2. Programmcode.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Entwicklung eines eigenen Kerns zur Einbettung in ein FPGA-basiertes Prozessorsystem.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Entwicklung von Programmen für den Zentralprozessor Redd am Beispiel des Zugriffs auf das FPGA.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die ersten Experimente am Streaming-Protokoll am Beispiel der CPU- und Prozessorkommunikation im Redd FPGA.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Merry Quartusel oder wie der Prozessor zu einem solchen Leben gekommen ist.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Codeoptimierungsmethoden für Redd.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1: Cache-Effekt.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Codeoptimierungsmethoden für Redd.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2: Nicht zwischengespeicherter Speicher und paralleler Busbetrieb.</a> </li></ol><br><h2>  Ein bisschen theoretisches Denken </h2><br>  Lassen Sie uns abschätzen, welche Frequenz wir schmerzlos für die Taktung unseres gesamten Eisens einstellen können.  Der im Komplex verwendete SDRAM-Chip ermöglicht eine Grenzfrequenz von 133 MHz.  Informationen zu den Taktraten des Prozessors finden Sie in den <b>Nios II-Leistungsbenchmarks</b> .  Dort ist für unseren FPGA Cyclone IV E die Nios II / f-Kernfrequenz von 160 MHz garantiert.  Ich bin kein Befürworter des Auspressens aller Säfte aus dem System, daher werden wir über das Arbeiten mit einer Frequenz von 100 MHz sprechen. <br><br>  Um ehrlich zu sein, habe ich mich immer noch nicht von der in Abschnitt <b>32.7</b> angegebenen Methode zur Berechnung der Taktfrequenzverschiebung inspirieren lassen <b>.</b>  <b>Überlegungen zu Uhrzeit, PLL und Timing des</b> <b>IP-Benutzerhandbuchs</b> <b>für</b> <b>eingebettete Peripheriegeräte</b> , aber ich bin anscheinend nicht der einzige.  Zumindest führte mich eine lange Suche im Internet nicht zu Artikeln, die Ergebnisse enthielten, die auf die gleiche Weise berechnet wurden, jedoch nicht für die im Hauptdokument angegebene Häufigkeit (dieselben 50 MHz). <br><br>  Es gibt einen interessanten Artikel, zu dem ich einen direkten Link geben werde: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">www.emb4fun.de/fpga/nutos1/index.html</a> .  Man könnte sich einfach darauf beziehen und sagen "Lass uns als Autor handeln", wenn nicht für ein "aber": Der Autor dieses Artikels verwendet den PLL-Block (auf Russisch - PLL und auf Haushaltsebene - einen Frequenzumrichter), der einfügt seinen eigenen Code in VHDL.  Wie bereits im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel über das lustige Quartusel erwähnt</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">halte ich</a> an der Ideologie fest, dass das Prozessorsystem auf der obersten Ebene der Projekthierarchie stehen sollte.  In keiner Sprache, sei es VHDL oder Verilog, sind Einfügungen erforderlich.  Vor kurzem hat mein Ansatz eine weitere Bestätigung erhalten: Wir haben einen neuen Mitarbeiter, einen Studenten, der noch kein Verilog spricht, aber großartigen Code für den Redd-Komplex erstellt, da der gewählte Ansatz dies zulässt. <br><br>  Es stellt sich heraus, dass wir nur davon ausgehen, dass alles für den Autor mit einer Verschiebung von minus 54 Grad funktioniert (welche Art von Grad wird im Artikel beschrieben, dem Link, zu dem ich den obigen Absatz gegeben habe). <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beachten Sie als</a> Nächstes einen weiteren interessanten Artikel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">asral.unimap.edu.my/wp-content/uploads/2019/07/2019_IJEECS_Chan_Implementation-Camera-System.pdf</a> .  Alles funktioniert für Autoren bei einer Verschiebung von minus 65 Grad. <br><br>  Versuchen wir, unser System mit einem Wert aus diesem Bereich zu erstellen.  Wenn während des täglichen RAM-Tests keine einzige Fehlfunktion auftritt, belassen wir diesen Wert als Kampf.  Wir haben das Recht, da die für Redd entwickelte „Firmware“ nicht an die Kunden geht, sondern für interne Bedürfnisse und in Stückzahlen verwendet wird.  Wenn überhaupt, ist es immer möglich, alles ohne unnötige Schwierigkeiten zu reparieren (Schwierigkeiten treten auf, wenn die „Firmware“ in Tausenden von verkauften Geräten und einfach von einem Remote-Kunden aktualisiert werden muss). <br><br><h2>  Neue Hardwarekonfiguration </h2><br>  Aus irgendeinem Grund scheint es mir, dass das Prozessorsystem für diesen Artikel einfacher von Grund auf neu zu erstellen ist als das alte neu zu erstellen.  Ich möchte lieber noch einmal von Anfang an alles zeigen, wie man den Prozess „Twist, Twist, wollen verwirren“ demonstriert und dabei ständig auf frühere Artikel verweist.  Gleichzeitig reparieren wir das Material.  Also, fangen wir an. <br><br>  Ganz am Anfang wird uns ein völlig leeres System gezeigt, das nur eine Takt- und Rücksetzsignalquelle enthält. <br><br><img src="https://habrastorage.org/webt/7q/lb/nb/7qlbnbmbkenpbeqgwna6jk4jnn4.png"><br><br>  Normalerweise ändere ich dort nichts, aber heute mache ich eine Ausnahme.  Ich möchte mich nicht von der Rücksetzschaltung ablenken lassen, da wir weiterhin unter dem Debugger arbeiten werden.  Daher werde ich die Rücksetzbedingung vom Pegel auf eine negative Differenz umschalten und das Bein selbst wird anschließend aufgehoben. <br><br><img src="https://habrastorage.org/webt/dg/wl/tq/dgwltqtfn-kmqrd7wln66eenqxa.png"><br><br>  Hier hat das Taktsignal jedoch eine Frequenz von 50 MHz (diese Frequenz wird durch die Eigenschaften des auf die Platine gelöteten Generators eingestellt).  In dem ersten der oben erwähnten Artikel wurde der dem Hauptprojekt hinzugefügte PLL-Block verwendet.  Woher bekommen wir es hier?  Und hier ist er! <br><br><img src="https://habrastorage.org/webt/08/oy/om/08oyom1okdqkzb2ifmkuzqnjjw0.png"><br><br>  Dies ist der gleiche Block, aber hier müssen wir keinen Code in Verilog oder VHDL einbetten.  Alles ist schon für uns eingefügt!  Die Einstellung für verschiedene Arten von FPGAs unterscheidet sich zwar etwas mehr als vollständig.  Genauer gesagt sind die einstellbaren Parameter mehr oder weniger gleich, befinden sich jedoch an grundlegend unterschiedlichen Stellen in den Konfigurationsdialogen.  Da das Cyclone IV E FPGA im Redd-Komplex verwendet wird, wird die Konfiguration dieser Option in Betracht gezogen. <br><br>  Ersetzen Sie auf der ersten Registerkarte die Eingangsfrequenz durch 50 MHz (standardmäßig 100) und wechseln Sie zur nächsten Registerkarte (klicken Sie auf Weiter, für Cyclone IV E müssen wir dies viele Male tun). <br><br><img src="https://habrastorage.org/webt/w-/rd/um/w-rdummwtsajd7lb__-cdwzp5ko.png"><br><br>  Deaktivieren Sie die zusätzlichen Ein- und Ausgänge.  Wir brauchen sie nicht: <br><br><img src="https://habrastorage.org/webt/ed/0q/_o/ed0q_otou0y9f25tgvrlxmcpzgm.png"><br><br>  Wir überspringen die nächsten Registerkarten, bis wir den Ausgang C0 einstellen.  Dort schalten wir das Optionsfeld um, um die Frequenz einzustellen und den Wert von 100 MHz einzugeben: <br><br><img src="https://habrastorage.org/webt/r0/lr/xp/r0lrxpaypyrhi9k3yvdhe8qaqp4.png"><br><br>  Mit C1 sind die Dinge etwas komplizierter.  Aktivieren Sie zunächst das Kontrollkästchen, das besagt, dass es auch verwendet werden soll.  Zweitens stellen wir auf ähnliche Weise die Frequenz von 100 MHz ein.  Nun, und drittens stellen wir die Frequenzverschiebung ein.  Welches soll man fragen?  Minus 58 oder minus 65?  Natürlich habe ich beide Optionen ausprobiert.  Beide haben mich verdient.  Das Argument zum Thema minus 58 sieht jedoch etwas weniger überzeugend aus. Daher empfehle ich hier, den Wert minus 65 Grad einzugeben (während die Automatisierung mir sagt, dass der tatsächlich erreichte Wert minus 63 Grad beträgt). <br><br><img src="https://habrastorage.org/webt/bc/p2/qq/bcp2qqfzxrhq5dnpg8xrkxeq4cm.png"><br><br>  Nun, das ist es.  Jetzt können Sie die Schaltfläche <b>Weiter</b> bis zum Ende durchlaufen oder einfach auf <b>Fertig stellen</b> klicken.  Wir verbinden die Eingänge <b>inclk_interface</b> und <b>inclk_interface_reset</b> .  Der Ausgang <b>c0</b> wird als Takt für das gesamte System verwendet.  Der Ausgang <b>c1 wird</b> zum Takten des <b>SDRAM-</b> Chips exportiert.  In Zukunft müssen Sie daran denken, den Datenbus an den Eingang <b>pll_slave anzuschließen</b> .  Für Cyclone V wäre dies nicht erforderlich. <br><br><img src="https://habrastorage.org/webt/d8/ka/fr/d8kafro1xgmvgyh2ofbytqoo7a0.png"><br><br><h2>  Andere Hardware-Teile, ausschließlich zur Befestigung von Material </h2><br>  Fügen Sie einen Prozessorkern hinzu.  Heute wird unser SDRAM getestet.  Der Code sollte sich also nicht darin befinden.  Dies bedeutet wiederum, dass sich der gesamte Code im internen RAM des FPGA befindet.  Das heißt, wir benötigen keinen Anweisungscache.  Schalten Sie es aus und sparen Sie FPGA-Speicher.  Wir verbinden auch einen stark verbundenen Bus mit Anweisungen und Daten.  Es sind keine weiteren interessanten Einstellungen für den Prozessorkern erforderlich. <br><br><img src="https://habrastorage.org/webt/2s/h2/jz/2sh2jzypydrpub1i5pzsqfymbyc.png"><br><br>  Fügen Sie mit der üblichen Handbewegung zwei Blöcke internen RAM-FPGA hinzu.  Einer ist ein Dual-Port mit einer Kapazität von 16 Kilobyte und einer ist ein einzelner Port mit einer Kapazität von 4 Kilobyte.  Ich hoffe, jeder erinnert sich daran, wie man sie benennt und wie man sich verbindet.  Das letzte Mal, als ich die Reifen mit Blumen hervorheben wollte, vielleicht um das Lesen zu erleichtern, werde ich dies in diesem Artikel tun. <br><br><img src="https://habrastorage.org/webt/lu/fs/sh/lufsshayqwws2kmrbr1isy3bjow.png"><br><br>  Vergessen Sie nicht, diesen Speicherblöcken spezielle Adressen im persönlichen Bereich zuzuweisen und zu sperren.  Lassen Sie <b>CodeMemory</b> 0x20000000 und <b>DataMemory</b> 0x20004000 zuweisen. <br><br>  Nun, fügen wir dem System einen <b>SDRAM-</b> Block hinzu, richten ihn ein, sowie <b>JTAG-UART-</b> Blöcke zum Anzeigen von Nachrichten und einen Einzelbit- <b>GPIO</b> , auf dem wir die tatsächliche Frequenz messen, um sicherzustellen, dass sie zunimmt.  Als Referenz sind hier einige nicht offensichtliche Einstellungen: <br><br><img src="https://habrastorage.org/webt/i3/eo/1h/i3eo1hx2p7ozz4h_9t026n6h-io.png"><br><br><img src="https://habrastorage.org/webt/t9/af/br/t9afbrimkhlvmd-n8qkhc08ol50.png"><br><br><img src="https://habrastorage.org/webt/hw/f3/gc/hwf3gcxo8y4dt4exehzc-v_qoli.png"><br><br>  Insgesamt erhalten wir ein solches System (ich habe den Datenbus hervorgehoben, da er alle externen Geräte scannt): <br><br><img src="https://habrastorage.org/webt/jq/km/rv/jqkmrvm8acbrz3gqqq_asxque_a.png"><br><br>  Wir weisen dem Prozessor Vektoren zu, weisen dem Erzeugungssystem automatisch Adressen zu, unterbrechen automatisch Interrupt-Nummern. <br><br>  Wir verbinden das System mit dem Projekt, führen eine grobe Montage durch, weisen die <b>Beinnummern zu</b> und dieses Mal machen wir nicht nur <b>CKE</b> virtuell, sondern auch <b>reset_n</b> (wie dies gemacht wird, habe ich in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einem der vorherigen Artikel</a> gesagt, suchen Sie dort nach Virtual Pin).  Wir machen die Endmontage, füllen die Ausrüstung im FPGA.  Das ist alles.  Wir haben die Ausrüstung fertiggestellt und gehen zum Software-Teil. <br><br><h2>  Wir haben BSP für unsere Umwelt eingerichtet </h2><br>  Lassen Sie uns zur Abwechslung ein Projekt erstellen, das auf einer Vorlage basiert, die nicht von <b>Hello World Small</b> , sondern von <b>Memory Test Small stammt</b> : <br><br><img src="https://habrastorage.org/webt/fh/bf/zj/fhbfzjbc6dqxyirgnhffs5nmzmw.png"><br><br>  Wenn es erstellt wurde, gehen Sie zum BSP-Editor.  Wie üblich deaktivieren wir zunächst die SysID-Prüfung und erlauben die Verwendung von C ++ (obwohl ich diesmal den Dateityp nicht ändere, aber es ist bereits eine Gewohnheit für mich): <br><br><img src="https://habrastorage.org/webt/ro/z3/4m/roz34m7na_mx3tzwawyu98qrrgs.png"><br><br>  Aber das Wichtigste, was wir auf der Registerkarte <b>Linker Script</b> korrigieren müssen.  Die Automatisierung hat erkannt, dass der Befehlsbus nur in den <b>CodeMemory-</b> Speicher geht, <b>und</b> hat daher einen Codeabschnitt ( <b>Text.</b> ) Im <b>CodeMemory-</b> Speicher abgelegt.  Aber sie kümmerte sich um uns und platzierte alles andere in der größten Datenregion, die sich im <b>SDRAM befindet</b> .  Woher wusste sie, dass wir diese Erinnerung gnadenlos löschen würden? <br><br><img src="https://habrastorage.org/webt/vo/tm/wq/votmwq4a0fiiu1irm0nud86hvwa.png"><br><br>  Wir müssen die Region manuell Zeile für Zeile durch <b>DataMemory</b> ersetzen (Auswahllisten werden dort <b>angezeigt</b> , die Auswahl sollte in ihnen neu angeordnet werden).  Wir sollten dieses Bild bekommen: <br><br><img src="https://habrastorage.org/webt/-f/xf/gs/-fxfgskf00akgti0fab5r_nn-h0.png"><br><br><h2>  Programmexperimente </h2><br>  Wir verlassen den Editor, generieren den BSP und versuchen, das Programm zum Debuggen auszuführen.  Wir erhalten folgenden Text: <br><br><img src="https://habrastorage.org/webt/wd/wo/w2/wdwow2im-i13rjmekzoj2ada9ag.png"><br><br>  Wenn ich die Eingabetaste drücke, war ich nicht erfolgreich.  Ich habe etwas eingegeben (ja sogar ein Leerzeichen) und dann die Eingabetaste gedrückt.  Dann fragten sie mich: <br><br><img src="https://habrastorage.org/webt/f8/or/rz/f8orrztu-bfgdmvrwfs5pmi6bag.png"><br><br>  Stunde für Stunde ist nicht einfacher.  Und welche Adresse eingeben?  Sie können Platform Designer öffnen und dort den Wert anzeigen.  Normalerweise schaue ich in der universellen Referenzdatei system.h nach (der vollständige Pfad für mein Projekt lautet C: \ Work \ CachePlay5 \ software \ MemoryTest_bsp \ system.h).  Dort interessieren uns zwei Zeilen: <br><br><img src="https://habrastorage.org/webt/6s/jd/mn/6sjdmnjd-k-jpho1b21472e6xek.png"><br><br><div class="spoiler">  <b class="spoiler_title">Gleicher Text</b> <div class="spoiler_text"><pre><code class="plaintext hljs">#define ALT_MODULE_CLASS_new_sdram_controller_0 altera_avalon_new_sdram_controller #define NEW_SDRAM_CONTROLLER_0_BASE 0x0 #define NEW_SDRAM_CONTROLLER_0_CAS_LATENCY 3 #define NEW_SDRAM_CONTROLLER_0_CONTENTS_INFO #define NEW_SDRAM_CONTROLLER_0_INIT_NOP_DELAY 0.0 #define NEW_SDRAM_CONTROLLER_0_INIT_REFRESH_COMMANDS 2 #define NEW_SDRAM_CONTROLLER_0_IRQ -1 #define NEW_SDRAM_CONTROLLER_0_IRQ_INTERRUPT_CONTROLLER_ID -1 #define NEW_SDRAM_CONTROLLER_0_IS_INITIALIZED 1 #define NEW_SDRAM_CONTROLLER_0_NAME "/dev/new_sdram_controller_0" #define NEW_SDRAM_CONTROLLER_0_POWERUP_DELAY 100.0 #define NEW_SDRAM_CONTROLLER_0_REFRESH_PERIOD 15.625 #define NEW_SDRAM_CONTROLLER_0_REGISTER_DATA_IN 1 #define NEW_SDRAM_CONTROLLER_0_SDRAM_ADDR_WIDTH 0x18 #define NEW_SDRAM_CONTROLLER_0_SDRAM_BANK_WIDTH 2 #define NEW_SDRAM_CONTROLLER_0_SDRAM_COL_WIDTH 9 #define NEW_SDRAM_CONTROLLER_0_SDRAM_DATA_WIDTH 16 #define NEW_SDRAM_CONTROLLER_0_SDRAM_NUM_BANKS 4 #define NEW_SDRAM_CONTROLLER_0_SDRAM_NUM_CHIPSELECTS 1 #define NEW_SDRAM_CONTROLLER_0_SDRAM_ROW_WIDTH 13 #define NEW_SDRAM_CONTROLLER_0_SHARED_DATA 0 #define NEW_SDRAM_CONTROLLER_0_SIM_MODEL_BASE 0 #define NEW_SDRAM_CONTROLLER_0_SPAN 33554432 #define NEW_SDRAM_CONTROLLER_0_STARVATION_INDICATOR 0</code> </pre> <br></div></div><br>  Dabei ist die Dezimalzahl 33554432 gleich hex 0x2000000.  Daher sollten meine Antworten und das Ergebnis der Arbeit folgendermaßen aussehen: <br><br><img src="https://habrastorage.org/webt/4a/uq/tz/4auqtz8lgb-ql61btoxiqbskzfk.png"><br><br>  Großartig, aber das ist nicht gut für einen täglichen Test.  Ich habe die <b>Hauptfunktion folgendermaßen</b> umgeschrieben: <br><br><pre> <code class="plaintext hljs">int main(void) { int step = 0; while (1) { if (step++%100 == 0) { alt_printf ("."); } if (MemTestDevice(NEW_SDRAM_CONTROLLER_0_BASE, NEW_SDRAM_CONTROLLER_0_SPAN)!=0) { printf ("*"); } } return (0); }</code> </pre><br>  Die Punkte zeigen an, dass das Programm nicht „eingefroren“ ist.  Wenn ein Fehler auftritt, wird ein Sternchen angezeigt.  Aus Gründen der Zuverlässigkeit können Sie einen Haltepunkt für die Ausgabe festlegen und ihn dann einfach nicht in den Ruhezustand versetzen. <br><br>  Zwar kletterten die „linken“ Punkte von irgendwoher.  Es stellte sich heraus, dass sie in der Funktion <b>MemTestDevice ()</b> angezeigt werden.  Dort habe ich ihre Schlussfolgerung gelöscht.  Der Test war erfolgreich.  Das resultierende System kann zumindest für interne Bedürfnisse verwendet werden (solche Entwicklungen werden nämlich im Rahmen des Redd-Komplexes durchgeführt). <br><br><h2>  Überprüfen der Systemleistung </h2><br>  Aber ich bin bereits daran gewöhnt, dass man bei der Arbeit mit Geräten nichts vertrauen kann.  Alles sollte sorgfältig geprüft werden.  Stellen wir sicher, dass wir mit einer Frequenz arbeiten, die im Vergleich zu früheren Artikeln verdoppelt wurde.  Fügen Sie die bekannte Funktion MagicFunction1 () hinzu. <br><br><div class="spoiler">  <b class="spoiler_title">Lass mich dich daran erinnern, wie sie aussieht.</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">void MagicFunction1() { IOWR (PIO_0_BASE,0,1); IOWR (PIO_0_BASE,0,0); IOWR (PIO_0_BASE,0,1); IOWR (PIO_0_BASE,0,0); IOWR (PIO_0_BASE,0,1); IOWR (PIO_0_BASE,0,0); IOWR (PIO_0_BASE,0,1); IOWR (PIO_0_BASE,0,0); IOWR (PIO_0_BASE,0,1); IOWR (PIO_0_BASE,0,0); IOWR (PIO_0_BASE,0,1); IOWR (PIO_0_BASE,0,0); IOWR (PIO_0_BASE,0,1); IOWR (PIO_0_BASE,0,0); IOWR (PIO_0_BASE,0,1); IOWR (PIO_0_BASE,0,0); IOWR (PIO_0_BASE,0,1); IOWR (PIO_0_BASE,0,0); IOWR (PIO_0_BASE,0,1); IOWR (PIO_0_BASE,0,0); IOWR (PIO_0_BASE,0,1); IOWR (PIO_0_BASE,0,0); IOWR (PIO_0_BASE,0,1); IOWR (PIO_0_BASE,0,0); IOWR (PIO_0_BASE,0,1); IOWR (PIO_0_BASE,0,0); IOWR (PIO_0_BASE,0,1); IOWR (PIO_0_BASE,0,0); IOWR (PIO_0_BASE,0,1); IOWR (PIO_0_BASE,0,0); }</code> </pre><br></div></div><br>  Wir werden es von <b>main () nennen</b> , wir werden die Impulse auf dem Oszilloskop erfassen, aber dieses Mal werden wir nicht nur auf ihre Schönheit, sondern auch auf die Frequenz achten (ich möchte Sie daran erinnern, dass jeder Tropfen, auch nach oben oder unten, ein Befehl ist, damit Sie den Abstand zwischen den Tropfen messen können ) <br><br><img src="https://habrastorage.org/webt/sm/pt/xf/smptxfb1x4sub0-v-6lbu7wkdpy.png"><br><br>  Nur 50 Megahertz.  Hat sich die Frequenz wirklich nicht erhöht?  Vergleichen Sie mit der Häufigkeit des Codes, der beim Schreiben des letzten Artikels entwickelt wurde, und wir verstehen, dass alles in Ordnung ist.  Es ist nur so, dass die normale Pio-Einheit 2 Taktzyklen pro Ausgang zum Port benötigt (bei einem hausgemachten habe ich 1 Takt, aber hier reicht es aus, um sicherzustellen, dass sich die Leistung des Systems verdoppelt). <br><br><img src="https://habrastorage.org/webt/w3/in/uo/w3inuobmvzdoa7pebgadrjigute.png"><br><br><h2>  Fazit </h2><br>  Anstatt einen Oszillator mit fester Frequenz zu verwenden, haben wir gelernt, wie man eine benutzerdefinierte PLL-Einheit verwendet.  Die erkannten Konstanten sind zwar für eine Frequenz von 100 MHz vorgesehen, aber jeder kann sie entweder mit bekannten Berechnungen oder durch Ausprobieren auf eine andere Frequenz einstellen.  Wir haben auch die Fähigkeiten zur Schaffung eines optimalen Prozessorsystems gestärkt und sichergestellt, dass der Speicher bei einer höheren Frequenz stabil funktioniert und die Frequenz wirklich zunimmt. <br><br>  Im Allgemeinen können wir bereits alle Computer-Dinge produzieren, wir können sogar mit dem Zentralprozessor austauschen, aber der Zentralprozessor des Komplexes wird triviale Berechnungen effizienter bewältigen.  Redd wird FPGA hinzugefügt, um Hochgeschwindigkeitsschnittstellen zu implementieren oder Informationsflüsse zu erfassen (gut oder abspielen).  Wir haben die Grundlagen des Entwerfens bereits beherrscht und gelernt, mehr oder weniger hohe Leistung zu erzielen.  Es ist Zeit, weiter mit Schnittstellen zu arbeiten, was wir im nächsten Artikel tun werden.  Genauer gesagt, eine Reihe von Artikeln, die die Regel "ein Artikel - eine Sache" berücksichtigen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de469985/">https://habr.com/ru/post/de469985/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de469975/index.html">Santiago Weg mit Laptop</a></li>
<li><a href="../de469977/index.html">Wie drei Klassenkameraden zu Facebook-Partnern wurden - Revealbot-Geschichte</a></li>
<li><a href="../de469979/index.html">Aufzeichnungen von Berichten aus dem zweiten iOS mitap Redmadrobot</a></li>
<li><a href="../de469981/index.html">Was ist im Chat-Bot?</a></li>
<li><a href="../de469983/index.html">Wie kann man eine Strategie entwickeln, um das Altern zu besiegen?</a></li>
<li><a href="../de469987/index.html">Top 20 Marktentwicklungsunternehmen aus aller Welt</a></li>
<li><a href="../de469991/index.html">Wir bearbeiten Bestellungen aus dem Online-Shop mit RabbitMQ und TypeScript</a></li>
<li><a href="../de469995/index.html">Python SAX-Parser gegen Python DOM-Parser. Parsim FIAS-Häuser</a></li>
<li><a href="../de469997/index.html">Welche Schlagzeilen am ehesten Aufmerksamkeit erregen oder HabraHabr-Analyse</a></li>
<li><a href="../de469999/index.html">Wie Server miteinander verhandeln: Raft Distributed Consensus-Algorithmus</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>