<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>〰️ 👩🏾‍🏭 🦓 Speichern Sie statische Ressourcen auf Ihrem Hosting 🔣 ↪️ 🏇🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Eines der ersten Dinge, die ich meinen Kunden empfehle, um Websites zu beschleunigen, erscheint zunächst paradox: Sie müssen statische Ressourcen auf ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Speichern Sie statische Ressourcen auf Ihrem Hosting</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/457210/">  Eines der ersten Dinge, die ich meinen Kunden empfehle, um Websites zu beschleunigen, erscheint zunächst paradox: Sie müssen statische Ressourcen auf Ihrem Hosting platzieren und die CDN-Infrastruktur von Drittanbietern aufgeben.  In diesem kurzen und hoffentlich sehr einfachen Beitrag möchte ich die Nachteile des Speicherns Ihrer statischen Dateien "nebenbei" und die enormen Vorteile des Hostings auf meinem Hosting skizzieren. <br><a name="habracut"></a><br><h4>  Worüber rede ich? </h4><br>  Entwickler klicken häufig auf den Link zu statischen Assets wie Bibliotheken oder Plugins, die sich auf Websites und CDN-Ressourcen befinden.  Ein klassisches Beispiel ist jQuery. <br><br>  Es gibt eine Reihe offensichtlicher Vorteile, aber mein Ziel später in diesem Artikel ist es, diesen Ansatz aufzuzeigen und zu zeigen, dass die Nachteile viel häufiger auftreten. <br><br>  (Betrachten Sie zunächst die Vorteile). <br><br><ul><li>  <b>Das ist bequem.</b>  Das Verbinden von Dateien erfordert nur sehr wenig Aufwand.  Kopieren Sie die HTML-Codezeile, und Sie sind fertig.  Einfach. </li><li>  <b>Wir erhalten Zugang zum CDN.</b>  code.jquery.com wird von StackPath bereitgestellt, es ist ein CDN.  Durch die Verbindung mit den Inhalten dieser Ressource erhalten wir eine kostenlose Lieferung in CDN-Qualität. </li><li> <b>Benutzerdateien sind möglicherweise bereits zwischengespeichert.</b>  Wenn website-a.com auf <a href="">code.jquery.com/jquery-3.3.1.slim.min.js verweist</a> und der Benutzer von hier zu website-b.com wechselt, das auch auf <a href="">code.jquery.com/jquery-3.3 verweist .1.slim.min.js</a> , dann hat der Benutzer diese Datei im Cache. </li></ul><br><h4>  Risiko: Geschwindigkeitsabfall und Ausfälle </h4><br>  Ich werde in diesem Beitrag nicht auf zu viele Details eingehen.  Ich habe einen ganzen Artikel über die Lebensfähigkeit eines Dritten und die mit Verzögerungen und Unterbrechungen verbundenen Risiken.  Es genügt zu sagen, dass wenn Sie über kritische Ressourcen im Zusammenhang mit Drittanbietern verfügen und der Anbieter unter Abstürzen und einem Rückgang der Geschwindigkeit oder Ausfällen leidet, dies eine ziemlich unangenehme Nachricht für Sie ist.  Sie werden auch darunter leiden. <br><br>  Wenn Sie Render-blockierendes CSS oder synchrones JS auf Ressourcen von Drittanbietern gehostet haben, übertragen Sie diese sofort auf Ihre eigene Infrastruktur.  Kritische Assets sind zu wertvoll, um auf Servern von Drittanbietern belassen zu werden. <br><br><h4>  Risiko: Beendigung des Dienstes </h4><br>  Dies kommt viel seltener vor. Was passiert jedoch, wenn der Anbieter entscheidet, dass der Dienst eingestellt werden muss?  Dies ist genau das, was Rawgit im Oktober 2018 getan hat. Bisher (zum Zeitpunkt des Schreibens) bietet eine grobe Suche im GitHub-Code immer noch mehr als eine Million Links zu dem Dienst, der derzeit geschlossen wird, und fast 20.000 bestehende Websites werden weiterhin verwendet beziehen Sie sich darauf. <br><br><h4>  Risiko: Sicherheitslücken </h4><br>  Eine andere Sache, auf die man achten sollte, ist eine einfache Vertrauenssache.  Wenn wir Inhalte von Ressourcen Dritter auf unsere Seite bringen, müssen wir hoffen, dass die Dateien, die wir erhalten, genau das sind, was wir erwarten, und genau das tun, was wir von ihnen erwarten. <br><br>  Stellen Sie sich den Schaden vor, der entstehen könnte, wenn jemand die Kontrolle über einen Anbieter wie code.jquery.com erlangen und kompromittierte oder böswillige Inhalte bereitstellen könnte.  Es ist beängstigend darüber nachzudenken! <br><br><h4>  Subressourcenintegrität </h4><br>  Wir müssen allen in diesem Artikel genannten Drittanbietern Tribut zollen. Sie tun alles, um die Integrität der Subressource (Subresource Integrity - SRI) sicherzustellen.  SRI ist der Mechanismus, mit dem der Anbieter den Hash (technisch gesehen einen Hash gefolgt von einer Base64-Codierung) der spezifischen Datei bereitstellt, die Sie erwarten und verwenden möchten.  Der Browser kann dann überprüfen, ob die empfangene Datei genau Ihren Anforderungen entspricht. <br><br><pre><code class="plaintext hljs">&lt;script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha256-pasqAKBDmFT4eHoN2ndd6lN370kFiGUFyTiUHWhU7k8=" crossorigin="anonymous"&gt;&lt;/script&gt;</code> </pre> <br>  Wenn Sie statische Inhalte unbedingt mit einer Ressource eines Drittanbieters verbinden müssen, stellen Sie erneut sicher, dass SRI aktiv ist.  Sie können SRI selbst anschließen. <br><br><h4>  Abrechnung: Netzwerkverhandlungen </h4><br>  Eine der größten und dringendsten Kosten, die uns entstehen, sind die Kosten für die Eröffnung neuer TCP-Verbindungen.  Für jede neue Ressource, die wir besuchen müssen, muss eine Verbindung hergestellt werden, was sehr teuer sein kann: DNS-Auflösung, TCP-Handshake, TLS-Aushandlung, die alle dazu beitragen, und die Geschichte wird schlimmer, wenn sich die Verbindung verzögert. <br><br>  Ich werde ein Beispiel geben, das direkt von Bootstraps eigener Seite "Erste Schritte" stammt.  Sie weisen Benutzer an, vier Dateien anzuhängen. <br><br>  Diese vier Dateien befinden sich auf drei verschiedenen Ressourcen, dh wir müssen drei TCP-Verbindungen öffnen.  Wie viel kostet das?  Nun, mit einer ziemlich schnellen Verbindung ist der Inhalt dieser statischen Dateien auf der Seite 311 ms oder 1,65-mal langsamer als wenn Sie sie auf Ihrem eigenen Hosting platzieren. <br><br>  Durch die Kontaktaufnahme mit drei verschiedenen Quellen für die Wartung statischer Assets verlieren wir gemeinsam die unnötigen 805 ms für Netzwerkgenehmigungen. <br><br>  OK, es ist nicht so beängstigend, aber Trainline, mein Kunde, stellte fest, dass Besucher, als die Verzögerung um 300 ms reduziert wurde, zusätzliche 8 Millionen Pfund pro Jahr zahlten.  Dies ist ein ziemlich einfacher Weg, um 8 Millionen zu verdienen. <br><br>  Durch die Verlagerung unserer Ressourcen auf Ihre Domain entfallen die Kosten für zusätzliche Verbindungen vollständig. <br><br>  Bei einer langsameren Verbindung mit einer längeren Verzögerung ist die Geschichte viel schlimmer.  Für 3G ist die Version von Drittanbietern langsamer als 1.765s.  Ich dachte, es sollte unsere Seite schneller machen. <br><br>  Bei einer Verbindung mit großer Verzögerung betragen die gesamten Netzwerkkosten ungeheure 5,037 Sekunden.  Was kann völlig vermieden werden. <br><br>  Durch das Verschieben von Dateien in unsere eigene Infrastruktur wird die Downloadzeit von 5,4 auf 3,6 Sekunden reduziert. <br><br>  Wenn dies kein guter Grund ist, Ihre statischen Ressourcen zu hosten, weiß ich nicht, was ich sonst noch mitbringen soll. <br><br><h4>  Voranschließen </h4><br>  Der springende Punkt meiner Präsentation hier ist natürlich, dass Sie keine statischen Ressourcen nebenbei veröffentlichen sollten, wenn Sie dies auf Ihrem Hosting tun können.  Wenn Ihnen jedoch die Hände gebunden sind, können Sie mithilfe der Ressourcenverbindungsvorverbindung proaktiv eine TCP-Verbindung zu einer bestimmten Quelle (n) öffnen: Darüber hinaus ist die Bereitstellung als HTTP-Header noch schneller. <br>  <b>Hinweis</b>  Selbst wenn Sie Preconnect verwenden, verringert sich der Zeitverlust nur geringfügig: Sie müssen immer noch die entsprechenden Verbindungen öffnen, und es ist unwahrscheinlich, dass die Kosten jemals gerechtfertigt werden, insbesondere bei langsamen Verbindungen. <br><br><h4>  Abrechnung: Verlust der Priorisierung </h4><br>  Die zweite Abrechnung erfolgt in Form einer Optimierung auf Protokollebene, die wir vermissen, wenn wir den Inhalt in Domänen aufteilen.  Wenn Sie HTTP / 2 verwenden, erhalten Sie Zugriff auf die Priorisierung. <br><br>  Alle Flows (daher Ressourcen) mit derselben TCP-Verbindung behalten ihre Priorität, und Browser und Server arbeiten zusammen, um den Abhängigkeitsbaum aller dieser priorisierten Flows zu erstellen, sodass wir kritische Ressourcen schneller zurückgeben und möglicherweise die Lieferung weniger wichtiger Ressourcen verzögern können. <br><br>  <b>Hinweis</b>  Technisch gesehen können Anforderungen aufgrund des Zusammenführens von HTTP / 2-Verbindungen über verschiedene Domänen hinweg relativ zueinander priorisiert werden, sofern sie dieselbe IP-Adresse verwenden. <br><br>  Wenn wir unsere Ressourcen auf verschiedene Domänen verteilen, müssen wir mehrere eindeutige TCP-Verbindungen öffnen.  Wir können keine Prioritäten für diese Verbindungen setzen, dh wir verlieren die Fähigkeit, Dateien auf eine bestimmte durchdachte Weise zu liefern. <br><br>  Indem wir den gesamten Inhalt auf einem Hosting hosten, können wir einen komplexeren Abhängigkeitsbaum erstellen.  Jeder Thread hat eine eigene ID, da sie zum selben Baum gehören.  Wenn wir so viel Inhalt wie möglich von einer Domain bereitstellen, können wir HTTP / 2 seine Arbeit erledigen lassen und Assets in der Hoffnung auf eine schnellere Antwort umfassender priorisieren. <br><br><h4>  Caching </h4><br>  Im Großen und Ganzen scheinen statische Ressourcen-Hosts ziemlich gut mit dem Festlegen langlebiger Max-Age-Direktiven zurechtzukommen.  Dies ist sinnvoll, da sich statische Inhalte auf versionierten URLs (wie oben angegeben) niemals ändern werden.  Dies macht es sehr sicher und rational, eine einigermaßen aggressive Cache-Richtlinie durchzusetzen. <br><br>  Dies ist jedoch nicht immer der Fall. Wenn Sie Ihre Ressourcen unabhängig voneinander platzieren, können Sie viel individuellere Caching-Strategien entwickeln. <br><br><h4>  Mythos: Domänenübergreifendes Caching </h4><br>  Interessanter ist die Möglichkeit, domänenübergreifendes Asset-Caching durchzuführen.  Das heißt, wenn viele Websites auf dieselbe Version von jQuery verweisen, die sich auf dem CDN befindet, haben Benutzer diese bestimmte Datei sicherlich bereits auf ihrem Computer.  So etwas wie Peer-to-Peer-Ressourcenfreigabe.  Dies ist eines der häufigsten Argumente für die Verwendung eines statischen Asset-Anbieters eines Drittanbieters. <br><br>  Leider gibt es keine veröffentlichten Beweise, die diese Behauptungen stützen: Es gibt keinen Grund zu der Annahme, dass dies wahr ist.  Umgekehrt deutet eine aktuelle Studie von Paul Calvano darauf hin, dass das Gegenteil der Fall sein könnte: <br><br>  Es gibt eine merkliche Lücke zwischen dem Alter des CSS-Ressourcencaches und den Webschriftarten von Erst- und Drittanbietern.  95% der Erstanbieter-Schriftarten sind älter als 1 Woche, verglichen mit 50% der Drittanbieter-Schriftarten, die weniger als 1 Woche alt sind.  Dies bietet gute Gründe für selbst gehostete Web-Schriftarten. <br><br>  Im Allgemeinen scheint es, dass Inhalte von Drittanbietern schlechter zwischengespeichert werden als ihre eigenen. <br><br>  Noch wichtiger ist, dass Safari diese Funktion aufgrund von Bedenken hinsichtlich des Missbrauchs der Privatsphäre vollständig deaktiviert hat, sodass die Shared-Cache-Technologie zum Zeitpunkt dieses Schreibens für 16% der Benutzer weltweit möglicherweise nicht funktioniert. <br><br>  Kurz gesagt, obwohl dies theoretisch gut ist, gibt es keine Hinweise darauf, dass domänenübergreifendes Caching irgendwie effizient ist. <br><br><h4>  CDN-Zugang </h4><br>  Ein weiterer weit verbreiteter Vorteil der Kontaktaufnahme mit einem statischen Ressourcenanbieter besteht darin, dass wahrscheinlich eine leistungsstarke Infrastruktur mit CDN-Funktionen verwendet wird: globale Verteilung, Skalierbarkeit, geringe Latenz und hohe Verfügbarkeit. <br><br>  Da dies absolut richtig ist, sollten Sie, wenn Sie sich für Ihre Leistung interessieren, Ihre eigenen Inhalte über das CDN ausführen.  Angesichts der aktuellen Hosting-Preise gibt es nur wenige Gründe, warum Sie dies nicht für Ihre Ressourcen verwenden. <br><br>  Mit anderen Worten: Wenn Sie glauben, dass Sie ein CDN für Ihre jQuery benötigen, benötigen Sie für alles ein CDN. <br><br><h4>  Hosten Sie statische Ressourcen auf Ihrem Hosting </h4><br>  Tatsächlich gibt es nur sehr wenige Gründe, Ihre statischen Ressourcen in der Infrastruktur eines anderen zu belassen.  Die möglichen Vorteile sind oft ein Mythos, und selbst wenn nicht, sind Kompromisse einfach nicht wert.  Das Laden von Ressourcen aus verschiedenen Quellen ist viel langsamer.  Nehmen Sie sich in den nächsten Tagen zehn Minuten Zeit, um Ihre Projekte zu prüfen und die Kontrolle über alle statischen Ressourcen von Drittanbietern zu übernehmen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de457210/">https://habr.com/ru/post/de457210/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de457200/index.html">Ein Zeichenbot zur Verwirklichung alltäglicher Szenen und sogar Geschichten</a></li>
<li><a href="../de457202/index.html">Wie wir Ideen für die Entwicklung unserer Produkte auswählen: Der Anbieter muss hören können ...</a></li>
<li><a href="../de457204/index.html">Windows PowerShell und lange Pfade</a></li>
<li><a href="../de457206/index.html">SQL Index Manager - eine lange Geschichte über SQL Server, Grabgraben und Indexpflege</a></li>
<li><a href="../de457208/index.html">Dynamisches Generieren von robots.txt für ASP.NET Core-Sites basierend auf der Umgebung</a></li>
<li><a href="../de457212/index.html">Warum ist es nie zu spät, Java (oder andere Java-Sprachen) zu lernen?</a></li>
<li><a href="../de457224/index.html">Ein moderner Ansatz für den Wettbewerb in Android: Corotins bei Kotlin</a></li>
<li><a href="../de457232/index.html">Roboterbiene "Bumble" - der erste Testflug innerhalb der ISS</a></li>
<li><a href="../de457234/index.html">Produkt kognitive Verzerrung</a></li>
<li><a href="../de457236/index.html">Wie ein IT-Unternehmen Schwierigkeiten hatte, Musik zu verkaufen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>