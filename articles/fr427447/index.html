<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìú ü§∞ üö∞ PVS-Studio prend en charge la cha√Æne d'outils int√©gr√©e GNU Arm üå≤ üê§ üàÇÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Les syst√®mes embarqu√©s sont entr√©s depuis longtemps et fermement dans nos vies. Les exigences de stabilit√© et de fiabilit√© sont tr√®s √©lev√©es et la cor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PVS-Studio prend en charge la cha√Æne d'outils int√©gr√©e GNU Arm</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/427447/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fef/427/f4c/fef427f4c05625dec0a8cfd484ad79d0.png" alt="Cha√Æne d'outils int√©gr√©e GNU Arm + PVS-Studio"></div><br>  Les syst√®mes embarqu√©s sont entr√©s depuis longtemps et fermement dans nos vies.  Les exigences de stabilit√© et de fiabilit√© sont tr√®s √©lev√©es et la correction d'erreurs est co√ªteuse.  Par cons√©quent, il est particuli√®rement important que les d√©veloppeurs int√©gr√©s utilisent r√©guli√®rement des outils sp√©cialis√©s pour garantir la qualit√© du code source.  Cet article parlera de l'apparence de la prise en charge de la cha√Æne d'outils int√©gr√©e GNU Arm dans l'analyseur PVS-Studio et des d√©fauts de code trouv√©s dans le projet Mbed OS. <br><a name="habracut"></a><br><h2>  Pr√©sentation </h2><br>  L'analyseur PVS-Studio prend d√©j√† en charge plusieurs compilateurs commerciaux pour les syst√®mes embarqu√©s, par exemple: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">IAR Embedded Workbench</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Outils de d√©veloppement int√©gr√©s Keil pour Arm</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Outils de g√©n√©ration de code TI ARM</a> </li></ul><br>  Maintenant, un autre outil de d√©veloppeur a √©t√© ajout√© pour prendre en charge - la cha√Æne d'outils int√©gr√©e GNU. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">La cha√Æne d'outils int√©gr√©e GNU</a> est une collection de compilateurs d'Arm bas√©e sur la collection de compilateurs GNU.  La premi√®re version officielle a eu lieu en 2012 et depuis lors, le projet se d√©veloppe avec le CCG. <br><br>  Le but principal de GNU Embedded Toolchain est de g√©n√©rer du code qui s'ex√©cute sur du m√©tal nu, c'est-√†-dire directement sur le processeur sans intercouche sous la forme d'un syst√®me d'exploitation.  Le package comprend des compilateurs pour C et C ++, un assembleur, un ensemble d'utilitaires GNU Binutils et la biblioth√®que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Newlib</a> .  Le code source de tous les composants est enti√®rement ouvert et sous licence GNU GPL.  Depuis le site officiel, vous pouvez t√©l√©charger des versions pour Windows, Linux et macOS. <br><br><h2>  Mbed OS </h2><br>  Pour tester l'analyseur, vous avez besoin d'autant de code source que possible.  Habituellement, cela ne pose aucun probl√®me, mais lorsque nous traitons de d√©veloppement int√©gr√© visant principalement les appareils inclus dans l'IoT, il peut √™tre difficile de trouver un nombre suffisant de grands projets.  Heureusement, ce probl√®me a √©t√© r√©solu par des syst√®mes d'exploitation sp√©cialis√©s, dont le code source est dans la plupart des cas ouvert.  Plus loin, nous parlerons de l'un d'eux. <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bb9/5b1/8a8/bb95b18a83f4b1b97c8cb2519c6d7018.png" alt="Mbed OS + PVS-Studio"></div><br><br>  Bien que l'objectif principal de cet article soit de parler de la prise en charge de la cha√Æne d'outils int√©gr√©e GNU, il est difficile d'√©crire beaucoup √† ce sujet.  De plus, les lecteurs de nos articles attendent probablement une description de quelques erreurs int√©ressantes.  Eh bien, ne trompons pas leurs attentes et ex√©cutons l'analyseur sur le projet Mbed OS.  Il s'agit d'un syst√®me d'exploitation open source d√©velopp√© avec l'aide d'Arm. <br><br>  Site officiel: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://www.mbed.com/</a> <br><br>  Code source: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://github.com/ARMmbed/mbed-os</a> <br><br>  Le choix sur Mbed OS n'est pas tomb√© par hasard, voici comment les auteurs d√©crivent le projet: <br><br>  Arm Mbed OS est un syst√®me d'exploitation embarqu√© open source sp√©cialement con√ßu pour les ¬´choses¬ª de l'Internet des objets.  Il comprend toutes les fonctionnalit√©s dont vous avez besoin pour d√©velopper un produit connect√© bas√© sur un microcontr√¥leur Arm Cortex-M, y compris la s√©curit√©, la connectivit√©, un RTOS et des pilotes pour les capteurs et les p√©riph√©riques d'E / S. <br><br>  Il s'agit d'un projet de construction id√©al utilisant la cha√Æne d'outils int√©gr√©e GNU, en particulier compte tenu de l'implication d'Arm dans son d√©veloppement.  Je vais faire une r√©servation tout de suite que je n'ai pas eu pour objectif de trouver et d'afficher autant d'erreurs que possible dans un projet sp√©cifique. Les r√©sultats de l'examen sont donc bri√®vement examin√©s. <br><br><h2>  Erreurs </h2><br>  Lors de la v√©rification du code Mbed OS, l'analyseur PVS-Studio a g√©n√©r√© 693 avertissements, 86 d'entre eux avec une priorit√© √©lev√©e.  Je ne les examinerai pas tous en d√©tail, d'autant plus que nombre d'entre eux se r√©p√®tent ou ne pr√©sentent pas un int√©r√™t particulier.  Par exemple, l'analyseur a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">g√©n√©r√© de</a> nombreux avertissements <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V547</a> (l'expression est toujours vraie / fausse) li√©s aux m√™mes fragments de code.  L'analyseur peut √™tre configur√© pour r√©duire consid√©rablement le nombre de r√©ponses fausses et sans int√©r√™t, mais cette t√¢che n'a pas √©t√© d√©finie lors de la r√©daction d'un article.  Ceux qui le souhaitent peuvent voir un exemple d'une telle configuration d√©crite dans l'article " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Sp√©cifications de l'analyseur PVS-Studio en utilisant l'exemple EFL Core Libraries, 10-15% de faux positifs</a> ". <br><br>  Pour l'article, j'ai s√©lectionn√© quelques erreurs int√©ressantes pour d√©montrer le fonctionnement de l'analyseur. <br><br><h2>  Fuites de m√©moire </h2><br>  Commen√ßons par la classe commune des erreurs en C et C ++ - les fuites de m√©moire. <br><br>  Avertissement de l'analyseur: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V773</a> CWE-401 La fonction a √©t√© quitt√©e sans lib√©rer le pointeur 'read_buf'.  Une fuite de m√©moire est possible.  cfstore_test.c 565 <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span> cfstore_test_init_1(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>) { .... read_buf = (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span>*) <span class="hljs-built_in"><span class="hljs-built_in">malloc</span></span>(max_len); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(read_buf == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) { CFSTORE_ERRLOG(....); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ret; } .... <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(node-&gt;key_name != <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) { .... ret = drv-&gt;Create(....); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(ret &lt; ARM_DRIVER_OK){ CFSTORE_ERRLOG(....); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ret; <span class="hljs-comment"><span class="hljs-comment">// &lt;= } .... free(read_buf); return ret; }</span></span></code> </pre> <br>  La situation classique lors de l'utilisation de la m√©moire dynamique.  Le tampon allou√© par <i>malloc</i> est utilis√© uniquement √† l'int√©rieur de la fonction et lib√©r√© avant de quitter.  Le probl√®me est que cela ne se produit pas si la fonction cesse de fonctionner plus t√¥t.  Notez le m√™me code dans les blocs <i>if</i> .  Tr√®s probablement, l'auteur a copi√© le fragment sup√©rieur et a oubli√© d'ajouter un appel <i>gratuit</i> . <br><br>  Un autre exemple similaire au pr√©c√©dent. <br><br>  Avertissement de l'analyseur: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V773</a> CWE-401 La fonction a √©t√© quitt√©e sans lib√©rer le pointeur ¬´interface¬ª.  Une fuite de m√©moire est possible.  nanostackemacinterface.cpp 204 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">nsapi_error_t</span></span> Nanostack::add_ethernet_interface( EMAC &amp;emac, <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> default_if, Nanostack::EthernetInterface **interface_out, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> *mac_addr) { .... Nanostack::EthernetInterface *interface; interface = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> (nothrow) Nanostack::EthernetInterface(*single_phy); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!interface) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> NSAPI_ERROR_NO_MEMORY; } <span class="hljs-keyword"><span class="hljs-keyword">nsapi_error_t</span></span> err = interface-&gt;initialize(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (err) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> err; <span class="hljs-comment"><span class="hljs-comment">// &lt;= } *interface_out = interface; return NSAPI_ERROR_OK; }</span></span></code> </pre> <br>  Le pointeur vers la m√©moire allou√©e est renvoy√© via le param√®tre de sortie, mais uniquement si l'appel d' <i>initialisation</i> a r√©ussi, et en cas d'erreur, une fuite se produit car la variable d' <i>interface</i> locale sort du domaine et le pointeur est simplement perdu.  Ici, il faut soit appeler <i>delete</i> , soit au moins donner l'adresse stock√©e dans la variable d' <i>interface</i> √† l'ext√©rieur dans tous les cas, afin que le code appelant puisse s'en occuper. <br><br><h2>  Memset </h2><br>  L'utilisation de la fonction <i>memset</i> entra√Æne souvent des erreurs, des exemples des probl√®mes qui lui sont associ√©s peuvent √™tre trouv√©s dans l'article " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">La fonction la plus dangereuse du monde C / C ++</a> ". <br><br>  Tenez compte de l'avertissement de l'analyseur suivant: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V575</a> CWE-628 La fonction 'memset' traite les √©l√©ments '0'.  Inspectez le troisi√®me argument.  mbed_error.c 282 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">mbed_error_status_t</span></span> mbed_clear_all_errors(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>) { .... <span class="hljs-comment"><span class="hljs-comment">//Clear the error and context capturing buffer memset(&amp;last_error_ctx, sizeof(mbed_error_ctx), 0); //reset error count to 0 error_count = 0; .... }</span></span></code> </pre> <br>  Le programmeur avait l'intention de r√©initialiser la m√©moire occup√©e par la structure <i>last_error_ctx</i> , mais a m√©lang√© les deuxi√®me et troisi√®me arguments.  Par cons√©quent, <i>0</i> octet est rempli avec la valeur <i>sizeof (mbed_error_ctx)</i> . <br><br>  Exactement la m√™me erreur est pr√©sente une centaine de lignes plus haut: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V575</a> CWE-628 La fonction 'memset' traite les √©l√©ments '0'.  Inspectez le troisi√®me argument.  mbed_error.c 123 <br><br><h2>  Instruction 'return' inconditionnelle dans une boucle </h2><br>  Avertissement de l'analyseur: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V612</a> CWE-670 Un ¬´retour¬ª inconditionnel dans une boucle.  thread_network_data_storage.c 2348 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">thread_nd_service_anycast_address_mapping_from_network_data</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">thread_network_data_cache_entry_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *networkDataList, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint16_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *rlocAddress, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> S_id)</span></span></span><span class="hljs-function"> </span></span>{ ns_list_foreach(<span class="hljs-keyword"><span class="hljs-keyword">thread_network_data_service_cache_entry_t</span></span>, curService, &amp;networkDataList-&gt;service_list) { <span class="hljs-comment"><span class="hljs-comment">// Go through all services if (curService-&gt;S_id != S_id) { continue; } ns_list_foreach(thread_network_data_service_server_entry_t, curServiceServer, &amp;curService-&gt;server_list) { *rlocAddress = curServiceServer-&gt;router_id; return true; // &lt;= } } return false; }</span></span></code> </pre> <br>  Dans cet extrait, <i>ns_list_foreach</i> est la macro qui se d√©veloppe dans l'instruction <i>for</i> .  La boucle interne n'effectue pas plus d'une it√©ration en raison de l'appel √† <i>retourner</i> imm√©diatement apr√®s la ligne dans laquelle le param√®tre de sortie de la fonction est initialis√©.  Peut-√™tre que ce code fonctionne comme pr√©vu, mais l'utilisation de la boucle interne semble plut√¥t √©trange dans ce contexte.  Tr√®s probablement, l'initialisation <i>rlocAddress</i> et la sortie de la fonction doivent √™tre effectu√©es par condition, <i>sinon</i> vous pouvez vous d√©barrasser de la boucle interne. <br><br><h2>  Erreurs dans les conditions </h2><br>  Comme je l'ai dit ci-dessus, l'analyseur a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">g√©n√©r√© un</a> assez grand nombre d'avertissements <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V547</a> sans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">int√©r√™t</a> , donc je les ai √©tudi√©s couramment et n'ai √©crit que deux cas pour l'article. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V547</a> CWE-570 L'expression 'pcb-&gt; state == LISTEN' est toujours fausse.  lwip_tcp.c 689 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> tcp_state { CLOSED = <span class="hljs-number"><span class="hljs-number">0</span></span>, LISTEN = <span class="hljs-number"><span class="hljs-number">1</span></span>, .... }; <span class="hljs-function"><span class="hljs-function">struct tcp_pcb * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tcp_listen_with_backlog_and_err</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(struct tcp_pcb *pcb, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">u8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> backlog, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">err_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *err)</span></span></span><span class="hljs-function"> </span></span>{ .... LWIP_ERROR(<span class="hljs-string"><span class="hljs-string">"tcp_listen: pcb already connected"</span></span>, pcb-&gt;state == CLOSED, res = ERR_CLSD; <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> done); <span class="hljs-comment"><span class="hljs-comment">/* already listening? */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pcb-&gt;state == LISTEN) { <span class="hljs-comment"><span class="hljs-comment">// &lt;= lpcb = (struct tcp_pcb_listen*)pcb; res = ERR_ALREADY; goto done; } .... }</span></span></code> </pre> <br>  L'analyseur consid√®re que la condition <i>pcb-&gt; state == LISTEN est</i> toujours fausse, <i>voyons</i> pourquoi. <br><br>  Avant l' <i>instruction if</i> , la macro <i>LWIP_ERROR</i> est <i>utilis√©e</i> , ce qui, par sa logique de fonctionnement, ressemble √† <i>assert</i> .  Son annonce ressemble √† ceci: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> LWIP_ERROR(message, expression, handler) do { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (!(expression)) { \ LWIP_PLATFORM_ERROR(message); handler;}} while(0)</span></span></code> </pre> <br>  Si la condition est fausse, la macro signale une erreur et ex√©cute le code transmis via le param√®tre du <i>gestionnaire</i> , dans ce fragment de code il y a un saut inconditionnel √† l'aide de <i>goto</i> . <br><br>  Dans cet exemple, la condition 'pcb-&gt; state == CLOSED' est v√©rifi√©e, c'est-√†-dire que la transition vers l'√©tiquette <i>done</i> se produit lorsque <i>pcb-&gt; state</i> a une autre valeur.  L' <i>instruction if</i> suivant l'appel √† <i>LWIP_ERROR</i> v√©rifie l' <i>√©tat pcb-&gt;</i> pour <i>LISTEN</i> , mais cette condition n'est jamais remplie, car l' <i>√©tat</i> sur cette ligne ne peut contenir que la valeur <i>CLOSED</i> . <br><br>  Consid√©rez un autre avertissement li√© aux conditions: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V517</a> CWE-570 L'utilisation du mod√®le 'if (A) {...} else if (A) {...}' a √©t√© d√©tect√©e.  Il y a une probabilit√© de pr√©sence d'erreur logique.  V√©rifiez les lignes: 62, 65. libdhcpv6_server.c 62 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">libdhcpv6_address_generate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (entry-&gt;linkType == DHCPV6_DUID_HARDWARE_EUI64_TYPE) <span class="hljs-comment"><span class="hljs-comment">// &lt;= { memcpy(ptr, entry-&gt;linkId, 8); *ptr ^= 2; } else if (entry-&gt;linkType == DHCPV6_DUID_HARDWARE_EUI64_TYPE)// &lt;= { *ptr++ = entry-&gt;linkId[0] ^ 2; *ptr++ = entry-&gt;linkId[1]; .... } }</span></span></code> </pre> <br>  Ici, <i>if</i> et <i>else if</i> v√©rifient la m√™me condition, √† la suite de quoi le code dans le corps <i>else if</i> n'est jamais ex√©cut√©.  Ces erreurs se produisent souvent lors de l'√©criture de code √† l'aide de la m√©thode <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">copier-coller</a> . <br><br><h2>  Expression sans propri√©taire </h2><br>  Jetons un coup d'≈ìil √† un morceau de code amusant. <br><br>  Avertissement de l'analyseur: expression sans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">propri√©taire</a> V607 '&amp; Discover_response_tlv'.  thread_discovery.c 562 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">thread_discovery_response_send</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">thread_discovery_class_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *class, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">thread_discovery_response_msg_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *msg_buffers)</span></span></span><span class="hljs-function"> </span></span>{ .... thread_extension_discover_response_tlv_write( &amp;discover_response_tlv, class-&gt;version, linkConfiguration-&gt;securityPolicy); .... }</code> </pre> <br>  <i>Jetons</i> maintenant un ≈ìil √† la <i>d√©claration de</i> macro <i>thread_extension_discover_response_tlv_write</i> : <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> thread_extension_discover_response_tlv_write \ ( data, version, extension_bit)\ (data)</span></span></code> </pre> <br>  La macro est d√©velopp√©e dans l'argument de donn√©es, c'est-√†-dire son appel √† l'int√©rieur de la fonction <i>thread_discovery_response_send</i> apr√®s que le pr√©traitement se transforme en expression <i>(&amp; discovery_response_tlv)</i> . <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/721/781/148/721781148d58d4fcfe8a8882c16bf2c5.png" alt="Attends quoi"></div><br><br>  Je n'ai aucun commentaire.  Ce n'est probablement pas une erreur, mais un tel code me met toujours dans un √©tat similaire √† l'image de l'image :). <br><br><h2>  Conclusion </h2><br>  La liste des compilateurs pris en charge dans PVS-Studio a √©t√© √©tendue.  Si vous avez un projet destin√© √† √™tre assembl√© √† l'aide de la cha√Æne d'outils int√©gr√©e GNU Arm, je sugg√®re d'essayer de le tester √† l'aide de notre analyseur.  T√©l√©chargez la d√©mo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> .  Faites √©galement attention √† l'option de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">licence gratuite</a> , qui convient √† certains petits projets. <br><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/ts/z9/km/tsz9kmyjtteajhd4x1au60rsrvq.png" align="left"></a> </p><br><br>  Si vous souhaitez partager cet article avec un public anglophone, veuillez utiliser le lien vers la traduction: Yuri Minaev.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PVS-Studio prend d√©sormais en charge la cha√Æne d'outils int√©gr√©e GNU Arm</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr427447/">https://habr.com/ru/post/fr427447/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr427435/index.html">STM32H7 - r√©glage de l'horloge sans HAL</a></li>
<li><a href="../fr427437/index.html">Configuration des serveurs li√©s: serveur sql ms et teradata</a></li>
<li><a href="../fr427439/index.html">Toute la v√©rit√© sur RTOS. Article # 16. Signaux</a></li>
<li><a href="../fr427441/index.html">Convergence avec Kubernetes</a></li>
<li><a href="../fr427443/index.html">Vivisection du succ√®s</a></li>
<li><a href="../fr427449/index.html">Comment comprendre Tensorflow et ne pas mourir, et m√™me enseigner quelque chose sur une voiture</a></li>
<li><a href="../fr427451/index.html">Connectez les t√¢ches phpStorm √† Bitrix24</a></li>
<li><a href="../fr427453/index.html">Comment j'ai fait la transmission du son sur le Raspberry Pi</a></li>
<li><a href="../fr427457/index.html">La troisi√®me vague d'IA et de syst√®mes pour la s√©curit√© de l'√âtat</a></li>
<li><a href="../fr427459/index.html">Lampes LED Diall du magasin Castorama</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>