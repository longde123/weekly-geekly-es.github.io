<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëáüèª üë®üèΩ‚Äçüé§ üßìüèΩ Varonis a d√©couvert un virus d'extraction de crypto: notre enqu√™te ü•á üìª üßõüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Notre unit√© d'enqu√™te de s√©curit√© a r√©cemment men√© une enqu√™te sur un r√©seau de virus d'extraction de crypto-monnaies presque enti√®rement dans l'une d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Varonis a d√©couvert un virus d'extraction de crypto: notre enqu√™te</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/varonis/blog/466817/"><img src="https://habrastorage.org/webt/b3/fo/_5/b3fo_5ib64rlap_izdap4paolls.jpeg"><br><br>  Notre unit√© d'enqu√™te de s√©curit√© a r√©cemment men√© une enqu√™te sur un r√©seau de virus d'extraction de crypto-monnaies presque enti√®rement dans l'une des moyennes entreprises.  Analyse <br>  des √©chantillons de logiciels malveillants collect√©s ont montr√© qu'une nouvelle modification avait √©t√© trouv√©e <br>  ces virus, appel√©s <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Norman</a> , utilisent diverses m√©thodes pour masquer leur pr√©sence.  De plus, un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">shell Web interactif a</a> √©t√© d√©couvert, qui pourrait √™tre li√© aux op√©rateurs miniers. <br><a name="habracut"></a><br><h2>  <font color="#D21927">Aper√ßu de l'√©tude</font> </h2><br><ul><li>  Varonis a d√©tect√© une infection √† grande √©chelle avec des cryptom√®res: presque tous les serveurs et postes de travail de l'entreprise ont √©t√© infect√©s par un tel logiciel </li><li>  Depuis l'infection initiale qui s'est produite il y a plus d'un an, le nombre de modifications et d'appareils infect√©s n'a cess√© d'augmenter </li><li>  Le nouveau type de mineur cryptographique Monero (Norman) que nous avons d√©couvert utilise diverses m√©thodes pour le cacher de l'analyse par un logiciel de s√©curit√© afin d'√©viter la d√©tection </li><li>  La plupart des variantes de logiciels malveillants ont utilis√© DuckDNS (un service DNS dynamique gratuit) pour se connecter au centre de contr√¥le (serveurs C&amp;C), ainsi que pour obtenir des param√®tres de configuration ou envoyer de nouvelles donn√©es. </li><li>  Norman - Mineur de crypto-monnaie Monero bas√© sur un mineur open source hautes performances - XMRig </li><li>  Nous n'avons pas de preuves concluantes de la connexion de crypto-mineurs avec un shell PHP interactif.  Cependant, il y a de bonnes raisons de croire que leur source est le m√™me attaquant.  Les chercheurs collectent des preuves suppl√©mentaires de la pr√©sence ou de l'absence d'une telle relation. </li><li>  Dans cet article, vous pouvez trouver des recommandations Varonis concernant la protection contre les coquilles Web distantes et les mineurs de crypto. </li></ul><br><h2>  <font color="#D21927">Enqu√™te</font> </h2><br>  L'enqu√™te a d√©but√© lors du prochain projet pilote de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Plateforme</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Varonis cybersecurity</a> (Varonis Data Security Platform), qui vous a permis d'identifier rapidement plusieurs √©v√©nements anormaux suspects au niveau du r√©seau lors de requ√™tes Internet (via des proxys web) associ√©s √† des actions anormales sur le syst√®me de fichiers. <br>  Le Client a imm√©diatement indiqu√© que les appareils identifi√©s par notre Plateforme, <br>  appartenaient aux m√™mes utilisateurs qui ont r√©cemment signal√© des plantages d'applications et des ralentissements de r√©seau. <br><br>  Notre √©quipe a examin√© manuellement l'environnement du client, passant d'une station infect√©e √† une autre conform√©ment aux alertes g√©n√©r√©es par la plateforme Varonis.  L'√©quipe de r√©ponse aux incidents a √©galement d√©velopp√© une r√®gle sp√©ciale dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le module DatAlert</a> pour d√©tecter les ordinateurs qui exploitaient activement, ce qui a aid√© √† √©liminer rapidement la menace.  Des √©chantillons des logiciels malveillants collect√©s ont √©t√© envoy√©s aux √©quipes des services de criminalistique et de d√©veloppement, qui ont d√©clar√© qu'il √©tait n√©cessaire d'effectuer des recherches suppl√©mentaires sur les √©chantillons. <br>  Les sites infect√©s ont √©t√© d√©couverts gr√¢ce √† leur utilisation des <b>appels DuckDNS</b> , Dynamic DNS, qui permet √† ses utilisateurs de cr√©er leurs propres noms de domaine et de les mapper rapidement √† des adresses IP changeantes.  Comme mentionn√© ci-dessus, la plupart des logiciels malveillants de l'incident se sont tourn√©s vers DuckDNS pour se connecter au centre de contr√¥le (C&amp;C), l'autre pour obtenir les param√®tres de configuration ou envoyer de nouvelles donn√©es. <br><br>  Presque tous les serveurs et ordinateurs √©taient infect√©s par des logiciels malveillants.  Principalement appliqu√© <br>  options communes de mineur de crypto.  D'autres logiciels malveillants comprenaient des outils de vidage de mot de passe, des shells PHP et un certain nombre d'outils fonctionnaient depuis plusieurs ann√©es. <br><br>  Nous avons fourni les r√©sultats au client, supprim√© les logiciels malveillants de leur environnement et stopp√© toute infection. <br><br>  Parmi tous les √©chantillons d√©couverts de cryptom√®res, un se d√©marquait.  Nous l'avons appel√© <strong>Norman</strong> . <br><br><h2>  <font color="#D21927">Rencontrez-moi!</font>  <font color="#D21927">Norman</font>  <font color="#D21927">Cryptominer</font> </h2><br>  Norman est un mineur de crypto-monnaie Monero haute performance bas√© sur le code XMRig.  Contrairement aux autres √©chantillons de mineurs trouv√©s, Norman utilise des m√©thodes pour le cacher de l'analyse avec un logiciel de s√©curit√© pour √©viter la d√©tection et emp√™cher une distribution ult√©rieure. <br><br>  √Ä premi√®re vue, ce malware est un mineur r√©gulier se cachant sous le nom svchost.exe.  Cependant, l'√©tude a montr√© qu'elle utilise des m√©thodes plus int√©ressantes pour se cacher de la d√©tection et de la maintenance du travail. <br><br>  Le processus de d√©ploiement de ce malware peut √™tre divis√© en trois √©tapes: <br><br><ul><li>  accomplissement; </li><li>  mise en ≈ìuvre; </li><li>  l'exploitation mini√®re. </li></ul><br><h2>  <font color="#D21927">Analyse pas √† pas</font> </h2><br><h3>  √âtape 1. Ex√©cution </h3><br>  La premi√®re √©tape commence par le fichier ex√©cutable svchost.exe. <br><br>  Un logiciel malveillant se compile avec NSIS (Nullsoft Scriptable Install System), ce qui est inhabituel.  NSIS est un syst√®me open source utilis√© pour cr√©er des programmes d'installation Windows.  Comme SFX, ce syst√®me cr√©e une archive de fichiers et un fichier de script qui sont ex√©cut√©s pendant le programme d'installation.  Le fichier de script indique au programme les fichiers √† ex√©cuter et peut interagir avec d'autres fichiers de l'archive. <br><br>  <i><strong>Remarque:</strong> Pour obtenir le fichier de script NSIS √† partir du fichier ex√©cutable, vous devez utiliser 7zip version 9.38, car cette fonction n'est pas impl√©ment√©e dans les versions ult√©rieures.</i> <br><br>  Les logiciels malveillants archiv√©s NSIS contiennent les fichiers suivants: <br><br><ul><li>  CallAnsiPlugin.dll, CLR.dll - modules NSIS pour appeler les fonctions DLL .NET; </li><li>  5zmjbxUIOVQ58qPR.dll - la DLL de charge utile principale; </li><li>  4jy4sobf.acz, es1qdxg2.5pk, OIM1iVhZ.txt - fichiers de charge utile; </li><li>  Retreat.mp3, Cropped_controller_config_controller_i_lb.png sont simplement des fichiers qui ne sont en aucun cas associ√©s √† d'autres activit√©s malveillantes. </li></ul><br>  La commande du fichier de script NSIS qui ex√©cute la charge utile est donn√©e ci-dessous. <br><br><img src="https://habrastorage.org/webt/dc/ch/st/dcchst5kvffhufreb1smhmw3lzs.png"><br><br>  Un logiciel malveillant est ex√©cut√© en appelant la fonction 5zmjbxUIOVQ58qPR.dll, qui prend d'autres fichiers comme param√®tres. <br><br><h3>  √âtape 2. Mise en ≈ìuvre </h3><br>  Le fichier 5zmjbxUIOVQ58qPR.dll est la charge utile principale, qui d√©coule du script NSIS ci-dessus.  Une analyse rapide des m√©tadonn√©es a montr√© que la DLL s'appelait √† l'origine Norman.dll, c'est pourquoi nous l'avons appel√©e ainsi. <br><br>  Fichier DLL d√©velopp√© sur .NET et prot√©g√© contre l'ing√©nierie inverse par triple obfuscation <br>  en utilisant le produit commercial bien connu Agile .NET Obfuscator. <br><br>  Au cours de l'ex√©cution, de nombreuses op√©rations de mise en ≈ìuvre d'auto-introduction sont impliqu√©es dans son propre processus, ainsi que dans d'autres processus.  Selon la profondeur de bits du syst√®me d'exploitation, le malware <br>  choisissez diff√©rents chemins d'acc√®s aux dossiers syst√®me et d√©marrez diff√©rents processus. <br><br><img src="https://habrastorage.org/webt/jp/sy/zn/jpsyzngdt-zv5qoswztui4odjrs.png"><br><br>  En fonction du chemin d'acc√®s au dossier syst√®me, le logiciel malveillant s√©lectionne diff√©rents processus √† d√©marrer. <br><br><img src="https://habrastorage.org/webt/wp/q9/jc/wpq9jcqxrvwvbfkgh9-wca2qmsi.png"><br><br>  La charge utile d√©ploy√©e a deux fonctions principales: ex√©cuter un crypto-mineur et emp√™cher la d√©tection. <br><br><h4>  Si le syst√®me d'exploitation est 64 bits </h4><br>  Lors de l'ex√©cution du fichier source svchosts.exe (fichier NSIS), il cr√©e son propre processus et lui injecte la charge utile (1).  Peu de temps apr√®s, il lance notepad.exe ou explorer.exe, et y injecte un cryptominer (2). <br><br><img src="https://habrastorage.org/webt/3n/rc/bt/3nrcbtfzkotbmjp_zqdvrzt9r_0.jpeg"><br><br>  Apr√®s cela, le fichier svchost.exe d'origine s'arr√™te et le nouveau fichier svchost.exe est utilis√© comme un programme qui surveille le fonctionnement du processus mineur. <br><br><img src="https://habrastorage.org/webt/ng/ze/bq/ngzebqxper1bhxzwrqxvygimlac.png"><br><br><h4>  Si le syst√®me d'exploitation est 32 bits </h4><br>  Lors de l'ex√©cution du fichier svchosts.exe d'origine (fichier NSIS), il duplique son propre processus et y injecte une charge utile, comme dans la version 64 bits. <br><br>  Dans ce cas, le malware injecte la charge utile dans le processus utilisateur explorer.exe.  D√©j√† √† partir de celui-ci, un code malveillant d√©marre un nouveau processus (wuapp.exe ou vchost.exe), et y injecte le mineur. <br><br><img src="https://habrastorage.org/webt/kb/c3/2q/kbc32qdqrmcwqzciy5vhesry224.png"><br><br>  Un logiciel malveillant cache le fait de l'impl√©mentation dans explorer.exe, √©crasant le code pr√©c√©demment impl√©ment√© par wuapp.exe et les valeurs vides. <br><br><img src="https://habrastorage.org/webt/dz/uz/ct/dzuzct_donm4jroc54uj4bqzy2i.png"><br><br>  Comme dans le cas d'une ex√©cution dans un environnement 64 bits, le processus svchost.exe d'origine se termine et le second est utilis√© pour r√©injecter du code malveillant dans explorer.exe si le processus est interrompu par l'utilisateur. <br><br>  √Ä la fin de l'algorithme d'ex√©cution, les logiciels malveillants injectent toujours le cryptominer dans son processus l√©gitime. <br><br>  Il est con√ßu pour emp√™cher la d√©tection en arr√™tant le mineur lorsque l'utilisateur lance le Gestionnaire des t√¢ches. <br><br>  Veuillez noter qu'apr√®s le d√©marrage du Gestionnaire des t√¢ches, le processus wuapp.exe se termine. <br><br><img src="https://habrastorage.org/webt/nm/dw/y0/nmdwy02bz2qho6dgotsq_wprv6a.gif"><br><br>  Apr√®s avoir ferm√© le gestionnaire de t√¢ches, le logiciel malveillant d√©marre encore et encore le processus wuapp.exe <br>  y introduit un mineur. <br><br><h3>  √âtape 3. Mineur </h3><br>  Consid√©rez le mineur XMRig mentionn√© ci-dessus. <br><br>  Un logiciel malveillant injecte la version UPX d√©guis√©e du mineur dans le bloc-notes, exe, explorer.exe, <br>  svchost.exe ou wuapp.exe, selon la profondeur de bits du syst√®me d'exploitation et le stade de l'algorithme d'ex√©cution. <br><br>  L'en-t√™te PE dans le mineur a √©t√© supprim√©, et dans la capture d'√©cran ci-dessous, nous pouvons voir qu'il est masqu√© √† l'aide de UPX. <br><br><img src="https://habrastorage.org/webt/u0/es/8g/u0es8g-pm5lpx7bov_hwarxv-ws.png"><br><br>  Apr√®s avoir cr√©√© un vidage et reconstruit l'ex√©cutable, nous avons r√©ussi √† l'ex√©cuter: <br><br><img src="https://habrastorage.org/webt/il/nl/c-/ilnlc-lauzxcgsjrkg0pggo1wik.png"><br><br>  Il est √† noter que l'acc√®s au site XMR cible est interdit, ce qui neutralise efficacement ce mineur. <br><br>  <strong>Configuration du mineur:</strong> <br><br><pre><code class="plaintext hljs">"url": "pool.minexmr.com:5555","user": "49WvfokdnuK6ojQePe6x2M3UCD59v3BQiBszkuTGE7wmNJuyAvHM9ojedgxMwNx9tZA33P84EeMLte7t6qZhxNHqHyfq9xA","pass":"x"</code> </pre> <br><h2>  <font color="#D21927">Myst√©rieux shell PHP transf√©rant des donn√©es vers C&amp;C</font> </h2><br>  Au cours de cette enqu√™te, nos experts judiciaires ont d√©couvert un fichier XSL qui a retenu leur attention.  Apr√®s une analyse approfondie de l'√©chantillon, un nouveau shell PHP a √©t√© d√©couvert qui est constamment connect√© au centre de contr√¥le (serveur C&amp;C). <br><br>  Sur plusieurs serveurs de l'environnement du client, un fichier XSL a √©t√© trouv√© et lanc√© par l'ex√©cutable Windows bien connu (mscorsv.exe) √† partir d'un dossier du r√©pertoire sysWOW64. <br><br>  Le dossier du logiciel malveillant s'appelait AutoRecover et contenait <b>plusieurs fichiers:</b> <br><br><ul><li>  Fichier XSL: xml.XSL </li><li>  neuf fichiers dll </li></ul><br>  <b>Fichiers ex√©cutables:</b> <br><ul><li>  Msscorsv.exe </li><li>  Wmiprvse.exe </li></ul><br><img src="https://habrastorage.org/webt/dr/bc/nv/drbcnvij4atirz8jn_tncb6ndkc.png"><br><br><h2>  <font color="#D21927">Fichier XSL</font> </h2><br>  Les fichiers XSL sont des feuilles de style similaires aux tableaux utilis√©s en CSS qui d√©crivent comment afficher un document XML. <br><br>  En utilisant le Bloc-notes, nous avons constat√© qu'il ne s'agissait en fait pas d'un fichier XSL, mais du code PHP Zend Guard obscurci.  Ce fait curieux sugg√®re que cette <br>  charge utile de malware bas√©e sur son algorithme d'ex√©cution. <br><br><img src="https://habrastorage.org/webt/b9/gx/z5/b9gxz56io5zcmlgbtephvyuxyn8.png"><br><br><h2>  <font color="#D21927">Neuf DLL</font> </h2><br>  Une premi√®re analyse du fichier XSL nous a amen√©s √† conclure qu'avoir autant de <br>  Les DLL ont un certain sens.  Le dossier principal contient une DLL appel√©e php.dll et trois autres biblioth√®ques li√©es √† SSL et MySQL.  Dans les sous-dossiers, les experts ont trouv√© quatre biblioth√®ques PHP et une biblioth√®que Zend Guard.  Tous sont l√©gitimes et sont obtenus √† partir du package d'installation PHP ou sous forme de DLL externes. <br><br>  √Ä ce stade, l'hypoth√®se a √©t√© faite que le malware √©tait bas√© sur PHP et obscurci par Zend Guard. <br><br><h2>  <font color="#D21927">Ex√©cutables</font> </h2><br>  Dans ce dossier se trouvaient √©galement deux fichiers ex√©cutables: Mscorsv.exe et Wmiprvse.exe. <br><br>  Apr√®s avoir analys√© le fichier mscorsv.exe, nous avons constat√© qu'il n'√©tait pas sign√© par Microsoft, bien que son param√®tre ProductName ait √©t√© d√©fini sur ¬´Microsoft.  Net Framework. " <br>  Au d√©but, cela semblait √©trange, mais l'analyse de Wmiprvse.exe a permis de mieux comprendre la situation. <br><br>  Le fichier Wmiprvse.exe n'√©tait pas non plus sign√©, mais contenait le symbole de copyright du groupe PHP et l'ic√¥ne PHP.  Lors d'une analyse rapide, des commandes de l'aide PHP ont √©t√© trouv√©es dans ses lignes.  Lors de son ex√©cution avec le commutateur -version, il a √©t√© d√©couvert qu'il s'agit d'un fichier ex√©cutable con√ßu pour ex√©cuter Zend Guard. <br><br><img src="https://habrastorage.org/webt/9c/xw/ju/9cxwjuu7xoqggrzco-tgun7kpsw.png"><br><br>  Lorsque mscorsv.exe a √©t√© lanc√© de la m√™me mani√®re, les m√™mes donn√©es ont √©t√© affich√©es.  Nous avons compar√© les donn√©es binaires de ces deux fichiers et constat√© qu'elles sont identiques, √† l'exception des m√©tadonn√©es <br>  Copyright et nom de l'entreprise / nom du produit. <br><br><img src="https://habrastorage.org/webt/mp/7y/qk/mp7yqkfz6uqusknzixm5vrwun9e.png"><br><br>  Sur cette base, il a √©t√© conclu que le fichier XSL contient du code PHP qui s'ex√©cute √† l'aide de l'ex√©cutable Zend Guard, cach√© sous le nom mscorsv.exe. <br><br><h2>  <font color="#D21927">Analyse d'un fichier XSL</font> </h2><br>  En utilisant la recherche sur Internet, les experts ont rapidement re√ßu un outil pour d√©sobfusquer Zend Guard et ont restaur√© le fichier xml.XSL d'origine: <br><br><img src="https://habrastorage.org/webt/5a/ek/nj/5aeknjt7mwgxx96m3t5twger2h0.png"><br><br>  Il s'est av√©r√© que le malware lui-m√™me est un shell PHP qui est constamment connect√© au centre de contr√¥le (serveur C&amp;C). <br><br>  Les commandes et les sorties qu'il envoie et re√ßoit sont crypt√©es.  Depuis que nous avons re√ßu le code source, nous avions √† la fois une cl√© de chiffrement et des commandes. <br><br>  Ce malware contient les fonctionnalit√©s int√©gr√©es suivantes: <br><br><ul><li>  Eval - couramment utilis√© pour modifier les variables existantes dans le code </li><li>  Enregistrement de fichier local </li><li>  Fonctionnalit√©s de la base de donn√©es </li><li>  Caract√©ristiques PSEXEC </li><li>  Ex√©cution cach√©e </li><li>  Cartographie des processus et des services </li></ul><br>  La variable suivante sugg√®re que les logiciels malveillants ont plusieurs versions. <br><br><img src="https://habrastorage.org/webt/al/id/bs/alidbstswyy1huff1onuh5ma7bg.png"><br><br>  Lors de la collecte d'√©chantillons, les versions suivantes ont √©t√© d√©couvertes: <br><br><ul><li>  0,5f </li><li>  0.4p </li><li>  0.4o </li></ul><br>  La seule fonction d'assurer la pr√©sence constante de logiciels malveillants dans le syst√®me est que lorsqu'il est ex√©cut√©, il cr√©e un service qui s'ex√©cute lui-m√™me et son nom <br>  varie d'une version √† l'autre. <br><br>  Des sp√©cialistes ont tent√© de trouver des √©chantillons similaires sur Internet et ont trouv√© des logiciels malveillants, <br>  qui, √† leur avis, √©tait la version pr√©c√©dente de l'√©chantillon existant.  Le contenu du dossier √©tait similaire, mais le fichier XSL √©tait diff√©rent et un num√©ro de version diff√©rent y √©tait sp√©cifi√©. <br><br><h2>  <font color="#D21927">Parle Wu Malvare?</font> </h2><br>  Peut-√™tre que le pays d'origine de ce malware est la France ou un autre pays francophone: le fichier SFX contenait des commentaires en fran√ßais qui indiquent que l'auteur a utilis√© la version fran√ßaise de WinRAR pour le cr√©er. <br><br><img src="https://habrastorage.org/webt/xq/e2/cd/xqe2cddtfruhzwvz3mro0iqglpm.png"><br><br>  De plus, certaines variables et fonctions du code ont √©galement √©t√© nomm√©es en fran√ßais. <br><br><img src="https://habrastorage.org/webt/vx/95/9d/vx959dqslson6ybxzoawqzzyvog.png"><br><br><img src="https://habrastorage.org/webt/sk/cv/rd/skcvrd_tj6ntrgghhjzl1fhpjy8.png"><br><br><h2>  <font color="#D21927">Suivi de l'ex√©cution et attente de nouvelles √©quipes</font> </h2><br>  Les sp√©cialistes ont modifi√© le code du logiciel malveillant et lanc√© en toute s√©curit√© le code d√©j√† modifi√© <br>  version pour recueillir des informations sur les √©quipes qu'il a re√ßues. <br><br><img src="https://habrastorage.org/webt/xv/tf/uf/xvtfufticasuciea8sfzqyrpppc.png"><br><br>  √Ä la fin de la premi√®re session de communication, les sp√©cialistes ont vu que le malware avait re√ßu une commande encod√©e en Base64 comme argument pour la cl√© de d√©marrage EVAL64. <br>  Cette commande est d√©cod√©e et ex√©cut√©e.  Il modifie plusieurs variables internes (la taille des tampons de lecture et d'√©criture), apr√®s quoi le malware entre dans le cycle de travail d'attente des commandes. <br><br>  Aucune nouvelle √©quipe n'a √©t√© re√ßue pour le moment. <br><br><h2>  <font color="#D21927">Shell PHP interactif et crypto mineur: sont-ils li√©s?</font> </h2><br>  Les experts de Varonis ne savent pas si Norman est associ√© au shell PHP, car il existe des arguments importants pour et contre cette hypoth√®se: <br><br><h3>  Pourquoi peuvent-ils √™tre li√©s </h3><br><ul><li>  Aucun des √©chantillons de logiciels malveillants de crypto mining n'avait la capacit√© de se distribuer de mani√®re ind√©pendante √† d'autres syst√®mes, bien qu'ils aient √©t√© trouv√©s sur divers appareils dans diff√©rents segments de r√©seau.  Il est possible que l'attaquant ait infect√© chaque n≈ìud s√©par√©ment (en utilisant √©ventuellement le m√™me vecteur d'attaque que lors de l'infection du ¬´z√©ro patient¬ª), bien qu'il serait plus efficace d'utiliser un shell PHP pour se propager sur le r√©seau qui √©tait la cible de l'attaque. </li><li>  Les campagnes automatis√©es cibl√©es √† grande √©chelle dirig√©es contre une organisation sp√©cifique laissent souvent des artefacts techniques ou des traces reconnaissables de menaces de cybers√©curit√© dans leur mise en ≈ìuvre.  Dans ce cas, rien de tel n'a √©t√© trouv√©. </li><li>  Norman et le shell PHP ont utilis√© le service DuckDNS. </li></ul><br><h3>  Pourquoi ils peuvent ne pas √™tre li√©s </h3><br><ul><li>  Il n'y a pas de similitudes techniques entre les options de logiciels malveillants de minage cryptographique et le shell PHP.  Le cryptominer malveillant a √©t√© cr√©√© en C ++ et le shell en PHP.  De plus, il n'y a aucune similitude dans la structure du code et les fonctions r√©seau sont impl√©ment√©es diff√©remment. </li><li>  Il n'y a pas d'interaction directe entre les options de malware et le shell PHP pour l'√©change de donn√©es. </li><li>  Ils ne contiennent pas de commentaires, de fichiers, de m√©tadonn√©es ou d'empreintes digitales g√©n√©raux des d√©veloppeurs. </li></ul><br><h3>  Trois recommandations pour la protection contre les obus retir√©s </h3><br>  Les logiciels malveillants, qui n√©cessitent des commandes du centre de contr√¥le (serveurs C&amp;C), ne ressemblent pas √† des virus ordinaires.  Ses actions ne sont pas si pr√©visibles et ressembleront plut√¥t aux actions d'un pirate ou d'un pentester effectu√©es sans outils ou scripts automatis√©s.  Par cons√©quent, la d√©tection de ces attaques sans signatures de logiciels malveillants est une t√¢che plus complexe que les analyses antivirus conventionnelles. <br><br>  <strong>Voici trois recommandations pour prot√©ger les entreprises contre les obus distants:</strong> <br><ol><li>  <b>Gardez tous les logiciels √† jour</b> <br>  Les attaquants exploitent souvent les vuln√©rabilit√©s des logiciels et des syst√®mes d'exploitation pour se propager sur le r√©seau de l'organisation et rechercher des donn√©es d'int√©r√™t afin de <br>  vol.  L'installation en temps opportun de correctifs r√©duit consid√©rablement le risque de telles menaces. </li><li>  <b>Suivre les √©v√©nements d'acc√®s aux donn√©es anormaux</b> <br>  Tr√®s probablement, les attaquants tenteront d'afficher les donn√©es confidentielles de l'organisation autour du p√©rim√®tre.  Le suivi des √©v√©nements anormaux d'acc√®s √† ces donn√©es permettra <br>  d√©tecter les utilisateurs compromis et l'ensemble des dossiers et fichiers qui pourraient r√©ellement tomber entre les mains des attaquants, et ne pas simplement consid√©rer toutes les donn√©es disponibles pour ces utilisateurs comme telles. </li><li>  <b>Suivre le trafic r√©seau</b> <br>  Gr√¢ce √† l'utilisation d'un pare-feu et / ou d'un serveur proxy, il est possible de d√©tecter et de bloquer les connexions malveillantes aux centres de contr√¥le des malwares (serveurs C&amp;C), ce qui emp√™chera les attaquants d'ex√©cuter des commandes et compliquera la t√¢che de sortie <br>  donn√©es p√©rim√©triques. </li></ol><br>  <strong>Pr√©occup√© par la question de l'exploitation mini√®re grise?</strong>  <strong>Six recommandations de protection:</strong> <br><br><ol><li>  <b>Gardez tous les syst√®mes d'exploitation √† jour.</b> <br>  La gestion des correctifs est tr√®s importante pour √©viter une mauvaise utilisation des ressources et une infection par un logiciel malveillant. </li><li>  <b>Surveillez le trafic r√©seau et les proxys Web</b> <br>  Faites-le pour d√©tecter certaines attaques et pour en √©viter une partie, vous pouvez bloquer le trafic en fonction des informations sur les domaines malveillants ou limiter les canaux de transmission de donn√©es inutiles. </li><li>  <b>Utilisez et entretenez des solutions antivirus et des syst√®mes de s√©curit√© des terminaux</b> (mais ne vous limitez en aucun cas √† n'utiliser que cette couche de protection). <br>  Les produits sur les appareils finaux permettent la d√©tection de cryptomineurs bien connus et la pr√©vention des infections avant que les performances des syst√®mes et l'utilisation de l'√©lectricit√© ne soient compromises.  Il convient de garder √† l'esprit que de nouvelles modifications ou de nouvelles m√©thodes de pr√©vention de la d√©tection peuvent emp√™cher les fonctionnalit√©s de s√©curit√© des appareils finaux de d√©tecter de nouvelles versions du m√™me malware. </li><li>  <b>Surveiller l'activit√© du processeur de l'ordinateur</b> <br>  En r√®gle g√©n√©rale, les mineurs cryptographiques utilisent le processeur central de l'ordinateur pour l'extraction.  Il est n√©cessaire d'analyser tous les messages sur la d√©gradation des performances (¬´Mon ordinateur a commenc√© √† ralentir.¬ª). </li><li>  <b>Surveillez DNS pour une utilisation inhabituelle des services DNS dynamiques (comme DuckDNS)</b> \ <br><br>  Malgr√© le fait que DuckDNS et d'autres services DNS dynamiques eux-m√™mes ne soient pas nocifs pour le syst√®me, l'utilisation de logiciels malveillants DuckDNS a simplifi√© la d√©tection des n≈ìuds infect√©s pour les √©quipes de sp√©cialistes impliqu√©es dans l'enqu√™te. </li><li>  <b>√âlaborer un plan de r√©ponse aux incidents</b> <br>  Assurez-vous que vous disposez des proc√©dures n√©cessaires d√©crites pour de tels incidents qui d√©tectent, limitent et √©liminent automatiquement la menace de crypto-mining gris. </li></ol><br>  <strong>Remarque pour les clients Varonis.</strong> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Varonis DatAlert</a> inclut des mod√®les de menace qui d√©tectent les logiciels malveillants pour l'extraction de crypto.  Les clients peuvent √©galement cr√©er leurs propres r√®gles pour la d√©couverte cibl√©e de logiciels bas√©s sur des domaines candidats √† la mise sur liste noire.  Pour vous assurer que vous utilisez la derni√®re version de DatAlert et appliquez les mod√®les de menace appropri√©s, contactez votre repr√©sentant commercial ou le support Varonis. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr466817/">https://habr.com/ru/post/fr466817/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr466807/index.html">Python, d√©vorant le monde: en tant que projet parall√®le d'un d√©veloppeur, il est devenu un langage de programmation populaire</a></li>
<li><a href="../fr466809/index.html">Le cercle est ferm√©. Comment les mitaps m'ont aid√© √† trouver un emploi de r√™ve</a></li>
<li><a href="../fr466811/index.html">Historique et alternatives √† la plateforme .NET</a></li>
<li><a href="../fr466813/index.html">Posit-arithm√©tique: vaincre un point flottant dans son propre champ. 2e partie</a></li>
<li><a href="../fr466815/index.html">Pr√©sentation technique de NEC HYDRAstor HS8 et plus</a></li>
<li><a href="../fr466819/index.html">Mise en place d'offres promotionnelles sur iOS. Comment gagner plus sur les abonnements?</a></li>
<li><a href="../fr466821/index.html">Installez 3CX √† partir d'Amazon AWS Marketplace</a></li>
<li><a href="../fr466823/index.html">Comment nous configurons les migrations pour les processus m√©tier dans Bitrix24</a></li>
<li><a href="../fr466829/index.html">Quelques touches pour travailler avec des identifiants bigint dans R</a></li>
<li><a href="../fr466831/index.html">D√©veloppement d'un syst√®me d'exploitation monolithique de type Unix - Heap (4)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>