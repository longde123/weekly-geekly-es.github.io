<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÉ üßëüèΩ‚Äçü§ù‚Äçüßëüèº üö£üèø Heimautomatisierung mit Unterst√ºtzung f√ºr industrielle Programmiersprachen oder BluePill x405 üôÖüèΩ üöü ‚¨õÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Beginn der √úberpr√ºfung 
 Meine lieben Kollegen, wir beginnen den R√ºckblick mit dem, was wir hier wirklich hervorheben m√∂chten. In diesem Artikel m√∂cht...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Heimautomatisierung mit Unterst√ºtzung f√ºr industrielle Programmiersprachen oder BluePill x405</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/477478/"><h3>  Beginn der √úberpr√ºfung </h3><br>  Meine lieben Kollegen, wir beginnen den R√ºckblick mit dem, was wir hier wirklich hervorheben m√∂chten.  In diesem Artikel m√∂chte ich die f√ºr die Erstellung eines industriellen Steuerungsprogramms typischen Elemente betrachten und zeigen, wie sie auf Hausautomationssysteme angewendet werden k√∂nnen.  Und das Wichtigste ist, die Antwort auf die Frage zu finden - was wird daf√ºr ben√∂tigt? <br><br><h3>  Home Automation - Anwendungen </h3><br>  Home sweet home ... Brauchen Sie wirklich einen Controller?  Die Antwort ist einfach - es h√§ngt alles davon ab, was in einem solchen Haus verf√ºgbar ist.  Wenn Sie nur eine Wohnung haben und die Automatisierung in der Verwaltung Ihres Home Media Centers und der Klimaanlage im Sommer besteht, kann nat√ºrlich alles, was im Folgenden beschrieben wird, v√∂llig uninteressant sein.  Aber wenn Ihr Hobby nicht nur die Couch schiebt (was sich da verstecken soll, habe ich selbst schon mal gemerkt), dann kann der Artikel sehr n√ºtzlich sein. <br><a name="habracut"></a><br>  Versuchen wir also zu verstehen, wie improvisierte Mittel unser schwieriges Leben vereinfachen k√∂nnen.  Als Beispiel verwenden wir die reale Situation - eine Pumpe in einem Brunnen mit einer Tiefe von 70 Metern, die zwei Nachbarn zusammengelegt haben.  Sie haben es im Fr√ºhjahr installiert, als es viel Wasser im Brunnen gab, und im Allgemeinen war es einfach warm und gut.  Aber die Zeit vergeht und Fragen beginnen - um Wasser aus einer solchen Tiefe zu heben, braucht man Elektrizit√§t, f√ºr die man bezahlen muss.  Der Keller und der technische Boden wurden mehrmals √ºberflutet - sie haben nur vergessen, die Pumpe auszuschalten ... Ja, und es ist nicht sehr praktisch, sie manuell zu steuern - Sie m√ºssen einen Hahn schlie√üen, einen anderen √∂ffnen, dann die Pumpe einschalten und den Wasserstand im Tank √ºberpr√ºfen. <br><br>  Lohnt es sich, Ihre Zeit damit zu verbringen, was bereits fehlt?  Ein forschender Verstand beginnt nach L√∂sungen zu suchen und findet sie nat√ºrlich!  Eine Liste der Aufgaben f√ºr die Implementierung wird erstellt. <br><br><ol><li>  Die Bezahlung des verbrauchten Stroms muss nicht √ºblich sein - das hei√üt, wir werden zwei Starter installieren, von denen jeder an einen eigenen Stromz√§hler angeschlossen ist. </li><li>  Die Pumpe sollte nicht aufgrund von Wassermangel ausfallen. Das bedeutet, dass wir einen Sensor f√ºr den ‚Äûtrockenen‚Äú Hub der Pumpe installieren.  Wenn es kein Wasser gibt, starten Sie die Pumpe einfach nicht, und wenn es funktioniert, stoppen wir im Notfall. </li><li>  Die Pumpe darf nicht zu lange laufen, z. B. l√§nger als 25 Minuten.  Das √úberschreiten dieser Zeit zeigt an, dass das System seinen normalen Betriebsmodus verl√§sst. </li><li>  Das Bef√ºllen von Beh√§ltern sollte ohne menschliches Eingreifen, dh automatisch, erfolgen, dh von der unteren Ebene aus beginnen und von der oberen Ebene aus anhalten. </li><li>  Es sollte nur ein Tank gef√ºllt werden, dh wir installieren zwei Ventile, um Wasser f√ºr einen Satz in jedem Tank zu liefern. </li><li>  Die Pause zwischen den Pumpenstarts muss mindestens 30 Minuten betragen. </li><li>  Eine Stromunterbrechung sollte den Betriebsalgorithmus nicht beeinflussen, wenn er aktiv war.  Trotz allem muss der Algorithmus vervollst√§ndigt werden. </li></ol><br>  Die Aufgaben sind einfach und k√∂nnen auf hundert, wenn nicht tausend Arten gel√∂st werden.  Aber der Titel des Artikels spricht f√ºr sich und wir werden einen dornigen Weg gehen.  Verwenden wir zun√§chst einen virtuellen Controller, der dies alles erledigt. <br><br><h3>  Wie funktioniert eine Industriesteuerung? </h3><br>  Nat√ºrlich kl√§ren wir das gleich - wir sprechen von den sogenannten speicherprogrammierbaren Steuerungen, kurz SPS.  Was verbirgt sich unter dieser Abk√ºrzung?  Und hier ist das Verborgene - eine unglaubliche Vielfalt an Hardwarel√∂sungen, eine Vielzahl an Softwareprodukten und Dienstprogrammen.  Es stellt sich sofort die vern√ºnftige Frage, wie man das alles gut nutzt.  Ist es wirklich notwendig, den Materialteil von Grund auf zu studieren und Zeit und Geld f√ºr jedes neue Ger√§t zu finden, um an Schulungen teilzunehmen und die f√ºr die Arbeit mit jedem Ger√§t erforderlichen F√§higkeiten zu erwerben? <br><br>  Die Antwort ist nein, es ist nicht notwendig.  Alles wurde vor uns getan.  Es bleibt nur zu lernen und zu lernen, wie man es benutzt.  Dies ist, was ich weiter machen m√∂chte - ein kleines Eintauchen in die Norm IEC 61131. Lassen Sie uns offenlegen, welche Teile diese Norm enth√§lt. <br><br><ul><li>  IEC 61131-1: Allgemeine Informationen. </li><li>  IEC 61131-2: Ger√§teanforderungen und Pr√ºfung. </li><li>  IEC 61131-3: Programmiersprachen. </li><li>  IEC 61131-4: Benutzerhandbuch. </li><li>  IEC 61131-5: Kommunikation. </li><li>  IEC 61131-6: Funktionale Sicherheit. </li><li>  IEC 61131-7: Fuzzy-Steuerungsprogrammierung. </li><li>  IEC 61131-8: Richtlinien f√ºr die Verwendung und Implementierung von Programmiersprachen. </li><li>  IEC 61131-9: Digitale Einpunkt-Kommunikationsschnittstelle f√ºr kleine Sensoren und Aktoren. </li><li>  IEC 61131-10: Offenes XML-basiertes Austauschformat f√ºr SPS. </li></ul><br>  Wir werden uns jedoch nicht mit dem Thema Normung befassen. Einfach gesagt, die Steuerung arbeitet im Allgemeinen zyklisch: Sie fragt den Status der Eing√§nge ab, der Interpreter f√ºhrt das Steuerprogramm aus, setzt den Status der Ausg√§nge, f√ºhrt interne Wartungsaufgaben durch und kehrt erneut zum Abfragen des Status der Eing√§nge zur√ºck.  Es ist langweilig genug, aber effektiv und effizient.  Ein Steuerprogramm ist ein Pseudocode, der in einer Programmierumgebung erstellt wird, √ºblicherweise eine bin√§r codierte Sequenz, die mit den √ºblichen Programmiersprachen nichts zu tun hat.  Obwohl es f√ºr den Benutzer in einer verst√§ndlichen Form dargestellt wird, wird f√ºr die Steuerung eine v√∂llig andere Ansicht verwendet.  Ein gutes Beispiel ist ein kleines Programm, das in Form von IL, LD und in Form einer bin√§ren Codierung f√ºr den Controller dargestellt wird (hmm, es gibt nicht einmal einen speziellen Begriff).  Unten unter dem Spoiler ist ein kleines Beispiel abgebildet. <br><br><div class="spoiler">  <b class="spoiler_title">Programmanzeigeoptionen</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/1v/zd/el/1vzdelgzkvbgvb9jdf8kzb66un8.png"><br></div></div><br>  Was macht dieses Programm also n√ºtzlich?  Ja, sie tut nichts - wenn der Wert des Merkers M8010 1 ist, wird 1 an den Ausgang mit der Adresse Y377 geschrieben, entsprechend gilt dies auch f√ºr 0. <br>  Einer der gr√∂√üten Vorteile einer solchen Implementierung ist die M√∂glichkeit, das Programm aus dem Speicher des Controllers zu entladen, in einem f√ºr den Menschen verst√§ndlichen Editor zum Bearbeiten zu √∂ffnen, zu kompilieren (dieser Begriff ist hier bedingt) und wieder in den Speicher des Controllers zu laden.  Dar√ºber hinaus speichern einige Controller sogar Kommentare und Variablennamen. <br><br><h3>  Wie programmiere ich den Controller? </h3><br>  Nat√ºrlich wird spezielle Software ben√∂tigt.  Nach langwierigen Suchen und Experimenten wurde Autoshop v3.02 von Inovance Control ausgew√§hlt.  Es ist bemerkenswert, dass es kostenlos ist, zum kostenlosen Download zur Verf√ºgung steht und Controller unterst√ºtzt, die mit Mitsubishi-Controllern kompatibel sind.  Und es unterst√ºtzt die Arbeit nicht nur √ºber serielle Schnittstellen, sondern auch √ºber Ethernet.  Link zu der von uns verwendeten Version, unter dem Spoiler. <br><br><div class="spoiler">  <b class="spoiler_title">Link zum Herunterladen von Yandex Disk</b> <div class="spoiler_text">  <a href="https://yadi.sk/d/nXaAKljCPvqR5Q">Autoshop v3.02</a> <br></div></div><br>  Nun, wir haben das Programm installiert und nun noch eine Frage - wie schreibt man das Programm auf unseren Controller?  Da wir mit einem bestimmten Ger√§t arbeiten, installieren wir bestimmte Treiber f√ºr den virtuellen COM-Port.  Um Schlussfolgerungen zu speichern und zu vereinfachen, entschied ich mich, den USB-Anschluss der Karte f√ºr den Anschluss zu verwenden.  Fahrer unter dem Spoiler. <br><br><div class="spoiler">  <b class="spoiler_title">Treiber auf Yandex Disk</b> <div class="spoiler_text">  <a href="https://yadi.sk/d/n6kmoszV3TexWj">Fahrer</a> <br></div></div><br>  Nachdem Sie die Treiber installiert und die Karte √ºber Mini-USB angeschlossen haben, k√∂nnen Sie √ºberpr√ºfen, ob bei Ihnen alles erfolgreich ist.  Klicken Sie dazu mit der rechten Maustaste auf My Computer-Management-Device Manager-Ports (COM und LPT).  Sie sollten ein solches Fenster wie unter einem Spoiler sehen.  Die COM-Anschlussnummer Ihres Systems kann variieren. <br><br><div class="spoiler">  <b class="spoiler_title">Ger√§te-Manager</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/co/vs/o_/covso_rwe7duas9oaeg8hmqbqpi.png"><br></div></div><br>  Jetzt k√∂nnen Sie im AutoShop-Men√º die Option Tools-Communication Setting ausw√§hlen, im angezeigten Fenster die Option Serial ausw√§hlen, die Anschlussnummer angeben und auf die Schaltfl√§che Test klicken.  Sie sollten ein Fenster wie dieses unter einem Spoiler haben. <br><br><div class="spoiler">  <b class="spoiler_title">Erfolgreiche Verbindung zum Vorstand</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/xf/l9/xf/xfl9xfc7ey_ktixw-tj3mh8f6cy.png"><br></div></div><br>  Aber wenn etwas f√ºr Sie nicht funktioniert, schreiben Sie entweder in eine PN oder in einen Kommentar.  Wir werden auf jeden Fall helfen. <br><br><h3>  Elemente des Programms, ohne die es traurig sein wird </h3><br>  Im Folgenden wird die Sprache von Kontaktpl√§nen oder die sogenannte LD betrachtet.  Betrachten wir nur die Elemente, die wir sp√§ter verwenden werden. <br><br><ul><li>  Die Ein- und Ausg√§nge sind diskret.  Sie sind mit X und Y bezeichnet. Sie sind zum Empfangen und Ausgeben von diskreten Signalen vorgesehen. </li><li>  Der Speicherbereich von M merkers M. Er kann zwei Zust√§nde annehmen - Ein und Aus. </li><li>  Timer sind mit T bezeichnet. Entwickelt f√ºr Z√§hlzeiten von 0,1 bis 3276,7 Sekunden. </li><li>  Der Bereich der Register D. Er hat eine Zellendimension von 16 Bit, kann aber auch als 32-Bit-Zelle adressiert werden. </li></ul><br><h3>  Kugelf√∂rmiges Pferd in einem Vakuum oder indirekte Adressregister </h3><br>  Die indirekten Adressierungsregister sind mit V und Z bezeichnet und k√∂nnen von V0 bis V7 und von Z0 bis Z7 adressiert werden.  Warum k√∂nnen sie verwendet werden?  Schauen wir uns an, wie sie im Allgemeinen funktionieren.  Dieser verr√ºckte D1000V0-Datensatz bedeutet, dass die als D1000-Adresse berechnete Zellenadresse plus dem in das indirekte Adressierungsregister geschriebenen Wert verwendet wird.  Wenn es 15 gibt, verwenden wir die Adresse der Zelle D1015.  Dies ist sehr praktisch, wenn Sie mit Datenfeldern oder mit Tabellensteuerung arbeiten. Es reicht aus, den Wert des Indexregisters zu √§ndern, und wir erhalten die Werte aus den Speicherzellen, die adressiert wurden.  Wir werden sie zwar nicht anwenden, in der n√§chsten Ver√∂ffentlichung jedoch darauf eingehen. <br><br><h3>  Ein bisschen √ºber die Visualisierung des Programms oder das Online-Debuggen </h3><br>  Wenn Sie ein Programmierer sind und gerade mit dem Schreiben eines Programms fertig sind, ist der n√§chste Schritt das Debuggen.  Und hier stellt sich die Frage, wie es geht.  Auch hier gibt es viele Optionen, aber ich werde √ºber die sprechen, die wir weiter verwenden werden.  Mit dem Programmierumgebungseditor k√∂nnen Sie visuell anzeigen, welche Werte von Bits und Variablen sich derzeit im Steuerungsspeicher befinden, indem Sie eine Taste dr√ºcken.  Ein sehr aufschlussreiches Beispiel wird sein - unterhalb der Spoiler Offline- und Online-Anzeige des Programms im Editor. <br><br><div class="spoiler">  <b class="spoiler_title">Taste zum Umschalten in den variablen Ansichtsmodus</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/5-/nr/8z/5-nr8zfe8q1j1zcmwlmoxg5kfw0.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Typ des Programms im Modus zum Anzeigen der Werte von Variablen</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/-_/ox/gx/-_oxgxsuqn4x90y1d8yqgndcbjq.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Art des Programms im Bearbeitungsmodus</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/pl/f9/tj/plf9tjq0u2vx6tnufkrlao_klhu.png"><br></div></div><br>  Ein wenig mehr √ºber die Prozesse, die beim Klicken auf die Schaltfl√§che Online ablaufen.  Das Programm erstellt schnell eine Liste der sichtbaren Variablen und schreibt sie nach Abschluss in einen bestimmten Steuerungspuffer.  Danach bereitet die Steuerung Daten aus dieser Liste vor und legt sie in einem anderen Puffer ab.  Das Programm liest die Werte aus diesem Puffer und zeigt sie als Werte im Blindschaltbild an.  Wenn Sie ein kleines Programm im Anzeigefenster scrollen und die sichtbaren Variablen √§ndern, wird dieser Zyklus erneut wiederholt ... <br><br><h3>  Wer nennt Hamlet oder auf der B√ºhne BluePill x405 </h3><br>  Ist Ihnen aufgefallen, dass der Markt nicht auf einfache Motherboards wie ein blaues Tablet st√∂√üt, sondern auf Prozessoren wie F405 und h√∂her?  Ich pers√∂nlich bin nur mit F401-Steinen begegnet, aber das ist ein etwas anderes Level ... Ich bin leicht zu besteigen und f√ºr meine Experimente habe ich, ohne zweimal dar√ºber nachzudenken, eine Zahlung in dem guten alten P-CAD 2006 geleistet und sie bei den Chinesen auf einer der Schnellbestellungsseiten bestellt.  Nat√ºrlich ist es in Farbe ein gr√ºnes Tablet, aber in Bezug auf die Bedeutung habe ich beschlossen, den Namen BluePill zu belassen, aber darauf hinzuweisen, dass es bereits x405 ist.  Das Ergebnis unter den Spoilern ist ein Foto des BluePill x405-Boards. <br><br><div class="spoiler">  <b class="spoiler_title">Blick von oben</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/kv/ha/hs/kvhahsy1nncrjqogvfafgr1jn10.jpeg"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Ansicht von unten</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/5z/ar/ts/5zartsne1u9zbrijwlz6txgknp8.jpeg"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Konzept und Gerber auf Github</b> <div class="spoiler_text">  <a href="https://github.com/Greeds74/BluePill-x405/tree/master/Habr">Github</a> <br></div></div><br>  Ein bisschen dar√ºber, warum dieses Board so bemerkenswert ist?  Schlie√ülich gab es nur Tausende von Versuchen, Bluepill-Klone zu erstellen!  Der Unterschied besteht jedoch darin, dass ich eine Firmware an dieses Board anschlie√üe, die es in einen Kernel verwandelt, der ein Programm ausf√ºhrt, das mit den Mitsubishi-Industriereglern in einem Befehlssystem kompatibel ist.  Dieses Wunder wird an 16 Eing√§ngen, 16 Ausg√§ngen, 2 analogen Eing√§ngen, 3 UART mit DE-Unterst√ºtzung f√ºr RS485, 1 Onewire-Master-Bus berechnet.  UART kann als Master-Bus-Modbus-RTU und als Slave arbeiten.  Und sie k√∂nnen v√∂llig unabh√§ngig arbeiten. <br>  Aber das ist noch nicht alles - wenn Sie eine 3-V-Batterie an den VBAT-Pin anschlie√üen, behalten nicht nur die Uhr, sondern auch die Timer, Z√§hler, Merker und die ersten 1000 Universalregister D ihre Werte bei. Und es gibt 8000 Register. <br><br>  Ich nehme die Fragen vorweg und sage sofort: Ja, die Software basiert auf einem Echtzeit-Betriebssystem.  Ja, DMA wird wo immer m√∂glich verwendet.  Diese Funktionen erm√∂glichen das Arbeiten ohne wesentliche √Ñnderungen der Zykluszeit bei hohen Kommunikationslasten.  Diese Version ist die zweite Revision, √ºberarbeitet und erg√§nzt. <br><br>  Diese Karte kann sowohl von GX FXDeveloper als auch von IEC Developer und GX Works vollst√§ndig programmiert werden. <br><br><h3>  Das Schicksal der Pumpe und zwei Panzer </h3><br>  L√∂sen wir jetzt dieses Problem - zumal alle Werkzeuge daf√ºr zur Verf√ºgung stehen.  Um nicht viel herauszuholen, habe ich ein Programm geschrieben, es in Teile (die sogenannten Netzwerk- oder Arbeitsketten) zerlegt, und ich werde jedes von ihnen hier zeigen und Kommentare abgeben. <br><br><div class="spoiler">  <b class="spoiler_title">Net 1 - erster Programmlauf</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/mt/se/6l/mtse6lkxocvzicroixvaxkp986y.png"><br></div></div><br>  Das D1000-Register speichert die Zeit, die zum Unterdr√ºcken des Kontaktsprungs erforderlich ist.  In der Tat ist dies bereits im Programm - aber ich m√∂chte es deutlicher zeigen.  Register D1001 ist f√ºr die Pumpenschutzzeit zust√§ndig.  Darin schreiben wir 15.000 oder 1.500 Sekunden.  Als n√§chstes haben wir eine Backup-Reset-Kette - wenn etwas schief geht, k√∂nnen Sie Signal 1 an Eingang X14 senden und die Karte neu starten.  In diesem Fall wird 0 in die Register D0 und D1 geschrieben und die M98- und M99-Mercker werden zur√ºckgesetzt. <br><br><div class="spoiler">  <b class="spoiler_title">Net 2 - Eingangssignalverarbeitung</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/q2/c2/0r/q2c20rgbj45frsx31p4sisxv_tg.png"><br></div></div><br>  Hier werden wir mit Hilfe von Timern den Kontaktsprung los.  Verwenden Sie dazu eine Verz√∂gerung von 200 Millisekunden.  Um sicherzustellen, dass im zuk√ºnftigen Programm beim √Ñndern der Eingabeadresse des Kontakts nicht viele Ketten neu geschrieben werden m√ºssen, verwende ich Zwischenmerker (z. B. M102).  Es ist auch bemerkenswert, dass der M8003-Systemh√§ndler hier verwendet wird - er wird eingeschaltet, nachdem der erste Zyklus der Programmausf√ºhrung verstrichen ist.  Der M8002 Merker ist jedoch nur im ersten Zyklus des Programms aktiv und kann und sollte zum Einstellen der Anfangswerte verwendet werden. <br><br><div class="spoiler">  <b class="spoiler_title">Netz 3 - Tankf√ºllung 1.</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/vr/cp/h4/vrcph4mhgoiir-hgrghd92tpiew.png"><br></div></div><br>  Die Bef√ºllung des Tanks 1 ist mit Ausnahme der Adressen v√∂llig identisch mit der Bef√ºllung des Tanks 2.  Die Zeichnung passte nicht ein bisschen - aber Sie sollten sie sich besser ansehen, indem Sie das Projekt √∂ffnen.  Was ist an diesem Steuerger√§t bemerkenswert?  Das Vorhandensein von Schutzvorrichtungen und Blockierungen, die sto√üfreie Start- und Stoppmechanismen erm√∂glichen.  Beispielsweise wird nach dem √ñffnen von Ventil 1 erst nach 700 ms ein Befehl zum Starten des Anlassers ausgegeben, der die Pumpe einschaltet. <br><br>  Die Verwaltung sieht hier keinen manuellen Modus vor.  Auch ein Schutz gegen Trockenlauf und ein Schutz gegen zu langen Pumpenbetrieb sind implementiert. <br><br><div class="spoiler">  <b class="spoiler_title">Net 5-6 - Output Management</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/sw/oi/ta/swoitandloflperaamkjr9yysak.png"><br></div></div><br>  Und hier steuern wir die Ausg√§nge in √úbereinstimmung mit den Sperren. <br><br>  Von den Aufgaben blieb nur die Verbindung des 30-min√ºtigen Schutzintervalls vor dem Neustart unerf√ºllt.  Ich muss gleich sagen - in dieser Version sind nur die Eing√§nge X0-X3 und der Ausgang Y0-Y3 implementiert, was f√ºr das Testen des Materials in diesem Artikel v√∂llig ausreicht.  Die Bindung ist PA4-X0, PA5-X1, PA6-X2, PA7-X3 und PB4-Y0, PB5-Y1, PB6-Y2, PB7-Y3. <br><br><h3>  Programmzyklusgeschwindigkeit - Gro√üv√§terliche Messmethoden </h3><br>  Wenn wir uns diese Frage stellen, f√§llt uns sofort ein, ein sehr gro√ües Programm aus einer bestimmten Anzahl identischer Elemente in die Steuerung zu schreiben, die Ausf√ºhrungszeit zu ermitteln und die Ausf√ºhrungszeit eines Befehls zu ermitteln.  Es wird gesagt - getan, unter dem Spoiler-Programm und im Namen der Spoiler-Ausf√ºhrungszeit. <br><br><div class="spoiler">  <b class="spoiler_title">7995 Schritte - 2,6 Millisekunden</b> <div class="spoiler_text">  <a href="">8000 Schritte</a> <br></div></div><br>  Hier ist jeder Schritt ein Befehl, und wir erhalten 2,6 / 7995 = 0,325 Mikrosekunden.  Nicht sehr schnell, aber nicht schlecht. <br><br><h3>  FPU - sein oder nicht sein? </h3><br>  Lassen Sie uns nun bestimmen, wie schnell Gleitkomma-Anweisungen in unserer Firmware funktionieren.  Es gibt zwei Firmwares, eine mit integrierter FPU und eine mit Software-Emulation.  Das Programm unten: <br><br><div class="spoiler">  <b class="spoiler_title">Programm zur Berechnung der Ausf√ºhrungszeit einer Anweisung</b> <div class="spoiler_text">  <a href="">8000 Gleitkomma-Schritte-Programm</a> <br></div></div><br>  Die Firmware unten befindet sich unter dem Spoiler und unterliegt keinen Einschr√§nkungen <br><br><div class="spoiler">  <b class="spoiler_title">Zwei Firmware</b> <div class="spoiler_text">  <a href="https://github.com/Greeds74/BluePill-x405/tree/master/Habr_software">Firmware</a> <br></div></div><br>  Bei Verwendung einer Hardware-FPU betr√§gt die Programmausf√ºhrungszeit 1,8 ms oder 1,8 / 600 = 0,003 ms oder 3 Mikrosekunden. <br><br>  Tauschen Sie nun die Firmware aus - verwenden Sie die Software-Emulation.  Das Ergebnis ist bereits anders - 2,5 ms oder 2,5 / 600 = 0,0041 ms oder 4,1 Mikrosekunden.  Nicht schlecht, aber der Unterschied ist deutlich zu sp√ºren. <br><br><h3>  Fazit </h3><br>  Trotz des gro√üen Volumens des Artikels gibt es immer noch viele Materialien, die gut zu behandeln w√§ren.  Wenn dieser Artikel f√ºr Sie von Interesse ist, wird diesem Artikel ein weiterer folgen.  Aber ich w√ºrde gerne Gleichgesinnte finden, die sich mit nur einem Zweck der Vereinigung von Industrie und Haushalt anschlie√üen wollen - damit diese Werkzeuge f√ºr einen einfachen Laien zug√§nglich sind. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de477478/">https://habr.com/ru/post/de477478/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de477464/index.html">Wie ich Docker in Docker gestartet habe und was dabei herausgekommen ist</a></li>
<li><a href="../de477468/index.html">Ein gro√üartiger √úberblick √ºber die W√§rmebildkamera Seek Thermal SHOT: W√§rmekontrolle von Wohngeb√§uden</a></li>
<li><a href="../de477470/index.html">√úber die Rolle von Testaufgaben im Leben des Entwicklers</a></li>
<li><a href="../de477474/index.html">Leben und Sitten der Tr√§umer</a></li>
<li><a href="../de477476/index.html">Heterogene Programmierung und OneAPI Toolkit. Stellen Sie einem Intel-Experten eine Frage</a></li>
<li><a href="../de477484/index.html">Was hielten sie von Programmierern?</a></li>
<li><a href="../de477488/index.html">Neungers: Gew√ºrz muss flie√üen</a></li>
<li><a href="../de477490/index.html">K√ºchenrobotik Teil 2 oder ein anderer Blynk Avatar</a></li>
<li><a href="../de477492/index.html">Was bleibt im Serverraum?</a></li>
<li><a href="../de477494/index.html">1. Malware-Analyse mit Check Point Forensics. Sandstrahl-Netzwerk</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>