<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õ≤Ô∏è üëµüèæ üëáüèæ Um pouco de pr√°tica da programa√ß√£o funcional no Swift para iniciantes üì¨ ü§õüèø ü§õ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Eu gostaria de apresentar o conceito de Programa√ß√£o Funcional para iniciantes da maneira mais simples, destacando algumas de suas vantagens das muitas...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Um pouco de pr√°tica da programa√ß√£o funcional no Swift para iniciantes</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/440722/"><img src="https://habrastorage.org/webt/r4/cx/wi/r4cxwi9bjlhswlncf4ru1uslm4q.png"><br><br>  Eu gostaria de apresentar o conceito de <i>Programa√ß√£o Funcional para</i> iniciantes da maneira mais simples, destacando algumas de suas vantagens das muitas outras que realmente tornar√£o o c√≥digo mais leg√≠vel e expressivo.  Peguei algumas demos interessantes para voc√™ que est√£o no <code>Playground</code> no <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Github</a></b> . <br><br><h2>  Programa√ß√£o Funcional: Defini√ß√£o </h2><br>  Primeiro de tudo, a <i>Programa√ß√£o Funcional</i> n√£o √© uma linguagem ou sintaxe, mas provavelmente uma maneira de resolver problemas dividindo processos complexos em processos mais simples e sua composi√ß√£o subseq√ºente.  Como o nome indica, ‚Äú <i>Programa√ß√£o Funcional</i> ‚Äù <i>,</i> a unidade de composi√ß√£o para essa abordagem √© uma <i>fun√ß√£o</i> ;  e o objetivo dessa <i>fun√ß√£o</i> √© evitar alterar estados ou valores fora de seu <code>scope)</code> . <br><br>  No <code>Swift</code> World, existem todas as condi√ß√µes para isso, porque as <i>fun√ß√µes</i> aqui s√£o participantes t√£o plenos do processo de programa√ß√£o quanto os <i>objetos,</i> e o problema da <code>mutation</code> √© resolvido no n√≠vel do conceito de <code>value</code> TYPES (estruturas e <code><font color="#0000FF">enum</font></code> enum√©ricas) que ajudam a gerenciar a mutabilidade ( <code>mutation</code> ) e comunique claramente como e quando isso pode acontecer. <br><br>  No entanto, o <code>Swift</code> n√£o <code>Swift</code> no sentido pleno da linguagem de <i>programa√ß√£o funcional</i> , n√£o o for√ßa a <i>programar</i> com <i>funcionalidade</i> , embora reconhe√ßa as vantagens das abordagens <i>funcionais</i> e encontre maneiras de incorpor√°-las. <br><br>  Neste artigo, focaremos o uso dos elementos <i>internos da Programa√ß√£o Funcional</i> no <code>Swift</code> (isto √©, "pronto para uso") e entender como voc√™ pode us√°-los confortavelmente em seu aplicativo. <br><a name="habracut"></a><br><h2>  Abordagens Imperativas e Funcionais: Compara√ß√£o </h2><br>  Para avaliar a Abordagem <i>Funcional</i> , vamos comparar as solu√ß√µes para um problema simples de duas maneiras diferentes.  A primeira solu√ß√£o √© " <i>Imperativo</i> " <i>,</i> na qual o c√≥digo altera o estado dentro do programa. <br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">//Imperative Approach var numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] for i in 0..&lt;numbers.count { let timesTen = numbers[i] * 10 numbers[i] = timesTen } print(numbers) //[10, 20, 30, 40, 50, 60, 70, 80, 90, 100]</span></span></code> </pre><br>  Observe que manipulamos os valores dentro da matriz mut√°vel denominada <code><font color="#0000FF">numbers</font></code> e, em seguida, imprimimos no console.  Observando este c√≥digo, tente responder √†s seguintes perguntas que discutiremos em um futuro pr√≥ximo: <br><br><ol><li>  O que voc√™ est√° tentando alcan√ßar com seu c√≥digo? </li><li>  O que acontece se outro <code>thread</code> tentar acessar a matriz de <code><font color="#0000FF">numbers</font></code> enquanto seu c√≥digo estiver em execu√ß√£o? </li><li>  O que acontece se voc√™ deseja ter acesso aos valores originais na matriz de <code><font color="#0000FF">numbers</font></code> ? </li><li>  Qu√£o confi√°vel esse c√≥digo pode ser testado? </li></ol><br>  Agora vamos ver uma abordagem alternativa " <i>Funcional</i> ": <br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">//Functional Approach let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] extension Array where Element == Int { func timesTen() -&gt; [Int] { var output = [Int]() for num in self { output.append(num * 10) } return output } } let result = numbers.timesTen() print(numbers) //[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] print(result) //[10, 20, 30, 40, 50, 60, 70, 80, 90, 100]</span></span></code> </pre><br>  Neste trecho de c√≥digo, obtemos o mesmo resultado no console, abordando a solu√ß√£o do problema de uma maneira completamente diferente.  Observe que desta vez nossa matriz de <code><font color="#0000FF">numbers</font></code> √© imut√°vel gra√ßas √† palavra-chave <code><font color="#0000FF">let</font></code> .  <code><font color="#0000FF">timesTen()</font></code> o processo de multiplica√ß√£o de n√∫meros da matriz de <code><font color="#0000FF">numbers</font></code> para o m√©todo <code><font color="#0000FF">timesTen()</font></code> , localizado na extens√£o de <code><font color="#0000FF">extension</font></code> <code><font color="#0000FF">Array</font></code> .  Ainda usamos um loop <code><font color="#0000FF">for</font></code> e modificamos uma vari√°vel chamada <code><font color="#0000FF">output</font></code> , mas o <code>scope</code> dessa vari√°vel √© limitado apenas por esse m√©todo.  Da mesma forma, nosso argumento de entrada <code><font color="#0000FF">self</font></code> √© passado para o m√©todo <code><font color="#0000FF">timesTen()</font></code> por valor ( <code>by value</code> ), tendo o mesmo escopo que a vari√°vel de <code><font color="#0000FF">output</font></code> .  O m√©todo <code><font color="#0000FF">timesTen()</font></code> √© chamado e podemos imprimir no console a matriz de <code><font color="#0000FF">numbers</font></code> original e o resultado da matriz de <code><font color="#0000FF">result</font></code> . <br>  Vamos voltar √†s nossas 4 perguntas. <br><br>  <i>1. O que voc√™ est√° tentando alcan√ßar com seu c√≥digo?</i> <br><br>  Em nosso exemplo, realizamos uma tarefa muito simples multiplicando os n√∫meros na matriz de <code><font color="#0000FF">numbers</font></code> por <code><font color="#0000FF">10</font></code> . <br><br>  Com uma abordagem <i>imperativa</i> , para obter uma sa√≠da, voc√™ precisa pensar como um computador, seguindo as instru√ß√µes no loop <code><font color="#0000FF">for</font></code> .  Nesse caso, o c√≥digo mostra <code></code> voc√™ consegue o resultado.  Com a Abordagem <i>Funcional</i> , ‚Äú <code></code> ‚Äù √© ‚Äú <code><font color="#0000FF">timesTen()</font></code> ‚Äù no m√©todo <code><font color="#0000FF">timesTen()</font></code> .  Desde que esse m√©todo tenha sido implementado em outro lugar, voc√™ poder√° realmente ver apenas a express√£o <code><font color="#0000FF">numbers.timesTen()</font></code> .  Esse c√≥digo mostra claramente o <code></code> alcan√ßado por esse c√≥digo, e n√£o <code></code> a tarefa √© resolvida.  Isso √© chamado de <i>Programa√ß√£o Declarativa</i> e √© f√°cil adivinhar por que essa abordagem √© atraente.  <i>A</i> abordagem <i>imperativa</i> faz o desenvolvedor entender <code></code> c√≥digo funciona para determinar o <code></code> ele deve fazer.  <i>A</i> abordagem <i>funcional</i> comparada √† abordagem <i>Imperative</i> √© muito mais "expressiva" e oferece ao desenvolvedor uma oportunidade de luxo de simplesmente assumir que o m√©todo faz o que ele afirma fazer!  (Obviamente, essa suposi√ß√£o se aplica apenas ao c√≥digo pr√©-verificado). <br><br>  <i>2. O que acontece se outro <code>thread</code> tentar acessar a matriz de <code><font color="#0000FF">numbers</font></code> enquanto seu c√≥digo estiver em execu√ß√£o?</i> <br><br>  Os exemplos apresentados acima existem em um espa√ßo completamente isolado, embora em um ambiente multiencadeado complexo, √© bem poss√≠vel que dois <code>threads</code> tentem acessar os mesmos recursos simultaneamente.  No caso da abordagem <i>Imperative</i> , √© f√°cil ver que quando outro <code>thread</code> tiver acesso √† matriz de <code><font color="#0000FF">numbers</font></code> no processo de uso, o resultado ser√° ditado pela ordem em que os <code>threads</code> acessam a matriz de <code><font color="#0000FF">numbers</font></code> .  Essa situa√ß√£o √© chamada de <code>race condition</code> e pode levar a comportamento imprevis√≠vel e at√© instabilidade e travamento do aplicativo. <br><br>  Em compara√ß√£o, a Abordagem <i>Funcional</i> n√£o tem "efeitos colaterais".  Em outras palavras, a sa√≠da do m√©todo de <code><font color="#0000FF">output</font></code> n√£o altera nenhum valor armazenado em nosso sistema e √© determinada apenas pela entrada.  Nesse caso, qualquer thread ( <code>threads</code> ) que tenha acesso √† matriz <code><font color="#0000FF">numbers</font></code> receber√° SEMPRE os mesmos valores e seu comportamento ser√° est√°vel e previs√≠vel. <br><br>  3. O que acontece se voc√™ deseja ter acesso aos valores originais armazenados na matriz de <code><font color="#0000FF">numbers</font></code> ? <br><br>  Esta √© uma continua√ß√£o da nossa discuss√£o sobre "efeitos colaterais".  Obviamente, as mudan√ßas de estado n√£o s√£o rastreadas.  Portanto, com a abordagem <i>Imperative</i> , perdemos o estado inicial de nossa matriz de <code><font color="#0000FF">numbers</font></code> durante o processo de convers√£o.  Nossa solu√ß√£o, baseada na Abordagem <i>Funcional</i> , salva a matriz de <code><font color="#0000FF">numbers</font></code> originais e gera uma nova matriz de <code><font color="#0000FF">result</font></code> com as propriedades desejadas na sa√≠da.  Ele deixa a matriz de <code><font color="#0000FF">numbers</font></code> original intacta e adequada para processamento futuro. <br><br>  4. Qu√£o confi√°vel esse c√≥digo pode ser testado? <br><br>  Como a abordagem <i>Funcional</i> destr√≥i todos os "efeitos colaterais", a funcionalidade testada est√° completamente dentro do m√©todo.  A entrada desse m√©todo NUNCA sofrer√° altera√ß√µes, portanto, voc√™ pode testar v√°rias vezes usando o ciclo quantas vezes quiser e sempre obter√° o mesmo resultado.  Nesse caso, o teste √© muito f√°cil.  Em compara√ß√£o, testar a solu√ß√£o <i>Imperative</i> em um loop alterar√° o in√≠cio da entrada e voc√™ obter√° resultados completamente diferentes ap√≥s cada itera√ß√£o. <br><br><h2>  Resumo dos Benef√≠cios </h2><br>  Como vimos em um exemplo muito simples, a Abordagem <i>Funcional</i> √© uma coisa interessante se voc√™ estiver lidando com um Modelo de Dados porque: <br><br><ul><li>  √â declarativo </li><li>  Corrige problemas relacionados a threads, como <code>race condition</code> e deadlocks </li><li>  Ele deixa o estado inalterado, que pode ser usado para transforma√ß√µes subsequentes. </li><li>  √â f√°cil de testar. </li></ul><br>  Vamos um pouco mais longe no aprendizado da Programa√ß√£o <i>Funcional</i> no <code>Swift</code> .  Ele assume que os principais "atores" s√£o fun√ß√µes e devem ser principalmente <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">objetos da primeira classe</a> . <br><br><h2>  Fun√ß√µes de primeira classe e fun√ß√µes de ordem superior </h2><br>  Para que uma fun√ß√£o seja de primeira classe, ela deve ter a capacidade de ser declarada como uma vari√°vel.  Isso permite gerenciar a fun√ß√£o como um TIPO de dados normal e, ao mesmo tempo, execut√°-la.  Felizmente, em <code>Swift</code> fun√ß√µes s√£o objetos da primeira classe, ou seja, s√£o suportadas passando-as como argumentos para outras fun√ß√µes, retornando-as como resultado de outras fun√ß√µes, atribuindo-as a vari√°veis ‚Äã‚Äãou armazenando-as em estruturas de dados. <br><br>  Por isso, temos outras fun√ß√µes no <code>Swift</code> - fun√ß√µes de ordem superior que s√£o definidas como fun√ß√µes que assumem outra fun√ß√£o como argumento ou retornam uma fun√ß√£o.  Existem muitos deles: <code><font color="#0000FF">map</font></code> , <code><font color="#0000FF">filter</font></code> , <code><font color="#0000FF">reduce</font></code> , <code><font color="#0000FF">forEach</font></code> , <code><font color="#0000FF">flatMap</font></code> , <code><font color="#0000FF">compactMap</font></code> , <code><font color="#0000FF">sorted</font></code> , etc.  Os exemplos mais comuns de fun√ß√µes de ordem superior s√£o <code><font color="#0000FF">map</font></code> , <code><font color="#0000FF">filter</font></code> e <code><font color="#0000FF">reduce</font></code> .  Eles n√£o s√£o globais, est√£o todos "apegados" a certos TIPOS.  Eles funcionam em todos os TIPOS de <code><font color="#0000FF">Sequence</font></code> , incluindo a <code><font color="#0000FF">Collection</font></code> , que √© representada por estruturas de dados <code>Swift</code> , como uma <code><font color="#0000FF">Array</font></code> , um <code><font color="#0000FF">Dictionary</font></code> e um <code><font color="#0000FF">Set</font></code> .  No <code>Swift 5</code> , fun√ß√µes de ordem superior tamb√©m funcionam com um TYPE - <code><font color="#0000FF">Result</font></code> completamente novo. <br><br><h2> <code><font color="#0000FF">map(_:)</font></code> </h2> <br>  No <code><font color="#0000FF">map(_:)</font></code> <code>Swift</code> <code><font color="#0000FF">map(_:)</font></code> assume uma fun√ß√£o como par√¢metro e converte os valores de um determinado <code></code> acordo com esta fun√ß√£o.  Por exemplo, aplicando <code><font color="#0000FF">map(_:)</font></code> a uma matriz de valores de <code><font color="#0000FF">Array</font></code> , aplicamos uma fun√ß√£o de par√¢metro a cada elemento da matriz original e obtemos uma matriz de <code><font color="#0000FF">Array</font></code> , mas tamb√©m os valores convertidos. <br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">//Functional Approach let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] func timesTen(_ x:Int) -&gt; Int { return x * 10 } let result = numbers.map (timesTen) print(numbers) //[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] print(result) //[10, 20, 30, 40, 50, 60, 70, 80, 90, 100]</span></span></code> </pre><br>  No c√≥digo acima, criamos a fun√ß√£o <code><font color="#0000FF">timesTen (_:Int)</font></code> , que pega um valor inteiro <code><font color="#0000FF">Int</font></code> e retorna o valor inteiro <code><font color="#0000FF">Int</font></code> multiplicado por <code><font color="#0000FF">10</font></code> , e o usamos como par√¢metro de entrada para nossa fun√ß√£o de <code><font color="#0000FF">map(_:)</font></code> ordem superior <code><font color="#0000FF">map(_:)</font></code> , aplicando-a √† nossa matriz <code><font color="#0000FF">numbers</font></code> .  Temos o resultado que precisamos na matriz de <code><font color="#0000FF">result</font></code> . <br><br>  O nome da fun√ß√£o de par√¢metro <code><font color="#0000FF">timesTen</font></code> para fun√ß√µes de ordem superior como <code><font color="#0000FF">map(_:)</font></code> n√£o importa, o <code></code> par√¢metro de entrada e o valor de retorno s√£o importantes, ou seja, a assinatura <code><font color="#0000FF">(Int) -&gt; Int</font></code> par√¢metro de entrada de fun√ß√£o.  Portanto, podemos usar fun√ß√µes an√¥nimas no <code><font color="#0000FF">map(_:)</font></code> - closures - de qualquer forma, incluindo aquelas com nomes abreviados de argumentos <code><font color="#0000FF">$0</font></code> , <code><font color="#0000FF">$1</font></code> , etc. <br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">//Functional Approach let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] let result = numbers.map { $0 * 10 } print(numbers) //[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] print(result) //[10, 20, 30, 40, 50, 60, 70, 80, 90, 100]</span></span></code> </pre><br>  Se olharmos para a fun√ß√£o <code><font color="#0000FF">map(_ :)</font></code> para uma <code><font color="#0000FF">Array</font></code> , ela pode ser assim: <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">map</span></span></span><span class="hljs-function">&lt;T&gt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> transform: </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(Element)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">T</span></span>) -&gt; [<span class="hljs-type"><span class="hljs-type">T</span></span>] { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> returnValue = [<span class="hljs-type"><span class="hljs-type">T</span></span>]() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> { returnValue.append(transform(item)) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> returnValue }</code> </pre><br>  Este √© um c√≥digo imperativo que nos √© familiar, mas n√£o √© mais um problema de desenvolvedor, √© um problema da <code>Apple</code> , um problema do <code>Swift</code> .  A implementa√ß√£o da fun√ß√£o de <code><font color="#0000FF">map(_:)</font></code> ordem superior <code><font color="#0000FF">map(_:)</font></code> √© otimizada pela <code>Apple</code> em termos de desempenho, e n√≥s, os desenvolvedores, temos a funcionalidade do <code><font color="#0000FF">map(_:)</font></code> garantida, para que possamos expressar corretamente corretamente com a fun√ß√£o de argumento de <code><font color="#0000FF">transform</font></code> <code></code> queremos, sem se preocupar com <code></code> ser√° implementado.  Como resultado, obtemos um c√≥digo perfeitamente leg√≠vel na forma de uma √∫nica linha, que funcionar√° melhor e mais rapidamente. <br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">//Functional Approach let possibleNumbers = ["1", "2", "three", "///4///", "5"] let mapped = possibleNumbers.map {str in Int(str) } print (mapped) // [Optional(1), Optional(2), nil, nil, Optional(5)]</span></span></code> </pre><br>  O <code></code> retornado pela fun√ß√£o de par√¢metro pode n√£o coincidir com o <code></code> elementos na cole√ß√£o original. <br><br>  No c√≥digo acima, temos poss√≠veis n√∫meros inteiros <code><font color="#0000FF">possibleNumbers</font></code> , representados como seq√º√™ncias de caracteres, e queremos convert√™-los em n√∫meros inteiros de <code></code> <code><font color="#0000FF">Int</font></code> , usando o inicializador dispon√≠vel <code><font color="#0000FF">Int(_ :String)</font></code> representado pelo fechamento <code><font color="#0000FF">{ str in Int(str) }</font></code> .  Fazemos isso usando <code><font color="#0000FF">map(_:)</font></code> e obtemos uma matriz <code><font color="#0000FF">mapped</font></code> de <code></code> <code><font color="#0000FF">Optional</font></code> como a sa√≠da: <br><br><img src="https://habrastorage.org/webt/43/mg/hd/43mghd5aphvgnytu06eos4zhxos.png"><br><br>  <code></code> foi poss√≠vel converter <code></code> elementos da nossa matriz <code><font color="#0000FF">possibleNumbers</font></code> em n√∫meros inteiros, como resultado, uma parte recebeu o valor <code><font color="#0000FF">nil</font></code> , indicando a impossibilidade de converter a <code><font color="#0000FF">String</font></code> em um inteiro <code><font color="#0000FF">Int</font></code> e a outra parte transformada em <code><font color="#0000FF">Optionals</font></code> , que possuem valores: <br><br><pre> <code class="swift hljs"><span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (mapped) <span class="hljs-comment"><span class="hljs-comment">// [Optional(1), Optional(2), nil, nil, Optional(5)]</span></span></code> </pre><br><h2> <code><font color="#0000FF">compactMap(_ :)</font></code> </h2> <br>  Se a fun√ß√£o de par√¢metro passada para a fun√ß√£o de ordem superior tiver um valor <code><font color="#0000FF">Optional</font></code> na sa√≠da, pode ser mais √∫til usar outra fun√ß√£o de ordem superior, com significado semelhante - <code><font color="#0000FF">compactMap(_ :)</font></code> , que faz a mesma coisa que <code><font color="#0000FF">map(_:)</font></code> , mas adicionalmente "expande" os valores recebidos na sa√≠da <code><font color="#0000FF">Optional</font></code> e remove valores <code><font color="#0000FF">nil</font></code> da cole√ß√£o. <br><br><img src="https://habrastorage.org/webt/ie/a8/ls/iea8lshgmocoqytj8horz--kx0k.png"><br><br>  Nesse caso, obtemos uma matriz de <code><font color="#0000FF">compactMapped</font></code> TYPE <code><font color="#0000FF">[Int]</font></code> , mas possivelmente menor: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> possibleNumbers = [<span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-string"><span class="hljs-string">"2"</span></span>, <span class="hljs-string"><span class="hljs-string">"three"</span></span>, <span class="hljs-string"><span class="hljs-string">"///4///"</span></span>, <span class="hljs-string"><span class="hljs-string">"5"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> compactMapped = possibleNumbers.compactMap(<span class="hljs-type"><span class="hljs-type">Int</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (compactMapped) <span class="hljs-comment"><span class="hljs-comment">// [1, 2, 5]</span></span></code> </pre><br><img src="https://habrastorage.org/webt/wl/wf/ae/wlwfaep3tzyxrennftqqdtwezb8.png"><br><br>  Sempre que voc√™ usar o <code><font color="#0000FF">init?()</font></code> Como a fun√ß√£o de transforma√ß√£o, ser√° necess√°rio usar o <code><font color="#0000FF">compactMap(_ :)</font></code> : <br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">// Validate URLs let strings = ["https://demo0989623.mockable.io/car/1", "https://i.imgur.com/Wm1xcNZ.jpg"] let validateURLs = strings.compactMap(URL.init) // Separate Numbers and Operations let mathString: String = "12-37*2/5+44" let numbers1 = mathString.components(separatedBy: ["-", "*", "+", "/"]).compactMap(Int.init) print(numbers1) // [12, 37, 2, 5, 44]</span></span></code> </pre><br>  Devo dizer que existem raz√µes mais do que suficientes para usar a fun√ß√£o de ordem superior <code><font color="#0000FF">compactMap(_ :)</font></code> .  <code>Swift</code> ‚Äúama‚Äù Valores <code><font color="#0000FF">Optional</font></code> , eles podem ser obtidos n√£o apenas usando o <code><font color="#0000FF">init?()</font></code> ‚Äú <code>failable</code> ‚Äù <code><font color="#0000FF">init?()</font></code> , mas tamb√©m usando o <code><font color="#0000FF">as?</font></code>  <code></code> "Fundi√ß√£o": <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> views = [innerView,shadowView,logoView] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> imageViews = views.compactMap{$<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>? <span class="hljs-type"><span class="hljs-type">UIImageView</span></span>}</code> </pre><br>  ... e a <code><font color="#0000FF">try?</font></code>  ao processar erros gerados por alguns m√©todos.  Devo dizer que a <code>Apple</code> preocupada que o uso de <code><font color="#0000FF">try?</font></code>  muitas vezes leva a dobrar <code><font color="#0000FF">Optional</font></code> e no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Swift 5</a> agora deixa apenas um n√≠vel <code><font color="#0000FF">Optional</font></code> depois de aplicar a <code><font color="#0000FF">try?</font></code>  . <br><br>  H√° mais uma fun√ß√£o semelhante no nome do <code><font color="#0000FF">flatMap(_ :)</font></code> ordem superior <code><font color="#0000FF">flatMap(_ :)</font></code> , sobre o qual um pouco menor. <br><br>  √Äs vezes, para usar o <code><font color="#0000FF">map(_:)</font></code> fun√ß√µes de ordem superior <code><font color="#0000FF">map(_:)</font></code> , √© √∫til usar o m√©todo <code><font color="#0000FF">zip (_:, _:)</font></code> para criar uma sequ√™ncia de pares a partir de duas seq√º√™ncias diferentes. <br><br>  Suponha que tenhamos uma <code><font color="#0000FF">view</font></code> na qual v√°rios pontos s√£o representados, conectados entre si e formando uma linha quebrada: <br><br><img src="https://habrastorage.org/webt/gj/ut/_3/gjut_3xu92asnbvjvibucndse5o.png"><br><br>  Precisamos construir outra linha quebrada conectando os pontos m√©dios dos segmentos da linha quebrada original: <br><br><img src="https://habrastorage.org/webt/zv/hr/ke/zvhrkexsungckflo4orcpnkkm7e.png"><br><br>  Para calcular o ponto m√©dio de um segmento, precisamos ter as coordenadas de dois pontos: o atual e o pr√≥ximo.  Para fazer isso, podemos criar uma sequ√™ncia que consiste em pares de pontos - o atual e o pr√≥ximo - usando o m√©todo <code><font color="#0000FF">zip (_:, _:)</font></code> <code><font color="#0000FF">points.dropFirst()</font></code> <code><font color="#0000FF">zip (_:, _:)</font></code> , no qual usaremos a matriz de pontos iniciais e a matriz dos seguintes <code><font color="#0000FF">points.dropFirst()</font></code> : <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> pairs = <span class="hljs-built_in"><span class="hljs-built_in">zip</span></span> (points,points.<span class="hljs-built_in"><span class="hljs-built_in">dropFirst</span></span>()) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> averagePoints = pairs.<span class="hljs-built_in"><span class="hljs-built_in">map</span></span> { <span class="hljs-type"><span class="hljs-type">CGPoint</span></span>(x: ($<span class="hljs-number"><span class="hljs-number">0</span></span>.x + $<span class="hljs-number"><span class="hljs-number">1</span></span>.x) / <span class="hljs-number"><span class="hljs-number">2</span></span>, y: ($<span class="hljs-number"><span class="hljs-number">0</span></span>.y + $<span class="hljs-number"><span class="hljs-number">1</span></span>.y) / <span class="hljs-number"><span class="hljs-number">2</span></span> )}</code> </pre><br>  Tendo essa sequ√™ncia, calculamos muito facilmente os pontos m√©dios usando o <code><font color="#0000FF">map(_:)</font></code> fun√ß√µes de ordem superior <code><font color="#0000FF">map(_:)</font></code> e os exibimos no gr√°fico. <br><br><h2> <code><font color="#0000FF">filter (_:)</font></code> </h2> <br>  No <code>Swift</code> , o <code><font color="#0000FF">filter (_:)</font></code> fun√ß√£o de ordem superior <code><font color="#0000FF">filter (_:)</font></code> est√° dispon√≠vel para a maioria dos <code></code> quais a fun√ß√£o de <code><font color="#0000FF">map(_:)</font></code> est√° dispon√≠vel.  Voc√™ pode filtrar qualquer <code><font color="#0000FF">Sequence</font></code> sequ√™ncia com o <code><font color="#0000FF">filter (_:)</font></code> , isso √© √≥bvio!  O m√©todo <code><font color="#0000FF">filter (_:)</font></code> assume outra fun√ß√£o como par√¢metro, que √© uma condi√ß√£o para cada elemento da sequ√™ncia e, se a condi√ß√£o for satisfeita, o elemento ser√° inclu√≠do no resultado e, se n√£o, n√£o ser√° inclu√≠do.  Essa "outra fun√ß√£o" pega um valor √∫nico - um elemento da sequ√™ncia <code><font color="#0000FF">Sequence</font></code> - e retorna um <code><font color="#0000FF">Bool</font></code> , o chamado predicado. <br><br>  Por exemplo, para matrizes de <code><font color="#0000FF">Array</font></code> , o <code><font color="#0000FF">filter (_:)</font></code> fun√ß√£o de ordem superior <code><font color="#0000FF">filter (_:)</font></code> aplica a fun√ß√£o de predicado e retorna outra matriz que consiste apenas nos elementos da matriz original para os quais a fun√ß√£o de predicado de entrada retorna <code><font color="#0000FF">true</font></code> . <br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">//Functional Approach let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] let filted = numbers.filter{$0 % 2 == 0} //[2, 4, 6, 8, 10]</span></span></code> </pre><br>  Aqui, o <code><font color="#0000FF">filter (_:)</font></code> fun√ß√£o de ordem superior <code><font color="#0000FF">filter (_:)</font></code> pega cada elemento da matriz de <code><font color="#0000FF">numbers</font></code> (representado por <code><font color="#0000FF">$0</font></code> ) e verifica se esse elemento √© um n√∫mero par.  Se esse for um n√∫mero par, os elementos da matriz de <code><font color="#0000FF">numbers</font></code> caem na nova matriz <code><font color="#0000FF">filted</font></code> , caso contr√°rio n√£o.  N√≥s, de forma declarativa, informamos ao programa o que queremos obter, em vez de nos preocuparmos com <code></code> devemos faz√™-lo. <br><br>  Vou dar outro exemplo de como usar o <code><font color="#0000FF">filter (_:)</font></code> fun√ß√£o de ordem superior <code><font color="#0000FF">filter (_:)</font></code> para obter apenas os <code><font color="#0000FF">20</font></code> primeiros n√∫meros de Fibonacci com valores <code><font color="#0000FF">&lt; 4000</font></code> : <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> fibonacci = sequence(first: (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), next: { ($<span class="hljs-number"><span class="hljs-number">1</span></span>, $<span class="hljs-number"><span class="hljs-number">0</span></span> + $<span class="hljs-number"><span class="hljs-number">1</span></span>) }) .<span class="hljs-keyword"><span class="hljs-keyword">prefix</span></span>(<span class="hljs-number"><span class="hljs-number">20</span></span>).<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>{$<span class="hljs-number"><span class="hljs-number">0.0</span></span>} .<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> {$<span class="hljs-number"><span class="hljs-number">0</span></span> % <span class="hljs-number"><span class="hljs-number">2</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; $<span class="hljs-number"><span class="hljs-number">0</span></span> &lt; <span class="hljs-number"><span class="hljs-number">4000</span></span>} <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (fibonacci) <span class="hljs-comment"><span class="hljs-comment">// [0, 2, 8, 34, 144, 610, 2584]</span></span></code> </pre><br>  Obtemos uma sequ√™ncia de tuplas que consiste em dois elementos da sequ√™ncia de Fibonacci: a n-√©sima e (n + 1) -a: <br><br><pre> <code class="swift hljs">(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>), (<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>), (<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>) ‚Ä¶</code> </pre><br>  Para processamento adicional, limitamos o n√∫mero de elementos aos vig√©simos primeiros elementos usando o <code><font color="#0000FF">prefix (20)</font></code> e <code><font color="#0000FF">0</font></code> o <code><font color="#0000FF">0</font></code> elemento da tupla formada usando o <code><font color="#0000FF">map {$0.0 }</font></code> , que corresponder√° √† sequ√™ncia de Fibonacci iniciando com <code><font color="#0000FF">0</font></code> : <br><br><pre> <code class="swift hljs"><span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">21</span></span>, <span class="hljs-number"><span class="hljs-number">34</span></span>, <span class="hljs-number"><span class="hljs-number">55</span></span>, <span class="hljs-number"><span class="hljs-number">89</span></span>, <span class="hljs-number"><span class="hljs-number">144</span></span>, <span class="hljs-number"><span class="hljs-number">233</span></span>, <span class="hljs-number"><span class="hljs-number">377</span></span>, <span class="hljs-number"><span class="hljs-number">610</span></span>, <span class="hljs-number"><span class="hljs-number">987</span></span>, <span class="hljs-number"><span class="hljs-number">1597</span></span>, <span class="hljs-number"><span class="hljs-number">2584</span></span>,...</code> </pre><br>  Poder√≠amos pegar o <code><font color="#0000FF">1</font></code> elemento da tupla formada usando o <code><font color="#0000FF">map {$0.1 }</font></code> , que corresponderia √† sequ√™ncia de Fibonacci come√ßando com <code><font color="#0000FF">1</font></code> : <br><br><pre> <code class="swift hljs"><span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">21</span></span>, <span class="hljs-number"><span class="hljs-number">34</span></span>, <span class="hljs-number"><span class="hljs-number">55</span></span>, <span class="hljs-number"><span class="hljs-number">89</span></span>, <span class="hljs-number"><span class="hljs-number">144</span></span>, <span class="hljs-number"><span class="hljs-number">233</span></span>, <span class="hljs-number"><span class="hljs-number">377</span></span>, <span class="hljs-number"><span class="hljs-number">610</span></span>, <span class="hljs-number"><span class="hljs-number">987</span></span>, <span class="hljs-number"><span class="hljs-number">1597</span></span>, <span class="hljs-number"><span class="hljs-number">2584</span></span>,...</code> </pre><br>  Obtemos os elementos necess√°rios com a ajuda do <code><font color="#0000FF">filter {$0 % 2 == 0 &amp;&amp; $0 &lt; 4000}</font></code> fun√ß√£o de ordem superior <code><font color="#0000FF">filter {$0 % 2 == 0 &amp;&amp; $0 &lt; 4000}</font></code> , que retorna uma matriz de elementos de sequ√™ncia que satisfazem o predicado especificado.  No nosso caso, ser√° uma matriz de n√∫meros inteiros <code><font color="#0000FF">[Int]</font></code> : <br><br><pre> <code class="swift hljs">[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">34</span></span>, <span class="hljs-number"><span class="hljs-number">144</span></span>, <span class="hljs-number"><span class="hljs-number">610</span></span>, <span class="hljs-number"><span class="hljs-number">2584</span></span>]</code> </pre><br>  H√° outro exemplo √∫til de uso de <code><font color="#0000FF">filter (_:)</font></code> para uma <code><font color="#0000FF">Collection</font></code> . <br><br>  Me deparei com <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">um problema real</a> quando voc√™ tem uma s√©rie de imagens que s√£o exibidas usando o <code><font color="#0000FF">CollectionView</font></code> e pode usar a tecnologia <code>Drag &amp; Drop</code> para coletar um "pacote" inteiro de imagens e mov√™-las para qualquer lugar, incluindo "dumping" para " lixeira ". <br><br><img src="https://habrastorage.org/webt/0s/-u/ks/0s-ukstskzfumukk9geirokdl-w.png"><br><br>  Nesse caso, a matriz de √≠ndices <code><font color="#0000FF">removedIndexes</font></code> despejadas na "lixeira" √© corrigida e voc√™ precisa criar uma nova matriz de imagens, excluindo aquelas cujos √≠ndices est√£o na matriz <code><font color="#0000FF">removedIndexes</font></code> .  Suponha que tenhamos uma matriz de <code><font color="#0000FF">images</font></code> inteiras que simula imagens e uma matriz de √≠ndices desses inteiros <code><font color="#0000FF">removedIndexes</font></code> que precisam ser removidos.  Usaremos o <code><font color="#0000FF">filter (_:)</font></code> para resolver nosso problema: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> images = [<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">22</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> removedIndexes = [<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> images1 = images .enumerated() .<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> { !removedIndexes.<span class="hljs-built_in"><span class="hljs-built_in">contains</span></span>($<span class="hljs-number"><span class="hljs-number">0</span></span>.offset) } .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span> { $<span class="hljs-number"><span class="hljs-number">0</span></span>.element } <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (images1) <span class="hljs-comment"><span class="hljs-comment">// [22, 14, 16, 9]</span></span></code> </pre><br>  O m√©todo <code><font color="#0000FF">enumerated()</font></code> retorna uma sequ√™ncia de tuplas que consiste em √≠ndices de <code><font color="#0000FF">offset</font></code> e valores de <code><font color="#0000FF">element</font></code> matriz.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em seguida, aplicamos um filtro </font></font><code><font color="#0000FF">filter</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√† sequ√™ncia resultante de tuplas, deixando apenas aquelas cujo √≠ndice </font></font><code><font color="#0000FF">$0.offset</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o </font><font style="vertical-align: inherit;">est√° </font><font style="vertical-align: inherit;">contido na matriz </font></font><code><font color="#0000FF">removedIndexes</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. A pr√≥xima etapa, selecionamos o valor da tupla </font></font><code><font color="#0000FF">$0.element</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e obtemos a matriz que precisamos </font></font><code><font color="#0000FF">images1</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><h2> <code><font color="#0000FF">reduce (_:, _:)</font></code> </h2> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O m√©todo </font></font><code><font color="#0000FF">reduce (_:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tamb√©m </font><font style="vertical-align: inherit;">est√° </font><font style="vertical-align: inherit;">dispon√≠vel para a maioria dos </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que est√£o dispon√≠veis </font></font><code><font color="#0000FF">map(_:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font><font style="vertical-align: inherit;">m√©todos </font></font><code><font color="#0000FF">filter (_:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">O m√©todo </font></font><code><font color="#0000FF">reduce (_:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"recolhe" a sequ√™ncia </font></font><code><font color="#0000FF">Sequence</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para um √∫nico valor acumulado e possui dois par√¢metros. </font><font style="vertical-align: inherit;">O primeiro par√¢metro √© o valor inicial da acumula√ß√£o e o segundo par√¢metro √© uma fun√ß√£o que combina o valor acumulado com o elemento de sequ√™ncia </font></font><code><font color="#0000FF">Sequence</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para obter um novo valor acumulado. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A fun√ß√£o do par√¢metro de entrada √© aplicada a cada elemento da sequ√™ncia </font></font><code><font color="#0000FF">Sequence</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, um ap√≥s o outro, at√© chegar ao final e criar o valor acumulado final.</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> sum = <span class="hljs-type"><span class="hljs-type">Array</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>...<span class="hljs-number"><span class="hljs-number">100</span></span>).<span class="hljs-built_in"><span class="hljs-built_in">reduce</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>, +)</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este √© um exemplo trivial cl√°ssico do uso de uma fun√ß√£o de ordem superior </font></font><code><font color="#0000FF">reduce (_:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- contando a soma dos elementos de uma matriz </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre> <code class="swift hljs">    <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> +<span class="hljs-number"><span class="hljs-number">1</span></span> = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span> = <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> + <span class="hljs-number"><span class="hljs-number">3</span></span> = <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> + <span class="hljs-number"><span class="hljs-number">6</span></span> = <span class="hljs-number"><span class="hljs-number">10</span></span> . . . . . . . . . . . . . . . . . . . <span class="hljs-number"><span class="hljs-number">100</span></span> <span class="hljs-number"><span class="hljs-number">4950</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span> <span class="hljs-number"><span class="hljs-number">4950</span></span> + <span class="hljs-number"><span class="hljs-number">100</span></span> = <span class="hljs-number"><span class="hljs-number">5050</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usando a fun√ß√£o, </font></font><code><font color="#0000FF">reduce (_:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">podemos calcular muito facilmente a soma dos n√∫meros de Fibonacci que atendem a uma determinada condi√ß√£o:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> fibonacci = sequence(first: (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), next: { ($<span class="hljs-number"><span class="hljs-number">1</span></span>, $<span class="hljs-number"><span class="hljs-number">0</span></span> + $<span class="hljs-number"><span class="hljs-number">1</span></span>) }) .<span class="hljs-keyword"><span class="hljs-keyword">prefix</span></span>(<span class="hljs-number"><span class="hljs-number">20</span></span>).<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>{$<span class="hljs-number"><span class="hljs-number">0.0</span></span>} .<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> {$<span class="hljs-number"><span class="hljs-number">0</span></span> % <span class="hljs-number"><span class="hljs-number">2</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; $<span class="hljs-number"><span class="hljs-number">0</span></span> &lt; <span class="hljs-number"><span class="hljs-number">4000</span></span>} <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (fibonacci) <span class="hljs-comment"><span class="hljs-comment">// [0, 2, 8, 34, 144, 610, 2584] print(fibonacci.reduce(0,+)) // 3382</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mas existem aplica√ß√µes mais interessantes de uma fun√ß√£o de ordem superior </font></font><code><font color="#0000FF">reduce (_:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por exemplo, podemos determinar de maneira muito simples e concisa um par√¢metro muito importante para </font></font><code><font color="#0000FF">UIScrollView</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- o tamanho da √°rea "rol√°vel" </font></font><code><font color="#0000FF">contentSize</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- com base em seu tamanho </font></font><code><font color="#0000FF">subviews</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> scrollView = <span class="hljs-type"><span class="hljs-type">UIScrollView</span></span>() scrollView.addSubview(<span class="hljs-type"><span class="hljs-type">UIView</span></span>(frame: <span class="hljs-type"><span class="hljs-type">CGRect</span></span>(x: <span class="hljs-number"><span class="hljs-number">300.0</span></span>, y: <span class="hljs-number"><span class="hljs-number">0.0</span></span>, width: <span class="hljs-number"><span class="hljs-number">200</span></span>, height: <span class="hljs-number"><span class="hljs-number">300</span></span>))) scrollView.addSubview(<span class="hljs-type"><span class="hljs-type">UIView</span></span>(frame: <span class="hljs-type"><span class="hljs-type">CGRect</span></span>(x: <span class="hljs-number"><span class="hljs-number">100.0</span></span>, y: <span class="hljs-number"><span class="hljs-number">0.0</span></span>, width: <span class="hljs-number"><span class="hljs-number">300</span></span>, height: <span class="hljs-number"><span class="hljs-number">600</span></span>))) scrollView.contentSize = scrollView.subviews .<span class="hljs-built_in"><span class="hljs-built_in">reduce</span></span>(<span class="hljs-type"><span class="hljs-type">CGRect</span></span>.zero,{$<span class="hljs-number"><span class="hljs-number">0</span></span>.union($<span class="hljs-number"><span class="hljs-number">1</span></span>.frame)}) .size <span class="hljs-comment"><span class="hljs-comment">// (500.0, 600.0)</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nesta demonstra√ß√£o, o valor acumulado √© </font></font><code></code> <code><font color="#0000FF">GCRect</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e a opera√ß√£o acumulativa √© a opera√ß√£o de combinar os </font></font><code><font color="#0000FF">union</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ret√¢ngulos que s√£o </font></font><code><font color="#0000FF">frame</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nossos </font></font><code><font color="#0000FF">subviews</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apesar de uma fun√ß√£o de ordem superior </font></font><code><font color="#0000FF">reduce (_:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">assumir um car√°ter acumulativo, ela pode ser usada em uma perspectiva completamente diferente. </font><font style="vertical-align: inherit;">Por exemplo, para dividir uma tupla em partes em uma matriz de tuplas:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">// Separate Tuples let arr = [("one", 1), ("two", 2), ("three", 3), ("four", 4)] let (arr1, arr2) = arr.reduce(([], [])) { ($0.0 + [$1.0], $0.1 + [$1.1]) } print(arr1) // ["one", "two", "three", "four"] print(arr2) // [1, 2, 3, 4]</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Swift </font></font><code>4.2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">introduziu um novo tipo de fun√ß√£o de ordem superior </font></font><code><font color="#0000FF">reduce (into:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">O m√©todo </font></font><code><font color="#0000FF">reduce (into:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© prefer√≠vel em efici√™ncia em compara√ß√£o com o m√©todo </font></font><code><font color="#0000FF">reduce (:, :)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se </font></font><code>COW (copy-on-write)</code> <code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, por exemplo, </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou for </font><font style="vertical-align: inherit;">usado como a estrutura resultante </font></font><code><font color="#0000FF">Dictionary</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ele pode ser usado efetivamente para remover valores correspondentes em uma matriz de n√∫meros inteiros:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">// Remove duplicates let arrayInt = [1,1,2,6,6,7,2,9,7].reduce(into: []) { !$0.contains($1) ? $0.append($1) : () } // [1, 2, 6, 7, 9]</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ... ou ao contar o n√∫mero de elementos diferentes em uma matriz: </font></font><br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">// Count equal elements in array let arrayIntCount = [1,1,2,2,6,6,7,2,9,7].reduce(into: [:]) { counts, letter in counts[letter, default: 0] += 1 } // [6: 2, 9: 1, 1: 2, 2: 3, 7: 2]</span></span></code> </pre><br><h2> <code><font color="#0000FF">flatMap (_:)</font></code> </h2> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Antes de prosseguir para esta fun√ß√£o de ordem superior, vejamos uma demonstra√ß√£o muito simples. </font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> maybeNumbers = [<span class="hljs-string"><span class="hljs-string">"42"</span></span>, <span class="hljs-string"><span class="hljs-string">"7"</span></span>, <span class="hljs-string"><span class="hljs-string">"three"</span></span>, <span class="hljs-string"><span class="hljs-string">"///4///"</span></span>, <span class="hljs-string"><span class="hljs-string">"5"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> firstNumber = maybeNumbers.<span class="hljs-built_in"><span class="hljs-built_in">map</span></span> (<span class="hljs-type"><span class="hljs-type">Int</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>).first</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se executarmos esse c√≥digo para executar </font></font><code>Playground</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, tudo parecer√° bom e o nosso </font></font><code><font color="#0000FF">firstNumber</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ser√° igual </font></font><code><font color="#0000FF">42</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/ld/wu/t6/ldwut6x-1iu4yxapphmpzcyamj4.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mas, se voc√™ n√£o souber, </font></font><code>Playground</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muitas vezes oculta o verdadeiro </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, em particular as </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">constantes </font></font><code><font color="#0000FF">firstNumber</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. De fato, a constante </font></font><code><font color="#0000FF">firstNumber</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tem </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">duas </font><font style="vertical-align: inherit;">coisas </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/v9/0k/xy/v90kxymnnsd_cxv-y4pznc0yj5s.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Isso ocorre porque, </font></font><code><font color="#0000FF">map (Int.init)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">na sa√≠da, forma uma matriz </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de valores TYPE </font></font><code><font color="#0000FF">[Int?]</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, pois nem todas as linhas </font></font><code><font color="#0000FF">String</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">podem ser convertidas </font></font><code><font color="#0000FF">Int</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e o inicializador </font></font><code><font color="#0000FF">Int.int</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est√° "caindo" ( </font></font><code>failable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). Em seguida, pegamos o primeiro elemento da matriz formada usando a fun√ß√£o </font></font><code><font color="#0000FF">first</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">da matriz </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, que tamb√©m forma a sa√≠da</font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, pois a matriz pode estar vazia e n√£o conseguiremos obter o primeiro elemento da matriz. Como resultado, temos um duplo </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ou seja </font></font><code><font color="#0000FF">Int??</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Temos uma estrutura aninhada </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">na </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qual √© realmente mais dif√≠cil trabalhar e que naturalmente n√£o queremos ter. Para obter o valor dessa estrutura aninhada, precisamos ‚Äúmergulhar‚Äù em dois n√≠veis. Al√©m disso, quaisquer transforma√ß√µes adicionais podem aprofundar </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ainda mais </font><font style="vertical-align: inherit;">o n√≠vel </font><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obter o valor do aninhado duplo √© </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">realmente oneroso. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Temos tr√™s op√ß√µes e todas elas exigem um conhecimento profundo do idioma </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><ul><li>      <code><font color="#0000FF">if let</font></code> ,       ;    ¬´¬ª ¬´¬ª <code><font color="#0000FF">Optional</font></code> ,    ‚Äî  ¬´¬ª <code><font color="#0000FF">Optional</font></code> : <br><br><img src="https://habrastorage.org/webt/dp/wa/qh/dpwaqh4oebq7cjcwy35777cnno0.png"></li><li>       <code><font color="#0000FF">if case let</font></code>      ( <code>pattern match</code> )  : <br><br><img src="https://habrastorage.org/webt/v8/a6/tg/v8a6tg2npzwpktlvjpvqxf1pa0q.png"><br><br>       <code><font color="#0000FF">??</font></code>     : <br><br><img src="https://habrastorage.org/webt/a6/ny/ia/a6nyiaeq5bds4kiewmcugwomppq.png"></li><li> ,      <code><font color="#0000FF">switch</font></code>     : <br><br><img src="https://habrastorage.org/webt/oq/dx/1s/oqdx1siedfr6cxs2lug7zasq4qg.png"></li></ul><br>   ,    ¬´¬ª <code></code>    ,    ( <code>generic</code> ) ,     <code><font color="#0000FF">map</font></code> . ,   <code><font color="#0000FF">Array</font></code> . <br><br>     . ,       <code><font color="#0000FF">multilineString</font></code> ,      ,   () : <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> multilineString = <span class="hljs-string"><span class="hljs-string">"""  ,  ,   ;     , ‚Äî  ,   :  ‚Äî   ,   .   ,   ,   .    .  ,        ,  ¬´ ¬ª  .  ,  ,   ! """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> words = multilineString.lowercased() .<span class="hljs-built_in"><span class="hljs-built_in">split</span></span>(separator: <span class="hljs-string"><span class="hljs-string">"\n"</span></span>) .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>{$<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">split</span></span>(separator: <span class="hljs-string"><span class="hljs-string">" "</span></span>)}</code> </pre><br>  ,     <code><font color="#0000FF">words</font></code> ,     ( )   ()    <code><font color="#0000FF">lowercased()</font></code> ,     c    <code><font color="#0000FF">split(separatot: "\n")</font></code>    ,    <code><font color="#0000FF">map {$0.split(separator: " ")}</font></code>       . <br><br>      : <br><br><pre> <code class="swift hljs">[[<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">";"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">"‚Äî"</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">":"</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"‚Äî"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"."</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"."</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"."</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"¬´"</span></span>, <span class="hljs-string"><span class="hljs-string">"¬ª"</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"."</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"!"</span></span>]]</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... e </font></font><code><font color="#0000FF">words</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tem um </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">duplo </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/b0/kc/y3/b0kcy3vh-dkhtw6ytrmk7fe_cbk.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">novamente temos uma estrutura de dados "aninhada", mas desta vez n√£o temos </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mas </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Se quisermos continuar processando as palavras recebidas </font></font><code><font color="#0000FF">words</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, por exemplo, para encontrar o espectro de letras desse texto com v√°rias linhas, primeiro teremos que "endireitar" de maneira alguma a matriz da dupla </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e transform√°-la em uma √∫nica matriz </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Isso √© semelhante ao que fizemos com o dobro </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de uma demonstra√ß√£o no in√≠cio desta se√ß√£o </font></font><code><font color="#0000FF">flatMap</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> maybeNumbers = [<span class="hljs-string"><span class="hljs-string">"42"</span></span>, <span class="hljs-string"><span class="hljs-string">"7"</span></span>, <span class="hljs-string"><span class="hljs-string">"three"</span></span>, <span class="hljs-string"><span class="hljs-string">"///4///"</span></span>, <span class="hljs-string"><span class="hljs-string">"5"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> firstNumber = maybeNumbers.<span class="hljs-built_in"><span class="hljs-built_in">map</span></span> (<span class="hljs-type"><span class="hljs-type">Int</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>).first</code> </pre><br>    <code>Swift</code>        . <code>Swift</code>        <code><font color="#0000FF">Array</font></code>  <code><font color="#0000FF">Optional</font></code> .     <code><font color="#0000FF">flatMap</font></code> !     <code><font color="#0000FF">map</font></code> ,      ,    ¬´¬ª ¬´¬ª,     <code><font color="#0000FF">map</font></code> .      <code><font color="#0000FF">flatMap</font></code> ,  ¬´¬ª ( <code>flattens</code> )  <code><font color="#0000FF">map</font></code> . <br><br>    <code><font color="#0000FF">flatMap</font></code>  <code><font color="#0000FF">firstNumber</font></code> : <br><br><img src="https://habrastorage.org/webt/l7/1g/ag/l71gagrp7qtfvn-9nae3ofbmlb0.png"><br><br>       c   <code><font color="#0000FF">Optional</font></code> . <br><br>   <code><font color="#0000FF">flatMap</font></code>    <code><font color="#0000FF">Array</font></code> .     <code><font color="#0000FF">words</font></code>    <code><font color="#0000FF">map</font></code>  <code><font color="#0000FF">flatMap</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/zh/t9/bm/zht9bmajklq5ybm4xxpigddrrma.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... e acabamos de obter uma matriz de palavras </font></font><code><font color="#0000FF">words</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sem nenhum "aninhamento":</font></font><br><br><pre> <code class="swift hljs">[<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">";"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">"‚Äî"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">":"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"‚Äî"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"."</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"."</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"."</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"¬´"</span></span>, <span class="hljs-string"><span class="hljs-string">"¬ª"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"."</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"!"</span></span>]</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agora podemos continuar o processamento que precisamos da matriz de palavras resultante </font></font><code><font color="#0000FF">words</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mas tenha cuidado. </font><font style="vertical-align: inherit;">Se o aplicarmos novamente </font></font><code><font color="#0000FF">flatMap</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a cada elemento da matriz </font></font><code><font color="#0000FF">words</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, obteremos, talvez, um resultado inesperado, mas bastante compreens√≠vel. </font></font><br><br><img src="https://habrastorage.org/webt/vw/iq/jd/vwiqjd_y3ambrq0w8e-r9dnjpl4.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Temos uma √∫nica matriz, n√£o "aninhada", de letras e s√≠mbolos </font></font><code><font color="#0000FF">[Character]</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contidos em nossa frase de v√°rias linhas:</font></font><br><br><pre> <code class="swift hljs">[<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">";"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, ...]</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O fato √© que a string </font></font><code><font color="#0000FF">String</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© uma cole√ß√£o de </font></font><code><font color="#0000FF">Collection</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">caracteres </font></font><code><font color="#0000FF">[Character]</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e, aplicando-se </font></font><code><font color="#0000FF">flatMap</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a cada palavra individual, abaixamos novamente o n√≠vel de "aninhamento" e chegamos a uma variedade de caracteres </font></font><code><font color="#0000FF">flattenCharacters</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Talvez seja exatamente isso que voc√™ deseja ou talvez n√£o. </font><font style="vertical-align: inherit;">Preste aten√ß√£o nisso.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Juntando tudo: resolvendo alguns problemas </font></font></h2><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> TAREFA 1 </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Podemos continuar o processamento que precisamos da matriz de palavras obtida na se√ß√£o anterior </font></font><code><font color="#0000FF">words</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e calcular a frequ√™ncia de ocorr√™ncia de letras em nossa frase de v√°rias linhas. </font><font style="vertical-align: inherit;">Para come√ßar, vamos "colar" todas as palavras da matriz </font></font><code><font color="#0000FF">words</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em uma linha grande e excluir todos os sinais de pontua√ß√£o, ou seja, deixe apenas as letras:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> wordsString = words.<span class="hljs-built_in"><span class="hljs-built_in">reduce</span></span> (<span class="hljs-string"><span class="hljs-string">""</span></span>,+).<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> { <span class="hljs-string"><span class="hljs-string">""</span></span> .<span class="hljs-built_in"><span class="hljs-built_in">contains</span></span>($<span class="hljs-number"><span class="hljs-number">0</span></span>)} <span class="hljs-comment"><span class="hljs-comment">// </span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ent√£o, n√≥s temos todas as letras que precisamos. </font><font style="vertical-align: inherit;">Agora vamos fazer um dicion√°rio deles, onde a chave </font></font><code><font color="#0000FF">key</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© a letra e o valor </font></font><code><font color="#0000FF">value</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© a frequ√™ncia de sua ocorr√™ncia no texto. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Podemos fazer isso de duas maneiras. </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O primeiro m√©todo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est√° associado ao uso de uma nova </font></font><code>Swift 4.2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">variedade de uma fun√ß√£o de ordem superior </font><font style="vertical-align: inherit;">que apareceu </font></font><code><font color="#0000FF">reduce (into:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Este m√©todo √© bastante adequado para organizarmos um dicion√°rio </font></font><code><font color="#0000FF">letterCount</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com a frequ√™ncia de ocorr√™ncia de letras em nossa frase de v√°rias linhas:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> letterCount = wordsString.<span class="hljs-built_in"><span class="hljs-built_in">reduce</span></span>(into: [:]) { counts, letter <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> counts[letter, <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>] += <span class="hljs-number"><span class="hljs-number">1</span></span>} <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (letterCount) <span class="hljs-comment"><span class="hljs-comment">// ["": 1, "": 18, "": 2, "": 2, "": 5, "": 7, "": 17, "": 4, "": 23, ...]</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como resultado, obteremos um dicion√°rio </font></font><code><font color="#0000FF">letterCount</font></code> <code></code> <code><font color="#0000FF">[Character : Int]</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no qual as chaves </font></font><code><font color="#0000FF">key</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s√£o os caracteres encontrados na frase em estudo e como o valor </font></font><code><font color="#0000FF">value</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© o n√∫mero desses caracteres. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O segundo m√©todo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> envolve inicializar o dicion√°rio usando o agrupamento, que fornece o mesmo resultado:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> letterCountDictionary = <span class="hljs-type"><span class="hljs-type">Dictionary</span></span>(grouping: wordsString ){ $<span class="hljs-number"><span class="hljs-number">0</span></span>}.mapValues {$<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>} letterCount == letterCountDictionary <span class="hljs-comment"><span class="hljs-comment">// true</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gostar√≠amos de classificar o dicion√°rio em </font></font><code><font color="#0000FF">letterCount</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ordem alfab√©tica:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> lettersStat = letterCountDictionary .sorted(by: &lt;) .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>{<span class="hljs-string"><span class="hljs-string">"\($0.0):\($0.1)"</span></span>} <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (lettersStat) <span class="hljs-comment"><span class="hljs-comment">// [":17", ":5", ":18", ":4", ":8", ":35", ":3", ":4", ":18", ":5", ":2", ":10", ":4", ":26", ":34", ":5", ":7", ":23", ":25", ":4", ":2", ":3", ":4", ":2", ":1", ":14", ":2", ":4"]</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mas n√£o podemos classificar o dicion√°rio diretamente </font></font><code><font color="#0000FF">Dictionary</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, pois n√£o √© fundamentalmente uma estrutura de dados ordenada. Se aplicarmos a fun√ß√£o </font></font><code><font color="#0000FF">sorted (by:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ao dicion√°rio </font></font><code><font color="#0000FF">Dictionary</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ele retornar√° para n√≥s os elementos da sequ√™ncia classificada com o predicado fornecido na forma de uma matriz de tuplas nomeadas, que </font></font><code><font color="#0000FF">map</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">transformamos em uma matriz de seq√º√™ncias de caracteres que </font></font><code><font color="#0000FF">[":17", ":5", ":18", ...]</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">refletem a frequ√™ncia de ocorr√™ncia da letra correspondente. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vemos que desta vez </font></font><code><font color="#0000FF">sorted (by:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apenas o operador " </font></font><code><font color="#0000FF">&lt;</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font><font style="vertical-align: inherit;">√© passado </font><font style="vertical-align: inherit;">como predicado para uma fun√ß√£o de </font><font style="vertical-align: inherit;">ordem </font><font style="vertical-align: inherit;">superior </font><font style="vertical-align: inherit;">. A fun√ß√£o </font></font><code><font color="#0000FF">sorted (by:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">espera uma "fun√ß√£o de compara√ß√£o" como o √∫nico argumento na entrada. √â usado para comparar dois valores adjacentes e decidir se eles est√£o ordenados corretamente (neste caso, retorna</font></font><code><font color="#0000FF">true</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) ou n√£o (retorna </font></font><code><font color="#0000FF">false</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font><font style="vertical-align: inherit;">Podemos atribuir a essa "fun√ß√£o de compara√ß√£o" fun√ß√µes </font></font><code><font color="#0000FF">sorted (by:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">na forma de um fechamento an√¥nimo:</font></font><br><br><pre> <code class="swift hljs">sorted(by: {$<span class="hljs-number"><span class="hljs-number">0</span></span>.key &lt; $<span class="hljs-number"><span class="hljs-number">1</span></span>.key}</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E podemos apenas fornecer o operador " </font></font><code><font color="#0000FF">&lt;</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">", que possui a assinatura de que precisamos, como foi feito acima. </font><font style="vertical-align: inherit;">Essa tamb√©m √© uma fun√ß√£o e a classifica√ß√£o por chave est√° em andamento </font></font><code><font color="#0000FF">key</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se queremos classificar o dicion√°rio por valores </font></font><code><font color="#0000FF">value</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e descobrir quais letras s√£o mais frequentemente encontradas nesta frase, teremos que usar o fechamento da fun√ß√£o </font></font><code><font color="#0000FF">sorted (by:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> countsStat = letterCountDictionary .sorted(by: {$<span class="hljs-number"><span class="hljs-number">0</span></span>.value &gt; $<span class="hljs-number"><span class="hljs-number">1</span></span>.value}) .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>{<span class="hljs-string"><span class="hljs-string">"\($0.0):\($0.1)"</span></span>} <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (countsStat ) <span class="hljs-comment"><span class="hljs-comment">//[":35", ":34", ":26", ":25", ":23", ":18", ":18", ":17", ":14", ":10", ":8", ":7", ":5", ":5", ":5", ":4", ":4", ":4", ":4", ":4", ":4", ":3", ":3", ":2", ":2", ":2", ":2", ":1"]</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Se dermos uma olhada na solu√ß√£o para o problema de determinar o espectro de letras de uma frase multilinha como um todo ... </font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> multilineString = <span class="hljs-string"><span class="hljs-string">"""  ,  ,   ;     , ‚Äî  ,   :  ‚Äî   ,   .   ,   ,   .    .  ,        ,  ¬´ ¬ª  .  ,  ,   ! """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> words = multilineString.lowercased() .<span class="hljs-built_in"><span class="hljs-built_in">split</span></span>(separator: <span class="hljs-string"><span class="hljs-string">"\n"</span></span>) .flatMap{$<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">split</span></span>(separator: <span class="hljs-string"><span class="hljs-string">" "</span></span>)} <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> wordsString = words.<span class="hljs-built_in"><span class="hljs-built_in">reduce</span></span> (<span class="hljs-string"><span class="hljs-string">""</span></span>,+).<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> { <span class="hljs-string"><span class="hljs-string">""</span></span> .<span class="hljs-built_in"><span class="hljs-built_in">contains</span></span>($<span class="hljs-number"><span class="hljs-number">0</span></span>)} <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> letterCount = wordsString.<span class="hljs-built_in"><span class="hljs-built_in">reduce</span></span>(into: [:]) { counts, letter <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> counts[letter, <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>] += <span class="hljs-number"><span class="hljs-number">1</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> lettersStat = letterCountDictionary .sorted(by: &lt;) .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>{<span class="hljs-string"><span class="hljs-string">"\($0.0):\($0.1)"</span></span>} <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (lettersStat) <span class="hljs-comment"><span class="hljs-comment">// [":17", ":5", ":18", ":4", ":8", ":35", ":3", ":4", ":18", ":5", ":2", ":10", ":4", ":26", ":34", ":5", ":7", ":23", ":25", ":4", ":2", ":3", ":4", ":2", ":1", ":14", ":2", ":4"] let countsStat = letterCountDictionary .sorted(by: {$0.value &gt; $1.value}) .map{"\($0.0):\($0.1)"} print (countsStat ) //[":35", ":34", ":26", ":25", ":23", ":18", ":18", ":17", ":14", ":10", ":8", ":7", ":5", ":5", ":5", ":4", ":4", ":4", ":4", ":4", ":4", ":3", ":3", ":2", ":2", ":2", ":2", ":1"]</span></span></code> </pre><br> ‚Ä¶   ,         ( <code><font color="#0000FF">var</font></code> ,  <code><font color="#0000FF">let)</font></code>        ()   ,     ,    : <br><br> <code><font color="#0000FF">split</font></code> - , <br> <code><font color="#0000FF">map</font></code> ‚Äî  <br> <code><font color="#0000FF">flatMap</font></code> -    (   ), <br> <code><font color="#0000FF">filter</font></code> - , <br> <code><font color="#0000FF">sorted</font></code> - , <br> <code><font color="#0000FF">reduce</font></code> -          <br><br>          ,   .     ¬´¬ª ,   <code><font color="#0000FF">map</font></code> ,         ,   <code><font color="#0000FF">flatMap</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, se quisermos selecionar apenas determinados dados, usaremos </font></font><code><font color="#0000FF">filter</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">etc. Todas essas fun√ß√µes de "ordem mais alta" s√£o projetadas e testadas </font></font><code>Apple</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">levando em considera√ß√£o a otimiza√ß√£o do desempenho. Portanto, esse trecho de c√≥digo √© muito confi√°vel e conciso - n√£o precis√°vamos de mais de cinco frases para resolver nosso problema. Este √© um exemplo de programa√ß√£o funcional. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A √∫nica desvantagem da aplica√ß√£o da abordagem funcional nesta demonstra√ß√£o √© que, por uma quest√£o de imutabilidade, testabilidade e legibilidade, perseguimos repetidamente nosso texto por v√°rias fun√ß√µes de ordem superior. No caso de um grande n√∫mero de itens de cole√ß√£o, o </font></font><code><font color="#0000FF">Collection</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">desempenho pode despencar. Por exemplo, se usarmos primeiro </font></font><code><font color="#0000FF">filter(_:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e, e depois - </font></font><code><font color="#0000FF">first</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em</font></font><code>Swift 4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Algumas novas op√ß√µes de recursos foram adicionadas para melhorar o desempenho, e aqui est√£o algumas dicas para escrever c√≥digo mais r√°pido. </font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Use </font></font><code><font color="#0000FF">contains</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, N√ÉO</font></font><code><font color="#0000FF">first( where: ) != nil</font></code> </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A verifica√ß√£o de que um objeto est√° em uma cole√ß√£o </font></font><code><font color="#0000FF">Collection</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pode ser feita de v√°rias maneiras. </font><font style="vertical-align: inherit;">O melhor desempenho √© fornecido pela fun√ß√£o </font></font><code><font color="#0000FF">contains</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C√ìDIGO CORRETO</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> numbers = [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>] numbers.<span class="hljs-built_in"><span class="hljs-built_in">contains</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C√ìDIGO INCORRETO </font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> numbers = [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>] numbers.<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> { number <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> number == <span class="hljs-number"><span class="hljs-number">1</span></span> }.isEmpty == <span class="hljs-literal"><span class="hljs-literal">false</span></span> numbers.first(<span class="hljs-keyword"><span class="hljs-keyword">where</span></span>: { number <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> number == <span class="hljs-number"><span class="hljs-number">1</span></span> }) != <span class="hljs-literal"><span class="hljs-literal">nil</span></span></code> </pre><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Use valida√ß√£o </font></font><code><font color="#0000FF">isEmpty</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, N√ÉO uma compara√ß√£o </font></font><code><font color="#0000FF">count</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com zero</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como em algumas cole√ß√µes, o acesso √† propriedade </font></font><code><font color="#0000FF">count</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© realizado atrav√©s da itera√ß√£o sobre todos os elementos da cole√ß√£o. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C√ìDIGO CORRETO</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> numbers = [] numbers.isEmpty</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C√ìDIGO INCORRETO </font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> numbers = [] numbers.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Verifique a string vazia </font></font><code><font color="#0000FF">String</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com</font></font><code><font color="#0000FF">isEmpty</font></code> </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">String </font></font><code><font color="#0000FF">String</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© uma cole√ß√£o de caracteres </font></font><code><font color="#0000FF">[Character]</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Isso significa que para strings </font></font><code><font color="#0000FF">String</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tamb√©m </font><font style="vertical-align: inherit;">√© </font><font style="vertical-align: inherit;">melhor usar </font></font><code><font color="#0000FF">isEmpty</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C√ìDIGO CORRETO</font></font><br><br><pre> <code class="swift hljs">myString.isEmpty</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C√ìDIGO INCORRETO </font></font><br><br><pre> <code class="swift hljs">myString == <span class="hljs-string"><span class="hljs-string">""</span></span> myString.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 4. Obten√ß√£o do primeiro elemento que satisfaz certas condi√ß√µes </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A itera√ß√£o de toda a cole√ß√£o para obter o primeiro objeto que satisfaz determinadas condi√ß√µes pode ser executada usando um m√©todo </font></font><code><font color="#0000FF">filter</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seguido por um m√©todo </font></font><code><font color="#0000FF">first</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mas o </font><font style="vertical-align: inherit;">m√©todo </font><font style="vertical-align: inherit;">√© o melhor em termos de velocidade </font></font><code><font color="#0000FF">first (where:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Esse m√©todo para de percorrer a cole√ß√£o assim que ela atende √†s condi√ß√µes necess√°rias. </font><font style="vertical-align: inherit;">O m√©todo </font></font><code><font color="#0000FF">filter</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">continuar√° a percorrer toda a cole√ß√£o, independentemente de ter atendido aos elementos necess√°rios ou n√£o. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obviamente, o mesmo vale para o m√©todo </font></font><code><font color="#0000FF">last (where:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C√ìDIGO CORRETO</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> numbers = [<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, -<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, -<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> firstNegative = numbers.first(<span class="hljs-keyword"><span class="hljs-keyword">where</span></span>: { $<span class="hljs-number"><span class="hljs-number">0</span></span> &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> })</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C√ìDIGO INCORRETO </font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> numbers = [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> allEven = numbers.<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> { $<span class="hljs-number"><span class="hljs-number">0</span></span> % <span class="hljs-number"><span class="hljs-number">2</span></span> != <span class="hljs-number"><span class="hljs-number">0</span></span> }.isEmpty</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Äs vezes, quando a cole√ß√£o </font></font><code><font color="#0000FF">Collection</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© muito grande e o desempenho √© cr√≠tico para voc√™, vale a pena comparar as abordagens imperativas e funcionais e escolher a que mais lhe conv√©m.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> TAREFA 2 </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H√° outro √≥timo exemplo de um uso muito conciso de uma fun√ß√£o de ordem superior </font></font><code><font color="#0000FF">reduce (_:, _:)</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que me deparei. Este √© um jogo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SET</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqui est√£o suas regras b√°sicas. O nome do jogo </font></font><code>SET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vem da palavra em ingl√™s "set" - "set". O jogo </font></font><code>SET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">envolve 81 cartas, cada uma com uma imagem √∫nica: </font></font><br><br><img src="https://habrastorage.org/webt/ho/tg/rr/hotgrrs2vjmbgdyuxo0l4if6fai.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cada carta possui 4 atributos, listados abaixo: </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quantidade</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : cada carta possui um, dois ou tr√™s caracteres. </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tipo de caracteres</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : ovais, losangos ou ondas. </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : os s√≠mbolos podem ser vermelhos, verdes ou roxos. </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Preenchimento</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : os caracteres podem estar vazios, sombreados ou sombreados. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Objetivo do jogo</font></font><code>SET</code> :  12 ,   ,   <code>SET</code> (),   3- ,        ,      3- .       . <br><br> ,     3-     ,  ,    3-     ,  ,   ‚Ä¶ <br><br>          <code>SET</code> <code><font color="#0000FF">struct SetCard</font></code>    <code>SET</code>  3-  <code><font color="#0000FF">isSet( cards:[SetCard])</font></code> : <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SetCard</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Equatable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> number: <span class="hljs-type"><span class="hljs-type">Variant</span></span> <span class="hljs-comment"><span class="hljs-comment">// number - 1, 2, 3 let color: Variant // color - 1, 2, 3 (, , , ) let shape: Variant // symbol - 1, 2, 3 (, , , ) let fill: Variant // fill - 1, 2, 3 (, , , ) enum Variant: Int, CaseIterable { case v1 = 1 case v2 case v3 } static func isSet(cards: [SetCard]) -&gt; Bool { guard cards.count == 3 else {return false} let sums = [ cards.reduce(0, { $0 + $1.number.rawValue }), cards.reduce(0, { $0 + $1.color.rawValue }), cards.reduce(0, { $0 + $1.shape.rawValue }), cards.reduce(0, { $0 + $1.fill.rawValue }) ] return sums.reduce(true, { $0 &amp;&amp; ($1 % 3 == 0) }) } }</span></span></code> </pre><br>     ‚Äî <i></i> <code><font color="#0000FF">number</font></code> , <i> </i> <code><font color="#0000FF">shape</font></code> , <i></i> <code><font color="#0000FF">color</font></code>  <i></i> <code><font color="#0000FF">fill</font></code> ‚Äî   <code><font color="#0000FF">Variant</font></code> ,  3  : <code><font color="#0000FF">var1</font></code> , <code><font color="#0000FF">var2</font></code>  <code><font color="#0000FF">var3</font></code> ,   3-   <code><font color="#0000FF">rawValue</font></code> ‚Äî <code><font color="#0000FF">1,2,3</font></code> .     <code><font color="#0000FF">rawValue</font></code>  .    - , , <code><font color="#0000FF">color</font></code> ,    <code><font color="#0000FF">rawValue</font></code>  <code><font color="#0000FF">colors</font></code> 3- ,  ,   <code><font color="#0000FF">colors</font></code>   3-  ,     <code><font color="#0000FF">3</font></code> , <code><font color="#0000FF">6</font></code>  <code><font color="#0000FF">9</font></code> ,      ,     <code><font color="#0000FF">6</font></code> .           3-  <code><font color="#0000FF">rawValue</font></code>  <code><font color="#0000FF">colors</font></code>  3- .  ,       ,  3   <code>SET</code> .  ,  3    <code>SET</code> ,     <code><font color="#0000FF">SetCard</font></code> -  <code><font color="#0000FF">number</font></code> ,   <code><font color="#0000FF">shape</font></code> ,  <code><font color="#0000FF">color</font></code>   <code><font color="#0000FF">fill</font></code> ‚Äî   <code><font color="#0000FF">rawValue</font></code>   3-. <br><br>   <code><font color="#0000FF">static</font></code>  <code><font color="#0000FF">isSet( cards:[SetCard])</font></code>     <code><font color="#0000FF">sums</font></code>  <code><font color="#0000FF">rawValue</font></code>   3-     4-        <code><font color="#0000FF">reduce</font></code>   ,  <code><font color="#0000FF">0</font></code> ,    <code><font color="#0000FF">{$0 + $1.number.rawValue}</font></code> , <code><font color="#0000FF">{$0 + $1.color.rawValue}</font></code> , <code><font color="#0000FF">{$0 + $1.shape.rawValue}</font></code> , <code><font color="#0000FF">{ {$0 + $1.fill.rawValue}</font></code> .    <code><font color="#0000FF">sums</font></code>    3-,      <code><font color="#0000FF">reduce</font></code> ,       ,  <code><font color="#0000FF">true</font></code>     " <code>AND</code> " <code><font color="#0000FF">{$0 &amp;&amp; ($1 % 3) == 0}</font></code> .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Swift 5</a>         <code><font color="#0000FF">isMultiply(of:)</font></code>   <code><font color="#0000FF">%</font></code>   .      : <code><font color="#0000FF">{ $0 &amp;&amp; ($1.isMultiply(of:3) }</font></code> . <br><br>       ,   3 <code><font color="#0000FF">SetCard</font></code>  <code>SET</code> -,   " <i></i> " ,         <code>Playground</code> : <br><br><img src="https://habrastorage.org/webt/9y/cg/6e/9ycg6e0hzi_kfdc4kvsnd0cnjsy.png"><br><br>      <code>SET</code>     ( <code>UI</code> )   <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"></a></b> , <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"></a></b>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"></a></b> . <br><br><h2>      </h2><br>     .               .       ,       (,  )       (, ).     . <br><br>    <code>Swift</code>     <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">point.free</a></b>     <b>" <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Functions</a> "</b>  <b>" <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Side Effects</a> "</b> ,         <b>" <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"></a> "</b>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">¬´ ¬ª</a></b> . <br><br><h2>   </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em um sentido matem√°tico, isso significa aplicar uma fun√ß√£o ao resultado de outra fun√ß√£o. Em uma </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fun√ß√£o, eles podem retornar um valor que voc√™ pode usar como entrada para outra fun√ß√£o. Esta √© uma pr√°tica de programa√ß√£o comum. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Imagine que temos uma matriz de n√∫meros inteiros e queremos obter uma matriz de quadrados de n√∫meros pares √∫nicos na sa√≠da. Normalmente, reimplementamos isso da seguinte maneira:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> integerArray = [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unique</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> array: [Int])</span></span></span></span> -&gt; [<span class="hljs-type"><span class="hljs-type">Int</span></span>] { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> array.<span class="hljs-built_in"><span class="hljs-built_in">reduce</span></span>(into: [], { (results, element) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> !results.<span class="hljs-built_in"><span class="hljs-built_in">contains</span></span>(element) { results.append(element) } }) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">even</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> array: [Int])</span></span></span></span> -&gt; [<span class="hljs-type"><span class="hljs-type">Int</span></span>] { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> array.<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span>{ $<span class="hljs-number"><span class="hljs-number">0</span></span>%<span class="hljs-number"><span class="hljs-number">2</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span>} } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">square</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> array: [Int])</span></span></span></span> -&gt; [<span class="hljs-type"><span class="hljs-type">Int</span></span>] { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> array.<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>{ $<span class="hljs-number"><span class="hljs-number">0</span></span>*$<span class="hljs-number"><span class="hljs-number">0</span></span> } } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> array = square(even(unique(integerArray))) <span class="hljs-comment"><span class="hljs-comment">// it returns [4, 16, 36, 64]</span></span></code> </pre><br>      ,   ,         .    ( )  ,     ( )     .             ‚Äî   <code><font color="#0000FF">inegerArray</font></code> ,          <code><font color="#0000FF">unique</font></code> ,        ‚Äî  <code><font color="#0000FF">even</font></code> , ,     <code><font color="#0000FF">square</font></code> . <br><br>        ¬´¬ª  <code><font color="#0000FF">&gt;&gt;&gt;</font></code>  <code><font color="#0000FF">|&gt;</font></code> ,         ,     <code><font color="#0000FF">integerArray</font></code>   ¬´¬ª : <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> array1 = integerArray |&gt; unique &gt;&gt;&gt; even &gt;&gt;&gt; square</code> </pre><br>         <code>F#</code> , <code>Elixir</code>  <code>Elm</code>     ¬´¬ª . <br><br>  <code>Swift</code>    ¬´¬ª  <code><font color="#0000FF">&gt;&gt;&gt;</font></code>  <code><font color="#0000FF">|&gt;</font></code> ,          <code>Generics</code> ,  ( <code>closure</code> )  <code><font color="#0000FF">infix</font></code> : <br><br><pre> <code class="swift hljs">precedencegroup <span class="hljs-type"><span class="hljs-type">ForwardComposition</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">associativity</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">left</span></span> higherThan: <span class="hljs-type"><span class="hljs-type">ForwardApplication</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">infix</span></span> <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> &gt;&gt;&gt; : <span class="hljs-type"><span class="hljs-type">ForwardComposition</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> &gt;&gt;&gt; &lt;A, B, C&gt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">left</span></span></span></span><span class="hljs-function"><span class="hljs-params">: @escaping </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(A)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">B</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">right</span></span>: @escaping (<span class="hljs-type"><span class="hljs-type">B</span></span>) -&gt; <span class="hljs-type"><span class="hljs-type">C</span></span>) -&gt; (<span class="hljs-type"><span class="hljs-type">A</span></span>) -&gt; <span class="hljs-type"><span class="hljs-type">C</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">right</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">left</span></span>($<span class="hljs-number"><span class="hljs-number">0</span></span>)) } } precedencegroup <span class="hljs-type"><span class="hljs-type">ForwardApplication</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">associativity</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">left</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">infix</span></span> <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> |&gt; : <span class="hljs-type"><span class="hljs-type">ForwardApplication</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> |&gt; &lt;A, B&gt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a: A, f: </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(A)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">B</span></span>) -&gt; <span class="hljs-type"><span class="hljs-type">B</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> f(a) }</code> </pre><br>    ,        ,     . ,    <code><font color="#0000FF">map</font></code>         ¬´¬ª <code><font color="#0000FF">&gt;&gt;&gt;</font></code>  ,      <code><font color="#0000FF">map</font></code> : <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> integerArray1 = [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> b = integerArray1.<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>( { $<span class="hljs-number"><span class="hljs-number">0</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span> } &gt;&gt;&gt; { $<span class="hljs-number"><span class="hljs-number">0</span></span> * <span class="hljs-number"><span class="hljs-number">3</span></span> } &gt;&gt;&gt; <span class="hljs-type"><span class="hljs-type">String</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (b) <span class="hljs-comment"><span class="hljs-comment">// ["6", "9", "12", "15", "18", "21", "24", "27", "30", "6", "15", "18"]</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mas nem sempre uma abordagem funcional produz um efeito positivo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No in√≠cio, quando apareceu </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em 2014, todos correram para escrever bibliotecas com operadores para "composi√ß√£o" de fun√ß√µes e resolver uma tarefa dif√≠cil para a √©poca, como analisar </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usando operadores de programa√ß√£o funcional em vez de usar constru√ß√µes infinitamente aninhadas </font></font><code><font color="#0000FF">if let</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Eu mesmo traduzi o </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artigo sobre a an√°lise funcional do JSON que</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> me encantou com sua solu√ß√£o elegante </font><font style="vertical-align: inherit;">e era f√£ da biblioteca </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Argo</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mas os desenvolvedores </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seguiram um caminho completamente diferente e propuseram, com base na tecnologia orientada a protocolos, uma maneira muito mais concisa de escrever c√≥digo. Para "entregar" os </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dados diretamente ao</font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O suficiente para fazer isso </font></font><code></code> <code><font color="#0000FF">Codable</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, que implementa automaticamente este protocolo, se o seu modelo √© composto pelas conhecidas </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">estruturas de dados: </font></font><code><font color="#0000FF">String</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">Int</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">URL</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">Array</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><font color="#0000FF">Dictionary</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, etc.</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Blog</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Codable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> id: <span class="hljs-type"><span class="hljs-type">Int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> name: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> url: <span class="hljs-type"><span class="hljs-type">URL</span></span> }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tendo </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dados desse </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">famoso artigo</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ...</font></font><br><pre> <code class="swift hljs">[ { <span class="hljs-string"><span class="hljs-string">"id"</span></span> : <span class="hljs-number"><span class="hljs-number">73</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span> : <span class="hljs-string"><span class="hljs-string">"Bloxus test"</span></span>, <span class="hljs-string"><span class="hljs-string">"url"</span></span> : <span class="hljs-string"><span class="hljs-string">"http://remote.bloxus.com/"</span></span> }, { <span class="hljs-string"><span class="hljs-string">"id"</span></span> : <span class="hljs-number"><span class="hljs-number">74</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span> : <span class="hljs-string"><span class="hljs-string">"Manila Test"</span></span>, <span class="hljs-string"><span class="hljs-string">"url"</span></span> : <span class="hljs-string"><span class="hljs-string">"http://flickrtest1.userland.com/"</span></span> } ]</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... no momento, voc√™ s√≥ precisa de uma linha de c√≥digo para obter uma variedade de blogs </font></font><code><font color="#0000FF">blogs</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> blogs = <span class="hljs-type"><span class="hljs-type">Bundle</span></span>.main.path(forResource: <span class="hljs-string"><span class="hljs-string">"blogs"</span></span>, ofType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>) .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>(<span class="hljs-type"><span class="hljs-type">URL</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(fileURLWithPath:)) .flatMap { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">Data</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(contentsOf: $<span class="hljs-number"><span class="hljs-number">0</span></span>) } .flatMap { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">JSONDecoder</span></span>().decode([<span class="hljs-type"><span class="hljs-type">Blog</span></span>].<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, from: $<span class="hljs-number"><span class="hljs-number">0</span></span>) } <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (<span class="hljs-string"><span class="hljs-string">"\(blogs!)"</span></span>) <span class="hljs-comment"><span class="hljs-comment">// [id: 73 name: Bloxus test url: http://remote.bloxus.com/, // id: 74 name: Manila Test url: http://flickrtest1.userland.com/]</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Todo mundo se esqueceu com seguran√ßa de usar os operadores da "composi√ß√£o" de fun√ß√µes para analisar </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, se houver outra maneira mais compreens√≠vel e f√°cil de fazer isso usando protocolos. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se tudo √© t√£o f√°cil, podemos "enviar" </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dados para modelos mais complexos. </font><font style="vertical-align: inherit;">Suponha que tenhamos um arquivo de </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dados que tenha um nome </font></font><code>user.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e esteja localizado em nosso diret√≥rio.Ele </font></font><code>Resources.</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cont√©m dados sobre um determinado usu√°rio:</font></font><br><br><pre> <code class="swift hljs">{ <span class="hljs-string"><span class="hljs-string">"email"</span></span>: <span class="hljs-string"><span class="hljs-string">"blob@pointfree.co"</span></span>, <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">42</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Blob"</span></span> }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E temos um </font></font><code><font color="#0000FF">Codable</font></code> <code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usu√°rio </font></font><code><font color="#0000FF">User</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com um inicializador a partir dos dados </font></font><code><font color="#0000FF">json</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Codable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> email: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> id: <span class="hljs-type"><span class="hljs-type">Int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> name: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>?(json: <span class="hljs-type"><span class="hljs-type">Data</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> newValue = <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">JSONDecoder</span></span>().decode(<span class="hljs-type"><span class="hljs-type">User</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, from: json) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> = newValue } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span> } } }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Podemos facilmente obter um novo usu√°rio </font></font><code><font color="#0000FF">newUser</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com um c√≥digo funcional ainda mais simples:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> newUser = <span class="hljs-type"><span class="hljs-type">Bundle</span></span>.main.path(forResource: <span class="hljs-string"><span class="hljs-string">"user"</span></span>, ofType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>) .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>(<span class="hljs-type"><span class="hljs-type">URL</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(fileURLWithPath:)) .flatMap { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">Data</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(contentsOf: $<span class="hljs-number"><span class="hljs-number">0</span></span>) } .flatMap { <span class="hljs-type"><span class="hljs-type">User</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(json: $<span class="hljs-number"><span class="hljs-number">0</span></span>) }</code> </pre><br> ,   <code><font color="#0000FF">newUser</font></code>  <code><font color="#0000FF">Optional</font></code> ,   <code><font color="#0000FF">User?</font></code> : <br><br><img src="https://habrastorage.org/webt/ws/hp/ba/wshpbajpp-wrpb00sxusmhycttk.png"><br><br> ,      <code>Resources</code>       <code>invoices.json</code>         . <br><br><pre> <code class="swift hljs">[ { <span class="hljs-string"><span class="hljs-string">"amountPaid"</span></span>: <span class="hljs-number"><span class="hljs-number">1000</span></span>, <span class="hljs-string"><span class="hljs-string">"amountDue"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"closed"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }, { <span class="hljs-string"><span class="hljs-string">"amountPaid"</span></span>: <span class="hljs-number"><span class="hljs-number">500</span></span>, <span class="hljs-string"><span class="hljs-string">"amountDue"</span></span>: <span class="hljs-number"><span class="hljs-number">500</span></span>, <span class="hljs-string"><span class="hljs-string">"closed"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span> } ]</code> </pre><br>       ,     <code><font color="#0000FF">User</font></code> .        <code><font color="#0000FF">struct Invoice</font></code> ‚Ä¶ <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Invoice</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Codable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> amountDue: <span class="hljs-type"><span class="hljs-type">Int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> amountPaid: <span class="hljs-type"><span class="hljs-type">Int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> closed: <span class="hljs-type"><span class="hljs-type">Bool</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> id: <span class="hljs-type"><span class="hljs-type">Int</span></span> }</code> </pre><br> ‚Ä¶     <code>JSON</code>    <code><font color="#0000FF">invoices</font></code> ,         <code><font color="#0000FF">decode</font></code> : <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> invoices = <span class="hljs-type"><span class="hljs-type">Bundle</span></span>.main.path(forResource: <span class="hljs-string"><span class="hljs-string">"invoices"</span></span>, ofType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>) .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>( <span class="hljs-type"><span class="hljs-type">URL</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(fileURLWithPath:) ) .flatMap { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">Data</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(contentsOf: $<span class="hljs-number"><span class="hljs-number">0</span></span>) } .flatMap { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">JSONDecoder</span></span>().decode([<span class="hljs-type"><span class="hljs-type">Invoice</span></span>].<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, from: $<span class="hljs-number"><span class="hljs-number">0</span></span>) }</code> </pre><br> <code></code> <code><font color="#0000FF">invoices</font></code>  <code><font color="#0000FF">[Invoice]?</font></code> : <br><br><img src="https://habrastorage.org/webt/rk/-s/l0/rk-sl0uz-jcgqfdxuqlrzhpbrby.png"><br><br>       <code><font color="#0000FF">user</font></code>     <code><font color="#0000FF">invoices</font></code> ,      <code><font color="#0000FF">nil</font></code> ,  , ,    <code><font color="#0000FF">UserEnvelope</font></code> ,       : <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserEnvelope</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> user: <span class="hljs-type"><span class="hljs-type">User</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> invoices: [<span class="hljs-type"><span class="hljs-type">Invoice</span></span>] }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em vez de executar duas vezes </font></font><code><font color="#0000FF">if let</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> newUser = newUser, <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> invoices = invoices { }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... vamos escrever um an√°logo funcional do duplo </font></font><code><font color="#0000FF">if let</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">como uma </font></font><code>Generic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fun√ß√£o </font><font style="vertical-align: inherit;">auxiliar </font></font><code><font color="#0000FF">zip</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que converte dois </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">valores em uma </font></font><code><font color="#0000FF">Optional</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tupla:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zip</span></span></span><span class="hljs-function">&lt;A, B&gt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a: A?, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> b: B?)</span></span></span></span> -&gt; (<span class="hljs-type"><span class="hljs-type">A</span></span>, <span class="hljs-type"><span class="hljs-type">B</span></span>)? { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> a = a, <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> b = b { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (a, b) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span> }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agora n√£o temos motivos para atribuir algo √†s vari√°veis </font></font><code><font color="#0000FF">newUser</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font><code><font color="#0000FF">invoices</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, apenas incorporamos tudo √† nossa nova fun√ß√£o </font></font><code><font color="#0000FF">zip</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, usamos o inicializador </font></font><code><font color="#0000FF">UserEnvelope.init</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e tudo funcionar√°!</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> userEnv = <span class="hljs-built_in"><span class="hljs-built_in">zip</span></span>( <span class="hljs-type"><span class="hljs-type">Bundle</span></span>.main.path(forResource: <span class="hljs-string"><span class="hljs-string">"user"</span></span>, ofType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>) .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>(<span class="hljs-type"><span class="hljs-type">URL</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(fileURLWithPath:)) .flatMap { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">Data</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(contentsOf: $<span class="hljs-number"><span class="hljs-number">0</span></span>) } .flatMap { <span class="hljs-type"><span class="hljs-type">User</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(json: $<span class="hljs-number"><span class="hljs-number">0</span></span>) }, <span class="hljs-type"><span class="hljs-type">Bundle</span></span>.main.path(forResource: <span class="hljs-string"><span class="hljs-string">"invoices"</span></span>, ofType: <span class="hljs-string"><span class="hljs-string">"json"</span></span>) .<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>(<span class="hljs-type"><span class="hljs-type">URL</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(fileURLWithPath:)) .flatMap { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">Data</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(contentsOf: $<span class="hljs-number"><span class="hljs-number">0</span></span>) } .flatMap { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">JSONDecoder</span></span>().decode([<span class="hljs-type"><span class="hljs-type">Invoice</span></span>].<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, from: $<span class="hljs-number"><span class="hljs-number">0</span></span>) } ).flatMap (<span class="hljs-type"><span class="hljs-type">UserEnvelope</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (<span class="hljs-string"><span class="hljs-string">"\(userEnv!)"</span></span>) <span class="hljs-comment"><span class="hljs-comment">// UserEnvelope(user: id: 42 name: Blob , // invoices: [id: 1 amountDue: 0 amountPaid: 1000 closed: true, // id: 2 amountDue: 500 amountPaid: 500 closed: false])</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em uma √∫nica express√£o, um algoritmo inteiro para fornecer </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dados a um complexo </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">na forma de uma estrutura √© </font><font style="vertical-align: inherit;">compactado </font></font><code><font color="#0000FF">struct UserEnvelope</font></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><ul><li>    <code><font color="#0000FF">zip</font></code> ,  ,         .     <code><font color="#0000FF">user</font></code> , <code>JSON</code>   ,    <code><font color="#0000FF">invoices</font></code> ,      <code>JSON</code> .         . </li><li>    <code><font color="#0000FF">map</font></code> ,  ,   ¬´¬ª       . </li><li>    <code><font color="#0000FF">flatMap</font></code> ,  ,        ,     . </li></ul><br>  <code><font color="#0000FF">zip</font></code> , <code><font color="#0000FF">map</font></code>  <code><font color="#0000FF">flatMap</font></code>    <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">-  (domain-specific language, DSL)</a></b>   . <br><br>                   ,       <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">pointfree.co</a></b> . <br><br>      <i> </i>    ,       . <br><br><h2>  </h2><br>        <code>Swf</code> t ¬´ ¬ª,       <code><font color="#0000FF">map</font></code> , <code><font color="#0000FF">flatMap</font></code> , <code><font color="#0000FF">reduce</font></code> , <code><font color="#0000FF">filter</font></code>     <code><font color="#0000FF">Sequence</font></code> , <code><font color="#0000FF">Optional</font></code>  <code><font color="#0000FF">Result</font></code> .     ¬´ ¬ª    <code>,</code>     value <code></code> ‚Äî  <code><font color="#0000FF">struct</font></code>   <code><font color="#0000FF">enum</font></code> .  <code>iOS</code>     . <br><br>   ,   <code>Playground</code> ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Github</a> .        <code>Playground</code> ,    : <br><br> <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">    ¬´¬ª Xcode Playground   ¬´Launching Simulator¬ª  ¬´Running Playground¬ª.</a></b> <br><br>  Refer√™ncias: <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Functional Programming in Swift: An Introduction.</a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">An Introduction to Functional Programming in Swift.</a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">The Many Faces of Flat-Map: Part 3</a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Inside the Standard Library: Sequence.map()</a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Practical functional programming in Swift</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt440722/">https://habr.com/ru/post/pt440722/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt440712/index.html">A nuvem √© apenas o computador de algu√©m</a></li>
<li><a href="../pt440714/index.html">Como a redu√ß√£o da taxa de aquisi√ß√£o nos afeta (portadores de cart√£o)</a></li>
<li><a href="../pt440716/index.html">Implementa√ß√£o do maior IDCS pr√©-montado para autoridades p√∫blicas em Volgogrado</a></li>
<li><a href="../pt440718/index.html">Transfer√™ncia de dados entre cenas no Unity - aplicando valores m√∫ltiplos ao desenvolvimento de jogos simples</a></li>
<li><a href="../pt440720/index.html">Implementamos a interface do usu√°rio no iOS: melhoramos, aceleramos, dimensionamos</a></li>
<li><a href="../pt440724/index.html">Sele√ß√£o: 4 servi√ßos √∫teis para imigrantes em potencial nos EUA, Europa e outros pa√≠ses</a></li>
<li><a href="../pt440726/index.html">O jogo dos arqu√©tipos: como a narrativa funciona para marcas de tecnologia</a></li>
<li><a href="../pt440728/index.html">Desenvolvimento m√≥vel: da ideia √† estimativa de custos</a></li>
<li><a href="../pt440732/index.html">Atualize uma placa de depura√ß√£o com um processador Baikal-T1: adicione um cart√£o SD</a></li>
<li><a href="../pt440734/index.html">Sess√£o aberta √† vista no Spring Boot: a amea√ßa fantasma</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>