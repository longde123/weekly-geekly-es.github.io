<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü¶î üë©üèø‚Äçüåæ üßùüèª Serveur de diffusion vid√©o ESP32-CAM connectant des √©crans I2C et SPI ‚úäüèΩ üë®üèΩ‚Äçüè´ üëµüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Module CAM ESP-32 avec cam√©ra de Diymore 

 Serveur de diffusion vid√©o ESP32-CAM 
 Un exemple d'utilisation est ici . 

 Vous devez d'abord installer ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Serveur de diffusion vid√©o ESP32-CAM connectant des √©crans I2C et SPI</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463157/">  Module CAM ESP-32 avec cam√©ra de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Diymore</a> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fe/it/oc/feitoc3nxkss7zc6ocsw7cmuyho.jpeg" width="500"></div><br><h3>  Serveur de diffusion vid√©o ESP32-CAM </h3><br>  Un exemple d'utilisation est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  Vous devez d'abord installer les biblioth√®ques: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Carte Esp32 sous Arduino Ide Windows</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Carte Esp32 sous Arduino Ide Linux et Mac</a> <br><br>  Les param√®tres d√©taill√©s sont dans l'article. <br><br>  Dans mon cas, j'ai utilis√© le module AI-THINKER donc sans commentaire <br>  #define CAMERA_MODEL_AI_THINKER <br><br>  La fonctionnalit√© de reconnaissance faciale ne fonctionnait pas pour moi.  Le commentaire dans l'article a √©t√© utile. <br><a name="habracut"></a><br>  Il semble que la reconnaissance faciale ne fonctionne plus (du moins avec l'exemple de programme) lors de l'utilisation du noyau ESP 1.02.  Revenir au noyau 1.01 et utiliser l'exemple de programme appartenant √† ce noyau le ¬´corrigera¬ª <br><br>  Apr√®s √™tre revenu √† la version pr√©c√©dente de la biblioth√®que 1.01, tout fonctionnait. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/_2/tg/47/_2tg47ntvkqznzh-nr_jhqzitz8.png"></div><br>  J'ai une paire d'√©crans I2C 128x64 et TFT SPI 128x128 <br><br>  Article <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">OV7670 avec FIFO</a> comment connecter la cam√©ra √† l'√©cran si vous n'avez pas de module CAM.  Prise en charge des cam√©ras OV2640 et OV7670 <br><br>  Au moment de la r√©daction, les √©l√©ments suivants ont fonctionn√© pour moi <br><br>  Cam√©ra ESP32 + serveur Wifi + √©cran I2C (AdaFruit) <br>  Cam√©ra ESP32 + √©cran SPI 1,44 "TFT 128x128 v1.1 (AdaFruit) <br>  Cam√©ra ESP32 + √©cran SPI 1,8 "TFT 128 * 160 (biblioth√®que Espressif) <br><br>  Le pilote WiFi est en conflit avec le bus SPI.  Solution possible pour utiliser une biblioth√®que diff√©rente.  Le probl√®me est survenu lors de l'initialisation du module WiFi. <br><br>  Le principal probl√®me est que le module ESP32-CAM a un nombre limit√© de jambes libres.  Une partie des ports est utilis√©e pour la cam√©ra, une partie en parall√®le avec la carte SD.  Le connecteur de la carte SD est install√© sur la carte.  Une autre conclusion (IO4) est la lampe de poche LED. <br><br>  L'affichage I2C N / B n'est pas particuli√®rement int√©ressant pour une utilisation r√©elle avec l'image re√ßue de la cam√©ra.  Couleur TFT et haute r√©solution.  Sur celui-ci, vous pouvez d√©j√† voir le visage.  Sur un tel √©cran ou une r√©solution un peu plus √©lev√©e, vous pouvez faire <br><br>  Je dirai tout de suite que la biblioth√®que AdaFruit n'est pas la plus rapide.  J'ai r√©ussi √† afficher quelques images par seconde.  Il est plus prometteur d'utiliser des biblioth√®ques qui fonctionnent √† un faible niveau.  Mais je n'ai pas pu obtenir une ESP32_TFT_library avec mon √©cran 1,44 "128x128 SPI V1.1. Peut-√™tre qu'ILI9163 n'est pas pris en charge. J'ai pris 1,8" 128 * 160 SPI TFT et j'ai r√©ussi √† serrer environ 12 FPS!  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Lien</a> <br><br>  Il existe quelques biblioth√®ques qui fonctionnent plus rapidement.  Mais certains ne sont pas port√©s pour esp-32 ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">lien</a> ): <br><br>  4.98 sec Adafruit_ST7735 <br>  1,71 s ST7735X_kbv <br>  1,30 sec PDQ_ST7735 <br><br>  La vid√©o est impressionnante: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/HnhsxP0W0m4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Lorsque vous utilisez <s>deux ports, l'</s> un des ports mat√©riels HSPI ou VSPI sur le microcontr√¥leur et l'affichage avec le pilote ILI9341 peut recevoir 30 images par seconde ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">lien</a> ). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/7a/39/93/7a3993k5m_j9z5f2juglv5s9h9g.png"></div><br><br>  Mais comme je l'ai dit plus t√¥t dans le module ESP32-CAM, un seul SPI est gratuit.  Il est affich√© sur les PINS suivants: <br><br>  IO2 - DC (A0) <br>  IO14 - CLK <br>  IO15 - CS <br>  IO13 - MOSI (SDA) <br>  IO12 - MISO (entr√©e. Non utilis√©e) <br><br>  IO0 - BCKL (r√©tro√©clairage. Non utilis√©) <br>  IO16 - RST <br><br><img src="https://habrastorage.org/webt/ob/wr/wy/obwrwyztxqm6ct4dtlxe_fggdim.png"><br><br><img src="https://habrastorage.org/webt/nr/7e/dg/nr7edg2broaykspjtyxncso2zxy.png"><br><br>  La premi√®re biblioth√®que que j'ai essay√©e √©tait AdaFruit SSD1306 <br><br><h3>  √âcran OLED bleu I2C 128x64 </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ec/xl/ji/ecxljimycqq42q16yxswiehsv98.png"></div><br><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;Wire.h&gt; #include &lt;Adafruit_GFX.h&gt; #include &lt;Adafruit_SSD1306.h&gt; #define SCREEN_WIDTH 128 // OLED display width, in pixels #define SCREEN_HEIGHT 64 // OLED display height, in pixels // Declaration for an SSD1306 display connected to I2C (SDA, SCL pins) #define OLED_RESET -1 // Reset pin # (or -1 if sharing Arduino reset pin) Adafruit_SSD1306 display; void init_display(){ pinMode(14,INPUT_PULLUP); pinMode(15,INPUT_PULLUP); Wire.begin(14,15); display = Adafruit_SSD1306(SCREEN_WIDTH, SCREEN_HEIGHT, &amp;Wire, OLED_RESET); if(!display.begin(SSD1306_SWITCHCAPVCC, 0x3C)) { // Address 0x3D for 128x64 Serial.println(F("SSD1306 allocation failed")); for(;;); // Don't proceed, loop forever } ....</span></span></span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">camera_capture ()</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> BACKCOLOR 0x0000 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// Black #define PIXELCOLOR 0xFFFF // White #define FRAME_WIDTH 320 #define FRAME_HEIGHT 240 uint16_t pixel_color = 0; esp_err_t camera_capture(){ //acquire a frame camera_fb_t * fb = esp_camera_fb_get(); if (!fb) { ESP_LOGE(TAG, "Camera Capture Failed"); return ESP_FAIL; } int i = 0; for(int y = 0; y &lt; SCREEN_HEIGHT; y++){ for(int x = 0; x &lt; SCREEN_WIDTH; x++){ i = y * FRAME_WIDTH + x; // FRAMESIZE_QVGA // 320x240 char ch = (char)fb-&gt;buf[i]; if (ch &gt; 128) pixel_color = WHITE; else pixel_color = BLACK; // Draw a single pixel in white display.drawPixel(x, y, pixel_color); } } display.display(); //return the frame buffer back to the driver for reuse esp_camera_fb_return(fb); Serial.println("Capture frame ok."); return ESP_OK; }</span></span></span></span></code> </pre><br></div></div><br>  Lorsque vous travaillez dans esp32, l'√©mulation Software I2C est utilis√©e.  Impliqu√© IO14 et IO15.  Presque tous les ports libres peuvent √™tre utilis√©s, pas le bus H / W. <br><br>  Comment connecter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">un √©cran OLED monochrome 0.96 "i2c</a> . Vous devez faire attention √† l'adresse d'affichage sur le bus I2C. Dans ce cas, 0x3C <br><br><h3>  Affichage SPI 1,8 "TFT 128 * 160 Biblioth√®que Espressif </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/e9/ym/zg/e9ymzg6iukpuzpowfbgvlln89dg.jpeg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/eo/jv/j0/eojvj0nkmzg1dqiubx3jcaoepou.jpeg"></div><br>  Sch√©ma de c√¢blage: <br><br>  IO2 - A0 <br>  IO14 - SCK <br>  IO15 - CS <br>  IO13 - SDA <br>  IO16 - RESET <br><br><img src="https://habrastorage.org/webt/fp/v8/iv/fpv8iv79hdpoefoxwnzsc64ychm.png"><br>  Il y a aussi un lecteur de carte SD sur la carte <br><br>  Configuration d'E / S: <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Configuration for other boards, set the correct values for the display used //---------------------------------------------------------------------------- #define DISP_COLOR_BITS_24 0x66 //#define DISP_COLOR_BITS_16 0x55 // Do not use! // ############################################# // ### Set to 1 for some displays, ### // for example the one on ESP-WROWER-KIT ### // ############################################# #define TFT_INVERT_ROTATION 0 #define TFT_INVERT_ROTATION1 0 // ################################################ // ### SET TO 0X00 FOR DISPLAYS WITH RGB MATRIX ### // ### SET TO 0X08 FOR DISPLAYS WITH BGR MATRIX ### // ### For ESP-WROWER-KIT set to 0x00 ### // ################################################ #define TFT_RGB_BGR 0x08 // ############################################################## // ### Define ESP32 SPI pins to which the display is attached ### // ############################################################## // The pins configured here are the native spi pins for HSPI interface // Any other valid pin combination can be used #define PIN_NUM_MISO 12 // SPI MISO #define PIN_NUM_MOSI 13 // SPI MOSI #define PIN_NUM_CLK 14 // SPI CLOCK pin #define PIN_NUM_CS 15 // Display CS pin #define PIN_NUM_DC 2 // Display command/data pin #define PIN_NUM_TCS 0 // Touch screen CS pin (NOT used if USE_TOUCH=0) // -------------------------------------------------------------- // ** Set Reset and Backlight pins to 0 if not used ! // ** If you want to use them, set them to some valid GPIO number #define PIN_NUM_RST 0 // GPIO used for RESET control #define PIN_NUM_BCKL 0 // GPIO used for backlight control #define PIN_BCKL_ON 0 // GPIO value for backlight ON #define PIN_BCKL_OFF 1 // GPIO value for backlight OFF // -------------------------------------------------------------- // ####################################################### // Set this to 1 if you want to use touch screen functions // ####################################################### #define USE_TOUCH TOUCH_TYPE_NONE // ####################################################### // ####################################################################### // Default display width (smaller dimension) and height (larger dimension) // ####################################################################### #define DEFAULT_TFT_DISPLAY_WIDTH 128 #define DEFAULT_TFT_DISPLAY_HEIGHT 160 // ####################################################################### #define DEFAULT_GAMMA_CURVE 0 #define DEFAULT_SPI_CLOCK 32000000 #define DEFAULT_DISP_TYPE DISP_TYPE_ST7735B //---------------------------------------------------------------------------- #define TFT_INVERT_ROTATION 0 #define TFT_INVERT_ROTATION1 1 #define TFT_INVERT_ROTATION2 0</span></span></code> </pre><br>  Installez l'environnement et l'environnement de d√©veloppement d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Espressif</a> .  Des instructions d√©taill√©es sur la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">fa√ßon de proc√©der</a> . <br><br>  Installez la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">biblioth√®que</a> .  Deux corrections doivent √™tre apport√©es pour assembler la biblioth√®que. <br><br>  Makefile: <br><br><pre> <code class="bash hljs">+ CFLAGS += -Wno-error=tautological-compare \ + -Wno-implicit-fallthrough \ + -Wno-implicit-function-declaration</code> </pre><br>  composants / tft / tftspi.c: <br><br><pre> <code class="cpp hljs">+ <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"driver/gpio.h</span></span></span></span></code> </pre><br>  ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Patch</a> <br><br>  Installez ensuite le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pilote de la cam√©ra ESP32</a> . <br><br>  Configurer: <br><br>  #.  $ HOME / esp / esp-idf / export.sh <br>  # idf.py menuconfig <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yc/yl/ml/ycylmlzznbfewlweiaris71dbzo.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/_3/gn/5s/_3gn5s4bmrqunmhwjeabdtxe9yu.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/x8/jc/g6/x8jcg6ia43npfcol7rebn1taz7e.png"></div><br>  Autorisez l'acc√®s au port USB pour le micrologiciel et la surveillance: <br><br>  #sudo chmod 777 / dev / ttyUSB0 <br><br>  Nous collectons et remplissons: <br><br>  #make -j4 &amp;&amp; faire flash <br><br>  12FPS est atteint par l'√©criture de paquets en utilisant la m√©thode send_data.  L'enregistrement n'est pas pixel par pixel, mais une ligne enti√®re √©gale √† la largeur de l'√©cran: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">esp_err_t</span></span> camera_capture(){ <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> tstart, t1, t2; tstart = clock(); <span class="hljs-comment"><span class="hljs-comment">//acquire a frame camera_fb_t * fb = esp_camera_fb_get(); if (!fb) { printf("Camera Capture Failed\n"); return ESP_FAIL; } t1 = clock() - tstart; printf("Capture camera time: %u ms\r\n", t1); int i = 0, bufPos = 0; uint8_t hb, lb; color_t color; color_t *color_line = heap_caps_malloc(_width*3, MALLOC_CAP_DMA); tstart = clock(); for(int y = 0; y &lt; _height; y++) { bufPos = 0; for(int x = 0; x &lt; _width; x++) { i = (y * FRAME_WIDTH + x) &lt;&lt; 1; hb = fb-&gt;buf[i] ; lb = fb-&gt;buf[i + 1]; color.r = (lb &amp; 0x1F) &lt;&lt; 3; color.g = (hb &amp; 0x07) &lt;&lt; 5 | (lb &amp; 0xE0) &gt;&gt; 3; color.b = hb &amp; 0xF8; color_line[bufPos] = color; bufPos++; // TFT_drawPixel(0, 0, color, 1); } disp_select(); send_data(0, y, _width-1, y, _width, color_line); wait_trans_finish(1); disp_deselect(); } free(color_line); t1 = clock() - tstart; printf("Send buffer time: %u ms\r\n", t1); esp_camera_fb_return(fb); printf("Capture frame ok.\n"); return ESP_OK; }</span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">Configuration de la cam√©ra</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// #if defined(CAMERA_MODEL_AI_THINKER) #define PWDN_GPIO_NUM 32 #define RESET_GPIO_NUM -1 #define XCLK_GPIO_NUM 0 #define SIOD_GPIO_NUM 26 #define SIOC_GPIO_NUM 27 #define Y9_GPIO_NUM 35 #define Y8_GPIO_NUM 34 #define Y7_GPIO_NUM 39 #define Y6_GPIO_NUM 36 #define Y5_GPIO_NUM 21 #define Y4_GPIO_NUM 19 #define Y3_GPIO_NUM 18 #define Y2_GPIO_NUM 5 #define VSYNC_GPIO_NUM 25 #define HREF_GPIO_NUM 23 #define PCLK_GPIO_NUM 22 void camera_init_(){ camera_config_t config; config.ledc_channel = LEDC_CHANNEL_0; config.ledc_timer = LEDC_TIMER_0; config.pin_d0 = Y2_GPIO_NUM; config.pin_d1 = Y3_GPIO_NUM; config.pin_d2 = Y4_GPIO_NUM; config.pin_d3 = Y5_GPIO_NUM; config.pin_d4 = Y6_GPIO_NUM; config.pin_d5 = Y7_GPIO_NUM; config.pin_d6 = Y8_GPIO_NUM; config.pin_d7 = Y9_GPIO_NUM; config.pin_xclk = XCLK_GPIO_NUM; config.pin_pclk = PCLK_GPIO_NUM; config.pin_vsync = VSYNC_GPIO_NUM; config.pin_href = HREF_GPIO_NUM; config.pin_sscb_sda = SIOD_GPIO_NUM; config.pin_sscb_scl = SIOC_GPIO_NUM; config.pin_pwdn = PWDN_GPIO_NUM; config.pin_reset = RESET_GPIO_NUM; config.xclk_freq_hz = 20000000; config.fb_count = 2; // for display config.frame_size = FRAMESIZE_QVGA; config.pixel_format = PIXFORMAT_RGB565; // camera init esp_err_t err = esp_camera_init(&amp;config); if (err != ESP_OK) { printf("Camera init failed with error 0x%x", err); return; } printf("Camera init OK\n"); }</span></span></code> </pre><br></div></div><br>  ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Gist</a> <br><br>  <u>FRAME_WIDTH est la largeur d'image de 320 pixels pour QVGA</u> <br><br><pre> <code class="cpp hljs">config.frame_size = FRAMESIZE_QVGA; <span class="hljs-comment"><span class="hljs-comment">// 320x240</span></span></code> </pre><br>  En fait, nous voyons sur la fen√™tre d'affichage 128 * 160 √† partir du cadre complet <br><br>  <i>Journal pour la configuration avec un tampon de cam√©ra vid√©o (config.fb_count = 1)</i> <i><br></i>  <i>Temps de capture de la cam√©ra: 32 ms</i> <i><br></i>  <i>Temps de tampon d'envoi: 47 ms</i> <i><br></i>  <i>Cadre de capture ok.</i> <br><br>  <b>R√©sultat</b> <b><br></b>  <b>1000 / (32 + 47) = 12,65 FPS</b> <br><br><div class="spoiler">  <b class="spoiler_title">Journal pour la configuration avec deux tampons de cam√©scope (config.fb_count = 2)</b> <div class="spoiler_text">  Temps de capture de la cam√©ra: 39 ms <br><br>  Temps de tampon d'envoi: 63 ms <br><br>  Cadre de capture ok. <br>  Temps de capture de la cam√©ra: 0 ms <br><br>  Temps de tampon d'envoi: 59 ms <br><br>  Cadre de capture ok. <br>  Temps de capture de la cam√©ra: 0 ms <br><br>  Temps de tampon d'envoi: 34 ms <br><br>  Cadre de capture ok. <br>  Temps de capture de la cam√©ra: 40 ms <br><br>  Temps de tampon d'envoi: 64 ms <br><br>  Cadre de capture ok. <br>  Temps de capture de la cam√©ra: 0 ms <br><br>  Temps de tampon d'envoi: 59 ms <br><br>  Cadre de capture ok. <br>  Temps de capture de la cam√©ra: 0 ms <br><br>  Temps de tampon d'envoi: 34 ms <br><br>  Cadre de capture ok. <br>  Temps de capture de la cam√©ra: 40 ms <br><br>  Temps de tampon d'envoi: 63 ms <br><br>  Cadre de capture ok. <br>  Temps de capture de la cam√©ra: 0 ms <br><br>  Temps de tampon d'envoi: 60 ms <br><br>  Cadre de capture ok. <br>  Temps de capture de la cam√©ra: 0 ms <br><br>  Temps de tampon d'envoi: 34 ms <br><br>  Cadre de capture ok. <br>  Temps de capture de la cam√©ra: 39 ms <br><br>  Temps de tampon d'envoi: 63 ms <br><br>  Cadre de capture ok. <br>  Temps de capture de la cam√©ra: 0 ms <br><br>  Temps de tampon d'envoi: 60 ms <br><br>  Cadre de capture ok. <br>  Capturez le temps de la cam√©ra: 1 ms <br><br>  Temps de tampon d'envoi: 34 ms <br><br>  Cadre de capture ok. <br>  Temps de capture de la cam√©ra: 40 ms <br><br>  Temps de tampon d'envoi: 63 ms <br><br>  Cadre de capture ok. <br>  Temps de capture de la cam√©ra: 0 ms <br><br>  Temps de tampon d'envoi: 60 ms <br><br>  Cadre de capture ok. <br>  Temps de capture de la cam√©ra: 0 ms <br><br>  Temps de tampon d'envoi: 34 ms <br><br>  Cadre de capture ok. <br>  Temps de capture de la cam√©ra: 40 ms <br><br>  Temps de tampon d'envoi: 63 ms <br><br>  Cadre de capture ok. <br>  Temps de capture de la cam√©ra: 0 ms <br><br>  Temps de tampon d'envoi: 59 ms <br><br>  Cadre de capture ok. <br>  Temps de capture de la cam√©ra: 0 ms <br><br>  Temps de tampon d'envoi: 35 ms <br><br>  Cadre de capture ok. </div></div><br>  En raison de l'utilisation du deuxi√®me tampon du cam√©scope, le tampon de certains cycles est obtenu instantan√©ment.  Dans un premier temps, le cycle complet est obtenu en moins que d'utiliser un seul tampon, mais cette fois "continue".  L'intervalle entre les cycles est flottant. <br><br>  Plusieurs fois, j'ai attrap√© dans les journaux "Le d√©tecteur de panne de courant s'est d√©clench√©", j'ai donc √©teint le d√©tecteur.  Parce qu'au d√©but, j'ai aliment√© l'affichage du r√©tro√©clairage √† partir de la broche ESP32-CAM de 3,3 V <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"soc/rtc_cntl_reg.h"</span></span></span><span class="hljs-meta"> ... WRITE_PERI_REG(RTC_CNTL_BROWN_OUT_REG, 0); </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//disable brownout detector</span></span></span></span></code> </pre><br><h3>  Conclusion </h3><br>  Module fonctionnel ESP32 √† faible co√ªt.  Il y a un manque catastrophique de conclusions pour les ports impl√©ment√©s dans la version CAM de la carte, alors choisissez la version CAM si vous avez vraiment besoin d'une cam√©ra. <br><br><div class="spoiler">  <b class="spoiler_title">Liens utiles</b> <div class="spoiler_text">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">randomnerdtutorials.com/esp32-troubleshooting-guide</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">www.instructables.com/id/Select-Color-Display-for-ESP32</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github.com/gnulabis/UTFT-ESP</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github.com/Bodmer/TFT_eSPI</a> </div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr463157/">https://habr.com/ru/post/fr463157/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr463143/index.html">Premiers pas avec Google Analytics: App + Web</a></li>
<li><a href="../fr463147/index.html">Robot Trolley ROS - Partie 3. Acc√©l√©rez, changez la cam√©ra, corrigez la d√©marche</a></li>
<li><a href="../fr463149/index.html">Alan Kay recommande de lire des livres de programmation anciens et oubli√©s mais importants</a></li>
<li><a href="../fr463151/index.html">iOS 13 sous la loupe</a></li>
<li><a href="../fr463155/index.html">Le bruit blanc dessine un carr√© noir. Partie 2. Solution</a></li>
<li><a href="../fr463159/index.html">√Ä propos de la s√©curit√©, des chiffres, des e-mails et, un peu sur la publicit√©</a></li>
<li><a href="../fr463165/index.html">Telegram contre-attaque DPI et verrous - Faux TLS</a></li>
<li><a href="../fr463167/index.html">Mat√©riel n√©cessaire pour d√©marrer le d√©veloppement d'un projet de formation VR</a></li>
<li><a href="../fr463169/index.html">Aide auditive Open Source - Comment √ßa marche</a></li>
<li><a href="../fr463171/index.html">R√©seaux de neurones et apprentissage en profondeur: un tutoriel en ligne, chapitre 6, partie 1: apprentissage en profondeur</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>