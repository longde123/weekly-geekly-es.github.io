<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📈 👩🏼‍🎨 🔪 Deep Learning in der optischen Flussberechnung ✡️ 🦌 🤳🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mit dem Aufkommen vieler verschiedener neuronaler Netzwerkarchitekturen gehören viele klassische Computer Vision-Techniken der Vergangenheit an. Immer...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Deep Learning in der optischen Flussberechnung</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ods/blog/446726/">  Mit dem Aufkommen vieler verschiedener neuronaler Netzwerkarchitekturen gehören viele klassische Computer Vision-Techniken der Vergangenheit an.  Immer seltener verwenden Menschen SIFT und HOG zur Objekterkennung und MBH zur Aktionserkennung. Wenn sie es verwenden, ähneln sie eher handgefertigten Zeichen für die entsprechenden Gitter.  Heute werden wir uns eines der klassischen CV-Probleme ansehen, bei denen die klassischen Methoden immer noch die Führung übernehmen, während DL-Architekturen sie träge in den Hinterkopf atmen. <br><br><img src="https://habrastorage.org/webt/6z/eh/72/6zeh726hjzbg1t7k20ob4wy9_o4.png"><br><a name="habracut"></a><br><h2>  Optische Durchflussschätzung </h2><br>  Die Aufgabe der Berechnung des optischen Flusses zwischen zwei Bildern (normalerweise zwischen benachbarten Bildern eines Videos) besteht darin, ein Vektorfeld zu konstruieren <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.057ex" viewBox="0 -780.1 763.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-4F" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi></math></span></span><script type="math/tex" id="MathJax-Element-1"> O </script>  die gleiche Größe im Übrigen <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.377ex" height="2.66ex" viewBox="0 -832 2745.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-69" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2C" x="1498" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-6A" x="1943" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-29" x="2356" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-2"> O (i, j) </script>  entspricht dem scheinbaren Pixelverschiebungsvektor <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.604ex" height="2.66ex" viewBox="0 -832 1982.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-69" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2C" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-6A" x="1180" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-29" x="1592" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-3"> (i, j) </script>  vom ersten bis zum zweiten Frame.  Indem wir ein solches Vektorfeld zwischen allen benachbarten Bildern des Videos erstellen, erhalten wir ein vollständiges Bild davon, wie sich bestimmte Objekte darauf bewegt haben.  Mit anderen Worten, dies ist die Aufgabe, alle Pixel in einem Video zu verfolgen.  Der optische Strom wird sehr häufig verwendet - bei Aufgaben zur Aktionserkennung können Sie sich beispielsweise mit einem solchen Vektorfeld auf die Bewegungen konzentrieren, die auf dem Video auftreten, und sich von seinem Kontext entfernen [7].  Noch häufigere Anwendungen sind visuelle Kilometerzähler, Videokomprimierung, Nachbearbeitung (z. B. Hinzufügen eines Zeitlupeneffekts) und vieles mehr. <br><br><img src="https://habrastorage.org/webt/pf/hx/t6/pfhxt6t_fawwqjyxiptno85zyge.png" width="720" height="360"><br><br>  Es gibt Raum für einige Unklarheiten - was genau wird aus mathematischer Sicht als sichtbare Verzerrung angesehen?  Normalerweise wird angenommen, dass die Pixelwerte ohne Änderungen von einem Bild zum nächsten gehen, mit anderen Worten: <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>I</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>I</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>+</mo><msub><mi>u</mi><mi>i</mi></msub><mo>,</mo><mi>j</mi><mo>+</mo><msub><mi>u</mi><mi>j</mi></msub><mo>,</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="33.096ex" height="2.78ex" viewBox="0 -832 14249.5 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-49" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-28" x="504" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-69" x="894" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2C" x="1239" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-6A" x="1684" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2C" x="2097" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-74" x="2542" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-29" x="2903" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-3D" x="3571" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-49" x="4627" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-28" x="5131" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-69" x="5521" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2B" x="6089" y="0"></use><g transform="translate(7089,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2C" x="8006" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-6A" x="8451" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2B" x="9086" y="0"></use><g transform="translate(10087,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-6A" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2C" x="11051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-74" x="11496" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2B" x="12080" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-31" x="13081" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-29" x="13581" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2C" x="13971" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>I</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>I</mi><mo stretchy="false">(</mo><mi>i</mi><mo>+</mo><msub><mi>u</mi><mi>i</mi></msub><mo>,</mo><mi>j</mi><mo>+</mo><msub><mi>u</mi><mi>j</mi></msub><mo>,</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>,</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-4"> I (i, j, t) = I (i + u_i, j + u_j, t + 1), </script></p>  wo <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>I</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.649ex" height="2.66ex" viewBox="0 -832 3293.3 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-49" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-28" x="504" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-69" x="894" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2C" x="1239" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-6A" x="1684" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2C" x="2097" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-74" x="2542" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-29" x="2903" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-5"> I (i, j, t) </script>  - Pixelintensität in Koordinaten <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.604ex" height="2.66ex" viewBox="0 -832 1982.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-69" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2C" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-6A" x="1180" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-29" x="1592" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-6"> (i, j) </script>  dann optischer Fluss <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>u</mi><mi>i</mi></msub><mo>,</mo><msub><mi>u</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.212ex" height="2.78ex" viewBox="0 -832 3105.2 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2C" x="1306" y="0"></use><g transform="translate(1751,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-6A" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-29" x="2715" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>u</mi><mi>i</mi></msub><mo>,</mo><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-7"> (u_i, u_j) </script>  zeigt, wo sich dieses Pixel zum nächsten Zeitpunkt bewegt hat (d. h. im nächsten Bild). <br><br>  Auf dem Bild sieht es so aus: <br><br><img src="https://habrastorage.org/webt/55/pv/ql/55pvqliwe25q4uz58mc9vhf5z9m.gif"><br><br><img src="https://habrastorage.org/webt/vk/5b/wr/vk5bwroklj2xdi_ncrk-zihvhic.gif"><br><br>  Das Visualisieren eines Vektorfeldes direkt mit Vektoren ist visuell, aber nicht immer bequem. Daher besteht die zweite übliche Methode darin, mit Farbe zu visualisieren: <br><br><img src="https://habrastorage.org/webt/eb/lc/a2/eblca2o7vwo_d0wtyw8gm9axdte.gif"><br><br><img src="https://habrastorage.org/webt/v4/fp/pe/v4fppenisw4sf3psqncsmg_7xqm.gif"><br><br>  Jede Farbe in diesem Bild codiert einen bestimmten Vektor.  Der Einfachheit halber werden Vektoren, die länger als 20 sind, zugeschnitten, und der Vektor selbst kann anhand der Farbe aus dem folgenden Bild wiederhergestellt werden: <br><br><img src="https://habrastorage.org/webt/wa/fo/eh/wafoeh4p14ei82ascjk7te6i0go.png" width="320" height="320"><br><br><div class="spoiler">  <b class="spoiler_title">Mehr Katzenfluss!</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/4l/mo/nt/4lmont9w39gboi9b127uvnnkxqw.gif"><br><img src="https://habrastorage.org/webt/ki/-p/z4/ki-pz4kopzo9dlhzxc9u01kbkmk.gif"><br><img src="https://habrastorage.org/webt/v1/tb/xw/v1tbxwqp0sxnugfok07tksnzmds.gif"><br><img src="https://habrastorage.org/webt/pn/vj/ds/pnvjdsmzb1ikdyk3koiyfmlbp68.gif"><br><img src="https://habrastorage.org/webt/w4/wd/z-/w4wdz-cvvu21hust2ldrueki_cw.gif"><br><img src="https://habrastorage.org/webt/fx/xz/wy/fxxzwyibq5qcpaapl4tcj0f2mju.gif"><br><img src="https://habrastorage.org/webt/lo/kj/0w/lokj0wamraallgkyt1el0udou0e.gif"><br><img src="https://habrastorage.org/webt/ui/2k/ac/ui2kacgkblcf9c_5u5hkdelnxfg.gif"><br><img src="https://habrastorage.org/webt/hc/g0/me/hcg0mecxdbevoasfbcrsavhnbte.gif"><br><img src="https://habrastorage.org/webt/f3/gr/32/f3gr32ufn8t4rhuoecwnjhqy2l0.gif"><br><img src="https://habrastorage.org/webt/yr/dm/4t/yrdm4t_qnwmpoeurnwyhawdxgqw.gif"><br><img src="https://habrastorage.org/webt/p3/rb/qi/p3rbqiggl8o5tptv21ydinm5wfw.gif"><br></div></div><br>  Klassische Methoden haben eine ziemlich gute Genauigkeit erreicht, die manchmal ihren Preis hat.  Wir werden die Fortschritte betrachten, die neuronale Netze bei der Lösung dieses Problems in den letzten 4 Jahren erzielt haben. <br><br><h2>  Daten und Metriken </h2><br>  Zwei Wörter darüber, welche Datensätze zu Beginn unserer Geschichte (d. H. 2015) verfügbar und beliebt waren und wie sie die Qualität des resultierenden Algorithmus messen. <br><br><h5>  Middlebury </h5><br>  Ein winziger Datensatz von 8 Bildpaaren mit kleinen Offsets, der jedoch auch jetzt noch zur Validierung von Algorithmen zur Berechnung des optischen Flusses verwendet wird. <br><br><img src="https://habrastorage.org/webt/nc/oo/tt/ncoott5vvw5zietkw5vz6xixzpa.png"><br><br><h5>  Kitty </h5><br>  Dies ist ein Datensatz, der für Anwendungen für selbstfahrende Autos gekennzeichnet und mit LIDAR-Technologie zusammengestellt wurde.  Es wird häufig zur Validierung von Algorithmen zur Berechnung des optischen Flusses verwendet und enthält viele ziemlich komplizierte Fälle mit scharfen Übergängen zwischen Frames. <br><br><img src="https://habrastorage.org/webt/nc/6c/82/nc6c824qepdccm51ynf1uc9ip5i.jpeg"><br><br><h5>  Sintel </h5><br>  Ein weiterer sehr verbreiteter Maßstab, der auf der Grundlage des offenen und in Blender gezeichneten Cartoon Sintel in zwei Versionen erstellt wurde, die als sauber und endgültig bezeichnet werden.  Der zweite ist viel komplizierter, weil  enthält viele atmosphärische Effekte, Rauschen, Unschärfe und andere Probleme für die Algorithmen zur Berechnung des optischen Flusses. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/ZmiBI4tPk_o" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h5>  EPE </h5><br>  Die Standardfehlerfunktion für die Aufgabe zur Berechnung des optischen Flusses ist Endpunktfehler oder EPE.  Dies ist einfach der euklidische Abstand zwischen dem berechneten Algorithmus und dem wahren optischen Fluss, gemittelt über alle Pixel. <br><br><h2>  Flownet (2015) </h2><br>  Als die Autoren (von den Universitäten München und Freiburg) 2015 mit dem Aufbau einer neuronalen Netzwerkarchitektur für die Berechnung des optischen Flusses begannen, hatten sie zwei Probleme: Es gab keinen großen markierten Datensatz für diese Aufgabe, und das manuelle Markieren wäre schwierig (versuchen Sie zu markieren, wo ich mich bewegt habe) Erstens jedes Pixel des Bildes im nächsten Bild.  Diese Aufgabe war ganz anders als alle Aufgaben, die zuvor mit Hilfe von CNN-Architekturen gelöst wurden.  Tatsächlich ist dies eine Aufgabe der Pixel-für-Pixel-Regression, wodurch sie der Aufgabe der Segmentierung (Pixel-für-Pixel-Klassifizierung) ähnelt, aber anstelle eines Bildes haben wir zwei Eingaben, und intuitiv sollten die Zeichen irgendwie den Unterschied zwischen den beiden Bildern zeigen.  Als erste Iteration wurde beschlossen, nur zwei RGB-Frames als Eingabe zu platzieren (nachdem tatsächlich ein 6-Kanal-Bild empfangen wurde), zwischen denen wir den optischen Strom berechnen möchten, und U-net als Architektur mit einer Reihe von Änderungen zu verwenden.  Dieses Netzwerk wurde FlowNetS genannt (S steht für Simple): <br><br><img src="https://habrastorage.org/webt/pv/tw/ss/pvtwssodmmsjy6a58kmlvovgp80.png"><br><br><img src="https://habrastorage.org/webt/uj/tl/g-/ujtlg-sweodxqqisb9kjehzd_2a.png"><br><br>  Wie Sie dem Diagramm entnehmen können, fällt der Encoder nicht auf, der Decoder unterscheidet sich in mehreren Punkten von den klassischen Optionen: <br><br><ol><li>  Die Vorhersage des optischen Flusses erfolgt nicht nur von der letzten Ebene, sondern auch von allen anderen.  Um die Grundwahrheit für die i-te Ebene des Decoders zu erhalten, wird das ursprüngliche Ziel (d. H. Der optische Strom) einfach (fast das gleiche wie das Bild) auf die gewünschte Auflösung reduziert, und das auf der i-ten Ebene erhaltene Prädikat geht weiter, t es wird mit einer Merkmalskarte verkettet, die aus dieser Ebene hervorgeht.  Die allgemeine Funktion des Lernverlusts ist eine gewichtete Summe der Verluste von allen Ebenen des Decoders, während die Gewichtung selbst umso größer ist, je näher die Ebene an der Netzwerkausgabe liegt.  Die Autoren geben keine Erklärung dafür, warum dies getan wird, aber höchstwahrscheinlich liegt der Grund darin, dass scharfe Bewegungen auf frühen Ebenen besser zu erkennen sind, dann sind die Vektoren im optischen Strom mit niedrigerer Auflösung nicht so groß. </li><li>  Das Diagramm zeigt, dass die Eingangsauflösung der Bilder 384 x 512 beträgt und die Ausgabe viermal kleiner ist.  Die Autoren stellten fest, dass, wenn Sie diese Ausgabe durch einfache bilineare Interpolation auf 384 x 512 erhöhen, die gleiche Qualität erzielt wird, als würden Sie zwei weitere Ebenen des Decoders anschließen.  Sie können auch den Variationsansatz [2] verwenden, der die Qualität beweist (+ v in der Tabelle mit Qualität). </li><li>  Wie in U-net werden Attributkarten vom Codierer an den Decodierer gesendet und wie in der Abbildung gezeigt verkettet. </li></ol><br><img src="https://habrastorage.org/webt/n3/hv/wt/n3hvwta--ipyc3rvgod2w1lfrnu.png"><br><br>  Um zu verstehen, wie die Autoren versucht haben, ihre Basislinie zu verbessern, müssen Sie wissen, wie die Korrelation zwischen Bildern ist und warum sie bei der Berechnung des optischen Flusses hilfreich sein kann.  Wenn wir also zwei Bilder haben und wissen, dass das zweite das nächste Bild im Video relativ zum ersten ist, können wir versuchen, den Bereich um den Punkt im ersten Bild (für den wir eine Verschiebung zum zweiten Bild finden möchten) mit Bereichen gleicher Größe im zweiten Bild zu vergleichen.  Unter der Annahme, dass die Verschiebung pro Zeiteinheit nicht zu groß sein könnte, kann der Vergleich nur in einer bestimmten Nachbarschaft des Startpunkts betrachtet werden.  Hierzu wird eine Kreuzkorrelation verwendet.  Lassen Sie uns anhand eines Beispiels veranschaulichen. <br><br>  Nehmen Sie zwei benachbarte Bilder des Videos. Wir möchten feststellen, wo sich ein bestimmter Punkt vom ersten zum zweiten Bild verschoben hat.  Angenommen, ein Bereich um diesen Punkt hat sich auf die gleiche Weise verschoben.  In der Tat werden benachbarte Pixel in einem Video normalerweise zusammen versetzt, wie z  höchstwahrscheinlich sind sie visuell Teil eines Objekts.  Diese Annahme wird beispielsweise in differenziellen Ansätzen aktiv verwendet, die in [5], [6] ausführlicher gelesen werden können. <br><br><pre><code class="python hljs">fig, ax = plt.subplots(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, figsize=(<span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>)) ax[<span class="hljs-number"><span class="hljs-number">0</span></span>].imshow(frame1) ax[<span class="hljs-number"><span class="hljs-number">1</span></span>].imshow(frame2);</code> </pre> <br><img src="https://habrastorage.org/webt/an/it/s5/anits5i5bvq4kreaodhtn1xtxeg.png"><br><br>  Versuchen wir, einen Punkt in der Mitte der Pfote des Kätzchens zu finden und ihn im zweiten Bild zu finden.  Nehmen Sie einen Bereich um ihn herum. <br><br><pre> <code class="python hljs">patch1 = frame1[<span class="hljs-number"><span class="hljs-number">90</span></span>:<span class="hljs-number"><span class="hljs-number">190</span></span>, <span class="hljs-number"><span class="hljs-number">140</span></span>:<span class="hljs-number"><span class="hljs-number">250</span></span>] plt.imshow(patch1);</code> </pre> <br><img src="https://habrastorage.org/webt/mr/he/rg/mrherghnedxhdep1yus3wvrtym8.png"><br><br>  Wir berechnen die Korrelation zwischen diesem Bereich (in der englischen Literatur wird häufig eine Vorlage oder ein Patch aus dem ersten Bild geschrieben) und dem zweiten Bild.  Die Vorlage „geht“ einfach durch das zweite Bild und berechnet den folgenden Wert zwischen sich und Teilen gleicher Größe im zweiten Bild: <br><br><img src="https://habrastorage.org/webt/iz/jz/vi/izjzvibw_g1nqwnpttrby6qtax8.png"><br><br>  Je größer der Wert dieses Werts ist, desto mehr sieht die Vorlage wie das entsprechende Stück im zweiten Bild aus.  Mit OpenCV kann dies folgendermaßen geschehen: <br><br><pre> <code class="python hljs">corr = cv2.matchTemplate(frame2, patch1, cv2.TM_CCORR_NORMED) plt.imshow(corr, cmap=<span class="hljs-string"><span class="hljs-string">'gray'</span></span>);</code> </pre><br>  Weitere Details finden Sie in [7]. <br><br>  Das Ergebnis ist wie folgt: <br><br><img src="https://habrastorage.org/webt/k0/k_/ph/k0k_phkyfonxwflqwatxrw6hynu.png"><br><br>  Wir sehen einen klaren Peak, der weiß angezeigt wird.  Finden Sie es im zweiten Frame: <br><br><pre> <code class="python hljs">min_val, max_val, min_loc, max_loc = cv2.minMaxLoc(corr) h, w, _ = patch1.shape top_left = max_loc bottom_right = (top_left[<span class="hljs-number"><span class="hljs-number">0</span></span>] + w, top_left[<span class="hljs-number"><span class="hljs-number">1</span></span>] + h) frame2_copy = frame2.copy() cv2.rectangle(frame2_copy, top_left, bottom_right, <span class="hljs-number"><span class="hljs-number">255</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) plt.imshow(frame2_copy);</code> </pre> <br><img src="https://habrastorage.org/webt/bo/11/v9/bo11v9zepjhqgzm5f_b6ckbrmbs.png"><br><br>  Wir sehen, dass der Fuß korrekt gefunden wurde. Anhand dieser Daten können wir verstehen, in welche Richtung er sich vom ersten zum zweiten Bild bewegt hat, und den entsprechenden optischen Fluss berechnen.  Zusätzlich stellt sich heraus, dass dieser Vorgang gegenüber photometrischen Verzerrungen, d. H.  Wenn die Helligkeit im zweiten Bild stark ansteigt, bleibt der Kreuzkorrelationspeak zwischen den Bildern bestehen. <br><br>  In Anbetracht all dessen entschieden sich die Autoren, die sogenannte Korrelationsschicht in ihre Architektur einzuführen, aber es wurde beschlossen, die Korrelation nicht gemäß den Eingabebildern, sondern gemäß den Attributkarten nach mehreren Schichten des Codierers zu berücksichtigen.  Eine solche Schicht hat aus offensichtlichen Gründen keine Lernparameter, obwohl sie im Wesentlichen der Faltung ähnlich ist, aber anstelle von Filtern verwenden wir hier keine Gewichte, sondern einen Bereich des zweiten Bildes: <br><br><img src="https://habrastorage.org/webt/j2/xx/bg/j2xxbga6vl1jvffhsbjzndhkul4.png"><br><br>  Seltsamerweise führte dieser Trick zu keiner signifikanten Verbesserung der Qualität der Autoren dieses Artikels. Er wurde jedoch erfolgreicher in weiteren Arbeiten angewendet, und in [9] konnten die Autoren zeigen, dass FlowNetC durch geringfügige Änderung der Trainingsparameter wesentlich besser funktionieren kann. <br><br>  Die Autoren lösten das Problem mit dem Fehlen eines Datensatzes auf ziemlich elegante Weise: Sie kratzten 964 Bilder von Flickr zu den Themen "Stadt", "Landschaft", "Berg" in der Auflösung 1024 × 768 und verwendeten ihre Ernte 512 × 384 als Hintergrund, die dann einige warf Stühle aus einem offenen Satz gerenderter 3D-Modelle.  Dann wurden verschiedene affine Transformationen unabhängig voneinander auf die Stühle und den Hintergrund angewendet, die verwendet wurden, um das zweite Bild in einem Paar und den optischen Fluss zwischen ihnen zu erzeugen.  Das Ergebnis ist wie folgt: <br><br><img src="https://habrastorage.org/webt/4y/s7/qn/4ys7qnoa1fn9s8kaw_kclb_dtig.png"><br><br><img src="https://habrastorage.org/webt/07/y2/k5/07y2k5ryvqboyvz6w8udnenc5fq.png"><br><br>  Ein interessantes Ergebnis war, dass die Verwendung eines solchen synthetischen Datensatzes es ermöglichte, eine relativ gute Qualität für Daten aus einer anderen Domäne zu erzielen.  Die Feinabstimmung der entsprechenden Daten hat natürlich mehr Qualitäten bewiesen (+ ft in der folgenden Tabelle): <br><br><img src="https://habrastorage.org/webt/vu/wz/vt/vuwzvtxwgfrwsl5okrh_bgrk9ao.png"><br><br>  Das Ergebnis auf echten Videos ist hier zu sehen: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/k_wkDLJ8lJE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h2>  SpyNet (2016) </h2><br>  In vielen nachfolgenden Artikeln versuchten die Autoren, die Qualität zu verbessern, indem sie das Problem der schlechten Erkennung plötzlicher Bewegungen lösten.  Intuitiv wird die Bewegung vom Netzwerk nicht erfasst, wenn ihr Vektor das Empfangsfeld der Aktivierung deutlich überschreitet.  Es wird vorgeschlagen, dieses Problem aufgrund von drei Dingen zu lösen: einer größeren Faltung, Pyramiden und dem "Verziehen" eines Bildes von einem Paar in einen optischen Strom.  Alles in Ordnung. <br><br>  Wenn wir also ein paar Bilder haben, in denen sich das Objekt stark verschoben hat (10+ Pixel), können wir das Bild einfach reduzieren (um das 6-fache oder mehr).  Der absolute Wert des Versatzes nimmt erheblich ab, und das Netzwerk kann ihn mit größerer Wahrscheinlichkeit „fangen“, insbesondere wenn seine Windungen größer sind als der Versatz selbst (in diesem Fall werden 7x7-Windungen verwendet). <br><br><img src="https://habrastorage.org/webt/ec/-w/c4/ec-wc4u9vfdfqhcw-auhrcbmdqo.jpeg"><br><br>  Beim Verkleinern des Bildes haben wir jedoch viele wichtige Details verloren. Daher sollten wir zur nächsten Ebene der Pyramide gehen, in der die Bildgröße bereits größer ist, und dabei die Informationen berücksichtigen, die wir zuvor erhalten haben, als wir den optischen Fluss bei einer kleineren Größe berechnet haben.  Dies erfolgt unter Verwendung des Warping-Operators, der das erste Bild gemäß der verfügbaren Annäherung des optischen Flusses (erhalten auf der vorherigen Ebene) wiedergibt.  Eine Verbesserung in diesem Fall besteht darin, dass das erste Bild, das gemäß der Annäherung des optischen Flusses "geschoben" wird, näher am zweiten liegt als das ursprüngliche, dh wir reduzieren erneut den absoluten Wert des optischen Flusses, den wir vorhersagen müssen (Rückruf, kleiner Wert) Bewegungen werden viel besser erkannt, da sie vollständig in einer Faltung enthalten sind.  Aus mathematischer Sicht kann der Warping-Operator mit einem Bitmap-Bild I und einer Approximation des optischen Flusses V wie folgt beschrieben werden: <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>w</mi><mo stretchy=&quot;false&quot;>(</mo><mi>I</mi><mo>,</mo><mi>V</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mi>I</mi><mi>w</mi></msub><mo>,</mo><mspace width=&quot;thickmathspace&quot; /><mspace width=&quot;thickmathspace&quot; /><msub><mi>I</mi><mi>w</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>I</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>+</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="36.715ex" height="2.66ex" viewBox="0 -832 15807.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-77" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-28" x="716" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-49" x="1106" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2C" x="1610" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-56" x="2055" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-29" x="2825" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-3D" x="3492" y="0"></use><g transform="translate(4548,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-77" x="622" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2C" x="5595" y="0"></use><g transform="translate(6596,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-77" x="622" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-28" x="7643" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-78" x="8033" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-29" x="8605" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-3D" x="9273" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-49" x="10329" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-28" x="10833" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-78" x="11223" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2B" x="12018" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-56" x="13018" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-28" x="13788" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-78" x="14177" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-29" x="14750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-29" x="15139" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2C" x="15529" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>w</mi><mo stretchy="false">(</mo><mi>I</mi><mo>,</mo><mi>V</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>I</mi><mi>w</mi></msub><mo>,</mo><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><msub><mi>I</mi><mi>w</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>I</mi><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mi>V</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>,</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-8"> w (I, V) = I_w, \; \; I_w (x) = I (x + V (x)), </script></p>  wo <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.032ex" height="2.66ex" viewBox="0 -832 3888.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-78" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-3D" x="850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-28" x="1906" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-69" x="2296" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2C" x="2641" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-6A" x="3086" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-29" x="3499" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-9"> x = (i, j) </script>  d.h.  ein bestimmter Punkt im Bild <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>I</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.172ex" height="2.057ex" viewBox="0 -780.1 504.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-49" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-10"> I </script>  - das Bild selbst <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.787ex" height="2.057ex" viewBox="0 -780.1 769.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-56" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>V</mi></math></span></span><script type="math/tex" id="MathJax-Element-11"> V </script>  - optischer Fluss <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>I</mi><mi>w</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.432ex" height="2.419ex" viewBox="0 -780.1 1047.1 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-77" x="622" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mi>w</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-12"> I_w </script>  - das resultierende Bild, "eingewickelt" in den optischen Strom. <br><br>  Wie kann man all dies in der CNN-Architektur anwenden?  Wir legen die Anzahl der Pyramidenebenen fest <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.057ex" viewBox="0 -780.1 521.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-6B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-13"> k </script>  und einen Faktor, um den jedes nachfolgende Bild auf einem Niveau reduziert wird, das vom letzten beginnt <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-6E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-14"> n </script>  .  Bezeichnen mit <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2217;</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.188ex" height="2.66ex" viewBox="0 -832 1803 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-28" x="523" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2217" x="913" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-29" x="1413" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mo stretchy="false">(</mo><mo>∗</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-15"> d (*) </script>  und <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>u</mi><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2217;</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.301ex" height="2.66ex" viewBox="0 -832 1852 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-75" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-28" x="572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2217" x="962" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-29" x="1462" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi><mo stretchy="false">(</mo><mo>∗</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-16"> u (*) </script>  die Downsampling- und Upsampling-Funktionen des Bildes oder des optischen Flusses um diesen Faktor. <br><br>  Wir erhalten auch eine Reihe von CNN-ok { <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mn>0</mn></msub><mo>.</mo><mo>.</mo><mo>.</mo><msub><mi>G</mi><mi>k</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.898ex" height="2.419ex" viewBox="0 -780.1 3831.2 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-47" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-30" x="1112" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2E" x="1240" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2E" x="1685" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2E" x="2130" y="0"></use><g transform="translate(2575,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-47" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-6B" x="1112" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>G</mi><mn>0</mn></msub><mo>.</mo><mo>.</mo><mo>.</mo><msub><mi>G</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-17"> G_0 ... G_k </script>  }, eine für jede Ebene der Pyramide.  Dann <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>i</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.626ex" height="2.419ex" viewBox="0 -780.1 1130.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-47" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-69" x="1112" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>G</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-18"> G_i </script>  -th Netzwerk akzeptiert ein paar Bilder mit <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="1.937ex" viewBox="0 -728.2 345.5 834" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-69" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-19"> i </script>  Pyramidenniveau und optischer Fluss berechnet am <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.727ex" height="2.539ex" viewBox="0 -780.1 2035.2 1093.4" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-47" x="0" y="0"></use><g transform="translate(786,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2212" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-31" x="1124" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-20"> G_ {i-1} </script>  Niveau ( <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mn>0</mn></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.881ex" height="2.419ex" viewBox="0 -780.1 1240.4 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-47" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-30" x="1112" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>G</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-21"> G_0 </script>  akzeptiert stattdessen nur einen Tensor von Nullen).  In diesem Fall senden wir eines der Bilder an die Verzerrungsschicht, um den Unterschied zwischen ihnen zu verringern, und wir sagen nicht den optischen Fluss auf dieser Ebene voraus, sondern den Wert, der zu dem erhöhten (hochgetasteten) optischen Fluss von der vorherigen Ebene addiert werden muss, um den optischen Fluss zu erhalten auf dieser Ebene.  In der Formel sieht es ungefähr so ​​aus: <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>v</mi><mi>k</mi></msub><mo>=</mo><msub><mi>G</mi><mi>k</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msubsup><mi>I</mi><mi>k</mi><mn>1</mn></msubsup><mo>,</mo><mi>w</mi><mo stretchy=&quot;false&quot;>(</mo><msubsup><mi>I</mi><mi>k</mi><mn>2</mn></msubsup><mo>,</mo><mi>u</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><msub><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="33.384ex" height="3.021ex" viewBox="0 -883.9 14373.7 1300.8" role="img" focusable="false" style="vertical-align: -0.969ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-6B" x="686" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-3D" x="1232" y="0"></use><g transform="translate(2288,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-47" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-6B" x="1112" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-28" x="3543" y="0"></use><g transform="translate(3933,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-31" x="740" y="488"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-6B" x="622" y="-463"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2C" x="4910" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-77" x="5355" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-28" x="6072" y="0"></use><g transform="translate(6461,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-32" x="740" y="488"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-6B" x="622" y="-463"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2C" x="7439" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-75" x="7884" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-28" x="8457" y="0"></use><g transform="translate(8846,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-56" x="0" y="0"></use><g transform="translate(583,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2212" x="521" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-31" x="1300" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-29" x="10803" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-29" x="11192" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2C" x="11582" y="0"></use><g transform="translate(12027,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-56" x="0" y="0"></use><g transform="translate(583,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2212" x="521" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-31" x="1300" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-29" x="13984" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>v</mi><mi>k</mi></msub><mo>=</mo><msub><mi>G</mi><mi>k</mi></msub><mo stretchy="false">(</mo><msubsup><mi>I</mi><mi>k</mi><mn>1</mn></msubsup><mo>,</mo><mi>w</mi><mo stretchy="false">(</mo><msubsup><mi>I</mi><mi>k</mi><mn>2</mn></msubsup><mo>,</mo><mi>u</mi><mo stretchy="false">(</mo><msub><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>,</mo><msub><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-22"> v_k = G_k (I_k ^ 1, w (I_k ^ 2, u (V_ {k-1})), V_ {k-1}) </script></p><br>  Um den optischen Stream selbst zu erhalten, fügen wir einfach das Netzwerkprädikat und den erhöhten Stream der vorherigen Ebene hinzu: <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>V</mi><mi>k</mi></msub><mo>=</mo><mi>u</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><msub><mi>v</mi><mi>k</mi></msub><mo>.</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.929ex" height="2.66ex" viewBox="0 -832 8150.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-6B" x="825" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-3D" x="1330" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-75" x="2386" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-28" x="2958" y="0"></use><g transform="translate(3348,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-56" x="0" y="0"></use><g transform="translate(583,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2212" x="521" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-31" x="1300" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-29" x="5304" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2B" x="5916" y="0"></use><g transform="translate(6917,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-6B" x="686" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2E" x="7871" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>V</mi><mi>k</mi></msub><mo>=</mo><mi>u</mi><mo stretchy="false">(</mo><msub><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>v</mi><mi>k</mi></msub><mo>.</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-23"> V_k = u (V_ {k-1}) + v_k. </script></p>  Um die Grundwahrheit für das Netzwerk auf dieser Ebene zu erhalten, müssen wir die entgegengesetzte Operation ausführen: Subtrahieren Sie das Prädikat vom Ziel (auf die gewünschte Ebene reduziert) von der vorherigen Ebene der Pyramide.  Schematisch sieht es so aus: <br><br><img src="https://habrastorage.org/webt/yh/sa/_1/yhsa_1bbklhllkzucdplckzkgk4.png"><br><br>  Der Vorteil dieses Ansatzes ist, dass wir jede Stufe unabhängig unterrichten können.  Die Autoren begannen mit dem Training ab Stufe 0, jedes nachfolgende Netzwerk wurde mit den Parametern des vorherigen initialisiert.  Da jedes Netzwerk <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>i</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.626ex" height="2.419ex" viewBox="0 -780.1 1130.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-47" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-69" x="1112" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>G</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-24"> G_i </script>  löst das Problem viel einfacher als die vollständige Berechnung des optischen Flusses in einem großen Bild, dann können die Parameter viel weniger gemacht werden.  So sehr, dass jetzt das gesamte Ensemble auf mobile Geräte passen kann: <br><br><img src="https://habrastorage.org/webt/hc/8o/hs/hc8ohs8qo36ifqfzlrxio5c6gas.png"><br><br>  Das Ensemble selbst ist wie folgt (ein Beispiel für eine Pyramide mit 3 Ebenen): <br><br><img src="https://habrastorage.org/webt/x1/5e/n1/x15en1dysqgqcbfs9qlmwqse7da.png"><br><br>  Es bleibt direkt über Architektur zu sprechen <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>i</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.626ex" height="2.419ex" viewBox="0 -780.1 1130.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-47" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-69" x="1112" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>G</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-25"> G_i </script>  vernetzen und Bilanz ziehen.  Jedes Netzwerk <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>i</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.626ex" height="2.419ex" viewBox="0 -780.1 1130.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-47" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-69" x="1112" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>G</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-26"> G_i </script>  besteht aus 5 Faltungsschichten, von denen jede mit der ReLU-Aktivierung endet, mit Ausnahme der letzten (die den optischen Fluss vorhersagt).  Die Anzahl der Filter auf jeder Ebene beträgt jeweils { <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>32</mn><mo>,</mo><mn>64</mn><mo>,</mo><mn>32</mn><mo>,</mo><mn>16</mn><mo>,</mo><mn>2</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.598ex" height="2.419ex" viewBox="0 -780.1 6285.2 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-33"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-32" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2C" x="1001" y="0"></use><g transform="translate(1446,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-36"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-34" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2C" x="2447" y="0"></use><g transform="translate(2892,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-33"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-32" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2C" x="3893" y="0"></use><g transform="translate(4338,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-36" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-2C" x="5339" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMAIN-32" x="5784" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>32</mn><mo>,</mo><mn>64</mn><mo>,</mo><mn>32</mn><mo>,</mo><mn>16</mn><mo>,</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-27"> 32, 64, 32, 16, 2 </script>  }.  Die Eingänge des neuronalen Netzwerks (das Bild, das zweite Bild, das in den optischen Strom „eingewickelt“ ist, und der optische Strom selbst) verketten sich einfach entsprechend der Dimension der Kanäle, sodass ihr Eingangstensor 8 hat. Die Ergebnisse sind beeindruckend: <br><br><img src="https://habrastorage.org/webt/sm/gf/s5/smgfs5juy2q0nnpv4gptlatevlw.png"><br><br><h2>  PWC-Net (2018) </h2><br>  Inspiriert vom Erfolg ihrer deutschen Kollegen beschlossen die Mitarbeiter von NVIDIA, ihre Erfahrungen (und Grafikkarten) einzusetzen, um das Ergebnis weiter zu verbessern.  Ihre Arbeit basierte größtenteils auf Ideen des Vorgängermodells (SpyNet), daher wird sich PWC-Net auch mit Pyramiden befassen, jedoch mit Faltungspyramiden, jedoch nicht mit den Originalbildern - in der richtigen Reihenfolge. <br><br>  Die Verwendung von Rohpixelintensitäten zur Berechnung des optischen Flusses ist nicht immer sinnvoll, da  Eine starke Änderung der Helligkeit / des Kontrasts wird unsere Annahme brechen, dass sich Pixel ohne Änderungen von einem Bild zum nächsten bewegen und der Algorithmus solchen Änderungen nicht widersteht.  In klassischen Algorithmen zur Berechnung des optischen Flusses werden verschiedene Transformationen verwendet, die diese Situation abschwächen. In diesem Fall haben die Autoren beschlossen, dem Modell die Möglichkeit zu geben, solche Transformationen selbst zu lernen.  Daher werden anstelle der Bildpyramide in PWC-Net Faltungspyramiden verwendet (daher der erste Buchstabe in Pwc-Net), d. H.  Nur Feature-Maps aus verschiedenen CNN-Layern, die hier als Feature-Pyramiden-Extraktor bezeichnet werden. <br><br>  Dann ist fast alles wie in SpyNet, kurz bevor Sie bei CNN, dem so genannten optischen Flussschätzer, alles einreichen, was Sie brauchen, nämlich: <br><br><ul><li>  Bild (in diesem Fall eine Feature-Map vom Feature-Pyramiden-Extraktor), </li><li>  der auf der vorherigen Ebene berechnete hochgetastete optische Fluss, </li><li>  das zweite Bild, „eingewickelt“ (erinnern Sie sich an die Verzerrungsschicht, daher der zweite Buchstabe in pWc-Net), in diesen optischen Strom, </li></ul><br>  Überlegen Sie zwischen dem „verpackten“ zweiten Frame und dem üblichen ersten (ich erinnere Sie noch einmal daran, dass hier anstelle von Rohbildern Feature-Karten mit Feature-Pyramiden-Extraktor verwendet werden), was als Kostenvolumen bezeichnet wird (daher der dritte Buchstabe in pwC-Net) und was im Wesentlichen bereits vorhanden ist zuvor betrachtete Korrelation zwischen zwei Bildern. <br><br><img src="https://habrastorage.org/webt/mh/f1/rl/mhf1rlctjqtb8pwymdzzlju1dpa.png"><br><br>  Der letzte Schliff ist das Kontextnetzwerk, das unmittelbar nach dem optischen Flussschätzer hinzugefügt wird und die Rolle der trainierten Nachbearbeitung für den berechneten optischen Strom spielt.  Architektonische Details können unter dem Spoiler oder im Originalartikel eingesehen werden. <br><br><div class="spoiler">  <b class="spoiler_title">Intime Details</b> <div class="spoiler_text">  Der Merkmalspyramidenextraktor hat also für beide Bilder die gleichen Gewichte. Undichte ReLU wird für jede Faltung als Nichtlinearität verwendet.  Um die Auflösung von Feature-Maps auf jeder nachfolgenden Ebene zu verringern, werden Faltungen mit Schritt 2 und verwendet <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>c</mi><mi>t</mi><mi>l</mi></msubsup></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.833ex" height="3.037ex" viewBox="0 -950 789.1 1307.5" role="img" focusable="false" aria-hidden="true" style="vertical-align: -0.83ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-63" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-6C" x="613" y="500"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-74" x="613" y="-395"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>c</mi><mi>t</mi><mi>l</mi></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-28"> c_t ^ l </script>  bedeutet Bild-Feature-Map <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="1.936ex" viewBox="0 -713 361.5 833.5" role="img" focusable="false" aria-hidden="true" style="vertical-align: -0.28ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-74" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-29"> t </script>  auf der Ebene <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>l</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.693ex" height="2.074ex" viewBox="0 -772.3 298.5 892.8" role="img" focusable="false" aria-hidden="true" style="vertical-align: -0.28ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhjqWGQgcJPDqacgMcOTDFASh--Ecw#MJMATHI-6C" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-30"> l </script>  . <br><br><img src="https://habrastorage.org/webt/er/m5/r3/erm5r3r3hriaukcisvezaosvfcu.png"><br><br>  Optischer Durchflussschätzer auf der 2. Ebene der Pyramide (zum Beispiel).  Hier gibt es nichts Ungewöhnliches, jede Faltung endet immer noch mit undichtem ReLU, mit Ausnahme der letzten, die den optischen Fluss vorhersagt. <br><br><img src="https://habrastorage.org/webt/rm/n4/jw/rmn4jwq6vf31ml4xe7-tnyyqkno.png"><br><br>  Das Kontextnetzwerk befindet sich immer noch auf derselben 2. Ebene der Pyramide. Dieses Netzwerk verwendet erweiterte Faltungen mit denselben undichten ReLU-Aktivierungen, mit Ausnahme der letzten Schicht.  Es empfängt den vom optischen Flussschätzer berechneten optischen Fluss und die Attribute von der zweiten Schicht vom Ende der Schicht mit demselben optischen Flussschätzer.  Die letzte Ziffer in jedem Block bedeutet Dilatationskonstante. <br><br><img src="https://habrastorage.org/webt/yj/wj/6r/yjwj6r38by_6fx3bxym5civ0pwu.png"><br><br></div></div><br>  Die Ergebnisse sind noch beeindruckender: <br><br><img src="https://habrastorage.org/webt/iy/8c/h3/iy8ch3ploolmtrinveqzokfehdo.png"><br><br>  Im Vergleich zu anderen CNN-Methoden zur Berechnung des optischen Flusses erzielt PWC-Net ein Gleichgewicht zwischen Qualität und Anzahl der Parameter: <br><br><img src="https://habrastorage.org/webt/te/3c/6n/te3c6n3jziiqxwv9cggfowif27u.png"><br><br>  Es gibt auch eine hervorragende Präsentation der Autoren selbst, in der sie über das Modell selbst und ihre Experimente sprechen: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/vVU8XV0Ac_0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h2>  Fazit </h2><br>  Die Entwicklung von Architekturen, die das Problem der optischen Flusszählung lösen, ist ein wunderbares Beispiel dafür, wie der Fortschritt in CNN-Architekturen und deren Kombination mit klassischen Methoden das beste und beste Ergebnis liefert.  Und während klassische CV-Methoden immer noch an Qualität gewinnen, geben die jüngsten Ergebnisse Hoffnung, dass dies behoben werden kann ... <br><br><h2>  Quellen und Links </h2><br>  1. FlowNet: Lernen des optischen Flusses mit Faltungsnetzwerken: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Code</a> . <br>  2. Optischer Fluss mit großer Verschiebung: Deskriptoranpassung bei der Schätzung der Variationsbewegung: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel</a> . <br>  3. Optische Flussschätzung unter Verwendung eines räumlichen Pyramidennetzwerks: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Code</a> . <br>  4. PWC-Net: CNNs für den optischen Fluss unter Verwendung von Pyramide, Verzerrung und Kostenvolumen: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Code</a> . <br>  5. Was Sie über den optischen Fluss wissen wollten, aber es war Ihnen peinlich zu fragen: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel</a> . <br>  6. Berechnung des optischen Flusses nach der Lucas-Canada-Methode.  Theorie: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel</a> . <br>  7. Template Matching mit OpenCVP: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dock</a> . <br>  8. Quo Vadis, Aktionserkennung?  Ein neues Modell und der Kinetik-Datensatz: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel</a> . <br>  9. FlowNet 2.0: Entwicklung der optischen Flussschätzung mit tiefen Netzwerken: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Code</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de446726/">https://habr.com/ru/post/de446726/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de446714/index.html">Neugierige Perversionen aus der IT-Welt - 4</a></li>
<li><a href="../de446716/index.html">Doomsday Bewusstsein und Argument</a></li>
<li><a href="../de446718/index.html">Rückblick auf die interessantesten Berichte des CodeFest 2019: Version von True Engineering</a></li>
<li><a href="../de446722/index.html">Tests zeigen: Wie Sie sich auf die Implementierung von Cisco ISE vorbereiten und welche Funktionen des Systems Sie benötigen</a></li>
<li><a href="../de446724/index.html">Wie iOS-Entwickler versuchen, mit Cloud Computing die Nase vorn zu haben</a></li>
<li><a href="../de446728/index.html">Wie sich die vom kabellosen Laden empfangene Leistung ändert, hängt vom Standort des Telefons ab</a></li>
<li><a href="../de446730/index.html">Backend-Bereich zu DUMP: Serverless, Postgres and Go, .NET Core, GraphQL und mehr</a></li>
<li><a href="../de446732/index.html">Feropoden werden nicht helfen: Forschung und mathematische Modellierung von Grubenfallen für Ameisenlöwenlarven</a></li>
<li><a href="../de446736/index.html">Oracle APEX Berichte</a></li>
<li><a href="../de446738/index.html">Grundlagen der Verarbeitung natürlicher Sprache für Text</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>