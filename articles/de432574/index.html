<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèª‚Äçüåæ üëÉüèæ üéã Anspruchsvolles Design einfacher Ger√§te üìø ü§öüèº üë®üèº‚Äçüéì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Gr√º√üe an den Leser! Heute werde ich Ihnen eine merkw√ºrdige Geschichte erz√§hlen, die mich √ºber die Probleme nachdenken lie√ü, die bei der falschen (nich...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Anspruchsvolles Design einfacher Ger√§te</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/432574/"> Gr√º√üe an den Leser!  Heute werde ich Ihnen eine merkw√ºrdige Geschichte erz√§hlen, die mich √ºber die Probleme nachdenken lie√ü, die bei der falschen (nicht optimalen) Auswahl von Komponenten f√ºr die Implementierung eines elektronischen Produkts auftreten.  Und auch √ºber die scheinbare Einfachheit am Beispiel eines Eintagesger√§ts. <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/uv/9g/hg/uv9ghgxb_nswu_pvba8bbjt5jp0.jpeg" width="450"></div><a name="habracut"></a>  Lassen Sie uns zustimmen, dass die Geschichte fiktiv ist, alle Zuf√§lle zuf√§llig sind ... oder nicht zuf√§llig. <br>  Einmal wandte sich Seryozha, der Programmierer, an mich mit der Bitte, ein Ger√§t in seinem Auto herzustellen, das das sequentielle Dr√ºcken von 2 virtuellen Tasten beim Dr√ºcken eines physischen Autos in der Geschwindigkeitsregelung (Ford Focus 2) nachahmt.  Das Schema der Standardsteuereinheit ist wie folgt: <br><br><img src="https://habrastorage.org/webt/wu/yr/j3/wuyrj3rbtekr3o9zd3ogzyybvsg.png"><br><br>  Auf der Steuerseite ist dies ein klassischer Druckknopf-Eingang mit einem ADC.  Wenn Sie also die Hardwaretaste dr√ºcken, dr√ºcken Sie nacheinander die Tasten ON und SET + f√ºr eine Zeit von ~ 0,2 s.  Um die Integration des Ger√§ts zu vereinfachen, wurde beschlossen, es √ºber den oberen Widerstand des Teilers mit Strom zu versorgen.  Die Spannung an den Anschlussklemmen betr√§gt 4,6 V ohne angeschlossenen Tastenkreis.  Da das Ger√§t abends hergestellt werden sollte, erstellte ich ein Diagramm ohne vorl√§ufige Berechnungen von dem, was auf dem Montagetisch lag.  Die L√∂sung "in der Stirn": <br><br><img src="https://habrastorage.org/webt/xz/vg/4j/xzvg4jaka9aknb__8taqs7pwrmw.png"><br><br>  Serezha schrieb die Firmware und das Ger√§t funktionierte perfekt f√ºr Autos.  In dem Moment, als sie das Board in das Geh√§use des Lenks√§ulenschalters packen wollten, rief jemand von der R√ºckseite des B√ºros: ‚ÄûIst es so kompliziert?  Die H√§lfte der Details kann weggeworfen werden, und tats√§chlich ist STM8 genau das Richtige f√ºr eine solche Aufgabe. ‚Äú  Und es begann ... Der Autor der Idee meldete sich freiwillig, um das Layout "aus 3 Teilen" zu l√∂ten (anscheinend in Erwartung eines leichten Sieges).  Ich (geleitet von meinem eigenen Artikel √ºber <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">berufliche Eifersucht</a> ) beschloss, den Flug des jungen Spezialisten nicht zu st√∂ren, sondern mich erst zu dem Zeitpunkt zu verbinden, als allen klar wurde, dass kein Wunder geschehen war. <br><br>  Das von meinem Kollegen vorgeschlagene Schema war wirklich einfacher, funktionierte aber nur am Tisch: <br><br><img src="https://habrastorage.org/webt/pb/fc/yk/pbfcykqizfvig66cx0l3zo2e008.png"><br><br>  Fehler waren bereits auf den ersten Blick sichtbar, ich entschied mich jedoch daf√ºr, die Schaltung speziell f√ºr den STM8S001J3 MK zu verwenden. <br><br>  Um zu verstehen, wie die Schaltung wiederhergestellt wird, werden wir mehrere Messungen durchf√ºhren.  Der Widerstand des oberen Widerstands im ADC-Teiler betr√§gt ~ 130 Ohm und die Spannung ohne Last betr√§gt 4,6 V. <br><br>  Dann hat das Schaltfl√§chenknotendiagramm die Form: <br><br><img src="https://habrastorage.org/webt/g4/th/-g/g4th-gpsd2dzk3czstorlhjcati.png"><br><br><ul><li>  Wenn die Tasten losgelassen werden, betr√§gt der Strom in der Schaltung 2 mA, die Spannung am ADC-Eingang betr√§gt 4,33 V; </li><li>  Wenn die EIN-Taste 3,7 mA gedr√ºckt wird, betr√§gt die Spannung am Eingang des ADC 4,11 V; </li><li>  Bei gedr√ºckter SET-Taste + 18,4 mA betr√§gt die Spannung am ADC-Eingang 2,2 V. </li></ul><br>  Gleichzeitig betr√§gt der Betriebsspannungsbereich des STM8S001J3 MK 2,95-5,5 V. Es stellt sich heraus, dass ein Versuch, die SET + -Taste zu dr√ºcken, zu einem Spannungsabfall unter das Minimum f√ºhrt und der MK zur√ºckgesetzt wird. <br><br>  An dieser Stelle schlage ich vor, abzulenken und zu diskutieren, was das ideale MK f√ºr diese Aufgabe ist und warum sie es nicht gew√§hlt haben.  Verwenden Sie f√ºr solche Handwerke normalerweise das, womit der Entwickler arbeiten kann und was zur Hand ist.  Zum Beispiel verf√ºgt der Mikrochip √ºber PIC10F200- oder ATtiny10-Controller im SOT23-6-Geh√§use mit einem Spannungsbereich von 2 (1,8) - 5,5 V. Diese Mikroschaltungen ben√∂tigen keinen Spannungsregler (wie STM32L031), starten jedoch nicht neu, wenn die SET + -Taste gedr√ºckt wird (wie STM8S001J3).  Im Kabelbaum befinden sich nur 2 Widerst√§nde und ein Kondensator.  Sch√∂nheit, aber die STMicro-Reihe von Controllern mit diesem Leistungsbereich ist es nicht.  Ein aufmerksamer Leser wird zu Recht feststellen, dass im Rahmen einer solchen Aufgabe fast jeder Controller beherrscht werden kann, aber das Fehlen einer vertrauten Programmierumgebung und von Debugging-Tools die Wahl bestimmt. <br>  Zur√ºck zum Schema.  Um das Problem mit dem Zur√ºcksetzen des Controllers zu l√∂sen, ben√∂tigen wir Energie, um den Controller mit Strom zu versorgen, w√§hrend die SET + -Taste gedr√ºckt wird.  Um die Menge dieser Energie abzusch√§tzen, muss der Stromverbrauch gemessen werden (oder siehe Dokumentation): <br><br><img src="https://habrastorage.org/webt/sc/70/vu/sc70vuonse7-qjwdmc6a2fh4zaa.png"><br><br>  Fast 500 ŒºA von seiner besten Seite.  Das ist viel, aber um es klar zu machen, werde ich eine Berechnung geben.  Um Energie zu speichern, ben√∂tigen wir eine Diode (VD1) und einen Kondensator (C1): <br><br><img src="https://habrastorage.org/webt/si/2q/fe/si2qfeyf6zzawldlp-kk863noz0.png"><br><br>  Der Abfall an VD1 betr√§gt 0,2 V, wenn die C1-Tasten losgelassen werden, wird er auf 4,33 - 0,2 = 4,13 V aufgeladen. Wenn Sie die SET + -Taste dr√ºcken, f√§llt die Spannung an Vin auf 2,2 V ab, VD1 schlie√üt und MK angetrieben durch Entladung C1. <br><br><img src="https://habrastorage.org/webt/zn/by/cg/znbycg5v4zszjmr8uqvprphihce.png"><br><br>  (Danke an <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">VT100</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">DenisHW f√ºr die Behebung des Fehlers</a> ) <br>  In diesem Ausdruck ist die im Kondensator links gespeicherte Energie (wenn sie von 4,13 auf 3,1 V entladen wird) die Energie, die der Regler rechts f√ºr eine Zeit t = 0,2 s verbraucht.  Dann ist die Kapazit√§t des Kondensators: <br><br><img src="https://habrastorage.org/webt/yx/cf/l8/yxcfl8hijew86jmxqjkwvfeedic.png"><br><br>  100 Mikrofarad f√ºr diese Aufgabe sind tolerierbar, aber versuchen Sie, den Controller einzuschl√§fern, w√§hrend die Taste gedr√ºckt wird. <br><br>  Dazu verf√ºgt der STM8 √ºber einen aktiven Halt-Modus: <br><br><img src="https://habrastorage.org/webt/0n/mi/g9/0nmig9qr2gusc-np2serzxf0pim.png"><br><br>  Durch Deaktivieren von MVR und Flash konnte ein Verbrauchsstrom von ~ 40 ŒºA erzielt werden (dieser ist deutlich h√∂her als der deklarierte Strom, dieser Strom ist jedoch f√ºr diese Aufgabe geeignet). Dank AWU (Auto Wake Up Unit) k√∂nnen Sie das Aufwecken nach 256 ms nach dem Einschlafen problemlos einstellen.  In diesem Fall wird zur Sicherstellung des Betriebs des Reglers ein Kondensator mit einer Kapazit√§t von nur 10 ŒºF ben√∂tigt. Da es jedoch nach dem Festklemmen der Beine einige Zeit dauert, bis der MK einschl√§ft, betrug die erforderliche und ausreichende Kapazit√§t 47 ŒºF. <br><br>  Es scheint, dass alle Probleme gel√∂st wurden, aber es gibt noch einen, ABER.  Der Strom, wenn die SET-Taste + 18,4 mA gedr√ºckt wird, ist kleiner als der Grenzstrom f√ºr den Ausgang, aber die logische Nullspannung liegt im Bereich von 0,7 V. Dies f√ºhrt zu einem Stromabfall durch den Widerstand und erfordert entweder eine Neuberechnung des Widerstands oder die Verwendung eines externen Transistors gem√§√ü dem Schema mit offenem Abfluss.  Ich habe die zweite Option als vorhersehbarer im Verhalten gew√§hlt.  Das endg√ºltige Schema hatte die Form: <br><br><img src="https://habrastorage.org/webt/fn/7j/kx/fn7jkxbq6apqrnqzcudayesbwyo.png"><br><br>  In dieser Form hat es erfolgreich verdient und ist bis heute in Betrieb. <br><br>  <b>Anstelle einer Schlussfolgerung</b> <br><br>  In diesem Artikel m√∂chte ich auf das Problem aufmerksam machen, wie ein Entwickler f√ºr einen √ºberm√§√üig oberfl√§chlichen oder leichtfertigen Ansatz bei der Entwicklung eines einfachen (auf den ersten Blick) Ger√§ts bestraft wird.  Andererseits wollte ich zeigen, wie die nicht optimale Wahl der Hauptelementbasis (in diesem Fall MK) den Entwicklungsprozess und das Produkt selbst aus zwei Hauptgr√ºnden kompliziert: <br><br><ol><li>  Die Notwendigkeit, die Auswahl der technischen L√∂sungen an die F√§higkeiten des Programmierers anzupassen. </li><li>  Unf√§higkeit, die gesamte Palette der f√ºr die Aufgabe geeigneten Komponenten zu erfassen und "die meisten" auszuw√§hlen.  Diese Faktoren erkl√§ren meistens die Tatsache, dass viele Ger√§te (Haushalt, Gewerbe, Spezial) gut funktionieren, aber nicht so hergestellt werden, wie Sie es tun w√ºrden. </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de432574/">https://habr.com/ru/post/de432574/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de432562/index.html">Techday Make IT Real - 17. Dezember, Moskau</a></li>
<li><a href="../de432564/index.html">Rust 2018 kam heraus ... aber was ist das?</a></li>
<li><a href="../de432566/index.html">Zwei Welten oder "Ingenieure haben etwas zu sagen." Zu den verschiedenen Arten komplexer Aufgaben und den damit verbundenen Prozessen</a></li>
<li><a href="../de432568/index.html">‚ÄûWenn Sie der Chefredakteur von Rusbase sind‚Äú: Ein neuer Podcast √ºber die Arbeit mit Inhalten und eine Karriere in Technologiemedien</a></li>
<li><a href="../de432572/index.html">Der Metall-Luft-Transistor wird das Moore'sche Gesetz erweitern - wie Technologie funktioniert</a></li>
<li><a href="../de432576/index.html">Unter der Haube eines JobIntentService</a></li>
<li><a href="../de432578/index.html">China best√§tigt F√ºhrung bei der asiatischen Mondrasse</a></li>
<li><a href="../de432580/index.html">Was durchbohrt die KI, wenn sie menschliche Gesichter erzeugt?</a></li>
<li><a href="../de432584/index.html">China ist f√ºhrend in Quantenkryptografiesystemen</a></li>
<li><a href="../de432586/index.html">Atomic CSS - Ordnung und Sauberkeit</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>