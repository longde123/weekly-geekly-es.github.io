<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💓 ☔️ 🏂 Ein weiteres Smart-Home-Gerät 🙆🏾 👨🏻‍⚕️ 🤽🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Eintrag 
 Ich bin seit drei Jahren in der Heimautomation tätig und versuche, alle neuen Geräte in diesem Bereich im Auge zu behalten. Vor kurzem fiel ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ein weiteres Smart-Home-Gerät</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/410597/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/b8/7e/rp/b87erppacywqripfkc5as0cvpxu.png"></div><br><h3>  Eintrag </h3><br>  Ich bin seit drei Jahren in der Heimautomation tätig und versuche, alle neuen Geräte in diesem Bereich im Auge zu behalten.  Vor kurzem fiel die Ausstellung einem neuen Gerät der heimischen Produktion auf.  Nachdem ich im Internet gesucht hatte, fand ich keine Informationen über sie.  Ich dachte komisch und beschloss, den Hersteller zu kontaktieren (ich werde es nicht angeben).  Nach dem Gespräch gelang es mir, einen Monat lang ein Testmuster zu bekommen.  Einen Monat später beschloss ich, meine Eindrücke über dieses Produkt zu teilen. <br><br><h3>  Beschreibung vom Hersteller </h3><br>  Laut Hersteller ist das untersuchte Gerät eine Plattform, mit der Sie automatisierte Systeme zur Überwachung und Verwaltung von Infrastruktureinrichtungen erstellen können.  Mit der Plattform können Sie sowohl zentralisierte als auch verteilte Systeme entwickeln, einschließlich der Verbindung von Smart-Geräten. Die Funktionsmerkmale des Systems werden von der installierten Software bestimmt. <br><br>  Der Hersteller erklärt die folgenden Eigenschaften des Geräts: <br><a name="habracut"></a><table><tbody><tr><td>  CPU </td><td>  • CPU: Allwinner H5 ， Quad-Core 64-Bit-Cortex A53 <br>  • RAM: 1 GB <br>  • Speicher: 8 GB eMMC, MicroSD-Karte </td></tr><tr><td>  Operationssystem </td><td>  • Linux Debian oder Ubuntu </td></tr><tr><td>  Kommunikation </td><td>  • Netzwerk: Gbit / s-Ethernet <br>  • WiFi: 802.11b / g / n <br>  • Bluetooth: 4.0 Dual-Modus <br>  • Radio: 2,4 GHz <br>  • 2 x USB-Host <br>  • 1 x RS485 </td></tr><tr><td>  Eingangs- / Ausgangsanschlüsse </td><td>  • 4 "trockene" Kontakte 350 V / 120 mA <br>  • 4 Ausgänge 12 V / 1A <br>  • 4 Eingänge 0 - 12 v </td></tr><tr><td>  Statusanzeige </td><td>  • OLED-Anzeige <br>  • LED </td></tr><tr><td>  Ernährung </td><td>  • DC 12 v </td></tr></tbody></table><br><h3>  Wir bereiten den Kunden vor <br></h3><br>  Das Gerät ist in zwei Versionen erhältlich: Bare Metal und eine vorgefertigte Lösung mit Software.  Ich habe die erste Option, aber noch interessanter - dort kann man Fantasie tummeln. <br><br>  Das Aussehen des Gerätes ist ziemlich asketisch: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/b8/7e/rp/b87erppacywqripfkc5as0cvpxu.png"></div><br>  Das Gerätegehäuse ermöglicht die Montage in einem Schrank auf einer DIN-Schiene und nimmt vier Module in der Breite ein. <br><br>  Auf der Vorderseite befinden sich: <br><br><ul><li>  Anzeige </li><li>  vier Knöpfe; </li><li>  LED-Anzeige des Gerätestatus („rot“ - deaktiviert, „grün“ - Stromversorgung, „blau“ - zeigt Prozessoraktivität an); </li></ul><br>  Unter der Decke befinden sich: <br><br><ul><li>  E / A-Anschlüsse (auf den ersten Blick schien es mir, dass ihre Anzahl möglicherweise nicht ausreicht, aber ich werde diesen Moment etwas niedriger kommentieren); </li><li>  RS485-Schnittstelle </li><li>  Stromanschluss. </li></ul><br>  Alle Stecker sind festgezogen, was mich glücklich gemacht hat, weil ich nicht gerne klemme.  Auf der rechten Seite der Box befinden sich keine Anschlüsse und Bedienelemente, was im Allgemeinen für eine engere Installation der Geräte im Schrank hilfreich sein kann. <br><br>  Alle Steckverbinder sind auf der linken Seite montiert: <br><br><ul><li>  abnehmbare WiFi-Antenne; </li><li>  2 USB; </li><li>  1 Eth </li><li>  Audio-Buchse. </li></ul><br>  Die WiFi-Antenne stört den Anschluss von USB-Geräten und Netzwerkkabeln.  Es muss entweder heruntergedreht oder mit einem Kabel an die Vorderseite des Gehäuses gebracht werden. Die zweite Option ist wahrscheinlich korrekter, wodurch der Signalpegel verbessert wird. <br><br>  Wir fahren mit der "Öffnung des Patienten" fort (der gesamte Koffer ist auf Riegeln montiert, es ist nicht schwer, ihn zu zerlegen) und sehen, woraus er besteht. Öffnen Sie die vordere Abdeckung und sehen Sie: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ka/j4/d4/kaj4d4omm3_z-78fnhmpqiv5ws4.png"></div><br><ul><li>  OLED-Display SSD1306 (128x64px): Der Bildschirm ist zwar klein, aber Sie können nur minimale Informationen erhalten. </li><li>  Vier Tasten zur lokalen Steuerung des Geräts, gemessen an der Bezeichnung, zur Steuerung der Ausgabe von Informationen auf dem Bildschirm; </li><li>  Energieverwaltungstaste (wie ATtiny13 später für die Energieverwaltung herausgefunden hat); </li><li>  RGB LED </li><li>  Unter der Beschriftung befindet sich die Antenne des Funkmoduls. </li></ul><br>  Wir gehen weiter - öffnen Sie das Gehäuse und sehen Sie, dass das Gerät aus drei Karten besteht: Die Hauptplatine, die Prozessorkarte ist daran befestigt, und die "obere" Karte, deren Vorderseite oben beschrieben ist, ist über ein Kabel mit ihr verbunden.  Wir untersuchen sie genauer: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lt/ty/hz/lttyhznbz7tcf5yn8dzppnqxjtc.png"></div><br><br><ul><li>  Das Prozessormodul ist ein Einplatinencomputer NanoPi NEO Plus2.  Nicht zu hochgespieltes OBC, aber aus technischer Sicht sehr interessant.  Sie können hier darüber lesen. </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gp/3p/x-/gp3px-m9pebjgkevd2dnqi-fsbm.png"></div><br>  Auf der Hauptplatine befindet sich: <br><br><ul><li>  Schutz vor Polaritätsumkehr (wir haben über „Schutz vor Narren“ schon nicht schlecht nachgedacht); </li><li>  Der DC-DC-Wandler des XL4005E1 5A war froh, dass er nicht auf der leistungsstarken Schottky-Diode (12A) stand, aber die Spule ist mit einem dünnen Draht umwickelt - 3A ziehen, aber ich würde sie nicht mehr laden. Die Kühlpolygone des Wandlers befinden sich auf der Rückseite der Platine erhöht das Vertrauen in die Arbeit (der Konverter von ATtiny13 wird gesteuert); </li><li>  Der Rest der Details ist in Standardschemata enthalten: der Spannungsregler AMS 1117 für 3,3 V, der Extender MCP23017, der SP3485 für die Organisation der RS485-Schnittstelle, der 16-Bit-ADC ADS1115, das Vorhandensein des Atmosphärendrucksensors BMP180 angenehm überrascht. </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qk/iw/r_/qkiwr_vhzvpuc6l9aii7ovcb6u0.png"></div><br>  Auf der Rückseite der „oberen“ Platine sind installiert: <br><br><ul><li>  RTC-Modul DS3231; </li><li>  PCF8574-Port-Expander, der für die Verarbeitung von Tastenklicks verantwortlich ist; </li><li>  Funkmodul nRF24L01P mit Verstärker. </li></ul><br><h3>  Verwendung und Programmierung </h3><br>  Wie ich bereits sagte, bekam ich Bare Metal und musste die Funktion der Module überprüfen und selbst Skripte erstellen.  Er hat nicht philosophiert, Armbian hat die Linux-Assembly übernommen und die gesamte Programmierung in Python durchgeführt - schnell, billig und fröhlich!  Alle Mikroschaltungen sind einer Vielzahl von Amateurfunkbegeisterten bekannt, und es wird nicht schwierig sein, eine Beschreibung und grundlegende Verwendungsmethoden zu finden. <br><br>  Nach dem Studium des Geräts wurde eine ungefähre Liste der Aufgaben erstellt: <br><br><ol><li>  Verbinden Sie die Schütze 220V über die Ausgänge der "trockenen" Kontakte.  (Holen Sie sich steuerbare Stromleitungen) </li><li>  An zwei 12V / 1A-Ausgänge und zwei Eingänge werden Standard-Sicherheits- und Feuersensoren angeschlossen.  (Besorgen Sie sich ein Sicherheits- und Feuersystem ohne Zugriff auf die Fernbedienung, dies ist jedoch häufig nicht erforderlich.) </li><li>  Mit elektrischem Antrieb 12 V an freie Ein- und Ausgänge, Lecksensoren und Kugelhähne anschließen.  (Schutz vor Undichtigkeiten). </li><li>  Erhöhen Sie den WEB-Server und schreiben Sie eine Verwaltungsschnittstelle (Get Remote Control). </li><li>  Überprüfen Sie die Verbindung zusätzlicher Geräte über Funk, WLAN und RS485 (Überprüfen Sie die Möglichkeit, ein verteiltes Netzwerk aufzubauen). </li><li>  Überprüfen Sie die Funktion des USB-Modems. </li><li>  Überprüfen Sie den Betrieb als Router. </li></ol><br><img src="https://habrastorage.org/webt/zc/za/cu/zczacu4t1wrx2kogetbvn3kx53u.png"><br><br>  Zum Testen baute ich schnell einen Ständer zusammen und begann Spaß zu haben: <br><br>  ATtiny13 wurde bereits programmiert, ich habe es nicht angefasst, es soll gemäß dem Plan des Herstellers für die Stromversorgung verantwortlich sein. <br><br>  MCP23017, ADS1115, PCF8574, DS3231, BMP180 - all dies funktioniert gemäß I2C, sodass das Verständnis der Funktionsweise dieses Busses sofort etwa 80% des Codes bestimmt.  Alles lief (wie erwartet) an, da die Adressierung der Geräte bereits vom Hersteller festgelegt wurde. <br><br>  nRF24L01P läuft auf dem SPI-Bus, wofür auch Beispiele ausreichen.  Ich habe ein Paar Geräte auf Arduino kontaktiert, alles funktioniert wie vorgesehen. <br><br>  Der RS485 wurde im Modbus-Protokoll mit einem Eastron SDM220-Leistungsmesser getestet.  Ablesungen werden vorgenommen, es sind keine Überraschungen aufgetreten. <br><br>  Der USB-Stecker im Huawei E1550-Modem bestimmte alles, nahm den VPN-Client und kontaktierte den Heimserver.  Installierte einen Webserver und spielte mit der Fernbedienung. <br><br>  Das WiFi-Modul arbeitet sowohl im Client-Modus als auch im Access Point-Modus.  Er versetzte das Modul in den AP-Modus, installierte einen DHCP-Server, konfigurierte iptables und erhielt einen WLAN-Router. <br><br>  Die Installation eines lokalen Blynk-Servers verursachte keine Probleme.  Überprüfte Arbeit mit ESP8266.  Die Steuerung vom Smartphone funktioniert, die Messwerte werden angezeigt. <br><br>  Damit alle Aufgaben erledigt sind, wurde das zentrale Gerät des Smart Home gestartet!  Es scheint, dass alles einfach und programmiert programmiert, konfiguriert ist, oder ich bin ein Genie. <br><br>  Ich versichere Ihnen, das ist nicht so!  Ich bin bereits auf die meisten Mikroschaltungen und Module gestoßen, also bin ich früher auf einen Rechen getreten und meine Stirn tat sehr weh , aber die Unebenheiten gingen vorbei, aber das Wissen blieb! <br><br>  Die Leistung des Prozessormoduls ist mehr als ausreichend, um meine Aufgaben zu lösen. Während des Testens betrug die durchschnittliche Belastung des Prozessors nicht mehr als 15%.  Das Vorhandensein von eMMC-Speicher und MicroSD-Karten ermöglicht das Duplizieren von Betriebssystemen und Software.  Der Verbrauch ohne Anschluss von USB-Geräten beträgt ca. 300 mA.  Mit dieser Art von Verbrauch wird es nicht schwierig sein, eine unterbrechungsfreie Stromversorgung aus einer Batterie von Stunden für 5 Arbeiten zu organisieren. <br><br>  Die ausgewählte Elementbasis für den Bau von Peripheriegeräten ist sehr zuverlässig, was Vertrauen in den problemlosen Betrieb des Geräts im 24x7-Modus gibt. <br><br>  Das Vorhandensein einer kleinen Anzahl von Ein- und Ausgängen am Gerät selbst wird durch das Vorhandensein eines 485-Busses und eines Funkmoduls vollständig kompensiert, dh der Aufbau eines verteilten Steuerungssystems wird nicht sehr schwierig, und die an Bord befindlichen Ein- und Ausgänge können für die lokale Steuerung im Schaltschrank verwendet werden. <br><br><h3>  Schlussfolgerungen </h3><br>  Wird dieses vom Hersteller deklarierte Gerät alle intelligenten Geräte integrieren?  Mit einer Strecke kann man sagen, dass es wird.  Leider gibt es nicht genügend Funkmodul für 433 MHz, CAN-Bus, ZigBee-Unterstützung, aber das Vorhandensein von RS485, Funkmodul mit 2,4 GHz und WLAN ermöglicht den Anschluss einer ausreichenden Anzahl von Geräten, und Kommunikationsprotokolle können in Software implementiert werden. <br><br>  Ich wiederhole, das fragliche Gerät besteht aus zwei Versionen: einer vollständig vorgefertigten Lösung zum Aufbau eines verteilten Steuerungssystems und nur Hardware.  Meiner Meinung nach kann eine fertige Lösung nur gekauft werden, wenn Sie sich nicht mit Programmierung und Faulheit befassen möchten.  In anderen Fällen ist es viel interessanter, die Plattform zu nehmen und selbst zu programmieren. <br><br>  Die Kosten für das Gerät sind mir derzeit nicht bekannt.  Meiner Meinung nach, wenn der Hersteller nicht den Preis von mehr als 13 tr fährt.  Für die "nackte" Version ist dieses Gerät dann sehr interessant zu kaufen.  Wenn Sie alle Teile in China gekauft und in einem einzigen Paket verpackt haben, werden Sie wahrscheinlich nicht billiger. <br><br>  Ein Wettbewerber kann <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wiren Board 5 sein</a> .  Es gewinnt an Anzahl der Ports und möglichen Schnittstellen, verliert jedoch an Leistung des Prozessormoduls.  Dies wirkt sich nicht auf Standardaufgaben aus, aber die lokale Installation eines Blynk-Servers oder die Erstellung eines Sprachsteuerungsmoduls kann problematisch sein.  Wenn jemand versucht hat, dies auf WB5 zu tun, kommentieren Sie bitte in den Kommentaren. <br><br>  <b>PS:</b> Nachdem ich den Artikel bereits fertiggestellt hatte, fand ich auch den ATSHA204-Kryptographie-Chip auf der Platine.  Es unterstützt den kryptografischen SHA-256-Algorithmus und eignet sich hervorragend für symmetrische Authentifizierungsaufgaben.  Nun, das ist absolut für die Geeks! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de410597/">https://habr.com/ru/post/de410597/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de410585/index.html">Wie werde ich ein Zauberer (Teil 1)</a></li>
<li><a href="../de410587/index.html">Apple beabsichtigt, Kobalt ausschließlich von Bergbauunternehmen zu kaufen</a></li>
<li><a href="../de410589/index.html">Meeresökosysteme, die sich an die globale Erwärmung anpassen können</a></li>
<li><a href="../de410591/index.html">Die emotionale Geschichte der Prozessoren für die ersten Computer von den 70ern bis zu den frühen 90ern</a></li>
<li><a href="../de410593/index.html">Telegramm führt eine weitere Runde von ICO durch</a></li>
<li><a href="../de410599/index.html">Eine Welle von Gerätediebstählen von Bergbaubetrieben fegte über Island</a></li>
<li><a href="../de410601/index.html">Was ist heute pädagogische Robotik?</a></li>
<li><a href="../de410603/index.html">Manifest der Angemessenheit</a></li>
<li><a href="../de410605/index.html">Amateurastronom testete eine neue Kamera und fotografierte versehentlich eine Supernova</a></li>
<li><a href="../de410607/index.html">SpaceX arbeitet weiter: die ersten beiden Satelliten des globalen drahtlosen Internet-Netzwerks und die Jagd nach Verkleidungen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>