<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õµÔ∏è üë∞üèΩ üë©üèª‚Äç‚úàÔ∏è Points de contr√¥le virtuels: liste de contr√¥le de configuration üåô üí¥ üßëüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="De nombreux clients qui nous louent des ressources cloud utilisent des points de contr√¥le virtuels. Avec leur aide, les clients r√©solvent divers probl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Points de contr√¥le virtuels: liste de contr√¥le de configuration</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dataline/blog/442880/"><img src="https://habrastorage.org/webt/o2/xl/gk/o2xlgke6hdhz3btlzb10ynfm5r4.png"><br><br>  De nombreux clients qui nous louent des ressources cloud utilisent des points de contr√¥le virtuels.  Avec leur aide, les clients r√©solvent divers probl√®mes: quelqu'un contr√¥le l'acc√®s du segment serveur √† Internet ou publie leurs services pour nos √©quipements.  Quelqu'un doit ex√©cuter tout le trafic via la lame IPS, tandis que quelqu'un a besoin de Check Point comme passerelle VPN pour acc√©der aux ressources internes du centre de donn√©es √† partir des succursales.  Il y a ceux qui ont besoin de prot√©ger leur infrastructure dans le cloud pour passer la certification selon FZ-152, mais je vais vous en parler s√©par√©ment. <br><br>  En service, je participe au soutien et √† l'administration des points de contr√¥le.  Aujourd'hui, je vais vous dire ce qu'il faut consid√©rer lors du d√©ploiement d'un cluster de points de contr√¥le dans un environnement virtuel.  Je vais aborder des moments du niveau de virtualisation, du r√©seau, des param√®tres de Check Point lui-m√™me et de la surveillance. <br>  Je ne promets pas de d√©couvrir l'Am√©rique - beaucoup est dans les recommandations et les meilleures pratiques du vendeur.  Mais personne ne les lit), alors ils ont conduit. <br><a name="habracut"></a><br><h3>  Mode cluster </h3><br>  Nous avons Check Points en direct dans des clusters.  L'installation la plus courante est un cluster de deux n≈ìuds en mode veille active.  Si quelque chose arrive au n≈ìud actif, il devient inactif et le n≈ìud de secours est activ√©.  Le passage √† un n≈ìud ¬´de rechange¬ª se produit g√©n√©ralement en raison de probl√®mes de synchronisation entre les membres du cluster, de l'√©tat des interfaces, de la politique de s√©curit√© √©tablie, simplement en raison d'une lourde charge sur l'√©quipement. <br><br>  Dans un cluster √† deux n≈ìuds, nous n'utilisons pas le mode actif-actif. <br><br>  Si l'un des n≈ìuds tombe, le n≈ìud survivant peut tout simplement ne pas pouvoir r√©sister √† la double charge, et nous perdrons tout.  Si vous voulez vraiment actif-actif, le cluster doit avoir au moins 3 n≈ìuds. <br><br><h3>  Param√®tres de r√©seau et de virtualisation </h3><br>  <b>Le trafic de multidiffusion entre les interfaces SYNC des membres du cluster est autoris√© sur l'√©quipement r√©seau.</b>  <b>Si le trafic de multidiffusion n'est pas possible, le protocole de synchronisation (CCP) est utilis√© en diffusion.</b>  Les n≈ìuds du cluster Check Point se synchronisent les uns avec les autres.  Les messages sur les modifications sont transmis d'un n≈ìud √† l'autre via la multidiffusion.  Check Point utilise une impl√©mentation multicast non standard (une adresse IP non multicast est utilis√©e).  Pour cette raison, certains √©quipements, tels que le commutateur Cisco Nexus, ne comprennent pas ces messages et les bloquent donc.  Dans ce cas, passez en diffusion. <br><br><img src="https://habrastorage.org/webt/od/yo/cz/odyoczg_ya75ovj4zfpquljfkdw.png"><br>  <i>Description du probl√®me avec Cisco Nexus et ses solutions sur le portail fournisseur.</i> <br><br>  Au niveau de la virtualisation, nous permettons √©galement le passage du trafic multicast.  Si la multidiffusion est interdite pour la synchronisation de cluster (CCP), utilisez la diffusion. <br><br>  Dans la console Check Point, √† l'aide de la commande cphaprob -a if, vous pouvez voir les param√®tres CPP et son mode de fonctionnement (multidiffusion ou diffusion).  Pour changer le mode de fonctionnement, utilisez la commande de diffusion cphaconf set_ccp. <br><br><img src="https://habrastorage.org/webt/e6/ki/7j/e6ki7jzhw6py2bo9rf3v5wbz3wy.png"><br><br>  <b>Les n≈ìuds de cluster doivent se trouver sur diff√©rents h√¥tes ESXi.</b>  Tout est clair ici: lorsque l'h√¥te physique tombe, le deuxi√®me n≈ìud continue de fonctionner.  Ceci peut √™tre r√©alis√© en utilisant des r√®gles anti-affinit√© DRS. <br><br>  <b>Dimensions de la machine virtuelle sur laquelle Check Point s'ex√©cutera.</b>  Les recommandations du vendeur sont 2 vCPU et 6 Go, mais cela concerne une configuration minimale, par exemple, si vous avez un pare-feu avec une bande passante minimale.  Dans notre exp√©rience de mise en ≈ìuvre, lors de l'utilisation de plusieurs lames logicielles, il est conseill√© d'utiliser au moins 4 processeurs virtuels, 8 Go de RAM. <br>  Sur un n≈ìud, nous allouons en moyenne 150 Go de disque.  Lors du d√©ploiement d'un point de contr√¥le virtuel, le disque est partitionn√© et nous pouvons ajuster la quantit√© d'espace allou√© pour l'√©change de syst√®me, la racine du syst√®me, les journaux, la sauvegarde et la mise √† niveau. <br><br>  Lorsque vous augmentez la racine du syst√®me, la partition de sauvegarde et de mise √† niveau doit √©galement √™tre augment√©e afin de conserver la proportion entre elles.  Si la proportion n'est pas respect√©e, la prochaine sauvegarde peut ne pas correspondre au disque. <br><br>  <b>Provisionnement de disque - Provision √©paisse mise √† z√©ro diff√©r√©e.</b>  Check Point g√©n√®re beaucoup d'√©v√©nements et de journaux, chaque seconde 1000 entr√©es apparaissent.  Sous eux, il vaut mieux r√©server une place imm√©diatement.  Pour ce faire, lors de la cr√©ation d'une machine virtuelle, nous lui allouons un disque √† l'aide de la technologie Thick Provisioning, c'est-√†-dire  nous r√©servons de l'espace sur le stockage physique au moment de la cr√©ation du disque. <br><br>  R√©servation de ressources 100% configur√©e pour Check Point lors de la migration entre les h√¥tes ESXi.  Nous vous recommandons de r√©server 100% des ressources afin que la machine virtuelle sur laquelle Check Point est d√©ploy√© ne soit pas en concurrence pour les ressources avec d'autres machines virtuelles sur l'h√¥te. <br><br>  <b>Divers</b>  Nous utilisons la version Check Point de R77.30.  Pour cela, il est recommand√© d'utiliser RedHat Enterprise Linux version 5 (64 bits) comme OS invit√© sur une machine virtuelle.  Depuis les pilotes r√©seau - VMXNET3 ou Intel E1000. <br><br><h3>  Param√®tres du point de contr√¥le </h3><br>  <b>Les derni√®res mises √† jour de Check Point sont install√©es sur les passerelles et le serveur de gestion.</b>  V√©rifiez les mises √† jour via CPUSE. <br><br><img src="https://habrastorage.org/webt/of/o_/dw/ofo_dw7xmv7s_ot1qgpz6svmkd0.png"><br><br>  √Ä l'aide de Verifier, nous v√©rifions que le service pack que nous sommes sur le point d'installer n'est pas en conflit avec le syst√®me. <br><br><img src="https://habrastorage.org/webt/f-/6z/cn/f-6zcnlkxh8vpat2cam5ciszoyi.png"><br><br><img src="https://habrastorage.org/webt/dr/y-/kp/dry-kpzjts8ky_7v-z-eonatnha.png"><br><br>  Verifier, bien s√ªr, est une bonne chose, mais il y a des nuances.  Certaines mises √† jour ne sont pas compatibles avec le module compl√©mentaire, mais Verifier n'affichera pas ces conflits et autorisera la mise √† jour.  √Ä la fin de la mise √† jour, vous obtiendrez une erreur, et seulement √† partir d'elle, vous d√©couvrirez ce qui emp√™che la mise √† jour.  Par exemple, cette situation s'est produite avec le service pack MABDA_001 (Mobile Access Blade Deployment Agent), qui r√©sout le probl√®me du lancement du plug-in Java dans des navigateurs autres qu'IE. <br><br>  <b>Mises √† jour quotidiennes de signatures automatiques configur√©es pour IPS et d'autres lames logicielles.</b>  Check Point publie des signatures qui peuvent √™tre utilis√©es pour d√©tecter ou bloquer de nouvelles vuln√©rabilit√©s.  Les vuln√©rabilit√©s re√ßoivent automatiquement un niveau de criticit√©.  Conform√©ment √† ce niveau et au filtre d√©fini, le syst√®me d√©cide de d√©tecter ou de bloquer la signature.  Il est important ici de ne pas en faire trop avec les filtres, de v√©rifier p√©riodiquement et de faire des ajustements afin que le trafic l√©gitime ne soit pas bloqu√©. <br><br><img src="https://habrastorage.org/webt/0p/hh/p-/0phhp-2og69lvtrtq8mfnrcwbf4.png"><br>  <i>Profil IPS, o√π nous s√©lectionnons l'action par rapport √† la signature en fonction de ses param√®tres.</i> <br><br><img src="https://habrastorage.org/webt/n1/si/jb/n1sijbwodxv-p_ubudt8h_rqzne.png"><br>  <i>Param√®tres de strat√©gie pour ce profil IPS en fonction des param√®tres de signature: niveau de gravit√©, impact sur les performances, etc.</i> <br><br>  <b>Le mat√©riel Check Point est configur√© avec le protocole de synchronisation horaire NTP.</b>  Sur la base des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">recommandations</a> , Check Point doit utiliser un serveur NTP externe pour synchroniser l'heure sur l'√©quipement.  Cela peut √™tre fait via le portail web gaia. <br><br>  Une heure mal d√©finie peut entra√Æner une d√©synchronisation du cluster.  Si le moment est mal choisi, il est extr√™mement g√™nant de rechercher l'entr√©e de journal qui nous int√©resse.  Chaque entr√©e dans les journaux d'√©v√©nements est marqu√©e d'un soi-disant horodatage. <br><br><img src="https://habrastorage.org/webt/ce/ve/2x/ceve2x6z2nfrpuvablszwwjmnmk.jpeg"><br><br><img src="https://habrastorage.org/webt/rd/dm/gj/rddmgjxuih_jftgacbqp96nzaja.png"><br><br>  <b>√âv√©nement intelligent configur√© pour les alertes sur IPS, App Control, Anti-Bot, etc.</b> Il s'agit d'un module distinct avec sa propre licence.  Si vous en avez un, son utilisation est pratique pour visualiser les informations sur le fonctionnement de toutes les lames et p√©riph√©riques logiciels.  Par exemple, les attaques, le nombre d'op√©rations IPS, le niveau de criticit√© des menaces, les applications interdites utilis√©es par les utilisateurs, etc. <br><br><img src="https://habrastorage.org/webt/sm/ep/hi/smephijff9iy11roy-gkad-he7y.png"><br><br><img src="https://habrastorage.org/webt/px/ey/q8/pxeyq8x3j3uvpegh2vovripqtxi.png"><br>  <i>Ce sont des statistiques sur 30 jours selon le nombre de signatures et le degr√© de criticit√©.</i> <br><br><img src="https://habrastorage.org/webt/qa/if/-y/qaif-yr2di_vhaskm2runvouki8.jpeg"><br>  <i>Informations plus d√©taill√©es sur les signatures d√©tect√©es sur chaque lame de logiciel.</i> <br><br><h3>  Suivi </h3><br>  Il est important de surveiller au moins les param√®tres suivants: <br><br><ul><li>  √©tat du cluster; </li><li>  disponibilit√© des composants Check Point; </li><li>  Charge CPU </li><li>  espace disque restant; </li><li>  m√©moire libre. </li></ul><br>  Check Point dispose d'une lame logicielle distincte - Smart Monitoring (licence distincte).  Vous pouvez en outre surveiller la disponibilit√© des composants Check Point, les charges sur les lames individuelles et les statuts de licence. <br><br><img src="https://habrastorage.org/webt/ql/oi/gz/qloigzwdx53cfz5blmpp8pugqnk.png"><br><br><img src="https://habrastorage.org/webt/om/su/2e/omsu2enoalcopmgatfhmmvchasc.png"><br>  <i>Graphique de charge de Chek Point.</i>  <i>Splash - c'est le client qui a envoy√© des notifications push √† 800 000 clients.</i> <br><br><img src="https://habrastorage.org/webt/o4/dx/gf/o4dxgfya60iv0mj5hbfzwtqedxe.png"><br>  <i>Le graphique de la charge sur la lame de pare-feu dans la m√™me situation.</i> <br><br>  La surveillance peut √©galement √™tre configur√©e via des services tiers.  Par exemple, nous utilisons √©galement Nagios, o√π nous surveillons: <br><br><ul><li>  disponibilit√© des √©quipements sur le r√©seau; </li><li>  Disponibilit√© des adresses de cluster </li><li>  Chargement du processeur par c≈ìurs.  Lors du t√©l√©chargement de plus de 70%, une alerte e-mail arrive.  Une telle charge √©lev√©e peut indiquer un trafic sp√©cifique (vpn, par exemple).  Si cela se r√©p√®te souvent, alors il n'y a peut-√™tre pas assez de ressources et cela vaut la peine d'√©largir le bassin. </li><li>  RAM libre.  S'il reste moins de 80%, nous le saurons. </li><li>  chargement du disque sur certaines partitions, par exemple var / log.  Si elle se bouche rapidement, il est n√©cessaire de s'√©tendre. </li><li>  Split Brain (au niveau du cluster).  Nous surveillons l'√©tat lorsque les deux n≈ìuds deviennent actifs et la synchronisation entre eux dispara√Æt. </li><li>  Mode haute disponibilit√© - nous v√©rifions que le cluster est en mode veille active.  Nous regardons les √©tats des n≈ìuds - actifs, en veille, en panne. </li></ul><br><img src="https://habrastorage.org/webt/sa/6i/h6/sa6ih63oph6qaclqiwstgzclq2u.png"><br>  <i>Options de surveillance dans Nagios.</i> <br><br>  Il convient √©galement de surveiller l'√©tat des serveurs physiques sur lesquels les h√¥tes ESXi sont d√©ploy√©s. <br><br><h3>  Sauvegarde </h3><br>  Le vendeur lui-m√™me recommande de prendre un instantan√© imm√©diatement apr√®s l'installation de la mise √† jour (Hotfixies). <br><br>  Selon la fr√©quence des changements, une sauvegarde compl√®te est configur√©e une fois par semaine ou par mois.  Dans notre pratique, nous effectuons une copie incr√©mentielle quotidienne des fichiers Check Point et une sauvegarde compl√®te une fois par semaine. <br><br>  C‚Äôest tout.  Ce sont les points les plus √©l√©mentaires √† prendre en compte lors du d√©ploiement de points de contr√¥le virtuels.  Mais m√™me atteindre ce minimum aidera √† √©viter les probl√®mes avec leur travail. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr442880/">https://habr.com/ru/post/fr442880/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr442866/index.html">L'IA form√©e √† partir de d√©cennies d'exp√©rimentation culinaire cr√©e de nouveaux plats</a></li>
<li><a href="../fr442868/index.html">Une br√®ve excursion dans les syst√®mes de refroidissement du centre de donn√©es. Avantages et inconv√©nients</a></li>
<li><a href="../fr442870/index.html">Le meilleur du monde d'Angular pour la semaine - Digest n ¬∞ 2 (26 janvier - 7 mars)</a></li>
<li><a href="../fr442872/index.html">Comment j'ai trouv√© l'oeuf de P√¢ques dans la protection Android et que je n'ai pas trouv√© d'emploi chez Google</a></li>
<li><a href="../fr442876/index.html">Cartographie du bruit avec KSQL, Raspberry Pi et radio</a></li>
<li><a href="../fr442882/index.html">[Vid√©o] "Les Piems ne sont pas n√©cessaires" et trois autres id√©es de gestion de projet</a></li>
<li><a href="../fr442884/index.html">D√©j√†, la technologie vous permet de parler avec la voiture en tant que personne</a></li>
<li><a href="../fr442886/index.html">Sketch + Node.js: g√©n√©rez des ic√¥nes pour de nombreuses plateformes et marques. 2e partie</a></li>
<li><a href="../fr442888/index.html">Personnaliser la s√©lection sur css pur</a></li>
<li><a href="../fr442890/index.html">CYOD? COPE? BYOD?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>