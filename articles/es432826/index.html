<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïØÔ∏è „Ä∞Ô∏è üé£ Desarrollo moderno de Android en Kotlin. Parte 2 üßöüèª üëΩ üë™</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola Habr! Les presento la traducci√≥n del art√≠culo " Desarrollo moderno de Android con Kotlin (Parte 2) " de Mladen Rakonjac. 

 Nota Este art√≠culo es...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Desarrollo moderno de Android en Kotlin. Parte 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/432826/">  Hola Habr!  Les presento la traducci√≥n del art√≠culo " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Desarrollo moderno de Android con Kotlin (Parte 2)</a> " de Mladen Rakonjac. <br><br>  <i>Nota</i>  <i>Este art√≠culo es una traducci√≥n de la serie de art√≠culos de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Mladen Rakonjac</a> , fecha del art√≠culo: 23/09/2017.</i>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Github</a></i>  <i>Comenzando a leer la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">primera</a> parte de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">SemperPeritus,</a> descubr√≠ que el resto de la parte no estaba traducida por alguna raz√≥n.</i>  <i>Por lo tanto, traigo a su atenci√≥n la segunda parte.</i>  <i>El art√≠culo result√≥ ser voluminoso.</i> <br><br><img src="https://pbs.twimg.com/media/DIIHg0eV0AAl0u5.jpg" alt="imagen"><br><br>  "Es muy dif√≠cil encontrar un proyecto que cubra todo lo nuevo en desarrollo para Android en Android Studio 3.0, as√≠ que decid√≠ escribirlo". <br><a name="habracut"></a><br>  En este art√≠culo, analizaremos lo siguiente: <br><br><ol><li>  Android Studio 3 beta 1 <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a></b> </li><li>  Lenguaje de programaci√≥n Kotlin <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a></b> </li><li>  Opciones de compilaci√≥n <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a></b> </li><li>  Restricci√≥nDise√±o <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a></b> </li><li>  Biblioteca de enlace de datos <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a></b> </li><li>  <b>MVVM Architecture + Repository + Android Manager Wrappers Pattern</b> </li><li>  RxJava2 y c√≥mo nos ayuda en la arquitectura de la <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3</a></b> </li><li>  Daga 2.11, qu√© es la inyecci√≥n de dependencia, por qu√© deber√≠a usar esta <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 4</a></b> </li><li>  Retrofit (con Rx Java2) </li><li>  Habitaci√≥n (con Rx Java2) </li></ol><br><h2>  MVVM Architecture + Repository + Android Manager Wrappers Pattern </h2><br><h3>  Algunas palabras sobre arquitectura en el mundo de Android </h3><br>  Durante bastante tiempo, los desarrolladores de Android no han utilizado ninguna arquitectura en sus proyectos.  En los √∫ltimos tres a√±os, ha surgido una gran expectaci√≥n en la comunidad de desarrolladores de Android.  La actividad del tiempo de Dios ha pasado y Google ha publicado el repositorio <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Blueprints de Arquitectura de Android</a></b> , con muchos ejemplos e instrucciones sobre diversos enfoques arquitect√≥nicos.  Finalmente, en Google IO '17, presentaron <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Android Architecture Components</a></b> , una colecci√≥n de bibliotecas dise√±adas para ayudarnos a crear un c√≥digo m√°s limpio y mejorar las aplicaciones.  <b>El componente</b> dice que puede usarlos todos o solo uno de ellos.  Sin embargo, los encontr√© todos realmente √∫tiles.  M√°s adelante en el texto y en las siguientes partes las usaremos.  Primero, abordar√© el problema en el c√≥digo, y luego refactorizar√© el uso de estos componentes y bibliotecas para ver qu√© problemas deben resolver. <br><br>  Hay dos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">patrones arquitect√≥nicos</a> principales que comparten el c√≥digo GUI: <br><br><ul><li>  MVP </li><li>  MVVM </li></ul><br>  Es dif√≠cil decir cu√°l es mejor.  Debes probar ambos y decidir.  Prefiero <b>MVVM usando componentes conscientes del ciclo de vida</b> y escribir√© sobre ello.  Si nunca ha intentado usar MVP, hay toneladas de buenos art√≠culos en Medium sobre esto. <br><br><h3>  ¬øQu√© es un patr√≥n MVVM? </h3><br>  MVVM es un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">patr√≥n arquitect√≥nico</a> que se expande como Model-View-ViewModel.  Creo que este nombre confunde a los desarrolladores.  Si yo fuera a quien se le ocurri√≥ su nombre, lo llamar√≠a View-ViewModel-Model, porque <b>ViewModel</b> est√° en el medio, conectando <b>Vista</b> y <b>Modelo</b> . <br><br>  <b>La vista</b> es una abstracci√≥n para <b>Actividad</b> , <b>Fragmento</b> o cualquier otra Vista personalizada (Vista personalizada de <b>Android</b> ).  Tenga en cuenta que es importante no confundir esta <b>vista</b> con la vista de Android.  <b>La vista</b> debe ser tonta, no debemos escribirle ninguna l√≥gica.  <b>La vista</b> no debe contener datos.  Debe almacenar una referencia a la instancia de <b>ViewModel</b> y todos los datos que necesita la <b>Vista</b> deben provenir de all√≠.  Adem√°s, la <b>Vista</b> debe observar estos datos y el dise√±o debe cambiar cuando cambien los datos del <b>Modelo de vista</b> .  Para resumir, <b>View</b> es responsable de lo siguiente: vista de dise√±o para varios datos y estados. <br><br>  <b>ViewModel</b> es un nombre abstracto para una clase que contiene datos y l√≥gica, cu√°ndo se deben recibir estos datos y cu√°ndo se muestran.  <b>ViewModel</b> almacena el <b>estado</b> actual.  <b>ViewModel</b> tambi√©n almacena un enlace a uno o m√°s <b>modelos</b> y recibe todos los datos de ellos.  Ella no debe saber, por ejemplo, de d√≥nde provienen los datos, de la base de datos o del servidor.  Adem√°s, <b>ViewModel</b> no necesita saber nada sobre <b>View</b> .  Adem√°s, <u><b>ViewModel</b> no deber√≠a saber nada sobre el marco de Android.</u> <br><br>  <b>Modelo</b> es el nombre abstracto de la capa que prepara los datos para <b>ViewModel</b> .  Esta es la clase en la que recibiremos datos del servidor y los almacenaremos en cach√©, o los almacenaremos en una base de datos local.  Tenga en cuenta que estas no son las mismas clases que User, Car, Square, otras clases de modelos que simplemente almacenan datos.  Por lo general, esta es una implementaci√≥n de la plantilla del Repositorio, que discutiremos m√°s adelante.  <b>El modelo</b> no debe saber nada sobre <b>ViewModel</b> . <br><br>  <b>MVVM</b> , si se implementa correctamente, es una excelente manera de romper su c√≥digo y hacerlo m√°s comprobable.  Esto nos ayuda a seguir principios <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">S√ìLIDOS</a></b> , por lo que nuestro c√≥digo es m√°s f√°cil de mantener. <br><br><h3>  Ejemplo de c√≥digo </h3><br>  Ahora escribir√© un ejemplo simple que muestra c√≥mo funciona esto. <br><br>  Para comenzar, creemos un <b>Modelo</b> simple que devuelva una l√≠nea: <br><br><div class="spoiler">  <b class="spoiler_title">RepoModel.kt</b> <div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RepoModel</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">refreshData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> : String </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Some new data"</span></span> } }</code> </pre> <br></div></div><br>  Por lo general, recibir datos es una llamada <b>asincr√≥nica</b> , por lo que debemos esperar.  Para simular esto, cambi√© la clase a la siguiente: <br><br><div class="spoiler">  <b class="spoiler_title">RepoModel.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RepoModel</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">refreshData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(onDataReadyCallback: OnDataReadyCallback)</span></span></span><span class="hljs-function"> </span></span>{ Handler().postDelayed({ onDataReadyCallback.onDataReady(<span class="hljs-string"><span class="hljs-string">"new data"</span></span>) },<span class="hljs-number"><span class="hljs-number">2000</span></span>) } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnDataReadyCallback</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data : String)</span></span></span><span class="hljs-function"> }</span></span></code> </pre> <br></div></div><br>  <code><b>OnDataReadyCallback</b></code> interfaz <code><b>OnDataReadyCallback</b></code> con el m√©todo <code><b>onDataReady</b></code> .  Y ahora el m√©todo <code><b>refreshData</b></code> implementa (implementa) <code><b>OnDataReadyCallback</b></code> .  Para simular la espera, uso el <code><b>Handler</b></code> .  Una vez <code><b>onDataReady</b></code> 2 segundos, se <code><b>onDataReady</b></code> m√©todo <code><b>onDataReady</b></code> en las clases que implementan la interfaz <code><b>OnDataReadyCallback</b></code> . <br><br>  <b>Creemos</b> un <b>ViewModel</b> : <br><br><div class="spoiler">  <b class="spoiler_title">MainViewModel.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainViewModel</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> repoModel: RepoModel = RepoModel() <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> text: String = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> isLoading: Boolean = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> }</code> </pre> <br></div></div><br>  Como puede ver, hay una instancia de <code><b>RepoModel</b></code> , <code><b>text</b></code> , que se mostrar√°, y la variable <code><b>isLoading</b></code> , que almacena el estado actual.  Creemos un m√©todo de <code><b>refresh</b></code> que sea responsable de recuperar los datos: <br><br><div class="spoiler">  <b class="spoiler_title">MainViewModel.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainViewModel</span></span></span><span class="hljs-class"> </span></span>{ ... val onDataReadyCallback = object : OnDataReadyCallback { <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: String)</span></span></span><span class="hljs-function"> </span></span>{ isLoading.set(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) text.set(data) } } <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">refresh</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ isLoading.set(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) repoModel.refreshData(onDataReadyCallback) } }</code> </pre> <br></div></div><br>  El m√©todo de <code><b>refresh</b></code> llama a <code><b>refreshData</b></code> en el <code><b>RepoModel</b></code> , que toma una implementaci√≥n <code>OnDataReadyCallback</code> en argumentos.  Ok, pero ¬øqu√© es un <code><b>object</b></code> ?  Siempre que desee implementar una interfaz o heredar una clase extendida sin subclasificar, utilizar√° una <b>declaraci√≥n de objeto</b> .  ¬øY si quieres usar esto como una clase an√≥nima?  En este caso, est√° utilizando la <b>expresi√≥n de objeto</b> : <br><br><div class="spoiler">  <b class="spoiler_title">MainViewModel.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainViewModel</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> repoModel: RepoModel = RepoModel() <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> text: String = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> isLoading: Boolean = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">false</span></span></span><span class="hljs-function"> fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">refresh</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ repoModel.refreshData( object : OnDataReadyCallback { <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: String)</span></span></span><span class="hljs-function"> </span></span>{ text = data }) } }</code> </pre> <br></div></div><br>  Cuando llamamos <code>refresh</code> , debemos cambiar la vista al estado de <b>carga</b> y cuando llegan los datos, establece <code><b>isLoading</b></code> en <code>false</code> . <br><br>  Tambi√©n debemos reemplazar el <code><b>text</b></code> con <pre> <code class="hljs xml"><b>ObservableField<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">String</span></span></span><span class="hljs-tag">&gt;</span></span></b></code> </pre>  y est√° <code><b>isLoading</b></code> <pre> <code class="hljs pgsql"><b>ObservableField&lt;<span class="hljs-type"><span class="hljs-type">Boolean</span></span>&gt;</b></code> </pre>  .  <code><b>ObservableField</b></code> es una clase de la biblioteca de enlace de datos que podemos usar en lugar de crear un objeto Observable. Envuelve el objeto que queremos observar. <br><br><div class="spoiler">  <b class="spoiler_title">MainViewModel.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainViewModel</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> repoModel: RepoModel = RepoModel() val text = ObservableField&lt;String&gt;() val isLoading = ObservableField&lt;Boolean&gt;() <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">refresh</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ isLoading.set(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) repoModel.refreshData(object : OnDataReadyCallback { <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: String)</span></span></span><span class="hljs-function"> </span></span>{ isLoading.set(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) text.set(data) } }) } }</code> </pre> <br></div></div><br>  Tenga en cuenta que uso <b>val en</b> lugar de <b>var</b> , porque solo cambiaremos el valor en el campo, pero no el campo en s√≠.  Y si desea inicializarlo, use lo siguiente: <br><br><div class="spoiler">  <b class="spoiler_title">initobserv.kt</b> <div class="spoiler_text"><pre> <code class="java hljs">val text = ObservableField(<span class="hljs-string"><span class="hljs-string">"old data"</span></span>) val isLoading = ObservableField(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)</code> </pre> <br></div></div><br><br>  Cambiemos nuestro dise√±o para que pueda observar <b>texto</b> e <b>isLoading</b> .  Para comenzar, enlace <b>MainViewModel en</b> lugar de <b>Repository</b> : <br><br><div class="spoiler">  <b class="spoiler_title">activity_main.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">variable</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viewModel"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"me.mladenrakonjac.modernandroidapp.MainViewModel"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></div></div><br>  Entonces: <br><br><ul><li>  Cambiar TextView para observar el <b>texto</b> de <b>MainViewModel</b> </li><li>  Agregue una <b>barra de</b> progreso, que ser√° visible solo si <b>isLoading</b> true </li><li>  Bot√≥n Agregar, que, cuando se hace clic, llamar√° al m√©todo de <b>actualizaci√≥n</b> desde <b>MainViewModel</b> y se podr√° hacer clic solo si <b>isLoading</b> false </li></ul><br><div class="spoiler">  <b class="spoiler_title">main_activity.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs">... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/repository_name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{viewModel.text}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">...</span></span></span><span class="hljs-tag"> /&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ProgressBar</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/loading"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:visibility</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{viewModel.isLoading ? View.VISIBLE : View.GONE}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">...</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/refresh_button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:onClick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{() -&gt; viewModel.refresh()}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:clickable</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{viewModel.isLoading ? false : true}"</span></span></span><span class="hljs-tag"> /&gt;</span></span> ...</code> </pre> <br></div></div><br>  Si ejecuta ahora, obtendr√° un <code>View.VISIBLE and View.GONE cannot be used if View is not imported</code> .  Bueno, importemos: <br><br><div class="spoiler">  <b class="spoiler_title">main_activity.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">import</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.view.View"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">variable</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viewModel"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"me.fleka.modernandroidapp.MainViewModel"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></div></div><br>  Ok, hecho con el dise√±o.  Ahora termina con la encuadernaci√≥n.  Como dije, <code><b>View</b></code> debe tener una instancia de <code><b>ViewModel</b></code> : <br><br><div class="spoiler">  <b class="spoiler_title">MainActivity.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class">() </span></span>{ lateinit <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> binding: ActivityMainBinding <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mainViewModel = MainViewModel() <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(savedInstanceState: Bundle?)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState) binding = DataBindingUtil.setContentView(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, R.layout.activity_main) binding.viewModel = mainViewModel binding.executePendingBindings() } }</code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Finalmente podemos correr</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></div></div><br>  Puede ver que los <b>datos antiguos se</b> reemplazan por <b>datos nuevos</b> . <br><br>  Este fue un simple ejemplo de MVVM. <br><br><div class="spoiler">  <b class="spoiler_title">Pero hay un problema, volteemos la pantalla</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></div></div><br>  <b>los datos antiguos</b> reemplazaron los <b>datos nuevos</b> .  ¬øC√≥mo es esto posible?  Eche un vistazo al ciclo de vida de la actividad: <br><br><div class="spoiler">  <b class="spoiler_title">Ciclo de vida de la actividad</b> <div class="spoiler_text"><img src="https://cdn-images-1.medium.com/max/1600/1*CGGROXWhl8dTko1GdDeFsA.png" alt="imagen"><br></div></div><br>  Cuando encendi√≥ el tel√©fono, se cre√≥ una nueva instancia de Activity y se llam√≥ al m√©todo <code><b>onCreate()</b></code> .  Echa un vistazo a nuestra actividad: <br><br><div class="spoiler">  <b class="spoiler_title">MainActivity.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class">() </span></span>{ lateinit <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> binding: ActivityMainBinding <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mainViewModel = MainViewModel() <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(savedInstanceState: Bundle?)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState) binding = DataBindingUtil.setContentView(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, R.layout.activity_main) binding.viewModel = mainViewModel binding.executePendingBindings() } }</code> </pre> <br></div></div><br>  Como puede ver, cuando se cre√≥ una instancia de Activity, tambi√©n se cre√≥ una instancia de <b>MainViewModel</b> .  ¬øEs bueno si de alguna manera tenemos la misma instancia de <b>MainViewModel</b> para cada <b>MainActivity</b> recreado? <br><br><h3>  Introducci√≥n a los componentes del ciclo de vida </h3><br>  Porque  muchos desarrolladores se enfrentan a este problema, los desarrolladores del equipo de Android Framework decidieron crear una biblioteca dise√±ada para ayudar a resolver esto.  La clase <b>ViewModel</b> es una de ellas.  Esta es la clase de la que todos nuestros ViewModel deber√≠an heredar. <br><br>  <b>Heredemos MainViewModel</b> de <b>ViewModel</b> de los componentes que tienen en cuenta el ciclo de vida.  Primero, debemos agregar la biblioteca de <b>componentes</b> con <b>reconocimiento</b> del <b>ciclo de vida</b> a nuestro archivo <b>build.gradle</b> : <br><br><div class="spoiler">  <b class="spoiler_title">build.gradle</b> <div class="spoiler_text"><pre> <code class="xml hljs">dependencies { ... implementation "android.arch.lifecycle:runtime:1.0.0-alpha9" implementation "android.arch.lifecycle:extensions:1.0.0-alpha9" kapt "android.arch.lifecycle:compiler:1.0.0-alpha9"</code> </pre> <br></div></div><br>  Convierta <b>MainViewModel en el</b> heredero de <b>ViewModel</b> : <br><br><div class="spoiler">  <b class="spoiler_title">MainViewModel.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> me.mladenrakonjac.modernandroidapp <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.arch.lifecycle.ViewModel <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainViewModel</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewModel</span></span></span><span class="hljs-class">() </span></span>{ ... }</code> </pre> <br></div></div><br>  El m√©todo <b>onCreate ()</b> de nuestra MainActivity se ver√° as√≠: <br><br><div class="spoiler">  <b class="spoiler_title">MainActivity.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class">() </span></span>{ lateinit <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> binding: <span class="hljs-function"><span class="hljs-function">ActivityMainBinding override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(savedInstanceState: Bundle?)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState) binding = DataBindingUtil.setContentView(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, R.layout.activity_main) binding.viewModel = ViewModelProviders.of(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>).get(MainViewModel::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">binding</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">executePendingBindings</span></span></span><span class="hljs-class">() } }</span></span></code> </pre> <br></div></div><br>  Tenga en cuenta que no creamos una nueva instancia de <b>MainViewModel</b> .  Lo obtendremos usando <b>ViewModelProviders</b> .  <b>ViewModelProviders</b> es una clase de utilidad que tiene un m√©todo para obtener <b>ViewModelProvider</b> .  Se trata de <b>alcance</b> .  Si llama a <b>ViewModelProviders.of (this)</b> en una Actividad, su <b>ViewModel</b> vivir√° mientras esta Actividad est√© activa (hasta que se destruya sin volver a crear).  Por lo tanto, si llama a esto en un fragmento, su <b>ViewModel</b> vivir√° mientras el Fragment est√© vivo, etc.  Echa un vistazo al diagrama: <br><br><div class="spoiler">  <b class="spoiler_title">Alcance del ciclo de vida</b> <div class="spoiler_text"><img src="https://cdn-images-1.medium.com/max/1600/1*BSzxfYGPAEvHoIs5v2ThKA.png" alt="imagen"><br></div></div><br>  <b>ViewModelProvider</b> es responsable de crear una nueva instancia en la primera llamada o devolver la anterior si se recrea su Actividad o Fragmento. <br><br>  No te confundas con <br><br><pre> <code class="java hljs">MainViewModel::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span></span></code> </pre> <br>  En Kotlin, si sigues <br><br><pre> <code class="java hljs">MainViewModel::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span></code> </pre> <br>  esto le devolver√° <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">KClass</a> , que no es lo mismo que Class de Java.  Entonces, si escribimos <b>.java</b> , de acuerdo con la documentaci√≥n es: <br><blockquote>  Devolver√° una instancia de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Class</a> Java correspondiente a esta instancia de KClass </blockquote><div class="spoiler">  <b class="spoiler_title">Veamos qu√© sucede cuando giras la pantalla</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></div></div><br>  Tenemos los mismos datos que antes de la rotaci√≥n de la pantalla. <br><br>  En el √∫ltimo art√≠culo, dije que nuestra aplicaci√≥n obtendr√° una lista de repositorios de Github y los mostrar√°.  Para hacer esto, debemos agregar la funci√≥n <b>getRepositories</b> , que devolver√° una lista falsa de repositorios: <br><br><div class="spoiler">  <b class="spoiler_title">RepoModel.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RepoModel</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">refreshData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(onDataReadyCallback: OnDataReadyCallback)</span></span></span><span class="hljs-function"> </span></span>{ Handler().postDelayed({ onDataReadyCallback.onDataReady(<span class="hljs-string"><span class="hljs-string">"new data"</span></span>) },<span class="hljs-number"><span class="hljs-number">2000</span></span>) } <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRepositories</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(onRepositoryReadyCallback: OnRepositoryReadyCallback)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> arrayList = ArrayList&lt;Repository&gt;() arrayList.add(Repository(<span class="hljs-string"><span class="hljs-string">"First"</span></span>, <span class="hljs-string"><span class="hljs-string">"Owner 1"</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span> , <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)) arrayList.add(Repository(<span class="hljs-string"><span class="hljs-string">"Second"</span></span>, <span class="hljs-string"><span class="hljs-string">"Owner 2"</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span> , <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>)) arrayList.add(Repository(<span class="hljs-string"><span class="hljs-string">"Third"</span></span>, <span class="hljs-string"><span class="hljs-string">"Owner 3"</span></span>, <span class="hljs-number"><span class="hljs-number">430</span></span> , <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)) Handler().postDelayed({ onRepositoryReadyCallback.onDataReady(arrayList) },<span class="hljs-number"><span class="hljs-number">2000</span></span>) } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnDataReadyCallback</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data : String)</span></span></span><span class="hljs-function"> } interface OnRepositoryReadyCallback </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data : ArrayList&lt;Repository&gt;)</span></span></span><span class="hljs-function"> }</span></span></code> </pre> <br></div></div><br>  Tambi√©n necesitamos tener un m√©todo en <b>MainViewModel</b> que llame a <b>getRepositories</b> desde <b>RepoModel</b> : <br><br><div class="spoiler">  <b class="spoiler_title">MainViewModel.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainViewModel</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewModel</span></span></span><span class="hljs-class">() </span></span>{ ... <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> repositories = ArrayList&lt;Repository&gt;() <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">refresh</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ ... } <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadRepositories</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ isLoading.set(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) repoModel.getRepositories(object : OnRepositoryReadyCallback{ <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: ArrayList&lt;Repository&gt;)</span></span></span><span class="hljs-function"> </span></span>{ isLoading.set(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) repositories = data } }) } }</code> </pre> <br></div></div><br>  Y finalmente, necesitamos mostrar estos repositorios en RecyclerView.  Para hacer esto, debemos: <br><br><ul><li>  Crear dise√±o <b>rv_item_repository.xml</b> </li><li>  Agregue <b>RecyclerView</b> al dise√±o <b>activity_main.xml</b> </li><li>  Crear repositorioRecyclerViewAdapter </li><li>  Instale el adaptador en la vista de reciclaje </li></ul><br>  Para crear <b>rv_item_repository.xml,</b> utilic√© la biblioteca CardView, por lo que debemos agregarla a build.gradle (aplicaci√≥n): <br><br><pre> <code class="xml hljs">implementation 'com.android.support:cardview-v7:26.0.1'</code> </pre> <br>  As√≠ es como se ve: <br><br><div class="spoiler">  <b class="spoiler_title">rv_item_repository.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">layout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:app</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res-auto"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:tools</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/tools"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">import</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.view.View"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">variable</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"repository"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"me.mladenrakonjac.modernandroidapp.uimodels.Repository"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">android.support.v7.widget.CardView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"96dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_margin</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">android.support.constraint.ConstraintLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/repository_name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginEnd</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginStart</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{repository.repositoryName}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:textSize</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"20sp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintBottom_toBottomOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintHorizontal_bias</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintLeft_toLeftOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintRight_toRightOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintTop_toTopOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintVertical_bias</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.083"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">tools:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Modern Android App"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/repository_has_issues"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginEnd</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginStart</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginTop</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/has_issues"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:textStyle</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bold"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:visibility</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{repository.hasIssues ? View.VISIBLE : View.GONE}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintBottom_toBottomOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/repository_name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintEnd_toEndOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintHorizontal_bias</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintStart_toEndOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/repository_name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintTop_toTopOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/repository_name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintVertical_bias</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/repository_owner"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginBottom</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginEnd</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginStart</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{repository.repositoryOwner}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintBottom_toBottomOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintEnd_toEndOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintStart_toStartOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintTop_toBottomOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/repository_name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintVertical_bias</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">tools:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Mladen Rakonjac"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/number_of_starts"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginBottom</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginEnd</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginStart</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginTop</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{String.valueOf(repository.numberOfStars)}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintBottom_toBottomOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintEnd_toEndOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintHorizontal_bias</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintStart_toStartOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintTop_toBottomOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/repository_owner"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintVertical_bias</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">tools:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0 stars"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">android.support.constraint.ConstraintLayout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">android.support.v7.widget.CardView</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">layout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></div></div><br>  El siguiente paso es agregar RecyclerView a <b>activity_main.xml</b> .  Antes de hacer esto, aseg√∫rese de agregar la biblioteca RecyclerView: <br><br><pre> <code class="xml hljs">implementation 'com.android.support:recyclerview-v7:26.0.1'</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">activity_main.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">layout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:app</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res-auto"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:tools</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/tools"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">import</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.view.View"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">variable</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viewModel"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"me.fleka.modernandroidapp.MainViewModel"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">android.support.constraint.ConstraintLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">tools:context</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"me.fleka.modernandroidapp.MainActivity"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ProgressBar</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/loading"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"48dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"48dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:indeterminate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:visibility</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{viewModel.isLoading ? View.VISIBLE : View.GONE}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintBottom_toTopOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/refresh_button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintEnd_toEndOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintStart_toStartOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintTop_toTopOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">android.support.v7.widget.RecyclerView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/repository_rv"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:indeterminate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:visibility</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{viewModel.isLoading ? View.GONE : View.VISIBLE}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintBottom_toTopOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/refresh_button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintEnd_toEndOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintStart_toStartOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintTop_toTopOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">tools:listitem</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@layout/rv_item_repository"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/refresh_button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"160dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"40dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginBottom</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginEnd</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginStart</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginTop</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:onClick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{() -&gt; viewModel.loadRepositories()}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:clickable</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{viewModel.isLoading ? false : true}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Refresh"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintBottom_toBottomOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintEnd_toEndOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintStart_toStartOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintTop_toTopOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintVertical_bias</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">android.support.constraint.ConstraintLayout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">layout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></div></div><br><br>  Tenga en cuenta que eliminamos algunos elementos TextView y ahora el bot√≥n inicia <b>loadRepositories en</b> lugar de <b>actualizar</b> : <br><br><div class="spoiler">  <b class="spoiler_title">button.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/refresh_button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:onClick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{() -&gt; viewModel.loadRepositories()}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">...</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre> <br></div></div><br>  Eliminemos el m√©todo de <b>actualizaci√≥n</b> de MainViewModel y <b>refreshData</b> de RepoModel como innecesario. <br><br>  Ahora necesita crear un adaptador para RecyclerView: <br><br><div class="spoiler">  <b class="spoiler_title">RepositoryRecyclerViewAdapter.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RepositoryRecyclerViewAdapter</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">var</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">items</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ArrayList</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Repository</span></span></span><span class="hljs-class">&gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">var</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">listener</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnItemClickListener</span></span></span><span class="hljs-class">) : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RecyclerView</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Adapter</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RepositoryRecyclerViewAdapter</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewHolder</span></span></span><span class="hljs-class">&gt;() </span></span>{ <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreateViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(parent: ViewGroup?, viewType: Int)</span></span></span><span class="hljs-function">: ViewHolder </span></span>{ val layoutInflater = LayoutInflater.from(parent?.context) val binding = RvItemRepositoryBinding.inflate(layoutInflater, parent, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ViewHolder(binding) } <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onBindViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: ViewHolder, position: Int)</span></span></span><span class="hljs-function"> </span></span>= holder.bind(items[position], listener) <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getItemCount</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: Int </span></span>= items.size <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnItemClickListener</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onItemClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(position: Int)</span></span></span><span class="hljs-function"> } class </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">private</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">var</span></span></span></span><span class="hljs-function"><span class="hljs-params"> binding: RvItemRepositoryBinding)</span></span></span><span class="hljs-function"> : RecyclerView.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(binding.root)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bind</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(repo: Repository, listener: OnItemClickListener?)</span></span></span><span class="hljs-function"> </span></span>{ binding.repository = <span class="hljs-function"><span class="hljs-function">repo </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(listener != </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">null</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ binding.root.setOnClickListener({ _ -&gt; listener.onItemClick(layoutPosition) }) } binding.executePendingBindings() } } }</code> </pre> <br></div></div><br>  Tenga en cuenta que ViewHolder toma una instancia de tipo <b>RvItemRepositoryBinding</b> , en lugar de <b>View</b> , para que podamos implementar Data Binding en ViewHolder para cada elemento.  No se averg√ºence de la funci√≥n de l√≠nea √∫nica (en l√≠nea): <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onBindViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: ViewHolder, position: Int)</span></span></span><span class="hljs-function"> </span></span>= holder.bind(items[position], listener)</code> </pre> <br>  Esta es solo una entrada corta para: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onBindViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: ViewHolder, position: Int)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> holder.bind(items[position], listener) }</code> </pre> <br>  Y <b>items [posici√≥n]</b> es la implementaci√≥n para el operador de √≠ndice.  Es similar a <b>items.get (posici√≥n)</b> . <br><br>  Otra l√≠nea que puede confundirte: <br><br><pre> <code class="java hljs">binding.root.setOnClickListener({ _ -&gt; listener.onItemClick(layoutPosition) })</code> </pre> <br>  Puede reemplazar el par√°metro con _ si no lo est√° usando.  Bien, ¬øeh? <br><br>  Creamos el adaptador, pero a√∫n no lo hemos aplicado al <b>recyclerView</b> en <b>MainActivity</b> : <br><br><div class="spoiler">  <b class="spoiler_title">MainActivity.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RepositoryRecyclerViewAdapter</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnItemClickListener</span></span></span><span class="hljs-class"> </span></span>{ lateinit <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> binding: <span class="hljs-function"><span class="hljs-function">ActivityMainBinding override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(savedInstanceState: Bundle?)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState) binding = DataBindingUtil.setContentView(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, R.layout.activity_main) val viewModel = ViewModelProviders.of(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>).get(MainViewModel::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">binding</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">viewModel</span></span></span><span class="hljs-class"> </span></span>= viewModel binding.executePendingBindings() binding.repositoryRv.layoutManager = LinearLayoutManager(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) binding.repositoryRv.adapter = RepositoryRecyclerViewAdapter(viewModel.repositories, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) } <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onItemClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(position: Int)</span></span></span><span class="hljs-function"> </span></span>{ TODO(<span class="hljs-string"><span class="hljs-string">"not implemented"</span></span>) <span class="hljs-comment"><span class="hljs-comment">//To change body of created functions use File | Settings | File Templates. } }</span></span></code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Ejecuta la aplicaci√≥n</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></div></div><br>  Esto es raro  Que paso <br><br><ul><li>  Se cre√≥ la actividad, por lo que tambi√©n se cre√≥ un nuevo adaptador con <b>repositorios</b> que est√°n pr√°cticamente vac√≠os </li><li>  Apretamos el boton </li><li>  Se llama loadRepositories, que muestra el progreso </li><li>  Despu√©s de 2 segundos, obtenemos los repositorios, el progreso est√° oculto, pero no aparecen.  Esto se debe a que no se llama a <b>notifyDataSetChanged</b> en el adaptador </li><li>  Cuando giramos la pantalla, se crea una nueva Actividad, por lo que se crea un nuevo adaptador con el par√°metro de <b>repositorios</b> con algunos datos </li></ul><br>  Entonces, como <b>MainViewModel</b> debe notificar a <b>MainActivity</b> de los nuevos elementos, ¬øpodemos llamar a <b>notifyDataSetChanged</b> ? <br><br>  No podemos <br><br>  Esto es realmente importante, <b>MainViewModel</b> no deber√≠a saber nada sobre <b>MainActivity</b> . <br><br>  <b>MainActivity</b> es el que tiene una instancia de <b>MainViewModel</b> , por lo que debe escuchar los cambios y notificar al <b>Adaptador</b> sobre los cambios. <br><br>  ¬øPero c√≥mo hacerlo? <br><br>  Podemos observar los <b>repositorios</b> , as√≠ que despu√©s de cambiar los datos, podemos cambiar nuestro adaptador. <br><br>  ¬øQu√© hay de malo en esta decisi√≥n? <br><br>  Veamos el siguiente caso: <br><br><ul><li>  En <b>MainActivity,</b> observamos repositorios: cuando ocurre un cambio, ejecutamos <b>notifyDataSetChanged</b> </li><li>  Apretamos el boton </li><li>  Mientras esperamos los cambios de datos, <b>MainActivity se</b> puede volver a crear debido a <b>cambios en la configuraci√≥n.</b> </li><li>  Nuestro <b>MainViewModel</b> sigue vivo </li><li>  Despu√©s de 2 segundos, el campo de <b>repositorios</b> recibe nuevos elementos y notifica al observador que los datos han cambiado. </li><li>  El observador intenta ejecutar <b>notifyDataSetChanged</b> en el <b>adaptador</b> , que ya no existe, porque  <b>MainActivity ha</b> sido recreada </li></ul><br>  Bueno, nuestra decisi√≥n no es lo suficientemente buena. <br><br><h3>  Introducci√≥n a LiveData </h3><br>  <b>LiveData</b> es otro <b>componente del ciclo de vida</b> basado en un observable que conoce el ciclo de vida de View.  Entonces, cuando una Actividad se destruye debido a <b>un cambio de configuraci√≥n</b> , <b>LiveData lo</b> sabe, por lo que tambi√©n elimina al observador de la Actividad destruida. <br><br>  Implementamos en <b>MainViewModel</b> : <br><br><div class="spoiler">  <b class="spoiler_title">MainViewModel.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainViewModel</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewModel</span></span></span><span class="hljs-class">() </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> repoModel: RepoModel = RepoModel() val text = ObservableField(<span class="hljs-string"><span class="hljs-string">"old data"</span></span>) val isLoading = ObservableField(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> repositories = MutableLiveData&lt;ArrayList&lt;Repository&gt;&gt;() <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadRepositories</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ isLoading.set(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) repoModel.getRepositories(object : OnRepositoryReadyCallback { <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: ArrayList&lt;Repository&gt;)</span></span></span><span class="hljs-function"> </span></span>{ isLoading.set(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) repositories.value = data } }) } }</code> </pre> <br></div></div><br>  y comience a observar MainActivity: <br><br><div class="spoiler">  <b class="spoiler_title">MainActivity.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LifecycleActivity</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RepositoryRecyclerViewAdapter</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnItemClickListener</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> lateinit <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> binding: ActivityMainBinding <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> val repositoryRecyclerViewAdapter = RepositoryRecyclerViewAdapter(arrayListOf(), <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(savedInstanceState: Bundle?)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState) binding = DataBindingUtil.setContentView(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, R.layout.activity_main) val viewModel = ViewModelProviders.of(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>).get(MainViewModel::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">binding</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">viewModel</span></span></span><span class="hljs-class"> </span></span>= viewModel binding.executePendingBindings() binding.repositoryRv.layoutManager = LinearLayoutManager(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) binding.repositoryRv.adapter = repositoryRecyclerViewAdapter viewModel.repositories.observe(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, Observer&lt;ArrayList&lt;Repository&gt;&gt; { it?.let{ repositoryRecyclerViewAdapter.replaceData(it)} }) } <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onItemClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(position: Int)</span></span></span><span class="hljs-function"> </span></span>{ TODO(<span class="hljs-string"><span class="hljs-string">"not implemented"</span></span>) <span class="hljs-comment"><span class="hljs-comment">//To change body of created functions use File | Settings | File Templates. } }</span></span></code> </pre> <br></div></div><br>  ¬øQu√© significa la palabra <b>que</b> significa?  Si una funci√≥n tiene solo un par√°metro, se puede obtener acceso a este par√°metro utilizando la palabra clave it.  Entonces, supongamos que tenemos una expresi√≥n lambda para multiplicar por 2: <br><br><pre> <code class="java hljs">((a) -&gt; <span class="hljs-number"><span class="hljs-number">2</span></span> * a)</code> </pre> <br>  Se puede reemplazar de la siguiente manera: <br><br><pre> <code class="java hljs">(it * <span class="hljs-number"><span class="hljs-number">2</span></span>)</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Si inicia la aplicaci√≥n ahora, puede asegurarse de que todo funcione</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></div></div><br>  ... <br><br><h3>  ¬øPor qu√© prefiero MVVM sobre MVP? </h3><br><br><ul><li>  No hay una interfaz aburrida para View, ya que  ViewModel no tiene referencia a View </li><li>  No hay una interfaz aburrida para Presenter, y esto no es necesario </li><li>  Mucho m√°s f√°cil de manejar los cambios de configuraci√≥n </li><li>  Usando MVVM, tenemos menos c√≥digo para Actividad, Fragmentos, etc. </li></ul><br>  ... <br><br><h3>  Patr√≥n de repositorio </h3><br><div class="spoiler">  <b class="spoiler_title">Esquema</b> <div class="spoiler_text"><img src="https://cdn-images-1.medium.com/max/1600/1*UDzzNYwInvHg25V_OtWejg.jpeg" alt="imagen"><br></div></div><br>  Como dije anteriormente, <b>Modelo</b> es solo un nombre abstracto para la capa donde estamos preparando los datos.  Suele contener repositorios y clases de datos.  Cada clase de entidad (datos) tiene una clase de <b>repositorio</b> correspondiente.  Por ejemplo, si tenemos las clases <b>User</b> y <b>Post</b> , tambi√©n debemos tener <b>UserRepository</b> y <b>PostRepository</b> .  Todos los datos provienen de all√≠.  Nunca debemos llamar a una instancia de Preferencias compartidas o DB desde View o ViewModel. <br><br>  Por lo tanto, podemos cambiar el nombre de nuestro RepoModel a <b>GitRepoRepository</b> , donde <b>GitRepo</b> vendr√° del repositorio de Github y <b>Repository</b> vendr√° del patr√≥n Repository. <br><br><div class="spoiler">  <b class="spoiler_title">RepoRepositories.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GitRepoRepository</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getGitRepositories</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(onRepositoryReadyCallback: OnRepositoryReadyCallback)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> arrayList = ArrayList&lt;Repository&gt;() arrayList.add(Repository(<span class="hljs-string"><span class="hljs-string">"First"</span></span>, <span class="hljs-string"><span class="hljs-string">"Owner 1"</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)) arrayList.add(Repository(<span class="hljs-string"><span class="hljs-string">"Second"</span></span>, <span class="hljs-string"><span class="hljs-string">"Owner 2"</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>)) arrayList.add(Repository(<span class="hljs-string"><span class="hljs-string">"Third"</span></span>, <span class="hljs-string"><span class="hljs-string">"Owner 3"</span></span>, <span class="hljs-number"><span class="hljs-number">430</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)) Handler().postDelayed({ onRepositoryReadyCallback.onDataReady(arrayList) }, <span class="hljs-number"><span class="hljs-number">2000</span></span>) } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnRepositoryReadyCallback</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: ArrayList&lt;Repository&gt;)</span></span></span><span class="hljs-function"> }</span></span></code> </pre> <br></div></div><br>  Ok, <b>MainViewModel</b> obtiene la lista de repositorios Github de <b>GitRepoRepsitories</b> , pero ¬øde d√≥nde obtener <b>GitRepoRepositories</b> ? <br><br>  Puede llamar al <b>cliente</b> o <b>DB</b> directamente en el repositorio desde la instancia, pero todav√≠a no es la mejor pr√°ctica.  Su aplicaci√≥n debe ser modular tanto como pueda.  ¬øQu√© sucede si decide usar diferentes clientes para reemplazar Volley con Retrofit?  Si tiene alg√∫n tipo de l√≥gica dentro, ser√° dif√≠cil refactorizar.  Su repositorio no necesita saber qu√© cliente est√° utilizando para recuperar los datos remotos. <br><br><ul><li>  Lo √∫nico que el repositorio necesita saber es que los datos llegan de forma remota o local.  No es necesario saber c√≥mo obtenemos estos datos remotos o locales. </li><li>  El √∫nico <b>modelo de vista</b> requerido son los datos. </li><li>  Lo √∫nico que debe hacer la <b>Vista</b> es mostrar estos datos. </li></ul><br>  Cuando reci√©n comenc√© a desarrollar en Android, me preguntaba c√≥mo funcionan las aplicaciones sin conexi√≥n y c√≥mo funciona la sincronizaci√≥n de datos.  Una buena arquitectura de aplicaciones nos permite hacer esto con facilidad.  Por ejemplo, cuando se <b>llama</b> a <b>loadRepositories</b> en <b>ViewModel</b> si hay una conexi√≥n a Internet, <b>GitRepoRepositories</b> puede recibir datos de una fuente de datos remota y guardarlos en una fuente de datos local.  Cuando el tel√©fono est√° desconectado, <b>GitRepoRepository</b> puede recibir datos del almacenamiento local.  Por lo tanto, los <b>repositorios</b> deben tener instancias de <b>RemoteDataSource</b> y <b>LocalDataSource</b> y el procesamiento l√≥gico de donde deber√≠an venir estos datos. <br><br>  Agregue una <b>fuente de datos local</b> : <br><br><div class="spoiler">  <b class="spoiler_title">GitRepoLocalDataSource.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GitRepoLocalDataSource</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRepositories</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(onRepositoryReadyCallback: OnRepoLocalReadyCallback)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> arrayList = ArrayList&lt;Repository&gt;() arrayList.add(Repository(<span class="hljs-string"><span class="hljs-string">"First From Local"</span></span>, <span class="hljs-string"><span class="hljs-string">"Owner 1"</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)) arrayList.add(Repository(<span class="hljs-string"><span class="hljs-string">"Second From Local"</span></span>, <span class="hljs-string"><span class="hljs-string">"Owner 2"</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>)) arrayList.add(Repository(<span class="hljs-string"><span class="hljs-string">"Third From Local"</span></span>, <span class="hljs-string"><span class="hljs-string">"Owner 3"</span></span>, <span class="hljs-number"><span class="hljs-number">430</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)) Handler().postDelayed({ onRepositoryReadyCallback.onLocalDataReady(arrayList) }, <span class="hljs-number"><span class="hljs-number">2000</span></span>) } <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">saveRepositories</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(arrayList: ArrayList&lt;Repository&gt;)</span></span></span></span>{ <span class="hljs-comment"><span class="hljs-comment">//todo save repositories in DB } } interface OnRepoLocalReadyCallback { fun onLocalDataReady(data: ArrayList&lt;Repository&gt;) }</span></span></code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqu√≠ tenemos dos m√©todos: el primero, que devuelve datos locales falsos, y el segundo, para el almacenamiento de datos ficticios. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agregar una </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fuente de datos remota</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitRepoRemoteDataSource.kt</font></font></b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GitRepoRemoteDataSource</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRepositories</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(onRepositoryReadyCallback: OnRepoRemoteReadyCallback)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> arrayList = ArrayList&lt;Repository&gt;() arrayList.add(Repository(<span class="hljs-string"><span class="hljs-string">"First from remote"</span></span>, <span class="hljs-string"><span class="hljs-string">"Owner 1"</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)) arrayList.add(Repository(<span class="hljs-string"><span class="hljs-string">"Second from remote"</span></span>, <span class="hljs-string"><span class="hljs-string">"Owner 2"</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>)) arrayList.add(Repository(<span class="hljs-string"><span class="hljs-string">"Third from remote"</span></span>, <span class="hljs-string"><span class="hljs-string">"Owner 3"</span></span>, <span class="hljs-number"><span class="hljs-number">430</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)) Handler().postDelayed({ onRepositoryReadyCallback.onRemoteDataReady(arrayList) }, <span class="hljs-number"><span class="hljs-number">2000</span></span>) } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnRepoRemoteReadyCallback</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onRemoteDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: ArrayList&lt;Repository&gt;)</span></span></span><span class="hljs-function"> }</span></span></code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solo hay un m√©todo que devuelve </font><font style="vertical-align: inherit;">datos </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">remotos</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> falsos </font><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahora podemos agregar algo de l√≥gica a nuestro repositorio:</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitRepoRepository.kt</font></font></b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GitRepoRepository</span></span></span><span class="hljs-class"> </span></span>{ val localDataSource = GitRepoLocalDataSource() val remoteDataSource = GitRepoRemoteDataSource() <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRepositories</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(onRepositoryReadyCallback: OnRepositoryReadyCallback)</span></span></span><span class="hljs-function"> </span></span>{ remoteDataSource.getRepositories( object : OnRepoRemoteReadyCallback { <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: ArrayList&lt;Repository&gt;)</span></span></span><span class="hljs-function"> </span></span>{ localDataSource.saveRepositories(data) onRepositoryReadyCallback.onDataReady(data) } }) } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnRepositoryReadyCallback</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: ArrayList&lt;Repository&gt;)</span></span></span><span class="hljs-function"> }</span></span></code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por lo tanto, al compartir fuentes, f√°cilmente guardamos datos localmente. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øQu√© sucede si solo necesita datos de la red y a√∫n necesita usar la plantilla de repositorio?</font></font> Si<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Esto hace que las pruebas de c√≥digo sean m√°s f√°ciles, otros desarrolladores pueden entender mejor su c√≥digo y usted puede admitirlo m√°s r√°pido </font></font><br><br>  ... <br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Contenedores de Android Manager </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øQu√© </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sucede</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> si desea verificar su conexi√≥n a Internet en </font><b><font style="vertical-align: inherit;">GitRepoRepository</font></b><font style="vertical-align: inherit;"> para saber d√≥nde solicitar datos? </font><font style="vertical-align: inherit;">Ya dijimos que no deber√≠amos colocar ning√∫n c√≥digo relacionado con Android en </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ViewModel and Model</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , entonces, ¬øc√≥mo lidiar con este problema? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Escribamos un contenedor para una conexi√≥n a internet:</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NetManager.kt (Una soluci√≥n similar se aplica a otros gerentes, por ejemplo, a NfcManager)</font></font></b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NetManager</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">var</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">applicationContext</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Context</span></span></span><span class="hljs-class">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> status: Boolean? = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> val isConnectedToInternet: Boolean? get() { val conManager = applicationContext.getSystemService(Context.CONNECTIVITY_SERVICE) as ConnectivityManager val ni = conManager.activeNetworkInfo <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ni != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; ni.isConnected } }</code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Este c√≥digo solo funcionar√° si agregamos permiso para manifestar: </font></font><br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.INTERNET"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.ACCESS_NETWORK_STATE"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.ACCESS_WIFI_STATE"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pero, ¬øc√≥mo crear una instancia en el repositorio, si no tenemos el contexto ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">context La</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )? </font><font style="vertical-align: inherit;">Podemos solicitarlo en el constructor:</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitRepoRepository.kt</font></font></b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GitRepoRepository</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">context</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Context</span></span></span><span class="hljs-class">)</span></span>{ val localDataSource = GitRepoLocalDataSource() val remoteDataSource = GitRepoRemoteDataSource() val netManager = NetManager(context) <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRepositories</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(onRepositoryReadyCallback: OnRepositoryReadyCallback)</span></span></span><span class="hljs-function"> </span></span>{ remoteDataSource.getRepositories(object : OnRepoRemoteReadyCallback { <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: ArrayList&lt;Repository&gt;)</span></span></span><span class="hljs-function"> </span></span>{ localDataSource.saveRepositories(data) onRepositoryReadyCallback.onDataReady(data) } }) } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnRepositoryReadyCallback</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: ArrayList&lt;Repository&gt;)</span></span></span><span class="hljs-function"> }</span></span></code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Creamos antes de la nueva instancia de GitRepoRepository en ViewModel. </font><font style="vertical-align: inherit;">¬øC√≥mo podemos ahora tener </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NetManager</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en ViewModel cuando </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">necesitamos contexto para NetManager</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ? </font><font style="vertical-align: inherit;">Puede usar AndroidViewModel desde la biblioteca de componentes de Lifecycle-aware, que tiene un </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contexto</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Este es el contexto de la aplicaci√≥n, no la Actividad.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MainViewModel.kt</font></font></b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainViewModel</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AndroidViewModel</span></span></span><span class="hljs-class"> </span></span>{ constructor(application: Application) : <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(application) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> gitRepoRepository: GitRepoRepository = GitRepoRepository(NetManager(getApplication())) val text = ObservableField(<span class="hljs-string"><span class="hljs-string">"old data"</span></span>) val isLoading = ObservableField(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> repositories = MutableLiveData&lt;ArrayList&lt;Repository&gt;&gt;() <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadRepositories</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ isLoading.set(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) gitRepoRepository.getRepositories(object : OnRepositoryReadyCallback { <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: ArrayList&lt;Repository&gt;)</span></span></span><span class="hljs-function"> </span></span>{ isLoading.set(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) repositories.value = data } }) } }</code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> En esta linea </font></font><br><br><pre> <code class="java hljs">constructor(application: Application) : <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(application)</code> </pre> <br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Definimos</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> un constructor para </font><b><font style="vertical-align: inherit;">MainViewModel</font></b><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Esto es necesario porque </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AndroidViewModel</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> solicita una instancia de la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aplicaci√≥n</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en su constructor. </font><font style="vertical-align: inherit;">Entonces, en nuestro constructor, llamamos al s√∫per m√©todo que llama al constructor </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AndroidViewModel</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , del cual heredamos. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota: podemos deshacernos de una l√≠nea si lo hacemos:</font></font><br><br><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainViewModel</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">application</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Application</span></span></span><span class="hljs-class">) : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AndroidViewModel</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">application</span></span></span><span class="hljs-class">) </span></span>{ ... }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y ahora que tenemos la instancia de NetManager en el </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitRepoRepository</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , podemos verificar la conexi√≥n a Internet:</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitRepoRepository.kt</font></font></b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GitRepoRepository</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">val</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">netManager</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NetManager</span></span></span><span class="hljs-class">) </span></span>{ val localDataSource = GitRepoLocalDataSource() val remoteDataSource = GitRepoRemoteDataSource() <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRepositories</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(onRepositoryReadyCallback: OnRepositoryReadyCallback)</span></span></span><span class="hljs-function"> </span></span>{ netManager.isConnectedToInternet?.let { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (it) { remoteDataSource.getRepositories(object : OnRepoRemoteReadyCallback { <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onRemoteDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: ArrayList&lt;Repository&gt;)</span></span></span><span class="hljs-function"> </span></span>{ localDataSource.saveRepositories(data) onRepositoryReadyCallback.onDataReady(data) } }) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { localDataSource.getRepositories(object : OnRepoLocalReadyCallback { <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onLocalDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: ArrayList&lt;Repository&gt;)</span></span></span><span class="hljs-function"> </span></span>{ onRepositoryReadyCallback.onDataReady(data) } }) } } } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnRepositoryReadyCallback</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: ArrayList&lt;Repository&gt;)</span></span></span><span class="hljs-function"> }</span></span></code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por lo tanto, si tenemos una conexi√≥n a Internet, recibiremos los datos eliminados y los guardaremos localmente. Si no tenemos una conexi√≥n a Internet, obtendremos datos locales. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota de Kotlin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : la instrucci√≥n </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">let</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comprueba si es nula y devuelve un valor dentro de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ella</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En uno de los siguientes art√≠culos escribir√© sobre la inyecci√≥n de dependencias, lo malo que es crear instancias de repositorio en ViewModel y c√≥mo evitar usar AndroidViewModel. Tambi√©n escribir√© sobre una gran cantidad de problemas que ahora est√°n en nuestro c√≥digo. Los dej√© por una raz√≥n ... </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Estoy tratando de mostrarle los problemas para que pueda entender por qu√© todas estas bibliotecas son populares y por qu√© deber√≠a usarlas.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PD Me he cambiado de opini√≥n sobre el asignador ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cart√≥grafos</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Decid√≠ cubrir esto en los siguientes art√≠culos.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es432826/">https://habr.com/ru/post/es432826/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es432816/index.html">AXIS M3046-V versus IDIS DC-D3212X: Comparar c√°maras CCTV</a></li>
<li><a href="../es432818/index.html">Plotter casero: consejos para principiantes, trabajar con firmware grbl</a></li>
<li><a href="../es432820/index.html">Pruebas din√°micas de aplicaciones de Android.</a></li>
<li><a href="../es432822/index.html">Echo a perder el c√≥digo de mi vida para los desarrolladores y ya no quiero hacerlo</a></li>
<li><a href="../es432824/index.html">Acelerando la creaci√≥n de ConcurrentReferenceHashMap</a></li>
<li><a href="../es432828/index.html">Prueba y depuraci√≥n de MapReduce</a></li>
<li><a href="../es432830/index.html">Sistema automatizado para imponer multas por basura abandonada</a></li>
<li><a href="../es432832/index.html">C√≥mo "pegar" un servidor basado en Intel y superar el l√≠mite m√°ximo de escala de 8 procesadores</a></li>
<li><a href="../es432834/index.html">Enlace interno y externo en C ++</a></li>
<li><a href="../es432836/index.html">La primera buena bombilla de AliExpress</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>