<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😚 🚠 🌈 TelegramBot. الوظائف الأساسية. ملصقات والمشاعر. (الجزء 3) 👏🏿 👳🏿 👐🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="واحدة من الأسئلة التي غالبا ما تأتي في PM هو كيفية العمل مع الابتسامات (الرموز التعبيرية) والملصقات. 

 كيفية العمل معهم ، ما هي الأدوات التي أستخدمها...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>TelegramBot. الوظائف الأساسية. ملصقات والمشاعر. (الجزء 3)</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482260/" style=";text-align:right;direction:rtl"> واحدة من الأسئلة التي غالبا ما تأتي في PM هو كيفية العمل مع الابتسامات (الرموز التعبيرية) والملصقات. <br><br>  كيفية العمل معهم ، ما هي الأدوات التي أستخدمها ، إلخ. <br><br>  في هذا الجزء ، سننظر في مثل هذه الأمور: كيفية إنشاء رسالة باستخدام ملصق ، وكيفية معالجة رسالة مستلمة مع ملصق ، وكيفية العثور على جميع الرموز (الرموز التعبيرية) في نص الرسالة ، وكيفية إنشاء رسالة باستخدام الرموز. <br><br>  من يهتم ، من فضلك ، تحت القط. <br><a name="habracut"></a><br>  حسب التقاليد ، نبدأ المقال مع رابط للمصدر لأنه :) <br><br>  يتم تجميع كافة التعليمات البرمجية التي تمت مناقشتها في المقالة في <a href="https://github.com/dp-ua/TelegramBotBase/tree/Part3-Stick_and_Emoji">الفرع Part3-Stick_and_Emoji</a> . <br><br><h3 style=";text-align:right;direction:rtl">  ملصقات </h3><br>  واحدة من الأشياء التي أعجبتني كثيرًا في البرق بمجرد ظهورها هي الملصقات.  أنها باردة ومريحة وخالية.  وكل هذه المجموعة الضخمة من الملصقات التي نريد استخدامها بشكل طبيعي في الروبوت.  في الواقع ، هذا الإجراء بسيط جدا.  لإرسال ملصق إلى أحد المستخدمين ، نحتاج فقط إلى معرفة هوية الملصق وأي شيء آخر. <br>  عادةً ما يتعلق بالملصقات ، أقوم بإنشاء فئة مساعدين بنفسي ، حيث أقوم بتخزين البيانات حول الملصقات المستخدمة في الروبوت: <br><br>  <a href="">Stickers.java</a> <br><br><pre style=";text-align:right;direction:rtl"><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.telegram.telegrambots.api.methods.send.SendSticker; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> Stickers { FUNNY_JIM_CARREY(<span class="hljs-string"><span class="hljs-string">"CAADBQADiQMAAukKyAPZH7wCI2BwFxYE"</span></span>), ; String stickerId; Stickers(String stickerId) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.stickerId = stickerId; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> SendSticker </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSendSticker</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String chatId)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-string"><span class="hljs-string">""</span></span>.equals(chatId)) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IllegalArgumentException(<span class="hljs-string"><span class="hljs-string">"ChatId cant be null"</span></span>); SendSticker sendSticker = getSendSticker(); sendSticker.setChatId(chatId); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sendSticker; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> SendSticker </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSendSticker</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ SendSticker sendSticker = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SendSticker(); sendSticker.setSticker(stickerId); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sendSticker; } }</code> </pre> <br>  كل شيء بسيط هنا.  نعطي الملصق اسمًا مفهومًا لنا.  وبمساعدة من طريقتين نحصل على كائن جاهز للإرسال إلى المستخدم. <br><br>  للإجابة على السؤال: "من أين يمكنني الحصول على معرف الملصق؟" ، - دعنا نكتب مساعدًا سيقدم لنا هذه البيانات في روبوتنا. <br><br>  لدينا الوظائف الأساسية التي أنشأناها هنا: <br>  <a href="https://habr.com/ru/post/481354/">TelegramBot.</a>  <a href="https://habr.com/ru/post/481354/">الوظائف الأساسية.</a>  <a href="https://habr.com/ru/post/481354/">(الجزء 2)</a> <br>  لكي يبدأ الروبوت الخاص بنا في معالجة الملصقات المقبولة بطريقة ما ، نحتاج إلى: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  تحديد أنهم أرسلوا لنا ملصقا </li><li style=";text-align:right;direction:rtl">  حدد أي معالج مسؤول عن معالجة الرسائل باستخدام الملصقات </li><li style=";text-align:right;direction:rtl">  قم بتشغيل معالج يقوم بإنشاء رسالة للمستخدم استجابةً لذلك </li></ul><br>  <b>المهمة</b> : عند تلقي ملصق في الدردشة ، يجب أن يرسل الروبوت رسالة نصية بها معرف الملصق استجابةً لذلك. <br><br>  أضفنا الأمر <a href="">STICKER</a> إلى قائمة الأوامر <br><br>  في محلل التحديث الذي تم إرساله ، سنحاول تحديد ما إذا كانت لدينا رسالة نصية أم أنها تحتوي على ملصق: <br><br>  <a href="">MessageReciever.java سطر 57</a> <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (message.hasText()) { parsedCommand = parser.getParsedCommand(message.getText()); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Sticker sticker = message.getSticker(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sticker != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { parsedCommand = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ParsedCommand(Command.STICKER, sticker.getFileId()); } }</code> </pre> <br>  لأن  لسنا بحاجة إلى القيام بمعالجة معقدة للرسالة المرسلة ، فسنقوم بتكليف معالجة الرسائل التي تحتوي على الملصق إلى المعالج الحالي المسؤول عن معالجة ما يسمى "رسائل النظام": <br>  <a href="">MessageReciever.java سطر 86</a> <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> START: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> HELP: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ID: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> STICKER: SystemHandler systemHandler = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SystemHandler(bot); log.info(<span class="hljs-string"><span class="hljs-string">"Handler for command["</span></span> + command.toString() + <span class="hljs-string"><span class="hljs-string">"] is: "</span></span> + systemHandler); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> systemHandler;</code> </pre> <br>  وفقًا لذلك ، في <b>SystemHandler</b> نحتاج إلى تحديد كيفية معالجة أمر <b>STICKER الذي تم</b> استلامه: <br>  <a href="">SystemHandler.java سطر 31</a> <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> STICKER: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"StickerID: "</span></span> + parsedCommand.getText();</code> </pre> <br>  نتيجة لذلك ، عند إرسال أي لاصق إلى برنامج الروبوت الخاص بنا ، سوف نتلقى هويته ردًا على ذلك: <br><br><img src="https://habrastorage.org/webt/3i/56/dy/3i56dyf1gkch2j-xgy9o-gjk8si.png"><br><br><h3 style=";text-align:right;direction:rtl">  المشاعر أو الرموز التعبيرية </h3><br>  كانت موحدة ، وفهم جميع الأجهزة وأنظمة التشغيل تقريبا وقادرة على عرضها.  أنها مريحة للغاية لاستخدامها لتزيين الرسائل.  تبدو بإيجاز على الأزرار الموجودة أسفل الرسائل.  شئنا أم أبينا - بعض المزايا. <br><br>  على سبيل المثال ، في <a href="https://t.me/EventCheckPlanner_Bot">بوت جدولة الحدث</a> <br><br><img src="https://habrastorage.org/webt/r3/bq/bd/r3bqbdspnrch4-qy28vppzwxiks.png"><br><br>  باستخدام نفس الأيقونات على الأزرار وفي نص الرسالة ، تسمح للمستخدم بإدراك وفهم واجهتك ، مما يؤدي إلى تشويش الرسالة والأزرار بنص زائد. <br><br>  لعرض الرموز التعبيرية في رسالة أو على زر ، تحتاج إلى معرفة يونيكود.  الإنترنت مليء بالمصادر حيث يمكنك العثور على جميع الرموز المدرجة ، حيث تتم الإشارة إلى رموزها. <br>  بالنسبة لي ، اخترت هذه الطريقة في العمل مع الرموز التعبيرية: إنه أكثر ملاءمة لمشاهدة واختيار الرموز في البرقية نفسها. <br><br>  حسنًا ، بالطبع ، عن طريق القياس مع الملصقات ، فلنكتب مساعدًا صغيرًا لأنفسنا الذين سيظهرون لنا الرموز اللازمة وحتى نضمن معالجتها بشكل صحيح. <br><br>  بادئ ذي بدء ، أضف التبعية التالية إلى <a href="">pom.xml</a> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.vdurmont<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>emoji-java<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>3.3.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  بصراحة ، لا أتذكر المكان الذي صادفته ، لكنني منذ ذلك الحين لا أستخدمه إلا إذا احتجت إلى فعل شيء مع الرموز في روبوتي. <br><br>  تحتوي المكتبة على العديد من الأدوات المختلفة: <br><br><img src="https://habrastorage.org/webt/ri/4e/qm/ri4eqmdo2uiyrnwoxck1trfklim.png"><br><br>  سوف فضولي وفضولي يكون حيث يستدير :) <br><br>  ما الذي يتطلبه الأمر لإرسال التعبيرات باستخدام الروبوت؟  تحتاج إلى تضمين الرموز التعبيرية المطلوبة في نص رسالة Unicode. <br><br>  نعم ، يمكنك العثور على الموارد التي تعطي قوائم Unicode مع الرموز التعبيرية ، وتظهر جداول ملخص مختلفة لكيفية ظهور الرموز على الهواتف الذكية المختلفة. <br><br>  أريد أن أوضح لك الطريقة التي أصبحت أكثر ملائمة للعمل مع الابتسامات من أجلي. <br><br>  أولاً ، دعنا نرى كيف يمكنك استخدام الابتسامات في البرقية نفسها.  يمكنك استدعاء مربع حوار حيث يتم سرد جميع الرموز وإضافتها إلى الرسالة ، ببساطة عن طريق النقر على أيقوناتها.  يمكن أيضًا إضافة الرموز إلى الرسالة باستخدام العلامات. <br><br>  يجب وضع العلامات في علامات نقطية وتحتوي على نوع من النص الفريد الذي يشير إلى الابتسامة المطلوبة. <br><br>  إذا بدأت في حقل إدخال رسالة في كتابة رسالة تبدأ بنقطتين ، سيبدأ التلغراف نفسه في إظهار الرموز التعبيرية التي تحتوي على النص المدخل للعلامة: <br><br><img src="https://habrastorage.org/webt/hr/s4/1o/hrs41orsvl1k4mkpt7mxlja-bnm.png"><br><br>  وعندما تدخل علامة التعبيرات الصحيحة وتضع علامة القولون ، فإن النص سيتحول إلى ابتسامة.  يتم أيضًا عرض العلامات إذا كنت تضغط على زر الماوس الأيسر على التعبيرات. <br><br><img src="https://habrastorage.org/webt/t-/ib/ya/t-ibya9mw4829qau8wnz9h8uxwq.png"><br><br>  والآن تأتي المكتبة لمساعدتنا ، التي أضفناها أعلاه.  إنها تعرف كيفية التعامل مع علامات التعبيرات.  هذا مناسب لك في المقام الأول ، حيث أن العلامات أكثر قابلية للقراءة ، فهي تحمل نوعًا من المعنى. <br><br>  ونحن ، معرفة العلامة ، يمكننا الحصول على التعبيرات الخاصة بـ Unicode مثل هذا: <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">String emoji_kissing = EmojiParser.parseToUnicode(<span class="hljs-string"><span class="hljs-string">":kissing:"</span></span>);</code> </pre> <br>  يمكنك أن تجعل نفسك فصلًا منفصلاً ستحتفظ فيه بالرموز التي تستخدمها في الروبوت.  على سبيل المثال من <a href="https://t.me/EventCheckPlanner_Bot">مخطط الحدث</a> نفسه ، لديه هذه الابتسامات في ترسانته: <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.vdurmont.emoji.EmojiParser; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> Icon { PLUS(<span class="hljs-string"><span class="hljs-string">":heavy_plus_sign:"</span></span>), MINUS(<span class="hljs-string"><span class="hljs-string">":heavy_minus_sign:"</span></span>), CHECK(<span class="hljs-string"><span class="hljs-string">":white_check_mark:"</span></span>), NOT(<span class="hljs-string"><span class="hljs-string">":x:"</span></span>), DOUBT(<span class="hljs-string"><span class="hljs-string">":zzz:"</span></span>), FLAG(<span class="hljs-string"><span class="hljs-string">":checkered_flag:"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String value; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> EmojiParser.parseToUnicode(value); } Icon(String value) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.value = value; } }</code> </pre> <br>  وهذه هي الطريقة التي سيبدو بها الكود باستخدام هذه الفئة وشعور معين: <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> row.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InlineKeyboardButton() .setText(Icon.CHECK.get() + <span class="hljs-string"><span class="hljs-string">" I'm going"</span></span>)</code> </pre> <br>  هذا هو رمز هذا الزر: <br><br><img src="https://habrastorage.org/webt/bc/lw/ou/bclwou1ukoe0nosc7iyfnqw6zki.png"><br><br>  لقد لاحظت فارق بسيط واحد من هذه المكتبة.  ليست كل الرموز الموجودة في برقية ، يمكن للمكتبة التعرف عليها.  لذلك ، احترس من الإصدارات الجديدة من المكتبة. <br><br>  حسنًا ، للتأكد تمامًا من الابتسامات التي يمكن أن نظهرها وأيها لا ، سوف ننادي بهذه المهمة إلى مساعدنا. <br><br>  <b>المهمة:</b> إذا كانت الرسالة المرسلة لا تحتوي على أي أمر محدد ، ولكن تحتوي على الرموز في النص - فقم بعرض هذه الرموز على الشاشة في شكل رسالة إلى المستخدم والإشارة إلى سماتها (العلامة والوصف). <br><br>  أضف الأمر <b>TEXT_CONTAIN_EMOJI</b> إلى قائمة الأوامر <br>  <a href="">سطر Command.java 8</a> <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> Command { ... TEXT_CONTAIN_EMOJI, ... }</code> </pre> <br>  في المحلل اللغوي الذي يحدد نوع الأمر المتضمن في رسالتنا ، أضف النص التالي: <br><br>  <a href="">Parser.java سطر 38</a> <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result.getCommand() == Command.NONE) { List&lt;String&gt; emojiContainsInText = EmojiParser.extractEmojis(result.getText()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (emojiContainsInText.size() &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) result.setCommand(Command.TEXT_CONTAIN_EMOJI); }</code> </pre> <br>  إذا قررنا أن الرسالة لا تحتوي على أي أمر محدد ، ولكن هناك رموز في هذه الرسالة ، فإننا نرجع أننا قمنا بتحليل الأمر TEXT_CONTAIN_EMOJI. <br><br>  قم بإنشاء معالج منفصل يقوم بمعالجة هذا الأمر فقط: <br>  <a href="">EmojiHandler.java</a> <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.example.telegrambot.bot.Bot; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.example.telegrambot.command.ParsedCommand; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.vdurmont.emoji.Emoji; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.vdurmont.emoji.EmojiManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.vdurmont.emoji.EmojiParser; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.log4j.Logger; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.telegram.telegrambots.api.objects.Update; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.HashSet; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Set; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EmojiHandler</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AbstractHandler</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Logger log = Logger.getLogger(EmojiHandler.class); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EmojiHandler</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bot bot)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(bot); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">operate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String chatId, ParsedCommand parsedCommand, Update update)</span></span></span><span class="hljs-function"> </span></span>{ String text = parsedCommand.getText(); StringBuilder result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); Set&lt;String&gt; emojisInTextUnique = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashSet&lt;&gt;(EmojiParser.extractEmojis(text)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (emojisInTextUnique.size() &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) result.append(<span class="hljs-string"><span class="hljs-string">"Parsed emojies from message:"</span></span>).append(<span class="hljs-string"><span class="hljs-string">"\n"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (String emojiUnicode : emojisInTextUnique) { Emoji byUnicode = EmojiManager.getByUnicode(emojiUnicode); log.debug(byUnicode.toString()); String emoji = byUnicode.getUnicode() + <span class="hljs-string"><span class="hljs-string">" "</span></span> + byUnicode.getAliases() + <span class="hljs-string"><span class="hljs-string">" "</span></span> + byUnicode.getDescription(); result.append(emoji).append(<span class="hljs-string"><span class="hljs-string">"\n"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result.toString(); } }</code> </pre> <br>  يحدد هذا الرمز الرموز فقط من نص الرسالة ، ويشكل مجموعة ذات رموز فريدة ، ويختار العلامات والوصف من خصائصه ، وينشئ رسالة نصية من هذا. <br><br>  تبدو نتيجة العمل كما يلي: <br><br><img src="https://habrastorage.org/webt/ia/wy/sx/iawysxkxh3utfud9znjifqrgosm.png"><br><br>  في الأقواس المربعة ، نحصل على علامات يمكننا استخدامها لإدراج الرموز.  يمكنك أن ترى أن أكثر من علامة تشير في بعض الأحيان إلى تعبير واحد. <br><br>  وأيضًا ، بمساعدة هذا المساعد ، يمكننا أن نفهم بدقة الرموز التي تتفهمها مكتبتنا وتلك التي تتجاهلها. <br><br>  على سبيل المثال ، يمكنك أن ترى هنا: <br><br><img src="https://habrastorage.org/webt/bz/f9/5i/bzf95i9alj3uqweuzdxfqg9ost0.png"><br><br>  ابتسم مع الكود <i>: face_with_monocle:</i> لسبب ما لم يتم اكتشافه بواسطة هذه المكتبة. <br><br>  لذلك ، لدينا معالج.  كيف ننقل المهمة إليه؟ <br><br>  لأن  نحن نعلم بالفعل أنه يتم اكتشاف رسالة نصية ذات رموز تعبيرية داخلية كأمر TEXT_CONTAIN_EMOJI - في MessageReciever نحتاج إلى الإشارة إلى أن معالج EmojiHandler منفصل مسؤول عن معالجة هذا الأمر. <br><br>  <a href="">MessageReciever.java سطر 94</a> <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> TEXT_CONTAIN_EMOJI: EmojiHandler emojiHandler = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EmojiHandler(bot); log.info(<span class="hljs-string"><span class="hljs-string">"Handler for command["</span></span> + command.toString() + <span class="hljs-string"><span class="hljs-string">"] is: "</span></span> + emojiHandler); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> emojiHandler;</code> </pre> <br>  برنامج في المتعة ولا تتردد في طرح الأسئلة :) <br><br>  PS <br>  يمكنك أن تشعر بالبوت من خلال هذه الوظيفة هنا: <a href="https://t.me/test_habr_bot">https://t.me/test_habr_bot</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar482260/">https://habr.com/ru/post/ar482260/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar482248/index.html">نشارك تجربتنا في كيفية ظهور محركات أقراص الحالة الثابتة تحت RAID ومستوى الصفيف الأكثر ربحية</a></li>
<li><a href="../ar482250/index.html">آلة دولة بسيطة ل VueJS</a></li>
<li><a href="../ar482254/index.html">تجربة VonmoTrade. الجزء 3: كتاب أوامر. معالجة وتخزين المعلومات التجارية</a></li>
<li><a href="../ar482256/index.html">الذكاء الاصطناعي ومستقبل العمل: فرص العمل في المستقبل القريب</a></li>
<li><a href="../ar482258/index.html">كيف تعمل الشبكات العصبية ولماذا بدأت تجلب أموالاً كبيرة</a></li>
<li><a href="../ar482262/index.html">كيفية تسجيل الدخول في Talend Open Studio</a></li>
<li><a href="../ar482264/index.html">البرازيل ، السحر الداكن ، مورتال كومبات ، المريخ و 15000 شخص. نتائج العام Ontiko</a></li>
<li><a href="../ar482268/index.html">هياكل ضخمة للمستقبل: كرة دايسون ، محرك نجمي و "قنبلة ثقب أسود"</a></li>
<li><a href="../ar482272/index.html">اختيار مستودع بيانات لـ Prometheus: Thanos vs VictoriaMetrics</a></li>
<li><a href="../ar482274/index.html">5 أسباب لماذا يجب أن تتوقف عن استخدام System.Drawing في ASP.NET</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>