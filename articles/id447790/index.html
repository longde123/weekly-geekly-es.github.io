<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📔 🤷🏿 🔰 Belajar menulis kontrak pintar pada RIDE dan RIDE4DAPPS. Bagian 1 (Dompet Multiuser) 🔰 🤹🏽 🗄️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo semuanya! 


 Baru-baru ini, Waves Labs mengumumkan kompetisi untuk pengembang yang didedikasikan untuk merilis ekstensi bahasa kontrak pintar RI...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Belajar menulis kontrak pintar pada RIDE dan RIDE4DAPPS. Bagian 1 (Dompet Multiuser)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/447790/"><p><img src="https://habrastorage.org/webt/hb/tu/r2/hbtur2vzsoyu97xxymahyvpyf1k.png"></p><br><p>  Halo semuanya! </p><br><p>  Baru-baru ini, Waves Labs <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">mengumumkan</a> kompetisi untuk pengembang yang didedikasikan untuk merilis ekstensi bahasa kontrak pintar RIDE untuk aplikasi terdesentralisasi Ride4Dapps ke jaringan uji! </p><br><p>  Kami memilih kasus DAO, karena <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Ventuary</a> berencana untuk mengembangkan dApp dengan fungsi sosial: voting, penggalangan dana, manajemen kepercayaan, dll. </p><br><p>  Kami mulai dengan contoh sederhana di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sesi Tanya Jawab</a> dan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">IDE RIDE</a> - contoh dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dompet umum</a> . </p><a name="habracut"></a><br><p>  Mari kita lihat contoh ini, uji hipotesis dan pertimbangkan beberapa keanehan: </p><br><p>  Biarkan kami memiliki Alice - Pemilik dApp <br>  Boob dan Cooper adalah mitra Alice, salah satu pendiri Alice-BC DAO <br>  Neli adalah pemilik bisnis yang membutuhkan pembiayaan <br>  Bank - bank yang mendistribusikan token </p><br><h4>  Tahap 1. Inisialisasi saldo </h4><br><p>  Untuk menerima token di jaringan uji gelombang, Anda perlu menghubungi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">faucet</a> dan menentukan alamat token yang harus dikirim. </p><br><p>  Alamat tersebut dapat ditemukan di IDE dengan mengungkapkan informasi akun. </p><br><p>  Pilih Bank 10 GELOMBANG.  Setelah kami memverifikasi bahwa mereka datang melalui blok dan penjelajah transaksi: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">browser</a> </p><br><p>  Sekarang mari kita bagikan token dari bank ke peserta lain.  (Catatan: Semua transaksi dalam jaringan ombak tidak gratis, oleh karena itu, keseimbangan positif minimum diperlukan untuk semua peserta untuk menyelesaikan transaksi). </p><br><blockquote>  1 GELOMBANG = 100000000 unit (wavelet), karena jumlah hanya bisa bilangan bulat <br>  0,01 GELOMBANG (Biaya Transaksi) = 1000000 </blockquote><p>  Bank -&gt; [3 WAVES] -&gt; Alice, melalui TransferTransaction (Tipe: 4). </p><br><p>  Kami memverifikasi bahwa env.SEED dari mana transaksi ditandatangani sesuai dengan Bank kami: </p><br><p><img src="https://habrastorage.org/webt/cm/zh/zq/cmzhzq4a9z5hrejneh21hz94rck.png"><br>  ￼ <br>  Jika Anda tidak memiliki frasa unggulan yang cocok, cukup alihkan ke sana di tab Akun dan periksa lagi. </p><br><p>  Setelah itu, kami membuat, mengumumkan dan menandatangani transaksi pada transfer 3 GELOMBANG Alice. <br>  Anda juga dapat mempelajari data Alice melalui variabel env.accounts.  Penomoran dimulai dari 0, masing-masing Alice adalah env.accounts [1]. </p><br><p><img src="https://habrastorage.org/webt/e6/l_/if/e6l_ifwovlpgy4w7siy86jagamo.png"></p><br><pre><code class="scala hljs">broadcast(transfer({recipient:address(env.accounts[<span class="hljs-number"><span class="hljs-number">1</span></span>]), amount: <span class="hljs-number"><span class="hljs-number">300000000</span></span>, fee: <span class="hljs-number"><span class="hljs-number">1000000</span></span>}))</code> </pre> <br><p>  Hasilnya juga dapat diamati di browser, tautannya akan kembali kepada kami segera setelah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">transaksi</a> . </p><br><p>  Kami memastikan bahwa saldo Alice diisi kembali oleh 3 GELOMBANG, dan bahwa 10 - 3 - 0,01 = 0,699 tetap pada saldo bank. </p><br><p><img src="https://habrastorage.org/webt/mf/9o/xf/mf9oxf5scbacjrcwe--sthtyfvg.png"></p><br><p><img src="https://habrastorage.org/webt/sk/nr/0d/sknr0djykfnrmbamhg7pz4ne_ye.png"></p><br><p>  Kami mengirim Boob dan Cooper dalam 3 GELOMBANG, dan Neli, Xena dan Mark dalam 0,2 GELOMBANG dengan cara yang sama. <br>  (Catatan: Kami membuat satu kesalahan karakter dan mengirim Neli 0,02 WAVES. Hati-hati!) </p><br><pre> <code class="scala hljs">broadcast(transfer({recipient:address(env.accounts[<span class="hljs-number"><span class="hljs-number">4</span></span>]), amount: <span class="hljs-number"><span class="hljs-number">20000000</span></span>, fee: <span class="hljs-number"><span class="hljs-number">1000000</span></span>}))</code> </pre> <br><p>  Setelah mengisi saldo semua peserta, kita melihat: </p><br><p><img src="https://habrastorage.org/webt/dx/wd/aw/dxwdawf7j9hyghtpzwh1wpljprq.png"></p><br><h4>  Tahap 2. Membuat akun dApp </h4><br><p>  Kami sepakat bahwa pencipta dan pemilik aplikasi yang didesentralisasi adalah Alice. <br>  Di Akun, buka untuk menginstalnya sebagai SEED dan periksa cocok env.SEED Alice. </p><br><p>  Mari kita coba instal di akun Alice script (kontrak) paling sederhana yang mungkin. <br>  Kontak pintar di Waves adalah predikat yang melarang atau mengizinkan segala jenis transaksi keluar dijalankan dalam kondisi tertentu.  Dalam hal ini, kondisi ini SELALU.  Kode kontrak itu benar.  Kami memanggil deploy (). </p><br><p><img src="https://habrastorage.org/webt/wu/py/dy/wupydyzu8vi884kj7apghkg5l-i.png"></p><br><p>  Biaya untuk transaksi setScript 1400000/100000000 = 0,014 GELOMBANG.  Alice memiliki 2.986 GELOMBANG pada keseimbangannya. </p><br><p>  Mari kita coba sekarang untuk menginstal pada akun Alice logika kontrak pintar yang lebih kompleks yang dijelaskan dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">contoh</a> </p><br><blockquote>  <strong>Ride4Dapps</strong> sekarang mencakup 2 jenis anotasi baru: <br><ol><li>  <strong>@Callable (i)</strong> - mengambil sebagai parameter i, data tentang akun mana yang menyebabkan / menandatangani transaksi.  Hasil dari fungsi ini menentukan perubahan dalam status akun dApp.  Akun lain dapat membuat transaksi dan melakukan fungsi dengan anotasi ini dan mengubah status akun dApp. </li><li>  <strong>@ Verifier (tx)</strong> - Verifikasi transaksi dengan parameter tx transaksi.  Sesuai dengan logika predikat dari RIDE.  Dalam ungkapan ini Anda dapat mengaktifkan atau menonaktifkan perubahan lebih lanjut pada logika kontrak pintar pada akun dApp. <br>  <strong>Berhati-hatilah!</strong>  Poin penting adalah bahwa secara default skrip pada akun tidak sama dengan <strong>true</strong> , tetapi menggunakan perbandingan tanda tangan dan hanya memungkinkan pemilik tanda tangan untuk melakukan transaksi. <br><pre> <code class="scala hljs">sigVerify(tx.bodyBytes, tx.proofs[<span class="hljs-number"><span class="hljs-number">0</span></span>], tx.senderPk)</code> </pre> <br><br>  <strong>Tanpa verifikasi semacam itu, siapa pun dapat melakukan transaksi dari akun!</strong> </li></ol><br></blockquote><p>  Mari menjadikan akun <strong>dApp</strong> sebagai dompet umum untuk semua peserta. </p><br><p><img src="https://habrastorage.org/webt/e4/9m/ch/e49mchekxv3gxshylylb2s5gssi.png"></p><br><p>  Untuk memeriksa kontrak mana yang saat ini aktif di akun Anda, Anda dapat menyalin kode base64 kontrak pintar di browser blok dan mengenalinya melalui dekompiler ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">misalnya</a> ) </p><br><p><img src="https://habrastorage.org/webt/z5/xs/iv/z5xsiv5y_6akufw4svzyrfdwipy.png"></p><br><p><img src="https://habrastorage.org/webt/zf/w4/ii/zfw4iinsin-antvfjf71oghpypw.png"></p><br><p><img src="https://habrastorage.org/webt/vb/0t/tj/vb0ttjszckd-brvl_7sty0kxuty.png"></p><br><p>  Kami memastikan bahwa logika kontrak pintar sesuai dengan yang kami harapkan. <br>  Alice memiliki 2,972 GELOMBANG pada keseimbangannya. </p><br><p>  DApp ini melacak berapa banyak masing-masing peserta berkontribusi pada dana bersama melalui mekanisme <strong>transaksi data - DataEntry (currentKey, newAmount)</strong> , di mana currentKey adalah akun yang memanggil fungsi setoran, dan newAmount adalah nilai saldo yang diisi ulang. </p><br><p>  Boob dan Cooper melakukan setoran mereka di akun dApp masing-masing dengan 1 GELOMBANG. </p><br><p><img src="https://habrastorage.org/webt/ea/q9/of/eaq9ofimf-wsb4v90ky7zmfjpvu.png"></p><br><p>  Kami membuat kesalahan dan transaksi tidak lulus.  Karena kami, terlepas dari kenyataan bahwa kami yakin bahwa kami melakukan transaksi atas nama Bob, membuat kesalahan dalam indeks dan menunjukkan rekening Bank yang tidak memiliki kontrak pintar.  Di sini perlu diperhatikan poin penting - untuk usaha yang gagal untuk memulai transaksi, komisi <strong>tidak ditarik!</strong>  Alice memiliki 2,972 GELOMBANG pada keseimbangannya.  Bob 3 memiliki GELOMBANG. </p><br><p>  Bob mengirim 1 GELOMBANG ke Akun dApp. </p><br><pre> <code class="scala hljs">broadcast(invokeScript({dappAddress: address(env.accounts[<span class="hljs-number"><span class="hljs-number">1</span></span>]), call:{function:<span class="hljs-string"><span class="hljs-string">"deposit"</span></span>,args:[]}, payment: [{amount: <span class="hljs-number"><span class="hljs-number">100000000</span></span>, asset:<span class="hljs-literal"><span class="hljs-literal">null</span></span> }]}))</code> </pre> <br><p><img src="https://habrastorage.org/webt/na/nb/qy/nanbqy-fdxalvfweuhqfy9xnfge.png"></p><br><p>  Bob memiliki 1,99 GELOMBANG tersisa.  Artinya, Bob membayar komisi 0,01 WAVES </p><br><p><img src="https://habrastorage.org/webt/qb/bx/jn/qbbxjnpicgjaklsyfytsex7ji6u.png"></p><br><p>  Alice memiliki 2,972 GELOMBANG di neraca, menjadi 3,972.  Sebuah transaksi juga terdaftar di akun Alice, namun, tidak ada komisi yang dikurangkan dari Akun dApp (Alice). <br>  Setelah Cooper juga mengisi kembali akun Alice, 4,972 GELOMBANG menjadi di neraca. </p><br><p><img src="https://habrastorage.org/webt/it/fq/91/itfq91qi30frhgk00thymtmzzys.png"></p><br><p>  Anda dapat mengetahui berapa banyak GELOMBANG di dompet umum milik dalam blok explorer di tab Data. </p><br><p>  Cooper berubah pikiran tentang meninggalkan jumlah 1 GELOMBANG di dompet umum dan memutuskan untuk menarik setengah dari afinitas.  Untuk melakukan ini, ia harus memanggil fungsi penarikan. </p><br><p><img src="https://habrastorage.org/webt/hl/qx/df/hlqxdfug5ulr-z4hid9b2fvsmj0.png"></p><br><p>  Namun, kami kembali salah, karena fungsi penarikan memiliki parameter yang sama sekali berbeda, tanda tangan yang berbeda.  Saat merancang kontrak cerdas pada RIDE4DAPPS, Anda harus memperhatikan momen ini. </p><br><p><img src="https://habrastorage.org/webt/a3/p7/jj/a3p7jjgxl3do4hwd_wrgtahjizs.png"></p><br><p>  Cooper memiliki 2,48 GELOMBANG di neraca.  Dengan demikian, 3 GELOMBANG - 1 - 0,01, dan kemudian + 0,5 - 0,01.  Dengan demikian, setiap panggilan untuk menyetor dan menarik biaya 0,01 GELOMBANG.  Akibatnya, entri dalam tabel kepemilikan dApps telah berubah sebagai berikut. </p><br><p><img src="https://habrastorage.org/webt/dw/lm/sx/dwlmsx3wg_jheu1nj9urontq_wc.png"></p><br><p>  Bob juga memutuskan untuk menarik sejumlah tertentu dari total dompet, tetapi keliru dan mencoba untuk mengekstrak 1,5 GELOMBANG. </p><br><p><img src="https://habrastorage.org/webt/ba/vo/w3/bavow3e9pvqjsyaxgzipnt_n1ly.png"></p><br><p>  Namun, kontrak pintar itu memeriksa situasi semacam itu. </p><br><p>  Xena seorang penipu, dia mencoba menarik 1 GELOMBANG dari akun umum. </p><br><p><img src="https://habrastorage.org/webt/us/kg/5w/uskg5wgcu_xubpmskq0x37lsox4.png"></p><br><p>  Dia juga gagal. </p><br><p>  Pada bagian <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">selanjutnya</a> , kami akan mempertimbangkan masalah yang lebih kompleks yang terkait dengan ketidaksempurnaan Akun Alice dApp. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id447790/">https://habr.com/ru/post/id447790/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id447746/index.html">Logika bisnis basis data dengan SchemaKeeper</a></li>
<li><a href="../id447754/index.html">Aplikasi menu bar untuk macOS</a></li>
<li><a href="../id447784/index.html">Musik di Hari Kosmonautika</a></li>
<li><a href="../id447786/index.html">Latar Belakang: Robot Fedor, apa yang Anda?</a></li>
<li><a href="../id447788/index.html">Kami membuat agregator berita dengan fokus pada cryptocurrency - intwt.com</a></li>
<li><a href="../id447792/index.html">Pola Gelap dan Hukum: Bagaimana Regulator AS Mencoba Mengontrol Mekanika Produk dan Mengurangi Pengaruh Perusahaan Teknologi</a></li>
<li><a href="../id447794/index.html">Soal hal-hal sederhana, rumit. Surat dari seorang ahli kimia ke printer 3D. Pelarut untuk plastik dan perlindungan terhadapnya</a></li>
<li><a href="../id447798/index.html">Bagaimana cara menghasilkan grafik finansial besar dengan pola pencucian uang?</a></li>
<li><a href="../id447802/index.html">Isabella 2</a></li>
<li><a href="../id447804/index.html">Dwarf Fortress meninggalkan grafik teks, tetapi bukan esensinya</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>