<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ค ๐ซ ๐จ๐ผโโ๏ธ ุฑุจุงุนู ุงูุฃุดุฌุงุฑ ูุงูุงุนุชุฑุงู ุงูุงุตุทุฏุงู ๐คพ๐ผ ๐ ๐ฟ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุงู ูุฐุง ุงูุฃุณุจูุน ูุตูุฑูุง ุ ูููู ุงูุงุซููู ูุงูุซูุงุซุงุก ูุงุตูุช ุงูุนูู ุนูู ูุธุงู ุงูุฅุถุงุกุฉ ุซูุงุฆู ุงูุฃุจุนุงุฏ . ุจููุฉ ุงูููุช ุงูุฐู ูุถูุชู ูู ุชูููุฐ ุฃุดุฌุงุฑ quadtree. 

 ูู ูุฐู ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุฑุจุงุนู ุงูุฃุดุฌุงุฑ ูุงูุงุนุชุฑุงู ุงูุงุตุทุฏุงู</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/473066/" style=";text-align:right;direction:rtl"><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/59e/237/20a/59e23720a19b3109d80e62c6d2d539a0.gif" alt="ุตูุฑุฉ"></div><br>  ูุงู ูุฐุง ุงูุฃุณุจูุน ูุตูุฑูุง ุ ูููู ุงูุงุซููู ูุงูุซูุงุซุงุก ูุงุตูุช ุงูุนูู ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุธุงู ุงูุฅุถุงุกุฉ ุซูุงุฆู ุงูุฃุจุนุงุฏ</a> .  ุจููุฉ ุงูููุช ุงูุฐู ูุถูุชู ูู ุชูููุฐ ุฃุดุฌุงุฑ quadtree. <br><br>  ูู ูุฐู ุงูููุงูุฉ ุณูู ุฃุดุงุฑู ุชุทุจููู ูุฃููุงุฑู ุงูุชู ูุดุฃุช ุฃุซูุงุก ุนูููุฉ ุชุตููููุง. <br><br>  ุฃููุงู ุ ูุฌุจ ุฃู ุฃููู ููุงุฐุง ูุฑุฑุช ุชูููุฐ ุดุฌุฑุฉ ุฑุจุงุนูุฉ. <br><br>  Quadtree ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจููุฉ ุจูุงูุงุช ูุณู ุงููุถุงุก</a> .  ููุฒุชูุง ุงูุฑุฆูุณูุฉ ุนูู ููุงูู ุงูุจูุงูุงุช ุงูุฃุฎุฑู ูู ูุฏุฑุชูุง ุนูู ุงูุชููู.  ูููุฑ ุฃุฏุงุกู ุฌูุฏูุง ุนูุฏ ุงูุฅุฏุฑุงุฌ ูุงูุญุฐู ูุงูุจุญุซ.  ููุฐุง ูุนูู ุฃูู ูููููุง ุงุณุชุฎุฏุงู ูุฐู ุงูุดุฌุฑุฉ ูู ุณูุงู ุฏููุงูููู ุญูุซ ุชุชุบูุฑ ุงูุจูุงูุงุช ุบุงูุจูุง.  ุนูุงูุฉ ุนูู ุฐูู ุ ูุฐุง ุงููููู ุณูู ุงูููู ูุงูุชูููุฐ. <br><br>  ุฅุฐุง ูุงู ุชูุณูู ุงููุถุงุก ููุถูุนูุง ุฌุฏูุฏูุง ูู ุ ูุฃูุง ุฃูุตู ุจูุฑุงุกุฉ ูุฐู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุงูุฉ ุจูุงุณุทุฉ</a> ุฑูุจุฑุช ููุณุชุฑูู.  ุฅุฐุง ููุช ุชุฑูุฏ ูุนุฑูุฉ ุงููุฒูุฏ ุญูู ุฃุดุฌุงุฑ ุงูุฃุฑุจุงุน ุ ูุงูุฑุฃ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฐุง</a> ุงูููุงู ุฃู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฐุง</a> ุงูููุงู. <br><a name="habracut"></a><br>  ููุงู ููุงุทู ูู ูุนุจุชู ููููุฏ ูููุง ุงุณุชุฎุฏุงู quadtree ุนูู ุงูููุฑ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุนูุฏ ุงูุชุดุงู ุงูุงุตุทุฏุงูุงุช ุ ุชููู ุงูุดุฌุฑุฉ ุงูุฑุจุงุนูุฉ ุฃูุซุฑ ููุงุกุฉ ูู ุทุฑููุฉ ุงูููุฉ ุงูุบุงุดูุฉ (ุงุฎุชุจุงุฑ ุฌููุน ุงูุฃุฒูุงุฌ).  ูููู ูุฐุง ููุณ ูู ุงูููุฌ ุงูุฃูุซุฑ ูุนุงููุฉ ุ ููููู ุฏุฑุงุณุฉ ููุญุฉ ุนุงูุฉ ุนู ูุฎุชูู ุงูุชูููุงุช ูุงููุนุงููุฑ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฐู ุงูููุงูุฉ</a> .  ููุน ุฐูู ุ ุจุงููุณุจุฉ ููุฅุตุฏุงุฑ ุงูุฃูู ูู ูุญุฑู ุงูููุฒูุงุก ุงูุฎุงุต ุจู ุ ุฃุณุชุฎุฏูู.  ุฑุจูุง ูู ููุช ูุงุญู ุ ุฅุฐุง ูุฒู ุงูุฃูุฑ ุ ุณุฃุฎุชุงุฑ ุฎูุงุฑุฒููุฉ ุฃูุซุฑ ุชุฎุตุตูุง. </li><li style=";text-align:right;direction:rtl">  ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฑุณู ุงูุจูุงูู ูููุดูุฏ ุ</a> ุนูุฏ ุชูููุฐ ููุทุฉ ุ ูููููู ุงุณุชุฎุฏุงู quadtree ููุจุญุซ ุนู ุฌููุน ุงูุนูุฏ ุงููุฑุฆูุฉ. </li><li style=";text-align:right;direction:rtl">  ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุธุงู ุงูุฅุถุงุกุฉ ุ</a> ููููู ุงุณุชุฎุฏุงู ุงููุฑุจุน ุงูุฑุจุงุนู ูุฅูุฌุงุฏ ุฌุฏุฑุงู ุชุชูุงุทุน ูุน ูุถูุน ุฑุคูุฉ ูุตุฏุฑ ุงูุถูุก. </li><li style=";text-align:right;direction:rtl">  ูู ูุธุงู ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุ ููููู ุงุณุชุฎุฏุงู quadtree ููุจุญุซ ุนู ูู ุงููุงุฆูุงุช ุฃู ุงูุฃุนุฏุงุก ุงููุฑูุจูู ูู ุงูุฌููุฑ. </li><li style=";text-align:right;direction:rtl">  ูููู ุฌุฑุง ... </li></ul><br>  ููุง ุชุฑูู ุ ุฃุดุฌุงุฑ ุฑุจุงุนู ุชููุนุง ุฌุฏุง.  ุณูููู ุชุฌุฏูุฏ ุฌูุฏ ูู ูุฌููุนุฉ ุงูุฃุฏูุงุช ุงูุฎุงุตุฉ ุจู. <br><br>  ูููู ุงูุนุซูุฑ ุนูู ุฌููุน <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุฏุงุช</a> ุงูููุถุญุฉ ูู ุงูููุงู ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฌูุซุจ</a> . <br><br><h1 style=";text-align:right;direction:rtl">  ุงูุชุญุถูุฑ ุงูุฃููู </h1><br>  ูุจู ุชูุตูู ููุฏ quadtree ุ ูุญุชุงุฌ ุฅูู ูุตูู ุตุบูุฑุฉ <code>Vector2</code> ุงูููุฏุณูุฉ: ูุฆุฉ <code>Vector2</code> ูุชุญุฏูุฏ ุงูููุงุท ููุฆุฉ <code>Box</code> ูุชุญุฏูุฏ ุงููุณุชุทููุงุช.  ุนูู ุญุฏ ุณูุงุก ุณูููู boilerplate. <br><br><h2 style=";text-align:right;direction:rtl">  Vector2 </h2><br>  ูุฆุฉ <a href=""><code>Vector2</code></a> ุฃุถูู ุงูุญุฏูุฏ.  ุฃูู ูุญุชูู ุนูู ุตุงูุนู ููุท ุ ููุฐูู <code>+</code> ู <code>/</code> ุงููุดุบููู.  ูุฐุง ูู ูุง ูุญุชุงุฌู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Vector2</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: T x; T y; <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> Vector2&lt;T&gt;(TX = <span class="hljs-number"><span class="hljs-number">0</span></span>, TY = <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">noexcept</span></span> : x(X), y(Y) { } <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> Vector2&lt;T&gt;&amp; <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>+=(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Vector2&lt;T&gt;&amp; other) <span class="hljs-keyword"><span class="hljs-keyword">noexcept</span></span> { x += other.x; y += other.y; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> *<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> Vector2&lt;T&gt;&amp; <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>/=(T t) <span class="hljs-keyword"><span class="hljs-keyword">noexcept</span></span> { x /= t; y /= t; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> *<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } }; <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T&gt; <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> Vector2&lt;T&gt; <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>+(Vector2&lt;T&gt; lhs, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Vector2&lt;T&gt;&amp; rhs) <span class="hljs-keyword"><span class="hljs-keyword">noexcept</span></span> { lhs += rhs; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lhs; } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T&gt; <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> Vector2&lt;T&gt; <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>/(Vector2&lt;T&gt; vec, T t) <span class="hljs-keyword"><span class="hljs-keyword">noexcept</span></span> { vec /= t; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vec; }</code> </pre> <br><h2 style=";text-align:right;direction:rtl">  ุตูุฏูู </h2><br>  ูุฆุฉ <a href=""><code>Box</code></a> ููุณุช ุฃูุซุฑ ุชุนููุฏูุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Box</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: T left; T top; T width; <span class="hljs-comment"><span class="hljs-comment">// Must be positive T height; // Must be positive constexpr Box(T Left = 0, T Top = 0, T Width = 0, T Height = 0) noexcept : left(Left), top(Top), width(Width), height(Height) { } constexpr Box(const Vector2&lt;T&gt;&amp; position, const Vector2&lt;T&gt;&amp; size) noexcept : left(position.x), top(position.y), width(size.x), height(size.y) { } constexpr T getRight() const noexcept { return left + width; } constexpr T getBottom() const noexcept { return top + height; } constexpr Vector2&lt;T&gt; getTopLeft() const noexcept { return Vector2&lt;T&gt;(left, top); } constexpr Vector2&lt;T&gt; getCenter() const noexcept { return Vector2&lt;T&gt;(left + width / 2, top + height / 2); } constexpr Vector2&lt;T&gt; getSize() const noexcept { return Vector2&lt;T&gt;(width, height); } constexpr bool contains(const Box&lt;T&gt;&amp; box) const noexcept { return left &lt;= box.left &amp;&amp; box.getRight() &lt;= getRight() &amp;&amp; top &lt;= box.top &amp;&amp; box.getBottom() &lt;= getBottom(); } constexpr bool intersects(const Box&lt;T&gt;&amp; box) const noexcept { return !(left &gt;= box.getRight() || getRight() &lt;= box.left || top &gt;= box.getBottom() || getBottom() &lt;= box.top); } };</span></span></code> </pre> <br>  ุฃูู ูุญุชูู ุนูู ุจุนุถ ุงููุฏุงูุง ูููุฏุฉ. <br><br>  ูุง ูู ุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู ูู ุฃูู ูุญุชูู ุนูู ุทุฑููุฉ ุชุญุชูู ุนูู ุ ูุงูุชู ุชุชุญูู ููุง ุฅุฐุง ูุงู ุงููุณุชุทูู ุฏุงุฎู ุขุฎุฑ ุ ูุทุฑููุฉ <code>intersects</code> ุ ูุงูุฐู ูุชุญูู ูุง ุฅุฐุง ูุงู ุงููุณุชุทูู ูุชูุงุทุน ูุน ุขุฎุฑ. <br><br>  ุณูู ูุณุชุฎุฏู <code>contains</code> ุนูุฏ ุงูุฅุฏุฑุงุฌ ูุงูุญุฐู ุ <code>intersects</code> ุนูุฏ ุงูุชุนุฑู ุนูู ุงูุชูุงุทุนุงุช. <br><br><h1 style=";text-align:right;direction:rtl">  Quadtree </h1><br>  ููุง ูู <a href=""><code>Quadtree</code></a> ูุฆุฉ <a href=""><code>Quadtree</code></a> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T, <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> GetBox, <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Equal = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::equal_to&lt;T&gt;, <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Float = <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>&gt; class Quadtree { <span class="hljs-keyword"><span class="hljs-keyword">static_assert</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::is_convertible_v&lt;<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">invoke_result_t</span></span>&lt;GetBox, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> T&amp;&gt;, Box&lt;Float&gt;&gt;, <span class="hljs-string"><span class="hljs-string">"GetBox must be a callable of signature Box&lt;Float&gt;(const T&amp;)"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">static_assert</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::is_convertible_v&lt;<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">invoke_result_t</span></span>&lt;Equal, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> T&amp;, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> T&amp;&gt;, <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>&gt;, <span class="hljs-string"><span class="hljs-string">"Equal must be a callable of signature bool(const T&amp;, const T&amp;)"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">static_assert</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::is_arithmetic_v&lt;Float&gt;); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: Quadtree(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Box&lt;Float&gt;&amp; box, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> GetBox&amp; getBox = GetBox(), <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Equal&amp; equal = Equal()) : mBox(box), mRoot(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::make_unique&lt;Node&gt;()), mGetBox(getBox), mEqual(equal) { } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> Threshold = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span>(<span class="hljs-number"><span class="hljs-number">16</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> MaxDepth = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span>(<span class="hljs-number"><span class="hljs-number">8</span></span>); <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Node</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">array</span></span>&lt;<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">unique_ptr</span></span>&lt;Node&gt;, <span class="hljs-number"><span class="hljs-number">4</span></span>&gt; children; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;T&gt; values; }; Box&lt;Float&gt; mBox; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">unique_ptr</span></span>&lt;Node&gt; mRoot; GetBox mGetBox; Equal mEqual; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isLeaf</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Node* node)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> !<span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>&gt;(node-&gt;children[<span class="hljs-number"><span class="hljs-number">0</span></span>]); } };</code> </pre> <br>  ููุง ุชุฑูู ุ <code>Quadtree</code> ูู ูุฆุฉ ุงููุงูุจ.  ูุฐุง ุณูุณูุญ ููุง ุจุงุณุชุฎุฏุงู ุงููุตู ูุฃุบุฑุงุถ ูุชุนุฏุฏุฉ ุ ูุงูุชู ุชุญุฏุซุช ุนููุง ูู ุงูุจุฏุงูุฉ. <br><br>  ุฎูุงุฑุงุช ุงููุงูุจ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>T</code> : ููุน ุงูููู ุงูุชู ุณูุชู ุชุถููููุง ูู quadtree.  ูุฌุจ ุฃู ุชููู ูุฆุฉ <code>T</code> ุณููุฉ ุ ูุฃูู ุณูุชู ุชุฎุฒูููุง ุฏุงุฎู ุฑุจุงุนู.  ูู ุงููุงุญูุฉ ุงููุซุงููุฉ ุ ูุฌุจ ุฃู ูููู ูุฐุง ูุคุดุฑ ุฃู ุจููุฉ ุจูุงูุงุช ุจุณูุทุฉ ุตุบูุฑุฉ (POD). </li><li style=";text-align:right;direction:rtl">  <code>GetBox</code> : ููุน ุงููุงุฆู ุงูุฐู ุชู ุงุณุชุฏุนุงุคู ูุงูุฐู ุณูุชููู ุงููููุฉ ุนูุฏ ุงูุฅุฏุฎุงู ูุฅุฑุฌุงุน ูุณุชุทูู. </li><li style=";text-align:right;direction:rtl">  <code>Equal</code> : ููุน ุงููุงุฆู ุงูุฐู ุชู ุงุณุชุฏุนุงุคู ููุชุญูู ููุง ุฅุฐุง ูุงูุช ุงููููุชุงู ูุชุณุงููุชุงู.  ุจุดูู ุงูุชุฑุงุถู ุ ูุณุชุฎุฏู ุนุงูู ุงููุณุงูุงุฉ ุงูููุงุณู. </li><li style=";text-align:right;direction:rtl">  <code>Float</code> : ุงูููุน ุงูุญุณุงุจู ุงููุณุชุฎุฏู ูู ุงูุนูููุงุช ุงูุญุณุงุจูุฉ.  ุงูุชุฑุงุถูุง ุ ูุณุชุฎุฏู <code>float</code> . </li></ul><br>  ูู ุจุฏุงูุฉ ุชุนุฑูู ุงููุฆุฉ ุ ููุงู ุซูุงุซุฉ ุชุฃููุฏุงุช ุซุงุจุชุฉ ููุชุญูู ูู ุตุญุฉ ูุนููุงุช ุงููุงูุจ. <br><br>  ุฏุนูุง ูููู ูุธุฑุฉ ุนูู ุชุนุฑูู ุงูุนูุฏุฉ.  ุชููู ุงูุนูุฏุฉ ุจุจุณุงุทุฉ ุจุชุฎุฒูู ุงููุคุดุฑุงุช ุฅูู ุงูุนูุฏ ุงููุฑุนูุฉ ุงูุฃุฑุจุนุฉ ุงูุฎุงุตุฉ ุจูุง ููุงุฆูุฉ ูู ุงูููู ุงูููุฌูุฏุฉ ูููุง.  ูุญู ูุง ูุฎุฒู ููู ุงูุตูุฏูู ุงููุญูุท ุฃู ุงูุนูู ุ ุณูุชู ุญุณุงุจูุง ุนูู ุงูุทุงูุฑ. <br><br>  ููุฏ ุฃุฌุฑูุช ููุงุฑูุงุช ูููุง ุงูููุฌูู (ุงูุญูุงุธ ุนูู ูุณุชุทูู ุจุนูู ูุจุฏูู ุงูุญูุงุธ) ููู ุฃุฌุฏ ุฃู ุชุฏููุฑ ูู ุงูุฃุฏุงุก ุนูุฏ ุญุณุงุจููุง ุฃุซูุงุก ุงูุทูุฑุงู.  ุนูุงูุฉ ุนูู ุฐูู ุ ูุฅูู ูููุฑ ุงููููู ูู ุงูุฐุงูุฑุฉ. <br><br>  ูุชุชููู ูู ุชูููุฒ ุนูุฏุฉ ุฏุงุฎููุฉ ุนู ูุฑูุฉ ุ <code>isLeaf</code> ุทุฑููุฉ <code>isLeaf</code> .  ุฅูู ูุชุญูู ููุท ูู ุฃู ุงูุทูู ุงูุฃูู ููุณ ุฎุงูููุง.  ูุธุฑูุง ูุฃู null ูู ูู ุงูุนูุฏ ุงููุฑุนูุฉ ุฃู ูุง ุชูุฌุฏ ุฃู ูููุง ุ ููุฐุง ูููู ููุชุญูู ูู ุงูุฃููู ููุท. <br><br>  ุงูุขู ูููููุง ุฃู ููุธุฑ ุฅูู <code>Quadtree</code> ุนุถู <code>Quadtree</code> : <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>mBox</code> ูู ูุฑุจุน <code>mBox</code> ุนุงููู.  ูุฌุจ ุฃู ุชููู ุฌููุน ุงูููู ุงููุฏุฑุฌุฉ ูู quadtree ุถูููุง. </li><li style=";text-align:right;direction:rtl">  <code>mRoot</code> ูู ุฃุตู quadtree. </li><li style=";text-align:right;direction:rtl">  <code>mGetBox</code> ูู ูุงุฆู ูุณูู ุ ูุงูุฐู <code>mGetBox</code> ููุญุตูู ุนูู ุงููุณุชุทูู ูู ุงููููุฉ. </li><li style=";text-align:right;direction:rtl">  <code>mEqual</code> ูู ุงููุงุฆู ุงูุฐู ูุณูู ุ ูุงูุฐู <code>mEqual</code> ููุชุญูู ูู ุงููุณุงูุงุฉ ุจูู ุงููููุชูู. </li></ul><br>  ูููู ุงูููุดุฆ ุจุจุณุงุทุฉ ุจุชุนููู <code>mBox</code> ู <code>mGetBox</code> ู <code>mEqual</code> ุ ููุง ููุดุฆ ุนูุฏุฉ ุฌุฐุฑ. <br><br>  <code>MaxDepth</code> ูู ูุชุญุฏุซ <code>MaxDepth</code> ุจุนุฏ ููุง <code>Threshold</code> ู <code>MaxDepth</code> .  <code>Threshold</code> ูู ุงูุญุฏ ุงูุฃูุตู ูุนุฏุฏ ุงูููู ุงูุชู ูููู ุฃู ุชุญุชูููุง ุงูุนูุฏุฉ ูุจู ุชูุณูููุง.  <code>MaxDepth</code> ูู ุฃูุตู ุนูู ููุนูุฏุฉ ุ ูุชููู ุนู ูุญุงููุฉ ุชูุณูู ุงูุนูุฏ ุงูููุฌูุฏุฉ ุนูู <code>MaxDepth</code> ุ ูุฃูู ุฅุฐุง ูุณูุช ุฃูุซุฑ ูู ุงููุงุฒู ุ ููุฏ ูุนูู ุฐูู ุงูุฃุฏุงุก.  ุฃุนุทูุช ูุฐู ุงูุซูุงุจุช ููู ูุนูููุฉ ููุงุณุจุฉ ููุนุธู ุงูุญุงูุงุช.  ููููู ูุญุงููุฉ ุชุญุณูููุง ูู ุฃุฌู ุงูุชูููู ุงูุฎุงุต ุจู. <br><br>  ูุญู ุงูุขู ุนูู ุงุณุชุนุฏุงุฏ ูุจุฏุก ุนูููุงุช ุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู. <br><br><h1 style=";text-align:right;direction:rtl">  ุฅุฏุฑุงุฌ ูุญุฐู </h1><br>  ูุจู ุฃู ุฃุนุฑุถ ุฑูุฒ ุงูุฅุฏุฑุงุฌ ุ ูุญุชุงุฌ ุฅูู ููุงูุดุฉ ุงูุนูุฏ ุงูุชู ุณุชุญุชูู ุนูู ุงูููู.  ููุงู ุงุณุชุฑุงุชูุฌูุชุงู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุชู ุชุฎุฒูู ุงูููู ููุท ูู ุงูุฃูุฑุงู.  ูุธุฑูุง ูุฃู ุงููุฑุจุน ุงููุญูุท ุจูููุฉ ูููู ุฃู ูุชูุงุนู ูุน ุฃูุฑุงู ูุชุนุฏุฏุฉ ุ ุณูุชู ุชุฎุฒูู ุงููููุฉ ูู ูู ูุฐู ุงูุฃูุฑุงู. </li><li style=";text-align:right;direction:rtl">  ูููู ุชุฎุฒูู ุงูููู ูู ุฌููุน ุงูุนูุฏ.  ูููู ุจุชุฎุฒูู ุงููููุฉ ูู ุฃุตุบุฑ ุนูุฏุฉ ุชุญุชูู ุจุงููุงูู ุนูู ุงููุฑุจุน ุงููุญูุท ุจูุง. </li></ul><br>  ุฅุฐุง ูุงูุช ุงููุณุชุทููุงุช ุงููุญูุทูุฉ ุตุบูุฑุฉ ุงูุญุฌู ูุจููุณ ุงูุญุฌู ุชูุฑูุจูุง ุ ูุฅู ุงูุฅุณุชุฑุงุชูุฌูุฉ ุงูุฃููู ุชููู ุฃูุซุฑ ูุนุงููุฉ ุนูุฏ ุงูุจุญุซ ุนู ุงูุชูุงุทุนุงุช.  ููุน ุฐูู ุ ูู ุญุงูุฉ ูุฌูุฏ ูุณุชุทููุงุช ูุจูุฑุฉ ุ ูุฏ ุชุญุฏุซ ุญุงูุงุช ูุชุฏููุฑุฉ ูููู ุงูุฃุฏุงุก ูููุง ุณูุฆูุง ููุบุงูุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ูููุง ุจุฅุฏุฑุงุฌ ูููุฉ ูููู ูุณุชุทูููุง ูู ุงููุฑุจุน ุงููุญูุท ุงูุนุงู ุ ูุณูุชู ุฅุถุงูุชูุง ุฅูู ุฌููุน ุงูุฃูุฑุงู.  ูุฅุฐุง ูููุง ุจุฅุฏุฑุงุฌ ุญุฏ ููุฐู ุงูููู ุ ูุณูุชู ุชูุณูู ูู ุงูุนูุฏ ุญุชู <code>MaxDepth</code> ุงููุตูู ุฅูู <code>MaxDepth</code> ููู ุชููู ุงูููู ูู ุฌููุน ุงูุฃูุฑุงู.  ูุฐูู ุ ุณูู quadtree ุชุญุชูู <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mi>t</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi><mi>h</mi><mi>r</mi><mi>e</mi><mi>s</mi><mi>h</mi><mi>o</mi><mi>l</mi><mi>d</mi></mrow><mtext>&amp;#xA0;</mtext><mi>t</mi><mi>i</mi><mi>m</mi><mi>e</mi><mi>s</mi><msup><mn>4</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mi>t</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>M</mi><mi>a</mi><mi>x</mi><mi>D</mi><mi>e</mi><mi>p</mi><mi>t</mi><mi>h</mi></mrow></mrow></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="37.45ex" height="2.539ex" viewBox="0 -987.6 16124.4 1093.4" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-74" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-65" x="611" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-78" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-74" x="1650" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-74" x="2012" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-74" x="2373" y="0"></use><g transform="translate(2735,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-54" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-68" x="704" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-72" x="1281" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-65" x="1732" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-73" x="2199" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-68" x="2668" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-6F" x="3245" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-6C" x="3730" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-64" x="4029" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-74" x="7537" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-69" x="7899" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-6D" x="8244" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-65" x="9123" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-73" x="9589" y="0"></use><g transform="translate(10059,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMAIN-34" x="0" y="0"></use><g transform="translate(500,404)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-74" x="353" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-65" x="715" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-78" x="1181" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-74" x="1754" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-74" x="2115" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-74" x="2477" y="0"></use><g transform="translate(2007,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-61" x="1051" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-78" x="1581" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-44" x="2153" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-65" x="2982" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-70" x="3448" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-74" x="3952" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/post/473066/&amp;usg=ALkJrhhOGf0u28jyyFEFm8mOlAcIcUHQQA#MJMATHI-68" x="4313" y="0"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mi>t</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mi>h</mi><mi>r</mi><mi>e</mi><mi>s</mi><mi>h</mi><mi>o</mi><mi>l</mi><mi>d</mi></mrow><mtext>&nbsp;</mtext><mi>t</mi><mi>i</mi><mi>m</mi><mi>e</mi><mi>s</mi><msup><mn>4</mn><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mi>t</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>M</mi><mi>a</mi><mi>x</mi><mi>D</mi><mi>e</mi><mi>p</mi><mi>t</mi><mi>h</mi></mrow></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-1"> \ texttt {Threshold} \ times 4 ^ {\ texttt {MaxDepth}} </script>  ุงููุนุงูู ุ ููุฐุง ... ุงููุซูุฑ. <br><br>  ุนูุงูุฉ ุนูู ุฐูู ุ ูุน ุงูุงุณุชุฑุงุชูุฌูุฉ ุงูุฃููู ุ ุณูููู ุงูุฅุฏุฎุงู ูุงูุญุฐู ุฃุจุทุฃ ููููุงู ุ ูุฃูู ูุชุนูู ุนูููุง ุฅุฏุฑุงุฌ (ุฃู ุญุฐู) ุฌููุน ุงูุนูุฏ ุงูุชู ุชุชูุงุทุน ูุน ุงููููุฉ. <br><br>  ูุฐูู ุ ุณุฃุณุชุฎุฏู ุงูุฅุณุชุฑุงุชูุฌูุฉ ุงูุซุงููุฉ ุ ุงูุชู ูุง ุชูุฌุฏ ูููุง ุญุงูุงุช ุชููุณ.  ูุฃููู ุฃุฎุทุท ูุงุณุชุฎุฏุงู quadtree ูู ุณูุงูุงุช ูุฎุชููุฉ ุ ุณูููู ุฃูุซุฑ ููุงุกูุฉ.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุชุนุชุจุฑ ูุฐู ุงูุงุณุชุฑุงุชูุฌูุฉ ุฃูุซุฑ ููุงุกูุฉ ููุณูุงูุงุช ุงูุฏููุงููููุฉ ุงูุชู ูุชู ูููุง ุฅุฌุฑุงุก ุงููุซูุฑ ูู ุนูููุงุช ุงูุฅุฏุฑุงุฌ ูุงูุญุฐู ูุชุญุฏูุซ ุงูููู ุ ุนูู ุณุจูู ุงููุซุงู ุ ูู ูุญุฑู ูุนูู ูุชู ููู ุงูููุงูุงุช ููู. <br><br>  ููุนุฑูุฉ ุงูุนูุฏุฉ ุงูุชู ุณูููู ุจุฅุฏุฑุงุฌูุง ุฃู ุญุฐููุง ุ ุณูุณุชุฎุฏู ูุธููุชูู ูุณุงุนุฏุชูู. <br><br>  ุงูุฃูู ุ <code>computeBox</code> ุ ูุญุณุจ ูุณุชุทูู ุงูุนูุฏุฉ ุงูุชุงุจุนุฉ ุจูุงุณุทุฉ ูุณุชุทูู ุงูุนูุฏุฉ ุงูุฃุตู ูููุฑุณ ุงูุฑุจุน ุงูุฎุงุต ุจู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">Box&lt;Float&gt; computeBox(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Box&lt;Float&gt;&amp; box, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> origin = box.getTopLeft(); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> childSize = box.getSize() / <span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;Float&gt;(<span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (i) { <span class="hljs-comment"><span class="hljs-comment">// North West case 0: return Box&lt;Float&gt;(origin, childSize); // Norst East case 1: return Box&lt;Float&gt;(Vector2&lt;Float&gt;(origin.x + childSize.x, origin.y), childSize); // South West case 2: return Box&lt;Float&gt;(Vector2&lt;Float&gt;(origin.x, origin.y + childSize.y), childSize); // South East case 3: return Box&lt;Float&gt;(origin + childSize, childSize); default: assert(false &amp;&amp; "Invalid child index"); return Box&lt;Float&gt;(); } }</span></span></code> </pre> <br>  ุงูุซุงูู ุ <code>getQuadrant</code> ุ ุจุฅุฑุฌุงุน ุงูุฑุจุน ุงูุฐู ุชูุฌุฏ ููู ุงููููุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getQuadrant</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Box&lt;Float&gt;&amp; nodeBox, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Box&lt;Float&gt;&amp; valueBox)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> center = nodeBox.getCenter(); <span class="hljs-comment"><span class="hljs-comment">// West if (valueBox.getRight() &lt; center.x) { // North West if (valueBox.getBottom() &lt; center.y) return 0; // South West else if (valueBox.top &gt;= center.y) return 2; // Not contained in any quadrant else return -1; } // East else if (valueBox.left &gt;= center.x) { // North East if (valueBox.getBottom() &lt; center.y) return 1; // South East else if (valueBox.top &gt;= center.y) return 3; // Not contained in any quadrant else return -1; } // Not contained in any quadrant else return -1; }</span></span></code> </pre> <br>  ุชููู ุจุฅุฑุฌุงุน <code>-1</code> ุฅุฐุง ูู ููู ููุฌูุฏูุง ูู ุฃู ูู ุงูุฃุฑุจุงุน. <br><br>  ูุญู ุงูุขู ุนูู ุงุณุชุนุฏุงุฏ ูููุธุฑ ูู ุฃุณุงููุจ ุงูุฅุฏุฑุงุฌ ูุงูุญุฐู. <br><br><h2 style=";text-align:right;direction:rtl">  ุฅุฏุฑุงุฌ </h2><br>  ุงุณุชุฏุนุงุก ุงูุฃุณููุจ ุจุจุณุงุทุฉ ุงุณุชุฏุนุงุก ุฃุณููุจ ูุณุงุนุฏ ุฎุงุต: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> T&amp; value)</span></span></span><span class="hljs-function"> </span></span>{ add(mRoot.get(), <span class="hljs-number"><span class="hljs-number">0</span></span>, mBox, value); }</code> </pre> <br>  ููุง ูู ุฑูุฒ ุทุฑููุฉ ุงููุณุงุนุฏ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Node* node, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> depth, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Box&lt;Float&gt;&amp; box, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> T&amp; value)</span></span></span><span class="hljs-function"> </span></span>{ assert(node != <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>); assert(box.contains(mGetBox(value))); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isLeaf(node)) { <span class="hljs-comment"><span class="hljs-comment">// Insert the value in this node if possible if (depth &gt;= MaxDepth || node-&gt;values.size() &lt; Threshold) node-&gt;values.push_back(value); // Otherwise, we split and we try again else { split(node, box); add(node, depth, box, value); } } else { auto i = getQuadrant(box, mGetBox(value)); // Add the value in a child if the value is entirely contained in it if (i != -1) add(node-&gt;children[static_cast&lt;std::size_t&gt;(i)].get(), depth + 1, computeBox(box, i), value); // Otherwise, we add the value in the current node else node-&gt;values.push_back(value); } }</span></span></code> </pre> <br>  ูู ุงูุจุฏุงูุฉ ุ ููุฌุฏ ุงูุชุฑุงุถุงู ูุชุญููุงู ูู ุฃููุง ูุง ูููู ุจุฃู ุดูุก ุบูุฑ ููุทูู ุ ุนูู ุณุจูู ุงููุซุงู ุ ูุญู ูุง ูุฏุฑุฌ ูููุฉ ูู ุนูุฏุฉ ูุง ุชุญุชูู ุนูู ุงููุฑุจุน ุงููุญูุท ุจูุง. <br><br>  ุซู ุ ุฅุฐุง ูุงูุช ุงูุนูุฏุฉ ุนุจุงุฑุฉ ุนู ูุฑูุฉ ุ ููููููุง ุฅุฏุฑุงุฌ ูููุฉ ุฌุฏูุฏุฉ ูููุง ุ ุฃู  ูู <code>MaxDepth</code> ุฅูู <code>MaxDepth</code> ุฃู <code>Threshold</code> ุ ูู ุจุฅุฌุฑุงุก ุงูุฅุฏุฑุงุฌ.  ูุฅูุง ุ ูุฅููุง ูุดุงุฑู ูุฐู ุงูุนูุฏุฉ ููุนูุฏ ุงููุญุงููุฉ. <br><br>  ุฅุฐุง ูุงูุช ุงูุนูุฏุฉ ุฏุงุฎููุฉ ุ ูุฅููุง ูุญุณุจ ุงูุฑุจุน ุงูุฐู ูุญุชูู ุนูู ุงููุฑุจุน ุงููุญูุท ูููููุฉ.  ุฅุฐุง ูุงูุช ูุถููุฉ ุชูุงููุง ูู ุงูุนูุฏุฉ ุงููุฑุนูุฉ ุ ููุญู ูุฌุฑู ููุงููุฉ ูุชูุฑุฑุฉ.  ุฎูุงู ุฐูู ุ ุชุถุงู ูู ูุฐู ุงูุนูุฏุฉ. <br><br>  ููุง ูู ุฅุฌุฑุงุก ุงููุตู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">split</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Node* node, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Box&lt;Float&gt;&amp; box)</span></span></span><span class="hljs-function"> </span></span>{ assert(node != <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>); assert(isLeaf(node) &amp;&amp; <span class="hljs-string"><span class="hljs-string">"Only leaves can be split"</span></span>); <span class="hljs-comment"><span class="hljs-comment">// Create children for (auto&amp; child : node-&gt;children) child = std::make_unique&lt;Node&gt;(); // Assign values to children auto newValues = std::vector&lt;T&gt;(); // New values for this node for (const auto&amp; value : node-&gt;values) { auto i = getQuadrant(box, mGetBox(value)); if (i != -1) node-&gt;children[static_cast&lt;std::size_t&gt;(i)]-&gt;values.push_back(value); else newValues.push_back(value); } node-&gt;values = std::move(newValues); }</span></span></code> </pre> <br>  ููุดุฆ ุฃุฑุจุน ุนูุฏ ุชุงุจุนุฉ ุ ููู ุซู ููู ูููุฉ ููุนูุฏุฉ ุงูุฃุตู ุ ููุฑุฑ ูู ุฃู ุนูุฏุฉ (ุชุงุจุนุฉ ุฃู ุฃุตู) ูุฌุจ ุชุฎุฒูู ุงููููุฉ. <br><br><h2 style=";text-align:right;direction:rtl">  ุฅุฒุงูุฉ </h2><br>  ุชููู ุทุฑููุฉ <code>remove</code> ุฃูุถูุง ุจุงุณุชุฏุนุงุก ุทุฑููุฉ ุงููุณุงุนุฏ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">remove</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> T&amp; value)</span></span></span><span class="hljs-function"> </span></span>{ remove(mRoot.get(), <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>, mBox, value); }</code> </pre> <br>  ูููุง ููู ุฑูุฒ ุทุฑููุฉ ุงููุณุงุนุฏ ุ ููู ูุดุงุจู ุฌุฏูุง ูููุฏ ุงูุฅุฏุฑุงุฌ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">remove</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Node* node, Node* parent, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Box&lt;Float&gt;&amp; box, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> T&amp; value)</span></span></span><span class="hljs-function"> </span></span>{ assert(node != <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>); assert(box.contains(mGetBox(value))); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isLeaf(node)) { <span class="hljs-comment"><span class="hljs-comment">// Remove the value from node removeValue(node, value); // Try to merge the parent if (parent != nullptr) tryMerge(parent); } else { // Remove the value in a child if the value is entirely contained in it auto i = getQuadrant(box, mGetBox(value)); if (i != -1) remove(node-&gt;children[static_cast&lt;std::size_t&gt;(i)].get(), node, computeBox(box, i), value); // Otherwise, we remove the value from the current node else removeValue(node, value); } }</span></span></code> </pre> <br>  ุฅุฐุง ูุงูุช ุงูุนูุฏุฉ ุงูุญุงููุฉ ุนุจุงุฑุฉ ุนู ูุฑูุฉ ุ ูุณูููู ุจุฅุฒุงูุฉ ุงููููุฉ ูู ูุงุฆูุฉ ููู ุงูุนูุฏุฉ ุงูุญุงููุฉ <br>  ูุญุงูู ุฏูุฌ ูุฐู ุงูุนูุฏุฉ ูุน ุงูุนูุฏ ุงูุดูููุฉ ูุงููุงูุฏ.  ุฎูุงู ุฐูู ุ ูุฅููุง ูุญุฏุฏ ูู ุฃู ูุฑุจุน ุฑุจุงุนู ููุน ุงููุฑุจุน ุงููุญูุท ูููููุฉ.  ุฅุฐุง ูุงูุช ูุถููุฉ ุชูุงููุง ูู ุงูุนูุฏุฉ ุงููุฑุนูุฉ ุ ูุณูููู ุจุฅุฌุฑุงุก ููุงููุฉ ูุชูุฑุฑุฉ.  ุฎูุงู ุฐูู ุ ุงุญุฐู ูู ููู ุงูุนูุฏุฉ ุงูุญุงููุฉ. <br><br>  ูุธุฑูุง ูุฃููุง ูุง ููุชู ุจุชุฑุชูุจ ุงูููู ุงููุฎุฒูุฉ ูู ุงูุนูุฏุฉ ุ ุนูุฏูุง ุฃููู ุจูุณุญูุง ุ ุฃุณุชุฎุฏู ุชุญุณูููุง ุจุณูุทูุง: ููุฏ ููุช ููุท ุจุชุบููุฑ ุงููููุฉ ุงูุชู ุชู ูุญููุง ุจุงุณุชุฎุฏุงู ุงููููุฉ ุงูุฃุฎูุฑุฉ ูุญุฐููุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">removeValue</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Node* node, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> T&amp; value)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// Find the value in node-&gt;values auto it = std::find_if(std::begin(node-&gt;values), std::end(node-&gt;values), [this, &amp;value](const auto&amp; rhs){ return mEqual(value, rhs); }); assert(it != std::end(node-&gt;values) &amp;&amp; "Trying to remove a value that is not present in the node"); // Swap with the last element and pop back *it = std::move(node-&gt;values.back()); node-&gt;values.pop_back(); }</span></span></code> </pre> <br>  ูุญุชุงุฌ ุฃูุถูุง ุฅูู ุฅููุงุก ูุธุฑุฉ ุนูู <code>tryMerge</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tryMerge</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Node* node)</span></span></span><span class="hljs-function"> </span></span>{ assert(node != <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>); assert(!isLeaf(node) &amp;&amp; <span class="hljs-string"><span class="hljs-string">"Only interior nodes can be merged"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> nbValues = node-&gt;values.size(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span>&amp; child : node-&gt;children) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!isLeaf(child.get())) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; nbValues += child-&gt;values.size(); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (nbValues &lt;= Threshold) { node-&gt;values.reserve(nbValues); <span class="hljs-comment"><span class="hljs-comment">// Merge the values of all the children for (const auto&amp; child : node-&gt;children) { for (const auto&amp; value : child-&gt;values) node-&gt;values.push_back(value); } // Remove the children for (auto&amp; child : node-&gt;children) child.reset(); } }</span></span></code> </pre> <br>  ูุชุญูู <code>tryMerge</code> ุฃู ุฌููุน ุงูุนูุฏ ุงููุฑุนูุฉ ูู ุฃูุฑุงู ูุฃู ุงูุนุฏุฏ ุงูุฅุฌูุงูู ูููููุง ูููู ุงูุนูุฏ ุงููุฑุนูุฉ ุฃูู ูู ุงูุนุชุจุฉ.  ุฅุฐุง ูุงู ุงูุฃูุฑ ูุฐูู ุ ููุญู ููุณุฎ ุฌููุน ุงูููู ูู ุงูุนูุฏ ุงููุฑุนูุฉ ุฅูู ุงูุนูุฏุฉ ุงูุญุงููุฉ ููุญุฐู ุงูุนูุฏ ุงููุฑุนูุฉ. <br><br><h1 style=";text-align:right;direction:rtl">  ุจุญุซ ุชูุงุทุน </h1><br><h2 style=";text-align:right;direction:rtl">  ุชูุงุทุน ูุน ุงููุณุชุทูู </h2><br>  ูุฃุฎูุฑุง ุ ูุตููุง ุฅูู ุงูุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู: ููุจุญุซ ุนู ุงูุชูุงุทุนุงุช.  ุฃูู ุทุฑููุฉ ูุงุณุชุฎุฏุงููุง ูู ุงูุญุตูู ุนูู ุฌููุน ุงูููู ุงูุชู ุชุชูุงุทุน ูุน ูุณุชุทูู ูุนูู.  ุนูู ุณุจูู ุงููุซุงู ุ ูุฐุง ูุทููุจ ูุฃุฏุงุก ููุทุฉ. <br><br>  ูุณูุชู <code>query</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;T&gt; query(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Box&lt;Float&gt;&amp; box) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> values = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;T&gt;(); query(mRoot.get(), mBox, box, values); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> values; }</code> </pre> <br>  ูู ูุฐู ุงูุทุฑููุฉ ุ ูุฎุชุงุฑ ุจุจุณุงุทุฉ <code>std::vector</code> ุ ูุงูุชู ุณุชุญุชูู ุนูู ุงูููู ุงูุชู ุชุชูุงุทุน ูุน ุงููุฑุจุน ุงููุญูุท ุ ููุณุชุฏุนู ุทุฑููุฉ ุงููุณุงุนุฏ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">query</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Node* node, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Box&lt;Float&gt;&amp; box, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Box&lt;Float&gt;&amp; queryBox, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">vector</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;T&gt;&amp; values)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ assert(node != <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>); assert(queryBox.intersects(box)); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span>&amp; value : node-&gt;values) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (queryBox.intersects(mGetBox(value))) values.push_back(value); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!isLeaf(node)) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> i = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>); i &lt; node-&gt;children.size(); ++i) { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> childBox = computeBox(box, <span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;(i)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (queryBox.intersects(childBox)) query(node-&gt;children[i].get(), childBox, queryBox, values); } } }</code> </pre> <br>  ุฃููุงู ุ ูุถูู ุฌููุน ุงูููู ุงููุฎุฒูุฉ ูู ุงูุนูุฏุฉ ุงูุญุงููุฉ ุงูุชู ุชุชูุงุทุน ูุน ุงููุณุชุทูู ุงููุทููุจ.  ุซู ุ ุฅุฐุง ูุงูุช ุงูุนูุฏุฉ ุงูุญุงููุฉ ุฏุงุฎููุฉ ุ ูุฅููุง ูููู ุจุฅุฌุฑุงุก ููุงููุฉ ูุชูุฑุฑุฉ ููู ุนูุฏุฉ ุชุงุจุนุฉ ูุชูุงุทุน ูุณุชุทูููุง ุงููุญูุท ูุน ุงููุณุชุทูู ุงููุทููุจ. <br><br><h2 style=";text-align:right;direction:rtl">  ุฌููุน ุงูุชูุงุทุนุงุช ุงูุฒูุฌูุฉ </h2><br>  ุญุงูุฉ ุงูุงุณุชุฎุฏุงู ุงููุฏุนููุฉ ุงูุซุงููุฉ ูู ุงูุจุญุซ ุนู ุฌููุน ุฃุฒูุงุฌ ุงูููู ุงููุฎุฒูุฉ ูู ุดุฌุฑุฉ ุงูุฑุจุน ุงูุชู ุชุชูุงุทุน.  ูุฐุง ูููุฏ ุจุดูู ุฎุงุต ุนูุฏ ุฅูุดุงุก ูุญุฑู ูุงุฏู.  ูููู ุญู ูุฐู ุงููุดููุฉ ุจุงุณุชุฎุฏุงู ุทุฑููุฉ <code>query</code> .  ููู ุงููุงูุน ุ ูููููุง ุงุณุชุฏุนุงุก <code>query</code> ูู ุงููุฑุจุน ุงููุญูุท ูุฌููุน ุงูููู.  ููุน ุฐูู ุ ูููู ุงูููุงู ุจุฐูู ุจุดูู ุฃูุซุฑ ููุงุกุฉ ุนู ุทุฑูู ุฅุถุงูุฉ ุชูุงุทุน ูุงุญุฏ ููุท ููุฒูุฌ (ูุน <code>query</code> ุณูุฌุฏูู ูุฑุชูู). <br><br>  ูุชุญููู ูุฐุง ุ ูุญู ุจุญุงุฌุฉ ุฅูู ุงููุธุฑ ูู ุฃู ุงูุชูุงุทุน ูููู ุฃู ูุญุฏุซ ููุท <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุจูู ูููุชูู ุงููุฎุฒูุฉ ูู ุนูุฏุฉ ูุงุญุฏุฉ </li></ul><br>  ุฃู <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุจูู ุงููููุฉ ุงููุฎุฒูุฉ ูู ุงูุนูุฏุฉ ููููุฉ ุฃุฎุฑู ูุฎุฒูุฉ ูู ุณููู ูุฐู ุงูุนูุฏุฉ. </li></ul><br>  ูุชูุฌุฉ ููุฐุง ุ ูุญุชุงุฌ ุฅูู ุงูุชุญูู ูู ุงูุชูุงุทุน ุจูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงููููุฉ ูุงูููู ุงูุชุงููุฉ ุงููุฎุฒูุฉ ูู ููุณ ุงูุนูุฏุฉ </li></ul><br>  ู <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงููููุฉ ูุงูููู ุงููุฎุฒูุฉ ูู ุงูุณููู. </li></ul><br>  ูุจุงูุชุงูู ุ ูุฅููุง ุจุงูุชุฃููุฏ ูู ูุจูุบ ุนู ููุณ ุงูุชูุงุทุน ูุฑุชูู. <br><br>  ูููุง ููู ุฑูุฒ <code>findAllIntersections</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::pair&lt;T, T&gt;&gt; findAllIntersections() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> intersections = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::pair&lt;T, T&gt;&gt;(); findAllIntersections(mRoot.get(), intersections); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> intersections; }</code> </pre> <br>  ูุฑุฉ ุฃุฎุฑู ุ ูุญู ุจุจุณุงุทุฉ ูุฎุตุต <code>std::vector</code> ูุชุฎุฒูู ุงูุชูุงุทุนุงุช ูุงุณุชุฏุนุงุก ูุธููุฉ ุงููุณุงุนุฏ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">findAllIntersections</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Node* node, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">vector</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::pair&lt;T, T&gt;&gt;&amp; intersections)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// Find intersections between values stored in this node // Make sure to not report the same intersection twice for (auto i = std::size_t(0); i &lt; node-&gt;values.size(); ++i) { for (auto j = std::size_t(0); j &lt; i; ++j) { if (mGetBox(node-&gt;values[i]).intersects(mGetBox(node-&gt;values[j]))) intersections.emplace_back(node-&gt;values[i], node-&gt;values[j]); } } if (!isLeaf(node)) { // Values in this node can intersect values in descendants for (const auto&amp; child : node-&gt;children) { for (const auto&amp; value : node-&gt;values) findIntersectionsInDescendants(child.get(), value, intersections); } // Find intersections in children for (const auto&amp; child : node-&gt;children) findAllIntersections(child.get(), intersections); } }</span></span></code> </pre> <br>  ูู ุงููุฑุญูุฉ ุงูุฃููู ุ ูุชู ูุญุต ุงูุชูุงุทุนุงุช ุจูู ุงูููู ุงููุฎุฒูุฉ ูู ุงูุนูุฏุฉ ุงูุญุงููุฉ.  ุซู ุ ุฅุฐุง ูุงูุช ุงูุนูุฏุฉ ุงูุญุงููุฉ ุฏุงุฎููุฉ ุ ูุฅู <code>findIntersectionInDescendants</code> ุนู ุงูุชูุงุทุนุงุช ุจูู ุงูููู ุงููุฎุฒูุฉ ูู ูุฐู ุงูุนูุฏุฉ ูุงูููู ุงููุฎุฒูุฉ ูู ุฃุญูุงุฏูุง.  ุฃุฎูุฑูุง ุ ูุฌุฑู ููุงููุงุช ูุชูุฑุฑุฉ. <br><br>  <code>findIntersectionsInDescendants</code> ุจุดูู ูุชูุฑุฑ <code>findIntersectionsInDescendants</code> ุงูุชูุงุทุนุงุช ุจูู ุงููููุฉ ุงููุนุทุงุฉ ูุฌููุน ุงูููู ุงููุฎุฒูุฉ ูู ุงูุดุฌุฑุฉ ุงููุฑุนูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">findIntersectionsInDescendants</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Node* node, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> T&amp; value, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">vector</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::pair&lt;T, T&gt;&gt;&amp; intersections)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// Test against the values stored in this node for (const auto&amp; other : node-&gt;values) { if (mGetBox(value).intersects(mGetBox(other))) intersections.emplace_back(value, other); } // Test against values stored into descendants of this node if (!isLeaf(node)) { for (const auto&amp; child : node-&gt;children) findIntersectionsInDescendants(child.get(), value, intersections); } }</span></span></code> </pre> <br>  ูุฐุง ูู ุดุฆ!  ุฃูุฑุฑ ุ ูุชู ูุดุฑ ุฌููุน ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฌูุซุจ</a> . <br><br><h1 style=";text-align:right;direction:rtl">  ููุงุฑุฏ ูููุฏุฉ </h1><br>  ุฅุฐุง ููุช ุชุฑุบุจ ูู ูุนุฑูุฉ ุงููุฒูุฏ ุญูู ุงูุชุนุฑู ุนูู ุงูุชุตุงุฏู ูุชูุณูู ููุงูู ุงูุจูุงูุงุช ุ ูุฅููู ุฃูุตู ุจูุฑุงุกุฉ ุงููุชุงุจ ุจูุงุณุทุฉ Christer Erickson <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Real-Time Collision Detection</a> .  ูุชู ุงููุดู ุนู ุงูุนุฏูุฏ ูู ุงูููุงุถูุน ุจุนูู ููู ููุณ ุงูููุช ูุชู ูุชุงุจุฉ ุงููุชุงุจ ุจูุบุฉ ูููููุฉ ููุบุงูุฉ.  ุนูุงูุฉ ุนูู ุฐูู ุ ูููู ูุฑุงุกุฉ ุงููุตูู ุจุดูู ูููุตู.  ูุฐุง ูู ูุตุฏุฑ ูุฑุฌุนู ูุจูุฑ. <br><br><h1 style=";text-align:right;direction:rtl">  ุงุณุชูุชุงุฌ </h1><br>  ูุฐุง ูููู ุงูุนูู ูุน ุงูุชุนุฑู ุนูู ุงูุงุตุทุฏุงู.  ููุน ุฐูู ุ ูู ููุท ูุตู ุงููุญุฑู ุงููุงุฏู.  ุงููุตู ุงูุซุงูู ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฑุงุฑ ุงูุงุตุทุฏุงู</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar473066/">https://habr.com/ru/post/ar473066/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar473056/index.html">ููู ูุชุนุฑู ุฃููุณ ุงูุจูุฏุงู ูู ุงูุตูุฑ. ุจุญุซ ูุงูุฏูุณ</a></li>
<li><a href="../ar473058/index.html">ุณูุฑุฌู ุณููุชุณูู: "OSM ุฃูุซุฑ ูู ูุฌุฑุฏ ุฑุณู ุงูููุงุฒู ุฃู ุงููุณุงุฑุงุช. ูุฐู ูู ุงููุฒูุฏ ูู ุงููุตุต! "</a></li>
<li><a href="../ar473060/index.html">ุงูุนูุงูุงุช ุบูุฑ ุงูุฑุณููุฉ ูู ุงููุฑูู: ููุงุฐุง ูููู ุชุฏูุฑูุง</a></li>
<li><a href="../ar473062/index.html">user.js ุฐุงุชู ูู Mozilla Firefox ูููุณ ููุท</a></li>
<li><a href="../ar473064/index.html">ุฏููุน ุจุงุชุงููุง ูุงูุณูุงุฑุงุช ูุฒุฌุงุฌ ุงูุบูุฑููุง: ุญูู ุจุนุถ ุฃููุงุน ุงูุฒุฌุงุฌ ุงููููู</a></li>
<li><a href="../ar473070/index.html">ุงุณุชุฑุฌุงุน - ููุณุช ููุงู ุญุงุฌุฉ! ุงุณุชุจุฏุงู useContext ู useReducer ูู ุฑุฏ ุงููุนูุ</a></li>
<li><a href="../ar473072/index.html">ููู ุชููู Gazpromneft ุจุฅูุดุงุก ูุณุงุฑ ุฑููู ูุนููู ูุดุชุฑู</a></li>
<li><a href="../ar473074/index.html">ูุง ุงูููุตูุฏ ุจู APS ูููุงุฐุง "ูุง ุชุฌุนู ุฎุทุฉ ุงูุฅูุชุงุฌ ุจุงูุทุฑููุฉ ุงูุชู ูุฑูุฏูุง ..."</a></li>
<li><a href="../ar473078/index.html">ุจุณูููุฉ ุฅุฏุงุฑุฉ ุชููููุงุช microservice ูุน microconfig.io</a></li>
<li><a href="../ar473082/index.html">ููู ููุชุจ ุฎุฏูุงุช micros ูููุงุฐุง ูุง ููุนู ุฐูู ุจุณุฑุนุฉ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>