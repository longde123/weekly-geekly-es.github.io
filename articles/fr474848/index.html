<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§≤üèª ‚òëÔ∏è üìï Tetris comme imprimeur üè∫ ‚õìÔ∏è üéÖüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En tournant, en r√©organisant et en abaissant une s√©quence de formes pr√©d√©termin√©e, Tetris Printer Algorithm utilise la m√©canique de Tetris pour g√©n√©re...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tetris comme imprimeur</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/474848/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/sa/az/2c/saaz2chpnuatbjn-rdg3zcryjwo.png"></div><br>  En tournant, en r√©organisant et en abaissant une s√©quence de formes pr√©d√©termin√©e, Tetris Printer Algorithm utilise la m√©canique de Tetris pour g√©n√©rer des bitmaps arbitraires. <br><br><h2>  Description de l'algorithme </h2><br>  L'algorithme convertit les pixels de l'image source en carr√©s du champ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Tetris</a> ligne par ligne, se d√©pla√ßant de bas en haut.  Pour g√©n√©rer un seul carr√©, l'algorithme assemble une structure compos√©e d'une zone rectangulaire qui est compl√®tement support√©e par un carr√© en dessous.  Une fois l'assemblage de la r√©gion rectangulaire termin√©, ses lignes sont effac√©es, laissant un carr√© en dessous.  Voici trois exemples de ce comportement. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/895/c80/be8/895c80be864793bcd951c4edb6943f19.gif"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3c6/cdf/615/3c6cdf6159a7bbb9dd2dc95e87374055.gif"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/104/674/951/104674951b666a97f36c4d069006df5d.gif"></div><br>  Comme indiqu√© ci-dessous, l'algorithme peut √©galement g√©n√©rer plusieurs carr√©s avec une seule structure. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/caa/aef/04b/caaaef04b763c02d872079282d3b57d5.gif"></div><br>  Dans le processus de construction d'une ligne, tous les carr√©s ainsi cr√©√©s doivent √™tre bas√©s sur quelque chose.  Dans les images ci-dessus, les carr√©s g√©n√©r√©s sont sur le sol du terrain de jeu.  Cependant, si une ligne arbitraire contient des trous, elle ne pourra pas fournir le support n√©cessaire pour construire une ligne au-dessus d'elle.  L'algorithme r√©sout ce probl√®me en cr√©ant une plate-forme plate au-dessus de la cha√Æne avec des trous.  Dans l'animation ci-dessous, une plate-forme construite au sommet d'une ligne se compose d'un carr√© rouge.  Une plate-forme est une structure temporaire et l'insertion de la derni√®re forme la supprime. <br><a name="habracut"></a><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/acf/f14/c6d/acff14c6d078f15cc01523e4c24389cb.gif"></div><br>  La rang√©e de 5 carr√©s rouges illustr√©e ci-dessous est au-dessus de la rang√©e de 3 carr√©s rouges.  Ceci est r√©alis√© en construisant une plate-forme plate en haut de la ligne du bas.  La plateforme fournit le support n√©cessaire pour g√©n√©rer 5 carr√©s rouges.  √Ä la fin, la plate-forme est supprim√©e en ins√©rant la derni√®re forme et la nouvelle ligne se met en place.  Notez que si l'algorithme doit g√©n√©rer des lignes dans l'ordre inverse (une ligne de 3 carr√©s rouges au-dessus d'une ligne de 5 carr√©s rouges), la plate-forme ne sera pas n√©cessaire. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/851/0ad/35c/8510ad35cdbf5639b06b5f17957eec79.gif"></div><br><h2>  Un motif carr√© </h2><br>  Pour r√©f√©rence, je donnerai les noms de 7 tetramino (pi√®ces de jeu). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cef/817/4aa/cef8174aa74b378cb17af2fe0c6f1c7b.png"></div><br>  La version de Tetris Printer Algorithm pr√©sent√©e dans l'article est sp√©cialement con√ßue pour le rendu des sprites d'anciens jeux vid√©o.  Ces jeux contiennent des graphiques en 8 √ó 8 tuiles, et 2 octets ont √©t√© allou√©s pour chaque pixel.  Par cons√©quent, les sprites ne contenaient g√©n√©ralement que 3 couleurs plus des zones transparentes et avaient le plus souvent une taille de 16 √ó 16 ou 16 √ó 32 pixels. <br><br>  L'animation ci-dessous montre tous les motifs utilis√©s pour cr√©er des carr√©s individuels.  Chaque motif utilise un t√©tramino interchangeable J, T et L, cr√©ant un seul carr√© en bas.  L'algorithme attribue ce t√©tramino √† l'une des 3 couleurs pr√©sentes dans le sprite.  Le reste du t√©tramino se voit attribuer des couleurs arbitraires.  Tout au long du gameplay, toutes les couleurs restent constantes. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dfa/b1f/efc/dfab1fefc65efed365513213cdf5ad12.gif"></div><br>  En raison de la forme des trois t√©traminos, il est impossible de cr√©er un carr√© √† partir des trois couleurs dans les deux premi√®res et les deux derni√®res colonnes.  Par cons√©quent, la largeur minimale du terrain de jeu pour le rendu d'un sprite d'une largeur de 16 pixels est de 2 + 16 + 2 = 20 carr√©s.  Cependant, il s'est av√©r√© que 20 est trop peu. <br><br>  Comme indiqu√© ci-dessous, la zone au-dessus du carr√© inf√©rieur unique ne peut pas √™tre constitu√©e d'une seule ligne, car les seules figures qui peuvent y entrer (tetramino I) n'ont aucun support. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/87f/1e5/645/87f1e56455f90295b076e72296cc58c1.gif"></div><br>  Avec deux lignes, la seule fa√ßon d'√©tirer tout le terrain de jeu pour qu'il soit pris en charge est d'utiliser le tetramino S et Z. Mais dans ce cas, les trous resteront dans la ligne sup√©rieure. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/58c/ea6/8ef/58cea68ef0e7d83c102402e9ed0255fb.gif"></div><br>  Le nombre minimum de lignes requises au-dessus du carr√© inf√©rieur est de 3, et comme indiqu√© plusieurs fois ci-dessus, de tels mod√®les existent.  20 carr√©s est la largeur minimale requise pour placer un sprite d'une largeur de 16 pixels.  Mais 20 √ó 3 + 1 = 61, et ce nombre n'est pas divisible par 4, ce qui signifie qu'il ne peut pas √™tre construit √† partir de t√©tramino.  Cependant, une largeur de 21 nous donne 21 √ó 3 + 1 = 64, et il peut √™tre construit √† partir de 16 tetramino.  En fait, cette largeur permet √† l'algorithme de rendre les sprites jusqu'√† 17 pixels de large. <br><br>  Le terrain de jeu du Tetris original a une taille de 10 √ó 20 carr√©s (rapport 1: 2).  Dans cette version de l'algorithme, ce rapport est pr√©serv√© - le terrain de jeu a une taille de 21 √ó 42 carr√©s. <br><br>  √âtant donn√© que le t√©tramino J, T et L sont interchangeables lors de la cr√©ation d'un carr√©, et que 3 carr√©s de ces t√©tramino sont impliqu√©s dans la cr√©ation d'une ligne au-dessus, il existe 21 - 3 = 18 motifs pour cr√©er un seul carr√©.  Cependant, en raison de la sym√©trie miroir, il n'y a en fait que 9. Il y a 3 lignes qui fonctionnent pour la plupart de ces 9. Cependant, une √©tude informatique approfondie a montr√© que les deux mod√®les avaient besoin de plus.  La prochaine option possible est de 7 lignes, car 21 √ó 7 + 1 = 148, ce qui n√©cessite 37 t√©traminos.  Comme le montrent les images ci-dessous, de tels mod√®les existent. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9ee/0b4/889/9ee0b488962c79ad6c84255efd033b5d.gif"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7a2/643/2ca/7a26432ca3f6e11d43f134057f3bfa73.gif"></div><br><h2>  Motifs carr√©s multiples </h2><br>  Les motifs de cr√©ation de plusieurs carr√©s sont limit√©s aux trois m√™mes couleurs cr√©√©es par les motifs d'un seul carr√©.  Les carr√©s r√©sultants sont cr√©√©s √† partir de tetramino J, T et L, chacun occupant 3 carr√©s sur une ligne au-dessus de la ligne de cr√©ation.  Le nombre maximum de carr√©s pouvant potentiellement √™tre cr√©√©s avec un seul motif est 21/3 = 7. Cependant, pour les sprites d'une largeur de 16 pixels, le t√©tramino le plus √† droite ne peut pas cr√©er un carr√©.  M√™me dans le cas de sprites d'une largeur de 17 pixels, il peut cr√©er un carr√© d'une seule couleur.  Par cons√©quent, le mod√®le de cr√©ation √† partir de 7 carr√©s est rarement utilis√©. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e01/9cc/957/e019cc9577348937886f2f160fd8ad1b.gif"></div><br>  Le nombre de mod√®les pour cr√©er un nombre arbitraire de carr√©s peut √™tre d√©termin√© en utilisant la combinatoire des √©num√©rations.  Consid√©rez le mod√®le ci-dessous, repr√©sentant une rang√©e au-dessus d'une rang√©e de trois carr√©s.  Chaque bloc de trois carr√©s blancs adjacents d√©signe une partie de tetramino;  les carr√©s cr√©√©s ne sont pas affich√©s. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cef/b6d/fe5/cefb6dfe5d0c9c3b644189dc13901e63.gif"></div><br>  Trois t√©tramino cr√©ent 4 vides.  Il y a 21 - 3 √ó 3 = 12 carr√©s sombres qui peuvent √™tre ins√©r√©s arbitrairement dans ces vides pour former un motif sp√©cifique.  Le nombre de fa√ßons de distribuer ces carr√©s sombres peut √™tre calcul√© en les pla√ßant sur une ligne dans laquelle les carr√©s blancs simples sont trait√©s comme des s√©parateurs. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/373/160/0fb/3731600fb90642ff32fa58ee059cf4c3.gif"></div><br>  La t√¢che a donc √©t√© r√©duite au calcul de la valeur du coefficient du polyn√¥me.  En regardant ces carr√©s blancs, vous pouvez comprendre qu'il s'agit du nombre de fa√ßons de choisir 3 sur 15. <img src="https://habrastorage.org/getpro/habr/post_images/5d4/344/bdb/5d4344bdb66112361fa655447baff0a3.png">  = 455. <br><br>  Dans le cas g√©n√©ral, pour <i>n</i> il est √©gal √† <img src="https://habrastorage.org/getpro/habr/post_images/f0d/252/47d/f0d25247d7defed1af6417ed76660ba6.png">  .  Mais en raison de la sym√©trie miroir, en fait, ils sont deux fois moins;  si la quantit√© est impaire, puis en divisant par deux, nous arrondissons √† l'entier le plus proche pour inclure le mod√®le id√©alement sym√©trique qui devrait exister dans cet ensemble, comme, par exemple, illustr√© ci-dessous pour le cas avec 455. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5e6/093/98d/5e609398dfe585680459774fc3b96cdc.gif"></div><br>  En appliquant cette formule √† 7 tetramino, nous confirmons l'√©vidence: il n'y a qu'un seul motif pour cr√©er 7 carr√©s. <br><br>  Le mod√®le de cr√©ation de 6 carr√©s peut √™tre construit de deux mani√®res: deux lignes pleines (2 √ó 21 + 6 = 48) et six lignes remplies (6 √ó 21 + 6 = 132), ce qui n√©cessite 12 et 33 tetramino.  La formule ci-dessus montre qu'il existe 84 mod√®les pour cr√©er 6 carr√©s, mais seulement 35 d'entre eux peuvent √™tre construits √† partir de 2 lignes compl√®tes.  49 mod√®les n√©cessitent 6 lignes.  Les nombres sont impairs en raison des motifs sym√©triques illustr√©s ci-dessous. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c07/fe9/a24/c07fe9a243e3cdfe37103d4f16d01024.gif"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8a9/8c5/91b/8a98c591b95b4fc8a533e67adead58ad.gif"></div><br>  Il convient √©galement de noter que 2 lignes sont possibles ici, car contrairement au mod√®le de cr√©ation d'un carr√© qui n√©cessitait le t√©tramino S et Z, 6 chiffres sont utilis√©s dans ces mod√®les. <br><br>  Le tableau ci-dessous indique le nombre de carr√©s cr√©√©s par chaque type de motif, le nombre de lignes compl√®tes, le nombre de t√©tramino utilis√© et le nombre de motifs. <br><br><div class="scrollable-table"><table><tbody><tr><th>  Carr√©s cr√©√©s </th><th>  Lignes compl√®tes </th><th>  Tetramino </th><th>  Patterns </th></tr><tr><td>  1 </td><td>  7 et 3 </td><td>  37 et 16 </td><td>  19 (4 et 15) </td></tr><tr><td>  2 </td><td>  6 </td><td>  32 </td><td>  136 </td></tr><tr><td>  3 </td><td>  5 </td><td>  27 </td><td>  455 </td></tr><tr><td>  4 </td><td>  4 </td><td>  22 </td><td>  715 </td></tr><tr><td>  5 </td><td>  3 </td><td>  17 </td><td>  462 </td></tr><tr><td>  6 </td><td>  2 et 6 </td><td>  12 et 33 </td><td>  84 (35 et 49) </td></tr><tr><td>  7 </td><td>  1 </td><td>  7 </td><td>  1 </td></tr></tbody></table></div><br>  Exemples de mod√®les. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/569/9dc/055/5699dc0558af1a833b43b57defdefbf7.gif"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1d1/b83/682/1d1b83682d599094bcb138958706b8bf.gif"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/efd/510/bbb/efd510bbb099696e35b7e0b9156f35d4.gif"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/079/bd5/d7a/079bd5d7a149568bda463270a5b3baaf.gif"></div><br><h2>  Plateformes </h2><br>  Avant de construire une ligne, l'algorithme examine la ligne en dessous.  Si la rang√©e du bas ne peut pas prendre en charge tous les carr√©s au-dessus, alors une plate-forme temporaire est n√©cessaire.  Lorsque la plate-forme est supprim√©e, une nouvelle ligne descend, et en raison de la fa√ßon dont la gravit√© est impl√©ment√©e dans le Tetris d'origine, certains carr√©s restent suspendus dans l'air. <br><br>  L'illustration ci-dessous montre 10 mod√®les de plate-forme.  La construction de la plate-forme commence par abaisser le t√©tramino T au-dessus de l'un des carr√©s de la derni√®re ligne g√©n√©r√©e.  Les t√©traminos restants d√©pendent de ce premier T. Autrement dit, si la ligne g√©n√©r√©e pr√©c√©dente contient au moins 1 carr√©, comme le carr√© rouge dans l'image ci-dessous, nous pouvons cr√©er une plate-forme plate au-dessus pour g√©n√©rer la ligne suivante. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5b0/299/e1d/5b0299e1d7f2916a802a49ea11c4eb16.gif"></div><br>  Au milieu de la construction de la plate-forme, la ligne du bas est termin√©e et supprim√©e, laissant trois lignes au-dessus.  Le dernier t√©tramino J ou L, qui supprimera ces lignes, n'est ins√©r√© que lorsque les mod√®les de cr√©ation g√©n√®rent la ligne de sprite suivante au-dessus de la plate-forme.  Cette derni√®re figure emp√™che la cr√©ation de carr√©s dans les deux premi√®res et derni√®res lignes.  Mais, comme mentionn√© ci-dessus, en raison de la g√©om√©trie du t√©tramino J, T et L utilis√© dans ce processus, les mod√®les de cr√©ation de carr√©s sont limit√©s √† 17 colonnes internes. <br><br>  De plus, sur 19 fa√ßons possibles de construire des plates-formes au-dessus de Tetramino T, il n'y en a que 10 ci-dessus. <br><br><h2>  Matrices emball√©es </h2><br>  Comme indiqu√© ci-dessus, un sous-ensemble des 6 mod√®les de cr√©ation de carr√©s implique de ne supprimer que deux lignes.  Tous les autres mod√®les n√©cessitent 6 lignes.  Pour comprendre pourquoi c'est le cas, consid√©rez le mod√®le ci-dessous. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/370/9bf/3aa/3709bf3aa8fd860b3dbcc04014dfef8b.gif"></div><br>  Ces tetramino sont interchangeables avec tetramino J et L, et chacun d'eux ajoute 3 carr√©s adjacents √† la rang√©e commune.  Les lignes √† compl√©ter sont repr√©sent√©es par la matrice ci-dessous. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3ed/532/67a/3ed53267a1b216691289f68439470301.gif"></div><br>  Maintenant, le tout consiste √† emballer un espace vide avec du tetramino.  En partant de la gauche, la seule option est d'utiliser la s√©quence tetramino I. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/779/b54/9f5/779b549f51bef09e54217790f2110eb5.gif"></div><br>  La seule fa√ßon de remplir l'espace restant est d'utiliser J et O ou I et L. Les deux options sont pr√©sent√©es ci-dessous. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/de8/08e/33a/de808e33aa8f69d807c60b798e8ed0c1.gif"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/aec/a24/be8/aeca24be817f0cc88dc0ef3175ada63c.gif"></div><br>  Malheureusement, tetramino O et L ne sont pas pris en charge dans les matrices illustr√©es ci-dessus.  Ce motif √† 6 carr√©s n√©cessite une matrice plus grande. <br><br>  Un probl√®me similaire se pose dans deux mod√®les de cr√©ation d'un carr√©.  Consid√©rez la matrice ci-dessous: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fba/ec4/6ad/fbaec46ad778d94b5844c22d35ebc4ed.gif"></div><br>  La seule fa√ßon de remplir la ligne du bas √† droite est d'encha√Æner la s√©quence Z. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5e8/3e1/5b2/5e83e15b210424010966f17b2ee1b72c.gif"></div><br>  De m√™me, le seul moyen d'obtenir 3 cases vides en bas √† gauche est le tetramino S. <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/297/9ae/b51/2979aeb51a67c1c0a51c7e5105890744.gif"></div><br>  Dans la ligne m√©diane, il y a un carr√© vide entre S et Z et la seule fa√ßon de le remplir est d'utiliser le t√©tramino J, T ou L, comme indiqu√© dans les figures ci-dessous. <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2a0/364/433/2a036443351a7c1ec90fe0d534c38049.gif"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8f3/f88/7e8/8f3f887e84bcdbd7176b530af8757666.gif"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e3c/dc1/a0a/e3cdc1a0a243388524f4e5ffb8ac13d8.gif"></div><br>  L'insertion de l'une de ces formes divise l'espace vide.  La zone vide √† gauche contient respectivement 5, 6 et 7 vides.  Puisqu'aucune de ces valeurs n'est divisible par 4, il est impossible de continuer.  Une matrice plus grande est requise pour ce motif carr√© unique. <br><br>  Il en va de m√™me pour un autre motif de cr√©ation d'un carr√©, illustr√© dans la matrice ci-dessous. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fd3/c11/c6c/fd3c11c6ce8d7e4b60a257486caef4e2.gif"></div><br>  Apr√®s avoir utilis√© tetramino S et Z pour remplir la majeure partie de la ligne du bas, il y a un espace vide entre eux sur la ligne m√©diane. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3a6/e39/49c/3a6e3949c8f9f0849921a11ccf54596a.gif"></div><br>  Comme indiqu√© dans les images ci-dessous, l'insert de trou divise l'espace vide et la zone vide √† gauche contient 9, 10 ou 11 carr√©s, respectivement;  aucun des nombres n'est divisible par 4. <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/15d/d8b/9b2/15dd8b9b24d8054598665cbff061344e.gif"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6d6/928/f4d/6d6928f4d884b746af74059ec210b96d.gif"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0c5/269/800/0c5269800d3ebdcb62e1131c03e32db0.gif"></div><br>  Mais l'emballage de matrices n'est pas le seul moyen de g√©n√©rer un motif de carr√©s.  Par exemple, jetez un ≈ìil au cr√©ateur de 4 carr√©s ci-dessous. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4fc/22b/653/4fc22b6538117dca3baff88c595337e4.gif"></div><br>  Ce qui suit est une tentative de rendre le mod√®le comme un ensemble de t√©traminos emball√©s. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3f5/53f/bfc/3f553fbfc96ecfbbef8f7304c80a80fe.gif"></div><br>  Le dernier L est ignor√©, car un espace n'est form√© qu'apr√®s l'ach√®vement et la suppression de la troisi√®me ligne. <br><br>  Mais apr√®s une recherche approfondie, il a √©t√© d√©couvert que cette technique ne permet pas aux mod√®les √† un carr√© susmentionn√©s de fonctionner avec seulement 3 lignes.  De plus, il ne lui permet pas d'impl√©menter de nouveaux motifs de 6 carr√©s sur deux lignes.  Il n'est pas n√©cessaire de rechercher les motifs restants en dehors des matrices emball√©es, car ils utilisent d√©j√† la plus petite quantit√© possible de t√©tramino.  Et en nous limitant aux matrices emball√©es, nous trouverons tous les mod√®les n√©cessaires beaucoup plus rapidement. <br><br><h2>  Recherche de motifs </h2><br>  Pour simplifier la sortie des donn√©es, l'algorithme d'imprimante Tetris se limite √† cr√©er du t√©tramino au point central sup√©rieur du terrain de jeu, √† le tourner, √† le d√©placer horizontalement et √† l'abaisser.  Il n'a jamais √† d√©placer la figure horizontalement apr√®s avoir pass√© une certaine distance.  Cette restriction r√©duit consid√©rablement l'espace de recherche, car elle ne permet pas la formation de lacunes sous les chiffres ajout√©s √† la matrice.  √Ä titre d'exemple, regardons la matrice des 3 carr√©s suivante. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/466/4d1/250/4664d1250708c9d9daeb800eb2ac7f47.gif"></div><br>  Si nous jetons J au centre de la matrice, comme indiqu√© ci-dessus, nous obtenons alors un espace de 2 carr√©s vides, qui ne peuvent pas √™tre remplis avec les chiffres suivants.  Par cons√©quent, la recherche ne suivra pas ce chemin. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/562/934/866/56293486665cf1557d513f63fa700622.gif"></div><br>  √âtant donn√© que les espaces couverts ne sont pas autoris√©s, chaque colonne de la matrice peut √™tre consid√©r√©e comme une pile de carr√©s remplis et la hauteur de ces piles d√©crit pleinement le contenu de la matrice enti√®re.  Quel que soit le nombre de lignes, un tableau entier unidimensionnel √† 21 √©l√©ments sera suffisant pour d√©crire une matrice bidimensionnelle. <br><br>  Lorsqu'un chiffre tombe dans la matrice, les hauteurs des piles des colonnes correspondantes augmentent.  Pour acc√©l√©rer ce processus, toutes les t√©tramines sont analys√©es √† l'avance.  Il y a 19 tours t√©tramino, et la recherche consid√®re chacun d'eux comme une figure unique. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/40e/d13/9e0/40ed139e0a5612cac1f5d074a0093d96.png"></div><br>  Tetramino J dans le coin sup√©rieur gauche de l'image occupe 3 colonnes.  Lors de la descente sur la matrice, les hauteurs de 3 piles adjacentes augmentent respectivement de 1, 1 et 2 carr√©s.  Mais avant que la figure puisse √™tre abaiss√©e, le profil inf√©rieur de la figure doit correspondre au profil sup√©rieur des piles respectives.  Si ce J √©tait allong√© sur le sol du terrain de jeu, sous chacune de ces colonnes, il aurait d√ª y avoir des espaces de 1, 1 et 0 cases vides.  √âtant donn√© que les d√©gagements sont interdits, les hauteurs relatives de 3 piles devront correspondre parfaitement au mod√®le. <br><br>  Une autre cons√©quence de l'absence de lacunes est que lorsque les chiffres tombent dans la matrice, les rang√©es sont remplies de bas en haut.  Il n'est pas possible de remplir une ligne au milieu d'une matrice avant ou sans compl√©ter toutes les lignes en dessous.  Dans le processus de remplissage de la matrice, sa limite inf√©rieure remonte en fait.  Par cons√©quent, une pile de colonnes de matrice peut fournir un support uniquement si sa hauteur moins le nombre de lignes termin√©es est sup√©rieure √† 0. Lorsqu'une forme est ajout√©e √† la matrice, au moins une des colonnes correspondantes doit fournir un support. <br><br>  La recherche stocke un deuxi√®me tableau unidimensionnel contenant le nombre de carr√©s remplis dans chaque ligne.  Le J ci-dessus contient dans les lignes correspondantes 3 et 1 un carr√©.  Lorsque vous l'ins√©rez dans la matrice, ces valeurs sont ajout√©es aux √©l√©ments correspondants du tableau.  Le nombre de lignes compl√©t√©es est le nombre d'√©l√©ments avec une valeur de 21. <br><br>  Comme indiqu√© dans la section pr√©c√©dente, si la figure ajout√©e divise la matrice, les tailles des zones r√©sultantes doivent √™tre divis√©es par 4. Par exemple, dans l'image ci-dessous, l'ajout de I cr√©e 2 zones, chacune contenant 46 carr√©s vides.  Puisque 46 n'est pas divisible par 4, il n'y a plus de moyen de remplir le reste de la matrice. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c0d/c1e/91a/c0dc1e91a707d5b2fea279dd5c370ec4.gif"></div><br>  La s√©paration appara√Æt lorsque la hauteur de la pile est √©gale √† la hauteur de la matrice.  Apr√®s avoir ins√©r√© la figure en incr√©mentant les hauteurs des piles respectives, les dimensions de toutes les zones divis√©es d'espace vide peuvent √™tre d√©termin√©es en scannant le tableau de hauteurs et en ajoutant l'espace restant dans chaque pile.  Ce nombre est v√©rifi√© et r√©initialis√© lorsqu'un fractionnement est d√©tect√©. <br><br>  La recherche utilis√©e pour g√©n√©rer tous les mod√®les utilise une construction incr√©mentale randomis√©e, un algorithme de retour en arri√®re qui v√©rifie syst√©matiquement toutes les combinaisons dans un ordre al√©atoire.  La construction incr√©mentale d'une solution en ins√©rant des formes au hasard la fait grandir comme un cristal.  L'al√©atoire fournit une irr√©gularit√© contenant des faces bris√©es qui servent de base aux formes ajout√©es par la suite.  La plupart de la matrice est emball√©e au hasard tr√®s rapidement, et lorsque l'espace vide devient rare, le retour en arri√®re entre en jeu. <br><br>  Avant d'effectuer la recherche, des permutations al√©atoires de 371 fa√ßons d'ajouter un chiffre √† la matrice sont effectu√©es.  Le pseudo-code de la fonction de recherche est indiqu√© ci-dessous. <br><br><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Result </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">search</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Matrix matrix, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> remaining)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (remaining == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> SOLUTION } attempts := attempts + <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (attempts &gt;= MAX_ATTEMPTS) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> TIMEOUT } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (     S  Z) {        S  Z <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (  ) { Result result := search(matrix, remaining - <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result == SOLUTION) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> SOLUTION }       <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result == TIMEOUT) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> TIMEOUT } } }          <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(   ,    ) {      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (   ) { Result result := search(matrix, remaining - <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result == SOLUTION) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> SOLUTION }       <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result == TIMEOUT) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> TIMEOUT } } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> NO_SOLUTION }</code> </pre> <br>  La matrice d'origine pass√©e √† la fonction de recherche est vide, √† l'exception de la ligne du bas contenant des blocs de 3 carr√©s adjacents.  Il est transmis avec le nombre de chiffres restants √† ajouter.  S'il <code>remaining</code> 0, la matrice contient la solution et la fonction retourne.  Chaque appel r√©cursif incr√©mente le nombre global de <code>attempts</code> .  S'il d√©passe <code>MAX_ATTEMPTS</code> , qui a une valeur de 1 000, la recherche recommence. <br><br>  La troisi√®me <code>if</code> essaie d'ajouter le t√©tramino S ou Z au bas de la matrice si l'espace le permet.  Cela signifie √©viter des situations comme celle illustr√©e ci-dessous, lorsque l'algorithme passe du temps √† remplir une partie de la matrice, ne pouvant pas remplir le reste par manque de support. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/36d/3f9/b81/36d3f9b81275718dccb5d40e70d7843b.gif"></div><br>  Gr√¢ce √† l' <code>if</code> elle forme rapidement une plateforme sur laquelle construire: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1d0/aa1/ed7/1d0aa1ed7c08ed07b3f31e22ab92ea42.gif"></div><br>  Pour tenter d'ajouter un chiffre √† la matrice, les v√©rifications ci-dessus sont requises.  L'algorithme v√©rifie si la figure aura un support, √©tant donn√© les lignes compl√©t√©es.  Il v√©rifie √©galement s'il divise par 4 la taille de chaque espace vide individuel cr√©√© par l'insertion de la forme. <br><br><h2>  Conversion d'image </h2><br>  L'algorithme d'imprimante Tetris convertit chaque ligne du bitmap en une s√©rie de passes.  En se d√©pla√ßant de gauche √† droite, chaque passage de mani√®re "gourmande" ins√®re le tetramino J, T et L √† l'endroit o√π il est plac√©.  Par exemple, l'image ci-dessous montre une ligne de 16 pixels d'une image bitmap. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9c1/4c5/b69/9c14c5b69ae9a4599ee0856a250256a8.gif"></div><br>  L'image ci-dessous montre les 5 passes n√©cessaires pour couvrir ces 16 pixels. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/989/f7d/760/989f7d76010dd0d7e523361148e0e323.gif"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4c4/920/25a/4c492025a6033a3eda85fd240118b657.gif"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0f1/44f/373/0f144f3734988b25dd231a1a445c52fd.gif"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6c1/e37/392/6c1e373927f4842ad379ff2b6c42b123.gif"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a9a/64b/222/a9a64b222baaf24ed13674bdac9b8d01.gif"></div><br>  La s√©quence de formes que l'algorithme essaie d'ins√©rer est d√©termin√©e par les couleurs des pixels.  Pour que les formes ne se chevauchent pas, un tableau unidimensionnel de valeurs bool√©ennes est utilis√©.  Pour ins√©rer une figure, 3 √©l√©ments z√©ro doivent √™tre pr√©sents dans le tableau.  Une fois l'insertion de la figure 3 r√©ussie, les √©l√©ments de tableau correspondants prennent la valeur 1. <br><br>  Pour suivre les pixels termin√©s entre plusieurs passes, un deuxi√®me tableau unidimensionnel de valeurs bool√©ennes est utilis√©.  Lorsque chaque √©l√©ment vaut 1, la ligne est termin√©e. <br><br>  √Ä la fin de chaque passage, le convertisseur d'image recherche dans le tableau tous les motifs pour cr√©er un ou plusieurs carr√©s.  √Ä la sortie, il passe le motif correspondant avec le tetramino J, T et L ins√©r√© en bas. Par exemple, le premier passage montr√© ci-dessus est affich√© comme le motif suivant pour cr√©er 5 carr√©s: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c67/b1b/377/c67b1b3778a37bf7008438052679942e.gif"></div><br><h2>  Recherche en temps r√©el </h2><br>  Le convertisseur d'image d√©crit dans la section pr√©c√©dente est extr√™mement rapide car il utilise une table constante contenant tous les motifs pour cr√©er des carr√©s et ne les recherche pas en temps r√©el.  Cependant, la recherche en temps r√©el peut utiliser des mod√®les qui ne figurent pas dans le tableau et, par cons√©quent, r√©duire consid√©rablement la quantit√© de t√©tramino n√©cessaire pour g√©n√©rer l'image.  Il utilise les carr√©s cr√©√©s dans les passages pr√©c√©dents, les utilisant comme supports suppl√©mentaires.  Par exemple, comme mentionn√© ci-dessus, le mod√®le suivant pour cr√©er un carr√© n√©cessite 7 lignes compl√®tes. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9ee/0b4/889/9ee0b488962c79ad6c84255efd033b5d.gif"></div><br>  Mais un carr√© rouge cr√©√© dans le passage pr√©c√©dent dans le coin inf√©rieur gauche de l'image ci-dessous fournit un support suppl√©mentaire, r√©duisant le nombre de lignes remplies √† 3. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dfa/d3e/271/dfad3e271c5623daedc462821b82b8af.gif"></div><br>  De plus, une recherche en temps r√©el peut couvrir 3 pixels adjacents de la m√™me couleur en retournant le tetramino J, T ou L. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a31/e09/776/a31e097766437cb13ebde1e35ee66453.gif"></div><br>  En fait, il peut combiner t√©tramino invers√© et invers√©, couvrant un grand nombre de pixels en une seule passe.  Par exemple, les 5 passes ci-dessus n√©cessaires pour couvrir 16 pixels peuvent √™tre r√©duites √† la seule passe illustr√©e ci-dessous. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/64c/653/c31/64c653c31d38daeef85189e3b2eacaa8.gif"></div><br>  Pour obtenir ce motif, le convertisseur d'image commence par emballer avec enthousiasme le t√©tramino retourn√© J, T et L. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e7a/e98/67e/e7ae9867e1419492f6f19f6816d18f04.gif"></div><br>  Ensuite, il essaie ardemment d'ajouter les versions non retourn√©es, et dans ce cas, il parvient √† ajouter un autre J. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ba2/4f3/1d4/ba24f31d49baa855fc449c3cf98f09ca.gif"></div><br>  En principe, une table de recherche pr√©-calcul√©e peut √©galement √™tre utilis√©e dans ce processus, mais la taille m√™me d'une telle table la rend inapplicable dans la pratique. <br><br>  Dans cet exemple, 8 carr√©s cons√©cutifs au-dessus de la ligne √† cr√©er sont ajout√©s √† la ligne inf√©rieure de la matrice vide.  Pour <i>n</i> carr√©s sur un terrain de 21 m√®tres carr√©s, la hauteur de la matrice <i>h</i> est le plus petit entier positif tel que <i>21h - n</i> est divisible par 4. Dans ce cas, une matrice de hauteur 4 est requise. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b2a/c2e/d2b/b2ac2ed2bc3a422d0d94fff2b10bf9e0.gif"></div><br>  La recherche en temps r√©el fonctionne exactement de la m√™me mani√®re que l'algorithme de recherche d√©crit ci-dessus, mais pr√©sente des am√©liorations mineures.  Comme pr√©c√©demment, la pile de colonnes de matrice fournit un support uniquement si la hauteur de colonne moins le nombre de lignes termin√©es est sup√©rieure √† z√©ro.  Lorsque la diff√©rence est nulle, la pile de colonnes ne doit pas fournir de support.  Cependant, dans cette version, s'il est √©gal √† z√©ro, il v√©rifie les carr√©s de la ligne cr√©√©e g√©n√©r√©s par les passes pr√©c√©dentes.  En d'autres termes, tous les carr√©s de la ligne situ√©e sous la ligne inf√©rieure de la matrice prennent en charge les colonnes vides. <br><br>  De plus, la recherche √©tant effectu√©e en temps r√©el, il sera impossible de la rendre exhaustive.  S'il n'a pas trouv√© de solution apr√®s un certain nombre de tentatives, il ajoute 4 lignes suppl√©mentaires en haut de la matrice, puis r√©essaye.  Apr√®s cela, s'il ne pouvait toujours pas trouver de solution apr√®s un certain nombre de tentatives, alors dans le passage en cours, il revient √† la m√©thode avec les tables de recherche pr√©calcul√©es et la conversion d'images d√©crites dans la section pr√©c√©dente de l'article. <br><br><h2>  Imprimer </h2><br>  Pour l'impression, vous devez suivre les instructions affich√©es par le convertisseur d'image sur le terrain de jeu de Tetris.  L'imprimante cr√©e un t√©tramino sp√©cifique au point central sup√©rieur du terrain de jeu dans une orientation standard.  Ensuite, l'imprimante la fait pivoter, la d√©place horizontalement et l'abaisse.  Ce processus est illustr√© dans la vid√©o: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/PJkHwulsac4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h2>  Code source </h2><br>  Le code source du projet Java 7 est disponible <a href="">ici</a> . <br><br>  Les algorithmes de recherche pour les tableaux pr√©-pr√©par√©s et en temps r√©el sont dans les packages <code>search.precomputed</code> et <code>search.realtime</code> .  Ils utilisent certaines classes communes situ√©es dans le package de <code>search</code> .  Les r√©sultats d'une recherche pr√©calcul√©e sont stock√©s dans le package de <code>patterns</code> sous la forme d'une s√©quence de fichiers texte.  Les fichiers texte stockent les matrices compress√©es sous forme de caract√®res ASCII, en commen√ßant par <code>A</code>  Par exemple, les 3 premi√®res matrices dans <code>emitters1.txt</code> (l'ensemble de mod√®les pour cr√©er un carr√©) ressemblent √† ceci: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lv/yo/mo/lvyomov6ld5rle3bqj1jnjegic4.png"></div><br>  Comme indiqu√© √† plusieurs reprises dans l'article, 3 symboles <code>A</code> adjacents dans les matrices ci-dessus peuvent √™tre remplac√©s par tetramino J, T ou L.Les symboles <code>B</code> , <code>C</code> , <code>D</code> et ainsi de suite repr√©sentent la s√©quence de tetramino que vous devez cr√©er. <br><br>  La classe <code>imageconverter.ImageConverter</code> contient la m√©thode <code>main</code> , qui re√ßoit un seul argument de ligne de commande: le nom du fichier d'image-objet.  Une image ne peut pas d√©passer 17 √ó 32 pixels et ne peut pas contenir plus de 3 couleurs opaques.  Tous les autres pixels doivent √™tre transparents. <br><br>  Fait int√©ressant, dans les anciens jeux vid√©o, les d√©veloppeurs utilisaient souvent l'arri√®re-plan pour obtenir des couleurs suppl√©mentaires.  Par exemple, les √©l√®ves et la bouche de Bubble de Bubble bobble, les √©l√®ves de Donkey Kong de Donkey Kong et le sourcil avec la taupe de Miss Pakman de Mme  Pac-Man est en fait transparent.  Le noir est obtenu √† partir d'un fond uni. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3fe/67d/330/3fe67d330fce92bff0b4595902e5f5bb.png"></div><br>  Le fond du terrain de jeu de Tetris peut √™tre utilis√© de la m√™me mani√®re. <br><br>  <code>ImageConverter</code> sortie d' <code>ImageConverter</code> ressemble √† cet extrait: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rs/vt/ms/rsvtmsq6olz9bm1huiqbqgbouj4.png"></div><br>  Les 3 valeurs hexad√©cimales de la premi√®re ligne sont 3 couleurs opaques extraites du fichier image sprite.  Ils correspondent aux couleurs du t√©tramino J, T et L. Les couleurs des autres t√©tramino n'affectent pas l'image.  Les blocs restants sont des motifs emball√©s ex√©cut√©s sur le terrain de jeu (pour les caract√®res apr√®s <code>Z</code> et jusqu'√† <code>a</code> voir le <a href="">tableau des caract√®res ASCII</a> ).  Les blocs jaunes surlign√©s composent la plateforme.  Le premier bloc ajoute la plateforme, le second la supprime. <br><br>  La classe <code>printer.Printer</code> re√ßoit un fichier texte dans ce format et g√©n√®re un fichier image en lisant Tetris. <br><br>  L'algorithme d'imprimante utilis√© pour g√©n√©rer une vid√©o ressemblant √† la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">version NES de Tetris</a> d√©finit chaque type de tetramino dans chaque bloc d'un fichier texte.  Ensuite, il se d√©place dans l'ordre oppos√© du point de d√©part et de l'orientation initiale √† l'angle de rotation et aux coordonn√©es de l'abaissement de la figure indiqu√©e dans le fichier.  Remarque: en raison de la vitesse extr√™mement √©lev√©e des chiffres en baisse, il est impossible d'aller au-del√† du niveau 30 dans la vraie version NES de Tetris.  Il est suppos√© que l'imprimante transmet toutes ses commandes au terrain de jeu assez rapidement.  pour compenser cela. <br><br>  Pour r√©g√©n√©rer des fichiers de <code>search.precomputed.PatternSearcher</code> , utilisez <code>search.precomputed.PatternSearcher</code> .  Il peut √™tre personnalis√© en modifiant les constantes au d√©but du fichier de code source. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> MATRIX_WIDTH = <span class="hljs-number"><span class="hljs-number">21</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> MATRIX_HEIGHT = <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> EMITTED_SQUARES = <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> RANDOM_SETS = <span class="hljs-number"><span class="hljs-number">100000</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> MAX_ATTEMPTS = <span class="hljs-number"><span class="hljs-number">1000</span></span>;</code> </pre> <br>  <code>RANDOM_SETS</code> est le nombre de permutations al√©atoires de 371 fa√ßons d'ajouter un chiffre √† la matrice.  Lorsqu'il est d√©fini sur <code>100000</code> , il faut plusieurs secondes pour initialiser les permutations au d√©marrage.  De plus, leur stockage n√©cessite plus d'un gigaoctet de m√©moire. <br><br>  <code>MAX_ATTEMPTS</code> contr√¥le le temps d'ex√©cution de la recherche.  Une valeur relativement petite de <code>1000</code> permet √† la recherche de rejeter rapidement les d√©buts al√©atoires qui ne se montrent pas bien.  Cependant, afin de prouver que pour une taille de matrice sp√©cifique et le nombre de carr√©s cr√©√©s, il n'y a pas de solution, il est n√©cessaire d'explorer pleinement tout l'espace de recherche.  Pour ce faire, vous pouvez d√©finir <code>MAX_ATTEMPTS</code> sur <code>Integer.MAX_VALUE</code> . <br><br>  Des constantes similaires se trouvent dans <code>search.realtime.RealtimeSearcher</code> , qui est utilis√© par le convertisseur d'image.  Comme mentionn√© ci-dessus, une grande valeur <code>RANDOM_SETS</code> n√©cessite une augmentation de la m√©moire maximale et entra√Æne un d√©marrage plus long.  <code>MAX_RETRIES</code> contr√¥le le nombre de tentatives, apr√®s quoi la recherche en temps r√©el se rend et revient √† la recherche avec une table pr√©-calcul√©e. <br><br>  Gardez √† l'esprit que les deux algorithmes de recherche utilisent 100% du processeur, cr√©ant de nombreux threads parall√®les de taille √©gale au nombre de processeurs disponibles. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c2d/8b9/bd5/c2d8b9bd50fd64a3a7e739d51201c880.png"></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr474848/">https://habr.com/ru/post/fr474848/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr474838/index.html">SIBUR Challenge 2019 - Concours d'analyse de donn√©es industrielles</a></li>
<li><a href="../fr474840/index.html">Qu'est-ce qu'ils √©tudient dans la sp√©cialit√© de la science des donn√©es dans les universit√©s √©trang√®res</a></li>
<li><a href="../fr474842/index.html">Cas: Service de voiture. D√©veloppement de campagnes publicitaires et impl√©mentation de Bitrix24</a></li>
<li><a href="../fr474844/index.html">Dell XPS 13 7390: un ordinateur portable tr√®s compact pour ceux qui travaillent souvent en dehors du bureau</a></li>
<li><a href="../fr474846/index.html">Le programme de nettoyage des rivi√®res du monde des ordures</a></li>
<li><a href="../fr474850/index.html">Le pari quantique de Google sur l'IA - et ce que cela signifie pour toute l'humanit√©</a></li>
<li><a href="../fr474852/index.html">Environnement Lexical et fermetures en EcmaScript</a></li>
<li><a href="../fr474854/index.html">D√©clencher des e-mails - comment impliquer votre public</a></li>
<li><a href="../fr474856/index.html">Strat√©gies de localisation de contenu</a></li>
<li><a href="../fr474858/index.html">Ce que vous devez savoir sur le maillage du service Red Hat OpenShift</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>