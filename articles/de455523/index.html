<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ôüÔ∏è üßìüèª ‚óΩÔ∏è OpenStack LBaaS UI-Implementierung üèöÔ∏è üå≥ üëàüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Als ich die Benutzeroberfl√§che des Load Balancers f√ºr eine virtuelle private Cloud implementierte , hatte ich erhebliche Schwierigkeiten. Dies veranla...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>OpenStack LBaaS UI-Implementierung</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/selectel/blog/455523/"><img src="https://habrastorage.org/webt/ct/q8/3-/ctq83--b7viz0r6evi5um6brnam.png"><br><br>  Als ich die Benutzeroberfl√§che des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Load Balancers</a> f√ºr eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">virtuelle private Cloud</a> implementierte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">, hatte</a> ich erhebliche Schwierigkeiten.  Dies veranlasste mich, √ºber die Rolle des Frontends nachzudenken, die ich zun√§chst teilen m√∂chte.  Und dann begr√ºnden Sie ihre Gedanken am Beispiel einer bestimmten Aufgabe. <br><br>  Die L√∂sung des Problems erwies sich meiner Meinung nach als ziemlich kreativ, und ich musste in einem sehr begrenzten Rahmen danach suchen, daher denke ich, dass es interessant sein kann. <br><a name="habracut"></a><br><h2>  Frontend-Rolle </h2><br>  Ich muss sofort sagen, dass ich nicht die Wahrheit vort√§usche und ein kontroverses Thema anspreche.  Ich bin etwas deprimiert von der Ironie des Frontends und insbesondere des Webs als etwas Unbedeutendes.  Und es ist noch bedr√ºckender, dass dies manchmal vern√ºnftig geschieht.  Jetzt schlief die Mode bereits, aber es gab eine Zeit, in der alle mit Frameworks, Paradigmen und anderen Entit√§ten herumliefen und laut sagten, dass all dies √ºberaus wichtig und √ºberaus notwendig sei, und im Gegenzug erhielten sie eine Ironie, dass sich das Frontend mit der Ausgabe von Formen und Formen befasst Verarbeitung Klicks auf Tasten, die "auf dem Knie" erfolgen k√∂nnen. <br><br>  Nun scheint sich alles mehr oder weniger wieder normalisiert zu haben.  Niemand m√∂chte wirklich √ºber jede kleinere Version des n√§chsten Frameworks sprechen.  Aufgrund des zunehmenden Bewusstseins f√ºr ihren Nutzen suchen nur wenige Menschen nach dem perfekten Werkzeug oder Ansatz.  Aber auch dies beeintr√§chtigt beispielsweise nicht die fast ungerechtfertigte Kritik an Electron und seinen Anwendungen.  Ich denke, das liegt an einem Mangel an Verst√§ndnis f√ºr die Aufgabe, die vom Frontend gel√∂st wird. <br><br>  Das Frontend ist nicht nur ein Mittel zum Anzeigen der vom Backend bereitgestellten Informationen und nicht nur ein Mittel zum Verarbeiten von Benutzeraktionen.  Das Frontend ist etwas mehr, etwas Abstraktes, und wenn Sie es einfach und klar definieren, geht die Bedeutung unweigerlich verloren. <br><br>  Das Frontend befindet sich in einem ‚ÄûRahmen‚Äú.  Technisch gesehen liegt dies beispielsweise zwischen der vom Backend bereitgestellten API und der von den E / A-Einrichtungen bereitgestellten API.  In Bezug auf Aufgaben liegt es zwischen den Aufgaben der Benutzeroberfl√§che, die UX l√∂st, und den Aufgaben, die das Backend l√∂st.  Somit wird eine ziemlich enge Frontend-Spezialisierung erhalten, eine Spezialisierung der Schicht.  Dies bedeutet nicht, dass Front-End-Anbieter Bereiche au√üerhalb ihrer Spezialisierung nicht beeinflussen k√∂nnen, aber in dem Moment, in dem dieser Einfluss unm√∂glich ist, entsteht die eigentliche Front-End-Aufgabe. <br><br>  Dieses Problem kann durch einen Widerspruch ausgedr√ºckt werden.  Die Benutzeroberfl√§che muss nicht den Datenmodellen und dem Backend-Verhalten entsprechen.  Das Verhalten und die Datenmodelle des Backends sind nicht erforderlich, um den Aufgaben der Benutzeroberfl√§che zu entsprechen.  Und dann ist es die Aufgabe des Frontends, diesen Widerspruch zu beseitigen.  Je gr√∂√üer die Diskrepanz zwischen den Aufgaben des Backends und der Benutzeroberfl√§che ist, desto wichtiger ist die Rolle des Frontends.  Und um klar zu machen, wovon ich spreche, werde ich ein Beispiel geben, bei dem sich diese Diskrepanz aus irgendeinem Grund als signifikant herausgestellt hat. <br><br><h2>  Erkl√§rung des Problems </h2><br>  OpenStack LBaaS ist meiner Meinung nach ein Hardware-Software-Komplex von Tools, die zum Lastausgleich zwischen Servern erforderlich sind.  F√ºr mich ist es wichtig, dass die Umsetzung von objektiven Faktoren und der physischen Darstellung abh√§ngt.  Aus diesem Grund gibt es einige Besonderheiten in der API und in der Art der Interaktion mit dieser API. <br><br>  Bei der Entwicklung einer Benutzeroberfl√§che liegt das Hauptinteresse nicht auf den technischen Merkmalen des Backends, sondern auf seinen grundlegenden Funktionen.  Die Schnittstelle wird f√ºr den Benutzer erstellt, und der Benutzer ben√∂tigt eine Schnittstelle zum Verwalten von Ausgleichsparametern, und der Benutzer muss nicht in die internen Funktionen der Backend-Implementierung eintauchen. <br><br>  Das Backend wird gr√∂√ütenteils von der Community entwickelt, und es ist m√∂glich, seine Entwicklung in sehr begrenzten Mengen zu beeinflussen.  Eines der Hauptmerkmale f√ºr mich ist, dass die Backend-Entwickler bereit sind, die Bequemlichkeit und Einfachheit von Steuerelementen aus Gr√ºnden der Leistung zu opfern, und dies ist absolut gerechtfertigt, da es darum geht, die Last auszugleichen. <br><br>  Es gibt noch einen subtileren Punkt, und ich m√∂chte ihn sofort skizzieren und einige Fragen warnen.  Es ist klar, dass auf OpenStack und ihrer API das Licht nicht konvergierte.  Sie k√∂nnen jederzeit Ihre eigenen Tools oder eine ‚ÄûEbene‚Äú entwickeln, die mit der OpenStack-API zusammenarbeitet und eine eigene API erstellt, die f√ºr Benutzeraufgaben geeignet ist.  Die Frage ist nur die Zweckm√§√üigkeit.  Wenn anfangs verf√ºgbare Tools es Ihnen erm√∂glichen, die Benutzeroberfl√§che wie beabsichtigt zu implementieren, ist es sinnvoll, Entit√§ten zu erstellen? <br><br>  Die Antwort auf diese Frage ist vielf√§ltig und f√ºr Unternehmen h√§ngt sie von Entwicklern, ihrer Besch√§ftigung, ihrer Kompetenz, Verantwortungsfragen, Unterst√ºtzung usw. ab.  In unserem Fall war es am zweckm√§√üigsten, einige der Aufgaben im Frontend zu l√∂sen. <br><br><h3>  Funktionen von OpenStack LBaaS </h3><br>  Ich m√∂chte nur die Funktionen identifizieren, die einen starken Einfluss auf das Frontend hatten.  Fragen, warum diese Funktionen entstanden sind oder worauf sie sich st√ºtzen, gehen bereits √ºber den Rahmen dieses Artikels hinaus. <br><br>  Ich arbeite mit vorgefertigten Dokumentationen und muss deren Funktionen akzeptieren.  Wer sich von innen f√ºr OpenStack Octavia interessiert, kann sich mit der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">offiziellen Dokumentation</a> vertraut machen.  Octavia ist der Name einer Reihe von Tools, mit denen die Last im OpenStack-√ñkosystem ausgeglichen werden kann. <br><br>  Das erste Merkmal, auf das ich w√§hrend der Entwicklung gesto√üen bin, ist die gro√üe Anzahl von Modellen und Beziehungen, die zum Anzeigen des Status des Balancers erforderlich sind.  Die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Octavia-API</a> beschreibt 12 Modelle, f√ºr die Clientseite werden jedoch nur 7 ben√∂tigt. Diese Modelle verf√ºgen √ºber h√§ufig denormalisierte Verbindungen. Das folgende Bild zeigt ein ungef√§hres Diagramm: <br><br><div style="text-align:center;"><img title="Beispieldiagramm von Modellen und Beziehungen OpenStack Octavia" src="https://habrastorage.org/webt/p2/fw/2v/p2fw2vvyascudv9zjx5a0m-5bkq.png"></div><br><br>  "Sieben" klingt nicht sehr beeindruckend, aber in Wirklichkeit musste ich zum Zeitpunkt des Schreibens dieses Textes 16 Datenmodelle und etwa 30 Beziehungen zwischen ihnen verwenden, um den vollen Betrieb der Benutzeroberfl√§che sicherzustellen.  Da Octavia nur ein Balancer ist, m√ºssen andere OpenStack-Module funktionieren.  Und das alles wird nur f√ºr zwei Seiten in der Benutzeroberfl√§che ben√∂tigt. <br><br>  Das zweite und dritte Merkmal sind <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">asynchrone</a> und transaktionale Octavia.  Datenmodelle verf√ºgen √ºber ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Statusfeld</a> , das den Status der an einem Objekt ausgef√ºhrten Operationen widerspiegelt. <br><div class="scrollable-table"><table><tbody><tr><th>  Status </th><th>  Beschreibung </th></tr><tr><td>  AKTIV </td><td>  Objekt in gutem Zustand </td></tr><tr><td>  GEL√ñSCHT </td><td>  Objekt gel√∂scht </td></tr><tr><td>  Fehler </td><td>  Objekt ist besch√§digt </td></tr><tr><td>  PENDING_CREATE </td><td>  Objekt in der Herstellung </td></tr><tr><td>  PENDING_UPDATE </td><td>  Objekt wird gerade aktualisiert </td></tr><tr><td>  PENDING_DELETE </td><td>  Objekt wird gerade gel√∂scht </td></tr></tbody></table></div>  Der Vorgang des Lesens eines Objekts erfolgt synchron und unterliegt keinen Einschr√§nkungen.  Das Erstellen, Aktualisieren und L√∂schen von Vorg√§ngen kann jedoch unbegrenzt lange dauern.  Dies liegt genau daran, dass Datenmodelle grob gesagt eine physikalische Bedeutung haben. <br><br>  Nachdem wir eine Anforderung zur Erstellung gesendet haben, k√∂nnen wir wissen, dass der Datensatz angezeigt wurde, wir k√∂nnen ihn lesen, aber bis der Erstellungsvorgang abgeschlossen ist, k√∂nnen wir keine anderen Vorg√§nge f√ºr diesen Datensatz ausf√ºhren.  Ein solcher Versuch f√ºhrt zu einem Fehler.  Das √Ñndern eines Objekts kann nur <b>gestartet</b> werden, wenn sich das Objekt im Status <b>AKTIV befindet</b> . Sie k√∂nnen ein Objekt zum L√∂schen im Status <b>AKTIV</b> und <b>FEHLER</b> senden. <br><br>  Diese Status k√∂nnen √ºber WebSockets erfolgen, was ihre Verarbeitung erheblich erleichtert. Transaktionen sind jedoch ein viel gr√∂√üeres Problem.  Wenn Sie √Ñnderungen an einem Objekt vornehmen, nehmen auch alle zugeh√∂rigen Modelle an der Transaktion teil.  Wenn Sie beispielsweise √Ñnderungen an <b>Member</b> vornehmen, werden der zugeh√∂rige <b>Pool</b> , <b>Listener</b> und <b>Loadbalancer</b> blockiert.  So sieht es in Bezug auf Ereignisse aus, die auf Web-Sockets empfangen werden: <br><br><div style="text-align:center;"><img title="Der Vorgang zum √Ñndern des Status verwandter Objekte." src="https://habrastorage.org/webt/ia/fp/ff/iafpffzblzikgdekdrrs83br1_y.png"></div><ul><li>  Die ersten vier Ereignisse sind die √úbertragung von Objekten in den Status <strong>PENDING_UPDATE</strong> : Das <strong>Zielfeld</strong> enth√§lt den Modellnamen des an der Transaktion beteiligten Objekts. </li><li>  Das f√ºnfte Ereignis ist nur ein Duplikat (ich wei√ü nicht, womit es verbunden ist). </li><li>  Die letzten vier sind eine R√ºckkehr zum Status <strong>AKTIV</strong> .  In diesem Fall handelt es sich um eine Gewichts√§nderungsoperation, die weniger als eine Sekunde dauert, manchmal aber auch viel l√§nger. </li></ul><br>  Sie k√∂nnen auch im Screenshot sehen, dass die Reihenfolge der Ereignisse nicht streng sein muss.  Es stellt sich also heraus, dass zum Einleiten einer Operation nicht nur der Status des Objekts selbst bekannt sein muss, sondern auch der Status aller Abh√§ngigkeiten, die ebenfalls an der Transaktion teilnehmen. <br><br><h3>  Funktionen der Benutzeroberfl√§che </h3><br>  Stellen Sie sich nun an die Stelle eines Benutzers, der irgendwo wissen muss, dass zwischen zwei Servern ausgeglichen werden soll: <br><br><ol><li>  Es ist erforderlich, einen Listener zu erstellen, in dem der Ausgleichsalgorithmus definiert wird. </li><li>  Erstellen Sie einen Pool. </li><li>  Weisen Sie dem Listener einen Pool zu. </li><li>  F√ºgen Sie dem Pool Links zu ausgeglichenen Ports hinzu. </li></ol><br>  Jedes Mal muss auf den Abschluss des Vorgangs gewartet werden, der von allen zuvor erstellten Objekten abh√§ngt. <br><br>  Wie eine interne Studie gezeigt hat, gibt es nach Ansicht des normalen Benutzers nur eine ungef√§hre Erkenntnis, dass der Balancer einen Einstiegspunkt haben muss, dass Austrittspunkte vorhanden sein m√ºssen und die Parameter des auszuf√ºhrenden Ausgleichs: Algorithmus, Gewicht und andere.  Der Benutzer muss nicht wissen, was OpenStack ist. <br><br>  Ich wei√ü nicht, wie kompliziert die Benutzeroberfl√§che f√ºr die Wahrnehmung sein sollte, bei der der Benutzer selbst alle technischen Funktionen des oben beschriebenen Backends befolgen muss.  F√ºr die Konsole mag dies zul√§ssig sein, da ihre Verwendung ein hohes Ma√ü an Eintauchen in die Technologie impliziert, aber f√ºr das Web ist eine solche Schnittstelle schrecklich. <br><br>  Im Web erwartet der Benutzer, dass er ein klares und logisches Formular ausf√ºllt, eine Taste dr√ºckt, wartet und alles funktioniert.  Vielleicht kann dies argumentiert werden, aber ich schlage vor, mich auf die Funktionen zu konzentrieren, die die Implementierung des Frontends beeinflussen. <br><br>  Die Schnittstelle wurde so konzipiert, dass Operationen kaskadiert verwendet werden: Eine Aktion in der Schnittstelle kann mehrere Operationen umfassen.  Die Schnittstelle bedeutet nicht, dass der Benutzer Aktionen ausf√ºhren kann, die derzeit nicht m√∂glich sind. Die Schnittstelle geht jedoch davon aus, dass der Benutzer verstehen muss, warum dies so ist.  Die Schnittstelle ist ein einzelnes Ganzes, und daher k√∂nnen ihre einzelnen Elemente Informationen von verschiedenen abh√§ngigen Entit√§ten, einschlie√ülich Metainformationen, verwenden. <br><br><div style="text-align:center;"><img title="Die Balancer-Listenoberfl√§che im Selectel-Bedienfeld" src="https://habrastorage.org/webt/cc/no/am/ccnoamyjre40swvpswygbqezn_w.png"></div><br><br>  Wenn wir ber√ºcksichtigen, dass es einige Funktionen der Benutzeroberfl√§che gibt, die nicht nur f√ºr den Balancer gelten, wie z. B. Schalter, Akkordeons, Registerkarten, ein Kontextmen√º, und davon ausgehen, dass ihre Funktionsprinzipien zun√§chst klar sind, denke ich nicht an einen Benutzer, der versteht, was Lastausgleich ist Es wird sehr schwierig sein, den gr√∂√üten Teil der obigen Benutzeroberfl√§che zu lesen und davon auszugehen, wie sie verwaltet wird.  Es ist jedoch nicht mehr die naheliegendste Aufgabe, hervorzuheben, welche Teile der Benutzeroberfl√§che hinter den Modellen von Balancer, Listener, Pool, Mitglied und anderen Entit√§ten verborgen sind. <br><br><h3>  Widerspr√ºche l√∂sen </h3><br>  Ich hoffe, ich konnte zeigen, dass die Funktionen des Backends nicht gut zur Benutzeroberfl√§che passen und dass diese Funktionen nicht immer vom Backend entfernt werden k√∂nnen.  Au√üerdem passen die Funktionen der Benutzeroberfl√§che nicht gut in das Backend und k√∂nnen auch nicht immer entfernt werden, ohne die Benutzeroberfl√§che zu komplizieren.  Jeder dieser Bereiche l√∂st seine eigenen Probleme.  Die Verantwortung des Frontends besteht darin, Probleme zu l√∂sen, um das erforderliche Ma√ü an Interaktion zwischen der Schnittstelle und dem Backend sicherzustellen. <br><br>  In meiner Praxis eilte ich sofort mit dem Kopf in den Pool, ohne darauf zu achten oder vielmehr nicht einmal zu versuchen, die h√∂heren Merkmale herauszufinden, aber ich hatte Gl√ºck oder die Erfahrung half (und der richtige Vektor wurde ausgew√§hlt).  Ich habe wiederholt festgestellt, dass es bei Verwendung einer API oder Bibliothek eines Drittanbieters sehr n√ºtzlich ist, sich im Voraus mit der Dokumentation vertraut zu machen: Je mehr Details, desto besser.  Die Dokumentation ist oft √§hnlich, die Menschen verlassen sich immer noch auf die Erfahrungen anderer Menschen, aber es gibt eine Beschreibung der Merkmale jedes einzelnen Systems und sie ist in den Details enthalten. <br><br>  Wenn ich anf√§nglich ein paar zus√§tzliche Stunden damit verbracht h√§tte, die Dokumentation zu studieren, anstatt die erforderlichen Informationen anhand von Schl√ºsselw√∂rtern herauszuholen, h√§tte ich √ºber die Probleme nachgedacht, mit denen ich konfrontiert werden m√ºsste, und dieses Wissen k√∂nnte sich von Anfang an auf die Projektarchitektur auswirken.  Zur√ºck zu gehen, um Fehler zu beseitigen, die am Anfang gemacht wurden, ist sehr demoralisierend.  Und ohne einen vollst√§ndigen Kontext muss man manchmal mehrmals zur√ºckkommen. <br><br>  Optional k√∂nnen Sie Ihre Linie biegen und nach und nach immer mehr Code ‚Äûmit einem Biss‚Äú generieren. Je mehr dieser Codehaufen jedoch vorhanden ist, desto mehr wird er am Ende geharkt.  Bei der Gestaltung der Architektur sollte man nat√ºrlich nicht zu tief eintauchen, alle m√∂glichen und unm√∂glichen Optionen ber√ºcksichtigen und viel Zeit damit verbringen. Es ist wichtig, ein Gleichgewicht zu finden.  Eine mehr oder weniger detaillierte Kenntnis der Dokumentation erweist sich jedoch h√§ufig als sehr n√ºtzliche Investition, die nicht sehr viel Zeit in Anspruch nimmt. <br><br>  Trotzdem wurde mir von Anfang an klar, dass es notwendig sein w√ºrde, eine Zuordnung des Backend-Status zum Client zu erstellen, wobei alle Verbindungen erhalten bleiben, nachdem ich eine gro√üe Anzahl von beteiligten Modellen gesehen hatte.  Nachdem es mir gelungen war, alle erforderlichen Informationen auf dem Client mit allen Verbindungen usw. anzuzeigen, musste eine Aufgabenwarteschlange organisiert werden. <br><br>  Daten werden asynchron aktualisiert, die Verf√ºgbarkeit von Operationen wird durch eine Vielzahl von Bedingungen bestimmt, und wenn kaskadierende Operationen erforderlich sind, kann unter solchen Bedingungen auf keine Warteschlange verzichtet werden.  Kurz gesagt, dies ist vielleicht die gesamte Architektur meiner L√∂sung: Speicher mit einer Reflexion des Backend-Status und der Task-Warteschlange. <br><br><h2>  L√∂sungsarchitektur </h2><br>  Aufgrund der unbestimmten Anzahl von Modellen und Beziehungen habe ich die Struktur des Repositorys skalierbar gemacht, indem ich eine Factory verwendet habe, die eine deklarative Beschreibung der Repository-Sammlungen zur√ºckgibt.  Die Sammlung hat einen Service, eine einfache Modellklasse mit CRUD.  Es w√§re m√∂glich, eine Beschreibung der Links im Modell zu erstellen, wie dies beispielsweise in RoR oder im guten alten Backbone der Fall ist, dies w√ºrde jedoch eine gro√üe Menge an Code erfordern, die ge√§ndert werden muss.  Daher liegt die Beschreibung der Beziehungen neben der Modellklasse: <br><br><div style="text-align:center;"><img title="Link Beschreibung Beispiel" src="https://habrastorage.org/webt/_y/jw/pr/_yjwpryzsckc_by0igzpq5vlog0.png"></div><br><br>  Insgesamt habe ich zwei Arten von Verbindungen: eine zu eins, eine zu viele.  Feedback kann auch beschrieben werden.  Zus√§tzlich zum Typ wird die Sammlung von Abh√§ngigkeiten angegeben, das Feld, an das die gefundene Abh√§ngigkeit angeh√§ngt ist, und das Feld, aus dem die ID des abh√§ngigen Objekts gelesen wird (bei einer Eins-zu-Viele-Kommunikation wird die Liste der IDs gelesen).  Wenn die Kommunikationsbedingung eines Objekts komplizierter ist als einfache Verkn√ºpfungen mit Objekten, kann im Werk die Funktion zum Testen von zwei Objekten beschrieben werden, deren Ergebnisse das Vorhandensein einer Verbindung bestimmen.  Es sieht alles ein bisschen "Fahrrad" aus, aber es funktioniert ohne unn√∂tige Abh√§ngigkeiten und genau so, wie es sollte. <br><br>  Das Repository verf√ºgt √ºber ein Modul zum Warten auf das Hinzuf√ºgen und L√∂schen einer Ressource. Im Wesentlichen verarbeitet es einmalige Ereignisse mit bedingter √úberpr√ºfung und mit einer Promis-Schnittstelle.  Beim Abonnieren werden der Ereignistyp (Hinzuf√ºgen, L√∂schen), die Testfunktion und der Handler √ºbergeben.  Wenn ein bestimmtes Ereignis eintritt und ein positives Testergebnis vorliegt, wird der Handler ausgef√ºhrt, wonach die Verfolgung gestoppt wird.  Beim synchronen Abonnieren kann ein Ereignis auftreten. <br><br>  Die Verwendung eines solchen Musters erm√∂glichte es, beliebig komplexe Beziehungen zwischen Modellen automatisch an einer Stelle anzubringen.  Diesen Ort habe ich einen Tracker genannt.  Wenn Sie dem Repository ein Objekt hinzuf√ºgen, beginnt es, seine Beziehungen zu verfolgen.  Mit dem Wartemodul k√∂nnen Sie auf Ereignisse reagieren und nach einer Verbindung zwischen dem √ºberwachten Objekt und dem Objekt im Speicher suchen.  Wenn sich das Objekt bereits im Repository befand, ruft das Wartemodul den Handler sofort auf. <br><br>  Mit einem solchen Speicherger√§t k√∂nnen Sie eine beliebige Anzahl von Sammlungen und die Beziehungen zwischen ihnen beschreiben.  Beim Hinzuf√ºgen und L√∂schen von Objekten f√ºgt der Speicher Eigenschaften mit dem Inhalt abh√§ngiger Objekte automatisch ein oder setzt sie zur√ºck.  Die Vorteile dieses Ansatzes bestehen darin, dass alle Beziehungen explizit beschrieben werden und von einem System √ºberwacht und aktualisiert werden.  Nachteile - in der Komplexit√§t der Implementierung und des Debuggens. <br><br>  Im Allgemeinen ist ein solches Repository eher trivial, und ich habe es selbst gemacht, da es viel schwieriger w√§re, eine vorgefertigte L√∂sung in eine vorhandene Codebasis zu integrieren, es jedoch noch schwieriger w√§re, eine Aufgabenwarteschlange an eine vorgefertigte L√∂sung anzuh√§ngen. <br><br>  Alle Aufgaben, wie Sammlungen, haben eine deklarative Beschreibung und werden von der Fabrik erstellt.  Aufgaben k√∂nnen in der Beschreibung die Startbedingungen und eine Liste von Aufgaben enthalten, die nach Abschluss der aktuellen Aufgabe zur Warteschlange hinzugef√ºgt werden m√ºssen. <br><br><div style="text-align:center;"><img title="Ein Beispiel zum Generieren einer Aufgabe zum Erstellen eines Pools" src="https://habrastorage.org/webt/03/7w/fo/037wfo0c0fn7uxeblixnsahw7j8.png"></div><br>  Das obige Beispiel beschreibt die Aufgabe, einen Pool zu erstellen.  In den Abh√§ngigkeiten werden der Balancer und der Listener angezeigt. Standardm√§√üig wird eine √úberpr√ºfung des <b>ACTIVE-</b> Status durchgef√ºhrt.  Das Objekt des Balancers ist gesperrt, da Verarbeitungsaufgaben in der Warteschlange synchron ausgef√ºhrt werden k√∂nnen. Durch das Sperren k√∂nnen Sie Konflikte zum Zeitpunkt des Sendens der Ausf√ºhrungsanforderung vermeiden, der Status hat sich jedoch nicht ge√§ndert, es wird jedoch davon ausgegangen, dass er sich √§ndert.  Wenn der Pool als Ergebnis der Kaskade von Aufgaben erstellt wird, wird anstelle von <b>PARENT</b> die <b>ID</b> automatisch ersetzt. <br><br>  Nach dem Erstellen eines Pools werden der Warteschlange Aufgaben hinzugef√ºgt, um einen Verf√ºgbarkeitsmonitor zu erstellen und alle Mitglieder dieses Pools zu erstellen.  Die Ausgabe ist eine Struktur, die vollst√§ndig in JSON konvertiert werden kann.  Dies geschieht, um die Warteschlange im Fehlerfall wiederherstellen zu k√∂nnen. <br><br>  Die Warteschlange √ºberwacht basierend auf der Aufgabenbeschreibung unabh√§ngig alle √Ñnderungen im Repository und √ºberpr√ºft die Bedingungen, die zum Ausf√ºhren der Aufgabe erf√ºllt sein m√ºssen.  Wie ich bereits sagte, werden Status √ºber Web-Sockets gesendet, und es ist sehr einfach, die erforderlichen Ereignisse f√ºr die Warteschlange zu generieren. Bei Bedarf ist es jedoch kein Problem, einen Mechanismus zur Aktualisierung der Zeitgeberdaten anzuh√§ngen (dies wurde urspr√ºnglich in der Architektur festgelegt, da dies Web-Sockets waren aus verschiedenen Gr√ºnden m√∂glicherweise nicht sehr stabil arbeiten).  Nach Abschluss der Aufgabe informiert die Warteschlange das Repository automatisch √ºber die Notwendigkeit, die Links in den angegebenen Objekten zu aktualisieren. <br><br><h2>  Fazit </h2><br>  Die Notwendigkeit der Skalierbarkeit hat zu einem deklarativen Ansatz gef√ºhrt.  Die Notwendigkeit, Modelle und die Beziehungen zwischen ihnen anzuzeigen, hat zu einem einzigen Repository gef√ºhrt.  Die Notwendigkeit, abh√§ngige Objekte zu verarbeiten, hat zur Warteschlange gef√ºhrt. <br><br>  Die Kombination dieser Anforderungen ist m√∂glicherweise nicht die einfachste Aufgabe in Bezug auf die Implementierung (dies ist jedoch ein separates Problem).  In Bezug auf die Architektur ist die L√∂sung jedoch sehr einfach und erm√∂glicht es Ihnen, alle Widerspr√ºche zwischen den Aufgaben des Backends und der Benutzeroberfl√§che zu beseitigen, deren Interaktion herzustellen und die Grundlage f√ºr andere m√∂gliche Funktionen einer der Parteien zu legen. <br><br>  Auf der Seite des Selectel- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kontrollfelds ist</a> der Ausgleichsprozess einfach und unkompliziert. Dadurch k√∂nnen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Servicekunden</a> keine Ressourcen f√ºr die unabh√§ngige Implementierung des Balancers ausgeben und gleichzeitig den Datenverkehr flexibel steuern. <br><br>  Testen Sie unseren Balancer jetzt in Aktion und schreiben Sie Ihre Bewertung in die Kommentare. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de455523/">https://habr.com/ru/post/de455523/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de455511/index.html">Schlaf ist die wichtigste Ressource f√ºr das Gehirn eines Programmierers</a></li>
<li><a href="../de455513/index.html">Explosion und eine globale Verschw√∂rung: die Geschichte der Lithium-Ionen-Batterien</a></li>
<li><a href="../de455515/index.html">Umkehren und Hacken der selbstverschl√ºsselenden externen Festplatte von Aigo. Teil 1: Zerlegen in Teile</a></li>
<li><a href="../de455517/index.html">Absolvent des Netologiekurses ‚ÄûData Science‚Äú √ºber seine Arbeit im Bankensektor</a></li>
<li><a href="../de455519/index.html">Wie wir das Onboarding neuer Entwickler implementiert haben</a></li>
<li><a href="../de455525/index.html">Zimbra und Mail Bomb Defense</a></li>
<li><a href="../de455527/index.html">Was steht darin geschrieben? Hinter den Kulissen von JavaScript-Objekten</a></li>
<li><a href="../de455529/index.html">Umkehren und Hacken der selbstverschl√ºsselenden externen Festplatte von Aigo. Teil 2: Dumping mit Cypress PSoC</a></li>
<li><a href="../de455533/index.html">Blasenphysik: Eine Suche nach Schaumzerst√∂rungsmechanismus</a></li>
<li><a href="../de455535/index.html">Verwalten von SSL / TLS-Zertifikaten in den Clouds und Containern - keine menschliche Arbeit</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>