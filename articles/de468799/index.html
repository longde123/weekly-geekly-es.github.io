<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíè üì∂ ü§ò Antimuster in Reaktion oder schlechte Tipps f√ºr Anf√§nger üò¨ üôåüèª üìß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo Habr. 

 Genau ein Jahr ist vergangen, seit ich angefangen habe, React zu studieren. W√§hrend dieser Zeit gelang es mir, mehrere kleine mobile An...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Antimuster in Reaktion oder schlechte Tipps f√ºr Anf√§nger</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/468799/"> Hallo Habr. <br><br>  Genau ein Jahr ist vergangen, seit ich angefangen habe, React zu studieren.  W√§hrend dieser Zeit gelang es mir, mehrere kleine mobile Anwendungen zu ver√∂ffentlichen, die in React Native geschrieben wurden, und an der Entwicklung einer Webanwendung mit ReactJS teilzunehmen.  Zusammenfassend und im R√ºckblick auf all die Rechen, auf die ich getreten bin, hatte ich die Idee, meine Erfahrungen in Form eines Artikels auszudr√ºcken.  Ich mache einen Vorbehalt, dass ich vor Beginn des Studiums der Reaktion 3 Jahre Entwicklungserfahrung in C ++, Python sowie die Meinung hatte, dass die Front-End-Entwicklung nichts Kompliziertes enth√§lt und es nicht schwierig sein wird, alles zu verstehen.  Daher habe ich in den ersten Monaten das Lesen der Lehrliteratur vernachl√§ssigt und im Grunde nur vorgefertigte Codebeispiele googelt.  Dementsprechend wird ein beispielhafter Entwickler, der zun√§chst zun√§chst Dokumentation studiert, hier h√∂chstwahrscheinlich nichts Neues f√ºr sich finden, aber ich denke immer noch, dass einige Leute beim Studium neuer Technologien den Weg von der Praxis zur Theorie bevorzugen.  Wenn dieser Artikel also jemanden vor einem Rechen rettet, habe ich es nicht umsonst versucht. <br><a name="habracut"></a><br><h3>  Tipp 1. Arbeiten mit Formularen </h3><br>  Die klassische Situation: Es gibt ein Formular mit mehreren Feldern, in das der Benutzer Daten eingibt, dann auf die Schaltfl√§che klickt und die eingegebenen Daten an eine externe API gesendet / im Status gespeichert / auf dem Bildschirm angezeigt werden - unterstreichen Sie das Notwendige. <br><br><h4>  Option 1. Wie geht das nicht? </h4><br>  In React k√∂nnen Sie eine Verkn√ºpfung zu einem DOM-Knoten oder einer React-Komponente erstellen. <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.myRef = React.createRef();</code> </pre> <br>  Mit dem ref-Attribut kann der erstellte Link an die gew√ºnschte Komponente / den gew√ºnschten Knoten angeh√§ngt werden. <br><br><pre> <code class="javascript hljs">&lt;input id=<span class="hljs-string"><span class="hljs-string">"data"</span></span> type=<span class="hljs-string"><span class="hljs-string">"text"</span></span> ref={<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.myRef} /&gt;</code> </pre> <br>  Somit kann das obige Problem gel√∂st werden, indem f√ºr jedes Feld des Formulars eine Referenz erstellt wird und im Hauptteil der Funktion, die beim Klicken auf die Schaltfl√§che aufgerufen wird, Daten aus dem Formular abgerufen werden, indem die erforderlichen Links kontaktiert werden. <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BadForm</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.myRef = React.createRef(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.onClickHandler = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.onClickHandler.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } onClickHandler() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> data = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.myRef.current.value; alert(data); } render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( &lt;&gt; &lt;form&gt; &lt;label htmlFor="data"&gt;Bad form:&lt;/label&gt; &lt;input id="data" type="text" ref={this.myRef} /&gt; &lt;input type="button" value="OK" onClick={this.onClickHandler} /&gt; &lt;/form&gt; &lt;/&gt; ); } }</code> </pre> <br>  <b>Wie der innere Affe versuchen kann, diese Entscheidung zu rechtfertigen:</b> <br><br><ol><li>  Die Hauptsache, die funktioniert, Sie haben immer noch 100500 Aufgaben und <s>Fernsehsendungen werden nicht gesehen,</s> Tickets sind nicht geschlossen.  Lass es so, dann √§ndere dich </li><li>  Sehen Sie, wie wenig Code zum Verarbeiten des Formulars ben√∂tigt wird.  Deklariert ref und Zugriff auf die Daten, wo immer Sie wollen. </li><li>  Wenn Sie den Wert im Status speichern, wird jedes Mal, wenn Sie die Eingabedaten √§ndern, die gesamte Anwendung erneut gerendert, und Sie ben√∂tigen nur die endg√ºltigen Daten.  Diese Methode erweist sich also auch als gut f√ºr die Optimierung. Lassen Sie es einfach so. </li></ol><br>  <b>Warum der Affe falsch liegt:</b> <br><br>  Das obige Beispiel ist das klassische Antimuster in React, das gegen das Konzept eines unidirektionalen Datenstroms verst√∂√üt.  In diesem Fall kann Ihre Anwendung w√§hrend der Eingabe nicht auf Daten√§nderungen reagieren, da diese nicht im Status gespeichert sind. <br><br><h4>  Option 2. Klassische L√∂sung </h4><br>  F√ºr jedes Formularfeld wird eine Variable in dem Zustand erstellt, in dem das Eingabeergebnis gespeichert wird.  Dem Wertattribut wird diese Variable zugewiesen.  Dem Attribut onhange wird eine Funktion zugewiesen, bei der der Wert der Variablen im Status √ºber setState () ge√§ndert wird.  Somit werden alle Daten aus dem Status √ºbernommen, und wenn sich die Daten √§ndern, √§ndert sich der Status und die Anwendung wird erneut gerendert. <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GoodForm</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = { <span class="hljs-attr"><span class="hljs-attr">data</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.onChangeData = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.onChangeData.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.onClickHandler = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.onClickHandler.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } onChangeData(event) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState({ <span class="hljs-attr"><span class="hljs-attr">data</span></span>: event.target.value }); } onClickHandler(event) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { data } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state; alert(data); } render() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { data } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( &lt;&gt; &lt;form&gt; &lt;label htmlFor="data"&gt;Good form:&lt;/label&gt; &lt;input id="data" type="text" value={data} onChange={this.onChangeData} /&gt; &lt;input type="button" value="OK" onClick={this.onClickHandler} /&gt; &lt;/form&gt; &lt;/&gt; ); } }</code> </pre> <br><h4>  Option 3. Erweitert.  Wenn Formen viele werden </h4><br>  Die zweite Option weist eine Reihe von Nachteilen auf: Eine gro√üe Menge an Standardcode. F√ºr jedes Feld muss die onhange-Methode deklariert und dem Status eine Variable hinzugef√ºgt werden.  Wenn es darum geht, eingegebene Daten zu validieren und Fehlermeldungen anzuzeigen, steigt die Codemenge noch weiter an.  Um die Arbeit mit Formularen zu erleichtern, gibt es eine hervorragende <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Formik-</a> Bibliothek, die sich um Probleme im Zusammenhang mit der Pflege von Formularen k√ºmmert und das Hinzuf√ºgen eines Validierungsschemas vereinfacht. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Formik } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'formik'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Yup <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'yup'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> SigninSchema = Yup.object().shape({ <span class="hljs-attr"><span class="hljs-attr">data</span></span>: Yup.string() .min(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">'Too Short!'</span></span>) .max(<span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-string"><span class="hljs-string">'Too Long!'</span></span>) .required(<span class="hljs-string"><span class="hljs-string">'Data required'</span></span>), }); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> () =&gt; <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;div&gt; &lt;Formik initialValues={{ data: </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">''</span></span></span></span><span class="hljs-function"><span class="hljs-params"> }} validationSchema={SigninSchema} onSubmit={(values</span></span></span><span class="hljs-function">) =&gt;</span></span> { alert(values.data); }} render={(props) =&gt; ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">form</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onSubmit</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{props.handleSubmit}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">label</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Formik form:</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">label</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">input</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{props.handleChange}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onBlur</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{props.handleBlur}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{props.values.data}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"data"</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> {props.errors.data &amp;&amp; props.touched.data ? ( </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">{props.errors.data}</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> ) : null} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Ok</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">form</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> )} /&gt; </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> );</code> </pre> <br><h3>  Tipp 2. Vermeiden Sie Mutationen </h3><br>  Betrachten Sie eine einfache Aufgabenlistenanwendung.  Im Konstruktor definieren wir im Status die Variable, in der die Aufgabenliste gespeichert wird.  Zeigen Sie in der Methode render () das Formular an, mit dem wir der Liste F√§lle hinzuf√ºgen.  √úberlegen Sie nun, wie wir den Zustand √§ndern k√∂nnen. <br><br>  <b>Falsche Option, die zur Array-Mutation f√ºhrt:</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state.data.push(item);</code> </pre> <br>  In diesem Fall hat sich das Array wirklich ge√§ndert, aber React wei√ü nichts dar√ºber, was bedeutet, dass die render () -Methode nicht aufgerufen wird und unsere √Ñnderungen nicht angezeigt werden.  Tatsache ist, dass in JavaScript beim Erstellen eines neuen Arrays oder Objekts der Link in der Variablen und nicht im Objekt selbst gespeichert wird.  Wenn Sie dem Datenarray ein neues Element hinzuf√ºgen, √§ndern wir das Array selbst, nicht jedoch die Verkn√ºpfung dazu. Dies bedeutet, dass sich der im Status gespeicherte Datenwert nicht √§ndert. <br><br>  Mutationen in JavaScript k√∂nnen auf Schritt und Tritt auftreten.  Um Datenmutationen zu vermeiden, verwenden Sie den Spread-Operator f√ºr Arrays, die filter () - und map () -Methode und f√ºr Objekte den Spread-Operator oder die assign () -Methode. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> newData = [...data, item]; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> copy = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.assign({}, obj);</code> </pre> <br>  Zur√ºck zu unserer Anwendung: Die richtige Option zum √Ñndern des Status ist die Verwendung der Methode setState ().  Versuchen Sie nicht, den Zustand direkt au√üerhalb des Konstruktors zu √§ndern, da dies der React-Ideologie widerspricht. <br><br>  <b>Tu das nicht!</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state.data = [...data, item];</code> </pre> <br>  Vermeiden Sie auch die Zustandsmutation.  Selbst wenn Sie setState () verwenden, k√∂nnen Mutationen beim Optimierungsversuch zu Fehlern f√ºhren.  Wenn Sie beispielsweise ein mutiertes Objekt √ºber Requisiten an eine untergeordnete PureComponent √ºbergeben, kann diese Komponente nicht verstehen, dass sich die empfangenen Requisiten ge√§ndert haben, und wird nicht erneut gerendert. <br><br>  <b>Tu das nicht!</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state.data.push(item); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState({ <span class="hljs-attr"><span class="hljs-attr">data</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state.data });</code> </pre> <br>  <b>Die richtige Option:</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { data } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> newData = [...data, item]; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState({ <span class="hljs-attr"><span class="hljs-attr">data</span></span>: newData });</code> </pre> <br>  Aber selbst die obige Option kann zu subtilen Fehlern f√ºhren.  Tatsache ist, dass niemand garantiert, dass sich der Zustand selbst w√§hrend der Zeit zwischen dem Empfang der Datenvariablen aus dem Status und dem Schreiben ihres neuen Werts in den Status nicht √§ndert.  Auf diese Weise riskieren Sie, einige der vorgenommenen √Ñnderungen zu verlieren.  Wenn Sie daher den Wert einer Variablen im Status mit ihrem vorherigen Wert aktualisieren m√ºssen, gehen Sie wie folgt vor: <br><br>  <b>Die richtige Option, wenn die folgende Bedingung vom aktuellen abh√§ngt:</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {<span class="hljs-attr"><span class="hljs-attr">data</span></span>: [...state.data, item]}; });</code> </pre> <br><h3>  Tipp 3. Emulieren einer mehrseitigen Anwendung </h3><br>  Ihre Anwendung entwickelt sich und irgendwann stellen Sie fest, dass Sie mehrere Seiten ben√∂tigen.  Aber was tun, weil React eine einseitige Anwendung ist?  An diesem Punkt k√∂nnte Ihnen die folgende verr√ºckte Idee in den Sinn kommen.  Sie entscheiden, dass Sie die Kennung der aktuellen Seite im globalen Status Ihrer Anwendung belassen, z. B. mithilfe des Redux-Speichers.  Um die gew√ºnschte Seite anzuzeigen, verwenden Sie das bedingte Rendern und wechseln zwischen den Seiten, wobei Sie die Aktion mit der gew√ºnschten Nutzlast aufrufen und dadurch die Werte im Speicherredux √§ndern. <br><br>  <b>App.js.</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { connect } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'./App.css'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Page1 <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./Page1'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Page2 <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./Page2'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> mapStateToProps = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">page</span></span>: state.page }); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AppCon</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (props.page === <span class="hljs-string"><span class="hljs-string">'Page1'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"App"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Page1</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"App"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Page2</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> App = connect(mapStateToProps)(AppCon); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> App;</code> </pre> <br>  <b>Seite1.js</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { connect } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { setPage } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./redux/actions'</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mapDispatchToProps</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">dispatch</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">setPageHandle</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">page</span></span></span><span class="hljs-function">) =&gt;</span></span> dispatch(setPage(page)), }; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Page1Con</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;&gt; &lt;h3&gt; Page </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params"> &lt;</span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/h3&gt; &lt;input type="button" value="Go to page2" onClick={() =&gt; props.setPageHandle('Page2')} /</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; &lt;</span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/&gt; ); } const Page1 = connect(null, mapDispatchToProps)(Page1Con); export default Page1;</span></span></span></span></span></span></code> </pre> <br>  Warum ist das so schlimm? <br><br><ol><li>  Diese L√∂sung ist ein Beispiel f√ºr ein primitives Fahrrad.  Wenn Sie wissen, wie man ein solches Fahrrad kompetent herstellt und versteht, was Sie wollen, dann kann ich Sie nicht beraten.  Andernfalls ist Ihr Code implizit, verwirrend und √ºberm√§√üig komplex. </li><li>  Sie k√∂nnen die Zur√ºck-Schaltfl√§che im Browser nicht verwenden, da der Verlauf der Besuche nicht gespeichert wird. </li></ol><br>  Wie kann man das l√∂sen? <br><br>  Verwenden Sie einfach den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">React-Router</a> .  Dies ist ein gro√üartiges Paket, mit dem Sie Ihre Anwendung leicht in eine mehrseitige verwandeln k√∂nnen. <br><br><h3>  Tipp 4. Wo k√∂nnen Sie API-Anfragen stellen? </h3><br>  Irgendwann mussten Sie einer externen API in Ihrer Anwendung eine Anfrage hinzuf√ºgen.  Und hier fragen Sie sich: Wo in Ihrer Anwendung m√ºssen Sie die Anforderung ausf√ºhren? <br>  Im Moment, wenn eine React-Komponente montiert wird, ist ihr Lebenszyklus wie folgt: <br><br><ul><li>  Konstruktor () </li><li>  statisch getDerivedStateFromProps () </li><li>  render () </li><li>  componentDidMount () </li></ul><br>  Lassen Sie uns alle Optionen der Reihe nach analysieren. <br><br>  In der Methode constructor () empfiehlt die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dokumentation</a> nichts anderes als: <br><br><ul><li>  Initialisieren des internen Status durch Zuweisung des this.state-Objekts. </li><li>  Bindungen von Ereignishandlern an eine Instanz. </li></ul><br>  Anrufe an die API sind in dieser Liste nicht enthalten. Fahren wir also fort. <br><br>  Die Methode getDerivedStateFromProps () gem√§√ü der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dokumentation</a> existiert f√ºr seltene Situationen, in denen der Status von √Ñnderungen an Requisiten abh√§ngt.  Wieder nicht unser Fall. <br><br>  Der h√§ufigste Fehler ist der Speicherort des Codes, der API-Anforderungen in der render () -Methode ausf√ºhrt.  Dies f√ºhrt dazu, dass Sie das Ergebnis h√∂chstwahrscheinlich im Status der Komponente speichern, sobald Ihre Anforderung erfolgreich ausgef√ºhrt wurde, und dies f√ºhrt zu einem neuen Aufruf der render () -Methode, in der Ihre Anforderung an die API erneut ausgef√ºhrt wird.  Auf diese Weise wird Ihre Komponente endlos gerendert, und dies ist eindeutig nicht das, was Sie ben√∂tigen. <br><br>  Die componentDidMount () -Methode ist daher der ideale Ort, um auf die externe API zuzugreifen. <br><br><h3>  Fazit </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Codebeispiele</a> finden Sie auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">github</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de468799/">https://habr.com/ru/post/de468799/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de468781/index.html">Mit komplexen Zahlen spielen</a></li>
<li><a href="../de468785/index.html">Intel Stratix 10 DX vervollst√§ndigt die Stratix 10 FPGA-Linie</a></li>
<li><a href="../de468789/index.html">2. Typische Anwendungsf√§lle f√ºr Check Point Maestro</a></li>
<li><a href="../de468793/index.html">Wir besch√§ftigen uns mit der Kryptow√§hrungswaage. Details</a></li>
<li><a href="../de468797/index.html">Brennweite des Auges. Was ist das? (Aktualisiert)</a></li>
<li><a href="../de468803/index.html">Wie wir unsere Workflow-Engine hergestellt haben</a></li>
<li><a href="../de468805/index.html">System.Console, Mono und NCurses</a></li>
<li><a href="../de468811/index.html">Technologien Yandex Turbo Pages und Google AMP f√ºr den E-Commerce</a></li>
<li><a href="../de468817/index.html">Kryptografische Workstation basierend auf Public-Key-Standards. Stellen Sie SSL-Zertifikate aus. Nachwort</a></li>
<li><a href="../de468819/index.html">Offenlegung der Telegrammnummer v.2 - Social Engineering</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>