<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèº‚Äçü§ù‚Äçüë©üèª üôÇ ‚öúÔ∏è D√™ algum espa√ßo ou um microcontrolador como um medidor de frequ√™ncia ü§≤üèø üïØÔ∏è üö∂üèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Todo mundo sabe sobre sistemas de coordenadas por sat√©lite. Eles tamb√©m informam a velocidade e a hora atual. Com base nesses sistemas, servidores de ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>D√™ algum espa√ßo ou um microcontrolador como um medidor de frequ√™ncia</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/476442/"><p>  Todo mundo sabe sobre sistemas de coordenadas por sat√©lite.  Eles tamb√©m informam a velocidade e a hora atual.  Com base nesses sistemas, servidores de hora exata s√£o constru√≠dos, que j√° foram mencionados muitas vezes aqui, e n√£o apenas aqui.  A precis√£o desses sistemas est√° aumentando, o pre√ßo est√° caindo, enfim, o progresso n√£o est√° parado.  Parece que recentemente era uma quest√£o de milissegundos e agora os microssegundos n√£o surpreendem ningu√©m.  E o dia n√£o est√° longe quando ... </p><br><p>  Honestamente, este dia j√° chegou para mim.  H√° pouco tempo, deparei-me com a informa√ß√£o de que um dos fabricantes de seus m√≥dulos promete uma precis√£o do intervalo do sinal de sa√≠da do PPS da ordem de dezenas de nanossegundos. </p><br><p>  Em outras palavras, um segundo padr√£o apareceu com uma precis√£o muito decente.  √â verdade que nem sempre est√° √† m√£o e geralmente depende de circunst√¢ncias externas, mas voc√™ pode obter condi√ß√µes favor√°veis ‚Äã‚Äãe obt√™-lo.  E, o mais importante, como se copiar. </p><br><p>  Apenas no caso, observei como est√£o as coisas com outros fabricantes de produtos similares e descobri as mesmas especifica√ß√µes t√©cnicas.  "Tend√™ncia, no entanto", um pensamento passou pela minha mente, aproximadamente, como o de Shtirlits.  Era necess√°rio fazer alguma coisa. </p><a name="habracut"></a><br><p>  Aqueles leitores que sabem como soldar um resistor de uma placa de circuito impresso ou como soldar um microcircuito e at√© sabem como faz√™-lo, concordam mentalmente comigo que ter um medidor de frequ√™ncia que garanta precis√£o de 7 a 8 d√≠gitos em casa nunca ser√° prejudicial.  Especialmente se ocupar pouco espa√ßo e voc√™ n√£o precisar emprestar muito dinheiro para compr√°-lo.  E aqueles que n√£o gostam de parar de pensar podem pensar em um rel√≥gio que √© confundido por alguns segundos por ano (no s√©timo d√≠gito, Clara).  Os f√£s de radiocomunica√ß√£o amadora provavelmente lembrar√£o o design de um bom filtro caseiro de banda estreita em ressonadores de quartzo. </p><br><p>  A primeira coisa a fazer foi encontrar o hardware certo.  Gostei da placa de avalia√ß√£o simples com um pequeno m√≥dulo Teseo-LIV3F de uma empresa conhecida.  Abaixo est√° como ela √©. </p><br><p><img src="https://habrastorage.org/webt/js/mx/_d/jsmx_d6f5hgvdwnobhpcrubjc5s.jpeg"></p><br><p>  Essa coisa √© vendida com uma antena ativa remota, que pode ser instalada mais pr√≥xima da janela para que os sat√©lites possam "ver" bem.  Jumpers s√£o colocados no quadro, conforme necess√°rio, para contarmos mais hist√≥rias e ter uma programa√ß√£o bem-sucedida.  A foto tamb√©m cont√©m melhorias nos circuitos na forma de um √∫nico diodo com boa velocidade. </p><br><p>  O esquema de melhorias ser√° mostrado abaixo.  O fabricante desde que esta placa possa ser inserida em uma placa de avalia√ß√£o Nucleo adequada com um microcontrolador a bordo (na verdade, esses s√£o conectores para o Arduino, mas n√£o quero deixar com 32 bits).  Na descri√ß√£o do m√≥dulo GPS / GNSS, encontrei o seguinte. </p><br><p><img src="https://habrastorage.org/webt/pp/a0/vw/ppa0vwykeian3mxsratvkynlzuk.jpeg"></p><br><p>  Isso √© muito bom e pode servir como uma primeira aproxima√ß√£o a um bom contador de frequ√™ncia.  Agora tenho um segundo intervalo muito preciso e posso calcular a frequ√™ncia das oscila√ß√µes, por exemplo, do meu pr√≥prio oscilador de cristal controlado termostaticamente.  E at√©, talvez, ajust√°-lo na dire√ß√£o necess√°ria para si.  Provavelmente ser√° mais tarde.  Enquanto isso, eu queria medir as frequ√™ncias dos ressonadores de quartzo acumulados na economia. </p><br><p>  Uma placa da s√©rie Nucleo adequada √© constru√≠da sobre o STM32L476RG.  Ele vem sem um ressonador de quartzo (o rel√≥gio n√£o conta).  Abaixo da foto mostra as setas onde os elementos ausentes tiveram que ser soldados. </p><br><p><img src="https://habrastorage.org/webt/rh/0t/ly/rh0tlyerkgwb9rkg1rugucmereq.jpeg"></p><br><p>  Esta op√ß√£o de placa √© selecionada por tr√™s raz√µes.  Primeiro, o gerador de microcontrolador com um ressonador externo opera de 4 a 48 MHz.  Nem todas as placas de microcontrolador Nucleo t√™m essas toler√¢ncias.  Executaremos este gerador com nosso quartzo.  Segundo, a porta serial (UART) pode ser gerada com clock de um gerador RC interno separado com precis√£o de 1% a uma frequ√™ncia de 16 MHz.  Portanto, n√£o ser√° necess√°rio alterar as configura√ß√µes e os divisores na configura√ß√£o UART com uma altera√ß√£o na frequ√™ncia do gerador externo.  E o mais importante, √© fornecido um local para montagem na parede para o ressonador de quartzo, onde voc√™ pode instalar os conectores para n√£o soldar o pr√≥ximo ressonador de cada vez. </p><br><p>  A porta serial j√° est√° conectada √† porta USB virtual no depurador integrado.  Ent√£o voc√™ pode usar o emulador de terminal para exibir informa√ß√µes.  Depois de finalizar e instalar duas sucatas para o quartzo do conector da pin√ßa, a placa fica da seguinte maneira. </p><br><p><img src="https://habrastorage.org/webt/vp/xz/fj/vpxzfj8nws3p7jg5vb4egg_i4_w.jpeg"></p><br><p>  Agora precisamos iniciar o cron√¥metro por exatamente um segundo e ele contar√° os pulsos do rel√≥gio do sistema, ou seja, a frequ√™ncia do nosso ressonador de quartzo.  Felizmente, o temporizador fornece um modo no qual √© redefinido simultaneamente e inicia a partir da borda ascendente do pulso externo. </p><br><p>  Eu imediatamente quis fazer isso para n√£o fazer a m√©dia de alguns segundos de medi√ß√µes, mas para medir a frequ√™ncia em dez segundos, ou seja, com mais precis√£o.  Para isso, era necess√°rio adicionar um diodo ao circuito e apoiar essa ideia programaticamente.  O refinamento do circuito √© mostrado abaixo. </p><br><p><img src="https://habrastorage.org/webt/rn/ln/ob/rnlnobsocqde8ehl8e7s5n1unfc.jpeg"></p><br><p>  Os diagramas a seguir mostram como fazer um intervalo de dez segundos a partir de um segundo. </p><br><p><img src="https://habrastorage.org/webt/bf/5b/hr/bf5bhrse2teowwv6h2gu53yugs0.jpeg"></p><br><p>  O sinal PPS √© fornecido ao temporizador atrav√©s de um diodo e diretamente √† entrada de interrup√ß√£o externa adicional.  Na interrup√ß√£o do timer, √© permitida uma interrup√ß√£o externa que, contando at√© dez, se pro√≠be e altera o resistor de pull-up de cima para baixo. </p><br><p>  As setas vermelhas indicam os momentos da opera√ß√£o de interrup√ß√£o do timer e o verde indica os momentos do in√≠cio da interrup√ß√£o externa, segundo os quais os segundos intervalos necess√°rios s√£o considerados.  Azul mostra resistores de pull-up on-off.  O projeto foi feito no IAR e voc√™ pode v√™-lo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> .  A foto abaixo mostra o resultado do programa do controlador em conjunto com o emulador de terminal, que mostra o estado estacion√°rio. </p><br><p><img src="https://habrastorage.org/webt/5p/o1/lt/5po1ltzl4lnatggoioblytygzt8.jpeg"></p><br><p>  Para ver o gr√°fico, e n√£o as linhas secas dos valores de frequ√™ncia, tive que compor um pequeno utilit√°rio para o Windows.  Sua carca√ßa est√° no mesmo local que o projeto do firmware. </p><br><p>  Todas as experi√™ncias foram realizadas de acordo com o mesmo cen√°rio.  Antes das medi√ß√µes, o quadro era deixado por quinze a vinte minutos na geladeira, onde ficava um pouco abaixo de zero.  Em seguida, foi naturalmente aquecido √† temperatura ambiente por meia hora.  Em seguida, o painel e o ressonador receberam ar quente do secador por v√°rios minutos (aqui as mesmas condi√ß√µes n√£o funcionaram). </p><br><p>  Bons ressonadores se comportaram bem, isto √©, de acordo com a depend√™ncia da temperatura do corte AT do cristal.  Esses gr√°ficos (ou v√°rias c√≥pias?) S√£o f√°ceis de encontrar na rede.  Os resultados das medi√ß√µes de tr√™s ressonadores a 16 MHz s√£o mostrados abaixo. </p><br><p><img src="https://habrastorage.org/webt/a8/av/js/a8avjsmwtvw7psub1ch9c2ncxbq.jpeg"></p><br><p>  Depois, descobriu-se que h√° exce√ß√µes √† imagem usual do comportamento.  Os dados abaixo mostram dois cristais de quartzo do mesmo tipo e, provavelmente, da mesma origem, que se comportaram de maneira diferente. </p><br><p><img src="https://habrastorage.org/webt/x-/tl/ff/x-tlffruiqyfvtw8gbjersttc68.jpeg"></p><br><p>  No ressonador, que se comporta como de costume, eu apenas respirei um pouco, e o segundo decidiu aquecer mais, porque se mostrava diferente.  Qu√£o f√°cil √© ver a depend√™ncia de temperatura dele ou mudar, ou apenas outra. </p><br><p>  Outra observa√ß√£o interessante.  Ap√≥s a exposi√ß√£o √† temperatura, o ressonador n√£o retorna aos valores de frequ√™ncia anteriores ou n√£o tive paci√™ncia para esperar.  De qualquer forma, n√£o importa se voc√™ n√£o se importa com os sinais ap√≥s o sexto. </p><br><p>  Aqui est√° outra observa√ß√£o.  Este √© o mesmo ressonador, que teve que ser medido duas vezes, porque causou surpresa.  Ainda n√£o encontrei uma explica√ß√£o para esse comportamento e ainda n√£o consegui. </p><br><p><img src="https://habrastorage.org/webt/bd/av/1y/bdav1ynmfs4o1ebtqabyvtabhw4.jpeg"></p><br><p>  Seria √∫til remover a depend√™ncia da temperatura individual da frequ√™ncia para um ressonador individual.  Em seguida, voc√™ pode criar um gerador altamente est√°vel de segundos intervalos, usando um bom sensor de temperatura e conhecendo a curva de temperatura do ressonador.  No entanto, isso j√° exigir√° uma c√¢mara de calor.  Gostaria de saber quais sensores de temperatura podem ser considerados bons hoje? </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt476442/">https://habr.com/ru/post/pt476442/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt476424/index.html">Estruturas - mais desvantagens do que vantagens</a></li>
<li><a href="../pt476428/index.html">Nginx VTS Stats, Mockify - API mock, compara√ß√£o Wiremock e Mockify</a></li>
<li><a href="../pt476430/index.html">Como criar o portf√≥lio t√©cnico perfeito</a></li>
<li><a href="../pt476434/index.html">Escrevemos drivers USB para dispositivos abandonados</a></li>
<li><a href="../pt476436/index.html">Relat√≥rios da primeira reuni√£o na R√∫ssia de desenvolvedores de rob√¥s no sistema operacional do rob√¥</a></li>
<li><a href="../pt476444/index.html">Desmistifica√ß√£o dos princ√≠pios da computa√ß√£o qu√¢ntica</a></li>
<li><a href="../pt476446/index.html">Jira Plugins: alguns exemplos da inven√ß√£o bem sucedida da bicicleta</a></li>
<li><a href="../pt476448/index.html">Explora√ß√£o do shader de areia do jogo Journey</a></li>
<li><a href="../pt476450/index.html">Vis√£o geral do cPanel - um console baseado na Web para gerenciar sites e hospedagem</a></li>
<li><a href="../pt476452/index.html">Armazenamento de valor-chave ou como nossos aplicativos se tornaram mais convenientes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>