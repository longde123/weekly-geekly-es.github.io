<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏼‍🤝‍👩🏻 🙂 ⚜️ Dê algum espaço ou um microcontrolador como um medidor de frequência 🤲🏿 🕯️ 🚶🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Todo mundo sabe sobre sistemas de coordenadas por satélite. Eles também informam a velocidade e a hora atual. Com base nesses sistemas, servidores de ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Dê algum espaço ou um microcontrolador como um medidor de frequência</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/476442/"><p>  Todo mundo sabe sobre sistemas de coordenadas por satélite.  Eles também informam a velocidade e a hora atual.  Com base nesses sistemas, servidores de hora exata são construídos, que já foram mencionados muitas vezes aqui, e não apenas aqui.  A precisão desses sistemas está aumentando, o preço está caindo, enfim, o progresso não está parado.  Parece que recentemente era uma questão de milissegundos e agora os microssegundos não surpreendem ninguém.  E o dia não está longe quando ... </p><br><p>  Honestamente, este dia já chegou para mim.  Há pouco tempo, deparei-me com a informação de que um dos fabricantes de seus módulos promete uma precisão do intervalo do sinal de saída do PPS da ordem de dezenas de nanossegundos. </p><br><p>  Em outras palavras, um segundo padrão apareceu com uma precisão muito decente.  É verdade que nem sempre está à mão e geralmente depende de circunstâncias externas, mas você pode obter condições favoráveis ​​e obtê-lo.  E, o mais importante, como se copiar. </p><br><p>  Apenas no caso, observei como estão as coisas com outros fabricantes de produtos similares e descobri as mesmas especificações técnicas.  "Tendência, no entanto", um pensamento passou pela minha mente, aproximadamente, como o de Shtirlits.  Era necessário fazer alguma coisa. </p><a name="habracut"></a><br><p>  Aqueles leitores que sabem como soldar um resistor de uma placa de circuito impresso ou como soldar um microcircuito e até sabem como fazê-lo, concordam mentalmente comigo que ter um medidor de frequência que garanta precisão de 7 a 8 dígitos em casa nunca será prejudicial.  Especialmente se ocupar pouco espaço e você não precisar emprestar muito dinheiro para comprá-lo.  E aqueles que não gostam de parar de pensar podem pensar em um relógio que é confundido por alguns segundos por ano (no sétimo dígito, Clara).  Os fãs de radiocomunicação amadora provavelmente lembrarão o design de um bom filtro caseiro de banda estreita em ressonadores de quartzo. </p><br><p>  A primeira coisa a fazer foi encontrar o hardware certo.  Gostei da placa de avaliação simples com um pequeno módulo Teseo-LIV3F de uma empresa conhecida.  Abaixo está como ela é. </p><br><p><img src="https://habrastorage.org/webt/js/mx/_d/jsmx_d6f5hgvdwnobhpcrubjc5s.jpeg"></p><br><p>  Essa coisa é vendida com uma antena ativa remota, que pode ser instalada mais próxima da janela para que os satélites possam "ver" bem.  Jumpers são colocados no quadro, conforme necessário, para contarmos mais histórias e ter uma programação bem-sucedida.  A foto também contém melhorias nos circuitos na forma de um único diodo com boa velocidade. </p><br><p>  O esquema de melhorias será mostrado abaixo.  O fabricante desde que esta placa possa ser inserida em uma placa de avaliação Nucleo adequada com um microcontrolador a bordo (na verdade, esses são conectores para o Arduino, mas não quero deixar com 32 bits).  Na descrição do módulo GPS / GNSS, encontrei o seguinte. </p><br><p><img src="https://habrastorage.org/webt/pp/a0/vw/ppa0vwykeian3mxsratvkynlzuk.jpeg"></p><br><p>  Isso é muito bom e pode servir como uma primeira aproximação a um bom contador de frequência.  Agora tenho um segundo intervalo muito preciso e posso calcular a frequência das oscilações, por exemplo, do meu próprio oscilador de cristal controlado termostaticamente.  E até, talvez, ajustá-lo na direção necessária para si.  Provavelmente será mais tarde.  Enquanto isso, eu queria medir as frequências dos ressonadores de quartzo acumulados na economia. </p><br><p>  Uma placa da série Nucleo adequada é construída sobre o STM32L476RG.  Ele vem sem um ressonador de quartzo (o relógio não conta).  Abaixo da foto mostra as setas onde os elementos ausentes tiveram que ser soldados. </p><br><p><img src="https://habrastorage.org/webt/rh/0t/ly/rh0tlyerkgwb9rkg1rugucmereq.jpeg"></p><br><p>  Esta opção de placa é selecionada por três razões.  Primeiro, o gerador de microcontrolador com um ressonador externo opera de 4 a 48 MHz.  Nem todas as placas de microcontrolador Nucleo têm essas tolerâncias.  Executaremos este gerador com nosso quartzo.  Segundo, a porta serial (UART) pode ser gerada com clock de um gerador RC interno separado com precisão de 1% a uma frequência de 16 MHz.  Portanto, não será necessário alterar as configurações e os divisores na configuração UART com uma alteração na frequência do gerador externo.  E o mais importante, é fornecido um local para montagem na parede para o ressonador de quartzo, onde você pode instalar os conectores para não soldar o próximo ressonador de cada vez. </p><br><p>  A porta serial já está conectada à porta USB virtual no depurador integrado.  Então você pode usar o emulador de terminal para exibir informações.  Depois de finalizar e instalar duas sucatas para o quartzo do conector da pinça, a placa fica da seguinte maneira. </p><br><p><img src="https://habrastorage.org/webt/vp/xz/fj/vpxzfj8nws3p7jg5vb4egg_i4_w.jpeg"></p><br><p>  Agora precisamos iniciar o cronômetro por exatamente um segundo e ele contará os pulsos do relógio do sistema, ou seja, a frequência do nosso ressonador de quartzo.  Felizmente, o temporizador fornece um modo no qual é redefinido simultaneamente e inicia a partir da borda ascendente do pulso externo. </p><br><p>  Eu imediatamente quis fazer isso para não fazer a média de alguns segundos de medições, mas para medir a frequência em dez segundos, ou seja, com mais precisão.  Para isso, era necessário adicionar um diodo ao circuito e apoiar essa ideia programaticamente.  O refinamento do circuito é mostrado abaixo. </p><br><p><img src="https://habrastorage.org/webt/rn/ln/ob/rnlnobsocqde8ehl8e7s5n1unfc.jpeg"></p><br><p>  Os diagramas a seguir mostram como fazer um intervalo de dez segundos a partir de um segundo. </p><br><p><img src="https://habrastorage.org/webt/bf/5b/hr/bf5bhrse2teowwv6h2gu53yugs0.jpeg"></p><br><p>  O sinal PPS é fornecido ao temporizador através de um diodo e diretamente à entrada de interrupção externa adicional.  Na interrupção do timer, é permitida uma interrupção externa que, contando até dez, se proíbe e altera o resistor de pull-up de cima para baixo. </p><br><p>  As setas vermelhas indicam os momentos da operação de interrupção do timer e o verde indica os momentos do início da interrupção externa, segundo os quais os segundos intervalos necessários são considerados.  Azul mostra resistores de pull-up on-off.  O projeto foi feito no IAR e você pode vê-lo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> .  A foto abaixo mostra o resultado do programa do controlador em conjunto com o emulador de terminal, que mostra o estado estacionário. </p><br><p><img src="https://habrastorage.org/webt/5p/o1/lt/5po1ltzl4lnatggoioblytygzt8.jpeg"></p><br><p>  Para ver o gráfico, e não as linhas secas dos valores de frequência, tive que compor um pequeno utilitário para o Windows.  Sua carcaça está no mesmo local que o projeto do firmware. </p><br><p>  Todas as experiências foram realizadas de acordo com o mesmo cenário.  Antes das medições, o quadro era deixado por quinze a vinte minutos na geladeira, onde ficava um pouco abaixo de zero.  Em seguida, foi naturalmente aquecido à temperatura ambiente por meia hora.  Em seguida, o painel e o ressonador receberam ar quente do secador por vários minutos (aqui as mesmas condições não funcionaram). </p><br><p>  Bons ressonadores se comportaram bem, isto é, de acordo com a dependência da temperatura do corte AT do cristal.  Esses gráficos (ou várias cópias?) São fáceis de encontrar na rede.  Os resultados das medições de três ressonadores a 16 MHz são mostrados abaixo. </p><br><p><img src="https://habrastorage.org/webt/a8/av/js/a8avjsmwtvw7psub1ch9c2ncxbq.jpeg"></p><br><p>  Depois, descobriu-se que há exceções à imagem usual do comportamento.  Os dados abaixo mostram dois cristais de quartzo do mesmo tipo e, provavelmente, da mesma origem, que se comportaram de maneira diferente. </p><br><p><img src="https://habrastorage.org/webt/x-/tl/ff/x-tlffruiqyfvtw8gbjersttc68.jpeg"></p><br><p>  No ressonador, que se comporta como de costume, eu apenas respirei um pouco, e o segundo decidiu aquecer mais, porque se mostrava diferente.  Quão fácil é ver a dependência de temperatura dele ou mudar, ou apenas outra. </p><br><p>  Outra observação interessante.  Após a exposição à temperatura, o ressonador não retorna aos valores de frequência anteriores ou não tive paciência para esperar.  De qualquer forma, não importa se você não se importa com os sinais após o sexto. </p><br><p>  Aqui está outra observação.  Este é o mesmo ressonador, que teve que ser medido duas vezes, porque causou surpresa.  Ainda não encontrei uma explicação para esse comportamento e ainda não consegui. </p><br><p><img src="https://habrastorage.org/webt/bd/av/1y/bdav1ynmfs4o1ebtqabyvtabhw4.jpeg"></p><br><p>  Seria útil remover a dependência da temperatura individual da frequência para um ressonador individual.  Em seguida, você pode criar um gerador altamente estável de segundos intervalos, usando um bom sensor de temperatura e conhecendo a curva de temperatura do ressonador.  No entanto, isso já exigirá uma câmara de calor.  Gostaria de saber quais sensores de temperatura podem ser considerados bons hoje? </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt476442/">https://habr.com/ru/post/pt476442/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt476424/index.html">Estruturas - mais desvantagens do que vantagens</a></li>
<li><a href="../pt476428/index.html">Nginx VTS Stats, Mockify - API mock, comparação Wiremock e Mockify</a></li>
<li><a href="../pt476430/index.html">Como criar o portfólio técnico perfeito</a></li>
<li><a href="../pt476434/index.html">Escrevemos drivers USB para dispositivos abandonados</a></li>
<li><a href="../pt476436/index.html">Relatórios da primeira reunião na Rússia de desenvolvedores de robôs no sistema operacional do robô</a></li>
<li><a href="../pt476444/index.html">Desmistificação dos princípios da computação quântica</a></li>
<li><a href="../pt476446/index.html">Jira Plugins: alguns exemplos da invenção bem sucedida da bicicleta</a></li>
<li><a href="../pt476448/index.html">Exploração do shader de areia do jogo Journey</a></li>
<li><a href="../pt476450/index.html">Visão geral do cPanel - um console baseado na Web para gerenciar sites e hospedagem</a></li>
<li><a href="../pt476452/index.html">Armazenamento de valor-chave ou como nossos aplicativos se tornaram mais convenientes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>