<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üì° üïû üè† Caracter√≠sticas de configuraci√≥n del conmutador ExtremeXOS üë®‚Äçüè´ ‚õπüèø üõÄüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Este art√≠culo tiene como objetivo reducir la cantidad de tiempo necesario para comprender los principios de trabajar con ExtremeXOS (XOS) . Cuando com...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Caracter√≠sticas de configuraci√≥n del conmutador ExtremeXOS</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/419965/"><p>  Este art√≠culo tiene como objetivo reducir la cantidad de tiempo necesario para comprender los principios de trabajar con <strong>ExtremeXOS (XOS)</strong> .  Cuando comenc√© a conocer XOS, realmente me faltaba un art√≠culo sobre Habr√©. </p><br><p>  A continuaci√≥n hablar√© sobre la configuraci√≥n de Extremes y los problemas que encontr√©.  Espero que ayude a los ingenieros de redes que reci√©n comienzan a trabajar con XOS.  Independientemente del modelo de conmutador, la sintaxis de la CLI es exactamente la misma. <br><br></p><br><p><img src="https://habrastorage.org/webt/jy/kh/yn/jykhynsiykae3nk7qvyy-3chk-w.jpeg" alt="KDPV"><br>  <em>Soporte de interruptor extremo</em> </p><a name="habracut"></a><br><h2>  A los negocios </h2><br><p>  Para la virtualizaci√≥n de hardware, uso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Eve-Ng</a> y una imagen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Virtual ExtremeOS ( <u>XOS</u> )</a> .  Tambi√©n puedes usar GNS3. </p><br><p> ¬øC√≥mo se ve la configuraci√≥n del interruptor? En <abbr title="SO extremo">XOS</abbr> no hay necesidad de cambiar los modos operativos, todos los comandos se ingresan desde el modo normal, marcado con <strong>#</strong> en el caso de la cuenta de administrador;  y <strong>&gt;</strong> en caso de usuario. <br>  Para empezar, me gustar√≠a describir los principios "b√°sicos" de los equipos en EOS.  Todo se basa en tres comandos y sus ant√≥nimos: <strong>crear</strong> , <strong>configurar</strong> , <strong>habilitar</strong> ( <strong>eliminar</strong> , <strong>desconfigurar</strong> , <strong>deshabilitar,</strong> respectivamente).  Es decir: creamos, configuramos, activamos.  Se ve l√≥gico. </p><br><pre><code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">create</span></span> vlan <span class="hljs-number"><span class="hljs-number">10</span></span> configure vlan <span class="hljs-number"><span class="hljs-number">10</span></span> ipaddress <span class="hljs-number"><span class="hljs-number">192.168.1.1</span></span>/<span class="hljs-number"><span class="hljs-number">24</span></span></code> </pre> <br><p>  Tambi√©n debe entenderse que la mayor√≠a de las configuraciones se configuran en una <strong>VLAN</strong> .  Es decir, en XOS, casi todo est√° vinculado a las VLAN.  Incluso la asignaci√≥n de VLAN a un puerto ocurre en la configuraci√≥n de VLAN, es decir, el puerto est√° bloqueado en el vlan. <br>  Me gustar√≠a prestar especial atenci√≥n a los enrutadores virtuales ( <em>VR</em> ), que est√°n por defecto en el conmutador.  Hay VR-Default, que posee todos los puertos, y VR-mgmt, que posee mgmt.  puerto  En XOS, para todos los comandos que env√≠an tr√°fico a alg√∫n lugar (ping, ssh, telnet, descarga, etc.), debe especificar VR. </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">ping</span></span> vr <span class="hljs-string"><span class="hljs-string">"VR-Default"</span></span> <span class="hljs-number"><span class="hljs-number">192.168.1.1</span></span></code> </pre> <br><h2>  Actualizaci√≥n del interruptor XOS </h2><br><p>  XOS tiene dos particiones en el sistema operativo: primaria y secundaria.  Funcionalmente, no difieren en nada, solo en nombres.  Puede instalar actualizaciones solo en la secci√≥n actualmente inactiva.  Puede usar el argumento inactivo para esto.  Despu√©s de la actualizaci√≥n, se requiere reiniciar y el conmutador se inicia desde otra partici√≥n (reci√©n actualizada).  Esto permite retroceder r√°pidamente, en caso de problemas, simplemente eligiendo una partici√≥n diferente en el arranque (aquella en la que se dej√≥ el sistema operativo anterior).  Tambi√©n noto que todas las im√°genes con parches representan una imagen completa, es decir, no necesita poner la versi√≥n principal, y luego algunas menores.  Al descargar, se usa tftp: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">download</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">image</span></span> 192<span class="hljs-selector-class"><span class="hljs-selector-class">.168</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">summitX-21</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.4</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.4-patch1-3</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xos</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">vr</span></span> "<span class="hljs-selector-tag"><span class="hljs-selector-tag">VR-Default</span></span>" <span class="hljs-selector-tag"><span class="hljs-selector-tag">inactive</span></span></code> </pre> <br><p>  Para averiguar qu√© secci√≥n est√° actualmente en uso, use: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">show</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">system</span></span> ‚Ä¶ <span class="hljs-selector-tag"><span class="hljs-selector-tag">Image</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Selected</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">primary</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Image</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Booted</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">secondary</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Primary</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ver</span></span>: 22<span class="hljs-selector-class"><span class="hljs-selector-class">.3</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.4</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Secondary</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ver</span></span>: 21<span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.4</span></span></code> </pre> <br><h2>  Cambiar apilamiento </h2><br><p>  Para apilar conmutadores XOS, debe habilitar el soporte de apilamiento y reiniciar el conmutador: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> stacking-support reboot</code> </pre> <br><p>  Es muy conveniente que los interruptores de diferentes modelos se puedan combinar en una pila, mientras que el interruptor con el rendimiento m√°s alto ser√° el maestro.  Por ejemplo, esto puede ser necesario para una pila de conmutadores 10G con 16 puertos para servidores, a los que se agrega un conmutador 1G de 48 puertos, que incluye mgmt.interfaces. <br>  Para apilar, los switches deben tener la misma versi√≥n del sistema operativo.  El apilamiento se realiza a trav√©s de ciertos puertos Ethernet, para cada modelo diferente, que se pueden encontrar en la documentaci√≥n.  Si ensambla los conmutadores de acuerdo con el esquema de puertos 1 en 2, 2 en 1, los conmutadores Extreme se pueden apilar de acuerdo con el procedimiento simplificado de apilamiento f√°cil, que a su vez vincular√° las direcciones mac con el n√∫mero de ranura y otras configuraciones.  En este caso, el primero ser√° el interruptor en el que habilita habilitar el apilamiento, el resto se le asignar√°n n√∫meros a lo largo de la cadena.  Esta es una forma bastante conveniente de ahorrar mucho tiempo.  Despu√©s de apilar, los puertos se ver√°n como SLOT: PORT (1: 1, 2:35). </p><br><pre> <code class="hljs pgsql">X440G2<span class="hljs-number"><span class="hljs-number">-48</span></span>p<span class="hljs-number"><span class="hljs-number">-10</span></span>G4<span class="hljs-number"><span class="hljs-number">.1</span></span> # <span class="hljs-keyword"><span class="hljs-keyword">show</span></span> stacking Stack Topology <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> a Ring This node <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> an Active Topology Node MAC Address Slot Stack State <span class="hljs-keyword"><span class="hljs-keyword">Role</span></span> Flags <span class="hljs-comment"><span class="hljs-comment">------------------ ---- ----------- ------- --- *00:04:96:xx:xx:xx - Disabled Master --- 00:04:96:xx:xx:xx - Disabled Master --- 00:04:96:xx:xx:xx - Disabled Master --- 00:04:96:xx:xx:xx - Disabled Master --- 00:04:96:xx:xx:xx - Disabled Master --- * - Indicates this node Flags: (C) Candidate for this active topology, (A) Active Node (O) node may be in Other active topology X440G2-48p-10G4.2 # enable stacking You have not yet configured all required stacking parameters. Would you like to perform an easy setup for stacking operation? (y/N) Yes Executing "configure stacking easy-setup" command... For every node in the 5-node stack, this command will: - enable stacking - configure a stack MAC address - choose and configure a slot number (this node will be assigned to slot 1) - configure redundancy to minimal (slot 1 will be the master node) - configure the stacking protocol to enhanced Upon completion, the stack will automatically be rebooted into the new configuration. Warning: If stacking is already configured, this command will alter that configuration. Do you wish to proceed? (y/N) Yes Stacking configuration is complete. Rebooting...</span></span></code> </pre> <br><p>  La actualizaci√≥n de la pila es que el maestro se actualiza, y luego √©l mismo vierte la nueva versi√≥n en las ranuras restantes.  <strong>Se requiere reiniciar</strong> . </p><br><h2>  Licencia </h2><br><p>  Cada conmutador viene con una licencia preinstalada (borde, borde avanzado, n√∫cleo, etc.).  Cada licencia tiene su propio conjunto de funciones que se pueden activar en el conmutador, por ejemplo, la cantidad de puertos que se pueden usar en OSPF.  Tambi√©n hay licencias para funciones individuales.  M√°s detalles se pueden leer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br>  Una de las licencias m√°s comunes es la caracter√≠stica: licencia <em>Dual-10GB-Uplink</em> .  Esta licencia para el switch switch-1G permite el uso de 2 puertos de 10 GbE.  Por ejemplo, en el X440-G2-48p. <br>  Las licencias est√°n disponibles en su cuenta personal en el sitio web de Extreme, despu√©s de lo cual son activadas (sin reiniciar) y verificadas por el equipo. </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> license XXXX-XXXX <span class="hljs-keyword"><span class="hljs-keyword">show</span></span> licenses</code> </pre> <br><p>  Si se utilizan diferentes licencias en la pila de conmutadores, se utilizar√° la <u>m√°s peque√±a</u> . </p><br><h2>  Personalizaci√≥n </h2><br><p>  Una peque√±a digresi√≥n: para ver los resultados de los comandos que ser√°n m√°s bajos, as√≠ como cualquier otra informaci√≥n, en la mayor√≠a de los casos puede usar mostrar, reemplazar crear y configurar.  Por ejemplo, muestre vlan. <br>  Sugerencia: Al usar show ports, XOS crear√° una tabla actualizada cada pocos segundos, que permite el monitoreo en tiempo real del estado de las interfaces.  Para obtener resultados sin actualizar, debe usar "show ports no-refresh". <br>  Lo primero que viene a la mente es configurar este <em>nombre de host</em> .  Parecer√≠a ser algo como esto: </p><br><p><del>  configurar el nombre de host Ex_sw_1 </del></p><br><p>  Pero no todo es tan simple, de hecho se hace as√≠: </p><br><pre> <code class="hljs powershell">configure snmp sysName Ex<span class="hljs-literal"><span class="hljs-literal">-sw</span></span><span class="hljs-literal"><span class="hljs-literal">-1</span></span></code> </pre> <br><p>  Crear una VLAN: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> vlan My_Vlan_Five tag <span class="hljs-number"><span class="hljs-number">5</span></span></code> </pre> <br><p>  O as√≠, y as√≠ es exactamente como se mostrar√° en la configuraci√≥n: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> vlan My_Vlan10 configure vlan My_Vlan10 tag <span class="hljs-number"><span class="hljs-number">10</span></span></code> </pre> <br><p>  Teniendo en cuenta la experiencia pr√°ctica y las realidades de la salida de comandos y la configuraci√≥n de XOS, cre√© una regla para m√≠: en el nombre de vlan, agregue su etiqueta al final, lo que facilita la comprensi√≥n y configuraci√≥n: </p><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> vlan <span class="hljs-keyword"><span class="hljs-keyword">users</span></span><span class="hljs-number"><span class="hljs-number">-10</span></span> tag <span class="hljs-number"><span class="hljs-number">10</span></span></code> </pre> <br><p>  XOS no tiene puertos troncales y de acceso per se.  En cambio, se utilizan conceptos: tr√°fico etiquetado y sin etiquetar en una interfaz vinculada a vlan.  Puede haber un vlan sin etiquetar y muchos etiquetados.  Los puertos est√°n numerados en n√∫meros (o ranura: puerto en la pila), todo es muy simple. </p><br><pre> <code class="hljs cs">configure vlan My_Vlan<span class="hljs-number"><span class="hljs-number">-5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> ports <span class="hljs-number"><span class="hljs-number">1</span></span> tagged configure vlan My_Vlan1 <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> ports <span class="hljs-number"><span class="hljs-number">1</span></span> untagged</code> </pre> <br><p>  En consecuencia, todo el tr√°fico sin una etiqueta que llegue a la interfaz se etiquetar√° como " <em>My_Vlan1</em> ". <br>  Al mismo tiempo, vlan puede especificarse tanto a trav√©s de &lt; <em>Nombre</em> &gt; como a trav√©s de &lt; <em>etiqueta</em> &gt;, y en cualquier combinaci√≥n (usando <em>vlan_list</em> , es decir, num√©rico por etiquetas).  Sin un atributo al final, se usa &lt; <em>sin etiquetar</em> &gt;: </p><br><pre> <code class="hljs powershell">onfigure vlan <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span><span class="hljs-literal"><span class="hljs-literal">-10</span></span>,<span class="hljs-number"><span class="hljs-number">15</span></span><span class="hljs-literal"><span class="hljs-literal">-20</span></span> add ports <span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-literal"><span class="hljs-literal">-8</span></span>, <span class="hljs-number"><span class="hljs-number">48</span></span> tagged configure vlan web<span class="hljs-literal"><span class="hljs-literal">-110</span></span> add ports <span class="hljs-number"><span class="hljs-number">5</span></span> onfigure vlan <span class="hljs-number"><span class="hljs-number">20</span></span> add ports <span class="hljs-number"><span class="hljs-number">30</span></span><span class="hljs-literal"><span class="hljs-literal">-40</span></span>,<span class="hljs-number"><span class="hljs-number">45</span></span> untagged</code> </pre> <br><p>  Como la mayor√≠a de los interruptores de la serie SummitX son interruptores <strong>L3</strong> , as√≠ es como se configura SVI: </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">configure</span></span> vlan <span class="hljs-number"><span class="hljs-number">125</span></span> ipaddress <span class="hljs-number"><span class="hljs-number">192.168.125.1</span></span>/<span class="hljs-number"><span class="hljs-number">24</span></span></code> </pre> <br><p>  Despu√©s de eso, debe aplicar este comando, de lo contrario, vlan seguir√° siendo no enrutable: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> ipforwarding vlan <span class="hljs-number"><span class="hljs-number">125</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> ipforwarding vlan <span class="hljs-number"><span class="hljs-number">10</span></span><span class="hljs-number"><span class="hljs-number">-50</span></span>,<span class="hljs-number"><span class="hljs-number">60</span></span></code> </pre> <br><p>  Para ver qu√© vlan hay en la interfaz, puede usar el comando: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">show</span></span> ports <span class="hljs-number"><span class="hljs-number">2</span></span> vlan</code> </pre> <br><p>  Para ver y guardar la configuraci√≥n, se utilizan los siguientes comandos y hay archivos de configuraci√≥n primarios y secundarios: </p><br><pre> <code class="hljs pgsql">save save secondary <span class="hljs-keyword"><span class="hljs-keyword">show</span></span> <span class="hljs-keyword"><span class="hljs-keyword">configuration</span></span></code> </pre> <br><h2>  Agregaci√≥n de enlaces </h2><br><p>  Uno de los momentos <u>inc√≥modos</u> que conoc√≠ es la agregaci√≥n de canales.  (puerto-canal).  El punto general es este: le asigna un puerto maestro y hasta siete interfaces secundarias.  Adem√°s, todas las configuraciones se realizan solo en un puerto maestro espec√≠fico, no hay interfaces l√≥gicas de la forma <em>po1</em> .  La desventaja es que si desea cambiar el puerto maestro, debe transferir manualmente todas las configuraciones a otro puerto, ya que cuando elimina un canal agregado, la configuraci√≥n completa <u>vuela</u> .  Hay una soluci√≥n a este inconveniente en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">este art√≠culo</a> , pero a√∫n no funciona perfectamente.  En XOS, la agregaci√≥n se llama <strong>compartir</strong> . <br>  Para habilitar dicho puerto, debe usar un comando del formulario </p><br><pre> <code class="hljs powershell">enable sharing [<span class="hljs-type"><span class="hljs-type">MASTER_PORT</span></span>] grouping [<span class="hljs-type"><span class="hljs-type">PORT_LIST</span></span>] [<span class="hljs-type"><span class="hljs-type">lacp</span></span>] enable sharing <span class="hljs-number"><span class="hljs-number">1</span></span> grouping <span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-literal"><span class="hljs-literal">-2</span></span> lacp</code> </pre> <br><p>  En la versi√≥n inferior a 22.X, es necesario agregar el algoritmo de "equilibrio": </p><br><pre> <code class="hljs powershell">enable sharing <span class="hljs-number"><span class="hljs-number">1</span></span> grouping <span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-literal"><span class="hljs-literal">-2</span></span> algorithm address<span class="hljs-literal"><span class="hljs-literal">-based</span></span> L2 lacp</code> </pre> <br><h2>  OSI Layer 2 Loop Protection </h2><br><p>  En los conmutadores Summit-X en Do mayor versi√≥n 22.2, el protocolo de protecci√≥n de bucle de segundo nivel estaba <strong><u>deshabilitado</u></strong> de forma predeterminada.  (STP y otros).  Al momento de escribir, el software recomendado por el proveedor es 21.1.5.2. </p><br><h3 id="elrp">  ELRP </h3><br><p>  En uno de mis proyectos, utilic√© el protocolo <abbr title="Protocolo de recuperaci√≥n de bucle extremo">ELRP</abbr> patentado, que est√° dise√±ado para detectar y prevenir bucles.  Durante las pruebas, mostr√≥ buenos resultados (velocidad de cierre del puerto con un bucle, etc.).  Este protocolo env√≠a una <abbr title="Unidad de datos de protocolo">PDU de</abbr> multidifusi√≥n, y si el remitente la recibe nuevamente, entonces hay un bucle. <br>  El intervalo es responsable de la frecuencia de distribuci√≥n de la PDU, en este caso, 2 segundos.  En el caso de un bucle, el puerto se bloquear√° durante 180 segundos, despu√©s de lo cual la PDU se enviar√° nuevamente.  Opciones de alerta: log, trap, log-and-trap.  En el caso de trap, snmp trap se env√≠a en consecuencia. <br>  Este protocolo por vlan est√° configurado, as√≠ como la mayor√≠a de las configuraciones en XOS. </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> elrp-client configure elrp-client periodic Buh<span class="hljs-number"><span class="hljs-number">-123</span></span> ports <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> <span class="hljs-type"><span class="hljs-type">interval</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">log</span></span> <span class="hljs-keyword"><span class="hljs-keyword">disable</span></span>-port ingress duration <span class="hljs-number"><span class="hljs-number">180</span></span></code> </pre> <br><p>  Para evitar que el protocolo ELRP bloquee los enlaces ascendentes de los conmutadores de acceso o las conexiones cr√≠ticas, se utiliza el comando para eliminar los puertos del bloqueo. </p><br><pre> <code class="hljs pgsql">configure elrp-client <span class="hljs-keyword"><span class="hljs-keyword">disable</span></span>-port <span class="hljs-keyword"><span class="hljs-keyword">exclude</span></span> <span class="hljs-number"><span class="hljs-number">35</span></span> configure elrp-client <span class="hljs-keyword"><span class="hljs-keyword">disable</span></span>-port <span class="hljs-keyword"><span class="hljs-keyword">exclude</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br><h3 id="stp">  STP </h3><br><p>  STP est√° configurado un poco m√°s complicado, pero en general no hay problemas especiales.  En XOS, este protocolo se llama "stpd", en todos los comandos para configurar STP, se utiliza.  Puede hacerlo por vlan utilizando diferentes dominios STP.  "Domain-id" y "vlan-id" deben coincidir.  Los puertos en STP se pueden agregar manualmente o usando vlan auto-bind.  Tan pronto como se agrega un puerto a vlan, este puerto se agrega autom√°ticamente a STP.  Tal es la l√≥gica.  Configuraci√≥n del modo: <abbr title="Est√°ndar 802.1d">dot1d</abbr> STP, <abbr title="Est√°ndar 802.1w">dot1w</abbr> - RSTP: </p><br><pre> <code class="hljs pgsql">configure stpd "s0" priority <span class="hljs-number"><span class="hljs-number">4096</span></span> configure stpd s0 mode dot1w <span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> stpd s0 <span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> stpd "s0" auto-bind "VLAN_0005"</code> </pre> <br><h2>  VRRP </h2><br><p>  VRRP es un tipo de <abbr title="Protocolo de redundancia de primer salto">FHRP</abbr> , un an√°logo de HSRP en Cisco.  Para cada red (vlan) es necesario usar un vrid, que puede ser de 1 a 255. Estaba satisfecho con la capacidad de enrutar el tr√°fico desde el switch backup-vrrp-L3 usando la opci√≥n de enrutamiento de estructura.  Por defecto, la prioridad es 100. ¬øCu√°l de los interruptores tiene mayor prioridad? Se convierte en "Maestro". </p><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> vrrp vlan test1 vrid <span class="hljs-number"><span class="hljs-number">125</span></span> configure vrrp vlan test1 vrid <span class="hljs-number"><span class="hljs-number">125</span></span> <span class="hljs-keyword"><span class="hljs-keyword">priority</span></span> <span class="hljs-number"><span class="hljs-number">50</span></span> configure vrrp vlan test1 vrid <span class="hljs-number"><span class="hljs-number">125</span></span> fabric-routing <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> vrrp vlan test1 vrid <span class="hljs-number"><span class="hljs-number">125</span></span></code> </pre> <br><h2>  MLAG </h2><br><p>  Acerca de qu√© es y por qu√©, se describe muy bien <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> : de hecho, es un an√°logo de Cisco VPC.  <abbr title="Conexi√≥n entre interruptores"><strong>ISC</strong></abbr> : conexi√≥n entre conmutadores de par mlag. </p><br><p>  En mi caso, se us√≥ el siguiente esquema: <br><img src="https://habrastorage.org/webt/zc/bu/qf/zcbuqf-hljcoauy1g6tmdlgb0vq.jpeg"></p><br><p>  Es necesario crear un vecino (par) para poder asignar puertos espec√≠ficos con mlag a un vecino espec√≠fico, ya que Extreme admite la capacidad de usar m√∫ltiples vecinos.  Para ISC, necesita un vlan que se use solo para ISC y que tenga una direcci√≥n IP.  En consecuencia, para X670-1 tendremos X670-2, y los puertos mlag ser√°n x440.  Para funcionar, es necesario crear un canal de agregaci√≥n, y en x670 para un puerto hacia x440, y un canal agregado hacia X670-2, en el que <strong>TODOS</strong> los Vlan participar√°n en mlag. <br>  En x670: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Enable</span></span> sharing <span class="hljs-number"><span class="hljs-number">1</span></span> grouping <span class="hljs-number"><span class="hljs-number">1</span></span> lacp <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> mlag peer "mlag1" configure mlag peer "mlag1" ipaddress <span class="hljs-number"><span class="hljs-number">10.255</span></span><span class="hljs-number"><span class="hljs-number">.255</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span> vr VR-<span class="hljs-keyword"><span class="hljs-keyword">Default</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> mlag port <span class="hljs-number"><span class="hljs-number">1</span></span> peer "mlag1" id <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br><p>  En x440-stack: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">enable</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">sharing</span></span> 1<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:51</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">grouping</span></span> 1<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:51</span></span>,2<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:51</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">lacp</span></span></code> </pre> <br><h2>  MLAG + VRRP </h2><br><p>  Durante las pruebas de los cuadros de distribuci√≥n en el stand, se encontr√≥ un problema que VRRP quita el rol de Maestro antes de que se levanten todas las otras interfaces (ISC sube primero) y los protocolos, lo que condujo a un tiempo de inactividad de la red del orden de un minuto. <br>  Este problema se resolvi√≥ con los siguientes comandos, sin embargo, solo est√°n disponibles con "EXOS 21.1.3.7-patch1-4" y "EXOS 22.3": </p><br><pre> <code class="hljs powershell">configure mlag ports reload<span class="hljs-literal"><span class="hljs-literal">-delay</span></span> <span class="hljs-number"><span class="hljs-number">60</span></span> enable mlag port reload<span class="hljs-literal"><span class="hljs-literal">-delay</span></span></code> </pre> <br><h2>  Enrutamiento </h2><br><p>  Las rutas est√°ticas se definen de la siguiente manera, no deber√≠a haber problemas.  Puede configurar la m√°scara en cualquier versi√≥n. </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">configure</span></span> iproute add <span class="hljs-number"><span class="hljs-number">10.0.66.0</span></span> <span class="hljs-number"><span class="hljs-number">255.255.255.0</span></span> <span class="hljs-number"><span class="hljs-number">172.16.1.1</span></span> configure iproute add <span class="hljs-number"><span class="hljs-number">10.0.0.1</span></span>/<span class="hljs-number"><span class="hljs-number">32</span></span> <span class="hljs-number"><span class="hljs-number">10.255.255.255</span></span> configure iproute add default <span class="hljs-number"><span class="hljs-number">172.16.0.1</span></span></code> </pre> <br><h3 id="ospf">  OSPF </h3><br><p>  Para el enrutamiento, en mi pr√°ctica, se utiliz√≥ OSPF con una sola zona.  Para garantizar la operatividad, es necesario establecer una identificaci√≥n de enrutador y tambi√©n agregar cada vlan que deba anunciarse (similar a Cisco: red). </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">configure</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ospf</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">routerid</span></span> 192<span class="hljs-selector-class"><span class="hljs-selector-class">.168</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">enable</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ospf</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">configure</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ospf</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">add</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">vlan</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">routing-5</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">area</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">configure</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ospf</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">add</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">vlan</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Voip-32</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">area</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">passive</span></span></code> </pre> <br><h2>  Otras cositas </h2><br><h3 id="dhcp-relay">  Retransmisi√≥n DHCP </h3><br><p>  Configurado de la siguiente manera: </p><br><pre> <code class="hljs pgsql">configure bootprelay <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.12</span></span><span class="hljs-number"><span class="hljs-number">.5</span></span> vr VR-<span class="hljs-keyword"><span class="hljs-keyword">Default</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> bootprelay ipv4 vlan servers<span class="hljs-number"><span class="hljs-number">-500</span></span></code> </pre> <br><p>  Al crear un nuevo vlan, debe agregarlo manualmente a la lista de vlan con DHCP Relay. </p><br><h3 id="ssh--acl-dlya-ssh">  SSH + ACL para SSH </h3><br><p>  Ssh se habilita de la siguiente manera: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> ssh2</code> </pre> <br><p>  Para limitar el acceso a ssh, debe crear un archivo de pol√≠tica separado del formulario NAME.pol y colgarlo en SSH. </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">vi</span></span> ssh.pol</code> </pre> <br><p>  Pol√≠tica: </p><br><pre> <code class="hljs mel">Entry AllowTheseSubnets { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">match</span></span> any { <span class="hljs-keyword"><span class="hljs-keyword">source</span></span>-address <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> /<span class="hljs-number"><span class="hljs-number">16</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">source</span></span>-address <span class="hljs-number"><span class="hljs-number">10.255</span></span><span class="hljs-number"><span class="hljs-number">.255</span></span><span class="hljs-number"><span class="hljs-number">.34</span></span> /<span class="hljs-number"><span class="hljs-number">32</span></span>; } Then { permit; } }</code> </pre> <br><p>  El comando para aplicar la pol√≠tica: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> ssh2 <span class="hljs-keyword"><span class="hljs-keyword">access</span></span>-profile ssh.pol</code> </pre> <br><h3 id="description--display-string">  Descripci√≥n + cadena de visualizaci√≥n </h3><br><p>  Para facilitar la configuraci√≥n y la operaci√≥n posterior, puede configurar el "nombre" y la "descripci√≥n" de la interfaz. </p><br><pre> <code class="hljs kotlin">onfigure port <span class="hljs-number"><span class="hljs-number">1</span></span> description ‚Äú<span class="hljs-keyword"><span class="hljs-keyword">this</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> port number one‚Äù</code> </pre> <br><p>  La descripci√≥n de la interfaz se mostrar√° solo en comandos de la forma: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">show</span></span> ports description</code> </pre> <br><p>  Un nombre de interfaz reemplazar√° casi en todas partes su n√∫mero en la salida de comandos.  El nombre no debe contener un espacio y est√° limitado a una longitud de 20 caracteres. </p><br><pre> <code class="hljs vhdl">onfigure <span class="hljs-keyword"><span class="hljs-keyword">port</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> display-<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> UserPort EXOS-VM.<span class="hljs-number"><span class="hljs-number">8</span></span> # sh <span class="hljs-keyword"><span class="hljs-keyword">port</span></span> vlan Untagged <span class="hljs-keyword"><span class="hljs-keyword">Port</span></span> /Tagged VLAN Name(s) <span class="hljs-comment"><span class="hljs-comment">-------- -------- ------------------------------------------------------------ UserPort Untagged Default 2 Untagged Default 3 Untagged Default</span></span></code> </pre> <br><h2 id="zaklyuchenie">  Conclusi√≥n </h2><br><p>  <strong>XOS</strong> tambi√©n le permite automatizar muchas acciones y adaptar el sistema a sus necesidades, ya que es compatible de forma nativa con Python y el mecanismo incorporado para crear y ejecutar secuencias de comandos utilizando comandos <em>CLI-Scripting</em> . </p><br><p>  Estoy abierto a sugerencias para mejorar el art√≠culo y corregir imprecisiones / errores, as√≠ como preguntas. </p><br><p>  <strong>UPD</strong> : LLDP para tel√©fonos IP se configura utilizando los comandos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">de este comentario</a> . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es419965/">https://habr.com/ru/post/es419965/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es419951/index.html">Experiencia usando WebRTC. Conferencia de Yandex</a></li>
<li><a href="../es419953/index.html">Estoy escribiendo un libro sobre la primera "nuestra" startup que conquist√≥ el mundo: ayuda</a></li>
<li><a href="../es419955/index.html">Caracter√≠sticas del b√∫fer FIFO UART en ESP32</a></li>
<li><a href="../es419961/index.html">El resumen de materiales interesantes para el desarrollador m√≥vil # 265 (6 de agosto - 12 de agosto)</a></li>
<li><a href="../es419963/index.html">Hacemos un controlador "inteligente" para el aire acondicionado en el ESP8266</a></li>
<li><a href="../es419969/index.html">Ocultamiento en Ruby. Ocultar tambi√©n clases de nivel superior</a></li>
<li><a href="../es419971/index.html">El laboratorio de cohetes repara, expande y acelera</a></li>
<li><a href="../es419973/index.html">Eventos digitales en Mosc√∫ del 13 al 19 de agosto.</a></li>
<li><a href="../es419975/index.html">C√≥mo nos escapamos de Windows corporativo</a></li>
<li><a href="../es419977/index.html">Investigadores: no todos los pilotos autom√°ticos de Nivel 2 funcionan igual de bien, pero el progreso es evidente</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>