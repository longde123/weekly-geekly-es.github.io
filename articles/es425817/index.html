<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üß§ üëäüèª üçΩÔ∏è Arrastra y suelta en tus aplicaciones iOS üßìüèΩ üå≥ üçÆ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="El mecanismo de Drag & Drop que se ejecuta en iOS 11 y iOS 12 es una forma de copiar o mover datos de forma as√≠ncrona de forma gr√°fica tanto en una so...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Arrastra y suelta en tus aplicaciones iOS</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/425817/"><img src="https://habrastorage.org/webt/gb/xu/dt/gbxudtvrfs8biaj5tlzkpjjjwe4.png"><br><br>  El mecanismo de <code>Drag &amp; Drop</code> que se ejecuta en <code>iOS 11</code> y <code>iOS 12</code> es una forma de copiar o mover datos de forma as√≠ncrona de forma gr√°fica tanto en una sola aplicaci√≥n como entre diferentes aplicaciones.  Aunque esta tecnolog√≠a tiene aproximadamente 30 a√±os, se ha convertido literalmente en una tecnolog√≠a "innovadora" en <code>iOS</code> debido al hecho de que al arrastrar algo en <code>iOS</code> , <code>multitouch</code> permite interactuar libremente con el resto del sistema y recopilar datos para restablecer desde diferentes aplicaciones. <br><a name="habracut"></a><br>  <code>iOS</code> hace posible capturar m√∫ltiples elementos a la vez.  Adem√°s, no tienen que estar en una accesibilidad conveniente para la selecci√≥n: puede tomar el primer objeto, luego ir a otra aplicaci√≥n y tomar otra cosa: todos los objetos se recoger√°n en una "pila" debajo de su dedo.  Luego llame al dock universal en la pantalla, abra cualquier aplicaci√≥n all√≠ y capture el tercer objeto, y luego vaya a la pantalla con las aplicaciones ejecut√°ndose y, sin liberar los objetos, volcarlos en uno de los programas abiertos.  Tal libertad de acci√≥n es posible en el <code>iPad</code> , en el <code>iPhone</code> , la cobertura de <code>Drag &amp; Drop</code> en <code>iOS</code> limita al marco de una aplicaci√≥n. <br><br>  Las aplicaciones m√°s populares ( <code>Safary</code> , <code>Chrome</code> , <code>IbisPaint X</code> , <code>Mail</code> , <code>Photos</code> , <code>Files</code> , etc.) ya tienen un mecanismo de <code>Drag &amp; Drop</code> .  Adem√°s de esto, <code>Apple</code> proporcion√≥ a los desarrolladores una <code>API</code> muy simple e intuitiva para integrar el mecanismo de <code>Drag &amp; Drop</code> en su aplicaci√≥n.  El mecanismo de <code>Drag &amp; Drop</code> , al igual que los gestos, funciona en <b><font color="#0000FF">UIView</font></b> y utiliza el concepto de <b><font color="#0000FF">interacciones</font></b> , un poco como los gestos, por lo que puede pensar en el mecanismo de <code>Drag &amp; Drop</code> como un gesto realmente poderoso. <br><br>  Es, adem√°s de gestos, muy f√°cil de integrar en su aplicaci√≥n.  Especialmente si su aplicaci√≥n usa la tabla <b><font color="#0000FF">UITableView</font></b> o la colecci√≥n <b><font color="#0000FF">UICollectionView</font></b> , porque para ellos <code>API Drag &amp; Drop</code> mejora y se eleva a un mayor nivel de abstracci√≥n en el sentido de que la <code>Collection View</code> s√≠ misma lo ayuda con el <b><font color="#0000FF">indexPath</font></b> del elemento de la colecci√≥n que desea arrastrar y soltar <code>Drag</code>  Ella sabe d√≥nde est√° su dedo y lo interpreta como el <b><font color="#0000FF">indexPath</font></b> del elemento de colecci√≥n que est√° "arrastrando" <code>Drag</code> en este momento, o como el <b><font color="#0000FF">indexPath</font></b> del elemento de colecci√≥n donde est√° "soltando" <code>Drop</code> algo.  Por lo tanto, la <code>Collection View</code> colecci√≥n le proporciona <b><font color="#0000FF">indexPath</font></b> , pero de lo contrario es absolutamente la misma <code>API Drag &amp; Drop</code> que para una vista general de <b><font color="#0000FF">UIView</font></b> . <br><br>  El proceso de <code>Drag &amp; Drop</code> en <code>iOS</code> tiene 4 fases diferentes: <br><br><h2>  Ascensor </h2><br>  <b>Levantar</b> (levantar): es cuando el usuario realiza un gesto de <b><font color="#FF00FF">presi√≥n prolongado</font></b> , que indica el elemento que se "arrastrar√° y soltar√°".  En este momento, se forma una llamada " <code>lift preview</code> " muy ligera del elemento indicado, y luego el usuario comienza a arrastrar los dedos. <br><br><img src="https://habrastorage.org/webt/t6/sw/tw/t6swtwdee7kasyvqq_od3ipzlxy.png" width="600" height="450"><br><br><h2>  Arrastrar (arrastrar y soltar) </h2><br>  <b>Arrastrar</b> (arrastrar y soltar): esto es cuando el usuario mueve el objeto en la superficie de la pantalla.  Durante esta fase, se puede modificar la " <code>lift preview</code> " para este objeto (aparece un signo m√°s "+" verde u otro signo) ... <br><br><img src="https://habrastorage.org/webt/07/yo/4x/07yo4x4yua4zelwculog6eng9aw.png" width="600" height="450"><br><br>  ... tambi√©n se permite cierta interacci√≥n con el sistema: puede hacer clic en otro objeto y agregarlo a la sesi√≥n actual de "arrastrar y soltar": <br><br><img src="https://habrastorage.org/webt/yb/bx/wi/ybbxwiqe6-226ipfjmkzmpymkva.png" width="600" height="450"><br><br><h2>  Soltar </h2><br>  <b>La ca√≠da</b> ocurre cuando el usuario levanta un dedo.  En este momento, pueden suceder dos cosas: el objeto <code>Drag</code> se destruir√° o el objeto <code>Drop</code> se "soltar√°" en el destino. <br><br><img src="https://habrastorage.org/webt/iv/b1/4z/ivb14zogie89jntnkfsxmuubvd0.png" width="600" height="450"><br><br><h2>  Transferencia de datos </h2><br>  Si no se cancel√≥ el proceso de Arrastrar " <b>arrastrar</b> y soltar" y se realiz√≥ el restablecimiento de " <b>Soltar</b> ", se produce la <b>Transferencia de</b> datos (transferencia de datos), en la cual el "punto de soltar" solicita datos de la "fuente" y se produce una transferencia de datos asincr√≥nica. <br><br>  En este tutorial, le mostraremos c√≥mo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">integrar</a> f√°cilmente <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">el</a> mecanismo de <code>Drag &amp; Drop</code> en su aplicaci√≥n <code>iOS</code> usando la aplicaci√≥n de demostraci√≥n de la Galer√≠a de im√°genes, tomada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">del curso de tareas CS193P de Stanford</a> . <br>  Dotaremos a la <code>Collection View</code> capacidad de llenarnos con im√°genes EXTERIORES, as√≠ como reorganizar elementos INTERIORES utilizando el mecanismo de <code>Drag &amp; Drop</code> .  Adem√°s, este mecanismo se usar√° para volcar elementos innecesarios de la <code>Collection View</code> en un "bote de basura", que es una vista de <b><font color="#0000FF">UIV</font></b> normal y se representa mediante un bot√≥n en el panel de navegaci√≥n.  Tambi√©n podemos compartir im√°genes recopiladas en nuestra Galer√≠a con otras aplicaciones utilizando el mecanismo de <code>Drag &amp; Drop</code> , por ejemplo, <code>Notes</code> o <code>Notes</code> o <code>Mail</code> o una biblioteca de fotos ( <code>Photo</code> ). <br><br>  Pero antes de centrarme en la implementaci√≥n del mecanismo de <code>Drag &amp; Drop</code> en la aplicaci√≥n de demostraci√≥n "Galer√≠a de im√°genes", examinar√© brevemente sus componentes principales. <br><br><h1>  Caracter√≠sticas de la aplicaci√≥n de demostraci√≥n "Galer√≠a de im√°genes" </h1><br>  La interfaz de usuario ( <code>UI</code> ) de la aplicaci√≥n Galer√≠a de im√°genes es muy simple.  Este es un "fragmento de pantalla" del <code>Image Gallery Collection View Controller</code> de la <code>Image Gallery Collection View Controller</code> insertado en el <code>Navigation Controller</code> : <br><br><img src="https://habrastorage.org/webt/rz/gl/o6/rzglo69owhktzl8vcstcosf5rdi.png"><br><br>  La parte central de la aplicaci√≥n es, sin duda, el <code>Image Gallery Collection View Controller</code> , que es compatible con la clase <b><font color="#0000FF">ImageGalleryCollectionViewController</font></b> con el modelo de galer√≠a de im√°genes como variable <b><font color="#0000FF">var imageGallery = ImageGallery ()</font></b> : <br><br><img src="https://habrastorage.org/webt/na/f2/1r/naf21rpv6pxjnht1bk02mowhgoi.png"><br><br>  El modelo est√° representado por una <b><font color="#0000FF">estructura de</font></b> estructura <b><font color="#0000FF">ImageGallery</font></b> que contiene un conjunto de im√°genes de <b><font color="#0000FF">im√°genes</font></b> , en el que cada imagen se describe mediante una <b><font color="#0000FF">estructura de</font></b> estructura <b><font color="#0000FF">ImageModel</font></b> que contiene la <code>URL</code> ubicaci√≥n <code>URL</code> imagen (no vamos a almacenar la imagen en s√≠) y su relaci√≥n de aspecto: <br><br><img src="https://habrastorage.org/webt/bp/0b/6_/bp0b6_kh3bgocgc4zlnjrocmk2q.png"><br><br>  Nuestra <b><font color="#0000FF">ImageGalleryCollectionViewController</font></b> implementa el protocolo <b><font color="#0000FF">DataSource</font></b> : <br><br><img src="https://habrastorage.org/webt/ka/vr/gj/kavrgjqaraoqv4sva-aqhffwvhu.png"><br><br>  La celda personalizada en la colecci√≥n de celdas contiene una imagen <b><font color="#0000FF">imageView: UIImageView!</font></b>  e indicador de actividad de la <b><font color="#0000FF">ruleta: UIActivityIndicatorView!</font></b>  y es compatible con la <code>subclass</code> personalizada <b><font color="#0000FF">ImageCollectionViewCell de la</font></b> clase <b><font color="#0000FF">UICollectionViewCell</font></b> : <br><br><img src="https://habrastorage.org/webt/cu/hs/1l/cuhs1ljdvbara4u2_ndq3y_sfxw.png"><br><br>  <code>Public API</code> de la clase <b><font color="#0000FF">ImageCollectionViewCell</font></b> es la <b><font color="#0000FF">URL de la</font></b> imagen <b><font color="#0000FF">imageURL</font></b> .  Tan pronto como lo instalamos, nuestra <code>UI</code> actualiza, es decir, los datos de la imagen se seleccionan de forma as√≠ncrona en esta imagen <b><font color="#0000FF">URL</font></b> y se muestran en la celda.  Mientras se recuperan datos de la red, el indicador de actividad de la <b><font color="#0000FF">ruleta</font></b> est√° funcionando, lo que indica que estamos en el proceso de recuperar datos. <br><br>  Utilizo la cola global <b><font color="#0000FF">(qos: .userInitiated)</font></b> con el <b><font color="#0000FF">argumento de</font></b> calidad de servicio <b><font color="#0000FF">qos</font></b> para obtener datos en una <code>URL</code> determinada, que se establece en <b><font color="#0000FF">.userInitiated</font></b> porque selecciono los datos a solicitud del usuario: <br><br><img src="https://habrastorage.org/webt/0q/aq/2-/0qaq2-uakbn1zou8ilh7pcvysxy.png"><br><br>  Cada vez que usa sus propias variables dentro de un cierre, en nuestro caso es <b><font color="#0000FF">imageView</font></b> e <b><font color="#0000FF">imageURL</font></b> , el compilador lo obliga a colocarse frente a ellas <b><font color="#0000FF">.</font></b>  para que te preguntes: "¬øHay un" enlace c√≠clico de memoria "?"  Aqu√≠ no tenemos un " <code>memory cycle</code> " expl√≠cito, porque el <b><font color="#0000FF">yo</font></b> mismo no tiene un puntero a este cierre. <br><br>  Sin embargo, en el caso de subprocesos m√∫ltiples, debe tener en cuenta que las <b><font color="#0000FF">celdas</font></b> en la <code>Collection View</code> son reutilizables gracias al m√©todo <b><font color="#0000FF">dequeueReusableCell</font></b> .  Cada vez que aparece una celda (nueva o reutilizada) en la pantalla, la imagen se descarga de la red de forma asincr√≥nica (en este momento, la " <b><font color="#0000FF">rueda giratoria</font></b> " del indicador de actividad de la <b><font color="#0000FF">rueda</font></b> gira). <br><br>  Tan pronto como se completa la descarga y se recibe la imagen, se actualiza la <code>UI</code> esta celda de colecci√≥n.  Pero no esperamos a que se cargue la imagen, seguimos desplaz√°ndonos por la colecci√≥n y la celda de colecci√≥n que marcamos sale de la pantalla sin actualizar nuestra <code>UI</code> .  Sin embargo, debe aparecer una nueva imagen a continuaci√≥n y la misma celda que ha salido de la pantalla se reutilizar√°, pero para otra imagen, que puede cargar y actualizar r√°pidamente la <code>UI</code> .  En este momento, la carga de la imagen iniciada previamente en esta celda volver√° y la pantalla se actualizar√°, lo que conducir√° a un resultado incorrecto.  Esto se debe a que ejecutamos diferentes cosas que funcionan con la red en diferentes hilos.  Vuelven en diferentes momentos. <br><br>  ¬øC√≥mo podemos solucionar la situaci√≥n? <br>  Dentro del marco del mecanismo <b><font color="#0000FF">GCD</font></b> que utilizamos, no podemos cancelar la descarga de la imagen de la celda que sali√≥ de la pantalla, pero podemos, cuando nuestros datos <b><font color="#0000FF">imageData llegan</font></b> de la red, verificar la <code>URL</code> <b><font color="#0000FF">URL</font></b> que caus√≥ la carga de estos datos y compararla con la que el usuario quiere tener en esta celda en este momento, es decir, <b><font color="#0000FF">imageURL</font></b> .  Si no coinciden, no actualizaremos la celda de la <code>UI</code> y esperaremos los datos de imagen que necesitamos: <br><br><img src="https://habrastorage.org/webt/01/xl/-v/01xl-vqsde3rlqyus1f7tksacja.png"><br><br>  Esta l√≠nea de c√≥digo aparentemente absurda <b><font color="#0000FF">url == self.imageURL</font></b> hace que todo funcione correctamente en un entorno multiproceso que requiere una imaginaci√≥n no est√°ndar.  El hecho es que algunas cosas en la programaci√≥n multiproceso ocurren en un orden diferente al que est√° escrito el c√≥digo. <br><br>  Si no fue posible seleccionar los datos de la imagen, se genera una imagen con un mensaje de error en forma de cadena "Error" y un emoji con "ce√±o fruncido".  Solo el espacio vac√≠o en nuestra <code>Collection View</code> puede confundir un poco al usuario: <br><br><img src="https://habrastorage.org/webt/7m/zh/dt/7mzhdt1eo0tedkkrolp6osiidhu.png"><br><br>  No queremos que la imagen con el mensaje de error repita el <b><font color="#0000FF">aspecto de</font></b> esta imagen de error, porque en este caso el texto junto con el emoji se estirar√° o comprimir√°.  Nos gustar√≠a que fuera neutral - cuadrado, es decir, tendr√≠a una relaci√≥n de aspecto de aspecto cercana a 1.0. <br><br><img src="https://habrastorage.org/webt/7b/rj/ve/7brjvesx81juxpsgnkevsnvge_u.png"><br><br>  Debemos informar a nuestro <code>Controller</code> de este deseo para que corrija la relaci√≥n de aspecto de la relaci√≥n de aspecto para la <b><font color="#0000FF">ruta</font></b> de <b><font color="#0000FF">√≠ndice</font></b> correspondiente en su modelo de <b><font color="#0000FF">galer√≠a de im√°genes</font></b> .  Esta es una tarea interesante, hay muchas formas de resolverla, y elegiremos la m√°s f√°cil de ellas, usando el cierre <b><font color="#0000FF">opcional</font></b> <b><font color="#0000FF">var closAspectRatio: (() -&gt; Void)?</font></b>  .  Puede ser igual a <b><font color="#0000FF">cero</font></b> y no necesita ser instalado si esto no es necesario: <br><br><img src="https://habrastorage.org/webt/8v/5q/wy/8v5qwyzl2_-dju1qfotj7i9nem4.png"><br><br>  Al llamar al cierre <b><font color="#0000FF">changeAspectRatio? ()</font></b> En caso de <b><font color="#0000FF">recuperaci√≥n</font></b> de datos err√≥nea, uso la cadena <b><font color="#0000FF">Opcional</font></b> .  Ahora, cualquier persona que est√© interesada en alg√∫n tipo de configuraci√≥n al recibir una imagen err√≥nea puede establecer este cierre en algo espec√≠fico.  Y esto es exactamente lo que hacemos en nuestro <code>Controller</code> en el m√©todo <b><font color="#0000FF">cellForItemAt</font></b> : <br><br><img src="https://habrastorage.org/webt/uv/ee/mi/uveemimakh506que35eaasanjbi.png"><br><br>  Los detalles se pueden encontrar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br><br>  Para mostrar im√°genes con el correcto <b><font color="#0000FF">AspectRatio</font></b> , se <b><font color="#0000FF">utiliza el</font></b> m√©todo <b><font color="#0000FF">sizeForItemAt del</font></b> delegado <b><font color="#0000FF">UICollectionViewDelegateFlowLayout</font></b> : <br><br><img src="https://habrastorage.org/webt/ys/v7/nz/ysv7nzh7rus7hnowtqyocbevwai.png"><br><br>  Adem√°s de la <code>Collection View</code> im√°genes <code>Collection View</code> , en nuestra <code>UI</code> colocamos un <code>Bar Button</code> en el panel de navegaci√≥n con una imagen personalizada de <b><font color="#0000FF">GarbageView que</font></b> contiene una "papelera" como una <b><font color="#0000FF">subvista</font></b> : <br><br><img src="https://habrastorage.org/webt/1h/eo/uu/1heouudwoicj6qyjrckscada9ug.png"><br><br>  En esta figura, los colores de fondo para <b><font color="#0000FF">GarbageView</font></b> y el bot√≥n <b><font color="#0000FF">UIButton</font></b> con la imagen del "bote de basura" (en realidad hay un fondo transparente) se modifican especialmente para que vea que el usuario que "volca" las im√°genes de la Galer√≠a en el "bote de basura" mucho m√°s espacio para maniobrar al "soltar" <b>Soltar</b> que solo el √≠cono de la papelera. <br>  La clase <b><font color="#0000FF">GarbageView tiene</font></b> dos inicializadores y ambos usan el m√©todo <b><font color="#0000FF">setup ()</font></b> : <br><br><img src="https://habrastorage.org/webt/xj/_t/es/xj_tesvqnjlk9yxbxnrvrvc_6w8.png"><br><br>  En el m√©todo <b><font color="#0000FF">setup ()</font></b> , tambi√©n agrego <b><font color="#0000FF">myButton</font></b> como una <b>subvista</b> con la imagen del "bote de basura" tomado del <code>Bar Button</code> est√°ndar del <code>Bar Button</code> : <br><br><img src="https://habrastorage.org/webt/if/s5/3c/ifs53cvfeaggqwtrlshju1g5qwc.png"><br><br>  Configur√© un fondo transparente para <b><font color="#0000FF">GarbageView</font></b> : <br><br><img src="https://habrastorage.org/webt/g_/9y/af/g_9yafe1tu_pz4vx6_wan3tarv0.png"><br><br>  El tama√±o del bote de basura y su posici√≥n se determinar√°n en el m√©todo <b><font color="#0000FF">layoutSubviews ()</font></b> de la clase <b><font color="#0000FF">UIView</font></b> , dependiendo de los <b><font color="#0000FF">l√≠mites de la</font></b> <b><font color="#0000FF">UIView</font></b> dada: <br><br><img src="https://habrastorage.org/webt/zf/ll/jb/zflljbnvhfenkfx0o2ge8iy2q2k.png"><br><br>  Esta es la versi√≥n inicial de la aplicaci√≥n de demostraci√≥n "Image Gallery", se encuentra en <b><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Github</a></code></b> en la carpeta <u><code>ImageGallery_beginning</code></u> .  Si ejecuta esta versi√≥n de la aplicaci√≥n "Galer√≠a de im√°genes", ver√° el resultado de la aplicaci√≥n trabajando en los datos de prueba, que luego eliminaremos y completaremos la "Galer√≠a de im√°genes" exclusivamente FUERA: <br><br><img src="https://habrastorage.org/webt/w9/jn/y4/w9jny4yxwtmeemq8cqkqhbirvoy.png"><br><br>  El plan para implementar el mecanismo de <code>Drag &amp; Drop</code> en nuestra aplicaci√≥n es el siguiente: <br><br><ol><li>  primero, dotaremos a nuestra <code>Collection View</code> capacidad de "arrastrar" <code>Drag</code> DE ella <b><font color="#0000FF">UIImage</font></b> im√°genes tanto externa como localmente, </li><li>  luego le ense√±aremos a nuestra colecci√≥n de im√°genes de <code>Collection View</code> de <code>Collection View</code> para aceptar "arrastrar" <code>Drag</code> externa o localmente desde <b><font color="#0000FF">UIImage</font></b> , </li><li>  tambi√©n le ense√±aremos a nuestro <b><font color="#0000FF">GarbageView</font></b> con el bot√≥n del bote de basura para aceptar im√°genes <b><font color="#0000FF">UIImage</font></b> arrastradas desde la <code>Collection View</code> local y eliminarlas de la <code>Collection View</code> </li></ol><br><br>  Si va al final de este tutorial y completa todos los cambios de c√≥digo necesarios, recibir√° la versi√≥n final de la aplicaci√≥n de demostraci√≥n "Galer√≠a de im√°genes", en la que se implement√≥ el mecanismo de <code>Drag &amp; Drop</code> .  Se encuentra en <b><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Github</a></code></b> en la carpeta <u><code>ImageGallery_finished</code></u> . <br><br>  Dos nuevos delegados proporcionan el rendimiento del mecanismo de <code>Drag &amp; Drop</code> en la <code>Collection View</code> . <br>  Los m√©todos <u>del primer delegado, <b><font color="#0000FF">dragDelegate</font></b> , est√°n</u> configurados para inicializar y personalizar los arrastrar y soltar <code>Drags</code> . <br>  Los m√©todos del segundo delegado, <b><font color="#0000FF">dropDelegate</font></b> , completan el arrastrar y soltar de <code>Drags</code> y, b√°sicamente, proporcionan <code>Data transfer</code> datos y configuraciones de animaci√≥n personalizadas cuando <code>Drop</code> reinicia <code>Drop</code> , as√≠ como otras cosas similares. <br><br>  Es importante tener en cuenta que ambos protocolos son completamente independientes.  Puede usar uno u otro protocolo si solo necesita "arrastrar" <code>Drag</code> o solo "soltar" <code>Drop</code> , pero puede usar ambos protocolos a la vez y simult√°neamente <code>Drag</code> y soltar <code>Drag</code> y "soltar" <code>Drop</code> , lo que abre una funcionalidad adicional Mecanismo de <code>Drag &amp; Drop</code> para reordenar elementos en su <code>Collection View</code> . <br><br><h1>  Arrastrar y soltar <code>Drag</code> elementos DESDE <code>Collection View</code> </h1><br>  La implementaci√≥n del protocolo de <code>Drag</code> es muy simple, y lo primero que debe hacer siempre es establecerse, como delegado de <b><font color="#0000FF">dragDelegate</font></b> : <br><br><img src="https://habrastorage.org/webt/mt/jw/dq/mtjwdqjahnvyzwjd0hz9cra47mg.png"><br><br>  Y, por supuesto, en la parte superior de la clase <b><font color="#0000FF">ImageGalleryCollectionViewController,</font></b> debe decir "S√≠", implementamos el protocolo <b><font color="#0000FF">UICollectionViewDragDelegate</font></b> : <br><br><img src="https://habrastorage.org/webt/ie/ue/xv/ieuexvbtxfan-uouzv4cvxpjw20.png"><br><br>  Tan pronto como hacemos esto, el compilador comienza a "quejarse", hacemos clic en el c√≠rculo rojo y se nos pregunta: "¬øDesea agregar los m√©todos necesarios del protocolo <b><font color="#0000FF">UICollectionViewDragDelegate</font></b> ?" <br>  Respondo: "¬°Por supuesto que quiero!"  y haga clic en el bot√≥n <code>Fix</code> : <br><br><img src="https://habrastorage.org/webt/6d/24/it/6d24itltj_buh2uwe3fbgkh8my8.png"><br><br>  El √∫nico m√©todo requerido del protocolo <b><font color="#0000FF">UICollectionViewDragDelegate</font></b> es el m√©todo <b><font color="#0000FF">itemsForBeginning</font></b> , que le dir√° al sistema <code>Drag</code> que "arrastramos y soltamos".  Se <b><font color="#0000FF">llama al</font></b> m√©todo <b><font color="#0000FF">itemsForBeginning</font></b> cuando el usuario comienza a "arrastrar" ( <code>Dragging</code> ) una celda en la <b><font color="#0000FF">celda de</font></b> colecci√≥n. <br><br>  Tenga en cuenta que en este m√©todo, la <code>Collection View</code> colecci√≥n ha agregado <b><font color="#0000FF">indexPath</font></b> .  Esto nos dir√° qu√© elemento de la colecci√≥n, qu√© <b><font color="#0000FF">indexPath</font></b> , vamos a "arrastrar y soltar".  Esto es realmente muy conveniente para nosotros, ya que es la aplicaci√≥n la responsable de usar los argumentos de <b><font color="#0000FF">sesi√≥n</font></b> e <b><font color="#0000FF">indexPath</font></b> para descubrir c√≥mo manejar este arrastrar y soltar de <code>Drag</code> . <br><br>  Si se <b><font color="#0000FF">devuelve</font></b> el conjunto <b><font color="#0000FF">[UIDragItems] de los</font></b> elementos "arrastrables", <code>Drag</code> inicializa el "arrastre" del <code>Drag</code> ; si <b><font color="#0000FF">se</font></b> devuelve el conjunto vac√≠o <b><font color="#0000FF">[]</font></b> , <code>Drag</code> ignora el "arrastre" del <code>Drag</code> . <br><br>  <b><font color="#0000FF">Crear√©</font></b> una peque√±a funci√≥n <b><font color="#0000FF">privada</font></b> <b><font color="#0000FF">dragItems (en: indexPath)</font></b> con el argumento <b><font color="#0000FF">indexPath</font></b> .  Devuelve la matriz <b><font color="#0000FF">[UIDragItem]</font></b> que <b><font color="#0000FF">necesitamos</font></b> . <br><br><img src="https://habrastorage.org/webt/_y/iv/86/_yiv869sqaamn_ytg22fg89iez0.png"><br><br>  ¬øC√≥mo es un elemento <b><font color="#0000FF">UIDragItem de</font></b> arrastrar y soltar? <br>  √âl solo tiene una cosa muy IMPORTANTE llamada <b><font color="#0000FF">itemProvider</font></b> .  <b><font color="#0000FF">itemProvider</font></b> es solo algo que puede proporcionar datos que ser√°n arrastrados. <br><br>  Y tiene derecho a preguntar: "¬øQu√© pasa con el" arrastrar y soltar "de un elemento <b><font color="#0000FF">UIDragItem</font></b> que simplemente no tiene datos?"  El elemento que desea arrastrar puede no tener datos, por ejemplo, porque crear estos datos es una operaci√≥n costosa.  Puede ser una imagen de <b><font color="#0000FF">imagen</font></b> o algo que requiera descargar datos de Internet.  Lo bueno es que la operaci√≥n de <code>Drag &amp; Drop</code> es completamente as√≠ncrona.  Cuando comienza a arrastrar y soltar <code>Drag</code> , es realmente un objeto muy liviano ( <code>lift preview</code> ), lo arrastra a todas partes y no sucede nada durante este "arrastre".  Pero tan pronto como "suelte" <code>Drop</code> su objeto en alg√∫n lugar, entonces, al ser un <b><font color="#0000FF">proveedor de elementos</font></b> , realmente debe proporcionar su objeto "arrastrado" y "arrojado" con datos reales, incluso si lleva una cierta cantidad de tiempo. <br><br>  Afortunadamente, hay muchos <b><font color="#0000FF">proveedores</font></b> de elementos <b><font color="#0000FF">integrados</font></b> .  Estas son clases que ya existen en <code>iOS</code> y que son <b><font color="#0000FF">itemPoviders</font></b> , como, por ejemplo, <code>NSString</code> , que le permite arrastrar y soltar texto sin fuentes.  Por supuesto, esta es una imagen <b><font color="#0000FF">UIImage</font></b> .  Puede seleccionar y arrastrar y soltar im√°genes <b><font color="#0000FF">UIImages en todo</font></b> .  La clase <b><font color="#0000FF">NSURL</font></b> , que es absolutamente maravillosa.  Puede ir a la p√°gina <code>Web</code> , seleccionar la <code>URL</code> y "soltarla" donde desee.  Esto puede ser un enlace a un art√≠culo o una <code>URL</code> para una imagen, como estar√° en nuestra demostraci√≥n.  Estas son las clases de color de <b><font color="#0000FF">UIColor</font></b> , <b><font color="#0000FF">elemento de</font></b> mapa <b><font color="#0000FF">MKMapItem</font></b> , contacto <b><font color="#0000FF">CNContact</font></b> de la libreta de direcciones, puede seleccionar y arrastrar muchas cosas.  Todos ellos son <b><font color="#0000FF">proveedores de art√≠culos</font></b> . <br><br>  Vamos a "arrastrar y soltar" la imagen <b><font color="#0000FF">UIImage</font></b> .  Se encuentra en la celda de la celda <code>Collection View</code> con <b><font color="#0000FF">indexPath</font></b> , lo que me ayuda a seleccionar la celda de la <b><font color="#0000FF">celda</font></b> , sacar el <code>Outlet</code> <b><font color="#0000FF">imageView</font></b> y obtener su <b><font color="#0000FF">imagen</font></b> . <br><br>  Expresemos esta idea con un par de l√≠neas de c√≥digo. <br>  Primero, solicito mi <code>Collection View</code> sobre una <b><font color="#0000FF">celda</font></b> para el <b><font color="#0000FF">elemento del</font></b> elemento correspondiente a este <b><font color="#0000FF">indexPath</font></b> . <br><br><img src="https://habrastorage.org/webt/ho/zi/gp/hozigp41-y0-3cfa525umwojyu4.png"><br><br>  El <b><font color="#0000FF">m√©todo cellForItem (en: IndexPath)</font></b> para la <code>Collection View</code> colecci√≥n funciona solo para las celdas visibles, pero, por supuesto, funcionar√° en nuestro caso, porque "arrastro y suelto" el elemento de la colecci√≥n <code>Drag</code> en la pantalla y es visible. <br><br>  Entonces, obtuve una celda <b><font color="#0000FF">celular</font></b> "arrastrable". <br>  A continuaci√≥n, uso el <b><font color="#0000FF">como</font></b> operador <b><font color="#0000FF">?</font></b>  a esta celda para que tenga un TIPO de mi <code>subclass</code> personalizada.  Y si esto funciona, entonces obtengo un <code>Outlet</code> <b><font color="#0000FF">imageView</font></b> , del cual tomo su imagen de <b><font color="#0000FF">imagen</font></b> .  Acabo de "capturar" la <b><font color="#0000FF">imagen</font></b> de esta <b><font color="#0000FF">indexPath</font></b> . <br><br>  Ahora que tengo una imagen de <b><font color="#0000FF">imagen</font></b> , todo lo que tengo que hacer es crear uno de estos <b><font color="#0000FF">UIDragItems</font></b> usando la imagen de <b><font color="#0000FF">imagen</font></b> resultante como <b><font color="#0000FF">itemProvider</font></b> , es decir, lo que nos proporciona los datos. <br>  Puedo crear <b><font color="#0000FF">dragItem</font></b> usando el constructor <b><font color="#0000FF">UIDragItem</font></b> , que toma <b><font color="#0000FF">itemProvider</font></b> como argumento: <br><br><img src="https://habrastorage.org/webt/to/zb/gt/tozbgtxocfrgoaqofvn9jgf9yeo.png"><br><br>  Luego creamos un <b><font color="#0000FF">itemProvider</font></b> para la imagen de la <b><font color="#0000FF">imagen</font></b> tambi√©n usando el constructor <b><font color="#0000FF">NSItemProvider</font></b> .  Hay varios constructores para <b><font color="#0000FF">NSItemProvider</font></b> , pero entre ellos hay uno realmente maravilloso: <b><font color="#0000FF">NSItemProvider (objeto: NSItemProviderWriting)</font></b> : <br><br><img src="https://habrastorage.org/webt/ey/21/cq/ey21cq0iq5riml7pfrye4gcnmi8.png"><br><br>  Simplemente le da el objeto <b><font color="#0000FF">objeto a</font></b> este constructor <b><font color="#0000FF">NSItemProvider</font></b> , y sabe c√≥mo hacer que <b><font color="#0000FF">itemProvider</font></b> salga de √©l.  Como tal <b><font color="#0000FF">objeto,</font></b> le doy a la imagen la imagen que recib√≠ de la <b><font color="#0000FF">celda</font></b> y obtengo <b><font color="#0000FF">itemProvider</font></b> for <b><font color="#0000FF">UIImage</font></b> . <br>  Y eso es todo.  Creamos <b><font color="#0000FF">dragItem</font></b> y deber√≠a devolverlo como una matriz que tiene un elemento. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pero antes de que vuelva </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dragItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , voy a hacer una cosa m√°s, es decir, para establecer la variable </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localobject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dragItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , igual a la imagen resultante </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagen</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><img src="https://habrastorage.org/webt/sh/h0/cz/shh0czt4sxjd7ienvsl2slz8yju.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øQu√© significa esto? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si realiza "arrastrar y soltar" </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localmente, es decir, dentro de su aplicaci√≥n, entonces no necesita pasar por todo este c√≥digo asociado con </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemProvider a</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> trav√©s de la recuperaci√≥n de datos as√≠ncrona. No necesita hacer esto, solo necesita tomar </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localObject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y usarlo. Este es un tipo de "cortocircuito" con "arrastrar y soltar" local </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El c√≥digo escrito por nosotros funcionar√° al arrastrar y soltar</font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fuera de nuestra colecci√≥n </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a otras aplicaciones, pero si "arrastramos y </font><b><font color="#0000FF"><font style="vertical-align: inherit;">soltamos</font></font></b><font style="vertical-align: inherit;"> " </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localmente, entonces podemos usar </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localObject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . A continuaci√≥n, devuelvo una matriz de un elemento </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dragItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por cierto, si por alguna raz√≥n no pude obtener una </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagen</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para esta celda de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">celda</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , entonces devuelvo una matriz vac√≠a </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[]</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , esto significa que </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se cancela </font><font style="vertical-align: inherit;">el "arrastrar y soltar" </font><font style="vertical-align: inherit;">. </font></font><br><br><img src="https://habrastorage.org/webt/4b/uk/o3/4buko3fve2swk7wr7d_oy5sflma.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adem√°s de objeto local </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localobject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , se puede recordar el contexto local </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para nuestra </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sesi√≥n de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la sesi√≥n</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . En nuestro caso, ser√° una colecci√≥n Ver </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">colecci√≥n</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y es √∫til para nosotros despu√©s: </font></font><br><br><img src="https://habrastorage.org/webt/o_/gi/tk/o_gitkbwnnbcevnxwcwm6obckwk.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tener "arrastrar y soltar" </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, puede agregar m√°s art√≠culos </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">art√≠culos</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a esta "arrastrar y soltar", s√≥lo haciendo el gesto </font></font><b><font color="#FF00FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">del grifo</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en ellos. Como resultado, puede arrastrar y soltar </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muchos elementos a la vez. Y esto es f√°cil de implementar con otro </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m√©todo</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> delegado </font><font style="vertical-align: inherit;">, </font><b><font color="#0000FF"><font style="vertical-align: inherit;">UICollectionViewDragDelegate</font></font></b><font style="vertical-align: inherit;"> , muy similar al m√©todo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemsForeginning</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , un m√©todo llamado </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemsForAddingTo</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . El m√©todo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemsForAddingTo</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se </font><font style="vertical-align: inherit;">ve exactamente igual que el m√©todo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemsForeginning</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y devuelve exactamente lo mismo, porque tambi√©n nos da </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de lo que el usuario "grab√≥" durante el proceso de "arrastrar </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font><font style="vertical-align: inherit;">soltar" </font><font style="vertical-align: inherit;">, y solo necesito obtener la imagen de la </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagen</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de la celda en la que el usuario "grab√≥" y devolverla. </font></font><br><br><img src="https://habrastorage.org/webt/u-/hc/9d/u-hc9dnk3001qhkra-et6oycphi.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Devolver una matriz vac√≠a </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[]</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> del m√©todo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemsForAddingTo</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hace que el gesto de </font></font><b><font color="#FF00FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">toque</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se interprete de la manera habitual, es decir, como seleccionar esta celda de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">celda</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y eso es todo lo que necesitamos para arrastrar y soltar </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lanzamos la aplicaci√≥n. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selecciono la imagen de "Venecia", la sostengo por un momento y empiezo a moverme ... </font></font><br><br><img src="https://habrastorage.org/webt/p7/ne/9z/p7ne9zdwnirsf2uxjogvflrqwao.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... y realmente podemos arrastrar esta imagen a la aplicaci√≥n</font></font><code>Photos</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ya que ve un signo m√°s verde "+" en la esquina superior izquierda de la imagen "arrastrable". </font><font style="vertical-align: inherit;">Puedo realizar un gesto de </font></font><b><font color="#FF00FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">toque</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en una imagen m√°s de </font><b><font color="#FF00FF"><font style="vertical-align: inherit;">Artika</font></font></b><font style="vertical-align: inherit;"> de la colecci√≥n </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... </font></font><br><br><img src="https://habrastorage.org/webt/cg/sj/om/cgsjomxtwxyzqxg-wxvqxz4huqi.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... y ahora podemos colocar dos im√°genes en la aplicaci√≥n </font></font><code>Photos</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/bk/xk/ud/bkxkud6ggdorw2d1yayjmatnsf4.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dado que el </font></font><code>Photos</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mecanismo ya est√° integrado </font><font style="vertical-align: inherit;">en la aplicaci√≥n </font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, todo funciona bien y es genial. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entonces, el "arrastrar" </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y "descargar" la </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagen </font><font style="vertical-align: inherit;">de la </font><font style="vertical-align: inherit;">Galer√≠a en otras aplicaciones </font><font style="vertical-align: inherit;">me funciona </font><font style="vertical-align: inherit;">, no tuve que hacer mucho en mi aplicaci√≥n, excepto entregar la imagen de la </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagen</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> como una matriz </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[UIDragItem]</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Esta es una de las muchas caracter√≠sticas excelentes del mecanismo.</font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Es muy f√°cil hacer que funcione en ambas direcciones. </font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Restablecer </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">im√°genes a la colecci√≥n</font></font><code>Collection View</code> </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahora tenemos que hacer una </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parte de mi colecci√≥n </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para poder "volcar" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cualquier imagen "arrastrada" DENTRO de esta colecci√≥n. </font><font style="vertical-align: inherit;">Una imagen "arrastrable" puede "venir" FUERA o directamente DENTRO de esta colecci√≥n. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para ello, hacemos lo mismo hecho de delegar </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dragDelegate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , es decir, hacer que nosotros mismos, </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">el auto</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , delegado </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dropDelegate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en el m√©todo de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la viewDidLoad</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/5q/wv/mf/5qwvmfjuyh74sfxzwcw7_0gikec.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Una vez m√°s, tenemos que subir a la parte superior de nuestra clase </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageGalleryCollectionViewController</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y verificar la implementaci√≥n del protocolo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UICollectionViewDropDelegate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><img src="https://habrastorage.org/webt/wc/ww/7p/wcww7pgfia3xxwe63teews1e9de.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tan pronto como agregamos nuestro nuevo protocolo, el compilador nuevamente comenz√≥ a "quejarse" de que no implementamos este protocolo. Hacemos clic en el bot√≥n </font></font><code>Fix</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y los m√©todos requeridos de este protocolo aparecen frente a nosotros. En este caso, se nos informa que debemos implementar el m√©todo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/ll/9t/k4/ll9tk4goht7nfa-gnifnq8iaoto.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">debemos hacer esto, de lo contrario no se producir√° un "reinicio" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. De hecho, voy a implementar el m√©todo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop en</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √∫ltimo lugar, porque hay un par de otros </font></font><code>Apple</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m√©todos </font><font style="vertical-align: inherit;">altamente recomendados </font><font style="vertical-align: inherit;">que necesita implementar para la </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parte. Esto es </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">canHandle</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dropSessionDidUpdate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><img src="https://habrastorage.org/webt/jd/ce/ve/jdcevehobhr1k7wwvc1iaem-w80.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si implementamos estos dos m√©todos, entonces podemos obtener un peque√±o signo m√°s verde "+" cuando arrastramos im√°genes desde el EXTERIOR a nuestra colecci√≥n </font></font><code>ollection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, y adem√°s, no intentar√°n volcar lo que no entendemos. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementemos </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">canHandle</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . puede </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">manejar la versi√≥n del</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> m√©todo </font><font style="vertical-align: inherit;">, que est√° destinada para la colecci√≥n </font></font><code>ollection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, pero este m√©todo se </font></font><code>ollection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ve exactamente igual que el m√©todo similar para </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> normal </font><font style="vertical-align: inherit;">, no hay </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexPath all√≠</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , solo necesitamos devolver </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">session.canLoadObjects (ofClass: UIImage.self)</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , y eso significa que acepto el "reinicio" de los objetos de este cl PAS en mi colecci√≥n </font></font><code>ollection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><img src="https://habrastorage.org/webt/0j/tz/ze/0jtzzen649jj7z58-3tiq_ehrvs.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pero esto no es suficiente para "volcar" la </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagen en mi colecci√≥n </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EXTERIOR. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si el "volcado" de la </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagen ocurre DENTRO de la colecci√≥n </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, cuando el usuario reorganiza sus propios </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">elementos</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilizando el mecanismo </font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, entonces solo una imagen </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIImage</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es </font><b><font color="#0000FF"><font style="vertical-align: inherit;">suficiente</font></font></b><font style="vertical-align: inherit;"> , y la implementaci√≥n del m√©todo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">canHandle</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se ver√° como la anterior. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pero si el "volcado" de la </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagen ocurre FUERA, entonces solo deber√≠amos manejar el "arrastrar y soltar" </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que representa la imagen </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIImage</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> junto con </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esta imagen, ya que no vamos a almacenar las im√°genes </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIImage directamente</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en modelo. En este caso, voy a volver </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cierto</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en el m√©todo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">canHandle</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> s√≥lo si ambas condiciones llevaron a cabo un par de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">session.canLoadObjects (ofClass: NSURL.self) &amp;&amp; (session.canLoadObjects ofClass: UIImage.self)</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/yj/dt/qn/yjdtqnmmxq0olgilbz1ifa5mdt8.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">me quedan por determinar si estoy tratando con "reset" EXTERIOR O INTERIOR. Har√© esto usando la constante calculada </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">isSelf</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , para cuyo c√°lculo puedo usar tal cosa en una </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sesi√≥n de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sesi√≥n</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> como su </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sesi√≥n </font><font style="vertical-align: inherit;">local </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localDragSession</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Esta </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sesi√≥n </font><font style="vertical-align: inherit;">local </font><font style="vertical-align: inherit;">a su vez tiene un contexto local </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si recuerdas, establecemos este contexto local en el m√©todo</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemsForVeginning</font></font></font></b> <code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> delegado</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> UICollectionViewDragDelegate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><img src="https://habrastorage.org/webt/o_/gi/tk/o_gitkbwnnbcevnxwcwm6obckwk.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voy a explorar el contexto local</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> localContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a la igualdad en mi colecci√≥n</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CollectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Es cierto, TYPE de</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> localContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ser√°</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Any</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , y necesito hacer una conversi√≥n de TYPE</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Any</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usando el operador</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> as. UICollectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><img src="https://habrastorage.org/webt/kc/zk/nt/kczknt6xiau08k5d06xu40akoyu.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">si el contexto local</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (session.localDragSession? .LocalContext as? UICollectionView)</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es igual a mi colecci√≥n</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , entonces la variable calculada</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> isSelf</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verdadera</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y hay un "reinicio" local DENTRO de mi colecci√≥n. Si se viola esta igualdad, entonces estamos tratando con un "restablecimiento" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EXTERIOR. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El m√©todo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">canHandle</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> informa que solo podemos manejar este tipo de "arrastrar y soltar" </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en nuestra colecci√≥n </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. De lo contrario, m√°s adelante, no tiene sentido hablar de "dumping" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si continuamos "reinicio" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, sigue siendo hasta el momento en que el usuario va a levantar los dedos fuera de la pantalla y no ser√° un verdadero "reinicio" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, tenemos que informar </font></font><code>iOS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utilizando el m√©todo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dropSessionDidUpdate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> delegado </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UICollectionViewDropDelegate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sobre nuestra oferta </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIDropProposal</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para implementar reinicio </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En este m√©todo, debemos devolver una </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oraci√≥n que pueda tener </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">valores .copy</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> o </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.move</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> o </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.cancel</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> o </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.forbidden</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para el argumento de la </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">operaci√≥n</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Y estas son todas las posibilidades que tenemos en el caso ordinario cuando se trata de una </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> normal </font><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pero la colecci√≥n </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">va m√°s all√° y ofrece devolver la oferta especializada </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UICollectionViewDropProposal</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que es una </font></font><code>subclass</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">clase de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIDropProposal</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y permite, adem√°s de la operaci√≥n de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">operaci√≥n,</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> especificar un par√°metro de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">intenci√≥n</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adicional </font><font style="vertical-align: inherit;">para la colecci√≥n </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par√°metro</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">intent</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> le dice a la colecci√≥n</font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">si queremos que el elemento "descartado" se coloque dentro de una</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> celda</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> existente</font><b><font color="#0000FF"><font style="vertical-align: inherit;"> ,</font></font></b><font style="vertical-align: inherit;"> o si queremos agregar una nueva</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> celda. ¬ø</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ves la diferencia? En el caso de la colecci√≥n,</font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">debemos comunicar nuestra intenci√≥n</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> intencional</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En nuestro caso, siempre queremos agregar una nueva celda, por lo que ver√° cu√°l ser√° nuestro par√°metro de</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> intenci√≥n</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seleccionamos el segundo constructor para</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> UICollectionViewDropProposal</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><img src="https://habrastorage.org/webt/ab/vh/-p/abvh-pb04qje37u4jjgveja3lgu.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en nuestro caso, siempre queremos agregar una nueva celda y el par√°metro de</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> intenci√≥n</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tomar√° el valor</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .insertAtDestinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> como opuesto</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.insertIntoDestinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><img src="https://habrastorage.org/webt/yg/t0/xi/ygt0xirvwaucl9zvuvuxvvil2cu.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Una vez m√°s me uso contabilizado constante</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> isself</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , y si es</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auto</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> reorganizaci√≥n, I desplazar√°</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .move</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , de lo contrario estoy haciendo hasta</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .copy</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . En ambos casos, usamos</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .insertAtDestinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , es decir, insertando nuevas</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> celdas</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hasta ahora no he implementado el m√©todo</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pero echemos un vistazo a lo que una colecci√≥n ya puede hacer</font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">con esta peque√±a informaci√≥n que le proporcionamos.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arrastro la imagen del</font></font><code>Safari</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">buscador</font></font><code>Google</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, y aparece un signo "+" verde en la parte superior de esta imagen, lo que indica que nuestra Galer√≠a de im√°genes no solo est√° lista para aceptar y copiar esta imagen </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, sino que tambi√©n proporciona un lugar dentro de la colecci√≥n </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/ia/gy/gv/iagygvechjnwsm-tfvduwi0pc1o.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">puedo hacer clic en un par de im√°genes </font></font><code>Safari</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y Ya habr√° 3 im√°genes "arrastradas": </font></font><br><br><img src="https://habrastorage.org/webt/kd/ca/7s/kdca7sflzfrbbsbtmnk8_zbueqm.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pero si levanto el dedo y "suelto" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">estas im√°genes, no se colocar√°n en nuestra Galer√≠a, sino que simplemente volver√°n a sus lugares anteriores, porque todav√≠a no hemos implementado el m√©todo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><img src="https://habrastorage.org/webt/5v/e4/me/5ve4me_unk6t-azl6fhatljzgxs.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se pod√≠a ver que la colecci√≥n </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ya sabe lo que quiero hacer. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La colecci√≥n </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">es una cosa absolutamente maravillosa para el mecanismo.</font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ella tiene una funcionalidad muy poderosa para esto. Apenas la tocamos escribiendo 4 l√≠neas de c√≥digo, y ella ya se ha movido bastante lejos en la percepci√≥n de "reinicio" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Volvamos al c√≥digo e implementemos el m√©todo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><img src="https://habrastorage.org/webt/i0/cc/es/i0ccescpyvub0pclhjyzcbdcu7o.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En este m√©todo, no podremos seguir adelante con 4 l√≠neas de c√≥digo, porque el m√©todo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop es un</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> poco m√°s complicado, pero no demasiado. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuando se produce el "reinicio" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, en el m√©todo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> necesitamos actualizar nuestro Modelo, que es la </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">galer√≠a de</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> im√°genes </font><b><font color="#0000FF"><font style="vertical-align: inherit;">imageGallery</font></font></b><font style="vertical-align: inherit;"> con una lista de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">im√°genes</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , y necesitamos actualizar nuestra colecci√≥n visual </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tenemos dos escenarios diferentes de "reinicio" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si hay un "reinicio" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de mi colecci√≥n </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , entonces tengo que "reiniciar" el </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">elemento de </font><font style="vertical-align: inherit;">la </font><font style="vertical-align: inherit;">colecci√≥n en un lugar nuevo y eliminarlo del lugar anterior, porque en este caso muevo ( </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.move</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) este elemento de la colecci√≥n. Esta es una tarea trivial. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hay un "restablecimiento" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">desde otra aplicaci√≥n, luego debemos usar la propiedad </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemProvider</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> del </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">elemento del</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> elemento "arrastrado" </font><font style="vertical-align: inherit;">para seleccionar datos. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuando realizamos un "reinicio" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en la colecci√≥n </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , la colecci√≥n nos proporciona un coordinador </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordinador</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. En primer lugar, nos inform√≥ el coordinador del </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordinador</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">destinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , es decir </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "-destination", "Reset" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, que es donde vamos a ser "reinicio". </font></font><br><br><img src="https://habrastorage.org/webt/mp/mt/wk/mpmtwkebx7beyw5ge72gt19xt7k.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pero </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">destinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> puede ser </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ya que puede arrastrar la imagen "descartada" a esa parte de la colecci√≥n </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que no es el lugar entre algunas </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">celdas</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> existentes </font><font style="vertical-align: inherit;">, por lo que bien podr√≠a ser </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Si ocurre esta situaci√≥n, entonces creo un </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> con el </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">elemento del</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> elemento </font><font style="vertical-align: inherit;">0 en la secci√≥n de la </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">secci√≥n</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 0 </font><font style="vertical-align: inherit;">.</font></font><br><br><img src="https://habrastorage.org/webt/qd/ei/me/qdeimejhoj1v0pkgml2xtog1jke.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Podr√≠a elegir cualquier otro </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pero </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usar√©</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> este </font><b><font color="#0000FF"><font style="vertical-align: inherit;">indexPath</font></font></b><font style="vertical-align: inherit;"> por defecto. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahora sabemos d√≥nde realizaremos el "reinicio" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Tenemos que pasar por todos los art√≠culos del </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordinador</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "reiniciables" </font><font style="vertical-align: inherit;">proporcionados por el </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordinador</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Cada </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">elemento</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de esta lista tiene un TIPO </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UICollectionViewDropItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y puede proporcionarnos datos muy interesantes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por ejemplo, si puedo obtener </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sourceIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item.sourceIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , entonces sabr√© con certeza que este "arrastrar y soltar" </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se realiza por s√≠ mismo, </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, y la fuente del arrastre </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">es el elemento de la colecci√≥n con </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> igual a </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sourceIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/y2/3d/2u/y23d2u0pmf1pnasfw2khu9htji4.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ni siquiera tengo que mirar </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en este caso para descubrir que este "arrastrar y soltar" se realiz√≥ DENTRO de la colecci√≥n </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font> Wow! <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahora s√© la fuente </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sourceIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y el "destino" </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">destinationIndexPath</font></font></font></b> <code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , y la tarea se vuelve trivial. Todo lo que necesito hacer es actualizar el Modelo para que se intercambien el punto de origen y el de destino, y luego actualizar la colecci√≥n </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , en la que deber√° eliminar el elemento de la colecci√≥n con </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sourceIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y agregarlo a la colecci√≥n con </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">destinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nuestro caso local es el m√°s simple, porque en este caso el mecanismo </font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">funciona no solo en la misma aplicaci√≥n, sino en la misma colecci√≥n </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , y puedo obtener toda la informaci√≥n necesaria utilizando el coordinador </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordinador</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Implement√©moslo en este caso local m√°s simple: </font></font><br><br><img src="https://habrastorage.org/webt/1m/uu/4r/1muu4rnsxmehwuyybyspei14bvo.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en nuestro caso, ni siquiera necesito </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localObject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que "escond√≠" antes cuando cre√© </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dragItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y que ahora puedo tomar prestado del elemento "arrastrado" </font><font style="vertical-align: inherit;">en la </font><font style="vertical-align: inherit;">colecci√≥n de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">elementos</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en el formulario </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item.localObject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Lo necesitaremos cuando "descarguemos" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">im√°genes en el "bote de basura", que est√° en la misma aplicaci√≥n, pero no es la misma colecci√≥n </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dos </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IndexPathes son</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> suficientes para m√≠ </font><b><font color="#0000FF"><font style="vertical-align: inherit;">ahora</font></font></b><font style="vertical-align: inherit;"> : el origen </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sourceIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y el "destino" </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">destinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Primero obtengo informaci√≥n</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageInfo</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sobre la imagen en el lugar antiguo del Modelo, elimin√°ndola de all√≠. Y luego insertar en una serie de</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> im√°genes</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de mis modelos</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> imageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> informaci√≥n</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ImageInfo</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> una imagen con un nuevo √≠ndice</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> destinationIndexPath.item</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . As√≠ es como actualic√© mi Modelo:</font></font><br><br><img src="https://habrastorage.org/webt/pk/bk/ny/pkbknyitrog4kq40dcs7sfpxk0g.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ahora tengo que actualizar la colecci√≥n</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Es importante entender que no quiero sobrecargar todos los datos de mi colecci√≥n</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CollectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilizando</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> reloadData ()</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en el medio de "arrastrar y soltar"</font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ya que restablece todo el "mundo" de nuestra galer√≠a de im√°genes, que es muy malo, no lo hago. En cambio, voy a ordenar e insertar elementos</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">elementos por</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> separado:</font><b><font color="#0000FF"><font style="vertical-align: inherit;"> elimin√© el</font></font></b></font><br><br><img src="https://habrastorage.org/webt/1-/xa/jg/1-xajgm6ru3uwhqh53w4tf7tblu.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> elemento de colecci√≥n</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> con</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sourceIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e</font><b><font color="#0000FF"><font style="vertical-align: inherit;"> insert√©</font></font></b><font style="vertical-align: inherit;"> un nuevo elemento de colecci√≥n con</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> destinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parece que este c√≥digo funciona muy bien, pero en realidad, este c√≥digo puede "bloquear" su aplicaci√≥n. La raz√≥n es que realiza numerosos cambios en su colecci√≥n</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , y en este caso cada paso de cambiar la colecci√≥n debe sincronizarse con el Modelo normalmente, lo que no se observa en nuestro caso, ya que realizamos ambas operaciones al mismo tiempo: eliminar e insertar. De ah√≠ la colecci√≥n</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en alg√∫n momento estar√° en un estado NO sincronizado con el Modelo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pero hay una forma realmente genial de evitar esto, que es que la colecci√≥n </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tiene un m√©todo llamado </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performBatchUpdates</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que tiene un cierre ( </font></font><code>closure</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) y dentro de este cierre puedo colocar cualquier n√∫mero de estos </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deleteItems</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insertItems</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">moveItems</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y todo lo que quiero: </font></font><br><br><img src="https://habrastorage.org/webt/6b/w_/6n/6bw_6nemnuzuv8xowkmmpt4yumw.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahora, </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deleteItems</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insertItems</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se realizar√°n como una sola operaci√≥n, y nunca habr√° una falta de sincronizaci√≥n de su Modelo con la colecci√≥n </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y finalmente, lo √∫ltimo que tenemos que hacer es pedirle al </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordinador que</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> implemente y anime el "reinicio" en s√≠ mismo </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/7k/qr/1u/7kqr1uatpcgzp8vim6hsf1-o_lo.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tan pronto como levante el dedo de la pantalla, la imagen se mueve, todo sucede al mismo tiempo: "reinicio", la imagen desaparece en un lugar y apariencia en otro. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intentemos mover la imagen de prueba "Venecia" en nuestra Galer√≠a de im√°genes al final de la primera l√≠nea ... </font></font><br><br><img src="https://habrastorage.org/webt/gy/k4/ci/gyk4ci8msjogcvzo4hb8iqt2atq.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... y "restablecerla": </font></font><br><br><img src="https://habrastorage.org/webt/kb/a0/mv/kba0mvrjzqyf_wf1y8b0j5h27oy.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">como quer√≠amos, se coloc√≥ al final de la primera l√≠nea.</font></font><br>  ¬°Hurra!<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬°Todo funciona! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahora NO trataremos con el caso local, es decir, cuando el elemento "reset" viene FUERA, es decir, de otra aplicaci√≥n. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para hacer esto, escribimos </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">otra cosa</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en el c√≥digo </font><font style="vertical-align: inherit;">con respecto a </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sourceIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Si no lo hacemos </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sourceIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , significa que el elemento de "usar y tirar" vino de fuera en alguna parte y tenemos que utilizar los datos de transferencia usando </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemProver</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> volcado "elemento </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item.dragItem.itemProvider</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/wh/-9/gd/wh-9gdfe_e52v_9-wc-mf6o-7co.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si usted tiene algo que" arrastrar y soltar " </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">desde el exterior y" tiro "</font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, entonces, ¬øesta informaci√≥n est√° disponible al instante? No, selecciona datos de la cosa "arrastrada" ASINCR√ìNICAMENTE. ¬øPero qu√© pasa si la muestra toma 10 segundos? ¬øQu√© har√° la colecci√≥n en este momento </font></font><code>ollection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? Adem√°s, los datos pueden no llegar en el orden en que los solicitamos. Gestionar esto no es f√°cil, y </font></font><code>Apple</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propone para </font></font><code>ollection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">este caso una tecnolog√≠a completamente nueva para el uso de sustitutos </font></font><code>Placeholders</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Coloca </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">marcador </font><font style="vertical-align: inherit;">de </font><font style="vertical-align: inherit;">posici√≥n </font><font style="vertical-align: inherit;">en su colecci√≥n </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, y la colecci√≥n lo </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gestiona todo por usted, por lo que todo lo que tiene que hacer cuando los datos finalmente se seleccionan es pedirle al marcador de posici√≥n que </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">llame a su </font><b><font color="#0000FF"><font style="vertical-align: inherit;">marcador de posici√≥n</font></font></b><font style="vertical-align: inherit;"> Contexto contextual</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y dile que recibiste la informaci√≥n. Luego actualice su Modelo y contexto </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">placeholderContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Intercambia AUTOM√ÅTICAMENTE </font><font style="vertical-align: inherit;">la </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">celda</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> con el marcador de posici√≥n </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">con una de sus </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">celdas</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que corresponde al tipo de datos que recibi√≥. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Realizamos todas estas acciones creando un contexto de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">marcador de posici√≥n de marcador de posici√≥n</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que gestiona el marcador de posici√≥n </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y que obtiene del coordinador </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordinador</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pidi√©ndole que "restablezca" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">el </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">elemento del</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> elemento </font><font style="vertical-align: inherit;">al marcador de posici√≥n </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usar√© el inicializador para el contexto de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">marcador de posici√≥n de marcador de posici√≥n</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que "arroja" </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dragItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a un </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UICollectionViewDropPlaceholder</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/xh/lo/gk/xhlogk8aee_nhrukgwbtq0m8nae.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El objeto que voy a "lanzar" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">es </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item.dragItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , donde </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es un elemento </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de un </font><font style="vertical-align: inherit;">bucle, ya que podemos lanzar </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muchos elementos </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordinator.items</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Los "tiramos" uno por uno. Entonces </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item.dragItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es lo que "arrastramos </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font><b><font color="#0000FF"><font style="vertical-align: inherit;">soltamos</font></font></b><font style="vertical-align: inherit;"> " </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. El siguiente argumento para esta funci√≥n es el marcador de posici√≥n, y lo crear√© usando el inicializador </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UICollectionViewDropPlaceholder</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/hg/yu/jk/hgyujkpqodrfosah0opsrwwc-t0.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para hacer esto, necesito saber D√ìNDE voy a insertar el marcador de posici√≥n</font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, es decir, </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insertionIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , as√≠ como el identificador de la celda reutilizada </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reuseIdentifier</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El argumento </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insertionIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es obviamente igual a </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">destinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , es el </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para colocar el objeto "arrastrado", se calcula al comienzo del m√©todo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDropWith</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahora veamos el </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">id de la</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> celda </font><b><font color="#0000FF"><font style="vertical-align: inherit;">reuseIdentifier</font></font></b><font style="vertical-align: inherit;"> . USTED debe decidir qu√© tipo de celda </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">celular es</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> su localizador </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. El coordinador </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordinador</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no tiene una </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">celda</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " </font><font style="vertical-align: inherit;">preempaquetada </font><font style="vertical-align: inherit;">" </font><font style="vertical-align: inherit;">para el localizador</font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Es USTED quien debe decidir sobre esta c√©lula </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">celular</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Por lo tanto, el identificador de la celda reutilizada </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reuseIdentifiercell se solicita</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a los suyos </font></font><code>storyboard</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para que pueda usarse como un PROTOTIPO. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lo llamar√© "DropPlaceholderCell", pero b√°sicamente, podr√≠a nombrarlo como sea. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esta es solo la </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cadena</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> String </font><font style="vertical-align: inherit;">que voy a usar en la m√≠a </font></font><code>storyboard</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para crear esta cosa. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Regrese a la nuestra </font></font><code>storyboard</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y cree una celda </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">celular</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para el marcador de posici√≥n </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Para hacer esto, solo necesitamos seleccionar una colecci√≥n </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e inspeccionarla. En el primer campo, </font></font><code>Items</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cambio </font></font><code>1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font><code>2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Esto crea inmediatamente una segunda celda para nosotros, que es una copia exacta de la primera. </font></font><br><br><img src="https://habrastorage.org/webt/df/go/ke/dfgokefx6miugtxs8ee0_jl1zsk.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seleccionamos nuestra nueva celda </font></font><code>ImageCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, establecemos el identificador " </font></font><code>DropPlaceholderCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">", eliminamos todos los </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">elementos </font><font style="vertical-align: inherit;">desde all√≠ </font><font style="vertical-align: inherit;">, incluido </font></font><code>Image View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ya que este PROTOTIPO se usa cuando la imagen a√∫n no ha llegado. Agregamos un nuevo indicador de actividad de la paleta de objetos all√≠ </font></font><code>Activity Indicator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, rotar√°, informando a los usuarios que espero algunos datos de "restablecimiento". Tambi√©n cambiar el color de fondo </font></font><code>Background</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que entender que cuando "Reset" de la imagen, fuera funciona exactamente esta celda </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">celular</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> como prototipos: </font></font><br><br><img src="https://habrastorage.org/webt/ur/gi/72/urgi728r6j2a1d2z0tf_4k-er1a.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adem√°s del tipo de c√©lula nueva no debe ser </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageCollectionVewCell</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, porque no habr√° im√°genes en √©l. Har√© que esta celda sea una celda normal de TYPE </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIollectionCiewCell</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ya que no necesitamos ninguna </font></font><code>Outlets</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para el control: </font></font><br><br><img src="https://habrastorage.org/webt/sg/d8/ya/sgd8ya2342bd0lgk9fl172j-8pi.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">configuremos el indicador de actividad </font></font><code>Activity Indicator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para que comience a animarse desde el principio, y no tendr√≠a que escribir nada en el c√≥digo para iniciarlo. Para hacer esto, haga clic en la opci√≥n </font></font><code>Animating</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/qm/de/hq/qmdehqmwsuzn_dt8fkbjdoclkss.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y eso es todo. Entonces, hicimos todas las configuraciones para esta celda </font></font><code>DropPlaceholderCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, volvemos a nuestro c√≥digo. Ahora tenemos un gran localizador </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">listo para funcionar. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Todo lo que tenemos que hacer es obtener los datos, y cuando se reciben los datos, simplemente le decimos al </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">marcador</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de </font><b><font color="#0000FF"><font style="vertical-align: inherit;">posici√≥n</font></font></b><font style="vertical-align: inherit;"> Contexto sobre este contexto </font><font style="vertical-align: inherit;">e intercambiar√° el marcador de posici√≥n</font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y nuestra celda "nativa" con datos, y haremos cambios en el Modelo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voy a "cargar" UN objeto, que ser√° mi </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">art√≠culo</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usando el </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m√©todo loadObject (ofClass: UIImage.self)</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (singular). Yo uso el c√≥digo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item.dragItem.itemProvider</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> proveedor </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ItemProvider</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que proporcionar√° elementos de datos tienen </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">elemento</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de forma as√≠ncrona. Est√° claro que si </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">iitemProvider est√°</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> conectado </font><font style="vertical-align: inherit;">, </font><font style="vertical-align: inherit;">obtenemos el </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">objeto</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "reset" de </font><b><font color="#0000FF"><font style="vertical-align: inherit;">iitem</font></font></b><font style="vertical-align: inherit;"> fuera de esta aplicaci√≥n. El siguiente es el </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m√©todo loadObject (ofClass: UIImage.self)</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (singular): </font></font><br><br><img src="https://habrastorage.org/webt/bv/pl/fj/bvplfjtt-wlffytoqky4jxcbxco.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">este cierre particular NO se realiza en</font></font><code>main queue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Y, desafortunadamente, tuvimos que cambiar al </font></font><code>main queue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uso de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DispatchQueue.main.async {}</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para "capturar" la relaci√≥n de aspecto de la imagen en la variable de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aspecto</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> local </font><b><font color="#0000FF"><font style="vertical-align: inherit;">Radio</font></font></b><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Realmente presentamos dos variables locales </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageURL</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aspectRatio</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ... </font></font><br><br><img src="https://habrastorage.org/webt/vc/k3/vg/vck3vgqg7grejo8tj2ojbdnfdny.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... y las "capturaremos" al cargar la imagen de la </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagen</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y la URL </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">URL</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/jc/ui/yk/jcuiyk3c1zcz4wmkeafkpmkdvqq.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">si las variables locales </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageURL</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aspectoRatio</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no </font><b><font color="#0000FF"><font style="vertical-align: inherit;">son </font></font></b></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulas</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , preguntaremos el contexto del </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">marcador de posici√≥n de marcador de posici√≥n de</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contexto </font><font style="vertical-align: inherit;">utilizando el m√©todo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commitInsertion</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d√©nos la oportunidad de cambiar nuestro modelo de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/z6/hm/8w/z6hm8w4jnyrwxgx2g8v9sfnfiuq.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en esta expresi√≥n, tenemos </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insertionIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : este es el </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para insertar, y cambiamos nuestro modelo de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Eso es todo lo que necesitamos hacer, y este m√©todo reemplazar√° AUTOM√ÅTICAMENTE un marcador de posici√≥n </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">con una </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">celda</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> llamando al m√©todo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cellForItemAt</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> normal </font><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tenga en cuenta que </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insertionIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> puede ser muy diferente de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">destinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font> Por qu√©<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Debido a que el muestreo de datos puede tomar 10 segundos, por supuesto, es poco probable, pero puede tomar 10 segundos. Durante este tiempo, </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pueden pasar muchas cosas </font><font style="vertical-align: inherit;">en la colecci√≥n </font><font style="vertical-align: inherit;">. Puede a√±adir nuevas c√©lulas de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">las c√©lulas</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , todo ocurre lo suficientemente r√°pido. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIEMPRE use </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insertionIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , y SOLAMENTE </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insertionIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , para actualizar su Modelo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øC√≥mo actualizamos nuestro modelo? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Insertamos en la matriz </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageGallery.images</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> estructura </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagemodel</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , compuesto por la relaci√≥n de aspecto </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aspectRatio</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y la imagen URL </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageURL</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que nos dio vuelta los correspondientes </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seg√∫n el proveedor</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esto actualiza nuestro modelo de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">galer√≠a de im√°genes</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , y el m√©todo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commitInsertion</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hace el resto por nosotros. Ya no necesita hacer nada extra, sin inserciones, sin eliminaciones, nada de esto. Y, por supuesto, dado que estamos en un cierre, necesitamos </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">agregarnos.</font></font></font></b>  . <br><br><img src="https://habrastorage.org/webt/rm/ff/nx/rmffnxnhy_1k1ukzub6ni468z6g.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si estamos por alguna raz√≥n no pueda obtener la relaci√≥n de aspecto </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aspectRatio</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la imagen </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageURL</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a partir del correspondiente </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seg√∫n el proveedor</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , se podr√≠a haber recibido un error </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de error</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en lugar de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">por el proveedor</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tenemos que hacerles saber el contexto </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">placeholderContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , es necesario destruir este un marcador de posici√≥n </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, porque todos somos lo mismo, no podemos obtener otros datos: </font></font><br><br><img src="https://habrastorage.org/webt/gw/tm/jj/gwtmjjywumpq4o7czavwnrcweay.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">una cosa a tener en cuenta es </font></font><code>URLs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que provienen de lugares como este </font></font><code>Google</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; en realidad, necesitan transformaciones menores para "limpiarse"</font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para la imagen Se puede ver c√≥mo se resuelve este problema en esta aplicaci√≥n de demostraci√≥n en un archivo </font></font><code>Utilities.swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por lo tanto, cuando recibimos una </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagen, usamos la propiedad </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageURL</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de la clase </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">URL</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/v5/cq/dc/v5cqdcxzqnwybov4eiklwlkt2o8.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y eso es todo lo que necesitas hacer para aceptar FUERA de algo dentro de la colecci√≥n </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vamos a verlo en acci√≥n. Lanzamos simult√°neamente en modo multitarea nuestra aplicaci√≥n de demostraci√≥n </font></font><code>ImageGallery</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font><code>Safari</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">con un motor de b√∫squeda </font></font><code>Google</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. En </font></font><code>Google</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">buscamos im√°genes sobre el tema de "Dawn" (amanecer). En </font></font><code>Safari</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ya construido</font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">el mecanismo, para que podamos seleccionar una de estas im√°genes, mantenerla presionada durante mucho tiempo, moverla un poco y arrastrarla a nuestra Galer√≠a de im√°genes. </font></font><br><br><img src="https://habrastorage.org/webt/au/t9/wk/aut9wky03l29lkgj9g7l1ulifmc.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La presencia de un signo m√°s verde "+" indica que nuestra aplicaci√≥n est√° lista para aceptar una imagen de terceros y copiarla en su colecci√≥n en la ubicaci√≥n especificada por el usuario. Despu√©s de "restablecerlo", lleva un tiempo descargar la imagen, y en este momento funciona </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: una </font></font><br><br><img src="https://habrastorage.org/webt/ge/e-/n0/gee-n08qnm7zc5ofbgr3e4o8df8.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vez completada la descarga, la imagen "restablecer" se coloca en el lugar correcto y </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">desaparece: </font></font><br><br><img src="https://habrastorage.org/webt/m8/rb/nq/m8rbnqvi2x0s3as4w_fzpjpltae.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">podemos continuar "restableciendo" las im√°genes y colocarlas en nuestro colecciones de a√∫n m√°s im√°genes: </font></font><br><br><img src="https://habrastorage.org/webt/x8/np/bq/x8npbqpkm9af1_ybkxhw13kjhug.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">despu√©s del trabajo de "reinicio" </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/b2/lq/hb/b2lqhbg6smc2mvvvjp0copbvfmu.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como resultado, nuestra Galer√≠a de im√°genes se llena de nuevas im√°genes:</font></font><br><br><img src="https://habrastorage.org/webt/lf/jl/mq/lfjlmqca5iqv26l0woi-htqldcq.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahora que est√° claro que somos capaces de tomar fotograf√≠as desde el exterior, no necesitamos la imagen de prueba, y quitaremos: </font></font><br><br><img src="https://habrastorage.org/webt/bv/0t/az/bv0tazx3cjushm1rkcfalu-m1au.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nuestro </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">viewDidLoad</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se vuelve muy simple: es que estamos haciendo nuestra </font></font><code>Controller</code> <code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">delegar y a√±adimos reconocedor gesto de </font></font><b><font color="#FF00FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pellizco</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que regula el n√∫mero de im√°genes por l√≠nea: </font></font><br><br><img src="https://habrastorage.org/webt/ei/fo/1b/eifo1bz0szfk12tuqfseh5fser8.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por supuesto , podemos agregar un cach√© para </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">las</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> im√°genes de </font><b><font color="#0000FF"><font style="vertical-align: inherit;">imageCache</font></font></b><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/f4/oi/ql/f4oiql_gjnka7racbmkrts7mbja.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rellenaremos el </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageCache</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cuando se "restablezca" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en el m√©todo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ... </font></font><br><br><img src="https://habrastorage.org/webt/xy/hc/bt/xyhcbtodifjiqgd5norskny9cge.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y cuando se recupere de la "red" en la clase personalizada </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageCollectionViewCell</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/nk/sl/2s/nksl2sw3dujz-_z7fmp55zixfzi.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y usaremos el cach√© de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageCache</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> al reproducir una celda</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">celda de</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nuestra Galer√≠a de im√°genes en la clase personalizada</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ImageCollectionViewCell</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><img src="https://habrastorage.org/webt/-5/ar/zo/-5arzoeghtoj_ckv-ezxhpu403c.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahora comenzamos con una colecci√≥n vac√≠a ...</font></font><br><br><img src="https://habrastorage.org/webt/rl/bq/vn/rlbqvnpsww27j5xbryp9vlgng1a.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... luego "soltamos" una nueva imagen en nuestra colecci√≥n ...</font></font><br><br><img src="https://habrastorage.org/webt/9j/7o/es/9j7oesf_b-rk-dj-s9ysujlkte0.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... la imagen se carga y</font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">funciona ...</font></font><br><br><img src="https://habrastorage.org/webt/tg/s7/6t/tgs76tffgkarqkpzhamq97ebvio.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... y la imagen aparece en el lugar correcto:</font></font><br><br><img src="https://habrastorage.org/webt/ps/uy/z8/psuyz8apr4zpulpgpl5z-hsegfy.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Continuamos llenando nuestra colecci√≥n FUERA:</font></font><br><br><img src="https://habrastorage.org/webt/it/ve/_y/itve_yuqqnffh8zyzlpmj_vvske.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Viene cargar im√°genes</font></font><code>Placeholders</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">funciona ...</font></font><br><br><img src="https://habrastorage.org/webt/li/rx/wd/lirxwd74znfsvgrtjkpg3gfvl8u.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y las im√°genes aparecen en el lugar correcto: por lo</font></font><br><br><img src="https://habrastorage.org/webt/uq/j0/as/uqj0asiyqcpqosl8x-3akydb3x0.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tanto, podemos hacer mucho con nuestra Galer√≠a de im√°genes: llenarla EXTERIOR, reorganizar elementos INTERIORES, compartir im√°genes con otras aplicaciones niyami</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solo tenemos que ense√±arle c√≥mo deshacerse de las im√°genes innecesarias al "restablecerlas"</font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en la "papelera" presentada en la barra de navegaci√≥n a la derecha. </font><font style="vertical-align: inherit;">Como se describe en la secci√≥n "Caracter√≠sticas de la aplicaci√≥n de demostraci√≥n de la galer√≠a de im√°genes", el "bote de basura" est√° representado por la clase </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GabageView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que hereda de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y debemos ense√±arle a aceptar im√°genes de nuestra colecci√≥n </font></font><code>ollection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Restablecer </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">im√°genes de la Galer√≠a a la papelera.</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inmediatamente del lugar - a la cantera. Voy a a√±adir a </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GabageView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "interacci√≥n" </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interacci√≥n</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y ser√° </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIDropInteraction</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ya que estoy tratando de "reset" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">algunas cosas. Todo lo que necesitamos para proporcionar esta </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIDropInteraction</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es un delegado </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">delegado</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , y me voy a asignar yo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mismo</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a este delegado </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">delegado</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/mm/tq/xn/mmtqxnmypbysaik9fjd3r2amrlg.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Naturalmente, nuestra clase </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GabageView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> debe confirmar que estamos implementando el protocolo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIDropInteractionDelegate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/nv/xy/vw/nvxyvwya12ggtiznb1byxq5vorm.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">todo lo que debemos hacer para que funcione </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, esto es para implementar los m√©todos </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">canHandle</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que ya conocemos </font><font style="vertical-align: inherit;">,</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sessionDidUpdate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><img src="https://habrastorage.org/webt/jg/m9/ol/jgm9olzkrnv_fmu0mwesx91dvsq.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sin embargo, a diferencia de m√©todos similares para la recolecci√≥n</font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, no tenemos ninguna informaci√≥n adicional en forma de un</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> IndexPath del</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lugar de descarga.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementemos estos m√©todos.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dentro del m√©todo</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> canHandle</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ser√° procesada s√≥lo el "arrastrar y soltar"</font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, que representan la imagen</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> un UIImage</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Por lo tanto,</font><font style="vertical-align: inherit;">solo</font><font style="vertical-align: inherit;">devolver√©</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verdadero</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> si</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> session.canLoadObjects (ofClass: UIImage.self)</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><img src="https://habrastorage.org/webt/if/z7/yo/ifz7yoibzsugla3mj7kat1cylt8.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en el m√©todo</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> canHandle</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font><font style="vertical-align: inherit;">esencialmente solo dice que si el objeto "arrastrable" no es una imagen</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> UIImage</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, entonces, adem√°s, no tiene sentido continuar la ca√≠da de "restablecimiento" y llamar a los m√©todos posteriores. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si el objeto "arrastrable" es una imagen </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIImage</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ejecutaremos el m√©todo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sessionDidUpdate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Todo lo que necesitamos hacer en este m√©todo es devolver nuestra </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oferta de</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "reinicio" de </font><b><font color="#0000FF"><font style="vertical-align: inherit;">UIDropProposal</font></font></b></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Y estoy listo para aceptar solo el objeto "arrastrado" LOCALMENTE </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIImage</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> TYPE </font><font style="vertical-align: inherit;">que se puede "soltar" en </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cualquier lugar dentro de mi </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GarbageView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Mi </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GarbageView</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no interactuar√° con im√°genes volcadas FUERA. As√≠ que estoy analizando usando la variable </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">session.localDragSession</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">si hay un "reinicio" local </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, y devuelvo la oraci√≥n "reinicio" en forma del constructor </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIDropProposal</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> con el argumento de la </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">operaci√≥n</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tomando el valor </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.copy</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , porque SIEMPRE LOCAL "arrastrar y soltar" </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en mi aplicaci√≥n vendr√° de la colecci√≥n </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Si "arrastrar </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font><font style="vertical-align: inherit;">soltar" </font><font style="vertical-align: inherit;">y "restablecer" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ocurren FUERA, entonces devuelvo la frase "restablecer" en forma del constructor </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIDropProposal</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> con el argumento de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">operaci√≥n</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tomando el valor </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.fobbiden</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , es decir, "prohibido" y obtendremos un signo de prohibici√≥n "restablecer" en lugar del signo m√°s verde . </font></font><br><br><img src="https://habrastorage.org/webt/ii/vd/wy/iivdwy9av6cxwzjkeay9kf87lby.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Copiar una imagen </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIImage</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, simularemos una disminuci√≥n en su escala a casi 0, y cuando ocurra el "reinicio", eliminaremos esta imagen de la colecci√≥n </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para crear el usuario la ilusi√≥n de "reinicio, y la desaparici√≥n de" imagen en el "cubo de basura", se utiliza un nuevo m√©todo para nosotros </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">previewForDropping</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que le permite redirigir el "reinicio" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en otro lugar y al mismo tiempo transformar el objeto "desechable" durante la animaci√≥n: </font></font><br><br><img src="https://habrastorage.org/webt/e7/ej/zb/e7ejzbhlfzjxrkxsjupt9hiewz4.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En En este m√©todo, usando el inicializador </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIDragPreviewTarget,</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> obtenemos una nueva vista </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">previa</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para que el objeto de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">destino</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se descarte </font><font style="vertical-align: inherit;">y lo redirigimos usando el m√©todo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retargetedPreview</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a un nuevo lugar, al "bote de basura", con su escala reducida a casi cero: </font></font><br><br><img src="https://habrastorage.org/webt/bu/zp/av/buzpavo-rn6n2eoeztccvman6r0.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">si el usuario levanta un dedo hacia arriba, se produce un "reinicio" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, y yo (como </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GarbageView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) recibo un mensaje </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . En el mensaje </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop,</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> realizamos el "reset" real </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Honestamente, la </font><font style="vertical-align: inherit;">imagen que se </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">volc√≥</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en </font><b><font color="#0000FF"><font style="vertical-align: inherit;">GarbageView</font></font></b><font style="vertical-align: inherit;"> ya no nos interesa, ya que la haremos pr√°cticamente invisible, lo m√°s probable es que el hecho mismo de completar el "reinicio" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indique que eliminamos esta imagen de la colecci√≥n </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Para lograr esto, debemos conocer la colecci√≥n en s√≠ </font><font style="vertical-align: inherit;">y la </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">colecci√≥n </font></font></font></b><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagen descartada en ella. ¬øDe d√≥nde podemos conseguirlos? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Debido a que el proceso </font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se lleva a cabo en una sola aplicaci√≥n, que est√° disponible para todos nosotros los locales: local de </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sesi√≥n </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localDragSession</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nuestra </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sesi√≥n de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la sesi√≥n</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , el contexto local </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que es nuestra colecci√≥n de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sollectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y objeto local </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localobject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , lo que podemos hacer por s√≠ mismo se restablece la imagen </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagen</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de la "Galer√≠a" o </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Debido a esto podemos obtener en el m√©todo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> clase </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GarbageView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> colecci√≥n </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">colecci√≥n</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , y su uso</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dataSource</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> c√≥mo</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ImageGalleryCollectionViewController</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y modelo</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> imageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nuestra</font></font><code>Controller</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, podemos obtener una serie de im√°genes de</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> im√°genes</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> TIPO [ImageModel]:</font></font><br><br><img src="https://habrastorage.org/webt/3t/tj/kr/3ttjkr1cuyqxh4v3islcmsofjhy.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Con la ayuda del local de</font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la sesi√≥n</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> localDragSession</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nuestra</font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sesi√≥n de</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> la sesi√≥n</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hemos sido capaces de conseguir todo el "arrastre" en la</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GarbageView</font></font></font></b> <code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> elementos de</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> art√≠culos</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , y puede haber una gran cantidad, tal como la conocemos, y Todos ellos son im√°genes de nuestra</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> colecci√≥n collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Creaci√≥n de</font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">elementos de</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dragItems</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nuestra colecci√≥n</font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, hemos proporcionado para cada "arrastre"</font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">elemento</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dragItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> objeto local</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> localobject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que es la imagen de</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> la imagen</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pero es que no vienen muy bien durante la recolecci√≥n de reorganizaci√≥n interna</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CollectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pero el "reset" Galer√≠a de im√°genes "bote de basura" que necesitan desesperadamente en la instalaci√≥n local de</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> localobject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "arrastrar" objeto</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dragItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , despu√©s de todo este tiempo no tenemos un</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> coordinador</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que generosamente comparte informaci√≥n sobre lo que est√° sucediendo en la colecci√≥n</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Por lo tanto, queremos que el objeto local</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> localobject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √≠ndice fue</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en la matriz de la imagen</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> im√°genes</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de nuestros modelos</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Hacer los cambios necesarios en el m√©todo</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dragItems (en indexPath: IndexPath)</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> clase</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ImageGalleryCollectionViewController</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><img src="https://habrastorage.org/webt/le/iy/hz/leiyhzxv04brlhk6nlhpakw4bek.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahora que podemos tomar cada "pretaskivaemogo" elemento de</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> elemento</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> localobject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que es el √≠ndice</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en la matriz de la imagen</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> im√°genes</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de nuestros modelos</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> galer√≠a de im√°genes</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , y enviarlo a los √≠ndices de matriz</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √≠ndices</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y matriz de</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indexPahes de</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> im√°genes eliminadas:</font></font><br><br><img src="https://habrastorage.org/webt/ci/cf/uo/cicfuo7gxvbmh7ddvjj2maorfog.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conocer la matriz de √≠ndices</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √≠ndices</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y la matriz de</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indexPahes de</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> im√°genes eliminadas, en el m√©todo</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> performBatchUpdates</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">colecci√≥n </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">colecci√≥n</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que eliminar todas las im√°genes borradas de los modelos de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">las im√°genes</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y de la colecci√≥n de la </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">colecci√≥n</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/2t/49/i4/2t49i4wwgqlz-vqqpalim8m4h4u.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ejecutar la aplicaci√≥n, llenar la galer√≠a con nuevas im√°genes: </font></font><br><br><img src="https://habrastorage.org/webt/vj/kb/v5/vjkbv5nwenjhacglkmksbto5jh0.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seleccione un par de im√°genes que queremos eliminar de nuestra galer√≠a ... </font></font><br><br><img src="https://habrastorage.org/webt/cm/-e/t1/cm-et1fd2cp7pext2src2vddkmm.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... "tirar" de ellos en el icono con el "cubo de basura" ... </font></font><br><br><img src="https://habrastorage.org/webt/yw/l3/ue/ywl3ue6tusekuyqvpjv3n4pn1xy.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se redujo casi a 0 ... </font></font><br><br><img src="https://habrastorage.org/webt/14/6r/nd/146rndccir7ou4z5zitpj9gv4ek.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... y desaparecer de la colecci√≥n </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, escondi√©ndose en el "bote de basura":</font></font><br><br><img src="https://habrastorage.org/webt/1x/b_/zw/1xb_zw27xn-2yp7lb7tvlpgm_fc.png"><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Guardar im√°genes entre inicios. </font></font></h1><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para guardar la Galer√≠a de im√°genes entre ejecuciones, usaremos </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserDefaults</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , despu√©s de convertir nuestro Modelo a un </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">formato. Para ello, a√±adiremos a nuestra </font></font><code>Controller</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">variable de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">defailts var</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ... </font></font><br><br><img src="https://habrastorage.org/webt/wy/cg/vy/wycgvy5krdrmfiugzp9dgykaphe.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">..., y en el modelo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageModel</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> protocolo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">codificable</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/j2/vv/w6/j2vvw62tiuud6eidtx1n9ipeq0w.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cadena </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de cuerda</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , las matrices de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la matriz</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la URL</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">doble</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ya est√°n implementando el protocolo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">codificable</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , por lo que no tenemos otra cosa que hacer para llegar a la codificaci√≥n de trabajo y decodificar en </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">modelos</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ImageGallery </font><font style="vertical-align: inherit;">en </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">formato.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øC√≥mo obtenemos la </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">versi√≥n de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para crear este ampliado variable de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSON var</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que devuelve el resultado de los intentos de convertir en s√≠, </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s√≠</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , a trav√©s de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSONEncoder.encode ()</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en el </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">formato: </font></font><br><br><img src="https://habrastorage.org/webt/f6/o3/hz/f6o3hzee-7hryaxadmzf--0jeym.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y eso es todo. Cualquiera de los </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datos</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se devolver√° </font><font style="vertical-align: inherit;">como resultado de la conversi√≥n de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uno mismo</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> al formato </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, o </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> si esta conversi√≥n falla, aunque esto √∫ltimo nunca ocurre, porque este TIPO es 100% </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Codificable</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . La </font><font style="vertical-align: inherit;">variable </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">opcional </font></font></font></b><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">json</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se usa </font><font style="vertical-align: inherit;">solo por razones de simetr√≠a.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahora tenemos una manera de convertir los modelos de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a </font><font style="vertical-align: inherit;">formato de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">datos</font></font></font></b><font style="vertical-align: inherit;"></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øLa</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> variable </font><b><font color="#0000FF"><font style="vertical-align: inherit;">json</font></font></b><font style="vertical-align: inherit;"> tiene un tipo de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">datos?</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que se puede recordar en </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserDefaults</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahora imagine que de alguna manera logramos obtener los </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">datos </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">json</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , y me gustar√≠a recrear a partir de ellos nuestro Modelo, una instancia de la estructura de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Para hacer esto, es muy f√°cil escribir un INICIALIZADOR para </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , cuyo argumento de entrada son </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">datos </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">json</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Este inicializador ser√° un inicializador "en ca√≠da"</font></font><code>failable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) Si no se puede inicializar, se bloquea y devuelve </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nil</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/g7/0n/l4/g70nl4mxpadtrajaq7y-ec4f6bw.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solo obtengo el valor </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">newValue</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usando el decodificador </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSONDecoder</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tratando de decodificar los datos </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">json</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que se pasan a mi inicializador, y luego lo asigno yo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mismo</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si logr√© hacer esto, entonces obtengo una nueva instancia de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pero si mi intento falla, entonces devuelvo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nada</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ya que mi inicializaci√≥n "fall√≥". </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Debo decir que aqu√≠ tenemos muchas m√°s razones para "fallar" ( </font></font><code>fail</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), porque es muy posible que los </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">datos </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">json</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">puede estropearse o vaciarse, todo esto puede conducir a la "ca√≠da" ( </font></font><code>fail</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) del inicializador. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahora podemos aplicar la LEA </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">datos y modelo de recuperaci√≥n </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> el m√©todo </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">viewWillAppear</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nuestra </font></font><code>Controller</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... </font></font><br><br><img src="https://habrastorage.org/webt/gw/n2/u-/gwn2u-zkggggk2vuwfi-czhycdq.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... as√≠ como una entrada en el observador </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">didSet {}</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> propiedades </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">galer√≠a de im√°genes</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/-g/bc/yz/-gbcyzh4t5innabrtcbxdmdh3wq.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vamos a ejecutar la aplicaci√≥n y llenar nuestra galer√≠a de im√°genes: </font></font><br><br><img src="https://habrastorage.org/webt/le/t5/wr/let5wryw9nwf-ahnij7f_wltztc.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si cerramos la aplicaci√≥n y abrirlo de nuevo, podemos ver nuestra galer√≠a anterior Im√°genes guardadas en </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserDefaults</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Conclusi√≥n </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este art√≠culo demuestra lo f√°cil que es integrar tecnolog√≠a </font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en una </font></font><code>iOS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aplicaci√≥n </font><font style="vertical-align: inherit;">utilizando el ejemplo de una aplicaci√≥n de demostraci√≥n muy simple "Galer√≠a de im√°genes" </font><font style="vertical-align: inherit;">. Esto hizo posible editar completamente la Galer√≠a de im√°genes, "arrojando" nuevas im√°genes de otras aplicaciones all√≠, moviendo las existentes y eliminando las innecesarias. Y tambi√©n para distribuir im√°genes acumuladas en la Galer√≠a a otras aplicaciones. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por supuesto, nos gustar√≠a crear muchas de estas pintorescas colecciones tem√°ticas de im√°genes y guardarlas directamente en el iPad o iCloud Drive. Esto se puede hacer si cada galer√≠a se interpreta como un documento </font><b><font color="#0000FF"><font style="vertical-align: inherit;">UID</font></font></b><font style="vertical-align: inherit;"> almacenado permanentemente</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Tal interpretaci√≥n nos permitir√° elevarnos al siguiente nivel de abstracci√≥n y crear una aplicaci√≥n que funcione con documentos. </font><font style="vertical-align: inherit;">En tal aplicaci√≥n, sus documentos ser√°n mostrados por el componente </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DocumentBrowserViewController</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , muy similar a la aplicaci√≥n </font></font><code>Files</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Le permitir√° crear </font><font style="vertical-align: inherit;">im√°genes de </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIDocument</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> del tipo "Galer√≠a de im√°genes" tanto en su </font></font><code>iPad</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">como en √©l </font></font><code>iCloud Drive</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, as√≠ como seleccionar el documento deseado para ver y editar. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pero este es el tema del pr√≥ximo art√≠culo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PD El c√≥digo de la aplicaci√≥n de demostraci√≥n antes de la implementaci√≥n del mecanismo </font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y despu√©s est√° en </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Github</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><br></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es425817/">https://habr.com/ru/post/es425817/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es425807/index.html">Complejidad de sistemas y m√©todos de "lucha" con √©l</a></li>
<li><a href="../es425809/index.html">Aprendiendo lenguajes de programaci√≥n en el proceso: desarrollador de software sobre proyectos complejos</a></li>
<li><a href="../es425811/index.html">Otro problema con la pantalla del MacBook Pro</a></li>
<li><a href="../es425813/index.html">CICD: implementaci√≥n perfecta en sistemas de cl√∫ster distribuidos sin tiempo de inactividad</a></li>
<li><a href="../es425815/index.html">Qui√©n no necesita SEO, c√≥mo elegir un optimizador y probar su trabajo</a></li>
<li><a href="../es425819/index.html">GitLab 11.3 lanzado con repositorio Maven y entornos seguros</a></li>
<li><a href="../es425821/index.html">C√≥mo convertirse en desarrollador de React en 2018</a></li>
<li><a href="../es425823/index.html">Estad√≠sticas de OPI 2018: $ 45 mil millones recaudados, Dropbox recaud√≥ menos dinero que las compa√±√≠as farmac√©uticas y los vendedores de bienes ra√≠ces</a></li>
<li><a href="../es425827/index.html">Lecci√≥n de Google+: los proyectos deben garantizar que los l√≠mites entre los intereses de los usuarios en la vida real se respeten en l√≠nea</a></li>
<li><a href="../es425829/index.html">C√≥mo peleamos con Roskomnadzor y qu√© sali√≥ de eso</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>