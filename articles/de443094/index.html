<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§° üöú üëºüèª Einrichten eines CUPS-Druckservers von Grund auf mit und ohne Dom√§nenautorisierung in einem Netzwerk mit verschiedenen Betriebssystemen üïí üòß üëÉ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Einrichten eines CUPS-Druckservers von Grund auf mit und ohne Dom√§nenautorisierung in einem Netzwerk mit verschiedenen Betriebssystemen 
 Eintrag 


 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Einrichten eines CUPS-Druckservers von Grund auf mit und ohne Dom√§nenautorisierung in einem Netzwerk mit verschiedenen Betriebssystemen</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/443094/"><h2 id="nastroyka-s-nulya-printservera-cups-s-domennoy-avtorizaciey-i-bez-nee-v-seti-s-raznymi-os">  Einrichten eines CUPS-Druckservers von Grund auf mit und ohne Dom√§nenautorisierung in einem Netzwerk mit verschiedenen Betriebssystemen </h2><br><h3 id="vstuplenie">  Eintrag </h3><br><p>  Also.  Vermutlich ist der CUPS-Druckdienst eine leistungsstarke L√∂sung, mit der Sie die zentrale Druckermanagement im Unternehmen organisieren k√∂nnen.  So ist es auch, aber w√§hrend des Einrichtungsprozesses m√ºssen Sie einige Zeit damit verbringen, nach einer L√∂sung f√ºr die vielen kleinen, nicht offensichtlichen Probleme von Google zu suchen, insbesondere wenn Ihre Anforderungen √ºber die Standard-Einrichtungshandb√ºcher hinausgehen. </p><br><p>  In diesem Artikel wird die Installation des CUPS-Druckservers unter Ubuntu Server in einem Netzwerk mit einer funktionierenden Active Directory-Dom√§ne beschrieben, obwohl seine Anwesenheit v√∂llig optional ist und Sie die Anweisungen zum Einrichten der Interaktion mit ihm, zum Einrichten sowie zum Einrichten von Linux- und Windows-Clientcomputern f√ºr die Interaktion sicher √ºberspringen k√∂nnen dieser Druckserver. </p><a name="habracut"></a><br><p>  In den Anweisungen wird die Dom√§ne als <strong>example.com bezeichnet</strong> , der Druckserver selbst ist <strong>cupsserver</strong> ( <strong>cupsserver.example.com</strong> ) mit einer IP-Adresse von 10.10.100.50 und die Clientcomputer <strong>Linux1</strong> , <strong>Linux2</strong> , <strong>Linux3</strong> usw. f√ºr Clientcomputer Linux und <strong>Windows1</strong> , <strong>Windows2</strong> , <strong>Windows3</strong> und usw.  f√ºr Windows-Client-Computer. </p><br><h3 id="nastroyka-printservera">  Einrichten eines Druckservers </h3><br><p>  Zun√§chst konfigurieren wir den Druckserver oder konfigurieren den Administratorzugriff darauf, konfigurieren dann den Druck darauf und beschreiben dann die Konfiguration der Clientcomputer. </p><br><p>  Wir gehen auf bequeme Weise zum Druckserver und aktualisieren die Pakete darauf: </p><br><pre><code class="plaintext hljs">root@cupsserver:~# apt update &amp;&amp; apt uprgrade -y</code> </pre> <br><p>  √úberpr√ºfen Sie als N√§chstes, ob CUPS auf dem Server installiert ist: </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# which cupsd</code> </pre> <br><p>  Wenn die Ausgabe ungef√§hr so ‚Äã‚Äãaussieht: </p><br><pre> <code class="plaintext hljs">/usr/bin/cupsd</code> </pre> <br><p>  dann wird CUPS installiert. Wenn keine Ausgabe erfolgt, installieren Sie CUPS: </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# apt install cups -y</code> </pre> <br><p>  Konfigurieren Sie nun den Administratorzugriff auf die CUPS-Weboberfl√§che.  Alle Konfigurationsdateien befinden sich im Pfad <em>/ etc / cups /</em> .  Zun√§chst werden wir f√ºr alle F√§lle die wichtigsten CUPS-Konfigurationsdateien sichern: </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# cp /etc/cups/cupsd.conf /etc/cups/cupsd.conf.original root@cupsserver:~# cp /etc/cups/cups-files.conf /etc/cups/cups-files.conf.original root@cupsserver:~# cp /etc/cups/cups-browsed.conf /etc/cups/cups-browsed.conf.original</code> </pre> <br><p>  Wenn Sie dies jedoch nicht getan haben, spielt es keine Rolle, dass sich die Beispieldatendateien standardm√§√üig entlang des Pfads <em>/ usr / share / cups befinden</em> .  Erw√§hnenswert ist auch, dass Sie alle hinzugef√ºgten Optionen in den CUPS-Konfigurationsdateien mit dem folgenden Befehl √ºberpr√ºfen k√∂nnen: </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# cupsd -t</code> </pre> <br><p>  Wenn Sie etwas durcheinander gebracht, versiegelt oder eine Option verwendet haben, die von CUPS nicht mehr unterst√ºtzt wird, werden diese Fehler in der Ausgabe des Befehls angezeigt. </p><br><p>  Aber zum Schluss wollen wir uns einrichten.  Nach √Ñnderungen an den Dateien im Ordner <em>/ etc / cups /</em> m√ºssen Sie den CUPS-Dienst neu starten, um den folgenden Effekt zu erzielen: </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# service cups restart  root@cupsserver:~# systemctl restart cups  root@cupsserver:~# /etc/init.d/cups restart</code> </pre> <br><p>  Und wenn Sie die Datei <em>/etc/cups/cups-browsed.conf</em> bearbeitet <em>haben</em> , ist ein separater, von <strong>Cups durchsuchter</strong> Dienst daf√ºr verantwortlich, der ebenfalls neu gestartet werden muss: </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# service cups-browsed restart  root@cupsserver:~# systemctl restart cups-browsed  root@cupsserver:~# /etc/init.d/cups-browsed restart</code> </pre> <br><p>  F√ºhren Sie den Befehl aus </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# nano /etc/cups/cupsd.conf</code> </pre> <br><p>  Die erste unkommentierte Option ist </p><br><pre> <code class="plaintext hljs">LogLevel warn</code> </pre> <br><p>  Es bestimmt den minimalen Informationsgehalt von CUPS-Protokollen.  CUPS-Protokolldateien befinden sich unter <em>/ var / log / cups /</em> .  Zum Zeitpunkt der Installation, Konfiguration und des Debuggens des Druckservers ist es ratsam, die Protokollierung in den Debug-Modus zu versetzen.  √Ñndern Sie dazu warn in debug2: </p><br><pre> <code class="plaintext hljs">LogLevel debug2</code> </pre> <br><p>  Standardm√§√üig wartet CUPS nur auf eingehende Verbindungen von <strong>localhost</strong> , <strong>dh</strong> auf der Loopback-Schnittstelle.  Um dies sicherzustellen, k√∂nnen Sie den Befehl ausf√ºhren </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# netstat -plutn</code> </pre> <br><p>  Eine der Zeilen sieht ungef√§hr so ‚Äã‚Äãaus: </p><br><pre> <code class="plaintext hljs">tcp 0 0 127.0.0.1:631 0.0.0.0:* LISTEN 737/cupsd</code> </pre> <br><p>  Weitere Aktionen h√§ngen vom Grad Ihrer Paranoia ab.  Sie k√∂nnen im Block, der bedingt mit dem Kommentar <strong>#Nur auf Verbindungen vom lokalen Computer warten,</strong> mehrere Zeilen hinzuf√ºgen, die IP-Adressen oder Subnetze angeben, von denen aus CUPS Verbindungen abh√∂ren darf. </p><br><pre> <code class="plaintext hljs"># Only listen for connections from the local machine. Listen localhost:631 Listen /run/cups/cups.sock #    IP  Listen 10.10.100.67:631 #     Listen 172.16.0.0:631</code> </pre> <br><p>  Oder Sie k√∂nnen CUPS erlauben, Verbindungen von allen Adressen abzuh√∂ren </p><br><pre> <code class="plaintext hljs"># Only listen for connections from the local machine. Listen /run/cups/cups.sock Port 631</code> </pre> <br><p>  Der n√§chste Konfigurationspunkt ist die Erkennung von Netzwerk- und gemeinsam genutzten Druckern. </p><br><pre> <code class="plaintext hljs"># Show shared printers on the local network. Browsing Off BrowseLocalProtocols dnssd</code> </pre> <br><p>  Meiner Meinung nach sollte diese Option deaktiviert bleiben, da sie bestimmt, ob Broadcast-Informationen √ºber an den Druckserver angeschlossene Drucker √ºber das Netzwerk gesendet werden.  Aber sie werden alle damit verbunden sein.  Dementsprechend werden auf allen Client-Computern sofort alle Drucker angezeigt.  Unser Druckserver sollte alle Drucker im Netzwerk suchen und erkennen, sie jedoch nicht gedankenlos √ºber das Netzwerk senden. </p><br><p>  Im Folgenden sind die Authentifizierungseinstellungen aufgef√ºhrt: </p><br><pre> <code class="plaintext hljs"># Default authentication type, when authentication is required... DefaultAuthType Basic</code> </pre> <br><p>  Definiert Zugriffsrechte auf die CUPS-Weboberfl√§che sowie auf deren administrativen Teil.  Damit der Benutzer das Recht hat, CUPS zu verwalten, muss er der <strong>lpadmin-</strong> Systemgruppe <strong>hinzugef√ºgt</strong> werden: </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# usermod -a -G lpadmin user</code> </pre> <br><p>  Im Allgemeinen werden Gruppen, denen Administratorzugriff auf CUPS <em>gew√§hrt</em> wird, in der Konfigurationsdatei <em>cups-files.conf</em> im Block definiert </p><br><pre> <code class="plaintext hljs"># Administrator user group, used to match @SYSTEM in cupsd.conf policy rules... # This cannot contain the Group value for security reasons... SystemGroup lpadmin</code> </pre> <br><p>  Wenn Sie einer bestimmten Gruppe von Linux-Benutzern Rechte zum Verwalten eines Druckservers hinzuf√ºgen m√∂chten, z. B. <strong>printadmins</strong> , f√ºgen Sie diese einfach mit einem Leerzeichen zu <strong>lpadmin hinzu</strong> .  Wenn die Gruppe eine Dom√§ne ist, ist sie etwas komplizierter und wird sp√§ter beschrieben. </p><br><p>  Fahren wir nun mit dem Block <strong>&lt;Location /&gt; fort</strong> : </p><br><pre> <code class="plaintext hljs"># Restrict access to the server... &lt;Location /&gt; Order allow,deny &lt;/Location&gt;</code> </pre> <br><p>  <strong>Bestellung zulassen, verweigern</strong> bedeutet, dass Verbindungen von √ºberall verboten sind, sofern nicht ausdr√ºcklich die Erlaubnis angegeben ist.  Das hei√üt, Sie m√ºssen IP-Adressen, Subnetze, Hosts oder Hosts nach Maske ( <em><strong>.example.com</strong> ) in der Form "</em> Zulassen von [zul√§ssige Adresse] *" hinzuf√ºgen: </p><br><pre> <code class="plaintext hljs"># Restrict access to the server... &lt;Location /&gt; Order allow,deny Allow from cupsserver #         Allow from cupsserver.example.com #       FQDN Allow from localhost #       loopback  Allow from 10.10.100.* #    Allow from linux4.example.com #     Allow from 172.168.5.125 #  , IP   &lt;/Location&gt;</code> </pre> <br><p>  F√ºr volles Vertrauen und Debugging k√∂nnen Sie, bis Sie alles andere konfiguriert haben, ein Design belassen, das das Drucken von √ºberall aus erm√∂glicht: </p><br><pre> <code class="plaintext hljs"># Restrict access to the server... &lt;Location /&gt; Order allow,deny Allow from all &lt;/Location&gt;</code> </pre> <br><p>  Richten wir den Administratorzugriff auf CUPS auf dem Druckserver ein.  Entscheiden Sie, zu welchen IPs und / oder Subnetzen Sie von CUPS aus eine Verbindung herstellen m√∂chten, und f√ºgen Sie sie analog zum Block <strong>&lt;Location /&gt; hinzu</strong> : </p><br><pre> <code class="plaintext hljs"># Restrict access to the admin pages... &lt;Location /admin&gt; Order allow,deny Allow from localhost Allow from 10.10.100.* Allow from admin.example.com &lt;/Location&gt; # Restrict access to configuration files... &lt;Location /admin/conf&gt; Order allow,deny Allow from localhost Allow from 10.10.100.* Allow from admin.example.com &lt;/Location&gt; # Restrict access to log files... &lt;Location /admin/log&gt; Order allow,deny Allow from localhost Allow from 10.10.100.* Allow from admin.example.com &lt;/Location&gt;</code> </pre> <br><p>  Optional k√∂nnen Sie die Standardschnittstellensprache hinzuf√ºgen.  Die Liste der verf√ºgbaren Sprachen kann mit dem folgenden Befehl angezeigt werden: </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# ls /usr/share/cups/locale</code> </pre> <br><p>  Wenn die Lokalisierung, die Sie ben√∂tigen, z. B. <strong>ru</strong> , lautet, f√ºgen Sie eine Zeile zu <em>/etc/cups/cupsd.conf hinzu</em> : </p><br><pre> <code class="plaintext hljs">DefaultLanguage ru</code> </pre> <br><p>  Damit Ihr Druckserver <strong>cupsserver.example.com</strong> von seinem Host (Hostname) aufgerufen werden kann, m√ºssen Sie eine <em>client.conf-</em> Datei im Ordner <em>/ etc / cups /</em> mit dem folgenden Inhalt erstellen: </p><br><pre> <code class="plaintext hljs">ServerName _</code> </pre> <br><p>  Auf einfachste Weise kann dies folgenderma√üen geschehen: </p><br><pre> <code class="plaintext hljs">root@cupsserver:/etc/cups# echo "ServerName $(cat /etc/hostname)" &gt; /etc/cups/client.conf</code> </pre> <br><p>  Da wir davon ausgehen, dass sich im Netzwerk ein DNS-Server befindet, sollten Sie vorzugsweise √ºber den Dom√§nennamen ( <strong>cupsserver.example.com</strong> ) auf den Druckserver <strong>zugreifen</strong> .  Dem Server kann auch ein CNAME-Alias ‚Äã‚Äãauf dem DNS-Server zugewiesen werden, z. B. <strong>Druck</strong> oder <strong>Tassen</strong> .  Damit der Druckserver bei solchen Aufrufen Verbindungen annehmen kann, m√ºssen Sie der Datei <em>/etc/cups/cupsd.conf</em> die folgende Zeile <em>hinzuf√ºgen</em> : </p><br><pre> <code class="plaintext hljs">ServerAlias cupsserver.example.com print cups</code> </pre> <br><p>  Wenn der Druckserver Anrufe annehmen soll oder sich nicht darum k√ºmmern m√∂chte, k√∂nnen Sie Folgendes hinzuf√ºgen: </p><br><pre> <code class="plaintext hljs">ServerAlias *</code> </pre> <br><p>  Sie m√ºssen auch in die Datei <em>/etc/cups/cups-browsed.conf</em> schauen.  Diese Datei steuert, wie der Druckserver im Netzwerk nach Druckern sucht und seine Drucker sendet.  Ich empfehle, die Newsletter-Option vollst√§ndig zu deaktivieren.  Der Druckserver sucht im Netzwerk nach dem Drucker, aber von dort aus werden die Drucker mit den Client-Computern manuell verbunden.  Nachfolgend wird beschrieben, warum.  In der Zwischenzeit finden wir die Zeile <strong>BrowseRemoteProtocols dnssd cups</strong> : </p><br><pre> <code class="plaintext hljs"># Which protocols will we use to discover printers on the network? # Can use DNSSD and/or CUPS and/or LDAP, or 'none' for neither. BrowseRemoteProtocols dnssd cups</code> </pre> <br><p>  Dank dieser Option sucht der Druckserver im Netzwerk nach freigegebenen Druckern.  Wir lassen es eingeschaltet, da es in unserem Interesse ist, dass der Druckserver den Drucker im Netzwerk durchsucht.  Der Druckserver muss jedoch nicht unbedingt alle angeschlossenen Drucker senden, da sonst gro√üe Verwirrung herrscht.  Um dieses Szenario zu verhindern, suchen Sie die folgende Option <strong>#BrowseLocalProtocols none</strong> und <strong>kommentieren Sie</strong> sie aus: </p><br><pre> <code class="plaintext hljs"># Which protocols will we use to broadcast shared local printers to the network? # Can use DNSSD and/or CUPS, or 'none' for neither. # Only CUPS is actually supported, as DNSSD is done by CUPS itself (we ignore DNSSD in this directive). BrowseLocalProtocols none</code> </pre> <br><p>  In diesem Fall unterbrechen wir die Konfiguration des Druckservers und fahren mit der Konfiguration der Client-Computer Windows und Linux fort.  Folgende Anforderungen werden gestellt: Druckauftr√§ge k√∂nnen an den Druckserver gesendet werden, und Druckauftr√§ge werden (und nur) an den Druckserver gesendet, wenn auf einem Netzwerkdrucker gedruckt werden muss. </p><br><p>  Als Beispiel konfigurieren wir das Drucken √ºber einen Druckserver zwischen zwei Clientcomputern mit Linux (Hostname <strong>Linux1</strong> ) bzw. Windows 8 (Hostname <strong>Windows1</strong> ).  Beginnen wir mit der Konfiguration von <strong>Windows1</strong> als Druckempf√§nger von einem Druckserver.  Ich habe einen Canon i-SENSYS MF4410 Drucker angeschlossen und arbeite normal.  Der Druckername lautet Canon-MF4400.  Der einfachste Weg, um das Drucken von einem Druckserver unter <strong>Windows1 sicherzustellen,</strong> besteht darin, zu <em>Systemsteuerung&gt; Programme&gt; Programme und Funktionen&gt; Windows-Funktionen</em> <strong>ein-</strong> <em>oder auszuschalten</em> .  Dort aktivieren wir <em>die</em> Komponente <em>Druck- und Dokumentendienste&gt; LPD-Druckdienst</em> .  Auf diese Weise k√∂nnen Sie diesen Drucker √ºber die <em>Adresse lpd: // windows1 / Canon-MF4400</em> mit dem <em>Druckserver verbinden</em> .  Nat√ºrlich reift die Frage, warum nicht mit SMB verbinden?  Niemand verbietet.  Wenn Sie diese Methode getestet haben, k√∂nnen Sie den Drucker auf diese Weise freigeben und √ºber das SMB-Protokoll mit dem Druckserver verbinden.  Die Anweisungen f√ºr diesen Zusammenhang gehen meiner Meinung nach √ºber den Rahmen dieses Artikels hinaus, der bereits ziemlich umfangreich ist.  In der Zwischenzeit glauben wir, dass der Leser erfolgreich zu der Adresse <code>http://cupsserver:631/admin</code> auf die Schaltfl√§che "Neuen Drucker <code>http://cupsserver:631/admin</code> " geklickt und nach Intuition, Logik und den zuvor gelesenen Handb√ºchern den Drucker √ºber das <strong>LPD-</strong> Protokoll erfolgreich mit <strong>Windows1</strong> verbunden <strong>hat [Beispiel. com]</strong> und die Druckerseite ist unter <code>http://cupsserver:631/printers/Canon-MF4400</code> . </p><br><p>  Jetzt f√ºhren wir eine √§hnliche Operation auf dem Linux-Client-Computer mit dem Hostnamen <strong>linux1 aus</strong> .  Im Allgemeinen wird dieser Teil viel gr√∂√üer sein, da der Clientcomputer √ºber einen eigenen CUPS-Dienst verf√ºgt und auch √§hnlich wie ein Druckserver konfiguriert werden muss, mit Ausnahme seiner untergeordneten Rolle bei der Organisation des Druckens. </p><br><h3 id="ispravlenie-oshibki-obrascheniya-k-cups-cherez-loopback-po-imeni-hosta">  Korrektur des Fehlers beim Zugriff auf CUPS √ºber Loopback nach Hostnamen </h3><br><p>  Es gibt einen unangenehmen Moment.  Wenn Sie <strong>linux1</strong> in eine Domain <strong>eingeben</strong> und CUPS gem√§√ü diesen Anweisungen konfigurieren, stellen Sie m√∂glicherweise eine absurde Situation fest, wenn Sie von au√üen auf die <strong>linux1-</strong> WEB-Schnittstelle zugreifen k√∂nnen, dies jedoch nicht auf dem Host selbst!  Grafische Anwendungen zum lokalen Konfigurieren von Druckern, z. B. die <strong>Systemkonfigurationsdrucker-</strong> Anwendung in Linux Mint, funktionieren nicht.  Wenn Sie versuchen, unter der Adresse <code>http://linux1:631/</code> eine Verbindung zu Ihrem eigenen CUPS <code>http://linux1:631/</code> wird die Meldung "Verboten" oder "Schlechte Anfrage" <code>http://linux1:631/</code> .  Dies ist ein bekanntes und nicht wirklich gel√∂stes Problem in vielen Internetforen. </p><br><p>  In den meisten Anweisungen zum Einf√ºhren von Linux in eine Dom√§ne besteht einer der Punkte darin, die <em>Datei / etc / hosts ungef√§hr so</em> aussehen zu lassen: </p><br><pre> <code class="plaintext hljs">127.0.0.1 localhost 127.0.1.1 linux1.example.com linux1 # The following lines are desirable for IPv6 capable hosts ::1 ip6-localhost ip6-loopback fe02::2 ip6-localnet ff00::0 ip6-mcastprefix ff02::1 ip6-allnodes ff02::2 ip6-allrouters</code> </pre> <br><p>  Aus irgendeinem Grund kann CUPS Anrufe √ºber 127.0.1.1, dh √ºber die Loopback-Schnittstelle, nicht mit dem Hostnamen verkn√ºpfen. </p><br><p>  Dieser Fehler wird auf zwei Arten behoben.  Wenn Ihre Netzwerk-IP-Adressen statisch sind <em>,</em> korrigieren Sie in der <em>Datei / etc / hosts</em> 127.0.1.1 f√ºr die IP-Adresse der externen Netzwerkschnittstelle des Client-Computers. Beispiel: </p><br><pre> <code class="plaintext hljs">127.0.0.1 localhost 192.168.1.50 linux1.example.com linux1</code> </pre> <br><p>  Da Sie Linux in die Dom√§ne eingeben, wird davon ausgegangen, dass DHCP und der Active Directory-DNS-Server in Ihrem Netzwerk ausgef√ºhrt werden.  In diesem Fall kommentieren Sie einfach diese Zeile aus: </p><br><pre> <code class="plaintext hljs">127.0.0.1 localhost # 127.0.1.1 linux1.example.com linux1</code> </pre> <br><p>  Leistungsunterschiede oder Probleme mit dieser Aktion wurden noch nicht festgestellt. </p><br><h3 id="nastroyka-adresov-proslushivaniya-podklyucheniy-k-cups-u-klientskih-mashin-linux">  Festlegen von √úberwachungsadressen f√ºr CUPS-Verbindungen auf Linux-Client-Computern </h3><br><p>  Wir gehen auf jede bequeme Weise zu <strong>Linux1</strong> .  Bearbeiten der Datei <em>/etc/cups/cupsd.conf</em> : </p><br><pre> <code class="plaintext hljs">user@linux1:~$ sudo nano /etc/cups/cupsd.conf</code> </pre> <br><p>  Wir finden, f√ºgen oder √§ndern darin Zeilen: </p><br><pre> <code class="plaintext hljs">DefaultLanguage ru #      /usr/share/cups/locale ServerAlias linux1.example.com linux1 [CNAME    DNS ]  ServerAlias * #      Listen /run/cups/cups.sock Listen localhost:631 #  localhost Listen 10.10.100.50:631 # IP   . Listen cupsserver:631 #   .    IP  ,    Listen linux1:631 #  Port 631 #       Listen /run/cups/cups.sock Browsing off # .       DefaultAuthType Basic #  .     Kerberos,     </code> </pre> <br><h3 id="nastroyka-adresov-proslushivaniya-podklyucheniy-k-cups">  Festlegen der √úberwachungsadressen f√ºr die CUPS-Verbindung </h3><br><p>  Im vorherigen Block haben wir die M√∂glichkeit konfiguriert, eine Verbindung zu CUPS herzustellen.  <strong>Fahren wir nun mit</strong> dem <strong>Festlegen</strong> der <strong>Druckberechtigungen</strong> sowie mit den Verwaltungsseiten des CUPS-Dienstes auf dem <strong>Linux1-</strong> Host fort.  Wenn geschlossen, √∂ffnen wir die Datei <em>/etc/cups/cupsd.conf erneut</em> und bearbeiten die <em>Bl√∂cke</em> <strong>&lt;Location /&gt;</strong> , <strong>&lt;Location / admin&gt;</strong> , <strong>&lt;Location / admin / conf&gt;</strong> , <strong>&lt;Location / admin / log&gt;</strong> : </p><br><pre> <code class="plaintext hljs"># Restrict access to the server... &lt;Location /&gt; Order allow,deny #    "  ,  " Allow from localhost #    linux1 Allow from linux1 #     .      Allow from cupsserver #  CUPS    DNS,  . ,     Allow from cupsserver.example.com # FQDN  Allow from 10.10.100.50 #     IP  **cupsserver** &lt;/Location&gt; # Restrict access to the admin pages... &lt;Location /admin&gt; Order allow,deny #   Allow from localhost #      Allow from linux1 #   Allow from 10.10.101.71 # ,  IP  Allow from 10.20.50.* # ,    IT  AuthType Default #   CUPS    .   Require user @SYSTEM #     CUPS &lt;/Location&gt; # Restrict access to configuration files... &lt;Location /admin/conf&gt; #   Order allow,deny #   Allow from localhost #      Allow from linux1 #   Allow from 10.10.101.71 # ,  IP  Allow from 10.20.50.* # ,    IT  AuthType Default #   CUPS    .   Require user @SYSTEM #     CUPS &lt;/Location&gt; # Restrict access to log files... &lt;Location /admin/log&gt; #   Order allow,deny #   Allow from localhost #      Allow from linux1 #   Allow from 10.10.101.71 # ,  IP  Allow from 10.20.50.* # ,    IT  AuthType Default #   CUPS    .   Require user @SYSTEM #     CUPS &lt;/Location&gt;</code> </pre> <br><h3 id="nastroyka-razdachi-i-polucheniya-shirokoveschatelnoy-rassylki-setevyh-printerov">  Konfigurieren der Verteilung und √úbertragung von Netzwerkdruckern </h3><br><p>  Selbst auf einem Linux-Client-Computer, in diesem Fall <strong><em>Linux1</em></strong> , m√ºssen Sie die Datei <em>/etc/cups/cups-browsed.conf</em> bearbeiten: </p><br><pre> <code class="plaintext hljs">user@linux1:~$ sudo nano /etc/cups/cups-browsed.conf BrowseRemoteProtocols none #  none      . BrowseLocalProtocols cups #     . DNSSD   ,    cupsd.conf BrowseOrder Allow,Deny #   Order  cupsd.conf -   ,        BrowseAllow 10.10.100.50 # IP  BrowseAllow cupsserver #    BrowseAllow cupsserver.example.com #    </code> </pre> <br><h3 id="nastroyka-administrativnogo-dostupa">  Konfigurieren Sie den Administratorzugriff </h3><br><p>  Noch ein paar Worte zum Administratorzugriff, sowohl auf der CUPS WEB-Oberfl√§che auf einem Druckserver als auch auf jedem Linux-Client-Computer.  Selbst wenn Sie 30-50 Computer haben, m√ºssen Sie die Autorisierung auf CUPS vereinheitlichen und nicht die Kennw√∂rter der einzelnen Computer ber√ºcksichtigen.  Dies ist auf allen Linux-Computern wichtig, da Sie den Drucker zun√§chst lokal installieren m√ºssen, um ihn zum Server hinzuzuf√ºgen.  Ich sehe mehrere M√∂glichkeiten. </p><br><p>  Der erste besteht darin, auf jedem Linux-System (zum Beispiel) einen <strong>Druckeradministrator</strong> zu <strong>erstellen</strong> und der Gruppe <strong>lpadmin</strong> hinzuzuf√ºgen: </p><br><pre> <code class="plaintext hljs">user@linux1:~$ sudo usermod -a -G lpamin printeradmin</code> </pre> <br><p>  und melden Sie sich mit seinen Anmeldeinformationen bei <code>http://_:631/admin</code> . </p><br><p>  Die zweite Option ist nahezu identisch und schl√§gt vor, eine Gruppe im System zu erstellen, z. B. <strong>Druckeradministratoren</strong> , und dort den erforderlichen CUPS-Administrator ( <strong>Druckeradministrator</strong> , <strong>Benutzer</strong> ) <strong>hinzuzuf√ºgen</strong> : </p><br><pre> <code class="plaintext hljs">user@linux1:~$ sudo groupadd printersadmins user@linux1:~$ sudo usermod -a -G printersadmins printeradmin user@linux1:~$ sudo usermod -a -G printersadmins user</code> </pre> <br><p>  Dann m√ºssen Sie die Zeile in der Datei <em>/etc/cups/cups-files.conf finden</em> </p><br><pre> <code class="plaintext hljs"># Administrator user group, used to match @SYSTEM in cupsd.conf policy rules... # This cannot contain the Group value for security reasons... SystemGroup lpadmin</code> </pre> <br><p>  und f√ºgen Sie eine oder mehrere Benutzergruppen mit dem Recht hinzu, CUPS √ºber einen Bereich zu verwalten. </p><br><pre> <code class="plaintext hljs"># Administrator user group, used to match @SYSTEM in cupsd.conf policy rules... # This cannot contain the Group value for security reasons... SystemGroup lpadmin printersadmins somegroup</code> </pre> <br><p>  Und schlie√ülich die dritte Option.  Machen Sie Administratoren des Druckservers und der CUPS von Clientcomputern zu einer Dom√§nengruppe von Benutzern.  Dazu m√ºssen der Druckserver und die Linux-Clientcomputer der AD-Dom√§ne hinzugef√ºgt werden.  Es gibt verschiedene Methoden, um Linux mit der Windows-Dom√§ne zu verbinden, aber soweit ich wei√ü, verbinden sich die wichtigsten mit Winbind und SSSD (Realmd).  Eine Beschreibung dieser Methoden ist im Artikel nicht enthalten, daher werde ich mich nur auf Punkte konzentrieren, die sich speziell auf CUPS beziehen. </p><br><h3 id="nastroyka-ispolzovaniya-domennyh-grupp-polzovateley-dlya-administrirovaniya-cups">  Konfigurieren der Verwendung von Dom√§nenbenutzergruppen f√ºr die CUPS-Verwaltung </h3><br><p>  Jede Methode zum Beitritt zu einem zentralen Autorisierungssystem unter Linux erstellt eine spezielle Pipe-Datei, √ºber die Anwendungen die Liste der Dom√§nenbenutzer anzeigen k√∂nnen.  Damit CUPS dies tun kann, m√ºssen Sie zulassen, dass Pipe in AppArmor zur Authentifizierung von Benutzern verwendet wird.  AppArmor ist ein Linux-Sicherheitszugriffskontrollmodul.  Beschr√§nkt bestimmte Programme auf die in den Richtlinien aufgef√ºhrten Dateien.  <em>F√ºgen Sie der</em> Datei /etc/apparmod.d/local/usr.sbin.cupsd die folgende Zeile hinzu, um CUPS das Recht hinzuzuf√ºgen, Dom√§nenbenutzer und -gruppen √ºber winbindd zu <em>verwenden</em> : </p><br><pre> <code class="plaintext hljs">/var/lib/samba/winbindd_privileged/pipe rw</code> </pre> <br><p>  Wenn Linux √ºber SSSD in die Dom√§ne eingegeben wird, m√ºssen Sie den Speicherort seiner Pipe in <em>/etc/apparmod.d/local/usr.sbin.cupsd angeben</em> und dort die folgende Zeile hinzuf√ºgen: </p><br><pre> <code class="plaintext hljs">/var/lib/sss/pipes/private/pam rw</code> </pre> <br><p>  Im Fall von SSSD erm√∂glicht dies au√üerdem die Authentifizierung (um herauszufinden, wer sich anmeldet). Um sich jedoch zu authentifizieren (um herauszufinden, ob der Benutzer das Recht hat, CUPS zu verwalten), m√ºssen Sie die Zeile auch zur SSSD-Konfigurationsdatei <em>/etc/sssd/sssd.conf hinzuf√ºgen</em> : </p><br><pre> <code class="plaintext hljs">ad_gpo_map_interactive = +cups</code> </pre> <br><p>  Dies gibt CUPS unter bestimmten Bedingungen das Recht, sich mit SSSD zu "befassen". </p><br><p>  Aufgrund der Tatsache, dass CUPS jetzt vom SSSD-Dienst abh√§ngt, m√ºssen Sie CUPS au√üerdem mitteilen, dass es nach SSSD gestartet werden soll. Andernfalls f√§llt es beim Einschalten ab und muss jedes Mal manuell eingeschaltet werden. </p><br><p>  F√ºgen Sie CUPS-Anweisungen hinzu, um nach SSSD zu starten.  Bearbeiten Sie die <em>Dienstdatei cups.service</em> im Pfad <em>/ lib / systemd / system /</em> und f√ºgen Sie die <strong>After-</strong> Anweisung zum Abschnitt <strong>[Unit] hinzu</strong> : </p><br><pre> <code class="plaintext hljs">[Unit] Description=CUPS Scheduler Documentation=man:cupsd(8) After=sssd.service</code> </pre> <br><p>  Daher wird CUPS f√ºr die Basisautorisierung √ºber eine Dom√§ne konfiguriert, dh die Autorisierung durch Eingabe des Logins und des Kennworts eines Dom√§nenbenutzers mit CUPS-Administratorrechten. </p><br><p>  Die Autorisierung kann unterschiedlich konfiguriert werden, aber das Prinzip (Pipe-Datei) ist im Allgemeinen universell und es besteht die M√∂glichkeit, es analog f√ºr LDAP, FreeIPA und andere Verzeichnisdienste zu konfigurieren. </p><br><h3 id="ustanovka-printera-v-linux">  Installieren eines Druckers unter Linux </h3><br><p>  Die Installation eines Druckers unter Linux ist h√§ufig eine bestimmte Aufgabe, die sich f√ºr verschiedene Marken und sogar Modelle unterscheidet.  Daher sehe ich keinen Grund, die Installation des Druckers zu beschreiben, und <strong>gehe</strong> davon aus, dass auf dem <strong>Linux1-</strong> Host ein Kyocera-1024FP-Drucker mit dem Namen <strong>Kyocera-1024FP installiert</strong> ist und die Druckerseite unter <code>http://linux1:631/printers/Kyocera-1024FP</code> . </p><br><p>  Nachdem der Linux-Server und die Client-Computer konfiguriert sind, sind Drucker an einige von ihnen angeschlossen, und es gibt auch Windows-Computer, mit denen gedruckt werden kann. Das gesamte System muss stabil sein, auch wenn der Drucker auf einem der PCs ausgetauscht werden muss Dann sollte dies nicht die Neukonfiguration einer guten H√§lfte aller PCs bedeuten, wenn nicht aller.  Au√üerdem ben√∂tigen Sie so wenig Probleme wie m√∂glich mit den Treibern.  Und es ist durchaus m√∂glich. </p><br><h3 id="gruppy-printerov-classes">  Druckergruppen (Klassen) </h3><br><p>     <strong>Canon-MF4400</strong> c  <strong>windows1</strong>   LPD.            <code>http://cupsserver:631/printers/Canon-MF4400</code> .          <strong>cupsserver</strong> <code>http://cupsserver:631/admin</code> .      " " [Add Class].   .      "", "", "",       .            .  <strong>Canon-MF4400</strong>    ,    "" ,  <strong>printer-windows1</strong> , ""  ""   ,   " ". </p><br><p>      <strong>printer-windows1</strong>   <strong>Canon-MF4400</strong>  .           <strong>Canon-MF4400</strong>       ‚Äî <code>http://cupsserver:631/classes/printer-windows1</code> . </p><br><p>         <strong>linux1</strong>  Kyocera-1024FP.      HTTP.    "   (http)" [Internet Printing Protocol (http)],      "Generic",  "IPP Everywhere".    ,        <strong>linux1</strong> ‚Äî <strong>Kyocera-1024FP</strong> .        <code>http://cupsserver:631/printers/Kyocera-1024FP</code> .    <strong>printer-windows1</strong>   <strong>printer-linux1</strong> c  <strong>Kyocera-1024FP</strong>  .    <code>http://cupsserver:631/classes/printer-linux1</code> . </p><br><p>    <strong>Kyocera-1024FP</strong>   <strong>linux1</strong>   <strong>cupsserver</strong>   <strong>windows1</strong>   Windows 8      (!)  .        "    ".  <strong></strong>    <code>http://_c:631/classes/_</code> .     ‚Äî <code>http://cupsserver:631/classes/printer-linux1</code> .        "Generic",  ‚Äî "MS Publisher Imagesetter".   ,        <code>printer-linux1  http://cupsserver:631</code> .             ,          Kyocera-1024FP. </p><br><p>    <strong>Canon-MF4400</strong>   <strong>windows1</strong>   <strong>cupsserver</strong>   <strong>linux1</strong>   Linux      (!)  .         ,   <strong>Kyocera-1024FP</strong>   <strong>cupsserver</strong> .       <strong>linux1</strong>    "   (http)",     ( <strong>Canon-MF4400</strong> )       ‚Äî <code>http://cupsserver:631/classes/printer-windows1</code> .        "Generic",  ‚Äî "IPP Everywhere".    ,       ‚Äî <strong>printer-windows1</strong> .     <strong>linux1</strong>   <code>http://linux1:631/printers/printer-windows1</code> ,        . </p><br><p>      ,        ,   ,     ,       ,         .      ‚Äî     ,   ,     ,  ,       .        ,          .  "IPP Everywhere"  "MS Publisher Imagesetter"     ,   ..,          . </p><br><h3 id="zaklyuchenie">  Fazit </h3><br><p>   ,   - ,       .  ,   ,    ,      ,           . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de443094/">https://habr.com/ru/post/de443094/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de443082/index.html">Warum Sie andere nicht ansehen sollten, wenn Sie eine Sprache lernen</a></li>
<li><a href="../de443084/index.html">Facebook weigert sich, Server in L√§nder mit Verletzung der Meinungsfreiheit zu √ºbertragen, und f√ºhrt eine End-to-End-Verschl√ºsselung ein</a></li>
<li><a href="../de443086/index.html">Food Design Digest, Februar 2019</a></li>
<li><a href="../de443090/index.html">Ausflug zum KKW Rostow</a></li>
<li><a href="../de443092/index.html">Mit dem neuen Ultraschallsensor k√∂nnen Sie Bakterien ‚Äûh√∂ren‚Äú - wie es funktioniert</a></li>
<li><a href="../de443096/index.html">Der Designer ist kein Journalist. So f√ºhren Sie ein Interview mit einem Benutzer</a></li>
<li><a href="../de443098/index.html">Daten werden mit Magneten und Lasern auf die Disc geschrieben</a></li>
<li><a href="../de443100/index.html">Fehler im Windows-Rechner z√§hlen</a></li>
<li><a href="../de443102/index.html">Verhaltens√§nderung als Produkt: Warum sammelt Marie Kondo mit Sequoia Capital eine 40-Millionen-Dollar-Runde?</a></li>
<li><a href="../de443104/index.html">Berechnen Sie symbolische Ausdr√ºcke mit unscharfen Dreieckszahlen in Python</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>