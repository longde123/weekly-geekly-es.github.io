<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚§¥Ô∏è üë®‚Äç‚ù§Ô∏è‚Äçüë® ‚ùì Hypercube. Wie wir Entwicklern Testger√§te zur Verf√ºgung gestellt haben und diese nicht verloren haben üë®üèæ‚Äçüç≥ ‚ûï üêù</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Es ist unm√∂glich, mobile Anwendungen ohne Testger√§te vollst√§ndig zu testen und zu debuggen. Es sollte viele solcher Ger√§te geben, da sich derselbe Cod...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Hypercube. Wie wir Entwicklern Testger√§te zur Verf√ºgung gestellt haben und diese nicht verloren haben</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/485050/"><p>  Es ist unm√∂glich, mobile Anwendungen ohne Testger√§te vollst√§ndig zu testen und zu debuggen.  Es sollte viele solcher Ger√§te geben, da sich derselbe Code auf verschiedenen Modellen unterschiedlich verh√§lt.  Aber wie organisiert man die Ger√§tebuchhaltung?  Wie k√∂nnen Entwickler und Tester schnell und unb√ºrokratisch dazu gebracht werden, ein bestimmtes Smartphone in der erforderlichen Konfiguration zu bekommen? </p><br><p>  Ich hei√üe Alexey Lavrenyuk.  Sie k√∂nnen mich als einen der Autoren von <a href="https://github.com/yandex/yandex-tank">Yandex.Tank</a> und einen Redner zum Thema <a href="https://www.youtube.com/watch%3Fv%3Dgws7L3EaeC0">Belastungstests kennen</a> .  Dann habe ich den Stromverbrauch von Handys gemessen.  Jetzt mache ich Yandex.Rover in einem Team von unbemannten Fahrzeugen (und manchmal Mondschein als <a href="https://www.youtube.com/watch%3Fv%3DBZgpMC5ORW0">Weihnachtsmann</a> ).  Und zwischen den Telefonen und dem Rover befand sich Hypercube. </p><br><p>  Vor ein paar Jahren kam der Leiter der mobilen Entwicklung zu unserer Abteilung f√ºr Lasttests und beschwerte sich √ºber die Situation mit Testger√§ten.  Handys wanderten von Hand zu Hand, um das Telefon zu finden und schnell zu finden, war ein Problem.  Wir hatten bereits Erfahrung mit mobilen Ger√§ten: Wir haben ein digitales Amperemeter gebaut, um deren Energieverbrauch zu messen.  Aus diesem Grund haben wir beschlossen, Kollegen zu helfen und schnell eine coole Sache zu erledigen: Es schien nur drei Monate zu funktionieren.  Ich lache √ºber mich selbst, naiv, ab 2020 und erz√§hle, was uns wirklich erwartet hat. </p><br><img src="https://habrastorage.org/webt/-k/hz/b2/-khzb2ut0-y7ljuehz1f_8virf0.jpeg"><br><br><a name="habracut"></a><h2>  Servicekonzept und erste Ideen </h2><br><p>  Wir waren einer der wenigen in Yandex, die Eisenvorrichtungen zusammenbauten.  Dar√ºber hinaus haben wir uns im Mobilbereich bestens auskennt.  F√ºr mich war die Idee des Dienstes offensichtlich: Sie m√ºssen die Telefone an den Hub anschlie√üen und ihre Verf√ºgbarkeit und Bewegung im B√ºro √ºber USB verfolgen.  Das Design passt in einen Serverschrank. </p><br><p>  So habe ich mir den Prozess vorgestellt: </p><br><ol><li> <b>Wir zeichnen Telefone √ºber USB auf.</b>  Alle Telefone im Schrank sind √ºber USB verbunden.  Das Telefon wird aufgeladen, und es werden Informationen angezeigt, darunter die Ger√§te-ID (eine eindeutige Kennung, die bei einigen chinesischen Ger√§ten nicht immer eindeutig ist), anhand derer Sie ein Telefon von einem anderen unterscheiden k√∂nnen.  √úbrigens k√∂nnen Sie anhand der Kennung, die ein USB-Ger√§t im Allgemeinen hat, alles verfolgen: Schlie√üen Sie beispielsweise einen normalen USB-Stick an Ihre Autoschl√ºssel an und f√ºhren Sie automatisch eine Aufzeichnung der Schl√ºssel. </li><li>  <b>Wir lesen Benutzer auf einem Abzeichen.</b>  Wir identifizieren jeden, der das Telefon aus dem Schrank nimmt, anhand eines Ausweises (eines Ausweises, an dem Sie jeden Yandex-Mitarbeiter erkennen k√∂nnen).  Nachdem ein Mitarbeiter den Schrank ge√∂ffnet hat, wird angenommen, dass er alle Bewegungen der Telefone im Schrank ausgef√ºhrt hat. </li><li>  <b>Alle Bewegungsinformationen werden zentral im Service gespeichert.</b>  Wir sehen, wo und mit wem sich jedes Handy befindet.  Wir k√∂nnen Statistiken verfolgen: Welche Modelle sind beliebter, welche Handys fehlen. </li></ol><br><p>  Es k√∂nnen viele solcher Schr√§nke vorhanden sein, die Informationen zu allen Mobilger√§ten befinden sich jedoch an einem Ort.  Alle Cubes (Schr√§nke) sind kombiniert und logisch miteinander verbunden und bilden zusammen einen gro√üen Hypercube (daher der interne Name des Service). </p><br><p>  Die Idee hat allen gefallen, wir haben angefangen zu arbeiten. </p><br><h2>  Hypercube.  Starten Sie </h2><br><p>  Wir haben einen Helpdesk f√ºr den RFID-Leser und den Intel NUC-Mini-Computer eingeschaltet.  Wir kauften einen Arduino, ein elektrisches Schloss, einen Schrank f√ºr Netzwerkger√§te (er war kleiner als ein Serverschrank, aber mit den gleichen ‚ÄûSchienen‚Äú zur Befestigung der Ger√§te). </p><br><img width="600" src="https://habrastorage.org/webt/gf/d4/i8/gfd4i8d6nytgx9c7efxnotiiynk.jpeg"><br><br><p>  TK und die Einkaufsliste haben wir nat√ºrlich nicht bekommen.  Wir wussten nicht genau, welches Schrankmodell passen w√ºrde, wie viele Schrauben und Meter Draht ben√∂tigt werden.  Die Anforderungen an das Kabinett √§nderten sich unterwegs entsprechend den W√ºnschen der Teams.  Wir haben zum Beispiel vereinbart, dass wir 40 Mobiltelefone in einem Schrank aufbewahren und den Schrank auf den Nachttisch stellen, da es klein und unbequem ist, sich dorthin zu lehnen. </p><br><img src="https://habrastorage.org/webt/xm/pp/b5/xmppb5zuu2hmopkmxjagfwmsaxy.jpeg"><br><br><h3>  Regale f√ºr Telefone </h3><br><p>  Wir haben uns lange √ºberlegt, wie wir die Regale bequem machen k√∂nnen.  Yandex hatte Gestelle, um Telefone zu demonstrieren oder Schnittstellen zu testen.  Wir dachten, die Gestelle wiederzuverwenden, aber sie passten nicht sehr gut zu uns: Die Telefone dort schalteten den Bildschirm f√ºr den Benutzer wie in einem Schaufenster ein - wir brauchen ihn nicht.  Wir wollten den Platz im Schrank optimieren und haben uns daher entschlossen, selbst Regale zu bauen. </p><br><p>  Es gab die Idee, die Telefone wie B√ºcher fest einzulegen.  Zu diesem Zweck suchten wir in Schreibwarengesch√§ften nach Trennw√§nden, versuchten, CD-ROM-Halter und Verkaufsregale zu verwenden - alles von.  In experimenteller Weise wurden Kunststoffecken eines abgeschnittenen Separators aus einem Kabelkanal mit Schmelzkleber auf ein Regal geklebt.  Das ‚ÄûBuchlayout‚Äú hat sich als sehr erfolgreich erwiesen und hat uns gut gefallen. </p><br><img src="https://habrastorage.org/webt/uy/f6/se/uyf6sey2q9tpuwgv-wlfxtrkpfw.jpeg"><br><br><h3>  Nur wenige Orte und viele Drehkreuze </h3><br><p>  Am unteren Rand des Schranks war nur wenig Platz f√ºr vier 10-Port-Hubs und Intel NUC - wir waren weit davon entfernt, sie zum ersten Mal dorthin zu schieben.  Die Schrankt√ºr war nicht zum Befestigen des Schlosses gedacht - wir haben viel Hei√ükleber, Holzkl√∂tze und eine B√ºgels√§ge verwendet.  Ich m√∂chte Sie daran erinnern: Das Projekt wurde von einer Lasttest-Gruppe durchgef√ºhrt, keiner von uns hatte Erfahrung mit einer M√ºhle an einem Kaffeepunkt. </p><br><img src="https://habrastorage.org/webt/uv/yy/oc/uvyyoc8ilf6w6apxjmoxfc26kys.jpeg"><br><br><h3>  Service-Prototyp </h3><br><p>  Wir haben uns schnell darum gek√ºmmert: Wir haben eine Seite erstellt, auf der die Position der Telefone angegeben ist, und sie direkt in unseren Auslastungstestservice gestellt.  Nur weil Sie so schnell und m√ºhelos ausprobieren konnten, was passiert ist. </p><br><h2>  Der erste funktionierende Prototyp </h2><br><p>  Wir haben den ersten Hypercube seit drei Wochen gesammelt.  Er sah so aus: </p><br><img src="https://habrastorage.org/webt/0s/3j/10/0s3j10s6n8gk4ryxw4tyxrq3xte.jpeg"><br><br><p>  Zun√§chst beschlossen wir, den Prototyp in unserem B√ºro in Moskau zu testen (der Kunde war in Jekaterinburg).  Er hat sich mit dem mobilen Yandex.Browser-Team bekannt gemacht - wir kannten sie bereits aus dem <a href="https://habr.com/ru/company/yandex/blog/311046/">Yandex Volta-</a> Projekt (eine neuere Version des Berichts ist <a href="https://www.youtube.com/watch%3Fv%3DFRWvJpwyYrU">hier</a> ).  Diese Jungs kennen sich mit dem Stromverbrauch aus. </p><br><h2>  Erster Test </h2><br><h3>  Wieder Regale </h3><br><p>  Es stellte sich heraus, dass Hei√ükleber Kunststoffecken auf Metallregalen nicht gut h√§lt.  Wir sind zur√ºck auf die Idee der Telefonst√§nder.  Ich habe lange √ºberlegt, wie das ideale Regal im Schrank aussehen soll.  Jetzt scheint es m√∂glich zu sein, es in 15 Minuten zu zeichnen.  Am Ende stellte sich heraus, dass es nicht ganz so war wie in der ersten Skizze, aber hier ist, was ich damals gezeichnet habe: </p><br><img src="https://habrastorage.org/webt/60/it/1c/60it1cg57quzpzegy-wshqqwb9o.jpeg"><br><br><p>  Wir nahmen die gekauften Regale f√ºr Serverschr√§nke und legten die gefr√§sten Trennw√§nde aus Plastikfolie, die wir auf Bestellung herstellten, darauf.  Dieser Entwurf hat bis heute √ºberlebt. </p><br><img src="https://habrastorage.org/webt/wo/gp/r9/wogpr9zec43uihz89v1icn6wrnu.jpeg"><br><br><h3>  Unbequeme Hubs </h3><br><p>  Die Hubs f√ºr die ersten Schr√§nke waren mit einem Netzschalter, Tasten ohne Verriegelung, standardm√§√üig ausgeschaltet.  Daher musste ich nach jedem Neustart alle vier Hubs mit den H√§nden einschalten.  Wir haben Yandex SpeechKit so angeschlossen, dass der W√ºrfel sagt, wenn die Hubs ausfliegen: "Mir geht es nicht gut, bitte rufen Sie die verantwortliche Person an."  Wenn eine Person hereinkommt, werden Sie von der Stimme aufgefordert, die Hubs zu √ºberpr√ºfen.  Und der Sprachassistent begann, Mitarbeiter mit Namen und Stimme anzurufen, die wie viele Telefone nahmen. </p><br><h3>  Sperrproblem </h3><br><p>  Es gab mehrere Iterationen mit der Burg.  Als ich am Anfang nach Schl√∂ssern f√ºr den Prototyp suchte, fand ich die einzige Option, die mir zusagte - "Sheriff": klein, stark und sehr witzig gemacht (ich habe noch keine Analoga gesehen).  Es schloss perfekt, aber um den Schrank zu √∂ffnen, musste die T√ºr leicht gedr√ºckt werden.  Nicht alle Benutzer haben dies verstanden, daher haben wir beschlossen, die Sperre zu √§ndern. </p><br><p>  Sie nahmen den "Sheriff" mit einer Feder, die die T√ºr dr√ºckte.  Der Schrank √∂ffnete sich perfekt - aber er begann schlecht zu schlie√üen und blieb offen (und betrachtete sich als geschlossen).  Dies lag daran, dass der Schlie√üsensor separat vom Schloss installiert wurde, die T√ºr ein Spiel hatte und der Sensor manchmal funktionierte, bis die T√ºr geschlossen wurde.  Die Einrichtung war unrealistisch. </p><br><p>  Einmal mehr haben wir das Schloss gegen den n√§chsten ‚ÄûSheriff‚Äú ausgetauscht, der nicht mehr so ‚Äã‚Äãwitzig gebaut war, sondern direkt einen Verschlusssensor eingebaut hat.  Das Schloss arbeitete am Prototyp, aber nachdem es im ersten Schrank in Betrieb genommen wurde, begann es zu greifen.  Ich musste mit einem Tamburin tanzen: zerlegen, schmieren, mit einer Feile feilen.  Mit halbem Kummer landete er. </p><br><p>  Nach den ersten Tests wurde klar: Entwickler und Tester m√∂gen das Geh√§use, sie nutzen es aktiv.  Dies ist praktisch: Sie k√∂nnen die Ger√§te √ºberwachen und im Webdienst nach dem richtigen suchen, anstatt Ihre Kollegen zu fragen: ‚ÄûWer hat dieses Telefon jetzt?‚Äú.  Wir haben die wichtigsten Probleme identifiziert: unbequeme USB-Hubs, die Sie mit den H√§nden einschalten m√ºssen, lange USB-Kabel von schlechter Qualit√§t (die Anschl√ºsse sind abgebrochen und die Kabel haben sich verheddert), ein schlechtes Schloss und unzuverl√§ssige Fachteiler, die die ganze Zeit heruntergefallen sind.  Die Arbeit ging weiter. </p><br><h2>  Hyperraum-Erweiterung </h2><br><p>  Der Manager aus der Projektmanagementabteilung - er half uns auch bei der Organisation des Outsourcings f√ºr die Regale - war bei Yandex aktiv in der internen PR t√§tig: Er ging zu verschiedenen Teams und sprach √ºber unseren wunderbaren Service.  Wir trafen uns mit Vertretern anderer Abteilungen und erhielten unerwartet interne Bestellungen f√ºr mehrere Dutzend Schr√§nke.  Es ergab sich ein d√ºsteres Bild: Lasttester montieren wochenlang mit dem gesamten Team manuell Schr√§nke aus dem, was gerade zur Hand ist. </p><br><p>  Wir stellten fest, dass wir Hilfe bei der Montage brauchten.  Zuvor war es notwendig, die Kosten f√ºr eine Instanz des Schranks und sein Design f√ºr die Produktion in kleinem Ma√üstab zu optimieren. </p><br><h3>  Auszubildender </h3><br><p>  Eineinhalb Sommermonate lang haben wir es geschafft, einen Praktikanten zu finden, der ein bisschen l√∂ten, bohren und codieren konnte.  Damit haben wir den alten Schrank auf dem Raspberry Pi √ºberarbeitet (um den teuren und unn√∂tigen Intel NUC loszuwerden) und einen weiteren Schrank f√ºr den Einbau in Helpdesks in Moskau und St. Petersburg zusammengestellt (es gibt clevere Leute, die unseren Benutzern helfen, mit dem Prototyp fertig zu werden und zu geben) n√ºtzliches Feedback). </p><br><h3>  Budget Alternativen </h3><br><p>  Um die Kosten zu optimieren, haben wir die unangemessen teuren Komponenten des Prototyps ersetzt: den Intel NUC-Mini-Computer (25.000 Rubel) und den RFID-Leser (5.000 Rubel).  Sie fanden auf AliExpress einen alternativen Reader f√ºr 150 Rubel und wechselten von einem Mini-Computer f√ºr 3,5 Tausend Rubel zu Raspberry Pi. </p><br><p>  Auf der neuen Plattform hatten wir einige Probleme.  Zun√§chst stellte sich heraus, dass das Relais f√ºr die Schl√∂sser nicht schaltet, da RPi 3,3 V liefert und mechanische Relais f√ºr 5 V ausgelegt sind. Ich musste auf Solid State schalten.  Dann haben wir herausgefunden, dass es keine Uhr auf der Karte gibt und es nicht funktioniert, die Zeit √ºber NTP zu messen: Ohne die richtige Zeit k√∂nnen Sie sich nicht im B√ºronetzwerk authentifizieren (wir haben eine spezielle Erweiterungskarte mit einer Uhr f√ºr RPi gefunden). </p><br><p>  Das bezauberndste Problem war mit iPhones.  Sobald das sechste iPhone in das RPi eingef√ºgt wurde, war es √ºber das Netzwerk nicht mehr verf√ºgbar.  Ein vorbeikommender Projektmanager (und in der Vergangenheit ein strenger Administrator) hat uns dabei geholfen, dies herauszufinden.  Es stellte sich heraus, dass die Netzwerkkarte auf dem RPi √ºber USB geschieden war und die iPhones einen Buggy-Service provozierten, um den USB-Bus fertigzustellen.  Dieses Problem tauchte zum ersten Mal im Minsker B√ºro auf, die Jungs konnten es schnell reproduzieren und Feedback geben, was uns sehr geholfen hat.  Sie haben das Problem gel√∂st, als sie die grafische Oberfl√§che abgerissen haben (wenn ich mich recht erinnere), weil der Dienst darin integriert war. </p><br><h3>  Schr√§nke wachsen </h3><br><p>  Es gab eine Debatte √ºber die Gr√∂√üe des Kabinetts.  Jemand hielt es f√ºr notwendig, doppelt so viele Telefone in einem Schrank unterzubringen, jemand, dass gro√üe Schr√§nke im B√ºro unpraktisch waren.  Und dann stellten wir fest, dass wir bereits alle kleinen Schr√§nke in Moskauer Gesch√§ften gekauft hatten und die n√§chste Lieferung erst in drei Monaten erfolgen w√ºrde.  Die Debatte endete von alleine. </p><br><p>  Sie beschlossen, alle folgenden Schr√§nke gro√ü zu machen.  Mit Blick auf die Zukunft sage ich: Es hat sich als die richtige Entscheidung herausgestellt.  Auf der Basis eines gro√üen Schranks ist es einfacher geworden, Elektronik zu platzieren, 80 Telefone wurden nicht mehr darin platziert.  Darin zwischen den Schienen befanden sich Standardserver von 19 Zoll.  In einem kleinen Schrank reichte der Abstand zwischen den Schienen nicht aus. </p><br><img src="https://habrastorage.org/webt/yr/zt/x4/yrztx4px9jzm3937az12pj0yjli.jpeg"><br><br><h3>  Webentwicklung und UX </h3><br><p>  Wir steckten unseren Zauberstab in eines der internen Webentwicklungs-Frameworks, stellten fest, dass es gut war, und zogen die Telefonplatte von Django nach React.  Aber es war klar, dass nur ein Tablet niemandem passen w√ºrde.  Die Geo-Services-Abteilung hat uns die Aufgabe auf mehreren Bildschirmen vorgestellt. </p><br><p>  Ich musste ein Webentwicklungsteam zusammenstellen.  Wir wurden mit einem Produktdesigner beauftragt, der die Interaktion der Benutzer mit dem Service gr√ºndlich durchdachte.  Er machte praktische Aufkleber auf den Schr√§nken, platzierte die Schr√§nke auf der B√ºrokarte, studierte den Support-Chat, um besser zu verstehen, was Benutzer wollen.  Kurz gesagt, ich habe das Projekt in Bezug auf die Benutzererfahrung unter meine Fittiche genommen. </p><br><p>  Webentwickler √ºbernahmen das Frontend und implementierten schnell Design-Layouts.  Wir haben etwas √Ñhnliches wie Yandex.Markt in kleinerem Ma√üstab: Sie kommen herein, w√§hlen ein Telefon, Sie gehen, um es in einem Schrank abzuholen.  Der Traum ist einfach. </p><br><img src="https://habrastorage.org/webt/ve/ip/7s/veip7sfanydchkpd_jmd4su5fe8.png"><br><br><p>  Irgendwo hier wurde uns klar, dass das Projekt auf das gesamte Yandex ausgedehnt werden musste.  Wir haben Ausgaben vereinbart, um Fehler zu korrigieren und die Servicequalit√§t erheblich zu verbessern: Es gab ein allgemeines Budget f√ºr den Kauf von Schr√§nken, Ersatzteilen und Werkzeugen.  Mit der Hilfe von Pasha Melnikov, dem damaligen Leiter der Gruppe der Eisen-RnD-Projekte und jetzt bei Yandex.Station, ist es uns gelungen, mit einem externen Unternehmen eine Vereinbarung √ºber die Herstellung von Serienschr√§nken zu treffen, die unsere Anforderungen ber√ºcksichtigt. </p><br><h3>  Neue Version von Hubs </h3><br><p>  Wir haben eine andere Version der Hubs ohne Netzschalter gekauft.  Jetzt musste man nicht mehr in den Schrank klettern und die Hubs nach einem Neustart einschalten.  Wir haben einen Prototyp manuell zusammengebaut - es hat perfekt funktioniert.  Aber als wir ihn nach Jekaterinburg schickten, erhielten wir sofort Beschwerden, dass das Kabinett einige Telefone nicht sieht.  Verstanden dies nur an Ort und Stelle.  Es stellte sich heraus, dass die neuen Hubs eine andere Topologie aufweisen (selbst f√ºr dasselbe Hub-Modell in verschiedenen Serien kann die Topologie variieren). </p><br><p>  Sowohl der alte als auch der neue Hub mit 10 Anschl√ºssen bestehen aus drei USB-Chips mit vier Anschl√ºssen.  Aber in der alten Nabe mit dem Einschaltknopf stecken zwei Chips in einem und in der neuen sind sie durch eine "Girlande" verbunden.  Die Anzahl der Ports ist gleich, aber die Tiefe der Verschachtelung ist unterschiedlich.  In H√§fen mit gro√üer Schachtelungstiefe wurden alte Telefone nicht erkannt.  Es ist gut, dass sie alt und nicht sehr notwendig waren.  Wir haben das Problem der Kopfschmerzen gel√∂st, indem wir den Kopf abgehackt haben: Wir haben nur neuere Telefonmodelle f√ºr den Schrank genommen, und wir haben auf die Implementierung unserer eigenen Hubs gewartet.  Die Software musste es erm√∂glichen, verschiedene USB-Topologiekonfigurationen f√ºr verschiedene Schr√§nke festzulegen. </p><br><h2>  Eigene Hubs </h2><br><p>  Gemeinsam mit Pasha haben wir begonnen, einen eigenen externen USB-Hub zu entwickeln.  Es war erforderlich, das Problem der gekauften Hubs zu l√∂sen und die vom Benutzer gew√ºnschten Ger√§te hervorzuheben und das Aufladen moderner Telefone zu beschleunigen. Daf√ºr verwendeten wir leistungsstarke Netzteile und unterst√ºtzten die neuesten Standards.  Die Hubs konnten externe Temperatursensoren anschlie√üen, sodass wir sie in jedem Regal steuern k√∂nnen.  Die Gr√∂√üen wurden so gew√§hlt, dass zwei in einem Geh√§use installierte Hub-Karten genau in das 19-Zoll-Server-Rack passen.  Hubs hatten ein niedriges Profil, um Platz zwischen den Regalen zu sparen - im Allgemeinen erwiesen sie sich als cool und modern.  Pasha wird detaillierter √ºber dieses Projekt auf Habr√© berichten. </p><br><img src="https://habrastorage.org/webt/fr/ou/uh/frouuhq7yr0jweypbpumfd0tpqq.jpeg"><br><br><h2>  Versammlung </h2><br><p>  Die Montage von Bauteilen auf Basis von gekauften Schr√§nken wurde ebenfalls ausgelagert.  Nach unseren Berechnungen sollte das Montageteam ein paar Abende √ºberstehen, doch aufgrund des √úberflusses an Handarbeit dauerte es einige Wochen.  Dr√§hte, die nicht standardgem√§√ü gem√§√ü den mit einem Stift auf einer Packungsbeilage gezeichneten Schemata verbunden sind, manuelles L√∂ten, fehlende vorgefertigte Sitze f√ºr Bauteile und fertige Bauteile selbst ... Die Schr√§nke wurden im wahrsten Sinne des Wortes fertiggestellt: L√∂cher f√ºr Schl√∂sser wurden gebohrt und herausgeschnitten von einem Schleifer f√ºr andere Bauteile. </p><br><h2>  N√§her an der Produktion </h2><br><p>  Wir haben schon davon getr√§umt, Schr√§nke in die Produktion zu geben.  Wir haben entschieden, dass es zur Beschleunigung notwendig ist, die Produktion zu vereinfachen und den Anteil des Outsourcings zu erh√∂hen. </p><br><h3>  Peripheriekarte </h3><br><p>  Entwickelte die Peripherieplatine und aktualisierte die Komponenten.  Jetzt wird es mit einem einzigen Kabel an den Raspberry Pi und alle anderen Komponenten mit Standardsteckern angeschlossen. </p><br>  Wir haben eine Uhr f√ºr RPi auf dem Brett aufgestellt: Vorher haben wir eine separate fertige Komponente aufgeklebt, die wir in einem Gesch√§ft gekauft haben.  Wir haben auch einen DC / DC-Wandler (fr√ºher gab es ein separates Netzteil) und eine RS-485-Schnittstelle installiert, sodass wir das Kabelgewebe loswerden konnten.  Zuvor haben wir sie manuell von Punkt zu Punkt verbunden, indem wir sie in einen der RPi-Stifte gel√∂tet oder geklebt haben.  Wir haben das Diagramm √ºberpr√ºft, den Eintrittspunkt f√ºr den Draht und das gew√ºnschte Loch gesucht - und das bei jedem Draht der Reihe nach.  Es war sehr zeitaufwendig und verursachte Montagefehler.  Das neue Board verwendete Telefonbuchsen. <br><br><img src="https://habrastorage.org/webt/bu/u5/11/buu5119817wci7cc-9mk2vderl8.jpeg"><br><br><p>  Es stellte sich sp√§ter heraus: Bei der Verkabelung habe ich nicht ber√ºcksichtigt, dass Sie den RS-485-Chip an gut definierte RPi-Beine anschlie√üen m√ºssen.  Ich musste die Version des Boards aktualisieren.  Als ich die RS-485-Leistungsentkopplungskomponente zeichnete, habe ich nicht darauf geachtet, dass auf dem Datenblatt der Mikrochip von unten und nicht von oben zu sehen ist, und als ich ihn zum ersten Mal einschaltete, gab er ein ‚ÄûBang!‚Äú Mit einem charakteristischen Geruch von sich.  Ich musste den Chip auf der R√ºckseite der Platine f√ºr die gesamte erste Platinenserie neu l√∂ten. </p><br><img src="https://habrastorage.org/webt/ob/7g/vf/ob7gvfrtpjy-iqvwg9dttukakwg.png"><br><br><h3>  Neue Schrankversion </h3><br><p>  Gekaufte Schr√§nke passen nicht mehr zu uns.  Sie sahen seltsam aus, weil sie f√ºr den Server bestimmt waren und nicht f√ºr das B√ºro, und sie mussten auch von Hand modifiziert werden.  Es hat viel Zeit in Anspruch genommen und das Ergebnis war handwerklich.  Wir beschlossen, unsere eigenen Schr√§nke in der Fabrik in Arzamas herzustellen. </p><br><p>  Wir haben die Fabrik gebeten, einen modifizierten Schrank auf der Basis ihres Standard-Serverschranks zu montieren: Gr√∂√üe √§ndern, Schloss einbauen, die erforderlichen Steckverbinder herausziehen, L√∂cher f√ºr die Befestigung der Elemente bohren.  Sie zeichneten Skizzen der Regale, machten einen Fall f√ºr die Elektronikeinheit (RPi und ihre Freunde), einen Fall f√ºr die Nabe.  Als es um das Schloss ging, √§nderte der Konstrukteur der Fabrik die gekaufte Option geringf√ºgig, und es begann besser zu funktionieren.  Ein Fehlerbericht mit einer Pull-Anfrage zum Finalisieren des Eisens wurde an die Autoren des Sheriffs gesendet. </p><br><p>  Es ist sehr praktisch, dass jetzt alle Schaltschranksteuerungselektroniken in einem Geh√§use zusammengefasst sind, das auf vier Schrauben montiert ist.  Es kann separat vom Schrank zusammengebaut werden, es ist einfach, das Ganze zu entfernen und zu ersetzen, wenn es kaputt ist. </p><br><img src="https://habrastorage.org/webt/2o/1c/48/2o1c48-sruzbyqc-w-flwjh9x_w.png"><br><img src="https://habrastorage.org/webt/h9/az/i7/h9azi7um8ew9v8pj1buv2aqnd8g.png"><br><img src="https://habrastorage.org/webt/6_/yu/vb/6_yuvbuqop_0bxooqjwithyojie.png"><br><br><p>  In Testschr√§nken waren die Dr√§hte verwechselt, die Stecker flogen aus der Nabe und brachen, und manchmal nahmen die Mitarbeiter die Dr√§hte mit.  Wir haben uns entschlossen, die Dr√§hte fest an den Regalen zu befestigen, ohne die M√∂glichkeit zu haben, die Dr√§hte zu wechseln.  Ich habe eine Skizze gezeichnet - und die Fabrik hat sie uns in Eisen verkauft. </p><br><img src="https://habrastorage.org/webt/be/qs/80/beqs80_1wvnvkexl2sjwadxrads.jpeg"><br><img src="https://habrastorage.org/webt/uu/gx/zj/uugxzj-rzbqpjeh5rhlrj0dso0c.jpeg"><br><br><p>  Nat√ºrlich sind wir mehrmals nach Arzamas gefahren: um zu verhandeln, die Produktion aufzubauen, um das Ergebnis zu akzeptieren.  Dadurch haben wir die Schr√§nke fast komplett fertiggestellt, es blieb ihnen nichts anderes √ºbrig, als sie in Betrieb zu nehmen.  Aber das ist eine andere Geschichte. </p><br><img src="https://habrastorage.org/webt/y_/fb/lj/y_fbljom5cnrcjj9e2gn218rjwq.jpeg"><br><br><p>  √úbrigens, wenn Sie Arzamas besuchen, gehen Sie zum Burger in der Mitte: es ist cool. </p><br><h2>  In der n√§chsten Serie </h2><br><p>  Jetzt werden unsere W√ºrfel im Unternehmen aktiv eingesetzt.  Wir haben uns sogar die Namen daf√ºr ausgedacht: Stanley Cube, Maggi Cube, Arnie Cube (Arnold Schwarzenegger, sechs Teile) usw. </p><br><p>  In naher Zukunft werden Kollegen mit Ihnen Geschichten √ºber das Schicksal des Dienstes teilen.  Zum Beispiel dar√ºber, wie Yandex.Hub entwickelt wurde.  Oder dar√ºber, wie einige H√§fen der Hubs anfingen, "taub zu werden".  Am "numbed" -Port kann man die Trennung von USB-Ger√§ten nicht erkennen, auch in Kernelmeldungen gibt es nichts.  Aber alles normalisiert sich, wenn Sie das Telefon aus dem Anschluss entfernen und es zur√ºckstecken.  In der Zwischenzeit schreiben die Jungs Artikel f√ºr Sie - versuchen Sie selbst zu erraten, warum dies sein k√∂nnte. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de485050/">https://habr.com/ru/post/de485050/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de485034/index.html">Automatisieren der Erstellung eines Qt-Projekts unter Windows in Travis CI</a></li>
<li><a href="../de485036/index.html">Warum brauche ich instrumentelle Unterst√ºtzung f√ºr die Schl√ºsselpagination?</a></li>
<li><a href="../de485042/index.html">Aufgrund der obligatorischen 5G-Unterst√ºtzung werden Smartphones mit Snapdragon 865 im Jahr 2020 schlechter sein</a></li>
<li><a href="../de485044/index.html">Wir zerlegen die Digitaluhr vom Sojus-Raumschiff</a></li>
<li><a href="../de485046/index.html">So planen Sie eine erfolgreiche Produktstrategie</a></li>
<li><a href="../de485052/index.html">Wer ist eine gute QS?</a></li>
<li><a href="../de485056/index.html">Teilen und erobern</a></li>
<li><a href="../de485058/index.html">‚Äû√úberpr√ºfen Sie die Uhr‚Äú: Was ist √ºber das neue Zeitsynchronisationsprotokoll des Servers bekannt?</a></li>
<li><a href="../de485068/index.html">Clean Code f√ºr TypeScript - Teil 2</a></li>
<li><a href="../de485070/index.html">Andrew Eun "Leidenschaft f√ºr maschinelles Lernen." √úbersetzung der Kapitel 36-46</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>