<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📵 🏇🏽 😯 Was ist passiert, als wir die Ausstellung geknackt haben? ⚡️ 💝 👩🏾‍🔧</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Q RC OD E über eine mobile Anwendung zum Scannen der Ausweise von Ausstellern von Informationssicherheitsprojekten. 

 Letztes Jahr haben wir eine gro...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Was ist passiert, als wir die Ausstellung geknackt haben?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/417621/">  Q <b>RC</b> OD <b>E</b> über eine mobile Anwendung zum Scannen der Ausweise von Ausstellern von Informationssicherheitsprojekten. <br><a name="habracut"></a><br>  Letztes Jahr haben wir eine große Ausstellung von Informationssicherheitsprojekten in London besucht.  Zur Vorbereitung erhielten wir unsere Ausweise in Form von PDFs zum Ausdrucken. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3cf/c19/9ba/3cfc199ba6b29143007fb4871a3536b5.png" alt="Toms Ausstellerabzeichen"></div><br>  Wir haben sofort zwei Arten von Barcodes bemerkt.  Interessanterweise sah der QR-Code zu dicht aus, da es ausreicht, nur die Teilnehmer-ID darin zu speichern.  Da wir von Natur aus neugierig sind, haben wir einen QR-Scanner gestartet und den Inhalt des Codes erhalten: <br><br><pre><code class="hljs objectivec">{<span class="hljs-string"><span class="hljs-string">"CJe"</span></span>;<span class="hljs-string"><span class="hljs-string">"BHEEZST"</span></span>,<span class="hljs-string"><span class="hljs-string">"DO"</span></span>;<span class="hljs-string"><span class="hljs-string">"Cvmmfuqsppg"</span></span>,<span class="hljs-string"><span class="hljs-string">"G"</span></span>;<span class="hljs-string"><span class="hljs-string">"upn"</span></span>,<span class="hljs-string"><span class="hljs-string">"KU"</span></span>;<span class="hljs-string"><span class="hljs-string">"Qfofusbujpo uftufs"</span></span>,<span class="hljs-string"><span class="hljs-string">"T"</span></span>;<span class="hljs-string"><span class="hljs-string">"xzbuu"</span></span>}</code> </pre> <br>  Es stellte sich heraus, dass es fast, aber nicht ganz JSON war.  Einer der Vorteile eines so kurzen Namens wie meines ist, dass er in solchen Situationen auffällt.  Daher bemerkte ich sofort, dass mein Name in ROT-25 verschlüsselt war (aus „tom“ wurde „upn“).  Es ist auch als Caesar-Chiffre bekannt, bei der jeder Buchstabe durch einen anderen mit festem Versatz ersetzt wird (in diesem Fall wurde der Buchstabe im Alphabet anstelle jedes Buchstabens verwendet).  Nachdem wir die Leitung durch den Decoder geführt haben (unter Berücksichtigung des JSON-Markups), haben wir: <br><br><pre> <code class="hljs objectivec">{<span class="hljs-string"><span class="hljs-string">"BId"</span></span>;<span class="hljs-string"><span class="hljs-string">"AGDDYRS"</span></span>,<span class="hljs-string"><span class="hljs-string">"CN"</span></span>;<span class="hljs-string"><span class="hljs-string">"Bulletproof"</span></span>,<span class="hljs-string"><span class="hljs-string">"F"</span></span>;<span class="hljs-string"><span class="hljs-string">"tom"</span></span>,<span class="hljs-string"><span class="hljs-string">"JT"</span></span>;<span class="hljs-string"><span class="hljs-string">"Penetration tester"</span></span>,<span class="hljs-string"><span class="hljs-string">"S"</span></span>;<span class="hljs-string"><span class="hljs-string">"wyatt"</span></span>}</code> </pre> <br>  Dies ist besser lesbar. <br><br><h2>  Brechen Sie es? </h2><br>  Seltsamerweise speichert der QR-Code Informationen, die mit dem BId-Feld in der Datenbank in Zusammenhang zu stehen scheinen.  Warum?  Das ist ziemlich einfach.  Die Organisatoren haben eine mobile Anwendung für Anbieter erstellt, mit deren Hilfe sie die Kontakte der Teilnehmer während der Ausstellung sammeln können.  Wir haben angenommen, dass die Daten in einem QR-Code verschlüsselt sind, falls das WLAN oder das Mobilfunksignal instabil ist. <br><br>  Bisher können wir mit diesen Informationen nur wenig anfangen, außer unsere Daten zu ändern, um Spam von Anbietern von der Veranstaltung zu vermeiden.  Es wäre lustig, aber kaum eine E-Mail an den Systementwickler wert.  Also gingen wir zum Play Market und installierten die entsprechende Anwendung, um zu sehen, was sie tut. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/544/bf7/ff1/544bf7ff1910ec9044f73bf566dbb997.png" alt="Screenshots der App"></div><br>  Und hier sind wir auf ein Problem gestoßen: Wir hatten nicht die notwendigen Daten von den Organisatoren der Veranstaltung.  Wir dachten, wir könnten die Serverantwort mit dem MiTM-Proxy fälschen, und die Anwendung wird uns gehen lassen.  Wir haben Burpsuite eingerichtet und einige erfolglose Anmeldeversuche aufgezeichnet, in der Hoffnung, den Datenverkehr abzufangen und damit zu spielen. <br><br>  Leider haben wir es nicht geschafft.  Die Anwendung leitete alle Anfragen mithilfe von SOAP, und die Antworten waren nicht offensichtlich.  Der Server veröffentlicht jedoch WSDL-Dokumente für die Anwendung. <br><br><h2>  Dies ist nicht das Ende </h2><br>  Warum nicht einen gefälschten Webdienst schreiben, damit Sie nicht mehr auf den realen Anwendungsserver zugreifen können?  Ein paar Stunden später hatten wir einen solchen Service und der gesamte Verkehr wurde darauf geschaltet.  Es funktioniert!  Die Anwendung hat sich mit allen Daten authentifiziert und mit einem gefälschten Ereignis verbunden. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c32/e23/0a9/c32e230a94d053e2bd63cc2f7849e4ba.png" alt="Gefälschte Show in App"></div><br>  Wir haben ein paar Abzeichen gescannt und alles schien richtig zu funktionieren.  Fortschritt!  Nachdem ich einige Zeit in der Anwendung herumgewandert war, stellte sich heraus, dass sie eine Art WebView-basiertes Framework verwendete.  Beim Stöbern in der APK fanden wir eine Reihe von Erwähnungen von Sencha und Ext.js, die unsere Annahme bestätigten. <br><br>  Und jetzt - das interessanteste.  Wenn eine Anwendung aus einer regulären Mischung aus HTML und JavaScript besteht, kann sie dann für Standard-Webangriffe anfällig sein?  Wir haben ein paar XSS in den "nicht ganz JSON" eingewickelt, den die Anwendung erwartet, sie gescannt und ... <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/21c/64d/940/21c64d940bd21911a963ff8ee4a8a697.png" alt="Gefälschte ID in App"></div><br><h2>  Wir haben es kaputt gemacht </h2><br>  Großartig!  Die HTML-Injection im Feld "JT" zeigte das Bild.  Wir können diesem Tag das Attribut "onerror" hinzufügen, um die Ausführung des Skripts zu erreichen. Wir sind jedoch durch die Beschränkung der maximalen Länge des QR-Codes begrenzt.  Als Ergebnis haben wir eine Nutzlast erstellt, die die JS-Datei vom Server heruntergeladen und auf dem Gerät ausgeführt hat.  Hier ist zum Beispiel der Standard-alert () -Test: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/831/726/56e/83172656e9f9340bfec3447e8d24ac3f.png" alt="Codierung einer Warnung"></div><br>  Das Scannen eines Barcodes löst XSS aus und führt den Code aus: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c9c/d23/7e2/c9cd237e297e61234ad05df380b52a3d.png" alt="Zeigt einen XSS-Fehler an"></div><br>  Wir haben es so gestochen, dass es genau in die maximale Größe eines lesbaren QR-Codes passt, nicht zu dicht zum Drucken auf einem Durchgang.  Nachdem wir die Dokumentation für die Ext.js-API gelesen und mit dem dekompilierten APK-Code verglichen hatten, konnten wir einen Barcode erstellen, der: <br><br><ol><li>  Laden Sie eine JS-Datei von einem Remote-Server herunter </li><li>  Liest Sitzungsschlüssel von einem Smartphone und sendet sie an unseren Server </li><li>  Liest den Inhalt der zwischengespeicherten Kontaktdatenbank aus der Anwendung, einschließlich der Namen und E-Mail-Adressen aller, deren Ausweise von diesem Gerät gescannt wurden </li><li>  Löscht Ihre Aufnahme von einem Smartphone </li></ol><br>  Dann läuft der Angriff auf Folgendes hinaus: Der Anbieter scannt meinen QR-Code im Austausch gegen einen kostenlosen Stift, und ich erhalte eine vollständige Liste aller von diesem Gerät gescannten Kontakte. <br><br>  Nutzlast: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/23d/604/4fc/23d6044fccd94b03cdd82e833a6c0d65.png" alt="Anzeigen der Nutzlast"><br><br>  Anfragen an den Webserver: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b3c/257/8de/b3c2578de409b7d6409e138f8aba5717.png" alt="Serverantwort anzeigen"><br><br><h2>  Alles ist gut, das endet gut </h2><br>  Wir haben die Anbieter auf der Messe auf sich aufmerksam gemacht, und nach einigen Diskussionen haben sie beschlossen, die Anwendung dieses Jahr nicht zu verwenden.  Nur wenige Teilnehmer der Veranstaltung nutzten die Anwendung, während einfache kleine Barcode-Scanner die Anwendung bevorzugten.  Die Anwendung vom Markt wurde nur etwa 500 Mal heruntergeladen.  Dies ist jedoch ein interessanter Vektor für XSS, der zeigt, dass Sie die Daten vor der Verwendung wirklich filtern müssen, unabhängig von ihrer Quelle. <br><br>  Obwohl diese spezielle Anwendung nicht weit verbreitet ist, stellen Sie sich vor, ob die Sicherheitsanfälligkeit in einer Anwendung liegt, die von Tausenden verwendet oder von Millionen heruntergeladen wird.  Alle diese Daten sind für Angreifer bestimmt, die sie nach eigenem Ermessen entsorgt hätten: von Phishing-Kampagnen bis hin zu Brute-Force-Angriffen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de417621/">https://habr.com/ru/post/de417621/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de417607/index.html">A / B-Tests funktionieren nicht. Überprüfen Sie, was Sie falsch machen</a></li>
<li><a href="../de417609/index.html">Spezialisierung auf Sportprogrammierung am Cursor</a></li>
<li><a href="../de417615/index.html">Disk Cracker Confessions für Apple II: 4 Uhr morgens Geheimnisse</a></li>
<li><a href="../de417617/index.html">Cassandra zum Speichern von Metadaten: Erfolge und Misserfolge</a></li>
<li><a href="../de417619/index.html">Win32 / Glupteba ist nicht mehr mit dem Windigo-Betrieb verbunden</a></li>
<li><a href="../de417627/index.html">Hyper CRM oder Mini ERP? Das Geschäft ist durcheinander</a></li>
<li><a href="../de417629/index.html">Delphi und C ++ Builder Community Edition</a></li>
<li><a href="../de417631/index.html">CSS Grid Video Tutorial</a></li>
<li><a href="../de417637/index.html">Entwicklung eines Editors zum Erstellen von Websites / Landungen (Erfahrung)</a></li>
<li><a href="../de417639/index.html">Die Rückseite des Neuromancers. Teil 4: Sound, Animation, Huffman, Github</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>