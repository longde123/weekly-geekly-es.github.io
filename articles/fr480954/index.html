<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéè üë©‚Äç‚öïÔ∏è üìß Num√©ro de t√¢che 1. D√©couvrez le sexe et le degr√© de relation üë∏üèæ üöµüèΩ üéÖüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans l' article d√©taill√© pr√©c√©dent sur le g√©nome complet, nous avions promis de publier trois probl√®mes et de donner un test √† celui qui r√©soudrait to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Num√©ro de t√¢che 1. D√©couvrez le sexe et le degr√© de relation</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/atlasbiomed/blog/480954/">  Dans l' <a href="https://habr.com/ru/company/atlasbiomed/blog/479602/">article</a> d√©taill√© pr√©c√©dent sur le <a href="https://atlas.ru/wgs">g√©nome complet,</a> nous avions promis de publier trois probl√®mes et de donner un test √† celui qui r√©soudrait tous les trois correctement.  Dans le m√™me temps, nous donnons des exemples de la fa√ßon de travailler avec des donn√©es g√©n√©tiques dans ces t√¢ches.  Aujourd'hui, nous publions le premier. <br><br><img src="https://habrastorage.org/webt/qd/mz/ye/qdmzye9a9sdyp82atstpktqrnu4.png"><br><a name="habracut"></a><br>  Dans le premier <a href="https://habr.com/ru/company/atlasbiomed/blog/479602/">article,</a> nous avons partag√© des informations et des liens utiles qui sont utiles pour travailler avec des donn√©es bioinformatiques.  Nous vous recommandons de le lire en premier si vous l'avez manqu√©. <br><br>  <b>Clause de non-responsabilit√©</b> <br>  Le travail avec les donn√©es g√©n√©tiques est effectu√© sur les syst√®mes Unix (Linux, macOS), car certaines commandes et logiciels ne sont pas disponibles sur Windows.  Par cons√©quent, pour les utilisateurs de Windows, l'une des solutions les plus simples consiste √† louer une machine virtuelle Linux. <br><br>  Toutes les op√©rations d√©crites ci-dessous sont effectu√©es sur la ligne de commande - terminal.  Avant de commencer, d√©couvrez comment travailler dans un terminal ex√©cutant votre syst√®me d'exploitation et utilisez des commandes, car certaines d'entre elles peuvent potentiellement endommager le syst√®me d'exploitation et vos donn√©es. <br><br><br><h2>  Logiciels requis </h2><br>  Nous avons collect√© l' <a href="https://cloud.yandex.ru/marketplace/products/f2e5v4acgtukhi31n6o4">image d'une machine virtuelle</a> (VM) avec tous les logiciels n√©cessaires sur Yandex.Cloud.  Inscrivez-vous dans Yandex.Cloud, dans votre compte dans la section Compute Cloud, cliquez sur Cr√©er une machine virtuelle.  En tant qu'image publique, s√©lectionnez 1000 g√©nomes dans le catalogue Atlas Data Analysis. <br><br>  Configuration VM: 100% 2vCPU, 8 Go de RAM, 20 Go de disque dur.  Lors de la cr√©ation d'une machine virtuelle, vous devez saisir les donn√©es de paiement, mais rien n'est radi√© du compte.  Un d√©marrage et une subvention suppl√©mentaire sur un mot de code suffisent pour travailler gratuitement avec une machine virtuelle et une image d'Atlas jusqu'au 31 d√©cembre 2019.  Pour recevoir une subvention pour l'ex√©cution de t√¢ches, envoyez le mot de code "ATLAS" au <a href="https://console.cloud.yandex.ru/support">support Yandex.Cloud</a> . <br><br>  Remarque: la subvention est valable pour les nouveaux utilisateurs de Yandex.Cloud qui se sont inscrits depuis le 18 d√©cembre 2019 ou pour ceux qui ont encore une p√©riode d'essai et ont une subvention de d√©part.  Le mot de code ATLAS n'est valable qu'une seule fois. <br><br>  Cr√©ez d'abord une cl√© ssh sur l'ordinateur local √† partir duquel vous pr√©voyez de vous connecter √† la machine virtuelle: <br><br><pre><code class="bash hljs">ssh-keygen -o -t rsa -b 4096 -C <span class="hljs-string"><span class="hljs-string">"my-local-machine"</span></span> -f ~/.ssh/yandex-cloud -a 100</code> </pre> <br>  N'oubliez pas de copier le contenu du fichier <code>~/.ssh/yandex-cloud.pub</code> dans la fen√™tre appropri√©e lors de la cr√©ation de la machine virtuelle. <br><br>  Si vous souhaitez installer le logiciel sur votre ordinateur, voici toutes les informations d'installation.  Si vous d√©cidez d'utiliser Yandex.Cloud, cr√©ez une machine virtuelle et passez √† la section suivante. <br><br><br><h3>  Plink </h3><br>  Plink est un progiciel de manipulation de donn√©es g√©n√©tiques et de recherche d'association √† large g√©nome (GWAS).  Il a √©t√© d√©velopp√© par le g√©n√©ticien Sean Purcell (Shaun Purcell).  Depuis 2008, avec l'aide de Plink, des centaines de GWAS ont √©t√© r√©alis√©s dans le monde, dont les meilleurs r√©sultats qu'Atlas utilise comme source de donn√©es pour les algorithmes de calcul des risques de maladie. <br><br>  Plink propose un ensemble d'outils pour stocker et convertir les donn√©es de g√©notypage et les rechercher.  Plink permet √©galement le traitement statistique, l'analyse de d√©s√©quilibre de liaison (LD), l'analyse d'identit√© par descendance (IBD) et d'identit√© (√©tat par IBS), la stratification de la population et les tests d'√©pistase - l'interaction de plusieurs variations g√©n√©tiques entre eux. <br><br>  L'IBD et l'IBS sont utilis√©s pour analyser la composition de la population et d√©terminer la parent√©. <br><br>  Un exemple d'√©pistase est la variation de rs7412 et rs429358 dans le g√®ne APOE, une certaine combinaison de variantes dont augmente fortement le risque de d√©velopper la maladie d'Alzheimer, tandis que chaque variante individuellement ne contribue que faiblement au risque. <br><br>  T√©l√©chargez la version stable de Plink sur le site <a href="https://www.cog-genomics.org/plink/">officiel</a> . <br><br><br><h3>  BCFtools </h3><br>  BCFtools est un ensemble d'utilitaires pour manipuler des donn√©es g√©n√©tiques au format VCF et son √©quivalent binaire BCF.  La liste des applications possibles de BCFtools comprend l'annotation, le filtrage, la fusion et le fractionnement des fichiers VCF / BCF, la recherche de leurs intersections, l'indexation, la recherche s√©lective, le tri, le comptage des statistiques, etc. <br><br>  Pour installer, faites: <br><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> git://github.com/samtools/htslib.git git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> git://github.com/samtools/bcftools.git <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> bcftools <span class="hljs-comment"><span class="hljs-comment"># The following is optional: # autoheader &amp;&amp; autoconf &amp;&amp; ./configure --enable-libgsl --enable-perl-filters make</span></span></code> </pre> <br>  Le processus d'installation est d√©crit plus en d√©tail <a href="https://samtools.github.io/bcftools/howtos/install.html">ici</a> . <br><br><br><h3>  ROI </h3><br>  Le package KING (Kinship-based INference for Gwas) est utilis√© dans les √©tudes de population lorsque vous travaillez avec les donn√©es d'une recherche d'association √† l'√©chelle du g√©nome pour d√©terminer les relations familiales dans les donn√©es √©tudi√©es.  Dans cette t√¢che, KING aidera √† d√©terminer le degr√© de parent√© de plusieurs √©chantillons du projet 1000 Genomes. <br>  Vous pouvez le t√©l√©charger <a href="http://people.virginia.edu/~wc9c/KING/Download.htm">ici</a> .  Pour r√©soudre les probl√®mes, le manuel KING est disponible <a href="http://people.virginia.edu/~wc9c/KING/manual.html">ici</a> . <br><br><blockquote>  Presque toutes les erreurs pouvant survenir pendant le travail avec les outils sont d√©crites sur <a href="https://stackoverflow.com/">Stackoverflow</a> ou son √©quivalent bioinformatique - <a href="https://www.biostars.org/">Biostars</a> . </blockquote><br><h2>  Donn√©es utilis√©es </h2><br>  √Ä titre indicatif, nous utilisons les donn√©es ouvertes <a href="https://www.internationalgenome.org/">du</a> projet 1000 Genomes.  Pour l'analyse, nous avons s√©lectionn√© 10 √©chantillons avec des informations sur les g√©notypes d'environ 85 millions de variations obtenues en analysant les donn√©es NGS align√©es avec la version du g√©nome de r√©f√©rence GRCh37.  Les relations familiales et les √©chantillons de population sont illustr√©s √† la figure 1. <br><br><img src="https://habrastorage.org/webt/yr/rt/bg/yrrtbgj6tct9huih0rg5gww63xc.png"><br>  <b>Figure 1</b>  Pedigree utilis√© dans les √©chantillons VCF.  Le carr√© correspond au sexe masculin, le cercle √† la femelle.  La ligne pointill√©e signifie une parent√© ind√©termin√©e de second ordre. <br><br><br><h2>  Prenez note </h2><br>  Le format VCF vous permet de stocker des informations sur le champ d'une personne sous la forme d'un num√©ro unique, si ces informations √©taient connues lors de la g√©n√©ration de VCF.  Il ressemble √† ceci: le champ GT (g√©notype, g√©notype) pour les enregistrements du chromosome X contient une valeur num√©rique qui correspond √† un all√®le, pour les hommes et deux pour les femmes.  S'il n'y a aucune information sur le champ biologique de l'√©chantillon s√©quenc√©, le champ GT contiendra par d√©faut deux valeurs num√©riques (surlign√©es en rouge sur la figure 2). <br><br>  Dans les fichiers VCF utilis√©s dans ce manuel, le chromosome Y est exclu, mais la pr√©sence du chromosome Y dans le fichier VCF ne signifie pas toujours que l'√©chantillon s√©quenc√© l'a vraiment.  Cela est d√ª aux r√©gions pseudo-autosomiques (PAR), identiques pour les chromosomes X et Y et situ√©es √† leurs extr√©mit√©s. <br><br>  Diff√©rents chromosomes n'ont normalement pas de r√©gions identiques (homologues) longues, cependant, les chromosomes X et Y ont de telles r√©gions plusieurs millions de paires de bases de long au tout d√©but (PAR1) et √† la fin (PAR2).  Par cons√©quent, lors de l'analyse des donn√©es NGS chez les hommes dans les r√©gions PAR, deux all√®les sont trouv√©s (un pour chaque chromosome sexuel), et chez les femmes, des g√©notypes peuvent appara√Ætre dans les r√©gions PAR du chromosome Y, bien qu'en fait ce soient des g√©notypes de leur chromosome X. <br><br><img src="https://habrastorage.org/webt/xc/nx/ga/xcnxgajnkuainexvlp2a5ppsqrg.png"><br>  <b>Figure 2</b>  Fichier VCF avec des g√©notypes du chromosome X d'un homme de la r√©gion PAR1 (deux premi√®res entr√©es) et de la r√©gion non pseudo-autosomique (deux derni√®res entr√©es). <br><br><blockquote>  Unit√© p√©dagogique <br>  Le genre g√©n√©tique est un ensemble de chromosomes sexuels correspondant √† la manifestation de caract√©ristiques sexuelles primaires et secondaires de type masculin ou f√©minin.  Normalement, les hommes ont un chromosome X et un chromosome Y, tandis que les femmes ont deux chromosomes X. Avec divers troubles de la formation des cellules germinales, des ≈ìufs et du sperme, un enfant avec un excellent ensemble de chromosomes sexuels peut na√Ætre de ses parents, ce qui conduit souvent √† des troubles du d√©veloppement caract√©ristiques sexuelles primaires et secondaires. <br><br>  Les deux anomalies sexuelles chromosomiques les plus courantes sont le <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B8%25D0%25BD%25D0%25B4%25D1%2580%25D0%25BE%25D0%25BC_%25D0%25A8%25D0%25B5%25D1%2580%25D0%25B5%25D1%2588%25D0%25B5%25D0%25B2%25D1%2581%25D0%25BA%25D0%25BE%25D0%25B3%25D0%25BE_%25E2%2580%2594_%25D0%25A2%25D1%2591%25D1%2580%25D0%25BD%25D0%25B5%25D1%2580%25D0%25B0">syndrome de Turner</a> (un ensemble de chromosomes X0, c'est-√†-dire un seul chromosome X) et <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B8%25D0%25BD%25D0%25B4%25D1%2580%25D0%25BE%25D0%25BC_%25D0%259A%25D0%25BB%25D0%25B0%25D0%25B9%25D0%25BD%25D1%2584%25D0%25B5%25D0%25BB%25D1%258C%25D1%2582%25D0%25B5%25D1%2580%25D0%25B0">le syndrome de Klinefelter</a> (un ensemble de chromosomes XXY). <br><br>  Un all√®le est un ou plusieurs nucl√©otides situ√©s √† n'importe quelle position dans le g√©nome et ayant une alternative.  Le concept est utilis√© pour d√©crire les g√©notypes.  Distinguer les all√®les de r√©f√©rence des alternatives.  Tous sont stock√©s dans le fichier VCF dans les champs REF et ALT, respectivement. </blockquote><br><h2>  D√©terminer le sexe </h2><br><div class="spoiler">  <b class="spoiler_title">Pour les utilisateurs de Yandex.Cloud</b> <div class="spoiler_text">  Toutes les donn√©es pour effectuer les t√¢ches manuelles et ind√©pendantes sont stock√©es sur Yandex.Cloud en utilisant la structure ci-dessous.  Le dossier <code>Tutorial</code> contient le fichier VCF n√©cessaire pour terminer le manuel, le dossier <code>Test</code> pour les t√¢ches ind√©pendantes.  Le dossier <code>Technical</code> contient deux fichiers avec une liste d'identifiants des variations g√©n√©tiques: <code>rsids_for_subsetting.txt</code> utilis√© dans le manuel et des t√¢ches pour une ex√©cution ind√©pendante, <code>external_interpretation_rsids.txt</code> pourrait √™tre n√©cessaire √† l'avenir lors de l'acquisition du s√©quen√ßage √† l'√©chelle du g√©nome dans l'Atlas pour t√©l√©charger des donn√©es de g√©notypage vers des services tiers.  Le dossier <code>Tools</code> contient, entre autres, deux scripts utilis√©s dans les t√¢ches 2 et 3. <br><br><pre> <code class="bash hljs">home ‚îî‚îÄ‚îÄ ubuntu ‚îú‚îÄ‚îÄ Data ‚îÇ ‚îú‚îÄ‚îÄ Test ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ CEI.1kg.2019.test.vcf.gz ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ CEI.1kg.2019.test.vcf.gz.tbi ‚îÇ ‚îî‚îÄ‚îÄ Tutorial ‚îÇ ‚îú‚îÄ‚îÄ CEI.1kg.2019.demo.vcf.gz ‚îÇ ‚îî‚îÄ‚îÄ CEI.1kg.2019.demo.vcf.gz.tbi ‚îú‚îÄ‚îÄ Technical ‚îÇ ‚îú‚îÄ‚îÄ external_interpretation_rsids.txt ‚îÇ ‚îî‚îÄ‚îÄ rsids_for_subsetting.txt ‚îî‚îÄ‚îÄ Tools ‚îú‚îÄ‚îÄ convert_plink_delimiter.sh ‚îî‚îÄ‚îÄ create_23andme.sh</code> </pre> <br>  Un dossier sera cr√©√© dans le r√©pertoire <code>/home</code> de la machine virtuelle Yandex.Cloud, dont le nom correspond au nom d'utilisateur sp√©cifi√© lors de la cr√©ation de la machine virtuelle.  Copiez tout du r√©pertoire <code>/home/ubuntu</code> vers votre r√©pertoire via les commandes suivantes: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~ cp -r /home/ubuntu/* ./</code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Pour le reste</b> <div class="spoiler_text">  Lorsque vous travaillez sur un PC personnel, vous pouvez t√©l√©charger les fichiers n√©cessaires pour la premi√®re t√¢che √† partir du <a href="">lien</a> .  L'archive t√©l√©charg√©e prend en charge une structure de stockage de fichiers similaire √† celle utilis√©e sur Yandex.Cloud: <br><br><pre> <code class="bash hljs">home ‚îî‚îÄ‚îÄ ubuntu ‚îú‚îÄ‚îÄ Data ‚îÇ ‚îú‚îÄ‚îÄ Test ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ CEI.1kg.2019.test.vcf.gz ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ CEI.1kg.2019.test.vcf.gz.tbi ‚îÇ ‚îî‚îÄ‚îÄ Tutorial ‚îÇ ‚îú‚îÄ‚îÄ CEI.1kg.2019.demo.vcf.gz ‚îÇ ‚îî‚îÄ‚îÄ CEI.1kg.2019.demo.vcf.gz.tbi ‚îú‚îÄ‚îÄ Technical ‚îÇ ‚îú‚îÄ‚îÄ external_interpretation_rsids.txt ‚îÇ ‚îî‚îÄ‚îÄ rsids_for_subsetting.txt ‚îî‚îÄ‚îÄ Tools ‚îú‚îÄ‚îÄ convert_plink_delimiter.sh ‚îî‚îÄ‚îÄ create_23andme.sh</code> </pre> <br>  <code>atlas_wgs_contest.tar.gz</code> archive <code>atlas_wgs_contest.tar.gz</code> avec la commande <br> <code>tar -xvzf atlas_wgs_contest.tar.gz</code> <br> </div></div><br>  Les fichiers VCF pour effectuer des t√¢ches sous forme non archiv√©e occupent environ 19 gigaoctets chacun, par cons√©quent, pour √©conomiser de l'espace, nous vous recommandons de travailler uniquement avec des archives.  Tous les programmes r√©pertori√©s ci-dessus peuvent d√©j√† fonctionner avec des donn√©es VCF compress√©es.  De plus, vous n'avez rien √† faire. <br><br>  Pour d√©terminer le sexe du sujet, vous devez regarder les g√©notypes sur le chromosome X et exclure les r√©gions PAR1 et PAR2 situ√©es √† son d√©but et √† sa fin.  Ce sont les intervalles des positions 60001‚Äì2699520 et 154931044‚Äì155260560 dans la version GRCh37 du g√©nome.  Si le g√©notype contient une d√©signation num√©rique, il s'agit du sexe biologique masculin, sinon de la femelle.  Il convient de garder √† l'esprit que la d√©signation du sexe dans le fichier VCF d√©pend de la disponibilit√© des informations sur le domaine biologique lors de la g√©n√©ration du VCF, de sorte que cette approche ne peut pas toujours √™tre utilis√©e. <br><br>  Utilisez la commande suivante pour chacun des √©chantillons de l'ensemble de donn√©es.  Remplacez l'identifiant de l'√©chantillon apr√®s l'argument <code>-s</code> : <br><br><pre> <code class="bash hljs">(/Data/Tutotrial/CEI.1kg.2019.demo.vcf.gz): <span class="hljs-comment"><span class="hljs-comment">#      bcftools view -O v -H -s HG00731 -r chrX:2699521-154931043 CEI.1kg.2019.demo.vcf.gz | head</span></span></code> </pre> <br>  Lors de l'ex√©cution des commandes, vous verrez une partie du contenu du fichier VCF pour l'identifiant d'√©chantillon sp√©cifi√©.  Le <code>-r chrX:2699521-154931043</code> dans BCFtools restreint la visualisation du contenu du fichier √† la r√©gion du chromosome X de la position 2699521 √† la position 154931043 (r√©gion non PAR sur la figure 3).  Ces limites excluent les r√©gions pseudo-autosomiques inutiles dans ce cas (PAR1 et PAR2).  √Ä l'aide des valeurs num√©riques du champ GT, d√©terminez le sexe de chaque √©chantillon. <br><br><img src="https://habrastorage.org/webt/vn/fx/et/vnfxetqzursuy3ltyytqj-giiko.png"><br>  <b>Figure 3</b>  La localisation des r√©gions pseudo-autosomiques de PAR1 et PAR2 sur les chromosomes sexuels. <br><br>  Vous pouvez voir la liste de tous les exemples d'identificateurs dans le fichier VCF de la figure 1 ou dans la derni√®re ligne de l'en-t√™te du fichier VCF.  Ils seront r√©pertori√©s apr√®s le nom de la colonne FORMAT: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#CHROM POS ID REF ALT QUAL FILTER INFO FORMAT HG00731 HG00732 HG02026 HG02025 HG02250 HG02373 HG00733 HG02024 HG02377 HG02381</span></span></code> </pre> <br>  Le vrai sexe de ces √©chantillons est √©galement indiqu√© dans la figure 1. <br><br><br><h2>  Nous d√©terminons la relation </h2><br>  Pour d√©terminer la relation, nous devons comparer par paire les donn√©es g√©n√©tiques de tous les √©chantillons.  Il est difficile de le faire en fonction du g√©nome complet: dans ce cas, un fichier VCF prend des dizaines de gigaoctets.  Le VCF que nous utilisons ne prend qu'environ 2 gigaoctets, mais nous le filtrons toujours en fonction de la liste des identificateurs de variation g√©n√©tique (rsID) g√©notyp√©s sur les puces d'Illumina: GSA v1, GSA v2, HumanOmniExpress v1.0, HumanOmniExpress v1.3, InfiniumExome v1. 1 et Infinium OmniExpressExome v1.4.  Ce sont les puces les plus populaires dans le g√©notypage commercial. <br><br>  Nous avons compil√© une liste de tous les identifiants des variations g√©n√©tiques de ces puces dans un fichier s√©par√© avec une liste de rsID.  Il contient 1,4 million d'identifiants.  Pour filtrer le fichier VCF, ex√©cutez la commande suivante: <br><br><pre> <code class="bash hljs">bcftools view -O z -i <span class="hljs-string"><span class="hljs-string">'ID=@rsids_for_subsetting.txt'</span></span> CEI.1kg.2019.demo.vcf.gz &gt; CEI.1kg.2019.demo.subset.vcf.gz</code> </pre> <br>  Chaque fois que vous utilisez BCFtools et d'autres packages pour travailler avec des fichiers VCF, l'historique des commandes pr√©c√©dentes est ajout√© √† l'en-t√™te du fichier.  Quelle que soit la m√©thode de filtrage du fichier VCF et les commandes pr√©c√©demment ex√©cut√©es, vous pouvez v√©rifier l'int√©grit√© et l'identit√© du contenu principal du VCF en calculant la somme de hachage: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#      gunzip -c CEI.1kg.2019.demo.subset.vcf.gz | grep -v "^#" &gt; CEI.1kg.2019.demo.subset.body.vcf md5sum --tag CEI.1kg.2019.demo.subset.body.vcf #       d609eb330908d4eb5feb9f1860fd508b</span></span></code> </pre> <br>  La commande <code>gunzip -c</code> d√©compresse le fichier et <code>gunzip -c</code> son contenu dans stdout, √† partir de laquelle les lignes d'en-t√™te du fichier VCF commen√ßant <code> #</code> sont supprim√©es (par cons√©quent, la commande <code>grep -v "^#"</code> est utilis√©e).  L'en-t√™te est supprim√© afin de comparer l'int√©grit√© des seules donn√©es g√©n√©tiques elles-m√™mes, et non les m√©tadonn√©es sur quels outils et quand ont √©t√© utilis√©s pour travailler avec ce fichier VCF. <br><br>  Si la valeur de hachage correspond, vous pouvez continuer et convertir VCF au format Plink interne (par d√©faut, le format Plink est de trois fichiers avec les extensions bed, bim et fam).  Dans ces fichiers, il ne reste que le g√©notype, le chromosome, la position et certaines autres donn√©es, et le reste est √©limin√©.  Avec ce format, il est beaucoup plus facile de travailler et de r√©soudre divers probl√®mes qui ne n√©cessitent pas d'informations suppl√©mentaires de VCF.  Par exemple, effectuez GWAS. <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#     plink --vcf CEI.1kg.2019.demo.subset.vcf.gz --make-bed --out CEI.1kg.2019.demo.subset</span></span></code> </pre><br>  Cette commande cr√©era trois fichiers dans le dossier: <br> <code>CEI.1kg.2019.demo.subset.bed <br> CEI.1kg.2019.demo.subset.bim <br> CEI.1kg.2019.demo.subset.fam</code> <br> <br>  Vous pouvez d√©terminer la parent√© par paire pour les 10 √©chantillons.  Nous utilisons la commande suivante pour analyser les fichiers Plink: <br><br><pre> <code class="bash hljs">king -b CEI.1kg.2019.demo.subset.bed --kinship --prefix CEI.1kg.2019.demo.subset.kinship_analysis</code> </pre> <br>  Regardez le fichier <code>CEI.1kg.2019.demo.subset.kinship_analysis.kin0</code> et faites attention √† la colonne Kinship, qui contient les coefficients de parent√© pour les paires d'√©chantillons indiqu√©es respectivement dans ID1 et ID2. <br><br>  Comparez les coefficients que vous avez obtenus dans le fichier <code>CEI.1kg.2019.demo.subset.kinship_analysis.kin0</code> pour toutes les paires d'√©chantillons avec le pedigree illustr√© √† la figure 1 (la ligne pointill√©e correspond √† la parent√© de second ordre, cependant, il n'y a pas de donn√©es de parent√© exactes, c'est-√†-dire il peut y avoir des cousins, tante / neveu ou oncle / ni√®ce).  Essayez de tirer votre propre conclusion sur les valeurs des coefficients de parent√© qui peuvent correspondre √† la parent√© de premier et de second ordre. <br><br><div class="spoiler">  <b class="spoiler_title">Indice</b> <div class="spoiler_text">  Extrait de la documentation KING: les coefficients de parent√©&gt; 0,354 correspondent √† des √©chantillons en double ou des jumeaux identiques, de 0,177 √† 0,354 √† la parent√© de premier ordre (parents-enfants, fr√®res et s≈ìurs), de 0,0884 √† 0,177 √† la parent√© de second ordre (cousins, tantes / oncles-neveux), et de 0,0442 √† 0,0884 - √† la parent√© de troisi√®me ordre (grands-parents, petits-enfants, cousins ‚Äã‚Äãau deuxi√®me degr√©).  Tout ce qui est inf√©rieur √† 0,0442 est difficile √† interpr√©ter sans ambigu√Øt√©. <br></div></div><br><br><h2>  La premi√®re t√¢che du concours </h2><br>  √Ä l'aide d'un ensemble de donn√©es de test de 12 √©chantillons <code>Data/Test/CEI.1kg.2019.test.vcf.gz</code> , <code>Data/Test/CEI.1kg.2019.test.vcf.gz</code> leur pedigree, guid√© par les r√©sultats de la d√©termination du sexe et de l'analyse de parent√©.  Les √©chantillons qui, selon les r√©sultats de l'analyse, ne sont pas en relation avec quelqu'un, sont not√©s √† proximit√©, sans les relier √† une ligne avec d'autres √©chantillons.  Le pedigree peut √™tre compos√© dans un style similaire √† celui de la figure 1, mais cela reste √† votre discr√©tion.  Les hommes sont indiqu√©s par un carr√©, les femmes par un cercle, le mariage par une ligne horizontale, un enfant par une ligne verticale, plusieurs enfants par une ramification horizontale d'une ligne verticale (sous la forme de la lettre P).  En savoir plus sur ces d√©signations <a href="https://www.khanacademy.org/science/high-school-biology/hs-classical-genetics/hs-pedigrees/a/hs-pedigrees-review">ici</a> . <br><br>  Comme nous l'avons √©crit plus haut, les coefficients de parent√© ne peuvent caract√©riser sans ambigu√Øt√© la parent√© d'un ordre ou d'un autre: les m√™mes coefficients de parent√© sont obtenus lors de la comparaison des couples parent-enfant et fr√®re-s≈ìur (parent√© de premier ordre).  S'il n'est pas possible d'√©tablir la nature de la relation, indiquez l'une des possibilit√©s.  Veuillez noter que les √©chantillons de l'ensemble de donn√©es de test ont des identifiants diff√©rents de ceux utilis√©s dans l'ensemble de donn√©es d'apprentissage. <br><br>  Les r√©ponses <a href="">doivent √™tre envoy√©es</a> √† <a href="">wgs@atlas.ru</a> mail jusqu'au 26 d√©cembre √† 23h59.  Deux autres t√¢ches seront publi√©es prochainement et les r√©sultats d√©finitifs de ces t√¢ches seront publi√©s le 28 d√©cembre.  Le gagnant recevra le test du g√©nome complet et les deuxi√®me et troisi√®me places recevront le test g√©n√©tique Atlas.  Il y aura √©galement des prix sp√©ciaux de <a href="https://cloud.yandex.ru/">Yandex.Cloud</a> .  Les anciens et actuels employ√©s d'Atlas ne participent pas au concours;) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr480954/">https://habr.com/ru/post/fr480954/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr480940/index.html">Ex√©cutez un test d'interface utilisateur multi-navigateur avec Cucumber et Selenoid dans Gitlab CI avec rapport Allure</a></li>
<li><a href="../fr480944/index.html">Top 5 des tendances du marketing par e-mail en 2020</a></li>
<li><a href="../fr480946/index.html">Journaux dans Kubernetes (et pas seulement) aujourd'hui: attentes et r√©alit√©</a></li>
<li><a href="../fr480948/index.html">Marketing Mitap et RP √† Ivanovo</a></li>
<li><a href="../fr480950/index.html">Analyse du quiz Android du stand hh.ru au Mobius 2019 Moscou</a></li>
<li><a href="../fr480956/index.html">Comment j'ai trouv√© un moyen de suivre tous les pilotes Citimobil</a></li>
<li><a href="../fr480958/index.html">Connexion satellite. Vue d'ensemble des soci√©t√©s op√©rateurs et un peu sur la notation</a></li>
<li><a href="../fr480960/index.html">Trouvez des fichiers perdus dans plusieurs cibles Xcode</a></li>
<li><a href="../fr480962/index.html">D√©veloppement du compilateur C pour le nouveau neuroprocesseur multiclet</a></li>
<li><a href="../fr480964/index.html">Qu'est-ce que la zone de Fresnel et CCQ (Client Connection Quality) ou les facteurs fondamentaux d'un pont sans fil de haute qualit√©</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>