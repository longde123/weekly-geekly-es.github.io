<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÜüèæ üï† üë®‚Äçüë®‚Äçüë¶ Profondeurs SIEM: corr√©lations pr√™tes √† l'emploi. Partie 5. M√©thodologie pour d√©velopper des r√®gles de corr√©lation üëêüèΩ ‚öñÔ∏è üëâüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nous concluons la s√©rie d'articles consacr√©s aux r√®gles de corr√©lation qui sortent du cadre. Nous nous sommes fix√© pour objectif de formuler une appro...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Profondeurs SIEM: corr√©lations pr√™tes √† l'emploi. Partie 5. M√©thodologie pour d√©velopper des r√®gles de corr√©lation</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/446212/">  Nous concluons la s√©rie d'articles consacr√©s aux r√®gles de corr√©lation qui sortent du cadre.  Nous nous sommes fix√© pour objectif de formuler une approche qui nous permettrait de cr√©er des r√®gles de corr√©lation qui peuvent fonctionner ¬´pr√™tes √† l'emploi¬ª avec un minimum de faux positifs. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/e6/bz/th/e6bzthq7bfspxncuni5hbtudz84.png" alt="M√©todologie d'√©laboration des r√®gles de corr√©lation"></div><br>  <i>Image: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Marketing logiciel</a></i> <br><a name="habracut"></a><br>  Tous les points cl√©s de l'article sont disponibles en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">conclusion</a> , au m√™me endroit cette m√©thodologie est pr√©sent√©e sous forme de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">diagramme</a> graphique. <br><br>  Bri√®vement sur ce qui √©tait dans les articles pr√©c√©dents: ils ont d√©crit √† quoi devrait ressembler un ensemble de champs d'un √©v√©nement normalis√© - un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sch√©ma</a> ;  quel syst√®me de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cat√©gorisation des</a> √©v√©nements utiliser;  comment, √† l'aide d'un syst√®me de cat√©gorisation et d'un sch√©ma, unifier le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">processus de</a> normalisation des √©v√©nements.  Nous avons √©galement examin√© le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">contexte de la</a> mise en ≈ìuvre des r√®gles de corr√©lation et examin√© ce que SIEM devrait savoir sur le syst√®me automatis√© (AS) qu'il surveille, et pourquoi. <br><br>  Toutes les approches et le raisonnement ci-dessus sont les blocs √† partir desquels la m√©thodologie pour d√©velopper des r√®gles de corr√©lation est construite.  Il est temps de les assembler et de regarder l'ensemble du tableau. <br><br>  L'ensemble de la m√©thodologie d'√©laboration des r√®gles de corr√©lation se compose de quatre blocs: <br><br><ul><li>  pr√©paration des sources et des environs; </li><li>  normalisation des √©v√©nements et leur enrichissement; </li><li>  adaptation des r√®gles de corr√©lation au contexte de l'AS; </li><li>  formation d'un accord sur les positifs. </li></ul><br><h1>  Pr√©paration des sources et des environnements </h1><br>  Les r√®gles de corr√©lation fonctionnent sur les √©v√©nements qui g√©n√®rent des sources.  √Ä cet √©gard, il est extr√™mement important que les sources requises pour les r√®gles de corr√©lation soient pr√©sentes dans les haut-parleurs et soient correctement configur√©es. <br><br><img src="https://habrastorage.org/webt/7r/ih/b5/7rihb5lksdmrzhpjpte5q9-3wls.png" alt="Pr√©paration des sources et des environnements"><br>  <i>Pr√©paration des sources et des environnements</i> <br><br>  <b>√âtape 1</b> : <i>R√©fl√©chissez √† la logique g√©n√©rale de la r√®gle et comprenez quelles sources d'√©v√©nements sont n√©cessaires.</i>  Si vous d√©veloppez √† partir de z√©ro ou prenez une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">r√®gle de</a> corr√©lation <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Sigma</a> pr√™te √† l'emploi, vous devez comprendre en fonction des √©v√©nements √† partir de quelles sources cela fonctionnera. <br><br>  <b>√âtape 2</b> : <i>Assurez-vous que toutes les sources n√©cessaires se trouvent dans l'entreprise et qu'elles peuvent √™tre collect√©es.</i>  Une situation est possible lorsqu'une r√®gle op√®re sur une cha√Æne d'√©v√©nements provenant de plusieurs sources du formulaire (√©v√©nement A de la source 1) - (√©v√©nement B de la source 2) - (√©v√©nement C de la source 3) pendant 5 minutes.  Si votre entreprise n'a pas au moins une source, une telle r√®gle devient inutile, car elle ne fonctionnera jamais.  Vous devez comprendre si, en principe, il est possible de collecter des √©v√©nements aupr√®s des sources n√©cessaires et si votre SIEM peut les fournir.  Par exemple, la source √©crit des √©v√©nements dans un fichier, mais le fichier est chiffr√© ou une base de donn√©es non standard est utilis√©e sur la source pour le stockage, dont l'acc√®s ne peut pas √™tre assur√© via le pilote ODBC / JDBC standard. <br><br>  <b>√âtape 3</b> : <i>connectez les sources au SIEM.</i>  <i>Peu importe √† quel point cela peut sembler banal, mais √† cette √©tape, il est n√©cessaire de mettre en ≈ìuvre la collecte d'√©v√©nements.</i>  Il y a souvent de nombreux probl√®mes.  Par exemple, des probl√®mes d'organisation, lorsque la direction informatique interdit cat√©goriquement la connexion aux syst√®mes critiques.  Ou technique, sans param√®tres suppl√©mentaires, l'agent SIEM (SmartConnector, Universal Forwarder), lors de la collecte des √©v√©nements, ¬´tue¬ª simplement la source, conduisant √† un d√©ni de service.  Cela peut souvent √™tre observ√© lors de la connexion de SGBD tr√®s charg√©s √† SIEM. <br><br>  <b>√âtape 4</b> : <i>Assurez-vous que l'audit sur les sources est correctement configur√©, les √©v√©nements n√©cessaires √† la corr√©lation sont re√ßus dans SIEM.</i>  Les r√®gles de corr√©lation attendent certains types d'√©v√©nements.  Ils doivent √™tre g√©n√©r√©s par la source.  Il arrive souvent que pour g√©n√©rer les √©v√©nements n√©cessaires aux r√®gles, la source doit √™tre configur√©e en plus: l'audit avanc√© est activ√© et la sortie du journal dans un certain format est configur√©e. <br><br>  L'activation de l'audit √©tendu affecte souvent la quantit√© de flux d'√©v√©nements (EPS) re√ßus dans le SIEM de la source.  √âtant donn√© que la source elle-m√™me et le SIEM rel√®vent de la responsabilit√© de diff√©rents services, il y a toujours un risque que l'audit √©tendu soit d√©sactiv√© et, par cons√©quent, les types d'√©v√©nements n√©cessaires cessent d'arriver au SIEM.  Ce probl√®me peut √™tre partiellement d√©tect√© en surveillant le flux d'√©v√©nements pour chaque source, ou plut√¥t en surveillant les changements dans les √©v√©nements par seconde (EPS). <br><br>  <b>√âtape 5</b> : <i>V√©rifiez que les √©v√©nements sont en cours et configurez la surveillance des sources.</i>  Dans toute infrastructure, t√¥t ou tard, des d√©faillances du r√©seau ou de la source elle-m√™me apparaissent.  √Ä ce stade, SIEM perd le contact avec la source et ne peut pas recevoir d'√©v√©nements.  Si la source est passive et √©crit ses journaux dans un fichier ou une base de donn√©es, les √©v√©nements ne seront pas perdus en cas d'√©chec, et SIEM pourra les recevoir lorsque la communication sera r√©tablie.  Si la source est active et envoie des √©v√©nements √† SIEM, par exemple, via syslog, sans les enregistrer ailleurs, les √©v√©nements seront perdus en cas d'√©chec et votre r√®gle de corr√©lation ne fonctionnera tout simplement pas, car l'√©v√©nement souhait√© n'attendra pas.  En creusant plus profond√©ment, vous pouvez voir que, m√™me lorsque vous travaillez avec une source passive, lors de la restauration de la communication apr√®s une d√©faillance, rien ne garantit que les r√®gles de corr√©lation fonctionneront, en particulier celles qui fonctionnent avec des fen√™tres temporelles.  Consid√©rez l'exemple de r√®gle d√©crit ci-dessus: (√©v√©nement A de la source 1) - (√©v√©nement B de la source 2) - (√©v√©nement C de la source 3) pendant 5 minutes.  Si une d√©faillance se produit apr√®s l'√©v√©nement B et que la connexion est r√©tablie dans une heure, la corr√©lation ne fonctionnera pas, car l'√©v√©nement C n'arrivera pas dans les 5 minutes attendues. <br><br>  En gardant ces fonctionnalit√©s √† l'esprit, vous devez configurer la surveillance des sources √† partir desquelles les √©v√©nements sont collect√©s.  Ce suivi doit surveiller la disponibilit√© des sources, la ponctualit√© de l'arriv√©e des √©v√©nements √† partir de celles-ci, la puissance du flux des √©v√©nements collect√©s (EPS). <br><br>  Le d√©clenchement du syst√®me de surveillance est la premi√®re cloche qui parle de l'apparition d'un facteur n√©gatif affectant les performances de tout ou partie des r√®gles de corr√©lation. <br><br><h1>  Normalisation des √©v√©nements et leur enrichissement </h1><br>  La collecte des √©v√©nements n√©cessaires √† la corr√©lation ne suffit pas.  Les √©v√©nements arrivant au SIEM doivent √™tre normalis√©s en stricte conformit√© avec les r√®gles accept√©es.  Nous avons √©crit sur les probl√®mes de normalisation et la formation d'une m√©thodologie de normalisation dans un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article</a> s√©par√©.  En g√©n√©ral, ce bloc peut √™tre caract√©ris√© comme une lutte contre les d√©chets entrants, les d√©chets <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sortants</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">GIGO</a> ). <br><br><img src="https://habrastorage.org/webt/1b/na/-x/1bna-xnslsomq5xp8shkaz7snr4.png" alt="Normalisation et enrichissement des √©v√©nements"><br>  <i>Normalisation et enrichissement des √©v√©nements</i> <br><br>  <b>√âtape 6</b> et <b>√©tape 7</b> : <i>Cat√©gorisation des √©v√©nements et normalisation des √©v√©nements en fonction de la cat√©gorie, sur la base de la m√©thodologie.</i>  Nous ne nous attarderons pas sur eux en d√©tail, puisque nous avons examin√© ces √©tapes en d√©tail dans l'article <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">¬´M√©thodologie de normalisation des √©v√©nements¬ª</a> . <br><br>  <b>√âtape 8</b> : <i>Enrichissement des √©v√©nements avec des informations manquantes et suppl√©mentaires, conform√©ment √† la cat√©gorie.</i>  Souvent, les √©v√©nements entrants ne contiennent pas toujours les informations n√©cessaires pour que les r√®gles de corr√©lation fonctionnent.  Par exemple, un √©v√©nement ne contient que l'adresse IP de l'h√¥te, mais il n'y a aucune information sur son nom de domaine complet ou son nom d'h√¥te.  Autre exemple: un √©v√©nement contient un ID utilisateur, mais il n'y a pas de nom d'utilisateur dans l'√©v√©nement.  Dans ce cas, les informations n√©cessaires doivent √™tre extraites de sources externes - bases de donn√©es, contr√¥leurs de domaine ou autres r√©pertoires et ajout√©es √† l'√©v√©nement. <br><br>  Il est important de noter que la cat√©gorisation des √©v√©nements se produit au tout d√©but - avant la normalisation.  En plus du fait que la cat√©gorie d√©finit les r√®gles de normalisation de l'√©v√©nement, elle d√©finit √©galement la liste des donn√©es qui doivent √™tre recherch√©es dans des sources externes si elles ne se trouvent pas dans l'√©v√©nement lui-m√™me. <br><br><h1>  Adapter les r√®gles de corr√©lation au contexte AS </h1><br>  Apr√®s avoir pr√©par√© les donn√©es d'entr√©e (√©v√©nements) et proc√©d√© au d√©veloppement de r√®gles de corr√©lation, il est n√©cessaire de prendre en compte les sp√©cificit√©s des √©v√©nements entrants, l'AS lui-m√™me et sa variabilit√©.  Pour en savoir plus, consultez l'article <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">¬´Mod√®le de syst√®me en tant que contexte des r√®gles de corr√©lation¬ª</a> . <br><br><img src="https://habrastorage.org/webt/i6/tr/uk/i6trukg2z33jqm-lhuzuierlcbk.png" alt="Adaptateur les r√®gles de corr√©lation au contexte AS"><br>  <i>Adapter les r√®gles de corr√©lation au contexte AS</i> <br><br>  <b>√âtape 9</b> : <i>Comprendre la fr√©quence des √©v√©nements de chaque source, d√©terminer la fen√™tre de temps pour la corr√©lation.</i>  Tr√®s souvent, les r√®gles de corr√©lation utilisent des fen√™tres temporelles lorsqu'il est n√©cessaire de pr√©voir l'arriv√©e d'un certain √©v√©nement dans un intervalle de temps donn√©.  Lors de l'√©laboration de telles r√®gles, il est important de tenir compte du retard dans la r√©ception des √©v√©nements.  Ils sont g√©n√©ralement caus√©s par deux facteurs. <br><br>  <b>Premi√®rement</b> , la source elle-m√™me peut ne pas √©crire imm√©diatement les √©v√©nements dans la base de donn√©es, dans un fichier ou l'envoyer via syslog.  Le temps de ce retard doit √™tre estim√© et pris en compte dans la r√®gle. <br><br>  <b>Deuxi√®mement</b> , il y a un retard dans la livraison des √©v√©nements au SIEM.  Par exemple, la collecte d'√©v√©nements de la base de donn√©es est configur√©e de sorte que la demande d'√©v√©nements soit effectu√©e toutes les 10 minutes, bien s√ªr, que la fen√™tre de corr√©lation de 5 minutes n'est pas la meilleure solution dans cette situation. <br><br>  Le probl√®me est aggrav√© lorsqu'il est n√©cessaire de d√©velopper une r√®gle de corr√©lation qui fonctionne avec les √©v√©nements de plusieurs sources √† la fois.  Dans ce cas, il est important de comprendre qu'ils peuvent avoir des d√©lais de livraison diff√©rents.  Dans le pire des cas, les √©v√©nements viendront dans un ordre al√©atoire avec une violation de la chronologie.  Dans une telle situation, le d√©veloppeur des r√®gles de corr√©lation doit clairement comprendre √† quel moment le SIEM r√©alise la corr√©lation (au moment de l'√©v√©nement ou quand l'√©v√©nement est arriv√© dans SIEM).  Je note que la corr√©lation dans l'heure d'arriv√©e des √©v√©nements est l'option la plus simple et la plus courante sur le plan technique pour traiter les √©v√©nements en mode pseudo-temps r√©el.  Cependant, cette option ne fait qu'exacerber les probl√®mes ci-dessus et ne les r√©sout pas. <br><br>  Si votre SIEM fournit une corr√©lation dans le temps de l'√©v√©nement, il existe tr√®s probablement des m√©canismes de r√©organisation des √©v√©nements qui peuvent restaurer la chronologie r√©elle des √©v√©nements. <br><br>  Dans le cas o√π vous comprenez que la fen√™tre temporelle est trop grande pour effectuer une corr√©lation sur le flux, vous devez utiliser le m√©canisme de r√©tro-corr√©lation, dans lequel les √©v√©nements d√©j√† enregistr√©s sont s√©lectionn√©s dans la base de donn√©es SIEM selon le calendrier et parcourent les r√®gles de corr√©lation. <br><br>  <b>√âtape 10</b> : <i>√âtablir un m√©canisme d'exception.</i>  Dans le monde r√©el, il y aura toujours un objet avec un comportement sp√©cial qui ne devrait pas √™tre g√©r√© par une r√®gle de corr√©lation sp√©cifique, car cela conduit √† un faux positif.  Par cons√©quent, au stade de l'√©laboration des r√®gles, des m√©canismes devraient √™tre mis en place pour ajouter de tels objets aux exceptions.  Par exemple, si votre r√®gle fonctionne avec les adresses IP des machines, vous avez besoin d'une liste de tableaux dans laquelle vous pouvez ajouter des adresses pour lesquelles la r√®gle ne fonctionnera pas.  De m√™me, si une r√®gle fonctionne avec des connexions utilisateur ou des noms de processus, il est n√©cessaire de travailler au pr√©alable avec des listes d'exclusion de table dans la logique de la r√®gle. <br><br>  Cette approche vous permettra d'ajouter automatiquement ou manuellement des objets aux exceptions sans avoir √† r√©√©crire le corps de la r√®gle. <br><br>  <b>√âtape 11</b> : <i>D√©finissez les limites physiques et logiques de l'applicabilit√© de la r√®gle de corr√©lation.</i>  Lors de l'√©laboration d'une r√®gle de corr√©lation, il est important de comprendre initialement les limites d'applicabilit√© (port√©e) de la r√®gle et si elles existent.  Lors de l'√©laboration de la logique et du d√©bogage de la r√®gle, il est n√©cessaire de se concentrer sur les sp√©cificit√©s de ce domaine.  Si une r√®gle commence √† travailler avec des donn√©es qui d√©passent le cadre de cette zone, la probabilit√© de faux positifs augmente. <br><br>  Deux types de port√©e peuvent √™tre distingu√©s: physique et logique.  La port√©e physique correspond aux r√©seaux de l'entreprise et adjacents, et la zone logique correspond aux parties de l'AS, des applications m√©tier ou des processus m√©tier.  Exemples de zone physique: segment DMZ, sous-r√©seaux internes et externes, r√©seaux d'acc√®s √† distance.  Exemples de la port√©e logique des r√®gles: ACS TP, comptabilit√©, segment PCI DSS, segment PD ou simplement des r√¥les d'√©quipement sp√©cifiques - contr√¥leurs de domaine, commutateurs d'acc√®s, routeurs principaux. <br><br>  Vous pouvez d√©finir des √©tendues pour les r√®gles de corr√©lation via des listes de tableaux.  Ils peuvent √™tre remplis manuellement ou automatiquement.  Si vous trouvez du temps dans votre entreprise pour la gestion d'actifs (Asset management), alors toutes les donn√©es n√©cessaires peuvent d√©j√† √™tre contenues dans le mod√®le AS cr√©√© dans SIEM.  La g√©n√©ration automatique de telles listes tabulaires vous permet d'inclure dynamiquement dans le p√©rim√®tre de nouveaux actifs qui apparaissent dans l'entreprise.  Par exemple, si vous disposiez d'une r√®gle qui fonctionnait exclusivement avec des contr√¥leurs de domaine, l'ajout d'un nouveau contr√¥leur √† la for√™t de domaine sera corrig√© dans le mod√®le et tombera dans le champ d'application de votre r√®gle. <br><br>  En g√©n√©ral, les listes de tableaux utilis√©es pour les exceptions peuvent √™tre consid√©r√©es comme des listes noires et les listes responsables de la port√©e des r√®gles comme des listes blanches. <br><br>  <b>√âtape 12</b> : <i>Utilisez le mod√®le de haut-parleur pour clarifier le contexte.</i>  Dans le processus de d√©veloppement d'une r√®gle de corr√©lation qui identifie les actions malveillantes, il est important de s'assurer qu'elles peuvent r√©ellement √™tre mises en ≈ìuvre.  Si cela n'est pas pris en compte, le d√©clenchement de la r√®gle qui a r√©v√©l√© l'attaque potentielle se r√©v√©lera faux, car ce type d'attaque peut tout simplement ne pas s'appliquer √† votre infrastructure.  Je vais expliquer avec un exemple: <br><br><ol><li>  Supposons que nous ayons une r√®gle de corr√©lation qui d√©tecte les connexions RDP distantes aux serveurs. </li><li>  Le pare-feu affiche une tentative de connexion au port TCP 3389 du serveur myserver.local. </li><li>  La r√®gle se d√©clenche et vous commencez √† analyser un incident potentiel avec une priorit√© √©lev√©e. </li></ol><br>  Au cours de l'enqu√™te, vous d√©couvrez rapidement que sur myserver.local 3389, il est ferm√© et n'a jamais √©t√© ouvert par aucun service et Linux est l√†.  C'est un faux positif qui vous a pris du temps pour enqu√™ter. <br><br>  Autre exemple: IPS envoie un √©v√©nement d√©clencheur de signature lorsqu'une tentative est faite pour exploiter la vuln√©rabilit√© CVE-2017-0144, cependant, au cours de l'enqu√™te, il s'av√®re que le correctif correspondant est install√© sur la machine attaqu√©e et il n'est pas n√©cessaire de r√©pondre √† un tel incident avec la plus haute priorit√©. <br>  L'utilisation des donn√©es du mod√®le d'enceinte aidera √† r√©gler ce probl√®me. <br><br>  <b>√âtape 13</b> : <i>utilisez des identifiants d'entit√©, pas leurs cl√©s source.</i>  Comme d√©j√† d√©crit dans l'article <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">¬´Mod√®le syst√®me en tant que contexte de r√®gles de corr√©lation¬ª, l'</a> adresse IP, le nom de domaine complet et m√™me le MAC d'un actif peuvent changer.  Ainsi, si vous utilisez les identifiants de source de l'actif dans la r√®gle de corr√©lation ou la liste des tables, apr√®s un certain temps, il y a de fortes chances de recevoir des faux positifs pour une raison compl√®tement banale, par exemple, le serveur DHCP a simplement d√©livr√© cette IP √† une autre machine. <br><br>  Si votre SIEM dispose d'un m√©canisme pour identifier les actifs, suivre leurs modifications et vous permettre de fonctionner avec leurs identifiants, vous devez utiliser des identifiants, pas les cl√©s source de l'actif. <br><br><h1>  Formation d'un accord positif </h1><br>  √Ä l'approche du dernier bloc de cr√©ation de la r√®gle de corr√©lation, nous rappelons que le r√©sultat de la r√®gle est un incident √©voqu√© dans SIEM.  Les professionnels responsables doivent r√©pondre √† un tel incident.  Bien que le but de cette s√©rie d'articles ne comprenne pas l'examen du processus de r√©ponse aux incidents, il convient de noter qu'une partie des informations sur l'incident est d√©j√† g√©n√©r√©e au stade de la cr√©ation de la r√®gle de corr√©lation correspondante. <br><br>  Ensuite, nous consid√©rons les points de base √† prendre en compte lors de la configuration des param√®tres de d√©clenchement de la r√®gle de corr√©lation et de g√©n√©ration d'un incident. <br><br><img src="https://habrastorage.org/webt/fg/z5/dj/fgz5djbyxha-uqiduo8ubym8ncq.png" alt="Formation d'un accord positif"><br>  <i>Formation d'un accord positif</i> <br><br>  <b>√âtape 14</b> : <i>D√©terminez les conditions d'agr√©gation et d'arr√™t en cas de grand nombre de faux positifs.</i>  Au stade du d√©bogage, et en cours de fonctionnement, si vous n'adh√©rez pas √† cette technique :), de fausses alarmes des r√®gles peuvent se produire.  C'est bien s'il y a un ou deux voyages par jour, mais qu'en est-il si une r√®gle a des milliers ou des dizaines de milliers de voyages?  Bien s√ªr, cela sugg√®re que la r√®gle doit √™tre d√©velopp√©e davantage.  Cependant, il est n√©cessaire de veiller √† ce que dans de telles situations un faux positif aussi massif: <br><br><ol><li>  Cela n'a pas affect√© les performances SIEM. </li><li>  Parmi la masse des faux positifs, les incidents vraiment importants n'ont pas √©t√© perdus.  Il existe m√™me un type d'attaque distinct visant √† cacher la principale activit√© malveillante derri√®re de nombreuses fausses <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">activit√©s</a> . </li></ol><br>  Des probl√®mes de ce type peuvent √™tre r√©solus si, lors de la cr√©ation d'une r√®gle de corr√©lation au niveau de l'ensemble du syst√®me dans son ensemble ou pour chaque r√®gle s√©par√©ment, des conditions d'agr√©gation des incidents et des conditions d'arr√™t d'urgence de la r√®gle sont d√©finies. <br><br>  Le m√©canisme d'agr√©gation des incidents permettra de ne pas cr√©er des millions d'incidents identiques, mais de ¬´coller¬ª de nouveaux incidents √† un, √† condition qu'ils soient identiques.  Dans les cas extr√™mes, lorsque m√™me l'agr√©gation d'incidents donne une charge importante, il est recommand√© de configurer la d√©sactivation automatique de la r√®gle de corr√©lation en cas de d√©passement d'un nombre donn√© d'op√©rations par unit√© de temps (minute, heure, jour). <br><br>  <b>√âtape 15</b> : <i>D√©finissez les r√®gles de g√©n√©ration du nom de l'incident.</i>  Cet √©l√©ment est souvent n√©glig√©, surtout s'ils ne d√©veloppent pas de r√®gles pour leur entreprise, par exemple, si une entreprise tierce est responsable de la mise en ≈ìuvre du SIEM et de l'√©laboration des r√®gles.  Le nom de la r√®gle de corr√©lation, ainsi que l'incident qu'elle a g√©n√©r√©, doivent √™tre courts et refl√©ter clairement l'essence d'une r√®gle particuli√®re. <br><br>  Si plusieurs personnes utilisent des r√®gles d'incidents et de corr√©lation dans votre entreprise, il est recommand√© de d√©velopper des r√®gles de d√©nomination.  Ils doivent √™tre compris et accept√©s par toute l'√©quipe travaillant avec SIEM. <br><br>  <b>√âtape 16</b> : <i>D√©finissez les r√®gles pour d√©terminer l'importance de l'incident.</i>  La plupart des solutions SIEM √† la derni√®re √©tape de la cr√©ation d'un incident vous permettent de d√©finir son importance et sa signification.  Certaines d√©cisions calculent m√™me automatiquement l'importance, en fonction du contexte de l'incident et des objets impliqu√©s. <br><br>  Dans le cas o√π votre SIEM effectue un calcul exclusivement automatique de l'importance des incidents, il est utile de d√©terminer sur la base de quoi et par quelle formule il est calcul√©.  Par exemple, si l'importance est calcul√©e sur la base de l'importance des actifs impliqu√©s dans l'incident, vous devez prendre au s√©rieux les probl√®mes de gestion d'actifs dans une entreprise √† l'avance. <br><br>  Si vous d√©finissez manuellement l'importance d'un incident, il est recommand√© de d√©velopper une formule de calcul qui tienne compte au moins des √©l√©ments suivants: <br><br><ol><li>  L'importance de la port√©e dans laquelle la r√®gle fonctionne.  Par exemple, un incident dans la zone critique des syst√®mes de la mission peut √™tre plus critique que si le m√™me incident exact s'est produit dans la zone des syst√®mes critiques de l'entreprise. </li><li>  L'importance des actifs et des comptes d'utilisateurs impliqu√©s dans l'incident. </li><li>  La r√©currence de cet incident dans l'entreprise. </li></ol><br>  De m√™me, comme dans la d√©nomination des incidents, il est important que toutes les parties int√©ress√©es comprennent clairement et √©galement les r√®gles selon lesquelles l'importance d'un incident se forme. <br><a name="Conclusions"></a><br><h1>  Conclusions </h1><br>  En r√©sumant les r√©sultats de notre s√©rie d'articles, je note qu'il est possible, √† mon avis, de cr√©er des r√®gles de corr√©lation qui fonctionnent hors de la bo√Æte.  La solution peut √™tre une fusion d'approches organisationnelles et techniques.  Le SIEM lui-m√™me doit √™tre capable de faire quelque chose, mais les sp√©cialistes qui l'exploitent doivent le faire et le savoir. <br><br>  Pour r√©sumer: <br><br><ol><li>  La m√©thode se compose des blocs suivants: <br><ul><li>  Pr√©paration des sources et des environnements. </li><li>  Normalisation des √©v√©nements et leur enrichissement. </li><li>  Adaptation des r√®gles de corr√©lation au contexte AS. </li><li>  Formation d'un accord sur les positifs. </li></ul></li><li>  Chaque unit√© a des composantes organisationnelles et techniques. </li><li>    ,        SIEM,        . </li><li>      ,     ,     SIEM-. </li><li>              .      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> . </li></ol><br><a name="Schema"></a><br><img src="https://habrastorage.org/webt/iw/gz/kz/iwgzkzilc0khjwsscaycz8mowes.png" alt="M√©thodologie pour d√©velopper des r√®gles de corr√©lation hors de la bo√Æte"><br> <i>   ,  ¬´ ¬ª</i> <br><br>   ,     ,       .      ‚Äî        .   . <br><a name="Articles"></a><br><hr><br> <b> :</b> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> SIEM:  ¬´ ¬ª.  1:     ?</a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> SIEM:  ¬´ ¬ª.  2.      ¬´¬ª</a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> SIEM:  ¬´ ¬ª.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 3.1.</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> SIEM:  ¬´ ¬ª.  3.2.   </a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> SIEM:  ¬´ ¬ª.  4.      </a> <br><br>  SIEM:  ¬´ ¬ª.  5.     ( <i> </i> ) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr446212/">https://habr.com/ru/post/fr446212/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr446202/index.html">Le condens√© de mati√®res fra√Æches du monde du front-end de la derni√®re semaine n ¬∞ 358 (25 - 31 mars 2019)</a></li>
<li><a href="../fr446204/index.html">Pr√©vision sur la mani√®re dont les restrictions Internet seront surmont√©es</a></li>
<li><a href="../fr446206/index.html">Tutoriel React, partie 26: Architecture d'application, mod√®le de conteneur / composant</a></li>
<li><a href="../fr446208/index.html">Tutoriel React Partie 25: Atelier sur les formulaires</a></li>
<li><a href="../fr446210/index.html">ADAM-3600 - un contr√¥leur industriel multifonctionnel</a></li>
<li><a href="../fr446214/index.html">OS1: un noyau primitif sur Rust pour x86. Partie 3. Carte m√©moire, exception de d√©faut de page, tas et allocations</a></li>
<li><a href="../fr446218/index.html">Le game designer n'est pas tr√®s diff√©rent d'un psycho. Comment nous avons cr√©√© le jeu CMAN</a></li>
<li><a href="../fr446222/index.html">Utilisation des potentiels thermiques pour l'analyse de territoire</a></li>
<li><a href="../fr446228/index.html">Am√©liorer la qualit√© de la classification des textes en connectant Wikipedia</a></li>
<li><a href="../fr446230/index.html">Surveillance et gestion √† distance des p√©riph√©riques bas√©s sur Linux / OpenWrt / Lede via le port 80, suite</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>