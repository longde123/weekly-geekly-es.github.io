<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ± ğŸ‘ğŸ¾ â˜¸ï¸ Tutorial DataPower ğŸŒ«ï¸ ğŸš´ğŸ¼ ğŸ¤šğŸ¾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Materi yang ditulis bersama oleh wedmeed 


 Pada 2017, ketika proyek kami dimulai di Vietnam, kami menemui binatang buas IBM DataPower untuk kami. IB...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tutorial DataPower</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/neoflex/blog/442686/"><p>  Materi yang ditulis bersama oleh <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link">wedmeed</a> </p><br><p> Pada 2017, ketika proyek kami dimulai di Vietnam, kami menemui binatang buas IBM DataPower untuk kami.  IBM DataPower adalah produk gerbang antara klien dan backend yang dirancang untuk menyaring, merutekan, memperkaya atau transformasi pesan lainnya yang melewatinya (selanjutnya disebut sebagai permintaan).  Itu perlu untuk belajar dengan cepat, tidak ada waktu untuk penumpukan, jadi kami diminta untuk membiasakan diri dengan itu, setelah itu ada berjam-jam konferensi Skype dengan rekan kami dari Moskow, yang menyampaikan kepada kami pengetahuan dan pengalamannya dengan produk ini. <br></p><br><p>  Belajar mandiri didasarkan pada mempelajari dokumentasi dan menonton video pelatihan dari Internet - dan di sini saya menunggu untuk menangkap.  Saya praktis tidak dapat menemukan informasi dalam bahasa Rusia.  Omong-omong, pengetahuan saya tentang bahasa Inggris pada waktu itu tidak pada tingkat tertinggi, selain itu adalah proyek pertama saya dan, mungkin, faktor-faktor ini mempersulit hidup saya.  Ini mendorong saya untuk menulis artikel pelatihan dalam bahasa Rusia dan dengan cara yang sesederhana mungkin bagi pengembang pemula yang menemukan produk ini dan berusaha untuk dengan cepat memahami dasar-dasarnya.  Artikel ini tidak akan membebaskan Anda dari membaca dokumentasi, tetapi itu akan membuat hidup lebih mudah pada tahap awal pemahaman "cara kerjanya." <br></p><br><p>  Perlu juga dicatat bahwa struktur yang diberikan dalam praktek akan dekat dengan proyek nyata, yang akan memungkinkan Anda untuk menggunakannya sebagai basis, memperluas dan melengkapi kebutuhan Anda.  Sebagai kesimpulan, beberapa kata tentang proyek yang sudah dilaksanakan, serta beberapa fitur yang perlu diperhatikan, akan diberikan ke bagian Teori. </p><br><img src="https://habrastorage.org/webt/rm/at/lk/rmatlkcfuvcjxvgireijushp7yc.jpeg"><br><a name="habracut"></a><br><h2>  Bagian 1. Menginstal DataPower dengan Docker Toolbox </h2><br><p>  Instal dan jalankan aplikasi Docker Toolbox.  Segera setelah memulai, Anda akan melihat alamat IP mesin, di mana DataPower akan tersedia di masa depan: <br></p><br><img src="https://habrastorage.org/webt/zs/qa/wn/zsqawn2jksqp8j8gfl5gwslnks4.png"><br><br><p>  Untuk memulai gambar, Anda perlu mengubah beberapa pengaturan mesin virtual (relevan untuk versi IDG.2018.4.1.0) dan mulai ulang: <br></p><br><ol><li>  Hentikan mesin buruh pelabuhan dengan perintah: <br><br><pre><code class="plaintext hljs">docker-machine stop</code> </pre> </li><li>  Sistem -&gt; Motherboard -&gt; Memori utama: minimum 4096Mb; <br></li><li>  Sistem -&gt; Prosesor: minimum 2; <br></li><li>  Tampilan -&gt; Layar -&gt; Memori video: setidaknya 128Mb; <br></li><li>  Kami meluncurkan mesin buruh pelabuhan dengan perintah: <br><br><pre> <code class="plaintext hljs">docker-machine start</code> </pre> <br>  <i>Catatan</i>  <i>Jika diminta untuk memulai ulang docker-machine env, jalankan:</i> <br><br><pre> <code class="plaintext hljs">docker-machine env</code> </pre> </li><li>  Selanjutnya, Anda harus mengempiskan gambar IBM DataPower: <br><br><pre> <code class="plaintext hljs">docker pull ibmcom/datapower</code> </pre> </li><li>  Kemudian meluncurkan wadah buruh pelabuhan dengan perintah berikut: <br><br><pre> <code class="plaintext hljs">docker run -it \ -v $PWD/config:/drouter/config \ -v $PWD/local:/drouter/local \ -e DATAPOWER_ACCEPT_LICENSE=true \ -e DATAPOWER_INTERACTIVE=true \ -p 9090:9090 \ -p 3630:3630 \ -p 9022:22 \ -p 7170:7170 \ --name idg \ ibmcom/datapower</code> </pre></li><li>  Setelah menyelesaikan perintah, tekan Enter dan masukkan <b>admin / admin</b> sebagai nama pengguna dan kata sandi <br></li><li>  Untuk memulai Antarmuka Manajemen Web, gunakan perintah: <br><br><pre> <code class="plaintext hljs">co</code> </pre> <br>  dan <br><br><pre> <code class="plaintext hljs">web-mgmt 0 9090</code> </pre> </li><li>  Setelah semua langkah ini, jalankan di browser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://192.168.99.100:9090/</a> <br></li></ol><br><h2>  Bagian 2. Domain </h2><br><h3>  2.1.  Teori </h3><br><p>  Domain di DataPower memungkinkan Anda memisahkan alat administrasi dan pengembangan, serta memberikan keamanan. <br></p><br><p>  Setelah instalasi, hanya ada domain default dari mana domain aplikasi dapat dibuat.  Setiap domain memiliki konfigurasi parameternya sendiri. <br></p><br><p>  Beberapa sumber daya dan parameter umum hanya dapat didefinisikan dalam domain default, ini termasuk antarmuka jaringan, pengguna dan kontrol akses, domain aplikasi, dan lainnya. <br></p><br><p>  Domain aplikasi adalah bagian pengembangan untuk layanan pemrosesan permintaan.  Layanan yang ditentukan di dalamnya tidak dapat dibagikan dengan domain aplikasi lain.  Domain aplikasi dapat di-restart secara terpisah dan mandiri, tanpa perlu restart penuh DataPower. <br></p><br><p>  Anda dapat membuat, memulai kembali, mengatur ulang, menjeda, memperbarui, atau menghapus domain.  Anda dapat menemukan informasi lebih rinci tentang semua fitur administrasi dalam dokumentasi resmi. <br></p><br><p>  Sedikit tentang proyek yang sudah selesai.  Kami menggunakan 3 domain: <br></p><br><ul><li>  default - domain default yang berisi sumber daya dan parameter bersama; </li><li>  trunk - domain utama yang berisi semua yang diperlukan untuk memproses permintaan; </li><li>  pengaturan - pengaturan dan domain keamanan, file lokal berisi informasi tentang aturan perutean layanan dan pengaturan keamanan. </li></ul><br><p>  Kebutuhan untuk mentransfer semua pengaturan ke domain terpisah muncul sehubungan dengan pencarian untuk jalur penyebaran yang lebih sederhana.  Seperti di banyak proyek, lingkungan pengembang, pengujian dan produksi dipisahkan, dan transfer ke domain pengaturan terpisah memungkinkan kami untuk menginstal semua domain utama dari lingkungan pengembang di lingkungan lain melalui ekspor / impor, tanpa risiko kehilangan pengaturan lingkungan. <br></p><br><h3>  2.2.  Berlatih </h3><br><ul><li>  Di bidang pencarian, masukkan "domain", pilih "Domain Aplikasi" dan klik "Tambah" <br><img src="https://habrastorage.org/webt/uo/k_/gs/uok_gsaxjifcklt56rs9wmiujhm.png"></li><li>  Di sini Anda perlu menentukan nama domain, komentar (jika diinginkan) dan mengaktifkan audit dan pencatatan.  Isi kolom dan terapkan perubahannya <br><img src="https://habrastorage.org/webt/3b/6w/ts/3b6wtsfrlvxcxgb7jgpkmm6u1rq.png"></li><li>  Demikian pula menambahkan "trunk" domain lain </li><li>  Pergi ke Tinjau perubahan <br><img src="https://habrastorage.org/webt/p-/nh/cp/p-nhcpeur45dhrzahmpffom9pq8.png"></li><li>  dan simpan konfigurasi domain <br><img src="https://habrastorage.org/webt/1u/8n/si/1u8nsi-zblkkqdsrpa7lnqcgw8g.png"></li><li>  Anda dapat memeriksa status objek yang dibuat dengan masuk ke domain default di pohon navigasi di Status -&gt; Main -&gt; Status Obyek <br><img src="https://habrastorage.org/webt/uz/qo/q4/uzqoq4kek4qdgkfkhovrjmiridm.png"></li><li>  Pilih <b><i>Lihat berdasarkan: jenis</i></b> <br><img src="https://habrastorage.org/webt/fj/5_/6z/fj5_6zg-kidxhkt5as0omzfvsiw.png"></li><li>  Temukan Domain Aplikasi dalam daftar dan periksa status objek: masing-masing harus disimpan, dihidupkan, dan dalam status naik.  Jika demikian, lanjutkan ke bab berikutnya. </li></ul><br><img src="https://habrastorage.org/webt/xa/ii/kj/xaiikjxfdhsy19lez-rxo2xmeug.png"><br><br><h2>  Bagian 3. Manajer antrian </h2><br><p>  Manajer antrian bukan merupakan komponen wajib dari IBM DataPower, tetapi melalui contoh MQ Anda dapat menunjukkan kekuatan penuh dari produk ini.  Kami akan menggunakan MQ dari IBM.  Selama pengujian yang dijelaskan dalam Bab 6, kita perlu mengirim pesan ke manajer antrian lokal.  Pada artikel ini, saya akan melakukan ini menggunakan utilitas rfhutil, tetapi Anda dapat menggunakan metode apa pun yang tersedia untuk Anda.  Untuk pengujian, Anda harus membuat koneksi dari DP ke manajer antrian lokal menggunakan MQ Queue Manager. </p><br><cut></cut><br><h3>  3.1.  Teori </h3><br><p>  Manajer antrian menyediakan pertukaran data antara gateway dan manajer antrian jarak jauh. </p><br><p>  Anda juga dapat mengkonfigurasi MQ Queue Manager Group, yang akan meningkatkan toleransi kesalahan sistem.  Ini dapat berguna, misalnya, jika Anda ingin menghubungkan klien ke salah satu set manajer antrian yang bekerja dan dalam beberapa kasus, yang dapat Anda temukan di dokumentasi resmi. </p><br><p>  Dari pengalaman proyek, perlu dicatat hanya satu fitur: pada satu waktu kami ingin mencoba menerapkan load balancing menggunakan DataPower, khususnya, menggunakan kelompok manajer antrian, tetapi dalam praktiknya kami tidak menemukan kemungkinan seperti itu.  Solusi alternatif adalah membuat sekelompok manajer antrian. </p><br><br><h3>  3.2.  Berlatih </h3><br><h4>  3.2.1.  Persiapan </h4><br><ol><li>  Instal WebSphere MQ; </li><li>  Buat LOCAL_DP_QM manajer antrian lokal, dapat diakses di port 3630; </li><li>  Konfigurasikan saluran DP.SVRCONN; <br><br><p>  Saat membuat saluran, perintah berikut mungkin berguna bagi Anda: </p><br><pre> <code class="plaintext hljs">strmqm LOCAL_DP_QM /*  mq*/ runmqsc LOCAL_DP_QM /*   mq*/ DEFINE CHANNEL (DP.SVRCONN) CHLTYPE(SVRCONN) MCAUSER('evlasenko') /* */ SET CHLAUTH('DP.SVRCONN') TYPE(USERMAP) CLNTUSER('evlasenko') USERSRC(channel) ADDRESS('*') ACTION(ADD) /*      */ SET CHLAUTH(DP.SVRCONN) TYPE(BLOCKUSER) USERLIST('nobody') /*   */ ALTER LISTENER (SYSTEM.DEFAULT.LISTENER.TCP) TRPTYPE(TCP) PORT(3630) control(QMGR) /*    3630*/ ALTER AUTHINFO (SYSTEM.DEFAULT.AUTHINFO.IDPWOS) AUTHTYPE(IDPWOS) CHCKCLNT(OPTIONAL) /* */ REFRESH SECURITY TYPE(CONNAUTH) /*  */ endmqm LOCAL_DP_QM /*  mq*/ strmqm LOCAL_DP_QM /*  mq*/ END</code> </pre><br></li><li>  Buat antrian DP.IIB.REQIN dan DP.IIB.RESIN </li><li>  Jalankan rfhutil di bawah nama pengguna yang salurannya dibuat.  Di baris Nama Manajer Antrian (untuk terhubung ke), tulis: <br><br><pre> <code class="plaintext hljs">DP.SVRCONN/TCT/127.0.0.1(3630)</code> </pre> <br></li><li>  Coba muat daftar nama antrian, seharusnya tidak ada kesalahan di jendela pesan.  Koneksi ke saluran telah diverifikasi. <br></li></ol><br><h4>  3.2.2.  Buat Manajer Antrian IBM MQ </h4><br><ol><li>  Buka domain trunk. </li><li>  Dalam pencarian, ketik MQ, pilih IBM MQ Queue Manager, dan klik Add. </li><li>  Anda perlu menentukan nama (TEST_QM), nama host manajer antrian, nama manajer antrian dan nama saluran, serta batas waktu.  Konfigurasikan dan simpan perubahan. <br><img src="https://habrastorage.org/webt/di/sg/x1/disgx1dt8szkq9uoicnlepcn9lg.png"><br></li></ol><br><p>  Periksa status objek manajer antrian dengan cara yang sama seperti memeriksa status domain.  Untuk melakukan ini, pilih Status Objek dan filter Lihat berdasarkan: dari domain trunk.  Di bagian "Manajer Antrian IBM MQ", cari objek yang sesuai dan periksa statusnya. </p><br><h2>  Bagian 4. Multiprotocol Gateways </h2><br><h3>  4.1.  Teori </h3><br><p>  Multi-Protocol Gateway (MPG) adalah gateway multi-protokol yang memungkinkan Anda untuk menerima permintaan dari klien menggunakan berbagai protokol, dan kemudian mentransfernya ke server yang berbeda menggunakan berbagai protokol.  Protokol yang digunakan oleh klien mungkin tidak cocok dengan protokol yang digunakan oleh server akses jarak jauh. </p><br>  Dalam pengaturan MPG utama, Anda dapat menentukan komponen-komponen berikut: <br><br><ul><li>  Manajer XML - mengontrol kompilasi dan caching style sheet (xsl, xslt), caching dokumen. </li><li>  Kebijakan - terdiri dari aturan, yang masing-masing mendefinisikan serangkaian tindakan yang diterapkan pada pesan yang melewati gateway. </li><li>  Pengaturan sisi depan dan belakang (url pengaturan, jenis pesan masuk dan keluar, batas waktu dan banyak lagi). </li></ul><br><p>  Beberapa kata tentang proyek ini: </p><br><p>  Proyek ini menggunakan 4 gateway multi-protokol (perutean, 2 transformasional untuk sistem akhir yang berbeda dan satu lagi yang dirancang untuk menerima file dari domain pengaturan).  Diagram di bawah ini menunjukkan skema interaksi umum: </p><br><img src="https://habrastorage.org/webt/p9/ea/yb/p9eayb25jpeoiazqjd0sitssuf4.png"><br><p>  Jumlah MPG dapat bervariasi tergantung pada arsitektur solusi secara keseluruhan.  Dalam kasus kami, DataPower menghadapi bus integrasi (IIB) dan layanan microser, yang memiliki perbedaan antarmuka yang signifikan (json / http versus xml / mq), sehingga diputuskan untuk membuat MPG transformasional untuk setiap backend spesifik dan beri nama sesuai.  Untuk semua klien, kami bekerja di json / http, jadi perutean MPG adalah satu.  MPG utama terdiri dari 3 aturan untuk memproses pesan - permintaan, respons, dan kesalahan.  Setiap aturan terdiri dari tindakan yang diperlukan, seperti transformasi, pencatatan, perutean, dan lainnya. </p><br><p>  Dari fitur - jika dalam kebijakan Anda menggunakan tindakan ConvertQueryParamToXML, maka perhatikan InputConversion.  Jika Anda mengatur Pengkodean Default ke JSON dan mencoba mengirim permintaan GET, Anda akan terkejut menemukan bahwa pesan tersebut belum mengalami transformasi apa pun yang Anda tentukan dan Anda tidak akan menemukan jejaknya.  Fitur ini akan membantu mengatasi pembuatan aturan terpisah untuk permintaan GET. </p><br><h3>  4.2.  Berlatih </h3><br><h4>  4.2.1.  Persiapan </h4><br><p>  Anda dapat menemukan semua file yang diperlukan untuk bekerja di tautan <a href="">https://github.com/EvgenyaVlasenko/IBM_DataPower.git</a> <br></p><h4>  4.2.1.1.  Batang domain </h4><br><ol><li>  Buka domain trunk. </li><li>  Di panel kontrol, pilih Manajemen File. </li><li>  Di direktori lokal, buat struktur direktori berikut dan tempatkan file yang sesuai di dalamnya (setiap file berisi deskripsi singkat tentang fungsi apa yang dikerjakannya, serta diskusi yang lebih rinci tentang ini nanti dalam artikel). <br><img src="https://habrastorage.org/webt/oj/am/i9/ojami90qdgg81ojuyr88pmeuzd0.png"><br></li></ol><br><h4>  4.2.1.2.  Pengaturan domain </h4><br><ol><li>  Buka domain pengaturan. </li><li>  Di panel kontrol, pilih Manajemen File. </li><li>  Di direktori lokal, buat struktur direktori berikut dan tempatkan file yang sesuai di dalamnya (file juga berisi deskripsi singkat tentang mereka). <br><img src="https://habrastorage.org/webt/mf/9r/ne/mf9rnemyu8mcb01ad_wi6__ozj0.png"><br></li></ol><br><h3>  4.2.2.  Buat GetFileMPG </h3><br><p>  Pertama, buat MPG pembantu sederhana yang akan mengembalikan file dari domain pengaturan. </p><br><ol><li>  Buka domain pengaturan. </li><li>  Di panel kontrol, pilih Gateway Multi-Protokol dan klik Buat. </li><li>  Tentukan nama (GetFileMPG), deskripsi (opsional), dan tipe backend (dinamis).  Bahkan, karena tidak akan ada panggilan ke backend, dan hanya file yang akan dikembalikan dari sistem lokal, dalam contoh ini Anda dapat menentukan semua jenis backend. <br><img src="https://habrastorage.org/webt/ds/g7/5g/dsg75gxvgo-7caldbmytubddg6i.png"><br></li><li>  Tentukan jenis permintaan dan respons.  Jenis yang ditentukan secara eksplisit akan mengurangi jumlah pemeriksaan inline.  Menentukan jenis Pass through memungkinkan Anda untuk tidak membuat aturan (dalam hal ini, untuk mengubah respons).  Jika kami menentukan Jenis Permintaan juga Lewat, maka kami tidak akan dapat memproses pesan dengan cara apa pun.  Opsi ini tidak sesuai dengan kami, jadi kami membatasi jenis permintaan menggunakan Non-XML. <br><br><img src="https://habrastorage.org/webt/qx/nx/l_/qxnxl_j3ki9e8hcc215zropuix8.png"><br></li><li>  Klik pada + dan pilih HTTP Handler untuk membuat Protokol Sisi Depan yang baru. <br><br><img src="https://habrastorage.org/webt/dc/gq/pq/dcgqpqgpx284pxkoqdqhivwjbku.png"><br></li><li>  Di sini Anda harus menentukan nama, alamat ip, port, dan daftar metode yang diperbolehkan.  Perhatikan alamat ip.  Jika Anda menentukan 0.0.0.0, maka semua orang dapat mengakses gateway ini.  Jika 127.0.0.1 - hanya gateway lain di dalam DataPower yang sama.  Karena ada parameter keamanan di antara pengaturan, kami menggunakan opsi kedua.  Isi kolom dan klik "Terapkan", protokol akan secara otomatis ditambahkan ke gateway. <br><br><img src="https://habrastorage.org/webt/xn/y5/-r/xny5-rfrolidwemexqwg25-tkec.png"><br></li><li>  Klik pada + untuk menambahkan kebijakan baru. <br><br><img src="https://habrastorage.org/webt/ju/y0/q6/juy0q6_osmjfnwd2v5xev97wvta.png"><br></li><li>  Isi nama kebijakan "GetFilePolicy". <br></li><li>  Buat aturan baru, isi nama dan arah aturan.  Karena sebenarnya tidak ada backend, dan hanya file yang diinginkan dikembalikan, hanya akan ada satu aturan (klien ke server). <br><br><img src="https://habrastorage.org/webt/cv/4c/z_/cv4cz_dfzc5sjxu4i7as6iluzne.png"><br></li><li>  Klik dua kali pada aksi Match untuk mengkonfigurasinya, pilih aturan yang ada dan terapkan perubahannya.  Secara ideologis akan benar untuk menetapkan batas pada kemampuan untuk hanya menerima permintaan, tetapi dalam kerangka tugas pelatihan, Anda dapat memilih yang sudah ada. <br></li><li>  Tambahkan tindakan lain - GatewayScript dengan menyeretnya ke aturan dan mengonfigurasinya.  Sebagai transformasi, kita akan menggunakan file yang disiapkan, yang di sistem file lokal: /// akan menemukan file dengan nama dari URI dari permintaan yang masuk dan menempatkannya di badan pesan.  Hasil operasi akan ditransfer langsung ke buffer output aturan.  Simpan perubahannya. <br><br><img src="https://habrastorage.org/webt/ai/pr/va/aiprvaljftoye2gr5tf1xjf4s_u.png"><br></li><li>  Hasil kebijakan akhir akan terlihat seperti ini: <br><br><img src="https://habrastorage.org/webt/rm/q0/on/rmq0onkkkvygnyevy574vsgz3ns.png"><br></li><li>  Pembuatan MPG selesai, simpan perubahannya. <br></li><li>  Anda dapat memverifikasi keberhasilan pembuatannya menggunakan Status Objek, mirip dengan memeriksa status domain dan manajer antrian.  Untuk melakukan ini, pilih Status Objek dan filter Lihat oleh: layanan dari domain pengaturan.  Di bagian "Multi-Protocol Gateway", cari objek yang sesuai dan periksa statusnya. <br></li><li>  Anda tidak dapat memanggil MPG ini dari luar, karena Anda melindunginya dengan ip.  Ubah sementara ip dari 127.0.0.1 ke 0.0.0.0 dan port dari 7171 ke 7170 dan jalankan permintaan berikut: <br><br><pre> <code class="plaintext hljs">curl -vv -k "http://192.168.99.100:7170/trunk/route/routeRules.xml"</code> </pre><br></li><li>  Anda harus mendapatkan jawaban berikut: <br><br><img src="https://habrastorage.org/webt/e5/m8/3n/e5m83ngxz17e8lahsicaxs6lj5s.png"><br></li><li>  Sekali lagi, ubah ip dan port ke 127.0.0.1:7171 yang asli. <br></li></ol><br><h4>  4.2.3.  Membuat RoutingMPG </h4><br><p>  Sekarang buat RoutingMPG.  Berdasarkan permintaan input dan aturan perutean, ia akan menentukan di mana dan dengan parameter apa permintaan harus dikirim. </p><br><ol><li>  Buka domain trunk. </li><li>  Buat Gateway Multi-Protokol baru sesuai dengan klausa 2-10 dari bagian 4.2.2 menggunakan nilai-nilai berikut: <br><ul><li>  3 - nama: RoutingMPG, tipe backend: Dinamis (untuk kemampuan untuk merutekan permintaan ke MPG yang berbeda jika perlu). </li><li>  4 - Rq: Non-xml, Rs: Non-xml. </li><li>  6 - nama: RoutingHTTP_FSH, ip: 0.0.0.0, port: 7170, + Dapatkan metode. </li><li>  8 - nama: RoutingPolicy. </li><li>  9 - nama: RoutingPolicy_rule_req, arah: Klien ke Server. </li></ul><br></li><li>  Tambahkan satu tindakan lagi untuk merutekan permintaan. Untuk melakukan ini, seret tindakan â€œRuteâ€ ke aturan, klik dua kali untuk mengonfigurasinya, isi kolom dan terapkan perubahannya.  File route.xsl menerima file pengaturan rute dari domain pengaturan melalui GetFileMPG yang dibuat sebelumnya.  Setelah itu, berdasarkan URI, pengaturan yang diperlukan untuk operasi ini sudah dipilih dari file.  Beberapa dari mereka digunakan untuk perutean, dan beberapa ditambahkan ke header untuk digunakan dalam MPG lainnya.  Parameter input dan output menentukan cara bekerja hanya dengan isi pesan dan sama sekali tidak memengaruhi header dan variabel.  Oleh karena itu: input dari nol - karena informasi dari badan pesan tidak digunakan untuk perutean.  Outputnya nol - karena hasil transformasi hanyalah perubahan dalam informasi layanan. <br><br><img src="https://habrastorage.org/webt/bb/q0/nh/bbq0nh2dtogav5pyfoeneb3t66m.png"><br></li><li>  Demikian pula, buat 2 aturan lagi dan simpan semua perubahan: <br><ul><li>  Arah: Server-Klien, nama: RoutingPolicy_rule_resp; <br>  Transformasi: Input INPUT, Output NULL, file transformasi lokal: ///RoutingMPG/transform/resp.xslt.  File resp.xslt menerima status http dari respons transformasi MPG dan secara eksplisit menetapkannya ke respons RoutingMPG.  Jika ini tidak dilakukan, maka kode default akan diatur ke 200, bahkan jika terjadi kesalahan dalam transformasi MPG. <br></li><li>  Arah: Kesalahan, nama: RoutingPolicy_rule_error; <br>  Transformasi: Input INPUT, Output PIPE (sesuai dengan dokumentasi, menggunakan PIPE antara dua node aksi yang berdekatan karena INPUT dan OUTPUT dapat menghilangkan pemrosesan tambahan dan mengurangi jumlah memori yang digunakan), file transformasi adalah lokal: ///RoutingMPG/transform/errors.xsl.  File errors.xsl menerima kode kesalahan dan teks dari respons dari MPG transformasi dan menghasilkan pesan kesalahan JSON dalam format yang diharapkan oleh klien. <br></li></ul><br></li><li>  Hasil kebijakan akhir akan terlihat seperti ini: <br><br><img src="https://habrastorage.org/webt/um/kx/x-/umkxx-3kwx3hi1dzmc1e80ko-wa.png"><br></li><li>  Pembuatan MPG selesai, simpan perubahannya. <br></li><li>  Menggunakan, misalnya, utilitas curl, jalankan kueri berikut: <br><br><pre> <code class="plaintext hljs">curl -vv -k "http://192.168.99.100:7170/dp/test/transformMessage"</code> </pre> <br></li><li>  Jika Anda mendapatkan kesalahan berikut, maka semuanya dilakukan dengan benar.  Kesalahan ini berarti bahwa pesan berhasil diterima dan diproses, tetapi upaya untuk memanggil backend (dalam hal ini IIBMPG) tidak berhasil.  Lanjutkan ke langkah berikutnya. <br><br><img src="https://habrastorage.org/webt/8g/iq/tl/8giqtlzspsyix66vnl7mkcxnelk.png"><br></li></ol><br><h4>  4.2.4.  Pembuatan IIBMPG </h4><br><p>  Langkah selanjutnya adalah membuat MPG transformasional.  Misalkan sistem eksternal dalam format permintaan JSON dan internal XML.  Kita perlu mengubah pesan input sehingga sistem internal dapat memahaminya.  Perlu dicatat bahwa ini tidak selalu merupakan konversi sederhana dari seluruh pesan.  Seringkali diperlukan untuk menyampaikan pesan terpotong atau diperbesar, kadang-kadang dengan struktur yang sepenuhnya didesain ulang. </p><br><ol><li>  Buka domain trunk. </li><li>  Buat Gateway Multi-Protokol baru sesuai dengan klausa 2-10 dari bagian 4.2.2 menggunakan nilai-nilai berikut: <br><ul><li>  3 - nama: IIBMPG, tipe backend: Dinamis </li><li>  4 - Rq: JSON, Rs: XML </li><li>  6 - nama: IIBHTTP_FSH, ip: 127.0.0.1 (hanya permintaan dari DataPower yang sama), port: 7172, + Dapatkan metode </li><li>  8 - Nama: IIBPolicy </li><li>  9 - nama: IIBPolicy_rule_req, arah: Klien ke Server </li></ul><br></li><li>  Tambahkan deskripsi.  Berdasarkan X-DP-Transform-Name di header permintaan, file IIBRuleRoute.xsl menerima dari file lokal: ///IIB/route/IIBRouteRules.xml nama-nama transformasi permintaan, file respons dan kesalahan untuk layanan ini dan menetapkan nilainya ke variabel konteks yang sesuai var: // context / IIB / reqTransform, var: // context / IIB / ansTransform, var: // context / IIB / errTransform.  Nilai lain dari tajuk (url, uri, kedaluwarsa, batas waktu) juga ditempatkan dalam variabel konteks. <br><br><img src="https://habrastorage.org/webt/xo/6b/ek/xo6bekae8dsumpvosfe5xnbhneg.png"><br></li><li>  Tambahkan tindakan lain dengan menyeret Lanjutan ke aturan Anda dan memilih Convert Query Params ke XML dari daftar, konfigurasikan.  Anda perlu menambahkan peta konversi input baru, memberinya nama (cmnJSONParseCNVM) dan jenis yang diperlukan (JSON). <br><br><img src="https://habrastorage.org/webt/ir/az/gb/irazgbszkybdgjkor1otjvrllqc.png"><br><br><img src="https://habrastorage.org/webt/yd/tk/2x/ydtk2xhbveh4j6z1gsweidcyhak.png"><br></li><li>  Tambahkan transformasi setelah konversi standar dan konfigurasikan.  Dalam hal ini, set variabel dalam transformasi sebelumnya digunakan untuk menunjukkan file transformasi.  Ini dilakukan agar transformasi bersifat universal, dan file itu sendiri diganti "on the fly" tergantung pada pesan input.  Badan pesan sudah siap.  Langkah selanjutnya adalah merutekan pesan, dan isi pesan tidak akan berubah, jadi kami membuat variabel dpvar_1 dan menyimpan hasilnya di dalamnya.  Variabel inilah yang kami arahkan ke input ke tindakan Hasil.  Simpan perubahannya. <br><br><img src="https://habrastorage.org/webt/yz/cf/do/yzcfdogrjturkuvvmqx7bio_ex4.png"><br></li><li>  Tambahkan tindakan perutean dan atur parameter berikut.  File IIBURLRoute.xsl menerima nilai-nilai variabel konteks, beberapa dari mereka ditetapkan sebagai variabel permintaan layanan, dan dari yang lain membentuk URI untuk permintaan ke sistem tujuan, yang juga menyimpan dalam variabel layanan. <br><br><img src="https://habrastorage.org/webt/kl/vk/cf/klvkcfgcro60wznqwo0ibxdncys.png"><br></li><li>  Demikian pula, buat 2 aturan lagi dan simpan semua perubahan: <br><ul><li>  Arah: Server-Klien, nama: IIBPolicy_rule_resp; <br>  Transformasi: Input INPUT, Output PIPE, file transformasi var: // context / IIB / ansTransform (variabel konteks untuk mensubstitusi transformasi respon "on the fly"). </li><li>  Arah: Kesalahan, nama: IIBPolicy_rule_error; <br>  Transformasi: Input NULL, Output PIPE, file transformasi var: // context / IIB / errTransform (variabel konteks untuk mengganti transformasi kesalahan dengan cepat). </li></ul><br></li><li>  Hasil kebijakan akhir akan terlihat seperti ini: <br><img src="https://habrastorage.org/webt/qi/d9/7u/qid97ursvmwifemzxbfdtudjkjc.png"><br></li><li>  Pembuatan MPG selesai, simpan perubahannya. <br></li></ol><br><h2>  Bagian 5. Pengujian </h2><br><h3>  5.1.  Persiapan </h3><br><ol><li>  Unduh, misalnya, utilitas rfhutil untuk membaca dan menulis pesan ke antrian; </li><li>  File uji terletak di folder tes dari direktori yang sama dengan file proyek. </li></ol><br><h3>  5.2.  Pemeriksaan Kesehatan </h3><br><ol><li>  Kirim permintaan menggunakan utilitas curl (untuk permintaan di bawah ini, direktori saat ini harus sama dengan example.json). <br><br><pre> <code class="plaintext hljs">curl -vv -k "http://192.168.99.100:7170/dp/test/transformMessage" -H "Content-Type: application/json" --data-binary @example.json</code> </pre> <br></li><li>  Buka 2 instance utilitas rfhutil dan kurangi pesan dari antrian DP.IIB.REQIN dengan instance pertama; <br></li><li>  Buka tab MQMD dan salin MessageID; <br></li><li>  Dalam contoh kedua, buka file rs.xml, di tab MQMD, masukkan pengidentifikasi pesan di CorrelID dan letakkan pesan di antrian DP.IIB.RESIN; <br></li><li>  Anda harus mendapatkan jawaban yang serupa: <br><br><img src="https://habrastorage.org/webt/mn/kj/xj/mnkjxj0lyafkvo7hjgpyytuytee.png"><br></li><li>  Ulangi langkah 1-3; <br></li><li>      rs_error.xml       correllId; <br></li><li>     <br><br><img src="https://habrastorage.org/webt/_y/i5/hb/_yi5hbw1lnrfwsuryyln9z3rdic.png"><br></li></ol><br><h2>  6.  </h2><br><h3>  6.1.  Teori </h3><br><p> Log Targets   ,         . <br></p><br><p>     Log Targets    .     ,      4     1000Kb,      .              2-4    .       ,        .  , DataPower,  , ,   ,        ,      ,      -  MPG,     . <br></p><br><h3> 6.2.  </h3><br><ol><li>    trunk; </li><li>    Log Target   ; </li><li>      : <br><ul><li> (IIB_LOG); </li><li> (File); </li><li>  (Text); </li><li>  timestamp(zulu); </li><li>   (logtemp:///IIB.log â€”  IIBMPG); </li><li>  (1000). <br><img src="https://habrastorage.org/webt/ev/sm/mj/evsmmjxy8m6suwkbaeojvgcudf8.png"><br></li></ul><br></li><li>   .        MPG   IIBMPG. <br><br><img src="https://habrastorage.org/webt/lq/vl/5l/lqvl5lvc_w8powdnufq6emgjgwc.png"><br></li><li>    ,     ,    (  ,        ). <br><br><img src="https://habrastorage.org/webt/ia/tu/98/iatu98v3l0fioelwktk8uwu-6fw.png"><br></li><li>         ; <br></li><li>    ; <br></li><li>          . <br></li><li>      Log Targets    MPG. <br></li><li>   : <br><ul><li>             , ,         . <br><br><img src="https://habrastorage.org/webt/z2/ix/vt/z2ixvtjk8eidxsfbbe6mmfcecnc.png"><br></li><li>        . <br><br><img src="https://habrastorage.org/webt/go/ik/wl/goikwl1pdvlzhiyd_d7gqpffzo8.png"><br></li></ul><br></li></ol><br><h2>  7.  -    </h2><br><ol><li>       â€“  ,   .    â€“  ,   ,     -    . <br></li><li>      .       View Logs.      ,  Â«  Â», Â«   Â»     . <br></li><li>       .           .       MPG       Show Probe -&gt; Enable Probe.         .   ,        . <br><br><img src="https://habrastorage.org/webt/re/6s/mh/re6smhejkm-i8cdmmeky6ch6cmy.png"><br></li><li>   ,      . <br></li></ol><br><p>     â€“    . <br></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id442686/">https://habr.com/ru/post/id442686/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id442676/index.html">Where Dreams Lead: Underground</a></li>
<li><a href="../id442678/index.html">Proyek terbesar dalam litografi stereo: kerangka raksasa dicetak pada printer 3D</a></li>
<li><a href="../id442680/index.html">Teknologi penggantian sensorik akan memungkinkan Anda untuk melihat dunia dengan bantuan suara: bagaimana neuroplastisitas otak manusia bekerja</a></li>
<li><a href="../id442682/index.html">Apa yang diketik dan cara merakit proyek C ++</a></li>
<li><a href="../id442684/index.html">Performa situs seimbang. Bagian 3: Konten</a></li>
<li><a href="../id442688/index.html">Analisis data scala - kebutuhan mendesak atau peluang yang menyenangkan?</a></li>
<li><a href="../id442690/index.html">Misi Lunar "Bereshit" - selfie di latar belakang Bumi</a></li>
<li><a href="../id442692/index.html">Blockchain tanpa perantara: cara kami mengirim sekuritas ke registri terdistribusi</a></li>
<li><a href="../id442694/index.html">Salah satu raksasa streaming diluncurkan di India dan menarik sejuta pengguna dalam seminggu</a></li>
<li><a href="../id442696/index.html">S for Security: Internet Security of Things dan laporan di InoThings ++ 2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>