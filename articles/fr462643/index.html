<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤰🏽 👩🏿‍🤝‍👩🏽 👸🏿 Déterminer les individus interdépendants à bord des structures à l'aide de python 👨🏽‍🌾 ☀️ 🤰🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Définition des personnes interdépendantes selon l'art. 105.1 du Code des impôts de la Fédération de Russie est une tâche plutôt banale pour un juriste...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Déterminer les individus interdépendants à bord des structures à l'aide de python</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/462643/">  Définition des personnes interdépendantes selon l'art.  105.1 du Code des impôts de la Fédération de Russie est une tâche plutôt banale pour un juriste d'entreprise. <br><br>  Habituellement, c'est simple et il semble, pourquoi y a-t-il quelque chose à automatiser? <br>  C'est vrai, si une société deux ou trois compare leur composition du diabète, il n'y a pas de problème.  Mais, s'il y a plus de deux douzaines de sociétés et en même temps différentes sociétés ont une composition d'administrateurs différente, y compris le nombre de membres?  Ici, vous devez déjà passer du temps.  Nous le consacrerons à un programme qui calculera pour nous les parties liées, analysant la composition du conseil d'administration. <br><a name="habracut"></a><br><h3>  Quelques définitions </h3><br>  Rappelons que les personnes interdépendantes sont déterminées par un certain nombre de critères énoncés dans le Code fiscal de la Fédération de Russie. <br><br>  Au paragraphe 2 de l'art.  105.1 du Code fiscal de la Fédération de Russie énumère les motifs pour lesquels les individus sont reconnus comme interdépendants.  Ainsi, à des fins fiscales, les parties liées sont: <br><br><ul><li>  organisation, si une organisation participe directement et (ou) indirectement à une autre organisation et que la proportion de cette participation est supérieure à 25%; </li><li>  un individu et une organisation dans le cas où un tel individu participe directement et (ou) indirectement à une telle organisation et que la proportion de cette participation est supérieure à 25%; </li><li>  les organisations, si la même personne participe directement et (ou) indirectement à ces organisations et si la proportion de cette participation dans chaque organisation est supérieure à 25%; </li><li> organisation et personne (y compris une personne avec son conjoint (conjoint), parents (y compris les parents adoptifs), enfants (y compris les adoptés), frères et sœurs et frères et sœurs, tuteurs (curateurs) et pupilles), avec autorité par nomination (élection) de l'organe exécutif unique de cette organisation ou par nomination (élection) d'au moins 50% de la composition de l'organe exécutif collégial ou du conseil d'administration (conseil de surveillance) de cette organisation; </li><li>  les organisations dont les seuls organes exécutifs ou au moins 50% de l'organe exécutif collégial ou du conseil d'administration (conseil de surveillance) sont nommés ou élus par décision de la même personne (individu avec son conjoint), parents (y compris parents adoptifs) ), les enfants (y compris les adoptés), les frères et sœurs et demi-frères et tuteurs légaux, les tuteurs et les pupilles); </li><li>  organisations dans lesquelles plus de 50% de l'organe exécutif collégial ou du conseil d'administration (conseil de surveillance) sont les mêmes personnes avec leur conjoint, leurs parents (y compris les parents adoptifs), les enfants (y compris les adoptés), à part entière et demi-frères et sœurs, tuteurs (curateurs) et pupilles; </li><li>  organisation et personne exerçant les pouvoirs de son unique organe exécutif; </li><li>  les organisations dans lesquelles les pouvoirs du seul organe exécutif sont exercés par la même personne; </li><li>  organisations et (ou) individus dans le cas où la part de la participation directe de chaque personne précédente dans chaque organisation suivante est supérieure à 50%; </li><li>  les individus dans le cas où un individu est subordonné à un autre par sa position officielle; </li><li>  un individu, son conjoint, ses parents (y compris les parents adoptifs), ses enfants (y compris les adoptés), ses demi-frères et demi-frères et sœurs, un tuteur (curateur) et un pupille. </li></ul><br><h3>  Aller droit au but </h3><br>  Il existe de nombreuses raisons, mais nous nous intéressons à l'une d'entre elles, à savoir: <br>  - les organisations dont plus de 50% des membres du conseil d'administration sont les mêmes personnes. <br><br>  Cette base diffère du reste en ce que l'avocat doit comparer toute la composition du conseil d'administration dans les entreprises avec une coïncidence de plus de 50% de leurs membres. <br><br>  Supposons toute la composition du conseil d'administration que nous avons résumée dans un tableau Excel avec des conseils d'administration et un nombre total de sociétés de plus de vingt: <br><br><img src="https://habrastorage.org/webt/cq/y8/-v/cqy8-vehb5ayp88ktsypd5yzzfg.jpeg"><br><br>  Nous avons besoin de notre programme, selon le tableau, pour sélectionner les entreprises s'il y a une coïncidence de plus de 50% du nombre total de membres du conseil d'administration.  Ensuite, le programme devrait afficher le résultat à l'écran ou dans un fichier. <br><br>  Logiquement, le programme exécutera l'algorithme suivant.  Ayant reçu le nom complet des administrateurs de l'utilisateur, elle les comparera avec chaque ligne d'Excel, qui contient les noms complets des administrateurs de chaque entreprise.  C'est-à-dire que tous les trois membres SD sur 5 utilisateurs sont comparés à tous les 3 sur 5 dans le tableau.  À ce stade, le programme n'analysera pas les CD de plus de 5 membres, en les ignorant. <br><br>  Les premières lignes de notre programme seront standard: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> openpyxl wb = openpyxl.load_workbook(<span class="hljs-string"><span class="hljs-string">'sd3.xlsx'</span></span>) sheet=wb.get_active_sheet()</code> </pre> <br>  Ici, nous avons importé le module pour travailler avec Excel et ouvert le fichier avec notre table. <br><br>  Nous allons maintenant proposer à l'utilisateur de saisir cinq membres du conseil d'administration, que le programme cherchera plus avant dans les sociétés pour comparaison.  Nous écrivons tous les membres de la SD entrés par l'utilisateur dans les variables a, b, c, e, f: <br><br><pre> <code class="python hljs">a=str(input(<span class="hljs-string"><span class="hljs-string">"-1: "</span></span>)) b=str(input(<span class="hljs-string"><span class="hljs-string">"-2: "</span></span>)) c=str(input(<span class="hljs-string"><span class="hljs-string">"-3: "</span></span>)) e=str(input(<span class="hljs-string"><span class="hljs-string">"-4: "</span></span>)) f=str(input(<span class="hljs-string"><span class="hljs-string">"-5: "</span></span>))</code> </pre> <br>  Ceci est un point important.  Le nom du réalisateur doit être entré sans espaces, par exemple, Ivanov I.I.  Dans le même formulaire, les noms complets des administrateurs doivent être présents dans le tableau Excel. <br><br>  Créons deux listes.  L'un est vide, le second concerne les sociétés où le conseil d'administration compte plus de 5 membres: <br><br><pre> <code class="python hljs">found = [] found2=[<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">11</span></span>,<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">13</span></span>,<span class="hljs-number"><span class="hljs-number">14</span></span>,<span class="hljs-number"><span class="hljs-number">18</span></span>,<span class="hljs-number"><span class="hljs-number">27</span></span>,<span class="hljs-number"><span class="hljs-number">31</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>] <span class="hljs-comment"><span class="hljs-comment">#    sd3,   5 . h = open('55555.txt','a')</span></span></code> </pre> <br>  Nous avons également ouvert le fichier texte 55555.txt, dans lequel nous allons enregistrer les résultats.La coïncidence de la SD de plus de 50% signifie que 3 membres sur 5 doivent correspondre.  Le programme doit donc effectuer 10 vérifications pour les noms correspondants.  C'est combien de combinaisons peuvent être pour le diabète de 5 membres. <br><br>  Par conséquent, afin de ne pas écrire le même code 10 fois, ce qui rend le programme encombrant, nous allons créer une fonction puis l'appeler (l'exécuter) 10 fois. <br><br><h3>  Fonction de charge </h3><br>  Voici notre fonction: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">myfun</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x,y,z)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> rowOfCellObjects <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> sheet[<span class="hljs-string"><span class="hljs-string">'B2'</span></span>:<span class="hljs-string"><span class="hljs-string">'L36'</span></span>]: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> cellObj <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> rowOfCellObjects: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> cellObj.value ==<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> <span class="hljs-comment"><span class="hljs-comment">#print (cellObj) if cellObj.value == x: for cellObj in rowOfCellObjects: if cellObj.value == y: for cellObj in rowOfCellObjects: if cellObj.value == z: d = list(cellObj.coordinate) d[0]='A' dd=d[0]+d[1] if len(d)&gt;2: dd=d[0]+d[1]+d[2] i=sheet[str(dd)].value #   ,   3-  q = cellObj.row if i not in found and i not in found2: found.append(i) h.write (str(i)+'\n')</span></span></code> </pre> <br>  Analysons le code. <br><br>  Nous définissons les limites du tableau pour B2: L36.  Si la cellule est vide, elle sera ignorée. <br><br>  Ensuite, la fonction considérera le nom du 1er directeur, si le nom dans la cellule correspond au nom entré par l'utilisateur, la fonction va plus loin et compare le 2ème, puis le 3ème directeur.  À la fin, la fonction forme une liste d'entreprises et écrit chacune d'elles dans le fichier 55555.txt. <br>  Une fois une fonction écrite, elle ne sera pas exécutée automatiquement par le programme. <br><br>  Il faut l'appeler: <br><br><pre> <code class="python hljs">myfun(a,b,c)</code> </pre> <br>  Mais ici, nous avons appelé la fonction uniquement pour les trois premiers administrateurs.  Il est nécessaire de répéter l'appel de fonction pour les combinaisons restantes: <br><br><pre> <code class="python hljs">myfun(a,b,e) myfun(a,b,f) myfun(a,e,f) myfun(a,c,e) myfun(a,c,f) myfun(b,c,e) myfun(b,c,f) myfun(b,e,f) myfun(c,e,f) h.close()</code> </pre> <br><h3>  Nous lançons </h3><br>  Exécutez le programme et entrez dans la fenêtre de l'interpréteur python 5 noms de directeurs à partir de <br>  ceux qui se trouvent au moins une fois dans le tableau Excel: <br><br><img src="https://habrastorage.org/webt/xr/pq/et/xrpqetknvczch5ss1nl3pcqc0ia.jpeg"><br><br>  Une fois le programme exécuté, regardez le fichier que le programme va créer - <br>  55555.txt: <br><br><img src="https://habrastorage.org/webt/ep/cu/rv/epcurvh9yvzpgjvkkgysn1wkyme.jpeg"><br><br>  Dans le fichier - numéros des entreprises où des correspondances ont été trouvées.  Il convient de noter que ce sont les numéros de société de la colonne A, pas les numéros de ligne Excel: <br><br><img src="https://habrastorage.org/webt/1c/vm/xu/1cvmxuo-g6ng65995mohw6abzck.jpeg"><br><br>  Le programme est prêt, mais il faut se rappeler qu'il n'analyse pas la composition du conseil d'administration avec des membres de plus de 5 personnes! <br><br>  Téléchargez le code du programme - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  Téléchargez le tableau des tests <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  PS: tous les matchs du tableau avec de vraies personnalités sont aléatoires. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr462643/">https://habr.com/ru/post/fr462643/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr462619/index.html">Enfants, mathématiques et R</a></li>
<li><a href="../fr462625/index.html">Dell G5 5590: l'un des ordinateurs portables de jeu les plus abordables avec RTX 2060</a></li>
<li><a href="../fr462631/index.html">Week-end Web: développement intensif de sites Web en Netologie</a></li>
<li><a href="../fr462635/index.html">Quantum, or there and back: un nouvel algorithme pour étudier la transition quantique-classique</a></li>
<li><a href="../fr462641/index.html">52 Caractéristiques du chef de produit idéal</a></li>
<li><a href="../fr462649/index.html"># 18 Mosdroid Argon - rapport</a></li>
<li><a href="../fr462653/index.html">Le LTE comme symbole de l'indépendance</a></li>
<li><a href="../fr462655/index.html">Tapez enfin votre code</a></li>
<li><a href="../fr462657/index.html">Test et test du chargeur SkyRC B6 Nano</a></li>
<li><a href="../fr462659/index.html">Premiers pas avec PVS-Studio Static Analyzer pour le développement C ++ sous Linux</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>