<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë∂üèª üçì üåõ Historique de la participation au Game Jam. Snowbox ü¶á ü§∞üèª üë∂üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Fin 2017, j'ai eu l'occasion de tester ma force et mon enthousiasme en tant que participant √† l'un des nombreux Game Jams mondiaux. 

 Comme c'√©tait m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Historique de la participation au Game Jam. Snowbox</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/409679/"><img src="https://habrastorage.org/webt/co/5g/n7/co5gn7mngh3htc0x51kcvywi6o8.png" alt="image" align="left">  Fin 2017, j'ai eu l'occasion de tester ma force et mon enthousiasme en tant que participant √† l'un des nombreux Game Jams mondiaux. <br><br>  Comme c'√©tait ma premi√®re exp√©rience dans un tel projet, j'ai appris quelques le√ßons utiles et quelques surprises agr√©ables.  Eh bien, j'ai aussi achet√© un jouet que je pourrais jouer avec mes coll√®gues le vendredi des vacances. <br><br>  Sous le chat, une description de l'intensit√© de 30 jours de d√©veloppement et de la lenteur de 20 jours d'attente des r√©sultats. <br><br>  <i>Remarque: l'article est de nature narrative, avec peu de d√©tails techniques.</i> <br><a name="habracut"></a><br><h3>  Prologue </h3><br>  Je voulais depuis longtemps m'essayer en tant que d√©veloppeur de jeux, et l'ann√©e derni√®re, ce d√©sir est devenu de plus en plus intrusif et intrusif.  √Ä la fin de l'ann√©e, j'ai d√©cid√© de commencer √† faire quelque chose - assister √† des rencontres sur le d√©veloppement de jeux, lire des livres et m√™me faire un petit prototype du jeu. <br><br>  Et puis un jour, Selim, mon coll√®gue, a propos√© de participer √† l'un des nombreux Game Jam et j'ai pens√© que c'√©tait la meilleure occasion d'√©tudier la cuisine de jeu sans aucune obligation √† long terme.  Ce n'est pas un prototype, mais pas encore son projet de longue date.  De plus, des d√©lais serr√©s sont souvent parmi les meilleurs motivateurs.  Et le principal avantage est que dans tous les cas, le r√©sultat est quelque chose d'holistique et complet, qui inspire toujours de nouvelles r√©alisations. <br><br>  Nous avons donc d√©cid√© de participer.  Deux d√©veloppeurs Java, sans aucune exp√©rience dans la cr√©ation de jeux.  Mais quand faut-il commencer? <br><br><h3>  La pr√©paration </h3><br>  Le Game Jam choisi √©tait th√©matique, et les organisateurs devaient annoncer le sujet strictement avant le d√©but du d√©veloppement.  Les candidats ont eu 1 mois pour cr√©er le jeu. <br><br>  Nous nous sommes inscrits une semaine avant le d√©but et, faute de sujet, nous avons pass√© du temps dans l'attente languissante et l'inaction.  Peut-√™tre valait-il mieux passer ce temps √† choisir un genre et une m√©canique de jeu.  Et puis enveloppez-le dans un style appropri√©. <br><br>  √Ä l'heure X, les organisateurs ont annonc√© le th√®me du concours - Retour (retour) et le compte √† rebours a commenc√©. <br><br>  Selim avait le seul souhait pour le jeu - la pr√©sence d'un serveur de jeu et forc√©ment en temps r√©el.  Il souhaitait conna√Ætre les d√©lices et les difficult√©s du d√©veloppement c√¥t√© serveur.  De plus, le jeu aurait d√ª √™tre simple, sinon nous n'aurions peut-√™tre pas le temps de le terminer. <br><br>  En ce qui concerne le sujet, les r√©flexions ont d'abord port√© soit sur le r√©tro, soit sur la pr√©histoire.  Le th√®me r√©tro ne m'int√©resse pas, j'ai donc essay√© de trouver quelque chose sur les dinosaures ou les anciens.  Cependant, je n'ai pas pu trouver quelque chose de simple et multi-utilisateur sur ce sujet. <br><br>  Et puis j'ai eu l'id√©e de faire un jeu de bac √† sable, au sens litt√©ral - une r√©f√©rence au divertissement des enfants sur la plage.  Nous construisons des ch√¢teaux, courons et jetons du sable sur nos rivaux (j'esp√®re que tout le monde n'a pas eu une enfance aussi difficile), mais les parents m√©contents sont punis pour cela.  Tout cela en 2D avec une vue de dessus. <br><br>  Selim a estim√© que le sable √©tait trop cruel aux yeux et a sugg√©r√© de remplacer le sable par de la neige et des ch√¢teaux par des forteresses de glace.  Sur cette option, nous nous sommes arr√™t√©s.  Au mieux de nos capacit√©s et de notre temps, nous pourrions ajouter de nouvelles fonctionnalit√©s et de la vari√©t√©. <br><br><h3>  D√©veloppement.  Semaine 1 </h3><br>  Nos r√¥les dans le projet √©taient divis√©s par eux-m√™mes.  Comme je l'ai dit, Selim ne s'int√©ressait qu'au d√©veloppement de serveurs.  Et j'√©tais int√©ress√© √† essayer le d√©veloppement de l'interface utilisateur, car, √† mon avis, il est le plus diff√©rent du d√©veloppement d'applications commerciales.  L'interface de jeu √©tait pr√©vue sur le web. <br><br><div class="spoiler">  <b class="spoiler_title">Br√®ve description des technologies utilis√©es</b> <div class="spoiler_text">  L'interaction client-serveur a √©t√© enti√®rement construite sur des sockets Web, car nous devions envoyer des messages du serveur au client de mani√®re asynchrone et r√©guli√®re.  Les messages du client ont √©galement √©t√© transmis via la prise Web, mais simplement pour la raison ¬´pourquoi pas¬ª.  Tous les messages √©taient au format Json. <br><br>  Pour travailler avec des sockets Web sur le serveur, le micro-framework Spark a √©t√© utilis√©.  Et comme un moteur physique box2d a √©t√© utilis√©, comme l'un des plus populaires.  Il √©tait responsable du calcul de la physique sur le serveur. <br><br>  Le client a √©t√© √©crit en JS pur, sans utiliser de frameworks, car je ne suis pas fort avec eux, et d'ailleurs, cela n'a pas de sens pour un petit projet.  En tant que moteur de jeu, Phaser 2 a √©t√© utilis√© - un moteur JS jeune et prometteur.  Contrairement au moteur physique du serveur, son objectif principal √©tait les graphiques et les calculs physiques simples.  KnockoutJS a √©galement √©t√© utilis√© pour <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la liaison de donn√©es</a> . <br><br>  Les produits JetBrains ont √©t√© utilis√©s comme IDE: Intellij IDEA et une version d'essai de WebStorm (juste une version de 30 jours, au moment du Game Jam). <br></div></div><br>  Le d√©veloppement a commenc√© par une r√©union conjointe le jour de cong√©.  Au cours des 2 premi√®res heures, j'ai ramass√© des sprites ¬´temporaires¬ª et j'ai r√©alis√© un gar√ßon qui courait et qui savait lancer des boules de neige.  Il aurait pu y avoir une image de ¬´c'√©tait / est devenu¬ª, mais elle est d√©pourvue de tout sens - visuellement ce qui √©tait, reste alors. <br><br>  Ayant une interface utilisateur fonctionnelle, il <i>ne</i> restait <i>plus qu'√†</i> resserrer l'interaction du serveur.  Le reste de la journ√©e a donc √©t√© consacr√© √† l'int√©gration: discussion de l'API, mise en place de la connexion, mise en place de l'interaction.  √Ä la fin de la journ√©e, notre petit homme pouvait se d√©placer de 1 pixel sur le c√¥t√©, en appuyant sur une touche.  Ce fut modeste, mais toujours r√©ussi. <br><br>  Le d√©veloppement s'est poursuivi uniquement pendant le temps libre du travail, avec 6 jours par semaine s√©par√©ment pour les foyers et un jour de cong√© ensemble.  Cela suffisait largement gr√¢ce √† une API simple et une distribution rigide des r√¥les. <br><br>  Pour r√©p√©ter le succ√®s de la premi√®re journ√©e (courir et lancer des boules de neige), mais d√©j√† via le serveur, cela nous a pris une semaine.  Cela a √©galement √©t√© affect√© par de nombreux facteurs techniques, notamment des probl√®mes avec des outils mal con√ßus pour notre mod√®le d'interaction client-serveur.  Je voudrais m'attarder sur ce mod√®le plus en d√©tail. <br><br><h3>  Mod√®le d'interaction client-serveur </h3><br>  Initialement, il a √©t√© d√©cid√© que le serveur serait responsable de tout mouvement, et le client n'enverrait que des commandes, comme appuyer sur une touche, et dessiner ce qui proviendrait du serveur.  Plus tard, cette philosophie a √©t√© l√©g√®rement modifi√©e, mais le serveur jusqu'√† la fin est rest√© le lien central. <br><br>  Dans la premi√®re impl√©mentation, le serveur envoyait des mises √† jour au client √† chaque tick.  C'est-√†-dire  par exemple, si une touche est maintenue enfonc√©e, la position du joueur change toutes les quelques millisecondes et une nouvelle position est envoy√©e au client. <br><br>  En utilisant un algorithme aussi simple, nous avons impl√©ment√© le mouvement du joueur.  Mais rechercher le meilleur nous a incit√©s √† changer l'algorithme en un √©v√©nement: seuls les √©v√©nements importants suffisants pour la synchronisation sont envoy√©s au serveur, ainsi qu'au client. <br><br>  Par exemple, pour d√©placer un joueur sur la carte, vous avez besoin de 4 √©v√©nements: <br><br><ol><li>  <i>Client</i> : touche haut enfonc√©e; </li><li>  <i>Serveur</i> : le joueur a commenc√© √† se d√©placer √† partir du point [x, <b>y1</b> ], selon un angle Œ±, avec la vitesse ŒΩ; </li><li>  <i>Client</i> : touche haut enfonc√©e; </li><li>  <i>Serveur</i> : le joueur a fini de se d√©placer au point [x, <b>y2</b> ]. </li></ol><br>  Cette approche a des avantages et des inconv√©nients. <br><br>  <b>Inconv√©nients</b> <br><br><ul><li>  beaucoup plus de logique sur le client: le client lui-m√™me doit calculer le mouvement, les collisions, etc. </li><li>  la logique sur le client doit r√©p√©ter tr√®s pr√©cis√©ment la logique sur le serveur, sinon des sauts dans le mouvement des objets sont obtenus.  Plus loin dans l'article, il y aura plusieurs exemples √† ce sujet; </li><li>  en cas de probl√®mes de r√©seau, la r√©ception d'√©v√©nements par la suite peut conduire √† des √©tats incorrects (sortir des limites, traverser des objets, etc.); </li><li>  en g√©n√©ral, il est beaucoup plus facile de d√©synchroniser l'√©tat sur le serveur et le client. </li></ul><br>  <b>Avantages</b> <br><br><ul><li>  beaucoup moins de charge sur les E / S; </li><li>  une logique suppl√©mentaire peut √™tre accroch√©e aux √©v√©nements.  Par exemple, au d√©but / fin d'un mouvement, vous pouvez d√©marrer / arr√™ter l'animation; </li><li>  les probl√®mes de r√©seau affectent moins la fluidit√© du mouvement.  Pendant que la boule de neige vole, un retard de m√™me une seconde n'affectera rien, car le serveur ne devrait rien envoyer; </li><li>  L'API et l'interaction elle-m√™me deviennent plus transparentes. </li></ul><br>  √Ä partir de ces listes, il est clair que si vous travaillez dur sur la mise en ≈ìuvre du client, il y a presque un avantage.  Pour notre projet, nous y sommes parvenus et l'interaction client-serveur a parfaitement fonctionn√©.  Mais nous devons rendre hommage, il a fallu beaucoup de force et de nerfs. <br><br><h3>  D√©veloppement.  Semaines 2 et 3 </h3><br>  Une semaine plus tard, lorsque nous avons r√©ussi √† ma√Ætriser l'int√©gration √† tout le moins et √† prendre en charge plusieurs types de messages entre le serveur et le client, il √©tait temps d'ajouter plus au jeu qu'un simple gar√ßon en cours d'ex√©cution. <br><br>  Par cons√©quent, nous avons d√©cid√© d'ajouter une fille qui court!  En cours de route, pour la fille, j'ai d√ª faire une fen√™tre de s√©lection de personnage.  Et comme il fallait encore faire la fen√™tre, c'est un p√©ch√© de ne pas ajouter de nom aussi.  De plus, j'ai d√ª √©tirer les images, comme pour l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">approche √† 9 patchs</a> . <br><br><img src="https://habrastorage.org/webt/cf/q_/0u/cfq_0ujfj7vseg_hu5istudnaec.png" alt="image"><br>  <i>Cela ressemblait √† la premi√®re version de la fen√™tre de connexion</i> <br><br>  √Ä cause de tout cela, une t√¢che si simple et si importante d'ajouter une fille a pris quelques soir√©es, mais cela en valait clairement la peine.  Et puis est venu le quotidien gris avec les m√™mes t√¢ches: nouvelles fonctions simples, corrections de bugs, am√©liorations visuelles mineures. <br><br>  Au fur et √† mesure que mes progr√®s progressaient du c√¥t√© client, le probl√®me de la vitesse de d√©veloppement du serveur et de l'interface utilisateur in√©gaux est apparu.  Et puisque le serveur est une partie centrale de toutes les interactions, sans la fonctionnalit√© termin√©e et fonctionnelle sur le serveur, le d√©veloppement client s'est arr√™t√©. <br><br>  Par cons√©quent, j'ai impl√©ment√© un serveur simul√© simple directement dans le client.  Beaucoup de choses y ont √©t√© mises en ≈ìuvre tr√®s maladroitement, y compris  gr√¢ce √† l'utilisation de l'√©tat global du monde du jeu.  Cela a suffi pour d√©velopper une interface utilisateur compl√®tement ind√©pendante du serveur et m'a fait gagner beaucoup de temps. <br><br>  Le faux serveur avait un autre avantage certain.  Il y avait des robots qui ne savaient pas comment tirer, donc il y avait au moins une chance de gagner. <br><br>  En m√™me temps, Selim a lutt√© avec le serveur.  Sur le serveur, il a connect√© le moteur physique box2d pour simuler la physique dans le jeu.  Ce moteur a beaucoup de ses nuances et leur √©tude a pris beaucoup de temps.  La plus grande difficult√© dans le d√©veloppement √©tait le manque de visualisation du monde du jeu.  Notre client n'a rendu que ce dont il avait besoin.  Et certains √©l√©ments du "monde des serveurs" √©taient cach√©s du c√¥t√© client.  De plus, il n'y avait aucune garantie compl√®te que le client rendait tout correctement. <br><br>  L'une des sous-t√¢ches importantes que Selim a d√ª r√©soudre √©tait de v√©rifier les collisions d'objets.  Sur le client, les collisions ont √©t√© v√©rifi√©es uniquement pour les √©l√©ments fixes.  Sur le serveur, il fallait tout faire honn√™tement pour ne pas empi√©ter sur les droits des objets en mouvement. <br><br>  Pendant le d√©veloppement des collisions, je me suis souvenu d'un bug amusant qui pouvait pr√©tendre √† une fonctionnalit√© sp√©ciale: lorsqu'un joueur lan√ßait une boule de neige, elle √©tait renvoy√©e avec un ¬´rebond¬ª.  Cela est arriv√© parce que dans box2d, par d√©faut, tout le monde peut entrer en collision avec tout le monde, et la r√©pulsion se produit toujours. <br><br>  Ce probl√®me a √©t√© r√©solu en introduisant des masques, c'est-√†-dire en sp√©cifiant des classes d'objets qui ne peuvent pas entrer en collision.  Par exemple, pour un joueur et ses boules de neige, le masque √©tait le m√™me. <br><br>  Selim a d√©cid√© de ne pas perdre de temps sur la gestion sp√©ciale des collisions entre boules de neige et a comment√© une telle collision: <br><br> <code>// for the <b>unlikely</b> event that we collide with a sibling snowball</code> <br> <br>  Comme la pratique l'a montr√©, la fr√©quence de cet √©v√©nement "peu probable" tend √† la fr√©quence des lancements de boules de neige, car lorsque vous vous tenez face √† face, les trajectoires des boules de neige co√Øncident.  Pour cette raison, les boules de neige extraterrestres battent constamment les leurs.  Nos opinions sur ce comportement divergeaient, nous l'avons donc laiss√© tel quel. <br><br>  Pendant que Selim s'amusait avec les collisions, j'ai d√©bogu√© le mouvement synchrone des objets sur le serveur et le client.  Il y avait des bugs mineurs dans notre propre impl√©mentation, mais Phaser a pr√©sent√© la plus grande surprise.  Dans son moteur physique, la vitesse r√©elle des objets est ajust√©e au FPS et arr√™te le monde.  Ceci est fait pour augmenter la douceur.  Malheureusement, ce comportement intelligent n'√©tait pas compatible avec un fonctionnement synchrone par rapport au serveur, et j'ai d√ª faire ma propre impl√©mentation d'objets en mouvement. <br><br><div class="spoiler">  <b class="spoiler_title">Description des sp√©cificit√©s de la vitesse dans Phaser ou ¬´course avec l'ombre¬ª</b> <div class="spoiler_text">  Afin de v√©rifier et de d√©boguer la vitesse, j'ai ajout√© l'objet d'un autre joueur √† la carte, qui se d√©pla√ßait √† la m√™me vitesse, mais √† proximit√©.  Ce joueur fant√¥me et ce joueur normal utilisaient diff√©rents algorithmes de d√©placement.  J'ai donc organis√© des comp√©titions et compar√© la stabilit√© de la vitesse. <br><br>  Au d√©but, j'ai essay√© de r√©soudre le probl√®me de la vitesse in√©gale en utilisant les param√®tres du moteur et la physique que nous utilisons.  Mais, si je comprends bien, ce comportement ne peut √™tre modifi√© en aucune fa√ßon.  Il √©tait possible de passer √† une impl√©mentation plus complexe de la physique, mais je ne voulais pas le faire uniquement pour la vitesse.  De plus, cette impl√©mentation n'a pas non plus donn√© une vitesse absolument stable. <br><br>  L'√©tape suivante, j'ai essay√© de mettre en ≈ìuvre le mouvement des objets moi-m√™me, mais √† partir du moteur, j'ai pris le contr√¥le et le delta de temps entre chaque cycle du monde.  Il existe plusieurs mod√®les temporels dans Phaser et l'impl√©mentation de la vitesse standard est bas√©e sur l'un d'eux.  Mais, pour une raison inconnue, aucun de ces moments n'a de stabilit√© et ils ne peuvent pas fournir une vitesse constante.  Il s'agit d'un probl√®me connu qui ne devrait pas √™tre r√©solu dans la version 2: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github.com/photonstorm/phaser/issues/798</a> . <br><br>  J'ai pass√© 2 jours sur la ¬´comp√©tition¬ª du joueur et de l'ombre et n'ai pas trouv√© d'option de travail.  Donc √† la fin, j'ai fait tout mon traitement de vitesse bas√© sur le temps standard dans JS.  Il est tr√®s surprenant qu'une fonction aussi importante ait re√ßu un support aussi √©trange dans le moteur et ait d√ª mettre en ≈ìuvre son propre v√©lo. <br></div></div><br>  Avec de telles blagues et blagues, nous avons tranquillement pass√© les deuxi√®me et troisi√®me semaines.  De plus, chaque semaine commen√ßait par la phrase "eh bien, la semaine prochaine, nous sommes oblig√©s de pr√©parer une version jouable" - chaque fois il nous semblait que nous √©tions sur le point d'√™tre pr√™ts.  Le manque total d'exp√©rience et la pr√©sence d'un formidable optimisme sont la pire fa√ßon d'√©valuer le calendrier. <br><br>  Une semaine avant la livraison, lors de la r√©union des d√©veloppeurs, nous n'avons m√™me pas pu montrer la version normale et avons d√ª montrer le faux serveur. <br><br>  Bien s√ªr, avec une telle vitesse de d√©veloppement, il n'y avait rien √† r√™ver sur une liste de fonctionnalit√©s initialement con√ßue, et encore plus sur le plaisir d'avoir des choses.  Par cons√©quent, nous avons d√ª oublier le "bac √† sable" et nous arr√™ter au tireur 2D le plus simple. <br><br><h3>  D√©veloppement.  Semaine 4, derni√®re </h3><br>  Au cours de la derni√®re semaine de d√©veloppement, nous nous sommes concentr√©s sur la correction des bogues.  Il vaut mieux avoir quelque chose de modeste et de fonctionnel que multifonctionnel, mais en ruine.  Les probl√®mes √©taient nombreux et la plupart concernaient l'int√©gration malheureuse.  Ici et l√†, des d√©fauts mineurs sont apparus, aggravant consid√©rablement l'impression du jeu. <br><br>  En plus de corriger les bugs, j'ai √©galement apport√© le brillant final √† l'interface utilisateur: ajouter de la musique et des sons, jouer avec les polices et am√©liorer les petits d√©tails. <br><br>  De toutes les fonctionnalit√©s, cette semaine, seul le syst√®me de points a √©t√© ajout√©, ainsi que la limitation du stock de boules de neige et leur restauration. <br><br>  Le dernier jour de Game Jam, nous avons pu jouer un peu avec des coll√®gues.  Malgr√© les critiques positives g√©n√©rales, cette session de jeu a √©chou√© en raison d'un bug critique - les boules de neige ont vol√© sur le serveur et sur le client √† diff√©rentes vitesses.  Pour cette raison, entrer dans d'autres joueurs √©tait plus susceptible d'√™tre un accident. <br><br><div class="spoiler">  <b class="spoiler_title">Description de la cause et correction de l'erreur</b> <div class="spoiler_text">  Nous avons fait ce bogue au dernier moment, r√©duisant le nombre de FPS sur le serveur de 1000 exp√©rimental √† 100. <br><br>  Il convient de noter que jusqu'√† pr√©sent, nous ne pouvions pas r√©aliser un mouvement enti√®rement synchrone sur le client et le serveur - il y avait parfois des sauts de mouvement.  En modifiant FPS, nous avons essay√© d'augmenter la r√©activit√© du serveur. <br><br>  Quand j'ai commenc√© √† rechercher ce bug, j'ai d√©couvert 2 mod√®les: <br><br><ul><li>  le mouvement du joueur a fonctionn√© correctement et de mani√®re stable; </li><li>  le mouvement de boule de neige sur le client √©tait toujours plus rapide que sur le serveur. </li></ul><br>  La valeur de la vitesse des objets revient au client √† partir du serveur, c'est-√†-dire qu'il ne peut pas s'agir d'une asym√©trie banale de valeurs.  De plus, une augmentation inverse du FPS √† 1000 a am√©lior√© la situation. <br><br>  J'ai pass√© beaucoup de temps √† essayer de corriger cette erreur.  Mais rien n'y fait.  Et √† la fin, la raison a √©t√© trouv√©e en utilisant googling - box2d limite indirectement la vitesse maximale en d√©pla√ßant l'objet de pas plus de 2 pixels en une seule √©tape du monde.  C'est-√†-dire  √† 100 FPS, la vitesse maximale est de 200 pixels / s (p / s) et √† 1000 FPS - 2000 p / s.  Cette valeur est sp√©cifi√©e dans une constante et ne peut pas √™tre modifi√©e dynamiquement.  Cela expliquait pleinement la raison du ralentissement de nos boules de neige, car leur vitesse aurait d√ª √™tre de 700 p / s, ce qui n√©cessitait un FPS stable au-dessus de 350. <br><br>  Pour r√©soudre ce probl√®me, j'ai augment√© le FPS √† 500, mais pour une raison.  Dans box2d, vous devez passer √† la fonction step du monde combien de temps s'est √©coul√© depuis l'√©tape pr√©c√©dente.  Avant mon changement, nous avons toujours calcul√© cette diff√©rence avant d'appeler la fonction.  Mais maintenant, connaissant la fr√©quence souhait√©e, il √©tait toujours possible d'indiquer un delta constant de 2 ms.  Le monde √©tant √† la tra√Æne du r√©el, les √©tapes devaient √™tre r√©p√©t√©es les unes apr√®s les autres, jusqu'√† ce que le temps du monde rattrape le d√©calage.  Puis un peu de sommeil et tout est nouveau. <br><br>  Cette correction, comme pr√©vu, a r√©solu le probl√®me de vitesse de boule de neige.  De plus, le probl√®me des mouvements non synchrones sur le serveur et le client a finalement disparu.  √Ä cette √©poque, cette gu√©rison miraculeuse √©tait une surprise compl√®te pour nous, mais maintenant j'ai compris la raison: malgr√© le maximum de 1000 FPS, personne n'a annul√© la lenteur du serveur, et surtout la collecte des ordures.  C'est-√†-dire  √† certains moments, le FPS pouvait tomber librement en dessous des 350 FPS requis, ce qui entra√Ænait des sauts de vitesse arbitraires. <br></div></div><br>  Donc, heureux d'un bug ferm√© et d'un jouet fonctionnel, 2 heures avant la date limite, nous √©tions pr√™ts √† nous rendre.  Il ne restait plus qu'√† envoyer le jeu sur le site du projet. <br><br>  Je m'attendais √† ce que la sortie du jeu se passe en douceur et en vain.  Il √©tait n√©cessaire de cr√©er une page de projet, de faire une description, de t√©l√©charger des captures d'√©cran et bien plus encore.  Nous nous sommes rencontr√©s, comme pr√©vu, de bout en bout.  Bien que plus tard, les organisateurs ont toujours accept√© individuellement les projets tardifs. <br><br><img src="https://habrastorage.org/webt/vk/er/sf/vkersfkvr9qzg0atrqywh1jgk4w.png" alt="image"><br>  <i>Capture d'√©cran de la version finale du jeu</i> <br><br><h3>  Vote </h3><br>  Selon les termes du concours, imm√©diatement apr√®s l'ach√®vement du d√©veloppement, un vote de 20 jours a √©t√© ouvert.  Pendant cette p√©riode, tout le monde a pu voir les projets achev√©s, dont plus de 200 ont √©t√© accumul√©s. Seuls les participants ont √©t√© autoris√©s √† voter pour les projets.  Chaque jeu peut √™tre class√© dans les cat√©gories suivantes: g√©n√©ral, graphisme, son, gameplay, caract√®re innovant et pertinence par rapport au th√®me. <br><br>  La phase de vote nous a pr√©par√© une mauvaise surprise li√©e √† la nature multijoueur de notre jeu.  Il y avait relativement peu de gens qui regardaient les matchs et la chance de rencontrer l'ennemi tendait √† z√©ro.  C'est-√†-dire  les gens sont all√©s chercher une carte vide, ont lanc√© quelques boules de neige, ont couru sur quelques m√®tres et sont repartis d√©√ßus. <br><br>  Nous avons essay√© d'organiser des sessions de jeu via le forum du projet.  De plus, Selim et moi sommes entr√©s p√©riodiquement dans le jeu, esp√©rant divertir un vagabond solitaire et ennuy√©.  Tout cela n'a donn√© presque aucun r√©sultat. <br><br>  J'√©tais int√©ress√© de voir des gens tester le jeu.  Je me souviens surtout du cas o√π un joueur a entr√© plusieurs caract√®res en m√™me temps et construit un pentagramme de gar√ßons.  Je ne sais pas ce que l'auteur voulait dire, mais j'ai toujours une capture d'√©cran du processus de sa cr√©ation. <br><br><img src="https://habrastorage.org/webt/cq/rn/yh/cqrnyhjzfmc5xzvzhllkon2gcs0.png" alt="image"><br><br>  Un autre joueur a ¬´pirat√©¬ª notre jeu.  Nous avons une v√©rification de la longueur du nom, mais uniquement du c√¥t√© client.  En cons√©quence, il a contourn√© cette d√©fense et a commenc√© √† correspondre avec moi de cette fa√ßon, en entrant chaque fois un nouveau caract√®re et en entrant sa phrase au nom d'un homme. <br><br>  Parall√®lement au vote, mes coll√®gues et moi avons jou√© √† nouveau, se vengeant du match infructueux le jour de la fin du projet.  Cette fois, tout s'est tr√®s bien pass√© et nous avons eu un certain nombre d'id√©es pour de nouvelles fonctions, qu'il √©tait cependant trop tard pour ajouter. <br><br>  √Ä mon avis, la qualit√© du jeu, notamment en ce qui concerne l'interaction avec le serveur, s'est r√©v√©l√©e √† un tr√®s bon niveau.  Combien de fois nous l'avons jou√©, nous n'avons remarqu√© aucun probl√®me et nous ne les avons pas entendus des autres joueurs.  Pour moi personnellement, ce fut une surprise, compte tenu de la qualit√© et du nombre d'erreurs quelques jours avant la livraison. <br><br>  Les 20 jours accord√©s √† l'√©valuation des jeux ont dur√© tr√®s longtemps, mais finalement ils se sont termin√©s et le temps tant attendu des r√©sultats est venu. <br><br><img src="https://habrastorage.org/webt/l5/pq/uo/l5pquotx-kdt6onfu_kcdnl_d6y.png" alt="image"><br><br>  Ainsi, nous avons pris la 36e place sur un peu plus de 200 participants.  Ce qui, d'une part, n'est pas mauvais pour le premier projet, mais d'autre part, c'est un peu d√©sagr√©able pour la fiert√©.  Surtout si l'on consid√®re que le top 10 a obtenu de bons matchs, mais tous ne m√©ritaient pas une attention particuli√®re. <br><br><h3>  Le√ßons apprises </h3><br>  Pour obtenir des le√ßons dans des conditions de semi-serre, tout a commenc√©.  Nous avons essay√© d'inventer beaucoup de choses nous-m√™mes et nous sommes limit√©s √† un ensemble minimal d'outils afin de ressentir les probl√®mes et de faire l'exp√©rience de mauvaises approches dans notre propre peau.  Mais maintenant, sachant comment le faire et pourquoi, √©tudier la th√©orie sera plus facile. <br><br>  <b>Le besoin d'un artiste</b> .  Comme l'a montr√© la pratique (pas seulement la n√¥tre), vous pouvez faire un bon jeu sans de bons graphismes.  Cependant, la s√©lection des bonnes images, polices et √©l√©ments d'interface utilisateur prend la plupart du temps.  Et le pire, c'est qu'en fin de compte ils ne co√Øncident pas.  De l√†, l'atmosph√®re du tube chaud est perdue et le jeu ne semble pas holistique. <br><br>  <b>Les tests de jeu sont tr√®s importants</b> .  En raison de probl√®mes de vitesse de d√©veloppement, nous n'avons pas pu tester la jouabilit√© de notre impl√©mentation la plupart du temps.  Lorsque nous avons pu jouer normalement, nous avions trop peu de temps pour r√©soudre les probl√®mes.  Et nous avons eu beaucoup de chance qu'il n'y ait pas eu autant de probl√®mes de ce genre. <br>  √Ä mon avis, pour les jeux, de tels tests sur des utilisateurs r√©els sont beaucoup plus importants que pour les applications commerciales, car en plus de la commodit√© et de la r√©solution des probl√®mes des utilisateurs, il est toujours n√©cessaire de maintenir un certain niveau d'√©motions et d'implication. <br><br>  <b>Toutes les biblioth√®ques ne sont pas √©galement utiles</b> .  Presque personne ne d√©veloppe de jeux sur leur propre moteur et il existe des moteurs sur le march√© pour toutes les occasions.  Dans la cour √©tait 2017, et on s'attendrait √† leur haute qualit√©.  J'ai choisi Phaser comme l'un des moteurs JS les plus recommand√©s et les plus jeunes.  Apr√®s tous les probl√®mes que nous avons rencontr√©s avec lui, j'ai peur d'imaginer √† quel point les moteurs semblent pires.  Non, en g√©n√©ral, les impressions de travailler avec Phaser sont plut√¥t positives, surtout compte tenu de la bonne documentation et des exemples.  Mais travailler avec lui sans conna√Ætre un grand nombre de nuances est tr√®s difficile.  Au printemps, une nouvelle version sort et j'esp√®re une am√©lioration significative.  Et aussi dans mes plans est un mini-projet sur un autre moteur √† comparer. <br>  Et je me souviendrai longtemps de ce probl√®me de vitesse maximale dans box2d. <br><br>  <b>Dans le processus de Game Jam, il est tout √† fait possible d'apprendre</b> .  Au d√©marrage de ce projet, nous ne savions presque rien du d√©veloppement des jeux, ni des biblioth√®ques que nous utilisions.  Et la plupart du temps √©tait consacr√© √† l'√©tude de ces choses.  Malgr√© cela, nous avons quand m√™me r√©ussi √† amener le jeu dans un √©tat complet. <br><br>  <b>Pas beaucoup de fonctionnalit√©s requises</b> .  Je suis un peu surpris que beaucoup de gens aient aim√© notre jeu.  Oui, ils ne s'y assoient pas tous les soirs, mais profitent d'une ou deux petites s√©ances.  Mais dans notre jeu, il n'y a ni id√©e originale, ni grande quantit√© de fonctionnalit√©s, ni histoire.  La m√™me chose peut √™tre dite de la plupart des jeux de Game Jam qui ont re√ßu des notes positives. <br><br>  <b>(Jeu) Jam est une excellente raison d'essayer</b> .  Peu importe quoi: une id√©e, une nouvelle biblioth√®que, vos propres forces.  Lorsqu'il y a un objectif clair et que d'autres devraient voir votre r√©sultat, c'est tr√®s motivant de ne pas devenir mou et de donner le meilleur.  Et m√™me si le r√©sultat est pire que pr√©vu, il ne sera pas dommage de le jeter, de tirer des le√ßons par vous-m√™me et d'aller de l'avant! <br><br><h4>  Liens vers les ressources: </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">selim.co/snowbox</a> - le jeu lui-m√™me.  Nous ne l'avons pas pouss√© aux tests de r√©sistance, je suis donc loin d'√™tre s√ªr qu'il r√©sistera √† tous les arrivants.  Si le serveur ment, vous pouvez essayer mock - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">selim.co/snowbox/#mock</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github.com/wowselim/gameserver</a> - d√©p√¥t de code serveur </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github.com/bugy/snowbox-ui</a> - r√©f√©rentiel client </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">itch.io/jam/game-off-2017</a> - Page Game Jam </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">itch.io/jam/game-off-2017/rate/199650</a> - page de vote de jeu </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">opengameart.org</a> - la principale source de ressources de jeu </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">freesound.org</a> - les sons du jeu ont √©t√© pris √† partir d'ici </li></ul><br>  <i>Merci √† tous pour votre temps et votre bonne humeur!</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr409679/">https://habr.com/ru/post/fr409679/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr409669/index.html">Ce que les innovateurs de paiement peuvent apprendre des singes</a></li>
<li><a href="../fr409671/index.html">Qu'est-ce que le minage et pourquoi le minage sur des cartes vid√©o</a></li>
<li><a href="../fr409673/index.html">Comment mettre en place un contr√¥le qualit√© des services m√©dicaux: l'exp√©rience de l'√©quipe DOC +</a></li>
<li><a href="../fr409675/index.html">L'asym√©trie de la nature</a></li>
<li><a href="../fr409677/index.html">Cure enzymatique ou comment se lever rapidement apr√®s une blessure</a></li>
<li><a href="../fr409681/index.html">Demandez √† Ethan: les non-stars peuvent-elles encore devenir des stars?</a></li>
<li><a href="../fr409683/index.html">Courte critique de l'ultrabook ASUS ZenBook 13</a></li>
<li><a href="../fr409687/index.html">Vendredi Format: Les femmes dans la musique √©lectronique - Wendy Carlos et Susan Chani</a></li>
<li><a href="../fr409689/index.html">Les chanceux et les perdants dans le monde du bitcoin: 7 histoires viennent de 2017</a></li>
<li><a href="../fr409691/index.html">M√©dias: les √âtats-Unis cesseront de financer l'ISS en 2025</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>