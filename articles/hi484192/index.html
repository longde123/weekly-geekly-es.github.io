<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>уКЧя╕П ЁЯСиЁЯП╝тАНЁЯТ╗ ЁЯПд рдЯрд╛рд░реЗрдВрдЯреВрд▓ рдХрд╛рд░реНрдЯреНрд░рд┐рдЬ (рднрд╛рдЧ 2) рдкрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдирд╛ рдЖрд╕рд╛рди рдФрд░ рдЖрд╕рд╛рди рд╣реИ ЁЯд▒ЁЯП╜ ЁЯдЮЁЯП┐ ЁЯМЧ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рд╣рд╛рд▓ рд╣реА рдореЗрдВ, рд╣рдордиреЗ рдЯрд╛рд░рдирдЯреВрд▓ рдХрд╛рд░реНрдЯреНрд░рд┐рдЬ рдореЗрдВ рд▓рд┐рдЦреЗ рдЧрдП рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдХреИрд╕реЗ рддреИрдирд╛рдд рдХрд┐рдпрд╛ рдЬрд╛рдП, рдЗрд╕ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХреА ред рд▓реЗрдХрд┐рди рдСрдкрд░реЗрд╢рди рддреИрдирд╛рддреА рдкрд░ рд╕рдорд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдЯрд╛рд░реЗрдВрдЯреВрд▓ рдХрд╛рд░реНрдЯреНрд░рд┐рдЬ (рднрд╛рдЧ 2) рдкрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдирд╛ рдЖрд╕рд╛рди рдФрд░ рдЖрд╕рд╛рди рд╣реИ</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/484192/"><p><img src="https://habrastorage.org/webt/yc/gm/xx/ycgmxxaqlvyslsrzoo6jnv1vmx0.jpeg"></p><br><p>  рд╣рд╛рд▓ рд╣реА рдореЗрдВ, рд╣рдордиреЗ <a href="https://habr.com/ru/company/mailru/blog/465503/">рдЯрд╛рд░рдирдЯреВрд▓ рдХрд╛рд░реНрдЯреНрд░рд┐рдЬ</a> рдореЗрдВ рд▓рд┐рдЦреЗ рдЧрдП рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдХреИрд╕реЗ рддреИрдирд╛рдд рдХрд┐рдпрд╛ рдЬрд╛рдП, <a href="https://habr.com/ru/company/mailru/blog/478710/">рдЗрд╕</a> рдмрд╛рд░реЗ рдореЗрдВ <a href="https://habr.com/ru/company/mailru/blog/478710/">рдмрд╛рдд рдХреА</a> ред  рд▓реЗрдХрд┐рди рдСрдкрд░реЗрд╢рди рддреИрдирд╛рддреА рдкрд░ рд╕рдорд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЖрдЬ рд╣рдо рдЕрдкрдиреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВрдЧреЗ рдФрд░ рд╕рдордЭреЗрдВрдЧреЗ рдХрд┐ рдЯреЛрдкреЛрд▓реЙрдЬреА, рд╢рд╛рд░реНрдХрд┐рдВрдЧ рдФрд░ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХреИрд╕реЗ рдХрд░реЗрдВ, рд╕рд╛рде рд╣реА рд╕рд╛рде рднреВрдорд┐рдХрд╛рдУрдВ рдХреЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЛ рднреА рдмрджрд▓реЗрдВред </p><br><p>  рдЬрд┐рдЬреНрдЮрд╛рд╕реБ рдХреГрдкрдпрд╛ рдХрдЯ! </p><a name="habracut"></a><br><h2 id="na-chem-my-ostanovilis">  рд╣рдо рдХрд╣рд╛рдВ рд░реБрдХ рдЧрдП </h2><br><p>  рдкрд┐рдЫрд▓реА рдмрд╛рд░ рд╣рдордиреЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЯреЛрдкреЛрд▓реЙрдЬреА рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдерд╛: </p><br><p><img src="https://habrastorage.org/webt/sw/0z/gm/sw0zgm53me7ft63db8lxrswcxvw.png"></p><br><p> рдЙрджрд╛рд╣рд░рдг <a href="https://github.com/dokshina/deploy-tarantool-cartridge-app">рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА</a> рдереЛрдбрд╝рд╛ рдмрджрд▓рдиреЗ рдореЗрдВ рдХрд╛рдордпрд╛рдм <code>getting-started-app-2.0.0-0.rpm</code> , рдирдИ рдлрд╛рдЗрд▓реЗрдВ рд╡рд╣рд╛рдВ рджрд┐рдЦрд╛рдИ рджреАрдВ, <code>getting-started-app-2.0.0-0.rpm</code> <code>hosts.updated.2.yml</code> . <code>getting-started-app-2.0.0-0.rpm</code> рдФрд░ <code>hosts.updated.2.yml</code> ред  рдЖрдкрдХреЛ рдирдП рд╕рдВрд╕реНрдХрд░рдг рдХреЛ рдЦреАрдВрдЪрдиреЗ рдХреА рдЬрд╝рд░реВрд░рдд рдирд╣реАрдВ рд╣реИ, рдЖрдк рдмрд╕ <a href="">рд▓рд┐рдВрдХ</a> рдХреЛ рдкреИрдХреЗрдЬ рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ <code>hosts.updated.2.yml</code> рдХреА рдХреЗрд╡рд▓ рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЖрдк рд╡рд░реНрддрдорд╛рди рдЗрдиреНрд╡реЗрдВрдЯреНрд░реА рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд╕рд╛рде рдХрдард┐рдирд╛рдЗрдпреЛрдВ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рд╡рд╣рд╛рдВ рдЭрд╛рдВрдХ рд╕рдХреЗрдВред </p><br><p>  рдпрджрд┐ рдЖрдкрдиреЗ рдЗрд╕ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдХреЗ рдкрд┐рдЫрд▓реЗ рднрд╛рдЧ рдХреЗ рд╕рднреА рдЪрд░рдгреЛрдВ рдХреЛ рдкреВрд░рд╛ рдХрд░ рд▓рд┐рдпрд╛ рд╣реИ, рддреЛ рдЕрдм рдЖрдкрдХреА hosts.yml <code>hosts.yml</code> рджреЛ <code>storage</code> рдкреНрд░рддрд┐рдХреГрддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рдХреНрд▓рд╕реНрдЯрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╣реИ (рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдореЗрдВ рдпрд╣ <code>hosts.updated.yml</code> )ред </p><br><p>  рд╣рдорд╛рд░реА рд╡рд░реНрдЪреБрдЕрд▓ рдорд╢реАрди рдЙрдард╛рдПрдБ: </p><br><pre> <code class="bash hljs">$ vagrant up</code> </pre> <br><p>  рдЕрдиреНрд╕рд┐рдмрд▓-рд░реЛрд▓ рдЯрд╛рд░реЗрдВрдЯреВрд▓ рдХрд╛рд░реНрдЯреНрд░рд┐рдЬ рдХреЗ рдирдП рд╕рдВрд╕реНрдХрд░рдг рдХреЛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ (рдпрд╣ рдмреЗрд╣рддрд░ рддрд░реАрдХреЗ рд╕реЗ, рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рдмрджрд▓рдиреЗ рдореЗрдВ рдХрд╛рдордпрд╛рдм рд░рд╣рд╛): </p><br><pre> <code class="bash hljs">$ ansible-galaxy install tarantool.cartridge,1.0.2</code> </pre> <br><p>  рддреЛ, рд╡рд░реНрддрдорд╛рди рдХреНрд▓рд╕реНрдЯрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди: </p><br><pre> <code class="plaintext hljs">--- all: vars: # common cluster variables cartridge_app_name: getting-started-app cartridge_package_path: ./getting-started-app-1.0.0-0.rpm # path to package cartridge_cluster_cookie: app-default-cookie # cluster cookie # common ssh options ansible_ssh_private_key_file: ~/.vagrant.d/insecure_private_key ansible_ssh_common_args: '-o IdentitiesOnly=yes -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no' # INSTANCES hosts: storage-1: config: advertise_uri: '172.19.0.2:3301' http_port: 8181 app-1: config: advertise_uri: '172.19.0.3:3301' http_port: 8182 storage-1-replica: config: advertise_uri: '172.19.0.3:3302' http_port: 8183 storage-2: config: advertise_uri: '172.19.0.3:3303' http_port: 8184 storage-2-replica: config: advertise_uri: '172.19.0.2:3302' http_port: 8185 children: # GROUP INSTANCES BY MACHINES host1: vars: # first machine connection options ansible_host: 172.19.0.2 ansible_user: vagrant hosts: # instances to be started on the first machine storage-1: storage-2-replica: host2: vars: # second machine connection options ansible_host: 172.19.0.3 ansible_user: vagrant hosts: # instances to be started on the second machine app-1: storage-1-replica: storage-2: # GROUP INSTANCES BY REPLICA SETS replicaset_app_1: vars: # replica set configuration replicaset_alias: app-1 failover_priority: - app-1 # leader roles: - 'api' hosts: # replica set instances app-1: replicaset_storage_1: vars: # replica set configuration replicaset_alias: storage-1 weight: 3 failover_priority: - storage-1 # leader - storage-1-replica roles: - 'storage' hosts: # replica set instances storage-1: storage-1-replica: replicaset_storage_2: vars: # replicaset configuration replicaset_alias: storage-2 weight: 2 failover_priority: - storage-2 - storage-2-replica roles: - 'storage' hosts: # replicaset instances storage-2: storage-2-replica:</code> </pre> <br><p>  <a href="http://localhost:8181/admin/cluster/dashboard">Http: // localhost: 8181 / рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ / рдХреНрд▓рд╕реНрдЯрд░ / рдбреИрд╢рдмреЛрд░реНрдб рдкрд░ рдЬрд╛рдПрдВ</a> рдФрд░ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдкрдХрд╛ рдХреНрд▓рд╕реНрдЯрд░ рд╕рд╣реА рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд╣реИред </p><br><p>  рдкрд┐рдЫрд▓реА рдмрд╛рд░ рдХреА рддрд░рд╣ рд╣реА рд╕рдм рдХреБрдЫ рд╣реИ: рд╣рдо рдзреАрд░реЗ-рдзреАрд░реЗ рдЗрд╕ рдлрд╛рдЗрд▓ рдХреЛ рдмрджрд▓реЗрдВрдЧреЗ рдФрд░ рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ рдХреНрд▓рд╕реНрдЯрд░ рдХреИрд╕реЗ рдмрджрд▓рддрд╛ рд╣реИред  рдЖрдк <code>hosts.updated.2.yml</code> рдореЗрдВ рд╣рдореЗрд╢рд╛ рдЕрдВрддрд┐рдо рд╕рдВрд╕реНрдХрд░рдг рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ </p><br><p>  рддреЛ рдпрд╣рд╛рдБ рд╣рдо рдЪрд▓реЗ! </p><br><h2 id="obnovlyaem-prilozhenie">  рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░ рд░рд╣рд╛ рд╣реИ </h2><br><p>  рдЖрд░рдВрдн рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдЗрдП рдЕрдкрдиреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВред  рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рд╡рд░реНрддрдорд╛рди рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ <code>getting-started-app-2.0.0-0.rpm</code> рдлрд╝рд╛рдЗрд▓ рд╣реИ (рдпрджрд┐ рдирд╣реАрдВ, рддреЛ рдЗрд╕реЗ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рд╕реЗ <a href="">рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ</a> )ред </p><br><p>  рдкреИрдХреЗрдЬ рдХреЗ рдирдП рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд▓рд┐рдП рдкрде рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░реЗрдВ: </p><br><pre> <code class="plaintext hljs">--- all: vars: cartridge_app_name: getting-started-app cartridge_package_path: ./getting-started-app-2.0.0-0.rpm # &lt;== cartridge_enable_tarantool_repo: false # &lt;==</code> </pre> <br><p>  рд╣рдордиреЗ рдХрд╛рд░рддреВрд╕_enable_tarantool_repo рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ <code>cartridge_enable_tarantool_repo: false</code> рдЗрд╕рд▓рд┐рдП рдХрд┐ рднреВрдорд┐рдХрд╛ рдЯрд╛рд░рд╕реНрдЯреВрд▓ рдкреИрдХреЗрдЬ рдХреЗ рд╕рд╛рде рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдХреЛ рдирд╣реАрдВ рдЬреЛрдбрд╝рддреА рд╣реИ, рдЬрд┐рд╕реЗ рд╣рдордиреЗ рдкрд╣рд▓реЗ рд╣реА рдЕрдВрддрд┐рдо рдмрд╛рд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдерд╛ред  рдпрд╣ рддреИрдирд╛рддреА рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдереЛрдбрд╝рд╛ рдЧрддрд┐ рджреЗрдЧрд╛, рд▓реЗрдХрд┐рди рдпрд╣ рдмрд┐рд▓реНрдХреБрд▓ рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реИред </p><br><p>  <code>cartridge-instances</code> рдЯреИрдЧ рдХреЗ рд╕рд╛рде рдкреНрд▓реЗрдмреБрдХ рд▓реЙрдиреНрдЪ рдХрд░реЗрдВ: </p><br><pre> <code class="bash hljs">$ ansible-playbook -i hosts.yml playbook.yml \ --tags cartridge-instances</code> </pre> <br><p>  рдФрд░ рд╣рдо рдЬрд╛рдБрдЪрддреЗ рд╣реИрдВ рдХрд┐ рдкреИрдХреЗрдЬ рдЕрджреНрдпрддрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: </p><br><pre> <code class="bash hljs">$ vagrant ssh vm1 [vagrant@svm1 ~]$ sudo yum list installed | grep getting-started-app</code> </pre> <br><p>  рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рд╕рдВрд╕реНрдХрд░рдг <code>2.0.0</code> рд╣реЛ рдЧрдпрд╛ рд╣реИ: </p><br><pre> <code class="bash hljs">getting-started-app.x86_64 2.0.0-0 installed</code> </pre> <br><p>  рдЕрдм рдЖрдк рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдирдП рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд╕рд╛рде рд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ рдкреНрд░рдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </p><br><h2 id="vklyuchaem-shardirovanie">  рд╢рд╛рд░реНрдХрд┐рдВрдЧ рдЪрд╛рд▓реВ рдХрд░реЗрдВ </h2><br><p>  рдЖрдЗрдП рд╢рд╛рд░реНрдбрд┐рдВрдЧ рдЪрд╛рд▓реВ рдХрд░реЗрдВ рддрд╛рдХрд┐ рд╣рдо рдмрд╛рдж рдореЗрдВ <code>storage</code> рдкреНрд░рддрд┐рдХреГрддрд┐рдпреЛрдВ рдХрд╛ рдирд┐рдпрдВрддреНрд░рдг рд▓реЗ рд╕рдХреЗрдВред  рдпрд╣ рдмрд╣реБрдд рд╕рд░рд▓рддрд╛ рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЪрд░ <code>all.vars</code> <code>cartridge_bootstrap_vshard</code> <code>all.vars</code> рдзрд╛рд░рд╛ рдЕрдиреБрднрд╛рдЧ рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ: </p><br><pre> <code class="plaintext hljs">--- all: vars: ... cartridge_cluster_cookie: app-default-cookie # cluster cookie cartridge_bootstrap_vshard: true # &lt;== ... hosts: ... children: ...</code> </pre> <br><p>  рд╣рдо рд▓реЙрдиреНрдЪ рдХрд░рддреЗ рд╣реИрдВ: </p><br><pre> <code class="bash hljs">$ ansible-playbook -i hosts.yml playbook.yml \ --tags cartridge-config</code> </pre> <br><p>  рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╣рдордиреЗ <code>cartridge-config</code> рдХреЙрдиреНрдлрд┐рдЧрд░ рдЯреИрдЧ рдХреЛ рдХреЗрд╡рд▓ рдЙрдиреНрд╣реАрдВ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рд╣реИ рдЬреЛ рдХреНрд▓рд╕реНрдЯрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред </p><br><p>  рд╡реЗрдм UI <a href="http://localhost:8181/admin/cluster/dashboard">http</a> рдЦреЛрд▓реЗрдВ <a href="http://localhost:8181/admin/cluster/dashboard">: // localhost: 8181 / admin / рдХреНрд▓рд╕реНрдЯрд░ / рдбреИрд╢рдмреЛрд░реНрдб</a> рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рд╣рдорд╛рд░реА рдмрд╛рд▓реНрдЯрд┐рдпрд╛рдБ <code>2:3</code> рдЕрдиреБрдкрд╛рдд рдореЗрдВ рднрдВрдбрд╛рд░рдг рдкреНрд░рддрд┐рдХреГрддрд┐ рд╕реЗрдЯ рдореЗрдВ рд╡рд┐рддрд░рд┐рдд рдХреА рдЬрд╛рддреА рд╣реИрдВ (рд╣рдордиреЗ рдЕрдкрдиреЗ рдкреНрд░рддрд┐рдХреГрддрд┐ рд╕реЗрдЯреЛрдВ рдХреЗ рд▓рд┐рдП рдЗрд╕ рддрд░рд╣ рдХреЗ рд╡рдЬрди рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдП рд╣реИрдВ, рдпрд╛рдж рд╣реИ?)ред </p><br><p><img src="https://habrastorage.org/webt/g_/vd/78/g_vd787hpifhrlhk-jfs5sw8iu4.png"></p><br><h2 id="vklyuchaem-avtomaticheskiy-failover">  рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд╡рд┐рдлрд▓рддрд╛ рдЪрд╛рд▓реВ рдХрд░реЗрдВ </h2><br><p>  рдФрд░ рдЕрдм рд╣рдо рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд╡рд┐рдлрд▓рддрд╛ рдореЛрдб рдХреЛ рдЪрд╛рд▓реВ рдХрд░реЗрдВрдЧреЗ рддрд╛рдХрд┐ рд╣рдо рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХреЗрдВ рдХрд┐ рдпрд╣ рдХреНрдпрд╛ рд╣реИ рдФрд░ рдпрд╣ рдмрд╛рдж рдореЗрдВ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред </p><br><p>  <code>cartridge_failover</code> рдзреНрд╡рдЬ рдХреЛ рд╡рд┐рдиреНрдпрд╛рд╕ рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ: </p><br><pre> <code class="plaintext hljs">--- all: vars: ... cartridge_cluster_cookie: app-default-cookie # cluster cookie cartridge_bootstrap_vshard: true cartridge_failover: true # &lt;== ... hosts: ... children: ...</code> </pre> <br><p>  рд╣рдо рдлрд┐рд░ рд╕реЗ рдХреНрд▓рд╕реНрдЯрд░ рдкреНрд░рдмрдВрдзрди рдХрд╛рд░реНрдп рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ: </p><br><pre> <code class="bash hljs">$ ansible-playbook -i hosts.yml playbook.yml \ --tags cartridge-config</code> </pre> <br><p>  рдкреНрд▓реЗрдмреБрдХ рдХреЛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдЖрдк рд╡реЗрдм UI рдкрд░ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдКрдкрд░реА рджрд╛рдПрдВ рдХреЛрдиреЗ рдореЗрдВ <code>Failover</code> рд╕реНрд╡рд┐рдЪ рдмрдВрдж рд╣реИред  рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдлрд╝реЗрд▓рдУрд╡рд░ рдореЛрдб рдХреЛ рдмрдВрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдХреЗрд╡рд▓ cart_failover рдХреЗ рдорд╛рди рдХреЛ <code>false</code> рдмрджрд▓реЗрдВ рдФрд░ рдкреНрд▓реЗрдмреБрдХ рдХреЛ рдлрд┐рд░ рд╕реЗ рдЪрд▓рд╛рдПрдБред </p><br><p>  рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХрд╛ рд╕рдордп рд╣реИ рдХрд┐ рдпрд╣ рдХрд┐рд╕ рддрд░рд╣ рдХрд╛ рд╢рд╛рд╕рди рд╣реИ рдФрд░ рд╣рдордиреЗ рдЗрд╕реЗ рдХреНрдпреЛрдВ рдЪрд╛рд▓реВ рдХрд┐рдпрд╛ред </p><br><h2 id="razbiraemsya-s-failover-om">  рд╣рдо рдЕрд╕рдлрд▓рддрд╛ рд╕реЗ рдирд┐рдкрдЯрддреЗ рд╣реИрдВ </h2><br><p>  рдЖрдкрдиреЗ рд╕рдВрднрд╡рддрдГ рдкреНрд░рддреНрдпреЗрдХ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ <code>failover_priority</code> рдЪрд░ рдХреЛ рджреЗрдЦрд╛ рдерд╛ред  рдЖрдЗрдП рджреЗрдЦреЗрдВ рдХрд┐ рдпрд╣ рдХреНрдпрд╛ рд╣реИред </p><br><p>  рдЯрд╛рд░реЗрдВрдЯреВрд▓ рдХрд╛рд░реНрдЯреНрд░рд┐рдЬ рдПрдХ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд╡рд┐рдлрд▓рддрд╛ рдореЛрдб рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред  рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рддрд┐рдХреГрддрд┐рдпреЛрдВ рдореЗрдВ рдПрдХ рдиреЗрддрд╛ рд╣реЛрддрд╛ рд╣реИ - рдЬрд┐рд╕ рдкрд░ рдпрд╣ рджрд░реНрдЬ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИред  рдЕрдЧрд░ рдиреЗрддрд╛ рдХреЛ рдХреБрдЫ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдЯрд┐рдкреНрдкрдгреА рдореЗрдВ рд╕реЗ рдПрдХ рдЙрд╕рдХреА рднреВрдорд┐рдХрд╛ рдкрд░ рд▓реЗ рдЬрд╛рдПрдЧрд╛ред  рдХреМрди рд╕рд╛?  рдЪрд▓реЛ <code>storage-2</code> рдкреНрд░рддрд┐рдХреГрддрд┐ рд╕реЗрдЯ рдкрд░ рдХрд░реАрдм рд╕реЗ рдирдЬрд╝рд░ рдбрд╛рд▓реЗрдВ: </p><br><pre> <code class="plaintext hljs">--- all: ... children: ... replicaset_storage_2: vars: ... failover_priority: - storage-2 - storage-2-replica</code> </pre> <br><p>  <code>storage-2</code> рдЙрджрд╛рд╣рд░рдг рд╣рдордиреЗ рдлреЗрд▓рдУрд╡рд░_рдкрд╛рдпрд░рд┐рдЯреА рдореЗрдВ рдкрд╣рд▓реЗ рджрд┐рдпрд╛ рдерд╛ред  рд╡реЗрдм UI рдореЗрдВ, рдпрд╣ рдкреНрд░рддрд┐рдХреГрддрд┐рдпреЛрдВ рдХреЗ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреА рд╕реВрдЪреА рдореЗрдВ рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИ рдФрд░ рд╣рд░реЗ рд░рдВрдЧ рдХреЗ рдореБрдХреБрдЯ рдХреЗ рд╕рд╛рде рдЪрд┐рд╣реНрдирд┐рдд рд╣реЛрддрд╛ рд╣реИред  рдпрд╣ рдиреЗрддрд╛ рд╣реИ - <code>failover_priority</code> рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдкрд╣рд▓рд╛ <code>failover_priority</code> : </p><br><p><img src="https://habrastorage.org/webt/ge/om/bg/geombgvhy6plfnrwpz0o8jqgnaw.png"></p><br><p>  рдЕрдм рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдЕрдЧрд░ рдкреНрд░рддрд┐рдХреГрдд рдХреЗ рдиреЗрддрд╛ рдХреЗ рд╕рд╛рде рдХреБрдЫ рд╣реЛрддрд╛ рд╣реИ рддреЛ рдХреНрдпрд╛ рд╣реЛрддрд╛ рд╣реИред  рд╣рдо рд╡рд░реНрдЪреБрдЕрд▓ рдорд╢реАрди рдореЗрдВ рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ <code>storage-2</code> рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХреЛ рд░реЛрдХрддреЗ рд╣реИрдВ: </p><br><pre> <code class="bash hljs">$ vagrant ssh vm2 [vagrant@vm2 ~]$ sudo systemctl stop getting-started-app@storage-2</code> </pre> <br><p>  рд╡реЗрдм UI рдкрд░ рд╡рд╛рдкрд╕: </p><br><p><img src="https://habrastorage.org/webt/iy/b2/ff/iyb2ff_a6dryhg0nik8p48rhqhm.png"></p><br><p>  <code>storage-2</code> рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдореБрдХреБрдЯ рд▓рд╛рд▓ рд╣реЛ рдЧрдпрд╛ - рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдирд╛рдорд┐рдд рдиреЗрддрд╛ рдЕрд╕реНрд╡рд╕реНрде рд╣реИред  рд▓реЗрдХрд┐рди <code>storage-2-replica</code> рдПрдХ рд╣рд░реЗ рд░рдВрдЧ рдХрд╛ рдореБрдХреБрдЯ рд╣реИ - рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдиреЗ <code>storage-2</code> рдХреА рд╕реЗрд╡рд╛ рдореЗрдВ рд╡рд╛рдкрд╕ рдЖрдиреЗ рддрдХ рдиреЗрддреГрддреНрд╡ рдХреА рдЬрд┐рдореНрдореЗрджрд╛рд░рд┐рдпреЛрдВ рдХреЛ рд╕рдВрднрд╛рд▓ рд▓рд┐рдпрд╛ред  рдпрд╣ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдореЗрдВ рдПрдХ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд╡рд┐рдлрд▓рддрд╛ рд╣реИред </p><br><p>  рдЖрдЗрдП <code>storage-2</code> рдкреБрдирд░реНрдЬреАрд╡рд┐рдд рдХрд░реЗрдВ: </p><br><pre> <code class="bash hljs">$ vagrant ssh vm2 [vagrant@vm2 ~]$ sudo systemctl start getting-started-app@storage-2</code> </pre> <br><p>  рд╕рдм рдХреБрдЫ рдПрдХ рд╡рд░реНрдЧ рдореЗрдВ рд▓реМрдЯ рдЖрдпрд╛: </p><br><p><img src="https://habrastorage.org/webt/ge/om/bg/geombgvhy6plfnrwpz0o8jqgnaw.png"></p><br><p>  рдЖрдЗрдП рд╡рд┐рдлрд▓рддрд╛рдУрдВ рдХреА рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдореЗрдВ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЗ рдХреНрд░рдо рдХреЛ рдмрджрд▓реЗрдВред  рд╣рдо <code>storage-2-replica</code> рдЙрджрд╛рд╣рд░рдг рдХреЛ рдПрдХ рдиреЗрддрд╛ рдмрдирд╛ рджреЗрдВрдЧреЗ, рдФрд░ <code>storage-2</code> рдХреЛ рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рд╕реВрдЪреА рд╕реЗ рд╣рдЯрд╛ рджреЗрдВрдЧреЗ: </p><br><pre> <code class="plaintext hljs">--- all: vars: ... hosts: ... children: ... replicaset_storage_2: vars: # replicaset configuration ... failover_priority: - storage-2-replica # &lt;== ...</code> </pre> <br><p>  рдЪрд▓рд╛рдПрдБ <code>cartridge-replicasets</code> <code>replicaset_storage_2</code> рд╕рдореВрд╣ рд╕реЗ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП <code>cartridge-replicasets</code> рдЪрд▓рд╛рдПрдВ: </p><br><pre> <code class="bash hljs">$ ansible-playbook -i hosts.yml playbook.yml \ --<span class="hljs-built_in"><span class="hljs-built_in">limit</span></span> replicaset_storage_2 \ --tags cartridge-replicasets</code> </pre> <br><p>  рд╣рдо <a href="http://localhost:8181/admin/cluster/dashboard">http: // localhost: 8181 / admin / рдХреНрд▓рд╕реНрдЯрд░ / рдбреИрд╢рдмреЛрд░реНрдб рдкрд░ рдЬрд╛рддреЗ рд╣реИрдВ</a> рдФрд░ рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдиреЗрддрд╛ рдмрджрд▓ рдЧрдпрд╛ рд╣реИ: </p><br><p><img src="https://habrastorage.org/webt/r_/hq/bm/r_hqbmgxwbkvcycacj7pnotjhjc.png"></p><br><p>  рд▓реЗрдХрд┐рди рд╣рдордиреЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╕реЗ <code>storage-2</code> рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХреЛ рд╣рдЯрд╛ рджрд┐рдпрд╛, рдпрд╣ рдЕрднреА рднреА рдпрд╣рд╛рдВ рдХреНрдпреЛрдВ рд╣реИ?  рддрдереНрдп рдпрд╣ рд╣реИ рдХрд┐ Cartridge, <code>failover_priority</code> рдХрд╛ рдирдпрд╛ рдорд╛рди рдкреНрд░рд╛рдкреНрдд рдХрд░ рд░рд╣рд╛ рд╣реИ <code>failover_priority</code> рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЛ рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рд╡реНрдпрд╡рд╕реНрдерд┐рдд рдХрд░рддрд╛ рд╣реИ: рд╕реВрдЪреА рд╕реЗ рдкрд╣рд▓рд╛ рдЙрджрд╛рд╣рд░рдг рдиреЗрддрд╛ рдмрди рдЬрд╛рддрд╛ рд╣реИ, рд╢реЗрд╖ рд╕рдВрдХреЗрдд рджрд┐рдП рдЧрдП рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░рддреЗ рд╣реИрдВред  рд╡рд┐рдлрд▓рддрд╛рдУрдВ_рдкрд╛рдпрд░рд┐рдЯреА рдореЗрдВ рдЙрд▓реНрд▓реЗрдЦ рдирд╣реАрдВ рдХрд┐рдП рдЧрдП рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЛ рдпреВрдпреВрдЖрдИрдбреА рджреНрд╡рд╛рд░рд╛ рдЖрджреЗрд╢ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рдЕрдВрдд рддрдХ рдЬреЛрдбрд╝рд╛ рдЬрд╛рдПрдЧрд╛ред </p><br><h2 id="izgnanie-instansa">  рдирд┐рд░реНрд╡рд╛рд╕рди рдХрд╛ рдЙрджрд╛рд╣рд░рдг </h2><br><p>  рд▓реЗрдХрд┐рди рдХреНрдпрд╛ рд╣реЛрдЧрд╛ рдЕрдЧрд░ рд╣рдо рдЯреЛрдкреЛрд▓реЙрдЬреА рд╕реЗ рдЙрджрд╛рд╣рд░рдг рдХреЛ рдмрд╛рд╣рд░ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ?  рд╕рдм рдХреБрдЫ рдмрд╣реБрдд рд╕рд░рд▓ рд╣реИ: рдЖрдкрдХреЛ <code>expelled</code> рдзреНрд╡рдЬ рдХреЛ рдкрд╛рд╕ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ <code>expelled</code> ред  рдЪрд▓реЛ <code>storage-2-replica</code> рдЙрджрд╛рд╣рд░рдг рдХреЛ рдмрд╛рд╣рд░ рдХрд░рддреЗ рд╣реИрдВред  рд╡рд╣ рдЕрдм рдиреЗрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдХрд╛рд░реНрдЯреНрд░рд┐рдЬ рд╣рдореЗрдВ рдРрд╕рд╛ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрдЧрд╛ред  рд▓реЗрдХрд┐рди рд╣рдо рдХрдард┐рдирд╛рдЗрдпреЛрдВ рд╕реЗ рдбрд░рддреЗ рдирд╣реАрдВ рд╣реИрдВ, рдФрд░ рдлрд┐рд░ рднреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ: </p><br><pre> <code class="plaintext hljs">--- all: vars: ... hosts: storage-2-replica: config: advertise_uri: '172.19.0.2:3302' http_port: 8185 expelled: true # &lt;== ...</code> </pre> <br><p>  рд╣рдо <code>cartridge-replicasets</code> рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддреЗ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХреЛ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓рдирд╛ рдПрдХ рдЯреЛрдкреЛрд▓реЙрдЬреА рдкрд░рд┐рд╡рд░реНрддрди рд╣реИ: </p><br><pre> <code class="bash hljs">$ ansible-playbook -i hosts.yml playbook.yml \ --<span class="hljs-built_in"><span class="hljs-built_in">limit</span></span> replicaset_storage_2 \ --tags cartridge-replicasets</code> </pre> <br><p>  рдкреНрд▓реЗрдмреБрдХ рдЪрд▓рд╛рдПрдВ рдФрд░ рддреНрд░реБрдЯрд┐ рджреЗрдЦреЗрдВ: </p><br><p><img src="https://habrastorage.org/webt/hf/wf/tc/hfwftcua4yyueyi0qgngr2mveia.png"></p><br><p>  рдЬреИрд╕рд╛ рдХрд┐ рд╣рдордиреЗ рдЕрднреА рджреЗрдЦрд╛ рд╣реИ, рдХрд╛рд░реНрдЯреНрд░рд┐рдЬ рд╡рд░реНрддрдорд╛рди рдкреНрд░рддрд┐рдХреГрддрд┐ рдХреЗ рдиреЗрддрд╛ рдХреЛ рдЯреЛрдкреЛрд▓реЙрдЬреА рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓рдиреЗ рдХрд╛ рдФрдЪрд┐рддреНрдп рдирд╣реАрдВ рд░рдЦрддрд╛ рд╣реИред  рдпрд╣ рдХрд╛рдлреА рддрд╛рд░реНрдХрд┐рдХ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдкреНрд░рддрд┐рдХреГрддрд┐ рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рд╣реИ, рдПрдХ рдиреЗрддрд╛ рдХреЗ рдмрд╣рд┐рд╖реНрдХрд╛рд░ рд╕реЗ рдбреЗрдЯрд╛ рд╣рд╛рдирд┐ рд╣реЛрдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИред  рд╣рдореЗрдВ рдПрдХ рдФрд░ рдиреЗрддрд╛ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдФрд░ рдЙрд╕рдХреЗ рдмрд╛рдж рд╣реА рдЙрджрд╛рд╣рд░рдг рдХреЛ рдЫреЛрдбрд╝ рджреЗрдВред  рднреВрдорд┐рдХрд╛ рдкрд╣рд▓реЗ рдирдП рдкреНрд░рддрд┐рдХреГрдд рд╡рд┐рдиреНрдпрд╛рд╕ рдХреЛ рд▓рд╛рдЧреВ рдХрд░реЗрдЧреА рдФрд░ рдлрд┐рд░ рдЕрдкрд╡рд╛рдж рд╕реЗ рдирд┐рдкрдЯреЗрдЧреАред  рдЗрд╕рд▓рд┐рдП, рд╣рдо <code>failover_priority</code> рдмрджрд▓рддреЗ рд╣реИрдВ рдФрд░ рдкреНрд▓реЗрдмреБрдХ рдХреЛ рдлрд┐рд░ рд╕реЗ рдЪрд▓рд╛рддреЗ рд╣реИрдВ: </p><br><pre> <code class="plaintext hljs">--- all: vars: ... hosts: ... children: ... replicaset_storage_2: vars: # replicaset configuration ... failover_priority: - storage-2 # &lt;== ...</code> </pre> <br><pre> <code class="bash hljs">$ ansible-playbook -i hosts.yml playbook.yml \ --<span class="hljs-built_in"><span class="hljs-built_in">limit</span></span> replicaset_storage_2 \ --tags cartridge-replicasets</code> </pre> <br><p>  Voila, <code>storage-2-replica</code> рдЙрджрд╛рд╣рд░рдг рдЯреЛрдкреЛрд▓реЙрдЬреА рд╕реЗ рдЧрд╛рдпрдм рд╣реЛ рдЧрдпрд╛ рд╣реИ! </p><br><p><img src="https://habrastorage.org/webt/tl/ao/ue/tlaoue_hclprc1i6tdjuil5efyk.png"></p><br><p>  рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЙрджрд╛рд╣рд░рдг рдирд┐рд░реНрд╡рд╛рд╕рди рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЕрдВрддрд┐рдо рдФрд░ рдЕрдкрд░рд┐рд╡рд░реНрддрдиреАрдп рд╣реИред  рдЯреЛрдкреЛрд▓реЙрдЬреА рд╕реЗ рдЙрджрд╛рд╣рд░рдг рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдорд╛рд░реА ansible рднреВрдорд┐рдХрд╛ рд╕рд┐рд╕реНрдЯрдордб рд╕реЗрд╡рд╛ рдХреЛ рд░реЛрдХ рджреЗрдЧреА рдФрд░ рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдХреА рд╕рднреА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд╣рдЯрд╛ рджреЗрдЧреАред </p><br><p><img src="https://habrastorage.org/webt/_7/bp/nx/_7bpnxxuydmfmddneontw1nxexi.png"></p><br><p>  рдпрджрд┐ рдЖрдк рдЕрдЪрд╛рдирдХ рдЕрдкрдирд╛ рджрд┐рдорд╛рдЧ рдмрджрд▓рддреЗ рд╣реИрдВ рдФрд░ рдпрд╣ рдирд┐рд░реНрдгрдп рд▓реЗрддреЗ рд╣реИрдВ рдХрд┐ <code>storage-2</code> рдкреНрд░рддрд┐рдХреГрддрд┐рдпреЛрдВ рдХреЛ рдЕрднреА рднреА рджреВрд╕рд░реЗ рдЙрджрд╛рд╣рд░рдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рддреЛ рдЖрдк рдЗрд╕реЗ рдкреБрдирд░реНрд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдирд╣реАрдВ рд╣реЛрдВрдЧреЗред  рдХрд╛рд░рддреВрд╕ рдЙрди рд╕рднреА рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЗ рдпреВрдпреВрдЖрдИрдбреА рдХреЛ рдпрд╛рдж рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдЯреЛрдкреЛрд▓реЙрдЬреА рдХреЛ рдЫреЛрдбрд╝ рдЪреБрдХреЗ рд╣реИрдВ рдФрд░ рдирд┐рд░реНрд╡рд╛рд╕рди рдХреЛ рд╡рд╛рдкрд╕ рд▓реМрдЯрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрдВрдЧреЗред  рдЖрдк рдПрдХ рд╣реА рдирд╛рдо рдФрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЗ рд╕рд╛рде рдПрдХ рдирдпрд╛ рдЙрджрд╛рд╣рд░рдг рдЙрдард╛ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЗрд╕рдореЗрдВ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдПрдХ рдЕрд▓рдЧ рдпреВрдпреВрдЖрдИрдбреА рд╣реЛрдЧрд╛, рдЗрд╕рд▓рд┐рдП рдХрд╛рд░реНрдЯреНрд░рд┐рдЬ рдЗрд╕реЗ рд╢рд╛рдорд┐рд▓ рд╣реЛрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред </p><br><h2 id="udalenie-replikaseta">  рдкреНрд░рддрд┐рдХреГрддрд┐рдпрд╛рдВ рдирд┐рдХрд╛рд▓рдирд╛ </h2><br><p>  рд╣рдордиреЗ рдкрд╣рд▓реЗ рд╣реА рдкрддрд╛ рд▓рдЧрд╛ рд▓рд┐рдпрд╛ рд╣реИ рдХрд┐ рд╣рдореЗрдВ рд░реЗрдкреНрд▓рд┐рдХрд╛рд╕реЗрдЯ рдХреЗ рдиреЗрддрд╛ рдХреЛ рдирд┐рд╖реНрдХрд╛рд╕рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреА рдЬрд╛рдПрдЧреАред  рд▓реЗрдХрд┐рди рдХреНрдпрд╛ рд╣реЛрдЧрд╛ рдЕрдЧрд░ рд╣рдо <code>storage-2</code> рдкреНрд░рддрд┐рдХреГрддрд┐ рдХреЛ рд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ рд╣рдЯрд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ?  рдмреЗрд╢рдХ, рдПрдХ рд░рд╛рд╕реНрддрд╛ рд╣реИред </p><br><p>  рдбреЗрдЯрд╛ рди рдЦреЛрдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдкрд╣рд▓реЗ рд╕рднреА рдмрд╛рд▓реНрдЯреА рдХреЛ <code>storage-1</code> рдЯреНрд░рд╛рдВрд╕рдлрд░ рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдЗрд╕рдХреЗ рд▓рд┐рдП рд╣рдордиреЗ <code>storage-2</code> рдкреНрд░рддрд┐рдХреГрддрд┐ рдХрд╛ рд╡рдЬрди <code>0</code> : </p><br><pre> <code class="plaintext hljs">--- all: vars: ... hosts: ... children: ... replicaset_storage_2: vars: # replicaset configuration replicaset_alias: storage-2 weight: 0 # &lt;== ... ...</code> </pre> <br><p>  рдЯреЛрдкреЛрд▓реЙрдЬреА рдкреНрд░рдмрдВрдзрди рд▓реЙрдиреНрдЪ рдХрд░реЗрдВ: </p><br><pre> <code class="bash hljs">$ ansible-playbook -i hosts.yml playbook.yml \ --<span class="hljs-built_in"><span class="hljs-built_in">limit</span></span> replicaset_storage_2 \ --tags cartridge-replicasets</code> </pre> <br><p>  рд╡реЗрдм UI <a href="http://localhost:8181/admin/cluster/dashboard">http</a> рдЦреЛрд▓реЗрдВ <a href="http://localhost:8181/admin/cluster/dashboard">: // localhost: 8181 / admin / рдХреНрд▓рд╕реНрдЯрд░ / рдбреИрд╢рдмреЛрд░реНрдб</a> рдФрд░ рдирд┐рд░реАрдХреНрд╖рдг рдХрд░реЗрдВ рдХрд┐ рд╕рднреА рдмрд╛рд▓реНрдЯрд┐рдпрд╛рдБ <code>storage-1</code> рдореЗрдВ рдХреИрд╕реЗ рдмрд╣рддреА рд╣реИрдВ: <code>storage-1</code> </p><br><p><img src="https://habrastorage.org/webt/nk/mo/fq/nkmofqnvvoccqfqkyz1myryu4-s.png"></p><br><p>  рд╣рдордиреЗ <code>storage-2</code> рд▓реАрдбрд░ рдХреЛ рдирд┐рд╖реНрдХрд╛рд╕рд┐рдд рдЭрдВрдбреЗ рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдФрд░ рдЗрд╕ рдкреНрд░рддрд┐рдХреГрддрд┐ рдХреЛ рдЕрд▓рд╡рд┐рджрд╛ рдХрд╣рд╛: </p><br><pre> <code class="plaintext hljs">--- all: vars: ... hosts: ... storage-2: config: advertise_uri: '172.19.0.3:3303' http_port: 8184 expelled: true # &lt;== ...</code> </pre> <br><pre> <code class="bash hljs">$ ansible-playbook -i hosts.yml playbook.yml \ --tags cartridge-replicasets</code> </pre> <br><p>  рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЗрд╕ рдмрд╛рд░ рд╣рдордиреЗ <code>limit</code> рд╡рд┐рдХрд▓реНрдк рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдирд╣реАрдВ рдХрд┐рдпрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдХрдо рд╕реЗ рдХрдо рдПрдХ рдЙрджрд╛рд╣рд░рдг рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рд╣рдордиреЗ рдкреНрд▓реЗрдмреБрдХ рд▓реЙрдиреНрдЪ рдХрд┐рдпрд╛ рдерд╛, рдХреЛ <code>expelled</code> рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред </p><br><p>  рдЗрд╕рд▓рд┐рдП рд╣рдо рдореВрд▓ рдЯреЛрдкреЛрд▓реЙрдЬреА рдореЗрдВ рд▓реМрдЯ рдЖрдП: </p><br><p><img src="https://habrastorage.org/webt/70/zo/vq/70zovqqaeiph6v1bjoenzl_hn1w.png"></p><br><h2 id="avtorizaciya">  рдкреНрд░рд╛рдзрд┐рдХрд░рдг </h2><br><p>  рдореИрдВ рдкреНрд░рддрд┐рдХреГрддрд┐ рд╕реЗрдЯ рдХреЗ рдкреНрд░рдмрдВрдзрди рд╕реЗ рдзреНрдпрд╛рди рд╣рдЯрд╛рдиреЗ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реЛрдЪрдиреЗ рдХрд╛ рдкреНрд░рд╕реНрддрд╛рд╡ рдХрд░рддрд╛ рд╣реВрдВред  рдЕрдм рдХреЛрдИ рднреА рдЕрдирдзрд┐рдХреГрдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╡реЗрдм UI рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреНрд▓рд╕реНрдЯрд░ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░ рд╕рдХрддрд╛ рд╣реИред  рд╕рд╣рдордд рд╣реВрдБ, рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИред </p><br><p>  рдХрд╛рд░рддреВрд╕ рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдореЙрдбреНрдпреВрд▓ рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдПрд▓рдбреАрдПрдкреА (рдпрд╛ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЬреЛ рдХреБрдЫ рднреА рд╣реИ), рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдФрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рддрдХ рдЙрдирдХреА рдкрд╣реБрдВрдЪ рдХреЛ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддреЗ рд╣реИрдВред  рд▓реЗрдХрд┐рди рд╣рдо рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ, рдЬреЛ рдХрд╛рд░рддреВрд╕ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред  рдпрд╣ рдореЙрдбреНрдпреВрд▓ рдЖрдкрдХреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд╕рд╛рде рдмреБрдирд┐рдпрд╛рджреА рд╕рдВрдЪрд╛рд▓рди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ (рд╣рдЯрд╛рдПрдВ, рдЬреЛрдбрд╝реЗрдВ, рд╕рдВрдкрд╛рджрд┐рдд рдХрд░реЗрдВ) рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рд╕рддреНрдпрд╛рдкрди рдлрд╝рдВрдХреНрд╢рди рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИред <br>  рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╣рдорд╛рд░реА рдЖрдиреБрд╖рдВрдЧрд┐рдХ рднреВрдорд┐рдХрд╛ рдХреЛ рдЗрди рд╕рднреА рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдмреИрдХрдПрдВрдб рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </p><br><p>  рдЗрд╕рд▓рд┐рдП, рд╣рдо рд╕рд┐рджреНрдзрд╛рдВрдд рд╕реЗ рдЕрднреНрдпрд╛рд╕ рдХреЗ рд▓рд┐рдП рдкрд╛рд╕ рд╣реЛрддреЗ рд╣реИрдВред  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЛ рдЕрдирд┐рд╡рд╛рд░реНрдп рдХрд░реЗрдВ, рд╕рддреНрд░ рдкреИрд░рд╛рдореАрдЯрд░ рд╕реЗрдЯ рдХрд░реЗрдВ рдФрд░ рдПрдХ рдирдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЬреЛрдбрд╝реЗрдВ: </p><br><pre> <code class="plaintext hljs">--- all: vars: ... # authorization cartridge_auth: # &lt;== enabled: true # enable authorization cookie_max_age: 1000 cookie_renew_age: 100 users: # cartridge users to set up - username: dokshina password: cartridge-rullez fullname: Elizaveta Dokshina email: dokshina@example.com # deleted: true # uncomment to delete user ...</code> </pre> <br><p>  рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдкреНрд░рдмрдВрдзрди <code>cartridge-config</code> рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд╣рд┐рд╕реНрд╕реЗ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╣рдо рдЗрд╕ рдЯреИрдЧ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддреЗ рд╣реИрдВ: </p><br><pre> <code class="bash hljs">$ ansible-playbook -i hosts.yml playbook.yml \ --tags cartridge-config</code> </pre> <br><p>  <a href="http://localhost:8181/admin/cluster/dashboard">Http: // localhost рдкрд░: 8181 / рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ / рдХреНрд▓рд╕реНрдЯрд░ / рдбреИрд╢рдмреЛрд░реНрдб рдПрдХ</a> рдЖрд╢реНрдЪрд░реНрдп рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░ рд░рд╣рд╛ рд╣реИ: </p><br><p><img src="https://habrastorage.org/webt/a2/t8/pq/a2t8pqil4sxnosey38i-baf3q1k.png"></p><br><p>  рдЖрдк рд╣рдорд╛рд░реЗ рдирдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ <code>username</code> рдФрд░ <code>password</code> рд╕рд╛рде рд▓реЙрдЧ рдЗрди рдХрд░ рд╕рдХрддреЗ <code>password</code> рдпрд╛ <code>admin</code> - рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЙрдЧ рдЗрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдЙрд╕рдХрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдХреНрд▓рд╕реНрдЯрд░ рдХреБрдХреА рд╣реИ, рд╣рдордиреЗ рдЪрд░ <code>cartridge_cluster_cookie</code> рдореЗрдВ рдпрд╣ рдорд╛рди рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рд╣реИ (рдпрд╣ <code>app-default-cookie</code> , рдЖрдк рдЭрд╛рдВрдХ рдирд╣реАрдВ рд╕рдХрддреЗ рд╣реИрдВ)ред </p><br><p>  рдПрдХ рд╕рдлрд▓ рд▓реЙрдЧрд┐рди рдХреЗ рдмрд╛рдж, рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <code>Users</code> рдЯреИрдм рдЦреЛрд▓реЗрдВ рдХрд┐ рд╕рдм рдХреБрдЫ рдареАрдХ рд╣реЛ рдЧрдпрд╛ рд╣реИ: </p><br><p><img src="https://habrastorage.org/webt/af/h_/9o/afh_9ofcv7htwplfgomnxejosxo.png"></p><br><p>  рдирдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдФрд░ рдЙрдирдХреА рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд╕рд╛рде рдкреНрд░рдпреЛрдЧ рдХрд░реЗрдВред  рдХрд┐рд╕реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, <code>deleted: true</code> рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░реЗрдВ <code>deleted: true</code> рдЙрд╕рдХреЗ рд▓рд┐рдП <code>deleted: true</code> рдзреНрд╡рдЬред  <code>email</code> рдФрд░ <code>fullname</code> рдореВрд▓реНрдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд╛рд░рддреВрд╕ рджреНрд╡рд╛рд░рд╛ рдХрд┐рд╕реА рднреА рддрд░рд╣ рд╕реЗ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЖрдк рдЙрдиреНрд╣реЗрдВ рд╕реБрд╡рд┐рдзрд╛ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </p><br><h2 id="konfiguraciya-prilozheniya">  рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди </h2><br><p>  рдЖрдЗрдП рдпрд╛рдж рдХрд░реЗрдВ рдХрд┐ рдпрд╣ рд╕рдм рдХреИрд╕реЗ рд╢реБрд░реВ рд╣реБрдЖред </p><br><p>  рд╣рдордиреЗ рдПрдХ рдЫреЛрдЯрд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рддреИрдирд╛рдд рдХрд┐рдпрд╛ рд╣реИ рдЬреЛ рдЧреНрд░рд╛рд╣рдХреЛрдВ рдФрд░ рдЙрдирдХреЗ рдмреИрдВрдХ рдЦрд╛рддреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдбреЗрдЯрд╛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИред  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдкрдХреЛ рдпрд╛рдж рд╣реИ, рдЗрд╕ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА 2 рднреВрдорд┐рдХрд╛рдПрдБ рд╣реИрдВ: <code>api</code> рдФрд░ <code>storage</code> ред  <code>storage</code> рднреВрдорд┐рдХрд╛ рдбреЗрдЯрд╛ рд╕рдВрдЧреНрд░рд╣рдг рдХреЛ рд╕рдВрднрд╛рд▓рддреА рд╣реИ рдФрд░ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд <code>vshard-storage</code> рднреВрдорд┐рдХрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП <code>vshard-storage</code> ред  рджреВрд╕рд░реА рднреВрдорд┐рдХрд╛, <code>api</code> , рдбреЗрдЯрд╛ рдкреНрд░рдмрдВрдзрди рдХреЗ рд▓рд┐рдП рдПрдХ рдПрдкреАрдЖрдИ рдХреЗ рд╕рд╛рде рдПрдХ HTTP рд╕рд░реНрд╡рд░ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддреА рд╣реИ, рдФрд░ рдЗрд╕рдХреЗ рдЕрдВрджрд░ рдПрдХ рдФрд░ рдорд╛рдирдХ рднреВрдорд┐рдХрд╛, <code>vshard-router</code> рдЬреБрдбрд╝рд╛ рд╣реБрдЖ рд╣реИ, рдЬреЛ <code>vshard-router</code> рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИред </p><br><p>  рддреЛ, рд╣рдо рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдПрдкреАрдЖрдИ рдХреЗ рд▓рд┐рдП рдкрд╣рд▓рд╛ рдЕрдиреБрд░реЛрдз рдХрд░рддреЗ рд╣реИрдВред  рдПрдХ рдирдпрд╛ рдЧреНрд░рд╛рд╣рдХ рдЬреЛрдбрд╝реЗрдВ: </p><br><pre> <code class="bash hljs">$ curl -X POST -H <span class="hljs-string"><span class="hljs-string">"Content-Type: application/json"</span></span> \ -d <span class="hljs-string"><span class="hljs-string">'{"customer_id":1, "name":"Elizaveta", "accounts":[{"account_id": 1}]}'</span></span> \ http://localhost:8182/storage/customers/create</code> </pre> <br><p>  рдЬрд╡рд╛рдм рдореЗрдВ, рд╣рдореЗрдВ рдРрд╕рд╛ рдХреБрдЫ рдорд┐рд▓рддрд╛ рд╣реИ: </p><br><pre> <code class="bash hljs">{<span class="hljs-string"><span class="hljs-string">"info"</span></span>:<span class="hljs-string"><span class="hljs-string">"Successfully created"</span></span>}</code> </pre> <br><p>  рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпреВрдЖрд░рдПрд▓ рдореЗрдВ рд╣рдордиреЗ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдкреЛрд░реНрдЯ <code>app-1</code> , <code>8082</code> рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЗрд╕ рдПрдкреАрдЖрдИ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИред </p><br><p>  рдЕрдм рдЕрдкрдиреЗ рдирдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд╕рдВрддреБрд▓рди рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рддреЗ рд╣реИрдВ: </p><br><pre> <code class="bash hljs">$ curl -X POST -H <span class="hljs-string"><span class="hljs-string">"Content-Type: application/json"</span></span> \ -d <span class="hljs-string"><span class="hljs-string">"{\"account_id\": 1, \"amount\": \"1000\"}"</span></span> \ http://localhost:8182/storage/customers/1/update_balance</code> </pre> <br><p>  рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рд╣рдо рдЕрджреНрдпрддрди рд╕рдВрддреБрд▓рди рджреЗрдЦрддреЗ рд╣реИрдВ: </p><br><pre> <code class="bash hljs">{<span class="hljs-string"><span class="hljs-string">"balance"</span></span>:<span class="hljs-string"><span class="hljs-string">"1000.00"</span></span>}</code> </pre> <br><p>  рдорд╣рд╛рди, рд╕рдм рдХреБрдЫ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ!  рдПрдкреАрдЖрдИ рдХреЛ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдХрд╛рд░реНрдЯреНрд░рд┐рдЬ рдбреЗрдЯрд╛ рд╢рд╛рд░реНрдкрд┐рдВрдЧ рдореЗрдВ рд▓рдЧрд╛ рд╣реБрдЖ рд╣реИ, рд╣рдордиреЗ рдкрд╣рд▓реЗ рд╣реА рдЖрдкрд╛рддрдХрд╛рд▓реАрди рдорд╛рдорд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдлреЗрд▓рдУрд╡рд░ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рддрдп рдХрд░ рд▓реА рд╣реИ рдФрд░ рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдЕрдзрд┐рдХреГрдд рдкреНрд░рд╛рдзрд┐рдХрд░рдг рднреАред  рдпрд╣ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЛ рдХрд░рдиреЗ рдХрд╛ рд╕рдордп рд╣реИред </p><br><p>  рд╡рд░реНрддрдорд╛рди рдХреНрд▓рд╕реНрдЯрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╡рд┐рддрд░рд┐рдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИред  рдкреНрд░рддреНрдпреЗрдХ рдЙрджрд╛рд╣рд░рдг рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рдХреА рдПрдХ рдкреНрд░рддрд┐ рд░рдЦрддрд╛ рд╣реИ, рдФрд░ рдХрд╛рд░реНрдЯреНрд░рд┐рдЬ рдХреНрд▓рд╕реНрдЯрд░ рдХреЗ рд╕рднреА рдиреЛрдбреНрд╕ рдХреЗ рдмреАрдЪ рдЗрд╕рдХрд╛ рд╕рд┐рдВрдХреНрд░рдирд╛рдЗрдЬрд╝реЗрд╢рди рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИред  рд╣рдо рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╣рдорд╛рд░реЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рднреВрдорд┐рдХрд╛рдУрдВ рдХреЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдХрд╛рд░рддреВрд╕ рд╕рднреА рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ рдирдП рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЛ рд╡рд┐рддрд░рд┐рдд рдХрд░рдиреЗ рдХрд╛ рдзреНрдпрд╛рди рд░рдЦреЗрдЧрд╛ред </p><br><p>  рдЖрдЗрдП рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рдХреА рд╡рд░реНрддрдорд╛рди рд╕рд╛рдордЧреНрд░реА рдХреЛ рджреЗрдЦреЗрдВред  <code>Cofiguration files</code> рдЯреИрдм рдкрд░ рдЬрд╛рдПрдВ рдФрд░ <code>Download</code> рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ: </p><br><p><img src="https://habrastorage.org/webt/wx/xw/vc/wxxwvcdusefetrgyaxpnnrvxwya.png"></p><br><p>  рдбрд╛рдЙрдирд▓реЛрдб рдХреА рдЧрдИ config.yml <code>config.yml</code> рд╣рдо рдПрдХ рдЦрд╛рд▓реА рддрд╛рд▓рд┐рдХрд╛ рдкрд╛рддреЗ рд╣реИрдВред  рдХреЛрдИ рдЖрд╢реНрдЪрд░реНрдп рдирд╣реАрдВ, рдХреНрдпреЛрдВрдХрд┐ рд╣рдордиреЗ рдЕрднреА рддрдХ рдХреЛрдИ рдкреИрд░рд╛рдореАрдЯрд░ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдирд╣реАрдВ рдХрд┐рдпрд╛ рд╣реИ: </p><br><pre> <code class="plaintext hljs">--- [] ...</code> </pre> <br><p>  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рд╣рдорд╛рд░реЗ рдХреНрд▓рд╕реНрдЯрд░ рдХреА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ рдЦрд╛рд▓реА рдирд╣реАрдВ рд╣реИ, рдпрд╣ рд╡рд░реНрддрдорд╛рди рдЯреЛрдкреЛрд▓реЙрдЬреА, рдкреНрд░рд╛рдзрд┐рдХрд░рдг рд╕реЗрдЯрд┐рдВрдЧреНрд╕, рдФрд░ рд╕реЗрдЯрд┐рдВрдЧ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИред  рд▓реЗрдХрд┐рди рдХрд╛рд░реНрдЯреНрд░рд┐рдЬ рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рд╕рд╛рдЭрд╛ рдХрд░рдирд╛ рдЗрддрдирд╛ рдЖрд╕рд╛рди рдирд╣реАрдВ рд╣реЛрдЧрд╛, рдпрд╣ рдЖрдВрддрд░рд┐рдХ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рд╣реИ, рдФрд░ рдЗрд╕рд▓рд┐рдП рдЗрд╕реЗ рдЫрд┐рдкреЗ рд╣реБрдП рд╕рд┐рд╕реНрдЯрдо рдЕрдиреБрднрд╛рдЧреЛрдВ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рд╣рдо рд╕рдВрдкрд╛рджрд┐рдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗред </p><br><p>  рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рднреВрдорд┐рдХрд╛ рдПрдХ рдпрд╛ рдЕрдзрд┐рдХ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдЕрдиреБрднрд╛рдЧреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреА рд╣реИред  рдПрдХ рдирдпрд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рджреЛ рдЪрд░рдгреЛрдВ рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ: рдкрд╣рд▓рд╛, рд╕рднреА рднреВрдорд┐рдХрд╛рдПрдВ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рддреА рд╣реИрдВ рдХрд┐ рд╡реЗ рдирдП рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд╣реИрдВред  рдпрджрд┐ рдХреЛрдИ рдЖрдкрддреНрддрд┐ рдирд╣реАрдВ рд╣реИ, рддреЛ рдкрд░рд┐рд╡рд░реНрддрди рд▓рд╛рдЧреВ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдпрджрд┐ рдХреЛрдИ рдЗрд╕рдХреЗ рдЦрд┐рд▓рд╛рдл рд╣реИ, рддреЛ рдПрдХ рд░реЛрд▓рдмреИрдХ рд╣реЛрддрд╛ рд╣реИред </p><br><p>  рдЖрдЗрдП рд╣рдорд╛рд░реЗ рдЖрд╡реЗрджрди рдкрд░ рд╡рд╛рдкрд╕ рдЬрд╛рдПрдВред  <code>api</code> рднреВрдорд┐рдХрд╛ <code>max-balance</code> рдЕрдиреБрднрд╛рдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИ, рдЬрд╣рд╛рдВ рдПрдХ рдЧреНрд░рд╛рд╣рдХ рдЦрд╛рддреЗ рдкрд░ рдЕрдзрд┐рдХрддрдо рд╕реНрд╡реАрдХрд╛рд░реНрдп рд╕рдВрддреБрд▓рди рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЖрдЗрдП рдЗрд╕ рдЕрдиреБрднрд╛рдЧ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВ, рд▓реЗрдХрд┐рди, рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ, рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдирд╣реАрдВ, рдмрд▓реНрдХрд┐ рд╣рдорд╛рд░реА Ansible рднреВрдорд┐рдХрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдПред </p><br><p>  рддреЛ, рдЕрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди (рдпрд╛ рдмрд▓реНрдХрд┐, рдЗрд╕рдХрд╛ рдПрдХ рд╣рд┐рд╕реНрд╕рд╛ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдЙрдкрд▓рдмреНрдз рд╣реИ) рдПрдХ рдЦрд╛рд▓реА рддрд╛рд▓рд┐рдХрд╛ рд╣реИред  рдЗрд╕рдореЗрдВ <code>100000</code> рдорд╛рди рдХреЗ рд╕рд╛рде рдПрдХ <code>max-balance</code> рдЕрдиреБрднрд╛рдЧ рдЬреЛрдбрд╝реЗрдВред  рд╣рдо рдЪрд░ <code>cartridge_app_config</code> рдХреЛ рдЕрдкрдиреА рдЗрдиреНрд╡реЗрдВрдЯреНрд░реА рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд▓рд┐рдЦрддреЗ рд╣реИрдВ: </p><br><pre> <code class="plaintext hljs">--- all: vars: ... # cluster-wide config cartridge_app_config: # &lt;== max-balance: # section name body: 1000000 # section body # deleted: true # uncomment to delete section max-balance ...</code> </pre> <br><p>  рд╣рдордиреЗ рдЕрдиреБрднрд╛рдЧ рдирд╛рдо, <code>max-balance</code> рдФрд░ рдЗрд╕рдХреА рд╕рд╛рдордЧреНрд░реА, <code>body</code> рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ <code>body</code> ред  рдПрдХ рдЕрдиреБрднрд╛рдЧ рдХреА рд╕рд╛рдордЧреНрд░реА рди рдХреЗрд╡рд▓ рдПрдХ рд╕рдВрдЦреНрдпрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ, рдпрд╣ рдПрдХ рддрд╛рд▓рд┐рдХрд╛ рдпрд╛ рдПрдХ рдкрдВрдХреНрддрд┐ рднреА рд╣реЛ рд╕рдХрддреА рд╣реИ рдЬреЛ рдЗрд╕ рдмрд╛рдд рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИ рдХрд┐ рднреВрдорд┐рдХрд╛ рдХреИрд╕реЗ рд▓рд┐рдЦреА рдЬрд╛рддреА рд╣реИ рдФрд░ рдЖрдк рдХрд┐рд╕ рдкреНрд░рдХрд╛рд░ рдХрд╛ рдореВрд▓реНрдп рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред </p><br><p>  рд╣рдо рд▓реЙрдиреНрдЪ рдХрд░рддреЗ рд╣реИрдВ: </p><br><pre> <code class="bash hljs">$ ansible-playbook -i hosts.yml playbook.yml \ --tags cartridge-config</code> </pre> <br><p>  рдФрд░ рд╣рдо рдЬрд╛рдБрдЪрддреЗ рд╣реИрдВ рдХрд┐ рдЕрдзрд┐рдХрддрдо рд╕реНрд╡реАрдХрд╛рд░реНрдп рд╕рдВрддреБрд▓рди рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдмрджрд▓ рдЧрдпрд╛ рд╣реИ: </p><br><pre> <code class="bash hljs">$ curl -X POST -H <span class="hljs-string"><span class="hljs-string">"Content-Type: application/json"</span></span> \ -d <span class="hljs-string"><span class="hljs-string">"{\"account_id\": 1, \"amount\": \"1000001\"}"</span></span> \ http://localhost:8182/storage/customers/1/update_balance</code> </pre> <br><p>  рдЬрд╡рд╛рдм рдореЗрдВ, рд╣рдореЗрдВ рдПрдХ рддреНрд░реБрдЯрд┐ рдорд┐рд▓рддреА рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ рд╣рдо рдЪрд╛рд╣рддреЗ рдереЗ: </p><br><pre> <code class="bash hljs">{<span class="hljs-string"><span class="hljs-string">"info"</span></span>:<span class="hljs-string"><span class="hljs-string">"Error"</span></span>,<span class="hljs-string"><span class="hljs-string">"error"</span></span>:<span class="hljs-string"><span class="hljs-string">"Maximum is 1000000"</span></span>}</code> </pre> <br><p>  рдЖрдк рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ рдЯреИрдм рдкрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ рдХреЛ рдлрд┐рд░ рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рд╣реЛ рд╕рдХреЗ рдХрд┐ рдПрдХ рдирдпрд╛ рдЦрдВрдб рд╡рд╣рд╛рдВ рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИ: </p><br><pre> <code class="plaintext hljs">--- max-balance: 1000000 ...</code> </pre> <br><p>  рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЗрдВ рдирдП рдЕрдиреБрднрд╛рдЧреЛрдВ рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ, рдЙрдирдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдмрджрд▓реЗрдВ рдпрд╛ рдЙрдиреНрд╣реЗрдВ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╣рдЯрд╛ рджреЗрдВ (рдЗрд╕рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ <code>deleted: true</code> рдЬрд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ <code>deleted: true</code> рдЕрдиреБрднрд╛рдЧ рдореЗрдВ <code>deleted: true</code> рдзреНрд╡рдЬ)ред </p><br><p>  рдЖрдк рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЯрд╛рд░реЗрдВрдЯреВрд▓ рдХрд╛рд░реНрдЯреНрд░рд┐рдЬ <a href="https://www.tarantool.io/ru/rocks/cartridge/1.0/modules/cartridge.clusterwide-config/">рдбреЙрдХреНрдпреВрдореЗрдВрдЯреЗрд╢рди</a> рдореЗрдВ рднреВрдорд┐рдХрд╛рдУрдВ рдореЗрдВ рд╡рд┐рддрд░рд┐рдд рдХреЙрдиреНрдлрд┐рдЧрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВред </p><br><p>  рдЬрдм рдЖрдк рдЙрдирдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░ рд░рд╣реЗ рд╣реЛрдВ рддрдм <code>vagrant halt</code> рдХреЛ рдмрдВрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <code>vagrant halt</code> рдХреЛ рдмреБрд▓рд╛рдирд╛ рдпрд╛рдж рд░рдЦреЗрдВред </p><br><h2 id="v-zaklyuchenie">  рдирд┐рд╖реНрдХрд░реНрд╖ рдореЗрдВ </h2><br><p>  рдкрд┐рдЫрд▓реА рдмрд╛рд░, рд╣рдордиреЗ рд╕реАрдЦрд╛ рдХрд┐ рдХреИрд╕реЗ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдПрдиреНрд╕рд┐рдмрд▓ рднреВрдорд┐рдХрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рддрд░рд┐рдд рдЯрд╛рд░реЗрдВрдЯреВрд▓ рдХрд╛рд░реНрдЯреНрд░рд┐рдЬ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рддреИрдирд╛рдд рдХрд┐рдпрд╛ рдЬрд╛рдПред  рдЖрдЬ рд╣рдордиреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд┐рдпрд╛, рдФрд░ рдЖрд╡реЗрджрди рдХреЗ рдЯреЛрдкреЛрд▓реЙрдЬреА, рд╢рд╛рд░реНрдбрд┐рдВрдЧ, рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдФрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЗ рдкреНрд░рдмрдВрдзрди рдореЗрдВ рднреА рдорд╣рд╛рд░рдд рд╣рд╛рд╕рд┐рд▓ рдХреАред </p><br><p>  рд╡рд╣рд╛рдВ рди рд░реБрдХреЗрдВ, рдПрдВрд╕реЗрдмрд▓ рдкреНрд▓реЗрдмреБрдХ рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_best_practices.html">рдЕрд▓рдЧ-рдЕрд▓рдЧ рджреГрд╖реНрдЯрд┐рдХреЛрдг</a> рд╕реАрдЦреЗрдВ рдФрд░ рдЕрдзрд┐рдХрддрдо рдЖрд░рд╛рдо рдХреЗ рд╕рд╛рде рдЕрдкрдиреЗ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред </p><br><p>  рдпрджрд┐ рдЖрдкрдХреЗ рд▓рд┐рдП рдХреБрдЫ рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ рдпрд╛ рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рд╣рдорд╛рд░реА рд╕реБрдпреЛрдЧреНрдп рднреВрдорд┐рдХрд╛ рдХреЛ рдмреЗрд╣рддрд░ рдмрдирд╛рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рдЪрд╛рд░ рд╣реИрдВ, рддреЛ <a href="https://github.com/tarantool/ansible-cartridge/issues/new">рдЯрд┐рдХрдЯ</a> рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрд╡рддрдВрддреНрд░ рдорд╣рд╕реВрд╕ рдХрд░реЗрдВред  рд╣рдо рд╣рдореЗрд╢рд╛ рдЖрдкрдХреА рд╕рдорд╕реНрдпрд╛ рдХреЗ рд╕рдорд╛рдзрд╛рди рдореЗрдВ рдорджрдж рдХрд░реЗрдВрдЧреЗ рдФрд░ рд╣рдо рджрд┐рд▓рдЪрд╕реНрдк рдкреНрд░рд╕реНрддрд╛рд╡реЛрдВ рдХреЗ рд▓рд┐рдП рдЦреБрд╢ рд╣реЛрдВрдЧреЗ! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi484192/">https://habr.com/ru/post/hi484192/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi484178/index.html">рдЧреНрд░рд╣ рдкреГрдереНрд╡реА рдХреЗ рд▓рд┐рдП рдмреБрджреНрдзрд┐рдорд╛рди рдИрдерд░рдиреЗрдЯ рд╕реНрд╡рд┐рдЪ</a></li>
<li><a href="../hi484180/index.html">рд░реЛрд╕реНрдЯреЗрд▓рдХреЙрдо рд╡рд░реНрдЪреБрдЕрд▓ рдкреАрдмреАрдПрдХреНрд╕: рдПрдкреАрдЖрдИ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреНрдпрд╛ рдФрд░ рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ</a></li>
<li><a href="../hi484182/index.html">рдПрдХреНрд╕рдиреЛрдмреЛрдЯреНрд╕: рдореЗрдВрдврдХ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рд╕реЗ рдЬреАрд╡рд┐рдд рдиреИрдиреЛрд░реЛрдмреЛрдЯреНрд╕</a></li>
<li><a href="../hi484186/index.html">LDAP - "рдкреНрд░рдорд╛рдгреАрдХрд░рдг" рдПрдХ рдПрдВрдЯреАрдкреИрдЯрд░реНрди рд╣реИ</a></li>
<li><a href="../hi484188/index.html">рдбреЗрдЯрд╛рдмреЗрд╕ рдбрд┐рдЬрд╛рдЗрди рдорд╛рдирдХ</a></li>
<li><a href="../hi484194/index.html">рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдиреЗ рдмрдЪреНрдЪреЛрдВ рдореЗрдВ рдЕрдиреБрд╡рд╛рдж рдХрд┐рдпрд╛</a></li>
<li><a href="../hi484196/index.html">рдПрдХ рдорд╛рдЗрдХреНрд░реЛрдлреЛрди рдпрд╛ рдЖрд╡рд╛рдЬ рдЯрд┐рдкреНрдкрдгрд┐рдпреЛрдВ рд╕реЗ рдЬреЗрдПрд╕ рдзреНрд╡рдирд┐ рд░рд┐рдХреЙрд░реНрдбрд┐рдВрдЧ</a></li>
<li><a href="../hi484198/index.html">рд╕рд┐рдХреНрдХреЗ рдХрд╛ рдЙрд▓реНрдЯрд╛ рд╣рд┐рд╕реНрд╕рд╛: рдЬреЛ рдЯреЗрд╕реНрд▓рд╛ рдХреЗ рд╢реЗрдпрд░реЛрдВ рдХреА рд╡реГрджреНрдзрд┐ рдкрд░ рдЬреАрддрд╛ рдФрд░ рд╣рд╛рд░ рдЧрдпрд╛</a></li>
<li><a href="../hi484200/index.html">рдЙрдиреНрд╣реЗрдВ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд▓рдХреНрд╖реНрдп рдХреИрд╕реЗ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдВ</a></li>
<li><a href="../hi484202/index.html">рдкреНрд░реЛрдЧреНрд░рд╛рдо рд╕реЛрд░реНрд╕ рдХреЛрдб рдХреЗ рд╕реНрдЯреЗрдЯрд┐рдХ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдореЗрдВ рдорд╢реАрди рд▓рд░реНрдирд┐рдВрдЧ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>