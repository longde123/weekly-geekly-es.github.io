<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üñêüèª üë©‚Äç‚öïÔ∏è ‚ôäÔ∏è Interaktion mit dem Server √ºber die API in iOS unter Swift 3. Teil 2 üèø üë®‚Äçüî¨ ‚ò™Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dieser Artikel ist eine Fortsetzung des Artikels Interaktion mit dem Server √ºber eine API in iOS unter Swift 3. Teil 1 und Aktualisierung eines alten ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Interaktion mit dem Server √ºber die API in iOS unter Swift 3. Teil 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415615/">  Dieser Artikel ist eine Fortsetzung des Artikels <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Interaktion mit dem Server √ºber eine API in iOS unter Swift 3. Teil 1</a> und Aktualisierung eines <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">alten Artikels</a> , der in Objective-C unter Swift 3 geschrieben wurde. <br><br><h2>  Kurze Theorie </h2><br><h3>  GET Anfrage </h3><br>  GET ist die einfachste HTTP-Anforderungsmethode und wird vom Browser zum Laden von Webseiten verwendet.  Es wird verwendet, um Inhalte anzufordern, die sich unter einer bestimmten URL befinden.  Der Inhalt kann beispielsweise eine Webseite, ein Bild oder eine Audiodatei sein.  Konventionell sind GET-Anforderungen schreibgesch√ºtzt und sollten gem√§√ü dem W3C-Standard nicht in Vorg√§ngen verwendet werden, die die Serverseite √§ndern.  Beispielsweise verwenden wir keine GET-Anforderung, um ein Formular oder ein Foto zu senden, da diese Vorg√§nge einige √Ñnderungen auf der Serverseite erfordern (in diesen F√§llen wird POST verwendet). <br><br><h3>  POST-Anfrage </h3><br>  POST sendet Daten zur weiteren Verarbeitung an die URL.  Parameter werden im Anforderungshauptteil im selben Format wie GET enthalten.  Wenn wir beispielsweise ein Formular mit zwei Feldern, einem Namen und einem Alter, ver√∂ffentlichen m√∂chten, senden wir im Anfragetext etwas √Ñhnliches wie name = Martin &amp; age = 29. <br><br>  Diese Methode zum Senden von Parametern wird h√§ufig auf Webseiten verwendet.  Die beliebtesten F√§lle sind Formen.  Wenn wir das Formular auf der Website ausf√ºllen und auf Senden klicken, lautet die Anfrage h√∂chstwahrscheinlich POST. <br><a name="habracut"></a><br>  In unserer Anwendung verwenden wir POST, um Witze zu bewerten.  Wir senden Stimmen (oder +1 oder -1) an den Remote-Server. <br><br>  POST-Anforderungsdaten k√∂nnen in verschiedenen Formaten strukturiert werden.  Parameter werden normalerweise gem√§√ü den Formulierungs-URL-Codierungsstandards (gem√§√ü dem W3C-HTML-Standard) formatiert.  Dies ist das Standardformat und wird in vielen Browsern h√§ufig verwendet.  Unsere Methode akzeptiert das Dictionary-W√∂rterbuch als Argument, aber wir k√∂nnen das Dictionary-W√∂rterbuch nicht √ºber die HTTP-Verbindung senden, da es sich um einen internen Swift-Typ handelt.  Um √ºber eine HTTP-Verbindung weiterzuleiten, m√ºssen wir eine erkennbare Darstellung des W√∂rterbuchs erstellen.  Es ist wie mit einem Ausl√§nder zu kommunizieren.  Wir √ºbersetzen unsere Botschaft in eine universelle Sprache und sie √ºbersetzt von einer universellen Sprache in ihre Muttersprache.  Die universelle Sprache in HTTP ist der W3C-Standard, unsere Sprache ist Swift, die Empf√§ngersprache ist uns unbekannt. <br><br>  Der W3C-Standard definiert Regeln, die definieren, was eine erkennbare Darstellung f√ºr jeden Fall bedeutet.  In unserem Fall m√ºssen wir die Parameter nach dem formular-url-codierten Teil des Standards pr√§sentieren (z. B. param1 = var1 &amp; param2 = var2). <br><br><h3>  Webview </h3><br>  Mit Programmiersprachen-Tools k√∂nnen wir Anforderungen an einen Remote-Server senden.  Dies tun Browser, bevor sie eine Webseite anzeigen.  Der Unterschied besteht nur im Inhalt der Antwort.  Webseiten werden mit dem HTML-Standard formatiert, der eine Reihe von Regeln f√ºr die grafische Definition verschiedener Markup-Tags definiert.  Diese Regeln scheinen einfach zu sein, aber das Anzeigen einer ganzen Seite nach dem W3C-Standard ist eine schwierige Aufgabe.  Gl√ºcklicherweise verf√ºgt iOS √ºber eine integrierte UIWebView-Komponente, die die bekannte WebKit-Engine verwendet, HTML / CSS / JavaScript interpretiert und ganze Webseiten in einem UIView anzeigt. <br><br>  Es gibt mehrere F√§lle, in denen wir den Navigationsfluss steuern m√∂chten.  Zum Beispiel m√∂chten wir wissen, wann bestimmte Inhalte oder eine bestimmte URL geladen werden. <br><br>  Oder wir implementieren einen sicheren Browser f√ºr Kinder. Wir m√∂chten den Benutzer daran hindern, Seiten zu laden, die bestimmten Kriterien wie Sex oder Drogen unterliegen.  F√ºr alle diese Arten der Anpassung erstellen wir eine Instanz einer Klasse, die das UIWebViewDelegate-Protokoll als UIWebView-Delegat implementiert.  Wir k√∂nnen die folgenden Methoden implementieren: <br><br><pre><code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">webView</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:shouldStartLoadWithRequest</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:navigationType</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">webViewDidStartLoad</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">webViewDidFinishLoad</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">webView</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:didFailLoadWithError</span></span>:</code> </pre> <br>  Mit der ersten Methode k√∂nnen wir den Navigationsfluss steuern, indem wir bestimmte Anforderungen zulassen oder blockieren.  Die anderen drei Methoden sind Informationsereignisse (Methodennamen geben einen guten √úberblick √ºber das Ereignis). <br><br><h2>  Durchf√ºhrung der Abstimmung per POST-Anfrage </h2><br>  Wir werden die <b>Dateien</b> <b>MainViewController.swift</b> und <b>HTTPCommunication.swift</b> hinzuf√ºgen und eine neue Datei <b>WebViewController.swift</b> erstellen, in der wir unsere webView definieren. <br><br>  Erstellen Sie zun√§chst eine neue WebViewController.swift-Datei und definieren Sie die WebViewController-Klasse darin: <br><br>  <b>WebViewController.swift</b> <br><br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> UIKit <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UIViewController { } extension WebViewController { }</span></span></span></span></code> </pre> <br>  Jetzt implementieren wir die Funktionalit√§t zum Erstellen von POST-Anforderungen in der Klasse, die f√ºr alle unsere HTTP-Operationen verantwortlich ist: HTTPCommunication-Klasse.  F√ºgen Sie dazu in HTTPCommunication.swift eine neue postURL (_: params: CompletionHandler :) -Methode hinzu, die der vorherigen RetrieveURL (_: CompletionHandler :) -Methode √§hnelt. <br><br>  <b>HTTPCommunication.swift</b> <br><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HTTPCommunication</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NSObject</span></span></span><span class="hljs-class"> </span></span>{ ‚Ä¶ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">retrieveURL</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> url: URL, completionHandler: @escaping </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params">(Data)</span></span></span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span>)) { ‚Ä¶ } <span class="hljs-comment"><span class="hljs-comment">// </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment">    } // end of class HTTPCommunication</span></span></code> </pre><br>  Methodencode <br><br><pre> <code class="hljs powershell">func postURL(_ url: URL, params: <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">String</span></span></span><span class="hljs-function">: </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">Int</span></span></span><span class="hljs-function">], </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">completionHandler</span></span></span></span>: @escaping ((<span class="hljs-keyword"><span class="hljs-keyword">Data</span></span>) -&gt; Void)) { // (K.<span class="hljs-number"><span class="hljs-number">1</span></span>) self.completionHandler = completionHandler // (K.<span class="hljs-number"><span class="hljs-number">2</span></span>) func postBody(params: <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">String</span></span></span><span class="hljs-function">: </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">Int</span></span></span><span class="hljs-function">]) -&gt; </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">Data</span></span></span></span>? { // (K.<span class="hljs-number"><span class="hljs-number">3</span></span>) var paramsArr: <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">String</span></span></span><span class="hljs-function">] = [] </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">for</span></span></span></span> (key, value) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> params { paramsArr.append(<span class="hljs-string"><span class="hljs-string">"\(key)=\(value)"</span></span>) } let postBodyString: String = paramsArr.joined(separator: <span class="hljs-string"><span class="hljs-string">"&amp;"</span></span>) let postBodyData: <span class="hljs-keyword"><span class="hljs-keyword">Data</span></span>? = postBodyString.data(using: .utf8) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> postBodyData } var request: URLRequest = URLRequest(url: url) // (K.<span class="hljs-number"><span class="hljs-number">4</span></span>) request.httpMethod = <span class="hljs-string"><span class="hljs-string">"POST"</span></span> request.httpBody = postBody(params: params) let session: URLSession = URLSession(configuration: .default, delegate: self, delegateQueue: nil) // (K.<span class="hljs-number"><span class="hljs-number">5</span></span>) let task: URLSessionDownloadTask = session.downloadTask(with: request) task.resume() }</code> </pre> <br>  (K.1) Mit Closure arbeiten wir au√üerhalb dieser Funktion, daher bezeichnen wir sie mit @escaping. <br>  (K.2) Wir speichern den √ºbergebenen Abschluss in der Eigenschaft completeHandler. <br>  (K.3) Wir schreiben eine Methode, die das W√∂rterbuch der √ºbergebenen Parameter in eine Zeichenfolgenform konvertiert und diese Zeichenfolge dann in utf8-Codierung in den Datentyp codiert. <br>  (K.4) Wir erstellen eine Anfrage mit der √ºbergebenen URL und konfigurieren sie: Legen Sie POST als Methode fest und legen Sie unsere Parameter vom Datentyp mit utf8 als Anfragetext fest. <br>  (K.5) Erstellen Sie abschlie√üend eine Sitzung mit einer Standardkonfiguration und einem Delegaten wie uns.  Und wir erstellen eine Aufgabe, um das Ergebnis dieser Anforderung in den tempor√§ren Speicher zu laden.  Am Ende die Aufgabe auftauen. <br><br>  F√ºgen wir nun die erforderliche Schnittstelle zu MainViewController.swift hinzu.  F√ºgen Sie zwei Schaltfl√§chen f√ºr die Abstimmung von voteUp und voteDown hinzu, wodurch die Bewertung des aktuellen Witzes erh√∂ht bzw. verringert wird.  Wir f√ºgen auch die Schaltfl√§che "Chuck Who?" Hinzu, die wir im Abschnitt √ºber die Webansicht mit Funktionen f√ºllen werden. <br><br>  F√ºgen Sie in MainViewController.swift den Initialisierungscode voteUpButton, voteDownButton und chuckWhoButton ein. <br><br>  <b>MainViewController.swift</b> <br><br><pre> <code class="hljs swift"><span class="hljs-built_in"><span class="hljs-built_in">lazy</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> jokeLabel: <span class="hljs-type"><span class="hljs-type">UILabel!</span></span> = ‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> jokeID: <span class="hljs-type"><span class="hljs-type">Int!</span></span> <span class="hljs-built_in"><span class="hljs-built_in">lazy</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> activityView: <span class="hljs-type"><span class="hljs-type">UIActivityIndicatorView!</span></span> = ‚Ä¶ <span class="hljs-comment"><span class="hljs-comment">//</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment">    lazy var stackView: UIStackView! = ‚Ä¶</span></span></code> </pre><br>  Initialisierungscode f√ºr Schaltfl√§chen <br><pre> <code class="hljs pgsql">lazy var voteUpButton: UIButton! = { // (L<span class="hljs-number"><span class="hljs-number">.1</span></span>) let button: UIButton = UIButton(<span class="hljs-keyword"><span class="hljs-keyword">type</span></span>: .<span class="hljs-keyword"><span class="hljs-keyword">system</span></span>) // (L<span class="hljs-number"><span class="hljs-number">.2</span></span>) button.setTitle("Vote Up", <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: .normal) button.sizeToFit() button.addTarget(self, action: #selector(self.voteUp), <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: .touchUpInside) // (L<span class="hljs-number"><span class="hljs-number">.3</span></span>) self.<span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.addSubview(button) // (L<span class="hljs-number"><span class="hljs-number">.4</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> button // (L<span class="hljs-number"><span class="hljs-number">.5</span></span>) }() lazy var voteDownButton: UIButton! = { let button: UIButton = UIButton(<span class="hljs-keyword"><span class="hljs-keyword">type</span></span>: .<span class="hljs-keyword"><span class="hljs-keyword">system</span></span>) button.setTitle("Vote Down", <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: .normal) button.sizeToFit() button.addTarget(self, action: #selector(self.voteDown), <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: .touchUpInside) self.<span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.addSubview(button) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> button }() lazy var chuckWhoButton: UIButton! = { let button: UIButton = UIButton(<span class="hljs-keyword"><span class="hljs-keyword">type</span></span>: .<span class="hljs-keyword"><span class="hljs-keyword">system</span></span>) button.setTitle("Chuck Who?", <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: .normal) button.sizeToFit() button.addTarget(self, action: #selector(self.chuckWho), <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: .touchUpInside) self.<span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.addSubview(button) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> button }()</code> </pre> <br>  Der Initialisierungscode f√ºr alle drei Schaltfl√§chen ist gleich. <br><br>  (L.1) Wir deklarieren eine faule Variable und initialisieren sie mit einem Abschluss. <br>  (L.2) Innerhalb des Abschlusses definieren wir eine lokale Variable f√ºr die Schaltfl√§che, einen Systemtyp, geben den Namen und die Gr√∂√üe an. <br>  (L.3) Wir ordnen der Taste die entsprechende Aktion zu, wenn sie gedr√ºckt wird. <br>  (L.4) Zur Ansichtshierarchie hinzuf√ºgen. <br>  (L.5) Und wir weisen diese lokale Variable unserer faulen Variablen zu. <br><br>  F√ºgen Sie als N√§chstes in MainViewController.swift den Methodencode f√ºr die Schaltfl√§chen ein <br><br>  <b>MainViewController.swift</b> <br><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIViewController</span></span></span><span class="hljs-class"> </span></span>{ ‚Ä¶ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">retrieveRandomJokes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { ‚Ä¶ } <span class="hljs-comment"><span class="hljs-comment">// </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment">    } // end of class MainViewController</span></span></code> </pre><br>  Methodencode f√ºr Schaltfl√§chen <br><pre> <code class="hljs powershell">func voteUp() { let http: HTTPCommunication = HTTPCommunication() // (M.<span class="hljs-number"><span class="hljs-number">1</span></span>) let params: [<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>] = [<span class="hljs-string"><span class="hljs-string">"joke_id"</span></span>: <span class="hljs-type"><span class="hljs-type">self.jokeID</span></span>, <span class="hljs-string"><span class="hljs-string">"vote"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>] // (M.<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> let url = URL(string: <span class="hljs-string"><span class="hljs-string">"http://example.com/rater/vote"</span></span>) { // (M.<span class="hljs-number"><span class="hljs-number">3</span></span>) http.postURL(url, params: params) { (<span class="hljs-keyword"><span class="hljs-keyword">data</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> // (M.<span class="hljs-number"><span class="hljs-number">4</span></span>) print(<span class="hljs-string"><span class="hljs-string">"\(data). Voted Up"</span></span>) } } } func voteDown() { let http: HTTPCommunication = HTTPCommunication() let params: [<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>] = [<span class="hljs-string"><span class="hljs-string">"joke_id"</span></span>: <span class="hljs-type"><span class="hljs-type">self.jokeID</span></span>, <span class="hljs-string"><span class="hljs-string">"vote"</span></span>: -<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> let url = URL(string: <span class="hljs-string"><span class="hljs-string">"http://example.com/rater/vote"</span></span>) { http.postURL(url, params: params) { (<span class="hljs-keyword"><span class="hljs-keyword">data</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> print(<span class="hljs-string"><span class="hljs-string">"\(data). Voted Down"</span></span>) } } } func chuckWho() { }</code> </pre> <br>  Der Code der Methoden zum Auf- und Abstimmen ist der gleiche. <br><br>  (M.1) Erstellen Sie ein Klassenobjekt f√ºr die Kommunikation mit dem Server. <br>  (M.2) Wir erstellen ein W√∂rterbuch mit Parametern, das die ID des Witzes enth√§lt, f√ºr den wir stimmen, und der tats√§chliche Wert der Abstimmung betr√§gt +1 oder -1. <br>  (M.3) Als N√§chstes erhalten wir die URL sicher aus der Adressleiste unserer Trainingsdom√§ne <code>http://example.com/rater/vote.</code> <br>  (M.4) Und wir senden per POST eine Anfrage nach URL unserer Parameter.  Drucken Sie auf der Konsole eine Zeile aus, die den Abschluss der Anforderung angibt. <br><br>  Als N√§chstes schreiben wir in MainViewController.swift den Code der configStackView-Methode unter Ber√ºcksichtigung der an der Benutzeroberfl√§che vorgenommenen √Ñnderungen neu. <br><br>  <b>MainViewController.swift</b> <br><br><pre> <code class="hljs powershell">func configStackView() -&gt; UIStackView { let innerStackView: UIStackView = UIStackView(arrangedSubviews: [<span class="hljs-type"><span class="hljs-type">self.voteUpButton</span></span>, <span class="hljs-type"><span class="hljs-type">self.voteDownButton</span></span>]) // (N.<span class="hljs-number"><span class="hljs-number">1</span></span>) innerStackView.axis = .horizontal // (N.<span class="hljs-number"><span class="hljs-number">2</span></span>) innerStackView.distribution = .fillEqually let mainStackView: UIStackView = UIStackView(arrangedSubviews: [<span class="hljs-type"><span class="hljs-type">self.jokeLabel</span></span>, <span class="hljs-type"><span class="hljs-type">innerStackView</span></span>, <span class="hljs-type"><span class="hljs-type">self.chuckWhoButton</span></span>]) // (N.<span class="hljs-number"><span class="hljs-number">3</span></span>) mainStackView.spacing = <span class="hljs-number"><span class="hljs-number">50</span></span> // (N.<span class="hljs-number"><span class="hljs-number">4</span></span>) mainStackView.axis = .vertical mainStackView.distribution = .fillEqually self.view.addSubview(mainStackView) // (N.<span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> mainStackView }</code> </pre> <br>  (N.1) Erstellen Sie eine innerStackView mit zwei Schaltfl√§chen zum Abstimmen. <br>  (N.2) Wir legen die vertikale Achse frei;  Die Verteilung ist die gleiche. <br>  (N.3) F√ºgen Sie in der Haupt-MainStackView die innereStackView und die Schaltfl√§che √ºber Chuck Norris zum Etikett aus dem letzten Teil hinzu. <br>  (N.4) Konfigurieren Sie mainStackView. <br>  (N.5) F√ºgen Sie mainStackView zur Ansichtshierarchie hinzu. <br><br>  Wir starten unsere Anwendung und sehen die Schnittstelle wie in Abb.  1 <br><br><img src="https://habrastorage.org/webt/wj/nv/ur/wjnvurcfmrxazb2lhifxl689zqa.png"><br>  <i>Abb. 1 Die Oberfl√§che unserer Anwendung mit zus√§tzlichen Schaltfl√§chen zum Abstimmen</i> <br><br>  Wir √ºberpr√ºfen, ob bei der Abstimmung f√ºr oder gegen einen Witz die folgenden Meldungen in der Konsole angezeigt werden: <br><br> <code>345 bytes. Voted Up</code> <br> <br>  oder <br><br> <code>345 bytes. Voted Down</code> <br> <br>  Dies zeigt eine erfolgreich abgeschlossene POST-Anforderung an den Server an. <br><br>  Wir haben eine Scherzanwendung mit der icndb API und dem GET HTTP Verb geschrieben.  Wir konnten diese Witze auf UIView zeigen und jeder Witz kann gesch√§tzt werden.  Diese Aktionen senden eine POST-Anforderung an den Remote-Server, wodurch unsere Sch√§tzung gespeichert werden soll. <br><br><h2>  Verwenden von WebViews zum Anzeigen von Webseiten </h2><br>  Wir werden eine Webansicht hinzuf√ºgen, um die Wikipedia-Seite √ºber Chuck Norris anzuzeigen.  Sie wird auf Knopfdruck verwirrt. <br><br>  Schreiben Sie in die Datei WebViewController.swift den folgenden Funktionsstub: <br><br>  <b>WebViewController.swift</b> <br><br><pre> <code class="hljs haskell"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> UIKit class WebViewController: UIViewController { lazy var webView: UIWebView = { // (<span class="hljs-type"><span class="hljs-type">O</span></span>.1) self.configWebView() }() lazy var toolbar: UIToolbar = { // (<span class="hljs-type"><span class="hljs-type">O</span></span>.2) self.configToolbar() }() override func viewDidLoad() { super.viewDidLoad() } func back() { // (<span class="hljs-type"><span class="hljs-type">O</span></span>.3) self.webView.goBack() } func forward() { self.webView.goForward() } } extension WebViewController { func configWebView() -&gt; UIWebView { // (<span class="hljs-type"><span class="hljs-type">O</span></span>.4) } func configToolbar() -&gt; UIToolbar { // (<span class="hljs-type"><span class="hljs-type">O</span></span>.5) } func configConstraints() { // (<span class="hljs-type"><span class="hljs-type">O</span></span>.6) } }</code> </pre> <br>  (O.1) Wir erstellen Lazy-Variablen f√ºr webView <br>  (O.2) und Symbolleiste. <br>  (O.3) Wir erstellen Methoden zur Navigation in der Geschichte des Besuchs von Links vor und zur√ºck. <br>  (O.4) Wir f√ºgen der Erweiterung webView-Initialisierungsmethoden hinzu <br>  (O.5) und ToolBar <br>  (O.6) und Einschr√§nkungen f√ºr die Schnittstelle. <br><br>  Jetzt malen wir den Code jeder Funktion: <br><br><pre> <code class="hljs swift"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">configWebView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UIWebView</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> webView: <span class="hljs-type"><span class="hljs-type">UIWebView</span></span> = <span class="hljs-type"><span class="hljs-type">UIWebView</span></span>() <span class="hljs-comment"><span class="hljs-comment">// (P.1) self.view.addSubview(webView) return webView }</span></span></code> </pre> <br>  (P.1) Wir initialisieren die Webansicht und f√ºgen die Ansicht der Hierarchie hinzu. <br><br><pre> <code class="hljs smalltalk">func configToolbar() -&gt; <span class="hljs-type"><span class="hljs-type">UIToolbar</span></span> { let toolbar: <span class="hljs-type"><span class="hljs-type">UIToolbar</span></span> = <span class="hljs-type"><span class="hljs-type">UIToolbar</span></span>(frame: <span class="hljs-type"><span class="hljs-type">CGRect</span></span>.zero) // (<span class="hljs-type"><span class="hljs-type">Q</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>) let backButton: <span class="hljs-type"><span class="hljs-type">UIBarButtonItem</span></span> = <span class="hljs-type"><span class="hljs-type">UIBarButtonItem</span></span>(title: <span class="hljs-comment"><span class="hljs-comment">"&lt;"</span></span>, style: .plain, target: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, action: <span class="hljs-symbol"><span class="hljs-symbol">#selector</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.back)) // (<span class="hljs-type"><span class="hljs-type">Q</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>) let forwardButton: <span class="hljs-type"><span class="hljs-type">UIBarButtonItem</span></span> = <span class="hljs-type"><span class="hljs-type">UIBarButtonItem</span></span>(title: <span class="hljs-comment"><span class="hljs-comment">"&gt;"</span></span>, style: .plain, target: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, action: <span class="hljs-symbol"><span class="hljs-symbol">#selector</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.forward)) toolbar.setItems([backButton, forwardButton], animated: <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) // (<span class="hljs-type"><span class="hljs-type">Q</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span>) toolbar.backgroundColor = <span class="hljs-type"><span class="hljs-type">UIColor</span></span>.lightGray // (<span class="hljs-type"><span class="hljs-type">Q</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.view.addSubview(toolbar) return toolbar }</code> </pre> <br>  (Q.1) Erstellen Sie eine Symbolleiste mit einem Nullrahmen. <br>  (Q.2) Wir erstellen zwei Schaltfl√§chen zum Navigieren im Verlauf des Besuchs von Links.  Mit den Namen "&lt;" und "&gt;" und den Aktionen, die an die entsprechende Methode in webView angeh√§ngt sind. <br>  (Q.3) F√ºgen Sie diese Schaltfl√§chen zur Symbolleiste hinzu. <br>  (Q.4) Stellen Sie die Hintergrundfarbe wie die Navigationsleiste hellgrau ein.  Und f√ºgen Sie die Ansicht der Hierarchie hinzu. <br><br><pre> <code class="hljs powershell">func configConstraints() { self.webView.translatesAutoresizingMaskIntoConstraints = false // (R.<span class="hljs-number"><span class="hljs-number">1</span></span>) NSLayoutConstraint.activate([ // (<span class="hljs-type"><span class="hljs-type">R.2</span></span>) <span class="hljs-type"><span class="hljs-type">self.webView.topAnchor.constraint</span></span>(<span class="hljs-type"><span class="hljs-type">equalTo</span></span>: <span class="hljs-type"><span class="hljs-type">self.topLayoutGuide.topAnchor</span></span>), <span class="hljs-type"><span class="hljs-type">self.webView.leadingAnchor.constraint</span></span>(<span class="hljs-type"><span class="hljs-type">equalTo</span></span>: <span class="hljs-type"><span class="hljs-type">self.view.leadingAnchor</span></span>), <span class="hljs-type"><span class="hljs-type">self.webView.trailingAnchor.constraint</span></span>(<span class="hljs-type"><span class="hljs-type">equalTo</span></span>: <span class="hljs-type"><span class="hljs-type">self.view.trailingAnchor</span></span>), <span class="hljs-type"><span class="hljs-type">self.webView.bottomAnchor.constraint</span></span>(<span class="hljs-type"><span class="hljs-type">equalTo</span></span>: <span class="hljs-type"><span class="hljs-type">self.toolbar.topAnchor</span></span>) ]) self.toolbar.translatesAutoresizingMaskIntoConstraints = false NSLayoutConstraint.activate([ // (<span class="hljs-type"><span class="hljs-type">R.3</span></span>) <span class="hljs-type"><span class="hljs-type">self.toolbar.leadingAnchor.constraint</span></span>(<span class="hljs-type"><span class="hljs-type">equalTo</span></span>: <span class="hljs-type"><span class="hljs-type">self.view.leadingAnchor</span></span>), <span class="hljs-type"><span class="hljs-type">self.toolbar.trailingAnchor.constraint</span></span>(<span class="hljs-type"><span class="hljs-type">equalTo</span></span>: <span class="hljs-type"><span class="hljs-type">self.view.trailingAnchor</span></span>), <span class="hljs-type"><span class="hljs-type">self.toolbar.bottomAnchor.constraint</span></span>(<span class="hljs-type"><span class="hljs-type">equalTo</span></span>: <span class="hljs-type"><span class="hljs-type">self.view.bottomAnchor</span></span>), <span class="hljs-type"><span class="hljs-type">self.toolbar.heightAnchor.constraint</span></span>(<span class="hljs-type"><span class="hljs-type">equalToConstant</span></span>: <span class="hljs-number"><span class="hljs-number">44.0</span></span>) ]) }</code> </pre> <br>  (R.1) Deaktivieren Sie Autoresizing-Masken, damit sie nicht mit unseren Einschr√§nkungen in Konflikt stehen <br>  (R.2) Konfigurieren Sie f√ºr webView alle vier Seiten der Ansicht. <br>  (R.3) Konfigurieren Sie f√ºr die Symbolleiste drei Seiten der Ansicht mit Ausnahme der Oberseite, stellen Sie jedoch zus√§tzlich die H√∂he auf die Standardgr√∂√üe 44,0 ein. <br><br>  Schreiben Sie den Code ViewDidLoad () wie folgt neu: <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">viewDidLoad</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.viewDidLoad() <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.configConstraints() <span class="hljs-comment"><span class="hljs-comment">// (S.1) if let url = URL(string: "http://en.wikipedia.org/wiki/Chuck_Norris") { // (S.2) let request: URLRequest = URLRequest(url: url) // (S.3) self.webView.loadRequest(request) // (S.4) } }</span></span></code> </pre> <br>  (S.1) Rufen Sie die Einstellung von Einschr√§nkungen auf. <br>  (S.2) Holen Sie sich die URL sicher aus der Adressleiste der Wikipedia-Seite <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">en.wikipedia.org/wiki/Chuck_Norris</a> <br>  (S.3) Wir erstellen eine Anfrage von der URL. <br>  (S.4) Und wir f√ºhren die angegebene Anfrage in webView aus. <br><br>  Wir kehren zum MainViewController zur√ºck und f√ºllen ihn mit der Methode zum Aufrufen von Informationen √ºber Chuck Norris. <br><br>  <b>MainViewController.swift</b> <br><br><pre> <code class="hljs swift"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">chuckWho</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.navigationController?.show(<span class="hljs-type"><span class="hljs-type">WebViewController</span></span>(), sender: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) <span class="hljs-comment"><span class="hljs-comment">// (T.1) }</span></span></code> </pre> <br>  (T.1) Wenn Sie auf diese Schaltfl√§che im Navigationscontroller-Stapel klicken, f√ºgen Sie eine neue Instanz von webView ein. <br><br>  Abb.  2 zeigt, wie webView in unserer Anwendung aussieht. <br><br><img src="https://habrastorage.org/webt/cj/tv/-a/cjtv-a57shzmktsq3btfccu6hme.png"><br>  <i>Abb.</i>  <i>2. Die endg√ºltige Ansicht der von uns implementierten WebView</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de415615/">https://habr.com/ru/post/de415615/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de415599/index.html">Indien will auch Helium-3 bekommen</a></li>
<li><a href="../de415601/index.html">Kubernetes HA-Cluster mit Containerd. Oder gibt es ein Leben ohne Hafenarbeiter?</a></li>
<li><a href="../de415605/index.html">Wie wir die Kartenverarbeitung mit Exadata gespeichert haben</a></li>
<li><a href="../de415611/index.html">PKI: GCrypt- und KSBA-Bibliotheken als Alternative zu OpenSSL mit Unterst√ºtzung f√ºr die russische Kryptographie. Fortsetzung</a></li>
<li><a href="../de415613/index.html">Warum sollten Sie keine LED-Kronleuchter kaufen</a></li>
<li><a href="../de415617/index.html">Verwenden der InternetPCools-FPC-Bibliothek in Delphi</a></li>
<li><a href="../de415619/index.html">Apple und Samsung schlie√üen 7-j√§hrigen Patentkrieg ab</a></li>
<li><a href="../de415621/index.html">Bergbau√ºberwachungssystem</a></li>
<li><a href="../de415623/index.html">Die Dynamik des Vertikalfluges eines Flugzeugs ist leichter als Luft</a></li>
<li><a href="../de415625/index.html">Kubernetes: Webinar (4. Juli um 19:30 Uhr) und intensiv (3.-5. August)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>