<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙇🏻 🍟 👌 Prosesor X86 Rakitan Mikrokode di Belakang 👞 🤳🏾 🌙</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kami tidak mempercayai perangkat lunak untuk waktu yang lama, dan oleh karena itu kami melakukan audit, melakukan rekayasa balik, menjalankannya dalam...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Prosesor X86 Rakitan Mikrokode di Belakang</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/427757/"><p> Kami tidak mempercayai perangkat lunak untuk waktu yang lama, dan oleh karena itu kami melakukan audit, melakukan rekayasa balik, menjalankannya dalam mode langkah-demi-langkah, menjalankannya di kotak pasir.  Bagaimana dengan prosesor tempat perangkat lunak kami berjalan?  - Kami dengan buta dan sepenuh hati mempercayai sepotong kecil silikon ini.  Namun, perangkat keras modern memiliki masalah yang sama dengan perangkat lunak: fungsi rahasia tidak berdokumen, bug, kerentanan, malware, trojan, rootkit, backdoors. </p><br><p><img src="https://habrastorage.org/webt/ip/yi/6i/ipyi6itjefhde2aetsgvqabmbwo.jpeg"></p><br><p>  ISA (Instruction Set Architecture) x86 adalah salah satu "arsitektur set instruksi" yang paling lama berubah dalam sejarah.  Dimulai dengan desain 8086 yang dikembangkan pada tahun 1976, ISA terus mengalami perubahan dan pembaruan;  sambil mempertahankan kompatibilitas mundur dan dukungan untuk spesifikasi asli.  Lebih dari 40 tahun tumbuh, arsitektur ISA telah tumbuh dan terus tumbuh dengan banyak mode dan set instruksi baru, yang masing-masing menambahkan lapisan baru ke desain sebelumnya, yang sudah kelebihan beban.  Karena kebijakan kompatibilitas penuh, prosesor x86 modern bahkan berisi instruksi dan mode yang sudah sepenuhnya dilupakan.  Sebagai hasilnya, kami memiliki arsitektur prosesor, yang merupakan labirin rumit dari teknologi baru dan antik.  Lingkungan yang sangat kompleks - menyebabkan banyak masalah dengan keamanan siber prosesor.  Oleh karena itu, prosesor x86 tidak dapat mengklaim sebagai akar tepercaya infrastruktur cyber kritis. </p><a name="habracut"></a><br><h2 id="vy-vsyo-eschyo-doveryaete-svoemu-processoru">  Apakah Anda masih mempercayai prosesor Anda? </h2><br><p>  Keamanan program dan sistem operasi - didasarkan pada keamanan perangkat keras yang digunakan.  Sebagai aturan, pengembang perangkat lunak tidak memperhitungkan fakta bahwa perangkat keras tempat perangkat lunak mereka digunakan dapat tidak dipercaya, berbahaya.  Ketika perangkat keras berperilaku keliru (baik sengaja atau tidak), mekanisme keamanan perangkat lunak menjadi sama sekali tidak berharga.  Selama bertahun-tahun, berbagai model prosesor aman telah ditawarkan: Intel SGX, AMD Pacifica, dll. Meskipun demikian, keteraturan yang patut ditiru dengan informasi yang dipublikasikan tentang kegagalan kritis (dari yang baru-baru ini, misalnya Meltdown dan Specter) dan mendeteksi fungsi "debugging" yang tidak didokumentasikan - mengarah ke pemikiran bahwa keyakinan sepenuh hati kami pada prosesor tidak berdasar. </p><br><p>  Prosesor x86 modern adalah jalinan yang sangat rumit dan rumit dari teknologi terbaru dan antik.  8086 memiliki 29 ribu transistor, Pentium 3 juta, Broadwell 3,2 miliar, Cannonlake lebih dari 10 miliar. </p><br><p><img src="https://habrastorage.org/webt/tn/p-/_2/tnp-_2qkl0ubruapqvdv-57kcko.png"></p><br><p>  Dengan begitu banyak transistor, tidak mengherankan bahwa prosesor x86 modern penuh dengan instruksi tidak berdokumen dan kerentanan perangkat keras.  Di antara yang tidak terdokumentasi, yang ditemukan hampir secara tidak sengaja, instruksi: ICEBP (0xF1), LOADALL (0x0F07), apicall (0x0FFFF0) [1], yang memungkinkan prosesor tidak terkunci untuk akses tidak sah ke area memori yang dilindungi. </p><br><p>  Adapun banyak kerentanan perangkat keras prosesor (lihat dua gambar di bawah), mereka memungkinkan penyerang cyber untuk meningkatkan hak istimewa [3], mengekstrak kunci kriptografi [4], membuat instruksi assembler baru [2], mengubah fungsi instruksi assembler yang sudah ada [2] , pasang kait pada instruksi assembler [2], kendalikan "virtualisasi akselerasi perangkat keras" [7], campur tangan dalam "perhitungan kriptografi atom" [7], dan, akhirnya, manis, masuk ke "mode dewa":  ive diri hardware yang sah Intel ME backdoor (yang memungkinkan Anda untuk menerima akses remote bahkan komputer dimatikan). [8]  Dan semua ini - tanpa meninggalkan jejak digital. </p><br><p><img src="https://habrastorage.org/webt/8b/7r/hu/8b7rhuqyqipkayzqgoa-dvxximu.png"><br><img src="https://habrastorage.org/webt/v9/hi/pk/v9hipk3k6e1n8krpm22zz8j_0uk.png"></p><br><h2 id="sovremennye-processory--eto-bolshe-soft-chem-zhelezo">  Prosesor modern lebih banyak perangkat lunak daripada perangkat keras </h2><br><p>  Sebenarnya, prosesor modern bahkan tidak bisa disebut "perangkat keras" dalam arti penuh kata.  Karena fungsi mereka yang paling kritis (termasuk ISA) disediakan oleh flashing mikrokode.  Awalnya, mikrokode terutama bertanggung jawab untuk mengendalikan decoding dan eksekusi instruksi assembler kompleks: operasi floating-point, primitif MMX, line handler dengan awalan REP, dll.  Namun, seiring waktu, semakin banyak tanggung jawab yang diberikan pada mikrokode untuk memproses operasi di dalam prosesor.  Misalnya, ekstensi modern prosesor Intel, seperti AVX (Advanced Vector Extensions) dan VT-d (virtualisasi perangkat keras) diimplementasikan pada mikrokode. </p><br><p>  Selain itu, saat ini mikrokode bertanggung jawab, antara lain, untuk menjaga keadaan prosesor, untuk mengelola cache, dan juga untuk mengelola penghematan daya.  Untuk menghemat energi, mikrokode memiliki mekanisme interupsi yang memproses status daya: C-state (tingkat tidur hemat energi: dari state aktif ke sleep dalam) dan P-state (kombinasi tegangan dan frekuensi yang berbeda).  Jadi, misalnya, mikrokode bertanggung jawab untuk mengatur ulang cache L2 saat memasuki negara C4, serta saat keluar. </p><br><h2 id="zachem-proizvoditeli-processorov-polzuyutsya-mikrokodom">  Mengapa produsen prosesor menggunakan mikrokode? </h2><br><p>  Produsen prosesor x86 menggunakan mikrokode untuk mendekomposisi instruksi perakitan yang rumit (yang dapat mencapai 15 byte) menjadi rantai instruksi mikro sederhana, untuk menyederhanakan arsitektur perangkat keras dan memfasilitasi diagnostik.  Faktanya, mikrokode adalah interpreter antara arsitektur CISC eksternal (terlihat oleh pengguna) dan arsitektur RISC internal (perangkat keras). </p><br><p>  Jika kesalahan terdeteksi dalam arsitektur CISC (terutama di ISA), pabrikan menerbitkan pembaruan mikrokode yang dapat diunduh ke prosesor melalui BIOS / UEFI dari motherboard atau melalui sistem operasi (selama proses booting).  Berkat sistem pembaruan yang didasarkan pada mikrokode, produsen prosesor memberi diri mereka fleksibilitas dan pengurangan biaya - sembari memperbaiki kesalahan pada peralatan mereka.  Kesalahan sensasional dengan fdiv, yang sangat merobohkan prosesor Intel Pentium pada tahun 1994, membuat fakta bahwa kesalahan perangkat keras teknologi tinggi rentan seperti perangkat lunak membuatnya semakin jelas.  Kejadian ini telah membuat produsen lebih tertarik pada arsitektur prosesor berbasis mikrokode.  Oleh karena itu, Intel dan AMD mulai membangun prosesor mereka menggunakan teknologi mikrokode.  Intel - dimulai dengan Pentium Pro (P6), dirilis pada 1995.  AMD - dimulai dengan K7, dirilis pada tahun 1999. </p><br><h2 id="vsyo-taynoe-stanovitsya-yavnym">  Segalanya rahasia menjadi jelas </h2><br><p>  Terlepas dari kenyataan bahwa produsen prosesor berusaha menjaga arsitektur mikrokode dan mekanisme untuk memperbaruinya dalam kepercayaan yang paling ketat, musuh tidak tertidur.  Potongan-potongan informasi yang terfragmentasi (terutama dari paten, seperti AMD RISC86 [5]) dan pembalikan bijaksana dari pembaruan BIOS resmi (seperti halnya dengan K8 [6]), secara bertahap menjelaskan rahasia mikrokode (lihat, misalnya, pada gambar di bawah ini “ Mekanisme pembaruan mikrokode prosesor AMD ”).  Dan berkat evolusi konstan alat rekayasa terbalik (baik perangkat lunak dan perangkat keras) [2], teknik fuzzing yang menjanjikan [1] dan munculnya alat OpenSource seperti Microparse [9] dan Sandsifter [10] - penyerang cyber dapat mempelajari segala sesuatu tentang mikrokode yang diperlukan untuk harus menulis malware microcode di atasnya. </p><br><p><img src="https://habrastorage.org/webt/rp/ko/yc/rpkoycfyygkkxhvcyxe4poffqri.png"></p><br><p>  Jadi, misalnya, dalam [2] sebagai "Halo dunia!"  (langkah pertama untuk trojanizing the microcode) "micro hook" (program microcode yang memotong instruksi assembler) dikembangkan, yang menghitung berapa kali prosesor mengakses perintah div.  Microhook ini adalah injeksi ke handler dari instruksi assembler div. </p><br><p><img src="https://habrastorage.org/webt/rn/kv/os/rnkvos_2xlvug2sjpyxjkif2h5a.png"></p><br><p>  Ibid [2] menyajikan microhook yang lebih maju - yang duduk dengan tenang dalam instruksi assembler dari div ebx, tidak memberikan kehadiran, dan diaktifkan hanya ketika kondisi tertentu terpenuhi saat mengakses ebx div: register ebx berisi nilai B, dan register eax berisi nilai A. Saat diaktifkan, microhook ini meningkatkan nilai register eip (penunjuk instruksi saat ini) satu per satu.  Akibatnya, pelaksanaan program (yang memiliki keberanian untuk merujuk pada instruksi div ebx) berlanjut dengan offset: bukan dari byte pertama dari perintah yang mengikuti div ebx, tetapi dari byte kedua.  Jika nilai-nilai lain ditentukan dalam register eax dan ebx, maka div ebx berfungsi seperti biasa.  Apa nilai praktis dalam hal ini?  Sebagai contoh, untuk secara diam-diam mengaktifkan rangkaian instruksi assembler tersembunyi saat menggunakan teknik kebingungan dengan “instruksi yang tumpang tindih” [11]. </p><br><p><img src="https://habrastorage.org/webt/gx/af/w9/gxafw9lfzweuvhrirvuwf_qfbu0.png"></p><br><p>  Dua contoh ini menunjukkan bagaimana instruksi assembler yang sah dapat digunakan untuk menyembunyikan kode Trojan sewenang-wenang di dalamnya. </p><br><p>  Pada saat yang sama, seorang penyerang cyber dapat mengaktifkan muatan jahatnya - termasuk jarak jauh.  Misalnya, ketika kondisi yang diperlukan untuk aktivasi terpenuhi pada halaman web yang dikendalikan oleh penyerang.  Hal ini dimungkinkan berkat kompiler Just-in-Time (JIT) dan Ahead-of-Time (AOT) yang dibangun dalam browser web modern.  Kompiler ini memungkinkan Anda untuk memancarkan aliran instruksi assembler yang telah ditentukan sebelumnya untuk kode mesin - bahkan jika Anda menulis program secara eksklusif dalam JavaScript tingkat tinggi (lihat daftar terakhir, tepat di atas). </p><br><div class="spoiler">  <b class="spoiler_title">Daftar pustaka</b> <div class="spoiler_text"><ol><li>  <em>Christopher Domas</em> .  Melanggar ISA x86 // DEFCON 25.07.2017. </li><li>  <em>Philipp Koppe</em> .  Teknik Reverse x86 Mikrokode Prosesor // Proses dari Simposium Keamanan USENIX ke-26.  2017. hlm.  1163-1180. </li><li>  <em>Matthew Hicks</em> .  SPECS: Mekanisme Runtime Ringan untuk Melindungi Perangkat Lunak dari Bug Prosesor Keamanan-kritis // Proses Konferensi Internasional ke-28 tentang Dukungan Arsitektur untuk Bahasa Pemrograman dan Sistem Operasi (ASPLOS).  2015. hal.  517-529. </li><li>  <em>Adi Shamir</em> .  Serangan Bug // Prosiding konferensi Tahunan ke-28 tentang Kriptografi: Kemajuan dalam Kriptologi.  2008. hal.  221–240. </li><li>  <em>John Favor</em> .  Set Instruksi RISC86 // Paten AS 6336178. 2002. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Opteron Exposed: Rekayasa Balik Pembaruan Mikrokode AMD K8</a> .  2004 </li><li>  <em>Saming Chen</em> .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Analisis Keamanan</a> Mikrokode <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Prosesor x86</a> .2014. </li><li>  <em>Simpanse Catalin</em> .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Malware Menggunakan Fitur Intel CPU yang Tidak Jelas untuk Mencuri Data dan Menghindari Firewall</a> .  2017 </li><li>  <em>Daming Chen</em> .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Microparse: Microcode parser untuk prosesor AMD, Intel, dan VIA</a> // GitHub.  2014 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Sandsifter: Fuzzer prosesor x86</a> // GitHib.  2017 </li><li>  <em>Karev V.M.</em>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Cara menulis program assembler dengan instruksi yang tumpang tindih (teknik lain untuk mengaburkan kode byte)</a> // Habrahabr.  2018. URL: (Tanggal akses: 25 Oktober 2018). </li></ol></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id427757/">https://habr.com/ru/post/id427757/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id427745/index.html">Kiat & trik Kubernetes: akses ke situs dev</a></li>
<li><a href="../id427747/index.html">Siapa yang menabrak mobil tak berawak: Hasil percobaan Mesin Moral</a></li>
<li><a href="../id427749/index.html">Apple dan Samsung untuk pertama kalinya didenda karena memperlambat ponsel lama</a></li>
<li><a href="../id427751/index.html">Gagasan Sublime CudaText</a></li>
<li><a href="../id427755/index.html">Rilis baru GitLab 11.4 dengan tinjauan rekan atas permintaan penggabungan dan bendera fitur</a></li>
<li><a href="../id427759/index.html">Tentang solvabilitas masalah beltway dalam waktu polinomial</a></li>
<li><a href="../id427761/index.html">Implementasi algoritma k-means (k-means) menggunakan contoh bekerja dengan piksel</a></li>
<li><a href="../id427763/index.html">Kursus MIT "Keamanan Sistem Komputer". Kuliah 13: Protokol Jaringan, Bagian 1</a></li>
<li><a href="../id427767/index.html">Situasi: di Kanada mereka mengusulkan untuk memperkenalkan pajak streaming - kami sedang mendiskusikan apa masalahnya</a></li>
<li><a href="../id427771/index.html">Kursus MIT "Keamanan Sistem Komputer". Kuliah 13: Protokol Jaringan, Bagian 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>