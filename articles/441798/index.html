<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîº ‚òùüèæ üìû Escribir una aplicaci√≥n de Android en ensamblador üíΩ üñêüèΩ üöû</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Esta historia trata sobre un enfoque no est√°ndar para el desarrollo de aplicaciones de Android. Una cosa es instalar Android Studio y escribir "Hello,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Escribir una aplicaci√≥n de Android en ensamblador</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/skillbox/blog/441798/"><img src="https://habrastorage.org/getpro/habr/post_images/6c7/141/a4b/6c7141a4b2db319c5f4dcbd6f432bc81.jpg" alt="imagen"><br><br>  Esta historia trata sobre un enfoque no est√°ndar para el desarrollo de aplicaciones de Android.  Una cosa es instalar Android Studio y escribir "Hello, World" en Java o Kotlin.  Pero mostrar√© c√≥mo se puede realizar la misma tarea de manera diferente. <br><a name="habracut"></a><br><blockquote>  <b>Le recordamos:</b> <i>para todos los lectores de "Habr": un descuento de 10.000 rublos al registrarse en cualquier curso de Skillbox con el c√≥digo de promoci√≥n "Habr".</i> <br><br>  <b>Skillbox recomienda:</b> El curso educativo en l√≠nea <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Profession Java-developer"</a> . <br><br></blockquote><h3>  ¬øC√≥mo funciona mi tel√©fono inteligente con el sistema operativo Android? </h3><br>  Primero, un poco de historia.  Una tarde una amiga llamada Ariella me llam√≥.  Ella me pregunt√≥: "Escucha, ¬øc√≥mo funciona mi tel√©fono inteligente?  ¬øQu√© hay dentro?  ¬øC√≥mo la energ√≠a el√©ctrica y las unidades ordinarias y ceros hacen que todo funcione? <br><br>  Mi amiga no es una novata en desarrollo, cre√≥ varios proyectos en Arduino, que consist√≠an tanto en software como en hardware.  Tal vez por eso quer√≠a saber m√°s.  Logr√© responder con la ayuda del conocimiento obtenido en uno de los cursos de inform√°tica tomados en la universidad. <br><br>  Luego trabajamos un par de semanas juntas, ya que Ariella quer√≠a descubrir c√≥mo funcionan los ladrillos de la tecnolog√≠a electr√≥nica, es decir, los elementos semiconductores, incluidos los transistores.  Luego pasamos a un nivel superior: le mostr√© c√≥mo crear puertas l√≥gicas, por ejemplo, NAND (l√≥gico Y) m√°s NOR (l√≥gico OR) usando una combinaci√≥n espec√≠fica de transistores. <br><br>  Investigamos elementos l√≥gicos de diferentes tipos, los combinamos para realizar c√°lculos (por ejemplo, agregar dos n√∫meros binarios) y celdas de memoria (disparadores).  Cuando todo qued√≥ claro, comenzaron a desarrollar un procesador simple (imaginario), en el que hab√≠a dos registros de prop√≥sito general y dos instrucciones simples (agregar estos registros).  Incluso escribimos un programa simple que multiplica estos dos n√∫meros. <br><br>  Por cierto, si est√° interesado en este tema, lea las instrucciones para crear una computadora de 8 bits desde cero.  Explica casi todo, desde lo m√°s b√°sico.  ¬°Ojal√° lo hubiera le√≠do antes! <br><br><h3>  Hola android </h3><br>  Despu√©s de completar todas las etapas del estudio, me pareci√≥ que Ariella ten√≠a suficiente conocimiento para comprender c√≥mo funciona el procesador del tel√©fono inteligente.  Su tel√©fono inteligente es el Galaxy S6 Edge, cuya base es la arquitectura ARM (como, de hecho, con la mayor√≠a de los tel√©fonos inteligentes).  Decidimos escribir una aplicaci√≥n "Hello, World" para Android, pero en lenguaje ensamblador. <br><br><pre><code class="plaintext hljs">.text .globl _start _start: mov %r0, $1 // file descriptor number 1 (stdout) ldr %r1, =message mov %r2, $message_len mov %r7, $4 // syscall 4 (write) swi $0 mov %r0, $0 // exit status 0 (ok) mov %r7, $1 // syscall 1 (exit) swi $0 .data message: .ascii "Hello, World\n" message_len = . - message</code> </pre> <br>  Si nunca antes ha encontrado c√≥digo de ensamblador, este bloque puede asustarlo.  Pero est√° bien, analicemos el c√≥digo juntos. <br><br>  Entonces, nuestro programa consta de dos partes.  El primero es texto con instrucciones de c√≥digo de m√°quina, y el segundo son variables, l√≠neas y otra informaci√≥n (comenzando con la l√≠nea 15).  La secci√≥n .text generalmente es de solo lectura y .data tambi√©n se puede escribir. <br><br>  En la l√≠nea 2, definimos una funci√≥n global llamada _start.  Es el punto de entrada a la aplicaci√≥n.  El sistema operativo comienza a ejecutar el c√≥digo desde este punto.  La definici√≥n de la funci√≥n se declara en la l√≠nea 4. <br><br>  Adem√°s, la funci√≥n hace dos cosas m√°s.  En las l√≠neas 5‚Äì9, el mensaje se muestra en la pantalla; en las l√≠neas 11‚Äì13, el programa finaliza.  Incluso si elimina las l√≠neas 11‚Äì13, el programa mostrar√° nuestra l√≠nea "Hola, Mundo" y saldr√°.  Sin embargo, la salida no ser√° correcta, porque el programa terminar√° con un error.  Sin las l√≠neas 11‚Äì13, la aplicaci√≥n intentar√° ejecutar una instrucci√≥n no v√°lida. <br><br>  La impresi√≥n se muestra utilizando la funci√≥n del sistema "Llamada del sistema" del sistema operativo.  En la aplicaci√≥n, llamamos a la funci√≥n write ().  Lo indicamos cuando cargamos el valor 4 en el registro del procesador con el nombre r7 (l√≠nea 8).  A continuaci√≥n, se ejecuta la instrucci√≥n swi $ = 0 (l√≠nea 9), donde hay una transici√≥n directamente al kernel de Linux, que es la base de Android. <br><br>  En cuanto a los par√°metros para la llamada al sistema, se transmiten a trav√©s de otros registros.  Por ejemplo, r0 muestra el n√∫mero del descriptor de archivo que necesitamos imprimir.  Ponemos el valor 1 all√≠ (l√≠nea 5), ‚Äã‚Äãindicando salida est√°ndar (stdout), es decir, salida a la pantalla. <br><br>  r1 indica la direcci√≥n de memoria de los datos que queremos escribir, por lo que simplemente cargamos la direcci√≥n de la cadena "Hola, Mundo" (l√≠nea 6) en esta √°rea, y el registro r2 muestra cu√°ntos bytes queremos escribir.  En nuestro programa, est√° configurado en message_len (l√≠nea 7), calculado en la l√≠nea 18 usando una sintaxis especial: el s√≠mbolo de punto indica la direcci√≥n de memoria actual.  Por esta raz√≥n  - mensaje indica la direcci√≥n de memoria actual menos la direcci√≥n del mensaje.  Bueno, como declaramos message_len inmediatamente despu√©s del mensaje, todo esto se calcula como la longitud del mensaje. <br><br>  Si escribe el c√≥digo para las l√≠neas 5‚Äì9 usando C, obtendr√° lo siguiente: <br><br><pre> <code class="cs hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> message "Hello, World\n" write(1, message, strlen(message));</span></span></code> </pre> <br>  Cerrar el programa es un poco m√°s f√°cil.  Para hacer esto, simplemente registramos el c√≥digo de salida en el registro r0 (l√≠nea 11), despu√©s de lo cual agregamos el valor 1, que es el n√∫mero de la llamada a la funci√≥n del sistema exit (), a r7 (l√≠nea 12), luego llamamos nuevamente al n√∫cleo (l√≠nea 13). <br><br>  Puede encontrar una lista completa de las llamadas al sistema Android y sus n√∫meros en el c√≥digo <a href="">fuente del sistema operativo</a> .  Tambi√©n hay una implementaci√≥n de <a href="">write ()</a> y <a href="">exit ()</a> que llama a las funciones del sistema correspondientes. <br><br><h3>  Poniendo el programa juntos </h3><br>  Para compilar nuestro proyecto, necesitar√° Android NDK (Native Development Kit).  Contiene un conjunto de compiladores y herramientas de compilaci√≥n para la plataforma ARM.  Puede descargarlo desde el sitio oficial, instalarlo, por ejemplo, a trav√©s de Android Studio. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b0f/ad0/963/b0fad09631cb9904cc9288563b294db1.png"><br><br>  Despu√©s de instalar el NDK, necesitamos el archivo arm-linux-androideabi-as, este es el ensamblador para ARM.  Si descargaste a trav√©s de Android Studio, b√∫scalo en la carpeta del SDK de Android.  Por lo general, su ubicaci√≥n es <br><br>  <i>ndk-bundle \ toolchains \ arm-linux-androideabi-4.9 \ prebuilt \ windows-x86_64 \ bin.</i> <br><br>  Despu√©s de encontrar el ensamblador, guarde lo que est√° escrito en un archivo llamado hello.s, y luego ejecute el siguiente comando para convertirlo en c√≥digo de m√°quina: <br><br>  <i>arm-linux-androideabi-as -o hello.o hello.s</i> <br><br>  Esta operaci√≥n crea un archivo de objeto ELF llamado hello.o.  Para convertirlo a un archivo binario que pueda funcionar en su dispositivo, llame al vinculador: <br><br>  <i>arm-linux-androideabi-ld -o hola hola.o</i> <br><br>  Ahora tenemos un archivo de saludo que contiene un programa que est√° listo para usar. <br><br><h3>  Inicie la aplicaci√≥n en su dispositivo </h3><br>  Las aplicaciones de Android generalmente se distribuyen en formato .apk.  Este es un tipo especial de archivo comprimido que incluye clases Java (s√≠, puede escribir con C / C ++, pero Java debe ser el punto de entrada). <br><br>  Para evitar problemas al iniciar la aplicaci√≥n, se utiliz√≥ adb en el ejemplo, que nos permiti√≥ copiarlo en la carpeta temporal de nuestro dispositivo Android.  Despu√©s de eso, lanzamos el shell adb para iniciar la aplicaci√≥n y evaluar el resultado: <br><br>  <i>adb push hello / data / local / tmp / hello</i> <i><br></i>  <i>adb shell chmod + x / data / local / tmp / hello</i> <br><br>  Y finalmente, ejecute la aplicaci√≥n: <br><br>  <i>adb shell / data / local / tmp / hello</i> <br><br><h3>  Que escribes </h3><br>  Ahora tiene un entorno de trabajo similar al que ten√≠a Ariella.  Pas√≥ varios d√≠as estudiando el ensamblador ARM, luego se le ocurri√≥ un proyecto simple: este es el juego Sven Boom (una variaci√≥n de Fizz Buzz originario de Israel).  Los jugadores cuentan por turno y cada vez que el n√∫mero se divide por 7 o contiene el n√∫mero 7, deben decir "boom" (de ah√≠ el nombre del juego). <br><br>  Vale la pena se√±alar que el programa del juego no es una tarea tan f√°cil.  Ariella escribi√≥ un m√©todo completo que muestra n√∫meros, un d√≠gito a la vez.  Como ella escribi√≥ todo en ensamblador sin llamar a las funciones est√°ndar de la biblioteca C, le llev√≥ varios d√≠as resolverlo. <br><br>  El primer programa de Ariella para Adnroid est√° disponible <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> .  Por cierto, algunos identificadores de c√≥digo en la aplicaci√≥n son en realidad palabras hebreas (por ejemplo, _sifra_ahrona). <br><br>  Escribir una aplicaci√≥n de Android en ensamblador es una buena manera de conocer mejor la arquitectura ARM, y tambi√©n de comprender mejor la cocina interna del dispositivo que usa a diario.  Le sugiero que haga esto de cerca e intente crear una peque√±a aplicaci√≥n de ensamblador para su dispositivo.  Podr√≠a ser un juego simple o algo m√°s. <br><br><blockquote>  <b>Skillbox recomienda:</b> <br><br><ul><li>  Curso pr√°ctico <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Mobile Developer PRO"</a> . </li><li>  Curso en l√≠nea <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Desarrollador C # desde cero"</a> . </li><li>  Curso pr√°ctico de dos a√±os <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Soy un desarrollador web PRO"</a> . </li></ul></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/441798/">https://habr.com/ru/post/441798/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../441784/index.html">La visi√≥n de un bi√≥logo de la teor√≠a mutacional del envejecimiento.</a></li>
<li><a href="../441788/index.html">C√≥mo funciona el sistema de videovigilancia Ivideon: una descripci√≥n general de la cuenta personal del usuario</a></li>
<li><a href="../441790/index.html">Creaci√≥n eficiente de componentes con sistema estilizado</a></li>
<li><a href="../441794/index.html">10 cosas sobre SEO t√©cnico que todo propietario de un sitio de WordPress necesita saber</a></li>
<li><a href="../441796/index.html">Tres puntos de crecimiento de conversi√≥n, o c√≥mo aumentar la seguridad y aumentar las ventas en el sitio</a></li>
<li><a href="../441800/index.html">Conversaciones en C ++: WP 21, Boost, Conferences</a></li>
<li><a href="../441802/index.html">Marco legal para biometr√≠a</a></li>
<li><a href="../441804/index.html">¬øD√≥nde ense√±ar programaci√≥n infantil?</a></li>
<li><a href="../441806/index.html">VPN sin VPN o una historia sobre el uso no convencional de SSH</a></li>
<li><a href="../441808/index.html">Te invitamos el 6 de marzo a ElixirLangMoscow Meetup # 9</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>