<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕵️ 🚤 ⌨️ Modules Laurent et Smart Home (Partie 2). Arduino et AMS 😍 👩🏿‍🤝‍👩🏼 👨‍👧‍👦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ceci est le deuxième article d'une série sur l'intégration des modules Laurent de KernelChip dans les systèmes domotiques, et dans cette partie, nous ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Modules Laurent et Smart Home (Partie 2). Arduino et AMS</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/387205/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ceci est le deuxième article d'une série sur l'intégration </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">des modules</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Laurent </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">de KernelChip</font></a><font style="vertical-align: inherit;"> dans les systèmes domotiques, et dans cette partie, nous nous concentrerons sur l'intégration de ces modules avec l'écosystème Arduino. </font><font style="vertical-align: inherit;">Dans la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">première partie de la</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> série, nous avons parlé de l'intégration avec le système domotique populaire MajorDoMo, et dans la troisième partie, vous apprendrez à gérer ces modules à partir d'esquisses dans le langage de programmation de traitement, directement depuis le bureau de votre ordinateur.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/279/7d1/bf2/2797d1bf243f51c2e44c4bbf9b4282d3.jpg" alt="image"><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduino est notre tout</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Où sans Arduino? </font><font style="vertical-align: inherit;">Je ne vais pas décrire les avantages de cette plate-forme pendant longtemps, sa popularité parle d'elle-même, alors passons immédiatement aux détails techniques de la mise en œuvre de l'interaction des modules Arduino et Laurent. </font><font style="vertical-align: inherit;">Et en cours de route, nous n'oublierons pas le système </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduino Mega Server</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dérivé très intéressant de l'écosystème Arduino.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le fer</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour contrôler des modules sur un réseau, par exemple, la carte Arduino Uno commune ou la carte Arduino Mega tout aussi populaire avec une carte d'interface réseau Ethernet Shield assemblée sur la base de la puce W5100 conviennent. </font><font style="vertical-align: inherit;">Tous les exemples de cet article sont donnés pour une telle combinaison et ont été testés en pratique. </font><font style="vertical-align: inherit;">Tout fonctionne de manière fiable et sans aucun problème. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/086/9f1/1a8/0869f11a82455209389c7e6c37437f0b.jpg" alt="image"><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ethernet Shield basé sur la puce W5100</font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Autrement dit, il vous suffit de prendre le croquis et de le télécharger sur votre carte Uno ou Mega, après l'avoir légèrement modifié pour vos tâches.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gérer les modules d'esquisse</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la première partie de la série, j'ai déjà parlé des principes de gestion des modules Laurent sur le réseau, pour ceux qui n'ont pas lu la première partie, je vais répéter brièvement la théorie ici. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les informations sont échangées avec les modules sur le réseau et pour commencer à travailler avec eux, vous devez établir une connexion TCP / IP sur le port 2424. </font><font style="vertical-align: inherit;">Une fois la connexion établie, vous pouvez envoyer des commandes de texte (dites commandes KE) qui contrôlent le module. </font><font style="vertical-align: inherit;">Le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">site Web KernelChip</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contient une documentation détaillée, y compris une description accessible des commandes KE. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essayons maintenant de traduire ces «termes de référence» théoriques dans le langage simple des croquis Arduino.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esquisser</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je ne vais pas expliquer ici comment installer et configurer l'environnement de programmation Arduino, on suppose que vous l'avez déjà fait et que vous pouvez écrire des croquis simples. </font><font style="vertical-align: inherit;">Donc, pour commencer, nous devons connecter les bibliothèques SPI.h et Ethernet.h nécessaires pour contrôler le bus et le module Ethernet lui-même.</font></font><br>
<br>
<pre><code class="java hljs">#include &lt;SPI.h&gt;<font></font>
#include &lt;Ethernet.h&gt;<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, vous devez définir les paramètres réseau pour le module Ethernet et le module Laurent, que nous gérerons. </font><font style="vertical-align: inherit;">Notez que les adresses MAC et les adresses IP doivent être uniques et LAURENT_PORT doit être défini sur 2424 et aucun autre.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> SELF_MAC[] = {<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x2A</span></span>, <span class="hljs-number"><span class="hljs-number">0xF5</span></span>, <span class="hljs-number"><span class="hljs-number">0x12</span></span>, <span class="hljs-number"><span class="hljs-number">0x67</span></span>, <span class="hljs-number"><span class="hljs-number">0xEE</span></span>};
<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> SELF_IP[] = {<span class="hljs-number"><span class="hljs-number">192</span></span>, <span class="hljs-number"><span class="hljs-number">168</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>};<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> LAURENT_IP[] = {<span class="hljs-number"><span class="hljs-number">192</span></span>, <span class="hljs-number"><span class="hljs-number">168</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">19</span></span>};
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> LAURENT_PORT = <span class="hljs-number"><span class="hljs-number">2424</span></span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons encore besoin d'un tampon pour stocker les commandes réseau, il est sélectionné avec une taille de 200 octets avec une certaine marge.Si vous avez des problèmes avec un manque de RAM, vous pouvez le réduire, par exemple, à 100 octets ou même moins.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">char</span></span> buf[<span class="hljs-number"><span class="hljs-number">200</span></span>];
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et la touche finale est le client Ethernet pour le module Laurent. </font><font style="vertical-align: inherit;">Nous allons maintenant effectuer toutes les opérations avec le module en utilisant l'objet lclient.</font></font><br>
<br>
<pre><code class="java hljs">EthernetClient lclient;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voilà, regardons maintenant une fonction qui envoie des commandes au module Laurent.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendLaurentRequest</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (lclient.connect(LAURENT_IP, LAURENT_PORT)) { <font></font>
    Serial.print(<span class="hljs-string"><span class="hljs-string">"Command: "</span></span>);<font></font>
    Serial.println(buf);<font></font>
    lclient.println(buf);<font></font>
    delay(<span class="hljs-number"><span class="hljs-number">100</span></span>);<font></font>
  <font></font>
    Serial.print(<span class="hljs-string"><span class="hljs-string">"Answer:  "</span></span>);
    <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(lclient.available() != <span class="hljs-number"><span class="hljs-number">0</span></span>) {
      <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> c = lclient.read();<font></font>
      Serial.print(c);<font></font>
    }<font></font>
    delay(<span class="hljs-number"><span class="hljs-number">500</span></span>);<font></font>
    lclient.stop();<font></font>
  } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<font></font>
      Serial.println(<span class="hljs-string"><span class="hljs-string">"Error sending command"</span></span>);<font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si une connexion est établie avec le module Laurent sur le port 2424, le contenu du tampon est envoyé au module et dupliqué en série pour une inspection visuelle. </font><font style="vertical-align: inherit;">Ensuite, 100 millisecondes sont attendues et la réponse du module est reçue. </font><font style="vertical-align: inherit;">Après cela, une pause à nouveau et la communication avec le module est interrompue. </font><font style="vertical-align: inherit;">Si, pour une raison quelconque, la connexion au module n'a pas pu être établie, un message d'erreur s'affiche. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Analysons maintenant l'initialisation. </font><font style="vertical-align: inherit;">L'initialisation Ethernet est une fonction simple</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ethernetInit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
  Ethernet.begin(SELF_MAC, SELF_IP);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et le module Laurent est initialisé par la fonction laurentInit (), dont nous allons maintenant analyser le fonctionnement en détail. Il est assez volumineux et vous devez bien le comprendre car c'est à partir du code de cette fonction que vous pourrez construire vos propres requêtes vers les modules Laurent.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">laurentInit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
  Serial.println(<span class="hljs-string"><span class="hljs-string">"Start modul Laurent Init..."</span></span>);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">"Connect to Laurent... "</span></span>);
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (lclient.connect(LAURENT_IP, LAURENT_PORT)) {<font></font>
    Serial.println(<span class="hljs-string"><span class="hljs-string">"OK"</span></span>);<font></font>
    lclient.stop();<font></font>
    <font></font>
    <span class="hljs-comment"><span class="hljs-comment">// Send test command</span></span>
    Serial.println(<span class="hljs-string"><span class="hljs-string">"Selftest..."</span></span>);<font></font>
    sprintf(buf, <span class="hljs-string"><span class="hljs-string">"$KE"</span></span>);<font></font>
    sendLaurentRequest();<font></font>
<font></font>
    <span class="hljs-comment"><span class="hljs-comment">// Send password (default: "Laurent")</span></span>
    Serial.println(<span class="hljs-string"><span class="hljs-string">"Set password..."</span></span>);<font></font>
    sprintf(buf, <span class="hljs-string"><span class="hljs-string">"$KE,PSW,SET,Laurent"</span></span>);   <font></font>
    sendLaurentRequest();<font></font>
  } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<font></font>
      Serial.println(<span class="hljs-string"><span class="hljs-string">"failed"</span></span>);<font></font>
    }<font></font>
  delay(<span class="hljs-number"><span class="hljs-number">500</span></span>);<font></font>
    <font></font>
  <span class="hljs-comment"><span class="hljs-comment">//   DATA</span></span>
  sprintf(buf, <span class="hljs-string"><span class="hljs-string">"$KE,DAT,OFF"</span></span>);<font></font>
  sendLaurentRequest();<font></font>
  delay(<span class="hljs-number"><span class="hljs-number">100</span></span>);<font></font>
  <font></font>
  <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
  sprintf(buf, <span class="hljs-string"><span class="hljs-string">"$KE,REL,2,0"</span></span>);<font></font>
  sendLaurentRequest();<font></font>
  <font></font>
  Serial.println(<span class="hljs-string"><span class="hljs-string">"Modul Laurent Init done"</span></span>);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Initialement, un message d'initialisation s'affiche et une tentative de connexion au module Laurent est tentée. En cas d'échec, un message d'erreur s'affiche et si la connexion au module réussit, une commande d'autodiagnostic est envoyée, à laquelle le module sain doit répondre par «#OK». </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, une commande est envoyée pour entrer le mot de passe (dans ce cas, c'est le mot de passe par défaut). Et 500 millisecondes est attendue. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, deux commandes supplémentaires sont introduites - l'une d'entre elles arrête la sortie de données par le module (si elle disparaît), et la seconde désactive le relais n ° 2, que nous utilisons dans nos expériences. En d'autres termes, ces commandes ramènent le module à un état initial. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici une impression du processus d'initialisation sur lequel toutes les commandes et toutes les réponses des modules sont visibles:</font></font><br>
<br>
<pre><code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">Start</span></span> modul Laurent Init...<font></font>
Connect to Laurent... OK<font></font>
Selftest...<font></font>
<span class="hljs-function"><span class="hljs-function">Command: $</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">KE</span></span></span><span class="hljs-function">
</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Answer</span></span></span><span class="hljs-function">:  #</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OK</span></span></span><span class="hljs-function">
</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Set</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">password</span></span></span><span class="hljs-function">...
</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Command</span></span></span><span class="hljs-function">: $</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">KE</span></span></span><span class="hljs-function">,</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PSW</span></span></span><span class="hljs-function">,</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SET</span></span></span><span class="hljs-function">,</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Laurent</span></span></span><span class="hljs-function">
</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Answer</span></span></span><span class="hljs-function">:  #</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PSW</span></span></span><span class="hljs-function">,</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SET</span></span></span><span class="hljs-function">,</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OK</span></span></span><span class="hljs-function">
</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Command</span></span></span><span class="hljs-function">: $</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">KE</span></span></span><span class="hljs-function">,</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DAT</span></span></span><span class="hljs-function">,</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OFF</span></span></span><span class="hljs-function">
</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Answer</span></span></span><span class="hljs-function">:  #</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DAT</span></span></span><span class="hljs-function">,</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OK</span></span></span><span class="hljs-function">
</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Command</span></span></span><span class="hljs-function">: $</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">KE</span></span></span><span class="hljs-function">,</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">REL</span></span></span><span class="hljs-function">,2,0
</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Answer</span></span></span><span class="hljs-function">:  #</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">REL</span></span></span><span class="hljs-function">,</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OK</span></span></span><span class="hljs-function">
</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Modul</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Laurent</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Init</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">done</span></span></span><span class="hljs-function">
</span></span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, le code de la fonction setup () standard. </font><font style="vertical-align: inherit;">Tous les sous-systèmes sont initialisés, y compris un port série à un débit standard de 9600 bauds.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{  <font></font>
  Serial.begin(<span class="hljs-number"><span class="hljs-number">9600</span></span>);  <font></font>
  ethernetInit();<font></font>
  laurentInit();<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons donc initialisé le module et nous pouvons le gérer comme nous le souhaitons: envoyer des commandes, lire des réponses, construire une logique de contrôle en tenant compte des données émises par le module Laurent. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Considérez, par exemple, la tâche la plus simple - allumer et éteindre à intervalles réguliers la lumière d'une lampe connectée au deuxième relais du module Laurent.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{
  <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
  sprintf(buf, <span class="hljs-string"><span class="hljs-string">"$KE,REL,2,1"</span></span>);<font></font>
  sendLaurentRequest();<font></font>
  delay(<span class="hljs-number"><span class="hljs-number">3000</span></span>);
  <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
  sprintf(buf, <span class="hljs-string"><span class="hljs-string">"$KE,REL,2,0"</span></span>);<font></font>
  sendLaurentRequest();<font></font>
  delay(<span class="hljs-number"><span class="hljs-number">3000</span></span>);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La fonction loop () est une boucle infinie et la lampe, obéissant à nos commandes, s'allumera en continu et s'éteindra toutes les 3 secondes. </font><font style="vertical-align: inherit;">Ceci, bien sûr, n'est qu'un exemple, en fait, la logique de travail peut être n'importe laquelle et tout dépend de vos besoins. </font><font style="vertical-align: inherit;">Et bien sûr, vous pouvez envoyer non seulement des commandes pour activer ou désactiver les charges, mais aussi toutes les autres prises en charge par le module. </font><font style="vertical-align: inherit;">Vous pouvez trouver une liste complète des commandes et leur description dans la documentation des modules Laurent. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez prendre ce croquis et l'intégrer dans vos propres projets, leur ajoutant ainsi un support pour la gestion des modules Laurent. </font><font style="vertical-align: inherit;">Ou vice versa, prenez cette esquisse comme base et augmentez progressivement sa fonctionnalité. </font><font style="vertical-align: inherit;">Il n'y a pas de limite à la perfection. </font><font style="vertical-align: inherit;">Voici le croquis complet.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code d'esquisse complet</font></font></b><div class="spoiler_text">#include &lt;SPI.h&gt;<br>
#include &lt;Ethernet.h&gt;<br>
<br>
byte SELF_MAC[] = {0x00, 0x2A, 0xF5, 0x12, 0x67, 0xEE};<br>
byte SELF_IP[] = {192, 168, 2, 20};<br>
<br>
byte LAURENT_IP[] = {192, 168, 2, 19};<br>
int LAURENT_PORT = 2424;<br>
<br>
char buf[200];<br>
<br>
EthernetClient lclient;<br>
<br>
void ethernetInit() {<br>
 Ethernet.begin(SELF_MAC, SELF_IP);<br>
}<br>
<br>
void laurentInit() {<br>
 Serial.println(«Start modul Laurent Init...»);<br>
 Serial.print(«Connect to Laurent… „);<br>
 if (lclient.connect(LAURENT_IP, LAURENT_PORT)) {<br>
 Serial.println(“OK»);<br>
 lclient.stop();<br>
 <br>
 // Send test command<br>
 Serial.println(«Selftest...»);<br>
 sprintf(buf, "$KE");<br>
 sendLaurentRequest();<br>
<br>
// Send password (default: «Laurent»)<br>
 Serial.println(«Set password...»);<br>
 sprintf(buf, "$KE,PSW,SET,Laurent"); <br>
 sendLaurentRequest();<br>
 } else {<br>
 Serial.println(«failed»);<br>
 }<br>
 delay(500);<br>
 <br>
 //   DATA<br>
 sprintf(buf, "$KE,DAT,OFF");<br>
 sendLaurentRequest();<br>
 delay(100);<br>
 <br>
 //  <br>
 sprintf(buf, "$KE,REL,2,0");<br>
 sendLaurentRequest();<br>
 <br>
 Serial.println(«Modul Laurent Init done»);<br>
} // laurentInit<br>
<br>
void sendLaurentRequest() {<br>
 if (lclient.connect(LAURENT_IP, LAURENT_PORT)) { <br>
 Serial.print(«Command: „);<br>
 Serial.println(buf);<br>
 lclient.println(buf);<br>
 delay(100);<br>
 <br>
 Serial.print(“Answer: „);<br>
 while(lclient.available() != 0) {<br>
 char c = lclient.read();<br>
 Serial.print©;<br>
 }<br>
 delay(500);<br>
 lclient.stop();<br>
 } else {<br>
 Serial.println(“Error sending command»);<br>
 }<br>
} // sendLaurentRequest<br>
<br>
void setup() { <br>
 Serial.begin(9600); <br>
 ethernetInit();<br>
 laurentInit();<br>
}<br>
<br>
void loop() {<br>
 //  <br>
 sprintf(buf, "$KE,REL,2,1");<br>
 sendLaurentRequest();<br>
 delay(3000);<br>
<br>
//  <br>
 sprintf(buf, "$KE,REL,2,0");<br>
 sendLaurentRequest();<br>
 delay(3000);<br>
}<br>
</div></div><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduino Mega Server</font></font></h2><br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/6cb/44c/34f/6cb44c34fc97289e192f28cc8e59fb8c.png" alt="image"><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduino Mega Server</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (AMS) est un système puissant pour Arduino Mega (maintenant aussi pour Arduino DUE et, bientôt, pour d'autres plates-formes 32 bits M0 (Zero) et Genuino 101), qui contient le code "pour toutes les occasions" et plus encore serveur intégré et interface Web conviviale. </font><font style="vertical-align: inherit;">AMS prend en charge les modules Laurent dès la sortie de la boîte et vous n'avez pas besoin d'ajouter autre chose que la logique utilisateur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AMS a une structure modulaire et l'activation et la désactivation des modules se fait simplement en commentant une ligne dans un croquis, par exemple,</font></font><br>
<br>
<pre><code class="java hljs">#define LAURENT_FEATURE
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ou </font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//#define LAURENT_FEATURE</span></span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si la ligne est commentée, alors le module n'est pas compilé et ne participe pas au travail, comme on peut le voir sur les indicateurs des modules dans l'en-tête du site. </font><font style="vertical-align: inherit;">Ou vice versa, un module compilé et fonctionnel est indiqué en bleu. </font><font style="vertical-align: inherit;">Dans ce cas, le module de commande LRT LRT ne fonctionne pas. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/7bb/e3b/f7e/7bbe3bf7ea1146478f40eff0c230d38f.png" alt="image"><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Indicateurs de fonctionnement du module</font></font></em><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Travailler avec les réponses du module Laurent</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ajoutons maintenant la possibilité non seulement d'afficher les réponses des modules, mais aussi de les utiliser, par exemple, de les analyser ou de les afficher sur les pages Web d'Arduino Mega Server. </font><font style="vertical-align: inherit;">Pour ce faire, nous avons besoin d'une nouvelle variable chaîne et d'une constante qui détermine la longueur de la chaîne que nous attribuons aux réponses des modules Laurent. </font><font style="vertical-align: inherit;">Dans l'exemple de test, il est égal à 25 caractères, mais vous pouvez l'augmenter si les réponses ne correspondent pas à cette valeur. </font><font style="vertical-align: inherit;">Vous devez juste vous rappeler que la RAM du microcontrôleur est une ressource précieuse et vous devez la sauvegarder. </font><font style="vertical-align: inherit;">Ajoutez les lignes suivantes au module laurent.ino standard du package AMS:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> MAX_LEN_LREQUEST = <span class="hljs-number"><span class="hljs-number">25</span></span>;<font></font>
String lrequest = String(MAX_LEN_LREQUEST);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous devons également changer le code de la fonction qui fait les demandes (les changements ajoutés sont mis en évidence par des flèches).</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendLaurentRequest</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (lclient.connect(LAURENT_IP, LAURENT_PORT)) { <font></font>
    Serialprint(<span class="hljs-string"><span class="hljs-string">"Command: "</span></span>);<font></font>
    Serial.println(buf);<font></font>
    lclient.println(buf);<font></font>
    delay(<span class="hljs-number"><span class="hljs-number">100</span></span>);<font></font>
  <font></font>
    Serialprint(<span class="hljs-string"><span class="hljs-string">"Answer:  "</span></span>);
    <span class="hljs-comment"><span class="hljs-comment">// --------------------&gt;</span></span>
    lrequest = <span class="hljs-string"><span class="hljs-string">""</span></span>;
    <span class="hljs-comment"><span class="hljs-comment">// --------------------&gt;</span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(lclient.available() != <span class="hljs-number"><span class="hljs-number">0</span></span>) {
      <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> c = lclient.read();<font></font>
      Serial.print(c);<font></font>
      <span class="hljs-comment"><span class="hljs-comment">// --------------------&gt;</span></span>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (lrequest.length() &lt; MAX_LEN_LREQUEST) {<font></font>
        lrequest += (c);<font></font>
      }<font></font>
      <span class="hljs-comment"><span class="hljs-comment">// --------------------&gt;</span></span><font></font>
    }<font></font>
    delay(<span class="hljs-number"><span class="hljs-number">500</span></span>);<font></font>
    lclient.stop();<font></font>
  } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<font></font>
      Serialprint(<span class="hljs-string"><span class="hljs-string">"Error sending command\n"</span></span>);<font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, nous avons appris comment obtenir des réponses de Laurent dans la variable de demande et maintenant nous pouvons faire ce que nous jugeons approprié. </font><font style="vertical-align: inherit;">Ensuite, je vais montrer comment afficher les résultats des requêtes directement dans le tableau de bord dans l'en-tête du site AMS. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une petite note. </font><font style="vertical-align: inherit;">Cet exemple utilise la fonction Serialprint au lieu du Serial.print standard car il économise plus de RAM. </font><font style="vertical-align: inherit;">Et il peut facilement être converti en un standard en mettant simplement fin à deux mots.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sortie de la réponse du module à l'en-tête du site</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et le dernier exemple. </font><font style="vertical-align: inherit;">Affichez les réponses des modules Laurent dans l'en-tête du site Arduino Mega Server. </font><font style="vertical-align: inherit;">Pour ce faire, nous devons ajouter la demande à la boucle loop principale () de l'esquisse AMS. </font><font style="vertical-align: inherit;">Ouvrez le fichier arduino_mega_server.ino et entrez le code suivant avant la fonction cyclosInSecWork ():</font></font><br>
<br>
<pre><code class="java hljs">    #<span class="hljs-function"><span class="hljs-function">ifdef LAURENT_FEATURE
      </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cycle30s)</span></span></span><span class="hljs-function"> </span></span>{<font></font>
        sprintf(buf, <span class="hljs-string"><span class="hljs-string">"$KE"</span></span>);   <font></font>
        sendLaurentRequest();<font></font>
      }<font></font>
    #endif<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce code interrogera la santé du module Laurent toutes les trente secondes. Naturellement, ce n'est qu'un exemple, à cet endroit, il peut y avoir n'importe quelle demande et n'importe quel code. Ainsi, dans la variable lrequest nous avons une réponse sur l'état du module et pouvons maintenant l'afficher dans l'en-tête du site. Pour ce faire, ouvrez le module server_ajax.ino et à la toute fin, dans le code de fonction responseDash (EthernetClient cl), avant la ligne cl.println (""); ajoutez le code suivant:</font></font><br>
<br>
<pre><code class="java hljs">    #<span class="hljs-function"><span class="hljs-function">ifdef LAURENT_FEATURE
      </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendTagString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"laurent"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span><span class="hljs-function"><span class="hljs-params">, lrequest, cl)</span></span></span></span>;<font></font>
    #endif<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce code, en fait, envoie les réponses du module à la page Web. </font><font style="vertical-align: inherit;">Il reste à faire deux choses: la première consiste à ajouter du code JavaScript qui "captera" nos données et la seconde est le code HTML sur la page AMS elle-même, où les réponses du module seront affichées. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, ouvrez le fichier scripts.js et dans la fonction getDashData () avant le crochet de fermeture} // if (this.responseXML! = Null) entrez le code qui acceptera nos locaux.</font></font><br>
<br>
<pre><code class="javascript hljs">          <span class="hljs-comment"><span class="hljs-comment">// Laurent</span></span>
          <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> {
            <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> laurent = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.responseXML.getElementsByTagName(<span class="hljs-string"><span class="hljs-string">'laurent'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>].childNodes[<span class="hljs-number"><span class="hljs-number">0</span></span>].nodeValue;<font></font>
          } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (err) {<font></font>
              laurent = <span class="hljs-string"><span class="hljs-string">"-"</span></span>;<font></font>
            }<font></font>
          <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"laurent"</span></span>).innerHTML = laurent; 
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il ne reste plus qu'à corriger légèrement le fichier dash.htm de la livraison AMS standard et à lui ajouter du code qui affichera des informations à l'écran. </font><font style="vertical-align: inherit;">Immédiatement après la ligne contenant class = "online-device", nous entrons dans notre nouvelle ligne avec le code:</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>Laurent: <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"value"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"laurent"</span></span></span><span class="hljs-tag">&gt;</span></span>...<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est tout. </font><font style="vertical-align: inherit;">Nous avons affiché les réponses du module Laurent dans l'en-tête du site Arduino Mega Server. </font><font style="vertical-align: inherit;">Et voici le résultat de nos efforts. </font><font style="vertical-align: inherit;">L'état du module est clairement visible dans le panneau AMS et il est mis à jour toutes les 30 secondes, donc si quelque chose arrive au module, vous en serez informé après un maximum de 30 secondes.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/126/5f2/c08/1265f2c08e49db3483fb7df355ac27e1.png" alt="image"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir, il n'y a rien de compliqué à gérer les modules Laurent en utilisant Arduino et Arduino Mega Server, et si vous avez déjà de tels modules ou prévoyez de les ajouter à votre système Smart Home, cet article vous aidera à le faire facilement et simplement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et dans le prochain article du cycle, vous apprendrez comment gérer Loranes directement à partir de l'écran de votre ordinateur et comment rendre le processus d'enseignement de la programmation des enfants interactif et plus intéressant. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Addition</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Une chaîne Youtube est ouverte et voici une </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vidéo promo du</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Arduino Mega Server, qui montre comment travailler avec un vrai système.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr387205/">https://habr.com/ru/post/fr387205/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr387195/index.html">Sculpture cinétique "Sisyphe" de LEGO Technics</a></li>
<li><a href="../fr387197/index.html">Les planètes peuvent faire pousser des cheveux de matière noire</a></li>
<li><a href="../fr387199/index.html">DIY PowerBank pour 17 000 heures milliampères honnêtes</a></li>
<li><a href="../fr387201/index.html">Combien coûte un pirate de l'empire du milieu?</a></li>
<li><a href="../fr387203/index.html">Une femme aveugle de 37 ans avec une double personnalité a commencé à voir quand elle est devenue adolescente</a></li>
<li><a href="../fr387207/index.html">Comment un ancien ingénieur de Google développe de nouvelles technologies de recherche de restaurants</a></li>
<li><a href="../fr387209/index.html">La naissance de la matrice: les réseaux de neurones artificiels ont appris à créer des visages réalistes des personnes et des intérieurs des chambres</a></li>
<li><a href="../fr387215/index.html">Un moyen simple d'ajouter un module Wi-Fi à votre Raspberry Pi Zero</a></li>
<li><a href="../fr387217/index.html">Vêtements intelligents et technologie portable</a></li>
<li><a href="../fr387219/index.html">Que donner un boom pour la nouvelle année dans la gamme de 10-20 $? Partie 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>