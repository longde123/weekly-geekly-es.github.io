<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⏱️ 👨🏿‍🤝‍👨🏾 🚝 Cara memulai pembayaran mikro di aplikasi Anda 👨‍🚒 🙅 ↪️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Minggu lalu saya habiskan mengembangkan program publik pertama saya - bot Telegram yang berfungsi sebagai dompet Bitcoin dan memungkinkan Anda untuk "...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cara memulai pembayaran mikro di aplikasi Anda</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/452696/">  Minggu lalu saya habiskan mengembangkan program publik pertama saya - bot Telegram yang berfungsi sebagai dompet Bitcoin dan memungkinkan Anda untuk "melempar koin" ke anggota lain dari obrolan grup dan juga melakukan pembayaran Bitcoin eksternal untuk Anda sendiri atau yang disebut lainnya  "Aplikasi Petir".  Maksud saya, secara umum pembaca mengenal Bitcoin dan Telegram  Saya akan mencoba menulis secara singkat, tanpa merinci.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pilihan sumber daya tentang Bitcoin tersedia di tautan ini</a> , tetapi Telegram adalah alat pengiriman pesan instan untuk perangkat seluler dan PC yang memungkinkan Anda membuat aplikasi kecil (chat chat) di platform mereka. <br><br><h3>  Apa saja fitur utama dari aplikasi ini? </h3><br><ul><li>  Memungkinkan Anda untuk berterima kasih atau menghargai lawan bicara dengan nilai materi yang benar-benar, dan bukan hanya <i>"seperti virtual"</i> , ini membawa komunikasi elektronik ke tingkat yang sama sekali baru </li><li>  Contoh dunia nyata dari aplikasi yang dapat berinteraksi secara finansial dengan aplikasi lain menggunakan protokol pembayaran terbuka </li><li>  Semua komponen aplikasi adalah proyek sumber terbuka dan dimungkinkan untuk memodifikasi dan menerapkannya pada tugas Anda.  Aplikasi ini tidak menggunakan solusi tertutup dan / atau komersial, meskipun faktanya sesuai dengan ruang lingkup perdagangan elektronik, yang saat ini cukup sulit untuk disebut terbuka. </li></ul><br><h3>  Dan bagaimana cara menerapkannya dalam bisnis? </h3><br>  sesuatu seperti itu ... <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/097/02b/175/09702b1750c94616a10fc66c1275c00f.png" alt="gambar"></div><a name="habracut"></a><br>  atau lebih ... <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3ef/1ff/85f/3ef1ff85f1e7b77662c63a9d4d838666.png" alt="gambar"></div><br>  Apa arti angka-angka ini?  Ini adalah <b>unit Bitcoin - Satoshi</b> .  Pada pertengahan harga pertukaran 2019, 1000 Satoshi adalah sekitar $ 0,06.  Satoshi dapat dihabiskan secara online atau dengan mudah ditukar dengan mata uang nasional.  Karena alasan ini (likuiditas) inilah ini bukan sekadar <i>“entri lain ke dalam basis data”</i> atau <i>“poin yang dapat Anda belanjakan di toko mitra kami,”</i> tetapi juga <b>uang internet nyata</b> . <br>  <i>* Saya ingin segera mencatat bahwa saya sengaja tidak mencoba menulis beberapa kata atau frasa dalam bahasa Rusia - entah saya tidak tahu terjemahan kontekstual itu sendiri dalam beberapa kasus, atau terjemahan semacam itu, menurut pendapat saya, terdengar lebih membingungkan daripada benar</i> <br><br>  Mungkin timbul pertanyaan, bagaimana cara menggunakan aplikasi semacam itu jika tidak ada bitcoin.  Mereka dapat dengan mudah dibeli dalam jumlah kecil di salah satu dari banyak pertukaran atau penukar, atau Anda bisa mendapatkannya dari teman bitcoin atau bahkan mendapatkan koin dari pengguna bot saat ini.  Banyak dompet di telepon menawarkan untuk membeli bitcoin secara langsung "tanpa meninggalkan meja kas." <br><br><img src="https://habrastorage.org/getpro/habr/post_images/883/661/461/883661461bdc686aec7d084d5d581236.png" alt="gambar"><img src="https://habrastorage.org/getpro/habr/post_images/779/716/5d9/7797165d93d292700d9a41a171d882a6.png" alt="gambar"><img src="https://habrastorage.org/getpro/habr/post_images/8fe/33b/84b/8fe33b84bb127132304634363bb4af42.png" alt="gambar"><br><br>  Ketika kami mendapatkan bitcoin (melainkan Satoshi (?)) - jalankan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">@atomic_tipbot</a> dan lakukan / setoran. <br><br>  Bot sebagai respons akan menanyakan berapa banyak satoshi yang akan dikreditkan ke akun dan akan mengirimkan faktur pembayaran, yang dapat dibayar dengan dompet ponsel dengan memindai kode QR atau mengklik tombol ( <i>“dompet terbuka”</i> ) pada halaman faktur. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8fe/33b/84b/8fe33b84bb127132304634363bb4af42.png" alt="gambar"><img src="https://habrastorage.org/getpro/habr/post_images/4a3/da5/f76/4a3da5f76574ac9ebb2161d56bceff62.png" alt="gambar"><img src="https://habrastorage.org/getpro/habr/post_images/54d/a43/0be/54da430be68237193dee82ade50bab37.png" alt="gambar"><br><br>  Setelah mengonfirmasi pembayaran di dompet Anda, segera konfirmasi pembayaran akan dikirim ke bot dan ini akan ditampilkan secara visual dalam bingkai akun. <br><br>  Hingga saat ini, kami menyentuh dua komponen aplikasi - bot telegram back-end dan sistem pemrosesan pembayaran cryptocurrency (lebih tepatnya, front-end). <br><br>  Untuk membuat bot Telegram, saya menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bot Python Telegram</a> .  Dan tentu saja, bot <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">open source</a> itu sendiri. <br><br>  Sebagai sistem pemrosesan pembayaran dan penyelesaian masalah UX, pilihannya jatuh (pada kenyataannya, hampir tidak ada pilihan) di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">BTCPayServer</a> , di mana <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dokumentasi tersedia di tautan ini</a> . <br><br>  Jika Anda mencari solusi untuk memproses acara pembayaran secara langsung, maka Anda harus memperhatikan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">halaman manual Electrum CLI</a> untuk apa yang disebut  pembayaran on-chain, dan untuk solusi pembayaran mikro instan (Lightning) seperti <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Lightning-charge</a> atau <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Sparko</a> . <br><br><h3>  Jadi itu host sendiri atau tidak !? </h3><br>  Ya itu.  Dalam aplikasi saya, saya menggunakan BTCPayServer hosting gratis - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">BTCPayJungle</a> , tetapi sangat mungkin dan tidak memerlukan banyak waktu untuk meluncurkan pusat pemrosesan saya sendiri.  Namun, perlu diingat bahwa Anda akan membutuhkan ~ 500GB yang tersedia di kereta api untuk menyimpan blockchain Bitcoin (dan Litecoin).  Ini juga akan membutuhkan sumber daya komputasi dan jaringan selama sinkronisasi dan, tergantung pada kebutuhan Anda, "pembungkus" yang diperlukan untuk blockchains, sehingga akan lebih mudah untuk berinteraksi dengan mereka.  BTCPayServer tidak mengandung kunci pribadi <i>by-design</i> atau informasi lain yang memungkinkan Anda untuk mengontrol dompet Anda. <br><br>  Untuk pembayaran on-chain (reguler), Anda perlu menambahkan apa yang disebut  kunci xpub-wallet di BTCPayServer untuk menghasilkan alamat penerima (kunci publik).  Ini memungkinkan dan aman untuk menggunakan BTCPayServer bahkan dalam bentuk "bersama".  Semua kunci dan alamat xpub ini dapat dengan mudah diperoleh di dompet yang bagus seperti <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Electrum</a> , untuk diproses lebih lanjut. <br><br>  Setiap orang yang telah menemukan Bitcoin telah mendengar bahwa Bitcoin lambat dan transaksinya mahal, terutama ketika hype, jadi untuk pembayaran mikro instan Anda harus menggunakan transaksi Jaringan Petir (off-chain). <br><br><h3>  Apa ini Jaringan Petir? </h3><br>  Ini adalah sedikit plugin bitcoin yang membangun lapisan abstraksi tambahan dan memungkinkan Anda untuk melakukan transaksi instan dan hampir gratis di jaringan Bitcoin.  Semua ini dimungkinkan berkat sihir kriptografi dengan multi-tanda tangan, sering disebut <i>kontrak pintar</i> .  Ada beberapa implementasi protokol Lightning Network, saya menggunakan implementasi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">c-lightning</a> di C. <br><br>  Perbedaan utama antara pembayaran on-chain dan off-chain (Lightning) adalah bagaimana mereka disimpan.  Semua transaksi <b>on-chain</b> diteruskan ke semua node jaringan sampai salah satu node Bitcoin mengumumkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">blok ranjau baru</a> dengan transaksi yang termasuk di dalamnya.  (Bahkan ada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link">BitFury di hub</a> ; mereka hanya menghasilkan besi untuk ditambang).  Untuk alasan inilah kami menyebutnya transaksi <b>on-chain</b> .  Transaksi tersebut akan dicatat dalam blockchain umum dan disimpan di dalamnya sampai akhir keberadaannya.  Transaksi tersebut juga berada dalam domain publik dan dapat dipantau, dilacak dan dianalisis. <br><br>  Dalam kasus transaksi <b>off-chain</b> (Lightning), semuanya terjadi secara berbeda.  Setiap node dari jaringan Lightning memiliki satu <i>(atau lebih)</i> alamat on-chain - ini adalah alamat Bitcoin yang biasa dari mana semuanya dimulai.  Ketika bitcoin muncul di alamat seperti itu, dimungkinkan untuk membuka apa yang disebut.  <i>saluran petir</i> ke node lain, yang berarti bahwa dengan bantuan teknik kriptografi, kedua node sepakat pada ketersediaan dana di antara mereka sendiri.  Kemudian, semua transaksi (baik milik mereka sendiri maupun transaksi dari simpul asing) yang melewati saluran tersebut disimpan hanya pada simpul peserta transaksi (dan simpul perantara).  Satu-satunya transaksi yang dicatat pada blockchain adalah transaksi tentang membuka atau menutup saluran.  Pada skala yang lebih penuh, kami mendapatkan jaringan node yang saling berhubungan yang membangun di antara para peserta ribuan cara berbeda untuk "mentransfer" dana dari satu node ke node lain sesuai dengan aturan ketat tertentu.  Hampir semua transaksi semacam itu hanya disimpan dalam file database dari node itu sendiri.  Karena alasan inilah kami menyebutnya <b>off-chain</b> . <br><br><h3>  Diagram menunjukkan visualisasi semua komponen aplikasi </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/3c6/636/b8c/3c6636b8c98d52aab9bd09ff9c52afcb.png" alt="gambar"><br><br>  Singkatnya: <br><br>  1) Pengguna mengirimkan perintah ke bot di <b>Telegram</b> <br><br>  2) Telegram mengirim pesan acara <b>python</b> ke <b>aplikasi</b> bot <br><br>  3) <b>aplikasi python</b> mengirimkan permintaan ke <b>BTCPayServer</b> <br><br>  4) BTCPayServer menghasilkan alamat BTC dan LTC yang masuk, serta mengirimkan permintaan faktur ke <b>biaya petir</b> , yang selanjutnya berkomunikasi dengan daemon <b>c-lightning</b> .  Di bagian keluaran, kami mendapatkan bentuk pemrosesan pembayaran HTML yang indah <br><br>  5) Pengguna membayar faktur dan melihat konfirmasi <br><br>  6) <b>BTCPayServer</b> mengirimkan <i>pemberitahuan pembayaran faktur</i> (IPN) ke callback_url yang ditentukan, dalam kasus kami <b>callbacks.py</b> (aplikasi python lain untuk menerima pemberitahuan) <br><br>  7) Menurut data yang diterima, saldo pengguna berubah <br><br>  <i>... dan jika pengguna ingin menarik dana (koin yang ia terima dari orang lain) ...</i> <br><br>  8) <b>Aplikasi Python</b> bot <b>sedang</b> menunggu teks atau gambar kode QR, dan ketika data yang valid diterima, pembayaran oleh utilitas <b>paylightning.py * dilakukan</b> , yang menginisialisasi transaksi menggunakan c-lightning RPC. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/518/3dc/c81/5183dcc817817f1aa676ff74d17d08bb.png" alt="gambar"><br><br>  <i>* Dalam keadilan, perlu dicatat bahwa pembungkus paylightning.py saya belum sepenuhnya selesai dan dapat mengembalikan negatif palsu dalam skenario tertentu.</i>  <i>Saya merekomendasikan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">untuk menggunakan pembungkus yang sudah disatukan dengan baik</a> dalam kasus yang dekat dengan produksi</i> <br><br>  Apa yang kita miliki  Pengguna bot kami dapat di dalam obrolan grup atau secara langsung dapat mentransfer <b>nilai materi</b> tanpa batasan.  Dan ini belum semuanya - berkat protokol Lightning Network, yang dalam arti tertentu adalah jaringan pembayaran yang disatukan dan disederhanakan, dimungkinkan untuk mengirim uang yang sama yang diterima dalam obrolan ke aplikasi pihak ketiga yang sepenuhnya.  Misalnya, Telegram sudah memiliki bot pertama untuk pembayaran bitcoin - @lntxbot.  "Satu saldo" memungkinkan Anda untuk menggunakan bot apa pun tergantung pada preferensi obrolan grup tertentu (ya, masalahnya benar-benar dibuat dan solusinya sangat tidak berguna, tetapi intinya pada dasarnya).  Mentransfer saldo dari satu bot ke bot lain tidak dikenakan biaya apa pun dan hanya membutuhkan waktu beberapa detik!  Penting untuk dicatat bahwa pembuat bot ini bahkan tidak pernah terhubung satu sama lain. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f09/c3a/ef9/f09c3aef995f7a82560987646b0d8ee0.png" alt="gambar"><img src="https://habrastorage.org/getpro/habr/post_images/1e2/344/82c/1e234482c56aa0df1d4b341ecfe3beb8.png" alt="gambar"><br><br>  Cukup kirimkan pesan permintaan setoran dari @lntxbot ke @atomic_tipbot dan voul'a! <br><br>  Ini bukan hanya "mentransfer nomor ke database", tetapi pembayaran antara dua database yang berbeda dan tidak terkait.  Dengan demikian, beberapa "LApps" sudah terintegrasi ke dalam bot, di antaranya: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sat2.io</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">lnsms.world</a> . <br><br>  <b>Apa yang <i>dimaksud dengan integrasi LApp</i> ?</b> <br><br>  Setiap node <i>Lightning Network</i> pada dasarnya adalah dompet Bitcoin.  Dia memiliki dua saldo: on-chain dan off-chain.  Saldo on-chain diperlukan untuk membuka saluran baru dan menyimpan dana dari saluran tertutup.  Tetapi keseimbangan off-chain adalah apa yang terjadi di antara node.  Persyaratan utama untuk sebuah node adalah menerima dan mengirim pembayaran, sehingga setiap node sebagai perangkat lunak memiliki fungsi <i><b>pembayaran</b></i> dan <i><b>faktur</b></i> .  Saya akan menunjukkan bagaimana ini terjadi: <br><br><pre><code class="bash hljs">user@ln-node:/ % lightning-cli invoice 1000000000 internal_description external_description { <span class="hljs-string"><span class="hljs-string">"payment_hash"</span></span> : <span class="hljs-string"><span class="hljs-string">"64c0c8f5f8f708b08487ad1376f3d256f92ccb9606987ba395c2b4193efde5a0"</span></span>, <span class="hljs-string"><span class="hljs-string">"expires_at"</span></span> : 1558709834, <span class="hljs-string"><span class="hljs-string">"bolt11"</span></span> : <span class="hljs-string"><span class="hljs-string">"lnbc10m1pwdaj72pp5vnqv3a0c7uytppy845fhdu7j2mujejukq6v8hgu4c26pj0hauksqdpqv4u8getjdeskchmyv4ekxunfwp6xjmmwxqyjw5qcqp2rzjqw3qcrp2u3ggke56wrjlstcg76drmfw680cvjum88sl7ja7mpas7xzxz8sqqfecqqyqqqqlgqqqqqqgqjqn8e3ml733dkms2txxldnuwsllwhhkldss73268hdka3e7f083vjhjqurwqrndqd2rcd85pw7vkywnr4dq7yfd59r0g2mw4wzztwr6dcprxzej6"</span></span> }</code> </pre> <br>  Kami mendapatkan "faktur" dari spesifikasi <a href="">BOLT11</a> dalam kasus ini, yang merupakan format pembayaran pada jaringan Bitcoin (dan omong-omong, Litecoin juga).  Ini adalah baris yang berisi informasi tentang penerima, jumlah transaksi, waktu kedaluwarsa permintaan, dll., Informasi terperinci dapat diperoleh dengan menjalankan decodepay sehubungan dengan baris ini: <br><br><pre> <code class="bash hljs">user@ln-node:/ % lightning-cli decodepay lnbc10m1pwdaj72pp5vnqv3a0c7uytppy845fhdu7j2mujejukq6v8hgu4c26pj0hauksqdpqv4u8getjdeskchmyv4ekxunfwp6xjmmwxqyjw5qcqp2rzjqw3qcrp2u3ggke56wrjlstcg76drmfw680cvjum88sl7ja7mpas7xzxz8sqqfecqqyqqqqlgqqqqqqgqjqn8e3ml733dkms2txxldnuwsllwhhkldss73268hdka3e7f083vjhjqurwqrndqd2rcd85pw7vkywnr4dq7yfd59r0g2mw4wzztwr6dcprxzej6 { <span class="hljs-string"><span class="hljs-string">"currency"</span></span> : <span class="hljs-string"><span class="hljs-string">"bc"</span></span>, <span class="hljs-string"><span class="hljs-string">"created_at"</span></span> : 1558105034, <span class="hljs-string"><span class="hljs-string">"expiry"</span></span> : 604800, <span class="hljs-string"><span class="hljs-string">"payee"</span></span> : <span class="hljs-string"><span class="hljs-string">"025a14b8ed40583d67aec92da19453e0b2d1fbbf75f96f85d3dd0ff61a51ee0490"</span></span>, <span class="hljs-string"><span class="hljs-string">"msatoshi"</span></span> : 1000000000, <span class="hljs-string"><span class="hljs-string">"amount_msat"</span></span> : <span class="hljs-string"><span class="hljs-string">"1000000000msat"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span> : <span class="hljs-string"><span class="hljs-string">"external_description"</span></span>, <span class="hljs-string"><span class="hljs-string">"min_final_cltv_expiry"</span></span> : 10, <span class="hljs-string"><span class="hljs-string">"routes"</span></span> : [ [ { <span class="hljs-string"><span class="hljs-string">"pubkey"</span></span> : <span class="hljs-string"><span class="hljs-string">"03a20c0c2ae4508b669a70e5f82f08f69a3da5da3bf0c973673c3fe977db0f61e3"</span></span>, <span class="hljs-string"><span class="hljs-string">"short_channel_id"</span></span> : <span class="hljs-string"><span class="hljs-string">"574012x1255x1"</span></span>, <span class="hljs-string"><span class="hljs-string">"fee_base_msat"</span></span> : 1000, <span class="hljs-string"><span class="hljs-string">"fee_proportional_millionths"</span></span> : 1, <span class="hljs-string"><span class="hljs-string">"cltv_expiry_delta"</span></span> : 144 } ] ], <span class="hljs-string"><span class="hljs-string">"payment_hash"</span></span> : <span class="hljs-string"><span class="hljs-string">"64c0c8f5f8f708b08487ad1376f3d256f92ccb9606987ba395c2b4193efde5a0"</span></span>, <span class="hljs-string"><span class="hljs-string">"signature"</span></span> : <span class="hljs-string"><span class="hljs-string">"304502210099f31dffd18b6db8296637db3e3a1ffbaf7b7db087a2ad1eedb7639f25e78b25022079038370073681aa1e1a7a05de6588e98ead078896d0a37a15b755c212dc3d37"</span></span> }</code> petir-cli decodepay lnbc10m1pwdaj72pp5vnqv3a0c7uytppy845fhdu7j2mujejukq6v8hgu4c26pj0hauksqdpqv4u8getjdeskchmyv4ekxunfwp6xjmmwxqyjw5qcqp2rzjqw3qcrp2u3ggke56wrjlstcg76drmfw680cvjum88sl7ja7mpas7xzxz8sqqfecqqyqqqqlgqqqqqqgqjqn8e3ml733dkms2txxldnuwsllwhhkldss73268hdka3e7f083vjhjqurwqrndqd2rcd85pw7vkywnr4dq7yfd59r0g2mw4wzztwr6dcprxzej6 <code class="bash hljs">user@ln-node:/ % lightning-cli decodepay lnbc10m1pwdaj72pp5vnqv3a0c7uytppy845fhdu7j2mujejukq6v8hgu4c26pj0hauksqdpqv4u8getjdeskchmyv4ekxunfwp6xjmmwxqyjw5qcqp2rzjqw3qcrp2u3ggke56wrjlstcg76drmfw680cvjum88sl7ja7mpas7xzxz8sqqfecqqyqqqqlgqqqqqqgqjqn8e3ml733dkms2txxldnuwsllwhhkldss73268hdka3e7f083vjhjqurwqrndqd2rcd85pw7vkywnr4dq7yfd59r0g2mw4wzztwr6dcprxzej6 { <span class="hljs-string"><span class="hljs-string">"currency"</span></span> : <span class="hljs-string"><span class="hljs-string">"bc"</span></span>, <span class="hljs-string"><span class="hljs-string">"created_at"</span></span> : 1558105034, <span class="hljs-string"><span class="hljs-string">"expiry"</span></span> : 604800, <span class="hljs-string"><span class="hljs-string">"payee"</span></span> : <span class="hljs-string"><span class="hljs-string">"025a14b8ed40583d67aec92da19453e0b2d1fbbf75f96f85d3dd0ff61a51ee0490"</span></span>, <span class="hljs-string"><span class="hljs-string">"msatoshi"</span></span> : 1000000000, <span class="hljs-string"><span class="hljs-string">"amount_msat"</span></span> : <span class="hljs-string"><span class="hljs-string">"1000000000msat"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span> : <span class="hljs-string"><span class="hljs-string">"external_description"</span></span>, <span class="hljs-string"><span class="hljs-string">"min_final_cltv_expiry"</span></span> : 10, <span class="hljs-string"><span class="hljs-string">"routes"</span></span> : [ [ { <span class="hljs-string"><span class="hljs-string">"pubkey"</span></span> : <span class="hljs-string"><span class="hljs-string">"03a20c0c2ae4508b669a70e5f82f08f69a3da5da3bf0c973673c3fe977db0f61e3"</span></span>, <span class="hljs-string"><span class="hljs-string">"short_channel_id"</span></span> : <span class="hljs-string"><span class="hljs-string">"574012x1255x1"</span></span>, <span class="hljs-string"><span class="hljs-string">"fee_base_msat"</span></span> : 1000, <span class="hljs-string"><span class="hljs-string">"fee_proportional_millionths"</span></span> : 1, <span class="hljs-string"><span class="hljs-string">"cltv_expiry_delta"</span></span> : 144 } ] ], <span class="hljs-string"><span class="hljs-string">"payment_hash"</span></span> : <span class="hljs-string"><span class="hljs-string">"64c0c8f5f8f708b08487ad1376f3d256f92ccb9606987ba395c2b4193efde5a0"</span></span>, <span class="hljs-string"><span class="hljs-string">"signature"</span></span> : <span class="hljs-string"><span class="hljs-string">"304502210099f31dffd18b6db8296637db3e3a1ffbaf7b7db087a2ad1eedb7639f25e78b25022079038370073681aa1e1a7a05de6588e98ead078896d0a37a15b755c212dc3d37"</span></span> }</code> </pre><br>  Tetapi untuk membayar “faktur” seperti itu kita membutuhkan fungsi pembayaran dari c-lightning: <br><br><pre> <code class="bash hljs">user@ln-node:/ % lightning-cli pay lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j { <span class="hljs-string"><span class="hljs-string">"id"</span></span> : 163, <span class="hljs-string"><span class="hljs-string">"payment_hash"</span></span> : <span class="hljs-string"><span class="hljs-string">"c3e644a005f56e33df89facbce2c9dfcabbef5d105285a98272cacc77ab2de63"</span></span>, <span class="hljs-string"><span class="hljs-string">"destination"</span></span> : <span class="hljs-string"><span class="hljs-string">"03021c5f5f57322740e4ee6936452add19dc7ea7ccf90635f95119ab82a62ae268"</span></span>, <span class="hljs-string"><span class="hljs-string">"msatoshi"</span></span> : 200000, <span class="hljs-string"><span class="hljs-string">"amount_msat"</span></span> : <span class="hljs-string"><span class="hljs-string">"200000msat"</span></span>, <span class="hljs-string"><span class="hljs-string">"msatoshi_sent"</span></span> : 200003, <span class="hljs-string"><span class="hljs-string">"amount_sent_msat"</span></span> : <span class="hljs-string"><span class="hljs-string">"200003msat"</span></span>, <span class="hljs-string"><span class="hljs-string">"created_at"</span></span> : 1558106072, <span class="hljs-string"><span class="hljs-string">"status"</span></span> : <span class="hljs-string"><span class="hljs-string">"complete"</span></span>, <span class="hljs-string"><span class="hljs-string">"payment_preimage"</span></span> : <span class="hljs-string"><span class="hljs-string">"1a9552b9f4e9199e26839353f870b12cc85b7674a2fb134e78aa370032611019"</span></span>, <span class="hljs-string"><span class="hljs-string">"bolt11"</span></span> : <span class="hljs-string"><span class="hljs-string">"lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j"</span></span> }</code> petir-cli membayar lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j <code class="bash hljs">user@ln-node:/ % lightning-cli pay lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j { <span class="hljs-string"><span class="hljs-string">"id"</span></span> : 163, <span class="hljs-string"><span class="hljs-string">"payment_hash"</span></span> : <span class="hljs-string"><span class="hljs-string">"c3e644a005f56e33df89facbce2c9dfcabbef5d105285a98272cacc77ab2de63"</span></span>, <span class="hljs-string"><span class="hljs-string">"destination"</span></span> : <span class="hljs-string"><span class="hljs-string">"03021c5f5f57322740e4ee6936452add19dc7ea7ccf90635f95119ab82a62ae268"</span></span>, <span class="hljs-string"><span class="hljs-string">"msatoshi"</span></span> : 200000, <span class="hljs-string"><span class="hljs-string">"amount_msat"</span></span> : <span class="hljs-string"><span class="hljs-string">"200000msat"</span></span>, <span class="hljs-string"><span class="hljs-string">"msatoshi_sent"</span></span> : 200003, <span class="hljs-string"><span class="hljs-string">"amount_sent_msat"</span></span> : <span class="hljs-string"><span class="hljs-string">"200003msat"</span></span>, <span class="hljs-string"><span class="hljs-string">"created_at"</span></span> : 1558106072, <span class="hljs-string"><span class="hljs-string">"status"</span></span> : <span class="hljs-string"><span class="hljs-string">"complete"</span></span>, <span class="hljs-string"><span class="hljs-string">"payment_preimage"</span></span> : <span class="hljs-string"><span class="hljs-string">"1a9552b9f4e9199e26839353f870b12cc85b7674a2fb134e78aa370032611019"</span></span>, <span class="hljs-string"><span class="hljs-string">"bolt11"</span></span> : <span class="hljs-string"><span class="hljs-string">"lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j"</span></span> }</code> </pre><br>  Semua status transaksi ditangani oleh seluruh jaringan dan simpul Anda sendiri secara khusus.  Tidak perlu (tetapi ada kesempatan seperti itu) untuk berinteraksi dengan penulis aplikasi penerima pembayaran atau API mereka untuk mendapatkan informasi tentang status pembayaran.  Tidak perlu memeriksa status pembayaran dalam sistem pemrosesan perantara.  Tidak perlu mengharapkan persetujuan transaksi Anda dari bank atau lembaga pemerintah.  Pada akhirnya, tidak ada serangan balik dan faktor eksternal lainnya yang dapat memengaruhi saldo di akun Anda.  Ini adalah solusi untuk memindahkan nilai melalui Internet, tanpa perlu arbiter eksternal yang memutuskan apakah transaksi sesuai dengan aturan (kadang-kadang bahkan aturan internal, yang tidak semua peserta diberitahu sebelumnya) atau tidak.  Tidak ada "aturan internal" dalam bitcoin.  Satu-satunya aturan yang perlu Anda ikuti adalah aturan jaringan - terbuka dan terkenal. <br><br>  Ini membuat transaksi uang <b>langsung</b> , <b>praktis gratis</b> dan <b>instan</b> antara orang atau program menjadi nyata. <br><br>  Jika Anda memiliki kesempatan untuk menerima data pembayaran dari aplikasi pihak ketiga, maka dimungkinkan untuk berinteraksi secara finansial dengan aplikasi ini.  Sebagai contoh, pertimbangkan layanan lnsms.world, yang memungkinkan Anda mengirim pesan SMS ke nomor sewenang-wenang dengan membayarnya dengan bitcoin.  Untuk mengintegrasikan aplikasi ini, kita hanya perlu mentransfer data dari formulir web langsung ke skrip pengiriman SMS - untuk meniru tindakan pengguna di situs web: <br><br><pre> <code class="python hljs">payload = { <span class="hljs-string"><span class="hljs-string">'number'</span></span>: phone_number, <span class="hljs-string"><span class="hljs-string">'text'</span></span>: text, <span class="hljs-string"><span class="hljs-string">'force_unicode'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> } send_req = requests.post(<span class="hljs-string"><span class="hljs-string">'https://lnsms.world/invoice'</span></span>, data=payload) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> send_req.status_code == <span class="hljs-number"><span class="hljs-number">201</span></span>: plain_invoice = str(send_req.text)</code> </pre><br>  Saya tidak tahu untuk alasan apa, tetapi lnsms merespons dengan 201 kode status HTTP dan mengembalikan faktur format BOLT11.  Nah, ini cukup bagi pengguna bot untuk membayar mengirim SMS dari saldo mereka yang diterima di chat room.  Pengguna bahkan tidak tahu apa yang terjadi di sana, ia hanya membayar beberapa sen untuk mengirim SMS.  Dan saya, sebagai pengembang, tidak masuk ke rincian pekerjaan layanan SMS.  Baru saja meneruskan pembayaran dan menerima layanan.  Anda dapat membuat mark-up di atas, tetapi Anda tidak dapat melakukannya - ini adalah pilihan bebas saya.  Tidak ada akun, perjanjian atau API lain untuk tugas sepele seperti mengirim SMS. <br><br>  Dan sekarang mari kita bayangkan sejenak bahwa aplikasi kita adalah sesuatu yang lebih berguna daripada bot obrolan dan melakukan pembayaran bukan ke bot lain, tetapi ke aplikasi atau perangkat lain yang terhubung ke Internet.  Atau lusinan atau bahkan ratusan pembayaran tidak penting setiap detik antara perangkat, layanan, toko, atau semacam penyedia layanan.  Ini adalah kekuatan pembayaran mikro, jadi Internet seharusnya terlihat seperti itu.  Sudah ada proyek seperti <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Althea</a> yang menghidupkan ide-ide ini dan dalam waktu dekat kita akan melihat perubahan besar dalam area yang sekarang kita sebut e-commerce. <br><br>  Jika Anda menyukai pos dan ingin mencoba bitcoin dalam aksi - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kirimkan saya bir dan roti Prancis yang lembut</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id452696/">https://habr.com/ru/post/id452696/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id452684/index.html">Mengembangkan game di Svelte 3</a></li>
<li><a href="../id452686/index.html">Spionase yang tidak dilarang (cerita dari tahun 80-an)</a></li>
<li><a href="../id452688/index.html">Layanan Windows. Cari kesalahan sistem dan tampilkan di WinForm C #</a></li>
<li><a href="../id452690/index.html">Apa yang begitu menarik tentang Kereta Api Trans-Siberia?</a></li>
<li><a href="../id452692/index.html">Penulis proyek rePalm menulis ulang Palm OS dari awal dan berencana mengubahnya menjadi platform jam tangan pintar</a></li>
<li><a href="../id452698/index.html">Dua dalam satu: data turis dan tiket untuk acara budaya tersedia untuk umum</a></li>
<li><a href="../id452700/index.html">Berita dari dunia OpenStreetMap No. 460 (05/07/2019 - 05/05/2019)</a></li>
<li><a href="../id452702/index.html">Tes untuk kode dan kode untuk tes</a></li>
<li><a href="../id452704/index.html">Debugging post-mortem pada Cortex-M</a></li>
<li><a href="../id452706/index.html">Pada tahun 1983, komputer ini dari Bella Labs menjadi grandmaster pertama.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>