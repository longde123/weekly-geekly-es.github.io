<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚Ü©Ô∏è üçΩÔ∏è ü§üüèª ADSM3. IPAM / DCIM-Systeme üë± üóëÔ∏è üöô</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In der vorherigen ADSM-Serie haben wir das Automatisierungsframework entwickelt und herausgefunden, warum die Virtualisierung angezeigt wird und wie s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ADSM3. IPAM / DCIM-Systeme</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/486000/"> In der vorherigen ADSM-Serie haben wir das Automatisierungsframework entwickelt und herausgefunden, warum die Virtualisierung angezeigt wird und wie sie funktioniert.  Im <a href="https://linkmeup.ru/blog/479.html" rel="nofollow">letzten Teil haben</a> wir das Netzwerkdesign, die Rollen der Ger√§te und Hersteller ausgew√§hlt und begr√ºndet und uns f√ºr LLD entschieden (Adressierung, Routing, Anzahl autonomer Systeme). <br><br>  Jetzt sind wir bereit zu √ºberlegen, wie wir diesen ganzen Berg an Informationen speichern und sp√§ter bequem abrufen k√∂nnen. <br><br>  Nein, nat√ºrlich gibt es heutzutage Unternehmen, die die zugewiesenen IP-Adressen in einer Excel-Tabelle nachverfolgen.  Das ist aber nicht unser Weg. <br><br>  Selbst f√ºr das kleinste B√ºro in einigen Filialen schadet das Vorhandensein eines zentralen IP-Space-Management-Systems nicht. <br><br>  Die Notwendigkeit eines Inventarsystems liegt auf der Hand. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b44/a21/5cc/b44a215cc7c93ecf6eeca48c41d721d9.svg" width="800"><br><br>  Alle Ausgaben von ADSM: <br><br>  <a href="https://habr.com/ru/post/453516/">0. ADSM.</a>  <a href="https://habr.com/ru/post/453516/">Teil Null.</a>  <a href="https://habr.com/ru/post/453516/">Planung</a> <br>  <a href="https://habr.com/ru/post/458622/">1. ADSM.</a>  <a href="https://habr.com/ru/post/458622/">Teil Eins (der nach Null ist).</a>  <a href="https://habr.com/ru/post/458622/">Netzwerkvirtualisierung</a> <br>  <a href="https://habr.com/ru/post/475614/">2. ADSM.</a>  <a href="https://habr.com/ru/post/475614/">Zweiter Teil.</a>  <a href="https://habr.com/ru/post/475614/">Netzwerkdesign</a> <br>  <a href="https://habr.com/ru/post/485618/">3. ADSM.</a>  <a href="https://habr.com/ru/post/485618/">Dritter Teil.</a>  <a href="https://habr.com/ru/post/485618/">IPAM / DCIM-System</a> <br><br>  Diese Ausgabe widme ich den integralen Systemen in der Netzwerkautomatisierung - dem Adressraum-Managementsystem und dem Inventarsystem. <br><br>  Wir werden es ausw√§hlen und installieren, wir werden uns mit der Architektur, dem Datenbankschema, den Interaktionsschnittstellen befassen und es f√ºllen.  In den folgenden Abschnitten werden einfache Skripts geschrieben, die sich wiederholende Vorg√§nge automatisieren, z. B. das Hinzuf√ºgen neuer Racks. <br><br>  Dar√ºber hinaus habe ich bereits einen separaten Artikel √ºber die <a href="https://habr.com/ru/post/485618/">RESTful-API ver√∂ffentlicht</a> , in dem ich einen kurzen √úberblick √ºber ihre Prinzipien und ihre Arbeit gegeben habe. Wir werden sie brauchen. <br><a name="habracut"></a><br><h1>  Inhalt </h1><br><ul><li>  <b>Systemarchitektur</b> </li><li>  <b>NetBox-Datenschema</b> </li><li>  <b>Fazit</b> </li><li>  <b>Einige Nuancen der Installation von NetBox</b> </li><li>  <b>Ein bisschen √ºber PostgreSQL</b> </li><li>  <b>N√ºtzliche Links</b> </li></ul><br>  Heute bietet der Markt rund ein Dutzend Tools an, die diese Aufgabe erf√ºllen: sowohl kostenpflichtige als auch Open Source-Tools. <br><br>  F√ºr die Aufgaben in dieser Artikelserie habe ich mich aus folgenden Gr√ºnden f√ºr NetBox entschieden: <br><br><ol><li>  Es ist kostenlos </li><li>  Es enth√§lt beide notwendigen Teile - Inventar und IP-Speicherverwaltung. </li><li>  Es hat eine RESTful API. </li><li>  Es wurde von Digital Ocean (und insbesondere von Jeremy Stretch geliebt) f√ºr sich selbst, dh f√ºr Rechenzentren, entwickelt.  Daher gibt es fast alles, was Sie brauchen, und fast nichts mehr. </li><li>  Es wird aktiv unterst√ºtzt (Slack, Github, Google Newsletters) und aktualisiert. </li><li>  Das ist Open Source </li></ol><br><blockquote>  F√ºr die Anforderungen von ADSM habe ich NetBox in einer Virtualochka auf unserem Server bereitgestellt (danke an Anton Klochkov und <a href="https://miran.ru/" rel="nofollow">Miran</a> ): <a href="http://netbox.linkmeup.ru:45127/" rel="nofollow">http://netbox.linkmeup.ru:45127</a> <br>  Au√üerdem habe ich fast alle Daten ausgef√ºllt, die wir in Zukunft ben√∂tigen. <br>  Daher k√∂nnen Sie fast alle Beispiele ausprobieren und das Datenschema im Lesemodus untersuchen, bis Sie Ihre Installation bereitstellen. <br></blockquote>  Ein wenig n√ºtzlich, bevor Sie anfangen: <br><br><ul><li>  <a href="https://github.com/netbox-community/netbox" rel="nofollow">NetBox selbst auf Github</a> </li><li>  <a href="https://github.com/netbox-community/netbox-docker" rel="nofollow">Containerversion</a> </li><li>  <a href="https://netbox.readthedocs.io/en/stable/" rel="nofollow">Vollst√§ndige Installationsanweisungen und alle Produktdokumentationen</a> </li><li>  <a href="https://github.com/digitalocean/pynetbox" rel="nofollow">Python NetKox SDK</a> </li><li>  <a href="http://netbox.linkmeup.ru:45127/api/docs/" rel="nofollow">API-Dokumentation</a> </li><li>  <a href="https://groups.google.com/forum/" rel="nofollow">Mailing-Liste</a> </li><li>  <a href="https://networktocode.slack.com/" rel="nofollow">NetworkToCode Slack Channel</a> </li><li>  <a href="https://habr.com/ru/post/485618/">Was ist REST?</a> </li><li>  <a href="http://netbox.linkmeup.ru:45127/" rel="nofollow">NetBox-Installation f√ºr ADSM</a> </li></ul><br><hr><br><h1>  Systemarchitektur </h1><br><ul><li>  NetBox ist in Python3 geschrieben.  Was gut ist, weil eine Reihe anderer L√∂sungen in PHP geschrieben sind und diese bei Bedarf nicht so einfach zu √§ndern sind. </li><li>  Der Rahmen f√ºr die Website selbst ist Django. </li><li>  Als Datenbank wird PostgreSQL verwendet. </li><li>  WEB-Frontend (HTTP-Service) - NGINX - Proxy f√ºr Anfragen an Gunicron. </li><li>  WSGI - Gunicorn - die Schnittstelle zwischen Nginx und der Anwendung selbst. </li><li>  API-Dokumentations-Framework - Swagger. </li><li>  NetBox - Systemd verteufeln. </li></ul><br><blockquote>  NetBox ist ein junges und schnelles Projekt.  In 2.7 haben sie beispielsweise supervisord und Python 2.7 aufgegeben und zugunsten von systemd danach gegriffen.  Vor nicht allzu langer Zeit gab es weder Caching noch Webhooks. <br><br>  Daher √§ndert sich alles schnell und die Informationen im Artikel k√∂nnen zum Zeitpunkt des Lesens veraltet sein. <br></blockquote><br>  Mit anderen Worten, alle Komponenten sind ausgereift und getestet. <br><br>  Laut dem Autor spiegelt NetBox nicht den tats√§chlichen Zustand des Netzwerks wider, sondern das Ziel.  Aus diesem Grund wird aus dem Netzwerk nichts in die NetBox geladen - dieses Netzwerk wird entsprechend dem Inhalt der NetBox konfiguriert. <br>  Somit fungiert NetBox als einzige Wahrheitsquelle (Transparentpapier mit einer einzigen Wahrheitsquelle). <br><br>  Und √Ñnderungen im Netzwerk m√ºssen durch √Ñnderungen an der NetBox ausgel√∂st werden. <br><br>  Und es passt sehr gut zu der Ideologie, die ich in dieser Artikelserie bekenne - wenn Sie √Ñnderungen im Netzwerk vornehmen m√∂chten -, nehmen Sie sie zuerst im System vor. <br><br><hr><br><h1>  NetBox-Datenschema </h1><br>  Die beiden Hauptaufgaben, die NetBox l√∂st, sind Adressraumverwaltung und Inventarisierung. <br><br>  Es ist unwahrscheinlich, dass NetBox das einzige Inventarsystem im Unternehmen wird, sondern ein spezielles zus√§tzliches System zur Inventarisierung des Netzwerks, das Daten aus dem Hauptnetzwerk entnimmt. <br><br>  In unserem Fall wird es nat√ºrlich nur NetBox f√ºr ADSM-Zwecke geben. <br><blockquote>  Zu diesem Zeitpunkt wurden die meisten anf√§nglichen Daten in NetBox bereits eingegeben. <br>  Anhand dieser Daten zeige ich verschiedene Beispiele f√ºr die Arbeit mit der API. <br>  Sie k√∂nnen einfach klettern und sehen: <a href="http://netbox.linkmeup.ru/" rel="nofollow">netbox.linkmeup.ru</a> : 45127 <br>  Und die gleichen Daten werden in Zukunft ben√∂tigt, wenn wir zur Automatisierung √ºbergehen. <br></blockquote>  Im Allgemeinen kann das Datenschema vom Datenbankschema in Postgres eingesehen werden. <br><br><pre><code class="bash hljs">List of relations Schema | Name | Type | Owner --------+------------------------------------+-------+-------- public | auth_group | table | netbox public | auth_group_permissions | table | netbox public | auth_permission | table | netbox public | auth_user | table | netbox public | auth_user_groups | table | netbox public | auth_user_user_permissions | table | netbox public | circuits_circuit | table | netbox public | circuits_circuittermination | table | netbox public | circuits_circuittype | table | netbox public | circuits_provider | table | netbox public | dcim_cable | table | netbox public | dcim_consoleport | table | netbox public | dcim_consoleporttemplate | table | netbox public | dcim_consoleserverport | table | netbox public | dcim_consoleserverporttemplate | table | netbox public | dcim_device | table | netbox public | dcim_devicebay | table | netbox public | dcim_devicebaytemplate | table | netbox public | dcim_devicerole | table | netbox public | dcim_devicetype | table | netbox public | dcim_frontport | table | netbox public | dcim_frontporttemplate | table | netbox public | dcim_interface | table | netbox public | dcim_interface_tagged_vlans | table | netbox public | dcim_interfacetemplate | table | netbox public | dcim_inventoryitem | table | netbox public | dcim_manufacturer | table | netbox public | dcim_platform | table | netbox public | dcim_powerfeed | table | netbox public | dcim_poweroutlet | table | netbox public | dcim_poweroutlettemplate | table | netbox public | dcim_powerpanel | table | netbox public | dcim_powerport | table | netbox public | dcim_powerporttemplate | table | netbox public | dcim_rack | table | netbox public | dcim_rackgroup | table | netbox public | dcim_rackreservation | table | netbox public | dcim_rackrole | table | netbox public | dcim_rearport | table | netbox public | dcim_rearporttemplate | table | netbox public | dcim_region | table | netbox public | dcim_site | table | netbox public | dcim_virtualchassis | table | netbox public | django_admin_log | table | netbox public | django_content_type | table | netbox public | django_migrations | table | netbox public | django_session | table | netbox public | extras_configcontext | table | netbox public | extras_configcontext_platforms | table | netbox public | extras_configcontext_regions | table | netbox public | extras_configcontext_roles | table | netbox public | extras_configcontext_sites | table | netbox public | extras_configcontext_tags | table | netbox public | extras_configcontext_tenant_groups | table | netbox public | extras_configcontext_tenants | table | netbox public | extras_customfield | table | netbox public | extras_customfield_obj_type | table | netbox public | extras_customfieldchoice | table | netbox public | extras_customfieldvalue | table | netbox public | extras_customlink | table | netbox public | extras_exporttemplate | table | netbox public | extras_graph | table | netbox public | extras_imageattachment | table | netbox public | extras_objectchange | table | netbox public | extras_reportresult | table | netbox public | extras_tag | table | netbox public | extras_taggeditem | table | netbox public | extras_webhook | table | netbox public | extras_webhook_obj_type | table | netbox public | ipam_aggregate | table | netbox public | ipam_ipaddress | table | netbox public | ipam_prefix | table | netbox public | ipam_rir | table | netbox public | ipam_role | table | netbox public | ipam_service | table | netbox public | ipam_service_ipaddresses | table | netbox public | ipam_vlan | table | netbox public | ipam_vlangroup | table | netbox public | ipam_vrf | table | netbox public | secrets_secret | table | netbox public | secrets_secretrole | table | netbox public | secrets_secretrole_groups | table | netbox public | secrets_secretrole_users | table | netbox public | secrets_sessionkey | table | netbox public | secrets_userkey | table | netbox public | taggit_tag | table | netbox public | taggit_taggeditem | table | netbox public | tenancy_tenant | table | netbox public | tenancy_tenantgroup | table | netbox public | users_token | table | netbox public | virtualization_cluster | table | netbox public | virtualization_clustergroup | table | netbox public | virtualization_clustertype | table | netbox public | virtualization_virtualmachine | table | netbox</code> </pre> <br>  <a href="https://netbox.readthedocs.io/en/stable/" rel="nofollow">NetBox-Funktionen</a> : <br><br><ul><li>  <b>IP-Adressverwaltung (IPAM)</b> - IP-Pr√§fixe, Adressen, VRFs und VLANs </li><li>  <b>Ger√§teracks</b> - <b>Ger√§teracks,</b> sortiert nach Standort, Gruppe und Rolle </li><li>  <b>Ger√§te</b> - Ger√§te, ihre Modelle, Rollen, Komponenten und Bereitstellung </li><li>  <b>Verbindungen</b> - Netzwerk-, Konsolen- und Stromverbindungen zwischen Ger√§ten </li><li>  <b>Virtualisierung</b> - Virtuelle Maschinen und Computing-Cluster </li><li>  <b>Datenleitungen</b> - Provider-Verbindungen </li><li>  <b>Geheimnisse</b> - Speicherung von verschl√ºsselten Benutzeranmeldeinformationen </li></ul><br>  In diesem Artikel werde ich auf die folgenden Dinge eingehen: DCIM - Verwaltung der Rechenzentrumsinfrastruktur, IPAM - Verwaltung der IP-Adressen, Virtualisierung, Weitere n√ºtzliche Dinge. <br><br><hr><br>  Das Wichtigste zuerst. <br><br><h2>  DCIM </h2><br>  Der wichtigste Teil ist zweifellos, welche Ausr√ºstung wir haben und wie sie miteinander verbunden ist.  Aber alles beginnt dort, <b>wo</b> es steht. <br><br><h3>  Regionen und Standorte (Regionen / Standorte) </h3><br>  Im NetBox-Paradigma wird ein Ger√§t auf einem Standort installiert, ein Standort geh√∂rt zu einer Region, Regionen k√∂nnen verschachtelt werden.  Das Ger√§t kann jedoch nicht einfach in der Region installiert werden.  Wenn dies erforderlich ist, sollte ein separater Standort eingerichtet werden. <br><br>  In unserem Fall kann (und wird) dies so aussehen: <br><br><ul><li>  <a href="http://netbox.linkmeup.ru:45127/dcim/sites/%3Fregion%3Dru" rel="nofollow">Russland</a> : <a href="http://netbox.linkmeup.ru:45127/dcim/sites/msk/" rel="nofollow">Moskau</a> , <a href="http://netbox.linkmeup.ru:45127/dcim/sites/kzn/" rel="nofollow">Kasan</a> </li><li>  <a href="http://netbox.linkmeup.ru:45127/dcim/sites/%3Fregion%3Dsp" rel="nofollow">Spanien</a> : <a href="http://netbox.linkmeup.ru:45127/dcim/sites/bcn/" rel="nofollow">Barcelona</a> , <a href="http://netbox.linkmeup.ru:45127/dcim/sites/mlg/" rel="nofollow">Malaga</a> </li><li>  <a href="http://netbox.linkmeup.ru:45127/dcim/sites/%3Fregion%3Dcn" rel="nofollow">China</a> : <a href="http://netbox.linkmeup.ru:45127/dcim/sites/sha/" rel="nofollow">Shanghai</a> , <a href="http://netbox.linkmeup.ru:45127/dcim/sites/Sia/" rel="nofollow">Xi'an</a> . </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/703/ab7/358/703ab73587ab4d1fe9079aa548ba93d1.png" width="800"><br><br>  Ich erinnere Sie daran, wo und wie wir unser Netzwerk geplant haben: <a href="https://linkmeup.ru/blog/479.html" rel="nofollow">ADSM2.</a>  <a href="https://linkmeup.ru/blog/479.html" rel="nofollow">Netzwerkdesign</a> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1df/012/888/1df0128888e0708959f6108e176a0de9.png" width="700"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d5d/b34/709/d5db34709814c8e1fe07f74b8c9f96fd.png" width="800"><br><br>  Mal sehen, was die API erlaubt. <br><br>  Hier ist eine Liste aller Regionen: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/regions/"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.dcim.regions.all()</code> </pre> <br><blockquote>  Im Folgenden werde ich Beispiele f√ºr Curl und Pynetbox geben, ohne das Ergebnis auszugeben. <br>  <b>Vergessen Sie nicht den</b> Schr√§gstrich am Ende der URL. Ohne diesen funktioniert es nicht. <br>  Ich habe in einem Artikel √ºber die <a href="https://habr.com/ru/post/485618/">RESTful-API</a> √ºber die Verwendung von pynetbox gesprochen. <br></blockquote>  Holen Sie sich die Liste der Websites: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/sites/"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.dcim.sites.all()</code> </pre><br>  Liste der Standorte in einer bestimmten Region: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/sites/?region=ru"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.dcim.sites.filter(region=<span class="hljs-string"><span class="hljs-string">"ru"</span></span>)</code> </pre><br><blockquote>  Bitte beachten Sie, dass die Suche nicht nach dem vollst√§ndigen Namen, sondern nach der sogenannten <a href="https://qna.habr.com/q/375615" rel="nofollow">Schnecke erfolgt</a> . <br>  <b>Slug</b> ist eine Kennung, die nur sichere Zeichen enth√§lt: [0-9A-Za-z-_], die in der URL verwendet werden k√∂nnen.  Es wird festgelegt, wenn ein Objekt erstellt wird, z. B. "bcn" anstelle von "Barcelona". <br><img src="https://habrastorage.org/getpro/habr/post_images/3db/6cc/f89/3db6ccf89097c571900457aebbc922fe.png" width="400"><br></blockquote><br><hr><br><h3>  Ger√§te </h3><br>  Das Ger√§t selbst hat eine <a href="http://netbox.linkmeup.ru:45127/dcim/device-roles/" rel="nofollow">Rolle</a> , zum Beispiel Blatt, R√ºcken, Kante, Rand. <br><br>  Es ist offensichtlich eine Art <a href="http://netbox.linkmeup.ru:45127/dcim/device-types/" rel="nofollow">Modell eines</a> <a href="http://netbox.linkmeup.ru:45127/dcim/manufacturers/" rel="nofollow">Anbieters</a> . <br>  Zum Beispiel <a href="http://netbox.linkmeup.ru:45127/dcim/device-types/%3Fmanufacturer%3Darista" rel="nofollow">Arista</a> . <br><br>  Auf diese Weise wird zuerst ein Kreditor erstellt und dann innerhalb des Modells. <br><br>  <a href="http://netbox.linkmeup.ru:45127/dcim/device-types/2/" rel="nofollow">Das Modell ist</a> durch einen Namen, eine Reihe von Serviceschnittstellen, eine Fernsteuerungsschnittstelle, einen Konsolenport und eine Reihe von Leistungsmodulen gekennzeichnet. <br><br>  Zus√§tzlich zu Switches, Routern und Hosts mit Ethernet-Schnittstellen k√∂nnen Sie Konsolenserver erstellen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/826/9a4/f9f/8269a4f9ffb7f7e66096eff89dc19013.png" width="800"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c81/cce/0f9/c81cce0f9d543eedd4f7c1e1ede5f43f.png" width="500"><br><br>  Liste aller Ger√§te abrufen: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/devices/"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.dcim.devices.all()</code> </pre><br>  Alle Ger√§te f√ºr einen bestimmten Standort: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/devices/?site=mlg"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.dcim.devices.filter(site=<span class="hljs-string"><span class="hljs-string">"mlg"</span></span>)</code> </pre><br>  Alle Ger√§te eines bestimmten Modells <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/devices/?model=veos"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.dcim.devices.filter(device_type_id=<span class="hljs-number"><span class="hljs-number">2</span></span>)</code> </pre><br>  Alle Ger√§te mit einer bestimmten Rolle: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/devices/?role=leaf"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.dcim.devices.filter(role=<span class="hljs-string"><span class="hljs-string">"leaf"</span></span>)</code> </pre><br>  Das Ger√§t kann sich in verschiedenen Status befinden: Aktiv, Offline, Geplant usw. <br><br>  Alle aktiven Ger√§te: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/devices/?status=active"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.dcim.devices.filter(status=<span class="hljs-string"><span class="hljs-string">"active"</span></span>)</code> </pre><br><hr><br><h3>  Schnittstellen </h3><br>  NetBox unterst√ºtzt viele Arten von physischen <a href="http://netbox.linkmeup.ru:45127/api/dcim/_choices/" rel="nofollow">Schnittstellen</a> und LAGs. Alle virtuellen <a href="http://netbox.linkmeup.ru:45127/api/dcim/_choices/" rel="nofollow">Schnittstellen</a> wie Vlan / IRB und Loopback werden jedoch unter einem Typ zusammengefasst: Virtuell. <br>  Jede Schnittstelle ist an ein Ger√§t gebunden. <br><br>  Ger√§teschnittstellen k√∂nnen miteinander verbunden werden.  Dies wird sowohl in der Schnittstelle als auch in den API-Antworten (Attribut connected_endpoint) angezeigt. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/aea/c56/b47/aeac56b47e58145211f5726c8e48cb91.png" width="800"><br><br>  Die Schnittstelle kann in verschiedenen Modi betrieben werden: Tagged oder Access. <br><br>  Dementsprechend kann es mit oder ohne VLANs in das Tag gestartet werden - diese Site oder global. <br><br>  Liste aller Ger√§teschnittstellen abrufen: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/interfaces/?device=mlg-leaf-0"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.dcim.interfaces.filter(device=<span class="hljs-string"><span class="hljs-string">"mlg-leaf-0"</span></span>)</code> </pre><br>  Ruft eine Liste der VLANs einer bestimmten Schnittstelle ab. <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/interfaces/?device=mlg-leaf-0&amp;name=Ethernet7"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.dcim.interfaces.get(device=<span class="hljs-string"><span class="hljs-string">"mlg-leaf-0"</span></span>, name=<span class="hljs-string"><span class="hljs-string">"Ethernet7"</span></span>).untagged_vlan.vid</code> </pre><br><blockquote>  Beachten Sie, dass ich hier bereits die Methode <b>get</b> anstelle von <b>filter verwende</b> .  Filter gibt eine Liste zur√ºck, auch wenn das Ergebnis ein einzelnes Objekt ist.  Get - Gibt ein einzelnes Objekt zur√ºck oder schl√§gt fehl, wenn das Abfrageergebnis eine Liste von Objekten ist. <br><br>  Daher sollte get nur verwendet werden, wenn Sie absolut sicher sind, dass das Ergebnis in einer einzelnen Kopie vorliegt. <br><br>  Hier wende ich mich direkt nach der Anfrage den Attributen des Objekts zu.  Streng genommen ist dies falsch: Wenn durch die Anfrage nichts gefunden wurde, gibt pynetbox None zur√ºck und hat nicht das Attribut "untagged_vlan". <br><br>  Und beachten Sie auch, dass Pynetbox nicht √ºberall irgendwo Schnecke und Namen erwartet. <br></blockquote>  Finden Sie heraus, an welche Schnittstelle von welchem ‚Äã‚ÄãGer√§t eine bestimmte Schnittstelle angeschlossen ist: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/interfaces/?device=mlg-leaf-0&amp;name=Ethernet1"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">iface = nb.dcim.interfaces.get(device=<span class="hljs-string"><span class="hljs-string">"mlg-leaf-0"</span></span>, name=<span class="hljs-string"><span class="hljs-string">"Ethernet1"</span></span>) iface.connected_endpoint.device iface.connected_endpoint.name</code> </pre><br>  Ermitteln Sie den Namen der Verwaltungsschnittstelle: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/interfaces/?device=mlg-leaf-0&amp;mgmt_only=true"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.dcim.interfaces.get(device=<span class="hljs-string"><span class="hljs-string">"mlg-leaf-0"</span></span>, mgmt_only=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre><br><hr><br><h3>  Konsolenports </h3><br>  Konsolenports sind keine Schnittstellen, daher werden sie als separate Endpunkte gerendert. <br>  Ger√§teports k√∂nnen Konsolenserverports zugeordnet werden. <br><br>  Finden Sie heraus, an welchem ‚Äã‚ÄãPort auf welchem ‚Äã‚ÄãKonsolenserver ein bestimmtes Ger√§t angeschlossen ist. <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/console-ports/?device=mlg-leaf-0"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.dcim.console_ports.get(device=<span class="hljs-string"><span class="hljs-string">"mlg-leaf-0"</span></span>).serialize()</code> </pre><br><blockquote>  Mit <b>der</b> Methode <b>serialize</b> in pynetbox k√∂nnen Sie die Attribute einer Instanz einer Klasse in ein W√∂rterbuch konvertieren. <br></blockquote><hr><br><h2>  Ipam </h2><br><h3>  VLAN und VRF </h3><br>  Sie k√∂nnen an einen Ort gebunden werden - n√ºtzlich f√ºr VLAN. <br><br>  Beim Erstellen einer VRF k√∂nnen Sie angeben, ob sich der Adressraum mit anderen VRFs √ºberschneiden darf. <br><br>  Liste aller VLANs abrufen: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/ipam/vlans/"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.ipam.vlans.all()</code> </pre><br>  Liste aller VRFs abrufen: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/ipam/vrfs/"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.ipam.vrfs.all()</code> </pre><br><hr><br><h3>  IP-Pr√§fixe </h3><br>  Sie haben eine hierarchische Struktur.  Es kann zu jedem VRF geh√∂ren (wenn nicht, dann Global). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/94b/ea6/8c4/94bea68c425c9a8bd601c9a0da74193e.png" width="800"><br><br>  NetBox bietet eine sehr praktische visuelle Darstellung der freien Pr√§fixe: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1be/90e/14d/1be90e14da8f4c3bedc4bcb892cb5156.png" width="800"><br><br>  Sie k√∂nnen es einfach ausw√§hlen, indem Sie auf die gr√ºne Linie klicken. <br><br>  Es kann an einen Ort angeh√§ngt werden.  Sie k√∂nnen das n√§chste freie Unterpr√§fix der erforderlichen Gr√∂√üe oder die n√§chste freie IP-Adresse √ºber die API ausw√§hlen. <br><br>  Das H√§kchen / der Parameter ‚ÄûIst ein Pool‚Äú legt fest, ob die 0-te Adresse aus diesem Pr√§fix bei der automatischen Auswahl hervorgehoben wird oder ab dem 1. beginnt. <br><br>  Erhalten Sie eine Liste der IP-Pr√§fixe der Malaga-Site mit der Unterlegungsrolle und einer L√§nge von 19: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/ipam/prefixes/?site=mlg&amp;role=underlay&amp;mask_length=19"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">prefix = nb.ipam.prefixes.get(site=<span class="hljs-string"><span class="hljs-string">"mlg"</span></span>, role=<span class="hljs-string"><span class="hljs-string">"underlay"</span></span>, mask_length=<span class="hljs-string"><span class="hljs-string">"19"</span></span>)</code> </pre><br>  Erhalten Sie eine Liste der kostenlosen Pr√§fixe in der Region Russland mit der Rolle "Unterlegen": <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/ipam/prefixes/40/available-prefixes/"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="bash hljs">prefix.available_prefixes.list()</code> </pre> <br>  Markieren Sie das folgende kostenlose 24-Pr√§fix: <br><br><pre> <code class="bash hljs">curl -X POST <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/ipam/prefixes/40/available-prefixes/"</span></span> \ -H <span class="hljs-string"><span class="hljs-string">"accept: application/json"</span></span> \ -H <span class="hljs-string"><span class="hljs-string">"Content-Type: application/json"</span></span> \ -H <span class="hljs-string"><span class="hljs-string">"Authorization: TOKEN a9aae70d65c928a554f9a038b9d4703a1583594f"</span></span> \ -d <span class="hljs-string"><span class="hljs-string">"{\"prefix_length\": 24}"</span></span></code> </pre> <br><pre> <code class="bash hljs">prefix.available_prefixes.create({<span class="hljs-string"><span class="hljs-string">"prefix_length"</span></span>:24})</code> </pre> <br><blockquote>  Wenn wir ein Kind in einem Objekt ausw√§hlen m√ºssen, wird die POST-Methode verwendet und wir m√ºssen die ID des √ºbergeordneten Objekts angeben - in diesem Fall - <b>40</b> .  Wir haben das durch einen Aufruf aus dem vorherigen Beispiel herausgefunden. <br>  Im Fall von pynetbox haben wir zuerst (im vorherigen Beispiel) das Ergebnis in der Pr√§fixvariablen gespeichert und dann <b>das</b> Attribut <b>available_prefixes</b> und die Methode <b>create</b> verwendet. <br>  Dieses Beispiel <b>funktioniert nicht</b> f√ºr Sie, da das Token mit dem Schreibrecht bereits ung√ºltig ist. <br></blockquote><hr><br><h3>  IP-Adressen </h3><br>  Wenn es ein Pr√§fix mit dieser Adresse gibt, sind sie Teil davon.  Sie k√∂nnen alleine sein. <br>  Kann jeder VRF angeh√∂ren oder in Global sein. <br>  Sie k√∂nnen an der Schnittstelle angebracht werden, k√∂nnen aber in der Luft h√§ngen. <br>  Sie k√∂nnen die n√§chste freie IP-Adresse im Pr√§fix ausw√§hlen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4a1/c4d/442/4a1c4d4428f703d9a90766ffa9351fe8.png" width="800"><br><br>  Klicken Sie dazu einfach auf die gr√ºne Linie. <br><br>  Rufen Sie eine Liste der IP-Adressen f√ºr eine bestimmte Schnittstelle ab: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/ipam/ip-addresses/?interface_id=8"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.ipam.ip_addresses.filter(interface_id=<span class="hljs-number"><span class="hljs-number">8</span></span>)</code> </pre><br>  Oder: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/ipam/ip-addresses/?device=mlg-leaf-0&amp;interface=Ethernet1"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.ipam.ip_addresses.filter(device=<span class="hljs-string"><span class="hljs-string">"mlg-leaf-0"</span></span>, interface=<span class="hljs-string"><span class="hljs-string">"Ethernet1"</span></span>)</code> </pre><br>  Rufen Sie eine Liste aller Ger√§te-IP-Adressen ab: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/ipam/ip-addresses/?device=mlg-leaf-0"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.ipam.ip_addresses.filter(device=<span class="hljs-string"><span class="hljs-string">"mlg-leaf-0"</span></span>)</code> </pre><br>  Rufen Sie eine Liste der verf√ºgbaren Pr√§fix-IP-Adressen ab: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/ipam/prefixes/28/available-ips/"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">prefix = nb.ipam.prefixes.get(site=<span class="hljs-string"><span class="hljs-string">"mlg"</span></span>, role=<span class="hljs-string"><span class="hljs-string">"leaf-loopbacks"</span></span>) prefix.available_ips.list()</code> </pre><br><blockquote>  Auch hier m√ºssen Sie die ID des Pr√§fixes in der URL angeben, aus der wir die Adresse ausw√§hlen - diesmal ist es 28. <br></blockquote>  Markieren Sie die folgende freie IP-Adresse im Pr√§fix: <br><br><pre> <code class="bash hljs">curl -X POST <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/ipam/prefixes/28/available-ips/"</span></span> \ -H <span class="hljs-string"><span class="hljs-string">"accept: application/json"</span></span> \ -H <span class="hljs-string"><span class="hljs-string">"Content-Type: application/json"</span></span> \ -H <span class="hljs-string"><span class="hljs-string">"Authorization: TOKEN a9aae70d65c928a554f9a038b9d4703a1583594f"</span></span></code> </pre> <br><pre> <code class="bash hljs">prefix.available_ips.create()</code> </pre> <br><hr><br><h2>  Virtualisierung </h2><br>  Wir k√§mpfen immer noch um den Titel eines modernen DC.  Wo ohne Virtualisierung. <br><br>  NetBox sieht nicht so aus und ist kein Ort, an dem es sich lohnt, Informationen √ºber virtuelle Maschinen zu speichern (Sie k√∂nnen sogar √ºber die Notwendigkeit spekulieren, physische Maschinen darin zu speichern).  Dies kann sich jedoch als n√ºtzlich f√ºr uns herausstellen. Sie k√∂nnen beispielsweise Informationen zu Route Reflectors, Servicemaschinen wie NTP, Syslog, S-Flow-Servern und Steuerungsmaschinen eingeben. <br><br>  Die VM verf√ºgt √ºber eine eigene Liste von Schnittstellen - sie unterscheiden sich von den Schnittstellen physischer Ger√§te und haben einen eigenen separaten Endpunkt. <br><br>  So k√∂nnen Sie alle virtuellen Maschinen auflisten: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/virtualization/virtual-machines/"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.virtualization.virtual_machines.all()</code> </pre><br>  Also - von allen Schnittstellen aller VMs: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/virtualization/interfaces/"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.virtualization.interfaces.all()</code> </pre><br>  F√ºr eine VM k√∂nnen Sie nicht den spezifischen Hypervisor / physischen Computer angeben, auf dem sie ausgef√ºhrt wird, aber Sie k√∂nnen einen Cluster angeben.  Obwohl nicht alles so hoffnungslos ist.  Lesen Sie weiter. <br><br><hr><br><h2>  Extra nettes Zeug </h2><br>  Die Grundfunktionalit√§t von NetBox deckt die meisten Aufgaben vieler Benutzer ab, jedoch nicht alle.  Dennoch wurde das Produkt urspr√ºnglich geschrieben, um die Probleme eines bestimmten Unternehmens zu l√∂sen.  Es wird jedoch aktiv weiterentwickelt und es erscheinen ziemlich <a href="https://github.com/netbox-community/netbox/releases" rel="nofollow">oft</a> neue Releases.  Dementsprechend erscheinen neue Funktionen. <br><br>  Zum Beispiel sind seit meiner ersten Installation von NetBox vor ein paar Jahren Tags darin erschienen, Konfigurationskontexte, Webhooks, Caching, Supervisord wurden in systemd ge√§ndert, externer Dateispeicher. <br><br>  Pass auf. <br><br><h3>  Benutzerdefinierte Felder </h3><br>  Manchmal m√∂chten Sie jedem Objekt ein Feld hinzuf√ºgen, in das Sie beliebige Daten einf√ºgen k√∂nnen. <br><br>  Geben Sie beispielsweise die Nummer der Liefervereinbarung an, mit der der Switch gekauft wurde, oder den Namen der physischen Maschine, auf der die VM ausgef√ºhrt wird. <br><br>  Hier kommen benutzerdefinierte Felder zum Einsatz - ein solches Feld mit einem Textwert, der zu fast jeder Entit√§t in NetBox hinzugef√ºgt werden kann. <br><br>  Erstellen Sie benutzerdefinierte Felder im Admin-Bereich <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1cf/10e/568/1cf10e56808f227ce7f7270581b84a31.png" width="600"><br><br>  So sieht es aus, wenn Sie das Ger√§t bearbeiten, f√ºr das das benutzerdefinierte Feld erstellt wurde: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d3a/c2b/c78/d3ac2bc78d80acccc3895463f7ed7295.png" width="450"><br><br>  Fordern Sie eine Liste der Ger√§te mit dem Wert custom_field an <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/devices/?cf_contract_number=0123456789"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><pre> <code class="python hljs">nb.dcim.devices.filter(cf_contract_number=<span class="hljs-string"><span class="hljs-string">"0123456789"</span></span>)</code> </pre><br><hr><br><h3>  Konfigurationskontext </h3><br>  Manchmal m√∂chten Sie mehr als nur unstrukturierten Text.  Dann kommt der <a href="http://netbox.linkmeup.ru:45127/extras/config-contexts/1/" rel="nofollow">Konfigurationskontext</a> zur Rettung. <br><br>  Dies ist eine Gelegenheit, einen Satz strukturierter Daten im JSON-Format einzuf√ºhren, der nirgendwo anders zu platzieren ist. <br><br>  Dies kann beispielsweise eine Reihe von BGP-Communities oder eine Liste von Syslog-Servern sein. <br><br>  Der Konfigurationskontext kann lokal (f√ºr ein bestimmtes Objekt konfiguriert) oder global (bei einmaliger Konfiguration) sein und dann auf alle Objekte angewendet werden, die bestimmte Bedingungen erf√ºllen (z. B. auf derselben Site oder auf derselben Plattform ausgef√ºhrt). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/97a/406/224/97a406224499ed35e9c471c3709a8d98.png" width="800"><br><br>  Der Konfigurationskontext wird automatisch zu den Abfrageergebnissen hinzugef√ºgt.  Gleichzeitig verschmelzen lokale und globale Kontexte zu einem. <br><br>  Beispielsweise enth√§lt die Ausgabe f√ºr ein Ger√§t, das nur ein einfaches russisches M√§dchen ist und f√ºr das es einen lokalen Kontext gibt, den Schl√ºssel ‚Äûconfig_context‚Äú: <br><br><pre> <code class="bash hljs">curl -X GET <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/devices/?q=russian"</span></span> -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span></code> </pre> <br><img src="https://habrastorage.org/getpro/habr/post_images/031/608/4bd/0316084bd52d028434631298a22ba33e.png" width="204"><br><br><hr><br><h3>  Tags </h3><br>  Es ist schwer, etwas Neues √ºber Tags zu sagen.  Sie sind.  Sie eignen sich zum Hinzuf√ºgen beliebiger Funktionen.  Beispielsweise k√∂nnen Sie "byada" -Schalter aus dem Stapel markieren, in dem der Speicher ausf√§llt. <br><br><hr><br><h3>  Webhooks </h3><br>  Eine unersetzliche Sache, wenn Sie andere Dienste ben√∂tigen, um sich √ºber √Ñnderungen in NetBox zu informieren. <br>  Wenn Sie beispielsweise einen neuen Switch starten, wird ein Hook an das Automatisierungssystem gesendet, der den Prozess des Einrichtens und der Inbetriebnahme des Ger√§ts startet. <br><br><hr><br><h1>  Fazit </h1><br>  In diesem Artikel m√∂chte ich nicht alle Funktionen von NetBox ber√ºcksichtigen, daher werde ich Ihnen alles Weitere geben.  Verstehe, versuche es. <br><br>  Dar√ºber hinaus werde ich im Rahmen des Aufbaus des Automatisierungssystems nur die Teile ansprechen, die wir wirklich ben√∂tigen. <br><br>  Deshalb habe ich oben kurz dar√ºber gesprochen, was NetBox ist und wie Daten darin gespeichert werden. <br><br>  Ich wiederhole, dass ich dort bereits fast alle erforderlichen Daten eingegeben habe und Sie einen <a href="" rel="nofollow">Datenbank-Dump f√ºr sich</a> selbst ziehen k√∂nnen. <br><br>  Alles ist bereit f√ºr die n√§chste Stufe der Automatisierung: Schreiben eines Systems (ahaha, nur Skripte), um die Ger√§te zu initialisieren und die Konfiguration zu verwalten. <br><br><hr><br>  Bevor ich den Artikel abschlie√üe, m√∂chte ich noch ein paar Worte zur Installation und zum Betrieb von NetBox-Komponenten sagen. <br><br><h1>  Einige Nuancen der Installation von NetBox </h1><br>  Ich werde den Installationsprozess nicht im Detail beschreiben - er ist mehr als ber√ºhmt in der <a href="https://netbox.readthedocs.io/en/stable/installation/" rel="nofollow">offiziellen Dokumentation</a> . <br><br>  Im Video von Dima Figol ( <a href="https://www.youtube.com/watch%3Fv%3DGGXgAlWm9aY%26t%3D9655s" rel="nofollow">ein-</a> und <a href="https://www.youtube.com/watch%3Fv%3Da3yK_WAisPw" rel="nofollow">zweimal</a> ) und <a href="https://www.youtube.com/watch%3Fv%3DI_Ra3PIR2Lc%26feature%3Dyoutu.be" rel="nofollow">Emil Garipov</a> k√∂nnen Sie sehen, wie das NetBox-Docker-Image gestartet und in der GUI gearbeitet wird. <br><br>  Wenn Sie die Installations- / Startschritte genau befolgen, funktioniert im Allgemeinen alles. <br>  Aber hier sind die Nuancen, die Sie versehentlich vergessen k√∂nnen. <br><br><ul><li>  In der Datei <a href="https://netbox.readthedocs.io/en/stable/installation/2-netbox/" rel="nofollow">configuration.py</a> muss der Parameter <a href="https://netbox.readthedocs.io/en/stable/installation/2-netbox/" rel="nofollow">ALLOWED_HOSTS</a> gef√ºllt sein: <br><pre> <code class="bash hljs">ALLOWED_HOSTS = [<span class="hljs-string"><span class="hljs-string">'netbox.linkmeup.ru'</span></span>, <span class="hljs-string"><span class="hljs-string">'localhost'</span></span>]</code> </pre> <br>  Hier m√ºssen Sie alle m√∂glichen NetBox-Namen angeben, auf die Sie zugreifen m√∂chten. Es kann sich beispielsweise um eine externe IP-Adresse oder einen 127.0.0.1- oder DNS-Alias ‚Äã‚Äãhandeln. <br>  Andernfalls wird die NetBox-Website nicht ge√∂ffnet und 400 angezeigt. </li><li>  In derselben Datei muss <a href="https://netbox.readthedocs.io/en/stable/installation/2-netbox/" rel="nofollow">SECRET_KEY</a> angegeben werden, den Sie selbst erfinden oder ein Skript generieren k√∂nnen. </li><li>  Auf der Hauptseite wird 502 Bad Gateway angezeigt, wenn beim Einrichten der PostgreSQL-Datenbank ein Fehler auftritt: √úberpr√ºfen Sie den Host (falls auf einem anderen Computer installiert), den Port, den Datenbanknamen, den Benutzernamen und das Kennwort. </li><li>  NetBox gew√§hrt seit <a href="" rel="nofollow">einiger Zeit</a> standardm√§√üig keine Leserechte mehr ohne Berechtigung. <br><br>  Dies alles √§ndert sich in der gleichen configuration.py: <br><br><pre> <code class="bash hljs">EXEMPT_VIEW_PERMISSIONS = [<span class="hljs-string"><span class="hljs-string">'*'</span></span>]</code> </pre> </li><li>  Au√üerdem geben API-Anforderungen 200 zur√ºck und funktionieren nicht, wenn die API-URL am Ende keinen Schr√§gstrich enth√§lt. <br><pre> <code class="bash hljs">curl -X GET -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json; indent=4"</span></span> <span class="hljs-string"><span class="hljs-string">"http://netbox.linkmeup.ru:45127/api/dcim/devices"</span></span></code> </pre> <br></li></ul><br><hr><br><h1>  Ein bisschen √ºber PostgreSQL </h1><br>  So stellen Sie eine Verbindung zum Server her: <br><br><pre> <code class="bash hljs">psql -U &lt;i&gt;username&lt;/i&gt; -h &lt;i&gt;hostname&lt;/i&gt; &lt;i&gt;db_name&lt;/i&gt;</code> </pre> <br>  Zum Beispiel: <br><br><pre> <code class="bash hljs">psql -U netbox -h localhost netbox</code> </pre> <br>  So zeigen Sie alle Tabellen an: <br><br><pre> <code class="bash hljs">/dt</code> </pre> <br>  So beenden Sie: <br><br><pre> <code class="bash hljs">/q</code> </pre> <br>  F√ºr einen Datenbankspeicherauszug: <br><br><pre> <code class="bash hljs">pg_dump -U &lt;i&gt;username&lt;/i&gt; -h &lt;i&gt;hostname&lt;/i&gt; &lt;i&gt;db_name&lt;/i&gt; &gt; netbox.sql</code> </pre> <br>  Wenn Sie nicht jedes Mal ein Passwort eingeben m√∂chten: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> *:*:*:&lt;i&gt;username&lt;/i&gt;:&lt;i&gt;password&lt;/i&gt; &gt; ~/.pgpass chmod 600 ~/.pgpass</code> </pre> <br>  Wenn Sie eine eigene Installation haben und nicht alles von Hand machen m√∂chten, k√∂nnen Sie dies einfach tun, indem Sie hier einen Speicherauszug der aktuellen NetBox-Datenbank erstellen: <br><br><pre> <code class="bash hljs">psql -U &lt;i&gt;username&lt;/i&gt; -h &lt;i&gt;hostname&lt;/i&gt; &lt;i&gt;db_name&lt;/i&gt; &lt; netbox_initial_db.sql</code> </pre> <br>  Wenn Sie zuerst alle Tabellen l√∂schen m√ºssen (und Sie m√ºssen dies tun), k√∂nnen Sie die Datei im Voraus vorbereiten: <br><br><pre> <code class="bash hljs">psql -U &lt;i&gt;username&lt;/i&gt; -h &lt;i&gt;hostname&lt;/i&gt; &lt;i&gt;db_name&lt;/i&gt; \o drop_all_tables.sql select <span class="hljs-string"><span class="hljs-string">'drop table '</span></span> || tablename || <span class="hljs-string"><span class="hljs-string">' cascade;'</span></span> from pg_tables; \q psql -U &lt;i&gt;username&lt;/i&gt; -h &lt;i&gt;hostname&lt;/i&gt; &lt;i&gt;db_name&lt;/i&gt; -f drop_all_tables.sql</code> </pre> <br><hr><br><h1>  N√ºtzliche Links </h1><br><ul><li>  <a href="https://github.com/netbox-community/netbox" rel="nofollow">NetBox selbst auf guthub</a> </li><li>  <a href="https://github.com/netbox-community/netbox-docker" rel="nofollow">Containerversion</a> </li><li>  <a href="https://netbox.readthedocs.io/en/stable/" rel="nofollow">Vollst√§ndige Installationsanweisungen und alle Produktdokumentationen</a> </li><li>  <a href="http://karneliuk.com/2019/04/documenting-your-network-infrastructure-in-netbox-integrating-with-ansible-over-rest-api-and-automating-provisioning-of-cumulus-linux-arista-eos-nokia-sr-os-and-cisco-ios-xr/" rel="nofollow">Dokumentation Ihrer Netzwerkinfrastruktur in NetBox, Integration in Ansible √ºber die REST-API</a> </li><li>  <a href="https://www.youtube.com/watch%3Fv%3DGGXgAlWm9aY%26t%3D9655s" rel="nofollow">IPAM NetBox und seine API, Docker, Postman</a> </li><li>  <a href="https://www.youtube.com/watch%3Fv%3Da3yK_WAisPw" rel="nofollow">IPAM NetBox und seine API, Konfigurationsvorlagen mit Python</a> </li><li>  <a href="https://github.com/digitalocean/pynetbox" rel="nofollow">Python NetKox SDK</a> </li><li>  <a href="http://netbox.linkmeup.ru:45127/api/docs/" rel="nofollow">API-Dokumentation</a> </li><li>  <a href="https://groups.google.com/forum/" rel="nofollow">Mailing-Liste</a> </li><li>  <a href="https://networktocode.slack.com/" rel="nofollow">NetworkToCode Slack Channel</a> </li><li>  <a href="https://habr.com/ru/post/485618/">Was ist REST?</a> </li><li>  <a href="http://netbox.linkmeup.ru:45127/" rel="nofollow">NetBox-Installation f√ºr ADSM</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de486000/">https://habr.com/ru/post/de486000/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de485986/index.html">Top 5 Lokalisierungstrends im Jahr 2020</a></li>
<li><a href="../de485988/index.html">[Case Locomizer] So beschleunigen Sie die Berechnung einer Heatmap in zweieinhalb Jahren um das 20.000-fache</a></li>
<li><a href="../de485990/index.html">Automatisierung t√∂tet?</a></li>
<li><a href="../de485996/index.html">Elastic APM in der App</a></li>
<li><a href="../de485998/index.html">LyX: Allgemeine Bemerkungen. Teil 2</a></li>
<li><a href="../de486006/index.html">Speichern Sie den Chat-Status auf dem Stapel</a></li>
<li><a href="../de486010/index.html">Erstellen Sie eine Demo f√ºr ein altes Telefon - AONDEMO</a></li>
<li><a href="../de486014/index.html">SLAC-Tour: Nationales Beschleunigerlabor des US-Energieministeriums in Stanford</a></li>
<li><a href="../de486018/index.html">Ergebnisse der Sitzungsumfrage</a></li>
<li><a href="../de486024/index.html">Wirklich einfache Grafiken in R f√ºr Wissenschaft und Journalismus</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>