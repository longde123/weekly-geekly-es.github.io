<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§∑üèø üßñüèº ‚û°Ô∏è Arquivos e configura√ß√£o do estado desejado do PowerShell: Parte 1. Configurando o DSC Pull Server para funcionar com o banco de dados SQL üèÇüèΩ üéõÔ∏è üòÇ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A Configura√ß√£o de Estado Desejado (DSC) do PowerShell facilita a implanta√ß√£o e configura√ß√£o do sistema operacional, fun√ß√µes de servidor e aplicativos ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Arquivos e configura√ß√£o do estado desejado do PowerShell: Parte 1. Configurando o DSC Pull Server para funcionar com o banco de dados SQL</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dataline/blog/452064/"><img src="https://habrastorage.org/webt/-4/vu/2i/-4vu2idi-kona7rk1zluhuqtrlk.png"><br><br>  A Configura√ß√£o de Estado Desejado (DSC) do PowerShell facilita a implanta√ß√£o e configura√ß√£o do sistema operacional, fun√ß√µes de servidor e aplicativos quando voc√™ possui centenas de servidores. <br><br>  Mas ao usar o DSC no local, ou seja,  n√£o no MS Azure, existem algumas nuances.  Eles s√£o especialmente tang√≠veis se a organiza√ß√£o for grande (de 300 esta√ß√µes de trabalho e servidores) e ainda n√£o abriu o mundo dos cont√™ineres: <br><br><ul><li>  N√£o h√° relat√≥rios completos sobre o status dos sistemas.  Se a configura√ß√£o necess√°ria n√£o foi aplicada em alguns servidores, sem esses relat√≥rios, n√£o saberemos sobre ela.  √â muito dif√≠cil obter informa√ß√µes do servidor de relat√≥rio interno e, para um grande n√∫mero de hosts, tamb√©m √© muito tempo. </li><li>  N√£o h√° escalabilidade e toler√¢ncia a falhas.  √â imposs√≠vel criar um conjunto de servidores Web DSC de pesquisa que possuam um √∫nico banco de dados tolerante a falhas e um reposit√≥rio comum de arquivos de configura√ß√£o, m√≥dulos e chaves de registro. </li></ul><br>  Hoje vou explicar como resolver o primeiro problema e obter os dados para gera√ß√£o de relat√≥rios.  Tudo seria mais simples se o SQL pudesse ser usado como banco de dados.  A MS <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">promete</a> suporte interno apenas no Windows Server 2019 ou no servidor Windows 1803 de compila√ß√£o. Ele tamb√©m <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">falhar√° na</a> recupera√ß√£o de dados usando o provedor OleDB, pois o servidor DSC usa um par√¢metro nomeado que n√£o √© totalmente suportado pelo OleDbCommand. <br><br>  Eu encontrei o seguinte: para aqueles que usam o Windows Server 2012 e 2016, voc√™ pode <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">configurar o</a> uso do banco de dados SQL como o back-end do servidor DSC de pesquisa.  Para fazer isso, crie um "proxy" na forma de um arquivo .mdb com tabelas vinculadas, que redirecionar√° os dados recebidos dos relat√≥rios do cliente para o banco de dados do SQL Server. <br><a name="habracut"></a><br>  <i>Nota: No Windows Server 2016, voc√™ deve usar o <a href="">AccessDatabaseEngine2016x86</a> , porque o Microsoft.Jet.OLEDB.4.0 n√£o √© mais suportado.</i> <br><br>  N√£o vou me debru√ßar sobre o processo de implanta√ß√£o do servidor DSC de pesquisa, est√° muito bem descrito <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> .  Eu noto apenas alguns pontos.  Se implantarmos o DSC de pesquisa no mesmo servidor da Web com o WSUS ou o Kaspersky Security Center, no script de cria√ß√£o da configura√ß√£o, ser√° necess√°rio alterar os seguintes par√¢metros: <br><br><ol><li><pre><code class="sql hljs">UseSecurityBestPractices     = $false</code> </pre> <br>  Caso contr√°rio, o TLS 1.0 ser√° desativado, voc√™ n√£o poder√° se conectar ao banco de dados SQL.  O Kaspersky Security Center tamb√©m n√£o funcionar√° (o problema deve ser resolvido no Kaspersky Security Center v11). </li><li><pre> <code class="sql hljs">Enable32BitAppOnWin64   = $true</code> </pre> <br>  Se voc√™ n√£o fizer essa altera√ß√£o, n√£o poder√° iniciar o servidor AppPool DSC no IIS com o WSUS. </li><li>  Ao instalar um servidor DSC com o WSUS, desative o cache est√°tico e din√¢mico do site DSC. </li></ol><br>  Vamos seguir para configurar o servidor DSC para usar o banco de dados SQL. <br><br><h3>  Criando um banco de dados SQL </h3><br><ol><li>  Crie um banco de dados SQL vazio chamado DSC. <br><br><img src="https://habrastorage.org/webt/24/je/ik/24jeikjjhurylsfpxfdz-hkdkoo.png"><br><br><img src="https://habrastorage.org/webt/-i/km/hz/-ikmhzvewzfmt8ygqaidws2erzm.png"></li><li>  Crie uma conta para se conectar a este banco de dados.  Pr√©-verifique se a autentica√ß√£o das contas Windows e SQL est√° ativada no servidor SQL. <br><br><img src="https://habrastorage.org/webt/z-/qz/tx/z-qztxe410jqyjoj7rwna3t9-am.png"><br><br><img src="https://habrastorage.org/webt/uh/no/vm/uhnovmv8wsywdxi6ahxiinvkj4y.png"></li><li>  V√° para a se√ß√£o Mapeamento do Usu√°rio.  Selecione um banco de dados, neste caso, DSC.  Concedemos os direitos do propriet√°rio do banco de dados. <br><br><img src="https://habrastorage.org/webt/cl/fg/vg/clfgvg0ya7csozw1ner_egxdxs8.png"></li><li>  Feito. <br><br><img src="https://habrastorage.org/webt/9i/la/7n/9ila7nedgtygol496l7da239i1k.png"></li></ol><br><h3>  Criando um esquema para um banco de dados DSC </h3><br>  H√° duas maneiras de criar um esquema para um banco de dados DSC: <br><br><ul><li>  independentemente, atrav√©s de um script no TSQL <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> ANSI_NULLS <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> QUOTED_IDENTIFIER <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[Devices]( [TargetName] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [ConfigurationID] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [ServerCheckSum] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [TargetCheckSum] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [NodeCompliant] [<span class="hljs-built_in"><span class="hljs-built_in">bit</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [LastComplianceTime] [datetime] <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [LastHeartbeatTime] [datetime] <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [Dirty] [<span class="hljs-built_in"><span class="hljs-built_in">bit</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [StatusCode] [<span class="hljs-built_in"><span class="hljs-built_in">int</span></span>] <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [PRIMARY] <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[RegistrationData]( [AgentId] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [LCMVersion] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [NodeName] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [IPAddress] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [ConfigurationNames] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-keyword"><span class="hljs-keyword">max</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [PRIMARY] TEXTIMAGE_ON [PRIMARY] <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[StatusReport]( [JobId] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">50</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [<span class="hljs-keyword"><span class="hljs-keyword">Id</span></span>] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">50</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [OperationType] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [RefreshMode] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [<span class="hljs-keyword"><span class="hljs-keyword">Status</span></span>] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [LCMVersion] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">50</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [ReportFormatVersion] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [ConfigurationVersion] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [NodeName] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [IPAddress] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [StartTime] [datetime] <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [EndTime] [datetime] <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [<span class="hljs-keyword"><span class="hljs-keyword">Errors</span></span>] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-keyword"><span class="hljs-keyword">max</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [StatusData] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-keyword"><span class="hljs-keyword">max</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [RebootRequested] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [PRIMARY] TEXTIMAGE_ON [PRIMARY] <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span></code> </pre> </li><li>  importe dados de devices.mdb vazios como parte do m√≥dulo PS PSDesiredStateConfiguration por meio do SQL Data Import Wizard. <br><br>  O Devices.mdb, com o qual trabalharemos, est√° localizado em C: \ Windows \ SysWOW64 \ WindowsPowerShell \ v1.0 \ Modules \ PSDesiredStateConfiguration \ PullServer. <br></li></ul><br><ol><li>  Para importar dados, execute o Assistente para Importa√ß√£o e Exporta√ß√£o do SQL Server. <br><br><img src="https://habrastorage.org/webt/im/3v/ww/im3vwwj9ib9wucm4xnl70jow1yy.png"></li><li>  Escolhemos de onde iremos coletar os dados - no nosso caso, √© um banco de dados do Microsoft Access.  Clique em Avan√ßar. <br><br><img src="https://habrastorage.org/webt/l5/rc/dq/l5rcdqtxvaajv5h5mbil72vv3k0.png"></li><li>  Selecione o arquivo de onde importamos o esquema. <br><br><img src="https://habrastorage.org/webt/th/dt/xu/thdtxutqcvsrv0laifxjhsbse2w.png"></li><li>  Indicamos onde importar - temos esse banco de dados SQL. <br><br><img src="https://habrastorage.org/webt/dc/sc/p5/dcscp5f9n-cdmm0qfo0gv_-k0oy.png"></li><li>  Selecionamos o servidor SQL (Nome do servidor) e o banco de dados no qual importaremos os dados (DataBase). <br><br><img src="https://habrastorage.org/webt/kr/sd/ds/krsddsbr4jpvi9dgvc3f_qcxwqy.png"></li><li>  Selecionamos a op√ß√£o Copiar dados de uma ou mais tabelas ou visualiza√ß√µes (copiar dados de tabelas ou visualiza√ß√µes). <br><br><img src="https://habrastorage.org/webt/nu/aq/q8/nuaqq8akzpdz07fwf1gedrxcfns.png"></li><li>  Selecionamos as tabelas das quais importaremos o esquema do banco de dados. <br><br><img src="https://habrastorage.org/webt/bf/7k/at/bf7kat56ltu-amw0nhvgbp2tkpw.png"></li><li>  Marque Executar imediatamente e clique em Concluir. <br><br><img src="https://habrastorage.org/webt/7i/au/wo/7iauwo3j_x0qzfwqgfc1u8tyfks.png"></li><li>  Feito. <br><br><img src="https://habrastorage.org/webt/oi/49/w0/oi49w0cedn8ilblfijwlhjsumfm.png"></li><li>  Como resultado, as tabelas devem aparecer no banco de dados DSC. <br><br><img src="https://habrastorage.org/webt/z3/ui/pp/z3uippubkjjk0r2fqolnoweezme.png"></li></ol><br><h3>  Configurando um arquivo "proxy" .mdb </h3><br>  <b>Criando uma conex√£o ODBC com o servidor SQL.</b>  Sup√µe-se que o MS Access n√£o esteja instalado no servidor com DSC; portanto, a configura√ß√£o do database.mdb √© executada em um host intermedi√°rio com o MS Access instalado. <br><br>  Vamos criar uma conex√£o ODBC do sistema com o servidor SQL (a profundidade de bits da conex√£o deve corresponder √† profundidade de bits do MS Access - 64 ou 32).  Pode ser criado usando: <br>  - Cmdlet do PowerShell: <br><br><pre> <code class="sql hljs">Add-OdbcDsn ‚ÄìName DSC ‚ÄìDriverName 'SQL Server' ‚ÄìPlatform '&lt;64-bit or 32-bit&gt;' ‚ÄìDsnType System ‚ÄìSetPropertyValue @('Description=DSC Pull Server',"Server=&lt;Name of your SQL Server&gt;",'Trusted_Connection=yes','Database=DSC') ‚ÄìPassThru</code> </pre> <br>  - ou manualmente, usando o assistente de conex√£o: <br><br><ol><li>  Abra ferramentas administrativas.  Selecionamos fontes de dados ODBC, dependendo da vers√£o do MS Access instalada.  V√° para a guia DSN do sistema e crie uma conex√£o do sistema (Adicionar). <br><br><img src="https://habrastorage.org/webt/pt/k5/cu/ptk5cuuxfa2deeqiw_h6vb4vy_4.png"></li><li>  Indicamos que nos conectaremos ao servidor SQL.  Clique em Finish. <br><br><img src="https://habrastorage.org/webt/ey/b_/dz/eyb_dz43l6-xzg3yupw4zgrasbi.png"></li><li>  Especifique o nome e o servidor para conectar.  Em seguida, uma conex√£o com os mesmos par√¢metros precisar√° ser criada no servidor DSC. <br><br><img src="https://habrastorage.org/webt/_d/py/lq/_dpylq1y7uycuiq08tkq-jp1eri.png"></li><li>  Indicamos que, para conectar-se ao servidor SQL, usamos o logon criado anteriormente com o nome DSC. <br><br><img src="https://habrastorage.org/webt/_2/bw/bs/_2bwbsadgrihkikrnnh2eq2tkbs.png"></li><li>  Especifique o banco de dados nas configura√ß√µes de conex√£o DSC. <br><br><img src="https://habrastorage.org/webt/eg/ex/eg/egexegl50aplc4fr_f1jbfx3edq.png"></li><li>  Clique em Finish. <br><br><img src="https://habrastorage.org/webt/di/a8/_n/dia8_nwzir-nhafd9rezwstdwjq.png"></li><li>  Antes de concluir as configura√ß√µes, verificamos se a conex√£o est√° funcionando (fonte de dados de teste). <br><br><img src="https://habrastorage.org/webt/kt/ft/tm/ktfttmjcb_8gyb3s-o_xnwewyfy.png"></li><li>  Feito. <br><br><img src="https://habrastorage.org/webt/4r/4z/aa/4r4zaalbv3rms8xsfjoijzvtige.png"></li></ol><br>  <b>Criando o banco de dados devices.mdb no MS Access.</b>  Iniciamos o MS Access e criamos um banco de dados vazio chamado devices.mdb. <br><br><img src="https://habrastorage.org/webt/tq/4n/ia/tq4niasnq5av17ozevpg365y_qy.png"><br><br><ol><li>  V√° para a guia Dados externos, clique no banco de dados ODBC.  Na janela exibida, selecione Criar uma tabela vinculada para comunica√ß√£o com a fonte de dados. <br><br><img src="https://habrastorage.org/webt/aq/ql/vq/aqqlvqqilfgqgdakivqfna9irvu.png"></li><li>  Na nova janela, selecione a guia Fonte de dados da m√°quina e clique em OK.  Na nova janela, insira as credenciais para conectar-se ao servidor SQL. <br><br><img src="https://habrastorage.org/webt/rr/8c/zl/rr8czlircqalebpljfw47h5eax4.png"></li><li>  Selecionamos as tabelas que precisam ser vinculadas.  Marque a caixa de sele√ß√£o Salvar senha e clique em OK.  A senha deve ser salva sempre para todas as tr√™s tabelas. <br><br><img src="https://habrastorage.org/webt/dy/f9/w5/dyf9w58ztue8ugsagfiieghgqsc.png"></li><li>  Nos √≠ndices, voc√™ precisa selecionar o seguinte: <br>  - TargetName para a tabela dbo_Devices; <br><br><img src="https://habrastorage.org/webt/e-/fl/s_/e-fls_elpbmiktv67egcweaxlvq.png"><br><br>  - NodeName ou IPAddress para dbo_RegistrationData; <br><br><img src="https://habrastorage.org/webt/xo/ug/do/xougdoiodatj1tlmsalqpdfzauk.png"><br><br>  - NodeName ou IPAddress para dbo_StatusReport. <br><br><img src="https://habrastorage.org/webt/w7/lj/us/w7ljush_8zrt8hupqoqvrtsgk4g.png"></li><li>  Renomeie as tabelas no MS Access, a saber: remova o prefixo dbo_ para que o DSC possa us√°-las. <br><br><img src="https://habrastorage.org/webt/6w/o-/1q/6wo-1qvgkwua75cv1nd1rsmng1k.png"></li><li>  Feito. <br><br><img src="https://habrastorage.org/webt/58/16/x8/5816x8uw93muoywridyx-dwjugw.png"></li><li>  Salve o arquivo e feche o MS Access.  Agora copie o devices.mdb resultante para o servidor DSC (por padr√£o em C: \ Arquivos de Programas \ WindowsPowershell \ DSCService) e substitua-o pelo existente (se houver). </li></ol><br><h3>  Configurando um servidor DSC para usar SQL </h3><br><ol><li>  Retornamos ao servidor DSC.  Para conectar-se ao servidor SQL com nosso arquivo proxy, crie uma nova conex√£o ODBC no servidor DSC.  O nome, a profundidade dos bits e as configura√ß√µes de conex√£o devem ser iguais aos da cria√ß√£o do arquivo MDB.  Voc√™ pode copiar o devices.mdb vazio j√° configurado a partir daqui. <br></li><li>  Para usar o devices.mdb, √© necess√°rio fazer altera√ß√µes no web.config do servidor DSC de pesquisa (por padr√£o, C: \ inetpub \ PSDSCPullServer \ web.config): </li></ol><br><br>  - para Windows Server 2012 <br><br><pre> <code class="sql hljs">&lt;add key="dbprovider" value="System.Data.OleDb"&gt; &lt;add key="dbconnectionstr" value="Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\Program Files\WindowsPowerShell\DscService\Devices.mdb;"&gt;</code> </pre> <br>  - para Windows Server 2016 <br><br><pre> <code class="sql hljs">&lt;add key="dbprovider" value="System.Data.OleDb"&gt; &lt;add key="dbconnectionstr" value="Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\Program Files\WindowsPowerShell\DscService\Devices.mdb;"&gt;</code> </pre> <br><br>  Isso conclui a configura√ß√£o do servidor DSC. <br><br><h3>  Verificando a integridade do servidor DSC </h3><br><ol><li>  Verifique se o servidor DSC est√° acess√≠vel atrav√©s de um navegador da web. <br><br><img src="https://habrastorage.org/webt/oi/oe/1z/oioe1zuj9x9gvl9eeek9sc38nz8.png"></li><li>  Agora vamos verificar se o servidor DSC de vota√ß√£o funciona corretamente.  Para isso, o m√≥dulo xPSDesiredStateConfiguration possui um script pullserversetuptests.ps1.  Antes de executar este script, voc√™ deve instalar o m√≥dulo Powershell chamado Pester.  Instale-o Install-Module -Name Pester. </li><li>  Abra C: \ Arquivos de programas \ WindowsPowerShell \ Modules \ xPSDesiredStateConfiguration \ &lt;vers√£o do m√≥dulo&gt; \ DSCPullServerSetup \ PullServerDeploymentVerificationTest (no exemplo, vers√£o 8.0.0.0.0). <br><br><img src="https://habrastorage.org/webt/_5/db/gl/_5dbglhxbi5mgboeexxi_pw7oxk.png"></li><li>  Abra PullServerSetupTests.ps1 e verifique o caminho para o web.config do servidor DSC.  Vermelho destacou o caminho para web.config, que verificar√° o script.  Se necess√°rio, altere esse caminho. <br><br><img src="https://habrastorage.org/webt/et/te/mn/ettemnvebjfc3kgviqzqsob_eas.png"></li><li>  Execute pullserversetuptests.ps1 <br>  Invocar-Pester. \ PullServerSetupTests.ps1 <br>  Tudo funciona. <br><br><img src="https://habrastorage.org/webt/qc/qp/m5/qcqpm5a4iwsl_-9d7n2uzll9zjg.png"></li><li>  No SQL Management Studio, vemos que os hosts administrados enviam relat√≥rios ao servidor de relat√≥rio DSC e os dados v√£o para o banco de dados DSC no servidor SQL. <br><br><img src="https://habrastorage.org/webt/ba/oo/04/baoo048uqhsyxpsv4yaaftqmwvi.png"></li></ol><br>  S√≥ isso.  Nos artigos a seguir, pretendo contar como criar relat√≥rios sobre os dados recebidos e abordar quest√µes sobre toler√¢ncia a falhas e escalabilidade. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt452064/">https://habr.com/ru/post/pt452064/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt452052/index.html">Como reduzimos pela metade o custo de uma li√ß√£o introdut√≥ria, procurando uma solu√ß√£o das companhias a√©reas</a></li>
<li><a href="../pt452054/index.html">Por que o WhatsApp nunca estar√° seguro</a></li>
<li><a href="../pt452056/index.html">Golang DevDay: 31 de maio, Novosibirsk + transmiss√£o</a></li>
<li><a href="../pt452060/index.html">Predicados da esperan√ßa da informa√ß√£o</a></li>
<li><a href="../pt452062/index.html">Como come√ßa a sua manh√£?</a></li>
<li><a href="../pt452066/index.html">Excelsior JET interrompe o desenvolvimento de seu compilador AOT ap√≥s 18 anos de trabalho</a></li>
<li><a href="../pt452068/index.html">12. Introdu√ß√£o ao Ponto de Verifica√ß√£o R80.20. Logs e relat√≥rios</a></li>
<li><a href="../pt452072/index.html">Implementamos CircularRevealAnimation no Flutter e publicamos simultaneamente a biblioteca em pub.dev</a></li>
<li><a href="../pt452074/index.html">O primeiro jogo de unidade ou o que me levou seis meses</a></li>
<li><a href="../pt452076/index.html">Quebrando o navegador UC</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>