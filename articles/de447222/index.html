<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⚙️ 👷🏼 🤰🏿 Linux Quest. Herzlichen Glückwunsch an die Gewinner und sprechen Sie über die Lösung von Problemen 🏿 🤵🏻 👨‍👩‍👧</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Am 25. März haben wir die Registrierung für Linux Quest eröffnet. Dies ist ein Spiel für Fans und Experten des Linux-Betriebssystems. Einige Statistik...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Linux Quest. Herzlichen Glückwunsch an die Gewinner und sprechen Sie über die Lösung von Problemen</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/447222/"><img src="https://habrastorage.org/webt/1h/zh/nd/1hzhnd4vk8qks_p2sjyylz-kpy4.png"><br><br>  Am 25. März haben wir die Registrierung für <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Linux Quest</a> eröffnet. Dies ist ein Spiel für Fans und Experten des Linux-Betriebssystems.  Einige Statistiken: 1117 Personen haben sich für das Spiel registriert, 317 von ihnen haben mindestens einen Schlüssel gefunden, 241 haben die Aufgabe der ersten Stufe erfolgreich abgeschlossen, 123 - die zweite und 70 haben die dritte Stufe bestanden.  Heute ist unser Spiel zu Ende und wir gratulieren unseren Gewinnern! <br><a name="habracut"></a><br><ul><li>  <b>Den ersten Platz belegte Alexander Teldekov.</b> <br>  Alexander sagte sich, dass er der typischste Systemadministrator ist.  Lebt in Wolgograd und verwaltet seit zwanzig Jahren verschiedene Unix-ähnliche Systeme.  Verwaltet für Internetanbieter, Banken und Systemintegratoren.  Jetzt arbeitet er remote in einem kleinen Unternehmen und beschäftigt sich mit der Cloud-Infrastruktur für einen großen ausländischen Kunden.  Liest gern, hört gerne Musik.  Über das Spiel sagte Alexander, dass er das Spiel als Ganzes mochte, er liebt solche Rätsel.  In einer der Firmen beim Interview war ich mit einem ähnlichen wie Hackerrank beschäftigt, es war interessant. </li><li>  <b>Zweiter Platz - Roman Suslov.</b> <br>  Ein Roman aus Moskau.  Er ist 37 Jahre alt.  Er arbeitet als Linux / Unix-Ingenieur bei Jet Infosystems.  Für die Arbeit muss ich Linux / Unix-Systeme + SAN verwalten und Fehler beheben.  Die Interessen sind sehr unterschiedlich: Linux-Systeme, Programmierung, Reverse Engineering, Informationssicherheit, Arduino.  Über das Spiel bemerkte Roman, dass er das Spiel im Allgemeinen mochte.  „Ich habe meinen Gyrus ein wenig gebeugt und war vom grauen Alltag der täglichen Arbeit abgelenkt.  :) Ich hätte gerne mehr Aufgaben, sonst hätte ich keine Zeit, einen Eindruck davon zu bekommen, wie das Spiel bereits vorbei war. " </li><li>  <b>Der dritte ist alex3d.</b> <br>  Alex lebt in Moskau und beschäftigt sich mit Softwareentwicklung.  "Vielen Dank für den Wettbewerb. Es war interessant, Ihre Google-Fu-Fähigkeiten zu überprüfen." </li></ul><br>  Auch in der Rangliste der Top 10 Spieler: <br><br><ul><li>  Jewgenij Saldayew </li><li>  Markel Mokhnachevsky </li><li>  Konstantin Konosov </li><li>  Pavel Sergeev </li><li>  Vladimir Bovaev </li><li>  Ivan Bubnov </li><li>  Pavlo klets </li></ul><br>  Wir verstehen, dass es viele Möglichkeiten gibt, alle unsere Probleme zu lösen. Eine der möglichen Lösungen wird unten beschrieben. <br><br><h3>  1. Die erste Stufe </h3><br>  Wir nannten es "Sind Sie sicher, dass der Administrator?", Weil die Aufgabe ganz einfach war - einen Warmlampendienst zu reparieren. <br><br><h4>  1.1.  Interessante Fakten: </h4><br>  Zwei Spieler fanden den ersten Schlüssel in den ersten 15 Minuten des Spiels, und in der ersten Stunde hatten wir drei Anführer, die die Aufgabe bewältigten. <br><br><h4>  1.2.  Aufgabe </h4><br>  Sie haben für ein Unternehmen gearbeitet, in dem es lange Zeit keinen kompetenten IT-Spezialisten gab.  Bevor Sie mit dem Aufräumen beginnen, müssen Sie ein brennendes Problem lösen, das die Arbeit des Büros blockiert. <br><br>  Eine Putzfrau wischte das Stromkabel zum Serverschrank.  Die Stromversorgung wurde wiederhergestellt, aber eine sehr wichtige Website funktioniert immer noch nicht.  Die Website ist wichtig, da das Unternehmen sich nicht sehr um die Informationssicherheit kümmert. Auf der Hauptseite finden Sie das Administratorkennwort auf dem Computer des CEO im Klartext. <br><br>  Neulich wurde das Passwort geändert, aber jeder hat das neue vergessen, der Regisseur kann nicht arbeiten.  Gerüchten zufolge gab es auf diesem Computer Schlüssel, mit denen wir die Sicherung von Buchhaltungsdokumenten entschlüsseln konnten. <br><br>  Jeder wartet auf eine schnelle Lösung des Problems! <br><br><h4>  1.3.  Lösung </h4><br>  1. Zunächst müssen Sie das Root-Passwort in der virtuellen Maschine ändern, um Zugriff darauf zu erhalten.  Beim Start stellen wir fest, dass dies Ubuntu 16.04 Server ist. <br><br>  Um das Root-Passwort zurückzusetzen, starten wir den Computer neu. Gehen Sie beim Start, wenn das Grub-Menü angezeigt wird, mit der Schaltfläche „e“ zur Bearbeitung des Ubuntu-Elements.  Wir bearbeiten die Linux-Zeile und fügen am Ende <code>init=/bin/bash</code> .  Wir laden durch Strg + x, wir bekommen Bash.  Hängen Sie den Root mit rw erneut ein und ändern Sie das Passwort: <br><br><pre> <code class="bash hljs">$ mount -o remount,rw /dev/mapper/ubuntu--vg-root $ passwd</code> </pre> <br>  Vergessen Sie nicht die Synchronisierung, starten Sie neu. <br><br>  2. Die Bedingung besagt, dass der Webserver bei uns nicht funktioniert, wir schauen: <br><br><pre> <code class="bash hljs">$ curl localhost Not Found The requested URL / was not found on this server. Apache/2.4.18</code> </pre> <br>  Das heißt, Apache wird ausgeführt, antwortet jedoch mit Code 404. Wir sehen uns die Konfiguration an: <br><br><pre> <code class="bash hljs">$ vim /etc/apache2/sites-enabled/000-default.conf</code> </pre> <br>  Es gibt auch einen Schlüssel - StevenPaulSteveJobs. <br><br>  Wir überprüfen den Pfad <code>/usr/share/WordPress</code> - dies ist nicht der <code>/usr/share/wordpress</code> , aber es gibt <code>/usr/share/wordpress</code> .  Wir korrigieren die Konfiguration und starten den Apache neu. <br><br><pre> <code class="bash hljs">$ systemctl restart apache2</code> </pre> <br>  3. Wir versuchen es erneut, wir erhalten eine Fehlermeldung: <br><br><pre> <code class="bash hljs">Warning: mysqli_real_connect(): (HY000/2002): Connection refused <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> /usr/share/wordpress/wp-includes/wp-db.php on line 1488</code> </pre> <br>  Die Datenbank läuft nicht? <br><br><pre> <code class="bash hljs">$ systemctl status mysql Active: active (running)</code> </pre> <br>  Was ist los?  Es ist notwendig zu verstehen.  Dazu müssen Sie auf MySQL zugreifen. Wie das geht, finden Sie in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dokumentation</a> .  Einer der Punkte in der Dokumentation empfiehlt, dass wir die Option <code>/etc/mysql/mysql.conf.d/mysqld.cnf</code> <code>skip-grant-tables</code> in <code>/etc/mysql/mysql.conf.d/mysqld.cnf</code> .  Hier ist auch der Schlüssel - AugustaAdaKingByron. <br><br>  Wir korrigieren die Rechte für den Benutzer <code>'wp'@'localhost'</code> .  Wir starten MySQL, machen es über das Netzwerk zugänglich und kommentieren die Option zum <code>skip-networking</code> in der Konfiguration. <br><br>  4. Nach den durchgeführten Aktionen wird der Webserver gestartet, die Site funktioniert jedoch weiterhin nicht <br><br><pre> <code class="bash hljs">Warning: require_once(/usr/share/wordpress/wp-content/themes/twentysixteen/footer.php): failed to open stream: Permission denied <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> /usr/share/wordpress/wp-includes/template.php on line 562</code> </pre> <br>  Wir korrigieren die Rechte an der Datei. <br><br><pre> <code class="bash hljs">$ chmod 644 /usr/share/wordpress/wp-content/themes/twentysixteen/footer.php</code> </pre><br>  Wir aktualisieren die Seite, gehen zur Website und finden den Schlüssel - BjarneStroustrup!  Wir haben alle drei Schlüssel gefunden, unser Direktor kann arbeiten, wir haben die Buchhaltungsdateien entschlüsselt.  Alle sind glücklich und Sie haben noch viel Arbeit vor sich, um Infrastruktur, Backups und Sicherheit im Unternehmen zu etablieren. <br><br><h3>  2. Die zweite Stufe </h3><br>  Das Problem des Sammelns von Analysen musste gelöst werden.  Jeder liebt Analytik - wer und wo und in welcher Menge.  Wir haben uns einen Fall ausgedacht, dem alle Ingenieure im Leben in der einen oder anderen Form begegnen können. <br><br><h4>  2.1.  Interessante Fakten </h4><br>  Einer unserer Spieler hat in den ersten 10 Minuten des Spiels den richtigen Schlüssel eingegeben, und in der ersten Stunde haben wir einen Anführer, der die Aufgabe bewältigt hat. <br><br><h4>  2.2.  Aufgabe </h4><br>  Sie gingen zur Arbeit für das Unternehmen, Manager kamen zu Ihnen und fragten, an wen Briefe aus Afrika geschickt wurden.  Sie müssen die Top-21-Empfängeradressen darauf aufbauen.  Die Anfangsbuchstaben der Empfängeradressen sind der Schlüssel.  Eines: Der Mailserver, über den Briefe gesendet wurden, wird nicht geladen.  Jeder wartet auf eine schnelle Lösung des Problems! <br><br><h4>  2.3.  Lösung </h4><br>  1. Der Server wird aufgrund der nicht vorhandenen Swap-Partition in fstab nicht geladen. Beim Booten versucht das System, ihn bereitzustellen, und stürzt ab.  Wie boote ich? <br><br>  Laden Sie das Image herunter, wir haben CentOS 7 heruntergeladen, von der Live-CD / DVD gestartet (Fehlerbehebung -&gt; Rettung), das System gemountet, <code>/etc/fstab</code> bearbeitet.  Hier finden wir den ersten Schlüssel - GottfriedWilhelm11646Leibniz! <br><br>  Erstellen Sie einen Swap: <br><br><pre> <code class="bash hljs">$ lvcreate -n swap centos -L 256M $ sync &amp;&amp; reboot</code> </pre> <br>  2. Wie immer gibt es kein Kennwort. Sie müssen das Root-Kennwort auf der virtuellen Maschine ändern.  Das haben wir schon in der ersten Aufgabe gemacht.  Wir ändern und gehen erfolgreich zum Server, aber es wird sofort neu gestartet.  Der Server ist so schnell überlastet, dass keine Zeit bleibt, alle Protokolle sorgfältig zu prüfen.  Wie kann man verstehen, was passiert? <br><br>  Wieder booten wir von livecd, studieren sorgfältig die Systemprotokolle und für den Fall, dass wir in Kronen schauen, da eine solche Häufigkeit.  Dort finden wir das Problem und der zweite Schlüssel ist Alan1912MathisonTuring! <br><br>  Das <code>echo b &gt; /proc/sysrq-trigger</code> in <code>/etc/crontab</code> muss gelöscht oder <code>echo b &gt; /proc/sysrq-trigger</code> . <br><br>  3. Danach wurde der Server hochgefahren und Sie können die Aufgabe der Manager ausführen: "Wie lauten die Adressen Afrikas?"  Diese Informationen sind allgemein öffentlich zugänglich.  Sie finden diese Informationen im Internet unter den Begriffen „IP-Adresse Afrika“, „Geoip-Datenbank“.  Um das Problem zu lösen, können Sie frei verfügbare Adressverteilungsbasen (Geoip) verwenden.  Wir haben die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">MaxMind GeoLite2-</a> Datenbank, die unter der Creative Commons Attribution-ShareAlike 4.0-Lizenz verfügbar ist, als Referenz verwendet. <br><br>  Versuchen wir, unser Problem nur mit Linux-Systemdienstprogrammen zu lösen. Im Allgemeinen kann es jedoch auf vielfältige Weise gelöst werden: mithilfe von Textfilterdienstprogrammen und mithilfe von Skripten in verschiedenen Programmiersprachen. <br><br>  Zunächst erhalten wir nur die Paare "IP-Absender - Empfänger" aus dem E-Mail-Protokoll <code>/var/log/maillog</code> ( <code>/var/log/maillog</code> eine Tabelle mit der E-Mail- <code>/var/log/maillog</code> des Empfängers - IP-Absender).  Dies kann mit dem folgenden Befehl erfolgen: <br><br><pre> <code class="bash hljs">$ cat /var/<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>/maillog | fgrep -e <span class="hljs-string"><span class="hljs-string">' connect from'</span></span> -e <span class="hljs-string"><span class="hljs-string">'status=sent'</span></span> | sed <span class="hljs-string"><span class="hljs-string">'s/[]&lt;&gt;[]/ /g'</span></span> | awk <span class="hljs-string"><span class="hljs-string">'/connect from/ {ip=$11} /status=sent/ {print $10" "ip}'</span></span> &gt; log1.txt</code> </pre> <br>  Bevor wir mit der Zusammenstellung der Datenbank afrikanischer Adressen fortfahren, schauen wir uns die Top-IP-Adressen der Absender an. <br><br><pre> <code class="bash hljs">$ cat log1.txt | cut -d<span class="hljs-string"><span class="hljs-string">' '</span></span> -f1 | sort | uniq -c | sort -r | head -n 40 5206 L2JhbjAbM67GA99jg@mail.ru 4165 iHKTBkegOQa6fIALq@mail.ru 3739 nHkcBl7BdgXxijSYD7@mail.ru 3405 SMAzPJAzbl9vp4hAXo@mail.ru 3346 xILz6d7P@mail.ru</code> </pre><br>  Unter den ersten drei Empfängern von oben unterscheiden sich deutlich die Anzahl der Buchstaben.  Wenn Sie die IP-Adressen von Absendern überprüfen, die an Adressen aus diesen Top-3 gesendet wurden, können Sie die eindeutige Dominanz bestimmter Netzwerke erkennen: <br><br><pre> <code class="bash hljs">$ cat log1.txt | fgrep <span class="hljs-string"><span class="hljs-string">'L2JhbjAbM67GA99jg@mail.ru'</span></span> | cut -d<span class="hljs-string"><span class="hljs-string">' '</span></span> -f2 | sort | cut -d<span class="hljs-string"><span class="hljs-string">'.'</span></span> -f1 | uniq -c | sort -r | head 831 105 806 41 782 197 664 196 542 154 503 102 266 156 165 45 150 160 108 165</code> </pre> <br>  Die meisten Netzwerke 105/8, 41/8, 196 / 8,197 / 8 werden von AFRINIC zugewiesen - einem der fünf regionalen Internet-Registrare, die Internet-Ressourcen verteilen.  AFRINIC verteilt den Adressraum in Afrika.  Und 41/8 bezieht sich vollständig auf AFRINIC. <br><br><pre> <code class="bash hljs">https://www.nic.ru/whois/?searchWord=105.0.0.0 https://www.nic.ru/whois/?searchWord=41.0.0.0</code> </pre><br>  Die Antwort auf das Problem befindet sich also tatsächlich im Protokoll selbst. <br><br><pre> <code class="bash hljs">$ cat log1.txt | fgrep -e <span class="hljs-string"><span class="hljs-string">'105.'</span></span> -e <span class="hljs-string"><span class="hljs-string">'41.'</span></span> -e <span class="hljs-string"><span class="hljs-string">'196.'</span></span> -e <span class="hljs-string"><span class="hljs-string">'197.'</span></span> -e <span class="hljs-string"><span class="hljs-string">'154.'</span></span> -e <span class="hljs-string"><span class="hljs-string">'102.'</span></span> | awk <span class="hljs-string"><span class="hljs-string">'{print $1}'</span></span> | sort | uniq -c | sort -r | head -n 21 4209 L2JhbjAbM67GA99jg@mail.ru 3313 iHKTBkegOQa6fIALq@mail.ru 2704 nHkcBl7BdgXxijSYD7@mail.ru 2215 uvRbp1O@mail.ru 1774 sPmMsmmFiV@mail.ru 1448 BtG3aHgQgCKuze2AKuRH@mail.ru 1233 eQpuuQ2uQdbwRL3@mail.ru 958 nJT5dpaBZ@mail.ru 862 ef4WbQiB@mail.ru 762 dQCqKL6eVminFfH7wLA@mail.ru 632 ifq6Rd1HxuCQOdO9@mail.ru 539 cFwm2ssypMmx1sA7@mail.ru 531 twtTnr4G@mail.ru 431 TSrczgYASrR11Hs3qCi@mail.ru 380 o3r3exc3OL@mail.ru 357 rzmjr2VAHK@mail.ru 348 vnPr6YjJ3ndw@mail.ru 312 anOjFXrwOtLP2Rl1Vcz6@mail.ru 289 dvny5zHmRW8fiT@mail.ru 282 sgg9jPxFDYvzw8Kr@mail.ru 274 tKSevzA7GntJ@mail.ru</code> </pre> <br>  Zu diesem Zeitpunkt erhalten wir die Zeichenfolge "LinuxBenedictTorvadst". <br><br>  Der richtige Schlüssel ist LinusBenedictTorvalds. <br><br>  Die resultierende Zeichenfolge enthält einen Tippfehler in Bezug auf den richtigen Schlüssel in 3 extremen Zeichen.  Dies liegt an der Tatsache, dass die von uns ausgewählten Netzwerke nicht vollständig afrikanischen Ländern zugeordnet sind und wie die E-Mails nach IP-Adressen in unserem Protokoll verteilt werden. <br><br>  Bei ausreichender Klärung der größten den afrikanischen Ländern zugewiesenen Netze erhalten Sie die genaue Antwort: <br><br><pre> <code class="bash hljs">$ cat log1.txt | fgrep -e<span class="hljs-string"><span class="hljs-string">' '</span></span>105.{30..255}. -e<span class="hljs-string"><span class="hljs-string">' '</span></span>41. -e<span class="hljs-string"><span class="hljs-string">' '</span></span>196.{64..47}. -e<span class="hljs-string"><span class="hljs-string">' '</span></span>196.{248..132}. -e<span class="hljs-string"><span class="hljs-string">' '</span></span>197.{160..31}. -e<span class="hljs-string"><span class="hljs-string">' '</span></span>154.{127..255}. -e<span class="hljs-string"><span class="hljs-string">' '</span></span>102.{70..255}. -e<span class="hljs-string"><span class="hljs-string">' '</span></span>156.{155..255}. | awk <span class="hljs-string"><span class="hljs-string">'{print $1}'</span></span> | sort | uniq -c | sort -r | head -n 21 3350 L2JhbjAbM67GA99jg@mail.ru 2662 iHKTBkegOQa6fIALq@mail.ru 2105 nHkcBl7BdgXxijSYD7@mail.ru 1724 uvRbp1O@mail.ru 1376 sPmMsmmFiV@mail.ru 1092 BtG3aHgQgCKuze2AKuRH@mail.ru 849 eQpuuQ2uQdbwRL3@mail.ru 712 nJT5dpaBZ@mail.ru 584 ef4WbQiB@mail.ru 463 dQCqKL6eVminFfH7wLA@mail.ru 365 ifq6Rd1HxuCQOdO9@mail.ru 269 cFwm2ssypMmx1sA7@mail.ru 225 twtTnr4G@mail.ru 168 TSrczgYASrR11Hs3qCi@mail.ru 142 o3r3exc3OL@mail.ru 111 rzmjr2VAHK@mail.ru 96 vnPr6YjJ3ndw@mail.ru 78 anOjFXrwOtLP2Rl1Vcz6@mail.ru 56 lHzWiB7ExvRtSbAcU9@mail.ru 56 dvny5zHmRW8fiT@mail.ru 40 sgg9jPxFDYvzw8Kr@mail.ru</code> </pre> <br>  Das Problem kann auch auf andere Weise gelöst werden. <br>  Laden Sie MaxMind herunter, entpacken Sie es und die folgenden drei Teams lösen ebenfalls unser Problem. <br><br><pre> <code class="bash hljs">$ cat GeoLite2-Country-Locations-ru.csv | grep <span class="hljs-string"><span class="hljs-string">""</span></span> | cut -d<span class="hljs-string"><span class="hljs-string">','</span></span> -f1 &gt; africaIds.txt $ grep -Ff africaIds.txt GeoLite2-Country-Blocks-IPv4.csv | cut -d<span class="hljs-string"><span class="hljs-string">','</span></span> -f1 &gt; africaNetworks.txt $ grepcidr -f africaNetworks.txt log1.txt | cut -d<span class="hljs-string"><span class="hljs-string">' '</span></span> -f1 | sort | uniq -c | sort -r | head -n21</code> </pre><br>  Auf die eine oder andere Weise haben wir schließlich die Statistiken gezählt und die Manager haben die Daten erhalten, die sie zum Arbeiten benötigen! <br><br><h3>  3. Die dritte Stufe </h3><br>  Die dritte Stufe ähnelt der ersten - Sie müssen auch den Warmlampenservice reparieren, aber es ist schwieriger als bei der ersten Aufgabe. <br><br><h4>  3.1.  Interessante Fakten </h4><br>  In den ersten 15 Minuten fanden drei Spieler den ersten Schlüssel, 2 Stunden 20 Minuten nach Beginn der Etappe erledigte unser Gewinner die Aufgabe. <br><br><h4>  3.2.  Aufgabe </h4><br>  Sie haben in einem Unternehmen gearbeitet, in dem alle Unternehmensdokumente auf dem internen Wiki-Server gespeichert sind.  Im vergangenen Jahr bestellte ein Techniker zusätzlich zu einer vorhandenen drei neue Festplatten für den Server und argumentierte, dass es aus Gründen der Systemfehlertoleranz erforderlich sei, Festplatten in einige Arrays einzulegen.  Leider ging der Ingenieur einige Wochen nach ihrer Installation in Indien zur Ruhe und kehrte nicht zurück. <br><br>  Der Server arbeitete mehrere Jahre ohne Fehler, aber vor ein paar Tagen wurde das Netzwerk des Unternehmens gehackt.  Gemäß den Anweisungen haben die Sicherheitsbeamten die Datenträger vom Server entfernt und an Sie gesendet.  Während des Transports ging eine Festplatte unwiederbringlich verloren. <br><br>  Sie müssen das Wiki wiederherstellen. Zunächst ist der Inhalt der Wiki-Seiten von Interesse.  Ein Text, der sich auf einer der Seiten dieses Wikis befand, ist ein Passwort von einem 1C-Server und wird dringend benötigt, um es zu entsperren. <br><br>  Außerdem gab es irgendwo auf den Wiki-Seiten oder anderswo Passwörter vom Protokollserver und vom Videoüberwachungsserver, die ebenfalls wiederhergestellt werden sollten. Ohne sie ist es unmöglich, den Vorfall zu untersuchen.  Wie immer werden sie von einer operativen Lösung des Problems erwartet! <br><br><h4>  3.3.  Lösung </h4><br>  1. Wir versuchen, der Reihe nach von den Laufwerken zu booten, die wir haben, und überall erhalten wir die gleiche Meldung: <br><br><pre> <code class="bash hljs">No bootable medium found! System halted</code> </pre><br>  Es ist notwendig, von etwas zu booten.  Rettet den Start erneut von einer Live-CD / DVD (Fehlerbehebung -&gt; Rettung).  Beim Booten versuchen wir, die Boot-Partition zu finden. Wir finden sie nicht. Wir gelangen in die Shell.  Wir versuchen zu lernen, was und wie mit Festplatten.  Es ist bekannt, dass es drei davon gibt.  In der 7. Version von CentOS gibt es weitere Tools dafür. Dort gibt es <code>blkid</code> oder <code>lsblk</code> , die uns alle Informationen zu den Festplatten <code>lsblk</code> . <br><br>  Wie und was zu tun ist: <br><br><pre> <code class="bash hljs">$ ls /dev/sd*</code> </pre> <br>  Es ist sofort klar, dass <br><br><pre> <code class="bash hljs">/dev/sdb1 - ext4 /dev/sdb2 -  lvm /dev/sda1  /dev/sdc1 -   /dev/sda2  /dev/sdc2 -        </code> </pre> <br>  Mounten Sie sdb1, es ist klar, dass dies die Boot-Partition von CentOS 6 ist. <br><br><pre> <code class="bash hljs">$ mkdir /mnt/sdb1 &amp;&amp; mount /dev/sdb1 /mnt/sdb1</code> </pre> <br>  Offensichtlich gehen wir zum Grub-Bereich und finden dort den ersten Schlüssel - James191955Gosling in einer ungewöhnlichen Datei. <br><br>  2. Wir studieren pvs und lvs, während wir mit LVM arbeiten.  Wir sehen, dass es 2 physische Volumes geben sollte, eines befindet sich nicht und schwört auf die verlorene UID.  Wir sehen, dass es logisch 2 Volumes geben sollte: root und swap, während root teilweise verloren geht (das P-Attribut von volume).  Mount funktioniert nicht, aber sorry!  Wir brauchen ihn wirklich. <br><br>  Es gibt 2 weitere Festplatten, sieh sie dir an, montiere sie und montiere sie: <br><br><pre> <code class="bash hljs">$ mdadm --examine --verbose --scan $ mdadm --assemble --verbose --scan $ mkdir /mnt/md127 &amp;&amp; mount /dev/md127 /mnt/md127</code> </pre> <br>  Wir sehen, es ist klar, dass dies die CentOS 6-Boot-Partition ist und eine Aufnahme dessen, was bereits auf <code>/dev/sdb1</code> , und auch hier ist der gleiche Schlüssel James191955Gosling! <br><br>  Wir schauen uns an, wie <code>/dev/md127</code> . <br><br><pre> <code class="bash hljs">$ mdadm --detail /dev/md127</code> </pre><br>  Wir sehen, dass es aus 4 Festplatten zusammengesetzt werden musste, zusammengesetzt aus zwei <code>/dev/sda1</code> und <code>/dev/sdc1</code> , sie sollten die Nummern 2 und 4 im System sein.  Wir gehen davon aus, dass Sie auch ein Array aus <code>/dev/sda2</code> und <code>/dev/sdc2</code> .  Es ist unklar, warum sie keine Metadaten enthalten, aber dies liegt im Gewissen des Administrators, der sich irgendwo in Goa befindet.  Wir gehen davon aus, dass es RAID10 geben sollte, obwohl es Optionen gibt.  Wir sammeln: <br><br><pre> <code class="bash hljs">$ mdadm --create --verbose /dev/md0 --assume-clean --level=10 --raid-devices=4 missing /dev/sda2 missing /dev/sdc2</code> </pre><br>  Wir schauen uns blkid, pvs, lvs an.  Wir stellen fest, dass wir ein physisches Volumen gesammelt haben, das uns zuvor gefehlt hat. <br><br>  Wir haben lvroot sofort repariert, gemountet, aber zuerst VG aktiviert: <br><br><pre> <code class="bash hljs">$ vgchange -ay $ mkdir /mnt/lvroot &amp;&amp; mount /dev/mapper/vg_c6m1-lv_root /mnt/lvroot</code> </pre><br>  Und alles ist da, einschließlich des DennisBMacAlistairCRitchie-Schlüssels - im Stammverzeichnis - <code>/root/sweet</code> . <br><br>  3. Trotzdem versuchen wir, unseren Server wiederzubeleben, damit er normal startet.  Das gesamte logische Volume c aus unserem <code>/dev/md0</code> (wo wir alles haben) wird nach <code>/dev/sdb2</code> , wo der gesamte Server ursprünglich gearbeitet hat. <br><br><pre> <code class="bash hljs">$ pvmove /dev/md0 /dev/sdb2 $ vgreduce vg_c6m1 /dev/md0</code> </pre> <br>  Wir löschen den Server, entfernen 1 und 3 Festplatten, lassen die zweite, booten von der Live-CD / DVD in Rescue.  Wir finden den Boot-Bereich, stellen Sie den Bootloader in grub wieder her: <br><br><pre> <code class="bash hljs">root (hd0,0) setup (hd0)</code> </pre><br>  Wir reißen die Bootdiskette ab und booten erfolgreich, aber die Site funktioniert nicht. <br><br>  4. Es gibt zwei Möglichkeiten, um die Site zu starten: Konfigurieren Sie Apache von Grund auf neu oder verwenden Sie Nginx, das bereits im Voraus mit php-fpm konfiguriert wurde: <br><br><pre> <code class="bash hljs">$ /etc/init.d/nginx start $ /etc/init.d/php-fpm start</code> </pre><br>  Schließlich müssen Sie MySQL starten: <br><br><pre> <code class="bash hljs">$ /etc/init.d/mysqld start</code> </pre> <br>  Es startet nicht und die Lösung liegt in <code>/var/log/mysql</code> .  Sobald Sie das Problem mit MySQL lösen, funktioniert die Site. Auf der Hauptseite befindet sich ein Schlüssel - RichardGCCMatthewGNUStallman!  Jetzt haben wir Zugang zu 1C und die Mitarbeiter können bezahlt werden.  Und wie immer haben Sie noch viel Arbeit vor sich, um die Infrastruktur und Sicherheit im Unternehmen aufzubauen. <br><br>  Wir können auch wieder eine Liste von Büchern teilen, die uns und unseren Teilnehmern geholfen haben, sich auf das Spiel vorzubereiten: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">linux.mail.ru/books</a> . <br><br>  Danke, dass Sie bei uns sind!  Folgen Sie den Ankündigungen der nächsten Spiele! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de447222/">https://habr.com/ru/post/de447222/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de447210/index.html">@ Pythonetc-Zusammenstellung März 2019</a></li>
<li><a href="../de447212/index.html">Tipps und Tricks von meinem Telegramm-Kanal @pythonetc, März 2019</a></li>
<li><a href="../de447214/index.html">Wie man das Spieldesign mit optimalen Strategien verbessert</a></li>
<li><a href="../de447218/index.html">JPoint 2019 Parsing</a></li>
<li><a href="../de447220/index.html">Grundlagen der JavaScript-Engine: Allgemeine Formulare und Inline-Caching. Teil 2</a></li>
<li><a href="../de447226/index.html">Interview mit dem Popularisator der Wissenschaft, dem Leiter der einzigen privaten Schule für Astronomie in Russland, Pavel Skripnichenko</a></li>
<li><a href="../de447232/index.html">Persönliche Erfahrung. Wie wir internationale Telefonie verbunden haben: Vergleich von 6 virtuellen Vermittlungsstellen</a></li>
<li><a href="../de447234/index.html">Wie man polymorphe Programme mit Arrow schreibt</a></li>
<li><a href="../de447236/index.html">Erstellen einer Android-Gerätefarm mit Open STF</a></li>
<li><a href="../de447240/index.html">Lernen Sie kontroverse Taktiken, Techniken und allgemeines Wissen (ATT @ CK). Unternehmenstaktik. Teil 10</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>