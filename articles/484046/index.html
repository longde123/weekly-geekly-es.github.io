<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîß üñêüèø üßëüèø‚Äçü§ù‚Äçüßëüèº Comprobaci√≥n de Emby con PVS-Studio üßí üö¥ üë®üèº‚Äçüé§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Emby es un servidor de medios bastante popular junto con Plex y Kodi. En este art√≠culo, discutiremos los errores encontrados en su c√≥digo fuente con e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comprobaci√≥n de Emby con PVS-Studio</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/484046/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/rr/ar/h3/rrarh3smm2vkgpopwdn2fgqan0s.png" alt="Cuadro 3"></div><br>  Emby es un servidor de medios bastante popular junto con Plex y Kodi.  En este art√≠culo, discutiremos los errores encontrados en su c√≥digo fuente con el analizador est√°tico PVS-Studio.  El comentario "Construido con ReSharper" en el sitio web oficial del proyecto hace que el an√°lisis sea a√∫n m√°s interesante. <br><a name="habracut"></a><br><h2>  PVS-Studio </h2><br>  PVS-Studio se ejecuta en sistemas Windows, Linux y macOS de 64 bits.  Puede detectar errores en el c√≥digo fuente del software escrito en C, C ++, C # y Java. <br><br><h2>  El proyecto bajo an√°lisis. </h2><br>  Emby es un servidor de medios;  su c√≥digo fuente est√° disponible en <a href="https://github.com/MediaBrowser/Emby">GitHub</a> .  Permite al usuario transmitir y acceder a su contenido multimedia (video, audio, fotos) en cualquier dispositivo.  Aqu√≠ hay un breve resumen de las <a href="https://emby.media/">caracter√≠sticas</a> de <a href="https://emby.media/">Emby</a> seg√∫n el sitio web oficial del proyecto: <br><br><ul><li>  Emby convierte y transmite autom√°ticamente sus medios sobre la marcha para reproducirlos en cualquier dispositivo; </li><li>  Amplias opciones de control parental para facilitar el control de acceso al contenido, que es una caracter√≠stica importante para las familias con ni√±os peque√±os; </li><li>  Emby organiza su contenido en presentaciones f√°ciles y elegantes.  Sus medios personales nunca se ver√°n iguales; </li><li>  Streaming con soporte de sincronizaci√≥n en la nube; </li><li>  F√°cil intercambio de contenido con sus amigos y familiares; </li><li>  Y mucho mas. </li></ul><br><h2>  Los fragmentos de c√≥digo m√°s interesantes reportados por el analizador </h2><br>  <b>Mensaje de diagn√≥stico de PVS-Studio:</b> <a href="https://www.viva64.com/en/w/v3001/">V3001</a> Hay <a href="https://www.viva64.com/en/w/v3001/">subexpresiones</a> id√©nticas 'c! =' &lt;'' A la izquierda y a la derecha del operador '&amp;&amp;'.  HttpListenerRequest.Managed.cs 49 <br><br><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetRequestLine</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> req</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((ic &gt;= <span class="hljs-string"><span class="hljs-string">'A'</span></span> &amp;&amp; ic &lt;= <span class="hljs-string"><span class="hljs-string">'Z'</span></span>) || (ic &gt; <span class="hljs-number"><span class="hljs-number">32</span></span> &amp;&amp; c &lt; <span class="hljs-number"><span class="hljs-number">127</span></span> &amp;&amp; c != <span class="hljs-string"><span class="hljs-string">'('</span></span> &amp;&amp; c != <span class="hljs-string"><span class="hljs-string">')'</span></span> &amp;&amp; c != <span class="hljs-string"><span class="hljs-string">'&lt;'</span></span> &amp;&amp; <span class="hljs-comment"><span class="hljs-comment">// &lt;= c != '&lt;' &amp;&amp; c != '&gt;' &amp;&amp; c != '@' &amp;&amp; c != ',' &amp;&amp; c != ';' &amp;&amp; // &lt;= c != ':' &amp;&amp; c != '\\' &amp;&amp; c != '"' &amp;&amp; c != '/' &amp;&amp; c != '[' &amp;&amp; c != ']' &amp;&amp; c != '?' &amp;&amp; c != '=' &amp;&amp; c != '{' &amp;&amp; c != '}')) continue; .... }</span></span></code> </pre> <br>  El analizador ha detectado una subexpresi√≥n duplicada <i>c! = '&lt;'</i> .  Una explicaci√≥n es que este es un error de programaci√≥n y el desarrollador ten√≠a la intenci√≥n de escribir algo m√°s en lugar de <i>'&lt;'</i> .  Otra explicaci√≥n m√°s probable es que la segunda subexpresi√≥n no estaba destinada a estar all√≠ y deber√≠a eliminarse. <br><br>  <b>Mensaje de diagn√≥stico de PVS-Studio:</b> <a href="https://www.viva64.com/en/w/v3001/">V3001</a> Hay <a href="https://www.viva64.com/en/w/v3001/">subexpresiones</a> id√©nticas 'SmbConstants.AttrHidden' a la izquierda y a la derecha de '|'  operador  SmbComDelete.cs 29 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SmbComDelete</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fileName</span></span></span><span class="hljs-function">)</span></span> { Path = fileName; Command = SmbComDelete; _searchAttributes = SmbConstants.AttrHidden | SmbConstants.AttrHidden | SmbConstants.AttrSystem; }</code> </pre> <br>  Otro error tipogr√°fico que tiene que ver con subexpresiones duplicadas.  Como nota al margen, hay demasiados problemas como ese en el c√≥digo fuente de Emby: errores causados ‚Äã‚Äãpor la falta de atenci√≥n.  Sin embargo, no culpo a los desarrolladores;  todos podemos estar distra√≠dos a veces ( <a href="https://www.viva64.com/en/examples/v501/">ejemplos</a> , <a href="https://www.viva64.com/en/examples/v3001/">ejemplos</a> , <a href="https://www.viva64.com/en/examples/v6001/">ejemplos</a> ), y esto es exactamente por qu√© existe el an√°lisis est√°tico: para protegernos de nuestros propios errores. <br><br>  <b>Mensaje de diagn√≥stico de PVS-Studio:</b> <a href="https://www.viva64.com/en/w/v3004/">V3004</a> La declaraci√≥n 'then' es equivalente a la declaraci√≥n 'else'.  SqliteItemRepository.cs 5648 <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> QueryResult&lt;Tuple&lt;BaseItem, ItemCounts&gt;&gt; GetItemValues(....) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (typesToCount.Length == <span class="hljs-number"><span class="hljs-number">0</span></span>) { whereText += <span class="hljs-string"><span class="hljs-string">" And CleanName In (Select CleanValue from ItemValues where "</span></span> + typeClause + <span class="hljs-string"><span class="hljs-string">" AND ItemId in (select guid from TypedBaseItems"</span></span> + innerWhereText + <span class="hljs-string"><span class="hljs-string">"))"</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">//whereText += " And itemTypes not null"; whereText += " And CleanName In (Select CleanValue from ItemValues where " + typeClause + " AND ItemId in (select guid from TypedBaseItems" + innerWhereText + "))"; } .... }</span></span></code> </pre> <br>  Y este se parece mucho a un error de copiar y pegar porque los bloques <i>if</i> y <i>else</i> tienen los mismos cuerpos.  ¬øDe qu√© sirve comprobar el <i>tama√±o de la</i> matriz <i>typesToCount</i> si no afecta a la l√≥gica de ejecuci√≥n posterior?  Esto es algo que solo los autores saben. <br><br>  <b>Mensaje de diagn√≥stico de PVS-Studio:</b> <a href="https://www.viva64.com/en/w/v3005/">V3005</a> La variable '_validProviderIds' se asigna a s√≠ misma.  BaseNfoParser.cs 77 <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt; _validProviderIds; .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Fetch</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... _validProviderIds = _validProviderIds = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary&lt;....&gt;(....); .... }</code> </pre> <br>  Otro error tipogr√°fico, lo que resulta en asignar a una variable su propio valor.  Este c√≥digo necesita revisi√≥n. <br><br>  <b>Mensaje de diagn√≥stico de PVS-Studio:</b> <a href="https://www.viva64.com/en/w/v3008/">V3008</a> A la variable 'Cap√≠tulos' se le asignan valores dos veces seguidas.  Quiz√°s esto sea un error.  L√≠neas de verificaci√≥n: 29, 28. T√≠tulo.cs 29 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Title</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params"> titleNum</span></span></span><span class="hljs-function">)</span></span> { ProgramChains = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;ProgramChain&gt;(); Chapters = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;Chapter&gt;(); Chapters = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;Chapter&gt;(); TitleNumber = titleNum; }</code> </pre> <br>  Se trata de falta de atenci√≥n y errores tipogr√°ficos de nuevo ... Las variables de los <i>cap√≠tulos se</i> les asigna un valor dos veces.  Claro, esta asignaci√≥n duplicada no har√° ning√∫n da√±o, pero a√∫n as√≠ no quieres cosas como esas en tu c√≥digo.  No tiene sentido demorarse en este, as√≠ que sigamos adelante. <br><br>  <b>Mensaje de diagn√≥stico de PVS-Studio:</b> <a href="https://www.viva64.com/en/w/v3013/">V3013</a> Es extra√±o que el cuerpo de la funci√≥n 'Leer' sea completamente equivalente al cuerpo de la funci√≥n 'Escribir' (407, l√≠nea 415).  BaseSqliteRepository.cs 407 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> IDisposable </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Read</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ReaderWriterLockSlim obj</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WriteLockToken(obj); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> IDisposable </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Write</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ReaderWriterLockSlim obj</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WriteLockToken(obj); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">WriteLockToken</span></span> : <span class="hljs-title"><span class="hljs-title">IDisposable</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ReaderWriterLockSlim _sync; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteLockToken</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ReaderWriterLockSlim sync</span></span></span><span class="hljs-function">)</span></span> { _sync = sync; sync.EnterWriteLock(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Dispose</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_sync != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { _sync.ExitWriteLock(); _sync = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } } }</code> </pre> <br>  Las funciones <i>Leer</i> y <i>Escribir</i> tienen los mismos cuerpos, y eso es lo que nos dice el analizador.  El m√©todo <a href="https://docs.microsoft.com/en-us/dotnet/api/system.threading.readerwriterlockslim.enterwritelock%3Fview%3Dnetframework-4.8"><i>EnterWriteLock</i></a> se usa para ingresar el bloqueo en modo de escritura.  Si desea ingresar el bloqueo en modo de lectura, use el m√©todo <i>EnterReadLock</i> , que permite que un recurso sea le√≠do por varios hilos a la vez. <br><br>  Los desarrolladores deben verificar este c√≥digo porque es muy probable que contenga un error, sobre todo porque hay una clase no utilizada en el c√≥digo: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ReadLockToken</span></span> : <span class="hljs-title"><span class="hljs-title">IDisposable</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ReaderWriterLockSlim _sync; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadLockToken</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ReaderWriterLockSlim sync</span></span></span><span class="hljs-function">)</span></span> { _sync = sync; sync.EnterReadLock(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Dispose</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_sync != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { _sync.ExitReadLock(); _sync = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } } }</code> </pre> <br>  <b>Mensaje de diagn√≥stico de PVS-Studio:</b> <a href="https://www.viva64.com/en/w/v3021/">V3021</a> Hay dos declaraciones 'if' con expresiones condicionales id√©nticas.  La primera instrucci√≥n 'if' contiene el m√©todo return.  Esto significa que la segunda declaraci√≥n 'if' no tiene sentido SkiaEncoder.cs 537 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EncodeImage</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> inputPath, DateTime dateModified, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> outputPath, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> autoOrient, ImageOrientation? orientation, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> quality, ImageProcessingOptions options, ImageFormat selectedOutputFormat</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrWhiteSpace(inputPath)) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-string"><span class="hljs-string">"inputPath"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrWhiteSpace(inputPath)) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-string"><span class="hljs-string">"outputPath"</span></span>); } .... }</code> </pre> <br>  El desarrollador debe haber clonado las primeras cuatro l√≠neas, pero se olvid√≥ de cambiar el nombre de la variable que se verifica de <i>inputPath</i> a <i>outputPath</i> .  Hay varias l√≠neas m√°s all√° donde <i>outputPath</i> se usa sin una verificaci√≥n nula previa, lo que significa que se puede lanzar una excepci√≥n. <br><br>  <b>Mensajes de diagn√≥stico de PVS-Studio:</b> <br><br><ul><li>  La expresi√≥n V3022 'processUnsupportedFrame (frame, CloseStatusCode.PolicyViolation, null)' siempre es falsa.  WebSocket.cs 462 </li><li>  V3022 La expresi√≥n 'processCloseFrame (frame)' siempre es falsa.  WebSocket.cs 461 </li><li>  V3022 Expresi√≥n 'frame.IsClose?  processCloseFrame (frame): processUnsupportedFrame (frame, CloseStatusCode.PolicyViolation, null) 'siempre es falso.  WebSocket.cs 460 </li><li>  V3022 La expresi√≥n 'processPongFrame (frame)' siempre es verdadera.  WebSocket.cs 459 </li><li>  La expresi√≥n V3022 'processPingFrame (frame)' siempre es verdadera.  WebSocket.cs 457 </li><li>  V3022 La expresi√≥n 'processDataFrame (frame)' siempre es verdadera.  WebSocket.cs 455 </li><li>  V3022 La expresi√≥n siempre es falsa.  WebSocket.cs 448 </li></ul><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">processWebSocketFrame</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">WebSocketFrame frame</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> frame.IsCompressed &amp;&amp; _compression == CompressionMethod.None ? processUnsupportedFrame(....) : frame.IsFragmented ? processFragmentedFrame(frame) : frame.IsData ? processDataFrame(frame) : frame.IsPing ? processPingFrame(frame) : frame.IsPong ? processPongFrame(frame) : frame.IsClose ? processCloseFrame(frame) : processUnsupportedFrame(....); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">processUnsupportedFrame</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { processException(....); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">processDataFrame</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">WebSocketFrame frame</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">processPingFrame</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">WebSocketFrame frame</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mask = Mask.Unmask; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">processPongFrame</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">WebSocketFrame frame</span></span></span><span class="hljs-function">)</span></span> { _receivePong.Set(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">processCloseFrame</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">WebSocketFrame frame</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> payload = frame.PayloadData; close(payload, !payload.ContainsReservedCloseStatusCode, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; }</code> </pre> <br>  He verificado menos proyectos que mis compa√±eros de equipo de PVS-Studio hasta ahora, y esto probablemente explica por qu√© nunca antes hab√≠a visto un fragmento de c√≥digo de 13 l√≠neas que activar√≠a 7 advertencias a la vez (es decir, un poco m√°s de una advertencia por dos l√≠neas).  Por eso incluyo este caso en el art√≠culo.  A continuaci√≥n se muestra un an√°lisis paso a paso del fragmento del problema. <br><br><ol><li>  La expresi√≥n <i>frame.IsCompressed &amp;&amp; _compression == CompressionMethod.None</i> se eval√∫a primero.  Si es cierto, el m√©todo <i>processUnsupportedFrame</i> se ejecutar√° y devolver√° <i>falso</i> en cualquier caso (esta es la primera advertencia).  Si el cheque es <i>falso</i> , pasamos al siguiente. </li><li>  Se <i>marca el</i> valor <i>frame.IsFragmented</i> .  No hay problemas aqu√≠. </li><li>  El valor <i>frame.IsData</i> est√° marcado.  Si es cierto, el m√©todo <i>processDataFrame</i> devolver√° <i>verdadero</i> en cualquier caso.  Esta es la segunda advertencia. </li><li>  El valor <i>frame.IsPing</i> est√° marcado.  Si es cierto, el m√©todo <i>processPingFrame</i> devolver√° <i>verdadero</i> .  Esta es la tercera advertencia. </li><li>  El valor <i>frame.IsPong</i> est√° marcado.  Igual que el anterior. </li><li>  El √∫ltimo: <i>frame.IsClose</i> .  <i>processCloseFrame</i> y <i>processUnsupportedFrame</i> devuelven <i>false</i> en cualquier caso. </li></ol><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/sq/ut/pe/squtpenxx02rmgsg31uyqk7yt6q.png" alt="Imagen 1"></div><br>  Espero que no haya sido demasiado tedioso para seguir.  Los ejemplos restantes no son tan complicados. <br><br>  <b>Mensaje de diagn√≥stico de PVS-Studio:</b> <a href="https://www.viva64.com/en/w/v3085/">V3085</a> El nombre del campo 'RtpHeaderBytes' en un tipo anidado es ambiguo.  El tipo externo contiene un campo est√°tico con un nombre id√©ntico.  HdHomerunUdpStream.cs 200 <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">HdHomerunUdpStream</span></span> : <span class="hljs-title"><span class="hljs-title">LiveStream</span></span>, <span class="hljs-title"><span class="hljs-title">IDirectStreamProvider</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> RtpHeaderBytes = <span class="hljs-number"><span class="hljs-number">12</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">UdpClientStream</span></span> : <span class="hljs-title"><span class="hljs-title">Stream</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> RtpHeaderBytes = <span class="hljs-number"><span class="hljs-number">12</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> PacketSize = <span class="hljs-number"><span class="hljs-number">1316</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> MediaBrowser.Model.Net.ISocket _udpClient; <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> disposed; .... } .... }</code> </pre> <br>  La clase anidada <i>UdpClientStream</i> tiene un campo cuyo nombre es id√©ntico al de un campo de la clase <i>adjunta HdHomerunUdpStream</i> .  No es un error, pero es una buena raz√≥n para revisar este c√≥digo nuevamente para asegurarse de que sea correcto.  Tener variables con nombres id√©nticos facilita el uso accidental de una de ellas en lugar de la otra, lo que resulta en el comportamiento inesperado del programa, mientras que el compilador no dice una palabra. <br><br>  <b>Mensajes de diagn√≥stico de PVS-Studio:</b> <br><br><ul><li>  V3090 Bloqueo inseguro en un tipo.  Todas las instancias de un tipo tendr√°n el mismo objeto 'Tipo'.  Lmhosts.cs 49 </li><li>  V3090 Bloqueo inseguro en un tipo.  Todas las instancias de un tipo tendr√°n el mismo objeto 'Tipo'.  Lmhosts.cs 57 </li></ul><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Lmhosts</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> NbtAddress </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetByName</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> host</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">lock</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Lmhosts)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> GetByName(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Name(host, <span class="hljs-number"><span class="hljs-number">0x20</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>)); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> NbtAddress </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetByName</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Name name</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">lock</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Lmhosts)) { .... } } }</code> </pre> <br>  El analizador advierte sobre un bloqueo inseguro aqu√≠.  No se recomienda usar el <i>bloqueo</i> de esa manera porque el objeto de bloqueo es de acceso p√∫blico y se puede bloquear en otro lugar, y el desarrollador que utiliz√≥ este objeto por primera vez puede no saberlo.  Esto puede conducir a un punto muerto. <br><br>  Idealmente, debe usar un campo privado para bloquear, por ejemplo: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Object locker = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Object(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> NbtAddress </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetByName</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> host</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">lock</span></span> (locker) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> GetByName(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Name(host, <span class="hljs-number"><span class="hljs-number">0x20</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>)); } }</code> </pre> <br>  <b>Mensaje de diagn√≥stico de PVS-Studio:</b> V3142 C√≥digo inalcanzable detectado.  Es posible que haya un error presente.  HdHomerunHost.cs 621 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> Task&lt;ILiveStream&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetChannelStream</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> enableHttpStream = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (enableHttpStream) { mediaSource.Protocol = MediaProtocol.Http; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> httpUrl = channelInfo.Path; <span class="hljs-comment"><span class="hljs-comment">// If raw was used, the tuner doesn't support params if (!string.IsNullOrWhiteSpace(profile) &amp;&amp; !string.Equals(profile, "native", StringComparison.OrdinalIgnoreCase)) { httpUrl += "?transcode=" + profile; } mediaSource.Path = httpUrl; return new SharedHttpStream(....); } return new HdHomerunUdpStream(....); }</span></span></code> </pre> <br>  El analizador dice que la √∫ltima l√≠nea de este fragmento nunca se ejecutar√°.  ¬øY cu√°l es el prop√≥sito de declarar la variable enableHttpStream, asignarle <i>verdadero</i> y verificarla inmediatamente despu√©s? <br><br>  Quiz√°s este c√≥digo sea simplemente redundante, pero de todos modos necesita una revisi√≥n. <br><br>  <b>Mensaje de diagn√≥stico de PVS-Studio:</b> <a href="https://www.viva64.com/en/w/v3083/">V3083</a> Invocaci√≥n insegura del evento 'RefreshStarted', NullReferenceException es posible.  Considere asignar un evento a una variable local antes de invocarlo.  ProviderManager.cs 943 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnRefreshStart</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BaseItem item</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (RefreshStarted != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { RefreshStarted(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GenericEventArgs&lt;BaseItem&gt;(item)); } }</code> </pre> <br>  El analizador nos advierte sobre una llamada potencialmente insegura del controlador de eventos <i>RefreshStarted</i> . <br><br>  Veamos por qu√© esta llamada no es segura.  Suponga que el evento se da de baja de otro subproceso en el momento entre verificar el evento como nulo y llamar al controlador de eventos en el cuerpo de la instrucci√≥n <i>if</i> .  Si no quedan suscriptores, el evento <i>RefreshStarted</i> se volver√° <i>nulo</i> , pero en el hilo donde la verificaci√≥n nula ya pas√≥, la llamada se ejecutar√° de todos modos: <br><br><pre> <code class="cs hljs">RefreshStarted(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GenericEventArgs&lt;BaseItem&gt;(item));</code> </pre> <br>  Esto resultar√° en arrojar una <i>NullReferenceException</i> . <br><br>  <b>Mensaje de diagn√≥stico de PVS-Studio:</b> <a href="https://www.viva64.com/en/w/v3029/">V3029</a> Las expresiones condicionales de las declaraciones 'if' ubicadas una junto a la otra son id√©nticas.  L√≠neas de verificaci√≥n: 142, 152. LocalImageProvider.cs 142 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PopulateImages</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-comment"><span class="hljs-comment">// Logo if (!isEpisode &amp;&amp; !isSong &amp;&amp; !isPerson) { added = AddImage(....); if (!added) { added = AddImage(....); } } // Art if (!isEpisode &amp;&amp; !isSong &amp;&amp; !isPerson) { AddImage(....); } .... }</span></span></code> </pre> <br>  Las dos declaraciones <i>if</i> tienen condiciones id√©nticas, pero sus cuerpos son diferentes.  No estoy seguro de si esto es un error o solo un c√≥digo redundante.  Quiz√°s est√° bien y el desarrollador simplemente quer√≠a diferenciar expl√≠citamente entre dos acciones, una de las cuales tiene que ver con "Logo" y la otra con "Art", cualesquiera que sean. <br><br>  <b>Mensaje de diagn√≥stico de PVS-Studio:</b> <a href="https://www.viva64.com/en/w/v3041/">V3041</a> La expresi√≥n se <a href="https://www.viva64.com/en/w/v3041/">convirti√≥</a> impl√≠citamente de tipo 'int' a tipo 'doble'.  Considere utilizar un molde de tipo expl√≠cito para evitar la p√©rdida de una parte fraccional.  Un ejemplo: doble A = (doble) (X) / Y;.  LiveTvManager.cs 1085 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> Task </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RefreshChannelsInternal</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> progressPerService = _services.Length == <span class="hljs-number"><span class="hljs-number">0</span></span> ? <span class="hljs-number"><span class="hljs-number">0</span></span> : <span class="hljs-number"><span class="hljs-number">1</span></span> / _services.Length; .... }</code> </pre> <br>  Este c√≥digo contiene una divisi√≥n entera, con el valor resultante convertido a un tipo de punto flotante, que no parece ser lo correcto. <br><br>  En realidad, la variable <i>progressPerService</i> tendr√° el valor 1.0 solo si <i>_services.Length = 1</i> .  Con cualquier otro valor de <i>_services.Length</i> , el resultado ser√° <i>0.0</i> . <br><br>  Creo que lo que deber√≠a escribirse es lo siguiente: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">double</span></span> progressPerService = _services.Length == <span class="hljs-number"><span class="hljs-number">0</span></span> ? <span class="hljs-number"><span class="hljs-number">0</span></span> : (<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>)<span class="hljs-number"><span class="hljs-number">1</span></span> / _services.Length;</code> </pre> <br>  <b>Mensaje de diagn√≥stico de PVS-Studio:</b> <a href="https://www.viva64.com/en/w/v3050/">V3050</a> Posiblemente un HTML incorrecto.  Se encontr√≥ la etiqueta de cierre &lt;/u&gt;, mientras que se esperaba la etiqueta &lt;/i&gt;.  SrtParserTests.cs 64 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TestParse</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> expectedSubs = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SubtitleTrackInfo { TrackEvents = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SubtitleTrackEvent[] { .... <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SubtitleTrackEvent { Id = <span class="hljs-string"><span class="hljs-string">"6"</span></span>, StartPositionTicks = <span class="hljs-number"><span class="hljs-number">330000000</span></span>, EndPositionTicks = <span class="hljs-number"><span class="hljs-number">339990000</span></span>, Text = <span class="hljs-string"><span class="hljs-string">"This contains nested &lt;b&gt;bold, &lt;i&gt;italic, &lt;u&gt;underline&lt;/u&gt; and &lt;s&gt;strike-through&lt;/s&gt;&lt;/u&gt;&lt;/i&gt;&lt;/b&gt; HTML tags"</span></span> }, .... } }; }</code> </pre> <br>  Tenga en cuenta esta l√≠nea: <br><br><pre> <code class="cs hljs">&lt;u&gt;underline&lt;/u&gt;</code> </pre> <br>  Ya tiene una etiqueta de cierre <i>&lt;/u&gt;</i> . <br>  Luego vemos el siguiente texto: <br><pre> <code class="cs hljs">&lt;/s&gt;&lt;/u&gt;&lt;/i&gt;&lt;/b&gt; HTML tags<span class="hljs-string"><span class="hljs-string">"</span></span></code> </pre> <br>  Aqu√≠ hay una etiqueta de cierre adicional <i>&lt;/u&gt;</i> , que es lo que se√±ala el analizador. <br><br>  <b>Mensaje de diagn√≥stico de PVS-Studio:</b> <a href="https://www.viva64.com/en/w/v3051/">V3051</a> Una verificaci√≥n de tipo excesiva.  El objeto ya es del tipo 'Excepci√≥n'.  SmbFileInputStream.cs 107 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> IOException </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SeToIoe</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">SmbException se</span></span></span><span class="hljs-function">)</span></span> { IOException ioe = se; Exception root = se.GetRootCause(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (root <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> TransportException) { ioe = (TransportException)root; root = ((TransportException)ioe).GetRootCause(); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (root <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> Exception) { ioe = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IOException(root.Message); ioe.InitCause(root); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ioe; }</code> </pre> <br>  Francamente, no entiendo muy bien qu√© quer√≠a decir el desarrollador con este c√≥digo.  El analizador dice que la segunda condici√≥n de la instrucci√≥n <i>if</i> verifica si el objeto <i>ra√≠z</i> es compatible con su propio tipo.  Probablemente sea un c√≥digo redundante, pero parece extra√±o y recomiendo revisarlo. <br><br><h2>  Conclusi√≥n </h2><br>  Los desarrolladores de Emby han hecho un gran trabajo en todos los sentidos (el proyecto tiene 215,539 LOC de largo, 4.6% de los cuales son comentarios).  Lo hicieron bien, lo digo en serio.  Pero PVS-Studio tambi√©n merece elogios: produjo 113 advertencias de alto <a href="https://www.viva64.com/en/m/0007/">nivel</a> , 213 de nivel medio y 112 de bajo nivel.  Algunos de ellos eran falsos positivos, pero la mayor√≠a de los errores no se mencionaron aqu√≠ porque eran muy parecidos.  Por ejemplo, el diagn√≥stico <a href="https://www.viva64.com/en/w/v3022/">V3022</a> (siempre condici√≥n falsa / verdadera) solo se activ√≥ 106 veces.  Por supuesto, podr√≠a haber filtrado los falsos positivos e incluir el resto en el art√≠culo, pero habr√≠a sido demasiado aburrido para leer. <br><br>  Espero haber logrado mostrar c√≥mo el an√°lisis est√°tico ayuda en el desarrollo de software.  Obviamente, los cheques √∫nicos no son suficientes;  Debe utilizar el an√°lisis est√°tico de forma regular.  Este tema se trata con m√°s detalle en el art√≠culo " <a href="https://www.viva64.com/en/b/0594/">Godot: sobre el uso regular de analizadores est√°ticos</a> ". </div></div><p>Source: <a href="https://habr.com/ru/post/484046/">https://habr.com/ru/post/484046/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../484020/index.html">¬øA qui√©n est√°s tratando de impresionar con tus plazos?</a></li>
<li><a href="../484026/index.html">Parte 6: Portar MemTest86 + a RISC-V</a></li>
<li><a href="../484028/index.html">Horseshoe Bend - tableta convertible con pantalla plegable</a></li>
<li><a href="../484034/index.html">Implementaci√≥n del esquema de trabajo del almacenamiento dirigido de bienes basado en la unidad de contabilidad de almac√©n 1C Integrated Automation 2</a></li>
<li><a href="../484036/index.html">Nuevo grupo industrial crea un est√°ndar universal para hogares inteligentes</a></li>
<li><a href="../484048/index.html">PHP y expresiones regulares: lo b√°sico para principiantes</a></li>
<li><a href="../484050/index.html">Incruste el an√°lisis del c√≥digo fuente con el analizador PVS-Studio</a></li>
<li><a href="../484052/index.html">Tareas para la base lunar</a></li>
<li><a href="../484056/index.html">¬øSu proyecto realmente necesita pruebas?</a></li>
<li><a href="../484062/index.html">Aprendiendo ingl√©s por MEMASICS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>