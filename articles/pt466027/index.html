<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèæ‚Äçüé® üò± ü¶ë O livro "O Caminho do Python. Faixa preta para desenvolvimento, dimensionamento, teste e implanta√ß√£o ‚Äù üíõ ‚å®Ô∏è üèµÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Oi, habrozhiteli! O Python Path permite aprimorar suas habilidades profissionais e aprender o m√°ximo poss√≠vel sobre os recursos da linguagem de progra...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>O livro "O Caminho do Python. Faixa preta para desenvolvimento, dimensionamento, teste e implanta√ß√£o ‚Äù</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/466027/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/kq/of/aw/kqofawsaidazmnefdopvktmtxei.jpeg" align="left" alt="imagem"></a>  Oi, habrozhiteli!  O Python Path permite aprimorar suas habilidades profissionais e aprender o m√°ximo poss√≠vel sobre os recursos da linguagem de programa√ß√£o mais popular.  Voc√™ aprender√° como escrever um c√≥digo eficaz, criar os melhores programas em um tempo m√≠nimo e evitar erros comuns.  √â hora de se familiarizar com a computa√ß√£o e memoiza√ß√£o multithread, obter aconselhamento especializado no campo da API e design de banco de dados, bem como olhar dentro do Python para expandir sua compreens√£o da linguagem.  Voc√™ precisa iniciar um projeto, trabalhar com vers√µes, organizar testes autom√°ticos e escolher um estilo de programa√ß√£o para uma tarefa espec√≠fica.  Em seguida, voc√™ estudar√° declara√ß√µes de fun√ß√µes eficazes, selecionar√° estruturas e bibliotecas de dados adequadas, criar√° programas, pacotes sem problemas e otimizar√° programas no n√≠vel do bytecode. <br><a name="habracut"></a><br><h3>  Trecho.  Executando testes em paralelo </h3><br>  A execu√ß√£o de su√≠tes de teste pode ser demorada.  Essa √© uma ocorr√™ncia comum em grandes projetos, quando um conjunto de testes leva alguns minutos para ser conclu√≠do.  Por padr√£o, o pytest executa testes sequencialmente, em uma ordem espec√≠fica. <br><br>  Como a maioria dos computadores possui processadores com v√°rios n√∫cleos, voc√™ pode acelerar se separar os testes para executar em v√°rios n√∫cleos. <br><br>  Para isso, o pytest possui um plugin pytest-xdist que pode ser instalado usando o pip.  Este plug-in estende a linha de comando pytest com o argumento ‚Äì‚Äìnumprocesses (abreviado ‚Äìn), que pega o n√∫mero de n√∫cleos usados ‚Äã‚Äãcomo argumento.  O lan√ßamento do pytest ‚Äìn 4 executar√° o conjunto de testes em quatro processos paralelos, mantendo um equil√≠brio entre a carga de n√∫cleos dispon√≠veis. <br><br>  Devido ao fato de que o n√∫mero de n√∫cleos pode variar, o plug-in tamb√©m aceita a palavra-chave autom√°tica como um valor.  Nesse caso, o n√∫mero de n√∫cleos dispon√≠veis ser√° retornado automaticamente. <br><br><h3>  Criando objetos usados ‚Äã‚Äãem testes usando acess√≥rios </h3><br>  Nos testes de unidade, muitas vezes √© necess√°rio executar um conjunto de opera√ß√µes padr√£o antes e depois da execu√ß√£o do teste, e essas instru√ß√µes envolvem certos componentes.  Por exemplo, voc√™ pode precisar de um objeto que expresse o estado da configura√ß√£o do aplicativo e ele deve ser inicializado antes de cada teste e, em seguida, redefinido para seus valores iniciais ap√≥s a execu√ß√£o.  Da mesma forma, se o teste depender de um arquivo tempor√°rio, esse arquivo dever√° ser criado antes do teste e exclu√≠do depois.  Esses componentes s√£o chamados de <i>lumin√°rias</i> .  Eles s√£o instalados antes do teste e desaparecem ap√≥s sua execu√ß√£o. <br><br>  No pytest, os equipamentos s√£o declarados como fun√ß√µes simples.  A fun√ß√£o de fixa√ß√£o deve retornar o objeto desejado para que, nos testes onde √© usado, esse objeto possa ser usado. <br><br>  Aqui est√° um exemplo de um acess√≥rio simples: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pytest @pytest.fixture <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">database</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> &lt;some database connection&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_insert</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(database)</span></span></span><span class="hljs-function">:</span></span> database.insert(<span class="hljs-number"><span class="hljs-number">123</span></span>)</code> </pre> <br>  O dispositivo el√©trico do banco de dados √© usado automaticamente por qualquer teste que tenha o argumento do banco de dados em sua lista.  A fun√ß√£o test_insert () receber√° o resultado da fun√ß√£o database () como o primeiro argumento e usar√° esse resultado como achar melhor.  Com esse uso de acess√≥rios, voc√™ n√£o precisa repetir o c√≥digo de inicializa√ß√£o do banco de dados v√°rias vezes. <br><br>  Outra caracter√≠stica comum do teste de c√≥digo √© a capacidade de remover sup√©rfluos ap√≥s a opera√ß√£o do aparelho.  Por exemplo, feche a conex√£o com o banco de dados.  A implementa√ß√£o do dispositivo el√©trico como um gerador adicionar√° funcionalidade para limpar objetos verificados (Listagem 6.5). <br><br><blockquote><h4>  Listagem 6.5.  Limpando um objeto verificado </h4><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pytest @pytest.fixture <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">database</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> db = &lt;some database connection&gt; <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> db db.close() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_insert</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(database)</span></span></span><span class="hljs-function">:</span></span> database.insert(<span class="hljs-number"><span class="hljs-number">123</span></span>)</code> </pre> </blockquote>  Como usamos a palavra-chave yield e criamos um gerador a partir do banco de dados, o c√≥digo ap√≥s a instru√ß√£o yield √© executado apenas no final do teste.  Este c√≥digo fechar√° a conex√£o com o banco de dados no final do teste. <br><br>  Fechar a conex√£o com o banco de dados para cada teste pode causar desperd√≠cio injustificado de poder de computa√ß√£o, pois outros testes podem usar uma conex√£o j√° aberta.  Nesse caso, voc√™ pode passar o argumento do escopo para o decorador do dispositivo el√©trico, especificando seu escopo: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pytest @pytest.fixture(scope=<span class="hljs-string"><span class="hljs-string">"module"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">database</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> db = &lt;some database connection&gt; <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> db db.close() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_insert</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(database)</span></span></span><span class="hljs-function">:</span></span> database.insert(<span class="hljs-number"><span class="hljs-number">123</span></span>)</code> </pre> <br>  Ao especificar o par√¢metro scope = ‚Äúmodule‚Äù, voc√™ inicializou o equipamento uma vez para o m√≥dulo inteiro e agora uma conex√£o de banco de dados aberta estar√° dispon√≠vel para todas as fun√ß√µes de teste que o solicitarem. <br><br>  Voc√™ pode executar algum c√≥digo geral antes ou depois do teste, definindo acess√≥rios como usados ‚Äã‚Äãautomaticamente com a palavra-chave autouse, em vez de especific√°-los como argumento para cada fun√ß√£o de teste.  A concretiza√ß√£o da fun√ß√£o pytest.fixture () com o argumento True, a palavra-chave autouse, garante que os equipamentos sejam chamados todas as vezes antes de executar o teste no m√≥dulo ou classe em que √© declarado. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pytest @pytest.fixture(autouse=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">change_user_env</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> curuser = os.environ.get(<span class="hljs-string"><span class="hljs-string">"USER"</span></span>) os.environ[<span class="hljs-string"><span class="hljs-string">"USER"</span></span>] = <span class="hljs-string"><span class="hljs-string">"foobar"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> os.environ[<span class="hljs-string"><span class="hljs-string">"USER"</span></span>] = curuser <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_user</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> os.getenv(<span class="hljs-string"><span class="hljs-string">"USER"</span></span>) == <span class="hljs-string"><span class="hljs-string">"foobar"</span></span>&lt;/source     .  ,    :     ,      ,       . &lt;h3&gt;  &lt;/h3&gt;           ,    ,   ,         .          Gnocchi,    . Gnocchi      &lt;i&gt;storage API&lt;/i&gt;.    Python          .       ,      API   .        ,      (    storage API),  ,       .   ,   &lt;i&gt; &lt;/i&gt;,     ,        .  <span class="hljs-number"><span class="hljs-number">6.6</span></span>          ,    :    mysql,   ‚Äî  postgresql. &lt;blockquote&gt;&lt;h4&gt; <span class="hljs-number"><span class="hljs-number">6.6</span></span>.      &lt;/h4&gt; &lt;source lang=<span class="hljs-string"><span class="hljs-string">"python"</span></span>&gt;<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pytest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> myapp @pytest.fixture(params=[<span class="hljs-string"><span class="hljs-string">"mysql"</span></span>, <span class="hljs-string"><span class="hljs-string">"postgresql"</span></span>]) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">database</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(request)</span></span></span><span class="hljs-function">:</span></span> d = myapp.driver(request.param) d.start() <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> d d.stop() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_insert</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(database)</span></span></span><span class="hljs-function">:</span></span> database.insert(<span class="hljs-string"><span class="hljs-string">"somedata"</span></span>)</code> </pre>  O dispositivo de driver recebe dois valores diferentes como par√¢metro - os nomes dos drivers de banco de dados que s√£o suportados pelo aplicativo.  test_insert √© executado duas vezes: uma para o banco de dados MySQL e a segunda para o banco de dados PostgreSQL.  Isso facilita a repeti√ß√£o do mesmo teste, mas com cen√°rios diferentes, sem adicionar novas linhas de c√≥digo. <br><br><h3>  Testes gerenciados com objetos fict√≠cios </h3><br>  Objetos fict√≠cios (ou stubs, objetos simulados) s√£o objetos que imitam o comportamento de objetos de aplicativos reais, mas em um estado controlado especial.  Eles s√£o mais √∫teis na cria√ß√£o de ambientes que descrevem minuciosamente as condi√ß√µes para o teste.  Voc√™ pode substituir todos os objetos, exceto o testado, por objetos fict√≠cios e isol√°-lo, al√©m de criar um ambiente para teste de c√≥digo. <br><br>  Um caso de uso √© criar um cliente HTTP.  √â quase imposs√≠vel (ou melhor, incrivelmente dif√≠cil) criar um servidor HTTP no qual voc√™ possa executar todas as situa√ß√µes e cen√°rios para cada valor poss√≠vel.  Clientes HTTP s√£o especialmente dif√≠ceis de testar para cen√°rios de erro. <br><br>  A biblioteca padr√£o possui um comando simulado para criar um objeto fict√≠cio.  A partir do Python 3.3, o mock foi integrado √† biblioteca unittest.mock.  Portanto, voc√™ pode usar o snippet de c√≥digo abaixo para fornecer compatibilidade com vers√µes anteriores entre o Python 3.3 e vers√µes anteriores: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> unittest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mock <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> ImportError: <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mock</code> </pre> <br>  A biblioteca simulada √© muito f√°cil de usar.  Qualquer atributo dispon√≠vel para o objeto mock.Mock √© criado dinamicamente no tempo de execu√ß√£o.  Qualquer atributo pode ser atribu√≠do a qualquer valor.  Na Listagem 6.7, mock √© usado para criar um objeto fict√≠cio para o atributo fict√≠cio. <br><blockquote><h4>  Listagem 6.7.  Acessando o atributo mock.Mock </h4><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> unittest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mock &gt;&gt;&gt; m = mock.Mock() &gt;&gt;&gt; m.some_attribute = <span class="hljs-string"><span class="hljs-string">"hello world"</span></span> &gt;&gt;&gt; m.some_attribute <span class="hljs-string"><span class="hljs-string">"hello world"</span></span></code> </pre> </blockquote>  Tamb√©m √© poss√≠vel criar dinamicamente um m√©todo para um objeto mut√°vel, como na Listagem 6.8, em que voc√™ cria um m√©todo fict√≠cio que sempre retorna 42 e aceita o que deseja como argumento. <br><blockquote><h4>  Listagem 6.8.  Criando um m√©todo para o objeto fict√≠cio mock.Mock </h4><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> unittest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mock &gt;&gt;&gt; m = mock.Mock() &gt;&gt;&gt; m.some_method.return_value = <span class="hljs-number"><span class="hljs-number">42</span></span> &gt;&gt;&gt; m.some_method() <span class="hljs-number"><span class="hljs-number">42</span></span> &gt;&gt;&gt; m.some_method(<span class="hljs-string"><span class="hljs-string">"with"</span></span>, <span class="hljs-string"><span class="hljs-string">"arguments"</span></span>) <span class="hljs-number"><span class="hljs-number">42</span></span></code> </pre> </blockquote>  Apenas algumas linhas, e o objeto mock.Mock agora tem um m√©todo some_method (), que retorna 42. √â preciso qualquer tipo de argumento, enquanto n√£o h√° verifica√ß√£o do que √© o argumento. <br><br>  Os m√©todos gerados dinamicamente tamb√©m podem ter efeitos colaterais (intencionais).  Para n√£o serem apenas m√©todos padronizados que retornam um valor, eles podem ser definidos para executar c√≥digos √∫teis. <br><br>  A Listagem 6.9 cria um m√©todo fict√≠cio que tem um efeito colateral - exibe a sequ√™ncia "hello world". <br><blockquote><h4>  Listagem 6.9.  Criando um m√©todo para um objeto mock.Mock com um efeito colateral </h4><br><pre> <code class="python hljs"> &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> unittest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mock &gt;&gt;&gt; m = mock.Mock() &gt;&gt;&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">print_hello</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> ... print(<span class="hljs-string"><span class="hljs-string">"hello world!"</span></span>) ... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">43</span></span> ... ‚ù∂ &gt;&gt;&gt; m.some_method.side_effect = print_hello &gt;&gt;&gt; m.some_method() hello world! <span class="hljs-number"><span class="hljs-number">43</span></span> ‚ù∑ &gt;&gt;&gt; m.some_method.call_count <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> </blockquote>  Atribu√≠mos uma fun√ß√£o inteira ao atributo some_method‚ù∂.  Tecnicamente, isso permite implementar um cen√°rio mais complexo no teste, devido ao fato de poder incluir qualquer c√≥digo necess√°rio para o teste no objeto fict√≠cio.  Em seguida, voc√™ precisa passar esse objeto para a fun√ß√£o que o espera. <br><br>  O atributo _ call_count √© uma maneira f√°cil de verificar o n√∫mero de vezes que um m√©todo foi chamado. <br><br>  A biblioteca simulada usa o padr√£o "verifica√ß√£o de a√ß√£o": isso significa que, ap√≥s o teste, voc√™ precisa garantir que as a√ß√µes substitu√≠das por manequins foram executadas corretamente.  A Listagem 6.10 aplica o m√©todo assert () a objetos fict√≠cios para executar essas verifica√ß√µes. <br><blockquote><h4>  Listagem 6.10.  M√©todos de verifica√ß√£o de chamadas </h4><br><pre> <code class="python hljs"> &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> unittest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mock &gt;&gt;&gt; m = mock.Mock() ‚ù∂ &gt;&gt;&gt; m.some_method(<span class="hljs-string"><span class="hljs-string">'foo'</span></span>, <span class="hljs-string"><span class="hljs-string">'bar'</span></span>) &lt;Mock name=<span class="hljs-string"><span class="hljs-string">'mock.some_method()'</span></span> id=<span class="hljs-string"><span class="hljs-string">'26144272'</span></span>&gt; ‚ù∑ &gt;&gt;&gt; m.some_method.assert_called_once_with(<span class="hljs-string"><span class="hljs-string">'foo'</span></span>, <span class="hljs-string"><span class="hljs-string">'bar'</span></span>) &gt;&gt;&gt; m.some_method.assert_called_once_with(<span class="hljs-string"><span class="hljs-string">'foo'</span></span>, ‚ù∏mock.ANY) &gt;&gt;&gt; m.some_method.assert_called_once_with(<span class="hljs-string"><span class="hljs-string">'foo'</span></span>, <span class="hljs-string"><span class="hljs-string">'baz'</span></span>) Traceback (most recent call last): File <span class="hljs-string"><span class="hljs-string">"&lt;stdin&gt;"</span></span>, line <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> &lt;module&gt; File <span class="hljs-string"><span class="hljs-string">"/usr/lib/python2.7/dist-packages/mock.py"</span></span>, line <span class="hljs-number"><span class="hljs-number">846</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> assert_cal led_once_with <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.assert_called_with(*args, **kwargs) File <span class="hljs-string"><span class="hljs-string">"/usr/lib/python2.7/dist-packages/mock.py"</span></span>, line <span class="hljs-number"><span class="hljs-number">835</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> assert_cal led_with <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> AssertionError(msg) AssertionError: Expected call: some_method(<span class="hljs-string"><span class="hljs-string">'foo'</span></span>, <span class="hljs-string"><span class="hljs-string">'baz'</span></span>) Actual call: some_method(<span class="hljs-string"><span class="hljs-string">'foo'</span></span>, <span class="hljs-string"><span class="hljs-string">'bar'</span></span>)</code> </pre> </blockquote>  Criamos m√©todos com argumentos foo e bar como testes chamando o m√©todo ‚ù∂.  Uma maneira f√°cil de testar chamadas para objetos fict√≠cios √© usar m√©todos assert_called (), como assert_called_once_with () ‚ù∑.  Para esses m√©todos, voc√™ precisa passar os valores que voc√™ espera que sejam usados ‚Äã‚Äãao chamar o m√©todo fict√≠cio.  Se os valores transmitidos diferirem dos usados, o mock gera uma exce√ß√£o AssertionError.  Se voc√™ n√£o souber quais argumentos podem ser passados, use mock.ANY como o valor de ‚ù∏;  ele substituir√° qualquer argumento passado para o m√©todo fict√≠cio. <br><br>  A biblioteca simulada tamb√©m pode ser usada para substituir uma fun√ß√£o, m√©todo ou objeto de um m√≥dulo externo.  Na Listagem 6.11, substitu√≠mos a fun√ß√£o os.unlink () por nossa pr√≥pria fun√ß√£o fict√≠cia. <br><blockquote><h4>  Listagem 6.11.  Usando mock.patch </h4><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> unittest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mock &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os &gt;&gt;&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fake_os_unlink</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(path)</span></span></span><span class="hljs-function">:</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> IOError(<span class="hljs-string"><span class="hljs-string">"Testing!"</span></span>) ... &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> mock.patch(<span class="hljs-string"><span class="hljs-string">'os.unlink'</span></span>, fake_os_unlink): ... os.unlink(<span class="hljs-string"><span class="hljs-string">'foobar'</span></span>) ... Traceback (most recent call last): File <span class="hljs-string"><span class="hljs-string">"&lt;stdin&gt;"</span></span>, line <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> &lt;module&gt; File <span class="hljs-string"><span class="hljs-string">"&lt;stdin&gt;"</span></span>, line <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> fake_os_unlink IOError: Testing!</code> </pre> </blockquote>  Quando usado como gerenciador de contexto, mock.patch () substitui a fun√ß√£o de destino pela que selecionamos.  Isso √© necess√°rio para que o c√≥digo executado dentro do contexto use o m√©todo corrigido.  Usando o m√©todo mock.patch (), √© poss√≠vel modificar qualquer parte do c√≥digo externo, for√ßando-o a se comportar de maneira a testar todas as condi√ß√µes do aplicativo (Listagem 6.12). <br><blockquote><h4>  Listagem 6.12.  Usando mock.patch () para testar muitos comportamentos </h4><br><pre> <code class="python hljs"> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> unittest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mock <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pytest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> requests <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WhereIsPythonError</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Exception)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> ‚ù∂ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">is_python_still_a_programming_language</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: r = requests.get(<span class="hljs-string"><span class="hljs-string">"http://python.org"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> IOError: <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> r.status_code == <span class="hljs-number"><span class="hljs-number">200</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'Python is a programming language'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> r.content <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> WhereIsPythonError(<span class="hljs-string"><span class="hljs-string">"Something bad happened"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_fake_get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(status_code, content)</span></span></span><span class="hljs-function">:</span></span> m = mock.Mock() m.status_code = status_code m.content = content <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fake_get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(url)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> m <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fake_get <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">raise_get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(url)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> IOError(<span class="hljs-string"><span class="hljs-string">"Unable to fetch url %s"</span></span> % url) ‚ù∑ @mock.patch(<span class="hljs-string"><span class="hljs-string">'requests.get'</span></span>, get_fake_get( <span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-string"><span class="hljs-string">'Python is a programming language for sure'</span></span>)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_python_is</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> is_python_still_a_programming_language() <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> @mock.patch(<span class="hljs-string"><span class="hljs-string">'requests.get'</span></span>, get_fake_get( <span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-string"><span class="hljs-string">'Python is no more a programming language'</span></span>)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_python_is_not</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> is_python_still_a_programming_language() <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> @mock.patch(<span class="hljs-string"><span class="hljs-string">'requests.get'</span></span>, get_fake_get(<span class="hljs-number"><span class="hljs-number">404</span></span>, <span class="hljs-string"><span class="hljs-string">'Whatever'</span></span>)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_bad_status_code</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> pytest.raises(WhereIsPythonError): is_python_still_a_programming_language() @mock.patch(<span class="hljs-string"><span class="hljs-string">'requests.get'</span></span>, raise_get) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_ioerror</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> pytest.raises(WhereIsPythonError): is_python_still_a_programming_language()</code> </pre> </blockquote><br><br>  A Listagem 6.12 implementa um caso de teste que procura todas as inst√¢ncias do <i>Python como uma</i> string de <i>linguagem de programa√ß√£o</i> em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">python.org</a> ‚ù∂.  N√£o h√° op√ß√£o em que o teste n√£o encontre nenhuma linha na p√°gina da web selecionada.  Para obter um resultado negativo, voc√™ deve alterar a p√°gina, mas isso n√£o pode ser feito.  Mas com a ajuda do mock, voc√™ pode seguir o truque e alterar o comportamento da solicita√ß√£o para que ela retorne uma resposta fict√≠cia com uma p√°gina fict√≠cia que n√£o contenha uma determinada string.  Isso permitir√° que voc√™ teste um cen√°rio negativo no qual <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">python.org</a> n√£o cont√©m uma determinada string e verifique se o programa lida com esse caso corretamente. <br><br>  Este exemplo usa a vers√£o do mock.patch () para o decorador.  O comportamento do objeto fict√≠cio n√£o muda e foi mais f√°cil dar um exemplo no contexto de uma fun√ß√£o de teste. <br><br>  O uso de um objeto fict√≠cio ajudar√° a simular qualquer problema: o servidor retorna um erro 404, um erro de E / S ou um atraso de rede.  Podemos garantir que o c√≥digo retorne os valores corretos ou gere a exce√ß√£o correta em cada caso, o que garante o comportamento esperado do c√≥digo. <br><br><h3>  Identificar c√≥digo n√£o testado com cobertura </h3><br>  Um √≥timo complemento para o teste de unidade √© a ferramenta de cobertura. [Cobertura de c√≥digo √© uma medida usada no teste.  Mostra a porcentagem do c√≥digo fonte do programa que foi executado durante o processo de teste <i>.</i>  ], que localiza partes de c√≥digo n√£o testadas.  Ele utiliza ferramentas de an√°lise e rastreamento de c√≥digo para identificar as linhas que foram executadas.  Nos testes de unidade, ele pode revelar quais partes do c√≥digo foram reutilizadas e quais n√£o foram usadas.  √â necess√°rio criar testes, e a capacidade de descobrir qual parte do c√≥digo voc√™ esqueceu de abordar com os testes torna esse processo mais agrad√°vel. <br><br>  Instale o m√≥dulo de cobertura via pip para poder us√°-lo atrav√©s do seu shell. <br><br><blockquote><h4>  NOTA </h4><br>  O comando tamb√©m pode ser chamado de cobertura python se o m√≥dulo for instalado atrav√©s do instalador do seu sistema operacional.  Um exemplo disso √© o sistema operacional Debian. </blockquote><br><br>  Usar a cobertura offline √© bastante simples.  Ele mostra as partes do programa que nunca iniciam e se tornam um "peso morto" - um c√≥digo que voc√™ n√£o pode remov√™-lo sem alterar a funcionalidade do programa.  Todas as ferramentas de teste discutidas anteriormente neste cap√≠tulo s√£o integradas √† cobertura. <br><br>  Ao usar pytest, instale o plug-in pytest-cov por meio de pip install pytest-pycov e adicione algumas op√ß√µes para gerar uma sa√≠da detalhada do c√≥digo n√£o testado (Listagem 6.13). <br><blockquote><h4>  Listagem 6.13.  Usando pytest e cobertura </h4><br><pre> <code class="python hljs">$ pytest --cov=gnocchiclient gnocchiclient/tests/unit ---------- coverage: platform darwin, python <span class="hljs-number"><span class="hljs-number">3.6</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>-final<span class="hljs-number"><span class="hljs-number">-0</span></span> ----------- Name Stmts Miss Branch BrPart Cover --------------------------- gnocchiclient/__init__.py <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>% gnocchiclient/auth.py <span class="hljs-number"><span class="hljs-number">51</span></span> <span class="hljs-number"><span class="hljs-number">23</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">49</span></span>% gnocchiclient/benchmark.py <span class="hljs-number"><span class="hljs-number">175</span></span> <span class="hljs-number"><span class="hljs-number">175</span></span> <span class="hljs-number"><span class="hljs-number">36</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>% --snip-- --------------------------- TOTAL <span class="hljs-number"><span class="hljs-number">2040</span></span> <span class="hljs-number"><span class="hljs-number">1868</span></span> <span class="hljs-number"><span class="hljs-number">424</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>% === passed <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">5.00</span></span> seconds ===</code> </pre> </blockquote>  A op√ß√£o --cov permite a sa√≠da do relat√≥rio de cobertura no final do teste.  Voc√™ deve passar o nome do pacote como argumento para que o plug-in filtre corretamente o relat√≥rio.  A sa√≠da conter√° linhas de c√≥digo que n√£o foram executadas, o que significa que elas n√£o foram testadas.  Tudo o que resta para voc√™ √© abrir o editor e escrever um teste para esse c√≥digo. <br><br>  O m√≥dulo de cobertura √© ainda melhor - permite gerar relat√≥rios claros no formato HTML.  Basta adicionar -‚Äìcov-report-html e as p√°ginas HTML aparecer√£o no diret√≥rio <i>htmlcov</i> de onde voc√™ executa o comando.  Cada p√°gina mostrar√° quais partes do c√≥digo-fonte estavam ou n√£o em execu√ß√£o. <br><br>  Se voc√™ quiser ir ainda mais longe, use ‚Äìcover-fail-under-COVER_MIN_PERCENTAGE, que far√° com que o conjunto de testes falhe se n√£o cobrir a porcentagem m√≠nima de c√≥digo.  Embora uma grande porcentagem de cobertura seja uma boa meta e as ferramentas de teste sejam √∫teis para obter informa√ß√µes sobre o status da cobertura de teste, a porcentagem em si n√£o √© muito informativa.  A Figura 6.1 mostra um exemplo de relat√≥rio de cobertura mostrando a porcentagem de cobertura. <br><br>  Por exemplo, cobrir o c√≥digo com testes 100% √© uma meta v√°lida, mas isso n√£o significa necessariamente que o c√≥digo foi totalmente testado.  Este valor mostra apenas que todas as linhas de c√≥digo no programa foram cumpridas, mas n√£o indica que todas as condi√ß√µes foram testadas. <br><br>  Vale a pena usar as informa√ß√µes de cobertura para expandir o conjunto de testes e cri√°-los para o c√≥digo que n√£o √© executado.  Isso simplifica o suporte ao projeto e melhora a qualidade geral do c√≥digo. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/d_/af/vl/d_afvlajlx_9ctds7yfu7ef_2ds.png" alt="imagem"></div><br><br><h3>  Sobre o autor </h3><br>  <i>Julien Danju hackeia o</i> freeware h√° cerca de vinte anos e desenvolve programas em Python h√° quase doze anos.  Atualmente, ele lidera a equipe de design da plataforma de nuvem distribu√≠da baseada no OpenStack, que possui o maior banco de dados de c√≥digo aberto do Python existente, com cerca de dois milh√µes e meio de linhas de c√≥digo.  Antes de desenvolver servi√ßos em nuvem, Julien criou o gerenciador de janelas e contribuiu para o desenvolvimento de muitos projetos, como o Debian e o GNU Emacs. <br><br><h3>  Sobre o Science Editor </h3><br>  <i>Mike Driscoll</i> programa em Python h√° mais de uma d√©cada.  Por um longo tempo, ele escreveu sobre Python no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">The Mouse vs.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O Python</a> .  Autor de v√°rios livros em Python: Python 101, entrevistas em Python e ReportLab: processamento de PDF com Python.  Voc√™ pode encontrar Mike no Twitter e no GitHub: @driscollis. <br><br>  ¬ªMais informa√ß√µes sobre o livro podem ser encontradas no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">site do editor</a> <br>  ¬ª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Conte√∫do</a> <br>  ¬ª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Trecho</a> <br><br>  Cupom de 25% de desconto para vendedores ambulantes - <b>Python</b> <br><br>  Ap√≥s o pagamento da vers√£o impressa do livro, um livro eletr√¥nico √© enviado por e-mail. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt466027/">https://habr.com/ru/post/pt466027/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt466001/index.html">"Mobile" Feng Shui, ou dormimos corretamente (caf√©, baratas e intoler√¢ncia em Habr√©)</a></li>
<li><a href="../pt466015/index.html">Um pouco mais sobre trigonometria na computa√ß√£o</a></li>
<li><a href="../pt466017/index.html">Livy - o link ausente na cadeia Python do Hadoop Spark Airflow</a></li>
<li><a href="../pt466019/index.html">ABBYY Mobile Web Capture: fotos de documentos de alta qualidade no navegador do seu smartphone</a></li>
<li><a href="../pt466021/index.html">Como eu ensinei Yandex.Alice a falar sobre brinquedos sexuais</a></li>
<li><a href="../pt466029/index.html">Como transformar um computador qu√¢ntico em um gerador de n√∫meros aleat√≥rios perfeito</a></li>
<li><a href="../pt466031/index.html">A miss√£o √©pica do DeepMind para resolver o problema cient√≠fico mais complexo</a></li>
<li><a href="../pt466033/index.html">Como envolver uma equipe na busca de id√©ias e obter muito mais do que id√©ias</a></li>
<li><a href="../pt466039/index.html">Bibliotecas PHP para com√©rcio eletr√¥nico: trabalhando com ATOL e Payture, analisando c√≥digos GS1 e outras tarefas</a></li>
<li><a href="../pt466041/index.html">O primeiro evento offline da comunidade Circle Developer Circle: Moscow - Launch Event</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>