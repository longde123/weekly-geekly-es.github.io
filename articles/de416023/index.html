<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏼‍🌾 📨 🚙 Wie iOS 'Spitzname Telegram Bot schrieb, auf Swift 🤛🏽 🚓 🧑🏿‍🤝‍🧑🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Es geht um Telegrammer, das Telegram Bot-Framework für Linux / macOS , das vollständig in Swift 4.1 geschrieben wurde 



 Exposition: Wie ist ein sol...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie iOS 'Spitzname Telegram Bot schrieb, auf Swift</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/416023/"><p>  Es geht um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Telegrammer, das Telegram Bot-Framework für Linux / macOS</a> , das vollständig in Swift 4.1 geschrieben wurde </p><br><p><img src="https://habrastorage.org/webt/uh/8_/do/uh8_do0h1mqyeeyheidwr3c-daw.png"></p><a name="habracut"></a><br><h1 id="ekspoziciya-kak-zhe-prishla-v-golovu-takaya-mysl">  Exposition: Wie ist ein solcher Gedanke in den Sinn gekommen? </h1><br><p>  Eines meiner Lieblingsprojekte (eine iOS-Anwendung, die sich auf Telegram bezieht, aber jetzt geht es nicht mehr um ihn) benötigte eine Weboberfläche für den Content Manager, um eine Beschreibung, ein Tag und mehr zu erstellen.  Da die Anwendung bereits ideologisch mit Telegram verbunden war, fiel mir sofort ein, Inhalte direkt an den Messenger zu senden und dort bereits die oben genannten Aktionen auszuführen. </p><br><p>  Es stellte sich heraus, dass Sie solche Daten über Bots senden können (wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bots im Telegramm</a> angeordnet sind). </p><br><h1 id="zavyazka-iskal-gotovoe-reshenie-podhodyaschego-ne-nashel">  Anfang: Ich suchte nach einer vorgefertigten Lösung, ich konnte keine passende finden. </h1><br><p> Und dann reihen sich alle Sterne aneinander, jetzt wirst du verstehen, was ich meine ... </p><br><p>  Es gibt viele zuverlässige, bewährte serverseitige Frameworks in Java, Go, Python, PHP und anderen, mit denen Sie bereits problemlos einen Bot erstellen können.  Aber hier geht es nicht um uns (Zeugen) <del>  Jehovas </del>  Apple) suchen wir nicht nach einfachen Wegen. </p><br><p>  Was ist, wenn Sie einen Bot in Swift schreiben? </p><br><p>  In jüngerer Zeit (nach den Standards der Programmiersprachen) begann sich die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Server Side Swift-Community</a> aktiv zu entwickeln, und es erschienen mehrere Frameworks wie Vapor, Perfect und Kitura, die genügend Ruhm erlangten. </p><br><p>  Außerdem hat Apple Brennholz in den Ofen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">geworfen</a> , was Entwicklern mit einem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SwiftNIO-</a> Framework auf niedriger Ebene und hoher Leistung das Leben erleichtert </p><br><div class="spoiler">  <b class="spoiler_title">Warum ist SwiftNIO cool?</b> <div class="spoiler_text"><p>  SwiftNIO ist ein plattformübergreifendes asynchrones ereignisgesteuertes Netzwerkanwendungsframework für die schnelle Entwicklung wartbarer Hochleistungsprotokollserver und -clients. </p><br><p>  Es ist wie bei <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Netty</a> , aber für Swift geschrieben. </p><br><p>  SwiftNIO ist im Grunde ein Low-Level-Tool zum Erstellen von Hochleistungs-Netzwerkanwendungen in Swift.  Es richtet sich insbesondere an Anwendungsfälle, in denen die Verwendung eines "Thread-per-Connection" -Modells der Parallelität ineffizient oder unhaltbar ist.  Dies ist eine häufige Einschränkung beim Erstellen von Servern, die eine große Anzahl von Verbindungen mit relativ geringer Auslastung verwenden, z. B. HTTP-Server. </p><br><p>  Um seine Ziele zu erreichen, verwendet SwiftNIO in großem Umfang "nicht blockierende E / A": daher der Name!  Nicht blockierende E / A unterscheiden sich vom häufigeren blockierenden E / A-Modell dadurch, dass die Anwendung nicht darauf wartet, dass Daten an das Netzwerk gesendet oder von diesem empfangen werden. Stattdessen fordert SwiftNIO den Kernel auf, sie zu benachrichtigen, wenn E / A-Vorgänge dies können durchgeführt werden, ohne zu warten. </p><br><p>  SwiftNIO zielt nicht darauf ab, Lösungen auf hoher Ebene bereitzustellen, wie dies beispielsweise bei Webframeworks der Fall ist.  Stattdessen konzentriert sich SwiftNIO auf die Bereitstellung der Low-Level-Bausteine ​​für diese übergeordneten Anwendungen.  Wenn es um das Erstellen einer Webanwendung geht, möchten die meisten Benutzer SwiftNIO nicht direkt verwenden. Stattdessen möchten sie eines der vielen großartigen Webframeworks verwenden, die im Swift-Ökosystem verfügbar sind.  Diese Web-Frameworks können sich jedoch dafür entscheiden, SwiftNIO unter dem Deckmantel zu verwenden, um ihre Netzwerkunterstützung bereitzustellen. </p></div></div><br><h4 id="chto-ya-rassmatrival-iz-gotovyh-telegram-bot-swift-bibliotek">  Was ich aus den fertigen Telegram Bot Swift-Bibliotheken herausgefunden habe: </h4><br><ol><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zmeyc / telegram-bot-swift</a> - Eine ziemlich fortgeschrittene Bibliothek, die gesamte Telegramm-Bot-API wird von der Site aus analysiert. Sowohl Methoden als auch Modelle, erweitertes Routing, funktionieren sowohl unter MacOS als auch unter Linux. <br>  Die Nachteile, die mit der Tatsache verbunden sind, dass es vor langer Zeit geschrieben wurde und zu dieser Zeit alle Apple-Frameworks (insbesondere Foundation) unter Linux sehr instabil arbeiteten: </p><br><ul><li>  Sendet Anfragen per Curl </li><li>  Zum Zeitpunkt der Studie waren sowohl die Bibliothek selbst als auch die abhängigen Bibliotheken nicht auf Swift 4 portiert </li><li>  Wird von Webhooks nicht unterstützt </li><li>  Ein Repository, das lange Zeit nicht aktualisiert wurde. Daher werden einige Funktionen der aktualisierten Telegramm-Bot-API nicht unterstützt. </li></ul><br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">FabrizioBrancati / SwiftyBot</a> - Verzeih mir, ich verstehe nicht, warum dieser Bot die meisten Sterne hat, der veraltete Vapor 2.4.0 ist unter der Haube und der einsame main.swift, der einfach die einfachste Arbeit mit dem Bot demonstriert.  Keine Modelle, Helfer, Versandwarteschlangen, nichts.  Oh nein!  Im Gegensatz zu Wettbewerbern unterstützt es WebHooks. </p><br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ShaneQi / ZEGBot</a> - Eine sehr einfache Implementierung, die grundlegenden Methoden, Modelle und wieder nur LongPolling sind implementiert. </p><br></li></ol><br><p>  Es wird also beschlossen, dass wir unser eigenes Framework schreiben.  Ehrlich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gesagt</a> hat mich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Andrey Fidrya mit</a> seinem Bot inspiriert, aber ich habe beschlossen, dass ich versuchen könnte, es besser zu machen. </p><br><h1 id="kulminaciya-dobro-pozhalovat-v-mir-bekenda-swiftnio-spasibo-za-vzorvannyy-mozg">  Höhepunkt: Willkommen in der Backend-Welt.  SwiftNIO, danke für das explodierte Gehirn. </h1><br><p>  Ich gebe zu, dass es nach iOS-Anwendungen ziemlich schwierig ist, eine Anwendung für die Serverseite zu schreiben. Ich muss anders denken. </p><br><p>  Zum Zeitpunkt der Erstellung des Frameworks hatten die Jungs von Vapor eine Beta angekündigt und basierten bereits auf SwiftNIO.  Vapor hat eine modulare Architektur. Jede Schicht befindet sich in einem eigenen Repository. Dies ist sehr praktisch. Sie können nur einen Teil der Implementierungen verwenden. </p><br><h4 id="ya-reshil-ispolzovat">  Ich entschied mich für: </h4><br><ul><li>  apor <a href="https://github.com/vapor/">/ http</a> - für HTTPClient, HTTPServer </li><li>  <a href="">Dampf / Krypto</a> - für https </li><li>  <a href="">Dampf / mehrteilig</a> - um Modell zu konvertieren -&gt; mehrteilige / Formulardaten </li></ul><br><p>  Dabei wurden einige Fehler in Vapor HTTPClient gefunden, erfolgreich behoben, der HTTPServer wurde verbessert, um mit https sofort zu arbeiten, ohne dass Nginx und dergleichen verwendet werden müssen. </p><br><h4 id="chto-poluchilos">  Was ist passiert: </h4><br><ul><li>  Die Bot-API wurde mit einem starken Blick auf einen vertrauenswürdigen Spieler in diesem Bereich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Python-Telegramm-Bot entwickelt</a> </li><li>  Wie bei <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zmeyc / telegram-bot-swift können</a> alle <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Telegramm-Bot-API-</a> Bot-Modelle und -Methoden durch Ausführen eines Skripts generiert werden. </li><li>  Implementierte Longpolling- und WebHooks-Modi </li><li>  Implementierte Handler: CommandHandler, CallbackQueryHandler, RegexpHandler, MessageHandler </li><li>  Viele Filter für Updates </li><li>  Zwei einfache Bots, zum Beispiel Standard EchoBot und HelloBot </li></ul><br><h1 id="razvyazka-pishem-bota-obschepoleznogo-pust-proveryaet-orfografiyu">  Austausch: Wir schreiben einen Bot, der im Allgemeinen nützlich ist. Lassen Sie ihn die Rechtschreibung überprüfen. </h1><br><p>  Bot: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">@yandex_spell_checker_bot</a> <br>  Quellcode: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://github.com/givip/YandexSpellCheckerBot</a> </p><br><p>  <em>main.swift</em> sieht <em>folgendermaßen</em> aus: </p><br><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Foundation <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Telegrammer ///   enviroment variable ( , ) guard let token = Enviroment.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>("SPELL_CHECKER_BOT_TOKEN") <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { ///   let bot = try Bot(token: token) ///    let dispatcher = Dispatcher(bot: bot) ///    let controller = SpellCheckerController(bot: bot) ///    /<span class="hljs-keyword"><span class="hljs-keyword">start</span></span>,   let commandHandler = CommandHandler(commands: ["/start"], callback: controller.<span class="hljs-keyword"><span class="hljs-keyword">start</span></span>) dispatcher.<span class="hljs-keyword"><span class="hljs-keyword">add</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">handler</span></span>: commandHandler) ///    ,        let textHandler = MessageHandler(filters: .private, callback: controller.spellCheck) dispatcher.<span class="hljs-keyword"><span class="hljs-keyword">add</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">handler</span></span>: textHandler) ///   ,    . let inlineHandler = CallbackQueryHandler(pattern: "\\w+", callback: controller.<span class="hljs-keyword"><span class="hljs-keyword">inline</span></span>) dispatcher.<span class="hljs-keyword"><span class="hljs-keyword">add</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">handler</span></span>: inlineHandler) ///     Longpolling _ = try Updater(bot: bot, dispatcher: dispatcher).startLongpolling().wait() } catch { print(error.localizedDescription) }</code> </pre> <br><h1 id="epilog-ios-razrabotchiki-i-ne-tolko-polzuytes">  Epilog: iOS-Entwickler und mehr, nutzen Sie es! </h1><br><p>  Das Framework befindet sich in der Beta-Phase und kann von jedem für seine Anforderungen verwendet werden. </p><br><p>  Nach einem Monat voller Tests und Verbesserungen gab es einige Mängel, Wunschliste und viele Verbesserungsprobleme, aber dennoch hat sich "Rechtschreibprüfung" unter Ubuntu schon lange gedreht. </p><br><p>  Ich wäre dankbar für jedes Feedback und würde auf den Ventilator werfen. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de416023/">https://habr.com/ru/post/de416023/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de416013/index.html">So fangen Sie an zu investieren und Geld zu sparen: Die Experten von Dow Jones nannten die fünf Hauptfehler von Anfängern</a></li>
<li><a href="../de416015/index.html">Spielen mit Threads in Node.JS 10.5.0</a></li>
<li><a href="../de416017/index.html">Wir sammeln Kohortenanalyse / Analyse von Flüssen am Beispiel von Excel</a></li>
<li><a href="../de416019/index.html">Wie gut ist das Open-Source-Ökosystem von R für die Lösung von Geschäftsproblemen?</a></li>
<li><a href="../de416021/index.html">Entwickeln Sie Ihr eigenes Framework und das berufliche Wachstum eines JS-Programmierers</a></li>
<li><a href="../de416025/index.html">Implementieren der Navigation in Android-Anwendungen mithilfe der Navigationsarchitekturkomponente</a></li>
<li><a href="../de416027/index.html">Sowjetisches HI-FI und seine Schöpfer: Gesunde Leidenschaften - Elektronik 150AC - 001</a></li>
<li><a href="../de416029/index.html">Flüssiger Computer: Erfassung von Ionen in Graphen</a></li>
<li><a href="../de416035/index.html">Dental 3D Scanner Shining 3D Autoscan DS EX (Unboxing) von 3Dtool</a></li>
<li><a href="../de416037/index.html">Start des Tages (April-Juni 2018)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>