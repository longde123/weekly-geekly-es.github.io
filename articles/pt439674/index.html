<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ôªÔ∏è üöû üôÜüèæ Aprendizado profundo de refor√ßo: pingue-pongue de pixel bruto üêé ‚úãüèø ü§¥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Este √© um artigo muito atrasado sobre o aprendizado por refor√ßo (RL). RL √© um t√≥pico interessante! 

 Voc√™ pode saber que os computadores agora podem ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Aprendizado profundo de refor√ßo: pingue-pongue de pixel bruto</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439674/">  Este √© um artigo muito atrasado sobre o aprendizado por refor√ßo (RL).  RL √© um t√≥pico interessante! <br><br>  Voc√™ pode saber que os computadores agora podem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aprender automaticamente a jogar jogos da ATARI</a> (obtendo pixels brutos do jogo na entrada!).  Eles venceram os campe√µes mundiais no jogo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Go</a> , aprendem virtual de quatro patas a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">correr e pular</a> , e os rob√¥s aprendem a executar tarefas complexas de manipula√ß√£o que desafiam a programa√ß√£o expl√≠cita.  Acontece que todas essas conquistas n√£o s√£o completas sem a RL.  Tamb√©m fiquei interessado em RL no ano passado: trabalhei com <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">o</a> livro de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Richard Sutton (aprox. Refer√™ncia: substitu√≠do)</a> , li <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">o</a> curso de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">David Silver</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">assisti √†s palestras de John Schulman</a> , escrevi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">a biblioteca RL em Javascript</a> e estagiei no DeepMind no ver√£o, trabalhando em um grupo O DeepRL e, mais recentemente, no desenvolvimento do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">OpenAI Gym</a> , √© o novo kit de ferramentas RL.  Por isso, √© claro, estou nessa onda h√° pelo menos um ano, mas ainda n√£o me preocupo em escrever uma nota sobre por que a RL √© de grande import√¢ncia, sobre o que √©, como tudo se desenvolve. <br><br><img src="https://habrastorage.org/webt/vr/ir/gu/vrirgukar82fw0cg6wbnsklagum.png"><br>  <i>Exemplos de uso do Deep Q-Learning.</i>  <i>Da esquerda para a direita: a rede neural joga ATARI, a rede neural joga AlphaGo, o rob√¥ dobra Lego, o virtual quadr√∫pede corre em volta de obst√°culos virtuais.</i> <br><a name="habracut"></a><br>  √â interessante refletir sobre a natureza do progresso recente na RL.  Gostaria de observar quatro fatores separados que afetam o desenvolvimento da IA: <br><br><ol><li>  Velocidade de computa√ß√£o (GPU, dispositivos especiais ASIC, lei de Moore) </li><li>  Dados suficientes em um formato utiliz√°vel (por exemplo, ImageNet) </li><li>  Algoritmos (pesquisa e ideias, por exemplo, backprop, CNN, LSTM) </li><li>  Infraestrutura (Linux, TCP / IP, Git, ROS, PR2, AWS, AMT, TensorFlow, etc.). </li></ol><br>  Assim como na vis√£o computacional, o progresso na RL est√° se movendo ... embora n√£o tanto quanto possa parecer.  Por exemplo, na vis√£o computacional, a rede neural AlexNet 2012 √© uma vers√£o aumentada em profundidade e largura da rede neural ConvNets dos anos 90.  Da mesma forma, o ATARI Deep Q-Learning 2013 √© uma implementa√ß√£o do algoritmo Q-Learning padr√£o que voc√™ pode encontrar no livro cl√°ssico de Richard Sutton, de 1998.  Al√©m disso, o AlphaGo usa a t√©cnica Gradiente de pol√≠tica e a pesquisa em √°rvore Monte Carlo (MCTS) tamb√©m s√£o id√©ias antigas ou suas combina√ß√µes.  Obviamente, s√£o necess√°rias muitas habilidades e paci√™ncia para faz√™-las funcionar, e muitas configura√ß√µes complicadas foram desenvolvidas com base em algoritmos antigos.  <b>Mas, em uma primeira aproxima√ß√£o, o principal fator do progresso recente n√£o s√£o novos algoritmos e id√©ias, mas a intensifica√ß√£o de c√°lculos, dados suficientes e infraestrutura madura.</b> <br><br>  Agora de volta √† RL.  Muitas pessoas n√£o acreditam que podemos ensinar um computador a jogar jogos da ATARI em n√≠vel humano usando pixels brutos do zero e usando o mesmo algoritmo de auto-aprendizado.  Ao mesmo tempo, toda vez que sinto uma lacuna - como parece m√°gico e como √© realmente simples por dentro. <br><br>  A abordagem b√°sica que usamos √© realmente muito burra.  Seja como for, gostaria de apresentar a t√©cnica Policy Gradient (PG), nossa op√ß√£o padr√£o favorita para resolver problemas com RL no momento.  Voc√™ pode estar curioso por que, em vez disso, n√£o consigo imaginar o DQN, que √© um algoritmo RL alternativo e mais conhecido que tamb√©m √© usado no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">treinamento da ATARI</a> .  Acontece que, embora o Q-Learning seja conhecido, ele n√£o √© t√£o perfeito.  A maioria das pessoas escolhe usar o Policy Gradient, incluindo os autores do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo</a> original do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DQN</a> , que mostraram que, com um bom ajuste, o Policy Gradient funciona ainda melhor que o Q-Learning.  O PG √© prefer√≠vel porque √© expl√≠cito: existe uma pol√≠tica clara e uma abordagem coerente que otimiza diretamente as recompensas esperadas.  Como exemplo, aprenderemos como jogar o ATARI Pong: do zero, de pixels brutos por meio de um Gradiente de Pol√≠tica com uma rede neural.  E colocaremos tudo isso em 130 linhas de Python.  ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Link Gist</a> ) Vamos ver como isso √© feito. <br><br><img src="https://habrastorage.org/webt/yy/fk/hg/yyfkhg3xutt4gsualf7l6o0sa4i.gif"><br><img src="https://habrastorage.org/webt/mw/rq/2w/mwrq2wthkobnxuqohcfovs1lgei.jpeg"><br>  <i>Acima: Ping Pong.</i>  <i>Abaixo: Apresenta√ß√£o de pingue-pongue como um caso especial do processo de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tomada de decis√£o</a> de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Markov (MDP)</a> : Cada v√©rtice do gr√°fico corresponde a um determinado estado do jogo, e as bordas determinam as probabilidades de transi√ß√£o para outros estados.</i>  <i>Cada costela tamb√©m determina a recompensa.</i>  <i>O objetivo √© encontrar o melhor caminho de qualquer estado para maximizar a recompensa</i> <br><br>  Jogar Ping Pong √© um √≥timo exemplo de desafio de RL.  Na vers√£o ATARI 2600, jogaremos uma raquete.  Outra raquete √© controlada por um algoritmo embutido.  Precisamos bater na bola para que o outro jogador n√£o tenha tempo de bater nela.  Espero que n√£o seja necess√°rio explicar o que √© o Ping Pong.  Em um n√≠vel baixo, o jogo funciona da seguinte maneira: obtemos um quadro de imagem - uma matriz de bytes 210x160x3 e decidimos se queremos mover a raquete PARA CIMA ou PARA BAIXO.  Ou seja, temos apenas duas op√ß√µes para gerenciar o jogo.  Ap√≥s cada escolha, o simulador de jogo executa sua a√ß√£o e nos d√° uma recompensa: +1 em recompensa se a bola passou na raquete do oponente ou -1 em se perdemos a bola.  Caso contr√°rio, 0. E, √© claro, nosso objetivo √© mover a raquete para obter a maior recompensa poss√≠vel. <br><br>  Ao considerar uma solu√ß√£o, lembre-se de que tentaremos fazer t√£o poucas suposi√ß√µes sobre o pong, porque isso n√£o √© particularmente importante na pr√°tica.  Levamos muito mais em conta em tarefas de grande escala, como manipula√ß√£o de rob√¥s, montagem e navega√ß√£o.  Pong √© apenas um divertido caso de teste de brinquedo com o qual brincamos enquanto descobrimos como escrever sistemas de IA muito gerais que podem um dia executar tarefas √∫teis arbitr√°rias. <br><br>  <b>Rede neural como uma pol√≠tica de RL</b> .  Em primeiro lugar, determinaremos a pol√≠tica que nosso jogador (ou "agente") implementa.  ((*) "Agente", "ambiente" e "pol√≠tica do agente" s√£o termos padr√£o da teoria da RL).  A fun√ß√£o pol√≠tica no nosso caso √© uma rede neural.  Ela aceitar√° o estado do jogo na entrada e na sa√≠da ela decidir√° o que fazer - subir ou descer.  Como nosso bloco de c√°lculo simples favorito, usaremos uma rede neural de duas camadas que obt√©m pixels brutos da imagem (total de 100.800 n√∫meros (210 * 160 * 3)) e produz um √∫nico n√∫mero indicando a probabilidade de mover a raquete para cima.  Observe que o uso de pol√≠tica estoc√°stica √© padr√£o, o que significa que produzimos apenas a probabilidade de movimento ascendente.  Para obter a mudan√ßa real, usaremos essa probabilidade.  A raz√£o para isso ficar√° mais clara quando falarmos sobre treinamento. <br><br><img src="https://habrastorage.org/webt/cm/n4/ap/cmn4apvesxvu5d8konqytnbk0cm.png"><br>  <i>Nossa fun√ß√£o pol√≠tica consiste em uma rede neural totalmente conectada em duas camadas</i> <br><br>  Mais especificamente, suponha que na entrada recebamos um vetor X, que cont√©m um conjunto de pixels pr√©-processados.  Ent√£o devemos calcular usando python \ numpy: <br><br><pre><code class="python hljs">h = np.dot(W1, x) <span class="hljs-comment"><span class="hljs-comment"># compute hidden layer neuron activations h[h&lt;0] = 0 # ReLU nonlinearity: threshold at zero logp = np.dot(W2, h) # compute log probability of going up p = 1.0 / (1.0 + np.exp(-logp)) # sigmoid function (gives probability of going up)</span></span></code> </pre> <br>  Nesse fragmento, W1 e W2 s√£o duas matrizes que inicializamos aleatoriamente.  N√≥s n√£o usamos preconceitos, porque quer√≠amos.  Note que no final usamos a n√£o linearidade do sigm√≥ide, o que reduz a probabilidade de sa√≠da para o intervalo [0,1].  Intuitivamente, os neur√¥nios em uma camada oculta (cujos pesos est√£o localizados em W1) podem detectar v√°rios cen√°rios de jogo (por exemplo, a bola est√° no topo e nossa raquete est√° no meio), e os pesos no W2 podem decidir se devemos subir em cada caso ou para baixo.  As combina√ß√µes aleat√≥rias iniciais W1 e W2, √© claro, a princ√≠pio causar√£o espasmos e convuls√µes em nosso neuro-jogador, o que o iguala a um imbecil-autista nos controles de um avi√£o.  Portanto, a √∫nica tarefa agora √© encontrar W1 e W2, o que leva a um bom jogo! <br><br>  H√° uma observa√ß√£o sobre o pr√©-processamento de pixels - idealmente, voc√™ precisa transferir pelo menos 2 quadros para a rede neural para que ele possa detectar movimento.  Mas, para simplificar a situa√ß√£o, aplicaremos a diferen√ßa de dois quadros.  Ou seja, subtrairemos os quadros atuais e anteriores e s√≥ ent√£o aplicaremos a diferen√ßa √† entrada da rede neural. <br><br>  <b>Parece algo imposs√≠vel.</b>  Neste ponto, gostaria que voc√™ apreciasse a complexidade do problema da RL.  Obtemos 100 800 n√∫meros (210x160x 3) e enviamos para nossa rede neural que implementa a pol√≠tica do jogador (que, ali√°s, inclui facilmente cerca de um milh√£o de par√¢metros nas matrizes W1 e W2).  Suponha que em algum momento decidimos subir.  O simulador de jogo pode responder que desta vez receberemos 0 pr√™mios e nos fornecer√° outros 100 800 n√∫meros para o pr√≥ximo quadro.  Podemos repetir esse processo centenas de vezes antes de receber uma recompensa diferente de zero!  Por exemplo, suponha que finalmente recebemos uma recompensa +1.  Isso √© maravilhoso, mas como ent√£o podemos dizer - o que levou a isso?  Foi essa a a√ß√£o que fizemos agora?  Ou talvez 76 quadros de volta?  Ou talvez isso tenha sido associado primeiro ao quadro 10 e depois fizemos algo certo no quadro 90?  E como descobrimos - qual dos milh√µes de "canetas" girar para alcan√ßar um sucesso ainda maior no futuro?  Chamamos isso de tarefa de determinar o coeficiente de confian√ßa em certas a√ß√µes.  No caso espec√≠fico do pong, sabemos que obtemos +1 se a bola passou pelo oponente.  A verdadeira raz√£o √© que chutamos acidentalmente a bola por um bom caminho alguns quadros atr√°s, e cada a√ß√£o subsequente que realizamos n√£o a afetou.  Em outras palavras, estamos diante de um problema computacional muito complexo e tudo parece bastante sombrio. <br><br>  <b>Treinando com um professor.</b>  Antes de nos aprofundarmos no gradiente da pol√≠tica (PG), gostaria de relembrar brevemente o ensino com um professor, porque, como veremos, a RL √© muito semelhante.  Consulte a tabela abaixo.  No ensino comum com um professor, transferiremos a imagem para a rede e receberemos na sa√≠da algumas probabilidades num√©ricas para as aulas.  Por exemplo, no nosso caso, temos duas classes: UP e DOWN.  Uso as probabilidades logar√≠tmicas (-1,2, -0,36) em vez das probabilidades no formato 30% e 70%, porque otimizamos a probabilidade logar√≠tmica da classe (ou etiqueta) correta.  Isso torna os c√°lculos matem√°ticos mais elegantes e equivale a otimizar apenas a probabilidade, porque o logaritmo √© mon√≥tono. <br><br>  Ao treinar com um professor, teremos acesso instant√¢neo √† turma correta (etiqueta).  No est√°gio de treinamento, eles nos dir√£o exatamente qual o passo certo necess√°rio agora (digamos que seja UP, etiqueta 0), embora a rede neural possa pensar de maneira diferente.  Portanto, calculamos o gradiente <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mtext" id="MJXp-Span-2">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-7"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-9" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W</font></font></span></span></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12"><font style="vertical-align: inherit;"> l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13"><font style="vertical-align: inherit;">o </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15"><font style="vertical-align: inherit;">p </font></span><span class="MJXp-mo" id="MJXp-Span-16" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">( </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17"><font style="vertical-align: inherit;">y </font></span><span class="MJXp-mo" id="MJXp-Span-18" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;">= </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19"><font style="vertical-align: inherit;">U </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20"><font style="vertical-align: inherit;">P </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22"><font style="vertical-align: inherit;">m </font></span><span class="MJXp-mrow" id="MJXp-Span-23"><span class="MJXp-mo" id="MJXp-Span-24" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">√©</font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25"><font style="vertical-align: inherit;"> d </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26"><font style="vertical-align: inherit;">i </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27"><font style="vertical-align: inherit;">o </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28"><font style="vertical-align: inherit;">x </font></span><span class="MJXp-mo" id="MJXp-Span-29" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">)</font></span></font><span class="MJXp-mtext" id="MJXp-Span-11">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-16" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-18" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-21">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-23"><span class="MJXp-mo" id="MJXp-Span-24" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-29" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.312ex" height="2.66ex" viewBox="0 -832 13050.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-6E" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-61" x="850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-62" x="1380" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-6C" x="1809" y="0"></use><g transform="translate(2108,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-57" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-6C" x="3728" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-6F" x="4027" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-67" x="4512" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-70" x="4993" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMAIN-28" x="5496" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-79" x="5886" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMAIN-3D" x="6661" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-55" x="7717" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-50" x="8485" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-6D" x="9486" y="0"></use><g transform="translate(10365,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">√©</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-64" x="10734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-69" x="11257" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-6F" x="11603" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-78" x="12088" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMAIN-29" x="12661" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> \ nabla_ {W} \ log p (y = UP \ m√©dio x) </script>  para ajustar as configura√ß√µes de rede.  Esse gradiente apenas nos diz como devemos alterar cada um dos milh√µes de par√¢metros para que a rede tenha um pouco mais probabilidade de prever o UP na mesma situa√ß√£o.  Por exemplo, um dentre um milh√£o de par√¢metros na rede pode ter um gradiente de -2,1, o que significa que se aument√°ssemos esse par√¢metro por um pequeno valor positivo (por exemplo, 0,001), a probabilidade logar√≠tmica de UP diminuiria em 2,1 * 0,001.  (diminui√ß√£o devido ao sinal negativo).  Se aplicarmos o gradiente e atualizarmos o par√¢metro usando o algoritmo de retropropaga√ß√£o, sim, nossa rede fornecer√° uma alta probabilidade de UP quando vir a mesma imagem ou uma imagem muito semelhante no futuro. <br><br><img src="https://habrastorage.org/webt/-p/r6/bu/-pr6bumeyrk2xdf9nuoulm5oflw.png"><br><br>  <b>Gradientes de Pol√≠tica (PG)</b> .  OK, mas o que fazemos se n√£o tivermos o r√≥tulo de treinamento de refor√ßo correto?  Aqui est√° uma solu√ß√£o para o PG (consulte o diagrama abaixo novamente).  Nossa rede neural calculou a probabilidade de um aumento de 30% (logprob -1.2) e de DOWN em 70% (logprob -0.36).  Agora, fazemos uma sele√ß√£o dessa distribui√ß√£o e especificamos qual a√ß√£o iremos executar.  Por exemplo, eles escolheram DOWN e enviaram essa a√ß√£o para o simulador de jogo.  Nesse ponto, preste aten√ß√£o a um fato interessante: poder√≠amos calcular e aplicar imediatamente o gradiente para a a√ß√£o DOWN, como fizemos no ensino com um professor, e assim aumentar a probabilidade da rede de executar a a√ß√£o DOWN no ‚Äã‚Äãfuturo.  Assim, podemos apreciar e lembrar imediatamente esse gradiente.  Mas o problema √© que, no momento, ainda n√£o sabemos - √© bom descer?  <b>Mas o mais interessante √© que podemos esperar um pouco e aplicar o gradiente mais tarde!</b>  Em Pong, podemos esperar at√© o final do jogo, receber a recompensa que recebemos (+1 se vencemos ou -1 se perdemos) e inseri-la como um fator para o gradiente.  Portanto, se introduzirmos -1 para a probabilidade DOWN e fizermos a propaga√ß√£o reversa, reconstruiremos os par√¢metros da rede para que seja menos prov√°vel que a a√ß√£o DOWN seja executada no futuro quando encontrar a mesma imagem, j√° que a ado√ß√£o dessa a√ß√£o nos levou a perder o jogo.  Ou seja, precisaremos lembrar de alguma forma todas as a√ß√µes (entradas e sa√≠das da rede neural) em um epis√≥dio do jogo e, com base nessa matriz, torcer a rede neural da mesma maneira que no ensino com um professor. <br><br><img src="https://habrastorage.org/webt/hj/jr/tg/hjjrtgpmkweozlnidrhixsf7jfs.png"><br><br>  E √© tudo o que √© necess√°rio: temos uma pol√≠tica estoc√°stica que escolhe a√ß√µes e, no futuro, a√ß√µes que acabam por levar a bons resultados s√£o incentivadas e a√ß√µes que levam a maus resultados n√£o s√£o incentivadas.  Al√©m disso, a recompensa n√£o deve ser de +1 ou -1 se finalmente vencermos o jogo.  Pode ser um valor arbitr√°rio com o mesmo significado.  Por exemplo, se tudo der certo, a recompensa pode ser 10,0, que usamos como gradiente para iniciar a retropropaga√ß√£o do backprop.  Essa √© a beleza das redes neurais.  Us√°-los pode parecer uma farsa: voc√™ pode ter 1 milh√£o de par√¢metros embutidos em 1 teraflop de c√°lculos e pode fazer o programa aprender a fazer coisas arbitr√°rias com descida do gradiente estoc√°stico (SGD).  N√£o deve funcionar, mas √© engra√ßado vivermos em um universo onde ele funciona. <br><br>  Se jog√°ssemos jogos de tabuleiro simples, como damas, o pedido seria aproximadamente o mesmo.  H√° uma diferen√ßa not√°vel em rela√ß√£o aos algoritmos de recorte minimax ou alfa-beta.  Nesses algoritmos, o programa olha alguns passos √† frente, conhecendo as regras do jogo e analisa milh√µes de posi√ß√µes.  Na abordagem RL, apenas movimentos efetivamente feitos s√£o analisados.  Ao mesmo tempo, a rede neural n√£o espera, pois n√£o sabe nada sobre as regras do jogo. <br><br>  <b>Ordem de treino em detalhes.</b>  Criamos e inicializamos uma rede neural com alguns W1, W2 e jogamos 100 jogos de pong (chamamos isso de "desentendimento" da pol√≠tica, lan√ßamentos de pol√≠ticas).  Suponha que cada jogo consista em 200 quadros, portanto, no total, tomamos 100 * 200 = 20.000 decis√µes para subir ou descer.  E para cada uma das solu√ß√µes, conhecemos o gradiente que nos diz como os par√¢metros devem mudar se queremos incentivar ou proibir esta solu√ß√£o nesse estado no futuro.  Tudo o que resta agora √© rotular cada decis√£o que tomamos como boa ou ruim.  Por exemplo, suponha que vencemos 12 jogos e perdemos 88. Tomaremos todas as 200 * 12 = 2400 decis√µes que tomamos nos jogos vencedores e faremos uma atualiza√ß√£o positiva (preenchendo um gradiente de +1,0 para cada a√ß√£o, executando backprop e atualizando os par√¢metros incentivar as a√ß√µes que escolhemos em todas essas condi√ß√µes).  E tomaremos as outras 200 * 88 = 17.600 decis√µes que tomamos na perda de jogos e faremos uma atualiza√ß√£o negativa (n√£o aprovando o que fizemos).  E isso √© tudo o que preciso.  Agora, a rede ter√° mais chances de repetir a√ß√µes que funcionaram e um pouco menos prov√°vel de repetir a√ß√µes que n√£o funcionaram.  Agora, jogamos outros 100 jogos com nossa nova pol√≠tica ligeiramente aprimorada e repetimos a aplica√ß√£o de gradientes. <br><br><img src="https://habrastorage.org/webt/zv/ap/mo/zvapmoiul9plnltsttdsplvze3g.png"><br>  <i>Esquema de desenho animado de 4 jogos.</i>  <i>Cada c√≠rculo preto √© um tipo de estado do jogo (tr√™s exemplos de estados s√£o mostrados abaixo) e cada seta √© uma transi√ß√£o marcada com a a√ß√£o que foi selecionada.</i>  <i>Nesse caso, vencemos 2 jogos e perdemos 2 jogos.</i>  <i>Fizemos os dois jogos que vencemos e incentivamos levemente todas as a√ß√µes que fizemos neste epis√≥dio.</i>  <i>Por outro lado, tamb√©m levaremos os dois jogos perdidos e desencorajaremos ligeiramente cada a√ß√£o individual que realizamos neste epis√≥dio.</i> <br><br>  Se voc√™ refletir sobre isso, come√ßar√° a encontrar algumas propriedades divertidas.  Por exemplo, e se fiz√©ssemos uma boa a√ß√£o no quadro 50, chutando a bola corretamente, mas perdemos a bola no quadro 150?  Como perdemos o jogo, cada a√ß√£o individual agora √© marcada como ruim e isso n√£o impede o acerto correto no quadro 50?  Voc√™ est√° certo - ser√° assim para esta festa.  No entanto, quando voc√™ considera o processo em milhares / milh√µes de jogos, a execu√ß√£o correta da recupera√ß√£o aumenta a probabilidade de vit√≥ria no futuro.  Em m√©dia, voc√™ ver√° atualiza√ß√µes mais positivas do que negativas para um golpe de raquete adequado.  E a pol√≠tica de implementa√ß√£o de redes neurais produzir√° as rea√ß√µes certas. <br><br>  <i>Atualiza√ß√£o: 9 de dezembro de 2016</i> √© uma vis√£o alternativa.  Na minha explica√ß√£o acima, uso termos como "definir uma propaga√ß√£o de gradiente e backprop back", que √© uma t√©cnica h√°bil definida.  Se voc√™ est√° acostumado a escrever seu pr√≥prio c√≥digo de backprop espalhado por backprop ou usando o Torch, pode controlar totalmente os gradientes.  No entanto, se voc√™ est√° acostumado ao Theano ou ao TensorFlow, ficar√° um pouco confuso porque o c√≥digo backprop √© totalmente automatizado e dif√≠cil de personalizar.  Nesse caso, a seguinte vis√£o alternativa pode ser mais produtiva.  Ao ensinar com um professor, o objetivo usual √© maximizar <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-30"><span class="MJXp-mtext" id="MJXp-Span-31">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-34"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-36" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38"><font style="vertical-align: inherit;"> l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39"><font style="vertical-align: inherit;">o </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41"><font style="vertical-align: inherit;">p </font></span><span class="MJXp-mo" id="MJXp-Span-42" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">( </font></span><span class="MJXp-msubsup" id="MJXp-Span-43"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">y </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-43"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-45" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">i</font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47"><font style="vertical-align: inherit;"> m </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48"><font style="vertical-align: inherit;">i </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49"><font style="vertical-align: inherit;">d </font></span><span class="MJXp-msubsup" id="MJXp-Span-50"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">x </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-50"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-52" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">i</font></span></span><span class="MJXp-mo" id="MJXp-Span-53" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"> )</font></span></font><span class="MJXp-mtext" id="MJXp-Span-37">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-42" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-43"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-45" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mtext" id="MJXp-Span-46">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-50"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-52" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mo" id="MJXp-Span-53" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.045ex" height="2.66ex" viewBox="0 -832 9060.9 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-75" x="719" y="0"></use><g transform="translate(1292,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-69" x="1242" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-6C" x="2764" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-6F" x="3063" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-67" x="3548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-70" x="4029" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMAIN-28" x="4532" y="0"></use><g transform="translate(4922,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-69" x="693" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-6D" x="6007" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-69" x="6885" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-64" x="7231" y="0"></use><g transform="translate(7754,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMAIN-29" x="8671" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> \ sum_i \ log p (y_i \ mid x_i) </script>  onde <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-54"><span class="MJXp-msubsup" id="MJXp-Span-55"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-57" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-58" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-59"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-61" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.102ex" height="1.817ex" viewBox="0 -520.7 2196.8 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-69" x="809" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMAIN-2C" x="916" y="0"></use><g transform="translate(1361,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-69" x="693" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-3"> x_i, y_i </script>  - exemplos de treinamento (como imagens e seus r√≥tulos).  A aplica√ß√£o do gradiente √† fun√ß√£o pol√≠tica coincide exatamente com o treinamento com o professor, mas com duas pequenas diferen√ßas: 1) n√£o temos os r√≥tulos corretos <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-62"><span class="MJXp-msubsup" id="MJXp-Span-63"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-65" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.939ex" height="1.817ex" viewBox="0 -520.7 834.8 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-69" x="693" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> y_i </script>  , portanto, como um "r√≥tulo falso", usamos a a√ß√£o que recebemos para selecionar a pol√≠tica quando viu <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-66"><span class="MJXp-msubsup" id="MJXp-Span-67"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-69" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.129ex" height="1.817ex" viewBox="0 -520.7 916.8 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-69" x="809" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> x_i </script>  e 2) Introduzimos outro coeficiente de conveni√™ncia (vantagem) para cada a√ß√£o.  Assim, no final, nossa perda agora parece <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-70"><span class="MJXp-mtext" id="MJXp-Span-71">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73">u</span><span class="MJXp-msubsup" id="MJXp-Span-74"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-76" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-77"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-79" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mtext" id="MJXp-Span-80">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84">p</span><span class="MJXp-mo" id="MJXp-Span-85" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-86"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-88" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mtext" id="MJXp-Span-89">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92">d</span><span class="MJXp-msubsup" id="MJXp-Span-93"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-95" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-96" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.588ex" height="2.66ex" viewBox="0 -832 10155.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-75" x="719" y="0"></use><g transform="translate(1292,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-69" x="1242" y="-213"></use></g><g transform="translate(2514,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-69" x="1061" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-6C" x="3859" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-6F" x="4158" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-67" x="4643" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-70" x="5124" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMAIN-28" x="5627" y="0"></use><g transform="translate(6017,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-69" x="693" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-6D" x="7101" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-69" x="7980" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-64" x="8325" y="0"></use><g transform="translate(8849,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMAIN-29" x="9766" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> \ sum_i A_i \ log p (y_i \ mid x_i) </script>  onde <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-97"><span class="MJXp-msubsup" id="MJXp-Span-98"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-100" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.939ex" height="1.817ex" viewBox="0 -520.7 834.8 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhjMGv6_Pno9uovDVSzAEQPx2GsZcA#MJMATHI-69" x="693" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> y_i </script>  - esta √© a a√ß√£o que realizamos com a amostra, e <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-101"><span class="MJXp-msubsup" id="MJXp-Span-102"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-104" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-8"> A_i </script>  √â o n√∫mero que chamamos de coeficiente de conveni√™ncia.  Por exemplo, no caso de pong, o valor <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-105"><span class="MJXp-msubsup" id="MJXp-Span-106"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-107" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-108" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-9"> A_i </script>  pode ser 1,0 se acabarmos vencendo o epis√≥dio e -1,0 se perdermos.  Isso garante que maximizamos a probabilidade de registrar a√ß√µes que levaram a um bom resultado e minimizamos a probabilidade de registrar a√ß√µes que n√£o o fizeram.  E a√ß√µes neutras como resultado de muitos apelos n√£o afetar√£o particularmente a fun√ß√£o da pol√≠tica.  Assim, o aprendizado por refor√ßo √© exatamente o mesmo que aprender com um professor, mas em um conjunto de dados (epis√≥dios) em constante mudan√ßa, com um fator adicional. <br><br>  <b>Recursos de viabilidade mais avan√ßados.</b>  Tamb√©m prometi um pouco mais de informa√ß√£o.  At√© o momento, avaliamos a corre√ß√£o de cada a√ß√£o individual com base em nossa vit√≥ria ou n√£o.  Em uma configura√ß√£o de RL mais geral, receberemos uma "recompensa condicional" <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-109"><span class="MJXp-msubsup" id="MJXp-Span-110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-112" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-10"> r_t </script>  para cada etapa, dependendo do n√∫mero ou hora da etapa.  Uma das op√ß√µes comuns √© usar um coeficiente com desconto, para que a ‚Äúposs√≠vel recompensa‚Äù no diagrama acima seja <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-113"><span class="MJXp-msubsup" id="MJXp-Span-114"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115" style="margin-right: 0.05em;">R</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-116" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-117" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-118">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120">u</span><span class="MJXp-msubsup" id="MJXp-Span-121"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-127"><span class="MJXp-mtext" id="MJXp-Span-128">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">y</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-123"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">k</span><span class="MJXp-mo" id="MJXp-Span-125">=</span><span class="MJXp-mn" id="MJXp-Span-126">0</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-134">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">m</span><span class="MJXp-msubsup" id="MJXp-Span-138"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-140" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-msubsup" id="MJXp-Span-141"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-143" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">t</span><span class="MJXp-mo" id="MJXp-Span-145">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">k</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-11"> R_t = \ sum_ {k = 0} ^ {\ infty} \ gama ^ k r_ {t + k} </script>  onde <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-147"><span class="MJXp-mtext" id="MJXp-Span-148">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-12"> \ gama </script>  √â um n√∫mero de 0 a 1, chamado coeficiente de desconto (por exemplo, 0,99).  A express√£o diz que a for√ßa com a qual incentivamos a a√ß√£o √© a soma ponderada de todas as recompensas, mas as recompensas subsequentes s√£o exponencialmente menos importantes.  Ou seja, cadeias curtas de a√ß√µes s√£o melhor incentivadas e a cauda de longas cadeias de a√ß√µes se torna menos importante.  Na pr√°tica, voc√™ tamb√©m precisa normaliz√°-los.  Por exemplo, suponha que calculamos <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-153"><span class="MJXp-msubsup" id="MJXp-Span-154"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155" style="margin-right: 0.05em;">R</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-156" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-13"> R_t </script>  para todas as 20.000 a√ß√µes em uma s√©rie de 100 epis√≥dios do jogo.  Uma boa id√©ia √© normalizar esses valores (subtrair a m√©dia, dividir pelo desvio padr√£o) antes de conect√°-los ao algoritmo backprop.  Assim, sempre incentivamos e desencorajamos cerca de metade das a√ß√µes realizadas.  Isso reduz as flutua√ß√µes e torna a pol√≠tica mais convergente.  Um estudo mais profundo pode ser encontrado em [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">link</a> ]. <br><br>  <b>Derivado de uma fun√ß√£o de pol√≠tica.</b>  Eu tamb√©m queria descrever brevemente como os gradientes s√£o feitos matematicamente.  Os gradientes da fun√ß√£o da pol√≠tica s√£o um caso especial de uma teoria mais geral.  O caso geral √© que, quando temos uma express√£o da forma <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-157"><span class="MJXp-msubsup" id="MJXp-Span-158"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-160" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">x</span><span class="MJXp-mtext" id="MJXp-Span-162">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166">p</span><span class="MJXp-mo" id="MJXp-Span-167">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">x</span><span class="MJXp-mtext" id="MJXp-Span-169">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">d</span><span class="MJXp-mtext" id="MJXp-Span-173">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178">a</span><span class="MJXp-mo" id="MJXp-Span-179">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-180" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181">f</span><span class="MJXp-mo" id="MJXp-Span-182" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">x</span><span class="MJXp-mo" id="MJXp-Span-184" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-185" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14"> E_ {x \ sim p (x \ mid \ theta)} [f (x)] </script>  , ou seja, a expectativa de alguma fun√ß√£o escalar <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-186"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">f</span><span class="MJXp-mo" id="MJXp-Span-188" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189">x</span><span class="MJXp-mo" id="MJXp-Span-190" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-15"> f (x) </script>  com alguma distribui√ß√£o de seu par√¢metro <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-191"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">p</span><span class="MJXp-mo" id="MJXp-Span-193" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-194">x</span><span class="MJXp-mo" id="MJXp-Span-195" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mtext" id="MJXp-Span-196">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">a</span><span class="MJXp-mo" id="MJXp-Span-202" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-16"> p (x; \ theta) </script>  parametrizado por algum vetor <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-203"><span class="MJXp-mtext" id="MJXp-Span-204">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-17"> \ theta </script>  .  Ent√£o <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-210"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-211">f</span><span class="MJXp-mo" id="MJXp-Span-212" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-213">x</span><span class="MJXp-mo" id="MJXp-Span-214" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-18"> f (x) </script>  se tornar√° nossa fun√ß√£o de recompensa (ou a fun√ß√£o de conveni√™ncia em um sentido mais geral) e a distribui√ß√£o discreta <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-215"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">p</span><span class="MJXp-mo" id="MJXp-Span-217" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218">x</span><span class="MJXp-mo" id="MJXp-Span-219" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> p (x) </script>  ser√° a nossa pol√≠tica, que na verdade tem a forma <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-220"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221">p</span><span class="MJXp-mo" id="MJXp-Span-222" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">a</span><span class="MJXp-mtext" id="MJXp-Span-224">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-228">I</span><span class="MJXp-mo" id="MJXp-Span-229" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> p (a \ mid I) </script>  dando as probabilidades de uma a√ß√£o a para a imagem <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-230"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231">I</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> I </script>  .  Ent√£o, estamos interessados ‚Äã‚Äãem como podemos mudar a distribui√ß√£o de p atrav√©s de seus par√¢metros <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-232"><span class="MJXp-mtext" id="MJXp-Span-233">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22"> \ theta </script>  aumentar <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-239"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240">f</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23"> f </script>  (ou seja, como alteramos as configura√ß√µes de rede para que as a√ß√µes recebam uma recompensa maior).  N√≥s temos isso: <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-241"><span class="noError" id="MJXp-Span-242" style="display: inline-block;">\&nbsp;begin&nbsp;{align}&nbsp;\&nbsp;nabla&nbsp;_&nbsp;{\&nbsp;theta}&nbsp;E_x&nbsp;[f&nbsp;(x)]&nbsp;&amp;&nbsp;=&nbsp;\&nbsp;nabla&nbsp;_&nbsp;{\&nbsp;theta}&nbsp;\&nbsp;sum_x&nbsp;p&nbsp;(x)&nbsp;f&nbsp;(x)&nbsp;&amp;&nbsp;\&nbsp;text&nbsp;{defini√ß√£o&nbsp;de&nbsp;expectativa}&nbsp;\\&nbsp;&amp;&nbsp;=&nbsp;\&nbsp;sum_x&nbsp;\&nbsp;nabla&nbsp;_&nbsp;{\&nbsp;theta}&nbsp;p&nbsp;(x)&nbsp;f&nbsp;(x)&nbsp;e&nbsp;\&nbsp;text&nbsp;{troque&nbsp;a&nbsp;soma&nbsp;e&nbsp;o&nbsp;gradiente}&nbsp;\\&nbsp;&amp;&nbsp;=&nbsp;\&nbsp;sum_x&nbsp;p&nbsp;(x)&nbsp;\&nbsp;frac&nbsp;{\&nbsp;nabla&nbsp;_&nbsp;{\&nbsp;theta}&nbsp;p&nbsp;(x)}&nbsp;{p&nbsp;(x)}&nbsp;f&nbsp;(x)&nbsp;&amp;&nbsp;\&nbsp;text&nbsp;{multiplique&nbsp;e&nbsp;divida&nbsp;por}&nbsp;p&nbsp;(x)&nbsp;\\&nbsp;&amp;&nbsp;=&nbsp;\&nbsp;sum_x&nbsp;p&nbsp;(x)&nbsp;\&nbsp;nabla&nbsp;_&nbsp;{\&nbsp;theta}&nbsp;\&nbsp;log&nbsp;p&nbsp;(x)&nbsp;f&nbsp;(x)&nbsp;&amp;&nbsp;\&nbsp;text&nbsp;{use&nbsp;o&nbsp;fato&nbsp;de&nbsp;que}&nbsp;\&nbsp;nabla&nbsp;_&nbsp;{\&nbsp;theta}&nbsp;\&nbsp;log&nbsp;(z)&nbsp;=&nbsp;\&nbsp;frac&nbsp;{1}&nbsp;{z}&nbsp;\&nbsp;nabla&nbsp;_&nbsp;{\&nbsp;theta}&nbsp;z&nbsp;\\&nbsp;&amp;&nbsp;=&nbsp;E_x&nbsp;[f&nbsp;(x)&nbsp;\&nbsp;nabla&nbsp;_&nbsp;{\&nbsp;theta}&nbsp;\&nbsp;log&nbsp;p&nbsp;(x)]&nbsp;&amp;&nbsp;\&nbsp;text&nbsp;{defini√ß√£o&nbsp;de&nbsp;expectativa}&nbsp;\&nbsp;end&nbsp;{align</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24"> \ begin {align} \ nabla _ {\ theta} E_x [f (x)] & = \ nabla _ {\ theta} \ sum_x p (x) f (x) & \ text {defini√ß√£o de expectativa} \\ & = \ sum_x \ nabla _ {\ theta} p (x) f (x) e \ text {troque a soma e o gradiente} \\ & = \ sum_x p (x) \ frac {\ nabla _ {\ theta} p (x)} {p (x)} f (x) & \ text {multiplique e divida por} p (x) \\ & = \ sum_x p (x) \ nabla _ {\ theta} \ log p (x) f (x) & \ text {use o fato de que} \ nabla _ {\ theta} \ log (z) = \ frac {1} {z} \ nabla _ {\ theta} z \\ & = E_x [f (x) \ nabla _ {\ theta} \ log p (x)] & \ text {defini√ß√£o de expectativa} \ end {align</script><br><br>  Vou tentar explicar isso.  Temos alguma distribui√ß√£o <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-243"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">p</span><span class="MJXp-mo" id="MJXp-Span-245" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">x</span><span class="MJXp-mo" id="MJXp-Span-247" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mtext" id="MJXp-Span-248">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253">a</span><span class="MJXp-mo" id="MJXp-Span-254" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> p (x; \ theta) </script>  (Usei a abrevia√ß√£o <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-255"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">p</span><span class="MJXp-mo" id="MJXp-Span-257" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">x</span><span class="MJXp-mo" id="MJXp-Span-259" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-26"> p (x) </script>  a partir do qual podemos selecionar valores espec√≠ficos.  Por exemplo, pode ser uma distribui√ß√£o gaussiana da qual um gerador de n√∫meros aleat√≥rios √© amostrado.  Para cada exemplo, tamb√©m podemos calcular a fun√ß√£o de estimativa <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-260"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261">f</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-27"> f </script>  , que, de acordo com o exemplo atual, fornece uma estimativa escalar.  A equa√ß√£o resultante nos diz como devemos mudar a distribui√ß√£o atrav√©s de seus par√¢metros <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-262"><span class="MJXp-mtext" id="MJXp-Span-263">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-265">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-28"> \ theta </script>  se quisermos mais exemplos de a√ß√µes baseadas nela para obter taxas mais altas <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">f</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29"> f </script>  .  Tomamos alguns exemplos de a√ß√µes <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-271"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-272">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30"> x </script>  e sua avalia√ß√£o <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-273"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-274">f</span><span class="MJXp-mo" id="MJXp-Span-275" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276">x</span><span class="MJXp-mo" id="MJXp-Span-277" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-31"> f (x) </script>  , e tamb√©m para cada x, tamb√©m avaliamos o segundo termo <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-278"><span class="MJXp-mtext" id="MJXp-Span-279">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">l</span><span class="MJXp-msubsup" id="MJXp-Span-284"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-286" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-287">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">a</span></span></span><span class="MJXp-mtext" id="MJXp-Span-293">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">p</span><span class="MJXp-mo" id="MJXp-Span-298" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">x</span><span class="MJXp-mo" id="MJXp-Span-300" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mtext" id="MJXp-Span-301">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306">a</span><span class="MJXp-mo" id="MJXp-Span-307" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-32"> \ nabla _ {\ theta} \ log p (x; \ theta) </script>  .  O que √© esse multiplicador?  Este √© precisamente o vetor - o gradiente, que nos d√° uma dire√ß√£o no espa√ßo do par√¢metro, o que levar√° a um aumento na probabilidade de uma a√ß√£o espec√≠fica <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-308"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-33"> x </script>  .  Em outras palavras, se empurr√°ssemos Œ∏ na dire√ß√£o <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-310"><span class="MJXp-mtext" id="MJXp-Span-311">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315">l</span><span class="MJXp-msubsup" id="MJXp-Span-316"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-318" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-319">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324">a</span></span></span><span class="MJXp-mtext" id="MJXp-Span-325">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">p</span><span class="MJXp-mo" id="MJXp-Span-330" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331">x</span><span class="MJXp-mo" id="MJXp-Span-332" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mtext" id="MJXp-Span-333">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338">a</span><span class="MJXp-mo" id="MJXp-Span-339" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-34"> \ nabla _ {\ theta} \ log p (x; \ theta) </script>  , veremos que a nova probabilidade dessa a√ß√£o aumentar√° um pouco.  Se voc√™ olhar para a f√≥rmula, ela nos diz que devemos tomar essa dire√ß√£o e multiplicar o valor escalar por ela. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341">f</span><span class="MJXp-mo" id="MJXp-Span-342" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343">x</span><span class="MJXp-mo" id="MJXp-Span-344" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-35"> f (x) </script>  .  Isso garantir√° que exemplos de a√ß√µes com uma classifica√ß√£o mais alta (no nosso caso, uma recompensa) sejam "mais atraentes" do que exemplos com um indicador mais baixo; portanto, se formos atualizar com base em v√°rias amostras de <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-345"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-36"> p </script>  , a densidade de probabilidade mudaria para a dire√ß√£o de pontos de jogo resultantes mais altos, o que aumenta a probabilidade de obter exemplos de a√ß√µes com altas recompensas.  √â importante que o gradiente n√£o seja retirado da fun√ß√£o <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-347"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348">f</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-37"> f </script>  , pois geralmente pode ser indiferenciado e imprevis√≠vel.  Um <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-349"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-38"> p </script>  diferenci√°vel por <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-351"><span class="MJXp-mtext" id="MJXp-Span-352">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-39"> \ theta </script>  .  Isso √© <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-358"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-40"> p </script>  √© uma distribui√ß√£o discreta continuamente ajust√°vel, onde voc√™ pode ajustar as probabilidades de a√ß√µes individuais.  Tamb√©m assumimos que <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-360"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-361">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-41"> p </script>  normalizado. <br><br><img src="https://habrastorage.org/webt/xo/qy/9p/xoqy9pzjvy4d3sxosr_irpasic4.png"><br><br>  <i>Visualiza√ß√£o em gradiente.</i>  <i>Esquerda: distribui√ß√£o gaussiana e v√°rios exemplos (pontos azuis).</i>  <i>Em cada ponto azul, tamb√©m plotamos o gradiente da probabilidade logar√≠tmica em rela√ß√£o ao par√¢metro m√©dio.</i>  <i>A seta indica a dire√ß√£o na qual o valor m√©dio da distribui√ß√£o deve ser alterado para aumentar a probabilidade dessa a√ß√£o de exemplo.</i>  <i>No meio: Adicionada alguma fun√ß√£o de avalia√ß√£o que fornece -1 em todos os lugares, exceto +1 em algumas regi√µes pequenas (observe que essa pode ser uma fun√ß√£o escalar arbitr√°ria e n√£o necessariamente diferenci√°vel).</i>  <i>As setas agora s√£o codificadas por cores, porque, devido √† multiplica√ß√£o, calcularemos a m√©dia de todas as setas verdes com uma classifica√ß√£o positiva e as setas vermelhas negativas.</i>  <i>Direita: ap√≥s atualizar os par√¢metros, as setas verdes e as setas vermelhas invertidas nos empurram para a esquerda e para baixo.</i>  <i>As amostras dessa distribui√ß√£o agora ter√£o uma classifica√ß√£o esperada mais alta, se desejado.</i> <br><br>  Espero que a conex√£o com a RL seja clara.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nossa pol√≠tica nos d√° exemplos de a√ß√µes, e algumas delas funcionam melhor que outras (a julgar pela fun√ß√£o da conveni√™ncia). A maneira de alterar as configura√ß√µes da pol√≠tica √© executar, pegar o gradiente das a√ß√µes selecionadas, multiplic√°-lo pela classifica√ß√£o e adicionar tudo o que fizemos acima. Para uma conclus√£o mais completa, recomendo uma palestra de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">John Shulman. </font></font><br></a> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Treinamento.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bem, desenvolvemos os princ√≠pios dos gradientes da fun√ß√£o da pol√≠tica. Eu implementei toda a abordagem em um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">script Python de 130 linhas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que usa o emulador ATAI 2600 Pong </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">pronto</font></a><font style="vertical-align: inherit;"> da </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenAI Gym</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Treinei uma rede neural de duas camadas com 200 neur√¥nios da camada oculta usando o algoritmo RMSProp para uma s√©rie de 10 epis√≥dios (cada epis√≥dio pelas regras consiste em v√°rios sorteios de bola e o epis√≥dio continua com 21). N√£o configurei muito os hiper par√¢metros e experimentei no meu Macbook lento, mas ap√≥s um treino de tr√™s dias, recebi uma pol√≠tica que √© um pouco melhor do que o player embutido. O n√∫mero total de epis√≥dios foi de aproximadamente 8.000, portanto, o algoritmo jogou aproximadamente 200.000 jogos de pong, o que √© bastante, e produziu um total de ~ 800 atualiza√ß√µes nos pesos. Se eu treinasse na GPU com ConvNets, em alguns dias conseguiria √≥timos resultados e, se otimizasse os hiperpar√¢metros, sempre conseguiria vencer. No entanto, n√£o gastei muito tempo computando ou configurando,ent√£o, temos o Pong AI, que ilustra as principais id√©ias e funciona muito bem:</font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/cf/gf/jr/cfgfjrkzt_awy-l7f5lcxcrfvki.png"></a> <br> <i>  .      </i> <br><br> <b> .</b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tamb√©m podemos observar os pesos obtidos da rede neural. Gra√ßas ao pr√©-processamento, cada uma de nossas entradas √© uma imagem diferente de 80x80 (quadro atual menos quadro anterior). Cada neur√¥nio da camada W1 √© conectado a uma camada oculta W2 composta por 200 neur√¥nios. O n√∫mero de t√≠tulos √© 80 * 80 * 200. Vamos tentar analisar essas conex√µes. Classificaremos todos os neur√¥nios da camada W2 e visualizaremos quais pesos levam a ela. A partir das escalas que levam a um neur√¥nio W2 dos neur√¥nios W1, faremos imagens de 80x80. Abaixo est√£o 40 fotos desse tipo de W2 (um total de 200). Pixels brancos s√£o pesos positivos e pretos s√£o negativos. Observe que v√°rios neur√¥nios W2 est√£o sintonizados em uma bola voadora codificada em linhas tracejadas. Em um jogo, a bola pode estar apenas em um lugar,portanto, esses neur√¥nios s√£o polivalentes e "disparam" se a bola estiver em algum lugar dentro dessas linhas. A altern√¢ncia de preto e branco √© interessante, porque quando a bola se move ao longo da pista, a atividade do neur√¥nio flutua como uma onda senoidal. E por causa da ReLU, ele apenas "dispara" em determinadas posi√ß√µes. H√° muito ru√≠do nas imagens, o que seria menor se eu usasse a regulariza√ß√£o L2.</font></font><br><br><img src="https://habrastorage.org/webt/1t/n4/le/1tn4lew2rszryk1u9vkbreigku4.png"><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O que n√£o est√° acontecendo.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ent√£o, aprendemos a jogar pong em imagens usando o gradiente da fun√ß√£o policy, e isso funciona muito bem. Essa abordagem √© uma forma bizarra de "sugerir e verificar", onde "adivinhar" se refere √† execu√ß√£o de nossa pol√≠tica em v√°rios epis√≥dios do jogo, e a "verifica√ß√£o" incentiva a√ß√µes que levam a bons resultados. Em geral, isso representa o n√≠vel atual de como estamos lidando atualmente com os problemas do aprendizado refor√ßado. Se voc√™ entende o algoritmo intuitivamente e sabe como ele funciona, voc√™ deve ficar pelo menos um pouco decepcionado. Em particular, quando isso n√£o funciona?</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Compare isso com a forma como uma pessoa pode aprender a jogar pong. Voc√™ mesmo mostra o jogo a eles e diz algo como: ‚ÄúVoc√™ controla a raquete e pode mov√™-la para cima e para baixo, e sua tarefa √© jogar a bola por outro jogador controlado pelo programa interno‚Äù e voc√™ est√° pronto para ir. Observe algumas diferen√ßas:</font></font><br><br><ul><li>         - , ,   ,     .     RL       ,        .       ,        (        ),       ,  .         .   ,          ,  ,  ,   ,            , ,   ,  . <br></li><li>      ,     ( ,    ,     ,      ..),    ( ¬´¬ª ¬´ ,  , ,    -  -  . .).      ¬´¬ª          / . ,     ,    (   )   (      ,    ). <br></li><li>    ‚Äî    (brute force),            ,       .              .       ,    ,           ,      .   ,     ¬´¬ª    ,        .   ,    ,         . <br></li><li>        ,    ,     .    ,             ,      .           . <br></li></ul><br><img src="https://habrastorage.org/webt/do/4a/ha/do4ahazbavg7xmlq-a5omrr77vq.png"><br><br> <i>:  :      RL.   ,  ,     .  ,    .     ,  99%        .  ,  ¬´¬ª   . :       ¬´¬ª,    ,  - , -  , -  ,     ,     .                 ¬´ ,      ¬ª.</i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eu tamb√©m gostaria de enfatizar o fato de que, pelo contr√°rio, em muitos jogos os gradientes da pol√≠tica derrotariam facilmente uma pessoa. Em particular, isso se aplica a jogos com recompensas frequentes, que exigem uma rea√ß√£o precisa e r√°pida e sem planejamento a longo prazo. Correla√ß√µes de curto prazo entre recompensas e a√ß√µes podem ser facilmente vistas pela abordagem do PG. Voc√™ pode ver semelhante em nosso agente Pong. Ele desenvolve uma estrat√©gia quando simplesmente espera a bola e depois se move rapidamente para peg√°-lo apenas na borda, por causa do qual a bola salta em alta velocidade vertical. O agente obt√©m v√°rias vit√≥rias consecutivas, repetindo essa estrat√©gia simples. Existem muitos jogos (Pinball, Breakout) nos quais o Deep Q-Learning atrai e atropela uma pessoa na lama com suas a√ß√µes simples e precisas.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Depois de entender o "truque" com o qual esses algoritmos funcionam, voc√™ poder√° entender seus pontos fortes e fracos. Em particular, esses algoritmos est√£o muito atr√°s das pessoas na constru√ß√£o de id√©ias abstratas sobre jogos que as pessoas podem usar para um aprendizado r√°pido. Quando o computador olha para a matriz de pixels e percebe a chave, a porta e pensa consigo mesmo que provavelmente seria bom pegar a chave e chegar √† porta. Atualmente, n√£o h√° nada pr√≥ximo disso, e tentar chegar l√° √© uma √°rea ativa de pesquisa. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C√°lculos n√£o diferenci√°veis ‚Äã‚Äãem redes neurais.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gostaria de mencionar outra aplica√ß√£o interessante de gradientes de pol√≠tica n√£o relacionados a jogos: ela nos permite projetar e treinar redes neurais usando componentes que executam (ou interagem) com c√°lculos n√£o diferenci√°veis. Esta ideia foi introduzida pela primeira vez em </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1992 por Williams</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . e foi recentemente popularizado em </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">modelos recorrentes de aten√ß√£o visual.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chamado "aten√ß√£o" no contexto de um modelo que processa uma imagem com uma sequ√™ncia de apar√™ncia foveal estreita de baixa resolu√ß√£o, semelhante √† maneira como nosso olho examina objetos com uma vis√£o central em execu√ß√£o. A cada itera√ß√£o, o RNN receber√° um pequeno fragmento da imagem e selecionar√° o local que precisa ser mais analisado. Por exemplo, o RNN pode olhar para a posi√ß√£o (5.30), obter um pequeno fragmento da imagem e decidir olhar para (24, 50) etc. H√° uma se√ß√£o da rede neural que seleciona onde procurar mais e depois a inspeciona. Infelizmente, essa opera√ß√£o n√£o √© diferenci√°vel, porque n√£o sabemos o que aconteceria se lev√°ssemos uma amostra para outro lugar. Em um caso mais geral, considere uma rede neural que possui v√°rias entradas e sa√≠das:</font></font><br><br><img src="https://habrastorage.org/webt/xn/gn/ca/xngncauic38rgmg3bi_srnlevbw.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Observe que a maioria das setas azuis √© diferenci√°vel como de costume, mas algumas transforma√ß√µes de exibi√ß√£o tamb√©m podem incluir uma opera√ß√£o de sele√ß√£o indiferenciada, destacada em vermelho. Podemos simplesmente percorrer as setas azuis na dire√ß√£o oposta, mas a seta vermelha √© uma depend√™ncia pela qual n√£o podemos inverter a propaga√ß√£o do backprop.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pol√≠tica de gradiente para o resgate! Vamos pensar na parte da rede que realiza a amostragem que pode ser representada como uma fun√ß√£o da pol√≠tica estoc√°stica incorporada em uma grande rede neural. Portanto, durante o treinamento, produziremos v√°rios exemplos (indicados pelos ramos abaixo) e, em seguida, incentivaremos amostras que acabam por levar a bons resultados (neste caso, por exemplo, medidos pela perda no final). Em outras palavras, treinaremos os par√¢metros inclu√≠dos nas setas azuis usando o backprop, como de costume, mas os par√¢metros inclu√≠dos na seta vermelha agora ser√£o atualizados independentemente da passagem para tr√°s usando gradientes de pol√≠tica, incentivando amostras que resultam em baixas perdas. Essa ideia tamb√©m foi recentemente bem estruturada.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Estimativa de gradiente usando gr√°ficos de c√°lculo estoc√°sticos.</font></font></a> <br><br><img src="https://habrastorage.org/webt/td/vx/lr/tdvxlrd98jepxgmsvpc5gtewlxs.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Entrada / sa√≠da treinada na mem√≥ria de acesso aleat√≥rio. Voc√™ tamb√©m encontrar√° essa id√©ia em muitos outros artigos. Por exemplo, a </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Neural Turing Machine</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> possui uma fita de mem√≥ria com a qual eles l√™em e escrevem. Para executar uma opera√ß√£o de grava√ß√£o, voc√™ precisa fazer algo como m [i] = x, onde ieex s√£o previstos pela rede neural da RNN. No entanto, n√£o h√° sinal nos dizendo o que aconteceria com a fun√ß√£o de perda se escrev√™ssemos j! = I. Portanto, o NTM pode executar opera√ß√µes leves de leitura e grava√ß√£o. Ele prev√™ a fun√ß√£o de distribui√ß√£o de aten√ß√£o a e, em seguida, executa para todos i: m [i] = a [i] * x. Agora √© diferenci√°vel, mas temos que pagar um pre√ßo computacional alto, classificando todas as c√©lulas.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No entanto, podemos usar gradientes de pol√≠ticas para solucionar teoricamente esse problema, como √© feito no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RL-NTM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Ainda previmos a distribui√ß√£o da aten√ß√£o a, mas, em vez de uma busca exaustiva, selecionamos aleatoriamente os locais para escrever: i = amostra (a); m [i] = x. Durante o treinamento, poder√≠amos fazer isso por um pequeno conjunto de ie, no final, encontrar√≠amos um conjunto que funcionaria melhor do que outros. Uma grande vantagem computacional √© que, durante o teste, voc√™ pode ler / gravar em uma c√©lula. No entanto, como indicado no documento, √© muito dif√≠cil come√ßar a trabalhar com essa estrat√©gia, porque voc√™ precisa passar por muitas op√ß√µes e quase acidentalmente acessar algoritmos de trabalho. Atualmente, os pesquisadores concordam que o PG funciona bem apenas quando existem v√°rias op√ß√µes discretas, quando voc√™ n√£o precisa vasculhar espa√ßos de pesquisa enormes.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No entanto, com a ajuda de gradientes de pol√≠ticas e nos casos em que uma grande quantidade de dados e poder de computa√ß√£o est√° dispon√≠vel, podemos, em princ√≠pio, sonhar muito. Por exemplo, podemos projetar redes neurais que aprendem a interagir com grandes objetos n√£o diferenci√°veis, como compiladores Latex. Por exemplo, para char-rnn gerar c√≥digo Latex pronto, ou um sistema SLAM, ou solucionadores LQR, ou qualquer outra coisa. Ou, por exemplo, a superintelig√™ncia pode querer aprender a interagir com a Internet via TCP / IP (que tamb√©m n√£o √© diferenci√°vel) para acessar as informa√ß√µes necess√°rias para capturar o mundo. Este √© um √≥timo exemplo.</font></font><br><br><h4>  Conclus√µes </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vimos que os gradientes de pol√≠ticas s√£o um poderoso algoritmo geral e, por exemplo, treinamos o agente ATARI Pong a partir de pixels brutos do zero em </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">130 linhas Python</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Em geral, o mesmo algoritmo pode ser usado para treinar agentes para jogos arbitr√°rios e, esperan√ßosamente, um dia podemos us√°-lo para resolver problemas de controle no mundo real. Concluindo, gostaria de acrescentar mais alguns coment√°rios: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sobre o desenvolvimento da IA</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Vimos que o algoritmo funciona por meio da pesquisa de for√ßa bruta, na qual voc√™ primeiro hesita aleatoriamente e precisa trope√ßar em situa√ß√µes √∫teis pelo menos uma vez e, idealmente, com frequ√™ncia, antes que a fun√ß√£o pol√≠tica altere seus par√¢metros. Tamb√©m vimos que uma pessoa aborda essas solu√ß√µes para esses problemas de uma maneira completamente diferente, que se assemelha √† constru√ß√£o r√°pida de um modelo abstrato. Como esses modelos abstratos s√£o muito dif√≠ceis (se n√£o imposs√≠veis) de se imaginar explicitamente, esse tamb√©m √© o motivo pelo qual recentemente houve tanto interesse em modelos generativos e indu√ß√£o de software. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sobre o uso em rob√≥tica.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O algoritmo n√£o se aplica onde √© dif√≠cil obter uma quantidade enorme de pesquisas. Por exemplo, voc√™ pode ter um (ou v√°rios) rob√¥s interagindo com o mundo em tempo real. Isso n√£o √© suficiente para uma aplica√ß√£o ing√™nua do algoritmo. Uma √°rea de trabalho projetada para mitigar esse problema s√£o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">os gradientes determin√≠sticos das pol√≠ticas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Em vez de fazer tentativas reais, essa abordagem obt√©m informa√ß√µes de gradiente de uma segunda rede neural (chamada de cr√≠tica) que modela a fun√ß√£o de avalia√ß√£o. Essa abordagem pode, em princ√≠pio, ser eficaz com a√ß√µes de alta dimens√£o, nas quais a amostragem aleat√≥ria fornece pouca cobertura. Outra abordagem relacionada √© aumentar a rob√≥tica que estamos come√ßando a ver no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Robot Farm</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou talvez at√© em um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tesla S + com piloto autom√°tico.</font></font></a> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> H√° tamb√©m uma linha de trabalho que est√° tentando tornar o processo de pesquisa menos desesperador, adicionando controle adicional. Por exemplo, em muitos casos pr√°ticos, voc√™ pode obter a dire√ß√£o inicial do desenvolvimento diretamente da pessoa. Por exemplo, o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AlphaGo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> primeiro usa o treinamento com um professor para prever apenas a√ß√µes humanas (por exemplo </font><font style="vertical-align: inherit;">, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">controle remoto de rob√¥</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aprendizado</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">otimiza√ß√£o de trajet√≥ria</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pesquisa completa de pol√≠ticas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). E a pol√≠tica resultante √© configurada posteriormente usando o PG para alcan√ßar o objetivo real - vencer o jogo.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em alguns casos, pode haver menos predefini√ß√µes (por exemplo, para </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">controlar remotamente os rob√¥s</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) e existem m√©todos para usar esses dados </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pr√©-est√°gio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Por fim, se as pessoas n√£o fornecerem dados ou configura√ß√µes espec√≠ficas, elas tamb√©m poder√£o ser obtidas em alguns casos atrav√©s de c√°lculos usando m√©todos de otimiza√ß√£o bastante caros, por exemplo, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">otimizando a trajet√≥ria</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> em um modelo din√¢mico conhecido (como F = ma em um simulador f√≠sico) ou em casos quando um modelo local aproximado √© criado (como visto em uma estrutura muito promissora para pesquisa de pol√≠tica gerenciada). </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sobre o uso do PG na pr√°tica.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eu gostaria de falar mais sobre a RNN. Eu acho que pode parecer que as RNNs s√£o m√°gicas e resolvem automaticamente problemas relacionados a seq√º√™ncias arbitr√°rias. A verdade √© que fazer com que esses modelos funcionem pode ser complicado. √â necess√°rio cuidado e experi√™ncia, al√©m de saber quando m√©todos mais simples podem ajud√°-lo a 90%. O mesmo vale para gradientes de pol√≠ticas. Eles n√£o funcionam automaticamente assim: voc√™ precisa ter muitos exemplos, eles podem treinar para sempre, s√£o dif√≠ceis de depurar quando n√£o funcionam. Voc√™ deve sempre tentar atirar de uma pistola pequena antes de pegar a Bazuca. Por exemplo, no caso de treinamento por refor√ßo, o </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">m√©todo de entropia cruzada (CEM)</font></a><font style="vertical-align: inherit;"> deve sempre ser verificado primeiro.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, uma abordagem estoc√°stica simples de "adivinhar e verificar", inspirada na evolu√ß√£o. E se voc√™ insistir em experimentar gradientes de pol√≠ticas para sua tarefa, verifique os truques espec√≠ficos. Comece simples e use uma op√ß√£o PG chamada </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TRPO</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que quase sempre funciona melhor e com mais consist√™ncia do </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que o PG cl√°ssico</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . A id√©ia b√°sica √© evitar atualizar as configura√ß√µes que alteram muito sua pol√≠tica, devido ao uso da dist√¢ncia Kulbak-Leibler entre a pol√≠tica antiga e a nova.</font></font><br><br>  Isso √© tudo!<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espero ter lhe dado uma id√©ia de onde estamos com o Aprendizado por Refor√ßo, quais s√£o os problemas e, se voc√™ quiser ajudar a promover a RL, convido voc√™ a fazer isso no nosso </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenAI Gym</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :) At√© a pr√≥xima!</font></font><br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Andrej Karpathy, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pesquisador, desenvolvedor, diretor do departamento de IA e piloto autom√°tico Tesla </font></font><br><br> <i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Informa√ß√µes adicionais:</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Deep Learning on Fingers </font><font style="vertical-align: inherit;">Course </font><font style="vertical-align: inherit;">2018 </font></font><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://habr.com/en/post/414165/</font></font></a> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Deep Learning on Fingers </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Open Course 2019 </font></font><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https: // habr.com/ru/company/ods/blog/438940/</font></font></a> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Faculdade de F√≠sica da NSU </font></font><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://www.phys.nsu.ru/</font></font></a></i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt439674/">https://habr.com/ru/post/pt439674/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt439662/index.html">An√∫ncio do TypeScript 3.3</a></li>
<li><a href="../pt439664/index.html">Compatibilidade bin√°ria em C ++ e atualiza√ß√µes sem problemas para o Visual Studio 2019</a></li>
<li><a href="../pt439668/index.html">Escalando um boletim t√©cnico para 700 mil assinantes em 300 cidades: a hist√≥ria do Techstars Startup Digest</a></li>
<li><a href="../pt439670/index.html">Sistema AI russo para o diagn√≥stico de c√¢ncer Botkin.AI. Agora no Azure Marketplace</a></li>
<li><a href="../pt439672/index.html">No√ß√µes b√°sicas do PowerShell: Detectando se uma sequ√™ncia termina com um certo caractere</a></li>
<li><a href="../pt439676/index.html">Reagir a integra√ß√£o nativa e C ++ para iOS e Android</a></li>
<li><a href="../pt439678/index.html">Enviar para o desafio F # aplicado</a></li>
<li><a href="../pt439680/index.html">Cerca de 50% dos russos est√£o dispostos a vender seus dados pessoais</a></li>
<li><a href="../pt439682/index.html">Treinamento Cisco 200-125 CCNA v3.0. Cisco Certified Network Specialist (CCNA). Dia 4. Dispositivos de gateway</a></li>
<li><a href="../pt439684/index.html">Inscreva-se no Desafio F # aplicado</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>