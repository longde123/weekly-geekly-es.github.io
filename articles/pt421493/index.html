<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üé° üé∂ üñêüèª An√°lise do tr√°fego de rede de um aplicativo m√≥vel no iOS. Parte 1 - proxies üç≠ üßúüèø üåÉ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="H√° situa√ß√µes em que, ao desenvolver ou testar um aplicativo m√≥vel, torna-se necess√°rio visualizar o tr√°fego de rede do aplicativo. Ainda est√° visualiz...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>An√°lise do tr√°fego de rede de um aplicativo m√≥vel no iOS. Parte 1 - proxies</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421493/"><p><img src="https://habrastorage.org/webt/o6/nl/fw/o6nlfwhw_nzwxjhjdcbp6htqkf8.jpeg"></p><br><p>  H√° situa√ß√µes em que, ao desenvolver ou testar um aplicativo m√≥vel, torna-se necess√°rio visualizar o tr√°fego de rede do aplicativo.  Ainda est√° visualizando o tr√°fego de aplicativos para dispositivos m√≥veis, exibindo-o no console do seu IDE?  Existem ferramentas mais eficazes para esta tarefa, por exemplo, proxies.  Neste artigo, analisaremos os proxies HTTP (S) mais populares, aprenderemos como us√°-los no desenvolvimento do iOS e os compararemos de acordo com v√°rios crit√©rios. </p><br><p>  Al√©m disso, falaremos sobre o uso de proxies no desenvolvimento do iOS, mas muitas coisas tamb√©m s√£o aplic√°veis ‚Äã‚Äãno desenvolvimento do Android. </p><br><p>  Cuidado, sob o corte muitas fotos. </p><a name="habracut"></a><br><p>  As ferramentas para analisar o tr√°fego de rede de um aplicativo m√≥vel podem ser divididas em: </p><br><ol><li>  N√£o requer integra√ß√£o no c√≥digo-fonte do aplicativo em teste - proxy: <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Mitmproxy</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Charles</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Burp suite</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Owasp zap</a> </li></ul></li><li>  Exigindo integra√ß√£o ao c√≥digo-fonte do aplicativo em teste.  Isso inclui principalmente estruturas de depura√ß√£o: <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Wormholy</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Netfox</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Dotzu</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Flex</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Depurador Pony</a> </li></ul></li></ol><br><p>  Esta √© a primeira parte do artigo em que consideraremos o uso de proxies e os compararemos de acordo com v√°rios crit√©rios.  Na segunda parte do artigo, examinaremos minuciosamente as estruturas para depura√ß√£o. </p><br><h2 id="mitmproxy">  Mitmproxy </h2><br><p><img src="https://habrastorage.org/webt/6s/x4/yx/6sx4yxmpa89qi5k_dizxgwkwda8.png"></p><br><p>  O Mitmproxy √© um proxy HTTP (S) gratuito e de c√≥digo aberto (~ 12.000 estrelas no github), que consiste no pr√≥prio Mitmproxy, um utilit√°rio de console para proxy de tr√°fego, mitmdump, um utilit√°rio de console adicional que apresenta funcionalidade semelhante ao tcpdump, mas para HTTP (S) tr√°fego, bem como mitmweb, a interface da web para o Mitmproxy. </p><br><p>  Voc√™ pode instalar o Mitmproxy usando o Homebrew: </p><br><p><code>brew install mitmproxy</code> </p> <br><p>  Ou fa√ßa o download da vers√£o desejada na p√°gina de lan√ßamento do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">site</a> oficial. </p><br><p>  Ap√≥s a instala√ß√£o bem-sucedida, para analisar o tr√°fego HTTP de um simulador ou dispositivo, voc√™ precisa especificar um proxy nas configura√ß√µes de rede. </p><br><p>  Para o simulador, voc√™ precisa ativar os proxies HTTP e HTTPS nas configura√ß√µes de rede do Mac OS (Prefer√™ncias do sistema -&gt; Rede -&gt; Avan√ßado -&gt; Proxies): </p><br><p><img src="https://habrastorage.org/webt/z5/1r/qb/z51rqb8cffwbfj6md_rq_0dvzbo.png"></p><br><p>  Um pequeno <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">script bash</a> para ativa√ß√£o / desativa√ß√£o r√°pida de um proxy nas configura√ß√µes de rede do Wi-Fi em um Mac.  (Depois que registramos a porta IP e proxy nas configura√ß√µes e usamos o comando <code>proxy on</code> ou <code>proxy off</code> no console). </p><br><p>  Para interceptar o tr√°fego de um dispositivo real, √© necess√°rio especificar o proxy nas configura√ß√µes da rede iOS, enquanto o endere√ßo IP do computador executando o Mitmproxy √© definido como o endere√ßo IP do proxy e a porta 8080. (O endere√ßo IP do computador pode ser visualizado em Configura√ß√µes&gt; Rede) </p><br><p><img src="https://habrastorage.org/webt/hp/pq/7m/hppq7mqcuffu47f67lqkqmhl04w.png"></p><br><p>  Nesse est√°gio, j√° podemos interceptar o tr√°fego HTTP, mas para interceptar o tr√°fego HTTPS, √© necess√°rio instalar os certificados Mitmproxy no simulador / dispositivo. <br>  Para fazer isso, no simulador, fa√ßa o seguinte (para um dispositivo real, as etapas s√£o semelhantes): </p><br><ul><li>  Verifique se o Mitmproxy est√° em execu√ß√£o e se o proxy est√° ativado e registrado nas configura√ß√µes de rede (para o simulador - configura√ß√µes do macOS, para o dispositivo - configura√ß√µes do iOS), conforme descrito acima.  Agora v√° para o navegador em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">mitm.it</a> e clique no √≠cone Apple para baixar o certificado Mitmproxy.  Um alerta ser√° exibido com a mensagem de que este site est√° tentando abrir as configura√ß√µes do iOS: clique em Permitir. </li></ul><br><p><img src="https://habrastorage.org/webt/np/uc/xq/npucxqnvc-k-wporeihhr7gvwvu.png"></p><br><ul><li>  Em seguida, instale o certificado Mitmproxy. </li></ul><br><p><img src="https://habrastorage.org/webt/ll/m5/x9/llm5x9dipaezxkmadswh-d-fz1m.png"></p><br><ul><li>  E o √∫ltimo toque - para iOS vers√£o 10.3 e superior, voc√™ deve habilitar o acesso total ao certificado raiz do Mitmproxy.  Para fazer isso, v√° para Configura√ß√µes&gt; Geral&gt; Sobre&gt; Configura√ß√µes de confian√ßa do certificado e ative o acesso total ao certificado Mitmproxy. </li></ul><br><p><img src="https://habrastorage.org/webt/t4/bx/pw/t4bxpwt1b4uqhplj8nlaygmv4hi.png"></p><br><p>  Agora podemos analisar o tr√°fego HTTPS no simulador.  Resta acrescentar um pequeno esclarecimento: o certificado √© instalado para um simulador espec√≠fico, ou seja, se o fiz√©ssemos apenas no simulador do iPhone X, no simulador do iPhone 8, precisamos fazer o mesmo para que o proxy intercepte o tr√°fego HTTPS.  Para interceptar o tr√°fego HTTPS de um dispositivo real, todas as etapas s√£o semelhantes, o principal √© que ele esteja conectado √† mesma rede local que um computador com Mitmproxy. </p><br><p>  Depois disso, voc√™ pode executar mitmproxy no console <del>  e me sinto como um hacker </del>  ou cliente da web mitmweb. </p><br><p>  O cliente do console nos encontra com uma interface de tubo (para os amantes da GUI, existe at√© suporte para mouse), onde todas as solicita√ß√µes interceptadas s√£o exibidas. </p><br><p><img src="https://habrastorage.org/webt/ev/9w/al/ev9walbksj5rs9-xyfgro7c-irw.png"></p><br><p>  Voc√™ pode visualizar informa√ß√µes detalhadas para cada solicita√ß√£o (par√¢metros, cabe√ßalhos, resposta, etc.) </p><br><p><img src="https://habrastorage.org/webt/4g/xe/nd/4gxendtfo1pmlrbyesmjwkkck5a.png"></p><br><p>  O Mitmproxy possui um poderoso sistema de filtragem de consultas com suporte para express√µes regulares.  Voc√™ pode filtrar solicita√ß√µes por c√≥digo, corpo de solicita√ß√£o / resposta, cabe√ßalhos, dom√≠nio etc.  Ligue para a ajuda sobre os atalhos dispon√≠veis e express√µes de filtro clicando em <code>?</code>  .  Por exemplo, para limpar a lista de consultas da sess√£o atual, basta pressionar <code>z</code> , para filtrar a lista de consultas por URL, na qual existe a palavra "ma√ß√£", √© necess√°rio pressionar <code>f</code> e escrever uma express√£o de filtro por URL <code>~u apple</code> , o que exige uma express√£o regular. </p><br><p><img src="https://habrastorage.org/webt/rx/ta/xl/rxtaxlzj7_0g8ulpleurl9jdgma.png"></p><br><p>  Os f√£s do Vim tamb√©m ficar√£o satisfeitos com o suporte ao hjkl.  Quase nos esquecemos de um atalho muito importante <code>q</code> - ele funciona como um bot√£o de retorno ao se mover entre telas, e na tela principal com uma lista de consultas quando voc√™ clica nesse atalho, o Mitmproxy se oferece para sair do programa. <br>  Apesar da interface do console, o uso do Mitmproxy √© um prazer, gra√ßas a atalhos convenientes e controles intuitivos simples.  Abaixo est√° uma pequena tabela com os principais atalhos. </p><br><table><thead><tr><th>  Atalho </th><th>  Descri√ß√£o do produto </th></tr></thead><tbody><tr><td>  ? </td><td>  Ajuda </td></tr><tr><td>  z </td><td>  Limpar lista de sess√µes atuais </td></tr><tr><td>  f </td><td>  Filtragem de Sess√£o </td></tr><tr><td>  q </td><td>  Voltar (sair na tela principal) </td></tr><tr><td>  d </td><td>  Remover solicita√ß√£o da lista de sess√µes </td></tr><tr><td>  r </td><td>  Repetir solicita√ß√£o </td></tr><tr><td>  e </td><td>  Salvar solicita√ß√£o no arquivo </td></tr><tr><td>  g </td><td>  Lista de sess√µes principais </td></tr><tr><td>  G </td><td>  No final da lista de sess√µes </td></tr></tbody></table><br><p>  Se voc√™ ainda √© um oponente ardente do console e reconhece apenas os aplicativos da GUI, ent√£o a mitmweb est√° com pressa para nos ajudar, vamos lan√ß√°-lo por enquanto tamb√©m no console, depois podemos fazer um atalho para a √°rea de trabalho. </p><br><p><img src="https://habrastorage.org/webt/ez/wd/s1/ezwds15jyp-by5b3ic_d-hbo_3g.png"></p><br><p>  O web client ainda est√° em teste beta e cont√©m apenas a funcionalidade b√°sica de mitmproxy (suficiente para 95% das tarefas), que √© gradualmente complementada com novos recursos a cada nova vers√£o, mas, apesar disso, agora pode ser usada e √© muito conveniente.  Alguns atalhos da vers√£o do console tamb√©m funcionam aqui, por exemplo, para limpar a lista de solicita√ß√µes da sess√£o atual, basta pressionar <code>z</code> .  Voc√™ tamb√©m pode filtrar solicita√ß√µes interceptadas atrav√©s do campo "Pesquisar", como fizemos no aplicativo de console quando aplicamos o filtro de <code>~u apple</code> . </p><br><p><img src="https://habrastorage.org/webt/sr/4z/nt/sr4zntpy7kccnhr_-thxh4-t_uy.png"></p><br><p>  O Mitmproxy reivindica suporte para o padr√£o Websocket, mas infelizmente a exibi√ß√£o dos quadros Websocket na interface do usu√°rio ainda n√£o foi implementada e, de acordo com os desenvolvedores, a funcionalidade Websocket est√° dispon√≠vel apenas para o utilit√°rio mitmdump. </p><br><h2 id="charles">  Charles </h2><br><p><img src="https://habrastorage.org/webt/w0/hu/hq/w0huhqhik2xqsosv682wnqzdski.png"></p><br><p>  Charles √© talvez o proxy HTTP (S) mais popular para MacOS, sua √∫nica desvantagem √© que ele √© pago, no momento da reda√ß√£o deste artigo, a licen√ßa custa US $ 50.  No entanto, existe uma vers√£o de avalia√ß√£o - ela funciona por 30 minutos, o aplicativo precisa ser reiniciado e todo o hist√≥rico de consultas √© perdido.  H√° tamb√©m atrasos de inicializa√ß√£o de cinco segundos. </p><br><p>  Ap√≥s a instala√ß√£o e a primeira inicializa√ß√£o, Charles solicitar√° que voc√™ forne√ßa o acesso para configurar automaticamente o proxy do sistema, selecione "Conceder privil√©gios" ou altere as configura√ß√µes do proxy do sistema todas as vezes manualmente.  Portanto, Charles alterar√° e ativar√° as configura√ß√µes de proxy do sistema quando estiver em execu√ß√£o - isso √© conveniente ao depurar no simulador, mas em um dispositivo real, voc√™ precisar√° definir manualmente as configura√ß√µes do servidor proxy para a rede, pois o servidor proxy especifica o endere√ßo IP do computador executando Charles, como porto - 8888. </p><br><p>  Nesta fase, podemos apenas visualizar o tr√°fego HTTP, para analisar o tr√°fego HTTPS de um simulador ou de um dispositivo real, precisamos instalar um certificado Charles nele, o procedimento √© semelhante √† instala√ß√£o de um certificado Mitmproxy.  Verifique se o proxy est√° sendo executado e ativado nas configura√ß√µes de rede do iOS (para um dispositivo real) ou nas configura√ß√µes de rede do macOS (para um simulador).  Em seguida, iremos ao simulador / dispositivo no navegador em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">chls.pro/ssl</a> . Um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">alerta</a> ser√° exibido com a mensagem de que este site est√° tentando abrir as configura√ß√µes do iOS: selecione Permitir.  Em seguida, selecione Instalar para instalar o certificado.  Ap√≥s instalar o certificado para iOS vers√£o 10.3 e superior, voc√™ deve ativar o acesso completo ao certificado raiz Charles.  Para fazer isso, v√° para Configura√ß√µes&gt; Geral&gt; Sobre&gt; Configura√ß√µes de confian√ßa do certificado e ative o acesso total ao certificado Charles. </p><br><p><img src="https://habrastorage.org/webt/ue/vs/kw/uevskwgkqccit0f8xylhu5c9di8.png"></p><br><p>  Por fim, voc√™ precisa configurar o proxy SSL no Charles, por padr√£o, n√£o descriptografa o tr√°fego HTTPS, mesmo se voc√™ instalou todos os certificados necess√°rios.  Para ativar o proxy SSL, v√° para Proxy&gt; SSL Proxying Settings e ative Proxy SSL, se estiver desativado, temos duas op√ß√µes - ativar o proxy SSL para todos os dom√≠nios ou apenas para dom√≠nios espec√≠ficos.  Para habilitar o proxy SSL para todos os dom√≠nios, voc√™ precisa adicionar um local curinga: clique no bot√£o Adicionar e especifique <code>*</code> em todos os campos, para que as configura√ß√µes de SSL sejam assim. </p><br><p><img src="https://habrastorage.org/webt/oz/pm/0-/ozpm0-3wqfnzy7pdrntt0_zud7g.png"></p><br><p>  Para habilitar o proxy SSl apenas para dom√≠nios espec√≠ficos, voc√™ deve adicion√°-los √† lista e verificar se o local do curinga est√° desabilitado.  Nesse caso, Charles ainda interceptar√° todo o tr√°fego, mas as solicita√ß√µes HTTPS para dom√≠nios que n√£o est√£o na lista n√£o ser√£o descriptografadas. </p><br><p>  Ao usar Charles, √© conveniente usar filtros de intercepta√ß√£o de tr√°fego, que podem ser configurados no menu Proxy&gt; Configura√ß√µes de grava√ß√£o: voc√™ pode especificar o protocolo, URL, porta. </p><br><p><img src="https://habrastorage.org/webt/tn/0g/u1/tn0gu1oxzekxkhhiu1dvjryfsb0.png"></p><br><p>  Agora temos a capacidade de visualizar o tr√°fego HTTPS. </p><br><p><img src="https://habrastorage.org/webt/id/4e/7m/id4e7mvkrp3jhioecejc4fpeb0w.png"></p><br><p>  Charles tamb√©m suporta o protocolo Websocket e exibe mensagens no estilo do iMessage, parece conveniente. </p><br><p><img src="https://habrastorage.org/webt/na/zj/2d/nazj2depjv-5syvqdksal4o-w70.png"></p><br><p>  O primeiro proxy desse tipo, Charles para iOS, merece men√ß√£o especial - a vers√£o m√≥vel de Charles, o pre√ßo na App Store no momento em que este artigo foi escrito √© de US $ 9.  O aplicativo cont√©m a funcionalidade b√°sica da vers√£o da √°rea de trabalho: proxy do tr√°fego HTTP (S), exibi√ß√£o do conte√∫do de solicita√ß√µes / respostas e configura√ß√£o autom√°tica conveniente das configura√ß√µes de proxy para uma rede Wi-Fi. </p><br><p><img src="https://habrastorage.org/webt/f5/fj/pf/f5fjpfgfyd7egnkrxaft3q1bfbg.png"></p><br><h2 id="burp-suite-community-edition">  Burp Suite (Community Edition) </h2><br><p><img src="https://habrastorage.org/webt/oc/5v/ee/oc5veeejxf4avf8cqxx76rduzxc.jpeg"></p><br><p>  O Burp Suite √© uma faca su√≠√ßa de criminosos e hackers, contendo uma quantidade indecente de ferramentas e funcionalidades.  Um dos m√≥dulos do Burp Suite √© um proxy, que usaremos para analisar o tr√°fego HTTP (S).  Existem duas vers√µes do aplicativo: Professional e Community Edition.  A vers√£o da comunidade √© gratuita, n√£o possui um scanner de vulnerabilidades e existe um limite no n√∫mero de solicita√ß√µes por unidade de tempo, mas, apesar disso, a vers√£o gratuita do aplicativo √© uma ferramenta de teste completa. </p><br><p>  Ap√≥s iniciar o aplicativo, voc√™ precisa adicionar e ativar o proxy acessando Proxy&gt; Op√ß√µes. </p><br><p><img src="https://habrastorage.org/webt/4b/du/pa/4bdupa1_viddbv4whpishs0tbdy.png"></p><br><p>  Em seguida, voc√™ precisa garantir que o interceptador de solicita√ß√£o de intercepta√ß√£o esteja desativado; caso contr√°rio, ele interceptar√° as solicita√ß√µes e as manter√° at√© voc√™ dizer o que fazer com essa solicita√ß√£o - cancele ou encaminhe-o ao servidor.  Portanto, desligue-o, agora n√£o precisamos dele. </p><br><p><img src="https://habrastorage.org/webt/p9/5w/i5/p95wi5sujsos-mmqxniwkliohsq.png"></p><br><p>  Em seguida, voc√™ precisa instalar o certificado Burp Suite no simulador / dispositivo; esse procedimento j√° deve ser familiar para n√≥s ap√≥s a instala√ß√£o dos certificados Mitmproxy e Charles.  Iniciamos o Burp Suite e n√£o esquecemos de ativar o proxy nas configura√ß√µes de rede do MacOS para o simulador ou no iOS para o dispositivo real (consulte a se√ß√£o Mitmproxy para saber como fazer isso), especifique o endere√ßo IP do computador que est√° executando o Burp Suite como servidor proxy, como a porta - 8080. Ent√£o vamos ao navegador no simulador e digite o endere√ßo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http: // burp</a> .  Em seguida, clique no bot√£o no site "Certificado CA" e fa√ßa o download do certificado. </p><br><p><img src="https://habrastorage.org/webt/ks/28/fc/ks28fcpuxf8iig_uaqfzg0ojboe.png"></p><br><p>  Em seguida, instale o certificado.  Depois de instalar o certificado para iOS vers√£o 10.3 e superior, voc√™ deve habilitar o acesso total ao certificado raiz do Burp Suite.  Para fazer isso, v√° para Configura√ß√µes&gt; Geral&gt; Sobre&gt; Configura√ß√µes de confian√ßa do certificado e ative o acesso total ao certificado Burp Suite. </p><br><p><img src="https://habrastorage.org/webt/v6/on/pc/v6onpcizqsfe13g508btt_dofhm.png"></p><br><p>  Acessando a guia Proxy -&gt; Hist√≥rico HTTP, √© poss√≠vel visualizar o tr√°fego HTTP (S) de um aplicativo m√≥vel.  Vale ressaltar que a desvantagem aqui √© a falta de formata√ß√£o JSON no corpo da solicita√ß√£o / resposta. </p><br><p><img src="https://habrastorage.org/webt/-s/dw/qa/-sdwqaag2hg3vl18quhyj5t_rks.png"></p><br><p>  O problema com a formata√ß√£o JSON pode ser resolvido instalando o plug-in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">JSON Beautifier</a> .  Para instalar, v√° para a guia Extender&gt; BApp Store, localize o JSON Beautifier na lista de plug-ins e clique em instalar. </p><br><p><img src="https://habrastorage.org/webt/yy/qy/j9/yyqyj9k2xw5lw_iicucpmkl5mkq.png"></p><br><p>  Agora h√° uma guia JSON Beautifier adicional com o lindo JSON. </p><br><p><img src="https://habrastorage.org/webt/ov/ef/-d/ovef-dcb03s1alol8ftnuxk8gio.png"></p><br><p>  O Burp Suite suporta o protocolo Websocket.  As mensagens do Websocket podem ser encontradas na guia especial Proxy&gt; Hist√≥rico do WebSockets. </p><br><p><img src="https://habrastorage.org/webt/f3/dd/f6/f3ddf6qoeyyrvhl4africgba3dq.png"></p><br><h2 id="owasp-zap">  OWASP ZAP </h2><br><p><img src="https://habrastorage.org/webt/qk/er/of/qkerofsyh6pdb3tvzo7i5kvnz0m.jpeg"></p><br><p>  Owasp ZAP √© uma cria√ß√£o da comunidade mundialmente famosa de seguran√ßa cibern√©tica Owasp, al√©m disso, o proxy √© de c√≥digo aberto.  O Owasp ZAP √© frequentemente comparado ao Burp Suite, mas o √∫ltimo √© de popularidade inferior.  O Owasp ZAP √© totalmente gratuito, n√£o h√° vers√µes PRO em compara√ß√£o com o Burp Suite. </p><br><p>  Depois de iniciar o aplicativo, voc√™ precisa verificar as configura√ß√µes de proxy Prefer√™ncias&gt; Proxies Locais, as configura√ß√µes padr√£o devem ter esta apar√™ncia. </p><br><p><img src="https://habrastorage.org/webt/zf/fw/2m/zffw2mzk8ut9ewbx97lowp4rzky.png"></p><br><p>  Em seguida, v√° para Prefer√™ncias&gt; Certificados SSL din√¢micos para exportar o certificado SSL.  Clique no bot√£o Salvar e salve o certificado, por exemplo, na √°rea de trabalho. </p><br><p><img src="https://habrastorage.org/webt/fu/jx/xj/fujxxj5oamjqkvitcmsykkxy8oy.png"></p><br><p>  Em seguida, basta arrastar o arquivo de certificado para o simulador e uma janela √© aberta, oferecendo a instala√ß√£o do certificado, n√≥s concordamos e instalamos.  Depois de instalar o certificado para iOS vers√£o 10.3 e superior, voc√™ deve habilitar o acesso total ao certificado raiz OWASP ZAP.  Para fazer isso, v√° para Configura√ß√µes&gt; Geral&gt; Sobre&gt; Configura√ß√µes de confian√ßa do certificado e ative o acesso total ao certificado ZAP OWASP. </p><br><p><img src="https://habrastorage.org/webt/4v/zv/eh/4vzveheku3uhmvagodbkewduifg.png"></p><br><p>  Agora temos a capacidade de visualizar o tr√°fego HTTPS.  O JSON, infelizmente, n√£o possui uma formata√ß√£o bonita aqui e, at√© o momento, n√£o conseguimos corrigir essa situa√ß√£o; em casos extremos, voc√™ pode usar um formatador JSON de terceiros, por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">este</a> . </p><br><p><img src="https://habrastorage.org/webt/4g/ux/jd/4guxjdtpkb3xuo-tibk7u6hr5-8.png"></p><br><p>  OWASP ZAP suporta o protocolo Websocket.  As mensagens do Websocket podem ser encontradas em uma guia especial WebSockets, tamb√©m √© conveniente selecionar o "canal" para filtrar por dom√≠nio. </p><br><p><img src="https://habrastorage.org/webt/tu/uq/9n/tuuq9ntpdwaoykwrktzfjelij08.png"></p><br><h2 id="ssl-pinning">  Fixa√ß√£o SSL </h2><br><p>  Se a pinagem de SSL estiver implementada em seu aplicativo, voc√™ n√£o ver√° o tr√°fego de aplicativos em proxy, pois o proxy usa seu pr√≥prio certificado para SSL; nesse caso, existem 4 op√ß√µes: </p><br><ol><li>  Desative temporariamente a Fixa√ß√£o SSL ao depurar solicita√ß√µes de rede usando um proxy. </li><li>  Adicione um certificado / chave p√∫blica de proxy aos certificados / chaves depurados para compila√ß√µes de depura√ß√£o. </li><li>  Use o certificado do servidor para o proxy em vez de seu pr√≥prio certificado gerado por ele. </li><li>  Em vez de usar um proxy externo, use uma estrutura de depura√ß√£o (a lista de estruturas √© indicada no in√≠cio do artigo), que interceptar√° e mostrar√° solicita√ß√µes e respostas diretamente no pr√≥prio aplicativo, mas isso requer integra√ß√£o no c√≥digo-fonte do aplicativo existente, mais sobre essas ferramentas no pr√≥ximo artigo. </li></ol><br><h2 id="itogi">  Sum√°rio </h2><br><p>  Vamos come√ßar com Charles.  Talvez o melhor proxy para quem deseja que tudo funcione imediatamente e seja o mais amig√°vel poss√≠vel, embora Charles possa surpreender o usu√°rio em alguns momentos, a funcionalidade do proxy √© muito extensa, mas tamb√©m possui a interface mais bonita e nativa para o macOS descrita no artigo proxy.  Se voc√™ n√£o se importa em gastar US $ 50,00 por esse instrumento, a escolha √© sua. </p><br><p>  Vamos para o Burp Suite.  A ferramenta mais poderosa, de acordo com uma certa funcionalidade e at√© com facilidade de uso, em alguns casos d√° facilmente chances a Charles, al√©m de haver um sistema para expandir a funcionalidade na forma de plug-ins.  O Burp Suite h√° muito se estabeleceu como uma ferramenta muito confi√°vel e precisa nas m√£os certas.  Se voc√™ n√£o tiver a funcionalidade do seu proxy atual, recomendamos que voc√™ preste aten√ß√£o a esta inst√¢ncia. </p><br><p>  Agora √© a vez do Mitmproxy - um proxy jovem e promissor, ganhando popularidade ativamente, que est√° sendo desenvolvido pela comunidade Open Source.  O mais controverso dos proxies que vimos, mas ao mesmo tempo n√£o menos interessante.  O Mitmproxy se destaca de seus concorrentes por sua interface do usu√°rio insanamente conveniente, simples e funcional.  Tamb√©m √© poss√≠vel usar a interface da web do Mitmweb, mas agora est√° em teste beta devido ao qual √© poss√≠vel ser raro, mas erros aparecem, n√£o h√° parte da funcionalidade avan√ßada do Mitmproxy (ela est√° sendo conclu√≠da gradualmente) e tamb√©m √© um pouco inferior em conveni√™ncia a concorrentes mais nativos.  O suporte ao protocolo Websocket tamb√©m foi decepcionante, por assim dizer, mas n√£o h√° exibi√ß√£o na interface do usu√°rio ou simplesmente n√£o aprendemos como prepar√°-lo, porque n√£o conseguimos que o Mitmproxy exibisse mensagens do Websocket, embora n√£o tenhamos problemas com outros proxies. </p><br><p>  E o √∫ltimo da lista, mas n√£o menos interessante foi o Owasp ZAP.  Das vantagens, existe um sistema de plug-in expans√≠vel (subjetivamente, seu n√∫mero √© menor que o do Burp Suite), mas infelizmente n√£o conseguimos configurar uma bela exibi√ß√£o JSON no corpo da solicita√ß√£o / resposta, que √© um crit√©rio bastante cr√≠tico na escolha de um proxy para o desenvolvimento m√≥vel.  No entanto, o Owasp ZAP possui um sistema avan√ßado para testar o tr√°fego do Websocket, bem como o grande nome dos desenvolvedores da comunidade Owasp atr√°s de mim, ent√£o eu n√£o o descartaria e tinha em mente casos raros e complexos. </p><br><p>  Abaixo est√° uma tabela de resumo subjetiva dos proxies que analisamos. </p><br><table><thead><tr><th>  crit√©rio / proxy </th><th>  Mitmproxy </th><th>  Charles </th><th>  Burpsuite (CE) </th><th>  Owasp zap </th></tr></thead><tbody><tr><td>  Formata√ß√£o JSON </td><td>  + </td><td>  + </td><td>  + </td><td>  - </td></tr><tr><td>  Editando e repetindo consultas </td><td>  + </td><td>  + </td><td>  + </td><td>  + </td></tr><tr><td>  Suporte para Websocket </td><td>  - </td><td>  + </td><td>  + </td><td>  + </td></tr><tr><td>  Software livre </td><td>  + </td><td>  - </td><td>  + </td><td>  + </td></tr></tbody></table><br><p>  Terminaremos aqui, esperamos que o artigo seja √∫til, teremos o maior prazer em comentar e se voc√™ compartilhar sua experi√™ncia no campo de teste e monitoramento do tr√°fego de aplicativos m√≥veis. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt421493/">https://habr.com/ru/post/pt421493/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt421481/index.html">Microfones, capturas de tela e v√≠deo local: como o SDK da Web Voximplant controla a m√≠dia em um navegador</a></li>
<li><a href="../pt421485/index.html">Aviso importante para usu√°rios do Gitlab Pages</a></li>
<li><a href="../pt421487/index.html">Como fortalecer o suporte t√©cnico - 6 maneiras secretas</a></li>
<li><a href="../pt421489/index.html">Grunhir, mas dar</a></li>
<li><a href="../pt421491/index.html">Como escrever um jogo para um computador no qual n√£o h√° dispositivos de entrada e sa√≠da</a></li>
<li><a href="../pt421495/index.html">Bem-vindo √† era do niilismo da privacidade</a></li>
<li><a href="../pt421497/index.html">Quando voc√™ n√£o precisa usar algoritmos do STL</a></li>
<li><a href="../pt421499/index.html">Estudo da probabilidade estat√≠stica de um valor de bit em um bitcoin n√£o-co</a></li>
<li><a href="../pt421501/index.html">O Hacker encontrou uma maneira de rastrear visitantes de sites concorrentes</a></li>
<li><a href="../pt421503/index.html">Como escrever instru√ß√µes para entender</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>