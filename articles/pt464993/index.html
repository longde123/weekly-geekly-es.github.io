<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêí üîÆ üíáüèª Construindo um pacote RPM para o Rosa Linux na pr√°tica üï∫üèº ü§¨ üë©üèΩ‚Äçü§ù‚Äçüë®üèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Se voc√™ usa o sistema operacional Linux h√° muito tempo e at√© conhece um pouco de programa√ß√£o, mais cedo ou mais tarde poder√° ser necess√°rio compilar o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Construindo um pacote RPM para o Rosa Linux na pr√°tica</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/464993/"><p>  Se voc√™ usa o sistema operacional Linux h√° muito tempo e at√© conhece um pouco de programa√ß√£o, mais cedo ou mais tarde poder√° ser necess√°rio compilar o programa a partir do c√≥digo-fonte.  Talvez o programa desejado n√£o esteja nos reposit√≥rios de distribui√ß√£o.  Ou o programa possui uma vers√£o antiga nesses reposit√≥rios e voc√™ precisa da vers√£o mais recente.  Ou talvez voc√™ tenha criado um novo programa e queira compartilh√°-lo com outros usu√°rios. <br></p><br><p>  Obviamente, voc√™ pode instalar o programa de acordo com as instru√ß√µes que acompanham o c√≥digo-fonte.  Mas voc√™ precisar√° gerenciar manualmente os arquivos de programa e monitorar suas depend√™ncias.  √â muito melhor criar um pacote com o programa e usar o gerenciador de aplicativos embutido no sistema operacional. <br></p><br><p>  Espero que este artigo ajude voc√™ a descobrir rapidamente como criar um pacote RPM para o <em>Rosa Linux</em> ou para outra distribui√ß√£o que use o gerenciador de pacotes RPM (Mandriva, RedHat).  Ou pelo menos me diga onde procurar informa√ß√µes. <br></p><br><p>  Aqui vou mostrar como criar pacotes RPM no meu computador local, usando um exemplo simples.  Vamos construir o programa <em>xkb-switch</em> no <em>sistema</em> operacional <em>Rosa Linux</em> .  N√≥s pegaremos o c√≥digo fonte do programa no <em>GitHub</em> . <br></p><br><br><a name="habracut"></a><br><br><div class="spoiler">  <b class="spoiler_title">O artigo est√° dividido em v√°rias partes curtas, de modo que o √≠ndice esteja embaixo do spoiler</b> <div class="spoiler_text"><h2>  Sum√°rio </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Um pouco sobre o Rosa Linux</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Um pouco sobre o xkb-switch</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Configurando, finalizando, verificando o programa</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Verificando o c√≥digo fonte sem o seu perfil no GitHub</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Verifica√ß√£o ao salvar o projeto no seu perfil do GitHub</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Criando patches</a> </li></ul><br></li></ul><br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Prepare o "local de trabalho" para criar um pacote</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Vamos come√ßar a criar um arquivo de especifica√ß√£o</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Um pouco sobre a sintaxe do arquivo de especifica√ß√£o</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cabe√ßalho do arquivo Spec</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Prepara√ß√£o da fonte</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Compila√ß√£o</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Instala√ß√£o</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Embalagem de arquivo</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O que √© rpmlint</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Tipos de pacotes RPM para Rosa Linux</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Nosso resultado</a> </li></ul><br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Se voc√™ precisar dividir o pacote em partes</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Adicione algumas macros</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Mude um pouco o t√≠tulo</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Definir pacotes de biblioteca</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Definir arquivos para pacotes</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Solu√ß√£o de problemas adicionais</a> </li></ul><br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Conclus√£o</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Equipas principais</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Comandos √∫teis para construir um pacote</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Verificando o pacote pronto</a> </li></ul><br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Links √∫teis (fontes principais)</a> </li></ul><br></div></div><br><br><a name="foreword"></a><br><h2>  Um pouco sobre o Rosa Linux </h2><br><p>  <em>Rosa Linux</em> √© uma distribui√ß√£o criada e suportada por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">desenvolvedores russos</a> .  √â baseado no <em>Mandriva</em> , mas com alguns recursos.  Estou usando a vers√£o de 32 bits do <em>Rosa Fresh R8</em> , lan√ßada em 2014.  Agora, a vers√£o <em>R8</em> n√£o √© mais suportada pelos desenvolvedores (os reposit√≥rios n√£o s√£o atualizados), mas funciona bem no meu laptop, portanto, n√£o quero instalar uma nova vers√£o. <br></p><br><p> <em>Rosa Fresh R8</em> Usa a √°rea de trabalho do <em>KDE4</em> .  Todas as vers√µes do pacote de distribui√ß√£o usam gerenciadores de <code>rpm</code> e <code>urpm</code> para gerenciar pacotes com aplicativos, e os comandos correspondentes s√£o <code>rpm</code> , <code>urpmi</code> , <code>urpme</code> , <code>urpmq</code> , <code>urpmf</code> . <br></p><br><p>  Os princ√≠pios de cria√ß√£o de pacotes de software geralmente raramente s√£o alterados na mesma fam√≠lia de distribui√ß√£o Linux.  Portanto, o que √© descrito neste artigo deve funcionar em todas as vers√µes das distribui√ß√µes <em>Rosa</em> . <br></p><br><p>  Construir pacotes no Rosa Linux √© um pouco mais simples do que em outras distribui√ß√µes baseadas em <em>RPM</em> .  Alguns pontos s√£o automatizados e n√£o precisam ser configurados. <br></p><br><br><a name="foreword-xkb-switch"></a><br><h2>  Um pouco sobre o xkb-switch </h2><br><p>  Gostei da ideia de usar o plugin para o editor de texto Vim - <em>xkbswitch</em> , sobre o qual existe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">um artigo sobre Habr√©</a> .  Ele muda automaticamente o layout do teclado para ingl√™s quando voc√™ sai do modo de entrada e vice-versa - para aquele em que o texto foi inserido pela √∫ltima vez - se voc√™ entrar no modo de entrada novamente.  Para que este plug-in funcione, voc√™ precisa do programa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">xkb-switch</a> , que permite alternar o layout do teclado na linha de comando e nos plug-ins do editor <em>Vim</em> .  Este programa n√£o estava nos reposit√≥rios <em>Rosa Linux R8</em> (e provavelmente ningu√©m o adicionar√°, porque a distribui√ß√£o j√° √© antiga e o programa <em>xkb-switch</em> n√£o <em>√©</em> muito popular). <br></p><br><br><a name="test_program"></a><br><h2>  Configurando, finalizando, verificando o programa </h2><br><p>  Freq√ºentemente, √© necess√°rio configurar a compila√ß√£o do programa para funcionar corretamente em uma distribui√ß√£o espec√≠fica ou mesmo para um sistema espec√≠fico.  Acontece que um programa precisa ser constru√≠do com outras op√ß√µes ou com o suporte de algum driver especial.  Ou talvez voc√™ queira corrigir erros no c√≥digo do programa ou apenas verificar se funciona.  Para fazer isso, √© melhor copiar o c√≥digo-fonte para o seu computador antes de criar o pacote RPM, tente compil√°-lo e verifique como o programa compilado funciona. <br></p><br><p>  Se voc√™ tiver certeza de que n√£o precisar√° modificar os arquivos do projeto, poder√° usar o c√≥digo-fonte original do site do projeto e prosseguir imediatamente para compilar o pacote.  Mas se voc√™ precisar alterar as configura√ß√µes de compila√ß√£o, geralmente √© muito mais f√°cil alterar o arquivo na pasta de origem (o chamado <em>makefile</em> ) do que lidar com as op√ß√µes para os comandos de compila√ß√£o e o dispositivo macro interno para o arquivo de especifica√ß√£o. <br></p><br><br><a name="test_program-local"></a><br><h3>  Verificando o c√≥digo fonte sem o seu perfil no GitHub </h3><br><p>  Se voc√™ decidir trabalhar com o c√≥digo-fonte ou as configura√ß√µes de compila√ß√£o do projeto, mas n√£o tiver seu pr√≥prio perfil no GitHub ou n√£o quiser us√°-lo, basta baixar e descompactar o c√≥digo-fonte.  No nosso caso, pode ser assim (eu uso a pasta <code>~/Projects/cpp</code> para c√≥digo-fonte <em>C ++</em> ): <br></p><br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Projects/cpp git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/ierton/xkb-switch.git</code> </pre><br><br><p>  Isso criar√° a pasta <code>~/Projects/cpp/xkb-switch</code> cont√©m o c√≥digo-fonte.  Obviamente, em vez de usar o <code>git</code> voc√™ pode baixar o arquivo com o programa e descompact√°-lo. <br></p><br><p>  No arquivo <code>README.md</code> na pasta do projeto, √© f√°cil adivinhar que o utilit√°rio <code>cmake</code> √© usado para criar o programa.  Portanto, se voc√™ precisar alterar as configura√ß√µes de compila√ß√£o, no nosso caso elas est√£o no arquivo <code>CMakeLists.txt</code> .  E apenas tentamos compilar o programa e verificar se ele funciona.  Quais comandos voc√™ precisa usar para isso est√£o escritos no mesmo arquivo <code>README.md</code> na raiz do projeto. <br></p><br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> xkb-switch mkdir build &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> build cmake .. make ./xkb-switch <span class="hljs-comment"><span class="hljs-comment">#         ./xkb-switch -l #       ./xkb-switch -s ru #       (  )</span></span></code> </pre><br><br><p>  Depois disso, para usar o projeto alterado, voc√™ precisar√° limpar ou excluir a pasta de <code>build</code> do projeto e compactar o c√≥digo-fonte no arquivo morto.  Pode ser assim: <br></p><br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Projects/cpp/xkb-switch rm -rf ./build <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Projects/cpp zip -r xkb-switch.zip xkb-switch</code> </pre><br><br><p>  O arquivo <code>xkb-switch.zip</code> precisar√° ser usado para criar o pacote. <br></p><br><br><a name="test_program-github"></a><br><h3>  Verifica√ß√£o ao salvar o projeto no seu perfil do GitHub </h3><br><p>  Suponho que qualquer pessoa que leia esta se√ß√£o esteja ao menos um pouco familiarizada com o trabalho com o <em>git</em> e j√° tenha configurado um perfil no <em>GitHub</em> .  Penso que este m√©todo √© o melhor, pelo que o resto do artigo implica que √© utilizado, salvo indica√ß√£o em contr√°rio. <br></p><br><p>  Primeiro, voc√™ precisa inserir o projeto original no seu <em>GitHub</em> .  Depois disso, como no m√©todo anterior, clonamos o projeto em nosso computador, mas em nosso reposit√≥rio (no meu caso, o nome de usu√°rio √© <em>alexandersolovyov</em> ): <br></p><br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Projects/cpp git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/alexandersolovyov/xkb-switch.git</code> </pre><br><br><p>  Para adicionar altera√ß√µes, √© melhor usar uma nova ramifica√ß√£o.  Ent√£o, se desejado, ser√° poss√≠vel usar diferentes vers√µes do programa.  E tamb√©m ser√° poss√≠vel propor altera√ß√µes ao autor do projeto usando solicita√ß√µes de recebimento.  Por exemplo, se voc√™ decidir corrigir um pouco o arquivo <code>CMakeLists.txt</code> , antes disso, ser√° necess√°rio criar uma nova ramifica√ß√£o com: <br></p><br><br><pre> <code class="bash hljs">git branch cmake_corrections</code> </pre><br><br><p>  Depois que as altera√ß√µes s√£o feitas, verificadas e adicionadas √† ramifica√ß√£o (usando <code>git commit -am " "</code> ), voc√™ pode adicionar uma nova ramifica√ß√£o ao seu GitHub: <br></p><br><br><pre> <code class="bash hljs">git push origin cmake_corrections</code> </pre><br><br><p>  Depois disso, voc√™ pode fazer uma solicita√ß√£o de recebimento, se necess√°rio. <br></p><br><p>  Voc√™ pode criar um link para o reposit√≥rio original: <br></p><br><br><pre> <code class="bash hljs">git remote add ierton https://github.com/ierton/xkb-switch.git</code> </pre><br><br><p>  E atualize a ramifica√ß√£o principal do seu reposit√≥rio para que ela corresponda ao original: <br></p><br><br><pre> <code class="bash hljs">git pull ierton master</code> </pre><br><br><p>  O c√≥digo do programa correspondente √† ramifica√ß√£o corrigida pode ser usado ao criar o RPM.  Para fazer isso, voc√™ precisar√° especificar o endere√ßo do arquivo morto no formul√°rio no arquivo de especifica√ß√£o: <br></p><br><br><pre> <code class="plaintext hljs">Source0: https://github.com/-/-/archive/---.zip</code> </pre><br><br><p>  Mas, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">como o usu√°rio do specblog solicitou</a> , esse n√£o √© realmente o caso.  √â melhor transmitir suas altera√ß√µes na forma de patches.  Para fazer isso, voc√™ precisa criar arquivos de corre√ß√£o a partir das altera√ß√µes em sua ramifica√ß√£o e copi√°-los para a pasta de origem para criar o pacote ( <code>~/rpmbuild/SOURCES/</code> ).  Ent√£o voc√™ precisar√° especific√°-los no arquivo de especifica√ß√µes.  Consideraremos isso um pouco mais tarde, mas se voc√™ quiser, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pode ler aqui</a> .  Se voc√™ n√£o sabe como criar patches, pode procurar no spoiler. <br></p><br><br><a name="test_program-github-patches"></a><br><div class="spoiler">  <b class="spoiler_title">Como criar patches usando git</b> <div class="spoiler_text"><h4>  Criando patches </h4><br><p>  <em>Patches</em> , s√£o <em>Patches</em> - s√£o arquivos nos quais as altera√ß√µes s√£o registradas no c√≥digo-fonte do programa.  Eles s√£o usados ‚Äã‚Äãcomo uma alternativa aos comandos <code>git pull</code> e <code>git push</code> para comunica√ß√£o entre reposit√≥rios de c√≥digos locais, se n√£o for conveniente "puxar" altera√ß√µes de um reposit√≥rio remoto, ou o hist√≥rico de altera√ß√µes do projeto e os princ√≠pios de trabalhar com ele s√£o de tal forma que √© melhor usar patches. <br></p><br><br><p>  Vamos imaginar que precisamos fazer altera√ß√µes no arquivo <code>CMakeLists.txt</code> .  Primeiro, voc√™ precisa fazer tudo como descrito acima: o ramo <em>mestre</em> em nosso reposit√≥rio GitHub deve corresponder ao ramo principal do projeto original e, para suas altera√ß√µes, voc√™ precisa usar o ramo <em>cmake_corrections</em> .  Ent√£o voc√™ precisa ir para este ramo, fazer as altera√ß√µes necess√°rias e salv√°-las no <em>git</em> usando commits. <br></p><br><p>  Agora voc√™ precisa salvar as altera√ß√µes como arquivos de corre√ß√£o na pasta <code>~/rpmbuild/SOURCES</code> (se voc√™ n√£o estiver usando o Rosa Linux, o caminho para a pasta <code>SOURCES</code> poder√° ser diferente).  Por exemplo, isso (quero dizer que estamos na pasta do projeto - por exemplo, <code>~/Projects/cpp/xkb-switch</code> - e no ramo <code>cmake_corrections</code> ): <br></p><br><pre> <code class="bash hljs">git format-patch -o ~/rpmbuild/SOURCES origin/master</code> </pre><br><p>  O comando <code>git format-patch</code> cria um arquivo de <code>git format-patch</code> para cada confirma√ß√£o.  Nesse formul√°rio, ele far√° patches come√ßando na confirma√ß√£o especificada pelo √∫ltimo argumento e terminando na √∫ltima confirma√ß√£o da ramifica√ß√£o atual.  Voc√™ pode especificar uma confirma√ß√£o de qualquer maneira: no in√≠cio do hash, usando o ponteiro <em>HEAD</em> ou o nome da ramifica√ß√£o, que agora indica a confirma√ß√£o desejada.  O principal √© que uma das confirma√ß√µes vis√≠veis quando o <code>git log</code> executado √© tomada como in√≠cio.  Ou seja, n√£o √© poss√≠vel come√ßar a fazer corre√ß√µes a partir de uma consolida√ß√£o que esteja em outra ramifica√ß√£o. <br></p><br><p>  E voc√™ pode lembrar (ou ver) quantos commits de volta n√≥s ramificamos da ramifica√ß√£o principal e fazer corre√ß√µes para um certo n√∫mero de commits de volta.  Por exemplo, se fizermos duas confirma√ß√µes, o comando seria: <br></p><br><pre> <code class="bash hljs">git format-patch -o ~/rpmbuild/SOURCES -2</code> </pre><br><p>  Aqui, o n√∫mero de confirma√ß√µes √© definido usando <code>-2</code> .  Voc√™ pode especificar qualquer n√∫mero deles em vez desta figura. <br></p><br><p>  Voc√™ pode especificar o intervalo de confirma√ß√µes a partir das quais as corre√ß√µes devem ser feitas colocando dois pontos entre os links para as confirma√ß√µes inicial e final: <br></p><br><pre> <code class="bash hljs">git format-patch -o ~/rpmbuild/SOURCES master..cmake_corrections</code> </pre><br><p>  O nome de cada arquivo de corre√ß√£o consiste em um n√∫mero de s√©rie e na primeira linha de um coment√°rio de confirma√ß√£o.  Portanto, √© melhor renomear cada arquivo para que a descri√ß√£o do patch descreva de maneira mais r√°pida e clara sua ess√™ncia.  Por exemplo, assim: <br></p><br><pre> <code class="bash hljs">mv 0001-Return-memory-allocated-by-XkbRf-getNamesProp()-<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>-tmp.patch 001-Fix-memory-leak.patch</code> </pre><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">a conven√ß√£o de nomenclatura para corre√ß√µes no artigo sobre a sintaxe do arquivo spec</a> recomenda adicionar <em>package_name-version-rosa-</em> antes da descri√ß√£o de cada arquivo de corre√ß√£o.  Talvez essa seja uma boa pr√°tica se voc√™ enviar corre√ß√µes por email, mas n√£o para criar pacotes.  Como constru√≠mos pacotes em nosso computador, √© melhor esvaziar a pasta <code>~/rpmbuild/SOURCES</code> todas as vezes antes de <code>~/rpmbuild/SOURCES</code> pacote com outro programa ou um novo pacote de vers√£o. <br></p><br><p>  Agora, se voc√™ precisar atualizar o ramo principal do reposit√≥rio ( <em>mestre</em> ) para corresponder ao original, depois disso, o ramo de mudan√ßa ( <em>cmake_corrections</em> ) precisar√° ser atualizado usando o <code>git rebase</code> .  Voc√™ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pode ver</a> como fazer isso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> .  Depois disso, os patches precisar√£o ser recriados. <br></p><br></div></div><br><br><a name="prepare"></a><br><h2>  Prepare o "local de trabalho" para criar um pacote </h2><br><p>  Primeiro voc√™ precisa criar uma estrutura de diret√≥rios.  Toda a montagem ocorre na pasta <code>rpmbuild</code> na pasta inicial do <code>rpmbuild</code> .  Crie a estrutura de diret√≥rio inicial e v√° para a pasta dos arquivos de especifica√ß√£o: <br></p><br><br><pre> <code class="bash hljs">mkdir -p ~/rpmbuild/SPECS &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/rpmbuild/SPECS</code> </pre><br><br><p>  Para o Rosa Linux, basta: as pastas restantes ser√£o criadas automaticamente. <br></p><br><p>  Outra distribui√ß√£o pode usar um local de arquivo diferente para criar o pacote.  E talvez voc√™ precise criar manualmente toda a hierarquia de pastas.  Procure informa√ß√µes para sua distribui√ß√£o se voc√™ n√£o estiver usando o Rosa Linux.  Por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">isso pode ser assim no Red Hat</a> . <br></p><br><p>  Se o pacote tiver sido constru√≠do com erros, todos os arquivos criados pelo comando <code>rpmbuild</code> n√£o <code>rpmbuild</code> exclu√≠dos - o mesmo que com uma compila√ß√£o bem-sucedida.  Vamos tentar coletar o pacote v√°rias vezes, e os arquivos restantes ap√≥s a √∫ltima vez ir√£o interferir.  Portanto, √© melhor criar um script simples que ajude a remov√™-los rapidamente.  Crie um arquivo cleanup.sh e coloque-o na <code>~/rpmbuild/SPECS</code> .  Aqui est√° o seu conte√∫do: <br></p><br><br><pre> <code class="bash hljs">!<span class="hljs-comment"><span class="hljs-comment">#/bin/sh rm -rf ~/rpmbuild/BUILD/* rm -rf ~/rpmbuild/BUILDROOT/* rm -rf ~/rpmbuild/RPMS/* rm -rf ~/rpmbuild/SRPMS/*</span></span></code> </pre><br><br><p>  Obviamente, √© melhor adicionar direitos de execu√ß√£o usando o <code>chmod u+x cleanup.sh</code> . <br></p><br><p>  Se voc√™ deseja coletar um pacote de arquivos que est√£o no computador local - se voc√™ n√£o est√° usando o <em>GitHub</em> e fez altera√ß√µes nos arquivos do projeto, ou deseja criar um pacote a partir do seu pr√≥prio programa, que √© armazenado apenas no seu computador - voc√™ precisa compactar o projeto em um arquivo morto ( por exemplo, <code>.zip</code> , <code>.tar</code> ou <code>.tar.gz</code> ) e coloque-o na pasta <code>SOURCES</code> .  Por exemplo, assim: <br></p><br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Projects/cpp/ zip -r xkb-switch.zip xkb-switch mkdir -p ~/rpmbuild/SOURCES cp xkb-switch.zip ~/rpmbuild/SOURCES/</code> </pre><br><br><p>  Se, ap√≥s a cria√ß√£o do programa, voc√™ desejar criar outra vers√£o igual ou diferente, mas diferente, ser√° necess√°rio excluir todos os arquivos da pasta <code>~/rpmbuild/SOURCES</code> e, em seguida, copiar o arquivo morto (se voc√™ n√£o fizer o download no <em>GitHub</em> ) e arquivos de corre√ß√£o (se usados).  Caso contr√°rio, o arquivo morto provavelmente n√£o ser√° baixado do <em>GitHub</em> (por que - veja mais adiante), e tamb√©m ser√° dif√≠cil descobrir qual arquivo de corre√ß√£o pertence a qual programa. <br></p><br><br><a name="specfile_start"></a><br><h2>  Vamos come√ßar a criar um arquivo de especifica√ß√£o </h2><br><p>  A base para a cria√ß√£o de um pacote RPM √© o chamado <em>arquivo speck</em> .  Este arquivo cont√©m as instru√ß√µes para o programa <code>rpmbuild</code> (ou melhor, <code>rpm</code> ) necess√°rias para a constru√ß√£o do pacote. <br></p><br><p>  Crie o arquivo <code>xkb-switch.spec</code> na <code>~/rpmbuild/SPECS/</code> .  A maneira mais f√°cil de come√ßar √© com um modelo que pode ser encontrado no site <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Arquivos de especifica√ß√£o de modelo</a> . <br></p><br><p>  No <code>README</code> na p√°gina do projeto <em>xkb-switch</em> , <em>√©</em> sabido que o programa √© compilado usando o utilit√°rio <code>cmake</code> .  Portanto, selecionaremos o <strong>arquivo Spec para um programa criado usando o CMake</strong> e copiaremos o modelo inteiro em nosso arquivo spec.  Obviamente, para montar adequadamente nosso pacote RPM, esse modelo precisa ser muito alterado, o que faremos. <br></p><br><br><a name="specfile_syntax"></a><br><h2>  Um pouco sobre a sintaxe do arquivo de especifica√ß√£o </h2><br><ul><li>  A sintaxe do arquivo spec permite adicionar coment√°rios no estilo bash. <br></li><li>  Voc√™ pode usar espa√ßos como os espa√ßos entre os valores na mesma linha para criar a apar√™ncia de colunas pares, mas a documenta√ß√£o recomenda enfaticamente o uso do caractere de tabula√ß√£o (um ou dois, desde que as colunas sejam pares).  <strong>Nota:</strong> em todos os exemplos de c√≥digo deste artigo, apenas espa√ßos s√£o usados; portanto, √© melhor n√£o copiar todo o texto daqui para seu arquivo de especifica√ß√£o, mas imprimi-lo voc√™ mesmo. <br></li><li>  Os campos de op√ß√£o consistem em um nome de op√ß√£o especial com dois pontos e o pr√≥ximo valor atrav√©s de guias (ou espa√ßos).  O caso de caracteres nos nomes dos campos n√£o importa.  Por exemplo: <br><pre> <code class="plaintext hljs"> Name: xkb-switch</code> </pre><br></li><li>  Se a palavra for precedida pelo s√≠mbolo <code>%</code> (por exemplo, <code>%description</code> ), essa √© uma palavra-chave especial.  Pode ser uma chamada de comando, macro ou script.  Depois disso, os par√¢metros que ele usa podem ser indicados.  E h√° palavras-chave que indicam o in√≠cio de um bloco de comandos ou op√ß√µes.  Em seguida, os par√¢metros podem ser indicados pr√≥ximos a ele e nas pr√≥ximas linhas deve haver comandos ou uma lista de op√ß√µes que descrevi no par√°grafo anterior.  Ap√≥s esse bloco, uma linha vazia deve ser deixada. <br></li><li>  Para usar o valor de uma constante, voc√™ precisa inserir uma constru√ß√£o do formul√°rio <code>%{_}</code> .  Seu valor pode ser predefinido ou pode ser determinado por uma op√ß√£o (por exemplo, <code>Name: xkb-switch</code> ) ou usando a palavra-chave <code>%define</code> .  Todas essas constantes tamb√©m s√£o consideradas macros.  Seu uso ser√° discutido em mais detalhes abaixo. <br></li></ul><br><br><a name="specfile_header"></a><br><h2>  Cabe√ßalho do arquivo Spec </h2><br><p>  No arquivo de especifica√ß√µes, o cabe√ßalho √© sempre escrito primeiro.  Esta √© uma lista de op√ß√µes que se aplicam ao pacote principal do RPM.  Quando o pacote estiver pronto, quase todas essas informa√ß√µes ser√£o exibidas ao visualizar sua descri√ß√£o.  Aqui est√° o que as linhas individuais indicam: <br></p><br><br>  <b>Resumo:</b> <br>  Uma breve descri√ß√£o do pacote.  Espiei a descri√ß√£o no arquivo <code>README.md</code> no projeto <em>xkb-switch</em> : <code>Query and change XKB layout state</code> . <br><br>  <b>Nome:</b> <br>  O nome do pacote.  No nosso caso, este √© o <code>xkb-switch</code> . <br><br>  <b>Vers√£o:</b> <br>  Vers√£o do programa.  Para descobrir, √© melhor consultar o arquivo <code>CMakeLists.txt</code> na pasta raiz do projeto.  Obviamente, voc√™ precisa tirar o arquivo da c√≥pia do projeto que ser√° usado para a montagem.  Se voc√™ usar o projeto original, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">poder√° abrir o arquivo diretamente na p√°gina do GitHub</a> .  Como voc√™ pode ver, a vers√£o √© composta por <code>MAJOR_VERSION</code> , <code>MINOR_VERSION</code> e <code>RELEASE_VERSION</code> .  Eu usei a vers√£o do programa <code>1.6.0</code> . <br><br>  <b>Lan√ßamento:</b> <br>  O n√∫mero da vers√£o do pr√≥prio pacote.  Exibe a hora em que um pacote com um programa da mesma vers√£o est√° sendo montado.  No nosso caso, √© "1", pois ningu√©m jamais montou um programa desta vers√£o.  No caso ideal, se j√° tentamos criar o pacote e o assembly chegou ao fim (mesmo que houvesse erros), depois de cada nova tentativa, √© necess√°rio aumentar esse n√∫mero em 1 e, ao mesmo tempo, n√£o exclua os pacotes coletados antigos das <code>rpmbuild/SRPMS</code> <code>rpmbuild/RPMS</code> e <code>rpmbuild/SRPMS</code> : Em seguida, novos pacotes com um novo n√∫mero de compila√ß√£o ser√£o criados.  Talvez isso deva ser feito se voc√™ usar um servidor especial para montagem.  N√≥s usamos nosso computador e, em vez disso, limparemos as pastas.  Se um pacote com um programa desta vers√£o j√° estiver nos reposit√≥rios da distribui√ß√£o Linux, mas voc√™ estiver compilando com outras configura√ß√µes, √© melhor especificar o n√∫mero do release 1 a mais que esse pacote. <br><br>  <b>Licen√ßa:</b> <br>  O nome abreviado da licen√ßa sob a qual o programa √© distribu√≠do.  De acordo com as regras do Rosa Linux, voc√™ s√≥ pode criar pacotes com uma licen√ßa que permita a distribui√ß√£o gratuita.  <code>README.md</code> pode descobrir no arquivo <code>README.md</code> que a licen√ßa √© <em>GNU GPLv3</em> .  Ent√£o, escrevemos: <code>GPLv3+</code> . <br><br>  <b>Grupo:</b> <br>  O grupo ou categoria √† qual o programa pertence.  Usando esses grupos, os programas s√£o classificados no menu de inicializa√ß√£o do aplicativo e no gerenciador de programas da janela (‚ÄúAdicionar ou remover programas‚Äù).  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A lista de grupos para o Rosa Linux pode ser encontrada aqui</a> .  Eu acho que o <code>Development\X11</code> √© melhor para n√≥s, pois o programa est√° relacionado ao X11 e √© principalmente necess√°rio para criar scripts e plugins para o Vim. <br><br>  <b>URL:</b> <br>  Endere√ßo da Internet em que voc√™ pode baixar o c√≥digo fonte original do programa.  Ser√° especificado ao visualizar as informa√ß√µes do pacote RPM.  Este item √© opcional, mas indicaremos: <code>https://github.com/ierton/xkb-switch</code> <br><br>  <b>Fonte0:</b> <br>  O nome do arquivo que cont√©m o c√≥digo-fonte ou o endere√ßo da Internet em que pode ser baixado.  Se voc√™ especificar um endere√ßo na Internet, durante a primeira compila√ß√£o, o arquivo ser√° baixado para <code>~/rpmbuild/SOURCES/</code> .  Se esse arquivo j√° existir, ele n√£o ser√° mais baixado, ou seja, o programa <code>rpmbuild</code> usar√° apenas o nome do arquivo especificado no final desta URL.  Voc√™ pode especificar apenas o nome do arquivo, mas ele precisar√° ser colocado na pasta <code>~/rpmbuild/SOURCES/</code> manualmente.  √â melhor fornecer o endere√ßo da sua c√≥pia do projeto no GitHub.  Usei o arquivo <code>https://github.com/alexandersolovyov/xkb-switch/archive/master.zip</code> .  Voc√™ pode especificar v√°rias fontes diferentes para coletar as fontes de v√°rios arquivos com a ajuda de um arquivo pontilhado.  Em seguida, no nome da op√ß√£o para adicionar cada arquivo subsequente, o n√∫mero deve aumentar ( <code>Source2</code> , <code>Source2</code> , etc.).  Esses endere√ßos de arquivo n√£o s√£o vis√≠veis ao exibir as informa√ß√µes do pacote RPM. <br><br>  <b>Patch0:</b> <br>  Esta op√ß√£o n√£o est√° no arquivo de modelo.  Pode ser √∫til se voc√™ decidir transferir suas altera√ß√µes nos arquivos de projeto do programa na forma de patches.  Quanto √† op√ß√£o <code>Source0</code> , cada arquivo deve ser indicado em uma linha separada, e o n√∫mero no final do nome da op√ß√£o deve aumentar a cada vez.  Os arquivos de corre√ß√£o devem estar localizados na pasta <code>~/rpmbuild/SOURCES</code> (ao lado do arquivo de origem baixado).  O nome de cada arquivo deve ser escrito sem um caminho para ele.  N√£o √© necess√°rio especificar todos os arquivos de corre√ß√£o aqui - apenas aqueles que voc√™ deseja aplicar podem ser usados. <br><br>  <b>BuildRequires:</b> <br>  Pacotes necess√°rios para construir o programa.  O modelo <code>cmake</code> .  O arquivo <code>CMakeLists.txt</code> indica que a vers√£o m√≠nima do CMake para montagem n√£o deve ser inferior a <em>2,6</em> ; portanto, √© melhor especificar <code>cmake &gt;= 2.6</code> .  Voc√™ pode adicionar outros pacotes, cada um em uma linha separada, usando a op√ß√£o <code>BuildRequires:</code> separada.  A lista de pacotes necess√°rios para montagem pode ser encontrada lendo o <code>README</code> do projeto e analisando atentamente o arquivo <code>CMakeLists.txt</code> (especialmente as <code>FIND_PACKAGE</code> , <code>TARGET_LINK_LIBRARY</code> , <code>FIND_PROGRAM</code> ).  Em seguida, voc√™ precisa encontrar o nome do pacote correto nos reposit√≥rios usando o comando <code>urpmq -a __</code> .  No nosso caso, o arquivo de configura√ß√µes de compila√ß√£o ( <code>CMakeLists.txt</code> ) j√° cont√©m linhas que verificam a presen√ßa dos pacotes necess√°rios no sistema.  Mas √© melhor especificar a lista inteira aqui tamb√©m: <br><pre> <code class="plaintext hljs"># CMake  2.6   BuildRequires: cmake &gt;= 2.6 #  C/C++ BuildRequires: gcc #    libxkbfile BuildRequires: libxkbfile-devel #   X11   libxkbfile, #  libx11-devel   . #    man: BuildRequires: xz</code> </pre><br><br>  <b>Requer:, Fornece:</b> <br>  Essas op√ß√µes n√£o est√£o na amostra, mas √†s vezes podem ser √∫teis.  Eles estabelecem depend√™ncias entre pacotes.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A op√ß√£o </font></font><code>Provides</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">especifica os </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recursos</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fornecidos pelo pacote que est√° sendo constru√≠do. Este pode ser o nome do arquivo de linguagem de cabe√ßalho </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ou din√¢mico nome da biblioteca de link, ou qualquer fun√ß√£o especial. E a op√ß√£o </font></font><code>Requires</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indica em quais </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recursos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> outros pacotes o pacote depende. Package Manager ( </font></font><code>rpm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>urpm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou outras pessoas que utilizam a sua distribui√ß√£o), na busca de depend√™ncias que procuram estas </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oportunidades</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> em vez de nomes de pacotes. Portanto, </font></font><code>Provides</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© melhor indicar a vers√£o da </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Oportunidade</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fornecida </font><font style="vertical-align: inherit;">e para </font></font><code>Requires</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quais vers√µes das </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Oportunidades</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fornecidas </font><font style="vertical-align: inherit;">s√£o adequadas. A vers√£o √© indicada por sinais </font></font><code>&gt;=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font><code>=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ou </font></font><code>&lt;=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cercado por espa√ßos. Normalmente, todas as op√ß√µes s√£o indicadas primeiro </font></font><code>Requires</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, depois - </font></font><code>Provides</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, um nome de recurso por linha - o mesmo que para </font></font><code>BuildRequires:</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Normalmente, ao criar pacotes no Rosa Linux, as depend√™ncias s√£o reconhecidas automaticamente e essas op√ß√µes raramente precisam ser especificadas. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AutoReq:, AutoProv:</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se voc√™ estiver </font><b><font style="vertical-align: inherit;">criando um</font></b><font style="vertical-align: inherit;"> programa que est√° escrito em um idioma em que o gerenciador de </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpm</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© </font><font style="vertical-align: inherit;">novo ou propriet√°rio e as depend√™ncias n√£o s√£o detectadas corretamente automaticamente, √© poss√≠vel desativar a detec√ß√£o autom√°tica de </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recursos</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (com </font></font><code>AutoProv: no</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) e / ou </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Depend√™ncias</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (com ajuda </font></font><code>AutoReq: no</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% descri√ß√£o</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este bloco n√£o faz mais parte do cabe√ßalho, mas est√° associado a ele. </font><font style="vertical-align: inherit;">Ele adicionar√° uma descri√ß√£o completa do programa ao pacote RPM. </font><font style="vertical-align: inherit;">Uma linha vazia deve ser deixada depois dela. </font><font style="vertical-align: inherit;">A descri√ß√£o pode ser a seguinte:</font></font><br><pre> <code class="plaintext hljs">%description xkb-switch is a C++ program that allows to query and change the keyboard layout state for X11 Window System (XKB) via command line. It provides a command 'xkb-switch', and bindings for API of the Vim text editor via 'libxkbswitch.so'. It is mainly used by a plugin for Vim text editor, vim-xkbswitch. Originally ruby-based code written by J.Broomley.</code> </pre><br><br><br><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As linhas do modelo que come√ßam com </font></font><code>%files</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font><code>%find_lang</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s√£o necess√°rias apenas se voc√™ criar um aplicativo com suporte para v√°rios idiomas, portanto, exclua-os.</font></font></p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Al√©m disso, ap√≥s o coment√°rio da linha divis√≥ria, seguido por comandos e macros que devem ser conclu√≠dos antes de compactar os arquivos. </font><font style="vertical-align: inherit;">Todos esses comandos s√£o divididos em blocos definidos usando palavras-chave especiais.</font></font></p><br><br><a name="prep"></a><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Prepara√ß√£o da fonte </font></font></h2><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O primeiro √© um bloco </font></font><code>%prep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que indica os comandos para se preparar para a compila√ß√£o. </font><font style="vertical-align: inherit;">Nele est√° um comando macro </font></font><code>%setup</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ela executa um script que faz o seguinte:</font></font></p><br><br><ul><li>       ,      <code>SourceX:</code>    (  ‚Äî  <code>Source0:</code> ).         ,    . <br></li><li>      <code>~/rpmbuild/SOURCES/</code> . <br></li><li>      <code>~/rpmbuild/BUILD/</code> . <br></li><li>      . <br></li></ul><br><br><p>   <code>-q</code> ,       . </p><br><p>     ,     <code>%prep</code> : </p><br><br><pre> <code class="bash hljs">rpmbuild -bp ~/rpmbuild/SPECS/xkb-switch.spec</code> </pre><br><br><p>     <code>rpmbuild</code> .       ,      <code>rpm</code>    : <code>rpmbuild</code>    ,      .           (   <code>root</code>    <code>sudo</code> ).    <code>rpmbuild</code>  ,  <code>man rpmbuild</code> .      ,       ,   , ‚Äî  ,          <code>rpmbuild</code> . <br></p><br><p>      : <code>xkb-switch-1.6.0: No such file or directory</code> .    ,          <code>~/rpmbuild/BUILD/xkb-switch-1.6.0</code> ,  .   <br></p><br><br><pre> <code class="bash hljs">ls ~/rpmbuild/BUILD/</code> </pre><br><br><p> ,     <code>xkb-switch-master</code> .     <code>%setup</code>    <code>-n</code> .    <code>%prep</code>  -   : <br></p><br><br><pre> <code class="bash hljs">%prep %setup -q -n xkb-switch-master</code> </pre><br><br><p>    <code>~/rpmbuild/SPECS/cleanup.sh</code> ,    <code>BUILD</code> ,     ,   <code>%prep</code> .  ,     <code>exit 0</code> .  ,     . <br></p><br><p>          ,         .       <code>%prep</code> .       ,    ,      : <br></p><br><pre> <code class="plaintext hljs">%apply_patches</code> </pre><br><p>       <code>rpmbuild -bp xkb-switch.spec</code> .    ‚Äî    . <br></p><br><p>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">  Maximum RPM</a> . <br></p><br><p>    . <br></p><br><br><a name="build"></a><br><h2>  </h2><br><p>      <code>%build</code> .   <code>README</code>  ,     <code>cmake ..</code>  <code>make</code> ,     -   .  :           ,     .    ,        <code>%build</code> : <br></p><br><br><pre> <code class="bash hljs">~/rpmbuild/SPECS/cleanup.sh rpmbuild -bc ~/rpmbuild/SPECS/xkb-switch.spec</code> </pre><br><br><p>     <code>exit 0</code> :    . <br></p><br><p> ,         .     shell (  bash  zsh,     ).  <code>rpmbuild</code>      ,           .    shell    - ‚Äî        . (    .) <br></p><br><p>     -  , ,  ,     <code>%build</code>  shell  . <br></p><br><p>     ,    ,   .      <code>cmake</code> , , ,        <code>%cmake</code>      -  ,      ,    .         (   ‚Äî <code>CMakeLists.txt</code> ).             ,    . <br></p><br><br><a name="install"></a><br><h2>  Instala√ß√£o </h2><br><p> , <em></em> .   <code>%install</code>   ,               ,     ,    <code>~/rpmbuild/BUILDROOT/__-buildroot/</code> . <br></p><br><p>  <code>__</code>    ,     <code>Name:</code>   -,   ( <code>Version:</code>  -),   ( <code>Release:</code>  -),  ,     . <br></p><br><p>   <code>README</code>  ,     <code>make install</code> ,    <code>build</code>   .  - - <code>%makeinstall_std -C build</code>    ,   .       ( ,   ): <br></p><br><br><pre> <code class="bash hljs">~/rpmbuild/SPECS/cleanup.sh rpmbuild -bi ~/rpmbuild/SPECS/xkb-switch.spec</code> </pre><br><br><p>      ,       RPM.   -   ,     . <br></p><br><br><a name="packing"></a><br><h2>   </h2><br><p>         ,      -  .     ,     <code>~/rpmbild/BUILDROOT/</code> . ( , ,     <code>tree</code> ,  -      Linux.)  ,       ,       <code>.debug</code> .    , ,    :        . <br></p><br><p>  ,       ,   <code>%files</code>  -.   ,     ,      .  . <br></p><br><p>       <code>%files</code>  -.  ,    .   Rosa Linux       <code>%prep</code> (  -   ).   ,   ,     ,  ,        ‚Äî   .          - (,    ,     ). <br></p><br><p>   <code>%files</code>    ,      RPM. ,     : <br></p><br><br><pre> <code class="plaintext hljs">%files %{_bindir}/%{name} %{_libdir}/libxkbswitch.so %{_libdir}/libxkbswitch.so.1 %{_libdir}/libxkbswitch.so.%{version} %{_mandir}/man1/%{name}.1.xz</code> </pre><br><br><p>         -.   , ,     <code>/usr/lib/rpm/macros</code> .  , <code>%{_bindir}</code>     , <code>%{_libdir}</code> ‚Äî   ,  <code>%{_mandir}</code> ‚Äî    man.   <code>%{name}</code>  <code>%{version}</code>    <code>Name:</code>  <code>Version:</code>   -. <br></p><br><p>     : <br></p><br><br><pre> <code class="bash hljs">~/rpmbuild/SPECS/cleanup.sh rpmbuild -ba ~/rpmbuild/SPECS/xkb-switch.spec</code> </pre><br><br><p> ‚Ä¶   2   1 .    <code>rpmlint</code> ,      .  ,   ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> Rpmlint Errors</a>  ,   : <br></p><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">`xkb-switch.i586: E: vers√£o incoerente no nome (validade: 50) 1`</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Erro: a vers√£o no nome do pacote da biblioteca n√£o est√° especificada corretamente. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">`xkb-switch.i586: E: execut√°vel na biblioteca-pacote (Badness: 1) / usr / bin / xkb-switch`</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Erro: o pacote da biblioteca cont√©m um arquivo execut√°vel. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">`xkb-switch.i586: W: arquivo devel-em-non-devel-pacote / usr / lib / libxkbswitch.so`</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Aviso que um arquivo de </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pacote de desenvolvimento</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><code>-devel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) foi encontrado em um pacote que n√£o foi desenvolvido para desenvolvimento.</font></font><br><br><br><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Est√° tudo claro? </font><font style="vertical-align: inherit;">Eu acho que n√£o. </font><font style="vertical-align: inherit;">Vamos dar uma olhada no que est√° acontecendo aqui.</font></font><br></p><br><br><a name="packing-rpmlint"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O que √© rpmlint </font></font></h3><br><p>     Rosa Linux  <code>rpmbuild</code>   <code>rpmlint</code> ,    .  <code>rpmlint</code>    ,   ,      .   ,     Rosa Linux (  ,     <code>rpmlint</code> )     . <br></p><br><p>     ,     ,      .       <code>~/rpmbuild/RPMS/_/</code>         <code>rpmlint -i __</code> . <br></p><br><p> ,      RPM   - ,  ,    ,  ,      Rosa Linux,      <code>rpmlint -i __</code> . <br></p><br><br><a name="packing-package_types"></a><br><h3>   RPM  Rosa Linux </h3><br><p>   Rosa Linux   6 .   ,          . <br></p><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pacote execut√°vel</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √â bin√°rio. Ele cont√©m apenas um arquivo ou script bin√°rio destinado diretamente √† execu√ß√£o. Os arquivos desses pacotes costumam ser instalados em uma pasta </font></font><code>/bin/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou em </font></font><code>/usr/bin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Tamb√©m pode conter links - para a possibilidade de chamar o programa usando v√°rios nomes diferentes. O nome do pacote corresponde ao nome do programa. Esses pacotes geralmente dependem da biblioteca. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Biblioteca</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cont√©m arquivos compilados de </font><b><font style="vertical-align: inherit;">bibliotecas</font></b><font style="vertical-align: inherit;"> dinamicamente conectadas ("compartilhadas", "compartilhadas") usadas pelos programas. Normalmente, esse √© o pr√≥prio arquivo da biblioteca, cujo nome termina com a vers√£o e um link para esse arquivo, cujo nome termina com o primeiro n√∫mero da vers√£o. Por exemplo, para uma biblioteca </font></font><code>libxkbfile</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vers√£o 1.0.2, ser√° um arquivo </font></font><code>libxkbfile.so.1.0.2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e um link para ele,</font></font><code>libxkbfile.so.1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. O pr√≥prio nome do pacote da biblioteca, pelo qual √© reconhecido no reposit√≥rio do instalador, termina com o primeiro n√∫mero da vers√£o e come√ßa com o prefixo </font></font><code>lib</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. A biblioteca tem o </font></font><code>libxkbfile</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nome correto - </font></font><code>libxkbfile1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Isso ocorre porque geralmente o n√∫mero da primeira vers√£o muda apenas com altera√ß√µes incompat√≠veis da biblioteca e, portanto, ser√° poss√≠vel instalar v√°rios pacotes com uma biblioteca de vers√µes diferentes se alguns programas usarem a vers√£o antiga da biblioteca e outros usarem uma vers√£o mais recente. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pacote para desenvolvedores</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Arquivos necess√°rios para compilar programas que usam a biblioteca, mas desnecess√°rios para o trabalho de programas prontos. Para programas </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C ++</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> simples </font><font style="vertical-align: inherit;">, este √© um link para o arquivo da biblioteca, mas sem vers√µes no nome (por exemplo,</font></font><code>libxkbfile.so</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), bem como arquivos de cabe√ßalho (com a extens√£o </font></font><code>.h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). Nome do pacote termina com </font></font><code>-devel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, por exemplo: </font></font><code>libxkbfile-devel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Durante a instala√ß√£o, sempre depende da biblioteca apropriada. Por exemplo, o pacote </font></font><code>libxkbfile-devel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">depende </font></font><code>libxkbfile1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C√≥digo Fonte Os</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> reposit√≥rios Rosa Linux possuem pacotes RPM que cont√™m o c√≥digo fonte para alguns programas - basicamente apenas aqueles que </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">realmente precisam ser</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> reconstru√≠dos. Os nomes desses pacotes terminam com </font></font><code>-src</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou </font></font><code>-source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(por exemplo, </font></font><code>apache-source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font></font><code>rpmbuild</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sempre cria esse pacote automaticamente e o coloca </font></font><code>~/rpmbuild/SRPMS/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S√≠mbolos de depura√ß√£o</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esta √© uma informa√ß√£o que pode ser usada para depurar um programa conclu√≠do. </font><font style="vertical-align: inherit;">Ele associa locais em arquivos compilados ao c√≥digo fonte. </font><font style="vertical-align: inherit;">Esses pacotes s√£o criados </font></font><code>rpmbuild</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">automaticamente </font><font style="vertical-align: inherit;">pela equipe </font><font style="vertical-align: inherit;">, e um final √© atribu√≠do ao seu nome </font></font><code>-debuginfo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">N√£o encontrei esses pacotes nos reposit√≥rios do Rosa Linux. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Documenta√ß√£o Os</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> reposit√≥rios do Rosa Linux possuem pacotes de documenta√ß√£o para v√°rios programas e bibliotecas. </font><font style="vertical-align: inherit;">Eu (por enquanto) n√£o conhe√ßo os recursos para compilar esses pacotes. </font><font style="vertical-align: inherit;">Seus nomes geralmente terminam em </font></font><code>doc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: por exemplo </font></font><code>libx11-doc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>java-1.7.0-openjdk-javadoc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">A prop√≥sito, quase todos eles s√£o feitos no estilo de sites e, para visualiz√°-los, √© melhor abrir um navegador, acessar o endere√ßo </font></font><code>file:///usr/share/doc/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e selecionar a pasta e o arquivo desejados.</font></font><br><br><br><br><a name="packing-result"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nosso resultado </font></font></h3><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Agora tudo ficou mais claro. </font></font><br></p><br><br><ul><li>    <code>xkb-switch</code>   <code>libxkbswitch.so</code> , ,  ,    <em>  </em> .   ,          : <code>xkb-switch.i586: W: devel-file-in-non-devel-package /usr/lib/libxkbswitch.so</code> . <br></li><li>     <em></em> ,      <code>/usr/lib/libxkbswitch.so.1</code>  <code>/usr/lib/libxkbswitch.so.1.6.0</code> .       ,       .  : <code>xkb-switch.i586: E: executable-in-library-package (Badness: 1) /usr/bin/xkb-switch</code> . <br></li><li>    ,          (1).   : <code>xkb-switch.i586: E: incoherent-version-in-name (Badness: 50) 1</code> . <br></li></ul><br><br><p> ,  <code>rpmlint</code> ,     .          .   <em>xkb-switch</em> ,      <code>libxkbswitch.so.1.6.0</code>       ,        <em>Vim</em> .            <em>xkb-switch</em> ,          <em>C</em>  <em>C++</em> .  RPM-    . <br></p><br><p>       -: <br></p><br><br><div class="spoiler"> <b class="spoiler_title">-   xkb-switch</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">Summary: Query and change XKB layout state Name: xkb-switch Version: 1.6.0 Release: 1 License: GPLv3+ Group: Development/X11 URL: https://github.com/ierton/xkb-switch Source0: https://github.com/alexandersolovyov/xkb-switch/archive/master.zip BuildRequires: cmake &gt;= 2.6 BuildRequires: gcc BuildRequires: libxkbfile-devel BuildRequires: xz %description xkb-switch is a C++ program that allows to query and change the keyboard layout state for X11 Window System (XKB) via command line. It provides a command 'xkb-switch', and bindings for API of the Vim text editor via 'libxkbswitch.so'. It is mainly used by a plugin for Vim text editor, vim-xkbswitch. Originally ruby-based code written by J.Broomley. %files %{_bindir}/%{name} %{_libdir}/libxkbswitch.so %{_libdir}/libxkbswitch.so.1 %{_libdir}/libxkbswitch.so.%{version} %{_mandir}/man1/%{name}.1.xz #------------------------------------------------------------------ %prep %setup -q -n xkb-switch-master %build %cmake %make %install %makeinstall_std -C build</code> </pre><br></div></div><br><br><a name="subpackaging"></a><br><h2>       </h2><br><p>        ‚Äî ,         .    ,  ,       <code>xkb-switch</code>  3 : <em></em> , <em></em>   <em></em> . : <br></p><br><br><ul><li>  <em></em>     <code>/usr/bin/xkb-switch</code>    <code>/usr/share/man/man1/xkb-switch.1.xz</code> , <br></li><li>  <em></em> ‚Äî  <code>/usr/lib/libxkbswitch.so.1</code>  <code>/usr/lib/libxkbswitch.so.1.6.0</code> , <br></li><li>    <em> </em> ‚Äî <code>/usr/lib/libxkbswitch.so</code> . <br></li></ul><br><br><p>       -.  ,   , <br>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">  - Maximum RPM</a> .     <a href=""> -  libxkbfile</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">   Rosa Linux</a> . <br></p><br><p>    . <br></p><br><br><a name="subpackaging-macros"></a><br><h3>    </h3><br><p>        ‚Äî   <a href="">-  libxkbfile</a> .     -  : <br></p><br><br><pre> <code class="plaintext hljs">%define major 1 %define libname %mklibname xkbswitch %{major} %define develname %mklibname -d xkbswitch</code> </pre><br><br><p>    <code>%define</code>  .        ,    (     ) ‚Äî   ,       .     ,    <code>%{major}</code>   <code>1</code> ,      . <br></p><br><p>  <code>%mklibname</code>   ¬´lib¬ª,     ,      ‚Äî   (  ).     <code>%{libname}</code>  <em>¬´lib¬ª + ¬´xkbswitch¬ª + (  %{major}) =</em> <code>libxkbswitch1</code> ‚Äî   . <br></p><br><p>  <code>-d</code>  <code>%mklibname</code>   <code>-devel</code> .    <code>%{develname}</code>  <code>libxkbswitch-devel</code> ‚Äî    . <br></p><br><br><a name="subpackaging-change_header"></a><br><h3>    </h3><br><p>     <code>Version:</code>   <br></p><br><br><pre> <code class="plaintext hljs">Version: %{major}.6.0</code> </pre><br><br><p>  ,           -. <br></p><br><p>      -       .      .      : <br></p><br><pre> <code class="plaintext hljs">Name: xkb-switch Version: %{major}.6.0 Release: 1 Summary: Query and change XKB layout state License: GPLv3+ Group: Development/X11 URL: https://github.com/alexandersolovyov/xkb-switch Source0: https://github.com/alexandersolovyov/xkb-switch/archive/master.zip BuildRequires: cmake &gt;= 2.6 BuildRequires: gcc BuildRequires: libxkbfile-devel BuildRequires: xz %description xkb-switch is a C++ program that allows to query and change the keyboard layout state for X11 Window System (XKB) via command line. It provides a command 'xkb-switch', and bindings for API of the Vim text editor, a library 'libxkbswitch'. It is mainly used for some plugins for Vim text editor, such as vim-xkbswitch. Originally ruby-based code written by J.Broomley.</code> </pre><br><br><a name="subpackaging-packages"></a><br><h3>    </h3><br><p>     <em>-</em>     . <em>-</em>   , -      (    <em>rpm</em> ).       <code>%package</code> .        -.     ,    -.          <code>Version</code> , <code>Summary</code> , <code>Group</code> .      <code>Provides</code>  <code>Requires</code>   <em></em>  <em></em> ,     .  <code>Name</code>   :    ,     <code>%package</code> . <br></p><br><p>      .     <code>%description</code>       ‚Äî   ,     <code>%package</code> . <br></p><br><p>  Rosa Linux   -   <code>%description</code>  -.    <code>libxkbswitch1</code> : <br></p><br><pre> <code class="plaintext hljs">%package -n %{libname} Version: %{version} Summary: A library for xkb-switch tool, provides API bindings for Vim text editor Group: Development/X11 %description -n %{libname} libxkbswitch library, required by xkb-switch tool. It provides bindings for API of the Vim text editor, which can be used via 'libxkbswitch.so.1'.</code> </pre><br><br><p>  <code>-n</code>    <code>%package</code>  <code>%description</code> ,       .    -        ,    <code>xkb-switch-libxkbswitch1</code> .       <code>libxkbswitch1</code> .           . <br></p><br><p>    <em> </em> : <br></p><br><pre> <code class="plaintext hljs">%package -n %{develname} Version: %{version} Summary: Development library libxkbswitch, provides API bindings for Vim text editor Group: Development/X11 %description -n %{develname} Development files for libxkbswitch. Provides bindings for API of the Vim text editor via 'libxkbswitch.so'.</code> </pre><br><br><a name="subpackaging-files"></a><br><h3>     </h3><br><p>   ,      .     <code>%files</code> . <br></p><br><p>      ,     ,    <code>%package</code> , <code>%description</code>  <code>%files</code> .  ,    <code>%description</code>  -    .   ,      ,    ‚Äî <code>xkb-switch</code> . <br></p><br><p>  -  Rosa Linux     <code>%files</code>   ,    <code>%prep</code> .       : <br></p><br><pre> <code class="plaintext hljs">%files %{_bindir}/%{name} %{_mandir}/%{name}.1.xz %files -n %{libname} %{_libdir}/libxkbswitch.so.%{major} %{_libdir}/libxkbswitch.so.%{version} %files -n %{develname} %{_libdir}/libxkbswitch.so</code> </pre><br><br><p>    , : <br></p><br><br><ul><li>   <code>xkb-switch</code>   <code>~/usr/bin/xkb-switch</code>  <code>~/usr/share/man/man1/xkb-switch.1</code> , <br></li><li>   <code>libxkbswitch1</code>   <code>~/usr/lib/libxkbswitch.so.1</code>  <code>~/usr/lib/libxkbswitch.so.1.6.0</code> , <br></li><li>    <code>libxkbswitch-devel</code>   <code>~/usr/lib/libxkbswitch.so</code> . <br></li></ul><br><br><p>       <code>cleanup.sh</code>       <code>rpmbuild -ba ~/rpmbuild/SPECS/xkb-switch.spec</code> .    3 : <br></p><br><br><pre> <code class="plaintext hljs">libxkbswitch1.i586: W: no-documentation libxkbswitch-devel.i586: W: no-documentation libxkbswitch-devel.i586: W: no-dependency-on libxkbswitch/libxkbswitch-libs/liblibxkbswitch</code> </pre><br><br><p>   ,       .   ,     .     .  Vamos tentar descobrir. <br></p><br><br><a name="subpackaging-problems"></a><br><h3>    </h3><br><p> ,      ,  ,        <code>README.md</code> .     <code>%files</code>      ‚Äî    <code>%doc</code> : <br></p><br><br><pre> <code class="plaintext hljs">%doc README.md</code> </pre><br><br><p>      .    <code>%doc</code> ‚Äî    .        <code>~/rpmbuild/BUILD/xkb-switdh-master/README.md</code> . <br></p><br><p>       : <code>libxkbswitch-devel.i586: W: no-dependency-on libxkbswitch/libxkbswitch-libs/liblibxkbswitch</code> .  ,    <code>libxkbswitch-devel</code>    <code>libxkbswitch</code>  . <br></p><br><p>    <code>rpm -qp  --</code>       .            : <br></p><br><pre> <code class="bash hljs">[user@pc ~] $ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/rpmbuild/RPMS/i586/ [user@pc ~/rpmbuild/RPMS/i586] $ ls libxkbswitch1-1.6.0-1-rosa2014.1.i586.rpm xkb-switch-1.6.0-1-rosa2014.1.i586.rpm libxkbswitch-devel-1.6.0-1-rosa2014.1.i586.rpm xkb-switch-debuginfo-1.6.0-1-rosa2014.1.i586.rpm [user@pc ~/rpmbuild/RPMS/i586] $ rpm -qp --provides libxkbswitch1-1.6.0-1-rosa2014.1.i586.rpm libxkbswitch.so.1 libxkbswitch1 = 1.6.0-1:2014.1 [user@pc ~/rpmbuild/RPMS/i586] $ rpm -qp --provides libxkbswitch-devel-1.6.0-1-rosa2014.1.i586.rpm devel(libxkbswitch) libxkbswitch-devel = 1.6.0-1:2014.1 [user@pc ~/rpmbuild/RPMS/i586] $ rpm -qp --requires libxkbswitch-devel-1.6.0-1-rosa2014.1.i586.rpm devel(libX11) devel(libgcc_s) devel(libstdc++) devel(libxkbfile) rpmlib(PayloadIsXz) &lt;= 5.2-1 [user@pc ~/rpmbuild/RPMS/i586] $ rpm -qp --requires xkb-switch-1.6.0-1-rosa2014.1.i586.rpm libc.so.6 libc.so.6(GLIBC_2.0) libc.so.6(GLIBC_2.1.3) libgcc_s.so.1 libgcc_s.so.1(GCC_3.0) libstdc++.so.6 libstdc++.so.6(CXXABI_1.3) libstdc++.so.6(GLIBCXX_3.4) libstdc++.so.6(GLIBCXX_3.4.11) libstdc++.so.6(GLIBCXX_3.4.20) libstdc++.so.6(GLIBCXX_3.4.9) libxkbswitch.so.1 rpmlib(PayloadIsXz) &lt;= 5.2-1</code> </pre><br><br><p>  ,    <code>libxkbswitch1</code>   <code>libxkbswitch.so.1</code>  <code>libxkbswitch1</code> .  <code>xkb-switch</code>   <code>libxkbswitch.so.1</code> ,     <code>libxkbswitch-devel</code>    <code>libxkbswitch1</code> .   ,     <code>%package</code>  <code>libxkbswitch-devel</code> .      : <br></p><br><br><pre> <code class="plaintext hljs">%package -n %{develname} Version: %{version} Summary: Development library libxkbswitch, provides API bindings for Vim text editor Group: Development/X11 Requires: %{libname} &gt;= %{version}</code> </pre><br><br><p>        , ‚Ä¶       .     <code>libxkbswitch-devel</code>  ,  ,    .     ,         ,  <code>rpmbuild</code>      . <br></p><br><p> -,     (  <code>README.md</code>    ), ‚Äî  : <br></p><br><br><div class="spoiler"> <b class="spoiler_title">-    </b> <div class="spoiler_text"><pre> <code class="plaintext hljs">%define major 1 %define libname %mklibname xkbswitch %{major} %define develname %mklibname -d xkbswitch # Main package. Automaticaly requires libxkbswitch and libxkbswitch-devel Name: xkb-switch Version: %{major}.6.0 Release: 1 Summary: Query and change XKB layout state License: GPLv3+ Group: Development/X11 URL: https://github.com/alexandersolovyov/xkb-switch Source0: https://github.com/alexandersolovyov/xkb-switch/archive/master.zip BuildRequires: cmake &gt;= 2.6 BuildRequires: gcc BuildRequires: libxkbfile-devel BuildRequires: xz %description xkb-switch is a C++ program that allows to query and change the keyboard layout state for X11 Window System (XKB) via command line. It provides a command 'xkb-switch', and bindings for API of the Vim text editor, a library 'libxkbswitch'. It is mainly used for some plugins for Vim text editor, such as vim-xkbswitch. Originally ruby-based code written by J.Broomley. # libxkbswitch %package -n %{libname} Version: %{version} Summary: A library for xkb-switch tool, provides API bindings for Vim text editor Group: Development/X11 %description -n %{libname} libxkbswitch library, required by xkb-switch tool. It provides bindings for API of the Vim text editor, which can be used via 'libxkbswitch.so.1'. # libxkbswitch-devel %package -n %{develname} Version: %{version} Summary: Development library libxkbswitch, provides API bindings for Vim text editor Group: Development/X11 Requires: %{libname} &gt;= %{version} %description -n %{develname} Development files for libxkbswitch. Provides bindings for API of the Vim text editor via 'libxkbswitch.so'. # xkb-switch %files %{_bindir}/%{name} %{_mandir}/man1/%{name}.1.xz # libxkbswitch1 %files -n %{libname} %{_libdir}/libxkbswitch.so.%{major} %{_libdir}/libxkbswitch.so.%{version} %doc README.md # libxkbswitch-devel %files -n %{develname} %{_libdir}/libxkbswitch.so %doc README.md #------------------------------------------------------------------ %prep %setup -q -n xkb-switch-master %build %cmake %make %install %makeinstall_std -C build</code> </pre><br></div></div><br><br><a name="summary"></a><br><h2>  Conclus√£o </h2><br><p>  ,      RPM    <em>Rosa Linux</em> (       ).       ,   -. ,       ‚Äî ,   ,   <em>rpmrc</em> ,      <em>ABF</em>   , ‚Äî         . <br></p><br><p>        ‚Äî    ,      -,         - , ‚Äî     . <br></p><br><br><a name="commands"></a><br><h2>   </h2><br><br><a name="commands-build"></a><br><h3>     </h3><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpmbuild -bp specfile.spec</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Execute a </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prepara√ß√£o</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (% de prepara√ß√£o). </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpmbuild -bc specfile.spec</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Run </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">compila√ß√£o</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (% build) e todas as a√ß√µes anteriores. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpmbuild -bi specfile.spec</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Execute uma </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pseudo-</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> instala√ß√£o (% install) e todas as etapas anteriores. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpmbuild -ba specfile.spec</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Crie pacotes completamente.</font></font><br><br><br><br><a name="commands-package"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Verificando o pacote pronto </font></font></h3><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpmlint -i package_file_name.rpm</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Verifica√ß√£o geral - qu√£o bem o pacote foi constru√≠do. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpm -qp - fornece package_filename.rpm</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Verifique quais "recursos" s√£o fornecidos pelo pacote. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpm -qp - requer package_filename.rpm</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Verifique em quais "capacidades" de outros pacotes este pacote depende. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpm -qpl package_file_name.rpm</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Lista de arquivos contidos no pacote. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpm -qpi nome do arquivo do pacote.rpm</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Informa√ß√µes sobre o pacote (no "cabe√ßalho" do arquivo de especifica√ß√£o ou no bloco </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% package</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br><br><br><br><p>          ,    <code>p</code> .    ,     Rosa Linux,   .     <code>urpmq</code> ,   <code>rpm -q</code> . , <code>urpmq -l _</code>    ,  <code>urpmq --requires _</code>   . <br></p><br><br><a name="links"></a><br><h2>   ( ) </h2><br><ol><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Building RPMs ‚Äî Quick Start</a> ‚Äî         RPM  Rosa Linux. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> RPM</a> ‚Äî    ,   ,       .   . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">RPM:  spec </a> ‚Äî    -  Rosa Linux. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Maximum RPM</a> ‚Äî        <code>rpm</code>   RPM-  RedHat Linux.         ,      Rosa Linux.    . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Template Spec Files</a> ‚Äî   <code>.spec</code> .  ,      -. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Automatic Build Farm (ABF)</a> ‚Äî      Rosa Linux.             ,   ,     ,    <code>.spec</code> .     -. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Rpmlint Errors</a> ‚Äî    ,   <code>rpmlint</code> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Packaging Group</a> ‚Äî    Rosa Linux. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">   Rosa Linux</a> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Git ‚Äî </a> ‚Äî      <em>Git</em> . </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt464993/">https://habr.com/ru/post/pt464993/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt464981/index.html">O Google fornece argumentos para justificar o rastreamento do usu√°rio - a empresa √© acusada de falta de sinceridade e manipula√ß√£o</a></li>
<li><a href="../pt464985/index.html">Internet das Coisas (IoT) vai mudar o mundo. Futuro da IoT</a></li>
<li><a href="../pt464987/index.html">Reposit√≥rios em Kubernetes: OpenEBS vs Rook (Ceph) vs Rancher Longhorn vs StorageOS vs Robin vs Portworx vs Linstor</a></li>
<li><a href="../pt464989/index.html">Contexto da extravag√¢ncia</a></li>
<li><a href="../pt464991/index.html">Projetos que n√£o decolaram</a></li>
<li><a href="../pt464995/index.html">Quebrar sequ√™ncias no Swift</a></li>
<li><a href="../pt464997/index.html">Sobre o desenvolvimento de tecnologias de RV: onde elas s√£o usadas, por que os neg√≥cios de RV e quais dispositivos usam</a></li>
<li><a href="../pt464999/index.html">Como as especificidades do trabalho com servidores de aplicativos est√£o mudando usando o exemplo OpenLiberty</a></li>
<li><a href="../pt465001/index.html">Amazon Prime Day 2019 - tecnologia da AWS</a></li>
<li><a href="../pt465003/index.html">Interesses para o g√™nero ARPG</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>