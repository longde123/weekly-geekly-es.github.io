<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ¼â€ğŸŒ¾ ğŸ‘¨ğŸ¾ ğŸƒ Jaringan saraf yang akan membantu Anda memilih film - "selera Anda spesifik" ğŸ‰‘ ğŸ¨ ğŸ”œ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hai 

 Kebetulan Anda menonton film, dan di kepala Anda hanya ada satu pertanyaan - "Apakah saya mendapatkan clickbait lagi?" Kami akan menyelesaikan ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Jaringan saraf yang akan membantu Anda memilih film - "selera Anda spesifik"</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/477630/">  Hai <br><br>  Kebetulan Anda menonton film, dan di kepala Anda hanya ada satu pertanyaan - "Apakah saya mendapatkan clickbait lagi?"  Kami akan menyelesaikan masalah ini dan kami hanya akan menonton film yang sesuai.  Saya sarankan untuk sedikit bereksperimen dengan data dan menulis jaringan saraf sederhana untuk mengevaluasi film. <br><br>  Eksperimen kami didasarkan pada teknologi analisis sentimen untuk menentukan suasana hati audiens terhadap suatu produk.  Sebagai data kami mengambil dataset ulasan pengguna pada film IMDb.  Lingkungan pengembangan Google Colab akan memungkinkan Anda untuk dengan cepat melatih jaringan saraf Anda berkat akses gratis ke GPU (NVidia Tesla K80). <br><br>  Saya menggunakan perpustakaan Keras, dengan bantuan yang saya akan membangun model universal untuk memecahkan masalah pembelajaran mesin yang sama.  Saya akan membutuhkan backend TensorFlow, versi default di Colab 1.15.0, jadi cukup tingkatkan ke 2.0.0. <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> absolute_import, division, print_function, unicode_literals <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf !tf_upgrade_v2 -h</code> </pre> <br>  Selanjutnya, kami mengimpor semua modul yang diperlukan untuk preprocessing data dan pembangunan model.  Pada artikel sebelumnya, penekanannya adalah pada perpustakaan, Anda dapat melihat di sana. <br><a name="habracut"></a><br><pre> <code class="python hljs">%matplotlib inline <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt</code> </pre> <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras.utils <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> to_categorical <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> models <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> layers <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras.datasets <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> imdb</code> </pre> <br><h2>  Parsing Data IMDb </h2><br><img src="https://habrastorage.org/webt/4m/gg/mj/4mggmjh34w_zrwpseprbnv8gpwy.png"><br><br>  Dataset IMDb terdiri dari 50.000 ulasan film dari pengguna yang ditandai positif (1) dan negatif (0). <br><br><ul><li>  Ulasan sudah diproses sebelumnya, dan masing-masing disandikan dengan urutan indeks kata dalam bentuk bilangan bulat </li></ul><br><ul><li>  Kata-kata dalam ulasan diindeks berdasarkan frekuensi totalnya dalam dataset.  Misalnya, bilangan bulat "2" mengkodekan kata yang paling sering digunakan kedua </li></ul><br><ul><li>  50.000 ulasan dibagi menjadi dua set: 25.000 untuk pelatihan dan 25.000 untuk pengujian. </li></ul><br>  Unduh dataset yang dibangun ke Keras.  Karena data dibagi menjadi pelatihan dan tes dalam rasio 50-50, saya akan menggabungkannya sehingga nanti saya bisa membaginya dengan 80-20. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras.datasets <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> imdb (training_data, training_targets), (testing_data, testing_targets) = imdb.load_data(num_words=<span class="hljs-number"><span class="hljs-number">10000</span></span>) data = np.concatenate((training_data, testing_data), axis=<span class="hljs-number"><span class="hljs-number">0</span></span>) targets = np.concatenate((training_targets, testing_targets), axis=<span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br><h2>  Eksplorasi data </h2><br>  Mari kita lihat apa yang sedang kita kerjakan. <br><br><pre> <code class="python hljs">print(<span class="hljs-string"><span class="hljs-string">"Categories:"</span></span>, np.unique(targets)) print(<span class="hljs-string"><span class="hljs-string">"Number of unique words:"</span></span>, len(np.unique(np.hstack(data))))</code> </pre> <br><img src="https://habrastorage.org/webt/i4/iv/gq/i4ivgqp7pzmudiozqn5ollfffcu.png"><br><br><pre> <code class="python hljs">length = [len(i) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> data] print(<span class="hljs-string"><span class="hljs-string">"Average Review length:"</span></span>, np.mean(length)) print(<span class="hljs-string"><span class="hljs-string">"Standard Deviation:"</span></span>, round(np.std(length)))</code> </pre> <br><img src="https://habrastorage.org/webt/_l/3z/td/_l3ztdm6ma6lanax8rzewdm_nk4.png"><br><br>  Anda dapat melihat bahwa semua data termasuk dalam dua kategori: 0 atau 1, yang mewakili mood peninjauan.  Seluruh dataset berisi 9998 kata unik, ukuran ulasan rata-rata adalah 234 kata dengan standar deviasi 173. <br><br>  Mari kita lihat review pertama dari dataset ini, yang ditandai sebagai positif. <br><br><pre> <code class="python hljs">print(<span class="hljs-string"><span class="hljs-string">"Label:"</span></span>, targets[<span class="hljs-number"><span class="hljs-number">0</span></span>]) print(data[<span class="hljs-number"><span class="hljs-number">0</span></span>])</code> </pre> <br><img src="https://habrastorage.org/webt/c0/fg/et/c0fgeth2sdc9d0ycekevqesuqwy.png"><br><br><pre> <code class="python hljs">index = imdb.get_word_index() reverse_index = dict([(value, key) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (key, value) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> index.items()]) decoded = <span class="hljs-string"><span class="hljs-string">" "</span></span>.join( [reverse_index.get(i - <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-string"><span class="hljs-string">"#"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> data[<span class="hljs-number"><span class="hljs-number">0</span></span>]] ) print(decoded)</code> </pre> <br><img src="https://habrastorage.org/webt/gl/mj/kd/glmjkdqcbp0mha-udlo2g_qgni4.png"><br><br><h2>  Persiapan data </h2><br>  Saatnya menyiapkan data.  Kita perlu membuat vektor setiap survei dan mengisinya dengan nol sehingga vektor tersebut berisi persis 10.000 angka.  Ini berarti bahwa setiap ulasan yang lebih pendek dari 10.000 kata diisi dengan nol.  Saya melakukan ini karena ikhtisar terbesar hampir sama ukurannya, dan setiap elemen input dari jaringan saraf kita harus memiliki ukuran yang sama.  Anda juga perlu mengubah variabel menjadi tipe float. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vectorize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(sequences, dimension = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">10000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> results = np.zeros((len(sequences), dimension)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i, sequence <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(sequences): results[i, sequence] = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> results data = vectorize(data) targets = np.array(targets).astype(<span class="hljs-string"><span class="hljs-string">"float32"</span></span>)</code> </pre> <br>  Selanjutnya, saya membagi dataset menjadi data pelatihan dan tes sesuai kesepakatan 4: 1. <br><br><pre> <code class="python hljs">test_x = data[:<span class="hljs-number"><span class="hljs-number">10000</span></span>] test_y = targets[:<span class="hljs-number"><span class="hljs-number">10000</span></span>] train_x = data[<span class="hljs-number"><span class="hljs-number">10000</span></span>:] train_y = targets[<span class="hljs-number"><span class="hljs-number">10000</span></span>:]</code> </pre> <br><br><h2>  Buat dan latih model </h2><br>  Masalahnya kecil, tetap hanya untuk menulis model dan melatihnya.  Mulailah dengan memilih jenis.  Dua jenis model tersedia dalam Keras: berurutan dan dengan API fungsional.  Maka Anda perlu menambahkan lapisan input, tersembunyi dan keluaran. <br><br>  Untuk mencegah pelatihan ulang, kita akan menggunakan "dropout" di antara mereka. Pada setiap lapisan kita menggunakan fungsi "padat" untuk sepenuhnya menghubungkan lapisan satu sama lain.  Di lapisan tersembunyi kita akan menggunakan fungsi aktivasi "relu", ini hampir selalu mengarah ke hasil yang memuaskan.  Pada layer output kami menggunakan fungsi sigmoid yang merenormalkan kembali nilai dalam kisaran dari 0 hingga 1. <br><br>  Saya menggunakan pengoptimal adam, itu akan mengubah bobot selama pelatihan. <br><br>  Kami menggunakan cross-entropy biner sebagai fungsi kerugian, dan akurasi sebagai metrik ukuran. <br><br>  Sekarang Anda dapat melatih model kami.  Kami akan melakukan ini dengan ukuran batch 500 dan hanya tiga era, karena terungkap bahwa model mulai melatih kembali jika dilatih lebih lama. <br><br><pre> <code class="python hljs">model = models.Sequential() <span class="hljs-comment"><span class="hljs-comment"># Input - Layer model.add(layers.Dense(50, activation = "relu", input_shape=(10000, ))) # Hidden - Layers model.add(layers.Dropout(0.3, noise_shape=None, seed=None)) model.add(layers.Dense(50, activation = "relu")) model.add(layers.Dropout(0.2, noise_shape=None, seed=None)) model.add(layers.Dense(50, activation = "relu")) # Output- Layer model.add(layers.Dense(1, activation = "sigmoid")) model.summary() # compiling the model model.compile( optimizer = "adam", loss = "binary_crossentropy", metrics = ["accuracy"] ) results = model.fit( train_x, train_y, epochs= 3, batch_size = 500, validation_data = (test_x, test_y) ) print("Test-Accuracy:", np.mean(results.history["val_acc"]))</span></span></code> </pre> <br><img src="https://habrastorage.org/webt/fc/ay/fd/fcayfd-sr1jv_ur91nve_ecqm-4.png"><br><br><h2>  Kesimpulan </h2><br>  Kami telah membuat jaringan saraf enam lapis sederhana yang dapat menghitung mood pembuat film dengan akurasi 0,89.  Tentu saja, untuk menonton film keren sama sekali tidak perlu untuk menulis jaringan saraf, tetapi ini hanyalah contoh lain dari bagaimana Anda dapat menggunakan data, manfaatkan dari itu, karena Anda memerlukannya untuk itu.  Jaringan saraf bersifat universal karena kesederhanaan strukturnya, mengubah beberapa parameter, Anda dapat menyesuaikannya untuk tugas yang sama sekali berbeda. <br><br>  Jangan ragu untuk menuliskan ide Anda di komentar. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id477630/">https://habr.com/ru/post/id477630/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id477616/index.html">Bagaimana cara masuk ke Apple Arcade? Wawancara dengan pendiri studio Tim Tortuga</a></li>
<li><a href="../id477618/index.html">Lokalisasi Aplikasi Bereaksi</a></li>
<li><a href="../id477622/index.html">Konsep Mengurangi Celah Hanya Dalam 10 Menit</a></li>
<li><a href="../id477624/index.html">Apa yang EXPLAIN tutupi dan bagaimana membicarakannya</a></li>
<li><a href="../id477628/index.html">Komputasi tanpa server berdasarkan OpenWhisk, bagian 2</a></li>
<li><a href="../id477634/index.html">Layanan microser dan struktur organisasi. Apa jenis tim yang akan memastikan kesuksesan?</a></li>
<li><a href="../id477638/index.html">Dibeli! = Milik Anda: John Deere merampas hak petani untuk memperbaiki traktor mereka sendiri</a></li>
<li><a href="../id477642/index.html">Visi mesin (radio) melihat melalui dinding</a></li>
<li><a href="../id477644/index.html">Mengembalikan UNIX v0 ke PDP-7: Detail Backroom</a></li>
<li><a href="../id477646/index.html">Matematikawan memotong bentuk untuk mencari bagian persamaan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>