<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💀 🖖🏿 🗜️ Automatisierung gegen Chaos 💇🏻 👩🏼‍⚖️ 🤗</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Die Entwicklung der IT-Technologien ermöglichte die Steuerung großer Datenflüsse. Unternehmen haben viele IT-Lösungen: CRM, ERP, BPM, Buchhaltungssyst...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Automatisierung gegen Chaos</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/436240/"><img src="https://habrastorage.org/webt/hj/s8/mq/hjs8mq4n1zefsd8fipawzx7j6ok.jpeg" alt="Bild"><br><br>  Die Entwicklung der IT-Technologien ermöglichte die Steuerung großer Datenflüsse.  Unternehmen haben viele IT-Lösungen: CRM, ERP, BPM, Buchhaltungssysteme oder zumindest nur Excel und Word.  Unternehmen sind auch anders.  Einige Unternehmen bestehen aus zahlreichen Niederlassungen.  Nennen wir wie "Pyramide".  Pyramiden haben ein Problem mit der Datensynchronisation für einen Stapel von IT-Systemen.  Softwareanbieter und -versionen unterscheiden sich für Branchen erheblich.  Darüber hinaus ändern die Verwaltungsgesellschaften kontinuierlich die Berichtsanforderungen, die zu Frustrationsangriffen in den Filialen führen.  Dies ist eine Geschichte über das Projekt, bei dem ich auf Chaos gestoßen bin, das systematisiert und automatisiert werden musste.  Niedriges Budget und enge Fristen schränkten die Verwendung der meisten vorhandenen Industrielösungen ein, eröffneten jedoch Raum für Kreativität. <br><a name="habracut"></a><br><h2>  Allzweckformat </h2><br>  Das Kundenunternehmen hat sich die Aufgabe gestellt, Berichtsdaten aus allen Filialen zu sammeln.  Lassen Sie mich das Ausmaß der Herausforderung erklären - es gibt Dutzende von Systemen, darunter sowohl selbstgemachte als auch Monster wie SAP. <br><br>  Ein Bericht könnte Daten enthalten von: Buchhaltern, Mechanikern, PR-Managern, EMERCOM, Meteorologen. <br><br>  Vor Projektbeginn wurde ein Großteil der Daten als Word / Excel-Anhänge per E-Mail an die Hauptfirma gesendet.  Ab dann sah es aus wie ein manuell erstellter Sonnenuntergang: Die Daten wurden von speziell untersuchten Mitarbeitern manuell verarbeitet und in einige Systeme eingegeben.  Am Ende gab es Dutzende von Berichten, die die Grundlage für Managemententscheidungen bildeten. <br><br>  Die Auswahl des Ansatzes wurde durch die verwendeten Dateiformate xlsx / docx veranlasst.  Sogar die Legacy-Software unterstützt das Hochladen von Daten in diese Formate.  Zumindest Copy-Paste kann ein letzter Stand für Zweige sein. <br><br>  Unser Plan war also: <br><br><ol><li>  Beschreiben Sie die Struktur und den Zeitplan jedes Berichts. </li><li>  Stellen Sie den Filialen Berichtsbestimmungen zur Verfügung.  Filialen sollten vorhandene Software verwenden, um Berichte per E-Mail zu senden.  Wenn keine Software vorhanden ist, senden Sie die Berichte wie zuvor manuell. </li><li>  Entwickeln Sie das System, das: </li></ol><br><ul><li>  nimmt die richtigen Dokumente aus dem E-Mail-Posteingang; </li><li>  extrahiert Daten aus Dokumenten; </li><li>  schreibt extrahierte Daten in die DB und bestraft Verstöße gegen Vorschriften. </li></ul><br><img src="https://habrastorage.org/webt/is/7j/jm/is7jjmttswxfhyiieqcz5cepmha.png" alt="Bild"><br><h2>  Implementierung </h2><br><h3>  Nichtentwicklungsprobleme </h3><br>  Während der Anforderungserfassungsphase stellte sich heraus, dass keine Beschreibung der Berichtsstruktur vorliegt.  Gar nichts.  Die Berichtsstruktur wurde in den Köpfen einiger Mitarbeiter gespeichert und mündlich als Volksmärchen übertragen.  Dieses Problem wurde mit einigen Anstrengungen gelöst, aber die eigentliche Herausforderung begann später mit der Einrichtung der Datenaustauschphase. <br><br><h3>  Erste Ausgabe </h3><br>  Einige Tage nach der Veröffentlichung der Beta-Version haben wir eine Lücke zwischen der Dokumentenstruktur und dem Dokumentmodell entdeckt.  Schlechte Datenqualität: Berichte hatten unterschiedliche Mengen, Spalten waren verwechselt oder hatten eine falsche Benennung.  Diese Probleme traten hauptsächlich in den Filialen auf, in denen Daten manuell erfasst und gesendet wurden. <br><br>  Lösung - Implementierung einer dreistufigen Überprüfung: <br><br><ol><li>  Bereitstellen von xlsx-Beispielen für Zweige, deren Struktur durch Excel-Tools festgelegt wurde.  Nur in diesen Proben verfügbare Zellen waren Dateneingaben.  Einige Zellen müssen zusätzlich überprüft werden: Typ, Konvergenz der Summen usw. </li><li>  Datenüberprüfung beim Extrahieren.  Beispiel: Vergleichen des aktuellen Datums und des Datums im Word-Absatz, Überprüfung der Datenarithmetik für Excel-Dokumente (falls dies nicht mit xlsx-Tools festgelegt werden kann). </li><li>  Tiefe Datenanalyse nach Extraktion.  Zum Beispiel die Erkennung signifikanter Abweichungen durch Schlüsselindikatoren im Vergleich zu früheren Perioden. </li></ol><br><h3>  Zweite Ausgabe </h3><br>  Ein systematischer Verstoß gegen den Datenübertragungsplan oder skrupellose Sabotageversuche: "Wir senden niemals Daten an jemanden, und hier sind Sie mit Ihrem ...", "Ich habe alles gesendet!  Pünktlich!  Wahrscheinlich haben Sie es wegen schlechter Latenz nicht bekommen. " <br><br>  Feedback wurde eine Lösung.  Die Software benachrichtigt automatisch die Verantwortlichen in der Filiale bei Verstößen gegen den Zeitplan. <br><br>  Einige Zeit später wurde das Feedback-Modul mit dem Modul zur Überprüfung der Datenqualität und dem Modul zur Erstellung von Abschlussberichten verbunden.  Auf diese Weise erhält der Zweig sofort eine Zusammenfassung der eigenen Daten und einen Vergleich mit den „Nachbarzweigen“.  Für eine Branche wäre also klar, warum sie gerügt wurde. <br><br><h2>  Entwickelte Module </h2><br>  Konfigurationswerkzeug für Berichtsvorlagen, das Folgendes beschreibt: <br><br><ul><li>  Attribute zur Identifizierung eines Berichts; </li><li>  Übertragungsvorschriften; </li><li>  Datenextraktionsalgorithmus; </li><li>  andere Attribute wie der Pfad zum Code, der die Daten validiert und speichert. </li></ul><br>  Eine E-Mail-Anwendung, die Anhänge in einen isolierten Speicher (Sandbox) verschiebt und mit Buchstaben verknüpfte Informationen speichert. <br><br>  Ein Anhangsparser, der den Bericht identifiziert und Daten extrahiert. <br><br><img src="https://habrastorage.org/webt/ym/iu/c5/ymiuc5d4tevhe9cnbkslpuj9fu8.png" alt="Bild"><br><br><h3>  Konfigurationstool </h3><br>  In der Vergangenheit wurden Briefe mit Berichten an die gemeinsame E-Mail-Adresse sowie an viele andere wichtige oder unwichtige Briefe gesendet.  Aus diesem Grund benötigten wir Attribute, um Arten von Berichtsanhängen zu identifizieren.  Die Verwendung bestimmter Dokumentnamen oder Texte im E-Mail-Text ist für den Absender unzuverlässig und unangenehm.  Aus diesem Grund haben wir beschlossen, dass die Identifizierung von Berichten nur durch einen Inhalt bestimmt wird. <br><br>  Brainstorming führte zu einer Reihe von Attributen, um den Berichtstyp anhand des Inhalts zu identifizieren: Farbe des Zelltextes, Schriftart usw.  Am besten ist es jedoch, wenn eine Teilzeichenfolge in einer bestimmten Zelle vorhanden ist - einem „Steckplatz“ oder in einem Array von Zellen für Excel.  Für Word haben wir Absatz oder Titel verwendet. <br><br>  Wir haben eine einfache Vergleichslogik für den "Slot" hinzugefügt: "gleich", "ungleich", "mehr", "weniger" und so weiter.  Beispiel für einen Excel-Bericht: Im Bereich von A2-E4 sollte der Zellentext gleich "Täglicher Bericht zum Laden von Geräten" sein. <br><br><img src="https://habrastorage.org/webt/r6/qf/qq/r6qfqqfzfos5m--nb5wnkucwu0g.png" alt="Bild"><br><br>  Auf ähnliche Weise haben wir den Suchbereich für den Anfang und das Ende der Daten konfiguriert. <br><br>  Unten finden Sie ein Beispiel für die Suchbedingung für das Datenende: "2 Leerzeilen in einer Reihe". <br><br><img src="https://habrastorage.org/webt/jc/pu/ok/jcpuokqbs80ari66rbcfs82pljw.png" alt="Bild"><br><br>  Einige andere Einstellungen: eine Liste der zulässigen Absender, ein Dokumenttyp (Excel / Word), ein Pfad für den Datenexport. <br><br>  Die Ausgabe ist eine JSON-Struktur (Vorlage), die den Bericht beschreibt. <br><br><h3>  E-Mail-Bewerbung </h3><br>  Diese Anwendung ist ein E-Mail-Posteingangsleser, der alle Anhänge in die Sandbox legt, E-Mail-Attribute speichert und Anhänge in die Parsing-Warteschlange setzt. <br><br>  Wir standen vor zwei Sicherheitsproblemen: <br><br><ol><li>  Was ist, wenn der Filialname im Bericht versehentlich (oder nicht) durch einen anderen Filialnamen ersetzt wurde? </li><li>  Was ist, wenn der Bericht von Eindringlingen gesendet wird? </li></ol><br>  Das erste Problem wird behoben, indem die E-Mail-Adresse des Absenders und der im Berichtskörper angegebene Zweigstellenname überprüft werden. <br><br>  Das zweite Problem wird mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SPF</a> gelöst. <br><br><h3>  Anhang Parser </h3><br>  Fast alle Word- und Excel-Analysebibliotheken unterstützen nur bestimmte Versionen / Erweiterungen.  Aus diesem Grund haben wir uns für die Libre Office-Konvertierung entschieden, um Dateien in ein einziges Format zu bringen.  Zum Beispiel Eingaben: odt, doc, docx (2007, 2010, 2013) ... in docx (2016) konvertieren. <br><br>  Nach der Konvertierung: <br><br><ol><li>  Wir filtern ein Array von Berichtsvorlagen basierend auf den grundlegenden Attributen heraus, z. B. Word oder Excel. Der Absender gehört zur Liste der zulässigen Elemente. </li><li>  den Bericht mit den verbleibenden Vorlagen bedrohen; </li><li>  Wenn ein Bericht mit der Vorlage übereinstimmt, extrahieren Sie die Daten und übertragen Sie sie in das Repository. </li></ol><br><h2>  Fortsetzen </h2><br>  Wir haben es geschafft! <br><br>  Nach zwei Monaten sorgfältiger Arbeit erhielt die Zentrale regelmäßig Daten für Berichte aus allen Niederlassungen. <br><br>  Datenqualität und Vollständigkeit werden beispiellos besser als zuvor.  Die implementierte Software hat Personal freigegeben, das die Projektkosten bis Ende des Jahres zurückgezahlt hat. <br><br>  Für uns selbst haben wir gelernt, dass der Integrationsprozess nicht immer schmerzhaft ist und haben die Hauptaspekte des Erfolgs identifiziert: <br><br><ol><li>  Wir sind nicht in Systeme in den Filialen gelangt. </li><li>  Wir haben eine einheitliche Berichtsstruktur und einen einheitlichen Transferplan formalisiert und genehmigt. </li><li>  Wir haben für jeden Berichtstyp Ausgabebeispiele mit integrierter Überprüfung erstellt. </li><li>  Wir haben die gängigste Methode zur Zustellung von Daten verwendet - eine E-Mail. </li></ol><br>  Als letztes Wort hat dieser Ansatz zwei Hauptnachteile: <br><br><ol><li>  niedrige Datenübertragungsgeschwindigkeit; </li><li>  Die Größe des Datenpakets sollte nicht größer sein als der durchschnittliche E-Mail-Anhang. </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de436240/">https://habr.com/ru/post/de436240/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de436230/index.html">So übernehmen Sie die Kontrolle über Ihre Netzwerkinfrastruktur. Kapitel Drei Netzwerksicherheit. Teil zwei</a></li>
<li><a href="../de436232/index.html">Telepathie-Strategie</a></li>
<li><a href="../de436234/index.html">Haskell Applicative Parsers</a></li>
<li><a href="../de436236/index.html">Wir verwenden Data Science, um den Lebenszyklus eines Kunden zu bestimmen</a></li>
<li><a href="../de436238/index.html">Authentifizierung in Kubernetes mit GitHub OAuth und Dex</a></li>
<li><a href="../de436242/index.html">YOLO und andere lose Methoden</a></li>
<li><a href="../de436244/index.html">Professor Lawrences neues Gehirn</a></li>
<li><a href="../de436246/index.html">Moderne Fahrzeugtechnik - 02. Sehr These über OS</a></li>
<li><a href="../de436248/index.html">Kalman Filter</a></li>
<li><a href="../de436250/index.html">Blutsauger-Bosse aus dem Zusammenhang geraten oder warum sie immer versagen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>