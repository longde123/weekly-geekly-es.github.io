<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©‚Äç‚úàÔ∏è üéÖüèΩ üë®üèø‚Äçüîß Pengenalan objek waktu-nyata pada iOS menggunakan YOLOv3 ü•• üöµüèª üíÜ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo semuanya! 

 Pada artikel ini kita akan menulis sebuah program kecil untuk menyelesaikan masalah deteksi dan pengenalan objek (deteksi objek) sec...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pengenalan objek waktu-nyata pada iOS menggunakan YOLOv3</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460869/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/gr/ah/g9/grahg9mh7movhc2fcbn7m-yfoxu.png"></div><br>  Halo semuanya! <br><br>  Pada artikel ini kita akan menulis sebuah program kecil untuk menyelesaikan masalah deteksi dan pengenalan objek (deteksi objek) secara real time.  Program ini akan ditulis dalam bahasa pemrograman Swift untuk platform iOS.  Untuk mendeteksi objek, kita akan menggunakan jaringan saraf convolutional dengan arsitektur yang disebut YOLOv3.  Dalam artikel ini, kita akan belajar cara bekerja di iOS dengan jaringan saraf menggunakan kerangka kerja CoreML, sedikit pemahaman tentang apa jaringan YOLOv3 dan bagaimana menggunakan dan memproses output dari jaringan ini.  Kami juga akan memeriksa pengoperasian program dan membandingkan beberapa variasi YOLOv3: YOLOv3-tiny dan YOLOv3-416. <br><br>  Sumber akan tersedia di akhir artikel, sehingga semua orang akan dapat menguji operasi jaringan saraf pada perangkat mereka. <br><a name="habracut"></a><br><h2>  Deteksi objek </h2><br>  Untuk memulainya, kita akan secara singkat memahami apa tugas mendeteksi objek (deteksi objek) dalam gambar dan alat apa yang digunakan untuk ini hari ini.  Saya mengerti bahwa banyak yang cukup akrab dengan topik ini, tetapi saya masih membiarkan diri saya menceritakan sedikit tentangnya. <br><br>  Sekarang banyak tugas di bidang visi komputer diselesaikan dengan bantuan jaringan saraf convolutional (Convolutional Neural Networks), selanjutnya CNN.  Karena strukturnya, mereka juga mengekstrak fitur dari gambar.  CNN digunakan dalam klasifikasi, pengakuan, segmentasi, dan banyak lainnya. <br><br>  Arsitektur CNN populer untuk pengenalan objek: <br><br><ul><li>  <b>R-CNN.</b>  Kita dapat mengatakan model pertama untuk menyelesaikan masalah ini.  Bekerja seperti penggolong gambar biasa.  Berbagai daerah gambar diumpankan ke input jaringan dan prediksi dibuat untuk mereka.  Sangat lambat karena menjalankan gambar tunggal beberapa ribu kali. </li><li>  <b>Cepat R-CNN.</b>  Versi R-CNN yang lebih baik dan lebih baik, bekerja dengan prinsip yang sama, tetapi pertama-tama seluruh gambar diumpankan ke input CNN, lalu wilayah dihasilkan dari representasi internal yang diterima.  Namun masih cukup lambat untuk tugas-tugas real-time. </li><li>  <b>Lebih cepat R-CNN.</b>  Perbedaan utama dari yang sebelumnya adalah bahwa alih-alih algoritma pencarian selektif, ia menggunakan jaringan saraf untuk memilih daerah untuk "menghafal" mereka. </li><li>  <b>YOLO.</b>  Prinsip operasi yang sama sekali berbeda dibandingkan dengan yang sebelumnya tidak menggunakan daerah sama sekali.  Tercepat.  Rincian lebih lanjut tentang itu akan dibahas dalam artikel ini. </li><li>  <b>SSD</b>  Ini pada prinsipnya mirip dengan YOLO, tetapi menggunakan VGG16 sebagai jaringan untuk mengekstrak fitur.  Juga cukup cepat dan cocok untuk pekerjaan real-time. </li><li>  <b>Fitur Jaringan Piramida (FPN).</b>  Jenis jaringan lain seperti Single Shot Detector, karena fitur ekstraksi fitur lebih baik daripada SSD mengenali objek kecil. </li><li>  <b>RetinaNet.</b>  Ini menggunakan kombinasi FPN + ResNet dan, berkat fungsi kesalahan khusus (kehilangan fokus), memberikan akurasi yang lebih tinggi. </li></ul><br>  Pada artikel ini, kita akan menggunakan arsitektur YOLO, yaitu modifikasi terbarunya, YOLOv3. <br><br><h2>  Mengapa YOLO? </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/i4/fy/lq/i4fylqlbpgsp-mu3w6k96zd5e1u.jpeg"></div><br><br>  YOLO atau You Only Look Once adalah arsitektur CNN yang sangat populer, yang digunakan untuk mengenali banyak objek dalam suatu gambar.  Informasi yang lebih lengkap tentang hal itu dapat diperoleh di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">situs web resmi</a> , di tempat yang sama Anda dapat menemukan publikasi di mana teori dan komponen matematika dari jaringan ini dijelaskan secara rinci, serta proses pelatihannya dijelaskan. <br><br>  Fitur utama arsitektur ini dibandingkan dengan yang lain adalah bahwa sebagian besar sistem menerapkan CNN beberapa kali untuk berbagai wilayah gambar, di YOLO, CNN diterapkan satu kali untuk seluruh gambar sekaligus.  Jaringan membagi gambar menjadi semacam kotak dan memprediksi kotak pembatas dan kemungkinan bahwa ada objek yang diinginkan untuk setiap bagian. <br><br>  Keuntungan dari pendekatan ini adalah bahwa jaringan melihat seluruh gambar sekaligus dan mempertimbangkan konteks ketika mendeteksi dan mengenali suatu objek.  YOLO juga 1000 kali lebih cepat dari R-CNN dan sekitar 100x lebih cepat dari Fast R-CNN.  Pada artikel ini, kami akan meluncurkan jaringan pada perangkat seluler untuk pemrosesan online, jadi ini adalah kualitas yang paling penting bagi kami. <br><br>  Informasi lebih rinci tentang perbandingan arsitektur dapat ditemukan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . <br><br><h4>  YOLOv3 </h4><br>  YOLOv3 adalah versi lanjutan dari arsitektur YOLO.  Ini terdiri dari 106 lapisan konvolusional dan lebih baik mendeteksi benda-benda kecil dibandingkan dengan pendahulunya YOLOv2.  Fitur utama YOLOv3 adalah bahwa ada tiga lapisan pada output, yang masing-masing dirancang untuk mendeteksi objek dengan ukuran yang berbeda. <br>  Gambar di bawah ini menunjukkan struktur skematiknya: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cl/rf/_j/clrf_jqzkt1qfszivfchhxkujv4.png"></div><br><br>  <b>YOLOv3-tiny</b> - Versi terpangkas dari arsitektur YOLOv3, terdiri dari lebih sedikit lapisan (hanya ada 2 lapisan keluaran).  Ini memprediksi objek yang lebih kecil lebih buruk dan dimaksudkan untuk dataset kecil.  Tetapi, karena struktur terpotong, bobot jaringan menempati sejumlah kecil memori (~ 35 MB) dan menghasilkan FPS yang lebih tinggi.  Karena itu, arsitektur seperti itu lebih disukai untuk digunakan pada perangkat seluler. <br><br><h2>  Kami sedang menulis sebuah program untuk pengenalan objek </h2><br>  Bagian yang menyenangkan dimulai! <br><br>  Mari kita membuat aplikasi yang akan mengenali berbagai objek dalam gambar secara real time menggunakan kamera ponsel.  Semua kode akan ditulis dalam bahasa pemrograman Swift 4.2 dan dijalankan pada perangkat iOS. <br><br>  Dalam tutorial ini kita akan mengambil jaringan yang sudah jadi dengan skala yang telah dilatih sebelumnya pada dataset <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">COCO</a> .  Ini menyajikan 80 kelas yang berbeda.  Oleh karena itu, neuron kita akan dapat mengenali 80 objek yang berbeda. <br><br><h4>  Dari Darknet ke CoreML </h4><br>  Arsitektur YOLOv3 asli diimplementasikan menggunakan kerangka <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Darknet</a> . <br><br>  Di iOS, dimulai dengan versi 11.0, ada perpustakaan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">CoreML yang</a> luar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">biasa</a> yang memungkinkan Anda menjalankan model pembelajaran mesin langsung di perangkat.  Tetapi ada satu batasan: <b>program hanya dapat dijalankan pada perangkat yang menjalankan iOS 11 ke atas.</b> <br><br>  Masalahnya adalah bahwa CoreML hanya memahami format spesifik dari model <i>.coreml</i> .  Untuk sebagian besar perpustakaan populer, seperti Tensorflow, Keras atau XGBoost, dimungkinkan untuk secara langsung mengkonversi ke format CoreML.  Tetapi untuk Darknet tidak ada kemungkinan seperti itu.  Untuk mengonversi model yang disimpan dan dilatih dari Darknet ke CoreML, Anda dapat menggunakan berbagai opsi, misalnya, menyimpan Darknet ke <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ONNX</a> , dan kemudian mengonversinya dari ONNX ke CoreML. <br><br>  Kami akan menggunakan cara yang lebih sederhana dan kami akan menggunakan implementasi Keras YOLOv3.  Algoritme tindakannya adalah ini: muat bobot Darknet ke dalam model Keras, simpan dalam format Keras dan langsung konversikan ke CoreML dari sini. <br><br><ol><li>  <b>Unduh Darknet.</b>  Unduh file dari model Darknet-YOLOv3 yang terlatih <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dari sini</a> .  Pada artikel ini, saya akan menggunakan dua arsitektur: YOLOv3-416 dan YOLOv3-tiny.  Kita membutuhkan file cfg dan bobot. </li><li>  <b>Dari Darknet ke Keras.</b>  Pertama, klon <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">repositori</a> , buka folder repo dan jalankan perintah: <br><br><pre><code class="bash hljs">python convert.py yolov3.cfg yolov3.weights yolo.h5</code> </pre> <br>  di mana yolov3.cfg dan yolov3.weights mengunduh file Darknet.  Akibatnya, kita harus memiliki file dengan ekstensi <i>.h5</i> - ini adalah model YOLOv3 yang disimpan dalam format Keras. </li><li>  <b>Dari Keras ke CoreML.</b>  Langkah terakhir tetap.  Untuk mengonversi model ke CoreML, Anda harus menjalankan skrip python (Anda harus menginstal pustaka coremltools terlebih dahulu untuk python): <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> coremltools coreml_model = coremltools.converters.keras.convert( <span class="hljs-string"><span class="hljs-string">'yolo.h5'</span></span>, input_names=<span class="hljs-string"><span class="hljs-string">'image'</span></span>, image_input_names=<span class="hljs-string"><span class="hljs-string">'image'</span></span>, input_name_shape_dict={<span class="hljs-string"><span class="hljs-string">'image'</span></span>: [<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-number"><span class="hljs-number">416</span></span>, <span class="hljs-number"><span class="hljs-number">416</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>]}, <span class="hljs-comment"><span class="hljs-comment">#      image_scale=1/255.) coreml_model.input_description['image'] = 'Input image' coreml_model.save('yolo.mlmodel')</span></span></code> </pre> </li></ol><br>  Langkah-langkah yang dijelaskan di atas harus dilakukan untuk dua model YOLOv3-416 dan YOLOv3-mungil. <br>  Ketika kami melakukan semua ini, kami memiliki dua file: yolo.mlmodel dan yolo-tiny.mlmodel.  Sekarang Anda dapat mulai menulis kode aplikasi itu sendiri. <br><br><h4>  Membuat aplikasi iOS </h4><br>  Saya tidak akan menjelaskan semua kode aplikasi, Anda dapat melihatnya di repositori, tautan yang akan diberikan di akhir artikel.  Izinkan saya mengatakan bahwa kami memiliki tiga UIViewController-a: OnlineViewController, PhotoViewController, dan SettingsViewController.  Yang pertama adalah output kamera dan deteksi objek secara online untuk setiap frame.  Dalam yang kedua, Anda dapat mengambil foto atau memilih gambar dari galeri dan menguji jaringan pada gambar-gambar ini.  Yang ketiga berisi pengaturan, Anda dapat memilih model YOLOv3-416 atau YOLOv3-mungil, serta memilih ambang batas IoU (persimpangan atas kesatuan) dan kepercayaan objek (probabilitas bahwa ada objek di bagian gambar saat ini). <br><br>  <b>Memuat Model dalam CoreML</b> <br><br>  Setelah kami mengkonversi model terlatih dari format Darknet ke CoreML, kami memiliki file dengan ekstensi <i>.mlmodel</i> .  Dalam kasus saya, saya membuat dua file: <i>yolo.mlmodel</i> dan <i>yolo-tiny.mlmodel</i> , <i>masing-masing</i> untuk model YOLOv3-416 dan YOLOv3-tiny.  Sekarang Anda dapat memuat file-file ini ke proyek di Xcode. <br><br>  Kami membuat kelas ModelProvider, itu akan menyimpan model dan metode saat ini untuk secara serentak memohon jaringan saraf untuk dieksekusi.  Model dimuat dengan cara ini: <br><br><pre> <code class="swift hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadModel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(type: YOLOType)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.model = <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> <span class="hljs-type"><span class="hljs-type">YOLO</span></span>(type: type) } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">assertionFailure</span></span>(<span class="hljs-string"><span class="hljs-string">"error creating model"</span></span>) } }</code> </pre><br>  Kelas YOLO bertanggung jawab langsung untuk memuat file <i>.mlmodel</i> dan menangani output model.  Unduh file model: <br><br><pre> <code class="swift hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> url: <span class="hljs-type"><span class="hljs-type">URL?</span></span> = <span class="hljs-literal"><span class="hljs-literal">nil</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.type = type <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> type { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> .v3_Tiny: url = <span class="hljs-type"><span class="hljs-type">Bundle</span></span>.main.url(forResource: <span class="hljs-string"><span class="hljs-string">"yolo-tiny"</span></span>, withExtension:<span class="hljs-string"><span class="hljs-string">"mlmodelc"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.anchors = tiny_anchors <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> .v3_416: url = <span class="hljs-type"><span class="hljs-type">Bundle</span></span>.main.url(forResource: <span class="hljs-string"><span class="hljs-string">"yolo"</span></span>, withExtension:<span class="hljs-string"><span class="hljs-string">"mlmodelc"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.anchors = anchors_416 } <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> modelURL = url <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-type"><span class="hljs-type">YOLOError</span></span>.modelFileNotFound } <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { model = <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> <span class="hljs-type"><span class="hljs-type">MLModel</span></span>(contentsOf: modelURL) } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> error { <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(error) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-type"><span class="hljs-type">YOLOError</span></span>.modelCreationError }</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Kode Pemberi Model Lengkap.</b> <div class="spoiler_text"><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> UIKit <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> CoreML protocol ModelProviderDelegate: class { func show(predictions: [YOLO.Prediction]?, stat: ModelProvider.Statistics, error: YOLOError?) } @available(macOS 10.13, iOS 11.0, tvOS 11.0, watchOS 4.0, *) class ModelProvider { struct Statistics { var timeForFrame: Float var fps: Float } static let shared = ModelProvider(modelType: Settings.shared.modelType) var model: YOLO! weak var delegate: ModelProviderDelegate? var predicted = 0 var timeOfFirstFrameInSecond = CACurrentMediaTime() init(modelType type: YOLOType) { loadModel(type: type) } func reloadModel(type: YOLOType) { loadModel(type: type) } private func loadModel(type: YOLOType) { do { self.model = try YOLO(type: type) } catch { assertionFailure("error creating model") } } func predict(frame: UIImage) { DispatchQueue.global().async { do { let startTime = CACurrentMediaTime() let predictions = try self.model.predict(frame: frame) let elapsed = CACurrentMediaTime() - startTime self.showResultOnMain(predictions: predictions, elapsed: Float(elapsed), error: nil) } catch let error as YOLOError { self.showResultOnMain(predictions: nil, elapsed: -1, error: error) } catch { self.showResultOnMain(predictions: nil, elapsed: -1, error: YOLOError.unknownError) } } } private func showResultOnMain(predictions: [YOLO.Prediction]?, elapsed: Float, error: YOLOError?) { if let delegate = self.delegate { DispatchQueue.main.async { let fps = self.measureFPS() delegate.show(predictions: predictions, stat: ModelProvider.Statistics(timeForFrame: elapsed, fps: fps), error: error) } } } private func measureFPS() -&gt; Float { predicted += 1 let elapsed = CACurrentMediaTime() - timeOfFirstFrameInSecond let currentFPSDelivered = Double(predicted) / elapsed if elapsed &gt; 1 { predicted = 0 timeOfFirstFrameInSecond = CACurrentMediaTime() } return Float(currentFPSDelivered) } }</code> </pre><br></div></div><br>  <b>Pemrosesan output jaringan saraf</b> <br><br>  Sekarang mari kita mencari cara untuk memproses output dari jaringan saraf dan mendapatkan kotak pembatas yang sesuai.  Dalam Xcode, jika Anda memilih file model, Anda dapat melihat apa itu dan melihat lapisan output. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/m_/3b/vz/m_3bvzkroynfyfkpv1fal-ydf_k.png"></div><br>  <i>Masuk dan keluar YOLOv3-mungil.</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/0l/nl/hy/0lnlhydblax7trhpzdte8bojc0y.png"></div><br>  <i>Masuk dan keluar YOLOv3-416.</i> <br><br>  Seperti yang dapat Anda lihat pada gambar di atas, kami memiliki tiga untuk YOLOv3-416 dan dua untuk lapisan keluaran YOLOv3-kecil di masing-masing kotak yang terikat untuk berbagai objek diprediksi. <br>  Dalam hal ini, ini adalah array angka biasa, mari kita cari tahu cara menguraikannya. <br><br>  Model YOLOv3 menggunakan tiga lapisan sebagai output untuk membagi gambar ke dalam kisi yang berbeda, ukuran sel dari kisi-kisi ini memiliki nilai berikut: 8, 16 dan 32. Misalkan kita memiliki gambar berukuran 416x416 piksel pada input, maka matriks keluaran (kisi) akan memiliki ukuran 52x52 , 26x26 dan 13x13 (416/8 = 52, 416/16 = 26 dan 416/32 = 13).  Dalam kasus YOLOv3-tiny, semuanya sama, tetapi alih-alih tiga kisi, kita memiliki dua: 16 dan 32, yaitu, matriks 26x26 dan 13x13 dimensi. <br><br>  Setelah memulai model CoreML yang dimuat, kami mendapatkan dua (atau tiga) objek kelas MLMultiArray pada output.  Dan jika Anda melihat properti bentuk dari objek-objek ini, kita akan melihat gambar berikut (untuk YOLOv3-tiny): <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mo stretchy=&quot;false&quot;>[</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>255</mn><mo>,</mo><mn>26</mn><mo>,</mo><mn>26</mn><mo stretchy=&quot;false&quot;>]</mo><mspace linebreak=&quot;newline&quot; /><mo stretchy=&quot;false&quot;>[</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>255</mn><mo>,</mo><mn>13</mn><mo>,</mo><mn>13</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="76.867ex" height="6.033ex" viewBox="0 -832 33095.6 2597.7" role="img" focusable="false" style="vertical-align: -4.101ex; max-width: 638px;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(13126,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-31" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-2C" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-31" x="1224" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-2C" x="1724" y="0"></use><g transform="translate(2169,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-35" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-2C" x="3671" y="0"></use><g transform="translate(4116,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-36" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-2C" x="5117" y="0"></use><g transform="translate(5562,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-36" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-5D" x="6563" y="0"></use></g><g transform="translate(13126,-1433)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-31" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-2C" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-31" x="1224" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-2C" x="1724" y="0"></use><g transform="translate(2169,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-35" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-2C" x="3671" y="0"></use><g transform="translate(4116,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-33" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-2C" x="5117" y="0"></use><g transform="translate(5562,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-33" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-5D" x="6563" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>255</mn><mo>,</mo><mn>26</mn><mo>,</mo><mn>26</mn><mo stretchy="false">]</mo><mspace linebreak="newline"></mspace><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>255</mn><mo>,</mo><mn>13</mn><mo>,</mo><mn>13</mn><mo stretchy="false">]</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> [1, 1, 255, 26, 26] \\ [1, 1, 255, 13, 13] </script></p><br>  Seperti yang diharapkan, dimensi matriks akan menjadi 26x26 dan 13x13. Tetapi apa artinya angka 255?  Seperti yang disebutkan sebelumnya, lapisan output adalah matriks 52x52, 26x26 dan 13x13.  Faktanya adalah bahwa setiap elemen dari matriks ini bukan angka, itu adalah vektor.  Yaitu, lapisan keluaran adalah matriks tiga dimensi.  Vektor ini memiliki dimensi B x (5 + C), di mana B adalah jumlah kotak pembatas dalam sel, C adalah jumlah kelas.  Dari mana asal nomor 5?  Alasannya adalah ini: untuk setiap kotak-a, probabilitas diprediksi bahwa ada objek (kepercayaan objek) - ini adalah satu angka, dan empat sisanya adalah x, y, lebar dan tinggi untuk kotak yang diprediksi-a.  Gambar di bawah ini menunjukkan representasi skematis dari vektor ini: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/3d/j3/rl/3dj3rlk_te-4x-pthae9mreq7k0.png"></div><br>  <i>Representasi skematis dari lapisan output (peta fitur).</i> <br><br>  Untuk jaringan kami yang terlatih dalam 80 kelas, 3 kotak pembatas-a diprediksi untuk setiap sel dari kotak partisi, untuk masing-masingnya - probabilitas kelas 80 + kepercayaan objek + 4 angka yang bertanggung jawab untuk posisi dan ukuran kotak ini-a.  Total: 3 x (5 + 80) = 255. <br><br>  Untuk mendapatkan nilai-nilai ini dari kelas MLMultiArray, lebih baik menggunakan pointer mentah ke array data dan alamat aritmatika: <br><br><pre> <code class="swift hljs"> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> pointer = <span class="hljs-type"><span class="hljs-type">UnsafeMutablePointer</span></span>&lt;<span class="hljs-type"><span class="hljs-type">Double</span></span>&gt;(<span class="hljs-type"><span class="hljs-type">OpaquePointer</span></span>(out.dataPointer)) <span class="hljs-comment"><span class="hljs-comment">//    if out.strides.count &lt; 3 { throw YOLOError.strideOutOfBounds } let channelStride = out.strides[out.strides.count-3].intValue let yStride = out.strides[out.strides.count-2].intValue let xStride = out.strides[out.strides.count-1].intValue func offset(ch: Int, x: Int, y: Int) -&gt; Int { //     return ch * channelStride + y * yStride + x * xStride }</span></span></code> </pre><br>  Sekarang Anda perlu memproses vektor 255 elemen.  Untuk setiap kotak, Anda perlu mendapatkan distribusi probabilitas untuk 80 kelas, Anda dapat melakukan ini menggunakan fungsi softmax. <br><br><div class="spoiler">  <b class="spoiler_title">Apa itu softmax</b> <div class="spoiler_text">  Fungsi mengubah vektor <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>b</mi><mi>b</mi><mi>x</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.354ex" height="2.074ex" viewBox="0 -772.3 4027.5 892.8" role="img" focusable="false" aria-hidden="true" style="vertical-align: -0.28ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-62" x="3025" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-78" x="3455" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>b</mi><mi>b</mi><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-2"> \ mathbb x </script>  Dimensi K menjadi vektor dari dimensi yang sama, di mana masing-masing koordinat <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>b</mi><mi>b</mi><msub><mi>x</mi><mi>i</mi></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.154ex" height="2.349ex" viewBox="0 -772.3 4371.8 1011.3" role="img" focusable="false" aria-hidden="true" style="vertical-align: -0.555ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-62" x="3025" y="0"></use><g transform="translate(3455,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-69" x="809" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>b</mi><mi>b</mi><msub><mi>x</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-3"> \ mathbb x_i </script>  vektor yang dihasilkan diwakili oleh bilangan real dalam interval [0,1] dan jumlah koordinat adalah 1. <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mi>a</mi><mo stretchy=&quot;false&quot;>(</mo><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>b</mi><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>x</mi></mrow><msub><mo stretchy=&quot;false&quot;>)</mo><mi>i</mi></msub><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>x</mi><mi>i</mi></msub></mrow></msup></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>K</mi></mrow></msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>x</mi><mi>k</mi></msub></mrow></msup></mrow></mrow></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="41.144ex" height="3.037ex" viewBox="0 -890.8 17714.6 1307.5" role="img" focusable="false" aria-hidden="true" style="vertical-align: -0.968ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-69" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-67" x="1065" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-6D" x="1545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-61" x="2424" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-28" x="2953" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-6D" x="3593" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-61" x="4471" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-74" x="5001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-68" x="5362" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-62" x="5939" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-62" x="6368" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-78" x="6798" y="0"></use><g transform="translate(7370,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-69" x="550" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-3D" x="8382" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-66" x="9688" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-72" x="10238" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-61" x="10690" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-63" x="11219" y="0"></use><g transform="translate(11653,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-65" x="0" y="0"></use><g transform="translate(466,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-69" x="809" y="-213"></use></g></g><g transform="translate(12868,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-75" x="719" y="0"></use><g transform="translate(1292,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-4B" x="1242" y="488"></use><g transform="translate(878,-327)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-3D" x="521" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-31" x="1300" y="0"></use></g></g><g transform="translate(3543,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-65" x="0" y="0"></use><g transform="translate(466,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-6B" x="809" y="-213"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mi>a</mi><mo stretchy="false">(</mo><mtext>&nbsp;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>b</mi><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow><msub><mo stretchy="false">)</mo><mi>i</mi></msub><mo>=</mo><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>x</mi><mi>i</mi></msub></mrow></msup></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>K</mi></mrow></msubsup><mrow class="MJX-TeXAtom-ORD"><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>x</mi><mi>k</mi></msub></mrow></msup></mrow></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-4"> \ sigma (\ mathbb {x}) _ i = \ frac {e ^ {x_i}} {\ sum_ {k = 1} ^ {K} {e ^ {x_k}}} </script></p>  di mana K adalah dimensi vektor. <br></div></div><br>  Fungsi Softmax di Swift: <br><br><pre> <code class="swift hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">softmax</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">inout</span></span></span></span><span class="hljs-function"><span class="hljs-params"> [Float])</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> len = vDSP_Length(x.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-built_in"><span class="hljs-built_in">count</span></span> = <span class="hljs-type"><span class="hljs-type">Int32</span></span>(x.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>) vvexpf(&amp;x, x, &amp;<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sum: <span class="hljs-type"><span class="hljs-type">Float</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span> vDSP_sve(x, <span class="hljs-number"><span class="hljs-number">1</span></span>, &amp;sum, len) vDSP_vsdiv(x, <span class="hljs-number"><span class="hljs-number">1</span></span>, &amp;sum, &amp;x, <span class="hljs-number"><span class="hljs-number">1</span></span>, len) }</code> </pre><br>  Untuk mendapatkan koordinat dan ukuran kotak pembatas-a, Anda perlu menggunakan rumus: <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>x</mi><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mi>a</mi><mo stretchy=&quot;false&quot;>(</mo><mtext>&amp;#xA0;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><msub><mi>c</mi><mi>x</mi></msub><mspace linebreak=&quot;newline&quot; /><mi>y</mi><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mi>a</mi><mo stretchy=&quot;false&quot;>(</mo><mtext>&amp;#xA0;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><msub><mi>c</mi><mi>y</mi></msub><mspace linebreak=&quot;newline&quot; /><mi>w</mi><mo>=</mo><msub><mi>p</mi><mi>w</mi></msub><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mi>w</mi></mrow></msup><mspace linebreak=&quot;newline&quot; /><mi>h</mi><mo>=</mo><msub><mi>p</mi><mi>h</mi></msub><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mi>h</mi></mrow></msup></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="76.867ex" height="13.262ex" viewBox="0 -832 33095.6 5710.1" role="img" focusable="false" style="vertical-align: -11.33ex; max-width: 638px;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(11502,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-78" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-3D" x="850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-73" x="2156" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-69" x="2626" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-67" x="2971" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-6D" x="3452" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-61" x="4330" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-28" x="4860" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-68" x="5499" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-61" x="6076" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-74" x="6605" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-78" x="6967" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-29" x="7539" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-2B" x="8151" y="0"></use><g transform="translate(9152,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-63" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-78" x="613" y="-213"></use></g></g><g transform="translate(11604,-1433)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-79" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-3D" x="775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-73" x="2081" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-69" x="2551" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-67" x="2896" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-6D" x="3377" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-61" x="4255" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-28" x="4785" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-68" x="5424" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-61" x="6001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-74" x="6530" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-79" x="6892" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-29" x="7389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-2B" x="8001" y="0"></use><g transform="translate(9002,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-63" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-79" x="613" y="-213"></use></g></g><g transform="translate(13787,-3064)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-77" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-3D" x="994" y="0"></use><g transform="translate(2050,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-77" x="712" y="-213"></use></g><g transform="translate(3160,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-65" x="0" y="0"></use><g transform="translate(466,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-68" x="353" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-61" x="930" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-74" x="1459" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-77" x="1821" y="0"></use></g></g></g><g transform="translate(13956,-4593)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-68" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-3D" x="854" y="0"></use><g transform="translate(1910,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-68" x="712" y="-213"></use></g><g transform="translate(2921,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-65" x="0" y="0"></use><g transform="translate(466,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-68" x="353" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-61" x="930" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-74" x="1459" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-68" x="1821" y="0"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>x</mi><mo>=</mo><mtext>&nbsp;</mtext><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mi>a</mi><mo stretchy="false">(</mo><mtext>&nbsp;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>c</mi><mi>x</mi></msub><mspace linebreak="newline"></mspace><mi>y</mi><mo>=</mo><mtext>&nbsp;</mtext><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mi>a</mi><mo stretchy="false">(</mo><mtext>&nbsp;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mi>y</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>c</mi><mi>y</mi></msub><mspace linebreak="newline"></mspace><mi>w</mi><mo>=</mo><msub><mi>p</mi><mi>w</mi></msub><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mi>w</mi></mrow></msup><mspace linebreak="newline"></mspace><mi>h</mi><mo>=</mo><msub><mi>p</mi><mi>h</mi></msub><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mi>h</mi></mrow></msup></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-5"> x = \ sigma (\ hat x) + c_x \\ y = \ sigma (\ hat y) + c_y \\ w = p_we ^ {\ hat w} \\ h = p_he ^ {\ hat h} </script></p><br>  dimana <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mi>x</mi><mo>,</mo><mtext>&amp;#xA0;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mi>y</mi><mo>,</mo><mtext>&amp;#xA0;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mi>w</mi><mo>,</mo><mtext>&amp;#xA0;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mi>h</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.546ex" height="2.419ex" viewBox="0 -780.1 10568.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-68" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-61" x="826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-74" x="1356" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-78" x="1717" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-2C" x="2290" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-68" x="2985" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-61" x="3561" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-74" x="4091" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-79" x="4452" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-2C" x="4950" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-68" x="5645" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-61" x="6221" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-74" x="6751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-77" x="7112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-2C" x="7829" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-68" x="8524" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-61" x="9101" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-74" x="9630" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-68" x="9992" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mi>x</mi><mo>,</mo><mtext>&nbsp;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mi>y</mi><mo>,</mo><mtext>&nbsp;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mi>w</mi><mo>,</mo><mtext>&nbsp;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mi>h</mi></math></span></span><script type="math/tex" id="MathJax-Element-6"> \ hat x, \ hat y, \ hat w, \ hat h </script>  - diprediksi masing-masing koordinat x, y, lebar dan tinggi, <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mi>a</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.999ex" height="2.66ex" viewBox="0 -832 4305 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-69" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-67" x="1065" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-6D" x="1545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-61" x="2424" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-28" x="2953" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-78" x="3343" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-29" x="3915" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mi>a</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-7"> \ sigma (x) </script>  Apakah fungsi sigmoid, dan <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mi>w</mi></msub><mo>,</mo><msub><mi>p</mi><mi>h</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.05ex" height="1.817ex" viewBox="-38.5 -520.7 2605 782.1" role="img" focusable="false" style="vertical-align: -0.607ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-77" x="712" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-2C" x="1110" y="0"></use><g transform="translate(1555,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-68" x="712" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>w</mi></msub><mo>,</mo><msub><mi>p</mi><mi>h</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-8"> p_w, p_h </script>  - nilai jangkar (jangkar) untuk tiga kotak.  Nilai-nilai ini ditentukan selama pelatihan dan diatur dalam file Helpers.swift: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> anchors1: [<span class="hljs-type"><span class="hljs-type">Float</span></span>] = [<span class="hljs-number"><span class="hljs-number">116</span></span>,<span class="hljs-number"><span class="hljs-number">90</span></span>, <span class="hljs-number"><span class="hljs-number">156</span></span>,<span class="hljs-number"><span class="hljs-number">198</span></span>, <span class="hljs-number"><span class="hljs-number">373</span></span>,<span class="hljs-number"><span class="hljs-number">326</span></span>] <span class="hljs-comment"><span class="hljs-comment">//     let anchors2: [Float] = [30,61, 62,45, 59,119] //     let anchors3: [Float] = [10,13, 16,30, 33,23] //    </span></span></code> </pre><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ng/zf/pv/ngzfpvvch8bhnkdapz6url5ok-w.png"></div><br>  <i>Representasi skematis dari perhitungan posisi kotak pembatas.</i> <br><br><div class="spoiler">  <b class="spoiler_title">Kode lengkap untuk memproses lapisan keluaran.</b> <div class="spoiler_text"><pre> <code class="swift hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">process</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(output out: MLMultiArray, name: String)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">throws</span></span> -&gt; [<span class="hljs-type"><span class="hljs-type">Prediction</span></span>] { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> predictions = [<span class="hljs-type"><span class="hljs-type">Prediction</span></span>]() <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> grid = out.shape[out.shape.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>-<span class="hljs-number"><span class="hljs-number">1</span></span>].intValue <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> gridSize = <span class="hljs-type"><span class="hljs-type">YOLO</span></span>.inputSize / <span class="hljs-type"><span class="hljs-type">Float</span></span>(grid) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> classesCount = labels.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span> <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(out.shape) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> pointer = <span class="hljs-type"><span class="hljs-type">UnsafeMutablePointer</span></span>&lt;<span class="hljs-type"><span class="hljs-type">Double</span></span>&gt;(<span class="hljs-type"><span class="hljs-type">OpaquePointer</span></span>(out.dataPointer)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> out.strides.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span> &lt; <span class="hljs-number"><span class="hljs-number">3</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-type"><span class="hljs-type">YOLOError</span></span>.strideOutOfBounds } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> channelStride = out.strides[out.strides.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>-<span class="hljs-number"><span class="hljs-number">3</span></span>].intValue <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> yStride = out.strides[out.strides.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>-<span class="hljs-number"><span class="hljs-number">2</span></span>].intValue <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> xStride = out.strides[out.strides.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>-<span class="hljs-number"><span class="hljs-number">1</span></span>].intValue <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">offset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ch: Int, x: Int, y: Int)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Int</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ch * channelStride + y * yStride + x * xStride } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ..&lt; grid { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> y <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ..&lt; grid { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> box_i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ..&lt; <span class="hljs-type"><span class="hljs-type">YOLO</span></span>.boxesPerCell { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> boxOffset = box_i * (classesCount + <span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> bbx = <span class="hljs-type"><span class="hljs-type">Float</span></span>(pointer[offset(ch: boxOffset, x: x, y: y)]) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> bby = <span class="hljs-type"><span class="hljs-type">Float</span></span>(pointer[offset(ch: boxOffset + <span class="hljs-number"><span class="hljs-number">1</span></span>, x: x, y: y)]) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> bbw = <span class="hljs-type"><span class="hljs-type">Float</span></span>(pointer[offset(ch: boxOffset + <span class="hljs-number"><span class="hljs-number">2</span></span>, x: x, y: y)]) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> bbh = <span class="hljs-type"><span class="hljs-type">Float</span></span>(pointer[offset(ch: boxOffset + <span class="hljs-number"><span class="hljs-number">3</span></span>, x: x, y: y)]) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> confidence = sigmoid(<span class="hljs-type"><span class="hljs-type">Float</span></span>(pointer[offset(ch: boxOffset + <span class="hljs-number"><span class="hljs-number">4</span></span>, x: x, y: y)])) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> confidence &lt; confidenceThreshold { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> x_pos = (sigmoid(bbx) + <span class="hljs-type"><span class="hljs-type">Float</span></span>(x)) * gridSize <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> y_pos = (sigmoid(bby) + <span class="hljs-type"><span class="hljs-type">Float</span></span>(y)) * gridSize <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> width = exp(bbw) * <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.anchors[name]![<span class="hljs-number"><span class="hljs-number">2</span></span> * box_i] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> height = exp(bbh) * <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.anchors[name]![<span class="hljs-number"><span class="hljs-number">2</span></span> * box_i + <span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-built_in"><span class="hljs-built_in">c</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ..&lt; <span class="hljs-number"><span class="hljs-number">80</span></span> { classes[<span class="hljs-built_in"><span class="hljs-built_in">c</span></span>] = <span class="hljs-type"><span class="hljs-type">Float</span></span>(pointer[offset(ch: boxOffset + <span class="hljs-number"><span class="hljs-number">5</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">c</span></span>, x: x, y: y)]) } softmax(&amp;classes) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> (detectedClass, bestClassScore) = argmax(classes) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> confidenceInClass = bestClassScore * confidence <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> confidenceInClass &lt; confidenceThreshold { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> } predictions.append(<span class="hljs-type"><span class="hljs-type">Prediction</span></span>(classIndex: detectedClass, score: confidenceInClass, rect: <span class="hljs-type"><span class="hljs-type">CGRect</span></span>(x: <span class="hljs-type"><span class="hljs-type">CGFloat</span></span>(x_pos - width / <span class="hljs-number"><span class="hljs-number">2</span></span>), y: <span class="hljs-type"><span class="hljs-type">CGFloat</span></span>(y_pos - height / <span class="hljs-number"><span class="hljs-number">2</span></span>), width: <span class="hljs-type"><span class="hljs-type">CGFloat</span></span>(width), height: <span class="hljs-type"><span class="hljs-type">CGFloat</span></span>(height)))) } } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> predictions }</code> </pre><br></div></div><br>  <b>Penindasan non maks</b> <br><br>  Setelah Anda menerima koordinat dan ukuran kotak pembatas dan probabilitas terkait untuk semua objek yang ditemukan dalam gambar, Anda bisa mulai menggambarnya di atas gambar.  Tapi ada satu masalah!  Situasi seperti itu dapat muncul ketika beberapa kotak dengan probabilitas yang agak tinggi diprediksi untuk satu objek.  Apa yang harus dilakukan dalam kasus ini?  Di sini algoritma yang cukup sederhana yang disebut Non maksimal suppression datang untuk membantu kami. <br><br>  Algoritma adalah sebagai berikut: <br><br><ol><li>  Kami mencari kotak pembatas dengan probabilitas tertinggi untuk memiliki objek. </li><li>  Kami menjalankan semua kotak terikat yang juga milik objek ini. </li><li>  Kami menghapusnya jika Persimpangan over Union (IoU) dengan kotak pembatas pertama lebih besar dari ambang yang ditentukan. </li></ol><br>  IoU dihitung dengan menggunakan rumus sederhana: <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>I</mi><mi>o</mi><mi>U</mi></mrow><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>A</mi><mi>r</mi><mi>e</mi><mi>a</mi><mi>p</mi><mi>e</mi><mi>r</mi><mi>s</mi><mi>i</mi><mi>m</mi><mi>p</mi><mi>a</mi><mi>n</mi><mi>g</mi><mi>a</mi><mi>n</mi></mrow></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>A</mi><mi>r</mi><mi>e</mi><mi>a</mi><mi>A</mi><mi>s</mi><mi>o</mi><mi>s</mi><mi>i</mi><mi>a</mi><mi>s</mi><mi>i</mi></mrow></mrow></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="60.3ex" height="2.419ex" viewBox="0 -780.1 25962.6 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-74" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-65" x="611" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-78" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-74" x="1650" y="0"></use><g transform="translate(2012,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-49" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-6F" x="504" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-55" x="990" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMAIN-3D" x="4047" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-66" x="5353" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-72" x="5904" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-61" x="6355" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-63" x="6885" y="0"></use><g transform="translate(7318,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-74" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-65" x="611" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-78" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-74" x="1650" y="0"></use><g transform="translate(2012,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-41" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-72" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-65" x="1202" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-61" x="1668" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-70" x="2198" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-65" x="2701" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-72" x="3168" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-73" x="3619" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-69" x="4089" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-6D" x="4434" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-70" x="5313" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-61" x="5816" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-6E" x="6346" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-67" x="6946" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-61" x="7427" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-6E" x="7956" y="0"></use></g></g><g transform="translate(17887,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-74" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-65" x="611" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-78" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-74" x="1650" y="0"></use><g transform="translate(2012,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-41" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-72" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-65" x="1202" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-61" x="1668" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-41" x="2198" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-73" x="2948" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-6F" x="3418" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-73" x="3903" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-69" x="4373" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-61" x="4718" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-73" x="5248" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhi72SCG-SpRgSr00V81BufcKJQ7bA#MJMATHI-69" x="5717" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>I</mi><mi>o</mi><mi>U</mi></mrow><mo>=</mo><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>A</mi><mi>r</mi><mi>e</mi><mi>a</mi><mi>p</mi><mi>e</mi><mi>r</mi><mi>s</mi><mi>i</mi><mi>m</mi><mi>p</mi><mi>a</mi><mi>n</mi><mi>g</mi><mi>a</mi><mi>n</mi></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>A</mi><mi>r</mi><mi>e</mi><mi>a</mi><mi>A</mi><mi>s</mi><mi>o</mi><mi>s</mi><mi>i</mi><mi>a</mi><mi>s</mi><mi>i</mi></mrow></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-9"> \ text {IoU} = \ frac {\ text {Area persimpangan}} {\ text {Area Asosiasi}} </script></p><div class="spoiler">  <b class="spoiler_title">Perhitungan IoU.</b> <div class="spoiler_text"><pre> <code class="swift hljs"> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IOU</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a: CGRect, b: CGRect)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Float</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> areaA = a.width * a.height <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> areaA &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> areaB = b.width * b.height <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> areaB &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> intersection = a.intersection(b) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> intersectionArea = intersection.width * intersection.height <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">Float</span></span>(intersectionArea / (areaA + areaB - intersectionArea)) }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Penindasan non maks.</b> <div class="spoiler_text"><pre> <code class="swift hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nonMaxSuppression</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(boxes: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">inout</span></span></span></span><span class="hljs-function"><span class="hljs-params"> [Prediction], threshold: Float)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> i &lt; boxes.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> j = i + <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> j &lt; boxes.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> iou = <span class="hljs-type"><span class="hljs-type">YOLO</span></span>.<span class="hljs-type"><span class="hljs-type">IOU</span></span>(a: boxes[i].rect, b: boxes[j].rect) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> iou &gt; threshold { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> boxes[i].score &gt; boxes[j].score { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> boxes[i].classIndex == boxes[j].classIndex { boxes.remove(at: j) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { j += <span class="hljs-number"><span class="hljs-number">1</span></span> } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> boxes[i].classIndex == boxes[j].classIndex { boxes.remove(at: i) j = i + <span class="hljs-number"><span class="hljs-number">1</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { j += <span class="hljs-number"><span class="hljs-number">1</span></span> } } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { j += <span class="hljs-number"><span class="hljs-number">1</span></span> } } i += <span class="hljs-number"><span class="hljs-number">1</span></span> } }</code> </pre><br></div></div><br>  Setelah itu, bekerja langsung dengan hasil prediksi jaringan saraf dapat dianggap lengkap.  Selanjutnya, Anda perlu menulis fungsi dan kelas untuk mendapatkan rekaman dari kamera, menampilkan gambar di layar dan membuat kotak terikat yang diprediksi.  Saya tidak akan menjelaskan semua kode ini di artikel ini, tetapi dapat dilihat di repositori. <br><br>  Perlu juga disebutkan bahwa saya menambahkan sedikit penghalusan kotak pembatas saat memproses gambar online, dalam hal ini adalah rata-rata posisi dan ukuran kotak yang diprediksi selama 30 frame terakhir. <br><br><h4>  Menguji program </h4><br>  Sekarang kami menguji aplikasi. <br><br>  Izinkan saya mengingatkan Anda sekali lagi: Ada tiga ViewControllers dalam aplikasi, satu untuk memproses foto atau foto, satu untuk memproses aliran video online, dan yang ketiga untuk mengatur jaringan. <br><br>  Mari kita mulai dengan yang ketiga.  Di dalamnya Anda dapat memilih salah satu dari dua model YOLOv3-tiny atau YOLOv3-416, pilih ambang batas kepercayaan dan ambang batas IoU, Anda juga dapat mengaktifkan atau menonaktifkan anti-aliasing online. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/sb/zq/tz/sbzqtzy6hai51objkormfzvtbuq.jpeg"></div><br>  Sekarang mari kita lihat bagaimana neuron yang terlatih bekerja dengan gambar nyata, untuk ini kita mengambil foto dari galeri dan mengirimkannya melalui jaringan.  Gambar di bawah ini menunjukkan hasil YOLOv3-mungil dengan pengaturan yang berbeda. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nr/j3/fj/nrj3fjpw0yvxgl2cigujbcb-1p4.png"></div><br>  <i>Mode operasi YOLOv3-mungil berbeda.</i>  <i>Gambar kiri menunjukkan mode operasi yang biasa.</i>  <i>Di tengah - ambang IoU = 1 i.e.</i>  <i>seolah-olah penindasan Non-max hilang.</i>  <i>Di sebelah kanan adalah ambang rendah kepercayaan objek, yaitu</i>  <i>semua kotak pembatas yang mungkin ditampilkan.</i> <br><br>  Berikut ini adalah hasil dari YOLOv3-416.  Anda mungkin memperhatikan bahwa, dibandingkan dengan YOLOv3-tiny, frame yang dihasilkan lebih benar, serta objek yang lebih kecil dalam gambar dikenali, yang sesuai dengan pekerjaan lapisan output ketiga. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wc/nj/xq/wcnjxqeygnuriffqpatmtvevyfo.png"></div><br>  <i>Gambar diproses menggunakan YOLOv3-416.</i> <br><br>  Ketika mode operasi online dihidupkan, setiap frame diproses dan prediksi dibuat untuk itu, <b>tes dilakukan pada iPhone XS,</b> sehingga hasilnya cukup dapat diterima untuk kedua opsi jaringan.  <b>YOLOv3-tiny menghasilkan rata-rata 30 - 32 fps, YOLOv3-416 - dari 23 hingga 25 fps.</b>  Perangkat yang diuji cukup produktif, sehingga pada model sebelumnya hasilnya mungkin berbeda, dalam hal ini tentu saja lebih baik menggunakan YOLOv3-mungil.  Poin penting lainnya: yolo-tiny.mlmodel (YOLOv3-tiny) memakan waktu sekitar 35 MB, sementara yolo.mlmodel (YOLOv3 -16) memiliki berat sekitar 250 MB, yang merupakan perbedaan yang sangat signifikan. <br><br><h2>  Kesimpulan </h2><br>  Akibatnya, aplikasi iOS ditulis bahwa dengan bantuan jaringan saraf dapat mengenali objek dalam gambar.  Kami melihat bagaimana bekerja dengan pustaka CoreML dan bagaimana menggunakannya untuk menjalankan berbagai model pra-terlatih (omong-omong, Anda juga dapat berlatih dengannya).  Masalah pengenalan objek diselesaikan menggunakan jaringan YOLOv3.  Pada iPhone XS, jaringan ini (YOLOv3-tiny) mampu memproses gambar pada frekuensi ~ 30 frame per detik, yang cukup untuk operasi waktu nyata. <br><br>  Kode aplikasi lengkap dapat dilihat di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">GitHub</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id460869/">https://habr.com/ru/post/id460869/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id460859/index.html">Konferensi IThink # 3 di Kharkov - berdasarkan WWDC 2019</a></li>
<li><a href="../id460861/index.html">Lingkup dan penutupan leksikal JavaScript</a></li>
<li><a href="../id460863/index.html">Rincian kerusakan Cloudflare 2 Juli 2019</a></li>
<li><a href="../id460865/index.html">Orang-orang di bulan. Sumber</a></li>
<li><a href="../id460867/index.html">Sumber daya untuk secara otomatis dikonversi ke struktur objek Realm</a></li>
<li><a href="../id460873/index.html">Why Turok: Dinosaur Hunter untuk N64 adalah tahun-tahun sebelumnya</a></li>
<li><a href="../id460875/index.html">Bagaimana kami di QIWI sampai pada gaya interaksi yang umum antara View dan ViewModel dalam MVVM</a></li>
<li><a href="../id460877/index.html">Kubernetes-adventure Dailymotion: membangun infrastruktur di awan + di tempat</a></li>
<li><a href="../id460879/index.html">DUMP Kazan 2019 - Tatarstan Developers Conference. Kami menerima aplikasi untuk laporan</a></li>
<li><a href="../id460881/index.html">Kesulitan menerapkan teknologi OCR dalam sistem DLP, atau Bagaimana kami mempersiapkan OCR</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>