<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë∂üèæ üìÉ üë®üèª‚Äç‚öïÔ∏è Mais uma vez sobre o princ√≠pio da substitui√ß√£o de Lisk, ou a sem√¢ntica da heran√ßa no POO üíÑ üåñ üï¢</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A heran√ßa √© um dos pilares da OOP. A heran√ßa √© usada para reutilizar o c√≥digo comum. Por√©m, nem sempre √© necess√°rio reutilizar o c√≥digo comum, e a her...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mais uma vez sobre o princ√≠pio da substitui√ß√£o de Lisk, ou a sem√¢ntica da heran√ßa no POO</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463385/"> <b>A heran√ßa √© um dos pilares da OOP.</b>  A heran√ßa √© usada para reutilizar o c√≥digo comum.  Por√©m, nem sempre √© necess√°rio reutilizar o c√≥digo comum, e a heran√ßa nem sempre √© a melhor maneira de reutilizar o c√≥digo.  Muitas vezes acontece que, para que haja um c√≥digo semelhante em duas partes diferentes de c√≥digo (classes), mas os requisitos para elas s√£o diferentes, ou seja,  as classes realmente herdam umas das outras e podem n√£o valer a pena. <br><a name="habracut"></a><br>  Geralmente, para ilustrar esse problema, use o exemplo sobre a heran√ßa da classe Square da classe Rectangle ou vice-versa. <br><br>  Vamos ter uma classe de ret√¢ngulo: <br><br><pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Rectangle</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, width, height)</span></span></span><span class="hljs-function">:</span></span> self._width = width self._height = height <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set_width</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, width)</span></span></span><span class="hljs-function">:</span></span> self._width = width <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set_height</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, height)</span></span></span><span class="hljs-function">:</span></span> self._height = height <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_area</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self._width * self._height ...</code> </pre> <br>  Agora quer√≠amos escrever a classe Square, mas, para reutilizar o c√≥digo de c√°lculo da √°rea, parece l√≥gico herdar o Square do Rectangle: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Square</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Rectangle)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set_width</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, width)</span></span></span><span class="hljs-function">:</span></span> self._width = width self._height = width <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set_height</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, height)</span></span></span><span class="hljs-function">:</span></span> self._width = height self._height = height</code> </pre><br>  Parece que o c√≥digo das classes Square e Rectangle √© consistente.  Parece que o quadrado preserva as propriedades matem√°ticas do quadrado, ou seja,  e um ret√¢ngulo  Isso significa que podemos passar objetos quadrados em vez de ret√¢ngulo. <br><br>  Mas se fizermos isso, podemos violar o <i>comportamento</i> da classe Rectangle: <br><br>  Por exemplo, h√° um c√≥digo de cliente: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">client_code</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(rect)</span></span></span><span class="hljs-function">:</span></span> rect.set_height(<span class="hljs-number"><span class="hljs-number">10</span></span>) rect.set_width(<span class="hljs-number"><span class="hljs-number">20</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> rect.get_area() == <span class="hljs-number"><span class="hljs-number">200</span></span></code> </pre><br>  Se voc√™ passar uma inst√¢ncia da classe Square como argumento para essa fun√ß√£o, a fun√ß√£o se comportar√° de maneira diferente.  O que √© uma viola√ß√£o do contrato para o comportamento da classe Rectangle, porque as a√ß√µes com um objeto da classe base devem fornecer exatamente o mesmo resultado que o objeto da classe descendente. <br><br>  Se a classe quadrada √© descendente da classe ret√¢ngulo, trabalhando com o quadrado e executando os m√©todos do ret√¢ngulo, n√£o devemos nem perceber que n√£o √© um ret√¢ngulo. <br><br>  Voc√™ pode corrigir esse problema, por exemplo, assim: <br><br><ol><li>  fa√ßa uma declara√ß√£o para corresponder exatamente √† classe ou fa√ßa um se isso funcionar de maneira diferente para classes diferentes </li><li>  no Square, crie o m√©todo set_size () e substitua os m√©todos set_height, set_width para que eles lan√ßem exce√ß√µes <br>  etc etc </li></ol><br>  Esse c√≥digo e essas classes funcionar√£o, no sentido de que o c√≥digo estar√° funcionando. <br><br>  Outra quest√£o √© que o c√≥digo do cliente que usa a classe Square ou Rectangle precisar√° saber sobre a classe base e seu comportamento, ou sobre a classe descendente e seu comportamento. <br><br>  Com o tempo, conseguimos: <br><br><ul><li>  a classe descendente substituir√° a maioria dos m√©todos </li><li>  refatorar ou adicionar m√©todos √† classe base quebrar√° o c√≥digo usando descendentes </li><li>  no c√≥digo que usa os objetos da classe base, haver√° ifs, verificando a classe do objeto e o comportamento dos descendentes e da classe base √© diferente </li></ul><br>  Acontece que o c√≥digo do cliente gravado para a classe base fica dependente da implementa√ß√£o da classe base e da classe descendente.  O que complica muito o desenvolvimento ao longo do tempo.  E OOP foi criado apenas para que voc√™ pudesse editar a classe base e a classe descendente independentemente uma da outra. <br><br>  Nos anos 80 do s√©culo passado, percebemos que, para que a heran√ßa de classe funcionasse bem para a reutiliza√ß√£o de c√≥digo, precisamos ter certeza de que a classe descendente pode ser usada em vez da classe base.  I.e.  sem√¢ntica de heran√ßa - isso deve ser n√£o apenas e n√£o tanto dados como comportamento.  Os herdeiros n√£o devem "quebrar" o comportamento da classe base. <br><br>  Na verdade, esse √© o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">princ√≠pio da substitui√ß√£o de Lisk</a> ou o princ√≠pio de determinar um subtipo com base no comportamento de tipagem comportamental forte de classes: <b>se voc√™ puder escrever pelo menos algum c√≥digo significativo no qual substituir o objeto de classe base pelo objeto de classe descendente, ele ser√° quebrado, n√£o valer√° a pena. herd√°-los um do outro.</b>  Devemos estender o comportamento da classe base nos descendentes, e n√£o alter√°-lo significativamente.  As fun√ß√µes que usam a classe base devem poder usar objetos de subclasse sem conhec√™-lo.  De fato, essa √© a sem√¢ntica da heran√ßa no POO. <br><br>  E no c√≥digo industrial real, √© altamente recomend√°vel que esse princ√≠pio seja seguido e respeite a sem√¢ntica descrita da heran√ßa.  E com esse princ√≠pio, existem v√°rias sutilezas. <br><br>  <b>O princ√≠pio deve ser satisfeito n√£o com abstra√ß√µes no n√≠vel do dom√≠nio, mas com abstra√ß√µes de c√≥digo - classes.</b>  Do ponto de vista geom√©trico, um quadrado √© um ret√¢ngulo.  Do ponto de vista da hierarquia de heran√ßa de classe, se a classe de um quadrado ser√° o herdeiro do ret√¢ngulo da classe depende do comportamento que exigimos dessas classes.  Depende de como e em que situa√ß√µes usamos esse c√≥digo. <br><br>  Se a classe Rectangle tiver apenas dois m√©todos - calcular a √°rea e renderizar, sem a possibilidade de redesenhar e redimensionar, nesse caso, o Square com um construtor substitu√≠do atender√° ao princ√≠pio de substitui√ß√£o de Lisky. <br><br>  I.e.  essas classes satisfazem o princ√≠pio da substitui√ß√£o: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Rectangle</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">draw</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_area</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> ... <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Square</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Rectangle)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span></code> </pre><br>  Embora, obviamente, este n√£o seja um c√≥digo muito bom, e mesmo, provavelmente, o antipadr√£o do design de classes, mas do ponto de vista formal, ele satisfaz o princ√≠pio de Liskov. <br><br>  Outro <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">exemplo</a>  Um conjunto √© um subtipo de um multiset.  Essa √© a propor√ß√£o de abstra√ß√µes de dom√≠nio.  Mas o c√≥digo pode ser escrito para que herdemos a classe Set de Bag e o princ√≠pio da substitui√ß√£o seja violado, ou podemos escrever para que o princ√≠pio seja respeitado.  Com a mesma sem√¢ntica de dom√≠nio de assunto. <br><br>  Em geral, a heran√ßa de classes pode ser considerada como a implementa√ß√£o do relacionamento ‚ÄúIS‚Äù, mas n√£o entre as entidades da √°rea de assunto, mas entre classes.  E se a classe descendente √© um subtipo da classe base √© determinada pelas restri√ß√µes e comportamento da classe que o c√≥digo do cliente utiliza (e, em princ√≠pio, pode usar). <br><br>  <b>Restri√ß√µes, invariantes, um contrato de classe base n√£o s√£o fixos no c√≥digo, mas sim nas cabe√ßas dos desenvolvedores que editam e leem o c√≥digo.</b>  O que √© "quebrar", o que est√° quebrando o "contrato" √© determinado n√£o pelo c√≥digo, mas pela sem√¢ntica da classe na cabe√ßa do desenvolvedor. <br><br>  Qualquer c√≥digo que seja significativo para um objeto de uma classe base n√£o deve ser interrompido se o substituirmos por um objeto de uma classe descendente.  C√≥digo significativo √© qualquer c√≥digo de cliente que usa um objeto de uma classe base (e seus descendentes) dentro da estrutura da sem√¢ntica e restri√ß√µes da classe base. <br><br>  O que √© extremamente importante entender √© que as limita√ß√µes da abstra√ß√£o implementada na classe base geralmente n√£o est√£o contidas no c√≥digo do programa.  Essas restri√ß√µes s√£o entendidas, conhecidas e suportadas pelo desenvolvedor.  Ele monitora a consist√™ncia da abstra√ß√£o e do c√≥digo.  Para o c√≥digo expressar o que significa. <br><br>  Por exemplo, um ret√¢ngulo possui outro m√©todo que retorna uma visualiza√ß√£o em json <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Rectangle</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">to_dict</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {<span class="hljs-string"><span class="hljs-string">"height"</span></span>: self.height, <span class="hljs-string"><span class="hljs-string">"width"</span></span>: self.width}</code> </pre><br>  E na Square redefinimos: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Square</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">to_dict</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {<span class="hljs-string"><span class="hljs-string">"size"</span></span>: self.height}</code> </pre><br>  Se considerarmos que o contrato b√°sico para o comportamento da classe Rectangle to_json tenha altura e largura, o c√≥digo <br><br><pre> <code class="python hljs">r = rect.to_dict() log(r[<span class="hljs-string"><span class="hljs-string">'height'</span></span>], r[<span class="hljs-string"><span class="hljs-string">'width'</span></span>])</code> </pre><br>  ser√° significativo para um objeto da classe base Rectangle.  Ao substituir um objeto de uma classe base por uma classe, o c√≥digo herdeiro de Square altera seu comportamento e viola o contrato, violando o princ√≠pio da substitui√ß√£o de Lisk. <br><br>  Se acreditamos que o contrato b√°sico para o comportamento da classe Rectangle √© que to_dict retorna um dicion√°rio que pode ser serializado sem colocar campos espec√≠ficos, ent√£o esse m√©todo to_dict estar√° ok. <br><br>  A prop√≥sito, este √© um bom exemplo, destruindo o mito de que a imutabilidade evita a viola√ß√£o do princ√≠pio. <br><br>  Formalmente, qualquer substitui√ß√£o de um m√©todo em uma classe descendente √© perigosa, bem como altera√ß√µes na l√≥gica na classe base.  Por exemplo, muitas vezes as classes descendentes se adaptam ao comportamento "incorreto" da classe base e, quando o bug √© corrigido na classe base, elas quebram. <br><br>  √â poss√≠vel transferir todas as condi√ß√µes do contrato e invariantes para o c√≥digo o m√°ximo poss√≠vel, mas, no caso geral, a sem√¢ntica do comportamento permanece a mesma fora do c√≥digo - na √°rea do problema e √© suportada pelo desenvolvedor.  O exemplo sobre to_dict √© um exemplo em que o contrato pode ser descrito no c√≥digo, mas, por exemplo, verificar se o m√©todo get_hash realmente retorna um hash com todas as propriedades do hash, e n√£o apenas uma linha, √© imposs√≠vel. <br><br>  Quando um desenvolvedor usa c√≥digo escrito por outros desenvolvedores, ele pode entender quais s√£o as sem√¢nticas de uma classe apenas diretamente por c√≥digo, nomes de m√©todos, documenta√ß√£o e coment√°rios.  Mas, em qualquer caso, a sem√¢ntica √© frequentemente um dom√≠nio humano e, portanto, incorreto.  A consequ√™ncia mais importante: somente pelo c√≥digo - sintaticamente - √© imposs√≠vel verificar a conformidade com o princ√≠pio de Liskov, e voc√™ precisa confiar na sem√¢ntica (muitas vezes) vaga.  N√£o h√° meios formais (matem√°ticos) de uma maneira verific√°vel e garantida para verificar uma forte tipagem comportamental. <br><br>  Portanto, muitas vezes, em vez do princ√≠pio de Liskov, s√£o usadas regras formais para pr√©-condi√ß√µes e p√≥s-condi√ß√µes da programa√ß√£o de contratos: <br><br><ul><li>  as pr√©-condi√ß√µes em uma subclasse n√£o podem ser refor√ßadas - uma subclasse n√£o deve exigir mais do que a classe base </li><li>  as p√≥s-condi√ß√µes da subclasse n√£o podem ser relaxadas - a subclasse n√£o deve fornecer (prometer) menos que a classe base </li><li>  invariantes da classe base devem ser preservados na classe descendente. </li></ul><br>  Por exemplo, em um m√©todo de classe descendente, n√£o podemos adicionar um par√¢metro necess√°rio que n√£o estava na classe base - porque √© assim que fortalecemos as pr√©-condi√ß√µes.  Ou n√£o podemos lan√ßar exce√ß√µes no m√©todo substitu√≠do, porque  violar os invariantes da classe base.  Etc. <br><br>  <b>O que importa n√£o √© o comportamento atual da classe, mas o que a classe muda implica em responsabilidade ou sem√¢ntica da classe.</b> <b><br></b> <br>  O c√≥digo √© constantemente corrigido e alterado.  Portanto, se neste momento o c√≥digo atender ao princ√≠pio da substitui√ß√£o, isso n√£o significa que as altera√ß√µes no c√≥digo n√£o ir√£o mudar isso. <br><br>  Digamos que exista um desenvolvedor da classe de biblioteca Rectangle e um desenvolvedor de aplicativos que herda Square do Rectangle.  No momento em que o desenvolvedor do aplicativo herdou o Square da Rectangle - tudo estava bem, as classes atendiam ao princ√≠pio da substitui√ß√£o. <br><br>  E, em algum momento, o desenvolvedor respons√°vel pela biblioteca adicionou um m√©todo de remodelagem ou set_width / set_height √† classe base Rectangle.  Do seu ponto de vista, uma extens√£o da classe base acabou de acontecer.  Mas, de fato, houve uma mudan√ßa na sem√¢ntica e nos contratos nos quais a classe descendente dependia.  Agora as classes n√£o satisfazem mais o princ√≠pio. <br><br>  Em geral, ao herdar no OOP, altera√ß√µes na classe base que se parecer√£o com uma extens√£o da interface - outro m√©todo ou campo ser√£o adicionados podem violar contratos ‚Äúnaturais‚Äù anteriores e, assim, alterar a sem√¢ntica ou as responsabilidades.  Portanto, adicionar qualquer m√©todo √† classe base √© perigoso.  Voc√™ pode acidentalmente alterar o contrato acidentalmente. <br><br>  E de um ponto de vista pr√°tico, no exemplo com um ret√¢ngulo e uma classe, √© importante se existe agora um m√©todo de remodelagem ou set_width / set_height.  Do ponto de vista pr√°tico, √© importante qu√£o alta √© a probabilidade de tais altera√ß√µes no c√≥digo da biblioteca.  A sem√¢ntica ou os limites da responsabilidade de classe implicam essas mudan√ßas.  Se impl√≠cita, a probabilidade de erro e / ou necessidade adicional de refatora√ß√£o aumenta significativamente.  E se houver uma pequena possibilidade, provavelmente √© melhor n√£o herdar essas classes umas das outras. <br><br>  <b>Manter defini√ß√µes de subtipo baseadas no comportamento √© dif√≠cil, mesmo para classes simples com sem√¢ntica clara</b> , para n√£o falar de empresas com l√≥gica de neg√≥cios complexa.  Apesar do fato de que a classe base e a classe herdeiro s√£o diferentes partes do c√≥digo, para elas voc√™ precisa pensar com cuidado e cuidado nas interfaces e na responsabilidade.  E mesmo com uma ligeira mudan√ßa na sem√¢ntica da classe - que n√£o pode ser evitada de forma alguma, precisamos examinar o c√≥digo das classes relacionadas, verificar se o novo contrato ou invari√°vel viola o que j√° est√° escrito (!) E usado.  Com quase qualquer altera√ß√£o na hierarquia de classes ramificadas, precisamos procurar e verificar muitos outros c√≥digos. <br><br>  Essa √© uma das raz√µes pelas quais algumas pessoas n√£o gostam muito da heran√ßa cl√°ssica no POO.  E, portanto, geralmente preferem composi√ß√£o de classes, heran√ßa de interfaces, etc., etc.  em vez da heran√ßa cl√°ssica do comportamento. <br><br>  Para ser justo, h√° algumas regras que provavelmente n√£o violam o princ√≠pio da substitui√ß√£o.  Voc√™ pode se proteger o m√°ximo poss√≠vel se proibir todas as estruturas perigosas.  Por exemplo, para C ++, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Oleg</a> escreveu sobre isso.  Mas, em geral, essas regras n√£o transformam classes em classes no sentido cl√°ssico. <br><br>  Usando m√©todos administrativos, a tarefa tamb√©m n√£o est√° muito bem resolvida.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Aqui</a> voc√™ pode ler como o tio Martin se saiu em C ++ e como n√£o funcionou. <br><br>  <b>Mas no c√≥digo industrial real, muitas vezes, o princ√≠pio de Liskov √© violado, e isso n√£o √© assustador</b> .  √â dif√≠cil seguir o princ√≠pio, porque  1) a responsabilidade e a sem√¢ntica de uma classe geralmente n√£o s√£o expl√≠citas e n√£o s√£o expressas no c√≥digo 2) a responsabilidade de uma classe pode mudar - tanto na classe base quanto na classe descendente.  Mas isso nem sempre leva a consequ√™ncias realmente terr√≠veis.  A viola√ß√£o mais comum, mais simples e mais b√°sica √© que um m√©todo substitu√≠do modifica o comportamento.  Como por exemplo aqui: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Task</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">close</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.status = CLOSED ... <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProjectTask</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Task)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">close</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> status == STARTED: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> Exception(<span class="hljs-string"><span class="hljs-string">"Cannot close a started Project Task"</span></span>) ...</code> </pre><br>  O m√©todo close do ProjectTask lan√ßar√° uma exce√ß√£o nos casos em que os objetos da classe Task funcionem bem.  Em geral, a redefini√ß√£o de m√©todos de uma classe base muitas vezes leva a uma viola√ß√£o do princ√≠pio da substitui√ß√£o, mas n√£o se torna um problema. <br><br>  De fato, nesse caso, o desenvolvedor percebe a heran√ßa N√ÉO como uma implementa√ß√£o do relacionamento "IS", mas simplesmente como uma maneira de reutilizar o c√≥digo.  I.e.  uma subclasse √© apenas uma subclasse, n√£o um subtipo.  Nesse caso, de um ponto de vista pragm√°tico e pr√°tico, importa mais - mas qual √© a probabilidade de existir ou j√° existir um c√≥digo de cliente que notar√° sem√¢nticas diferentes dos m√©todos da classe descendente e da classe base? <br><br>  Existe muito c√≥digo que espera um objeto de uma classe base, mas para o qual passamos o objeto da classe descendente?  Para muitas tarefas, esse c√≥digo nunca existir√°. <br><br>  Quando uma viola√ß√£o do LSP leva a grandes problemas?  Quando, devido a diferen√ßas de comportamento, o c√≥digo do cliente precisar√° ser reescrito com altera√ß√µes na classe descendente e vice-versa.  Isso se torna especialmente um problema se esse c√≥digo de cliente √© um c√≥digo de biblioteca que n√£o pode ser alterado.  Se a reutiliza√ß√£o do c√≥digo n√£o conseguir criar depend√™ncias entre o c√≥digo do cliente e o c√≥digo da classe no futuro, mesmo com a viola√ß√£o do princ√≠pio de substitui√ß√£o de Liskov, esse c√≥digo poder√° n√£o causar grandes problemas. <br><br>  Em geral, durante o desenvolvimento, a heran√ßa pode ser vista de duas perspectivas: subclasses s√£o subtipos, com todas as limita√ß√µes da programa√ß√£o de contratos e o princ√≠pio Lisk, e subclasses s√£o uma maneira de reutilizar c√≥digo, com todos os seus problemas em potencial.  I.e.  voc√™ pode pensar e projetar responsabilidades e contratos de classe e n√£o se preocupar com o c√≥digo do cliente.  Pense sobre o que pode ser o c√≥digo do cliente, como as classes ser√£o usadas e esteja preparado para poss√≠veis problemas, mas em menor grau se preocupa em observar o princ√≠pio da substitui√ß√£o.  A decis√£o, como de costume, depende do desenvolvedor, o mais importante √© que a escolha em uma situa√ß√£o espec√≠fica seja consciente e que haja uma compreens√£o de quais pr√≥s, contras e armadilhas acompanham essa ou aquela solu√ß√£o. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt463385/">https://habr.com/ru/post/pt463385/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt463367/index.html">Aprendizado de m√°quina e teoria das restri√ß√µes</a></li>
<li><a href="../pt463369/index.html">Sobre servi√ßos para consultas m√©dicas</a></li>
<li><a href="../pt463371/index.html">TI fora de Moscou</a></li>
<li><a href="../pt463373/index.html">Portf√≥lio de Design UX: Melhores Pr√°ticas</a></li>
<li><a href="../pt463375/index.html">Wine no Windows 10. Funciona</a></li>
<li><a href="../pt463387/index.html">Path QA Fighter</a></li>
<li><a href="../pt463389/index.html">Personalize-o: como trabalhamos com as recomenda√ß√µes QIWI</a></li>
<li><a href="../pt463391/index.html">Como se casar com todos (casamento de um, dois e tr√™s sexos) do ponto de vista da matem√°tica e por que os homens sempre vencem</a></li>
<li><a href="../pt463393/index.html">Sua empresa √© uma fam√≠lia ou um time de esportes?</a></li>
<li><a href="../pt463397/index.html">Mercado de c√¢mbio e engenharia financeira na Idade M√©dia</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>