<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úäüèæ üëáüèΩ üö≠ Pr√©paration de l'application pour Android Q. Partie 1 üóúÔ∏è üí© üôç</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La traduction de l'article a √©t√© pr√©par√©e sp√©cialement pour les √©tudiants du cours "d√©veloppeur Android". Cours de base . " Nous vous rappelons √©galem...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pr√©paration de l'application pour Android Q. Partie 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/463811/">  <i>La traduction de l'article a √©t√© pr√©par√©e sp√©cialement pour les √©tudiants du cours <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">"d√©veloppeur Android".</a></i>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Cours de base</a> . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">"</a></i>  <i>Nous vous rappelons √©galement que nous continuons de nous inscrire au cours avanc√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">"Sp√©cialisation Android-d√©veloppeur"</a></i> <br><br><img src="https://habrastorage.org/webt/e1/nl/7d/e1nl7dhanfo-bzheggvlnlgd3na.png"><br><br><hr><br>  Nous sommes dans la 10e ann√©e de d√©veloppement Android (Android Q doit √™tre la version 10.0).  Selon Beta 4, Android Q a officiellement une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">API de niveau 29</a> .  Bien que la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">B√™ta 5</a> existe d√©j√† et que la B√™ta 6 soit attendue, l'API a √©t√© marqu√©e comme finale, et il est maintenant temps de voir comment Android Q affectera les applications et quels changements doivent √™tre apport√©s pour prendre pleinement en charge Android Q. <a name="habracut"></a><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pt/rl/f8/ptrlf8nhzcgu1_itjsakkiial6m.png"></div><br>  Les changements importants (pas tous) pr√©sent√©s dans Android Q peuvent √™tre divis√©s en deux cat√©gories: a) <b>confidentialit√© et s√©curit√©</b> , b) <b>exp√©rience utilisateur</b> . <br><br>  <i>Du traducteur: ¬´Nous avons divis√© la traduction en deux parties correspondant √† ces cat√©gories.</i>  <i>En cons√©quence, dans la premi√®re partie, nous parlerons de confidentialit√© et de s√©curit√©. "</i> <br><br><h3>  1) Confidentialit√© et s√©curit√© </h3><br><h4>  a) D√©marrage des activit√©s de base </h4><br>  Vous ne pouvez plus d√©marrer une activit√© lorsque votre application est en arri√®re-plan. <br><br><ul><li>  <b>Ce qui affecte:</b> toutes les applications ex√©cut√©es sur Q (quel que soit le SDK cible).  Une exception est lev√©e si Android Q est la version cible de l'application;  et l'activit√© ne d√©marre tout simplement pas si Android Q n'est pas le SDK cible pour l'application, mais il fonctionne sur un appareil avec Android Q. </li><li> <b>Exceptions:</b> services li√©s, tels que l'accessibilit√©, la saisie semi-automatique, etc. Si l'application re√ßoit un <code>PendingIntent</code> du syst√®me, nous pouvons l'utiliser pour d√©marrer l'activit√©.  Si l'application dispose de l'autorisation <code>SYSTEM_ALERT_WINDOW</code> (supprim√©e dans Android GO) ou de l'application r√©cemment appel√©e <code>finish()</code> pour Activity (il n'est pas recommand√© de s'y fier. ¬´R√©cemment¬ª peut √™tre tr√®s ambigu), alors votre application est exempte de cette restriction. </li><li>  <b>Approche recommand√©e:</b> activit√© de d√©clenchement de notification </li></ul><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> fullScreenIntent = Intent(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, CallActivity::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">val</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fullScreenPendingIntent</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PendingIntent</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">getActivity</span></span></span></span>(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, fullScreenIntent, PendingIntent.FLAG_UPDATE_CURRENT) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> notificationBuilder = NotificationCompat.Builder(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, CHANNEL_ID) .... .setPriority(NotificationCompat.PRIORITY_HIGH) .setCategory(NotificationCompat.CATEGORY_CALL) .setFullScreenIntent(fullScreenPendingIntent, <span class="hljs-literal"><span class="hljs-literal">true</span></span>)</code> </pre> <br>  Ajoutez le <code>Fullscreen PendingIntent</code> √† la notification.  Maintenant que la notification a fonctionn√©, le syst√®me lancera une intention plein √©cran. <br><br>  Par cons√©quent, si nous voulons d√©marrer Activity √† l'arri√®re-plan, cr√©ez d'abord une notification qui sera affich√©e √† l'utilisateur.  Dans cette notification, ajoutez <code>Fullscreen PendingIntent</code> .  Ajoutez √©galement l'autorisation <code>USE_FULL_SCREEN_INTENT</code> √† votre manifeste.  Maintenant que la notification a fonctionn√©, le syst√®me lancera une intention plein √©cran. <br><br><ul><li>  <b>Pi√®ges:</b> le syst√®me d√©cide quand afficher une notification et quand afficher une activit√©.  Si l'utilisateur utilise activement l'appareil, une notification contextuelle s'affiche.  Si l'appareil est au repos ou lorsque l'utilisateur interagit avec la notification, l'activit√© en plein √©cran d√©marre.  Par exemple, comme lors de la r√©ception d'un appel t√©l√©phonique (notifications contextuelles lors de l'utilisation du t√©l√©phone, sinon activit√© plein √©cran). </li></ul><br><h4>  b) Identifiants mat√©riels </h4><br>  L'acc√®s aux identifiants d'appareil non r√©initialisables a √©t√© r√©voqu√© dans Android Q. <br><br><ul><li>  <b>Ce qui affecte:</b> toutes les applications ex√©cut√©es sur Q (quel que soit le SDK cible).  Une exception est lev√©e si Q est le SDK cible;  et renvoie <code>null</code> si le SDK cible est inf√©rieur √† Q </li><li>  <b>√Ä √©viter: l'</b> adresse Mac est d√©sormais al√©atoire et l'IMEI ( <code>TelephonyManager.getDeviceId()</code> ) et le num√©ro de s√©rie ne sont plus disponibles.  Ce sont d√©sormais des ¬´autorisations privil√©gi√©es¬ª et ne sont disponibles que pour les applications op√©rateur. </li><li>  <b>Approche recommand√©e:</b> utilisez des identifiants r√©initialisables tels que Advertising ID, Instance ID ou Globally-unique ID (GUID).  Voir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Meilleures pratiques pour les identifiants uniques</a> pour plus d'informations sur l'identifiant √† utiliser dans quel cas. </li></ul><br><h4>  c) D√©finition d'arri√®re-plan de l'emplacement </h4><br>  √Ä partir d'Android Q, le syst√®me fera la distinction entre les demandes de localisation effectu√©es au premier plan et en arri√®re-plan. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/2-/tq/rk/2-tqrkkbbpp73pbwyr2izasqoxm.png"></div><br>  La demande d'autorisation d'acc√®s √† l'emplacement aura d√©sormais 3 options: Autoriser tout le temps, Autoriser uniquement lors de l'utilisation de l'application (acc√®s uniquement au premier plan) et Refuser (pas d'acc√®s). <br><br><ul><li>  <b>Effets:</b> cela d√©pend du SDK cible.  Si Q est le SDK cible de l'application, vous devez demander une nouvelle autorisation d'emplacement en arri√®re-plan.  Si l'application a un SDK cible diff√©rent, elle recevra automatiquement cette autorisation si elle avait d√©j√† des droits d'acc√®s √† l'emplacement. </li></ul><br><img src="https://habrastorage.org/webt/xv/9u/pi/xv9upiapzwlxh1ecfmr1t_ewvj8.png"><br>  <i>Image prise √† partir de la documentation du d√©veloppeur Android</i> <br><br><ul><li>  <b>Approche recommand√©e:</b> si l'application n√©cessite un acc√®s unique √† l'emplacement de l'utilisateur pour effectuer certaines t√¢ches, utilisez le service de premier plan avec le param√®tre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">foregroundServiceType</a> sp√©cifi√© comme <code>location</code> dans le fichier manifeste de l'application. </li></ul><br><pre> <code class="kotlin hljs">&lt;service android:name=<span class="hljs-string"><span class="hljs-string">"MyNavigationService"</span></span> android:foregroundServiceType=<span class="hljs-string"><span class="hljs-string">"location"</span></span> ... /&gt;</code> </pre> <br>  Si l'application a besoin d'un acc√®s constant √† l'emplacement de l'appareil, par exemple pour la cl√¥ture g√©ographique, elle peut configurer une demande pour autoriser l'acc√®s √† l'emplacement en arri√®re-plan.  Il n'est pas n√©cessaire de modifier d'autres aspects de l'application (par exemple, la fa√ßon dont l'emplacement est extrait et utilis√©).  Pour demander l'acc√®s √† un emplacement en arri√®re-plan, ajoutez l'autorisation <code>ACCESS_BACKGROUND_LOCATION</code> au manifeste: <br><br><pre> <code class="kotlin hljs">&lt;manifest&gt; &lt;uses-permission android:name=<span class="hljs-string"><span class="hljs-string">"android.permission.ACCESS_COARSE_LOCATION"</span></span> /&gt; &lt;uses-permission android:name=<span class="hljs-string"><span class="hljs-string">"android.permission.ACCESS_BACKGROUND_LOCATION"</span></span> /&gt; &lt;/manifest&gt; <span class="hljs-comment"><span class="hljs-comment">//Request for the permission like any other permission request: ActivityCompat.requestPermissions(this, arrayOf(Manifest.permission.ACCESS_COARSE_LOCATION, Manifest.permission.ACCESS_BACKGROUND_LOCATION), your-permission-request-code)</span></span></code> </pre> <br>  Demander l'acc√®s √† l'emplacement en arri√®re-plan <br><br><ul><li>  Pi√®ges: </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/_1/q3/zi/_1q3zi9aherji3wi542vkyb6igu.png"></div><br>  <i>Rappel affich√© par le syst√®me sur l'acc√®s √† un emplacement en arri√®re-plan</i> <br><br>  Quelques points importants √† garder √† l'esprit: l'utilisateur peut √™tre rappel√© apr√®s avoir donn√© √† l'application l'acc√®s √† l'emplacement de l'appareil en arri√®re-plan, et, comme toute autre autorisation, l'utilisateur peut r√©voquer l'autorisation pour cela.  Cela est particuli√®rement important pour les applications o√π Q n'est pas un SDK cible, mais qui s'ex√©cute sur des appareils avec Android Q, car il obtiendrait la r√©solution d'arri√®re-plan par d√©faut s'il avait l'autorisation de localisation.  Assurez-vous que votre application g√®re ces scripts avec √©l√©gance.  Pour cette raison, chaque fois qu'une application d√©marre un service ou demande un emplacement, v√©rifiez si l'utilisateur autorise toujours l'application √† acc√©der aux informations de localisation. <br><br>  √Ä ce sujet, la premi√®re partie de l'article s'est termin√©e et, comme promis, nous parlerons des exp√©riences utilisateur dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">deuxi√®me partie</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr463811/">https://habr.com/ru/post/fr463811/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr463795/index.html">Nuances de sens en anglais: comment utiliser les verbes conseiller, recommander, sugg√©rer</a></li>
<li><a href="../fr463799/index.html">Ce que je n'aime pas dans Windows 10</a></li>
<li><a href="../fr463801/index.html">3 qualit√©s cl√©s pour un chef de produit performant: Anton Stozhko</a></li>
<li><a href="../fr463803/index.html">Mon cinqui√®me jour avec Haiku: portons quelques programmes</a></li>
<li><a href="../fr463805/index.html">Sept livres pour ceux qui veulent devenir game designer</a></li>
<li><a href="../fr463813/index.html">Multivan et routage sur Mikrotik RouterOS</a></li>
<li><a href="../fr463815/index.html">Pourquoi une banque √©trang√®re s'int√©resse-t-elle √† la source de vos fonds?</a></li>
<li><a href="../fr463817/index.html">20 chefs de produits et la structure matricielle la plus multidimensionnelle de tous. Conversation avec Skyeng</a></li>
<li><a href="../fr463819/index.html">Verrous PostgreSQL: 2. Verrous de cha√Æne</a></li>
<li><a href="../fr463821/index.html">AMO, Bitrix, 1C et autres: comment choisir par o√π commencer?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>