<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤲🏼 💥 🙆🏽 在AR中玩俄罗斯方块 🕋 👩🏻‍🎓 ⭕️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="我想到这个房子可能是玩俄罗斯方块的好平台。 离我不远的地方只有一栋适合于此的建筑物。 结果可以在视频中看到： 


 该项目的实施水平很低，没有使用任何现成的解决方案。 

 源代码 

 大多数情况下，他们使用2个选项来实现增强现实： 



- 无标记的，即 摄像机的位置取决于视频流关键点的移动...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>在AR中玩俄罗斯方块</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/454664/"> 我想到这个房子可能是玩俄罗斯方块的好平台。 离我不远的地方只有一栋适合于此的建筑物。 结果可以在视频中看到： <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/eGaokauVQ2o" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> 该项目的实施水平很低，没有使用任何现成的解决方案。 <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">源代码</a> <br><a name="habracut"></a><br> 大多数情况下，他们使用2个选项来实现增强现实： <br><br><ul><li> 无标记的，即 摄像机的位置取决于视频流关键点的移动； </li><li> 图像作为相对于相机位置的标记。 </li></ul><br> 这些实现不需要特殊的准备或特殊的条件。 <br><br> 还有另一个实现选项-识别特定对象并将其用作标记。 这至少需要它的存在，但是可以对其进行视觉控制。 这种识别的方法之一是通过边缘检测物体。 它有局限性-标记对象必须具有明确定义的边缘，即 该对象最有可能是固体。 <br><br> 或应明确划定边缘，例如建筑物的照明： <br><br><img src="https://habrastorage.org/webt/51/y8/nt/51y8ntbjtnm_hdy6iy5v2pmwgsu.jpeg"><br><br> 可以看出，背光可以容易地在图像中分离并用于检测。 <br><br><h2> 实作 </h2><br> 在Qt。 该框架使您可以在不同的平台上同时使用C ++进行工作。 由于性能对我们很重要，因此专业人士似乎是一个显而易见的选择。 <br><br> 尽管Qt在android上无法很好地运行（长时间启动，已禁用调试），但是通过在桌面上调试算法的能力，这一切都得到了解决。 <br><br> 在嵌入Qt的原始OpenGL中可视化了三维图形。 <br><br> 相机的工作是通过Qt进行的。 录制了一个视频以进行调试，它非常方便，可以用文件中的视频流替换摄像机的视频流。 <br><br> 输出是通过qml工具进行的。 结交qml和OpenGL并不是没有问题，但是我们不会对此进行详细介绍。 <br><br> 为了进行图像处理，连接了OpenCV库。 <br><br><h4> 追踪算法 </h4><br> 现在，让我们继续进行最有趣的部分-沿对象边缘跟踪对象的算法。 <br> 并从突出显示图像的边缘开始。 在我们的案例中，所有边缘均具有直线形式，因此首先想到的是使用线检测器。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">霍夫变换</a>可以用作线检测器。 但是，在我看来，这种方式不是很正确，因为霍夫变换非常昂贵，而且该检测器也不是很可靠（这是主观的，也许一切取决于任务）。 <br> 相反，让我们以一种不同的，更一般的方式进行。 我们不会考虑我们的直线是直线的，但是我们只会在二进制图像上工作。 边缘的存在将被编码到二进制图像中。 即 值为零的像素表示此位置存在边缘，该像素值大于零-没有边缘。 可以使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Canny边界检测器</a>或简单的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">阈值转换</a>来获得此类图像。 这些算法可以在OpenCV中找到。 <br><br>  OpenCV现在对我们还有另一个有用的功能-distanceTransform，它在输入处获取一个二进制图像，并在输出处提供一个图像，以像素为单位，其中距离最近的零像素被编码。 <br><br> 现在，假设我们已经对模型的位置有了一个很好的近似。 接下来，我们描述误差函数，该函数描述近似值的边缘与结果图像中的边缘不一致的程度。 使用distanceTransform中的图像，我们已经能够做到这一点。 然后，我们运行函数优化算法，仅更改对象在空间中位置的近似值。 结果，我们的近似值应该相当准确地描述物体的真实位置。 <br> 结果，该算法可以分为两个阶段： <br><br><ol><li> 图像预处理-二值化，滤波和distanceTransfrom函数的使用。 </li><li> 跟踪-错误功能的优化。 </li></ol><br><h4> 图像预处理 </h4><br> 此时，您需要突出显示图像中的边缘。 您可以使用Canny边界检测器，但在我们的情况下，通常的阈值转换或其自适应版本效果更好（在OpenCV中，这些是阈值或adaptiveThreshold函数）。 显然，这样的图像上会有噪点，因此需要过滤。 让我们按照以下步骤进行操作-使用OpenCV函数<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">findCountours</a>选择轮廓，并删除太小或不够像线段的线段。 <br><br> 处理结果可以在图像中看到： <br><br><img src="https://habrastorage.org/webt/ef/g9/ts/efg9tspnpbvzqb1gn2o0cricah8.jpeg"><br><br> 一致：原始图像-&gt;阈值变换后-&gt;过滤后。 <br><br> 该图像已经很清楚地告诉我们哪里有右边，哪里没有。 之后，我们使用distanceTransform函数，结果，我们将获得有关每个点距边缘多远的信息。 结果图像表示为 <img src="https://habrastorage.org/webt/qt/cr/xz/qtcrxzl1ow1zbp0xoducghnxhms.png">  。 <br><br> 如果进行标准化和可视化，则外观如下： <br><br><img src="https://habrastorage.org/webt/ho/ll/vm/hollvmy8tp4ozcc424szu5pjjuc.jpeg"><br><br> 接下来，我们将需要一些数学工具。 <br><br><h5> 功能优化算法 </h5><br> 功能优化是寻找功能最小值的任务。 <br><br> 如果我们要处理线性方程组，那么找到最小值非常简单。 想象一下矩阵形式的方程组： <img src="https://habrastorage.org/webt/8o/ib/1o/8oib1oj6a6trr7kkhjozgiy3day.png">  ，那么我们的解决方案： <img src="https://habrastorage.org/webt/ly/rc/qu/lyrcqutfkhebqb6tqlrfix5d1ms.png">  。 如果我们有一个超定的方程组，那么我们可以使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">最小二乘法</a> ： <img src="https://habrastorage.org/webt/ll/4i/ok/ll4iok4um66gxr9zxre_lxlyylm.png">  。 <br><br> 如果我们的函数是非线性的，那么任务将变得更加复杂。 要找到最小值，可以使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Gauss-Newton算法</a> 。 该算法的工作原理如下： <br><br><ol><li> 假设我们已经对解决方案有了一些初步的近似 <img src="https://habrastorage.org/webt/mg/yf/5k/mgyf5kyuniayj8w1_veck_sgciq.png"> 我们将反复完善。 </li><li> 使用泰勒展开，我们可以在当前逼近点逼近非线性函数。 我们用最小二乘法求解所得的线性方程组，得到 <img src="https://habrastorage.org/webt/_l/so/zd/_lsozdiipx0ny5krc_nvtsklixq.png">  。 结果，所得解决方案将不是解决方案，但将比当前近似值更近。 </li><li> 替换当前的近似值 <img src="https://habrastorage.org/webt/mg/yf/5k/mgyf5kyuniayj8w1_veck_sgciq.png"> 收到决定 <img src="https://habrastorage.org/webt/_l/so/zd/_lsozdiipx0ny5krc_nvtsklixq.png"> 并转到步骤2。 <img src="https://habrastorage.org/webt/n_/t0/bp/n_t0bpjlwogupz25g2toyse8w60.png"> 和 <img src="https://habrastorage.org/webt/2u/gv/-3/2ugv-3nsnzjslkonizusvzbgbuo.png"> 将不小于特定值。 </li></ol><br> 让我们更详细地分析算法。 <br><br> 让 <img src="https://habrastorage.org/webt/vc/j3/mp/vcj3mpo1jjwkew5a0enemocdyoq.png">  -工作功能， <img src="https://habrastorage.org/webt/i5/uo/zz/i5uozzwwbb4_f-ivitxfs2qferi.png">  -函数值的先前已知向量。 完美的方程式解决方案 <img src="https://habrastorage.org/webt/ht/2u/lo/ht2ulowooc32s10ajclpbeug1w4.png"> 以下说法是正确的 <img src="https://habrastorage.org/webt/m-/dk/pv/m-dkpv_tnys9clufhps155qfxkq.png">  。 但是我们只有它的近似值 <img src="https://habrastorage.org/webt/mg/yf/5k/mgyf5kyuniayj8w1_veck_sgciq.png">  。 然后，该近似值的误差向量表示为： <img src="https://habrastorage.org/webt/_v/d4/n1/_vd4n1yd6irh6smzqcnpswmmbjm.png">  。 该函数的一般错误将是： <img src="https://habrastorage.org/webt/8d/lf/me/8dlfmeklxb1jvlffcyk8w0vb478.png">  。 现在发现这样 <img src="https://habrastorage.org/webt/n_/t0/bp/n_t0bpjlwogupz25g2toyse8w60.png"> 在哪 <img src="https://habrastorage.org/webt/xl/um/pw/xlumpww55az0itxqrtigh2qofqg.png"> 将达到最小值，我们将获得更好的解决方案近似值 <img src="https://habrastorage.org/webt/ht/2u/lo/ht2ulowooc32s10ajclpbeug1w4.png">  。 <br> 从方法开始 <img src="https://habrastorage.org/webt/mg/yf/5k/mgyf5kyuniayj8w1_veck_sgciq.png"> 我们将迭代逼近，每次迭代 <img src="https://habrastorage.org/webt/n_/t0/bp/n_t0bpjlwogupz25g2toyse8w60.png">  。 为此，我们需要进行每次迭代以计算该函数<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">的Jacobi矩阵</a> <img src="https://habrastorage.org/webt/vc/j3/mp/vcj3mpo1jjwkew5a0enemocdyoq.png"> 对于当前的近似值，由我们函数的导数组成： <br><img src="https://habrastorage.org/webt/m1/g0/g-/m1g0g-jmv04dlsbyoivbvjbwpwi.png"><br> 并给出以下近似值： <img src="https://habrastorage.org/webt/lm/xc/y4/lmxcy4rjlhtxgwz_lb8kpi1cpys.png">  。 <br> 通常，任务的构造方式使我们拥有大量彼此独立的数据（仅与值无关）。 <img src="https://habrastorage.org/webt/ht/2u/lo/ht2ulowooc32s10ajclpbeug1w4.png">  ） 结果，一般的雅可比矩阵非常稀疏。 有一种方法可以优化计算。 <br> 假设从一组点计算出一个公共函数。 从第<i>j</i>点我们得到 <img src="https://habrastorage.org/webt/29/lv/wk/29lvwk822xw4y0xlriuxrxx4gli.png">  。 代替计算雅可比矩阵 <img src="https://habrastorage.org/webt/fu/vl/ui/fuvluirwbxatvxammyfzrbkxwug.png"> 对于整个函数，我们专门计算雅可比矩阵 <img src="https://habrastorage.org/webt/29/lv/wk/29lvwk822xw4y0xlriuxrxx4gli.png"> 并表示为： <img src="https://habrastorage.org/webt/zf/al/h0/zfalh0ntw3nupwu56dhc7u0fzn0.png">  。 然后，将给出以下近似值： <img src="https://habrastorage.org/webt/hl/2k/d6/hl2kd6neuqqtrclxyf6efubd8by.png">  。 此外，此更改使您可以并行计算。 <br> 可能发生以下值 <img src="https://habrastorage.org/webt/2u/gv/-3/2ugv-3nsnzjslkonizusvzbgbuo.png"> 会犯一个比 <img src="https://habrastorage.org/webt/n_/t0/bp/n_t0bpjlwogupz25g2toyse8w60.png">  。 要解决此问题，您可以使用算法的改进形式<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-Levenberg-Marquardt算法</a> 。 增值 <img src="https://habrastorage.org/webt/zi/jx/hs/zijxhs_ibqcwfjnfdefeoh7fwqu.png"> 变成我们的公式： <img src="https://habrastorage.org/webt/d-/jv/hi/d-jvhiklwzbaxqihirj97fnyvg4.png"> 在哪里 <img src="https://habrastorage.org/webt/hp/qi/1y/hpqi1yohaku8yblniy_qjap0ghe.png"> 是单位矩阵。 价值 <img src="https://habrastorage.org/webt/zi/jx/hs/zijxhs_ibqcwfjnfdefeoh7fwqu.png"> 选择如下： <br><ul><li> 首先，它具有一些相当小的值（以使算法收敛）； </li><li> 那么如果有错误 <img src="https://habrastorage.org/webt/2u/gv/-3/2ugv-3nsnzjslkonizusvzbgbuo.png"> 超过 <img src="https://habrastorage.org/webt/n_/t0/bp/n_t0bpjlwogupz25g2toyse8w60.png">  ，然后增加价值 <img src="https://habrastorage.org/webt/zi/jx/hs/zijxhs_ibqcwfjnfdefeoh7fwqu.png"> 并尝试计算错误 <img src="https://habrastorage.org/webt/2u/gv/-3/2ugv-3nsnzjslkonizusvzbgbuo.png"> 再来一次 </li></ul><br> 函数越非线性 <img src="https://habrastorage.org/webt/vc/j3/mp/vcj3mpo1jjwkew5a0enemocdyoq.png"> 该值应该越大 <img src="https://habrastorage.org/webt/zi/jx/hs/zijxhs_ibqcwfjnfdefeoh7fwqu.png">  。 但是价值越大 <img src="https://habrastorage.org/webt/zi/jx/hs/zijxhs_ibqcwfjnfdefeoh7fwqu.png">  ，算法收敛速度越慢。 <br><br> 我们何时完成算法 <img src="https://habrastorage.org/webt/2u/gv/-3/2ugv-3nsnzjslkonizusvzbgbuo.png"> 与...不同 <img src="https://habrastorage.org/webt/n_/t0/bp/n_t0bpjlwogupz25g2toyse8w60.png"> 小到拿 <img src="https://habrastorage.org/webt/2u/gv/-3/2ugv-3nsnzjslkonizusvzbgbuo.png"> 作为解决方案。 <br><br> 该算法非常通用，可用于多种任务。 <br><br><h5> 数学跟踪模型 </h5><br> 由于我们正在处理空间中的坐标，因此很明显，我们需要能够操纵这些坐标。 假设我们有一些要点 <img src="https://habrastorage.org/webt/pi/mv/hb/pimvhb7w8_hegkijjpdddui99ts.png">  。 我们需要将它们绕零坐标的点旋转。 可能最简单的方法是使用旋转矩阵<i>R</i> ，它描述了必要的旋转： <img src="https://habrastorage.org/webt/dn/qr/lf/dnqrlfvvkeyngvdbbqy8uwnbgyk.png">  。 如果我们需要移动点，则只需添加所需的向量<i>t</i> ： <img src="https://habrastorage.org/webt/ds/qc/jc/dsqcjcik5lk13aheb3_q78x8x6s.png">  。 <br> 因此，您可以随意更改对象在空间中的位置。 事实证明，物体的坐标是由三维矩阵<i>R</i>和三维矢量<i>t确定的</i> 。  12个参数 而且，这些参数不是彼此独立的，旋转矩阵的分量在一定条件下相互连接。 因此，从在优化中使用这些功能的角度来看，这些参数不是最佳解决方案。 参数多于自由度，它们之间存在关系。 还有另一种旋转形式- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">罗德里格（Rodrigue）的旋转公式</a> 。 该旋转由三个参数指定，形成一个三维矢量。 <br><br> 归一化向量是旋转轴，该向量的长度是绕该轴的旋转角度。 <br><br> 我们设置向量<i>v</i>的旋转函数： <img src="https://habrastorage.org/webt/kl/hc/cz/klhccza_fs2fv8gmvh3uovdnzvw.png"> 使用Rodrigue公式的<i>r</i>参数。 我们从中得到以下公式： <img src="https://habrastorage.org/webt/_s/sg/p1/_ssgp1pn5q49yx32g-zkluqkn8u.png">  。 <br> 最后，我们可以使用6维向量设置对象位置的坐标： <img src="https://habrastorage.org/webt/mb/mo/dl/mbmodlujklivexjnp7zo0eyup_o.png"><br> 我们得到以下公式： <img src="https://habrastorage.org/webt/ih/ls/hx/ihlshxts9oar5kcqw4l0a0ilj1w.png">  。 <br><br><h5> 针孔相机型号 </h5><br> 现在，我们描述项目中使用的相机的简单数学模型： <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi></mrow><mo>=</mo><mtext mathcolor=&quot;red&quot;>\&amp;#x5F00;</mtext><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x59CB;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>x</mi></mrow><msub><mi>p</mi><mi>x</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF06;</mo></mrow><msub><mi>p</mi><mi>y</mi></msub><mtext mathcolor=&quot;red&quot;>\&amp;#x7ED3;</mtext><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x675F;</mo></mrow><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>x</mi></mrow><mi>T</mi></msup><mo>=</mo><mi>c</mi><mi>a</mi><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>v</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow><mo>=</mo><mtext mathcolor=&quot;red&quot;>\&amp;#x5F00;</mtext><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x59CB;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>x</mi></mrow><msub><mi>f</mi><mi>x</mi></msub><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>v</mi><mi>x</mi></msub></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>v</mi><mi>z</mi></msub></mrow><mo>+</mo><msub><mi>c</mi><mi>x</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF06;</mo></mrow><msub><mi>f</mi><mi>y</mi></msub><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>v</mi><mi>y</mi></msub></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>v</mi><mi>z</mi></msub></mrow><mo>+</mo><msub><mi>c</mi><mi>y</mi></msub><mtext>&amp;#xA0;</mtext><mi>e</mi><mi>n</mi><mi>d</mi><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>x</mi></mrow><mi>T</mi></msup></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="125.126ex" height="3.142ex" viewBox="0 -987.6 53873.7 1352.7" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-65" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-63" x="1202" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-70" x="1635" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMAIN-3D" x="2416" y="0"></use><g fill="red" stroke="red" transform="translate(3473,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMAIN-5C"></use><g transform="translate(500,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">开</text></g></g><g transform="translate(4803,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">始</text></g><g transform="translate(5633,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-6D" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-61" x="1382" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-74" x="1911" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-72" x="2273" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-69" x="2724" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-78" x="3070" y="0"></use></g><g transform="translate(9276,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-78" x="712" y="-213"></use></g><g transform="translate(10284,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">＆</text></g><g transform="translate(11114,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-79" x="712" y="-213"></use></g><g fill="red" stroke="red" transform="translate(12069,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMAIN-5C"></use><g transform="translate(500,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">结</text></g></g><g transform="translate(13400,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">束</text></g><g transform="translate(14230,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-6D" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-61" x="1382" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-74" x="1911" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-72" x="2273" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-69" x="2724" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-78" x="3070" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-54" x="5151" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMAIN-3D" x="18748" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-63" x="19804" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-61" x="20238" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-6D" x="20767" y="0"></use><g transform="translate(21646,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-76" x="22726" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-65" x="23211" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-63" x="23678" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-76" x="24111" y="0"></use><g transform="translate(24597,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMAIN-3D" x="25705" y="0"></use><g fill="red" stroke="red" transform="translate(26761,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMAIN-5C"></use><g transform="translate(500,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">开</text></g></g><g transform="translate(28091,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">始</text></g><g transform="translate(28921,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-6D" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-61" x="1382" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-74" x="1911" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-72" x="2273" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-69" x="2724" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-78" x="3070" y="0"></use></g><g transform="translate(32564,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-66" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-78" x="693" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-66" x="33809" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-72" x="34360" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-61" x="34811" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-63" x="35341" y="0"></use><g transform="translate(35774,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-78" x="686" y="-213"></use></g><g transform="translate(36764,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-7A" x="686" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMAIN-2B" x="37903" y="0"></use><g transform="translate(38904,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-63" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-78" x="613" y="-213"></use></g><g transform="translate(39842,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">＆</text></g><g transform="translate(40672,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-66" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-79" x="693" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-66" x="41865" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-72" x="42415" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-61" x="42867" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-63" x="43396" y="0"></use><g transform="translate(43830,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-79" x="686" y="-213"></use></g><g transform="translate(44767,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-7A" x="686" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMAIN-2B" x="45906" y="0"></use><g transform="translate(46907,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-63" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-79" x="613" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-65" x="48042" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-6E" x="48509" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-64" x="49109" y="0"></use><g transform="translate(49633,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-6D" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-61" x="1382" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-74" x="1911" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-72" x="2273" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-69" x="2724" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-78" x="3070" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-54" x="5151" y="583"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi></mrow><mo>=</mo><mtext mathcolor="red">\开</mtext><mrow class="MJX-TeXAtom-ORD"><mo>始</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>x</mi></mrow><msub><mi>p</mi><mi>x</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>＆</mo></mrow><msub><mi>p</mi><mi>y</mi></msub><mtext mathcolor="red">\结</mtext><mrow class="MJX-TeXAtom-ORD"><mo>束</mo></mrow><msup><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>x</mi></mrow><mi>T</mi></msup><mo>=</mo><mi>c</mi><mi>a</mi><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>v</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow><mo>=</mo><mtext mathcolor="red">\开</mtext><mrow class="MJX-TeXAtom-ORD"><mo>始</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>x</mi></mrow><msub><mi>f</mi><mi>x</mi></msub><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>v</mi><mi>x</mi></msub></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>v</mi><mi>z</mi></msub></mrow><mo>+</mo><msub><mi>c</mi><mi>x</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>＆</mo></mrow><msub><mi>f</mi><mi>y</mi></msub><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>v</mi><mi>y</mi></msub></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>v</mi><mi>z</mi></msub></mrow><mo>+</mo><msub><mi>c</mi><mi>y</mi></msub><mtext>&nbsp;</mtext><mi>e</mi><mi>n</mi><mi>d</mi><msup><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>x</mi></mrow><mi>T</mi></msup></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> \ vec {p} = \开始{pmatrix} p_x＆p_y \结束{pmatrix} ^ T = cam（\ vec {v}）= \开始{pmatrix} f_x \ frac {v_x} {v_z} + c_x＆f_y \ frac {v_y} {v_z} + c_y \ end {pmatrix} ^ T </script></p> 在哪里 <img src="https://habrastorage.org/webt/4y/1n/eo/4y1neonrkqigjzoumocsltdvi-e.png">  -焦距（以像素为单位）； <img src="https://habrastorage.org/webt/en/zb/z6/enzbz61iibgzcsxm0jtasbuek28.png">  -光学中心也以像素为单位。 这些是单独的摄像机参数，称为摄像机的固有参数。 通常，这些参数是预先已知的。 在这个项目中，这些参数是通过肉眼选择的。 <br><br> 该模型未考虑相机的镜头畸变（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">畸变</a> ）。 假设它们不是。 <br><br> 使用此模型，我们得到一个中心投影，其所有点都更趋向于光学中心，离摄像机越远。 因此，我们得到了铁路收窄的影响： <br><br><img src="https://habrastorage.org/webt/3c/a2/gn/3ca2gngkegajdjw25-gm6zgy3_u.jpeg"><br><br> 在空间中，相机与<i>z</i>轴对齐，图像平面平行于<i>xy</i>平面。 我们通过在空间中移动的能力来补充我们的模型： <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi></mrow><mi>j</mi></msub><mo>=</mo><mi>c</mi><mi>a</mi><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mi>r</mi><mi>o</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>x</mi></mrow><mi>r</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>v</mi></mrow><mi>j</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow><mo>+</mo><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>x</mi></mrow><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="46.64ex" height="2.901ex" viewBox="0 -780.1 20081.2 1249" role="img" focusable="false" style="vertical-align: -1.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-65" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-63" x="1202" y="0"></use><g transform="translate(1635,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-6A" x="712" y="-326"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMAIN-3D" x="2808" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-63" x="3864" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-61" x="4298" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-6D" x="4827" y="0"></use><g transform="translate(5706,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-72" x="6536" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-6F" x="6987" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-74" x="7473" y="0"></use><g transform="translate(7834,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-76" x="8914" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-65" x="9400" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-63" x="9866" y="0"></use><g transform="translate(10300,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-72" x="809" y="-213"></use></g><g transform="translate(11291,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-76" x="12371" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-65" x="12857" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-63" x="13323" y="0"></use><g transform="translate(13757,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-6A" x="686" y="-213"></use></g><g transform="translate(14634,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMAIN-2B" x="15686" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-76" x="16937" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-65" x="17423" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-63" x="17889" y="0"></use><g transform="translate(18323,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgWZBSUMeDg4VkN0Vnj-kS5GHunoQ#MJMATHI-74" x="809" y="-213"></use></g><g transform="translate(19251,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><msub><mrow class="MJX-TeXAtom-ORD"><mi>p</mi></mrow><mi>j</mi></msub><mo>=</mo><mi>c</mi><mi>a</mi><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mi>r</mi><mi>o</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><msub><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow><mi>r</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><msub><mrow class="MJX-TeXAtom-ORD"><mi>v</mi></mrow><mi>j</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow><mo>+</mo><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><msub><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> \ vec {p} _j = cam（rot（\ vec {x} _r，\ vec {v} _j）+ \ vec {x} _t）</script></p><br> 因此，我们获得了一个模型，利用该模型可以以代数形式模拟从外部世界到摄像机图像（从世界坐标到屏幕）的点投影。 对于我们而言，在此模型中相机在空间中的相对位置的参数仍然未知。 <img src="https://habrastorage.org/webt/ln/ib/-f/lnib-foisc9iu_aqy0wernf1xgu.png">  。 这些参数称为相机的外部参数。 <br><br><h5> 追踪 </h5><br> 无需OpenCV工具即可实现。 首先，我们需要获得上述近似解决方案的误差函数。 我们将分阶段编写其计算： <br><br><ol><li> 我们根据当前近似参数选择跟踪模型的可见边缘。 </li><li> 我们将选定的一组边线变成一组固定的点，以简化计算。 例如，可以从每个边缘获取第n个点，或者（一种更正确的选择）选择一个数量，以使这些点之间的像素之间具有固定的距离。 我们将它们称为控制点（在项目中：controlPoint-控制点和controlPixelDistance-相同的固定距离，以像素为单位）。 </li><li> 我们在图像上投影控制点。 借助<i>distanceImage，</i>我们可以获得控制点的投影到图像边缘的距离。 在理想情况下，所有控制点都应严格位于图像边缘，即 到肋骨的距离应为零。 基于此，我们得到特定控制点的错误： <img src="https://habrastorage.org/webt/aj/yl/of/ajylofx-nqzxqkzyaaxwcczmd6a.png">  。 </li><li> 我们得到以下错误函数： <img src="https://habrastorage.org/webt/o8/u-/8w/o8u-8wwvnt2jhgyulfun8kyzh6k.png"></li></ol><br> 现在仍然需要找到最小的<i>E。</i> 为此，我们使用上述的Levenberg-Marquardt算法。 众所周知，该算法需要计算雅可比矩阵，即 派生函数。 您可以使用导数的数值发现。 您也可以对这种算法使用一些现成的解决方案。 但是，在该项目中，所有内容都是手动编写的，因此，我将描述整个解决方案的完整结论。 <br><br> 对于每个控制点，我们获得独立于其他点的方程。 上面已经描述了，在这种情况下，可以彼此独立地考虑这些方程，从而专门为每个方程计算雅可比矩阵。 我们将使用复杂函数的微分规则对命令进行分析： <br><br><img src="https://habrastorage.org/webt/qf/lm/3t/qflm3tr6vrmyirsufolpiwmlte4.png"><br><br> 我们表示 <img src="https://habrastorage.org/webt/_b/_i/i1/_b_ii1eklzapugxeahtbl7wwuky.png"> 然后 <img src="https://habrastorage.org/webt/tr/pz/a-/trpza-t1j_sr_otvetkquuvnac8.png"><br><br><img src="https://habrastorage.org/webt/en/k3/2q/enk32qx_j0zgvqzujalzydlfxyi.png"><br><br> 从这里： <br><br><img src="https://habrastorage.org/webt/ld/nh/s1/ldnhs1vypzpsx_mxlu6wjat4qtm.png"><br><br> 我们进一步表示 <img src="https://habrastorage.org/webt/dl/2z/q0/dl2zq0jren9jpbmbpoaexelsrhw.png"> 和 <img src="https://habrastorage.org/webt/gb/kc/ps/gbkcpsry9q7nmsdz2kqpq-6br6y.png"> 然后： <br><img src="https://habrastorage.org/webt/et/_j/ez/et_jez8fzupc2jtpk3bhteevl7y.png"><br><br>  <i>distanceImage</i>的导数是数字形式的。 并用于计算向量 <img src="https://habrastorage.org/webt/iq/ur/_3/iqur_3xmxhxrdeia7bnkmonogxi.png"> 和 <img src="https://habrastorage.org/webt/z-/fy/qz/z-fyqzcgc19axrhujj5y6v0lxcm.png"> 您将需要根据Rodrigue的旋转公式找到导数。 我在出版物<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“ 3D旋转导数的紧凑公式”中</a>找到了雅可比矩阵<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">。</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">指数坐标»吉列尔莫·加列戈，安东尼·叶兹</a> ： <br><br><img src="https://habrastorage.org/webt/lb/rr/cr/lbrrcr3knmrvyjbessogjsvjyos.png">  ， <br> 其中<i>R</i>是根据旋转向量通过Rodrigue公式获得的旋转矩阵 <img src="https://habrastorage.org/webt/qz/bd/pe/qzbdpe7zjfanzdyip7acfhwgwvo.png">  ; <img src="https://habrastorage.org/webt/bn/9c/-b/bn9c-blmg7tsys7l83pbu-2upny.png">  -我们正在转向的重点；  <i>我</i>是单位矩阵； <img src="https://habrastorage.org/webt/lq/im/g6/lqimg6wecrfth32alae6l435sxk.png">  。 正如我们在此处看到的，我们用旋转矢量的长度除以，如果矢量为零，则公式不再起作用。 这可能是由于在零矢量处未定义旋转轴这一事实。 如果旋转矢量非常接近于零，那么我们使用以下公式： <img src="https://habrastorage.org/webt/sm/hk/dc/smhkdchm-zr63paet8-nm_jftwo.png">  。 <br> 它仍然要绘画 <img src="https://habrastorage.org/webt/iq/ur/_3/iqur_3xmxhxrdeia7bnkmonogxi.png"> 和 <img src="https://habrastorage.org/webt/z-/fy/qz/z-fyqzcgc19axrhujj5y6v0lxcm.png">  （此处省略索引<i>j</i> ）： <br><br><img src="https://habrastorage.org/webt/nt/xz/lf/ntxzlffpi42xgp1imuodytk2bqc.png"><img src="https://habrastorage.org/webt/hx/nz/pb/hxnzpbadbgyhlb2doqetg7f4iea.png"><br> 因此，我们获得了所需点的Jacobi矩阵，并将其用于上述优化算法。 <br><br> 该算法存在几个问题。 首先，准确性。 结果，摄像机的全局位置在帧与帧之间略有跳跃。 您可以修复一下。 我们有一个先验信息，即摄像机的位置不会在帧与帧之间发生剧烈变化。 我们可以通过向函数添加其他方程式来减少这种抖动。 <br><br> 应当记住，在我们的情况下，位移矢量<i>t</i>不是摄像机全局位置的坐标。 全局位置是一个零坐标的局部点，因此可以如下得出： <br><br><img src="https://habrastorage.org/webt/ly/zk/bk/lyzkbkk1zig1yfqu2shk9ziogbc.png"><br><br> 我们记得上一帧在<i>prevGlobalPosition中</i>的位置。 现在以前的位置应该接近于零，即 向量长度 <img src="https://habrastorage.org/webt/hv/lb/ww/hvlbwwdmw-wcymqnyxvaosx75mc.png"> 应该足够小。 即 除了差异的其他值，向量<i>d</i>也必须最小化。 为了确定此修改的影响程度，我们引入了 <img src="https://habrastorage.org/webt/25/ij/uy/25ijuyi5965hui7hbmywcsgfnuy.png"> 并乘以向量<i>d</i> <img src="https://habrastorage.org/webt/25/ij/uy/25ijuyi5965hui7hbmywcsgfnuy.png">  ： <img src="https://habrastorage.org/webt/pc/eo/6_/pceo6_067ezk979vii2pi4ex8k4.png">  。 即 在优化算法中，我们另外将向量<i>d'</i>最小化。 当然，为此，有必要为其计算雅可比矩阵，该雅可比矩阵的推导方法与上文针对一般误差函数所推导的方法相同。 <br><br> 该算法的第二个问题是它可能陷入局部最小值。 在其他工作中，使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">粒子过滤器</a>可以解决此问题<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">。</a> 在我们的案例中，从原则上讲，这种选择就足够了。 <br><br><h4> 跟踪物体带来的好处 </h4><br> 了解了对象的位置和形状后，您可以在视觉上对其进行操作，这是我尝试在视频中演示的。 使用OpenGL着色器扭曲了对象。 在模型的帮助下，我将对象的点投影到图像上，从而获得了该点的颜色。 然后，您可以移动这一点，获得有趣的效果-例如，变形。 但是，必须记住，转移观点，有必要保留一些东西，否则不一致会变得很明显。 另外，根据我们跟踪的质量和物体的形状，由于累积的误差，我们会收到各种不良影响，而这种影响仍然存在。 它只是需要以某种方式加以考虑。 在上面展示的视频中，我想展示增强现实的使用范围可以不仅仅限于在图像上添加虚拟对象。 <br><br> 顺便说一下， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Vuforia SDK可以</a>通过对象的形状来跟踪对象，尽管我认为不可能用该对象来实现该项目，因为不可能使用严​​格定义的边缘并且不能与建筑物的照明关联。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN454664/">https://habr.com/ru/post/zh-CN454664/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN454646/index.html">@Pythonetc编译，2019年5月</a></li>
<li><a href="../zh-CN454648/index.html">我的电报频道@pythonetc的提示和技巧，2019年5月</a></li>
<li><a href="../zh-CN454652/index.html">家用3D打印机上的Jet引擎</a></li>
<li><a href="../zh-CN454658/index.html">美容小工具-认真的生意</a></li>
<li><a href="../zh-CN454662/index.html">带着妻子和抵押贷款小心地搬到荷兰。 第1部分：求职</a></li>
<li><a href="../zh-CN454666/index.html">软件无线电-它如何工作？ 第7部分</a></li>
<li><a href="../zh-CN454668/index.html">开发人员手册：DDD食谱（第5部分，过程）</a></li>
<li><a href="../zh-CN454670/index.html">系列“切尔诺贝利”：观察和思考</a></li>
<li><a href="../zh-CN454672/index.html">开始的关键：适用于计算机取证的最佳软件和硬件</a></li>
<li><a href="../zh-CN454674/index.html">控制台中的可怜人监视或服务器监视</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>