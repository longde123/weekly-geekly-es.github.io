<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõë üíÖüèø üíù Benef√≠cios da an√°lise de aplicativos de n√≠vel 7 em firewalls. Parte 2. Seguran√ßa üïß ‚ÅâÔ∏è ü§¢</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A nova gera√ß√£o de firewalls √© mais conveniente e segura, gra√ßas √† nova arquitetura de mecanismo e √† nova ideologia de gerenciamento de fluxos de rede....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Benef√≠cios da an√°lise de aplicativos de n√≠vel 7 em firewalls. Parte 2. Seguran√ßa</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/436836/"><img src="https://habrastorage.org/getpro/habr/post_images/786/9e4/d4e/7869e4d4eac6b07b8bfa763cb3985347.png"><br><br>  A nova gera√ß√£o de firewalls √© mais conveniente e segura, gra√ßas √† nova arquitetura de mecanismo e √† nova ideologia de gerenciamento de fluxos de rede. <br><br><h3>  Por que este artigo apareceu? </h3><br><blockquote>  Repetidamente, vi colegas de seguran√ßa que usam uma nova gera√ß√£o de firewalls e viram que continuam a escrever regras sobre n√∫meros de portas.  Por sugest√£o de continuar escrevendo pelo nome de aplicativos, ouvi "E se n√£o funcionar dessa maneira?"  Se voc√™ tamb√©m est√° "assustado" ou n√£o est√° claro por que escrever as regras para aplicativos, este artigo √© para voc√™. </blockquote><a name="habracut"></a>  In√≠cio do artigo por refer√™ncia <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1. No√ß√µes b√°sicas de firewall</a> <br><br><a name="Start"></a><h1>  Parte 2. Impacto na seguran√ßa do FIREWALL L7 </h1><br><h3>  Conte√∫do </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O firewall L7 verifica o conte√∫do do campo de dados, o firewall L4 n√£o</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Os aplicativos foram alterados - seu firewall foi alterado</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Como funciona a detec√ß√£o de tr√°fego</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O firewall L7 √© mais conveniente</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O firewall L7 √© mais seguro</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Quais novos problemas criam uma nova abordagem para escrever regras para L7</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Limita√ß√µes da tecnologia de an√°lise de n√≠vel 7</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Conclus√£o</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Vota√ß√£o</a> <br><br><a name="Data"></a><h2>  O firewall L7 verifica o conte√∫do do campo de dados, o firewall L4 n√£o </h2><br><blockquote>  <b>O principal problema com o qual estamos enfrentando problemas √© que agora os programas s√£o gravados imediatamente, para contornar a prote√ß√£o do firewall L4.</b> </blockquote>  Se uma pessoa coloca o Skype, ele n√£o quer ligar para o administrador do sistema e implorar para abrir a porta que ele precisa no firewall - ele quer que o Skype acenda imediatamente "verde".  Os programadores sabem que geralmente h√° um proxy HTTP na rede ou a porta 80 √© aberta para HTTP, a porta 53 √© para DNS, a porta 123 √© para NTP e, √†s vezes, para funcion√°rios de dentro para fora da Internet, tudo est√° aberto e voc√™ pode usar essas conex√µes permitidas de acordo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6de/735/726/6de735726e071aab7f3a122cb9e7fd34.png"><br><br>  Os desenvolvedores t√™m o termo Experi√™ncia do usu√°rio - ap√≥s a instala√ß√£o, o cliente pegou fogo em verde Skype = o cliente est√° feliz.  E o fato de o Skype ter ultrapassado ilegalmente o per√≠metro da empresa por meio de uma conex√£o aberta apenas para navegador nas portas TCP / 80 e 443 - o firewall L4 ignora, porque n√£o √© tarefa dele examinar o conte√∫do dos pacotes - apenas os cabe√ßalhos s√£o importantes para ele. <br><br><h3>  Problema no firewall L4: salto de porta (encapsulamento) </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/e3e/aa8/502/e3eaa85023c8a83afe2fd9410e866965.png" align="left">  O encapsulamento de aplicativos n√£o autorizados dentro de conex√µes permitidas √© uma imagem padr√£o nas redes modernas.  Naturalmente, os hackers usam o mesmo truque: eles criam t√∫neis nas conex√µes permitidas.  E os seguran√ßas nem sabem. <br><br><h3>  Exemplo de t√∫nel TCP-sobre-DNS </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/30d/c7e/f30/30dc7ef30cfc1ca8c880c9d54ac9f3b7.png"><br><br>  A partir dos pacotes de tr√°fego coletados na imagem, fica claro que h√° conex√µes na 53¬™ porta TCP, que geralmente √© considerada a opera√ß√£o do protocolo DNS.  No entanto, se voc√™ olhar com aten√ß√£o, poder√° ver que no campo Texto do protocolo DNS h√° algum tipo de texto criptografado.  Esta √© uma implementa√ß√£o do t√∫nel TCP-Over-DNS, que eu frequentemente vejo nas redes corporativas.  √Ä esquerda, h√° uma lista de outros t√∫neis que seus usu√°rios ou hackers podem usar.  O firewall L4 fornece essas informa√ß√µes?  N√£o.  Portanto, se voc√™ precisar proteger a empresa contra t√∫neis n√£o autorizados, precisar√° analisar o conte√∫do dos dados transmitidos e us√°-lo para analisar qual aplicativo est√° atualmente usando esta conex√£o TCP. <br><br><a name="App"></a><h2>  Os aplicativos foram alterados - seu firewall foi alterado </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/f4d/ee2/573/f4dee257312a6c98e9607812d9976731.png"><br><br>  O mundo mudou e hoje determinar a aplica√ß√£o pelo n√∫mero da porta n√£o √© suficiente.  Sim, h√° 20 anos, concordamos que, se 80 estiver escrito no campo Port, ent√£o isso √© HTTP, se 53, ent√£o isso √© DNS, mas agora n√£o √© assim! <br><br>  √â necess√°rio analisar o conte√∫do dos dados transmitidos e cabe a eles analisar qual aplicativo est√° usando atualmente essa conex√£o TCP. <br><br>  Acesse o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">banco de dados do</a> aplicativo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">applipedia.paloaltonetworks.com</a> .  Veja quantos aplicativos usam as portas 80 e 443. <br><blockquote>  <b>Um exemplo</b> <br><br>  Aplicativos usando a porta 80 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/522/b2d/510/522b2d51051df42c0ead70785e0c7e71.png"><br></blockquote><blockquote><h3>  O problema com muitos recursos de seguran√ßa √© ignorar aplicativos em portas n√£o padr√£o. </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/8a9/ece/07d/8a9ece07d27298757b7a0819107f88c8.png" align="left"><br>  Mover um aplicativo padr√£o para uma porta n√£o padr√£o tamb√©m permite que um invasor fique fora de controle.  Este controle restaura apenas o dispositivo que analisa o conte√∫do de todo o tr√°fego, e n√£o apenas os cabe√ßalhos. </blockquote><br><a name="Visual"></a><h2>  Como funciona a detec√ß√£o de tr√°fego </h2><br>  Uma das tarefas da an√°lise de aplicativos √© detectar o tr√°fego de aplicativos criados especialmente para que suas conex√µes n√£o fiquem vis√≠veis.  Tomemos, por exemplo, o Skype.  As pessoas que aprenderam a distinguir pacotes UDP criptografados do Skype de outros pacotes UDP criptografados s√£o muito bons. <br><br>  H√° tamb√©m uma classe de dispositivos que podem fazer isso: Inspe√ß√£o profunda de pacotes (a seguir, DPI).  Agora, esses dispositivos est√£o com grandes fornecedores e permitem que voc√™ manipule o tr√°fego de aplicativos: aplique QoS ou redirecione na dire√ß√£o certa.  √Äs vezes, NGFW e DPI s√£o comparados.  Diferen√ßa: o DPI foi projetado para controlar a qualidade do tr√°fego e a seguran√ßa do NGFW, embora o NGFW tamb√©m tenha recursos de QoS. <br><br>  Os m√©todos para detectar aplicativos no tr√°fego s√£o diferentes. <br><br><ul><li>  Se voc√™ precisar encontrar um <b>aplicativo</b> que <b>n√£o se oculte</b> no tr√°fego, como HTTP, basta usar as pesquisas usuais para os padr√µes ou assinaturas correspondentes.  E isso √© usado ativamente pelos fabricantes.  Este √© o mais f√°cil. <br></li><li>  Se voc√™ precisar encontrar um <b>aplicativo</b> que <b>oculte deliberadamente</b> , por exemplo, TOR, precisar√° de um conjunto de m√©todos para analisar as estat√≠sticas e o comportamento do pacote.  Isso √© dif√≠cil, pois requer um laborat√≥rio de pesquisa, que tamb√©m precisa acompanhar as mudan√ßas no protocolo a tempo e implementar novos algoritmos de busca.  Minhas tentativas de conseguir pelo menos um desenvolvedor para dizer como esses algoritmos funcionam, deparamos com a resposta de que tudo isso √© propriedade intelectual. <br></li></ul><br>  Acontece que o aplicativo j√° alterou o algoritmo de opera√ß√£o e o mecanismo DPI ou NGFW ainda n√£o conseguiu alterar.  Por exemplo, o Telegram √†s vezes muda porque est√° sendo procurado.  Ocorrem falsos positivos.  Isso √© importante para verificar.  Consequentemente, os dispositivos, NGFW e DPI diferem principalmente no n√∫mero e na qualidade da detec√ß√£o de aplicativos.  Aqui est√° o √∫nico m√©todo: coloque o NGFW no seu tr√°fego e veja.  Se falamos sobre o per√≠metro, o tr√°fego mais complexo que eu vi continha 715 aplicativos diferentes por m√™s.  Em m√©dia, 200 a 300 aplicativos de v√°rios tipos passam pelo per√≠metro.  Nesta visualiza√ß√£o do tr√°fego de aplicativos, voc√™ pode ver o seguinte: passe o mouse sobre cada c√≠rculo: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http://researchcenter.paloaltonetworks.com/app-usage-risk-report-visualization/</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><br><img src="https://habrastorage.org/getpro/habr/post_images/945/099/048/94509904864c2cfeba02858aabf7127e.png"></a> <br><br>  Existem milhares de aplicativos no banco de dados de aplicativos, portanto, analisar essencialmente os formatos e algoritmos de cada aplicativo √© um trabalho longo e meticuloso dos analistas.  Depois de entendermos como o aplicativo funciona, os programadores come√ßam a trabalhar, que implementam a descoberta de aplicativos pelo tr√°fego.  E esses poucos milhares de aplicativos est√£o mudando constantemente.  Consequentemente, o produto deve ser constantemente suportado, aprender novas aplica√ß√µes e monitorar altera√ß√µes nas antigas e adicionar detectores modificados ao banco de dados.  O banco de dados de todos os aplicativos poss√≠veis que geram tr√°fego pode ser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">encontrado aqui</a> . <br><br>  √Äs vezes, os fornecedores de firewall L7 tentam medir o n√∫mero de aplicativos que eles t√™m no banco de dados, mas isso √© mais como palavr√µes.  Ao ativar o pensamento cr√≠tico, voc√™ entende que, na realidade, voc√™ s√≥ precisa detectar aplicativos no per√≠metro (em m√©dia, na regi√£o de 300 aplicativos diferentes), no data center (10 a 15 pe√ßas), nas redes ICS / SCADA (2-3 aplica√ß√µes), entre segmentos (talvez sejam apenas algumas dezenas).  E se voc√™ for oferecido para detectar milhares de aplicativos - isso √© apenas marketing e a detec√ß√£o de alguns aplicativos desconhecidos que ningu√©m usa. <br><br>  <b>Exemplos de aplicativos na rede de uma empresa:</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/240/186/ad2/240186ad2ca0654136be608ba2238460.png" alt="imagem"><br><br>  A segmenta√ß√£o interna dentro da empresa √© uma exig√™ncia constante de padr√µes de seguran√ßa da informa√ß√£o que quase ningu√©m atende.  Entre os segmentos onde est√£o programadores, financiadores, RH e contabilidade, os aplicativos tamb√©m s√£o executados.  No m√≠nimo, voc√™ precisa controlar a rede Windows (protocolo SMB), isso ficou especialmente claro ap√≥s a epidemia de criptomoedas WannaCry, que foi distribu√≠da via SMB.  Ou seja, as redes internas tamb√©m precisam da an√°lise de aplicativos de n√≠vel 7 e m√©todos relacionados para procurar c√≥digo malicioso na sandbox e no IPS e, pelo menos, controlar os tipos de arquivos transferidos. <br><blockquote>  O problema mais comum que se nota nas redes: o firewall supostamente est√° no n√≠vel 7, mas na realidade ele detecta aplicativos por porta.  Como verific√°-lo? <br><br><ol><li>  Para o teste, desligue o servidor FTP na porta 25.  Se o dispositivo estiver errado e disser que √© o protocolo SMTP, esse definitivamente n√£o √© o firewall L7. </li><li>  Ou tente escrever regras para dois aplicativos diferentes que usam a mesma porta.  Fa√ßa regras diferentes para eles: em um bloco, os arquivos exe, no outro, permitam.  Se isso acontecer, significa que a verdade √© a an√°lise do aplicativo (n√£o o n√∫mero da porta) e, em seguida, trabalhe com seu conte√∫do: bloqueio de arquivos, verifica√ß√£o de assinaturas de v√≠rus, verifica√ß√£o de IPS e assim por diante. </li><li>  Outro teste interessante para o NGFW √© quando voc√™ precisa criar dois aplicativos L7 personalizados com propriedades diferentes no mesmo endere√ßo IP.  Isso n√£o pode firewall L4, mas pode firewall L7.  Descri√ß√£o completa e teste em si aqui: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http://basic.ngfw-test.com/</a> </li></ol></blockquote>  Na R√∫ssia, ainda √© importante que os firewalls conhe√ßam o tr√°fego de aplicativos russos: 1C, Odnoklassniki, Yandex.Disk, mail.ru, como s√£o as atualiza√ß√µes do Kaspersky Anti-Virus e assim por diante.  Esse tamb√©m √© um componente importante de descoberta de aplicativos que voc√™ precisa para permitir esses aplicativos com seguran√ßa aos seus funcion√°rios. <br><br><a name="Comfort"></a><h2>  O firewall L7 √© mais conveniente </h2><br>  Se voc√™ observar o processo de treinamento de engenheiros de rede, na maioria das vezes as pessoas fazem cursos de um conhecido fabricante de equipamentos de rede, o que fornece um bom conhecimento das tecnologias de rede. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e73/5bc/284/e735bc2844f2258e4d11fe3e702d2fd2.jpg"><br><br>  O autor dessas linhas concluiu um n√∫mero decente de cursos da Cisco em 2003 e, portanto, apresenta as especificidades dos engenheiros de redes de treinamento em particular: como regra, depois de estudar o modelo OSI ISO de sete n√≠veis, apenas os quatro primeiros n√≠veis s√£o estudados em detalhes.  Ou seja, todas as sutilezas dos engenheiros de rede de seguran√ßa da informa√ß√£o conhecem apenas at√© o n√≠vel de TCP / UDP / ICMP.  Apenas alguns b√°sicos s√£o considerados no n√≠vel do aplicativo: HTTP, DNS, SSH, Telnet, NTP, FTP.  Qual √© o resultado?  E o administrador da rede considera que √© f√°cil gerenciar a camada de aplicativos a partir da camada de transporte! <br><br>  Pode parecer para um especialista em rede rec√©m-criado que tudo pode ser feito com regras no n√≠vel de transporte, onde voc√™ s√≥ precisa permitir o protocolo e a porta necess√°rios.  Precisa permitir um navegador na Internet?  Abrimos o TCP / 80.  Precisa abrir o DNS?  Abra o TCP / 53 ou UDP / 53.  Precisa abrir o RDP?  Abra o TCP / 3389.  E escrever regras no firewall L4 est√° se tornando o padr√£o na empresa. <br><br>  Devo dizer que muitos especialistas em TI est√£o cientes do conceito de inspe√ß√£o completa.  Mas, ao mesmo tempo, para muitos, √© uma revela√ß√£o que diferentes firewalls oferecem suporte √† inspe√ß√£o adequada para um conjunto diferente de aplicativos.  Tenho certas estat√≠sticas porque trabalhei como professor de cursos de Firewall no centro de treinamento da empresa Informzashita.  O que estou vendo?  Algu√©m pensa que a inspe√ß√£o completa do estado √© apenas permiss√£o para aceitar as respostas do protocolo TCP / UDP / ICMP de volta.  Mas e as aplica√ß√µes mais complexas?  Por exemplo, como rastrear duas conex√µes TCP que o protocolo FTP faz nas portas 21 e 20 - elas dependem uma da outra?  L√°, voc√™ precisa n√£o apenas aceitar a resposta, mas tamb√©m permitir a segunda conex√£o, dependendo do comando PORT, dentro da conex√£o de controle na porta 21.  E quantos aplicativos mais para abrir novas conex√µes dentro de si fornecem aplicativos?  Em resumo, as redes agora usam a lista de acesso usual, que n√£o entende o comando PORT dentro do protocolo FTP, e h√° o firewall L4, que desmonta o comando PORT e abre automaticamente a porta desejada, h√° algu√©m que foi al√©m e examinou os comandos mais complexos do protocolo MS RPC ou ICS Protocolos / SCADA.  Mas todos os aplicativos poss√≠veis do firewall L4 n√£o s√£o exibidos, e esses firewalls geralmente tamb√©m diferem no n√∫mero de aplicativos implementados dentro do Application Layer Gateway (ALG). <br><br>  No que estou chegando?  A convic√ß√£o de que apenas lembrar as principais portas TCP / UDP n√£o funciona. <br>  J√° existem milhares de aplicativos no mundo e todos usam redes de computadores.  E nenhum engenheiro de rede consegue se lembrar de todas essas portas. <br><br>  A revela√ß√£o para os engenheiros de rede √© a tarefa de abrir portas para uma aplica√ß√£o mais complexa, por exemplo, o VNC.  Ningu√©m se lembra de quais portas existem e precisa usar o google. <br><blockquote>  Ao publicar a primeira parte, realizei uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pesquisa</a> e vejo que as pessoas ainda est√£o prontas para lembrar os n√∫meros das portas - as opini√µes foram divididas em 50 a 50: algu√©m respondeu que estava pronto para lembrar as 4 portas do aplicativo VNC. <br><br>  Talvez o campe√£o no n√∫mero de portas seja o Lync (tamb√©m conhecido como Skype for Business).  Cerca de 40 portas.  √â realista lembr√°-los? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/795/133/dad/795133dad8b8ad8e24d78cfba7d8056c.png"></blockquote>  Se voc√™ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">observar o</a> Microsoft TechNet, que descreve quais portas voc√™ precisa abrir, desejo escrever uma permiss√£o para qualquer regra, porque existem cerca de 40 portas e algumas delas devem abrir dinamicamente.  E √© desastrosamente inconveniente registrar-se no firewall L4. <br><br>  Acontece que √© mais conveniente para um engenheiro de rede escrever as regras do aplicativo L7 e √© necess√°rio que o pr√≥prio firewall abra automaticamente as portas necess√°rias. <br><br>  Precisa abrir o VNC?  Voc√™ escreve a palavra VNC na regra e o firewall j√° entende quais protocolos subjacentes voc√™ precisa abrir.  Isso √© conveniente. <br><br>  <b>Um exemplo</b>  <b>Relat√≥rio NGFW sobre categorias de tr√°fego selecionadas.</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d38/cf1/44f/d38cf144fe1b72801cb6665551f246f7.png"><br><br>  Em m√©dia, 200 a 300 aplicativos usam acesso √† Internet a partir de uma rede corporativa.  O firewall no n√≠vel do aplicativo mostra quais aplicativos s√£o e pode filtrar esses aplicativos para todos ou para usu√°rios espec√≠ficos e filtrar arquivos por tipos ou conte√∫do que v√£o para aplicativos permitidos para todos os usu√°rios na rede corporativa.  Tamb√©m n√£o esque√ßa que no NGFW, as fun√ß√µes de seguran√ßa funcionam em paralelo: IPS, antiv√≠rus, anti-spyware, filtro de URL, filtro de DNS, Threat Intelligence e assim por diante.  Ou seja, n√£o apenas permitimos aplicativos, mas o fazemos com seguran√ßa. <br><br><a name="Security"></a><h2>  O firewall L7 √© mais seguro </h2><br>  Eu tenho o NGFW da Palo Alto Networks em m√£os.  Eu escrevi tr√™s regras diferentes sobre isso.  Vamos ver como eles diferem. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/934/f87/9d9/934f879d9fc26ca130016ebcf12d3986.png"><br><br>  Se voc√™ j√° configurou um firewall, ver√° que para diferentes grupos de usu√°rios: vip, marketing e programadores, ativei o SSL de tr√™s maneiras diferentes. <br><br><ol><li>  <b>Os</b> usu√°rios <b>vip</b> poder√£o acessar <b>a porta 443 e usar SSL dentro dela</b> , pois √© a porta padr√£o para SSL.  Se eles tentarem acessar a porta 443, por exemplo, telnet comum, eles n√£o ter√£o √™xito - o firewall verificar√° se n√£o √© SSL e o bloquear√°.  E √© disso que voc√™ precisa! </li><li>  <b>o marketing</b> pode ir <b>para qualquer porta usando SSL</b> , porque no campo Servi√ßo, onde as portas s√£o indicadas, qualquer porta √© permitida.  A quest√£o √©: eu quero que o marketing use SSL em portas n√£o padr√£o?  N√£o.  Este √© um erro de configura√ß√£o comum.  Especificar uma porta como qualquer outra √© l√≥gica se a regra for proibitiva - ou seja, se queremos proibir o SSL em qualquer porta. </li><li>  <b>programadores</b> podem andar <b>na porta 443 com qualquer aplicativo</b> , o que √© realmente um buraco, porque eu originalmente queria abrir apenas SSL.  E √© exatamente assim que o firewall L4 funciona - ele abre a porta e, em seguida, n√£o importa para ele o que existe e quais aplicativos usam essa porta.  Qualquer programador no grupo de programadores pode usar qualquer t√∫nel. </li></ol><br>  Definir o <b>padr√£o do aplicativo √©</b> muito importante e permite reduzir o n√∫mero de regras: voc√™ pode especificar os aplicativos necess√°rios na coluna Aplicativo em uma regra e o pr√≥prio firewall abrir√° as portas necess√°rias para os aplicativos necess√°rios, e somente os aplicativos que devem ir passar por essas portas.  Assim, voc√™ precisa de uma regra para abrir v√°rios aplicativos. <br><br>  Por exemplo, para a regra abaixo, onde todos os funcion√°rios t√™m permiss√£o para acessar a Internet apenas por padr√£o, o NGFW verifica constantemente se eles querem apenas o cliente DNS na 53¬™ porta e n√£o o TCP sobre DNS.  E, claro, isso aumenta a seguran√ßa, porque voc√™ n√£o apenas permite aplicativos, mas controla que apenas os aplicativos permitidos passam por canais abertos. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/268/a16/3c8/268a163c8dc1bb195b9c34e02e18da65.png"><br><br><a name="Issues"></a><h2>  Quais novos problemas criam uma nova abordagem para escrever regras para L7 </h2><br>  Voc√™ precisa entender que a determina√ß√£o do aplicativo pelo conte√∫do do pacote √© muito estressante para o processador de firewall L7.  Se o firewall L4 habitual verificou apenas alguns bytes do cabe√ßalho do pacote TCP e passou os megabytes restantes do clipe de flash sem verificar, o firewall L7 deve ler tudo o que est√° armazenado no campo de dados TCP / IP e verificar constantemente o conte√∫do da conex√£o TCP / IP; mudou ou representa uma amea√ßa para a empresa.  Portanto, quando um funcional, como an√°lise de conte√∫do, apareceu, todos os dispositivos come√ßaram a ficar mais lentos.  Portanto, a an√°lise de conte√∫do requer dispositivos mais poderosos. <br><br><a name="Limitations"></a><h2>  Limita√ß√µes da tecnologia de an√°lise de n√≠vel 7 </h2><br>  O firewall L7 requer mais mem√≥ria para armazenar o estado de uma conex√£o, portanto, o par√¢metro "n√∫mero de conex√µes simult√¢neas" do firewall L7 √© sempre menor que o firewall L4 com a mesma quantidade de RAM nos dois dispositivos e significativamente a cada 10 vezes. Isso j√° foi explicado acima na se√ß√£o Statefull Inspe√ß√£o  E esse √© o pre√ßo da seguran√ßa de seus aplicativos.  Portanto, se voc√™ estiver comparando a inspe√ß√£o L4 e L7, pergunte ao fabricante como ele mediu o par√¢metro "n√∫mero de sess√µes simult√¢neas": com a seguran√ßa ativada no n√≠vel 7 ou desativada. <br><br>  O mesmo com o desempenho: o processador de firewall L4 verifica apenas alguns bytes do cabe√ßalho do pacote e depois transfere os dados em velocidade de roteamento sem verifica√ß√£o, e o firewall L7 verifica o cabe√ßalho e todos os megabytes de dados contidos nos pacotes de conex√£o subsequentes.  E este √© um trabalho completamente diferente.  Portanto, esse trabalho precisa ser feito em plataformas especializadas de hardware, onde a an√°lise de aplicativos √© acelerada, o antiv√≠rus de streaming √© acelerado, o IPS e outras fun√ß√µes de seguran√ßa s√£o aceleradas.  O melhor de tudo √© que a Cavium conseguiu criar chips para acelerar a seguran√ßa, cujos chips, por exemplo, s√£o usados ‚Äã‚Äãpela Palo Alto Networks.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Al√©m disso, o uso de chips FPGA especializados (FPGAs) permite que voc√™ atualize as assinaturas de antiv√≠rus e IPS no pr√≥prio chip e a verifica√ß√£o da assinatura √© realizada na velocidade do hardware do chip FPGA. Agora, mesmo os computadores pessoais t√™m acelera√ß√£o de fun√ß√µes gr√°ficas em GPUs dedicadas, portanto, o uso de chips para acelerar a seguran√ßa √© um desenvolvimento l√≥gico da tecnologia.</font></font><br><br><a name="end"></a><h2>  Conclus√£o </h2><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Primeiro</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , gerenciar a seguran√ßa no firewall L7 √© mais f√°cil. Anteriormente, voc√™ lia a documenta√ß√£o do fabricante do aplicativo por um longo tempo e abriu as portas listadas l√°. Agora √© simples: especifique o nome do aplicativo na regra NGFW e as portas necess√°rias ser√£o resolvidas automaticamente, dependendo do estado das conex√µes desse aplicativo. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em segundo lugar</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , voc√™ pode detectar e bloquear o encapsulamento, porque o firewall L7 permite com seguran√ßa apenas um aplicativo especificado explicitamente e, se algu√©m tentar encapsular outro aplicativo em uma porta aberta, ele ser√° imediatamente detectado e bloqueado. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em terceiro lugar</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, voc√™ pode permitir o aplicativo desejado em qualquer porta desejada e apenas o aplicativo desejado entrar√° nessa porta, e n√£o todos de uma vez. </font><font style="vertical-align: inherit;">Por exemplo, apenas um navegador da web usar√° a porta 80. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parte 3. Descriptografia de SSL no NGFW. </font><font style="vertical-align: inherit;">(continua√ß√£o) </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tudo de bom! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Denis Batrankov </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">denis@batrankov.ru</font></font><a name="vote"></a></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt436836/">https://habr.com/ru/post/pt436836/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt436794/index.html">Confer√™ncia DEFCON 19. An√¥nimo e n√≥s. Parte 2</a></li>
<li><a href="../pt436822/index.html">Rob√≥tica Android at√© 2019: a hist√≥ria real; em 5 partes; parte 3</a></li>
<li><a href="../pt436826/index.html">Rob√≥tica Android at√© 2019: a hist√≥ria real; em 5 partes; parte 4</a></li>
<li><a href="../pt436828/index.html">A transi√ß√£o para o Boost-1.65.1 e os erros que surgiram</a></li>
<li><a href="../pt436830/index.html">Rob√≥tica Android at√© 2019: a hist√≥ria real; em 5 partes; parte 5</a></li>
<li><a href="../pt436838/index.html">Entendendo redes neurais convolucionais atrav√©s de visualiza√ß√µes no PyTorch</a></li>
<li><a href="../pt436840/index.html">O caminho do brilho para a neuroci√™ncia: um podcast tem√°tico sobre carreiras em marketing de m√≠dia e conte√∫do</a></li>
<li><a href="../pt436842/index.html">Solu√ß√£o Veeam para backup e recupera√ß√£o de m√°quinas virtuais na plataforma Nutanix AHV. Parte 2</a></li>
<li><a href="../pt436846/index.html">O resumo de materiais frescos do mundo do front-end da √∫ltima semana n ¬∞ 348 (14-20 de janeiro de 2019)</a></li>
<li><a href="../pt436848/index.html">NSA anuncia lan√ßamento de ferramenta interna para engenharia reversa</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>