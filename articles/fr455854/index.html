<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏒 🤘🏻 🐿️ Comment implémenter les menus contextuels dans iOS 13 🌒 👩🏽 👨🏼‍⚕️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour à tous, je m'appelle Denis, nous développons un service d'analyse d'abonnement pour les applications iOS - Apphud . 


 Lors de la WWDC 2019, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment implémenter les menus contextuels dans iOS 13</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/apphud/blog/455854/"><p>  Bonjour à tous, je m'appelle Denis, nous développons un service d'analyse d'abonnement pour les applications iOS - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Apphud</a> . </p><br><p>  Lors de la WWDC 2019, Apple a présenté une nouvelle façon d'interagir avec l'interface de votre application: les <em>menus contextuels</em> .  Ils ressemblent à ceci: </p><br><p><img src="https://habrastorage.org/webt/mo/kw/5c/mokw5cy2bio4dg5gxpgfmxfavg0.gif"></p><br><p> Dans cet article, nous allons examiner certaines des subtilités de leur utilisation et apprendre à les fabriquer. <a name="habracut"></a></p><br><p>  Les menus contextuels sont une continuation logique de la technologie «Peek and Pop», lorsque l'utilisateur pouvait ouvrir un aperçu d'un élément en appuyant dessus.  Mais entre eux, il existe plusieurs différences importantes. </p><br><ul><li><p>  Les menus contextuels fonctionnent sur tout appareil exécutant iOS 13. Aucune prise en charge tactile 3D n'est requise de l'appareil.  Par conséquent, en particulier, ils peuvent être utilisés sur tous les iPad. </p><br></li><li><p>  Les boutons qui vous permettent d'interagir avec l'élément apparaissent immédiatement et ne nécessitent pas de balayage vers le haut. </p><br></li></ul><br><p>  Pour ouvrir le menu contextuel, l'utilisateur a juste besoin de tenir votre doigt sur l'élément souhaité ou d'appuyer dessus (si l'appareil prend en charge 3D Touch). </p><br><h2 id="rekomendacii-pri-ispolzovanii-kontekstnyh-menyu">  Recommandations lors de l'utilisation des menus contextuels </h2><br><p>  Les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">directives d'interface humaine</a> d'Apple vous recommandent de suivre ces directives lors de la conception des menus contextuels. </p><br><h3 id="proektiruyte-pravilno">  Concevoir correctement </h3><br><p>  Ce ne sera pas bon si vous ajoutez un menu pour certains éléments à certains endroits et ne l'ajoutez pas pour des éléments similaires dans d'autres.  L'utilisateur pensera alors que l'application ne fonctionne pas correctement. </p><br><h3 id="vklyuchayte-v-menyu-tolko-neobhodimoe">  Inclure uniquement le nécessaire dans le menu </h3><br><p>  Le menu contextuel est un endroit idéal pour les commandes les plus couramment utilisées.  «Le plus souvent» est une phrase clé.  N'ajoutez pas tout de suite. </p><br><h3 id="ispolzuyte-vlozhennye-menyu">  Utiliser des sous-menus </h3><br><p>  Utilisez les sous-menus pour faciliter la navigation de l'utilisateur.  Donnez aux éléments de menu des noms simples et clairs. </p><br><h3 id="ispolzuyte-ne-bolee-1-urovnya-vlozhennosti">  N'utilisez pas plus d'un niveau d'imbrication </h3><br><p>  Malgré le fait que les sous-menus peuvent faciliter la navigation, ils peuvent facilement la compliquer.  Apple ne recommande pas d'utiliser plus d'un niveau d'imbrication. </p><br><h3 id="raspolagayte-naibolee-chasto-ispolzuemye-punkty-v-verhney-chasti">  Mettez les articles les plus fréquemment utilisés en haut </h3><br><p>  Les utilisateurs se concentrent principalement sur le haut du menu, il leur est donc plus facile de naviguer dans votre application. </p><br><h3 id="ispolzuyte-gruppirovku">  Utiliser le regroupement </h3><br><p>  Regrouper les éléments de menu similaires </p><br><h3 id="izbegayte-odnovremennogo-ispolzovaniya-kontekstnogo-menyu-i-menyu-redaktirovaniya-na-odnom-elemente">  Évitez d'utiliser le menu contextuel et le menu d'édition sur le même élément en même temps </h3><br><p>  Ils peuvent entrer en conflit les uns avec les autres, car les deux sont appelés en appuyant longuement. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/26d/ed2/24b/26ded224b635217601b986d56783e8b3.png" alt="Menu d'édition IOS"></p><br><h3 id="ne-dobavlyayte-otdelnuyu-knopku-otkryt-v-menyu">  N'ajoutez pas de bouton «Ouvrir» distinct dans le menu </h3><br><p>  Les utilisateurs peuvent ouvrir un élément en appuyant simplement dessus.  Un bouton supplémentaire «Ouvrir» sera superflu. </p><br><h2 id="prosteyshee-kontekstnoe-menyu-dlya-uiview">  Le menu contextuel le plus simple pour UIView </h2><br><p>  Maintenant que nous avons appris les règles de base pour utiliser les menus contextuels, passons à la pratique.  Bien sûr, les menus ne fonctionnent que sur iOS 13 et supérieur, et pour les tests, vous aurez besoin de Xcode 11. Vous pouvez télécharger la version bêta de Xcode 11 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . </p><br><blockquote><h1 id="vy-mozhete-skachat-primer-polnostyu-otsyudahttpsgithubcomapphudexample-context_menus">  Vous pouvez télécharger l'exemple complètement <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . </h1><br></blockquote><p> Ajoutons un menu contextuel, par exemple, sur un <code>UIImageView</code> , <em>comme dans l'animation ci-dessus</em> . </p><br><p>  Pour ce faire, ajoutez simplement l'objet <code>UIImageView</code> au contrôleur et écrivez quelques lignes de code, par exemple, dans la méthode <code>viewDidLoad</code> : </p><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SingleViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIViewController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@IBOutlet</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> imageView: <span class="hljs-type"><span class="hljs-type">UIImageView!</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">viewDidLoad</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.viewDidLoad() imageView.isUserInteractionEnabled = <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> interaction = <span class="hljs-type"><span class="hljs-type">UIContextMenuInteraction</span></span>(delegate: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) imageView.addInteraction(interaction) } }</code> </pre> <br><p>  <code>UIContextMenuInteraction</code> , un objet de la classe <code>UIContextMenuInteraction</code> est <code>UIContextMenuInteraction</code> .  Le constructeur vous demande de spécifier le délégué qui sera responsable du menu.  Revenons un peu plus tard.  Et avec la méthode <code>addInteraction</code> nous ajoutons notre menu à l'image. </p><br><p>  Reste maintenant à implémenter le protocole <code>UIContextMenuInteractionDelegate</code> .  Il n'a qu'une seule méthode obligatoire qui est responsable de la création du menu: </p><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SingleViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIContextMenuInteractionDelegate</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">contextMenuInteraction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> interaction: UIContextMenuInteraction, configurationForMenuAtLocation location: CGPoint)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UIContextMenuConfiguration?</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> configuration = <span class="hljs-type"><span class="hljs-type">UIContextMenuConfiguration</span></span>(identifier: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, previewProvider: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) { actions -&gt; <span class="hljs-type"><span class="hljs-type">UIMenu</span></span>&lt;<span class="hljs-type"><span class="hljs-type">UIAction</span></span>&gt;? <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> save = <span class="hljs-type"><span class="hljs-type">UIAction</span></span>(__title: <span class="hljs-string"><span class="hljs-string">"My Button"</span></span>, image: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, options: []) { action <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-comment"><span class="hljs-comment">// Put button handler here } return configuration } }</span></span></code> </pre> <br><p>  Si <code>nil</code> retourné dans cette méthode, le menu contextuel ne sera pas appelé.  À l'intérieur de la méthode elle-même, nous créons un objet de la classe <code>UIContextMenuConfiguration</code> .  Lors de la création, nous transmettons ces paramètres: </p><br><ul><li><p>  <code>identifier</code> - identifiant du menu. </p><br></li><li><p>  <code>previewProvider</code> est un contrôleur personnalisé qui peut éventuellement être affiché à la place de l'élément actuel dans le menu.  Nous y réfléchirons un peu plus tard. </p><br></li><li><p>  dans <code>actionProvider</code> nous passons les éléments du menu contextuel. </p><br></li></ul><br><p>  Les éléments eux-mêmes sont créés simplement nulle part: ils indiquent le nom, une icône facultative et un gestionnaire pour cliquer sur un élément de menu.  C'est tout! </p><br><h3 id="dobavlyaem-vlozhennoe-menyu">  Ajouter un sous-menu </h3><br><p>  Compliquons un peu les choses.  Ajoutez à notre image un menu avec deux éléments: "Enregistrer" et "Modifier ...".  En cliquant sur "Modifier ...", un sous-menu s'ouvre avec les éléments "Rotation" et "Supprimer".  Cela devrait ressembler à ceci: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/cb1/546/047/cb1546047c9d4b64864f63c2b99cdeb2.gif"></p><br><p>  Pour ce faire, réécrivez la méthode de protocole <code>UIContextMenuInteractionDelegate</code> comme suit: </p><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">contextMenuInteraction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> interaction: UIContextMenuInteraction, configurationForMenuAtLocation location: CGPoint)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UIContextMenuConfiguration?</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> configuration = <span class="hljs-type"><span class="hljs-type">UIContextMenuConfiguration</span></span>(identifier: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, previewProvider: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) { actions -&gt; <span class="hljs-type"><span class="hljs-type">UIMenu</span></span>&lt;<span class="hljs-type"><span class="hljs-type">UIAction</span></span>&gt;? <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-comment"><span class="hljs-comment">// Creating Save button let save = UIAction(__title: "Save", image: UIImage(systemName: "tray.and.arrow.down.fill"), options: []) { action in // Just showing some alert self.showAlert(title: action.title) } // Creating Rotate button let rotate = UIAction(__title: "Rotate", image: UIImage(systemName: "arrow.counterclockwise"), options: []) { action in self.showAlert(title: action.title) } // Creating Delete button let delete = UIAction(__title: "Delete", image: UIImage(systemName: "trash.fill"), options: .destructive) { action in self.showAlert(title: action.title) } // Creating Edit, which will open Submenu let edit = UIMenu&lt;UIAction&gt;.create(title: "Edit...", children: [rotate, delete]) // Creating main context menu return UIMenu&lt;UIAction&gt;.create(title: "Menu", children: [save, edit]) } return configuration }</span></span></code> </pre> <br><p>  Ici, nous créons successivement les boutons "Enregistrer", "Rotation" et "Supprimer", ajoutons les deux derniers au sous-menu "Modifier ..." et enveloppons le tout dans le menu contextuel principal. </p><br><h2 id="dobavlyaem-kontekstnoe-menyu-v-uicollectionview">  Ajouter un menu contextuel à <code>UICollectionView</code> </h2><br><p>  Ajoutons un menu contextuel à l' <code>UICollectionView</code> .  Avec un appui long sur la cellule, l'utilisateur affichera un menu avec l'élément «Archive», comme ceci: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/904/a8f/4ed/904a8f4ed139724afc6b59cc7ac2bde2.gif"></p><br><p>  L'ajout d'un menu contextuel à <code>UICollectionView</code> est simple: implémentez simplement la méthode facultative <code>func collectionView(_ collectionView: UICollectionView, contextMenuConfigurationForItemAt indexPath: IndexPath, point: CGPoint) -&gt; UIContextMenuConfiguration?</code>  Protocole <code>UICollectionViewDelegate</code> .  Voici ce que nous avons obtenu: </p><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">collectionView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> collectionView: UICollectionView, contextMenuConfigurationForItemAt indexPath: IndexPath, point: CGPoint)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UIContextMenuConfiguration?</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> configuration = <span class="hljs-type"><span class="hljs-type">UIContextMenuConfiguration</span></span>(identifier: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, previewProvider: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) { actions -&gt; <span class="hljs-type"><span class="hljs-type">UIMenu</span></span>&lt;<span class="hljs-type"><span class="hljs-type">UIAction</span></span>&gt;? <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> action = <span class="hljs-type"><span class="hljs-type">UIAction</span></span>(__title: <span class="hljs-string"><span class="hljs-string">"Archive"</span></span>, image: <span class="hljs-type"><span class="hljs-type">UIImage</span></span>(systemName: <span class="hljs-string"><span class="hljs-string">"archivebox.fill"</span></span>), options: .destructive) { action <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-comment"><span class="hljs-comment">// Put button handler here } return UIMenu&lt;UIAction&gt;.create(title: "Menu", children: [action]) } return configuration }</span></span></code> </pre> <br><p>  Ici, comme précédemment, l'élément et le menu lui-même sont créés.  Maintenant, avec un clic long (fort) sur une cellule, l'utilisateur verra un menu contextuel. </p><br><h2 id="dobavlyaem-kontekstnoe-menyu-v-uitableview">  Ajouter un menu contextuel à <code>UITableView</code> </h2><br><p>  Tout ici est similaire à <code>UICollectionView</code> .  Vous devez implémenter la méthode <code>UITableViewDelegate</code> protocole <code>UITableViewDelegate</code> comme ceci: </p><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tableView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tableView: UITableView, contextMenuConfigurationForRowAt indexPath: IndexPath, point: CGPoint)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UIContextMenuConfiguration?</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> configuration = <span class="hljs-type"><span class="hljs-type">UIContextMenuConfiguration</span></span>(identifier: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, previewProvider: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) { actions -&gt; <span class="hljs-type"><span class="hljs-type">UIMenu</span></span>&lt;<span class="hljs-type"><span class="hljs-type">UIAction</span></span>&gt;? <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> action = <span class="hljs-type"><span class="hljs-type">UIAction</span></span>(__title: <span class="hljs-string"><span class="hljs-string">"Custom action"</span></span>, image: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, options: []) { action <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-comment"><span class="hljs-comment">// Put button handler here } return UIMenu&lt;UIAction&gt;.create(title: "Menu", children: [action]) } return configuration }</span></span></code> </pre> <br><p>  Mais que se passe-t-il si nous voulons utiliser un écran personnalisé dans le menu contextuel?  Par exemple, ceci: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/42d/724/29d/42d72429d50424a69d1ecddb7a7c91ce.gif"></p><br><p>  Pour ce faire, lors de la création d'une <code>UIContextMenuConfiguration</code> devez transmettre l' <code>UIViewController</code> souhaité à <code>previewProvider</code> .  Voici un exemple de code qui implémente ceci: </p><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PreviewViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIViewController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">controller</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">PreviewViewController</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> storyboard = <span class="hljs-type"><span class="hljs-type">UIStoryboard</span></span>(name: <span class="hljs-string"><span class="hljs-string">"Main"</span></span>, bundle: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> controller = storyboard.instantiateViewController(withIdentifier: <span class="hljs-string"><span class="hljs-string">"PreviewViewController"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>! <span class="hljs-type"><span class="hljs-type">PreviewViewController</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> controller } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TableViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UITableViewDelegate</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tableView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tableView: UITableView, contextMenuConfigurationForRowAt indexPath: IndexPath, point: CGPoint)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UIContextMenuConfiguration?</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> configuration = <span class="hljs-type"><span class="hljs-type">UIContextMenuConfiguration</span></span>(identifier: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, previewProvider: { () -&gt; <span class="hljs-type"><span class="hljs-type">UIViewController?</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-comment"><span class="hljs-comment">// Return Preview View Controller here return PreviewViewController.controller() }) { _ -&gt; UIMenu&lt;UIAction&gt;? in let action = UIAction(__title: "Custom action", image: nil, options: []) { action in // Put button handler here } return UIMenu&lt;UIAction&gt;.create(title: "Menu", children: [action]) } return configuration } }</span></span></code> </pre> <br><p>  Dans l'exemple, <code>PreviewViewController</code> initialisé à partir du storyboard et affiché dans le menu contextuel. </p><br><p>  Il reste à ajouter le traitement des clics à ce ViewController.  Pour ce faire, implémentez la méthode <code>UITableViewDelegate</code> protocole <code>UITableViewDelegate</code> .  Le gestionnaire lui-même sera placé dans <code>animator.addCompletion</code> : </p><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tableView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tableView: UITableView, willCommitMenuWithAnimator animator: UIContextMenuInteractionCommitAnimating)</span></span></span></span> { animator.addCompletion { <span class="hljs-comment"><span class="hljs-comment">// Put handler here } }</span></span></code> </pre> <br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  Les menus contextuels sont un nouvel outil puissant pour l'interaction de l'utilisateur avec votre application.  Et, comme vous pouvez le voir, leur mise en œuvre est assez simple.  Mais vous ne devez pas oublier que les méthodes peuvent changer jusqu'à la sortie de la version finale d'iOS 13. </p><br><blockquote>  Vous souhaitez mettre en œuvre des abonnements dans votre application iOS en 10 minutes?  Intégrez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Apphud</a> et: <br><ul><li>  Faites des achats en utilisant une seule méthode; </li><li>  suivre automatiquement l'état de l'abonnement de chaque utilisateur; </li><li>  Intégrez facilement les offres d'abonnement </li><li>  envoyer des événements d'abonnement à Amplitude, Mixpanel, Slack et Telegram en tenant compte de la devise locale de l'utilisateur; </li><li>  diminuer le taux de désabonnement dans les applications et renvoyer les utilisateurs non abonnés. </li></ul><br></blockquote><br><h2 id="chto-pochitat">  Que lire? </h2><br><ul><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">15 conseils pour obtenir votre application d'abonnement sur l'App Store</a> </p><br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Guide de notification des abonnements Apple pour iOS.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Sont-ils vraiment bons?</a> </p><br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">7 choses importantes à savoir sur les abonnements iOS</a> </p><br></li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr455854/">https://habr.com/ru/post/fr455854/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr455844/index.html">Création d'un analyseur Roslyn en utilisant les tests d'encapsulation comme exemple</a></li>
<li><a href="../fr455846/index.html">Informatique distribuée dans Julia</a></li>
<li><a href="../fr455848/index.html">Technique pour éviter un comportement indéfini lors de l'accès à un singleton</a></li>
<li><a href="../fr455850/index.html">Boîte à outils pour les chercheurs - Troisième édition: recherche et utilisation de sources</a></li>
<li><a href="../fr455852/index.html">Levée de sinus et implantation simultanée</a></li>
<li><a href="../fr455856/index.html">Capteur de température, d'humidité et de pression atmosphérique sans fil sur nRF52832</a></li>
<li><a href="../fr455858/index.html">Réseaux de télévision par câble pour les plus petits. Partie 9: Headend</a></li>
<li><a href="../fr455860/index.html">Développement de BPM élégant et à la mode pour les jeunes chez Camunda</a></li>
<li><a href="../fr455862/index.html">Nouveautés d'AWS: API DATA, Kinesis Data Analytics, S3 Path</a></li>
<li><a href="../fr455868/index.html">Surmonter la loi de Moore: les technologies des transistors du futur</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>