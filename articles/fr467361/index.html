<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍽️ 🎴 👲 Nous avons oublié la délégation en JavaScript. Délégation d'événement en réaction ✒️ 🛡️ 👨‍👩‍👧‍👦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour à tous. Cet article concerne la délégation d'événements en JavaScript et son implémentation dans react.js. 





 De quoi s'agit-il réellement...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nous avons oublié la délégation en JavaScript. Délégation d'événement en réaction</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467361/"><h3 id="vsem-privet-statya-o-delegirovanie-sobytiy-v-javascript-i-realizaciya-ego-v-reactjs">  Bonjour à tous.  Cet article concerne la délégation d'événements en JavaScript et son implémentation dans react.js. </h3><br><p><img src="https://habrastorage.org/webt/vd/cq/gx/vdcqgx0vuflyxvf4p-krrwvkbo8.jpeg"></p><br><p>  De quoi s'agit-il réellement?  Pourquoi et pourquoi? </p><br><h4 id="dlya-nachala-davayte-kratko-obsudim">  Pour commencer, discutons brièvement: </h4><br><ol><li>  qu'est-ce qu'un événement; </li><li>  comment se produit la distribution; </li><li>  Traitement DOM niveau 2 avec un exemple en JavaScript; </li></ol><br><p>  Et enfin: pourquoi ne pas oublier la délégation dans React. </p><br><h4 id="sobytie">  Événement </h4><br><p>  JavaScript et HTML interagissent entre eux à travers des événements.  Chaque événement sert à indiquer à JavaScript que quelque chose s'est produit dans la fenêtre du document ou du navigateur.  Afin d'attraper ces événements, nous avons besoin d'écouteurs (écouteurs), ces gestionnaires qui sont déclenchés en cas d'événement. </p><br><h4 id="rasprostranenie-sobytiy">  Propagation de l'événement </h4><br><p>  Commandez.  Résoudre le problème: comment comprendre à quelle partie de la page appartient l'événement?  Deux méthodes ont été implémentées: dans Internet Explorer, «bulles d’événement» et dans Netscape Communicator, «accrochage d’événements». </p><a name="habracut"></a><br><h4 id="vsplytie-sobytiy">  Bulle d'événement </h4><br><p>  Dans ce cas, l'événement est déclenché au niveau du nœud le plus profond de l'arborescence de documents, après quoi il monte dans la hiérarchie jusqu'à la fenêtre elle-même. </p><br><pre><code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Some title<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"myDiv"</span></span></span><span class="hljs-tag">&gt;</span></span>Click Me<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Dans ce cas, il y aura l'ordre suivant: </p><br><ol><li>  élément div </li><li>  élément de corps </li><li>  élément html </li><li>  document </li><li>  fenêtre </li></ol><br><blockquote>  Désormais, la navigation est prise en charge par tous les navigateurs modernes, bien qu'avec différentes implémentations. </blockquote><p>  Dans le cas d'une interception d'événement, l'inverse est vrai: </p><br><ol><li>  fenêtre </li><li>  document </li><li>  élément html </li><li>  élément de corps </li><li>  élément div </li></ol><br><blockquote>  On pensait que l'événement pouvait être traité avant qu'il n'atteigne l'élément cible (comme décidé dans Netscape, il a ensuite repris tous les navigateurs modernes). </blockquote><p>  Par conséquent, nous avons la structure suivante pour distribuer les événements DOM: </p><br><ol><li>  fenêtre </li><li>  document </li><li>  élément html </li><li>  élément de corps // la phase d'interception se termine </li><li>  élément div // phase cible </li><li>  élément du corps // la phase de montée commence </li><li>  élément html </li><li>  document </li><li>  fenêtre </li></ol><br><p>  Ce schéma est divisé en trois phases: la phase d'interception - l'événement peut être intercepté avant qu'il n'atteigne l'élément, la phase cible - le traitement par l'élément cible et la phase de remontée - pour effectuer les dernières actions en réponse à l'événement. </p><cut></cut><br><h4 id="itak-perehodim-k-obrabotke-sobytiy">  Nous nous tournons donc vers le traitement des événements </h4><br><p>  Voyons un exemple typique de gestion d'événements en JavaScript. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> btn = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'myDiv'</span></span>) btn.addEventListener(<span class="hljs-string"><span class="hljs-string">"click"</span></span>, handler) <span class="hljs-comment"><span class="hljs-comment">// some code btn.removeEventListener("click", handler)</span></span></code> </pre> <br><p>  Tout ne serait rien, mais ici, nous rappelons notre bien-aimé IE qui souscrit aux événements en utilisant attachEvent, et pour supprimer detachEvent.  Et vous pouvez vous abonner à l'événement plusieurs fois.  Et n'oubliez pas qu'en signant une fonction anonyme, nous n'avons pas la possibilité de nous désinscrire. </p><br><p>  Mais nous ne sommes pas des codeurs externes g *.  Faisons tout selon le canon: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> EventUtil = { <span class="hljs-attr"><span class="hljs-attr">addHandler</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">elem, type, handler</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (elem.addEventListener) { elem.addEventListener(type, handler, <span class="hljs-literal"><span class="hljs-literal">false</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (elem.attachEvent) { elem.attachEvent(<span class="hljs-string"><span class="hljs-string">"on"</span></span> + type, handler) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { elem[<span class="hljs-string"><span class="hljs-string">"on"</span></span> = type] = hendler } }, <span class="hljs-attr"><span class="hljs-attr">removeHandler</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">elem, type, handler</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (elem.removeEventListener) { elem.removeEventListener(type, handler, <span class="hljs-literal"><span class="hljs-literal">false</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (elem.detachEvent) { elem.detachEvent(<span class="hljs-string"><span class="hljs-string">"on"</span></span> + type, handler) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { elem[<span class="hljs-string"><span class="hljs-string">"on"</span></span> = type] = <span class="hljs-literal"><span class="hljs-literal">null</span></span> } } }</code> </pre> <br><p>  Si bien, mais qu'en est-il de l'objet événement?  Après tout, dans IE, il n'y a pas de .target .srcElement, preventDefault?  no returnValue = false.  Mais il n'y a rien à ajouter quelques méthodes: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> EventUtil = { <span class="hljs-attr"><span class="hljs-attr">addHandler</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">elem, type, handler</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (elem.addEventListener) { elem.addEventListener(type, handler, <span class="hljs-literal"><span class="hljs-literal">false</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (elem.attachEvent) { elem.attachEvent(<span class="hljs-string"><span class="hljs-string">"on"</span></span> + type, handler) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { elem[<span class="hljs-string"><span class="hljs-string">"on"</span></span> = type] = hendler } }, <span class="hljs-attr"><span class="hljs-attr">getEvent</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> event ? event : <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.event }, <span class="hljs-attr"><span class="hljs-attr">getTarget</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> event.target || event.srcElement }, <span class="hljs-attr"><span class="hljs-attr">preventDefault</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (event.preventDefault) { event.preventDefault() } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { event.returnValue = <span class="hljs-literal"><span class="hljs-literal">false</span></span> } }, <span class="hljs-attr"><span class="hljs-attr">removeHandler</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">elem, type, handler</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (elem.removeEventListener) { elem.removeEventListener(type, handler, <span class="hljs-literal"><span class="hljs-literal">false</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (elem.detachEvent) { elem.detachEvent(<span class="hljs-string"><span class="hljs-string">"on"</span></span> + type, handler) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { elem[<span class="hljs-string"><span class="hljs-string">"on"</span></span> = type] = <span class="hljs-literal"><span class="hljs-literal">null</span></span> } }, <span class="hljs-attr"><span class="hljs-attr">stopPropagation</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (event.stopPropagation) { event.stopPropagation() } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { event.cancelBubble = <span class="hljs-literal"><span class="hljs-literal">true</span></span> } } }</code> </pre> <br><p>  Etc.  etc.  et ce sont toutes des danses. </p><br><p>  Eh bien, nous sommes bien faits, nous avons résolu tous les problèmes, tout va bien.  Certes, le code est sorti assez lourd.  Imaginez maintenant que nous avons besoin de beaucoup d'abonnements à de nombreux éléments.  Wow, cela prendra pas mal de lignes de code.  Un exemple: </p><br><pre> <code class="javascript hljs">&lt;ul&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"id1"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">go somewhere</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;li id=<span class="hljs-string"><span class="hljs-string">"id2"</span></span>&gt;<span class="hljs-keyword"><span class="hljs-keyword">do</span></span> something&lt;<span class="hljs-regexp"><span class="hljs-regexp">/li&gt; &lt;li id="some-next-id"&gt;next&lt;/</span></span>li&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> item1 = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'id1'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> item2 = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'id2'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> itemNext = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'some-next-id'</span></span>) EventUtil.addHandler(item1, <span class="hljs-string"><span class="hljs-string">"click"</span></span>, someHandle) EventUtil.addHandler(item2, <span class="hljs-string"><span class="hljs-string">"click"</span></span>, someHandle2) EventUtil.addHandler(itemNext, <span class="hljs-string"><span class="hljs-string">"click"</span></span>, someHandle3)</code> </pre> <br><p>  <strong>Et donc pour chaque élément, et nous ne devons pas oublier de supprimer, de travailler avec la cible et similaires</strong> </p><br><h4 id="i-tut-k-nam-na-pomosch-prihodit-delegirovanie-sobytiy-event-delegation">  Et ici, la délégation de l'événement vient à notre aide. </h4><br><p>  Tout ce que nous devons faire est de connecter un seul gestionnaire au point le plus élevé de l'arborescence DOM: </p><br><pre> <code class="javascript hljs">&lt;ul id=<span class="hljs-string"><span class="hljs-string">"main-id"</span></span>&gt; <span class="hljs-comment"><span class="hljs-comment">//  id    &lt;li id="id1"&gt;go somewhere&lt;/li&gt; &lt;li id="id2"&gt;do something&lt;/li&gt; &lt;li id="some-next-id"&gt;next&lt;/li&gt; &lt;/ul&gt; var list = document.getElementById('main-id') EventUtil.addHandler(list, "click", function(event) { event = EventUtil.getEvent(event) var target = EventUtil.getTarget(event) switch(target.id) { case "id1": //  -    id1 break case "id2": //  -    id1 break case "some-next-id": //  -    break } })</span></span></code> </pre> <br><p>  <strong>Par conséquent, nous n'avons qu'un seul gestionnaire en mémoire et la propriété id peut être utilisée pour l'action souhaitée.</strong>  <strong>Une consommation de mémoire moindre améliore les performances globales des pages.</strong>  <strong>L'enregistrement d'un gestionnaire d'événements nécessite moins de temps et moins d'appels vers le DOM.</strong>  <strong>L'exception est peut-être mouseover et mouseout, avec eux tout est un peu plus compliqué.</strong> </p><br><h3 id="a-teper-chto-naschyot-react">  Et qu'en est-il de React </h3><br><p>  Tout sur la compatibilité entre navigateurs pour nous a déjà été fait par des gars de Facebook.  Tous nos gestionnaires d'événements reçoivent une instance de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SyntheticEvent</a> .  Ce qui nous permet de réutiliser les événements du pool, en supprimant toutes les propriétés après avoir appelé le gestionnaire. </p><br><p>  Bon. </p><br><p>  Néanmoins, un gestionnaire supplémentaire est un gestionnaire supplémentaire.  Je me suis rencontré plusieurs fois, et je me repens, j'ai écrit ce genre de code: </p><br><pre> <code class="xml hljs">class Example extends React.Component { handleClick () { console.log('click') } render () { return ( <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {new Array(20).fill().map((_, index) =&gt; <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{index}</span></span></span><span class="hljs-tag"> // </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elem.id</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{index}</span></span></span><span class="hljs-tag"> // </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elem.id</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{()</span></span></span><span class="hljs-tag"> =&gt;</span></span> console.log('click')} /&gt; )} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> ) } }</code> </pre><br><p>  <strong>L'exemple montre le cas où il existe une sorte de feuille avec n-nombre d'éléments, et donc avec n-nombre d'enregistrements de gestionnaires.</strong> </p><br><p>  Courons, allons sur la page et vérifions combien de gestionnaires sont en action en ce moment.  Pour cela, j'ai trouvé un bon script: </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.from(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelectorAll(<span class="hljs-string"><span class="hljs-string">'*'</span></span>)) .reduce(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">pre, dom</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> clks = getEventListeners(dom).click; pre += clks ? clks.length || <span class="hljs-number"><span class="hljs-number">0</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> pre }, <span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre><br><p>  Fonctionne dans chrome dev-tool. </p><br><p>  Et maintenant, nous déléguons tout cela aux div parent et acclamations, nous venons d'optimiser notre application n = array.length fois.  Exemple de code ci-dessous: </p><br><pre> <code class="xml hljs">class Example extends React.Component { constructor () { super() this.state = { useElem: 0 } } handleClick (elem) { var id = elem.target.id this.setState({ useElem: id }) } render () { return ( <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{this.handleClick}</span></span></span><span class="hljs-tag">&gt;</span></span> {new Array(20).fill().map((_, index) =&gt; <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{index}</span></span></span><span class="hljs-tag"> // </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elem.id</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{index}</span></span></span><span class="hljs-tag"> // </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elem.id</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">useElem</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{index</span></span></span><span class="hljs-tag"> === </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">this.state.useElem}</span></span></span><span class="hljs-tag"> /&gt;</span></span> )} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> ) } }</code> </pre> <br><p>  La délégation est un bon outil pour traiter un grand nombre d'abonnements, et dans le cas d'un rendu dynamique et de redessins fréquents, elle est tout simplement irremplaçable.  Dommage pour les ressources de l'utilisateur, elles ne sont pas illimitées. </p><br><p>  Cet article est basé sur un livre JavaScript pour les développeurs Web professionnels, écrit par Nicholas Zakas. </p><br><p>  <strong>Merci beaucoup pour votre attention.</strong>  <strong>Si vous avez quelque chose à partager ou trouvez une sorte de faille, peut-être une erreur ou une question, écrivez dans les commentaires.</strong>  <strong>Je serai heureux de toute rétroaction!</strong> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr467361/">https://habr.com/ru/post/fr467361/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr467349/index.html">Déplacer un programmeur en Estonie: travail, argent et coût de la vie</a></li>
<li><a href="../fr467353/index.html">Méthodes d'optimisation de code pour Redd. Partie 1: effet de cache</a></li>
<li><a href="../fr467355/index.html">Entretien avec Eugene Schwab-Chesaru, chercheur de marché et tendances du développement de logiciels en Europe centrale et orientale</a></li>
<li><a href="../fr467357/index.html">PVS-Studio dans les nuages: Azure DevOps</a></li>
<li><a href="../fr467359/index.html">PVS-Studio passe aux nuages: Azure DevOps</a></li>
<li><a href="../fr467363/index.html">Utilisation de fonctions de perte personnalisées et apprentissage des métriques de qualité dans Keras</a></li>
<li><a href="../fr467365/index.html">Relais de surveillance de tension résidentiels</a></li>
<li><a href="../fr467369/index.html">RubyRussia 2019. Mikhail Pronyakin: Ruby est-il sûr?</a></li>
<li><a href="../fr467371/index.html">Analyse des entretiens d'embauche Google: recherche de relations</a></li>
<li><a href="../fr467375/index.html">Gestion de l'expérience client - qu'est-ce que c'est?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>