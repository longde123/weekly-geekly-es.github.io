<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👰🏼 💇🏿 ✌🏻 Comment rouler avec un code hérité lorsqu'un projet était nécessaire hier 🤗 👍🏻 🐠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Salut Je m'appelle Ivan Melnichuk, je suis chef du département de développement dans une société informatique ukrainienne. Dans la publication, je veu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment rouler avec un code hérité lorsqu'un projet était nécessaire hier</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/431562/">  Salut  Je m'appelle Ivan Melnichuk, je suis chef du département de développement dans une société informatique ukrainienne.  Dans la publication, je veux partager mes approches professionnelles personnelles concernant la résolution du problème de code hérité dans le contexte du développement rapide du projet et parler des techniques auxquelles notre équipe a recours dans les cas «lorsque des fonctionnalités doivent être transmises» pour hier ». <br><br><h3>  Nous nous occupons du projet </h3><br>  Afin de montrer à quel point le travail doit être précis, réfléchi et minutieux avec l'héritage, je donnerai une analogie avec un château de cartes. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dbb/e10/658/dbbe10658bed914e04ba9514627493f7.jpg" alt="image"></div><br>  Voici à quoi ressemble le code hérité.  Si nous décidons de retirer ou de remplacer au moins une carte de ce bâtiment, nous courons le risque de submerger toute la maison et de niveler ses restes avec le sol. <br><br>  Legacy se comporte approximativement de la même manière.  Par conséquent, le travail d'un programmeur qui a assumé la tâche de moderniser et de «donner une seconde vie» au projet devrait être dans une certaine mesure un bijou.  La plupart des programmeurs tentent d'éviter et généralement de «sauter du sujet» de la dette technique.  Même compilé un hit-parade des citations les plus courantes qui devaient être entendues par des programmeurs pris dans des conditions héritées: <br><a name="habracut"></a><br><ol><li>  <i>Nous avons créé un site "simple", et maintenant vous voulez obtenir un nouveau "chignon", et nous devons réécrire tout cela, car nous avons un héritage ...</i> </li><li>  <i>Personne ne sait comment cela fonctionne ..</i> </li><li>  <i>Pour ajouter un module, vous devez vérifier l'ensemble du site - seulement de cette façon, nous comprendrons quoi et où il peut sortir ...</i> </li><li>  <i>Je ne vais pas y aller en tout cas, tout y est déjà mal ...</i> </li></ol><br>  Mais l'expérience en programmation montre que la vie après l'héritage existe.  Il n'y a aucun problème de programmation.  Il n'y a que des tâches qui doivent être traitées.  Et avant d'élaborer un plan d'action «pour surmonter le code d'héritage», vous devez comprendre à quel point les choses sont mauvaises sur le projet dans son ensemble.  Au cours de la pratique, il a identifié 6 étapes du problème du projet: <br><br><ol><li>  <i>Pas de documentation technique.</i>  Le seuil de problèmes le plus bas, car vous pouvez tester et en venir à des hypothèses préliminaires sur la façon dont cela devrait fonctionner. </li><li>  <i>Pas de documentation commerciale.</i>  Si toute la documentation (à la fois technique et commerciale) est manquante, le sentiment «il semble que nous sommes coincés dans l'histoire» vient involontairement.  En effet, même une entreprise ne se souvient pas de la façon dont elle devrait fonctionner, ce qui signifie que l'équipe, au moins, n'a aucune compréhension du résultat attendu. </li><li>  <i>Personne n'a conçu cela.</i>  Si, en plus du manque de documentation, il n'y a pas non plus de développeur qui pourrait expliquer comment le projet devrait fonctionner, alors ça sent déjà frit. </li><li>  <i>Nous ne savons pas ce que l'utilisateur devrait finalement obtenir.</i>  C'est une chose lorsque seuls les problèmes liés au back-end se posent, mais si nous n'avons toujours aucune idée de ce qui doit être affiché à l'avant, cela est déjà proche de l'état «le patient est plus susceptible d'être mort que vivant». </li><li>  <i>200+ utilisation de chaque fonction et elles sont appelées getA</i> .  Cinquième niveau de difficulté: lorsque vous entrez dans Legacy, vous voyez l'utilisation des fonctions A et 200, et personne ne sait pourquoi c'est ... </li><li>  <i>Il n'y a aucun programmeur qui souhaiterait / pourrait développer.</i>  Pas de commentaire. </li></ol><br><h3>  Comprendre les affaires </h3><br>  Les entreprises comptent pour l'argent.  Les entreprises ne veulent pas dépenser des ressources financières supplémentaires simplement pour refaire ce qui fonctionne déjà.  Une entreprise n'achètera jamais l'idée: «Je vais le faire d'une manière nouvelle parce que je n'aime pas ça.»  Par conséquent, offrez toujours plus. <br><br>  Souvent, les développeurs poussent les entreprises vers des idées inutiles.  À cette occasion, il existe un «fonds de citations d'or» distinct. <br><br><ul><li>  <i>Nous embauchons une nouvelle équipe pour un «sciage» de haute qualité du code.</i>  Autrement dit, nous avons besoin d'une équipe de spécialistes qui réalisera le projet en parallèle avec l'équipe existante.  Pas le fait que le résultat sera différent, mais l'entreprise devrait déjà contenir deux projets. </li><li>  <i>Nous arrêtons d'ajouter des fonctionnalités, maintenant seulement la refactorisation!</i>  Officiellement, vous déclarez aux entreprises: tabou absolu sur les fonctionnalités, il est seulement possible de "mettre les choses en ordre" sous le capot.  Officieusement, vous avez dit qu'il n'y aura pas d'améliorations et d'améliorations à grande échelle du projet, mais que vous les «réparerez» localement. </li><li>  <i>J'ai déjà tout ce dont j'ai besoin sur WP, j'ai juste besoin de migrer la base de données.</i>  Il s'agit d'un «symptôme» d'un débutant.  La chanson préférée de June: c'est un site tellement simple, ça ne marche qu'une heure ou deux ... </li></ul><br>  Pour négocier avec l'entreprise concernant la réincarnation d'un code obsolète, servi sous la sauce de nouvelles fonctionnalités rentables, il faut partir de la position d'ouvrir de nouveaux horizons commerciaux.  Cependant, avant les négociations, il faut répondre aux questions suivantes: <br><br><ol><li>  <b>L'entreprise est-elle prête à croître?</b>  Vous devez comprendre: l'entreprise a-t-elle une demande d'élever la norme financière ou a-t-elle simplement besoin du service pour travailler plus efficacement? </li><li>  <b>Stade du prototype?</b>  Souvent, une entreprise commande un prototype simple, avec lequel elle veut «sonder» le marché au moment de la pertinence du produit.  Et ce n'est que s'il commence à gagner de l'argent que l'entreprise est prête à développer la fonctionnalité en un projet plus avancé et complet. </li><li>  <b>Le développement est-il terminé et désormais uniquement support?</b>  Il est important de comprendre la gamme complète des tâches. </li><li>  <b>Y a-t-il suffisamment de feu dans nos yeux et ne s'éteindra-t-il pas?</b>  Le projet doit inspirer et non démotiver.  Il est très important que votre équipe souhaite s'engager dans la réincarnation de Legacy, sinon les gens se disperseront progressivement dans des projets plus intéressants pour eux. </li><li>  <b>Y a-t-il un architecte?</b>  C'est la question la plus importante - avez-vous une personne qui peut faire la bonne architecture et commencer à écrire du bon code déjà.  Cela n'a aucun sens d'essayer même de commencer s'il n'y a pas d'architecte.  Sinon, dans une semaine, vous deviendrez celui qui a créé l'héritage du problème. </li></ol><br>  Lorsque vous vendez des idées aux entreprises, concentrez-vous sur les messages "nouveau, créer, ajouter" ... L'entreprise répond très bien aux offres de la série: "Nous vous ferons une nouvelle fonctionnalité et le projet X sera plus rapide ..." et "Pour augmenter la conversion, ajoutez-en une nouvelle ... " <br><br><h3>  P - Planification </h3><br>  Pour travailler rapidement et efficacement avec la dette technique, vous avez besoin d'un plan. <br><br>  1. <i>Définition des tâches sur lesquelles nous parasiterons.</i>  Pourquoi parasiter?  Cela arrive souvent: nous avons vendu une fonctionnalité, et par là, nous entendons partiellement le refactoring. <br><br>  2. <i>Définition d'exigences de haut niveau.</i>  Il est nécessaire d'enregistrer une demande commerciale claire pour un «standard élevé» afin d'établir la documentation correcte. <br><br>  3. <i>Définition des principaux modules du système, imposition de modules.</i>  Avant de commencer la refactorisation, vous devez comprendre les principaux modules du système: où, comment, quoi et avec quoi peuvent interagir et délimiter le code en sections. <br><br>  4. <i>Définition de l'intégration.</i>  Lors de la création d'un module spécifique, nous devons penser à l'avance à la possibilité de le monter dans un héritage voisin. <br><br>  5. <i>Définition de l'équipe.</i>  Un dans le domaine du refactoring n'est pas un guerrier.  L'équipe est un élément très important d'un résultat réussi.  Ferveur, esprit d'équipe et excellente interaction entre les participants au processus indispensable. <br><br>  6. <i>Comment allons-nous tester?</i>  Si vous envisagez de prendre un projet de haute qualité, vous devez penser à l'avance et proposer des options de test de produit. <br><br>  Parallèlement à ce qui précède, il est également important de déterminer quel devrait être le résultat final souhaité, d'élaborer un plan de mise à l'échelle et d'enregistrer les goulots d'étranglement du projet.  Par exemple, en cas de mise à l'échelle de code, il est important de comprendre où des problèmes peuvent potentiellement survenir dans des conditions de forte charge (il peut s'agir d'une base de données, ou de requêtes lourdes, ou d'une grille, ou d'un autre lien intermédiaire qui peut «tomber»). <cut></cut><br><br>  Il est tout aussi important de déterminer les limites du projet, où se trouvait l'ancien code et où il y aura un nouveau niveau de «chef-d'œuvre».  Vous devriez également envisager des approches de microservices, ou DDD, ou, peut-être, vous avez besoin d'un peu plus de «nanomagie». <br><br><h3>  Ninja Legacy Techniques </h3><br>  Après le «travail préparatoire», nous arrivons aux techniques qui facilitent le processus d'épargne de la dette technique.  Il n'y a pas de recette universelle et de panacée pour tous les maux dans Legacy, mais au cours de travaux sur des projets à forte charge, j'ai fait une liste d'ingrédients avec lesquels vous pouvez préparer un code vraiment «savoureux». <br><br>  1. <b>Ne réinventez pas la roue.</b>  Pour moi, c'est le principal hack de vie pour écrire du code.  Tout a été inventé avant vous, ne recourez pas à la danse avec des tambourins et autres expériences pour résoudre les problèmes de code hérité. <br><br>  2. <b>Le code est standard.</b>  Sans standard unique, chaque développeur écrira à sa manière.  Le «style d'auteur» contribuera au chaos et augmentera encore plus la corbeille de code. <br><br>  3. <b>Révision du code.</b>  Pas seulement une présence de la norme de code.  Il est également nécessaire que l'équipe soit chargée de le vérifier.  Sinon, tout reviendra à la normale, c'est-à-dire au niveau de l'ancien code. <br><br>  4. <b>Analyseurs de code statique, détecteur de dégâts PHP, etc. (au lieu d'un millier de livres)</b> .  Ces techniques et d'autres techniques automatiques seront nécessaires pour accélérer le processus, en particulier avec le même code de révision. <br><br>  5. <b>Nous essayons les microservices.</b>  Séparément, il peut également y avoir des modules ou des bibliothèques.  Pourquoi des microservices?  Leur avantage est d'isoler autant que possible la logique et de la limiter à une API spécifique.  L'avantage de ce dernier est que l'API est une entité plus monolithique par rapport à «l'adaptateur dans le code qui peut être corrigé».  Cependant, l'API présente un inconvénient sous la forme de coûts réseau supplémentaires. <cut></cut><br><br>  6. <b>Architecture de base de données, sources de données.</b>  C'est la base de données que je considère comme le premier goulot d'étranglement de tout héritage.  Mais tout le monde conçoit comme il veut, et même en SQL, vous pouvez trouver des défauts non focalisés.  Voici quelques conseils pour travailler avec la nouvelle base de données: <br><br><ul><li>  <i>Rien à foutre, soif de tout.</i>  Si vous souhaitez modifier l'ancienne structure de données incorrecte en un nouveau format de données, plus rapide et plus productif, vous pouvez procéder de deux manières.  La première consiste à installer une nouvelle base, en supprimant complètement l'ancienne et quoi qu'il arrive.  La seconde - dans le cas d'un héritage dur, introduire un nouveau format en parallèle.  Au sens figuré, pour en planter un nouveau près d'un vieil arbre.  Pourquoi la deuxième voie est-elle justifiée et plus prometteuse?  Parce que tout ce qui est nouveau fonctionnera efficacement et si des problèmes surviennent pendant la phase de déploiement ou d'intégration, vous pouvez simplement restaurer le code et il n'est pas nécessaire de restaurer toutes les migrations de bases de données complexes. </li><li>  <i>Une nouvelle base de données est créée dans la structure correcte.</i>  Lors de la création d'une nouvelle ressource, il est important de contrôler les endroits dans lesquels nous écrivons la nouvelle structure.  En parallèle, il est nécessaire de créer un support pour l'ancienne structure, car il n'est pas pratique de s'en débarrasser complètement.  Autrement dit, nous continuons à écrire du nouveau matériel, et en même temps, nous soutenons l'ancien modèle, dans lequel nous traduisons tout ce qui est nouveau, et permettons ainsi à l'ancien de fonctionner aussi - comme si à l'ancienne, mais en soutenant la nouvelle structure. </li><li>  <i>Nous contrôlons l'ensemble de l'enregistrement.</i>  Nous ne manquons pas les détails du champ d'attention afin de garantir le support de la base de données. </li></ul><br>  7. <b>Mais SQL?</b>  Si, d'un point de vue architectural, vous pouvez opérer avec des entités, opérez.  Le concept de quelque chose de défini et de fini vous aidera à ne pas créer de relations inutiles et en double. <cut></cut><br><br>  8. <b>Décorateurs, adaptateurs, médiators ...</b> Ces modèles sont l'un des principaux pour intégrer le nouveau code dans l'ancien héritage. <br><br>  9. <b>Plan B, ou plan de restauration pour l'intégration.</b>  Beaucoup font l'erreur de l'oublier.  Il est vital dans la situation «quand quelque chose ne va pas» lors de la coulée de nouveau matériel.  Autrement dit, dès que nous commençons à construire l'architecture, déjà à ce stade, nous devons comprendre comment nous allons la restaurer en cas de bogue. <br><br>  10. <b>Un nouveau code sans (docks) tests devient un héritage en une semaine.</b>  Peu importe la beauté de votre code, sans documentation dans une semaine, il sera dans le statut «hérité» - en raison de son incompréhensibilité. <br><br>  11. <b>Test.</b>  Si les tests unitaires sont trop chers, nous utilisons des tests de fumée, fonctionnels et d'intégration.  Dans quelle mesure est-il réaliste de vendre des tests unitaires à une entreprise avec de la sauce «pour rendre un travail beau?»  Dans nos réalités, c'est plutôt une rareté qu'un modèle.  Si pour une raison quelconque, cela ne fonctionne pas avec des «unités», nous nous tournons vers des tests de fumée, fonctionnels ou d'intégration, et n'oubliez pas que nous pouvons déléguer la tâche, par exemple, à un testeur manuel. <br><br><h3>  Au lieu d'un épilogue </h3><br>  La chose la plus importante dans cette histoire est de faire le travail et de ne pas laisser l'héritage de 6 étapes problématiques (classées par ordre de simple à plus complexe): <br><br><ul><li>  Pas de documentation technique </li><li>  Pas de documentation commerciale </li><li>  Il n'y a personne qui a développé ce </li><li>  Nous ne savons pas ce que l'utilisateur devrait recevoir. </li><li>  200 + utilisation de chaque fonction et elles sont appelées getA () </li><li>  Il n'y a personne qui voudrait / pourrait développer cela. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr431562/">https://habr.com/ru/post/fr431562/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr431550/index.html">Moulage par injection de film (IMD): comment cela fonctionne</a></li>
<li><a href="../fr431554/index.html">Facebook comme le compteur d'un vieux compteur électrique</a></li>
<li><a href="../fr431556/index.html">Sidenis sur le travail avec les sociétés d'assurance, le coaching agile et les technologies interdites</a></li>
<li><a href="../fr431558/index.html">Si inventer un langage de programmation du 21e siècle</a></li>
<li><a href="../fr431560/index.html">Accès aux réseaux de signalisation SS7 via le sous-système radio - maintenant c'est possible</a></li>
<li><a href="../fr431564/index.html">La plus grande erreur de l'histoire de la physique</a></li>
<li><a href="../fr431566/index.html">Accéléromètres et gyroscopes MEMS - Comprendre les spécifications</a></li>
<li><a href="../fr431568/index.html">Recueil Fintech: paiement par téléphone, nouvelle attaque des distributeurs automatiques de billets, institutionnalisation de la cryptosphère</a></li>
<li><a href="../fr431570/index.html">Étude sur la sécurité des paiements de stationnement</a></li>
<li><a href="../fr431572/index.html">Comment rédiger les exigences fonctionnelles</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>