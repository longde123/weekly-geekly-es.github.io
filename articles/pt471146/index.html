<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💫 🌸 ✅ Serviços órfãos: o lado oposto da (micro) arquitetura de serviço ⛹🏻 ⚪️ 🖕</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Na conferência do ano passado, DevOpsDays Moscow, o diretor de operações do portal Banki.ru, Andrei Nikolsky, falou sobre serviços órfãos: como identi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Serviços órfãos: o lado oposto da (micro) arquitetura de serviço</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/scienceman_events/blog/471146/">  Na conferência do ano passado, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DevOpsDays Moscow, o</a> diretor de operações do portal Banki.ru, Andrei Nikolsky, falou sobre serviços órfãos: como identificar um órfão na infraestrutura, quais são os maus serviços órfãos, o que fazer com eles e como ser, se nada ajudar. <br><br>  Abaixo do corte, está a versão em texto do relatório. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/j9I4oeEXBO8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><a name="habracut"></a><br>  Olá colegas!  Meu nome é Andrey, lidero a operação no Banki.ru. <br><br>  Temos ótimos serviços, são serviços monolíticos, existem serviços em um sentido mais clássico, existem muito pequenos.  Na terminologia de meu trabalhador e camponês, digo que se o serviço é simples e pequeno, então é micro, e se não é muito simples e não é pequeno, é apenas um serviço. <br><br><h3>  <b>Profissionais de serviço</b> </h3><br>  Analisarei rapidamente as vantagens dos serviços. <br><br><img src="https://habrastorage.org/webt/ji/xj/_u/jixj_uxelvtokkt54xoul15fsnu.png"><br><br>  A primeira é a escala.  Você pode fazer algo rapidamente no serviço e iniciar a produção.  Você chegou ao trânsito, clonou o serviço.  Você ainda tem tráfego, ainda clonou e vive com ele.  Este é um bom bônus e, em princípio, quando começamos, era considerado o mais importante entre nós, por que fazemos tudo isso. <br><br><img src="https://habrastorage.org/webt/lc/oq/d3/lcoqd397ppryaemtruvd7awdoxe.png"><br><br>  Em segundo lugar, desenvolvimento isolado, quando você tem várias equipes de desenvolvimento, vários desenvolvedores diferentes em cada equipe e cada equipe vê algum tipo de serviço. <br><br>  Há uma nuance com as equipes.  Os desenvolvedores são diferentes.  E há, por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pessoas-flocos de neve</a> .  Vi pela primeira vez isso com Maxim Dorofeev.  Às vezes, as pessoas têm flocos de neve em algumas equipes e outras não.  Isso torna os diferentes serviços usados ​​na empresa um pouco desiguais. <br><br><img src="https://habrastorage.org/webt/_k/nk/ml/_knkmlyetdgucwl7bkuxuvtpahe.png"><br><br>  Olhe para a foto: ele é um bom desenvolvedor, ele tem grandes mãos, ele pode fazer muito.  O principal problema é de onde essas mãos crescem. <br><br><img src="https://habrastorage.org/webt/-6/li/zn/-6liznhfxdjynboqueccoayiat8.png"><br><br>  Os serviços possibilitam o uso de diferentes linguagens de programação mais adequadas para diferentes tarefas.  Alguns serviços no Go, outros no Erlang, outros no Ruby, outros no PHP, outros no Python.  Em geral, você pode se virar muito amplamente.  Também há nuances aqui. <br><br><img src="https://habrastorage.org/webt/7h/ob/ka/7hobkajsj1y7nsdqr1sfoqt7ljo.jpeg"><br><br>  A arquitetura orientada a serviços é principalmente sobre devops.  Ou seja, se você não possui automação, não há processo de implantação; se você configurar com as mãos, suas configurações podem mudar de uma instância de serviço para uma instância e você precisa ir lá para fazer alguma coisa, então está no inferno. <br><br>  Por exemplo, você tem 20 serviços e precisa implantar com as mãos, 20 consoles e simultaneamente pressiona “enter”, como um ninja.  Isso não é muito bom. <br><br>  Se você tiver um serviço após o teste (se houver, é claro) e também precisará finalizá-lo com um arquivo para que ele funcione na produção, também tenho más notícias para você. <br><br>  Se você confia nos serviços específicos da Amazon e trabalha na Rússia, há dois meses você também tinha "Tudo está pegando fogo, estou bem, tudo é legal". <br><br><img src="https://habrastorage.org/webt/vu/z0/u6/vuz0u6eenpfaob592_jtdrnpp8e.png"><br><br>  Usamos Ansible para automação de implantação, Puppet para convergência, Bamboo para automação de implantação, Confluence para descrever tudo de alguma forma. <br><br>  Não vou me debruçar sobre isso em detalhes, porque o relatório é mais sobre a prática de interações e não sobre implementação técnica. <br><br><img src="https://habrastorage.org/webt/dg/c5/cz/dgc5cz_nevmer6hzgcxjj1tqe5g.png"><br><br>  Por exemplo, tivemos problemas com o Puppet no servidor que trabalha com o Ruby 2, e alguns aplicativos foram escritos no Ruby 1.8, e juntos eles não funcionam.  Existe algum tipo de batente.  E quando você precisa manter várias versões do Ruby na mesma máquina, geralmente tem problemas. <br><br>  Por exemplo, damos a cada desenvolvedor uma plataforma na qual há praticamente tudo o que temos, todos os serviços que podem ser desenvolvidos para que ele tenha um ambiente isolado, ele pode decompô-lo e construí-lo como quiser. <br><br>  Acontece que você precisa de algum tipo de pacote especialmente compilado com suporte para algo lá.  Isso é difícil o suficiente.  Ouvi um relatório em que a imagem do docker pesa 45 GB.  No Linux, é claro, é mais simples, tudo é menor lá, mas, de qualquer forma, não haverá lugares suficientes. <br><br>  Bem, existem dependências conflitantes quando você tem uma parte de um projeto, dependendo da biblioteca de uma versão, outra parte do projeto em uma versão diferente e as bibliotecas não são reunidas. <br><br><img src="https://habrastorage.org/webt/9m/dr/vn/9mdrvnnkajxl_8cxfmj79ukk8dk.png"><br><br>  Temos sites e serviços no PHP 5.6, temos vergonha deles, mas o que fazer.  Este é o nosso site.  Existem sites e serviços no PHP 7, há mais deles, não temos vergonha deles.  E cada desenvolvedor tem sua própria base, onde ele pode ser feliz. <br><br>  Se você escreve na empresa em um idioma, três máquinas virtuais por desenvolvedor - parece normal.  Se você tiver diferentes linguagens de programação, a situação se agrava. <br><br><img src="https://habrastorage.org/webt/mp/np/b0/mpnpb0q-gcmneomvazzs_1gd4-w.jpeg"><br><br>  Você tem sites e serviços nisto, nisto, então outra plataforma para Go, uma plataforma para Ruby, outro Redis ao lado.  Como resultado, tudo isso se transforma em um grande campo de suporte e, durante todo o tempo, parte disso pode ser interrompida. <br><br><img src="https://habrastorage.org/webt/cb/cq/u_/cbcqu_ynjcnffa0fepuvln_gib8.png"><br><br>  Portanto, substituímos os pães da linguagem de programação pelo uso de diferentes estruturas, uma vez que as estruturas em PHP são bem diferentes, elas têm capacidades diferentes, comunidades diferentes, suporte diferente.  E você pode escrever um serviço para que você já tenha algo pronto para ele. <br><br><h3>  <b>Cada serviço tem sua própria equipe.</b> </h3><br><img src="https://habrastorage.org/webt/zp/nc/6m/zpnc6mlp098fx0xriegr8mwn1jm.png"><br><br>  Nossa principal vantagem, que se cristalizou ao longo de vários anos, é que cada serviço tem sua própria equipe.  Isso é conveniente para um projeto grande, você pode economizar tempo com documentação, os gerentes estão bem cientes de seu projeto. <br><br>  Tarefas do suporte podem ser executadas perfeitamente.  Por exemplo, o serviço de seguros quebrou.  E imediatamente a equipe de seguros vai reparar. <br><br>  Novos recursos são criados rapidamente, porque quando você tem um serviço atômico, pode rapidamente estragar algo nele. <br><br>  E quando você interrompeu seu serviço, e isso inevitavelmente acontece, você não prejudicou os serviços de outra pessoa, e os desenvolvedores com partes de outras equipes não recorrem a você e eles não dizem: "Ah, não faça isso. <br><br><img src="https://habrastorage.org/webt/34/hw/ro/34hwroxdvr056crrpgakpbk2f1g.png"><br><br>  Como sempre, existem nuances.  Temos equipes estáveis, os gerentes são acertados na equipe.  Existem documentos claros, os gerentes monitoram tudo isso de perto.  Cada equipe com um gerente possui vários serviços e há um ponto específico de competência. <br><br>  Se as equipes estão flutuando (isso às vezes também é usado conosco), existe um bom método chamado mapa estelar. <br><br><img src="https://habrastorage.org/webt/lu/01/uq/lu01uqtz9m1qqsp-dndyetupouq.png"><br><br>  Você tem uma lista de serviços e pessoas.  Um asterisco significa que uma pessoa é especialista neste serviço, um livro significa que uma pessoa está estudando esse serviço.  A tarefa do homem é trocar um livrinho por um asterisco.  E se nada estiver escrito em frente ao serviço, começam os problemas, sobre os quais continuarei falando. <br><br><h3>  <b>Como os serviços órfãos aparecem?</b> </h3><br><img src="https://habrastorage.org/webt/eh/rx/97/ehrx971egg-nuycxtteb8q824wo.jpeg"><br><br>  O primeiro problema, a primeira maneira, de tornar um serviço órfão em sua infraestrutura é demitir pessoas.  Alguém já aconteceu quando os prazos chegam das empresas antes de avaliar as tarefas?  Às vezes acontece que os prazos são apertados e simplesmente não há tempo suficiente para a documentação.  "Devemos entregar o serviço à produção e depois o adicionaremos." <br><br>  Se a equipe é pequena, acontece que há um desenvolvedor que escreve tudo, o resto está nas asas.  "Eu escrevi a arquitetura básica, você me deu as interfaces."  Então, em algum momento, o gerente, por exemplo, sai.  E durante esse período, quando o gerente foi embora e um novo ainda não foi nomeado, os próprios desenvolvedores decidem para onde o serviço está se movendo, o que está acontecendo lá.  E como sabemos (vamos voltar alguns slides), em algumas equipes existem pessoas-flocos de neve, às vezes um floco de neve-timlid.  Então ele sai, e temos um serviço órfão. <br><br><img src="https://habrastorage.org/webt/rh/ro/qw/rhroqwez4ltwh8a5petmhcvszi4.png"><br><br>  Ao mesmo tempo, as tarefas de suporte e de negócios não desaparecem, elas são liquidadas na lista de pendências.  Se houver algum erro de arquitetura durante o desenvolvimento do serviço, eles também serão resolvidos no backlog.  O serviço está se degradando lentamente. <br><br><h3>  <b>Como identificar um órfão?</b> </h3><br>  Esta lista descreve bem a situação.  Quem aprendeu alguma coisa na infraestrutura? <br><br><img src="https://habrastorage.org/webt/4r/gy/nv/4rgynviquavl_b6pmfr85mhzybo.png"><br><br>  Sobre as soluções alternativas documentadas: existe um serviço e, em geral, funciona, possui um manual de duas páginas, como trabalhar com ele, mas ninguém sabe como funciona por dentro. <br><br>  Ou, por exemplo, há algum tipo de encurtador de link.  Por exemplo, agora usamos três encurtadores de link para diferentes propósitos em diferentes serviços.  Essas são as consequências. <br><br><img src="https://habrastorage.org/webt/sm/ka/0f/smka0fa5trizu6rxhzit6e-6fj0.png"><br><br>  Agora serei o capitão da evidência.  O que precisa ser feito?  Primeiro, você precisa transferir o serviço para outro gerente, outra equipe.  Se o líder da sua equipe ainda não desistiu, nessa outra equipe, quando você entender que o serviço é como um órfão, precisará incluir alguém que entenda pelo menos algo sobre ele. <br><br>  O principal: você deve ter procedimentos de transmissão por sangue.  No nosso caso, geralmente sigo isso, porque preciso que isso funcione.  Os gerentes precisam que isso seja entregue rapidamente, e o que acontecerá com ele mais tarde não é tão importante para eles. <br><br><img src="https://habrastorage.org/webt/6b/wy/5p/6bwy5pd9qqzaki4jfyo0qimq8tk.png"><br><br>  A próxima maneira de tornar um órfão é "Vamos fazer a terceirização, será mais rápido e depois a transferiremos para a equipe".  É claro que todo mundo tem alguns planos na equipe, na fila.  Freqüentemente, um cliente comercial pensa que um terceirizado fará o mesmo que o departamento técnico que está na empresa.  Embora seus motivadores sejam diferentes.  A terceirização tem soluções tecnológicas estranhas e soluções algorítmicas estranhas. <br><br><img src="https://habrastorage.org/webt/3o/iv/zg/3oivzgpkzi_5akenrhhsfl9r8h8.png"><br><br>  Por exemplo, tivemos um serviço em que o Sphinx estava em vários lugares inesperados.  Eu vou te dizer mais tarde o que eu tinha que fazer. <br><br>  Os terceirizados têm estruturas auto-escritas.  Este é apenas PHP nu com copiar e colar do projeto anterior, onde você pode encontrar tudo.  Muletas grandes nos scripts de implantação, quando você precisa alterar várias linhas em algum arquivo com alguns scripts Bash complexos, enquanto esses scripts de implantação são chamados por algum terceiro script.  Como resultado, você altera o sistema de implantação, escolhe outra coisa, pula e seu serviço não funciona.  Porque havia mais 8 links para colocar entre pastas diferentes.  Ou acontece que mil registros funcionam, mas cem mil se foram. <br><br>  Vou continuar a capitão.  Aceitar um serviço de terceirização é um procedimento necessário.  Quem aconteceu que um serviço de um contratador chega, mas não é aceito em lugar algum?  Obviamente, isso não é tão popular quanto um órfão de serviço, mas ainda assim. <br><br><img src="https://habrastorage.org/webt/ak/8j/lh/ak8jlhfoevrsvkv4d-y1rfu8gri.png"><br><br>  O serviço deve ser verificado, o serviço deve ser revisado, as senhas devem ser alteradas.  Tivemos um caso quando o serviço nos lançou, o painel de administração "se login == 'admin' &amp;&amp; password == 'admin' ..." está escrito diretamente no código.  Sentamos e pensamos, e as pessoas escrevem isso em 2018? <br><br>  Testar o volume de armazenamento também é obrigatório.  Você precisa observar o que acontecerá em cem mil registros, mesmo antes de iniciar esse serviço em algum lugar da produção. <br><br><img src="https://habrastorage.org/webt/mc/k2/qa/mck2qagxhsslsxcojjpekfludq4.png"><br><br>  Enviar o serviço para revisão não deve ter vergonha.  Quando você diz: "Não aceitaremos este serviço, temos 20 tarefas, execute-as e depois aceitaremos", isso é normal.  A consciência não deve prejudicar o fato de você substituir um gerente ou de uma empresa gastar dinheiro.  A empresa gastará mais. <br><br>  Tivemos um caso quando decidimos fazer um projeto piloto de terceirização. <br><br><img src="https://habrastorage.org/webt/fo/cm/be/focmbesdalmj5fa1ia9_lkpxss4.png"><br><br>  Foi entregue dentro do prazo e esse foi o único critério de qualidade.  Portanto, eles fizeram outro projeto piloto, nem mesmo um projeto piloto.  Esses serviços foram aceitos, disseram de maneira administrativa: aqui está o seu código, aqui está uma equipe, aqui está o seu gerente.  Os serviços realmente já começaram a ter lucro.  Além disso, na verdade, eles permaneceram órfãos, ninguém entende como eles funcionam e os gerentes de todas as maneiras possíveis negam suas tarefas. <br><br><img src="https://habrastorage.org/webt/z6/lo/mn/z6lomn7i2eknkjah0pquashtywu.png"><br><br>  Há outro excelente conceito - desenvolvimento partidário.  Quando um departamento, em regra, é um departamento de marketing, eles querem testar uma hipótese e solicitar todo o serviço terceirizado.  O tráfego começa a cair nele, eles fecham documentos, assinam atos com o contratado, entram em operação e dizem: “Cara, a gente tem um serviço aqui, ele já tem tráfego, nos traz dinheiro, nos traz dinheiro, vamos levar”  Nós somos: "Oppa, como assim." <br><br><img src="https://habrastorage.org/webt/bw/g-/vj/bwg-vjk4-tvz3574ib3mbjw18ue.png"><br><br>  E mais uma maneira de obter um serviço órfão: quando uma equipe é subitamente carregada, a gerência diz: "Vamos transferir o serviço dessa equipe para outra equipe, ela tem menos carga".  E então iremos transferir para a terceira equipe e mudaremos de gerente.  E no final, novamente temos um órfão. <br><br><h3>  <b>Qual é o problema com os órfãos?</b> </h3><br><img src="https://habrastorage.org/webt/_o/-3/ux/_o-3uxqtu_lh_cmgfg8mf6pousc.png"><br><br>  Quem não sabe, este foi o navio da linha Wasa criada na Suécia, famosa pelo fato de ter afundado 5 minutos após o lançamento.  E o rei da Suécia, aliás, não executou ninguém por isso.  Foi construído por duas gerações de engenheiros que não podiam construir tais navios.  O efeito natural. <br><br>  A propósito, o navio poderia afundar, muito pior, por exemplo, quando o rei o montaria em algum lugar durante uma tempestade.  E assim, ele se afogou imediatamente, de acordo com a prisão, é bom falhar cedo. <br><br>  Se falharmos cedo, geralmente não há problemas.  Por exemplo, durante a aceitação, eles enviaram para revisão.  E se já falhamos na produção, quando o dinheiro é investido, pode haver problemas.  As consequências, como são chamadas nos negócios. <br><br>  Por que serviços órfãos perigosos: <br><br><ul><li>  O serviço pode quebrar repentinamente. </li><li>  O serviço é reparado por um longo período ou não é reparado. </li><li>  Questões de segurança. </li><li>  Problemas com melhorias e atualizações. </li><li>  Se um serviço importante falha, a reputação da empresa sofre. </li></ul><br><h3>  <b>O que fazer com os serviços órfãos?</b> </h3><br><img src="https://habrastorage.org/webt/3k/ex/8v/3kex8vjbf7clzd9jbktsfzjclby.png"><br><br>  Mais uma vez, o que fazer.  Em primeiro lugar, deve haver documentação.  Durante 7 anos no Banki.ru, fui ensinado que os testadores não devem ter uma palavra para os desenvolvedores e a operação não deve ter uma palavra para todos.  É necessário verificar. <br><br><img src="https://habrastorage.org/webt/dx/rc/ub/dxrcubcmw-ybkov8kdag3cz2rzs.png"><br><br>  Em segundo lugar, é necessário escrever esquemas de interação, porque acontece que serviços que não são bem recebidos contêm dependências sobre as quais ninguém falou.  Por exemplo, os desenvolvedores colocam o serviço na chave para alguns Yandex.Maps ou Dadata.  Você ficou sem um limite gratuito, tudo quebrou e não sabe o que aconteceu.  Todos esses ancinhos devem ser descritos: o serviço usa Dadata, Sms, outra coisa. <br><br><img src="https://habrastorage.org/webt/hy/6o/ki/hy6okizhuhhwibejacdgchvoo68.png"><br><br>  Em terceiro lugar, trabalhe com a dívida técnica.  Quando você faz muletas ou aceita o serviço e diz que algo precisa ser feito, você precisa garantir que eles o façam.  Porque então pode acontecer que o pequeno buraco não seja tão pequeno e você caia lá. <br><br>  Com tarefas de arquitetura, tivemos uma história sobre o Sphinx.  Em um dos serviços, o Sphinx foi usado para inserir listas.  Apenas uma lista de paginação, mas era reindexada todas as noites.  Foi compilado a partir de dois índices: um foi indexado todas as noites, e ainda havia um pequeno índice aparafusado a ele.  Todos os dias, com uma probabilidade de 50%, bombardeará ou não, durante o cálculo, o índice estava batendo e as notícias pararam de ser atualizadas na página principal.  No início, eram 5 minutos, enquanto o índice era re-indexado, depois o índice aumentava e, em algum momento, começou a re-indexar 40 minutos.  Quando cortamos, soltamos um suspiro de alívio, porque estava claro que um pouco mais de tempo passaria e nosso índice seria reindexado em tempo integral.  Será um arquivo para o nosso portal, oito horas sem novidades - é isso, o negócio se levantou. <br><br><h3>  <b>Plano de trabalho com um serviço órfão</b> </h3><br><img src="https://habrastorage.org/webt/ox/ny/wq/oxnywqk2gpyoczjewhrt_ngsiz0.png"><br><br>  De fato, é muito difícil, porque o devops é sobre comunicação.  Quero ter boas relações com meus colegas e, quando você bate em colegas e gerentes com regulamentos na cabeça, eles podem ter sentimentos conflitantes por aquelas pessoas que fazem isso. <br><br>  Além de todos esses pontos, há outra coisa importante: para cada serviço específico, para cada seção específica do procedimento de implantação, pessoas específicas devem ser responsáveis.  Quando não há pessoas e você precisa atrair outras pessoas, para estudar a coisa toda, fica difícil. <br><br><img src="https://habrastorage.org/webt/6o/-d/co/6o-dcolwznowrvatclrcvbvau0a.png"><br><br>  Se tudo isso não ajudar, e o órfão do serviço ainda é órfão, ninguém quer levá-lo para você, a documentação não está escrita, a equipe que foi chamada para esse serviço se recusa a fazer algo, há uma maneira fácil de refazer tudo . <br><br>  Ou seja, você pega os requisitos de serviço novamente e escreve um novo serviço, melhor, em uma plataforma melhor, sem soluções tecnológicas estranhas.  E migre para ele na batalha. <br><br><img src="https://habrastorage.org/webt/_j/f2/wk/_jf2wkfeybtdq4xty4syofgx1ei.png"><br><br>  Tivemos uma situação em que pegamos o serviço no Yii 1 e percebemos que não podíamos desenvolvê-lo mais, porque tínhamos acabado os desenvolvedores que podem escrever bem no Yii 1. Todos os desenvolvedores escrevem bem no terceiro Symfony.  O que fazer  Levamos um tempo, alocamos a equipe, alocamos o gerente, reescrevemos o projeto e mudamos o tráfego suavemente para ele. <br><br>  Depois disso, o serviço antigo pode ser excluído.  Esse é o meu procedimento favorito, quando você precisa retirar e limpar algum serviço do sistema de gerenciamento de configuração e depois verificar se todos os carros da produção foram reembolsados ​​para que os desenvolvedores não tenham mais vestígios.  O repositório no git permanece. <br><br>  Isso é tudo sobre o que eu queria falar, estou pronto para discutir, o tópico é holístico, muitos flutuaram nele. <br><br>  <b>Nos slides, tratava-se de você unificar idiomas.</b>  <b>Um exemplo foi o redimensionamento de imagens.</b>  <b>Mas é realmente necessário ter um idioma difícil?</b>  <b>Como redimensionar imagens em PHP, bem, você realmente pode fazer isso em Golang.</b> <br><br>  De fato, isso não é necessário, como todas as práticas.  Talvez, em alguns casos, até indesejável.  Mas você precisa entender que, se você tem 50 pessoas no departamento técnico, 45 delas são desenvolvedores de PHP, outras 3 são devops que podem fazer Python, Ansible, Puppet e algo assim, e apenas uma delas escreve em alguns Vá ao serviço para redimensionar as fotos e, quando ele sair, o exame sairá com ele.  E, ao mesmo tempo, você precisará procurar um desenvolvedor específico do mercado que conheça esse idioma, especialmente se for raro.  Ou seja, do ponto de vista organizacional, isso é problemático.  Do ponto de vista dos devops, você precisará não apenas clonar alguns conjuntos prontos de playbooks que você usa para implantar serviços, mas também precisará escrevê-los novamente. <br><br>  Agora estamos vendo o serviço no Node.js, e ele será apenas uma plataforma próxima para cada desenvolvedor com um idioma separado.  Mas ficamos pensando que o jogo valia a pena.  Ou seja, a questão aqui é sentar e pensar. <br><br>  <b>Como você monitora seus serviços?</b>  <b>Como você coleta e rastreia logs?</b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Coletamos logs no Elasticsearch e colocamos no Kibana e, dependendo dos ambientes de produção ou teste, diferentes coletores são usados ​​lá. Em algum lugar lenhador, em algum outro lugar, não me lembro mais. E ainda existem alguns lugares em certos serviços onde colocamos o Telegraf e o bullet em outro lugar separadamente. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como viver com o Puppet e o Ansible em um ambiente?</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De fato, agora temos dois ambientes, um é Puppet, o outro é Ansible. Estamos trabalhando para hibridá-los. O Ansible é um bom ambiente para a configuração inicial, o Puppet é uma coisa ruim para a configuração inicial, porque requer mãos para trabalhar diretamente com o site, e o Puppet fornece convergência de configuração. Isso significa que o site em si é mantido atualizado e, para que a máquina ansiblizada seja mantida atualizada, você precisa constantemente jogar com ele com alguma frequência. Aqui está essa diferença. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como você mantém a compatibilidade? Você tem configurações no Ansible e no Puppet?</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Essa é a nossa grande dor, mantemos a compatibilidade com as mãos e pensamos, como se agora, mudar tudo isso para algum lugar. Acontece que o Puppet lança pacotes e suporta alguns links lá, enquanto o Ansible, por exemplo, rola o código e direciona novas configurações de aplicativos para lá. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A apresentação foi sobre diferentes versões do Ruby. Qual é a solução?</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Somos confrontados com isso em um só lugar, e temos que manter isso em mente o tempo todo. Acabamos de desativar a parte que trabalhava no Ruby, que era incompatível com os aplicativos, e a mantivemos separada.</font></font><br><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este ano, a conferência </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DevOpsDays Moscow</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> será realizada em 7 de dezembro em Technopolis. </font><font style="vertical-align: inherit;">Até 11 de novembro, aceitamos solicitações de relatórios. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Envie-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nos se você quiser falar. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As inscrições para os participantes estão abertas, participe!</font></font><br></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt471146/">https://habr.com/ru/post/pt471146/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt471134/index.html">Python vs JavaScript: Qual deles pode te beneficiar mais?</a></li>
<li><a href="../pt471136/index.html">A primeira grande reunião de tubos da comunidade Scala na Rússia - como foi</a></li>
<li><a href="../pt471138/index.html">Programação em par em Vineti</a></li>
<li><a href="../pt471140/index.html">Preparando-se para a certificação profissional da Spring. Descanso de primavera</a></li>
<li><a href="../pt471142/index.html">12 recursos do ES10 em 12 exemplos simples</a></li>
<li><a href="../pt471150/index.html">“Como gerenciar intelectuais. I, nerds e geeks "(versão eletrônica gratuita do livro)</a></li>
<li><a href="../pt471154/index.html">De volta à escola: como treinar testadores portáteis para lidar com testes automáticos</a></li>
<li><a href="../pt471158/index.html">ID @ Xbox na Rússia: expandindo os horizontes dos jogos</a></li>
<li><a href="../pt471160/index.html">Problema ao instalar o Ruby on Rails no final de 2019</a></li>
<li><a href="../pt471162/index.html">Anunciando suporte para edição nativa de notebooks Jupyter no código VS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>