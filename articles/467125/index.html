<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ÜîÔ∏è üí≤ üëÉüèΩ Juego moderno de NES escrito en un lenguaje similar a Lisp üë®‚Äçüë®‚Äçüëß‚Äçüë¶ üë©üèΩ‚Äçüíº üõÉ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What Remains es un juego narrativo de aventuras para la consola de videojuegos NES de 8 bits, lanzado en marzo de 2019 como una ROM gratuita que se ej...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Juego moderno de NES escrito en un lenguaje similar a Lisp</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467125/">  What Remains es un juego narrativo de aventuras para la consola de videojuegos NES de 8 bits, lanzado en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">marzo de 2019</a> como una ROM gratuita que se ejecuta en el emulador.  Fue creado por un peque√±o equipo de Iodine Dynamics durante dos a√±os de forma intermitente.  En este momento, el juego se encuentra en la etapa de implementaci√≥n en el hardware: estamos creando un conjunto limitado de cartuchos a partir de piezas recicladas. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/db4/d1a/663/db4d1a6633208845a7e7ce5d670d82ac.jpg"></div><br>  El juego tiene 6 niveles en los que el jugador camina a lo largo de varias escenas con cartas de desplazamiento en cuatro direcciones, se comunica con el NPC, recoge pistas, conoce su mundo, juega minijuegos y resuelve rompecabezas simples.  Yo era el ingeniero jefe del proyecto, as√≠ que encontr√© muchas dificultades para hacer realidad la visi√≥n del equipo.  Dadas las serias limitaciones del equipo NES, es bastante dif√≠cil crear un juego para √©l, sin mencionar un proyecto con tanto contenido como en What Remains.  Solo gracias a los subsistemas √∫tiles creados que nos permiten ocultar esta complejidad y administrarla, pudimos trabajar en equipo y completar el juego. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/956/a4d/921/956a4d9217a209643bb35b68e25694b5.png"></div><br>  En este art√≠culo hablar√© sobre algunos detalles t√©cnicos de partes individuales del motor del juego.  Espero que otros desarrolladores los encuentren √∫tiles o al menos curiosos. <br><a name="habracut"></a><br><h2>  Equipo NES </h2><br>  Antes de comenzar el c√≥digo, le contar√© un poco sobre las especificaciones del equipo con el que trabajamos.  NES es una consola de juegos lanzada en 1983 (Jap√≥n, 1985 - Am√©rica).  En su interior tiene una CPU 6502 de 8 bits [1] con una frecuencia de 1.79 MHz.  Dado que la consola produce 60 cuadros por segundo, hay aproximadamente 30 mil ciclos de CPU por cuadro, y esto es bastante peque√±o para calcular todo lo que sucede en el ciclo de juego principal. <br><br>  Adem√°s, la consola tiene un total de 2048 bytes de RAM (que se puede ampliar a 10,240 bytes usando RAM adicional, lo cual no hicimos).  Tambi√©n puede abordar 32 KB de ROM a la vez, lo que se puede ampliar cambiando de banco (What Remains usa 512 KB de ROM).  Cambiar de banco es un tema complejo [2] que los programadores modernos no abordan.  En resumen, el espacio de direcciones disponible para la CPU es menor que los datos contenidos en la ROM, es decir, cuando se cambia manualmente, los bloques de memoria completos permanecen inaccesibles.  ¬øQuer√≠as llamar a alguna funci√≥n?  No es hasta que reemplace el banco llamando al comando de cambio de banco.  Si esto no se hace, cuando se llama a la funci√≥n, el programa se bloquear√°. <br><br>  De hecho, lo m√°s dif√≠cil al desarrollar un juego para NES es considerar todo esto al mismo tiempo.  La optimizaci√≥n de un aspecto del c√≥digo, como el uso de memoria, a menudo puede afectar a otra cosa, como el rendimiento de la CPU.  El c√≥digo debe ser efectivo y al mismo tiempo conveniente en soporte.  Por lo general, los juegos se programaban en lenguaje ensamblador. <br><br><h2>  Co2 </h2><br>  Pero en nuestro caso, no fue as√≠.  En cambio, un t√°ndem con el juego habr√≠a desarrollado su propio lenguaje.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Co2</a> es un lenguaje similar a Lisp construido en Racket Scheme y compilado en el ensamblador 6502. Inicialmente, el lenguaje fue creado por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Dave Griffiths</a> para construir la demostraci√≥n What Remains, y decid√≠ usarlo para todo el proyecto. <br><br>  Co2 le permite escribir c√≥digo de ensamblador incorporado si es necesario, pero tambi√©n tiene capacidades de alto nivel que simplifican algunas tareas.  Implementa variables locales que son efectivas tanto en t√©rminos de consumo de RAM como de velocidad de acceso [2].  Tiene un sistema macro muy simple que le permite escribir c√≥digo legible y al mismo tiempo eficiente [3].  Lo m√°s importante, debido a la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">homo-conicidad de</a> Lisp, simplifica enormemente la visualizaci√≥n de datos directamente en la fuente. <br><br>  Escribir sus propias herramientas est√° bastante extendido en el desarrollo de juegos, pero crear un lenguaje de programaci√≥n completo es mucho menos com√∫n.  Sin embargo, lo hicimos.  No est√° muy claro si la complejidad del desarrollo y el soporte de Co2 se demostr√≥, pero definitivamente ten√≠a ventajas que nos ayudaron.  En la publicaci√≥n no hablar√© en detalle sobre el trabajo de Co2 (esto merece un art√≠culo separado), pero lo mencionar√© constantemente porque su uso est√° bastante estrechamente entrelazado con el proceso de desarrollo. <br><br>  Aqu√≠ hay un c√≥digo de Co2 de muestra que dibuja el fondo de una escena cargada antes de atenuarla: <br><br><pre><code class="lisp hljs"><span class="hljs-comment"><span class="hljs-comment">; Render the nametable for the scene at the camera position (defsub (create-initial-world) (camera-assign-cursor) (set! camera-cursor (+ camera-cursor 60)) (let ((preserve-camera-v)) (set! preserve-camera-v camera-v) (set! camera-v 0) (loop i 0 60 (set! delta-v #xff) (update-world-graphics) (when render-nt-span-has (set! render-nt-span-has #f) (apply-render-nt-span-buffer)) (when render-attr-span-has (set! render-attr-span-has #f) (apply-render-attr-span-buffer))) (set! camera-v preserve-camera-v)) (camera-assign-cursor))</span></span></code> </pre> <br><h2>  Sistema de la entidad </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ee6/d87/ad4/ee6d87ad406879dbc9433c61fa4e3a5b.png"></div><br>  Cualquier juego en tiempo real m√°s complejo que Tetris es inherentemente un "sistema de entidades".  Esta es una funcionalidad que permite que varios actores independientes act√∫en simult√°neamente y sean responsables de su propia condici√≥n.  Aunque What Remains no es en absoluto un juego activo, todav√≠a tiene muchos actores independientes con un comportamiento complejo: se animan y se representan a s√≠ mismos, verifican colisiones y provocan di√°logos. <br><br>  La implementaci√≥n es bastante t√≠pica: una gran matriz contiene una lista de entidades en la escena, cada registro contiene datos relacionados con la entidad junto con una etiqueta de tipo.  La funci√≥n de actualizaci√≥n en el ciclo de juego principal evita todas las entidades e implementa el comportamiento correspondiente seg√∫n su tipo. <br><br><pre> <code class="lisp hljs"><span class="hljs-comment"><span class="hljs-comment">; Called once per frame, to update each entity (defsub (update-entities) (when (not entity-npc-num) (return)) (loop k 0 entity-npc-num (let ((type)) (set! type (peek entity-npc-data (+ k entity-field-type))) (when (not (eq? type #xff)) (update-single-entity k type)))))</span></span></code> </pre> <br>  La forma de almacenar datos de entidad es m√°s interesante.  En general, el juego tiene tantas entidades √∫nicas que el uso de una gran cantidad de ROM puede convertirse en un problema.  Aqu√≠ Co2 muestra su poder, permiti√©ndonos presentar cada esencia de la escena en una forma concisa pero legible, como una secuencia de pares clave-valor.  Adem√°s de datos como la posici√≥n inicial, casi todas las claves son opcionales, lo que permite declararlas a las entidades solo cuando es necesario. <br><br><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">bytes</span></span> npc-diner-a <span class="hljs-number"><span class="hljs-number">172</span></span> <span class="hljs-number"><span class="hljs-number">108</span></span> prop-palette <span class="hljs-number"><span class="hljs-number">1</span></span> prop-hflip prop-picture picture-smoker-c prop-animation simple-cycle-animation prop-anim-limit <span class="hljs-number"><span class="hljs-number">6</span></span> prop-head hair-flip-head-tile <span class="hljs-number"><span class="hljs-number">2</span></span> prop-dont-turn-around prop-dialog-a (<span class="hljs-number"><span class="hljs-number">2</span></span> progress-stage-4 on-my-third my-dietician) prop-dialog-a (<span class="hljs-number"><span class="hljs-number">2</span></span> progress-stage-3 have-you-tried-the-pasta the-real-deal) prop-dialog-a (<span class="hljs-number"><span class="hljs-number">2</span></span> progress-diner-is-clean omg-this-cherry-pie its-like-a-party) prop-dialog-a (<span class="hljs-number"><span class="hljs-number">2</span></span> progress-stage-1 cant-taste-food puff-poof) prop-dialog-b (<span class="hljs-number"><span class="hljs-number">1</span></span> progress-stage-4 tea-party-is-not) prop-dialog-b (<span class="hljs-number"><span class="hljs-number">1</span></span> progress-stage-3 newspaper-owned-by-dnycorp) prop-dialog-b (<span class="hljs-number"><span class="hljs-number">1</span></span> progress-stage-2 they-paid-a-pr-guy) prop-dialog-b (<span class="hljs-number"><span class="hljs-number">1</span></span> progress-stage-1 it-seems-difficult) prop-customize (<span class="hljs-name"><span class="hljs-name">progress-stage-2</span></span> stop-smoking) <span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br>  En este c√≥digo, <code>prop-palette</code> establece la paleta de colores utilizada para la entidad, <code>prop-anim-limit</code> establece el n√∫mero de cuadros de animaci√≥n y <code>prop-dont-turn-around</code> evita que el NPC gire si el jugador intenta hablar con √©l desde el otro lado.  Tambi√©n establece un par de banderas de condiciones que cambian el comportamiento de la entidad en el proceso de pasar el juego por el jugador. <br><br>  Este tipo de presentaci√≥n es muy efectiva para el almacenamiento en ROM, pero es muy lenta cuando se accede en tiempo de ejecuci√≥n y ser√° demasiado ineficiente para el juego.  Por lo tanto, cuando un jugador ingresa a una nueva escena, todas las entidades en esta escena se cargan en la RAM y procesan todas las condiciones que pueden afectar su estado inicial.  Pero no puede descargar ning√∫n detalle para cada entidad, ya que ocupar√≠a m√°s RAM de la que est√° disponible.  El motor carga solo lo m√°s necesario para cada entidad, adem√°s de un puntero a su estructura completa en ROM, que se desreferencia en situaciones como el manejo de di√°logos.  Este conjunto espec√≠fico de compromisos nos permiti√≥ proporcionar un nivel suficiente de rendimiento. <br><br><h2>  Portales </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c41/9dd/b90/c419ddb90349fbfb890c935e15bdfb95.png"></div><br>  El juego What Remains tiene muchas ubicaciones diferentes, varias escenas en la calle con mapas de desplazamiento y muchas escenas en habitaciones que permanecen est√°ticas.  Para pasar de uno a otro, debe determinar que el jugador ha llegado a la salida, cargar una nueva escena y luego colocar al jugador en el punto deseado.  En las primeras etapas de desarrollo, tales transiciones se describieron de una manera √∫nica como dos escenas conectadas, por ejemplo, "primera ciudad" y "caf√©" y datos en la declaraci√≥n if sobre la ubicaci√≥n de las puertas en cada escena.  Para determinar d√≥nde colocar al jugador despu√©s de cambiar la escena, solo ten√≠a que verificar de d√≥nde iba y d√≥nde, y colocarlo al lado de la salida correspondiente. <br><br>  Sin embargo, cuando comenzamos a llenar la escena de la "segunda ciudad", que se conecta a la primera ciudad en dos lugares diferentes, dicho sistema comenz√≥ a desmoronarse.  De repente, el par <code>(_, _)</code> ya no se ajusta.  Despu√©s de pensar en esto, nos dimos cuenta de que la conexi√≥n en s√≠ es realmente importante, lo que dentro del c√≥digo del juego llama el "portal".  Para tener en cuenta estos cambios, el motor ha sido reescrito.  lo que nos llev√≥ a una situaci√≥n similar a la entidad.  Los portales podr√≠an almacenar listas de pares clave-valor y cargarlos al comienzo de la escena.  Al ingresar al portal, puede usar la misma informaci√≥n de posici√≥n que al salir.  Adem√°s, se simplific√≥ la adici√≥n de condiciones, similar a lo que ten√≠an las entidades: en ciertos puntos del juego, pod√≠amos modificar portales, por ejemplo, abrir o cerrar puertas. <br><br><pre> <code class="lisp hljs"><span class="hljs-comment"><span class="hljs-comment">; City A (bytes city-a-scene #x50 #x68 look-up portal-customize (progress-stage-5 remove-self) ; to Diner diner-scene #xc0 #xa0 look-down portal-width #x20 0)</span></span></code> </pre> <br>  Tambi√©n simplific√≥ el proceso de agregar "puntos de teletransportaci√≥n", que a menudo se usaban en inserciones cinematogr√°ficas, donde el jugador ten√≠a que moverse a otro en la escena, dependiendo de lo que suced√≠a en la trama. <br><br>  As√≠ es como se ve la teletransportaci√≥n al comienzo del nivel 3: <br><br><pre> <code class="lisp hljs"><span class="hljs-comment"><span class="hljs-comment">; Jenny's home (bytes jenny-home-scene #x60 #xc0 look-up portal-teleport-only jenny-back-at-home-teleport 0)</span></span></code> </pre> <br>  Preste atenci√≥n al valor de <code>look-up</code> , que indica la direcci√≥n para la "entrada" a este portal.  Al salir del portal, el jugador mirar√° en la otra direcci√≥n;  en este caso, Jenny (el personaje principal del juego) est√° en casa, mientras mira hacia abajo. <br><br><h2>  Bloque de texto </h2><br>  La representaci√≥n de un bloque de texto result√≥ ser una de las piezas de c√≥digo m√°s complejas de todo el proyecto.  Las limitaciones gr√°ficas de NES obligaron a enga√±ar.  Para empezar, NES solo tiene una capa para datos gr√°ficos, es decir, para liberar espacio para un bloque de texto, debe borrar parte del mapa en el fondo y luego restaurarlo despu√©s de cerrar el bloque de texto. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6b8/7a5/d6f/6b87a5d6f4f44f8eb4fa9cf3b3242392.png"></div><br>  Adem√°s, la paleta para cada escena individual debe contener colores blanco y negro para representar el texto, lo que impone restricciones adicionales al artista.  Para evitar conflictos de color con el resto del fondo, el bloque de texto debe alinearse con la cuadr√≠cula 16 √ó 16 [5].  Dibujar un bloque de texto en una escena con una habitaci√≥n es mucho m√°s simple que en una calle, donde la c√°mara se puede mover, porque en este caso es necesario considerar los buffers gr√°ficos desplaz√°ndose vertical y horizontalmente.  Finalmente, el mensaje de la pantalla de pausa es un cuadro de di√°logo est√°ndar ligeramente modificado, porque muestra informaci√≥n diferente, pero usa casi el mismo c√≥digo. <br><br>  Despu√©s de un n√∫mero infinito de versiones defectuosas del c√≥digo, finalmente logr√© encontrar una soluci√≥n en la que el trabajo se divide en dos etapas.  Primero, se realizan todos los c√°lculos que determinan d√≥nde y c√≥mo dibujar el bloque de texto, incluido el c√≥digo de procesamiento para todos los casos de borde.  Por lo tanto, todas estas dificultades se llevan a un solo lugar. <br><br>  Luego, un bloque de texto con preservaci√≥n de estado se dibuja l√≠nea por l√≠nea y los c√°lculos de la primera etapa se usan para no complicar el c√≥digo. <br><br><pre> <code class="lisp hljs"><span class="hljs-comment"><span class="hljs-comment">; Called once per frame as the text box is being rendered (defsub (text-box-update) (when (or (eq? tb-text-mode 0) (eq? tb-text-mode #xff)) (return #f)) (cond [(in-range tb-text-mode 1 4) (if (not is-paused) ; Draw text box for dialog. (text-box-draw-opening (- tb-text-mode 1)) ; Draw text box for pause. (text-box-draw-pausing (- tb-text-mode 1))) (inc tb-text-mode)] [(eq? tb-text-mode 4) ; Remove sprites in the way. (remove-sprites-in-the-way) (inc tb-text-mode)] [(eq? tb-text-mode 5) (if (not is-paused) ; Display dialog text. (when (not (crawl-text-update)) (inc tb-text-mode) (inc tb-text-mode)) ; Display paused text. (do (create-pause-message) (inc tb-text-mode)))] [(eq? tb-text-mode 6) ; This state is only used when paused. Nothing happens, and the caller ; has to invoke `text-box-try-exiting-pause` to continue. #t] [(and (&gt;= tb-text-mode 7) (&lt; tb-text-mode 10)) ; Erase text box. (if (is-scene-outside scene-id) (text-box-draw-closing (- tb-text-mode 7)) (text-box-draw-restoring (- tb-text-mode 7))) (inc tb-text-mode)] [(eq? tb-text-mode 10) ; Reset state to return to game. (set! text-displaying #f) (set! tb-text-mode 0)]) (return #t))</span></span></code> </pre> <br>  Si te acostumbras al estilo Lisp, entonces el c√≥digo se lee con bastante comodidad. <br><br><h2>  Sprite Z-capas </h2><br>  Al final, hablar√© sobre un peque√±o detalle que no afecta particularmente el juego, pero agrega un toque agradable del que estoy orgulloso.  NES tiene solo dos componentes gr√°ficos: una tabla de nombres, que se utiliza para fondos est√°ticos y alineados a la cuadr√≠cula, y los sprites son objetos de 8x8 p√≠xeles que se pueden colocar en lugares arbitrarios.  Los elementos como el personaje del jugador y los NPC generalmente se crean como sprites si deber√≠an estar encima de los gr√°ficos de la tabla de nombres. <br><br>  Sin embargo, el equipo NES tambi√©n proporciona la capacidad de especificar una porci√≥n de sprites que se pueden colocar completamente debajo de la tabla de nombres.  Esto sin esfuerzo le permite realizar un efecto 3D genial. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1c6/4e0/c48/1c64e0c481f82d2b6569aa6326ea00a1.png"></div><br>  Funciona de la siguiente manera: la paleta utilizada para la escena actual maneja el color en la posici√≥n 0 de una manera especial: es el color de fondo global.  Se dibuja una tabla de nombres encima, y ‚Äã‚Äãlos sprites con una capa z se dibujan entre otras dos capas. <br><br>  Aqu√≠ est√° la paleta de esta escena: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/23c/2c6/391/23c2c6391ae6301f9b527259250ee0e5.png"></div><br>  Entonces, el color gris oscuro en la esquina izquierda se usa como color de fondo global. <br><br>  El efecto de las capas funciona de la siguiente manera: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d30/0ae/f89/d300aef890a928421a48d94968a263f9.png"></div><br>  En la mayor√≠a de los otros juegos, todo esto termina, sin embargo, What Remains ha dado un paso m√°s.  El juego no coloca a Jenny completamente delante o debajo de los gr√°ficos de la tabla de nombres: su personaje se divide entre ellos seg√∫n sea necesario.  Como puede ver, los sprites tienen un tama√±o de 8x8 unidades, y los gr√°ficos de todo el personaje consisten en varios sprites (de 3 a 6, dependiendo del cuadro de animaci√≥n).  Cada sprite puede establecer su propia capa z, es decir, algunos sprites estar√°n delante de la tabla de nombres y otros detr√°s de ella. <br><br>  Aqu√≠ hay un ejemplo de este efecto en acci√≥n: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/86b/3a3/ae5/86b3a3ae58931ef34d44640d7ff4c449.png"></div><br>  El algoritmo para implementar este efecto es bastante complicado.  Primero, se examinan los datos de colisi√≥n que rodean al jugador, en particular fichas, que pueden tomar un personaje completo para dibujar.  En este diagrama, los mosaicos s√≥lidos se muestran en cuadrados rojos, y los mosaicos amarillos indican la parte con la capa z. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/10d/162/38c/10d16238cc137b14b8719479624f7245.png"></div><br>  Utilizando varias heur√≠sticas, se combinan para crear un "punto de referencia" y una m√°scara de bits de cuatro bits.  Cuatro cuadrantes relativos al punto de referencia corresponden a cuatro bits: 0 significa que el jugador debe estar delante de la tabla de nombres, 1, que est√° detr√°s de √©l. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ccb/3a4/ff9/ccb3a4ff911243e0e771c3bd64e10134.png"></div><br>  Al colocar sprites individuales para renderizar al jugador, su posici√≥n se compara con el punto de referencia para determinar la capa z de este sprite en particular.  Algunos de ellos est√°n en la capa frontal, otros en la parte posterior. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0ee/f36/273/0eef362737679bb6483465264ada9ba4.png"></div><br><h2>  Conclusi√≥n </h2><br>  Brevemente habl√© sobre los diferentes aspectos del funcionamiento interno de nuestro nuevo juego retro moderno.  Hay mucho m√°s interesante en la base del c√≥digo, pero he esbozado una parte importante de lo que hace que el juego funcione. <br><br>  La lecci√≥n m√°s importante que aprend√≠ de este proyecto son los beneficios que se pueden obtener de los motores basados ‚Äã‚Äãen datos.  Varias veces logr√© reemplazar una l√≥gica √∫nica con una tabla y un mini-int√©rprete, y gracias a esto, el c√≥digo se volvi√≥ m√°s simple y m√°s legible. <br><br>  ¬°Espero que hayas disfrutado el art√≠culo! <br><br><hr><br><h3>  Notas </h3><br>  [1] Estrictamente hablando, se instal√≥ una especie de CPU 6502 llamada Ricoh 2A03 en NES. <br><br>  [2] De hecho, este proyecto me convenci√≥ de que cambiar de banco / administrar ROM es la principal limitaci√≥n para cualquier proyecto de NES que exceda cierto tama√±o. <br><br>  [3] Por esto, uno deber√≠a agradecer a la "pila compilada", un concepto utilizado en la programaci√≥n de sistemas embebidos, aunque apenas logr√© encontrar literatura al respecto.  En resumen, debe crear un gr√°fico completo de las llamadas al proyecto, clasificarlo desde los nodos hoja hasta la ra√≠z y luego asignar a cada nodo una memoria igual a sus necesidades + n√∫mero m√°ximo de nodos secundarios. <br><br>  [4] Las macros se agregaron en etapas de desarrollo bastante tard√≠as y, francamente, no pudimos aprovecharlas especialmente. <br><br>  [5] Puedes leer m√°s sobre gr√°ficos NES en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">mi serie de art√≠culos</a> .  Los conflictos de color son causados ‚Äã‚Äãpor los atributos descritos en la primera parte. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/467125/">https://habr.com/ru/post/467125/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../467111/index.html">Consejos radicales sobre c√≥mo colgar menos en su tel√©fono</a></li>
<li><a href="../467113/index.html">¬øC√≥mo mantener al usuario en el sitio? Secretos de usabilidad</a></li>
<li><a href="../467115/index.html">"Ls" at√≠pico - Edici√≥n Habr</a></li>
<li><a href="../467117/index.html">Los manuscritos no se queman: el secreto de la longevidad de los rollos del Mar Muerto que datan de 250 aC</a></li>
<li><a href="../467119/index.html">Juega IT-Alias ‚Äã‚Äãcon los ingenieros de Badoo</a></li>
<li><a href="../467127/index.html">Prueba de API utilizando Postman y Excel</a></li>
<li><a href="../467129/index.html">Enderezado cognitivo 2: ilusiones y distorsiones de aprendizaje</a></li>
<li><a href="../467131/index.html">CLRium # 6: Informe par sobre Lock-Free, mucha teor√≠a y conocimiento pr√°ctico</a></li>
<li><a href="../467135/index.html">Pedal USB para cambiar de computadora</a></li>
<li><a href="../467137/index.html">Garantizar el funcionamiento confiable del equipo Zextras en redes corporativas complejas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>