<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚öîÔ∏è ü§ô üìú ¬øC√≥mo se ve el archivo zip y qu√© podemos hacer al respecto? üí™üèº üññ üèì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Buen d√≠a, querido Habr! 

 Durante el √∫ltimo medio a√±o, el camino torcido de mis proyectos favoritos me ha llevado a esa jungla, donde todav√≠a parece ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>¬øC√≥mo se ve el archivo zip y qu√© podemos hacer al respecto?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/471066/"> Buen d√≠a, querido Habr! <br><br>  Durante el √∫ltimo medio a√±o, el camino torcido de mis proyectos favoritos me ha llevado a esa jungla, donde todav√≠a parece imposible salir.  Y todo comenz√≥ de manera inofensiva: un sitio con im√°genes, pero una sensaci√≥n de perfeccionismo, la b√∫squeda de un obsequio, as√≠ como algunas caracter√≠sticas de mi mentalidad convirtieron esto, como se hab√≠a planeado originalmente, en una peque√±a caminata en un viaje realmente largo.  Bueno, est√° bien, como sol√≠a decir un revolucionario bastante burry: "Aprende, estudia y estudia de nuevo", pero yo, de todos modos, tengo que seguir esta advertencia. <br><br>  Oh, algo que nos distrajo del tema principal.  Ya no te aburrir√© con largos discursos, pero me dedicar√© a los negocios. <br><a name="habracut"></a><br><h3>  Crea un archivo zip </h3><br>  En principio, no volver√© a escribir la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">especificaci√≥n</a> aqu√≠.  En general, tampoco tiene sentido describir la estructura, porque todo esto se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">hizo antes que yo</a> . <br><br>  Para aquellos que son demasiado flojos para seguir los enlaces, resumir√© brevemente que cualquier archivo zip debe contener: <br><br><ul><li>  Entrada de archivo: <ul><li>  Encabezado de archivo local </li><li>  Datos √∫tiles </li><li>  Descriptor de datos (opcional, utilizado cuando no conocemos el tama√±o del archivo y su hash hasta que lo leamos hasta el final) </li></ul></li><li>  Encabezado del archivo del directorio central (para cada archivo. Esto es como una tabla de contenido del libro, donde se indica cada secci√≥n y la p√°gina en la que se puede encontrar) </li><li>  Fin del directorio central </li></ul><br>  Sabiendo esto, podemos intentar escribir un archivo simple que contendr√° solo dos archivos: <br><br><pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">//        (1.txt  2.txt)   : $entries = [ '1.txt' =&gt; 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc id ante ultrices, fermentum nibh eleifend, ullamcorper nunc. Sed dignissim ut odio et imperdiet. Nunc id felis et ligula viverra blandit a sit amet magna. Vestibulum facilisis venenatis enim sed bibendum. Duis maximus felis in suscipit bibendum. Mauris suscipit turpis eleifend nibh commodo imperdiet. Donec tincidunt porta interdum. Aenean interdum condimentum ligula, vitae ornare lorem auctor in. Suspendisse metus ipsum, porttitor et sapien id, fringilla aliquam nibh. Curabitur sem lacus, ultrices quis felis sed, blandit commodo metus. Duis tincidunt vel mauris at accumsan. Integer et ipsum fermentum leo viverra blandit.', '2.txt' =&gt; 'Mauris in purus sit amet ante tempor finibus nec sed justo. Integer ac nibh tempus, mollis sem vel, consequat diam. Pellentesque ut condimentum ex. Praesent finibus volutpat gravida. Vivamus eleifend neque sit amet diam scelerisque lacinia. Nunc imperdiet augue in suscipit lacinia. Curabitur orci diam, iaculis non ligula vitae, porta pellentesque est. Duis dolor erat, placerat a lacus eu, scelerisque egestas massa. Aliquam molestie pulvinar faucibus. Quisque consequat, dolor mattis lacinia pretium, eros eros tempor neque, volutpat consectetur elit elit non diam. In faucibus nulla justo, non dignissim erat maximus consectetur. Sed porttitor turpis nisl, elementum aliquam dui tincidunt nec. Nunc eu enim at nibh molestie porta ut ac erat. Sed tortor sem, mollis eget sodales vel, faucibus in dolor.', ]; //      Lorem.zip,      cwd (      ) $destination = 'Lorem.zip'; $handle = fopen($destination, 'w'); //      ,    ,     ,   "" Central Directory File Header $written = 0; $dictionary = []; foreach ($entries as $filename =&gt; $content) { //         Local File Header,     //        ,      . $fileInfo = [ //     'versionToExtract' =&gt; 10, //   0,        - 'generalPurposeBitFlag' =&gt; 0, //      ,    0 'compressionMethod' =&gt; 0, // -    mtime ,    ,      ? 'modificationTime' =&gt; 28021, //   , ? 'modificationDate' =&gt; 20072, //      .     ,       ,   ? 'crc32' =&gt; hexdec(hash('crc32b', $content)), //     .        . //       :) 'compressedSize' =&gt; $size = strlen($content), 'uncompressedSize' =&gt; $size, //    'filenameLength' =&gt; strlen($filename), //  .    ,   0. 'extraFieldLength' =&gt; 0, ]; //      . $LFH = pack('LSSSSSLLLSSa*', ...array_values([ 'signature' =&gt; 0x04034b50, //  Local File Header ] + $fileInfo + ['filename' =&gt; $filename])); //       ,       Central Directory File Header $dictionary[$filename] = [ 'signature' =&gt; 0x02014b50, //  Central Directory File Header 'versionMadeBy' =&gt; 798, //  .    ,  -  . ] + $fileInfo + [ 'fileCommentLength' =&gt; 0, //    . No comments 'diskNumber' =&gt; 0, //     0,        'internalFileAttributes' =&gt; 0, //    'externalFileAttributes' =&gt; 2176057344, //    'localFileHeaderOffset' =&gt; $written, //      Local File Header 'filename' =&gt; $filename, //  . ]; //      $written += fwrite($handle, $LFH); //    $written += fwrite($handle, $content); } // ,     ,    . //          End of central directory record (EOCD) $EOCD = [ //  EOCD 'signature' =&gt; 0x06054b50, //  .    ,   0 'diskNumber' =&gt; 0, //      -  0 'startDiskNumber' =&gt; 0, //       . 'numberCentralDirectoryRecord' =&gt; $records = count($dictionary), //    .    ,     'totalCentralDirectoryRecord' =&gt; $records, //   Central Directory Record. //      ,      'sizeOfCentralDirectory' =&gt; 0, // ,    Central Directory Records 'centralDirectoryOffset' =&gt; $written, //     'commentLength' =&gt; 0 ]; //     !   foreach ($dictionary as $entryInfo) { $CDFH = pack('LSSSSSSLLLSSSSSLLa*', ...array_values($entryInfo)); $written += fwrite($handle, $CDFH); } // ,   .  ,    $EOCD['sizeOfCentralDirectory'] = $written - $EOCD['centralDirectoryOffset']; //     End of central directory record $EOCD = pack('LSSSSLLS', ...array_values($EOCD)); $written += fwrite($handle, $EOCD); //  . fclose($handle); echo '  : ' . $written . ' ' . PHP_EOL; echo '     `unzip -tq ' . $destination . '`' . PHP_EOL; echo PHP_EOL;</span></span></code> </pre> <br>  Intente ejecutar este c√≥digo primitivo y la salida le dar√° un archivo Lorem.zip que contendr√° 1.txt y 2.txt. <br><br><h3>  Por qu√© </h3><br>  Por supuesto, cualquier persona adecuada dir√° que escribir archiveros en php es una tarea in√∫til, especialmente porque para un formato como zip, hay un mont√≥n de implementaciones listas para todos los gustos y colores.  Y en el mismo php hay bibliotecas listas para usar.  Yo tambi√©n lo dir√© :) <br><br>  Pero, ¬øpor qu√©, entonces, es todo este art√≠culo, por qu√© me dediqu√© a escribirlo y a leerlo? <br>  Y luego, que no todo es tan simple y saber c√≥mo funciona zip, nos abre algunas posibilidades adicionales. <br><br>  En primer lugar, espero, al menos un poco, pero ayudar√° a aquellos que quieran comprender la estructura del zip. <br>  Y en segundo lugar, al crear el archivo con nuestras propias manos, tenemos control y, lo m√°s importante, acceso a sus datos internos. <br><br>  Podemos precalcular el Encabezado de archivo local y el Encabezado de archivo del directorio central y, a pedido, generar un archivo zip sobre la marcha con cualquier contenido y orden de archivos, simplemente sustituyendo estos datos.  Y sin gastos generales, excepto para E / S. <br><br>  O bien, podemos grabar el archivo, subirlo, por ejemplo, a la nube, que admite la descarga fragmentada y, conociendo las compensaciones para cada archivo, obtener cualquiera de los archivos de archivo, como si no estuviera en el archivo, agregando solo uno T√≠tulo de la solicitud.  Y luego todo esto puede ser proxy y ... <br><br>  De acuerdo, no nos adelantemos.  Si est√° interesado en este tema, en los siguientes art√≠culos intentar√© considerar estas oportunidades y mostrar c√≥mo usarlas. <br><br><hr><blockquote>  'diskNumber' =&gt; 0, // Por lo general me encontr√© con 0 en todas partes, y en particular decid√≠ no profundizar en </blockquote>  Como sugiri√≥ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">berez</a> , el n√∫mero de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">volumen</a> en el archivo de varios vol√∫menes. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/471066/">https://habr.com/ru/post/471066/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../471048/index.html">Reaccionar + Mobx: ¬øcu√°l es el punto?</a></li>
<li><a href="../471050/index.html">D Financiaci√≥n del Fondo para el desarrollo del lenguaje: nuevas plataformas y nuevas subvenciones ...</a></li>
<li><a href="../471052/index.html">¬øPuedo hacer? Golpeado por la programaci√≥n de tipo gen√©rico</a></li>
<li><a href="../471054/index.html">Longrid sobre el realismo de la amenaza cu√°ntica para las criptomonedas y los problemas de la "profec√≠a 2027"</a></li>
<li><a href="../471062/index.html">C√≥mo ense√±arle a Alice a administrar su hogar inteligente. Informe Yandex</a></li>
<li><a href="../471070/index.html">Qu√© idioma de servidor elegir ... para un desarrollador m√≥vil</a></li>
<li><a href="../471072/index.html">¬øCu√°ntos gramos en Telegram?</a></li>
<li><a href="../471074/index.html">Synet: un marco para lanzar redes neuronales pre-entrenadas en la CPU</a></li>
<li><a href="../471076/index.html">C√≥mo Matrix cre√≥ un legado a prueba de balas</a></li>
<li><a href="../471078/index.html">Chrome bloquear√° completamente el contenido mixto</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>