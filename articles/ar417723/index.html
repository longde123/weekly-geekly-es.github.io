<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ถ ๐ท ๐ฉ๐ปโ๐ฌ ุงูุนูู ูุน KOMPAS-3D API โ ุงูุฏุฑุณ 11 โ ุชุณููุงุช ูุตูุฉ ุจุณูุทุฉ ๐ก ๐๐ฝ ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูู ุงูุฏุฑูุณ ุงูุณุงุจูุฉ ูู ุงูุฏูุฑุฉ ุ ุชุนูููุง ุนุฑุถ ุงููุต ูู ูุชูุฉ ุงูุนููุงู. ุณูุชุญุฏุซ ุงูููู ุนู ููููุฉ ุฅุฎุฑุงุฌ ุงููุต ุฅูู ุงููุณุชูุฏ ููุณู. ุณููุธุฑ ูู ุฃุจุณุท ุงูุฃูุซูุฉ ุ ููุนุฑุถ ุญูููุง ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุงูุนูู ูุน KOMPAS-3D API โ ุงูุฏุฑุณ 11 โ ุชุณููุงุช ูุตูุฉ ุจุณูุทุฉ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ascon/blog/417723/" style=";text-align:right;direction:rtl">  ูู ุงูุฏุฑูุณ ุงูุณุงุจูุฉ ูู ุงูุฏูุฑุฉ ุ ุชุนูููุง ุนุฑุถ ุงููุต ูู ูุชูุฉ ุงูุนููุงู.  ุณูุชุญุฏุซ ุงูููู ุนู ููููุฉ ุฅุฎุฑุงุฌ ุงููุต ุฅูู ุงููุณุชูุฏ ููุณู.  ุณููุธุฑ ูู ุฃุจุณุท ุงูุฃูุซูุฉ ุ ููุนุฑุถ ุญูููุง ุฃูุซุฑ ุชุนููุฏูุง ูู ุงูุฏุฑูุณ ุงูุชุงููุฉ. <br><br><img src="https://habrastorage.org/webt/wz/do/cm/wzdocmvrzusasojdie12itkajtq.png"><br><br><a name="habracut"></a><br><blockquote style=";text-align:right;direction:rtl"><h4 style=";text-align:right;direction:rtl">  ูุญุชูู ุณูุณูุฉ ุงูุฏุฑุณ "ุงูุนูู ูุน COMPASS-3D API" </h4><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฃุณุงุณูุงุช</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุตููู ุฑุณู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงุชุตุงู ุตุญูุญ ุจู KOMPAS</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุด ุงูุฑุฆูุณู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุจุฏุงุฆููู ุงูุฑุณู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุญูุธ ูุณุชูุฏ ุจุชูุณููุงุช ูุฎุชููุฉ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุชุนุฑู ุนูู ุงูุฅุนุฏุงุฏุงุช</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุทุฑู ูุชุงุจุฉ ุฃูุซุฑ ุชุนููุฏูุง ูู ูุชูุฉ ุงูุนููุงู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฑุงุกุฉ ุฎูุงูุง ุงูุชุฑุฌูุฉ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃุญุฑู ุฎุงุตุฉ ุจูุง ูู ุฐูู ุณูุณูุฉ</a> </li><li style=";text-align:right;direction:rtl">  <b>ุชุณููุงุช ูุตูุฉ ุจุณูุทุฉ</b> </li></ol></blockquote><br><h2 style=";text-align:right;direction:rtl">  <font color="#00B2FF">ููุทุฉ ุฑุจุท ุงููุต</font> </h2><br>  ูุชู ุฏุงุฆููุง ุนุฑุถ ุงููุต ูู KOMPAS ุจุงููุณุจุฉ ุฅูู ููุทุฉ ูุง ุ ูุงูุชู ุชุณูู ููุทุฉ ุงูุฑุจุท.  ูููู ูุถุน ุงููุต ุจุดูู ูุฎุชูู ุจุงููุณุจุฉ ูู.  ููุนุฑูุฉ ูููุน ุงููุต ุจุงููุณุจุฉ ุฅูู ููุทุฉ ุงูุฑุจุท ุ ูุชู <b>ุงุณุชุฎุฏุงู</b> ุทุฑููุฉ <b>ksGetTextAlign</b> ูููุงุฌูุฉ <b>ksDocument2D</b> .  ูุง ููู ูู ูููุฐุฌูุง ุงูุฃููู. <br><br><pre style=";text-align:right;direction:rtl"><code class="hljs objectivec"><span class="hljs-keyword"><span class="hljs-keyword">long</span></span> ksGetTextAlign ( <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> pText <span class="hljs-comment"><span class="hljs-comment">//   );</span></span></code> </pre> <br>  ููุนููุฉ ููุท ุ ูุฅูู ูุฃุฎุฐ ูุคุดุฑ ุนุฏุฏ ุตุญูุญ ุฅูู ูุงุฆู <i>ูุต</i> .  ุชูุฑุฌุน ุงูุทุฑููุฉ <i>ููุน ุงูุฑุจุท</i> ุ ุฃู <i>-1</i> ูู ุญุงูุฉ ุญุฏูุซ ุฎุทุฃ.  ุฃููุงุน ุงูุฑุจุท ุงูุตุงูุญุฉ ููุถุญุฉ ูู ุงูุฌุฏูู ุฃุฏูุงู. <br><br><img src="https://habrastorage.org/webt/x1/ar/kt/x1arktnxaiyg0pu4wxidqdqbzke.png"><br>  <i>ุฌุฏูู ุฃููุงุน ุงูุฑุจุท ุงูุตุงูุญุฉ</i> <br><br>  ูุชุบููุฑ ุฑุจุท ุงููุต ุ ุงุณุชุฎุฏู ุทุฑููุฉ <b>ksSetTextAlign</b> ูููุงุฌูุฉ <b>ksDocument2D</b> .  ูุง ููู ูู ูููุฐุฌูุง ุงูุฃููู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ksSetTextAlign</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> pText, //   ยซยป </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> align //  </span></span></span><span class="hljs-function">)</span></span>;</code> </pre><br>  ูู ุญุงูุฉ ูุฌุงุญูุง ุ ุชุฑุฌุน ูุฐู ุงูุทุฑููุฉ <i>1</i> ุ ููู ุญุงูุฉ ุญุฏูุซ ุฎุทุฃ ุ ูุชู ุฅุฑุฌุงุน <i>ุตูุฑ</i> . <br><br><h2 style=";text-align:right;direction:rtl">  <font color="#00B2FF">ุฅุฎุฑุงุฌ ุงููุต</font> </h2><br>  ูุฅุฎุฑุงุฌ ูุต ุจุณูุท ุ ุงุณุชุฎุฏู ุทุฑููุฉ <b>ksText</b> ูููุงุฌูุฉ <b>ksDocument2D</b> .  ูููุง ููู ูููุฐุฌ ุฃููู ููุฐู ุงูุทุฑููุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ksText</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, //   </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ang, //   </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> hStr, //    </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ksuStr, //  </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> bitVector, //  BSTR s //  </span></span></span><span class="hljs-function">)</span></span>;</code> </pre><br>  ุฏุนููุง <b>ูุญูู</b> ูุนููุงุช ุทุฑููุฉ <b>ksText</b> .  ูุงูุดูุง ููุทุฉ ุงูุฑุจุท ูู ุงููุณู ุงูุณุงุจู. <br><br>  ุชููู ุงููุนููุฉ <b>ang</b> ุจุชุนููู ุงูุฒุงููุฉ ุจุงูุฏุฑุฌุงุช ุจูู ุณุทุฑ ูู ุงููุต ูุฎุท ุฃููู.  ุชูุญุณุจ ุงูุฒุงููุฉ ุนูุณ ุงุชุฌุงู ุนูุงุฑุจ ุงูุณุงุนุฉ.  ุชูุถุญ ุงูุตูุฑุฉ ุฃุฏูุงู ุฎุทูุง ูุฑุณูููุง ุจุฒุงููุฉ <i>45 ุฏุฑุฌุฉ</i> . <br><br><img src="https://habrastorage.org/webt/f4/4s/qd/f44sqdinktxtkua8fe9qd_jvdf4.png"><br>  <i>ุณูุณูุฉ 45 ุฏุฑุฌุฉ</i> <br><br>  <b>ุชุนููู</b> ุงููุนููุฉ <b>hStr</b> ุญุฌู ุฃุญุฑู ุงูุณูุณูุฉ ุจุงููููููุชุฑ.  ุฅุฐุง ูุงูุช ูููุฉ ูุฐู ุงููุนููุฉ <i>ุตูุฑูุง</i> ุ ูุณูุชู ุงุณุชุฎุฏุงู ุงูุญุฌู ุงูุงูุชุฑุงุถู. <br><br>  ุชุญุฏุฏ ุงููุนููุฉ <b>ksuStr</b> ุชูุฏุฏ (ุชุถููู) ุงููุต.  ููุถุญ ุงูุดูู ุฃุฏูุงู ุนุฏุฉ ุฃุณุทุฑ ุจููู ูุฎุชููุฉ ููุนููุฉ <b>ksuStr</b> . <br><br><img src="https://habrastorage.org/webt/eg/ph/bg/egphbgtc5ecognfjioff2r3c3dm.png"><br>  <i>ุฎุทูุท ูุชุนุฏุฏุฉ ุจููู ุงูุชุฏุงุฏ ูุฎุชููุฉ</i> <br><br>  ูู ูุฐุง ุงูุดูู ูููู ููุงุญุธุฉ ุฃู "ุงูุชูุฏุฏ 0" ูุนุงุฏู "ุงูุชูุฏุฏ 1" ุ ุฃู ุบูุงุจ ุฃู ุชูุฏุฏ. <br><br>  ุชุญุชูู ุงููุนููุฉ <b>bitVector</b> ุนูู ูุฌููุนุฉ ูู ุงูุนูุงูุงุช ุงูุชู ุชุญุฏุฏ ููุท ุงูุญุฑู.  ุงูุฃุนูุงู ุงูุตุงูุญุฉ ูุฏุฑุฌุฉ ูู ุงูุฌุฏูู ุฃุฏูุงู. <br><br><img src="https://habrastorage.org/webt/yi/is/hb/yiishb0rg_-xvibw5cmm90uno3m.png"><br>  <i>ุฌุฏูู ุฃุนูุงู ุงูุฃุญุฑู</i> <br><br>  ูู ุงููุงูุน ุ ููุงู ุฃุนูุงู ุตุงูุญุฉ ุฃุฎุฑู ุ ูููู ุนูููุง ูุธูุฑ ููุท ูู ุจูุงุก ุณูุงุณู ูุฑูุจุฉ ูุนูุฏุฉ.  ุณููุธุฑ ูู ุจุนุถูุง ูู ุงูุฏุฑุณ ุงูุชุงูู. <br>  ุชุฐูุฑ - ูุฌุจ ุฃูุง ุชุญุชูู ุณูุณูุฉ ุงูุฅุฎุฑุงุฌ ุนูู ุงูุฃุญุฑู <i>@</i> ู <i>$</i> <i>ู &amp; ู</i> <i>~</i> ู <i>^</i> ู <i>#</i> ุ ูุฃููุง ุฃุญุฑู ุชุญูู.  ุณูุชุญุฏุซ ุนู ุงูุนูู ูุนูู ูู ุงูุฏุฑูุณ ุงููุงุฏูุฉ ูู ุฏูุฑุชูุง. <br>  ูู ุญุงูุฉ ูุฌุงุญ ุฐูู ุ ุชุฑุฌุน ุทุฑููุฉ <b>ksText</b> ูุคุดุฑ ุนุฏุฏ ุตุญูุญ ุฅูู ุงููุต.  ูููู ุชูุฑูุฑ ูุฐุง ุงููุคุดุฑ ุ ุนูู ุณุจูู ุงููุซุงู ุ ุฅูู ุฃุณููุจ <b>ksSetTextAlign</b> ูุชุบููุฑ ููุถุน ุงููุต ุจุงููุณุจุฉ ุฅูู ููุทุฉ ุงูุงุฑุชุณุงุก.  ูู ุญุงูุฉ ุญุฏูุซ ุฎุทุฃ ุ ุชุฑุฌุน ุทุฑููุฉ <b>ksText</b> <i>ุตูุฑ</i> . <br><br><h2 style=";text-align:right;direction:rtl">  <font color="#00B2FF">ูุซุงู</font> </h2><br>  ูุง ููู ูู ุจุฑูุงูุฌ ูุซุงู ููุถุญ ุฅุฎุฑุงุฌ ุงูุณูุณูุฉ ุจุงุณุชุฎุฏุงู ุฃุณููุจ <b>ksText</b> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs ruby">/<span class="hljs-regexp"><span class="hljs-regexp">/  BSTR str = SysAllocString(L""); long itext; itext = Document2D-&gt;ksText(100, 100, /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  0, /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  11, /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  0, /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ 0, /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  str); SysFreeString(str); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/    Document2D-&gt;ksSetTextAlign(itext, txta_Left); Document2D.Unbind(); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   kompas-&gt;Visible = true; kompas.Unbind();</span></span></code> </pre><br>  ูู ุฃุฌู ุงูุจุณุงุทุฉ ุ ูุชู ุญุฐู ุงูุฑูุฒ ุงููุณุคูู ุนู ุฅูุดุงุก ุงููุณุชูุฏ ูุชูููุฐู ูู ูุฐุง ุงููุซุงู.  ูุชูุฌุฉ ููุฐุง ุงูุจุฑูุงูุฌ ุ ูุชู ุนุฑุถ ุงููุต <i>"ุณูุณูุฉ"</i> ูู ุงููุณุชูุฏ. <br><br><h2 style=";text-align:right;direction:rtl">  <font color="#00B2FF">ุญุฌู ุงููุต</font> </h2><br>  ุนูุฏ ุนุฑุถ ุงููุต ูู ูุณุชูุฏ ุ ูู ุงููููุฏ ูุนุฑูุฉ ููุฏุงุฑ ุงููุณุงุญุฉ ุงูุชู ูุดุบููุง.  ูุชู ุชุนููู ุงุฑุชูุงุน ุงููุต ุจูุงุณุทุฉ ูุนููุฉ <b>hStr</b> ูุฃุณููุจ <b>ksText</b> .  ููู ุทููู ูุนุชูุฏ ุจุดูู ูุจุงุดุฑ ุนูู ุณูุณูุฉ ุงูุฅุฎุฑุงุฌ. <br><br>  ูุชุญุฏูุฏ ุฐูู ุ ุงุณุชุฎุฏู ุทุฑููุฉ <b>ksGetTextLengthFromReference</b> ูููุงุฌูุฉ <b>ksDocument2D</b> .  ุชุญุชูู ูุฐู ุงูุทุฑููุฉ ุนูู ูุนููุฉ ูุงุญุฏุฉ ููุท - ูุคุดุฑ ุนุฏุฏ ุตุญูุญ ูููุต.  ุชููู ุจุฅุฑุฌุงุน ุทูู ุงููุต ุจุงููููููุชุฑ. <br><br>  ุฅู ุทุฑููุฉ <b>ksGetTextLengthFromReference ุบูุฑ</b> ููุงุฆูุฉ ูุฃููุง ูุง ุชุณูุญ ูู ุจุชุญุฏูุฏ ุทูู ุงูุณุทุฑ ูุจู ุฅุฎุฑุงุฌู ุฅูู ุงููุณุชูุฏ.  ูุชุญุฏูุฏ ุทูู ุณูุณูุฉ ูู ูุชู ุฅุฎุฑุงุฌูุง ุจุนุฏ ุฅูู ุงููุณุชูุฏ ุ ุชุญุชุงุฌ ุฅูู ุงุณุชุฎุฏุงู ุฃุณููุจ <b>ksGetTextLength</b> .  ูููู ูุจู ุงูุชูููุฑ ูู ุงูุฃูุฑ ุ ููุชุญุฏุซ ุนู ุงูุฃููุงุท. <br><br><h2 style=";text-align:right;direction:rtl">  <font color="#00B2FF">ุฃููุงุท ุงููุต</font> </h2><br>  ูุญุฏุฏ ูุธุงู KOMPAS ุงูุนุฏูุฏ ูู ุงูุฃููุงุท ูููุตูุต ุงููุนุฑูุถุฉ ูู ุงููุณุชูุฏุงุช.  ูู ููุท ูู ุนุฏุฏ ุตุญูุญ.  ุงูุฃููุงุท ุงูุฃูุซุฑ ุงุณุชุฎุฏุงููุง ููุฌูุฏุฉ ูู ุงูุฌุฏูู ุฃุฏูุงู. <br><br><img src="https://habrastorage.org/webt/4p/sf/ny/4psfnyywguukemqayhjyzsu0tqi.png"><br>  <i>ุฃููุงุท ุงููุต ุดุงุฆุนุฉ ุงูุงุณุชุฎุฏุงู</i> <br><br>  ูุง ูุชู ุฅุนุทุงุก ุฌููุน ุงูุฃููุงุท ูู ูุฐุง ุงูุฌุฏูู: ุฌุฒุก ูููุง ููุท.  ูููู ุงูุนุซูุฑ ุนูู ูุงุฆูุฉ ูุงููุฉ ุจุงูุซูุงุจุช ุงููุชููุฑุฉ ูู ุตูุญุฉ <i>"ููุงูู ุงููุนููุงุช ู Constants \ Constants \ Text Constants \ System Text Styles" ูู</i> ูุซุงุฆู KOMPAS. <br><br><h2 style=";text-align:right;direction:rtl">  <font color="#00B2FF">ุทุฑููุฉ <b>KsGetTextLength</b></font> </h2><br>  ุชุณูุญ <b>ูู</b> ุทุฑููุฉ <b>ksGetTextLength</b> ูููุงุฌูุฉ <b>ksDocument2D</b> ุจุชุญุฏูุฏ ุทูู ุงูุณูุณูุฉ ูุจู ุฅุฎุฑุงุฌูุง ุฅูู ุงููุณุชูุฏ.  ููุฌุฏ ุฃุฏูุงู ูููุฐุฌ ุฃููู ููุฐู ุงูุทุฑููุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ksGetTextLength</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> BSTR text, // </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> style //  </span></span></span><span class="hljs-function">)</span></span>;</code> </pre><br>  ุชุฑุฌุน ุงูุทุฑููุฉ ุทูู ุงูุณูุณูุฉ ุจุงููููููุชุฑ.  ูุฑุฌู ููุงุญุธุฉ: ุฃู ุงูุฃุณููุจ ููุจู ุงูุณูุณูุฉ ููุณูุง ููุนููุฉ ุ ูููุณ ูุคุดุฑูุง ูููุงุฆู "text".  ูุฐุง ูุณูุญ ูู ุจุชูููู ุญุฌู ุงูุฎุท ูุจู ุฅุฎุฑุงุฌู ุฅูู ุงููุณุชูุฏ. <br><br><h2 style=";text-align:right;direction:rtl">  <font color="#00B2FF">ูุซุงู</font> </h2><br>  ุฎุฐ ุจุนูู ุงูุงุนุชุจุงุฑ ูุซุงู ุนูู ุงุณุชุฎุฏุงู ุทุฑููุฉ <b>ksGetTextLength</b> .  ูููุชุฑุถ ุฃู ูุฏููุง ุฎุทูุง ููุญุชุงุฌ ุฅูู ูุถุนู ูู ูุณุชุทูู ุจุทูู ูุนูู (ูุฐู ุงููููุฉ ุฃุณูู ุจูุซูุฑ ูู ุญููุง ุจูุณุงุนุฏุฉ ุงูููุฑุงุช ุ ูููู ุญูููุง ูู ุงูุฏุฑูุณ ุงููุงุฏูุฉ).  ุฅุฐุง ูุงู ุงูุฎุท ููุงุณุจูุง ูู ุ ูุณูุชู ุนุฑุถู ุจุงููุงูู.  ุฅุฐุง ูู ููู ูุฐูู ุ ูุณูุชู ูุทุนู ููุถุน ุนูุงูุฉ ุญุฐู ูู ููุงูุชู.  ุฃุฏูุงู ูู ุฑูุฒ ุงููุตุฏุฑ ููุจุฑูุงูุฌ ุงูุฐู ูุญู ูุซู ูุฐู ุงููุดููุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs ruby">const wchar_t FULLSTR[] = L<span class="hljs-string"><span class="hljs-string">"  !   !   !"</span></span>; const wchar_t DOTS[] = L<span class="hljs-string"><span class="hljs-string">"..."</span></span>; const long STYLE = <span class="hljs-number"><span class="hljs-number">1</span></span>; double maxSize = <span class="hljs-number"><span class="hljs-number">100.0</span></span>; BSTR str = SysAllocString(FULLSTR); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Document2D-&gt;ksGetTextLength(str, STYLE) &gt; maxSize) { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   BSTR str_dots = SysAllocString(DOTS); double size_dots = Document2D-&gt;ksGetTextLength(str_dots, STYLE); SysFreeString(str_dots); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>     maxSize -= size_dots; SysReAllocStringLen(&amp;str, str, SysStringLen(str) - <span class="hljs-number"><span class="hljs-number">4</span></span>); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> ,     <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(Document2D-&gt;ksGetTextLength(str, STYLE) &gt; maxSize) SysReAllocStringLen(&amp;str, str, SysStringLen(str) - <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>    size_t len = SysStringLen(str); SysFreeString(str); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>     wchar_t *p = new wchar_t[len + wcslen(DOTS) + <span class="hljs-number"><span class="hljs-number">1</span></span>]; wcsncpy(p, FULLSTR, len); p[len] = L<span class="hljs-string"><span class="hljs-string">'\0'</span></span>; wcscat(p, DOTS); str = SysAllocString(p); delete [] p; } /<span class="hljs-regexp"><span class="hljs-regexp">/    Document2D-&gt;ksText(100, 100, /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  0, /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  0, /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  0, /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ 0, /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  str); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  SysFreeString(str); Document2D.Unbind(); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   kompas-&gt;Visible = true; kompas.Unbind();</span></span></code> </pre><br>  ูุชู ุชุญุฏูุฏ ุงูุณูุณูุฉ ุงููุตุฏุฑ ูู ุซุงุจุช <b>FULLSTR</b> .  ูููู <b>maxSize</b> ุงููุชุบูุฑ ุจุชุนููู ุทูู ุงููุณุชุทูู ุงูุฐู ุชุฑูุฏ ุฅุฏุฎุงู ุงูุณูุณูุฉ ููู.  ูู ููุช ูุงุญู ูุชู ุชุญุฏูุฏ ูุฐู ุงููููุฉ ุ ูุชู ุทุฑุญ ุญุฌู ุงููุทุน ูููุง ุ ูุงูุฐู ูุชู ุชุฎุฒููู ูู ูุชุบูุฑ <b>size_dots</b> .  ุฅุฐุง ูู ููู ุงูุฎุท ููุงุณุจูุง ุ ูุชู ูุทุน ุญุฑู ูุงุญุฏ ููู ุญุชู ูุชูุงุณุจ ูุน ูุณุชุทูู ุงูุญุฌู ุงููุญุฏุฏ.  ูุญุฏุซ ูุฐุง ูู <b>ุญููุฉ ูู ุงูููุช</b> . <br><br>  ุงูุชุจู ุฅูู ููุทุฉ ูููุฉ ุฌุฏูุง: ุนูุฏ ุฅุฎุฑุงุฌ ุณูุณูุฉ ุ ูููู ูุฌููุน ูุนููุงุช ุทุฑููุฉ <b>ksText</b> (ุจุงุณุชุซูุงุก ุฅุญุฏุงุซูุงุช ููุทุฉ ุงูุฑุจุท) <i>ูููุฉ ุตูุฑูุฉ</i> .  ูุงูุญูููุฉ ูู ุฃู ุทุฑููุฉ <b>ksGetTextLength ูุง</b> ุชุนุฑู ุดูุฆูุง ุนู ูุฐู ุงููุนููุงุช ุ ูุฐุง ูุง ูููููุง ุฃุฎุฐูุง ูู ุงูุงุนุชุจุงุฑ ุนูุฏ ุญุณุงุจ ุทูู ุงูุณูุณูุฉ.  ูุจุงูุชุงูู ุ ุฅุฐุง ูุงู ูุงุชุฌ ุงูุณูุณูุฉ ูุณุชุฎุฏู ููููุง ุบูุฑ ุตูุฑูุฉ ููุนููุงุช ุฃุณููุจ <b>ksText</b> ุ ููุฏ ูุฎุชูู ุทูู ุงูุณูุณูุฉ ุงููุงุชุฌ ุนู ุฐูู ุงูุฐู ุชู ุงูุญุตูู ุนููู ุจูุงุณุทุฉ ุทุฑููุฉ <b>ksGetTextLength</b> . <br><br>  <b>ุงูุฎูุงุตุฉ</b> <br><br>  ุชุนูููุง ูู ูุฐุง ุงูุฏุฑุณ ููููุฉ ุนุฑุถ ุชุณููุงุช ูุตูุฉ ุจุณูุทุฉ ุจุงุณุชุฎุฏุงู ุทุฑููุฉ <b>ksText</b> .  ูุฐู ููุณุช ุงูุทุฑููุฉ ุงููุญูุฏุฉ ูุนุฑุถ ุงููุต ุ ูููู ุฑุจูุง ุฃุณูู.  ูู ุงูุฏุฑุณ ุงูุชุงูู ุ ุณูููู ูุธุฑุฉ ุนูู ููููุฉ ุฅุฎุฑุงุฌ ูุฐุง ุงูุฎุท ุงููุฑูุจ ุจุงุณุชุฎุฏุงู ูุฐู ุงูุทุฑููุฉ.  ููู ูุง ููู ุ ุณููุธุฑ ูู ุทุฑู ุฅุฎุฑุงุฌ ุงููุต ุงูุฃูุซุฑ ุชุนููุฏูุง. <br><br>  <b>ูููุชุงุจุนุฉ ุ ุชุงุจุน ุฃุฎุจุงุฑ ุงููุฏููุฉ.</b> <br><br> <a href=""><img src="https://habrastorage.org/web/595/eee/f27/595eeef271b24830b3578751fcb52716.png"></a>  ุณูุฑุฌู ููุฑุณูู ุ ุฏูุชูุฑุงู ุ ูุคูู ูุชุงุจ "ุชุทููุฑ ุงูุชุทุจููุงุช ูู COMPAS ูู ุฏููู". </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar417723/">https://habr.com/ru/post/ar417723/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar417709/index.html">ุฃูู ูููู ูููู ุงููุทูุฑูู ุฃุตุญุงุจ ุงูุนููุ ุฎุฏูุงุช ุชูููู ุงูุดุฑูุฉ ูู ุตูุงุนุฉ ุชูููููุฌูุง ุงููุนูููุงุช</a></li>
<li><a href="../ar417711/index.html">ูุงุฐุง ุชูุฑุฃ ุนูู Swift ุจุงููุบุฉ ุงูุฑูุณูุฉุ</a></li>
<li><a href="../ar417715/index.html">ูุฏุงุนุง ุฎุฑุงุฆุท ุฌูุฌู</a></li>
<li><a href="../ar417717/index.html">ููู ูุงูุช ุงูุฃุฑุถ ุนูุฏูุง ูุงูุช ุณุงุฎูุฉ ุนูููุง ููุง ูุนุฏูุง ุนุงู 2100ุ</a></li>
<li><a href="../ar417721/index.html">GPUs ูู ุญู ูุดุงูู ุชูููููุฌูุง ุงููุนูููุงุช ุงูุญุฏูุซุฉ</a></li>
<li><a href="../ar417725/index.html">ููู ูุณุชุฃุฌุฑ Flant ุงูููุธููู</a></li>
<li><a href="../ar417729/index.html">ุงูุชู ููุฑ i7-8086K (ุงูุฌุฒุก 2)</a></li>
<li><a href="../ar417731/index.html">ูุตุฉ T61 ูุงุญุฏุฉ</a></li>
<li><a href="../ar417733/index.html">ุจุฑูุงูุฌ Java 9 ุงูุชุนูููู ูุฃููุฆู ุงูุฐูู ูุฌุจ ุนูููู ุงูุนูู ูุน ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงููุฏููุฉ</a></li>
<li><a href="../ar417735/index.html">ุงูุจููุฉ ุงูุชุญุชูุฉ ููููุชุงุญ ุงูุนุงู: ุฑููุฒ GnuPG / SMIME ู PKCS # 11 ูุน ุฏุนู ุงูุชุดููุฑ ุงูุฑูุณู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>