<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üå† üë®‚Äçüëß ü§í Criando um aplicativo de colora√ß√£o no Unity3D üõÄüèø üïé üë©üèø‚Äçü§ù‚Äçüë®üèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Essa hist√≥ria come√ßou em uma noite gelada de primavera, quando surgiu a pergunta: existe uma maneira de determinar o grau de preenchimento de uma form...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Criando um aplicativo de colora√ß√£o no Unity3D</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/412971/"><img src="https://habrastorage.org/webt/1n/wt/6k/1nwt6kpf53h7tdyd_ez0-j3f5ds.jpeg" alt="imagem"><br><br>  Essa hist√≥ria come√ßou em uma noite gelada de primavera, quando surgiu a pergunta: existe uma maneira de determinar o <b>grau de preenchimento de uma forma geom√©trica arbitr√°ria com tinta</b> (ou seja, em que porcentagem ela √© atualmente pintada)?  Sim, para que n√£o apenas diminua a velocidade, mas <i>voe a 60 fps</i> nos dispositivos m√≥veis mais fracos. <br><br>  Para aqueles que n√£o entenderam imediatamente o que eu estava falando, explicarei: uma abordagem raster √© poss√≠vel para o problema, assim como ... n√£o uma abordagem raster. <br><a name="habracut"></a><br>  No primeiro caso, tudo √© simples, o t√≥pico <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">inunda√ß√£o</a> e algoritmos relacionados foram estudados e implementados com √™xito no <abbr title="Linguagens de Programa√ß√£o">YP</abbr> para todos os gostos.  H√° uma matriz de pixels a serem preenchidos, suas bordas.  Contamos o n√∫mero de pontos inundados, dividimos pelo n√∫mero total e voila - temos a porcentagem estimada na sa√≠da.  Mas - com um grande n√∫mero de pixels (e ppi em dispositivos modernos, voc√™ mesmo sabe qual deles), al√©m disso - se houver muitas dessas figuras, encontramos v√°rios c√°lculos em cada quadro que aquecem agradavelmente o dispositivo, mas n√£o a alma. <br><br>  De qualquer forma, trabalhar com o raster parecia antidesportivo.  O olhar estava voltado para aterros onipotentes.  V√°rias horas emocionantes de codifica√ß√£o relaxada e persistente provaram a hip√≥tese: voc√™ pode usar algo como ‚Äú <i>cor de v√©rtice</i> ‚Äù - cor de v√©rtice. <br><br><div class="spoiler">  <b class="spoiler_title">Um pouco sobre a cor dos v√©rtices</b> <div class="spoiler_text">  O canal de informa√ß√µes adicionais nativas dispon√≠veis na estrutura de dados do tri√¢ngulo √© o mesmo <i>mesh.colors</i> .  Teoricamente, ele pode ser usado para qualquer finalidade, dependendo do que est√° escrito no shader, mas nesse caso, o byte estimado armazenar√° exatamente o valor atual do preenchimento de cores para cada v√©rtice.  Seu sombreador o usa ao renderizar e, com o Unity, um material, voc√™ pode criar um n√∫mero ilimitado de malhas multicoloridas com um material para todos.  O mais interessante √© que os valores das cores dos v√©rtices s√£o interpolados por hardware entre si, o que permite fazer gradientes de luz. <br></div></div><br>  Acho que vale a pena mencionar por que era necess√°ria a not√≥ria porcentagem de sombreamento, com a qual o artigo come√ßou.  A id√©ia principal da aplica√ß√£o de colora√ß√£o foi a seguinte: a figura final consiste em um conjunto de pol√≠gonos.  O aplicativo ir√° <b>sequencialmente e automaticamente desativar o elemento usu√°rio por elemento</b> .  Assim, at√© que voc√™ termine de pintar uma pe√ßa at√© o fim, voc√™ n√£o passar√° para a pr√≥xima.  Essa decis√£o me pareceu muito elegante, atraente e, √† luz do dom√≠nio global dos corantes de "pixel" nas hist√≥rias, tamb√©m era nova. <br><br><h1>  Primeiros passos </h1><br>  Obviamente, para criar uma colora√ß√£o completa, era necess√°rio criar muitas solu√ß√µes intrigantes.  Em primeiro lugar, eu queria que, por toda a natureza poligonal da aplica√ß√£o, a colora√ß√£o fosse percebida como a mais raster, ou seja, a <b>tinta deveria se espalhar sob o dedo</b> e ter uma apar√™ncia mais ou menos realista.  O requisito inicial para o desempenho m√°ximo n√£o desapareceu em lugar nenhum e continuou pendurando uma formid√°vel nuvem cumulus em todo o processo. <br><br>  O primeiro passo foi fazer o <b>mosaico</b> humano (quebrar um grande pol√≠gono que consiste em um conjunto de tri√¢ngulos em um grupo estoc√°stico de pequenos tri√¢ngulos).  De fato, se obtivermos uma matriz de v√©rtices e escrevermos a cor do v√©rtice ao preenchermos, podemos determinar por uma passagem normal pela matriz se a figura est√° completamente preenchida e que outras pe√ßas permanecem sem pintura - <i>semelhante ao algoritmo de pixel, mas com muito mais liberdade</i> . <br><br><img src="https://habrastorage.org/webt/hd/ki/0c/hdki0cypjlbrmfhokpfho7y0qv4.jpeg" alt="imagem"><br><br>  Ent√£o come√ßou uma emocionante jornada ao mundo dos shaders.  Como voc√™ entende, n√£o consigo descobrir completamente todos os achados e segredos, mas direi que, ao interagir com o mapa de ru√≠do e os raios Unity da velha escola que emitem dos meus dedos, o efeito do pincel foi alcan√ßado, e mesmo com a propaga√ß√£o de tinta ao longo dos tri√¢ngulos adjacentes ao dedo.  O uso da cor de v√©rtice tornou poss√≠vel dispensar <b>um material Unity</b> em absolutamente todas as partes componentes da figura e, portanto, as chamadas no programa finalizado n√£o excedem 5-7 (dependendo da presen√ßa de menus e part√≠culas). <br><br>  O golpe √© feito pelo habitual Unity Line Renderer, que trai√ßoeiramente trai√ßoeira algumas figuras, movendo-se e mostrando falhas nas articula√ß√µes.  Isso n√£o p√¥de ser derrotado; portanto, a tarefa priorit√°ria √© reescrever o componente do zero.  Uma impress√£o digital tamb√©m √© um Trail Renderer padr√£o, mas seu shader usa uma verifica√ß√£o z para que os oligoelementos n√£o se sobreponham, criando artefatos feios.  A textura "quadriculado" do fundo ajuda, entre outras coisas, <b>a avaliar o tamanho do elemento que est√° sendo pintado</b> : quanto maior, menor o tamanho das c√©lulas. <br><br><img src="https://habrastorage.org/webt/tq/oa/-3/tqoa-3wwdoc-fg23wqk_mcgnpqc.gif" alt="imagem"><br><br><h1>  Funcionalidade n√£o esperada </h1><br>  Durante o teste, muitas vezes, em algum ponto nos cantos da figura, havia picos vazios, o que era dif√≠cil de determinar visualmente.  Apesar do fato de o gatilho para alternar para o pr√≥ximo elemento funcionar quando o n√≠vel de preenchimento era de 97%, a situa√ß√£o √© ‚Äú <i>o que fazer a seguir?</i>  ¬ª- com um grau de ocupa√ß√£o de 90% a 97% - surgiam com frequ√™ncia e confundiam usu√°rios (que basicamente n√£o tinham mais de 12 anos).  Eu n√£o queria definir um gatilho de menos de 97%, porque ent√£o apareceu o efeito " <i>ainda n√£o havia terminado, mas j√° havia saltado</i> ". <br><br>  Ent√£o, com relut√¢ncia, conheci <b>Madame Clusterization</b> .  Imagine: um pol√≠gono, um monte de pontos dentro, existem alguns "especiais", √†s vezes separadamente, √†s vezes em grupos.  √â necess√°rio encontrar e designar o maior "grupo".  Este √© um problema matem√°tico comum.  Nenhum dos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">algoritmos tradicionais</a> que encontrei surgiu por v√°rias raz√µes, eu tive que fazer o meu pr√≥prio.  Hackear o hack, mas funcionou - e as √°reas n√£o pintadas come√ßaram a se destacar em um belo c√≠rculo din√¢mico.  Para otimizar, esse algoritmo funciona a cada 3 segundos e somente depois que o usu√°rio fica intrigado em levantar o dedo da tela no estilo "o que fazer a seguir".  Parece bastante org√¢nico. <br><br><img src="https://habrastorage.org/webt/h_/qc/-d/h_qc-dlrdx_2aqol8nbqioqivzq.gif" alt="imagem"><br><br>  Ap√≥s um brainstorming, criar uma <b>‚Äúlinha de colora√ß√£o‚Äù</b> variada de acordo com os requisitos dos testadores - ou seja, dar ao usu√°rio a oportunidade de escolher em que sequ√™ncia ele deseja colorir os elementos - era quest√£o de uma noite.  Tudo o que voc√™ precisa √© determinar os centros geom√©tricos de cada malha e constru√≠-los conforme necess√°rio: da esquerda para a direita, de cima para baixo, etc. Para maior clareza, as part√≠culas foram implementadas contra o fundo, que mostram a dire√ß√£o da fila. <br><br><div class="spoiler">  <b class="spoiler_title">Ilustra√ß√£o de fila</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/vg/kt/ij/vgktijp2haaqb6ij0gi6jemuqjo.gif" alt="imagem"><br><br>  A fila padr√£o √© mostrada aqui (como o artista pretendeu).  Se voc√™ ativar o modo " <i>passo a passo</i> ", clicando em um dos bot√µes abaixo, a fila de cores ser√° alterada e as part√≠culas viajar√£o na dire√ß√£o indicada. <br></div></div><br><h1>  UX e interface do usu√°rio </h1><br>  Eu geralmente gosto da id√©ia de automatismo controlado em aplicativos e, portanto, cada elemento √© centralizado e dimensionado para que possa ser pintado com o dedo <b>sem precisar rolar a tela</b> .  A desvantagem dessa abordagem √© que nem sempre √© claro qual parte da figura est√° agora na tela.  Como se viu, os usu√°rios at√© gostam de um desafio t√£o pequeno, pois ele treina mem√≥ria de curto prazo e correla√ß√£o de informa√ß√µes - voc√™ precisa ter em mente o quadro geral.  Bem, existem duas maneiras de chegar √† "vista a√©rea da figura" - com um gesto de pin√ßa ou pressionando o bot√£o de zoom. <br><br><img src="https://habrastorage.org/webt/9_/ej/ic/9_ejic4dyydfoljrxzxdqjl9xos.gif" alt="imagem"><br><br>  Seguindo os preceitos das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">diretrizes de interface</a> da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Apple</a> , decidiu-se reduzir ao m√≠nimo o n√∫mero de bot√µes na tela.  Al√©m do bot√£o de <b>aumentar / diminuir</b> o <b>zoom</b> e do √≥bvio bot√£o de sa√≠da no menu, h√° tamb√©m uma chamada na paleta - voc√™ pode pintar com a cor "padr√£o" definida pelo artista ou √† sua escolha. <br><br>  Al√©m disso, no modo ‚Äúolho de p√°ssaro‚Äù, voc√™ pode alterar o gradiente de fundo (cada clique √© gerado aleatoriamente) ou entrar no modo de ‚Äúrepintar‚Äù, que permite corrigir um elemento j√° pintado.  Sim, tive que ocultar essa funcionalidade, mas √© justificada - para todos os testes, ningu√©m nunca perguntou como faz√™-lo. <br><br><h4>  Sobre a paleta </h4><br>  A paleta em si foi refeita duas vezes.  No come√ßo, simplesmente coloquei um certo n√∫mero de quadrados com cores na tela, mas os usu√°rios pediram mais cores.  Eu n√£o queria rolar na interface e, portanto, o esquema <b>"tonalidade da cor"</b> apareceu, ou seja, primeiro o usu√°rio seleciona a cor base pressionando e depois uma de suas tonalidades.  A paleta √© removida com um bot√£o ou deslizando o dedo para baixo.  Al√©m disso, quando aparece na tela, o espa√ßo de trabalho do artista √© reduzido em 1/3, o que exige um "redimensionamento" da figura atual para o tamanho alterado da janela de exibi√ß√£o. <br><br><img src="https://habrastorage.org/webt/-b/7l/mc/-b7lmcif2fozsmqquhrifrisyqo.gif" alt="imagem"><br><br><h1>  Para doce </h1><br>  O principal elo que faltava em todo o cen√°rio era a <b>recompensa</b> - um tipo de recompensa psicol√≥gica visual que o usu√°rio recebe ap√≥s a conclus√£o do processo de colora√ß√£o.  A ideia <s>foi espionada</s> na superf√≠cie: a figura foi pintada automaticamente e de novo, no modo acelerado, e exatamente como o usu√°rio - em outras palavras, o <b>intervalo de tempo de 15 a 20 segundos</b> .  Isso √© implementado gravando a sequ√™ncia na qual o usu√°rio tocou nos v√©rtices das figuras e, posteriormente, reproduzindo os dados no mecanismo de desenho com atrasos (via corotinas).  Cada malha √© duplicada v√°rias vezes para obter os efeitos de "manifesta√ß√£o" e "atenua√ß√£o". <br><br><img src="https://habrastorage.org/webt/1m/q7/dg/1mq7dg-rgkjl0r5hamxlci7vq94.gif" alt="imagem"><br><br>  Obviamente, o intervalo de tempo durante a reprodu√ß√£o √© <b>gravado no arquivo de v√≠deo</b> e, ap√≥s a extravag√¢ncia visual, o usu√°rio √© solicitado a salvar / compartilhar uma obra-prima rec√©m-criada.  Felizmente, na primavera, um plug-in apareceu na Asset Store que permite capturar v√≠deos de v√°rias plataformas na tela (depois de algumas configura√ß√µes), porque escrever essa ferramenta do zero vai muito al√©m das minhas habilidades de programa√ß√£o, <s>mas em geral sou designer</s> . <br><br><div class="spoiler">  <b class="spoiler_title">Em vez de uma conclus√£o</b> <div class="spoiler_text">  Nestas mil palavras atribu√≠das por mim at√© a primeira obra.  Nas partes a seguir, est√° planejado contar sobre as batalhas her√≥icas com a Unity UI ao desenvolver a segunda parte do aplicativo - o menu para selecionar imagens, al√©m de contar os solavancos nos neg√≥cios dif√≠ceis da ASO. <br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt412971/">https://habr.com/ru/post/pt412971/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt412959/index.html">Para a quest√£o do AVR e recordes mundiais</a></li>
<li><a href="../pt412961/index.html">Compartilhando economia nas telecomunica√ß√µes</a></li>
<li><a href="../pt412963/index.html">Nova precipita√ß√£o: o que se sabe sobre o Vault 76?</a></li>
<li><a href="../pt412967/index.html">Fazendo um bom widget de ajuste de brilho</a></li>
<li><a href="../pt412969/index.html">Os sistemas de reconhecimento de rosto aparecem nas escolas americanas, mas sua efic√°cia est√° em quest√£o</a></li>
<li><a href="../pt412975/index.html">Button smartphones em 2018</a></li>
<li><a href="../pt412977/index.html">Desagrado anula o n√≠vel de felicidade: por que √© imposs√≠vel ser feliz o tempo todo</a></li>
<li><a href="../pt412979/index.html">Pergunte a Ethan: se a mat√©ria escura est√° em todo lugar, por que n√£o a encontramos no sistema solar?</a></li>
<li><a href="../pt412983/index.html">Insider Dev Tour: transmiss√£o ao vivo</a></li>
<li><a href="../pt412985/index.html">A revolu√ß√£o das mensagens instant√¢neas? A UE prop√¥s a introdu√ß√£o de uma lei sobre um padr√£o de mensagens unificadas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>