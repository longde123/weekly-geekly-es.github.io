<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë¥üèº üóø üõçÔ∏è PBX virtuel Rostelecom: quoi et comment faire via l'API üç£ üßúüèª üë®üèΩ‚Äç‚úàÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Les entreprises modernes per√ßoivent les t√©l√©phones fixes comme une technologie d√©pass√©e: la communication cellulaire assure la mobilit√© et la disponib...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PBX virtuel Rostelecom: quoi et comment faire via l'API</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/rostelecom/blog/484180/"><img src="https://habrastorage.org/webt/9p/4z/il/9p4zilg_eledccytuo6hslf19f0.png"><br><br>  Les entreprises modernes per√ßoivent les t√©l√©phones fixes comme une technologie d√©pass√©e: la communication cellulaire assure la mobilit√© et la disponibilit√© constante des employ√©s, les r√©seaux sociaux et les messageries instantan√©es sont un canal de communication plus facile et plus rapide.  Afin de suivre leurs concurrents, les PBX de bureau leur ressemblent de plus en plus: ils vont dans le cloud, sont g√©r√©s via l'interface web et sont int√©gr√©s √† d'autres syst√®mes via l'API.  Dans cet article, nous vous expliquerons les fonctions de l'API PBX virtuel Rostelecom et comment l'utiliser avec les fonctions de base d'un PBX virtuel. <br><a name="habracut"></a><br>  La t√¢che principale de l'API PBX virtuel Rostelecom est d'interagir avec les sites CRM ou d'entreprise.  Par exemple, l'API comprend des widgets "rappel" et "appel depuis le site" pour les principaux syst√®mes de contr√¥le: WordPress, Bitrix, OpenCart.  L'API vous permet de: <br><br><ul><li>  Recevoir des informations, informer sur l'√©tat et passer des appels sur demande √† partir d'un syst√®me externe; <br></li><li>  Obtenez un lien temporaire vers l'enregistrement de la conversation; <br></li><li>  G√©rer et recevoir les param√®tres de restriction des utilisateurs; <br></li><li>  Obtenez des informations sur l'utilisateur d'un PBX virtuel; <br></li><li>  Demander un historique des frais et des frais sur les appels; <br></li><li>  T√©l√©chargez le journal des appels. <br></li></ul><br><h2>  Fonctionnement de l'API </h2><br>  L'API d'int√©gration et le syst√®me externe interagissent les uns avec les autres √† l'aide de requ√™tes HTTP.  Dans votre compte personnel, l'administrateur d√©finit les adresses o√π les demandes √† l'API doivent arriver et o√π les demandes de l'API doivent √™tre envoy√©es.  Le syst√®me externe doit avoir une adresse publique accessible depuis Internet avec un certificat SSL install√©. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/aef/32c/8c5/aef32c8c5b54534a5b002a87166cb724.png"><br><br>  De plus, dans votre compte personnel, l'administrateur de domaine peut restreindre les sources IP de demandes lors de l'acc√®s √† l'API. <br><br><h2>  Nous obtenons des informations sur les utilisateurs du PBX virtuel </h2><br>  Pour obtenir une liste d'utilisateurs ou de groupes, vous devez envoyer une demande au PBX virtuel √† l'aide de la m√©thode <i>/ users_info</i> . <br><br><pre><code class="plaintext hljs">{         "domain":"example.ru" }</code> </pre> <br>  Une liste vous sera retourn√©e que vous pourrez sauvegarder. <br><br><pre> <code class="plaintext hljs">{ "result":0, "resultMessage":"", "users":[                           {                            "display_name":"test_user_1",                            "name":"admin",                            "pin":^_^quot öquot^_^,                           "is_supervisor":true,                            "is_operator":false,                            "email":"test_user_1@mail.gov","recording":1                             },                            {                            "display_name":"test_user_2",                            "name":"test",                            "pin":^_^quot øquot^_^,                            "is_supervisor":true,                            "is_operator":false,                            "email":"",                           "recording":1                            }              ], "groups":              [                            {                            "name":"testAPI",                            "pin":^_^quot«¥quot^_^,                            "email":"Ivanov@mail.gov",                            "distribution":1,                           "users_list":[^_^quot öquot^_^,^_^quot øquot^_^]                            }              ]</code> </pre><br>  Dans cette m√©thode, deux tableaux sont pass√©s.  Un avec les utilisateurs du domaine, un avec les groupes de domaines.  Le groupe a √©galement la possibilit√© de sp√©cifier l'e-mail qui sera envoy√© dans la demande. <br><br><h2>  Nous traitons les informations sur un appel entrant </h2><br>  La connexion de la t√©l√©phonie d'entreprise √† divers syst√®mes CRM fait gagner du temps aux employ√©s qui interagissent avec les clients et acc√©l√®re le traitement des appels entrants.  Par exemple, lors d'un appel du client actuel, CRM peut ouvrir sa carte, et depuis CRM, vous pouvez envoyer un appel au client et le connecter √† l'employ√©. <br><br>  Pour obtenir des informations sur les appels via l'API, vous devez utiliser la m√©thode <i>/ get_number_info</i> , qui forme une liste d'appels avec des informations sur le groupe dans lequel l'appel est distribu√©.  Supposons qu'un appel entrant du num√©ro 1234567890 soit arriv√© au num√©ro de PBX virtuel, puis une demande sera envoy√©e depuis le PBX: <br><br><pre> <code class="plaintext hljs">{        "session_id":"SDsnZugDFmTW7Sec",        "timestamp":"2019-12-27 15:34:44.461",        "type":"incoming",        "state":"new",        "from_number":"sip:&lt;/i^_^gt lt&amp;i;gt^_^@192.168.0.1",        "from_pin":"",        "request_number":"sip:&lt;/i^_^gt lt&amp;i;gt^_^@1192.168.0.1",        "request_pin":^_^quot…üquot^_^,        "disconnect_reason":"",        "is_record":"" }</code> </pre><br>  Ensuite, vous devez connecter le gestionnaire <i>/ get_number_info</i> .  La demande doit √™tre ex√©cut√©e lorsqu'un appel entrant arrive sur une ligne entrante avant de router les appels.  Si la r√©ponse √† la demande n'est pas re√ßue dans le d√©lai d√©fini, l'appel est achemin√© conform√©ment aux r√®gles √©tablies dans le domaine. <br><br>  Exemple de gestionnaire c√¥t√© CRM. <br><br><pre> <code class="plaintext hljs">if ($account) {        $data = [            'result' =&gt; 0,            'resultMessage' =&gt; ' ',            'displayName' =&gt; $account-&gt;name,            //'PIN' =&gt; $crm_users,        ];    }        else                {        $data = [            'result' =&gt; 0,            'resultMessage' =&gt; '  ',            'displayName' =&gt; '  '.$contact,            //'PIN' =&gt; crm_users,        ];    }    return $data;</code> </pre><br>  La r√©ponse du gestionnaire. <br><br><pre> <code class="plaintext hljs">{        "result":0,        "resultMessage":" ",        "displayName":"   +1&lt;/i&gt; 234-56-78-90&lt;i&gt;" }</code> </pre><br><h2>  Nous surveillons l'√©tat et t√©l√©chargeons les enregistrements de conversation </h2><br>  Dans le central t√©l√©phonique virtuel de Rostelecom, l'enregistrement des conversations est activ√© dans votre compte personnel.  √Ä l'aide de l'API, vous pouvez suivre l'√©tat de cette fonction.  Lors du traitement de la terminaison d'appel dans <i>call_events,</i> vous pouvez voir l' <i>indicateur 'is_record',</i> qui informe l'utilisateur de l'√©tat d'enregistrement: <i>true</i> signifie que la fonction d'enregistrement de conversation est <i>activ√©e pour l'utilisateur</i> . <br><br>  Pour t√©l√©charger un enregistrement, vous devez envoyer une demande √† <i>api.cloudpbx.rt.ru/get_record en utilisant l'</i> ID de session de l'appel <i>session_id</i> <i>.</i> <i><br></i> <br><pre> <code class="plaintext hljs">{        "session_id":"SDsnZugDFmTW7Sec" }</code> </pre><br>  La r√©ponse sera un lien temporaire pour t√©l√©charger le fichier d'enregistrement de conversation. <br><br><pre> <code class="plaintext hljs">{        "result": ^_^quot&amp;#0;quot^_^,        "resultMessage": "  ",    "url": "https://api.cloudpbx.rt.ru/records_new_scheme/record/download/501a8fc4a4aca86eb35955419157921d/188254033036" }</code> </pre><br><br>  La dur√©e de stockage des fichiers est d√©finie dans les param√®tres de votre compte personnel.  Une fois le fichier supprim√©. <br><br><h2>  Statistiques et rapports </h2><br>  Dans votre compte sur une page s√©par√©e, vous pouvez voir les statistiques et les rapports pour tous les appels et appliquer des filtres par statut et par heure.  Gr√¢ce √† l'API, vous devez d'abord traiter l'appel avec la m√©thode <i>/ call_events</i> : <br><br><pre> <code class="plaintext hljs">    {        "session_id":"SDsnZugDFmTW7Sec",        "timestamp":"2019-12-27 15:34:59.349",        "type":"incoming",        "state":"end",        "from_number":"sip:&lt;/i^_^gt lt&amp;i;gt^_^@192.168.0.1",        "from_pin":"",        "request_number":"sip:&lt;/i^_^gt lt&amp;i;gt^_^@192.168.0.1",        "request_pin":^_^quot öquot^_^,        "disconnect_reason":"",        "is_record":"true"        }</code> </pre><br>  Appelez ensuite la m√©thode <i>call_info</i> pour traiter le tableau et afficher l'appel dans le syst√®me CRM. <br><br><pre> <code class="plaintext hljs">   {        "session_id":"SDsnZugDFmTW7Sec" }</code> </pre><br>  La r√©ponse sera un tableau de donn√©es qui peut √™tre trait√© pour stocker des donn√©es dans le journal CRM. <br><br><pre> <code class="plaintext hljs">{        "result":0,        "resultMessage":"",        "info":        {                "call_type":1,                "direction":1,                "state":1,                "orig_number":"sip:&lt;/i^_^gt lt&amp;i;gt^_^@192.168.0.1",                "orig_pin":null,                "dest_number":"sip:&lt;/i^_^gt lt&amp;i;gt^_^@192.168.0.1",                "answering_sipuri":"admin@example.ru",                "answering_pin":^_^quot…üquot^_^,                "start_call_date":^_^quot quot^_^,                "duration":14,                 "session_log":"0:el:123456789;0:ru:admin;7:ct:admin;9:cc:admin;14:cd:admin;",                "is_voicemail":false,                "is_record":true,                "is_fax":false,                "status_code":^_^quot&amp;#0;quot^_^,                "status_string":""        } }</code> </pre><br><br><h2>  Autres fonctionnalit√©s de PBX virtuel utiles </h2><br>  En plus de l'API, le PBX virtuel a quelques fonctions plus utiles que vous pouvez utiliser.  Par exemple, il s'agit d'un menu vocal interactif et d'une combinaison de communications cellulaires et fixes. <br><br>  La r√©ponse vocale interactive (RVI) est ce que nous entendons dans le r√©cepteur avant qu'une personne ne r√©ponde.  En fait, il s'agit d'un op√©rateur √©lectronique qui redirige les appels vers les services appropri√©s et r√©pond automatiquement √† certaines des questions.  Bient√¥t, il sera possible de travailler avec IVR via l'API: nous d√©veloppons maintenant un logiciel qui vous permettra de suivre la progression d'un appel via IVR et de recevoir des informations sur les frappes lorsque l'appelant est dans le menu vocal. <br><br>  Pour transf√©rer la t√©l√©phonie d'entreprise vers les t√©l√©phones mobiles, vous pouvez utiliser des applications de t√©l√©phonie logicielle ou connecter s√©par√©ment le service de convergence mobile fixe (FMC).  Avec n'importe laquelle des m√©thodes, les appels au sein du r√©seau sont gratuits, il est possible de travailler avec des num√©ros courts, et les appels peuvent √™tre enregistr√©s et des statistiques g√©n√©rales peuvent √™tre conserv√©es √† leur sujet. <br><br>  La diff√©rence est que les t√©l√©phones logiciels ont besoin d'Internet pour communiquer, mais ils ne sont pas li√©s √† un op√©rateur, et FMC est li√© √† un op√©rateur sp√©cifique, mais peut m√™me √™tre utilis√© sur des t√©l√©phones √† bouton-poussoir plus anciens. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr484180/">https://habr.com/ru/post/fr484180/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr484170/index.html">Mettre √† jour Check Point de R77.30 √† 80.20</a></li>
<li><a href="../fr484172/index.html">Int√©gration continue dans Unity: comment r√©duire le temps d'assemblage et √©conomiser des ressources + ligne de paiement en cadeau</a></li>
<li><a href="../fr484174/index.html">Castle buvant dans des conditions "extr√™mes" ou comment nous avons particip√© au spectacle "DOZOR"</a></li>
<li><a href="../fr484176/index.html">Impl√©mentation du mod√®le de statut dans Unity</a></li>
<li><a href="../fr484178/index.html">Commutateur Ethernet intelligent pour la plan√®te Terre</a></li>
<li><a href="../fr484182/index.html">Xenobots: des nanorobots vivants issus de cellules de grenouilles</a></li>
<li><a href="../fr484186/index.html">LDAP - "l'authentification" est un contre-mod√®le</a></li>
<li><a href="../fr484188/index.html">Normes de conception de base de donn√©es</a></li>
<li><a href="../fr484192/index.html">Applications faciles et faciles √† d√©ployer sur la cartouche Tarantool (partie 2)</a></li>
<li><a href="../fr484194/index.html">Kubernetes traduit en enfants</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>