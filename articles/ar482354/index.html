<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ง๐ผ ๐ ๐๏ธ ConfigureAwait: ุงูุฃุณุฆูุฉ ุงููุชุฏุงููุฉ ๐ง๐ฟ ๐ฉ๐พโ๐ค โฅ๏ธ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุฑุญุจุง ูุง ูุจุฑ! ุฃูุฏู ููู ุชุฑุฌูุฉ ููุงูุฉ ุฃุณุฆูุฉ ูุฃุฌูุจุฉ ูู ConfigureAwait ูู ุชุฃููู Stephen Taub. 



 await ุฅุถุงูุฉ Async / await ุฅูู .NET ููุฐ ุฃูุซุฑ ูู ุณุจุน ุณููุงุช...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ConfigureAwait: ุงูุฃุณุฆูุฉ ุงููุชุฏุงููุฉ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482354/" style=";text-align:right;direction:rtl"> ูุฑุญุจุง ูุง ูุจุฑ!  ุฃูุฏู ููู ุชุฑุฌูุฉ ููุงูุฉ <a href="https://devblogs.microsoft.com/dotnet/configureawait-faq/" rel="nofollow">ุฃุณุฆูุฉ ูุฃุฌูุจุฉ ูู ConfigureAwait ูู</a> ุชุฃููู Stephen Taub. <br><br><img src="https://habrastorage.org/webt/ps/pj/sm/pspjsmmgsimr2lachonj6idmnj8.png" alt="ุตูุฑุฉ"><br><br>  <code>await</code> ุฅุถุงูุฉ <code>Async</code> / <code>await</code> ุฅูู .NET ููุฐ ุฃูุซุฑ ูู ุณุจุน ุณููุงุช.  ูุงู ููุฐุง ุงููุฑุงุฑ ุชุฃุซูุฑ ูุจูุฑ ููุณ ููุท ุนูู ุงููุธุงู ุงูุจูุฆู .NET - ุจู ููุนูุณ ุฃูุถูุง ูู ุงูุนุฏูุฏ ูู ุงููุบุงุช ูุงูุฃุทุฑ ุงูุฃุฎุฑู.  ุญุงูููุง ุ ุชู ุชูููุฐ ุงูุนุฏูุฏ ูู ุงูุชุญุณููุงุช ูู .NET ูู ุญูุซ ุงูุชุฑููุจุงุช ุงููุบููุฉ ุงูุฅุถุงููุฉ ุจุงุณุชุฎุฏุงู ุนุฏู ุงูุชุฒุงูู ุ ูุชู ุชูููุฐ ูุงุฌูุงุช ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ูุน ุฏุนู ุบูุฑ ูุชุฒุงูู ุ ููุฏ ุชู ุฅุฌุฑุงุก ุชุญุณููุงุช ุฃุณุงุณูุฉ ูู ุงูุจููุฉ ุงูุชุญุชูุฉ ุจุณุจุจ ุนุฏู <code>async</code> / <code>await</code> ูุซู ุณุงุนุฉ (ุนูู ูุฌู ุงูุฎุตูุต ุ ุชู ุชุญุณูู ุงูุฃุฏุงุก ููุฏุฑุงุช ุงูุชุดุฎูุต ูู. NET ุงูุฃุณุงุณูุฉ). <br><br>  ูุนุฏ <code>ConfigureAwait</code> ุฃุญุฏ ูุธุงูุฑ <code>async</code> / <code>await</code> ุงูุฐู ูุณุชูุฑ ูู ุทุฑุญ ุงูุฃุณุฆูุฉ.  ุขูู ุฃู ุฃุชููู ูู ุงูุฅุฌุงุจุฉ ุนูู ุงููุซูุฑ ูููู.  ุณุฃุญุงูู ุฌุนู ูุฐู ุงูููุงูุฉ ูุงุจูุฉ ูููุฑุงุกุฉ ูู ุงูุจุฏุงูุฉ ุฅูู ุงูููุงูุฉ ุ ููู ุงูููุช ููุณู ุชูููุฐูุง ูู ููุท ุงูุฅุฌุงุจุงุช ุนูู ุงูุฃุณุฆูุฉ ุงููุชุฏุงููุฉ (FAQ) ุจุญูุซ ูููู ุงูุฑุฌูุน ุฅูููุง ูู ุงููุณุชูุจู. <a name="habracut"></a><br><br>  ููุชุนุงูู ูุน <code>ConfigureAwait</code> ุจุงููุนู ุ ุณูุนูุฏ ููููุงู. <br><br><h3 style=";text-align:right;direction:rtl">  ูุง ูู SynchronizationContextุ </h3><br>  ููููุง ููุซุงุฆู <a href="https://docs.microsoft.com/en-us/dotnet/api/system.threading.synchronizationcontext%3Fview%3Dnetframework-4.8" rel="nofollow">System.Threading.SynchronizationContext</a> "ุชููุฑ ุงููุธููุฉ ุงูุฃุณุงุณูุฉ ูุชูุฒูุน ุณูุงู ุงูุชุฒุงูู ูู ููุงุฐุฌ ุงูุชุฒุงูู ุงููุฎุชููุฉ."  ูุฐุง ุงูุชุนุฑูู ููุณ ูุงุถุญูุง ุชูุงููุง. <br><br>  ูู 99.9ูช ูู ุงูุญุงูุงุช ุ <code>SynchronizationContext</code> ุงุณุชุฎุฏุงู <code>SynchronizationContext</code> ุจุจุณุงุทุฉ ูููุน ุฐู ุฃุณููุจ <code>Post</code> ุงูุชุฑุงุถู ููุจู ูููุถูุง ููุชูููุฐ ุบูุฑ ุงููุชุฒุงูู (ููุงู ุฃุนุถุงุก ุงูุชุฑุงุถููู ุขุฎุฑูู ูู <code>SynchronizationContext</code> ุ ููููู ุฃูู ุดููุนูุง ููู ูุชู ููุงูุดุชูู ูู ูุฐู ุงูููุงูุฉ).  <a href="" rel="nofollow">ุงุณุชุฏุนุงุก</a> ุงูุฃุณููุจ <code>Post</code> ูู ุงูููุน ุงูุฃุณุงุณู ุญุฑููุงู <a href="" rel="nofollow">ุจุจุณุงุทุฉ</a> <code>ThreadPool.QueueUserWorkItem</code> ูุชูููุฐ ุงููููุถ ุงููุชููุฑ ุจุดูู ุบูุฑ ูุชุฒุงูู.  ุชุฎุทู ุงูุฃููุงุน ุงููุดุชูุฉ <code>Post</code> ุจุญูุซ ูููู ูููููุถ ุงูุชูููุฐ ูู ุงูููุงู ุงูููุงุณุจ ูู ุงูููุช ุงูููุงุณุจ. <br><br>  ุนูู ุณุจูู ุงููุซุงู ุ ูุญุชูู Windows Forms ุนูู <a href="" rel="nofollow">ููุน</a> ูุดุชู ูู SynchronizationContext ูุนูุฏ ุชุนุฑูู <code>Post</code> ูุฌุนู ุงูููุงูุฆ <code>Control.BeginInvoke</code> .  ูุฐุง ูุนูู ุฃู ุฃู ููุงููุฉ ุฅูู ุทุฑููุฉ <code>Post</code> ูุฐู ุณุชุคุฏู ุฅูู ุงุณุชุฏุนุงุก ุงููููุถ ูู ูุฑุญูุฉ ูุงุญูุฉ ูู ุณูุณูุฉ ุงูุฑุณุงุฆู ุงููุฑุชุจุทุฉ ุจุงูุชุญูู ุงูููุงุจู - ูุง ูุณูู ุจุฎูุท ูุงุฌูุฉ ุงููุณุชุฎุฏู.  ูู ููุจ ููุงุฐุฌ ูููุฏูุฒ ูู ูุนุงูุฌุฉ ุงูุฑุณุงุฆู Win32.  ูุชู ุชูููุฐ ุญููุฉ ุงูุฑุณุงุฆู ูู ูุคุดุฑ ุชุฑุงุจุท ูุงุฌูุฉ ุงููุณุชุฎุฏู ุงูุชู ุชูุชุธุฑ ููุท ูุนุงูุฌุฉ ุงูุฑุณุงุฆู ุงูุฌุฏูุฏุฉ.  ูุชู ุชุดุบูู ูุฐู ุงูุฑุณุงุฆู ูู ุฎูุงู ุญุฑูุฉ ุงููุงูุณ ูุงูููุฑุงุช ูุฅุฏุฎุงู ููุญุฉ ุงูููุงุชูุญ ูุฃุญุฏุงุซ ุงููุธุงู ุงููุชุงุญุฉ ููุชูููุฐ ูู ูุจู ุงููููุถูู ุ ุฅูุฎ. ูุฐูู ุ ุฅุฐุง ูุงู ูุฏูู ูุซูู <code>SynchronizationContext</code> ููุคุดุฑ ุชุฑุงุจุท ูุงุฌูุฉ ุงููุณุชุฎุฏู ูู ุชุทุจูู Windows Forms ุ ููุฌุจ ุนููู ุชูุฑูุฑ ุงููููุถ ุฅูู ุทุฑููุฉ <code>Post</code> ุฃุฌู ุฅุฌุฑุงุก ุนูููุฉ ููู. <br><br>  ูุญุชูู Windows Presentation Foundation (WPF) ุฃูุถูุง ุนูู <a href="" rel="nofollow">ููุน</a> ูุดุชู ูู <code>SynchronizationContext</code> ูุน ุทุฑููุฉ <code>Post</code> ููุฌูุฑุฉ ุจุงููุซู "ุชูุฌู" ุงููููุถ ุฅูู ุฏูู ูุงุฌูุฉ ุงููุณุชุฎุฏู (ุจุงุณุชุฎุฏุงู <code>Dispatcher.BeginInvoke</code> ) ุ ูุน ุชุญูู WPF Dispatcher ุ ูููุณ ุงูุชุญูู ูู ููุงุฐุฌ Windows. <br><br>  ููุญุชูู Windows RunTime (WinRT) ุนูู <a href="" rel="nofollow">ููุน</a> ูุดุชู ูู <code>SynchronizationContext</code> ุ ูุงูุฐู ูุถุน ุงููููุถ ุฃูุถูุง ูู <code>CoreDispatcher</code> ูุคุดุฑ ุชุฑุงุจุท ูุงุฌูุฉ ุงููุณุชุฎุฏู ุจุงุณุชุฎุฏุงู <code>CoreDispatcher</code> . <br><br>  ูุฐุง ูู ูุง ูููู ูุฑุงุก ุนุจุงุฑุฉ "ุชุดุบูู ุงููููุถ ูู ููุถูุน ูุงุฌูุฉ ุงููุณุชุฎุฏู".  ููููู ุฃูุถูุง ุชุทุจูู <code>SynchronizationContext</code> ุจุงุณุชุฎุฏุงู ุทุฑููุฉ <code>Post</code> ูุจุนุถ ุงูุชูููุฐ.  ุนูู ุณุจูู ุงููุซุงู ุ ูุง ุฏุงุนู ููููู ุจุดุฃู ูุคุดุฑ ุงูุชุฑุงุจุท ุงูุฐู ูุนูู ุนููู ุงููููุถ ุ ููููู ุฃุฑูุฏ ุฃู ุฃุชุฃูุฏ ูู ุฃู ุฃู ุทุฑููุฉ <code>Post</code> ุชูููุถ ูู <code>SynchronizationContext</code> ุชุนูู ูุน ุฏุฑุฌุฉ ูุญุฏูุฏุฉ ูู ุงูุชูุงุฒู.  ููููู ุชุทุจูู <code>SynchronizationContext</code> ูุฎุตุต ุจูุฐู ุงูุทุฑููุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">internal</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MaxConcurrencySynchronizationContext</span></span> : <span class="hljs-title"><span class="hljs-title">SynchronizationContext</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> SemaphoreSlim _semaphore; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MaxConcurrencySynchronizationContext</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> maxConcurrencyLevel</span></span></span><span class="hljs-function">)</span></span> =&gt; _semaphore = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SemaphoreSlim(maxConcurrencyLevel); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Post</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">SendOrPostCallback d, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> state</span></span></span><span class="hljs-function">)</span></span> =&gt; _semaphore.WaitAsync().ContinueWith(<span class="hljs-keyword"><span class="hljs-keyword">delegate</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { d(state); } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { _semaphore.Release(); } }, <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>, TaskContinuationOptions.None, TaskScheduler.Default); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Send</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">SendOrPostCallback d, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> state</span></span></span><span class="hljs-function">)</span></span> { _semaphore.Wait(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { d(state); } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { _semaphore.Release(); } } }</code> </pre> <br>  ูุญุชูู ุฅุทุงุฑ ุนูู xUnit ุนูู <a href="" rel="nofollow">ุชุทุจูู</a> ููุงุซู <a href="" rel="nofollow">ูู</a> SynchronizationContext.  ููุง ูุชู ุงุณุชุฎุฏุงูู ูุชูููู ููุฏุงุฑ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงููุฑุชุจุทุฉ ุงูุงุฎุชุจุงุฑุงุช ุงููุชูุงุฒูุฉ. <br><br>  ุงููุฒุงูุง ููุง ูู ููุณูุง ููุง ูู ุงูุญุงู ูุน ุฃู ุชุฌุฑูุฏ: ูุชู ุชูููุฑ ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช ูุงุญุฏุฉ ูููู ุงุณุชุฎุฏุงููุง ูู ูุงุฆูุฉ ุงูุชุธุงุฑ ุงููููุถ ููุชูููุฐ ุจุงูุทุฑููุฉ ุงูุชู ูุฑุบุจ ูููุง ุงููุจุฑูุฌ ุ ุฏูู ุงูุญุงุฌุฉ ุฅูู ูุนุฑูุฉ ุชูุงุตูู ุงูุชูููุฐ.  ูููุชุฑุถ ุฃููู ุฃูุชุจ ููุชุจุฉ ุญูุซ ุฃุญุชุงุฌ ุฅูู ุงูููุงู ุจุจุนุถ ุงูุฃุนูุงู ุซู ุงูุงูุชุธุงุฑ ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ูุฑุฉ ุฃุฎุฑู ุฅูู ุงูุณูุงู ุงูุฃุตูู.  ููููุงู ุจุฐูู ุ ุฃุญุชุงุฌ ุฅูู ุงูุชูุงุท <code>SynchronizationContext</code> ุงูุฎุงุต ุจู ุ ูุนูุฏูุง ุฃููู ูุง ููุฒู ุ ุณุฃููู ูุถุทุฑูุง ููุท ูุงุณุชุฏุนุงุก ุทุฑููุฉ <code>Post</code> ุงูุฎุงุตุฉ ุจูุฐุง ุงูุณูุงู ูุชูุฑูุฑู ููููุถ ููุชูููุฐ.  ูุณุช ุจุญุงุฌุฉ ุฅูู ูุนุฑูุฉ ุฃูู ุจุงููุณุจุฉ ูููุงุฐุฌ Windows ุ ููุฒูู <code>Control</code> ูุงุณุชุฎุฏุงู <code>BeginInvoke</code> ุ ุฃู WPF ุงุณุชุฎุฏู <code>BeginInvoke</code> ูู <code>Dispatcher</code> ุ ุฃู ุจุทุฑููุฉ ูุง ุงูุญุตูู ุนูู ุงูุณูุงู ููุงุฆูุฉ ุงูุงูุชุธุงุฑ ูู xUnit.  ูู ูุง ุฃุญุชุงุฌ ุฅููู ูู ุงูุงุณุชููุงุก ุนูู <code>SynchronizationContext</code> ุงูุญุงูู ูุงุณุชุฎุฏุงูู ูุงุญููุง.  ููููุงู ุจุฐูู ุ ูุญุชูู <code>SynchronizationContext</code> ุนูู ุฎุงุตูุฉ <code>Current</code> .  ูุฐุง ูููู ุชูููุฐู ุนูู ุงููุญู ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DoWork</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Action worker, Action completion</span></span></span><span class="hljs-function">)</span></span> { SynchronizationContext sc = SynchronizationContext.Current; ThreadPool.QueueUserWorkItem(_ =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { worker(); } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { sc.Post(_ =&gt; completion(), <span class="hljs-literal"><span class="hljs-literal">null</span></span>); } }); }</code> </pre> <br>  ููููู ุชุนููู ุณูุงู ุฎุงุต ูู ุงูุฎุงุตูุฉ <code>Current</code> ุจุงุณุชุฎุฏุงู ุงูุฃุณููุจ <code>SynchronizationContext.SetSynchronizationContext</code> . <br><br><h3 style=";text-align:right;direction:rtl">  ูุง ูู ุจุฑูุงูุฌ ุฌุฏููุฉ ุงูููุงูุ </h3><br>  <code>SynchronizationContext</code> ุนุจุงุฑุฉ ุนู ุชุฌุฑูุฏ ุดุงุฆุน ูู "ุงููุฌุฏูู".  ุจุนุถ ุงูุฃุทุฑ ุชุณุชุฎุฏู ุงูุชุฌุฑูุฏุงุช ุงูุฎุงุตุฉ ุจูุง ูุฐูู ุ ู <code>System.Threading.Tasks</code> ููุณุช ุงุณุชุซูุงุก.  ุนูุฏูุง ูููู ููุงู ูููุถูู ูู <code>Task</code> ุงูุชู ูููู ูุถุนูุง ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ูุชูููุฐูุง ุ ูุฅููุง ุชุฑุชุจุท ูุน <code>System.Threading.Tasks.TaskScheduler</code> .  ููุงู ุฃูุถูุง ุทุฑููุฉ <code>Post</code> ุงูุชุฑุงุถูุฉ <code>TaskScheduler</code> ุงูุชุธุงุฑ ุงููููุถ (ูุชู ุชูููุฐ ุงุณุชุฏุนุงุก ุงููููุถ ุจุงุณุชุฎุฏุงู ุงูุขููุงุช ุงูููุงุณูุฉ) ุ ููููุฑ <code>QueueTask</code> ุทุฑููุฉ <code>QueueTask</code> ูุฌุฑุฏุฉ (ูุชู ุชูููุฐ ุงุณุชุฏุนุงุก ูููุฉ ุจุงุณุชุฎุฏุงู ุฃุณููุจ <code>ExecuteTask</code> ). <br><br>  ุงููุฌุฏูู ุงูุงูุชุฑุงุถู ุงูุฐู ูููู ุจุฅุฑุฌุงุน <code>TaskScheduler.Default</code> ูู ุชุฌูุน <code>TaskScheduler.Default</code> ุชุฑุงุจุท.  ูู <code>TaskScheduler</code> ูู ุงููููู ุฃูุถูุง ุงูุญุตูู ุนูู ุฃุณุงููุจ <code>TaskScheduler</code> ูุชุญุฏูุฏ ููุช ูููุงู ุงุณุชุฏุนุงุก <code>Task</code> .  ุนูู ุณุจูู ุงููุซุงู ุ ุชุชุถูู ุงูููุชุจุงุช ุงูุฃุณุงุณูุฉ ููุน <code>System.Threading.Tasks.ConcurrentExclusiveSchedulerPair</code> .  ูููุฑ ูุซูู ูุฐู ุงููุฆุฉ <code>TaskScheduler</code> ุฎุตุงุฆุต <code>TaskScheduler</code> : <code>ExclusiveScheduler</code> ู <code>ConcurrentScheduler</code> .  ูููู ุชูููุฐ ุงูููุงู ุงููุฌุฏููุฉ ูู <code>ConcurrentScheduler</code> ุจุดูู ูุชูุงุฒู ุ ูููู ูุน ูุฑุงุนุงุฉ ุงูุชูููุฏ ุงูุฐู ุชู ุชุนูููู ุจูุงุณุทุฉ <code>ConcurrentExclusiveSchedulerPair</code> ุนูุฏ ุฅูุดุงุฆู (ูุดุงุจู ูู <code>MaxConcurrencySynchronizationContext</code> ).  ูู ูุชู ุชูููุฐ ุฃู ูููุฉ <code>ConcurrentScheduler</code> ุฅุฐุง ุชู ุชูููุฐ ุงููููุฉ ูู <code>ExclusiveScheduler</code> ููู ูุณูุญ ุฅูุง ููููุฉ ุญุตุฑูุฉ ูุงุญุฏุฉ ุจุงูุนูู ูู ููุช ูุงุญุฏ.  ูุฐุง ุงูุณููู ูุดุงุจู ุฌุฏูุง ูููู ุงููุฑุงุกุฉ / ุงููุชุงุจุฉ. <br><br>  ูุซู <code>SynchronizationContext</code> ุ ูุญุชูู <code>TaskScheduler</code> ุนูู ุฎุงุตูุฉ <code>Current</code> ุชููู ุจุฅุฑุฌุงุน <code>TaskScheduler</code> ุงูุญุงูู.  ููุน ุฐูู ุ ุจุฎูุงู <code>SynchronizationContext</code> ุ ูุฅูู ููุชูุฑ ุฅูู ุทุฑููุฉ ูุชุนููู ุงููุฌุฏูู ุงูุญุงูู.  ุจุฏูุงู ูู ุฐูู ุ ูุฑุชุจุท ุจุฑูุงูุฌ ุงูุฌุฏููุฉ ุจุงููููุฉ ุงูุญุงููุฉ.  ูุฐูู ุ ุนูู ุณุจูู ุงููุซุงู ุ ุณูุนุฑุถ ูุฐุง ุงูุจุฑูุงูุฌ <code>True</code> ุ ุญูุซ ูุชู ุชูููุฐ lambda ุงููุณุชุฎุฏูุฉ ูู <code>StartNew</code> ูู ูุซูู <code>ExclusiveScheduler</code> ูู <code>ConcurrentExclusiveSchedulerPair</code> ุ <code>TaskScheduler.Current</code> ุชุซุจูุช <code>TaskScheduler.Current</code> ุนูู ูุฐุง ุงููุฌุฏูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Threading.Tasks; <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cesp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConcurrentExclusiveSchedulerPair(); Task.Factory.StartNew(() =&gt; { Console.WriteLine(TaskScheduler.Current == cesp.ExclusiveScheduler); }, <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>, TaskCreationOptions.None, cesp.ExclusiveScheduler).Wait(); } }</code> </pre> <br>  ููู ุงููุซูุฑ ููุงูุชูุงู ุ ุฃู <code>TaskScheduler</code> ูููุฑ ุฃุณููุจ <code>FromCurrentSynchronizationContext</code> ุซุงุจุช.  ุชููู ุงูุทุฑููุฉ ุจุฅูุดุงุก <code>TaskScheduler</code> ุฌุฏูุฏุฉ <code>TaskScheduler</code> ุงูููุงู ููุชูููุฐ ูู ุณูุงู <code>SynchronizationContext.Current</code> ุงููุฑุชุฌุน ุจุงุณุชุฎุฏุงู ุฃุณููุจ <code>Post</code> . <br><br><h3 style=";text-align:right;direction:rtl">  ููู ูู SynchronizationContext ู TaskScheduler ุงููุชุนููุฉ ุงูุชุธุงุฑุ </h3><br>  ูููุชุฑุถ ุฃูู ุจุญุงุฌุฉ ุฅูู ูุชุงุจุฉ ุชุทุจูู ูุงุฌูุฉ ุงููุณุชุฎุฏู ุจุงุณุชุฎุฏุงู ุฒุฑ.  ูุคุฏู ุงูุถุบุท ุนูู ุงูุฒุฑ ุฅูู ุจุฏุก ุชูุฒูู ุงููุต ูู ูููุน ุงูููุจ ูุชุนูููู ุนูู ุฒุฑ <code>Content</code> .  ูุฌุจ ุฃู ูููู ุงูุฒุฑ ูุชุงุญูุง ููุท ูู ูุงุฌูุฉ ุงููุณุชุฎุฏู ููุฏูู ุงูุฐู ููุน ููู ุ ูุจุงูุชุงูู ุ ุนูุฏูุง ูููู ุจุชุญููู ุงูุชุงุฑูุฎ ูุงูููุช ุจูุฌุงุญ ููุฑูุฏ ูุถุนููุง ูู <code>Content</code> ุงูุฒุฑ ุ ูุญุชุงุฌ ุฅูู ุงูููุงู ุจุฐูู ูู ุงูุฏูู ุงูุฐู ูุชุญูู ููู.  ุฅุฐุง ูู ูุชุญูู ูุฐุง ุงูุดุฑุท ุ ูุณูุญุตู ุนูู ุงุณุชุซูุงุก: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">System.InvalidOperationException: <span class="hljs-string"><span class="hljs-string">'        ,     .'</span></span></code> </pre><br>  ูููููุง ุงุณุชุฎุฏุงู <code>SynchronizationContext</code> ูุฏูููุง ูุชุนููู <code>Content</code> ูู ุณูุงู ุงููุตุฏุฑ ุ ุนูู ุณุจูู ุงููุซุงู ุนุจุฑ <code>TaskScheduler</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> HttpClient s_httpClient = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpClient(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">downloadBtn_Click</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, RoutedEventArgs e</span></span></span><span class="hljs-function">)</span></span> { s_httpClient.GetStringAsync(<span class="hljs-string"><span class="hljs-string">"http://example.com/currenttime"</span></span>).ContinueWith(downloadTask =&gt; { downloadBtn.Content = downloadTask.Result; }, TaskScheduler.FromCurrentSynchronizationContext()); }</code> </pre> <br>  ููููููุง ุงุณุชุฎุฏุงู <code>SynchronizationContext</code> ูุจุงุดุฑุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> HttpClient s_httpClient = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpClient(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">downloadBtn_Click</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, RoutedEventArgs e</span></span></span><span class="hljs-function">)</span></span> { SynchronizationContext sc = SynchronizationContext.Current; s_httpClient.GetStringAsync(<span class="hljs-string"><span class="hljs-string">"http://example.com/currenttime"</span></span>).ContinueWith(downloadTask =&gt; { sc.Post(<span class="hljs-keyword"><span class="hljs-keyword">delegate</span></span> { downloadBtn.Content = downloadTask.Result; }, <span class="hljs-literal"><span class="hljs-literal">null</span></span>); }); }</code> </pre> <br>  ููุน ุฐูู ุ ูุณุชุฎุฏู ููุง ุงูุฎูุงุฑูู ุจุดูู ุตุฑูุญ ุฑุฏ ุงุชุตุงู.  ุจุฏูุงู ูู ุฐูู ุ ูููููุง ุงุณุชุฎุฏุงู <code>async</code> / <code>await</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> HttpClient s_httpClient = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpClient(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">downloadBtn_Click</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, RoutedEventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> text = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> s_httpClient.GetStringAsync(<span class="hljs-string"><span class="hljs-string">"http://example.com/currenttime"</span></span>); downloadBtn.Content = text; }</code> </pre> <br>  ูู ูุฐุง "ูุนูู ููุท" ููููู ุจุชูููู <code>Content</code> ุจูุฌุงุญ ูู ูุคุดุฑ ุชุฑุงุจุท ูุงุฌูุฉ ุงููุณุชุฎุฏู ุ ูุฃูู ูู ุญุงูุฉ ุงูุฅุตุฏุงุฑ ุงูุฐู ุชู ุชูููุฐู ูุฏูููุง ุฃุนูุงู ุ ูุดูุฑ ุงูุชุธุงุฑ ุงููููุฉ ุงูุชุฑุงุถููุง ุฅูู <code>SynchronizationContext.Current</code> ู <code>TaskScheduler.Current</code> .  ุนูุฏูุง "ุชุชููุน" ุดูุฆูุง ูุง ูู C # ุ ูููู ุงููุญูู ุงูุจุฑูุฌู ุจุชุญููู ุฑูุฒ ุงูุงุณุชูุตุงุก (ุนู ุทุฑูู ุงุณุชุฏุนุงุก <code>GetAwaiter</code> ) "ุงููุชููุน" (ูู ูุฐู ุงูุญุงูุฉ ุ ุงููููุฉ) ุฅูู "ุงูุชุธุงุฑ" ( <code>TaskAwaiter</code> ).  ูููู "ุงูุชุธุงุฑ" ูุณุคููุงู ุนู ุฅุฑูุงู ุฑุฏ ุงุชุตุงู (ููุทูู ุนููู ุบุงูุจูุง "ุงุณุชูุฑุงุฑ") ูุงูุฐู ูุนูุฏ ุฅูู ุฌูุงุฒ ุงูุญุงูุฉ ุนูุฏ ุงูุชูุงู ุงูุงูุชุธุงุฑ.  ูููู ุจุชูููุฐ ุฐูู ุจุงุณุชุฎุฏุงู ุงูุณูุงู / ุงููุฌุฏูู ุงูุฐู ุณุฌูู ุฃุซูุงุก ุชุณุฌูู ุฑุฏ ุงูุงุชุตุงู.  ุณูููู ุจุชุญุณูู ูุชูููู ุจุนุถ ุงูุดูุก ุ ุฅูู ุดูุก ูุซู ูุฐุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">object</span></span> scheduler = SynchronizationContext.Current; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (scheduler <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; TaskScheduler.Current != TaskScheduler.Default) { scheduler = TaskScheduler.Current; }</code> </pre> <br>  ููุง ุ ูุชู ุชุญุฏูุฏ ูุง ุฅุฐุง ูุงู <code>SynchronizationContext</code> <code>TaskScheduler</code> ุฃู ูุง ุ ููุง ุฅุฐุง ูุงู ููุงู <code>TaskScheduler</code> ุบูุฑ ููุงุณู.  ุฅุฐุง ูุงู ููุงู ูุงุญุฏ ุ ูุนูุฏูุง ูููู ุฑุฏ ุงูุงุชุตุงู ุฌุงูุฒูุง ููููุงููุฉ ุ ูุณูุชู ุงุณุชุฎุฏุงู ุงููุฌุฏูู ุงูุฐู ุชู ุงูุชูุงุทู ุ  ุฅุฐุง ูู ููู ุงูุฃูุฑ ูุฐูู ุ ูุณูุชู ุชูููุฐ ุฑุฏ ุงูุงุชุตุงู ูุฌุฒุก ูู ุงูุนูููุฉ ุงูุชู ุชููู ุงููููุฉ ุงููุชููุนุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  ูุงุฐุง ุชูุนู ConfigureAwait (ุฎุทุฃ) </h3><br>  ุทุฑููุฉ <code>ConfigureAwait</code> ููุณุช ุฎุงุตุฉ: ูู ูุชู ุงูุชุนุฑู ุนูููุง ุจุฃู ุทุฑููุฉ ูุนููุฉ ูู ูุจู ุงููุชุฑุฌู ุฃู ููุช ุงูุชุดุบูู.  ูุฐู ุทุฑููุฉ ุนุงุฏูุฉ ุชููู ุจุฅุฑุฌุงุน ุจููุฉ ( <code>ConfiguredTaskAwaitable</code> - ููุชู ุงููููุฉ ุงูุฃุตููุฉ) ูุชุชุฎุฐ ูููุฉ ููุทููุฉ.  ุชุฐูุฑ ุฃูู ูููู ุงุณุชุฎุฏุงู <code>await</code> ูุน ุฃู ููุน ูููู ุจุชูููุฐ ุงููููุฐุฌ ุงูุตุญูุญ.  ุฅุฐุง ุชู ุฅุฑุฌุงุน ููุน ุขุฎุฑ ุ ููุฐุง ูุนูู ุฃูู ุนูุฏูุง ูุญุตู ุงููุชุฑุฌู ุนูู ุทุฑููุฉ <code>GetAwaiter</code> (ุฌุฒุก ูู ุงููููุฐุฌ) ูู ุงููุซููุงุช ุ ูููู ููุนู ุฐูู ูู ุงูููุน ุงูุฐู ุชู ุฅุฑุฌุงุนู ูู <code>ConfigureAwait</code> ุ ูููุณ ูู ุงููููุฉ ูุจุงุดุฑุฉ.  ูุฐุง ูุณูุญ ูู ุจุชุบููุฑ ุณููู <code>await</code> ูุฐุง ุงูุงูุชุธุงุฑ ุงูุฎุงุต. <br><br>  ุงูุชุธุงุฑ ุงูููุน ุงูุฐู ูุชู ุฅุฑุฌุงุนู ุจูุงุณุทุฉ <code>ConfigureAwait(continueOnCapturedContext: false)</code> ุจุฏูุงู ูู ุงูุชุธุงุฑ <code>Task</code> ูุคุซุฑ ูุจุงุดุฑุฉ ุนูู ุชุทุจูู ุงูุชูุงุท ุงูุณูุงู / ุงููุฌุฏูู ุงูููุถุญ ุฃุนูุงู.  ูุตุจุญ ุงูููุทู ุดูุฆูุง ูุซู ูุฐุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">object</span></span> scheduler = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (continueOnCapturedContext) { scheduler = SynchronizationContext.Current; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (scheduler <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; TaskScheduler.Current != TaskScheduler.Default) { scheduler = TaskScheduler.Current; } }</code> </pre> <br>  ุจูุนูู ุขุฎุฑ ุ ูุนูู ุชุญุฏูุฏ <code>false</code> ุ ุญุชู ุฅุฐุง ูุงู ููุงู ุณูุงู ุฃู ุจุฑูุงูุฌ ุฌุฏููุฉ ุญุงูููู ูุฑุฏ ุงูุงุชุตุงู ุ ุฃูู ุบุงุฆุจ. <br><br><h3 style=";text-align:right;direction:rtl">  ููุงุฐุง ุฃุญุชุงุฌ ุฅูู ุงุณุชุฎุฏุงู ConfigureAwait (ุฎุทุฃ)ุ </h3><br>  <code>ConfigureAwait(continueOnCapturedContext: false)</code> ูููุน ูุฑุถ ูุนุงูุฏุฉ ุงูุงุชุตุงู ูู ุณูุงู ุงููุตุฏุฑ ุฃู ุงููุฌุฏูู ุงููุตุฏุฑ.  ูุฐุง ูุนุทููุง ุงูุนุฏูุฏ ูู ุงููุฒุงูุง: <br><br>  <b>ุชุญุณูู ุงูุฃุฏุงุก.</b>  ููุงู ููุฏุงุฑ ูุจูุฑ ูู ุงูุงูุชุธุงุฑ ูู ูุงุฆูุฉ ุงูุชุธุงุฑ ูุงุณุชุฏุนุงุก ุ ุนูู ุนูุณ ุงูุงุชุตุงู ููุท ุ ูุฃู ูุฐุง ูุชุทูุจ ุนูู ุฅุถุงูู (ูุชุฎุตูุต ุฅุถุงูู ุนุงุฏุฉ).  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุง ูููููุง ุงุณุชุฎุฏุงู ุงูุชุญุณูู ูู ููุช ุงูุชุดุบูู (ูููููุง ุชุญุณูู ุฃูุซุฑ ุนูุฏูุง ูุนุฑู ุจุงูุถุจุท ููู ุณูุชู ุงุณุชุฏุนุงุก ุฑุฏ ุงูุงุชุตุงู ุ ูููู ุฅุฐุง ุชู ูููู ุฅูู ุชูููุฐ ุชุนุณูู ููุชุฌุฑูุฏ ุ ูุฅู ูุฐุง ููุฑุถ ูููุฏูุง ูู ุจุนุถ ุงูุฃุญูุงู).  ุจุงููุณุจุฉ ููุฃูุณุงู ุงููุญููุฉ ุจูุซุงูุฉ ุ ูููู ุฃู ุชุฒูุฏ ุงูุชูุงููู ุงูุฅุถุงููุฉ ููุชุญูู ูู <code>SynchronizationContext</code> ุงูุญุงูู ู <code>TaskScheduler</code> ุงูุญุงูู (ููุงููุง ููุทูู ุนูู ุงููุตูู ุฅูู ุงูุชุฏููุงุช ุงูุซุงุจุชุฉ) ุจุดูู ูุจูุฑ.  ุฅุฐุง ูุงูุช ุงูุชุนูููุฉ ุงูุจุฑูุฌูุฉ ุจุนุฏ <code>await</code> ูุง ุชุชุทูุจ ุงูุชูููุฐ ูู ุงูุณูุงู ุงูุฃุตูู ุ ุจุงุณุชุฎุฏุงู <code>ConfigureAwait(false)</code> ุ ูููู ุชุฌูุจ ูู ูุฐู ุงููููุงุช ุ ูุธุฑูุง ูุฃูู ูุง ูุญุชุงุฌ ุฅูู ูุถุน ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุฏูู ุฏุงุน ุ ูููููู ุงุณุชุฎุฏุงู ุฌููุน ุงูุชุญุณููุงุช ุงููุชุงุญุฉ ุ ููุง ููููู ุชุฌูุจ ุงููุตูู ุบูุฑ ุงูุถุฑูุฑู ุฅูู ุฅุญุตุงุฆูุงุช ุงูุชุฏูู. <br><br>  <b>ููุน ุงูุฌููุฏ.</b>  ููุฑ ูู ุทุฑููุฉ ุงูููุชุจุฉ ุงูุชู <code>await</code> ุงุณุชุฎุฏุงููุง ูุชูุฒูู ุดูุก ูู ุงูุดุจูุฉ.  ููููู ุงุณุชุฏุนุงุก ูุฐู ุงูุทุฑููุฉ ูุญุธุฑูุง ุจุดูู ูุชุฒุงูู ุ ูู ุงูุชุธุงุฑ ุฅููุงู ุงููููุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ ุจุงุณุชุฎุฏุงู <code>.Wait()</code> ุฃู <code>.Result</code> ุฃู <code>.GetAwaiter()</code> <code>.GetResult()</code> .  ุงูุขู ุ ุถุน ูู ุงุนุชุจุงุฑู ูุง ูุญุฏุซ ูู ุญุงูุฉ ุญุฏูุซ ุงูููุงููุฉ ุนูุฏูุง ูุญุฏุฏ <code>SynchronizationContext</code> ุงูุญุงูู ุนุฏุฏ ุงูุนูููุงุช ููู ุฅูู 1 ุจุงุณุชุฎุฏุงู <code>MaxConcurrencySynchronizationContext</code> ุจุดูู ุตุฑูุญ ุ ุฃู ุถููููุง ุ ุฅุฐุง ูุงู ุณูุงููุง ุจุงุณุชุฎุฏุงู ูุคุดุฑ ุชุฑุงุจุท ูุงุญุฏ ูุงุณุชุฎุฏุงูู (ุนูู ุณุจูู ุงููุซุงู ุ ูุคุดุฑ ุชุฑุงุจุท ูุงุฌูุฉ ุงููุณุชุฎุฏู).  ูุจุงูุชุงูู ุ ููููู ุงุณุชุฏุนุงุก ุงูุฃุณููุจ ูู ูุคุดุฑ ุชุฑุงุจุท ูุงุญุฏ ุ ุซู ุญุธุฑู ุ ูู ุงูุชุธุงุฑ ุงูุชูุงู ุงูุนูููุฉ.  ูุจุฏุฃ ุงูุชูุฒูู ุนุจุฑ ุงูุดุจูุฉ ูููุชุธุฑ ุงุณุชููุงูู.  ุจุดูู ุงูุชุฑุงุถู ุ <code>Task</code> ุงูุชุธุงุฑ <code>Task</code> ุงูุชูุงุท <code>SynchronizationContext</code> ุงูุญุงูู (ููู ูุฐู ุงูุญุงูุฉ) ุ ูุนูุฏ ุงูุชูุงู ุงูุชูุฒูู ูู ุงูุดุจูุฉ ุ ุณูุชู ูุถุนู ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ูุฑุฉ ุฃุฎุฑู ูู ุฑุฏ ุงูุงุชุตุงู <code>SynchronizationContext</code> ุ ูุงูุฐู ุณูู ูุณุชุฏุนู ุจุงูู ุงูุนูููุฉ.  ูููู ูุคุดุฑ ุงูุชุฑุงุจุท ุงููุญูุฏ ุงูุฐู ููููู ุงูุชุนุงูู ูุน ุฑุฏ ุงูุงุชุตุงู ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ูุญุธูุฑ ุญุงูููุง ุฃุซูุงุก ุงูุชุธุงุฑ ุงูุชูุงู ุงูุนูููุฉ.  ููู ุชูุชูู ูุฐู ุงูุนูููุฉ ุญุชู ุชุชู ูุนุงูุฌุฉ ุฑุฏ ุงูุงุชุตุงู.  ุทุฑูู ูุณุฏูุฏ!  ูููู ุฃู ูุญุฏุซ ุญุชู ุนูุฏูุง ูุง ููุชุตุฑ ุงูุณูุงู ุนูู ุงูุชุฒุงูู ุนูู 1 ุ ูููู ุงูููุงุฑุฏ ูุญุฏูุฏุฉ ุจุทุฑููุฉ ุฃู ุจุฃุฎุฑู.  ุชุฎูู ุงููููู ููุณู ุ ููุท ุจูููุฉ 4 ูู <code>MaxConcurrencySynchronizationContext</code> .  ุจุฏูุงู ูู ุชูููุฐ ุงูุนูููุฉ ูุฑุฉ ูุงุญุฏุฉ ุ ูุญู ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ 4 ููุงููุงุช ุฅูู ุงูุณูุงู.  ูุชู ุฅุฌุฑุงุก ูู ููุงููุฉ ูุฃููุงู ุชุญุณุจุง ูุงุณุชููุงููุง.  ูุชู ุงูุขู ุญุธุฑ ุฌููุน ุงูููุงุฑุฏ ุงูุชุธุงุฑูุง ูุงุณุชููุงู ุงูุฃุณุงููุจ ุบูุฑ ุงููุชุฒุงููุฉ ุ ูุงูุดูุก ุงููุญูุฏ ุงูุฐู ุณูุณูุญ ููุง ุจุงูุฅููุงู ูู ุฅุฐุง ุชูุช ูุนุงูุฌุฉ ุนูููุงุช ุงูุงุณุชุฑุฌุงุนุงุช ุงูุฎุงุตุฉ ุจูู ุจูุงุณุทุฉ ูุฐุง ุงูุณูุงู.  ููุน ุฐูู ุ ููู ุจุงููุนู ูุดุบููุฉ ุจุงููุงูู.  ุญุงูุฉ ุชููู ุชุงู ูุฑุฉ ุฃุฎุฑู.  ุฅุฐุง ูุงูุช ุทุฑููุฉ ุงูููุชุจุฉ ุชุณุชุฎุฏู <code>ConfigureAwait(false)</code> ุจุฏูุงู ูู ุฐูู ุ ููู ุชุถุน ูุงุฆูุฉ ุงูุชุธุงุฑ ูู ุฑุฏ ุงูุงุชุตุงู ูู ุงูุณูุงู ุงูุฃุตูู ุ ููุง ูุคุฏู ุฅูู ุชุฌูุจ ุงูุจุฑุงูุฌ ุงููุตูุฉ ูุญุงูุฉ ุชููู ุชุงู. <br><br><h3 style=";text-align:right;direction:rtl">  ูู ุฃุญุชุงุฌ ุฅูู ุงุณุชุฎุฏุงู ConfigureAwait (ุตูุงุจ)ุ </h3><br>  ูุง ุ ูุง ูู ุชูู ุจุญุงุฌุฉ ุฅูู ุงูุฅุดุงุฑุฉ ุตุฑุงุญุฉ ุฅูู ุฃูู ูุง ุชุณุชุฎุฏู <code>ConfigureAwait(false)</code> (ุนูู ุณุจูู ุงููุซุงู ุ ูุฅุฎูุงุก ุชุญุฐูุฑุงุช ุงูุชุญููู ุงูุซุงุจุช ุ ููุง ุฅูู ุฐูู).  <code>ConfigureAwait(true)</code> ูุง ููุนู ุดูุฆูุง ููููุง.  ุฅุฐุง ูุงุฑูุช <code>await task</code> <code>await task.ConfigureAwait(true)</code> ุ ูุณุชููู ูุชุทุงุจูุฉ ูุธููููุง.  ูุจุงูุชุงูู ุ ุฅุฐุง ูุงู <code>ConfigureAwait(true)</code> ููุฌูุฏูุง ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุ ููููู ุญุฐูู ุฏูู ุฃู ุนูุงูุจ ุณูุจูุฉ. <br><br>  ุชุฃุฎุฐ ุทุฑููุฉ <code>ConfigureAwait</code> ูููุฉ ููุทููุฉ ุ ุญูุซ ูุฏ ุชุญุชุงุฌ ูู ุจุนุถ ุงูุญุงูุงุช ุฅูู ุชูุฑูุฑ ูุชุบูุฑ ููุชุญูู ูู ุงูุชูููู.  ูููู ูู 99ูช ูู ุงูุญุงูุงุช ุ ูุชู ุชุนููู ุงููููุฉ ุนูู "ุฎุทุฃ" ุ <code>ConfigureAwait(false)</code> . <br><br><h3 style=";text-align:right;direction:rtl">  ูุชู ูุฌุจ ุงุณุชุฎุฏุงู ConfigureAwait (ุฎุทุฃ)ุ </h3><br>  ูุนุชูุฏ ุฐูู ุนูู ูุง ุฅุฐุง ููุช ุชููู ุจุชุทุจูู ุฑูุฒ ูุณุชูู ุงูุชุทุจูู ุฃู ุฑูุฒ ููุชุจุฉ ููุฃุบุฑุงุถ ุงูุนุงูุฉ. <br><br>  ุนูุฏ ูุชุงุจุฉ ุงูุชุทุจููุงุช ุ ุนุงุฏุฉ ูุง ุชููู ููุงู ุญุงุฌุฉ ุฅูู ุจุนุถ ุงูุณููู ุงูุงูุชุฑุงุถู.  ุฅุฐุง ูุงู ุทุฑุงุฒ / ุจูุฆุฉ ุงูุชุทุจูู (ุนูู ุณุจูู ุงููุซุงู ุ Windows Forms ู WPF ู ASP.NET Core) ุจูุดุฑ <code>SynchronizationContext</code> ุฎุงุต ุ ููู ุงููุคูุฏ ุฃู ููุงู ุณุจุจ ูุฌูู ูุฐูู: ููุฐุง ูุนูู ุฃู ุงูููุฏ ูุณูุญ ูู ุจุงูุงูุชูุงู ุจุณูุงู ุงููุฒุงููุฉ ููุชูุงุนู ุงูููุงุณุจ ูุน ุทุฑุงุฒ / ุจูุฆุฉ ุงูุชุทุจูู.  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ูุชุจุช ูุนุงูุฌ ุฃุญุฏุงุซ ูู ุฃุญุฏ ุชุทุจููุงุช Windows Forms ุ ุฃู ุงุฎุชุจุงุฑูุง ูู xUnit ุ ุฃู ุฑูุฒูุง ูู ูุญุฏุฉ ุชุญูู ASP.NET MVC ุ ุจุบุถ ุงููุธุฑ ุนูุง ุฅุฐุง ูุงู ุทุฑุงุฒ ุงูุชุทุจูู ูุฏ ูุดุฑ <code>SynchronizationContext</code> ุ ูุฃูุช ุจุญุงุฌุฉ ุฅูู ุงุณุชุฎุฏุงู <code>SynchronizationContext</code> ุญุงูุฉ ูุฌูุฏู.  ูุฐุง ูุนูู ุฃูู ุฅุฐุง ุชู ุงุณุชุฎุฏุงู ูู ูู <code>ConfigureAwait(true)</code> <code>await</code> ุ ููุชู ุฅุนุงุฏุฉ ุนูููุงุช ุงูุงุณุชุฑุฌุงุนุงุช / ุงูุงุณุชุฌุงุจุงุช ุฅูู ุงูุณูุงู ุงูุฃุตูู - ูู ุดูุก ูุณูุฑ ููุง ููุจุบู.  ูู ููุง ููููู ุตูุงุบุฉ ูุงุนุฏุฉ ุนุงูุฉ: <b>ุฅุฐุง ูุชุจุช ุฑูุฒ ูุณุชูู ุงูุชุทุจูู ุ <i>ููุง ุชุณุชุฎุฏู</i> <code>ConfigureAwait(false)</code></b> .  ุฏุนูุง ูุนูุฏ ุฅูู ูุนุงูุฌ ุงูููุฑุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> HttpClient s_httpClient = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpClient(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">downloadBtn_Click</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, RoutedEventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> text = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> s_httpClient.GetStringAsync(<span class="hljs-string"><span class="hljs-string">"http://example.com/currenttime"</span></span>); downloadBtn.Content = text; }</code> </pre> <br>  <code>downloadBtn.Content = text</code> ูุฌุจ ุชูููุฐ <code>downloadBtn.Content = text</code> ูู ุงูุณูุงู ุงูุฃุตูู.  ุฅุฐุง ุงูุชููุช ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูุฐู ุงููุงุนุฏุฉ ูุงุณุชุฎุฏูุช <code>ConfigureAwait (false)</code> ุจุฏูุงู ูู ุฐูู ุ ููู ูุชู ุงุณุชุฎุฏุงููุง ูู ุงูุณูุงู ุงูุฃุตูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> HttpClient s_httpClient = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpClient(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">downloadBtn_Click</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, RoutedEventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> text = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> s_httpClient.GetStringAsync(<span class="hljs-string"><span class="hljs-string">"http://example.com/currenttime"</span></span>).ConfigureAwait(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  downloadBtn.Content = text; }</span></span></code> </pre> <br>  ูุฐุง ุณูู ูุคุฏู ุฅูู ุณููู ุบูุฑ ูุงุฆู.  ุงูุฃูุฑ ููุณู ููุทุจู ุนูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูู ุชุทุจูู ASP.NET ููุงุณููู ูุนุชูุฏ ุนูู <code>HttpContext.Current</code> .  ุนูุฏ ุงุณุชุฎุฏุงู <code>ConfigureAwait(false)</code> ุงููุญุชูู ุฃู ุชุคุฏู ูุญุงููุฉ ูุงุญูุฉ ูุงุณุชุฎุฏุงู ุฏุงูุฉ <code>Context.Current</code> ุฅูู ุญุฏูุซ ูุดููุงุช. <br><br>  ูุฐุง ูู ูุง ูููุฒ ุงูููุชุจุงุช ุงูุนุงูุฉ ุงูุบุฑุถ.  ุฅููุง ุนุงูููุฉ ุจุดูู ุฌุฒุฆู ูุฃููุง ูุง ุชูุชู ุจุงูุจูุฆุฉ ุงูุชู ูุชู ุงุณุชุฎุฏุงููุง ูููุง.  ููููู ุงุณุชุฎุฏุงููุง ูู ุชุทุจูู ููุจ ุฃู ูู ุชุทุจูู ุนููู ุฃู ูู ุงุฎุชุจุงุฑ - ูุง ููู ุ ูุธุฑูุง ูุฃู ุฑูุฒ ุงูููุชุจุฉ ุบูุฑ ููุงุฆู ูุทุฑุงุฒ ุงูุชุทุจูู ุงูุฐู ูููู ุงุณุชุฎุฏุงูู ููู.  ูุนูู Agnostic ุฃูุถูุง ุฃู ุงูููุชุจุฉ ูู ุชูุนู ุฃู ุดูุก ููุชูุงุนู ูุน ุทุฑุงุฒ ุงูุชุทุจูู ุ ุนูู ุณุจูู ุงููุซุงู ุ ูู ุชุชููู ูู ุงููุตูู ุฅูู ุนูุงุตุฑ ุชุญูู ูุงุฌูุฉ ุงููุณุชุฎุฏู ุ ูุฃู ููุชุจุฉ ุงูุฃุบุฑุงุถ ุงูุนุงูุฉ ูุง ุชุนุฑู ุดูุฆูุง ุนููุง.  ูุธุฑูุง ูุนุฏู ูุฌูุฏ ุญุงุฌุฉ ุฅูู ุชุดุบูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูู ุฃู ุจูุฆุฉ ูุนููุฉ ุ ูููููุง ุชุฌูุจ ูุฑุถ ุงูุงุณุชูุฑุงุฑูุฉ / ุนูููุงุช ุงูุงุณุชุฑุฌุงุนุงุช ุนูู ุงูุณูุงู ุงูุฃุตูู ุ ููููู ุจุฐูู ุจุงุณุชุฎุฏุงู <code>ConfigureAwait(false)</code> ุ ููุง ูููุญูุง ูุฒุงูุง ุฃุฏุงุก ููุฒูุฏ ูู ุงูููุซูููุฉ.  ูุคุฏู ุจูุง ุฐูู ุฅูู ูุง ููู: <b>ุฅุฐุง ููุช ุชูุชุจ ุฑูุฒ ููุชุจุฉ ููุฃุบุฑุงุถ ุงูุนุงูุฉ ุ ูุงุณุชุฎุฏู <code>ConfigureAwait(false)</code></b> .  ูุฐุง ูู ุงูุณุจุจ ูู ุฃู ูู (ุฃู ูู ุดูุก ุชูุฑูุจูุง) ูู ููุชุจุงุช ููุช ุชุดุบูู .NET Core ุชุณุชุฎุฏู ConfigureAwait (false) ุ  ูุน ุจุนุถ ุงูุงุณุชุซูุงุกุงุช ุ ูุงูุชู ูู ุงููุญุชูู ุฃู ุชููู ุฃุฎุทุงุก ุ ุณูุชู ุฅุตูุงุญูุง. , <a href="https://github.com/dotnet/corefx/pull/38610" rel="nofollow"> PR</a>    <code>ConfigureAwait(false)</code>  <code>HttpClient</code> . <br><br>      . ,     (,   , ,   )      ,     API,     .   ,         ,       โ "  . , ,    Where LINQ: <code>public static async IAsyncEnumerable&lt;T&gt; WhereAsync(this IAsyncEnumerable&lt;T&gt; source, Func&lt;T, bool&gt; predicate)</code> .   <code>predicate</code>    <code>SynchronizationContext</code>  ?     <code>WhereAsync</code> ,   ,        <code>ConfigureAwait(false)</code> . <br><br>       :  <code>ConfigureAwait(false)</code>      /app-model-agnostic . <br><br><h3 style=";text-align:right;direction:rtl">   ConfigureAwait (false),         ? </h3><br> ,  ,          .    ,    <code>await</code>      .    ,      ,      . ,    ,      ,   ,   <code>ConfigureAwait(false)</code> ,            ,     . <br><br><h3 style=";text-align:right;direction:rtl">    ConfigureAwait (false)       ,    โ ? </h3><br>  , .   FAQ.  <code>await task.ConfigureAwait(false)</code>  ,       (      ),   <code>ConfigureAwait(false)</code>  ,           -    ,    . <br><br>     ,   <code>await</code>    ,         ,    <code>SynchronizationContext</code>  <code>TaskScheduler</code> . , <code>CryptoStream</code>     .NET ,                 .      <code><a href="" rel="nofollow">awaiter</a></code> ,  ,          .       ,   await -  <code>ConfigureAwait(false)</code> ;     ,      ,     ,     <code>ConfigureAwait(false)</code> . <br><br><h3 style=";text-align:right;direction:rtl">    Task.Run,    ConfigureAwait (false)? </h3><br> ,   : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">Task.Run(<span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-keyword"><span class="hljs-keyword">delegate</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> SomethingAsync(); <span class="hljs-comment"><span class="hljs-comment">//     });</span></span></code> </pre> <br>  <code>ConfigureAwait(false)</code>  <code>SomethingAsync()</code>  ,   ,   <code>Task.Run</code>      ,       , <code>SynchronizationContext.Current</code>   <code>null</code> .  , <code>Task.Run</code>   <code>TaskScheduler.Default</code> ,  <code>TaskScheduler.Current</code>      <code>Default</code> .  ,  <code>await</code>        ,    <code>ConfigureAwait(false)</code> .        ,       .     : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">Task.Run(<span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-keyword"><span class="hljs-keyword">delegate</span></span> { SynchronizationContext.SetSynchronizationContext(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SomeCoolSyncCtx()); <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> SomethingAsync(); <span class="hljs-comment"><span class="hljs-comment">//    SomeCoolSyncCtx });</span></span></code> </pre> <br>    <code>SomethingAsync</code>   <code>SynchronizationContext.Current</code>  <code>SomeCoolSyncCtx</code> .   <code>await</code> ,       SomethingAsync     .  ,    ,  ,        ,     ,       . <br><br>        /     .         /      . <br><br>    ,        ,  ,     . ,       ,    <code>ConfigureAwait(false)</code> <a href="https://docs.microsoft.com/en-us/visualstudio/code-quality/ca2007%3Fview%3Dvs-2019" rel="nofollow">CA2007</a> .    ,         <code>ConfigureAwait</code> ,   ,    .        , ,      -  ,            ,       <code>ConfigureAwait(false)</code> . <br><br><h3 style=";text-align:right;direction:rtl">    SynchronizationContext.SetSynchronizationContext,    ConfigureAwait (false)? </h3><br>  ูุง. , .      <br><br>    : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">Task t; SynchronizationContext old = SynchronizationContext.Current; SynchronizationContext.SetSynchronizationContext(<span class="hljs-literal"><span class="hljs-literal">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { t = CallCodeThatUsesAwaitAsync(); <span class="hljs-comment"><span class="hljs-comment">// await'      } finally { SynchronizationContext.SetSynchronizationContext(old); } await t; //  -    </span></span></code> </pre> <br><br>  ,      <code>CallCodeThatUsesAwaitAsync</code>     <code>null</code> .   .       ,  <code>await</code>  <code>TaskScheduler.Current</code> .       <code>TaskScheduler</code> , <code>await</code> '  <code>CallCodeThatUsesAwaitAsync</code>          <code>TaskScheduler</code> . <br><br>    <code>Task.Run</code> FAQ,      :     ,     <code>try</code>     ,    (       ). <br><br>          : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">SynchronizationContext old = SynchronizationContext.Current; SynchronizationContext.SetSynchronizationContext(<span class="hljs-literal"><span class="hljs-literal">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> t; } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { SynchronizationContext.SetSynchronizationContext(old); }</code> </pre><br>    ?   ,   .  ,       /   .  ,   <code>SynchronizationContext</code>        ,     ,          .   ,    ,    ,  ,            .        ,    ,          .       ,       .  ู ููุฐุง.    . <br><br><h3 style=";text-align:right;direction:rtl">    ConfigureAwait(false)    GetAwaiter ().GetResult ()? </h3><br>  ูุง. <code>ConfigureAwait</code>   .  ,  <code>awaiter</code> ,  <code>awaiter</code> '   <code>IsCompleted</code> ,  <code>GetResult</code>  <code>OnCompleted</code> (   UnsafeOnCompleted). <code>ConfigureAwait</code>     <code>{Unsafe}OnCompleted</code> ,       <code>GetResult()</code> ,       <code>TaskAwaiter</code>  <code>ConfiguredTaskAwaitable.ConfiguredTaskAwaiter</code>    .     <code>task.ConfigureAwait(false).GetAwaiter().GetResult()</code>      <code>task.GetAwaiter().GetResult()</code> (  ,       ). <br><br><h3 style=";text-align:right;direction:rtl">  ,     ,       SynchronizationContext   TaskScheduler.     ConfigureAwait(false)? </h3><br>  ุฑุจูุง.    ,      ยซยป.     ,  ,   ,    ,    <code>SynchronizationContext</code>        <code>TaskScheduler</code> ,  ,         .       ,     ,    . <br><br><h3 style=";text-align:right;direction:rtl">  ,   .NET Core    ConfigureAwait (false).   ? </h3><br>  ููุณ ููุฐุง.      .NET Core    ,      .NET Framework.      . <br><br>  ,      <code>SynchronizationContext</code> .  ,      ASP.NET  .NET Framework   <code><a href="" rel="nofollow">SynchronizationContext</a></code> ,  ASP.NET Core  .  ,  ,    ASP.NET Core       <code>SynchronizationContext</code> ,     <code>ConfigureAwait(false)</code>   . <br><br>    ,       <code>SynchronizationContext</code>  <code>TaskScheduler</code> .  -   (   ,  )             ,     ,  <code>await</code> '  ASP.NET Core      ,       <code>ConfigureAwait(false)</code> . ,  ,      (       -)             ,      <code>ConfigureAwait(false)</code> . <br><br><h3 style=";text-align:right;direction:rtl">     ConfigureAwait,  ยซ  foreachยป  IAsyncEnumerable? </h3><br>  ูุนู.  .  <a href="https://docs.microsoft.com/en-us/archive/msdn-magazine/2019/november/csharp-iterating-with-async-enumerables-in-csharp-8" rel="nofollow"> MSDN</a> . <br><br> <code>Await foreach</code>   ,  ,      <code>IAsyncEnumerable&lt;T&gt;</code> .       ,     API.    .NET   <a href="" rel="nofollow"></a> <code>ConfigureAwait</code>  <code>IAsyncEnumerable&lt;T&gt;</code> ,    ,   <code>IAsyncEnumerable&lt;T&gt;</code>  <code>Boolean</code>    .      <code>MoveNextAsync</code>  <code>DisposeAsync</code> .         ,    ,    . <br><br><h3 style=";text-align:right;direction:rtl">    ConfigureAwait,  'await using' IAsyncDisposable? </h3><br> ,     . <br><br>    <code>IAsyncEnumerable&lt;T&gt;</code> , .NET       <code>ConfigureAwait</code>  <code>IAsyncDisposable</code>  <code>await using</code> ,   ,      ( ,    <code>DisposeAsync</code> ): <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> c = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MyAsyncDisposableClass().ConfigureAwait(<span class="hljs-literal"><span class="hljs-literal">false</span></span>)) { ... }</code> </pre> <br>     ,   <code>c</code> โ   <code>MyAsyncDisposableClass</code> ,   <code>System.Runtime.CompilerServices.ConfiguredAsyncDisposable</code> ,      <code>ConfigureAwait</code>  <code>IAsyncDisposable</code> . <br><br>   ,   : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> c = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MyAsyncDisposableClass(); <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (c.ConfigureAwait(<span class="hljs-literal"><span class="hljs-literal">false</span></span>)) { ... }</code> </pre> <br>   <code>c</code>    <code>MyAsyncDisposableClass</code> .         <code>c</code> ;  ,        . <br><br><h3 style=";text-align:right;direction:rtl">   ConfigureAwait (false),   AsyncLocal       .  ? </h3><br> ,   .   <code>AsyncLocal&lt;T&gt;</code>   <code>ExecutionContext</code> ,    <code>SynchronizationContext</code> .       <code>ExecutionContext</code>   <code>ExecutionContext.SuppressFlow()</code> , <code>ExecutionContext</code> (,  ,  <code>AsyncLocal &lt;T&gt;</code> )     <code>awaits</code> ,   ,   <code>ConfigureAwait</code>     <code>SynchronizationContext</code> .      <a href="https://devblogs.microsoft.com/pfxteam/executioncontext-vs-synchronizationcontext/" rel="nofollow"></a> . <br><br><h3 style=";text-align:right;direction:rtl">           ConfigureAwait(false)   ? </h3><br>        <code>ConfigureAwait(false)</code>     . <br><br>     ,   ,     // .      ,    , : <a href="https://github.com/dotnet/csharplang/issues/645" rel="nofollow">1</a> , <a href="https://github.com/dotnet/csharplang/issues/2542" rel="nofollow">2</a> , <a href="https://github.com/dotnet/csharplang/issues/2649" rel="nofollow">3</a> , <a href="https://github.com/dotnet/csharplang/issues/2746" rel="nofollow">4</a> . <br><br>     ,        ,  <a href="https://devblogs.microsoft.com/dotnet/configureawait-faq/" rel="nofollow"> </a>    . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar482354/">https://habr.com/ru/post/ar482354/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar482340/index.html">ูู Junior'a ุฅูู Middle'a: ุงููุญูู ุงููุบูู</a></li>
<li><a href="../ar482344/index.html">ุงุญุตู ุนูู ุงุณุชุนุฏุงุฏ ูุฅุฏุฎุงู ุงูุชุตููู ุงูุงุฌุชูุงุนู ูู ุฑูุณูุง</a></li>
<li><a href="../ar482346/index.html">ASP.NET MVC - ุงูุนูู ูุน MySQL ูู ุฎูุงู ADO.NET</a></li>
<li><a href="../ar482348/index.html">ุงูุทูุจูููุฌูุง ูุงูุชุญููู ุงูุดุงูู ููุทูุฑ ุงูุฃูุนุงุจ ุงููุทูุฆู: ุถุบุท ุงููุชุฌูุงุช ุซูุงุซูุฉ ุงูุฃุจุนุงุฏ ุงููุฑุฏูุฉ</a></li>
<li><a href="../ar482352/index.html">ููุง ุฑููุช ุชูุฑูุจุง 150K ูู ููุจ ุงูุฑูุญ ุฃู ุชุงุฑูุฎ ุชุฑููุจ ุงูุชูููุฉ ุงููุณุฑูุฉ ูู ุงูุดูุฉ</a></li>
<li><a href="../ar482356/index.html">ุงุณุชุฎุฏุงู Windows Server ุฏูู ุงููุณุชูุดู ูู ูุฌูุฉ ูุธุฑ ูุณุชุฎุฏู Windows ุงูุนุงุฏู</a></li>
<li><a href="../ar482360/index.html">ุงููุจุงุญุซ ูุจุฑุง: ูู ุฃุตุฏูุงุก ูุน ุงูุฃุฌุณุงู ุงูุบุฑูุจุฉ</a></li>
<li><a href="../ar482362/index.html">ุดุจู ููุถู: ุชุงุฑูุฎ ููุฌุฒ ูููุฏูููุช ุ ูุดุฑูุน ูุง ููุชู ุจุงูููุฒ ุนูู ุงูุฅูุชุฑูุช</a></li>
<li><a href="../ar482364/index.html">ุงูุฃุดูุงุก ุงูุชู ุฑุจูุง ูู ุชุนุฑููุง ุนู ุฌุงูุง</a></li>
<li><a href="../ar482366/index.html">ูุงุฐุง ุฎุจุฑุงุก ุงูุณูุงุฑุงุช ุงูุฑูุจูุชูุฉ ุชููุฑ ูู ุชุณูุง ุงูุทูุงุฑ ุงูุขูู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>