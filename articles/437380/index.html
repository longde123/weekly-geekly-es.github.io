<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üê∑ üë®üèº‚Äç‚öïÔ∏è ‚è© Todos rega√±an los marcos de prueba auto-escritos. Y estamos contentos con nuestro ‚ùå üìõ üç™</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mi nombre es Elena Rastorgueva, soy responsable del producto Factor en HFLabs . El Factor es una empresa algor√≠tmica muy compleja; procesa datos a esc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Todos rega√±an los marcos de prueba auto-escritos. Y estamos contentos con nuestro</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/hflabs/blog/437380/"><img src="https://habrastorage.org/webt/nt/p-/0f/ntp-0fxrjpsarus7awbwtsdgdhu.jpeg"><br><br>  Mi nombre es Elena Rastorgueva, soy responsable del producto Factor en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">HFLabs</a> .  El Factor es una empresa algor√≠tmica muy compleja; procesa datos a escala industrial. <br><br>  En el art√≠culo, le contar√© c√≥mo comenzamos a probar el "Factor", c√≥mo se desarrollaron las pruebas autom√°ticas y por qu√© llegamos a los marcos autoescritos. <br><a name="habracut"></a><br><h2>  ¬øQu√© tipo de producto es este? </h2><br>  "Factor" limpia datos en bases de datos con millones de clientes: elimina errores tipogr√°ficos en el nombre, tel√©fono y correo electr√≥nico, revisa pasaportes, hace mucho m√°s.  Lo m√°s dif√≠cil es corregir las direcciones de correo. <br><br><img src="https://habrastorage.org/webt/sc/le/g8/scleg8hmrcclix90ouwukypheke.png"><br>  <sub>Las direcciones se escriben de cientos de maneras, por lo que el Factor tiene un fuerte aparato algor√≠tmico bajo el cap√≥</sub> <br><br>  "Factor" funciona como un servicio: datos de entrada - datos de salida. <br><br>  Este es un sistema sin estado donde cada llamada es independiente de las anteriores.  Sin estado simplifica enormemente la vida del probador.  Es mucho m√°s dif√≠cil probar un sistema con estado cuando una secuencia de acciones es importante. <br><br>  El producto debe ser confiable como ISS, ya que es utilizado por bancos, operadores m√≥viles, seguros y minoristas del nivel Lenta.  Respondemos por errores con la cabeza en la medida en que la ausencia de errores sea parte del SLA en el contrato con el cliente. <br><br>  Debido a los requisitos de confiabilidad de las pruebas autom√°ticas, escribimos desde el comienzo del desarrollo.  Uno de los criterios para la preparaci√≥n de la tarea es "Pruebas autom√°ticas agregadas". <br><br><h2>  Comenz√≥ con comprobaciones manuales y pruebas autom√°ticas </h2><br>  Lanzamos el Factor en 2005 y primero lo probamos con nuestras manos.  Por la ma√±ana, el probador realiz√≥ pruebas autom√°ticas en un archivo con casos y compar√≥ el resultado del procesamiento de datos con el resultado del d√≠a anterior: lo que cambi√≥ despu√©s de la confirmaci√≥n del c√≥digo de ayer. <br><br>  El proceso podr√≠a tomar medio d√≠a, esta alineaci√≥n no fue buena.  Por lo tanto, tomamos el conjunto m√≠nimo de pruebas para la funcionalidad clave y las incluimos en pruebas unitarias.  Estas pruebas son r√°pidas, y el desarrollador mismo las ejecut√≥ antes de comprometerse. <br><br>  Las pruebas unitarias son tan convenientes y tan r√°pidas que agregamos miles de ellas.  Y luego nos topamos con √©l: cuando las pruebas parecen una hoja de miles de piezas de c√≥digo, no es f√°cil incluso desplazarse al lugar correcto.  Sin mencionar agregar o actualizar. <br><br><img src="https://habrastorage.org/webt/vd/a5/ua/vda5uatnzsl6du95r_x_jjbpsle.png"><br>  <sub>Prueba unitaria para verificar el formato SNILS</sub> <br><br>  Adem√°s, algo inesperado aparece repentinamente en los datos industriales que no cubre las pruebas unitarias.  Por ejemplo, un nuevo cliente vino con nuevas funciones en las direcciones, las pruebas unitarias no cubren estas funciones.  Debe sentarse y ver qu√© pruebas agregar para obtener nuevos datos.  A√∫n lo hicimos manualmente. <br><br><h2>  Crea tu propio marco </h2><br>  En las pruebas unitarias tradicionales, los datos y el c√≥digo se mezclan; es dif√≠cil encontrar las partes correctas. <br><br>  Por lo tanto, probamos las <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">pruebas</a> autom√°ticas en el paradigma de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Pruebas</a> controladas por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">datos (DDT)</a> .  DDT es cuando los datos para la prueba se almacenan por separado del c√≥digo para la prueba. <br><br>  Los casos se cargaron desde un archivo de Excel, estaban en las columnas "Datos sin procesar" y "Resultado esperado".  El DDT fue un gran avance: la actualizaci√≥n de casos en el "exelnik" es inexpresablemente m√°s simple. <br><br>  Poco a poco, desarrollamos un enfoque y desarrollamos nuestro propio marco de prueba.  Recibe archivos de texto como entrada, dentro de ellos est√°n los datos de origen y el resultado esperado. <br><br><img src="https://habrastorage.org/webt/4z/ux/b2/4zuxb2hzdkjzampel0ioln9qksa.png"><br>  <sub>Nos negamos a los archivos de Excel como almacenamiento: los archivos de texto se abren m√°s r√°pido, no cambian los contenidos, es m√°s f√°cil recolectar datos</sub> <br><br>  El marco es ayudado por herramientas est√°ndar: <br><br><ul><li>  TeamCity ejecuta pruebas autom√°ticamente todas las noches; </li><li>  testNG compara los resultados esperados y reales. </li></ul><br><img src="https://habrastorage.org/webt/js/3p/3x/js3p3xatz9q9u7qhd1hk7ahinfq.png"><br>  <sub>Si el resultado es diferente al esperado, en TeamCity la prueba se sonroja.</sub>  <sub>Si todo est√° como deber√≠a, la prueba es verde</sub> <br><br><h2>  Modific√≥ el marco para usted </h2><br>  Han pasado 12 a√±os desde entonces.  Durante este tiempo, el marco se ha cubierto de capacidades que no est√°n en las soluciones est√°ndar. <br><br>  <b>Contabilizaci√≥n del estado de la tarea en Jira.</b>  HFLabs se adhiere a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Test Driven Development</a> : primero escribimos una prueba o agregamos casos de prueba para un nuevo comportamiento, y solo luego cambiamos la funcionalidad. <br><br>  Apagamos nuevos casos comentando la l√≠nea.  De lo contrario, primero cayeron e interfirieron, porque los casos agregaron caracter√≠sticas o correcciones de errores antes. <br><br>  Pero es posible que la tarea no pueda completar el caso de prueba correspondiente: el error resultar√° ser extremadamente raro o el cliente traer√° algo m√°s importante.  Algunas tareas se suspendieron durante meses con baja prioridad y se acumularon casos desconectados.  Al mismo tiempo, no est√° claro a qu√© tarea pertenece cada caso, si este caso se puede eliminar. <br><br>  Por lo tanto, agregamos un n√∫mero de tarea a los casos desconectados y arruinamos un poco la automatizaci√≥n.  Ahora todo funciona as√≠: <br><br><ul><li>  el caso de prueba se deshabilita al combinarlo con una tarea abierta en Jira; <br><br><img src="https://habrastorage.org/webt/ny/xd/rb/nyxdrbvmz4np0kkgjgn5srct-cw.png"><br>  <sub>Para adjuntar un caso a una tarea, escriba delante de √©l <i>#</i> y n√∫mero de tarea</sub> <br></li><li>  el marco ejecuta pruebas incluso en casos deshabilitados.  Pero ignora los bloqueos mientras la tarea est√° abierta en Jira; </li><li>  Tan pronto como se cierra la tarea, la prueba comienza a recaer en los casos adjuntos.  Esta es una se√±al: aprobaron la tarea, pero olvidaron encender los casos; </li><li>  Si de repente la prueba para el caso desconectado comenz√≥ a pasar con una tarea abierta, el marco tambi√©n informar√° sobre esto.  Quiz√°s sea hora de encender el caso o cerrar la tarea adjunta (adem√°s de actualizar las notas de la versi√≥n e informar a los clientes). <br><br><img src="https://habrastorage.org/webt/ah/eb/vt/ahebvthx1cfsge12a5ofyjms408.png"><br>  <sub>El marco dice que el caso desconectado est√° pasando.</sub>  <sub>Quiz√°s alguien corrigi√≥ el c√≥digo como parte de otra tarea, y ahora todo funciona</sub> <br></li></ul><br>  As√≠ que ahorramos TDD y derrotamos el olvido al gestionar casos de prueba. <br><br><img src="https://habrastorage.org/webt/8s/df/1w/8sdf1wf1xib-di08-upv-njfwd8.png"><br>  <sub>Documentamos todas las opciones con el estado de los casos de prueba y tareas relacionadas, para no olvidar</sub> <br><br>  <b>Actualizaci√≥n de casos de prueba en modo semiautom√°tico.</b>  Parece que si la prueba falla, busque un error en el c√≥digo.  Pero para nosotros este no es siempre el caso.  A veces sucede que los casos de prueba deben actualizarse, porque los requisitos para el resultado han cambiado. <br><br>  Por ejemplo, antes de que el cliente en la direcci√≥n autorizada quisiera "g.  Mosc√∫ "en un campo.  Ahora que ha cambiado la arquitectura de la base de datos, quiere la "ciudad" en un campo, "Mosc√∫" en otro.  Es hora de cambiar los casos de prueba. <br><br>  Para la prueba ca√≠da, TeamCity muestra la diferencia entre los resultados esperados y reales.  Anteriormente, copiamos esta diferencia y actualizamos los casos de prueba con nuestras manos.  Para cambios masivos, un evento muy costoso. <br><br><img src="https://habrastorage.org/webt/2g/cv/iu/2gcviu56ac4pgtbtb3me4k5cc_0.png"><br>  <sub>Un ejemplo vivo: ense√±amos "Factor" para determinar un pa√≠s por n√∫mero de tel√©fono, las pruebas en TeamCity cayeron.</sub>  <sub>Se puede tomar un nuevo punto de referencia del resultado real, pero lleva mucho tiempo</sub> <br><br>  Hicimos que el marco actualizara el punto de referencia en s√≠.  Para hacer esto, despu√©s de ejecutar las pruebas, reemplaza los resultados de limpieza esperados en el est√°ndar con los resultados reales donde no coincid√≠an.  El resultado se guarda en artefactos como un archivo de actualizaci√≥n de caso. <br><br><img src="https://habrastorage.org/webt/6e/ok/dp/6eokdpdk8hqlbsggw2e2zxsyxty.png"><br>  <sub>El primer archivo es un nuevo punto de referencia en el que el marco ha actualizado los resultados esperados.</sub>  <sub>Los archivos restantes son los datos de entrada, el est√°ndar anterior y los datos reales de los casos descartados.</sub> <br><br>  Con el nuevo punto de referencia, el probador actualiza los casos en tres pasos. <br><br><ol><li>  Descargue el archivo generado. </li><li>  Comprueba a trav√©s de cualquier herramienta de fusi√≥n qu√© cambios hay en el nuevo punto de referencia.  Deja solo lo necesario. </li><li>  Comprometerse </li></ol><br><img src="https://habrastorage.org/webt/wp/o8/xn/wpo8xnrbcyzdhqkbif0mafezhbs.png"><br>  <sub>El probador verifica si las actualizaciones en el nuevo est√°ndar son correctas y las confirma</sub> <br><br>  S√≠, si se actualiza sin pensar, nada bueno saldr√° de eso.  Pero existe el riesgo de una actualizaci√≥n irreflexiva cuando se trabaja manualmente. <br><br>  <b>Estabilizaci√≥n de datos de prueba con stubs.</b>  "Factor" devuelve datos procesados ‚Äã‚Äãen docenas de campos.  Hay un mont√≥n de componentes en una sola direcci√≥n: √≠ndice, regi√≥n, tipo de regi√≥n, tipo de ciudad, ciudad, tipo de calle, casa, edificio, edificio, apartamento.  Para ellos, el "Factor" atrapa IFTS, OKATO, OKTMO e incluso las peque√±as cosas.  Entonces, de una l√≠nea en la entrada se obtienen docenas de valores. <br><br>  No todos los campos del resultado deben verificarse con casos de prueba.  Por ejemplo, el reconocimiento de la misma direcci√≥n depende directamente del directorio de estado: FIAS.  Y en √©l los campos cambian regularmente, para nuestras tareas son completamente extra√±os.  La actualizaci√≥n de algunos c√≥digos CLADR para casas dej√≥ caer cientos de casos de prueba. <br><br>  Agregamos talones al resultado esperado cuando nos dimos cuenta de que est√°bamos perdiendo el tiempo analizando ca√≠das sin importancia. <br><br>  Cuando no es necesario verificar el campo, el probador escribe un s√≠mbolo en el resultado esperado: <i>$$ DNV $$</i> .  Cu√°ndo debe rellenarse el campo, pero el valor en s√≠ mismo no es importante: <i>$$ NE $$</i> . <br><br><img src="https://habrastorage.org/webt/ol/v6/e_/olv6e_wixlpjexljoquxpcgo4l8.png"><br>  <sub>El ID de FIAS siempre est√° en la direcci√≥n, por lo que lo verificamos en todas las pruebas.</sub>  <sub>Si el campo est√° vac√≠o, algo est√° mal.</sub>  <sub>Pero el √≠ndice puede no ser, por lo tanto, al verificar la ID de FIAS, ignoramos el √≠ndice</sub> <br><br>  Podr√≠a ir hacia otro lado y separar las pruebas: cada campo tiene el suyo.  Pero es dif√≠cil, porque no todo puede aislarse.  Por ejemplo, "ciudad" y "calle" son partes de una direcci√≥n y sin la otra no tienen sentido. <br><br><h2>  Un marco auto escrito es m√°s conveniente </h2><br>  Por lo tanto, no considero en absoluto crear mi propio marco como una tarea est√∫pida.  Si no hubi√©ramos creado nuestra propia herramienta, no habr√≠amos recibido tantas oportunidades nuevas y tanta flexibilidad. <br><br>  Desactivar el caso de texto por estado de la tarea, generar un nuevo punto de referencia y resguardos para el resultado son las cosas que nuestros evaluadores ahora piden en otros marcos.  Si tom√°ramos soluciones est√°ndar, nunca podr√≠amos hacerlo. <br><br>  <i>Si te gusta hacer cosas complejas en la empresa, ven a nosotros.</i>  <i>Ahora <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">estamos buscando un desarrollador de Java</a> , salario de 135 000 ‚ÇΩ sin impuesto sobre la renta personal.</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/437380/">https://habr.com/ru/post/437380/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../437368/index.html">MOSDROID # 15 F√≥sforo</a></li>
<li><a href="../437372/index.html">Tres trucos simples para reducir las im√°genes acoplables</a></li>
<li><a href="../437374/index.html">Los usuarios de Facebook alquilan sus cuentas con dinero y computadoras port√°tiles gratuitas</a></li>
<li><a href="../437376/index.html">Perversiones curiosas del mundo de TI - 2</a></li>
<li><a href="../437378/index.html">¬øQu√© es ARCore? Todo lo que necesitas saber</a></li>
<li><a href="../437382/index.html">Teor√≠a de los fuegos artificiales. Fantas√≠a cosmol√≥gica</a></li>
<li><a href="../437384/index.html">El Ministerio de Trabajo y Rostelecom no est√°n de acuerdo en evaluar la cantidad de funcionarios que recibir√°n tel√©fonos inteligentes en el sistema operativo local Sailfish</a></li>
<li><a href="../437386/index.html">Entrevistas - Look de entrevistador</a></li>
<li><a href="../437390/index.html">"Secretos" DPAPI. Mira el burro</a></li>
<li><a href="../437396/index.html">¬øPor qu√© CarPrice es impulsado por inteligencia artificial?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>