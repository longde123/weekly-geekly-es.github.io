<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨‍👧‍👧 🍪 🤜 Dua dalam satu: Wi-Fi memantau kualitas udara dan jam 🚙 😷 🧑🏻‍🤝‍🧑🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pada suatu waktu, saya menyukai monitor kualitas udara dari publikasi oleh Sergey Silnov, "Monitor udara rumah kompak (CO2, suhu, kelembaban, tekanan)...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Dua dalam satu: Wi-Fi memantau kualitas udara dan jam</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/442856/"><p>  Pada suatu waktu, saya menyukai monitor kualitas udara dari publikasi oleh Sergey Silnov, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">"Monitor udara rumah kompak (CO2, suhu, kelembaban, tekanan) dengan Wi-Fi dan antarmuka seluler"</a> . </p><br><p>  Di monitor kualitas udara (selanjutnya disebut monitor) dari proyek Sergey, informasi dari sensor suhu, kelembaban, tekanan, dan konten 2 di udara diproses oleh pengontrol ESP8266 dan ditampilkan pada layar monokrom dalam beberapa bingkai.  Selain itu, di monitor, melalui formulir di browser, kunci identifikasi layanan Blynk disimpan dalam memori ESP8266 dan data secara otomatis dikirim ke Blynk. </p><br><p>  Monitor memiliki satu masalah serius: monitor mati / hidup atau bahkan "berkedip" tegangan suplai monitor. </p><br><p>  Saya mengulangi proyek dengan perubahan kecil, dan untuk menghilangkan pembekuan monitor saya menambahkan daya alternatif ke sirkuit.  Sederhana seperti penggaruk: belitan relai berada di bawah tegangan adaptor AC / DC, dan kontak relai mengalihkan daya dari adaptor ke baterai ketika tegangan dalam jaringan 220V menghilang. </p><br><p>  Kesuksesan imajiner saya bertahan sampai pemadaman lama pertama di rumah (ini terjadi dengan kami).  Baterai murah habis sebelum tegangan muncul di outlet, dan saya kembali ke titik awal. </p><br><p>  Setelah menginjak penggaruknya sendiri, saya memutuskan untuk tidak mencari solusi sederhana. </p><a name="habracut"></a><br><p>  Perubahan / penambahan yang dibuat pada sketsa oleh S. Silnov: </p><br><ul><li>  Monitor secara otomatis menjadi offline 90 detik setelah mematikan dan menghidupkan kembali tegangan catu daya monitor, jika Wi-Fi tidak tersedia saat ini. </li><li>  Nilai suhu batas, kadar CO2, kelembaban udara, serta zona waktu dan musim dingin / musim panas dimasukkan ke dalam memori ESP8266, seperti kunci Blynk, dari formulir di browser. </li><li>  Perubahan nilai batas disederhanakan secara radikal.  Jika sebelumnya prosedur ini dilakukan melalui kompiler kode, sekarang cukup untuk mengubah catatan di salah satu bidang formulir dari "0" menjadi "1".  Pekerjaan ini telah menjadi layak bahkan untuk pengguna tingkat lanjut. </li><li>  Informasi tentang pengoperasian monitor ditampilkan pada layar warna 1,44 ", 128x128 dalam satu bingkai.  Output dari parameter udara di luar nilai batas ditampilkan dalam bingkai berwarna. </li><li>  Di monitor, indeks panas (humindex) dihitung dan ditampilkan di layar. </li><li>  Pemberitahuan dikirim dari monitor melalui email jika suhu, kandungan CO2 atau kelembaban udara di luar ambang batas yang ditetapkan oleh pengguna. </li><li>  Monitor dapat bekerja tanpa terhubung ke layanan Blynk dan alamat email. </li><li>  Jam analog real-time telah ditambahkan ke monitor, yang disinkronkan melalui Internet dengan server waktu yang tepat. </li></ul><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/dp/hc/ba/dphcba8d2lt2ihdpvatv2m_a0pu.gif"></div><br><p>  Ini adalah salah satu tugas yang belum terselesaikan dari proyek saya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">“Thermostat ruang Wi-Fi nirkabel yang dapat diprogram dengan monitor kualitas udara dan fungsi bermanfaat lainnya”</a> .  Saya memutuskan untuk meresmikan tugas ini sebagai artikel terpisah, karena saat ini banyak yang tertarik dengan kualitas udara di perumahan. </p><br><h2>  Majelis </h2><br><p>  Untuk merakit perangkat, Anda akan memerlukan komponen, daftar yang dan perkiraan biayanya dengan harga situs web <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">AliExpress</a> ditunjukkan pada tabel. </p><br><p></p><table border="1"><tbody><tr><td>  <strong>Komponen</strong> </td><td>  <strong>Harga ($)</strong> </td></tr><tr><td>  Papan Wi-Fi NodeMCU CP2102 ESP8266 </td><td>  2,53 </td></tr><tr><td>  Sensor suhu dan kelembaban DHT22 </td><td>  2,34 </td></tr><tr><td>  Sensor konten CO2 MH Z-19 </td><td>  18.50 </td></tr><tr><td>  Layar TFTLCD 1,44 "SPI 128x128 </td><td>  2.69 </td></tr><tr><td>  RTC DS3231 Watch </td><td>  1,00 </td></tr><tr><td>  Kabel perakitan, hal-hal sepele lainnya </td><td>  2,00 </td></tr><tr><td>  <strong><em>Total (kurang-lebih):</em></strong> </td><td>  <strong><em>30</em></strong> </td></tr></tbody></table><br><p>  Otak monitor adalah pengontrol ESP8266 di papan modul NodeMCU CP2102.  Ini menerima sinyal dari sensor, jam tangan dan menghasilkan sinyal kontrol layar, menyinkronkan jam, dan juga mengirim informasi ke Blynk dan email. </p><br><p> <a href=""><img src="https://habrastorage.org/webt/qw/zn/q7/qwznq7uggbl-1rmx1esmdtwpopg.png"></a> </p><br><p>  Sayangnya, saya tidak menemukan perpustakaan Fritzing untuk layar warna 1,44 ”, 128x128 dengan pinout 8-pin, sehingga layar memiliki layar 11-pin.  Saat memasang, perhatikan bukan pada lokasi output layar relatif terhadap yang lain, tetapi untuk beban fungsionalnya. </p><br><p>  Bagi mereka yang tidak suka membuat prototipe untuk diagram kabel, tabel koneksi: </p><br><p></p><table border="1"><tbody><tr><td>  <strong>NodeMCU (GPIO)</strong> </td><td>  <strong>Sensor pin</strong> </td></tr><tr><td>  D0 (GPIO 16) </td><td>  displ_1.44, CS </td></tr><tr><td>  D1 (GPIO 5) </td><td>  DS3231, SCL </td></tr><tr><td>  D2 (GPIO 4) </td><td>  DS3231, SDA </td></tr><tr><td>  D3 (GPIO 0) </td><td>  DHT22, DATA; </td></tr><tr><td>  D4 (GPIO 2) </td><td>  displ_1.44, A0 </td></tr><tr><td>  D5 (GPIO 14) </td><td>  displ_1.44, SCK </td></tr><tr><td>  D6 (GPIO 12) </td><td>  displ_1.44, RST </td></tr><tr><td>  D7 (GPIO 13) </td><td>  displ_1.44, SDA </td></tr><tr><td>  D8 (GPIO 15) </td><td>  GND </td></tr><tr><td>  Tx </td><td>  MH-Z19, Rx </td></tr><tr><td>  Rx </td><td>  MH-Z19, Tx </td></tr><tr><td>  Vin (5V) </td><td>  displ_1.44, Vcc;  DHT22;  Mh-z19 </td></tr><tr><td>  3.3V </td><td>  displ_1.44, LED;  DS3231, Vcc </td></tr><tr><td>  GND </td><td>  Sensor, GND </td></tr></tbody></table><br><p>  Jika Anda menggunakan baterai alih-alih baterai dalam modul arloji, jangan lupa memutus sirkuit pengisian daya baterai, jika tidak, baterai akan membengkak setelah beberapa minggu bekerja di bawah tegangan.  Dengan keakuratan jam berdaya otomatis 2 detik / tahun Anda dijamin. </p><br><p>  Tegangan monitor <em>5V</em> dapat disuplai dari port USB komputer dengan kabel <em>USB</em> standar <em>- microUSB</em> ke modul <em>NodeMCU esp12</em> . </p><br><p>  Sketsa monitor untuk memuat di ESP8266 berada di bawah spoiler. </p><br><p>  Untuk jaga-jaga, jangan terlalu malas untuk men-tweak driver I2C bawaan untuk inti Arduino ESP8266.  Instruksi ada di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . </p><br><div class="spoiler">  <b class="spoiler_title">monitor sketsa</b> <div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">/* *   :   Wi-Fi       * aqm_32F_14F_P */</span></span> <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;FS.h&gt; #include &lt;Arduino.h&gt; #include &lt;ESP8266WiFi.h&gt; //https://github.com/esp8266/Arduino // Wifi Manager #include &lt;DNSServer.h&gt; #include &lt;ESP8266WebServer.h&gt; #include &lt;WiFiManager.h&gt; //https://github.com/tzapu/WiFiManager //OLED #include &lt;SPI.h&gt; #include &lt;Adafruit_GFX.h&gt; #include &lt;TFT_ILI9163C.h&gt; //clock #include &lt;pgmspace.h&gt; #include &lt;TimeLib.h&gt; #include &lt;ESP8266WiFi.h&gt; #include &lt;WiFiUdp.h&gt; #include &lt;Wire.h&gt; #include &lt;RtcDS3231.h&gt; RtcDS3231&lt;TwoWire&gt; Rtc(Wire); #define countof(a) (sizeof(a) / sizeof(a[0])) //e-mail #include &lt;ESP8266WiFiMulti.h&gt; #include &lt;ESP8266HTTPClient.h&gt; #define USE_SERIAL Serial ESP8266WiFiMulti WiFiMulti; //e-mail, address char address[64] {"e-mail"}; // HTTP requests #include &lt;ESP8266HTTPClient.h&gt; // OTA updates #include &lt;ESP8266httpUpdate.h&gt; // Blynk #include &lt;BlynkSimpleEsp8266.h&gt; // Debounce #include &lt;Bounce2.h&gt; //https://github.com/thomasfredericks/Bounce2 // JSON #include &lt;ArduinoJson.h&gt; //https://github.com/bblanchon/ArduinoJson // Debounce interval in ms #define DEBOUNCE_INTERVAL 10 Bounce hwReset {Bounce()}; // Humidity/Temperature #include &lt;DHT.h&gt; #define DHTPIN 0 //D3 gpio0, DHT22 DATA #define DHTTYPE DHT22 // DHT 22 DHT dht(DHTPIN, DHTTYPE); // Blynk token char blynk_token[33] {"Blynk token"}; // Setup Wifi connection WiFiManager wifiManager; // Network credentials String ssid { "am180206" }; String pass { "vb654321" }; //flag for saving data bool shouldSaveConfig = false; // Sensors data float t {-100}, t_old{-100}; float hic {-1}, hic_old{-1}; int h {-1}, h_old{-1}; int co2 {-1}, co2_old{-1}; char Tmn[5]{}, Tmx[5]{}, Hmn[5]{}, Cmx[7]{}, tZ[5]{}, timeSW[4]{}, formFS[]{"0"}; //  t, h  co2, .  float Tmin, Tmax, Hmin, Cmax, tZone, timeSummerWinter, formatingFS; float trp = 0; int crbn, bl, ml=18000; int md; // : 1 - , 2 -  int blnk; // Color definitions #define BLACK 0x0000 #define BLUE 0x001F #define RED 0xF800 #define GREEN 0x07E0 #define CYAN 0x07FF #define MAGENTA 0xF81F #define YELLOW 0xFFE0 #define WHITE 0xFFFF #define GRAY 0x9999 #define __CS 16 //D0(gpio16)- CS(display) #define __DC 2 //D4 gpio2 - AO(display) #define __RST 12 // D6 gpio12 - RESET(display) //char datestring[20]; char time_r[9]; char date_r[12]; //analog clock uint16_t ccenterx = 64,ccentery = 70;//center x,y of the clock clock const uint16_t cradius = 40;//radius of the clock const float scosConst = 0.0174532925; float sx = 0, sy = 1, mx = 1, my = 0, hx = -1, hy = 0; float sdeg=0, mdeg=0, hdeg=0; uint16_t osx,osy,omx,omy,ohx,ohy; uint16_t x0 = 0, x1 = 0, yy0 = 0, yy1 = 0; //uint32_t targetTime = 0;// for next 1 second timeout uint8_t hh,mm,ss; //containers for current time TFT_ILI9163C display = TFT_ILI9163C(__CS, __DC, __RST); String utf8(String source) { int i,k; String target; unsigned char n; char m[2] = { '0', '\0' }; k = source.length(); i = 0; while (i &lt; k) { n = source[i]; i++; if (n &gt;= 0xC0) { switch (n) { case 0xD0: { n = source[i]; i++; if (n == 0x81) { n = 0xA8; break; } if (n &gt;= 0x90 &amp;&amp; n &lt;= 0xBF) n = n + 0x30; break; } case 0xD1: { n = source[i]; i++; if (n == 0x91) { n = 0xB8; break; } if (n &gt;= 0x80 &amp;&amp; n &lt;= 0x8F) n = n + 0x70; break; } } } m[0] = n; target = target + String(m); } return target; } // NTP Servers: //static const char ntpServerName[] = "us.pool.ntp.org"; static const char ntpServerName[] = "time.nist.gov"; //const int timeZone = 2; // , , , , ,  //const int timeSummer = 1; WiFiUDP Udp; unsigned int localPort = 2390; // local port to listen for UDP packets time_t getNtpTime(); void digitalClockDisplay(); void printDigits(int digits); void sendNTPpacket(IPAddress &amp;address); void readCO2(){ #define mySerial Serial static byte cmd[9] = {0xFF,0x01,0x86,0x00,0x00,0x00,0x00,0x00,0x79}; //  byte response[9]; byte crc = 0; while (mySerial.available())mySerial.read();//  UART   memset(response, 0, 9);//   mySerial.write(cmd,9);//    CO2 mySerial.readBytes(response, 9);// 9    //   crc = 0; for (int i = 1; i &lt;= 7; i++) { crc += response[i]; } crc = ((~crc)+1); { // CRC if ( !(response[0] == 0xFF &amp;&amp; response[1] == 0x86 &amp;&amp; response[8] == crc) ) { Serial.println("CRC error"); } else { //  CO2 co2 = (((unsigned int) response[2])&lt;&lt;8) + response[3]; Serial.println("CO2: " + String(co2) + "ppm"); } } } void sendMeasurements() { float t1 {-100}, hic1 {-1}; float h1 {-1}; // Temperature t1 = dht.readTemperature(); if ((t1 &gt; -1) and (t1 &lt; 100)) t = t1; Serial.println("T: " + String(t) + "*C"); // Humidity h1 = dht.readHumidity(); if ((h1 &gt; -1) and (h1 &lt; 100)) h = h1; Serial.println("H: " + String(h) + "%"); // Humindex hic1 = dht.computeHeatIndex(t, h, false); if (t &gt;= 21.0) hic = hic1; else hic = t; Serial.println("Ti: "+String(hic)+"*C"); // CO2 crbn++; if (crbn &gt; 110) {readCO2(); crbn = 0; Serial.println("CO2: " + String(co2) + "ppm"); } } void drawConnectionDetails() { display.clearScreen(); display.setTextSize(1); display.setCursor(12,24); display.setTextColor(WHITE); display.println(utf8("Connect to WiFi:")); display.setCursor(12,36); display.println(utf8("net: " + String(ssid))); display.setCursor(12,48); display.println(utf8("pass: " + String(pass))); display.setCursor(12,60); display.println(utf8("Open browser:")); display.setCursor(12,72); display.println(utf8("http://192.168.4.1")); display.setCursor(2,84); display.setTextColor(RED); display.println(utf8(" Enter your personal information!")); } void digitalClockDisplay() { // digital clock display of the time Serial.print(hour()); printDigits(minute()); printDigits(second()); Serial.print(" "); Serial.print(day()); Serial.print("."); Serial.print(month()); Serial.print("."); Serial.print(year()); Serial.println(); } void printDigits(int digits) { // utility for digital clock display: prints preceding colon and leading 0 Serial.print(":"); if (digits &lt; 10) Serial.print('0'); Serial.print(digits); } // NTP code const int NTP_PACKET_SIZE = 48; // NTP time is in the first 48 bytes of message byte packetBuffer[NTP_PACKET_SIZE]; //buffer to hold incoming &amp; outgoing packets time_t getNtpTime() { int tZoneI, timeSummerWinterI; tZoneI = (int)tZone; timeSummerWinterI = (int)timeSummerWinterI; IPAddress ntpServerIP; // NTP server's ip address while (Udp.parsePacket() &gt; 0) ; // discard any previously received packets Serial.println("Transmit NTP Request"); // get a random server from the pool WiFi.hostByName(ntpServerName, ntpServerIP); Serial.print(ntpServerName); Serial.print(": "); Serial.println(ntpServerIP); sendNTPpacket(ntpServerIP); uint32_t beginWait = millis(); while (millis() - beginWait &lt; 1500) { int size = Udp.parsePacket(); if (size &gt;= NTP_PACKET_SIZE) { Serial.println("Receive NTP Response"); Udp.read(packetBuffer, NTP_PACKET_SIZE); // read packet into the buffer unsigned long secsSince1900; // convert four bytes starting at location 40 to a long integer secsSince1900 = (unsigned long)packetBuffer[40] &lt;&lt; 24; secsSince1900 |= (unsigned long)packetBuffer[41] &lt;&lt; 16; secsSince1900 |= (unsigned long)packetBuffer[42] &lt;&lt; 8; secsSince1900 |= (unsigned long)packetBuffer[43]; return secsSince1900 - 2208988800UL + tZoneI * SECS_PER_HOUR + timeSummerWinterI * SECS_PER_HOUR; } } Serial.println("No NTP Response :-("); return 0; // return 0 if unable to get the time } // send an NTP request to the time server at the given address void sendNTPpacket(IPAddress &amp;address) { // set all bytes in the buffer to 0 memset(packetBuffer, 0, NTP_PACKET_SIZE); // Initialize values needed to form NTP request // (see URL above for details on the packets) packetBuffer[0] = 0b11100011; // LI, Version, Mode packetBuffer[1] = 0; // Stratum, or type of clock packetBuffer[2] = 6; // Polling Interval packetBuffer[3] = 0xEC; // Peer Clock Precision // 8 bytes of zero for Root Delay &amp; Root Dispersion packetBuffer[12] = 49; packetBuffer[13] = 0x4E; packetBuffer[14] = 49; packetBuffer[15] = 52; // all NTP fields have been given values, now // you can send a packet requesting a timestamp: Udp.beginPacket(address, 123); //NTP requests are to port 123 Udp.write(packetBuffer, NTP_PACKET_SIZE); Udp.endPacket(); } void draw(){ //temperature display.setTextSize(1); display.setCursor(1,6); display.setTextColor(CYAN); display.println(utf8("T: CO2:")); String t_p; t_p = String(t); char t_p_m [12]; t_p.toCharArray(t_p_m, 5); if (t != t_old) { display.fillRect(1,15,48,18,BLACK); display.setTextSize(2); display.setCursor(1,15); display.setTextColor(GREEN); if(t &lt; Tmin) display.setTextColor(RED); if(t &gt; Tmax) display.setTextColor(RED); if ((t &gt; -100) and (t &lt; 100)) display.println(utf8(String(t_p_m))); else display.println(utf8("----"));} //heat index display.setTextSize(1); display.setCursor(2,98); display.setTextColor(CYAN); display.println(utf8("H: Ti:")); String hic_p; hic_p = String(hic); char hic_p_m [12]; hic_p.toCharArray(t_p_m, 5); if (hic != hic_old) { display.fillRect(80,108,48,18,BLACK); display.setTextSize(2); display.setCursor(80,108); display.setTextColor(GREEN); // if(t &lt; Tmin) display.setTextColor(RED); if(hic &gt; 27.0) display.setTextColor(YELLOW); if(hic &gt; 31.0) display.setTextColor(RED); if ((hic &gt; 0) and (hic &lt; 100)) display.println(utf8(String(t_p_m))); else display.println(utf8("----"));} //CO2 if (co2 != co2_old) { display.fillRect(80,15,48,18,BLACK); display.setTextSize(2); display.setCursor(80,15); display.setTextColor(GREEN); if (co2 &gt; Cmax) display.setTextColor(RED); if (co2 &gt; 600) display.setTextColor(CYAN); if ((co2 &gt; -1) and (co2 &lt;= 2000)) display.println(utf8(String(co2))); else display.println(utf8("---")); } //humidity if (h != h_old) { display.fillRect(1,108,49,18,BLACK); display.setTextSize(2); display.setCursor(1,108); display.setTextColor(GREEN); if (h &lt; Hmin) display.setTextColor(RED); if (h &gt; 60) display.setTextColor(RED); if ((h &gt; -1) and (h &lt; 100)) display.println(utf8(String(h))); else display.println(utf8("--")); } //date if (hh==0) display.fillRect(28,1,60,10,BLACK); display.setCursor(28,1); display.setTextSize(1); display.setTextColor(CYAN); display.println(utf8(date_r)); //OFFLINE if (md == 2) { display.fillRect(106,44,18,8,RED); display.setCursor(106,44); display.setTextSize(1); display.setTextColor(CYAN); display.println(" A"); } //OFF BLYNK if (blnk == 1) { display.fillRect(106,44,18,8,RED); display.setCursor(106,44); display.setTextSize(1); display.setTextColor(CYAN); display.println(" B"); } } void synchronClockA() { Rtc.Begin(); Serial.print("IP number assigned by DHCP is "); Serial.println(WiFi.localIP()); Serial.println("Starting UDP"); Udp.begin(localPort); Serial.print("Local port: "); Serial.println(Udp.localPort()); Serial.println("waiting for sync"); setSyncProvider(getNtpTime); //setSyncInterval(300); if(timeStatus() != timeNotSet){ digitalClockDisplay(); Serial.println("here is another way to set rtc"); time_t t = now(); char date_0[12]; snprintf_P(date_0, countof(date_0), PSTR("%s %02u %04u"), monthShortStr(month(t)), day(t), year(t)); Serial.println(date_0); char time_0[9]; snprintf_P(time_0, countof(time_0), PSTR("%02u:%02u:%02u"), hour(t), minute(t), second(t)); Serial.println(time_0); Serial.println("Now its time to set up rtc"); RtcDateTime compiled = RtcDateTime(date_0, time_0); // printDateTime(compiled); Serial.println(""); if (!Rtc.IsDateTimeValid()) { // Common Cuases: // 1) first time you ran and the device wasn't running yet // 2) the battery on the device is low or even missing Serial.println("RTC lost confidence in the DateTime!"); // following line sets the RTC to the date &amp; time this sketch was compiled // it will also reset the valid flag internally unless the Rtc device is // having an issue } Rtc.SetDateTime(compiled); RtcDateTime now = Rtc.GetDateTime(); if (now &lt; compiled) { Serial.println("RTC is older than compile time! (Updating DateTime)"); Rtc.SetDateTime(compiled); } else if (now &gt; compiled) { Serial.println("RTC is newer than compile time. (this is expected)"); } else if (now == compiled) { Serial.println("RTC is the same as compile time! (not expected but all is fine)"); } // never assume the Rtc was last configured by you, so // just clear them to your needed state Rtc.Enable32kHzPin(false); Rtc.SetSquareWavePin(DS3231SquareWavePin_ModeNone); } } void synchronClock() { Rtc.Begin(); // WiFi.begin(lnet, key); wifiManager.autoConnect(ssid.c_str(), pass.c_str()); while (WiFi.status() != WL_CONNECTED) { delay(500); Serial.print("."); } Serial.println(" "); Serial.print("IP number assigned by DHCP is "); Serial.println(WiFi.localIP()); Serial.println("Starting UDP"); Udp.begin(localPort); Serial.print("Local port: "); Serial.println(Udp.localPort()); Serial.println("waiting for sync"); setSyncProvider(getNtpTime); if(timeStatus() != timeNotSet){ digitalClockDisplay(); Serial.println("here is another way to set rtc"); time_t t = now(); char date_0[12]; snprintf_P(date_0, countof(date_0), PSTR("%s %02u %04u"), monthShortStr(month(t)), day(t), year(t)); Serial.println(date_0); char time_0[9]; snprintf_P(time_0, countof(time_0), PSTR("%02u:%02u:%02u"), hour(t), minute(t), second(t)); Serial.println(time_0); Serial.println("Now its time to set up rtc"); RtcDateTime compiled = RtcDateTime(date_0, time_0); Serial.println(""); if (!Rtc.IsDateTimeValid()) { // Common Cuases: // 1) first time you ran and the device wasn't running yet // 2) the battery on the device is low or even missing Serial.println("RTC lost confidence in the DateTime!"); // following line sets the RTC to the date &amp; time this sketch was compiled // it will also reset the valid flag internally unless the Rtc device is // having an issue } Rtc.SetDateTime(compiled); RtcDateTime now = Rtc.GetDateTime(); if (now &lt; compiled) { Serial.println("RTC is older than compile time! (Updating DateTime)"); Rtc.SetDateTime(compiled); } else if (now &gt; compiled) { Serial.println("RTC is newer than compile time. (this is expected)"); } else if (now == compiled) { Serial.println("RTC is the same as compile time! (not expected but all is fine)"); } // never assume the Rtc was last configured by you, so // just clear them to your needed state Rtc.Enable32kHzPin(false); Rtc.SetSquareWavePin(DS3231SquareWavePin_ModeNone); } } void Clock(){ RtcDateTime now = Rtc.GetDateTime(); //Print RTC time to Serial Monitor hh = now.Hour(); mm = now.Minute(); ss = now.Second(); sprintf(date_r, "%d.%d.%d", now.Day(), now.Month(), now.Year()); if (mm &lt; 10) sprintf(time_r, "%d:0%d", hh, mm); else sprintf(time_r, "%d:%d", hh, mm); Serial.println(date_r); Serial.println(time_r); } //analog void drawClockFace(){ display.fillCircle(ccenterx, ccentery, cradius, BLUE); display.fillCircle(ccenterx, ccentery, cradius-4, BLACK); // Draw 12 lines for(int i = 0; i&lt;360; i+= 30) { sx = cos((i-90)*scosConst); sy = sin((i-90)*scosConst); x0 = sx*(cradius)+ccenterx; yy0 = sy*(cradius)+ccentery; x1 = sx*(cradius-8)+ccenterx; yy1 = sy*(cradius-8)+ccentery; display.drawLine(x0, yy0, x1, yy1, 0x0377); } // Draw 4 lines for(int i = 0; i&lt;360; i+= 90) { sx = cos((i-90)*scosConst); sy = sin((i-90)*scosConst); x0 = sx*(cradius+6)+ccenterx; yy0 = sy*(cradius+6)+ccentery; x1 = sx*(cradius-11)+ccenterx; yy1 = sy*(cradius-11)+ccentery; display.drawLine(x0, yy0, x1, yy1, 0x0377); } } //analog static uint8_t conv2d(const char* p) { uint8_t v = 0; if ('0' &lt;= *p &amp;&amp; *p &lt;= '9') v = *p - '0'; return 10 * v + *++p - '0'; } //analog void drawClockHands(uint8_t h,uint8_t m,uint8_t s){ // Pre-compute hand degrees, x &amp; y coords for a fast screen update sdeg = s * 6; // 0-59 -&gt; 0-354 mdeg = m * 6 + sdeg * 0.01666667; // 0-59 -&gt; 0-360 - includes seconds hdeg = h * 30 + mdeg * 0.0833333; // 0-11 -&gt; 0-360 - includes minutes and seconds hx = cos((hdeg-90)*scosConst); hy = sin((hdeg-90)*scosConst); mx = cos((mdeg-90)*scosConst); my = sin((mdeg-90)*scosConst); sx = cos((sdeg-90)*scosConst); sy = sin((sdeg-90)*scosConst); // Erase just old hand positions display.drawLine(ohx, ohy, ccenterx+1, ccentery+1, BLACK); display.drawLine(omx, omy, ccenterx+1, ccentery+1, BLACK); display.drawLine(osx, osy, ccenterx+1, ccentery+1, BLACK); // Draw new hand positions display.drawLine(hx*(cradius-20)+ccenterx+1, hy*(cradius-20)+ccentery+1, ccenterx+1, ccentery+1, WHITE); display.drawLine(mx*(cradius-8)+ccenterx+1, my*(cradius-8)+ccentery+1, ccenterx+1, ccentery+1, WHITE); display.drawLine(sx*(cradius-8)+ccenterx+1, sy*(cradius-8)+ccentery+1, ccenterx+1, ccentery+1, RED); display.fillCircle(ccenterx+1, ccentery+1, 3, RED); // Update old x&amp;y coords osx = sx*(cradius-8)+ccenterx+1; osy = sy*(cradius-8)+ccentery+1; omx = mx*(cradius-8)+ccenterx+1; omy = my*(cradius-8)+ccentery+1; ohx = hx*(cradius-20)+ccenterx+1; ohy = hy*(cradius-20)+ccentery+1; } void FaceClock(){ display.clearScreen(); display.setTextColor(WHITE, BLACK); osx = ccenterx; osy = ccentery; omx = ccenterx; omy = ccentery; ohx = ccenterx; ohy = ccentery; drawClockFace();// Draw clock face } void drawSynchron() { display.clearScreen(); display.setTextSize(2); display.setCursor(2,48); display.setTextColor(WHITE); display.println(utf8(" Clock")); display.setTextSize(1); display.setCursor(2,68); display.setTextColor(WHITE); display.println(utf8("synchronization...")); } void drawWiFi() { display.clearScreen(); display.setTextSize(2); display.setCursor(2,48); display.setTextColor(RED); display.println(utf8("Connection to Wi-Fi")); } void drawBlynk() { display.clearScreen(); display.setTextSize(2); display.setCursor(2,48); display.setTextColor(RED); display.println(utf8("Connection to Blynk")); } void mailer() { // wait for WiFi connection if((WiFiMulti.run() == WL_CONNECTED)) { HTTPClient http; Serial.print("[HTTP] begin...\n"); http.begin("http://skorovoda.in.ua/php/wst41.php?mymail="+String(address)+"&amp;t="+String(t) +"&amp;h="+String(h)+"&amp;co2="+String(co2)+"&amp;ID="+String(ESP.getChipId())); Serial.print("[HTTP] GET...\n"); // start connection and send HTTP header int httpCode = http.GET(); // httpCode will be negative on error if(httpCode &gt; 0) { // HTTP header has been send and Server response header has been handled Serial.printf("[HTTP] GET... code: %d\n", httpCode); // file found at server if(httpCode == HTTP_CODE_OK) { String payload = http.getString(); Serial.println(payload); } } else { Serial.printf("[HTTP] GET... failed, error: %s\n", http.errorToString(httpCode).c_str()); } http.end(); } } //callback notifying the need to save config void saveConfigCallback() { Serial.println("Should save config"); shouldSaveConfig = true; } void factoryReset() { Serial.println("Resetting to factory settings"); wifiManager.resetSettings(); SPIFFS.format(); ESP.reset(); } void printString(String str) { Serial.println(str); } bool loadConfigS() { Blynk.config(address); Serial.print("e-mail: "); Serial.println( address ); Blynk.config(tZ); Serial.print("T_Zone: "); Serial.println( tZ ); Blynk.config(Tmx); Serial.print("T max: "); Serial.println( Tmx ); Blynk.config(Cmx); Serial.print("CO2 max: "); Serial.println( Cmx ); Blynk.config(Tmn); Serial.print("T min: "); Serial.println( Tmn ); Blynk.config(Hmn); Serial.print("H min: "); Serial.println( Hmn ); Blynk.config(timeSW); Serial.print("Time Summer/Winter: "); Serial.println( timeSW ); Blynk.config(formFS); Serial.print("format FS: "); Serial.println( formFS ); Blynk.config(blynk_token, "blynk-cloud.com", 8442); Serial.print("token: " ); Serial.println( blynk_token ); } bool loadConfig() { Serial.println("Load config..."); File configFile = SPIFFS.open("/config.json", "r"); if (!configFile) { Serial.println("Failed to open config file"); return false; } size_t size = configFile.size(); if (size &gt; 1024) { Serial.println("Config file size is too large"); return false; } // Allocate a buffer to store contents of the file. std::unique_ptr&lt;char[]&gt; buf(new char[size]); // We don't use String here because ArduinoJson library requires the input // buffer to be mutable. If you don't use ArduinoJson, you may as well // use configFile.readString instead. configFile.readBytes(buf.get(), size); StaticJsonBuffer&lt;200&gt; jsonBuffer; JsonObject &amp;json = jsonBuffer.parseObject(buf.get()); if (!json.success()) { Serial.println("Failed to parse config file"); return false; } // Save parameters strcpy(blynk_token, json["blynk_token"]); strcpy(address, json["address"]); strcpy(tZ, json["tZ"]); strcpy(Tmx, json["Tmx"]); strcpy(Cmx, json["Cmx"]); strcpy(Tmn, json["Tmn"]); strcpy(Hmn, json["Hmn"]); strcpy(timeSW, json["timeSW"]); strcpy(formFS, json["formFS"]); } void configModeCallback (WiFiManager *wifiManager) { String url {"http://192.168.4.1"}; printString("Connect to WiFi:"); printString("net: " + ssid); printString("pw: "+ pass); printString("Open browser:"); printString(url); printString("to setup device"); drawConnectionDetails(); } void setupWiFi() { //set config save notify callback wifiManager.setSaveConfigCallback(saveConfigCallback); // Custom parameters WiFiManagerParameter custom_blynk_token("blynk_token", "Blynk token", blynk_token, 34); wifiManager.addParameter(&amp;custom_blynk_token); WiFiManagerParameter custom_address("address", "E-mail", address, 64); wifiManager.addParameter(&amp;custom_address); WiFiManagerParameter custom_tZ("tZ", "Time Zone", tZ, 5); wifiManager.addParameter(&amp;custom_tZ); WiFiManagerParameter custom_Tmn("Tmn", "T min", Tmn, 5); wifiManager.addParameter(&amp;custom_Tmn); WiFiManagerParameter custom_Tmx("Tmx", "T max", Tmx, 5); wifiManager.addParameter(&amp;custom_Tmx); WiFiManagerParameter custom_Cmx("Cmx", "C max", Cmx, 7); wifiManager.addParameter(&amp;custom_Cmx); WiFiManagerParameter custom_Hmn("Hmn", "H min", Hmn, 5); wifiManager.addParameter(&amp;custom_Hmn); WiFiManagerParameter custom_timeSW("timeSW", "Time Summer(1)/Winter(0)", timeSW, 4); wifiManager.addParameter(&amp;custom_timeSW); WiFiManagerParameter custom_formFS("formFS", "formating FS", formFS, 4); wifiManager.addParameter(&amp;custom_formFS); wifiManager.setAPCallback(configModeCallback); wifiManager.setTimeout(60); if (!wifiManager.autoConnect(ssid.c_str(), pass.c_str())) { md = 2; Serial.println("mode OffLINE :("); loadConfigS(); } //save the custom parameters to FS if (shouldSaveConfig) { Serial.println("saving config"); DynamicJsonBuffer jsonBuffer; JsonObject &amp;json = jsonBuffer.createObject(); json["blynk_token"] = custom_blynk_token.getValue(); json["address"] = custom_address.getValue(); json["tZ"] = custom_tZ.getValue(); json["Tmx"] = custom_Tmx.getValue(); json["Cmx"] = custom_Cmx.getValue(); json["Tmn"] = custom_Tmn.getValue(); json["Hmn"] = custom_Hmn.getValue(); json["timeSW"] = custom_timeSW.getValue(); json["formFS"] = custom_formFS.getValue(); File configFile = SPIFFS.open("/config.json", "w"); if (!configFile) { Serial.println("failed to open config file for writing"); } json.printTo(Serial); json.printTo(configFile); configFile.close(); //end save } //if you get here you have connected to the WiFi Serial.println("WiFi connected"); Serial.print("IP address: "); Serial.println(WiFi.localIP()); } void connectBlynk(){ if(String(blynk_token)== "Blynk token"){ blnk = 0; Serial.println("! Off Blynk!"); } else { Serial.println("Connecting to blynk..."); while (Blynk.connect() == false) { delay(500); Serial.println("Connecting to blynk..."); } } } void sendToBlynk(){ Blynk.virtualWrite(V1, t); Blynk.virtualWrite(V2, h); Blynk.virtualWrite(V3, co2); Blynk.virtualWrite(V5, hic); } void formatFS(){ SPIFFS.format(); SPIFFS.begin(); } void setup() { Serial.begin(115200); display.begin(); // Init filesystem if (!SPIFFS.begin()) { Serial.println("Failed to mount file system"); ESP.reset(); } md = 1; // Setup WiFi drawWiFi(); //"Connecting to Wi-Fi..." setupWiFi(); if(md == 1){ // Load configuration if (!loadConfig()) { Serial.println("Failed to load config"); // factoryReset(); } else { Serial.println("Config loaded"); } Blynk.config(address); Serial.print("e-mail: "); Serial.println( address ); Blynk.config(tZ); Serial.print("T_Zone: "); Serial.println( tZ ); Blynk.config(Tmx); Serial.print("T max: "); Serial.println( Tmx ); Blynk.config(Cmx); Serial.print("CO2 max: "); Serial.println( Cmx ); Blynk.config(Tmn); Serial.print("T min: "); Serial.println( Tmn ); Blynk.config(Hmn); Serial.print("H min: "); Serial.println( Hmn ); Blynk.config(timeSW); Serial.print("Time Summer/Winter: "); Serial.println( timeSW ); Blynk.config(formFS); Serial.print("format FS: "); Serial.println( formFS ); Blynk.config(blynk_token, "blynk-cloud.com", 8442); Serial.print("token: " ); Serial.println( blynk_token ); Tmax = atof (Tmx); Cmax = atof (Cmx); Tmin = atof (Tmn); Hmin = atof (Hmn); tZone = atof (tZ); timeSummerWinter = atof (timeSW); formatingFS = atof (formFS); drawSynchron(); synchronClock(); connectBlynk(); FaceClock(); if (formatingFS == 1) { formatFS(); } } else if(md == 2) { Tmax = atof (Tmx); Cmax = atof (Cmx); Tmin = atof (Tmn); Hmin = atof (Hmn); tZone = atof (tZ); timeSummerWinter = atof (timeSW); formatingFS = atof (formFS); synchronClockA(); FaceClock(); if (formatingFS == 1) { formatFS(); } } } void loop() { if (md == 2) Serial.println(":( OffLINE"); else if (md == 1) Serial.println(":) OnLINE"); sendMeasurements(); draw(); Clock(); drawClockHands(hh,mm,ss); if (ml &gt;= 480000) ml = 0; //  if ((ml &gt;= 20000) and ((t &gt; Tmax) or (co2 &gt; Cmax) or (t &lt; Tmin) or (h &lt; Hmin))) { mailer(); ml = 0; } Blynk.run(); if (bl &gt; 210){ // 30 sec sendToBlynk(); Serial.println("   Blynk"); bl = 0; } bl++; ml++; delay(100); t_old = t; hic_old = hic; h_old = h; co2_old = co2; Serial.println(" "); }</span></span></span></span></code> </pre> </div></div><br><p>  Jika setidaknya salah satu parameter udara di luar ambang batas yang ditetapkan, perangkat mengirim pesan email tentang konten berikut sekitar sekali per jam: </p><br><p> <a href=""><img src="https://habrastorage.org/webt/sb/s7/e5/sbs7e5g0boyq3gqvnyos8vhgpic.png"></a> </p><br><p>  Pesan ke email dikirim melalui skrip php.  Skrip diunggah ke server email saya.  Ini akan diperlukan jika Anda berencana untuk mengirim pesan dari sumber lain. </p><br><div class="spoiler">  <b class="spoiler_title">skrip php</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">//  - http://skorovoda.in.ua/php/aqm42.php?mymail=my_login@my.site.net&amp;t=22.2&amp;h=55&amp;co2=666 $EMAIL=0; $TEMPER=0; $vlaga=0; $carbon=0; $device=0; $EMAIL=$_GET["mymail"]; $device=$_GET["ID"]; echo $EMAIL; $TEMPER=$_GET["t"]; $vlaga=$_GET["h"]; $carbon=$_GET["co2"]; $mdate = date("H:i dmy"); echo &lt;&lt;&lt;END &lt;p&gt;: $TEMPER °&lt;p&gt; &lt;p&gt;: $vlaga %&lt;p&gt; &lt;p&gt;  : $carbon ppm&lt;p&gt; &lt;p&gt;--------------------&lt;p&gt; &lt;p&gt; №: $device&lt;p&gt; END; echo &lt;&lt;&lt;END &lt;p&gt;$mdate&lt;/p&gt; END; mail($EMAIL, "Air Quality Monitor " .$device. " v.051018","       №" .$device. " .        (,     )      . === : ".$TEMPER."°C === ".": ".$vlaga."% === "."  : ".$carbon." ppm === "." ! === , : ".$mdate,"From: my_sensors@air-monitor.info \n") </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre> </div></div><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/8w/7n/el/8w7nelwjfe3b2wumssuerp3o3pm.png"></div><br><p>  Nyalakan monitor. </p><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/75/wk/lw/75wklw7on-_tir_swognf_fsmoq.png"></div><br><p>  Perangkat menaikkan titik akses am180206.  Kami menemukan titik ini dalam daftar jaringan yang tersedia dan terhubung ke sana, kata sandi ada di layar.  Coba sambungkan ke titik ini dalam satu setengah menit, jika tidak, monitor akan secara otomatis masuk ke mode baterai.  Tentang mode offline - beberapa saat kemudian.  Kemudian buka halaman browser http://192.168.4.1. </p><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/0x/xs/8d/0xxs8da7p7nxulfkzh3c6k4ysvw.png"></div><br><p>  Klik tombol <em>Configure WiFi (No Scan)</em> .  Halaman akan terbuka dengan formulir pengaturan termostat: </p><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/u6/k_/qn/u6k_qn1o6venw84_jnfvrq5bwe4.png"></div><br><p>  Tunjukkan dalam bentuk nama dan kata sandi jaringan rumah Anda, kunci identifikasi BLynk, email Anda, zona waktu, musim panas / musim dingin, serta nilai ambang batas untuk suhu, kelembaban, dan konten CO2. </p><br><p>  Saat memilih nilai ambang batas untuk parameter udara, dipandu oleh indikator yang saya temukan di Internet: </p><br><p>  1. Suhu nyaman di malam hari saat tidur 19 ... 21 ° C, siang hari - 22 ... 23 ° C </p><br><p>  2. Kelembaban relatif optimal di musim dingin dianggap kelembaban 30 ... 45%, dan di hangat - 30 ... 60%.  Indikator kelembaban maksimum maksimum: di musim dingin tidak boleh melebihi 60%, dan di musim panas - 65%. </p><br><p>  3. Tingkat maksimum karbon dioksida di tempat tidak boleh melebihi 1000 ppm.  Tingkat yang disarankan untuk kamar tidur, kamar anak-anak - tidak lebih dari 600 ppm.  Tanda 1400 ppm untuk waktu yang lama adalah batas kandungan CO2 yang diizinkan di dalam ruangan.  Jika ada lebih banyak, maka kualitas udara dianggap rendah. </p><br><p>  Bidang <em>e-mai</em> dapat dibiarkan kosong.  Kemudian, peluang untuk menerima surat melalui email tentang keluarnya parameter udara di luar nilai batas akan hilang.  Tanpa kunci Blynk yang dimasukkan, Anda akan kehilangan kemampuan untuk menerima informasi tentang parameter udara di kejauhan.  Namun, monitor tidak akan "hilang" jika bidang dengan nilai pembatasan parameter udara tetap kosong. </p><br><p>  Isi tanpa ragu semua bidang formulir dengan angka dalam format titik mengambang, misalnya, zona waktu <em>2.0</em> .  Sketsa tersebut menyediakan konversi angka selanjutnya ke format yang diinginkan. </p><br><p>  Setelah menyimpan pengaturan dalam memori ESP8266 (tombol <em>Simpan</em> ), monitor akan terhubung ke jaringan dan mulai bekerja. </p><br><p>  Pertimbangkan gambar di layar. </p><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/nr/d3/b-/nrd3b-zotfdmjlxuo4pxlsg98c0.png"></div><br><p>  Tanggal, waktu, suhu yang diukur, kadar CO2 dan kelembaban udara cukup jelas.  Saya akan mengklarifikasi jika parameter udara melampaui batas yang Anda tetapkan, maka tampilan mereka di layar akan berubah warna dari hijau menjadi merah. </p><br><p>  Huruf "B" dengan latar belakang merah menunjukkan bahwa monitor berfungsi tanpa menghubungkan ke Blynk, dan jika huruf "A" muncul, daya hilang dan tidak ada Wi-Fi pada saat itu muncul (perangkat offline). </p><br><p>  Secara umum, tampilan warna merah pada layar harus waspada - ada penyimpangan dari fungsi normal perangkat. </p><br><p>  Di sudut kanan bawah layar kita melihat indeks panas (indeks panas, humindex). </p><br><p>  <em>“Humidex adalah kuantitas tanpa dimensi berdasarkan titik embun.</em>  <em>Indeks ini banyak digunakan dalam laporan cuaca Kanada di musim panas.</em> <em><br></em>  <em>Menurut Layanan Meteorologi Kanada, nilai Humidex di atas 30 menyebabkan beberapa ketidaknyamanan, di atas 40 menyebabkan ketidaknyamanan besar, dan nilai di atas 45 berbahaya.</em>  <em>Jika humidex mencapai 54, stroke panas tidak bisa dihindari.</em>  <em>Angin tidak memperhitungkan indeks ini. "</em>  (Wikipedia, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">humidex</a> ). </p><br><p>  Harus diklarifikasi bahwa indeks panas dihitung hanya untuk suhu yang relatif tinggi, ketika suhu udara yang diukur di atas 21 ° C.  Secara kiasan, indeks panas adalah suhu yang dirasakan pada hari musim panas tanpa angin. <br></p><br><p>  Menurut tabel artikel yang sama di Wikipedia, suhu terukur 25 ° C pada kelembaban 30% dirasakan sebagai 24 ° C, pada 50% - 28 ° C, dan pada 90% - 35 ° C (10 ° C lebih tinggi dari termometer).  Di dalam ruangan, indikator ini dapat dikurangi dengan mengatur konsep atau menyalakan kipas.  AC akan menyala secara otomatis jika Anda mengatur suhu AC tidak lebih tinggi dari 25 ° C.  Indeks panas, menurut saya, adalah parameter kualitas udara yang lebih relevan daripada, katakanlah, tekanan, yang tidak dapat kita pengaruhi dengan cara apa pun. </p><br><p>  Sensor DHT22, seperti DHT11, bersama dengan "minus" - akurasi rendah pengukuran kelembaban memiliki "plus" yang tak terbantahkan: bus data sensor ini memiliki informasi tentang indeks panas.  Saya memanfaatkan "plus" ini dan menampilkan indeks panas pada layar perangkat. <br></p><br><p>  Ada banyak keluhan di Internet tentang rendahnya akurasi DHT22.  Bagi mereka yang bertekad untuk menolak menggunakan sensor ini dalam proyek mereka, saya meminta Anda untuk melihat ke arah sensor suhu dan kelembaban yang lebih modern HTU21D, Si7021 atau SHT21. <br></p><br><p>  Saatnya untuk meluncurkan aplikasi Blynk di ponsel cerdas Anda. </p><br><p>  Siapkan aplikasi Anda.  Variabel untuk Blynk (bukan untuk mencari mereka dalam sketsa): suhu - <em>V1</em> , kelembaban - <em>V2</em> , konten CO2 - <em>V3</em> , indeks panas - <em>V5</em> . </p><br><p>  Di ponsel cerdas saya, antarmuka Blynk'a terlihat seperti: </p><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/dw/3e/zd/dw3ezdbdzpghvmnmsmt6lsazvia.png"></div><br><p>  Grafik menunjukkan suhu yang diukur (kuning), kelembaban (biru), indeks panas (ungu).  Puncak pertama dalam grafik adalah pemanasan sensor tekanan-kelembaban di telapak tangan: kurva indeks panas terletak di atas kurva suhu.  Puncak kedua adalah pemanasan sensor dengan pengering rambut.  Kelembaban udara berkurang ketika sensor memanas dengan pengering rambut, dan kurva indeks panas di beberapa daerah berulang atau di bawah garis suhu.  (lihat info). </p><br><p>  Jangan khawatir jika garis suhu menghilang pada grafik: pada suhu di bawah 21 ° C, kurva indeks panas mengulangi kurva suhu yang diukur. </p><br><p>  Sekarang kami sedang menguji operasi sistem notifikasi melalui email.  Masukkan alamat http dari kode skrip php ke bilah alamat browser (dalam skrip, baris dengan alamat http dikomentari).  Jika Anda tidak lupa menentukan email Anda di pengaturan, dan di jendela browser - informasi, seperti pada gambar di bawah ini, maka kemungkinan besar tidak akan ada masalah dengan menerima pemberitahuan.  Tes ini sangat berguna ketika mentransfer skrip php dari server saya ke yang lain. </p><br><p></p><p><img src="https://habrastorage.org/webt/lq/mc/8q/lqmc8qgoywmrc9t5ogsv3oravhk.png"></p><br><br><h2>  Kesimpulan </h2><br><p>  Saya tidak akan mengulangi apa yang telah dilakukan, tetapi memikirkan hal-hal yang ambigu. </p><br><p>  Logis, misalnya, adalah pertanyaan "Mengapa jam di sini?"  Arloji panah diperlukan untuk mengisi layar.  Meskipun jam digital saat ini dibangun di hampir setiap alat rumah tangga, jam analog memiliki satu keunggulan: skala waktu, berkat dial, membuatnya mudah untuk memperkirakan waktu ke suatu acara.  Saya tidak akan berdebat - Anda dapat melakukannya tanpa jam. </p><br><p>  Apa yang perlu Anda kerjakan: </p><br><p>  • Atur catu daya otonom untuk monitor dari dua baterai AA untuk waktu yang lama - setidaknya satu tahun. </p><br><p>  • Penampilan tidak layak didiskusikan - di sini setiap orang memiliki pendapat dan kemungkinan mereka sendiri.  Misalnya, saya suka opsi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link">avs24rus</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ia menggunakan layar 7 "dalam bingkai dengan pencetakan 3D sebagai layar</a> . Anda dapat mengganti bingkai mahal dengan yang murah dari baguette. Dan dalam mode siaga menampilkan lanskap, potret kekasih Anda atau foto anak-anak - Anda juga akan memiliki bingkai foto asli sebagai tambahan. </p><br><p>  Jika Anda tidak terlalu menuntut di sisi estetika masalah, maka mungkin sesuatu yang serupa akan cocok untuk Anda: </p><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/t9/mc/ad/t9mcadjmxmqqiseaztnhsj_odyw.png"></div><br><p>  <strong>Catatan</strong>  Awalnya, monitor dikandung sebagai perangkat universal yang siap digunakan dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">termostat</a> .  Fleksibilitasnya telah menyebabkan komplikasi skema yang tidak dapat dibenarkan.  Karena itu, kemudian saya menolak kemungkinan menggunakan solusi monitor dalam termostat dan mengedit publikasi.  Jejak dari versi perangkat yang lebih kompleks sebelumnya tetap ada di komentar. </p><br><p>  Semoga beruntung </p><br><h2>  Bookmark saya tentang suatu subjek dari Habr </h2><br><p>  1. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Termometer Wi-Fi di ESP8266 + DS18B20 hanya dengan $ 4</a> </p><br><p>  2. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Monitor udara rumah yang ringkas (CO2, suhu, kelembaban, tekanan) dengan Wi-Fi dan antarmuka seluler</a> </p><br><p>  3. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pengalaman praktis menggunakan Blynk untuk sensor CO2.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian 1</a> </p><br><p>  4. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Menggunakan memori tampilan Flash SPI untuk menyimpan sumber daya grafis atau menampilkan stasiun cuaca rumah</a> </p><br><p>  5. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Kami mengukur konsentrasi CO2 di apartemen menggunakan MH-Z19</a> </p><br><p>  6. Sisi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">gelap MH-Z19</a> </p><br><p>  7. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Kami mengukur konsentrasi CO2 di apartemen menggunakan MH-Z19</a> </p><br><p>  Akhirnya, terima kasih <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">@kumekay</a> untuk saran yang berharga. <br>  Publikasi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">"Pengalaman praktis menggunakan Blynk untuk sensor CO2</a> membantu saya memecahkan masalah memasukkan kembali variabel ke dalam memori ESP8622 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">"</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian 1 "</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">@ a3x</a> .  Artikel serba guna! <br></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id442856/">https://habr.com/ru/post/id442856/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id442840/index.html">Backend United 3: Jellied</a></li>
<li><a href="../id442844/index.html">Kapitan di pucuk pimpinan Kubernetes</a></li>
<li><a href="../id442846/index.html">Industri luar angkasa kami. Pandangan tentang masalah industri dari perspektif pengembang biasa</a></li>
<li><a href="../id442852/index.html">Dell 6000 atau halo dari 2005</a></li>
<li><a href="../id442854/index.html">Bagaimana kami membuat skema metro Minsk</a></li>
<li><a href="../id442858/index.html">Apakah ada terlalu banyak gajah di Afrika? Bagaimana koeksistensi damai dengan komunitas manusia dapat membantu dalam hal ini</a></li>
<li><a href="../id442862/index.html">Proof-of-Stake: Inside Look</a></li>
<li><a href="../id442864/index.html">Berapa umur tuanmu?</a></li>
<li><a href="../id442866/index.html">AI yang terlatih dari beberapa dekade percobaan kuliner menciptakan hidangan baru</a></li>
<li><a href="../id442868/index.html">Tamasya singkat ke sistem pendingin pusat data. Pro dan kontra</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>