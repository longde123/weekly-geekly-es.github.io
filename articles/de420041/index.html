<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚öæÔ∏è üí£ üë®‚Äçüë®‚Äçüë¶‚Äçüë¶ TypeScript War oder Enum Conquest üë©üèΩ‚Äçüè´ üë®üèº üîà</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hintergrund 
 Vor einem halben Jahr hat unser Unternehmen beschlossen, auf neuere und modischere Technologien umzusteigen. Zu diesem Zweck wurde eine ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>TypeScript War oder Enum Conquest</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/420041/"><h2>  Hintergrund </h2><br>  Vor einem halben Jahr hat unser Unternehmen beschlossen, auf neuere und modischere Technologien umzusteigen.  Zu diesem Zweck wurde eine Gruppe von Spezialisten gebildet, die: sich f√ºr den technologischen Stack entscheiden, auf der Grundlage dieses Stacks eine Br√ºcke zum Legacy-Code schlagen und schlie√ülich einige der alten Module auf neue Schienen √ºbertragen sollten.  Ich hatte das Gl√ºck, in diese Gruppe zu kommen.  Die Client-Codebasis besteht aus ungef√§hr einer Million Codezeilen.  Wir haben TypeScript als Sprache gew√§hlt.  Sie beschlossen, ein GUI-Substrat auf vue in Verbindung mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">vue-class-component</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">IoC zu erstellen</a> . <br><br>  Aber die Geschichte handelt nicht davon, wie wir das Erbe des Codes losgeworden sind, sondern von einem kleinen Vorfall, der zu einem echten Wissenskrieg gef√ºhrt hat.  Wen k√ºmmert es, willkommen bei Katze. <br><a name="habracut"></a><br><h2>  Das Problem kennenlernen </h2><br>  Einige Monate nach dem Start machte sich die Arbeitsgruppe mit dem neuen Stapel vertraut und schaffte es, einen Teil des alten Codes darauf zu √ºbertragen.  Man k√∂nnte sogar sagen, dass es eine kritische Masse an Fleisch gab, wenn man anhalten, Luft holen und sich ansehen musste, was wir getan hatten. <br><br>  Wie Sie wissen, waren Orte, die ein gr√ºndliches Studium erforderten, ausreichend.  Aber von all den wichtigen Dingen hat mich ironischerweise nichts erwischt.  Nicht als Entwickler.  Aber einer der unwichtigen, im Gegenteil, verfolgte.  Ich war bis zum Wahnsinn genervt, wie wir mit Aufz√§hlungsdaten arbeiten.  Es gab keine Verallgemeinerung.  Sie werden eine separate Klasse mit einer Reihe erforderlicher Methoden treffen, dann werden Sie zwei Klassen f√ºr dieselbe oder sogar etwas Geheimnisvolles und Magisches finden.  Und es ist niemand schuld.  Das Tempo, mit dem wir das Erbe loswurden, war zu gro√ü. <br><br>  Nachdem ich das Thema Transfers unter Kollegen angesprochen hatte, erhielt ich Unterst√ºtzung.  Es stellte sich heraus, dass nicht nur ich mit dem Fehlen eines einheitlichen Ansatzes f√ºr die Arbeit mit ihnen nicht zufrieden war.  In diesem Moment schien es mir, dass ich in ein paar Stunden Codierung das gew√ºnschte Ergebnis erzielen w√ºrde und mich freiwillig bereit erkl√§rte, die Situation zu korrigieren.  Aber wie falsch ich damals war ... <br><br><pre><code class="hljs pgsql">//    ,        . <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {Enum} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> "ts-jenum"; @Enum("text") export <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> State { static readonly <span class="hljs-built_in"><span class="hljs-built_in">NEW</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> State("New"); static readonly ACTIVE = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> State("Active"); static readonly BLOCKED = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> State("Blocked"); private constructor(<span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">text</span></span>: string) { super(); } } //   console.log("" + State.ACTIVE); // Active console.log("" + State.BLOCKED); // Blocked console.log(State.<span class="hljs-keyword"><span class="hljs-keyword">values</span></span>()); // [State.<span class="hljs-built_in"><span class="hljs-built_in">NEW</span></span>, State.ACTIVE, State.BLOCKED] console.log(State.valueOf("New")); // State.<span class="hljs-built_in"><span class="hljs-built_in">NEW</span></span> console.log(State.valueByName("NEW")); // State.<span class="hljs-built_in"><span class="hljs-built_in">NEW</span></span> console.log(State.ACTIVE.enumName); // ACTIVE</code> </pre> <br><h2>  1. Dekorateur </h2><br>  Wo soll ich anfangen?  Nur eines kam mir in den Sinn: Nehmen Sie eine Java-√§hnliche Aufz√§hlung als Grundlage.  Aber da ich mich meinen Kollegen zeigen wollte, beschloss ich, das klassische Erbe aufzugeben.  Verwenden Sie stattdessen einen Dekorateur.  Dar√ºber hinaus kann der Dekorateur mit Argumenten versehen werden, um den Aufz√§hlungen einfach und nat√ºrlich die erforderliche Funktionalit√§t zu verleihen.  Das Codieren dauerte nicht lange und nach ein paar Stunden hatte ich schon etwas √Ñhnliches: <br><br><div class="spoiler">  <b class="spoiler_title">Dekorateur</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">export <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> Enum(idProperty?: string) { // tslint:<span class="hljs-keyword"><span class="hljs-keyword">disable</span></span>-next-<span class="hljs-type"><span class="hljs-type">line</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> &lt;T extends <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span>, V&gt;(target: T): T { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((target <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span>).__enumMap__ || (target <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span>).__enumValues__) { const enumName = (target <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span>).prototype.constructor.name; throw <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Error(`The enumeration ${enumName} has already initialized`); } const enumMap: <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> = {}; const enumMapByName: <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> = {}; const enumValues = []; // Lookup static fields <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (const key <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.keys(target)) { const <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> = (target <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span>)[key]; // <span class="hljs-keyword"><span class="hljs-keyword">Check</span></span> static field: <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> be instance <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> enum <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> instanceof target) { let id; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (idProperty) { id = (<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span>)[idProperty]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (typeof id !== "string" &amp;&amp; typeof id !== "number") { const enumName = (target <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span>).prototype.constructor.name; throw <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Error(`The <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the ${idProperty} property <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the enumeration element ${enumName}. ${key} <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> a string <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> a number: ${id}`); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { id = key; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (enumMap[id]) { const enumName = (target <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span>).prototype.constructor.name; throw <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Error(`An element <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> the identifier ${id}: ${enumName}.${enumMap[id].enumName} already <span class="hljs-keyword"><span class="hljs-keyword">exists</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the enumeration ${enumName}`); } enumMap[id] = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; enumMapByName[key] = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; enumValues.push(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.defineProperty(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>, "__enumName__", {<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>: key}); <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">freeze</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">freeze</span></span>(enumMap); <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">freeze</span></span>(enumValues); <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.defineProperty(target, "__enumMap__", {<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>: enumMap}); <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.defineProperty(target, "__enumMapByName__", {<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>: enumMapByName}); <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.defineProperty(target, "__enumValues__", {<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>: enumValues}); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (idProperty) { <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.defineProperty(target, "__idPropertyName__", {<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>: idProperty}); } //  <span class="hljs-keyword"><span class="hljs-keyword">values</span></span>(), valueOf     ,    -. <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">freeze</span></span>(target); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> target; }; }</code> </pre></div></div><br>  Und hier habe ich den ersten Misserfolg erlitten.  Es stellte sich heraus, dass Sie den Typ nicht mit Hilfe eines Dekorateurs √§ndern k√∂nnen.  Microsoft hat sogar einen Appell zu diesem Thema: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Class Decorator Mutation</a> .  Wenn ich sage, dass Sie den Typ nicht √§ndern k√∂nnen, bedeutet dies, dass Ihre IDE nichts dar√ºber wei√ü und keine Hinweise und eine angemessene automatische Vervollst√§ndigung bietet.  Und Sie k√∂nnen den Typ so oft √§ndern, wie Sie m√∂chten, nur das Gute daran ... <br><br><h2>  2. Vererbung </h2><br>  Da ich nicht versuchte, mich selbst zu √ºberzeugen, musste ich zu der Idee zur√ºckkehren, Transfers basierend auf der allgemeinen Klasse zu erstellen.  Ja, und was ist daran falsch?  Ich war von mir selbst genervt.  Die Zeit l√§uft davon, Leute aus der Gruppe, Gott bewahre, ich verbringe Zeit mit Dekorateuren.  Es war m√∂glich, die Aufz√§hlung im Allgemeinen in einer Stunde einzureichen und fortzufahren.  So sei es.  Warf schnell den Code der Basisklasse Enumerable und seufzte und f√ºhlte sich erleichtert.  Ich warf den Entwurf in das allgemeine Repository und bat meinen Kollegen, die L√∂sung zu √ºberpr√ºfen. <br><br><div class="spoiler">  <b class="spoiler_title">Aufz√§hlbar</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">// :     ,  -     export <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Enumerable&lt;T&gt; { constructor() { const clazz = this.constructor <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> EnumStore; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (clazz.__enumMap__ || clazz.__enumValues__ || clazz.__enumMapByName__) { throw <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Error(`It <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> forbidden <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> ${clazz.name} enumeration elements outside the enumeration`); } } static <span class="hljs-keyword"><span class="hljs-keyword">values</span></span>&lt;T&gt;(): ReadonlyArray&lt;T&gt; { const clazz = this <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> EnumStore; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!clazz.__enumValues__) { throw <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Error(`${clazz.name} enumeration has <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> been initialized. It <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> necessary <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> the decorator @Enum <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>`); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> clazz.__enumValues__; } static valueOf&lt;T&gt;(id: string | number): T { const clazz = this <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> EnumStore; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!clazz.__enumMap__) { throw <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Error(`${clazz.name} enumeration has <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> been initialized. It <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> necessary <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> the decorator @Enum <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>`); } const <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = clazz.__enumMap__[id]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) { throw <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Error(`The element <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> ${id} identifier does <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> exist <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the $ {clazz.name} enumeration`); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; } static valueByName&lt;T&gt;(<span class="hljs-type"><span class="hljs-type">name</span></span>: string): T { const clazz = this <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> EnumStore; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!clazz.__enumMapByName__) { throw <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Error(`${clazz.name} enumeration has <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> been initialized. It <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> necessary <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> the decorator @Enum <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>`); } const <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = clazz.__enumMapByName__[<span class="hljs-type"><span class="hljs-type">name</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) { throw <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Error(`The element <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> ${<span class="hljs-type"><span class="hljs-type">name</span></span>} <span class="hljs-type"><span class="hljs-type">name</span></span> does <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> exist <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the ${clazz.name} enumeration`); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> enumName(): string { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (this <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span>).__enumName__; } toString(): string { const clazz = this.constructor <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> EnumStore; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (clazz.__idPropertyName__) { const self = this <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self[clazz.__idPropertyName__]; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> this.enumName; } }</code> </pre> </div></div><br>  Aber die Tragikom√∂die gewann an Fahrt.  TypeScript Version 2.6.2 wurde auf meinem Computer installiert, die Version, in der es einen unsch√§tzbaren Fehler gab.  Unbezahlbar, denn es ist kein Bug, sondern eine Fitcha.  Eine Stimme aus dem Nebenzimmer rief, dass er nichts tun w√ºrde.  Fehler beim Kompilieren ( <i>Transpilieren</i> ).  Ich konnte meinen eigenen Ohren nicht trauen, denn ich habe immer vor einem Push ein Projekt zusammengestellt, auch wenn es ein Entwurf war.  Und die innere Stimme fl√ºsterte: Das ist ein Fiasko, Bruder. <br><br>  Nach einem kurzen Test stellte ich fest, dass es sich um eine TypeScript-Version handelte.  Es stellte sich heraus, dass der Compiler dies als einen Typ betrachtete, wenn der generische Name der Klasse mit dem Namen des in der statischen Methode angegebenen generischen Namens √ºbereinstimmte.  Aber was auch immer es war, jetzt ist es f√ºr die Kenntnis von TypeScript bereits Teil der Geschichte dieses Krieges. <br><br>  Fazit: Das Problem mit Transfers wie es war und blieb.  Meine Trauer ... <br><br>  Hinweis: <i>Ich kann dieses Verhalten jetzt mit 2.6.2 nicht selbst reproduzieren. M√∂glicherweise habe ich einen Fehler mit der Version gemacht oder in den Testf√§llen nichts hinzugef√ºgt.</i>  <i>Die Anforderung f√ºr das obige Problem " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Statischen Mitgliedern erlauben, auf Parameter des Klassentyps zu verweisen"</a> wurde abgelehnt.</i> <br><br><h2>  3. Casting-Funktion </h2><br>  Trotz der Tatsache, dass es eine krumme L√∂sung gab, die explizit den Typ der Aufz√§hlungsklasse in statischen Methoden angibt, z. B. State.valueOf &lt;State&gt; (), passte sie niemandem und vor allem mir.  F√ºr eine Weile legte ich sogar die verdammten Transfers beiseite und verlor das Vertrauen, dass ich dieses Problem generell l√∂sen k√∂nnte. <br><br>  Nachdem ich meine moralische St√§rke wiedererlangt hatte, suchte ich im Internet nach TypeScript-Tricks, schaute, wer unter was litt, las die Sprachdokumentation f√ºr alle F√§lle erneut und beschloss, den Job zu beenden, um dies zu vermeiden.  Sieben Stunden ununterbrochener Experimente, bei denen selbst nach Kaffee nichts gesucht wurde, ergaben das Ergebnis.  Nur eine Funktion, die aus einer Codezeile besteht, setzt alles an seinen Platz. <br><br><pre> <code class="hljs matlab">export <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EnumType</span></span></span><span class="hljs-function">&lt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">T</span></span></span><span class="hljs-function">&gt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IStaticEnum</span></span></span><span class="hljs-function">&lt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">T</span></span></span><span class="hljs-function">&gt; { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">return</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(&lt;IStaticEnum&lt;T&gt;&gt; Enumerable)</span></span></span><span class="hljs-function">; } //  </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IStaticEnum</span></span></span><span class="hljs-function"> : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">export</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">interface</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IStaticEnum</span></span></span><span class="hljs-function">&lt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">T</span></span></span><span class="hljs-function">&gt; { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">new</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: {</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">enumName</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span><span class="hljs-function">}; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">values</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadonlyArray</span></span></span><span class="hljs-function">&lt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">T</span></span></span><span class="hljs-function">&gt;; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">valueOf</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(id: string | number)</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">T</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">valueByName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name: string)</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">T</span></span></span><span class="hljs-function">; }</span></span></code> </pre><br>  Und die Deklaration einer Java-√§hnlichen Aufz√§hlung sieht jetzt so aus: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {Enum, EnumType, IStaticEnum} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> "ts-jenum"; @Enum("text") export <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> State extends EnumType&lt;State&gt;() { static readonly <span class="hljs-built_in"><span class="hljs-built_in">NEW</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> State("New"); static readonly ACTIVE = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> State("Active"); static readonly BLOCKED = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> State("Blocked"); private constructor(<span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">text</span></span>: string) { super(); } } //   console.log("" + State.ACTIVE); // Active console.log("" + State.BLOCKED); // Blocked console.log(State.<span class="hljs-keyword"><span class="hljs-keyword">values</span></span>()); // [State.<span class="hljs-built_in"><span class="hljs-built_in">NEW</span></span>, State.ACTIVE, State.BLOCKED] console.log(State.valueOf("New")); // State.<span class="hljs-built_in"><span class="hljs-built_in">NEW</span></span> console.log(State.valueByName("NEW")); // State.<span class="hljs-built_in"><span class="hljs-built_in">NEW</span></span> console.log(State.ACTIVE.enumName); // ACTIVE</code> </pre><br>  Nicht ohne Neugierde, mit einem zus√§tzlichen Import von IStaticEnum, das nirgendwo verwendet wird (siehe obiges Beispiel).  In der sehr ungl√ºcklichen Version von TypeScript 2.6.2 m√ºssen Sie dies explizit angeben.  Ein Fehler zum Thema <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> . <br><br><h2>  Insgesamt </h2><br>  Wenn Sie lange leiden, wird etwas funktionieren.  Link zu Github mit dem Ergebnis der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> geleisteten Arbeit.  Ich selbst habe festgestellt, dass TypeScript eine Sprache mit gro√üartigen Funktionen ist.  Es gibt so viele dieser M√∂glichkeiten, dass Sie darin ertrinken k√∂nnen.  Und wer nicht sinken will, lernt schwimmen.  Wenn Sie zum Thema √úberweisungen zur√ºckkehren, k√∂nnen Sie sehen, wie andere mit ihnen arbeiten: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Aufz√§hlung basierend auf zwei Klassen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Box Wrapper Wrapper</a> </li></ul><br>  Schreiben Sie √ºber Ihre Arbeit, ich denke, die Community wird interessiert sein.  Vielen Dank f√ºr Ihre Geduld und Ihr Interesse. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de420041/">https://habr.com/ru/post/de420041/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de420031/index.html">Zeichnen mit Renderzielen in Unreal Engine</a></li>
<li><a href="../de420033/index.html">Wie wir angefangen haben, Registrierkassen f√ºr unsere Kunden zu registrieren</a></li>
<li><a href="../de420035/index.html">Golang GUI: GTK + 3</a></li>
<li><a href="../de420037/index.html">Streamen Sie mit mehreren Kameras aus improvisierten Materialien</a></li>
<li><a href="../de420039/index.html">Funktionales Denken. Teil 2</a></li>
<li><a href="../de420045/index.html">Bunker f√ºr das Datum: Wie ich im RUVDS-Rechenzentrum auf dem Territorium der Raumfahrtanlage herumlaufen durfte</a></li>
<li><a href="../de420049/index.html">Das Buch "Der Mann spricht. Evolution und Sprache</a></li>
<li><a href="../de420051/index.html">[DotNetBook] Span, Memory und ReadOnlyMemory</a></li>
<li><a href="../de420053/index.html">Veeam Academy f√ºr C # -Entwickler: Neue Saison</a></li>
<li><a href="../de420055/index.html">Theorie und Praxis von Backups mit Borg</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>