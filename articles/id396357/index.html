<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏼‍✈️ 👭 ⚫️ Reverse Engineering Laser Scanner Leuze RS4 🧑🏻 💷 🅾️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sebelumnya, saya berbicara tentang rekayasa balik sensor jarak laser . Kali ini kita akan berbicara tentang perangkat yang lebih kompleks - pemindai l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Reverse Engineering Laser Scanner Leuze RS4</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/396357/"><img src="https://habrastorage.org/files/09a/d9e/f75/09ad9ef7519d415f9d003991043d22b1.jpg" align="right"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebelumnya, saya berbicara tentang rekayasa balik </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sensor jarak laser</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Kali ini kita akan berbicara tentang perangkat yang lebih kompleks - pemindai laser Leuze RS4. </font><font style="vertical-align: inherit;">Seperti sensor, pemindai ini datang kepada saya dalam keadaan rusak, jadi saya harus mulai memulihkan pekerjaannya, dan dalam proses meningkatkan beberapa karakteristiknya, dan, bahkan, membuat kembali ke perangkat lain.</font></font><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apa pemindai laser ini?</font></font></h4><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Leuze RS4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah pemindai keamanan laser, yang dirancang untuk mencegah orang memasuki area berbahaya di pabrik, untuk mencegah tabrakan kendaraan produksi, dll. Ini memiliki karakteristik yang lumayan - jangkauan maksimum: 15 / 50m (tergantung pada mode operasi ), keakuratan mengukur jarak di seluruh rentang pengukuran adalah 5 mm, resolusi sudut 0,36 derajat, kecepatan pemindaian 25 rpm (25000 pengukuran / detik).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perlu dicatat bahwa pemindai ini diposisikan secara tepat sebagai alat pengaman - yaitu pemindai ini menyimpan lokasi zona peringatan dan alarm di dalam memori, dan ketika sebuah objek memasuki zona ini, salah satu kunci terbuka di pemindai. Untuk mengkonfigurasi lokasi zona, pemindai dapat dihubungkan ke komputer dan mengamati lokasi hambatan di layar. Bahkan ada paket ROS yang memungkinkan Anda menerima data dari pemindai ini.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya dapat pemindai tanpa case, dibongkar menjadi komponen-komponennya. Pemindai jatuh karena pukulan keras ke tubuh; apa tepatnya berhenti bekerja, saya masih tidak mengerti - mungkin optik tidak selaras, kontak di salah satu konektor keluar, atau sensor encoder bergerak, atau yang lainnya. Saya mencoba merakit semua bagian bersama-sama, pemindai terlihat di perangkat lunak asli, tetapi pemindaian tidak dimulai. Jadi saya hanya punya satu cara untuk memulainya - mengembalikan sirkuit pemindai selengkap mungkin, dan menulis firmware mikrokontroler pemindai saya sendiri. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berikut adalah bagian-bagian yang saya tampak seperti: </font><font style="vertical-align: inherit;">
Di sini mereka harus berada dalam case (foto dari dokumentasi, dapat dilihat bahwa desain dan elektronik sedikit berbeda):</font></font><br>
<br>
<a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/52c/f37/092/52cf370928ab5d8ee92ff63432d49fbb.jpg" alt="gambar"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/77f/2b8/395/77f2b839587cb43a293ea58c34270b1c.jpg" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Juga bagian penting dari pemindai adalah cermin pemindaian (disorot dengan warna biru pada foto di atas) yang dipasang di tengahnya: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/16d/5db/5c6/16d5db5c60f0e710e0485fab2236e510.jpg" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diagram skematik pemindai: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/74e/9e5/8bd/74e9e58bdd529e60b5a823df47fdc6db.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti dapat dilihat dari diagram, seluruh elektronik pemindai terdiri dari modul terpisah (papan) yang dihubungkan oleh konektor dan loop. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada banyak modul - modul catu daya (DC-DC), modul antarmuka, modul prosesor, modul photodetector (APD), modul laser. Selain itu, ada juga modul encoder dan dua papan berbentuk tapal kuda, yang pada awalnya terasa aneh. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertama-tama, ada baiknya memperhatikan mereka:</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/957/fd1/ab6/957fd1ab64924ab5285c3442bae9e0fe.jpg" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jelas, salah satu papan berisi LED, dan yang kedua berisi fotodioda. Awalnya, saya pikir itu semacam encoder, atau semacam mekanisme untuk memeriksa radiasi laser. Namun, kemudian, setelah membaca dokumentasi untuk pemindai, dan setelah memeriksa foto-foto di dalamnya secara terperinci, saya menyadari bahwa ini adalah sistem untuk memantau keadaan permukaan kaca pelindung pemindai. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lubang untuk LED terlihat di foto: </font></font><br>
<br>
<img src="https://habrastorage.org/files/d08/12c/0e5/d0812c0e54544f7d9d6439be016575c7.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan mengukur tingkat sinyal dari fotodioda, Anda dapat memperkirakan tingkat transmisi kaca pelindung. Jelas, sistem ini tidak penting untuk pemindai, jadi saya tidak menggunakan papan ini di masa depan. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modul prosesor</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah bagian paling sulit dari pemindai. Beginilah tampilan elektronik modul dari dua sisi:</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/170/eb3/716/170eb3716ee18ad64d9e8ea5abf453d6.jpg" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk pertama kalinya saya melihat papan, saya segera menyadari bahwa pemindai menggunakan metode pengukuran jarak waktu penerbangan (TOF) - chip dengan tanda terbesar ternyata " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ACAM TDC-GPX</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ", yang sudah saya dengar. TDC - "Time-to-Digital Converter", yaitu, chip khusus yang dirancang untuk mengukur interval waktu dengan akurasi sangat tinggi, itu adalah yang digunakan untuk mengukur waktu "penerbangan" dari pulsa laser. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Juga ada mikrokontroler Infineon C167 dengan chip memori FLASH eksternal (yang senang) dan ASIC (yang sangat kesal). Lebih detail tentang modul ini saya akan ceritakan di bawah ini. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modul daya</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">berisi konverter DC-DC khusus yang diisolasi secara galvanis dengan beberapa tegangan output dan beberapa kapasitor: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/7c9/30a/1f5/7c930a1f510a7df150eb89654c4c82dd.jpg" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tegangan pasokan konverter adalah 24V. Fitur utamanya adalah menyediakan tegangan tinggi (~ 230V), yang diperlukan untuk pengoperasian laser dan fotodetektor, ke konektor kecil yang terpisah. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini juga menampilkan tegangan berikut ke konektor utama: + 5V, -5V, ~ 15V, diisolasi secara galvanis dari yang lain + 5V untuk antarmuka RS232. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagian optik pemindai</font></font></b><br>
<br>
<a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/b2c/f7d/4af/b2cf7d4af2cf9f75fe2659845d9887fb.jpg" alt="gambar"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada pandangan pertama, tidak terlalu jelas di mana optik pemindai berada. Dalam hal ini, jendela kecil dengan cermin di tengah foto berfungsi untuk menghasilkan sinar laser, dan permukaan mengkilap besar di sekitarnya adalah permukaan filter cahaya interferensi yang dipasang di depan lensa fotodetektor. Filter ini hanya memancarkan radiasi yang panjang gelombangnya dekat dengan panjang gelombang laser. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini adalah bagaimana hal itu ditunjukkan dalam dokumentasi pemindai: </font></font><br>
<br>
<img src="https://habrastorage.org/files/a6a/58d/c01/a6a58dc01c2a434398d2e8e4b35ccd3b.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lensa itu sendiri dipasang di dalam wadah plastik hitam, sehingga bermasalah untuk melihatnya. Pada akhir casing ini, berlawanan dengan apa yang terlihat pada foto di atas, </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">modul laser</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">photodetector</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> diperbaiki </font><font style="vertical-align: inherit;">: </font><b><font style="vertical-align: inherit;">Modul laser</font></b></font><br>
<br>
<a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/17a/c09/dcf/17ac09dcf9e6e59b2383d155d932e7a3.jpg" alt="gambar"></a><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tampilan modul laser (beberapa detail ditandai oleh saya selama menggambar sirkuit): </font><font style="vertical-align: inherit;">
Seperti yang Anda lihat, sirkuit modul ini cukup sederhana, jadi saya dapat sepenuhnya memulihkan sirkuitnya: </font><font style="vertical-align: inherit;">
Bagian bundar yang besar pada papan adalah penghasil laser khusus. </font><font style="vertical-align: inherit;">Sayangnya, tidak ada tanda di situ, jadi tidak ada dokumentasi yang bisa ditemukan. </font><font style="vertical-align: inherit;">
Dari uraian pada pemindai Anda dapat menemukan - “Panjang gelombang sinar laser - 905 nm”, “Kelas laser - 1”, “Durasi pulsa - 0,003 μs”, “Frekuensi pengulangan - 25 kHz”. </font><font style="vertical-align: inherit;">
Apa yang mungkin dipahami dengan mengembalikan sirkuit modul dan menganalisis operasinya:</font></font><br>
<br>
<a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/c28/71a/a61/c2871aa619e574fe9cb8f01b7c3e21db.jpg" alt="gambar"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/2d7/2c5/176/2d72c51767c4c239419dbcf2d35ff249.png" alt="gambar"></a><br>
<br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pemancar laser secara konstan disuplai dengan tegangan suplai 143 V, dibatasi oleh dioda zener.</font></font></li>
<li>       ,    «3» .   ,     ,     .</li>
<li>   ,        ,    .        ( )    «» .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semua kontrol laser dilakukan dalam satu baris - "LASER_PULSE". Sebagian besar waktu di telepon harus level "tinggi". Ketika pulsa negatif diterapkan, pemicu DD1 diatur ulang ke 0 pada tepi depan, dan pada tepi belakang, pemicu mulai "menunggu" untuk sinyal dari fotodioda dan laser mulai. Ketika sinyal dari fotodioda muncul, pelatuk beralih ke 1. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda dapat melihat dua kabel koaksial menggunakan konektor yang terhubung ke modul. Mereka digunakan untuk mengirimkan sinyal diferensial dari pelatuk ke chip TDC. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Juga pada modul ini ada lima LED. Modul prosesor mengontrolnya. </font><font style="vertical-align: inherit;">
Modul </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Photodetector</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Modul itu sendiri terlihat seperti ini: </font><font style="vertical-align: inherit;">
Foto photodetector itu sendiri dekat:</font></font><br>
<br>
<a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/a91/704/ae2/a91704ae269a7ce0761135bf935d1de8.jpg" alt="gambar"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/444/bb5/671/444bb5671b8daa4ba612f2e35b331ada.jpg" alt="gambar"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tanda tegangan tinggi di sudut papan jelas menunjukkan bahwa </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avalanche photodiode (APD)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> digunakan di sini </font><font style="vertical-align: inherit;">- mereka memerlukan tegangan yang cukup tinggi untuk beroperasi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sayangnya, tidak ada tanda yang terlihat pada badan fotodetektor. Dengan lambang pada fotodioda itu sendiri (di tengah), itu hanya mungkin untuk menentukan bahwa itu diproduksi oleh </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pacific Silicon Sensor (Sensor Pertama)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Namun, tidak ada informasi lebih lanjut tentang dia, mungkin dia dibuat khusus. Dapat dilihat dari foto bahwa photodetector ini adalah hybrid, mis. berisi penguat bawaan - terlihat jelas di atas fotodioda. Jelas, amplifier dan fotodioda membutuhkan daya - itu dimasukkan melalui terminal yang lebih rendah (kapasitor disolder ke mereka). Sebuah misteri besar adalah detail kecil di sebelah kiri fotodioda, di mana ada tiga konduktor. Penelitian lebih lanjut menunjukkan bahwa ini adalah sensor termal analog. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Modul ini jauh lebih rumit daripada yang sebelumnya, ia menggunakan papan sirkuit tercetak berlapis-lapis - setidaknya 4 lapisan, dengan sebagian besar garis sinyal terletak di lapisan luar papan, yang sangat memudahkan analisisnya. Dalam modul ini, saya memulihkan sekitar 80% dari rangkaian, sisanya tidak terlalu diperlukan untuk saya.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sirkuit yang dihasilkan dari modul photodetector: </font><font style="vertical-align: inherit;">
Di bagian atas sirkuit adalah sumber tegangan tinggi linier yang dapat disesuaikan untuk fotodioda longsor. Itu dapat menghasilkan tegangan stabil setidaknya 150 V. Sumber ini dikendalikan oleh DA1 DAC (LTC1451).</font></font><br>
<br>
<a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/5d6/508/5ea/5d65085eade00ed5135fbf19a85bb783.png" alt="gambar"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena pemindai didasarkan pada pencari jangkauan pulsa, tugas utama modul photodetector adalah untuk dengan cepat mendeteksi sinyal laser yang cukup lemah yang tercermin dari penghalang. Karena tingkat sinyal cahaya sangat kecil, itu hanya dapat dideteksi menggunakan avalanche phototodiode, yang memiliki gain sendiri. Dalam hal ini, sinyal dari fotodioda juga diperkuat oleh amplifier terintegrasi yang terintegrasi dalam photodetector. Karena fakta bahwa amplifier dibangun ke dalam tubuh photodetector, pengaruh gangguan pada sinyal yang berguna berkurang. Sinyal yang dihasilkan oleh photodetector (OUT_B) ditransmisikan ke chip DA4 tertentu, yang tampaknya merupakan penguat frekuensi tinggi lainnya. Setelah itu, sinyal ditransmisikan ke input langsung komparator kecepatan tinggi D1 (MAX9601).Sinyal referensi dari pembagi resistor (sekitar 50 mV) diumpankan ke input kebalikan dari komparator ini.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sinyal pada keluaran komparator adalah diferensial, ditransmisikan melalui kabel koaksial langsung ke papan modul prosesor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selain itu, sinyal dari output amplifier DA4 ditransmisikan ke beberapa jenis detektor puncak, yang "mengingat" tingkat maksimum pulsa yang diterima. Saya tidak mulai mengembalikan rangkaian simpul ini, dan menggambar pada rangkaian hanya tahap keluarannya (chip U1), sinyal yang darinya juga ditransmisikan ke modul prosesor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Salah satu bagian dari pemindai yang kurang jelas bagi saya adalah transistor Q3 yang dipasang pada output penguat RF. Dilihat oleh sirkuit, perlu untuk memungkinkan pelemahan sinyal pada output amplifier. Transistor ini dapat dikontrol menggunakan sinyal dari papan prosesor (line10 - “digi”).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda mungkin memperhatikan bahwa board memiliki chip EEPROM. Semua output sinyal dari chip ini terhubung ke papan prosesor. Rupanya, dalam rangkaian mikro ini beberapa parameter disimpan, unik untuk setiap papan fotodetektor, dan dicatat di dalamnya saat menguji papan. Secara khusus, ini dapat berupa kurva dari ketergantungan APD gain pada tegangan suplai, ketergantungan tegangan pada output sensor suhu pada suhunya, dan karakteristik serupa lainnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda dapat melihat bahwa kekuatan photodetector dapat dikontrol dengan mengatur level tertentu pada garis CLK, CS, CS2 yang terhubung ke DAC dan EEPROM.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Papan berisi beberapa sirkuit yang dirancang untuk memantau kondisinya. Anda dapat mengontrol level tegangan APD, suhunya (line7) dan ambang pembanding. Tegangan ini dikonversi oleh amplifier operasional DA3-DA5 dan dikirim ke papan modul prosesor. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kembali ke</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
modul </font><b><font style="vertical-align: inherit;">prosesor</font></b><font style="vertical-align: inherit;"> Modul ini adalah yang paling kompleks dari semuanya, ini berisi sejumlah besar sirkuit mikro multi-output, papan sirkuit tercetak lagi empat-lapisan, dan sebagian besar garis sinyal dipisahkan dalam lapisan dalam, yang secara signifikan mempersulit pemulihan sirkuit. </font><font style="vertical-align: inherit;">
Sangat sering ternyata trek beralih ke sisi lain papan. Untuk mencari dengan cepat di mana trek tertentu terhubung, saya harus menggunakan sikat seperti itu, terhubung ke multimeter (dalam mode panggilan):</font></font><br>
<br>
<a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/170/eb3/716/170eb3716ee18ad64d9e8ea5abf453d6.jpg" alt="gambar"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/281/d5d/e1c/281d5de1cb6b8e4c16daf6d4f1690f99.jpg" alt="gambar"> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya memulihkan sekitar 70% dari skema - sisanya saya tidak benar-benar membutuhkan. Block diagram dari modul prosesor: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/08d/3f6/60f/08d3f660f31927fd38ae94b82a953714.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diagram yang dihasilkan dari modul prosesor: </font><font style="vertical-align: inherit;">
Terlepas dari kenyataan bahwa saya menyebut modul ini "modul prosesor" di mana-mana, pada kenyataannya itu didasarkan pada </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">mikrokontroler Infineon SAK-C167CR-L33M</font></a><font style="vertical-align: inherit;"> . Ini memiliki 144 pin, dan dibangun di atas arsitektur C166 yang cukup lama. Mikrokontroler ini tidak memiliki memori non-volatile sendiri - perlu menghubungkan memori eksternal ke dalamnya melalui bus paralel. Untuk keperluan ini, pemindai memiliki chip memori Flash M29F400B (512K x 8 / 256K x 16). Juga, dua chip RAM terhubung ke mikrokontroler - IS61C6416AL-12 (64K x 16) dan K6R4016C1D (256K x 16).</font></font><br>
<br>
<a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/f5d/fef/0a7/f5dfef0a7e036ce6af8872997538b420.png" alt="gambar"></a><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda dapat melihat bahwa bus alamat terhubung ke semua sirkuit memori dengan pergeseran satu bit - jalur memori A0 terhubung ke jalur A1 dari mikrokontroler. Ini disebabkan oleh fakta bahwa alamat-alamat diatur pada bus alamat dalam byte, tetapi pengontrol dan memori 16-bit. Agar controller menulis byte tunggal ke RAM tanpa mempengaruhi byte tetangga dalam kata 16-bit, chip memori memiliki jalur khusus UBn, LBn. Solusi ini sangat umum pada perangkat dengan bus paralel dan dijelaskan secara rinci dalam dokumentasi untuk pengontrol.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetapi solusi lain dalam modul prosesor tidak sepenuhnya jelas bagi saya. Jika Anda melihat chip memori Flash U1, Anda akan melihat bahwa garis A14 chip terhubung ke ground. Jalur bus alamat pengontrol A15 yang sesuai tidak terhubung ke chip sama sekali. Hasilnya adalah pengontrol hanya memiliki akses ke setengah dari memori Flash. Situasi yang sangat mirip dengan chip RAM2 (DD3). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan chip RAM1 (DD2), situasinya agak berbeda - garis pengontrol A15 juga tidak terhubung, tetapi pada saat yang sama semua input alamat dari chip ini terhubung ke bus alamat, sehingga controller memiliki akses ke seluruh memori chip.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan sekarang Anda harus memperhatikan simpul pada elemen logis DX1, DX2, DD4. </font><font style="vertical-align: inherit;">Microcircuits inilah yang menentukan microcircuits memori mana yang dipilih oleh mikrokontroler. </font><font style="vertical-align: inherit;">Dapat dilihat bahwa mereka dikendalikan oleh sinyal berikut:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WRn - sinyal perekaman, level aktif - rendah. </font><font style="vertical-align: inherit;">Pada baris ini, mikrokontroler menetapkan level rendah ketika Anda perlu menulis beberapa data ke memori RAM eksternal</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A15 adalah jalur bus data yang sama yang tidak terhubung langsung ke salah satu chip memori.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSn0 adalah sinyal pemilihan chip khusus, level aktif rendah. </font><font style="vertical-align: inherit;">Baris ini terhubung ke decoder alamat yang terintegrasi dalam controller. </font><font style="vertical-align: inherit;">Setelah reset, pengontrol rendah.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RAM2_CE - terhubung ke GPIO controller dengan mengangkat ke tanah.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Logika pengoperasian simpul ini dijelaskan dengan baik oleh tabel: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/f49/171/c32/f49171c3210acdcfbac396e81b568a46.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang Anda lihat, tergantung pada status garis RAM2_CE, mikrokontroler akan bekerja dengan memori Flash atau dengan mikrosirkuit RAM2 (DD3), dan ruang alamatnya bertepatan. Perlu dicatat bahwa kapasitas memori dari sirkuit mikro ini adalah sama. Mungkin ini dilakukan untuk mempermudah memperbarui firmware perangkat. Ada pilihan lain - RAM yang dipasang 3 kali lebih cepat dari memori Flash, jadi setelah memulai controller dapat menyalin isi FLASH ke RAM2, setelah itu program dijalankan darinya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetapi level tinggi pada jalur A15 dengan jelas menentukan bahwa pengontrol akan bekerja dengan chip RAM (DD2). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Akibatnya, ternyata FLASH dan memori RAM1 bergantian di ruang alamat pengontrol:</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/130/d7a/ee6/130d7aee659a1839be0296586fe25024.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Area RAM yang sudah dijumpai disorot dengan warna merah - saat mengaksesnya, pengontrol akan mendapatkan akses ke data yang terletak di alamat (0x8000-0xFFFF). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Konfigurasi kompiler adalah non-sepele, dan, seperti yang saya sebutkan di atas, setengah dari Flash / RAM2 hilang. Mengapa pengembang pemindai tidak beralih antara FLASH dan chip RAM menggunakan jalur CSnX khusus dari pengontrol tidak jelas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang telah saya sebutkan, controller yang digunakan tidak memiliki Flash-memory, dan karenanya, Fuse-bits. Untuk mengonfigurasi beberapa parameter controller: lebar dan alamat bus data, parameter PLL digunakan resistor pull-down yang terhubung ke bus data. Controller itu sendiri memiliki resistor Pull-Up resistensi tinggi (&gt; 100 KOhm) yang terhubung ke seluruh bus. Jadi, karena resistor eksternal, kombinasi sinyal tertentu dibuat pada bus, yang dibaca pengontrol ketika dihidupkan. Ini menentukan pengaturan pengontrol yang diperlukan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam hal ini, kita berbicara tentang resistor R3-R6. Konfigurasi resistor yang dipilih konsisten dengan koneksi sinyal bus yang dihasilkan dan memberikan kecepatan clock pengontrol 33 MHz.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sinyal pulsa dari mirror encoder diumpankan ke input timer "T2IN" dari mikrokontroler melalui elemen logika ATAU D6. Input kedua chip ini terhubung ke GPIO controller, yang memungkinkan Anda untuk menonaktifkan pasokan pulsa ke input timer. Mengapa solusi seperti itu diperlukan, dan mengapa tidak mungkin mematikan timer secara terprogram, saya masih tidak mengerti. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang Anda harus memperhatikan chip TDC (DD1). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pemindai ini memiliki chip TDC-GPX - yang paling "canggih" dari semua yang ada dalam kisaran ACAM. Keakuratan yang diklaim untuk mengukur interval waktu hingga 10 ps RMS. Microcircuit memiliki 8 saluran input jalur LVTTL dan 2 saluran LVECL (diferensial).</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam pemindai ini, untuk mendapatkan keakuratan maksimum pengukuran waktu, input LVECL yang digunakan untuk menerima sinyal dari modul laser dan modul photodetector menggunakan empat kabel koaksial. Sinyal dari modul laser dimasukkan ke input dari DStart / DStartN, dan mulai menghitung waktu. Sinyal dari modul photodetector dimasukkan ke input DStop1 / DStop1N, DStop2 / DStop2N, dan menghentikan penghitungan waktu. Seperti yang dapat dilihat dari diagram, sinyal stop diterapkan segera ke dua saluran TDC, dengan polaritas terbalik. Karena ini, dimungkinkan untuk mengukur tidak hanya durasi "penerbangan" dari pulsa cahaya, tetapi juga lebar dari pulsa yang diterima.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TDC-GPX memiliki bus data 28-bit, tetapi dapat diubah ke mode 16-bit, yang digunakan pada pemindai. Bus alamat 4-bit, juga bergeser 1 bit, seperti halnya chip memori. Chip DD8, DD9, U2 digunakan untuk menghasilkan sinyal kontrol dari chip dan mencocokkan level - mikrokontroler bekerja dari 5V, dan TDC - dari 3.3V. Secara umum, sistem daya TDC cukup kompleks, bahkan ada penyesuaian otomatis dari tegangan suplai. Karena kerumitannya, saya tidak mulai menggambar diagram-nya - saya menduga itu tidak jauh berbeda dari datasheet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pemrograman mikrokontroler dan TDC akan dibahas nanti.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang saya sebutkan sebelumnya, chip ASIC khusus dengan tulisan "LEUZE98" dan "WATCHDOG" dipasang di papan tulis. Apa itu tidak diketahui. Dapat dilihat bahwa osilator kristal 20 MHz terhubung ke sirkuit mikro ini. Setelah saya dapat memprogram mikrokontroler, saya memastikan bahwa ASIC tidak mengganggu operasinya, dan tidak mengembalikan diagram koneksi ASIC. Sejauh yang saya mengerti, chip ini berkomunikasi dengan controller melalui bus paralel. Ada kemungkinan bahwa ASIC yang menghasilkan RESETn sinyal reset, yang me-reset pengontrol dan TDC. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Namun demikian, perlu untuk berurusan dengan beberapa rantai secara lebih rinci.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ternyata, sinyal kontrol laser "LASER_PULSE" dapat dihasilkan oleh mikrokontroler dan ASIC menggunakan simpul pada transistor T1, T2. Dalam hal ini, ketika dinyalakan, ASIC membuka transistor T1, sehingga pengontrol tidak dapat mengontrol laser. Karena itu, saya harus melepas resistor R24 ​​- dan laser mulai dikontrol secara normal oleh pengontrol. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sinyal kontrol cermin motor line_motor1 juga berasal dari ASIC (via diode D2). Karena itu, saya harus memotong trek di papan tulis dan menghubungkan sinyal ini langsung ke output bebas dari pengendali GPIO - P3.15.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hal yang paling aneh adalah bahwa saluran CS2 yang terhubung ke DAC yang dipasang pada papan sirkuit modul photodetector juga ternyata terhubung ke ASIC. Karena itu, pengontrol tidak dapat secara independen mengatur tegangan pasokan APD, dan menyalakan amplifier APD. Mungkin ini dilakukan untuk meningkatkan keandalan pemindai - pengaturan DAC yang salah dapat menyebabkan kegagalan APD. Saya juga harus menghubungkan baris ini ke pin GPIO gratis dari kontroler P3.4. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diketahui bahwa ASIC yang mengontrol tiga LED yang terpasang pada modul laser. Dua LED lagi yang menampilkan status pemindai (adanya penghalang di area kerja) dikendalikan dari pengontrol - jalur LN1, LN2. Baris-baris ini juga menuju ke papan modul antarmuka.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena pemindai dapat bekerja dalam sistem keamanan, papan prosesor memiliki sejumlah besar simpul untuk mendiagnosis kondisinya. </font><font style="vertical-align: inherit;">Prosesor (dan mungkin ASIC) dapat mendeteksi masuknya laser (menggunakan chip U3), mengontrol level beberapa tegangan suplai, tegangan suplai APD, suhu APD, dan ambang komparator pada papan fotodetektor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena fakta bahwa tegangan referensi ADC controller adalah 4.1V, sebagian dari tegangan yang diukur dikurangi dengan bantuan pembagi resistor - mereka dapat dilihat pada diagram di sebelah kanan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan sekarang bermanfaat untuk melihat lebih dekat pada metode menghasilkan </font><font style="vertical-align: inherit;">sinyal "digi" yang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tidak biasa</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang saya sebutkan sebelumnya dalam deskripsi modul photodetector.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diagram di bawah ini menunjukkan node dari modul prosesor (bawah) dan modul photodetector (atas):</font></font><br>
<br>
<a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/44d/9b6/e35/44d9b6e356033cbfe9f892c5b9838622.png" alt="gambar"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Panah menunjukkan koneksi modul menggunakan kabel. Di bawah ini saya akan menjelaskan operasi dari node ini, seperti yang saya mengerti. Dalam modul photodetector, sinyal dari output APD diperkuat oleh chip DA4, setelah itu ditransfer ke komparator D1. Jika level sinyal pada input komparator lebih dari 50 mV, maka level tinggi ditetapkan pada output komparator. Sinyal dari output komparator ditransmisikan ke modul prosesor. Pertama-tama, ia memasuki input TDC, yang menghitung waktu dari awal pulsa laser. Tetapi di samping itu, sinyal ini diumpankan ke input jam dari D-trigger DD1. Unit logis selalu dipasok ke input sinyal pemicu, dan pemicu itu sendiri dapat diatur ulang ke nol menggunakan garis GPIO dari pengontrol BASE5. Dengan demikian, pengoperasian komparator mengarah ke pemicu snap "1". Pemicu ini memiliki keluaran diferensial,sinyal yang diumpankan ke input chip D3, yang mengubahnya menjadi format LVTTL. Sinyal ini diumpankan ke input "digi" dari modul photodetector. Seperti yang saya sebutkan sebelumnya, menurut pendapat saya, tampilan sinyal ini mengarah pada melemahnya level sinyal pada input komparator.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertanyaan utamanya adalah mengapa ini diperlukan dan mengapa begitu sulit untuk diterapkan? Mengapa tidak mungkin membuat kedua node di papan modul photodetector? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya hanya bisa mengungkapkan asumsi saya. Mungkin sinyal perlu dilemahkan untuk menghindari transisi komparator atau detektor amplitudo ke saturasi. Mungkin - untuk mengurangi panjang pulsa yang diterima. Untuk kedua node, tidak mungkin ada tempat di papan photodetector. Pilihan lain juga mungkin - sinyal perlu dilemahkan hanya setelah memiliki waktu untuk mencapai TDC melalui kabel koaksial, yang membenarkan desain yang kompleks. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Penelitian menunjukkan bahwa sebelum memulai laser pulsa baru, perlu untuk mengatur ulang pemicu, jika tidak, pulsa tidak diterima. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modul antarmuka</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sayangnya, saya tidak menemukan foto yang bagus dari modul ini. Hanya ada satu ini: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/394/165/79a/39416579aee7e4e226a1dbc9225386f0.jpg" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada modul ini hanya dua konektor yang diinstal, yang dapat Anda hubungkan di luar pemindai. Salah satunya adalah RS-232 / RS-422, menurut yang kedua, daya disuplai ke pemindai, sinyal kontrol disediakan, dan sirkuit keselamatan terhubung di sini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Modul ini berisi konverter UART-RS232 / RS485 dan optocoupler isolasi galvanik (mereka dipasang pada papan kecil terpisah yang ditunjukkan di sebelah kanan), tombol daya dari sirkuit pengaman, sirkuit input dari garis kendali range finder, sirkuit kontrol motor, konverter sinyal encoder. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Modul daya dan modul prosesor, serta modul encoder dan motor cermin terhubung ke modul ini (menggunakan konektor di bagian bawah modul, mereka tidak terlihat di foto).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diagram parsial dari modul antarmuka: </font><font style="vertical-align: inherit;">
Saya hanya mengembalikan sebagian diagram rangkaian modul ini (sekitar 20%), karena saya tidak tertarik dengan kunci dan jalur input yang diperlukan untuk memastikan keamanan. Dan ada beberapa luka di sana, dokumentasi menyebutkan batas saat ini di sirkuit keselamatan, pemantauan hubung singkat, dan fungsi lainnya.</font></font><br>
<br>
<a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/6cb/b3b/711/6cbb3b71160b4d70462c898dac6263a5.png" alt="gambar"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agak anehnya mengendalikan kecepatan putaran motor cermin. Kontrol kecepatan diterapkan dengan mengubah tegangan motor - dengan ini, semuanya jelas. Tetapi penyesuaian tegangan ini sendiri dilakukan dengan bantuan rantai pengintegrasian tertentu pada penguat operasional. Untuk meningkatkan tegangan, pengontrol menetapkan 0 pada jalur line_mot1 untuk menurunkannya - 1. Jelas, tanpa umpan balik konstan dari pembuat enkode, motor berhenti atau berakselerasi ke kecepatan maksimum melalui pengontrol. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ternyata, chip konverter UART-RS232 LTC1387 cukup lambat - pada kecepatan 500 kbit / s, data terdistorsi. Karena itu, saya harus melepas papan kecil dengan chip ini, dan menghubungkan konverter USB-UART langsung ke papan modul antarmuka.</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sekarang saya sudah bicara tentang desain semua modul, ada baiknya untuk menguraikan proses rekayasa balik itu sendiri.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ketika saya mulai berurusan dengan elektronik pemindai, saya paling takut bahwa laser atau fotodetektor dapat rusak akibat dampak. Pada saat yang sama, saya tidak yakin bahwa saya akan dapat meluncurkan modul prosesor - mikrokontroler yang tidak dikenal dan ASIC merasa malu. Karena itu, pertama-tama, saya mengembalikan sirkuit modul laser, dan kemudian modul photodetector. Setelah saya dapat memahami sirkuit dari modul-modul ini dan menentukan tujuan dari semua kontak pada konektor mereka, adalah mungkin untuk melanjutkan ke modul prosesor. Sebagai upaya terakhir, jika saya tidak bisa memulainya, saya punya ide untuk membuat analog dari modul ini pada STM32 + TDC-GP2 microcircuits.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jelas, untuk memeriksa modul, Anda perlu menjalankan program Anda sendiri pada mikrokontroler Infineon SAK-C167CR yang terpasang di dalamnya. Sekali lagi, perlu diingat bahwa pengontrol ini tidak memiliki memori Flash bawaan. Selain itu, ternyata, controller tidak memiliki antarmuka debugging khusus (termasuk JTAG). Dengan tingkat probabilitas tinggi, firmware ditulis ke Flash eksternal di pemrogram di pabrik. Namun, ternyata, semuanya tidak terlalu buruk - pengontrol memiliki bootloader ("Bootstrap Loader"), bekerja pada UART. Bootloader ini disimpan di boot-ROM bawaan controller, jadi pasti ada di controller saya. Dan itu bekerja sangat aneh - untuk mengaktifkannya saat startup, Anda perlu mengatur jalur data bus P0L.4 ke rendah,setelah itu controller mulai menunggu byte 0x00 dari host muncul. Setelah menerima byte ini, bootloader secara otomatis menentukan kecepatan transfer, dan mulai menunggu 32 byte data yang disalin ke RAM internal controller. Setelah data diterima, pengontrol memulai eksekusi program yang diterima (16 kata pengontrol).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bahkan, dalam 32 byte ini Anda perlu mendorong loader lain ("preloader"), yang akan menerima "loader eksternal" loader utama dari host, dan mulai pelaksanaannya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sini saya beruntung - untuk prosesor ini sudah ada program FLASHit yang sudah jadi yang dapat melakukan semua operasi yang disebutkan secara otomatis. Pemuat yang dibangun di dalamnya memiliki cukup banyak fungsi - dengan itu Anda dapat secara otomatis menentukan model memori Flash yang dipasang, mengedit dan melihat isi register pengontrol, Anda dapat melihat status saluran ADC.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya tidak dapat menemukan bantalan uji di papan yang terhubung ke garis P0L.4 controller, jadi untuk memulai bootloader, saya harus menyolder pin khusus ke baris ini. Saya menempelkan pin ke kasing salah satu chip RAM. Untuk memulai bootloader, Anda harus menghubungkan pin ini melalui resistor 8 kΩ ke ground. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah saya menghubungkan papan ke komputer, dan menerapkan daya ke modul prosesor, mikrokontroler benar-benar muncul di FLASHit. Setelah itu, saya menulis sebuah program kecil di Keil yang mengganti salah satu pin pengontrol dan menulisnya di Flash. Program ini bekerja dengan baik, ASIC tidak ikut campur dengan cara apa pun (saya takut semacam mekanisme pengawas yang ada di dalamnya, atau konflik di bus), sehingga memungkinkan untuk melanjutkan.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah itu, saya memulihkan sirkuit modul prosesor, yang memungkinkan saya untuk memeriksa operasi semua modul dalam perakitan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yang pertama saya memeriksa pengoperasian modul laser - seperti yang saya tulis sebelumnya, untuk memulai pulsa laser, perlu menerapkan hanya satu sinyal ke modul ini. Laser bekerja - kilatannya bisa dilihat menggunakan kamera ponsel. Juga, menggunakan osiloskop, saya memeriksa bahwa modul biasanya membentuk pulsa (referensi). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berikutnya adalah pemeriksaan modul photodetector. Di sini saya harus memeriksa operasi DAC, unit pembangkit tegangan fotodioda longsor, dan unit kontrol daya dari penguat fotodetektor. Semuanya didapat, yang memungkinkan untuk memeriksa operasi pencari jarak itu sendiri. Untuk melakukan ini, saya mengumpulkan modul-modulnya dalam bentuk yang dimaksudkan oleh para pengembang:</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/462/307/8fe/4623078fe14cf75b455d285680f2ece8.jpg" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam foto itu, kelima modul utama dirakit bersama di sekitar sistem optik. Di sini, alih-alih cermin berputar saya sendiri, saya memasang cermin biasa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah itu, saya mengajukan program kontrol laser untuk UART, mengatur fotodioda. Sebagai hasilnya, ketika saya memulai laser pada input pembanding, saya benar-benar dapat mendeteksi pulsa dengan osiloskop yang amplitudo tergantung pada jenis penghalang di depan cermin! Komparator juga bekerja dengan baik. Bagian penting terakhir dari tes ini tetap - verifikasi kinerja TDC. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chip TDC-GPX yang dipasang pada pemindai memiliki desain yang agak rumit, dan dapat bekerja dalam sejumlah besar mode. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gambar di bawah ini menunjukkan diagram strukturalnya:</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/ab4/c21/6f6/ab4c216f68fe6e7785f763fd7619dc67.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang Anda lihat, chip berisi 8 saluran terpisah, yaitu, ia dapat menerima hingga 8 sinyal stop. Jika salurannya diferensial, maka hanya dua sinyal stop ditambah satu sinyal awal yang dapat dianalisis. Dalam hal ini, chip memungkinkan Anda untuk menggabungkan saluran pengukuran, sehingga meningkatkan akurasi interval waktu pengukuran:</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/a22/968/689/a22968689e8450060a016c0db84b9bad.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jujur, saya tidak suka dokumentasi untuk chip ini. Banyak hal di dalamnya dijelaskan secara dangkal, contoh kode tidak dapat dipahami. Bagian dari lembar data yang ditujukan untuk menyesuaikan resolusi waktu penuh dengan semacam "angka migrasi". Juga tidak ada "Catatan Aplikasi" yang normal pada chip. Selain itu, pada pemindai itu sendiri, saya tidak dapat mendeteksi koneksi jalur EF1 / EF1 ke controller. Dari garis-garis inilah maka dapat diketahui bahwa rangkaian mikro telah selesai mengukur waktu. Karena semua ini, memulai TDC membutuhkan waktu yang cukup lama, tetapi sebagai hasilnya semuanya bekerja sebagaimana mestinya - ketika laser mulai, TDC bekerja, dan hasil TDC jelas tergantung pada jarak ke rintangan. Dengan demikian, pencari jangkauan laser berdenyut mulai bekerja. Tetap mengubah seluruh struktur menjadi pemindai laser yang bisa diterapkan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Langkah pertama yang saya butuhkan untuk melakukan penyesuaian - pengintai yang berkumpul berhenti "melihat" hambatan setelah beberapa meter. Sistem optik terlihat utuh, tetapi saya harus melepaskan papan dari sistem optik, sehingga cahaya yang dipantulkan tidak secara tepat difokuskan oleh lensa pada photodetector. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebelum penyelarasan, saya menulis sebuah program untuk controller, yang tidak hanya menentukan jarak, tetapi juga mengukur amplitudo sinyal yang dihasilkan oleh detektor puncak menggunakan ADC. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seluruh proses penyesuaian dikurangi untuk kelancaran pergerakan photodetector dan papan laser, dan untuk mencari posisi mereka di mana amplitudo sinyal maksimum. Sebagai hasil dari penyesuaian, amplitudo sinyal yang diterima meningkat secara signifikan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selanjutnya, Anda harus memperhatikan beberapa fitur pemrosesan data yang melekat pada pengukur jangkauan pulsa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sinyal yang dihasilkan oleh photodetector memiliki bentuk analog. Untuk mengubahnya menjadi bentuk digital, yang selanjutnya diproses oleh TDC, komparator digunakan yang dikonfigurasi untuk beralih jika sinyal input melebihi ambang tertentu. Akibatnya, karena bentuk kompleks sinyal input, ketika mengubah amplitudo sinyal, kesalahan terjadi ketika menentukan interval waktu:</font></font><br>
<br>
<img src="https://img-fotki.yandex.ru/get/198361/14557097.6/0_10da03_2cd9184c_orig.bmp" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang dapat dilihat dari grafik, sinyal dengan amplitudo yang lebih rendah akan terdeteksi dengan penundaan. Untuk mengatasi masalah ini, ada beberapa metode, baik perangkat keras maupun perangkat lunak. Saya memutuskan untuk menggunakan opsi paling sederhana - koreksi hasil pengukuran tergantung pada amplitudo sinyal. Pada saat yang sama, saya harus mengumpulkan statistik tentang perubahan hasil pengukuran waktu dari perubahan amplitudo sinyal. Untuk mengubah amplitudo sinyal tanpa mengubah parameter lainnya, saya menggunakan pembalut kertas pada lensa, yang mengurangi insiden fluks cahaya pada fotodioda. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hasilnya adalah ketergantungan ini: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/0db/eee/642/0dbeee642afc3de178445fe45d3e2044.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berdasarkan ketergantungan ini, saya membentuk tabel koreksi, data yang digunakan oleh program pengontrol untuk menentukan jarak ke objek.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Langkah selanjutnya adalah memulai mesin mirror dan encoder. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebelumnya, saya sudah mengutip foto cermin: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/16d/5db/5c6/16d5db5c60f0e710e0485fab2236e510.jpg" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Motor cermin itu tanpa sikat, sangat mirip dengan yang digunakan pada kipas pendingin. Tiga kabel keluar dari sana - 2 di antaranya adalah kekuatan, yang lain adalah sinyal kecepatan pulsa. Semua kabel ini terhubung ke modul antarmuka, sedangkan sinyal kecepatan yang dihasilkan oleh motor tidak digunakan - kontrol didasarkan pada data dari encoder. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang dapat Anda lihat dari foto, disk transparan dengan label untuk enkoder ditetapkan pada sumbu mesin. Anda mungkin memperhatikan bahwa ada tanda nol pada disk.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Encoder dipasang di papan kecil dan sepenuhnya ditutupi dengan layar logam, sehingga penandaannya tidak dapat ditentukan. Namun, berdasarkan ukuran dan pinout, saya memutuskan bahwa itu adalah HEDS-9040 quadrature encoder: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/e13/b8a/134/e13b8a134252c787ef4fee9ae23161ae.jpg" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Empat kabel pergi dari papan encoder ke modul antarmuka, tetapi ternyata, hanya tiga dari mereka yang digunakan - dua catu daya dan sinyal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang saya pahami, pemicu Schmitt dan beberapa logika dipasang di papan tulis, menggabungkan data dari saluran A, B, dan indeks (sinyal tanda nol). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini adalah bagaimana sinyal yang dihasilkan oleh papan encoder dan sinyal indeks diambil langsung dari encoder.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/fef/43c/dd1/fef43cdd10c0302e460b266ba4a5124b.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti dapat dilihat, selama sinyal indeks, pulsa encoder ditekan. Ternyata, papan encoder menghasilkan 500 pulsa per revolusi, tetapi timer dari pengontrol T2, yang terhubung dengan garis encoder, dapat beroperasi secara bersamaan di kedua sisi pulsa, yang memberikan 1000 gangguan per putaran cermin. Nilai ini sesuai dengan resolusi sudut pemindai yang dinyatakan pada 0,36 derajat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya mengatur timer T2 ke "Capture mode", yang memungkinkan saya untuk mengukur waktu antara interupsi dari encoder. Waktu yang diperoleh digunakan untuk mendeteksi posisi "nol" dari cermin, dan untuk menstabilkan kecepatan putaran motor. Pada saat yang sama, jumlah gangguan dihitung, yang memungkinkan Anda untuk menentukan posisi cermin.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah encoder bekerja, dan saya berhasil memulai kontrol kecepatan mesin, dimungkinkan untuk merakit pemindai sepenuhnya. Karena bentuk papan dan optik yang rumit, desainnya ternyata agak rumit: </font><font style="vertical-align: inherit;">
Tidak mudah untuk merakit desain seperti itu - keakuratan pengaturan setiap bagian sangat penting bagi pemindai. Jika sumbu cermin tidak sesuai dengan sumbu optik bagian pengintai, ini dapat mengarah pada fakta bahwa bidang pemindaian akan sangat melengkung atau miring.</font></font><br>
<br>
<a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/16f/05e/cdd/16f05ecddefcb0016348678d7f587d8b.jpg" alt="gambar"></a><br>
<br>
<a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/2e6/71b/812/2e671b81234a099cbbe91cd55f9060c7.jpg" alt="gambar"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ketika mengukur jarak yang tepat ke objek, penting untuk memiliki semacam "referensi" objek, jarak yang diketahui dengan tepat. Mengetahui "waktu penerbangan" untuk itu, Anda dapat secara akurat menentukan waktu yang sesuai dengan jarak nol. Karena perubahan suhu komponen pemindai, kali ini dapat berubah, jadi kali ini harus dipantau terus-menerus. Untuk mengatasi masalah ini, saya memasang pelat hitam yang dihitamkan di pemindai: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/fcd/d14/a3b/fcdd14a3bbc74d42b8e75a734530e66d.jpg" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Piring itu menghitam sehingga cahaya yang dipantulkan darinya tidak "membutakan" photodetector. Dilihat oleh instruksinya, elemen pemantul gelap dan terang juga dipasang pada desain pemindai asli. Mereka digunakan untuk memantau operasi bagian pengintai pemindai, dan kemungkinan besar, mereka juga digunakan untuk kalibrasi.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada foto di atas, encoder yang terpasang di papan juga terlihat jelas. Ternyata, encoder harus diposisikan sangat tepat relatif terhadap disk, dan ada banyak masalah dengan ini - bahkan pergeseran kecil encoder menyebabkan hilangnya pulsa, terutama yang indeks. Ada kemungkinan bahwa pemindai berhenti bekerja setelah mengenai tubuh justru karena masalah dengan enkoder. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hasilnya, dimungkinkan untuk mendapatkan kecepatan pemindaian hingga 20 putaran per detik. Dengan tegangan APD 135 V, jarak hingga 10-15 m biasanya terdeteksi. Pada tegangan 145 V dan dengan pemfilteran sinyal tambahan, dimungkinkan untuk mengukur jarak hingga 30 m (walaupun saya tidak yakin apakah ini aman untuk photodetector).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perlu dicatat bahwa kecepatan transmisi maksimum pada pemindai asli adalah 115200 bit / s, yang memungkinkan Anda untuk mentransfer semua data hanya dengan kecepatan sekitar 11 putaran per detik. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang saya sebutkan, dalam firmware saya, saya mentransfer data pada kecepatan 500 kbit / s, yang secara signifikan dapat meningkatkan jumlah pemindaian yang ditransmisikan per detik. Karena batas kecepatan UART, saya tidak meningkatkan kecepatan pemindaian ke 25 putaran asli per detik. Saya perhatikan bahwa dalam desain asli pemindai, data diproses dalam pemindai itu sendiri, sehingga kecepatan transfer data yang rendah tidak terlalu memengaruhi apa pun. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena pemindai sekarang berfungsi tanpa perumahan, dimungkinkan untuk meningkatkan area pemindaian menjadi 208 derajat dibandingkan 190 dalam desain aslinya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Visualisasi data yang diterima dari pemindai:</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/ac1/8ae/f90/ac18aef90d3f6f6b083e373c0c80e144.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jelas, pemindai harus melakukan beberapa fungsi yang berguna, jadi saya memutuskan untuk memeriksa operasinya di ROS di SLAM, dan membandingkan hasilnya dengan hasil </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pemindai laser buatan sendiri</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Untuk melakukan ini, saya menginstalnya di Roomba, di mana pemindai buatan rumah sebelumnya diinstal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tampilan pemindai Leuze yang dipasang di Roomba (cermin berputar sehingga </font><font style="vertical-align: inherit;">
tampak </font><font style="vertical-align: inherit;">buram): </font><font style="vertical-align: inherit;">Sebagai hasil dari operasi hector_slam, kami berhasil mendapatkan peta apartemen seperti itu (dinding diperlihatkan dengan warna kuning): </font><font style="vertical-align: inherit;">
Karena penyedot debu bergerak di lantai, itu terutama “melihat” perabotan. </font><font style="vertical-align: inherit;">
Tetapi kartu semacam itu diperoleh jika penyedot debu hanya dilakukan di tangan setinggi sabuk: </font><font style="vertical-align: inherit;">
Dalam hal ini, dinding apartemen "lebih terlihat" lebih sering.</font></font><br>
<br>
<a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/dc1/c58/f5a/dc1c58f5a2ecf6eba47a9f880d3aefbc.jpg" alt="gambar"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/4fd/a8e/83d/4fda8e83dee18c10bfbd178f39a8b8e6.png" alt="gambar"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/4f4/3d8/ec3/4f43d8ec31a8f1a0a546f9d85c76cee7.png" alt="gambar"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika kita membandingkan kualitas kartu, jelas bahwa garis-garis pemindai buatan sendiri lebih "berisik". Hal ini disebabkan oleh fakta bahwa dengan pemindai buatan sendiri yang menggunakan prinsip triangulasi operasi, akurasi meningkat secara signifikan dengan meningkatnya jarak. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sayangnya, meskipun kualitas pemindaiannya sangat bagus, pemindai ini tidak cocok untuk robot otonom - pemindai ini memiliki dimensi terlalu besar dan konsumsi daya (sekitar 7,2 W).</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di mana lagi saya bisa menggunakan pemindai seperti itu? Sebelumnya, ketika membahas pemindai buatan sendiri, saya sering ditanya tentang kemungkinan membuat pemindai 3D, dan inilah saatnya membuatnya! Kecepatan pemindaian yang cukup tinggi berguna di sini. Tentu saja, dengan resolusi, pemindai seperti itu tidak dapat dibandingkan dengan pemindai yang menggunakan prinsip triangulasi pengukuran jarak (dengan garis laser atau proyektor (SLS)), tetapi mereka dapat memindai ruang besar - tempat, bagian jalan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk membuat ulang pemindai 2D dalam 3D, Anda harus memberikannya kemampuan untuk memutar sepanjang sumbu lain. Saya memutuskan untuk membuat pemindai saya menggunakan prinsip pemindaian berkas yang sama dengan pemindai dari </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artikel. Untuk melakukan ini, saya menempatkan pemindai Leuze "berbaring" sehingga bidang pemindaiannya tegak lurus ke lantai. Selanjutnya, perlu untuk mewujudkan rotasi lambat yang lancar dari seluruh pemindai di sekitar sumbu. Kesulitan utama - pemindai harus berputar tanpa denyut dan distorsi, yang akan menyebabkan distorsi pemindaian. Ternyata, di rumah sulit untuk membuat rakitan bantalan yang dapat memberikan rotasi yang akurat. Oleh karena itu, saya memutuskan untuk menggunakan kepala VHS dari tape recorder sebagai unit bantalan - ini berisi dua bantalan, dibuat dengan akurasi yang sangat tinggi dan mampu menahan berat pemindai. Desain yang dihasilkan digerakkan oleh motor stepper. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pemindai 3D rakitan terlihat seperti ini: </font><font style="vertical-align: inherit;">
Tampilan pemindai yang terpasang pada tripod:</font></font><br>
<br>
<a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/60d/967/07c/60d96707cb26b50daca5c06bcbee64e5.jpg" alt="gambar"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/167/77d/118/16777d118478b27a1b5ae56d449304d3.jpg" alt="gambar"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sebelah kiri adalah baterai 12 V, yang juga merupakan penyeimbang. Karena pemindai Leuze memerlukan 24 V untuk pengoperasian, saya harus menginstal konverter DC / DC step-up yang dirakit berdasarkan chip XL6009 pada pemindai. Motor stepper pemindai dikendalikan oleh modul pada A4988 dan Arduino, yang memberikan rotasi pada kecepatan tertentu. Baik pemindai Leuze (melalui adaptor USB-UART) dan Arduino terhubung melalui hub USB dengan kabel ke komputer yang menangkap data. Dalam bentuk saat ini, rotasi cermin pemindai dan rotasi seluruh pemindai tidak disinkronkan - kecepatan rotasi pemindai dipilih sehingga ketika diputar oleh 0,36 derajat, cermin punya waktu untuk membuat setidaknya tiga putaran. Karena tidak ada sinkronisasi kecepatan, saya harus mengirimkan informasi posisi sinkronisasi dari Arduino ke pemindai Leuze.Ini diterapkan cukup sederhana - ketika Arduino memutar pemindai untuk setiap 0,36 derajat, itu mengubah level sinyal di salah satu terminal. Sinyal ini dikirim ke modul prosesor pemindai (ke konektor yang tidak digunakan dari sensor status kaca pelindung). Informasi tentang keadaan sinyal ini ditransmisikan pada awal setiap pengiriman pemindai - dengan demikian program yang ditulis sendiri untuk PC yang mengontrol pemindai menerima informasi tentang pergerakan pemindai dan menentukan sudut putarannya.menerima informasi tentang pergerakan pemindai dan menentukan sudut rotasi.menerima informasi tentang pergerakan pemindai dan menentukan sudut rotasi.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pemindaian 3D tunggal yang dihasilkan oleh pemindai mengandung sekitar 350'000 poin. </font><font style="vertical-align: inherit;">Tentu saja, ini secara signifikan kurang dari pemindai profesional, tetapi masih cukup bagus, terutama jika Anda merekatkan beberapa pemindaian bersama. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contohnya adalah pemindaian tunggal sebuah ruangan: </font><font style="vertical-align: inherit;">
Contohnya adalah pemindaian ruangan yang dilem dari beberapa: Bagian yang </font><font style="vertical-align: inherit;">
dipindai dari pintu masuk: Sebuah </font><font style="vertical-align: inherit;">
video yang menunjukkan hasil pemindai yang dihasilkan:</font></font><br>
<br>
<a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/152/e40/f46/152e40f4695ab5321aa7de9f0bf00f45.png" alt="gambar"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/37c/376/a36/37c376a366c09c7b5c94cca47992d5f1.png" alt="gambar"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/592/ebd/33d/592ebd33da93487d27e38a2ca030025e.png" alt="gambar"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3SnqrfDCc70" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
→ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kode sumber program pengontrol di Github</font></font></a></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id396357/">https://habr.com/ru/post/id396357/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id396343/index.html">Apakah bintang-bintang akhirnya meledak?</a></li>
<li><a href="../id396345/index.html">Pencetakan korporat: jauh lebih banyak masalah daripada yang terlihat</a></li>
<li><a href="../id396347/index.html">Kontrol AC melalui Wi-Fi</a></li>
<li><a href="../id396349/index.html">"Teman teman saya bilang ...". Mengungkap gosip dan mitos tentang SSD</a></li>
<li><a href="../id396353/index.html">Tombol sentuh dengan lampu latar dari Cina untuk kerajinan DIY</a></li>
<li><a href="../id396359/index.html">SoftBank membeli ARM Holdings seharga £ 24 miliar</a></li>
<li><a href="../id396361/index.html">Pemilik Tesla Model S mengklaim bahwa autopilot mobil listriknya menyelamatkan pejalan kaki dari kematian</a></li>
<li><a href="../id396363/index.html">Windows 10 persis berumur satu tahun</a></li>
<li><a href="../id396365/index.html">HyperX Alloy FPS - Keandalan Di Atas Semua</a></li>
<li><a href="../id396367/index.html">Kode SMS otorisasi Telegram terus mencegat</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>