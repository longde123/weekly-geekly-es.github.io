<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üå∞ üôä üëäüèæ Rendimiento de la plataforma de negociaci√≥n con un ejemplo simple üòì ü§∏üèº ‚ô£Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En este art√≠culo, quiero hablar en una forma cient√≠fica popular sobre la optimizaci√≥n del tiempo de respuesta en las plataformas comerciales de bolsas...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Rendimiento de la plataforma de negociaci√≥n con un ejemplo simple</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/437626/"><img src="https://habrastorage.org/webt/ek/hb/e1/ekhbe1j_jv2gufmgexvlsgre-si.png"><br><p>  En este art√≠culo, quiero hablar en una forma cient√≠fica popular sobre la optimizaci√≥n del tiempo de respuesta en las plataformas comerciales de bolsas y bancos (HFT).  Como referencia, estamos hablando de tiempos de cientos de nanosegundos a cientos de microsegundos.  Para la mayor√≠a de las otras aplicaciones, muchos de los m√©todos de optimizaci√≥n a continuaci√≥n son irrelevantes simplemente porque no existen requisitos tan estrictos. </p><br><p>  Por lo general, consideramos el rendimiento en unidades de ancho de banda.  Por ejemplo en Gigaflops.  La tarea de optimizaci√≥n en tales casos se reduce a realizar la cantidad m√°xima de c√°lculos por unidad de tiempo o resolver el problema en el tiempo m√≠nimo.  El dise√±o del procesador est√° dise√±ado principalmente para lograr el n√∫mero m√°ximo de c√°lculos por unidad de tiempo y t√©cnicas de optimizaci√≥n est√°ndar para el mismo. </p><br><p>  Sin embargo, hay aplicaciones en las que el tiempo de respuesta es m√°s importante, por ejemplo, plataformas de negociaci√≥n en el comercio de computadoras (HFT), motores de b√∫squeda, rob√≥tica y telecomunicaciones.  El tiempo de respuesta es el tiempo de ejecuci√≥n de una operaci√≥n "√∫nica" de este tipo, por ejemplo, desde la recepci√≥n de un paquete con cotizaciones actuales del intercambio hasta el env√≠o de la orden para la operaci√≥n de intercambio.  De hecho, el tiempo de respuesta y el rendimiento (el n√∫mero de operaciones de este tipo por unidad de tiempo) est√°n estrechamente relacionados, pero la diferencia es fundamental.  A menudo es posible aumentar el rendimiento simplemente agregando hardware (m√°s servidores), pero mejorar el tiempo de respuesta de esta manera es problem√°tico (excepto en casos de cargas m√°ximas). </p><a name="habracut"></a><br><p>  Se utilizan varias t√©cnicas excelentes para optimizar el tiempo de respuesta.  Algunos mejoran tanto el tiempo de respuesta como el rendimiento al mismo tiempo, otros mejoran uno a expensas del otro.  Por ejemplo, para mejorar el rendimiento, el almacenamiento en b√∫fer es t√≠pico para procesar una matriz de paquetes a la vez.  Obviamente, para el tiempo de respuesta a un solo paquete, este enfoque es perjudicial. </p><br><p>  En las plataformas de negociaci√≥n, la estabilidad del tiempo de respuesta tambi√©n es muy importante.  La mayor√≠a de las ganancias y p√©rdidas ocurren durante los movimientos bruscos de los mercados, acompa√±ados de una actividad anormalmente alta.  La plataforma debe soportar tales cargas.  Cualquier enchufe puede causar p√©rdidas tangibles. </p><br><p>  En general, una optimizaci√≥n de tiempo de respuesta de tan bajo nivel es un tema complejo que requiere una buena comprensi√≥n de la pila de red, el n√∫cleo del sistema operativo, el rendimiento del procesador y la plataforma, y ‚Äã‚Äãla sincronizaci√≥n eficiente de subprocesos.  Mi tarea es explicar todas estas cosas complejas con un ejemplo simple y comprensible. </p><cut><br><h4>  Trabajo de oficina </h4><br><p>  Usemos la siguiente analog√≠a.  Imagine un grupo de personas trabajando en una oficina.  Las comunicaciones se producen mediante el intercambio de mensajes en papel (cartas).  Cada carta contiene el destinatario, el remitente y la tarea.  Las cartas se colocan en ciertas mesas de la oficina.  Hay empleados cuya tarea es recibir cartas del mundo exterior y ponerlas en las mesas.  Otros recogen cartas de las mesas y las pasan a los que toman las decisiones.  Cada tomador de decisiones trabaja solo con un cierto tipo de letras (o tareas). </p><br><p>  El tomador de decisiones lee las cartas destinadas a √©l y decide si esta tarea se completar√°, pospondr√° o ignorar√°.  Las tareas para la ejecuci√≥n se apilan en una tabla separada.  Los trabajadores especiales recogen cartas de esta mesa y las distribuyen a los artistas.  Algunas cartas deben ser respondidas fuera de la oficina, por ejemplo, enviar confirmaci√≥n al remitente externo. </p><br><p>  Para estar m√°s cerca de la realidad, compliquemos un poco m√°s las condiciones.  Por ejemplo, una oficina es una red compleja de habitaciones y pasillos, y diferentes tipos de trabajadores solo pueden ir a ciertos lugares donde tienen acceso.  Como dicen los matem√°ticos, sin p√©rdida de generalidad, supongamos que nuestra oficina, en condiciones normales, procesa 200 mensajes por d√≠a con un tiempo promedio de procesamiento de mensajes de 5 minutos. </p><br><p>  Entonces, nuestra tarea es minimizar el tiempo de procesamiento de mensajes.  En este caso, es deseable que el tiempo m√°ximo de procesamiento no exceda el promedio m√°s de, digamos, dos veces.  Es decir, los estallidos de actividad deben manejarse de manera efectiva. </p><br><p>  Entonces, ¬øpor d√≥nde empezamos?  La forma m√°s f√°cil de contratar m√°s empleados es procesar m√°s mensajes.  Es bueno buscar trabajadores r√°pidos, luego se reducir√° el tiempo de procesamiento.  Digamos que contratamos a Usain Bolt y a los otros finalistas ol√≠mpicos.  Quiz√°s el tiempo de procesamiento ha disminuido a 2 minutos.  Pero es obvio que no hay ning√∫n lugar para avanzar m√°s en esta direcci√≥n.  Nadie corre m√°s r√°pido.  Se alcanza el l√≠mite.  Al comparar estos enfoques con una computadora, la contrataci√≥n de personas est√° comprando hardware adicional (servidores, procesadores, n√∫cleos) para aumentar el n√∫mero de subprocesos de ejecuci√≥n.  Contratar atletas es similar a comprar el hierro m√°s r√°pido (frecuencia m√°xima en primer lugar). </p><br><p>  Quiz√°s el dise√±o de nuestra oficina no sea √≥ptimo.  Se debe proporcionar suficiente espacio para que los trabajadores trabajen eficientemente.  ¬øQuiz√°s ampliar los pasillos, de lo contrario la gente tiene que ceder el uno al otro, perdiendo un tiempo precioso?  Vamos a expandirnos.  Tambi√©n aumentemos ligeramente las salas para que las personas no se amontonen al acercarse a las mesas.  Es como comprar un servidor con m√°s n√∫cleos y m√°s memoria y ancho de banda de E / S. </p><br><p>  Adem√°s, podemos cambiar al servicio express en lugar del correo regular para intercambiar mensajes con el mundo exterior.  En t√©rminos inform√°ticos, esto es similar a seleccionar y optimizar el equipo de red y la pila de red del sistema operativo.  Todo esto es un costo adicional, pero suponemos que definitivamente valdr√° la pena. </p><br><p>  Entonces, despu√©s de las innovaciones, nuestro tiempo de procesamiento de mensajes cay√≥ a, digamos, un minuto.  Los trabajadores tambi√©n pueden recibir capacitaci√≥n para mejorar el proceso de comunicaci√≥n y ejecuci√≥n.  Quiz√°s esto le dar√° un 15 por ciento con la motivaci√≥n correcta.  √âl sabe que llegamos a 51 segundos.  Esto es similar a la optimizaci√≥n de software. </p><br><p>  El siguiente paso es tratar de evitar colisiones entre nuestros trabajadores en r√°pido movimiento.  El cuello de botella probable es el enfoque de las tablas.  Es aconsejable que los trabajadores tengan acceso instant√°neo y simult√°neo a los escritorios que necesitan.  Puede ordenar los mensajes en las tablas al colocarlos (ponerlos en carpetas separadas) para acelerar el acceso.  Los mensajes tambi√©n pueden tener diferentes prioridades.  En el programa, este es un an√°logo de sincronizaci√≥n de subprocesos.  Las transmisiones deben tener acceso ilimitado paralelo y m√°ximo a los datos.  La soluci√≥n de problemas de sincronizaci√≥n de subprocesos a menudo aumenta enormemente el rendimiento del sistema y ayuda a mejorar los tiempos de respuesta.  En el sentido de procesar r√°fagas de actividad, la influencia de un algoritmo de sincronizaci√≥n √≥ptimo es generalmente dif√≠cil de sobreestimar. </p><br><p>  Adem√°s, los trabajadores a veces pueden encontrarse frente a una puerta cerrada.  Otros problemas menores de esta naturaleza pueden causar inconvenientes y retrasos.  Es aconsejable cumplir con las siguientes condiciones: el n√∫mero de personas en un edificio dado nunca excede su capacidad, la velocidad de los trabajadores es ilimitada, no se toman medidas que no est√©n relacionadas con el trabajo principal, y nadie externo ingresa al proceso de trabajo.  En t√©rminos inform√°ticos, esto significa que el n√∫mero de subprocesos nunca excede el n√∫mero de n√∫cleos disponibles, la plataforma est√° configurada para una frecuencia / rendimiento m√°ximos, los modos econ√≥micos est√°n apagados, el modo Turbo est√° encendido y el n√∫cleo del sistema operativo y otras aplicaciones est√° aislado y (casi) no afecta a la plataforma de negociaci√≥n. </p><br><p>  Ahora es el momento de considerar a√∫n m√°s cuidadosamente las condiciones en la oficina.  ¬øLas puertas se abren f√°cilmente?  ¬øSe resbala el piso?  Esto es casi lo mismo que analizar las interacciones con el sistema operativo.  Si no hay nada que mejorar, puede intentar evitar el uso de ciertas partes.  Por ejemplo, en lugar de entregar cartas a trav√©s de la oficina, ¬øpor qu√© no intentar tirarlas de una ventana a otra?  ¬øDices inc√≥modo?  Puede ser inc√≥modo, pero r√°pido.  Esto es similar al uso del enfoque de derivaci√≥n del n√∫cleo en la pila de red. </p><br><p>  En lugar de utilizar la pila de red del sistema operativo, el bypass del n√∫cleo ejecuta la pila de red en el espacio del usuario.  Esto ayuda a deshacerse de la copia innecesaria de datos entre el sistema y la pila de usuarios y el retraso en la ejecuci√≥n del flujo de recepci√≥n de mensajes.  En el bypass del kernel, la secuencia de recepci√≥n generalmente espera activamente.  No se sienta en el bloqueo del sistema operativo, sino que verifica continuamente la variable de bloqueo hasta que le da permiso para ejecutar. </p><br><p>  De hecho, si comenzamos a lanzar mensajes a trav√©s de las ventanas, hag√°moslo de manera eficiente.  La opci√≥n m√°s confiable es pasar por la ventana de mano en mano.  Este principio se usa en el protocolo TCP.  Esta no es la opci√≥n m√°s r√°pida.  UDP le permite simplemente dejar caer un mensaje sin confirmaci√≥n.  Es mas rapido.  Nadie est√° obligado a esperar.  ¬øCrees que este es el l√≠mite?  No, a√∫n puede aprender a tirar por la ventana para que la letra caiga directamente en la tabla deseada y en la carpeta deseada.  Este enfoque se denomina acceso directo a memoria remota (RDMA).  Creo que redujimos el tiempo de procesamiento de segundos a 35. </p><br><p>  ¬øO tal vez construir una oficina desde cero en lugar de adaptar la existente a nuestras necesidades?  Tal que proporcione condiciones de trabajo ideales.  Quiz√°s esto mejorar√° el tiempo de respuesta de segundos a 20, o incluso menos.  El dise√±o de la propia oficina es el uso de la matriz de compuerta programable de campo (FPGA).  FPGA es algo as√≠ como un procesador cuyo hardware est√° programado para resolver un problema espec√≠fico.  Un procesador normal est√° codificado para ejecutar un conjunto espec√≠fico de instrucciones sobre ciertos tipos de datos y el hilo de ejecuci√≥n (que no debe confundirse con el hilo de la aplicaci√≥n) tambi√©n es fijo.  A diferencia del procesador, los FPGA no est√°n preprogramados para un conjunto de instrucciones, tipos de datos y flujo de ejecuci√≥n.  Est√°n programados para una tarea espec√≠fica y en este estado solo pueden ejecutarla (hasta la reprogramaci√≥n posterior).  La programaci√≥n efectiva de FPGA no es una tarea f√°cil.  Hacer cambios en el programa tambi√©n puede requerir mucho esfuerzo.  Y aunque FPGA no implica contratar a Usain Bolt (las frecuencias son mucho m√°s bajas que las del procesador), pero el paralelismo ilimitado de la ejecuci√≥n de la instrucci√≥n permite lograr tiempos de procesamiento de mensajes m√°s bajos que en el procesador. </p><br><p>  Bueno, en conclusi√≥n, recomendar√© herramientas de an√°lisis de rendimiento para software.  El amplificador Intel VTuneTM y la tecnolog√≠a Intel Processor Trace lo ayudan a ver en detalle d√≥nde y por qu√© se pierde el tiempo de CPU. </p><br><p>  Si est√° interesado en el tema, puede leer mis art√≠culos sobre Intel Developer Zone (en ingl√©s), que tambi√©n proporciona consejos t√©cnicos pr√°cticos para optimizar el tiempo de respuesta. </p><br><ul><li>  https://software.intel.com/en-us/articles/optimizing-computer-applications-for-latency-part-1-configuring-the-hardware </li><li>  https://software.intel.com/en-us/articles/optimizing-computer-applications-for-latency-part-2-tuning-applications </li></ul></cut></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/437626/">https://habr.com/ru/post/437626/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../437616/index.html">Seis meses sin ca√≠da de las ventas de CEO y iPhone: por qu√© caen las acciones de Intel</a></li>
<li><a href="../437618/index.html">42 operadores de b√∫squeda avanzada de Google (lista completa)</a></li>
<li><a href="../437620/index.html">C√≥mo la tecnolog√≠a en la nube est√° cambiando la forma en que tratamos</a></li>
<li><a href="../437622/index.html">Introducci√≥n al servicio Azure Machine Learning</a></li>
<li><a href="../437624/index.html">OpenSceneGraph: Conceptos b√°sicos de textura</a></li>
<li><a href="../437630/index.html">Los principales anuncios de Microsoft de la conferencia BETT</a></li>
<li><a href="../437632/index.html">Mash, los fundamentos del lenguaje</a></li>
<li><a href="../437634/index.html">Enrutador inal√°mbrico de bricolaje</a></li>
<li><a href="../437636/index.html">Publicaci√≥n de la aplicaci√≥n en Microsoft Store: algunos cambios para el a√±o</a></li>
<li><a href="../437638/index.html">"¬øCu√°l es el punto de respuesta?" REVISI√ìN DEL NEONIZADOR. Atmotubo y soldadura</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>