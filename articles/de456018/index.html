<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèπ üñºÔ∏è üå≠ So implementieren Sie eine Bereitstellung von GitHub auf einem Produktionsserver mithilfe von Webhook üëé üéΩ üëºüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ich habe lange die Gewohnheit, Repositories auf GitHub zu erstellen. Dies ist viel effektiver, als alles auf Google Drive oder, schlimmer noch, auf Ih...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>So implementieren Sie eine Bereitstellung von GitHub auf einem Produktionsserver mithilfe von Webhook</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/skillbox/blog/456018/"><img src="https://habrastorage.org/getpro/habr/post_images/a60/7c0/b39/a607c0b396ae120f0dc052183ad0700e.jpg"><br><br>  Ich habe lange die Gewohnheit, Repositories auf GitHub zu erstellen.  Dies ist viel effektiver, als alles auf Google Drive oder, schlimmer noch, auf Ihrer Festplatte zu speichern.  Hier stellt sich jedoch sofort die Frage: Wie wird auf einem funktionierenden Server bereitgestellt? <br><br>  Die meisten Suchanfragen brachten mich zu Jenkins und anderen Tools f√ºr die kontinuierliche Bereitstellung.  Aber ich wollte eine andere L√∂sung finden.  Also ging ich zum kostenlosen Webhook-Service. <br><a name="habracut"></a><br><blockquote>  <b>Skillbox empfiehlt:</b> Praktikum <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">"Mobile Developer PRO"</a> . <br><br>  <b>Wir erinnern Sie daran:</b> <i>F√ºr alle Leser von ‚ÄûHabr‚Äú - ein Rabatt von 10.000 Rubel bei der Anmeldung f√ºr einen Skillbox-Kurs mit dem Promo-Code ‚ÄûHabr‚Äú.</i> </blockquote><br>  Die technische Basis von Webhook ist das frische Digital Ocean-Tr√∂pfchen mit Ubuntu 16.04 als Produktionsserver.  Um die Anzahl der zur Implementierung des Plans erforderlichen Schritte zu verringern, werden alle Aktionen vom Root-Benutzer ausgef√ºhrt. <br><br><h3>  Beginnen wir mit Github </h3><br>  Wenn Sie ein Repository haben und es verwenden m√∂chten, k√∂nnen Sie diesen Schritt √ºberspringen - verwenden Sie einfach den SSH-URI, und fertig.  Wenn nicht, erstellen Sie eine und verwenden Sie auch den SSH-URI. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3ea/127/1d5/3ea1271d50f0493f426c5fb8b85e8f17.png"><br><br>  Installieren Sie Go und Webhook (Digital Ocean Droplet). <br><br>  Bevor Sie beginnen, lohnt es sich, ein kurzes Update und Upgrade mit dem neuen Ubuntu 16.04-Installationsprogramm durchzuf√ºhren. <br><br><pre><code class="plaintext hljs">sudo apt update -y &amp;&amp; sudo apt upgrade -y</code> </pre> <br>  Um WebHook zu installieren, m√ºssen Sie jetzt die Programmiersprache Go installieren.  Zum Zeitpunkt dieses Schreibens war Version 1.11.4 relevant. Wenn Sie also eine andere Version haben, m√ºssen Sie √Ñnderungen vornehmen. <br><br><pre> <i><code class="plaintext hljs">wget https://dl.google.com/go/go1.11.4.linux-amd64.tar.gz sudo tar -C /usr/local -xzf go1.11.4.linux-amd64.tar.gz export PATH=$PATH:/usr/local/go/bin</code></i> </pre> <br>  Es ist Zeit, die neueste Version von Webhook herunterzuladen. <br><br><pre> <i><code class="plaintext hljs">go get github.com/adnanh/webhook</code></i> </pre> <br>  W√§hrend des Downloads gibt es keinen Fortschrittsbalken, Sie m√ºssen also nur warten.  F√ºhren Sie nach Abschluss des Vorgangs ~ / go / bin / webhook aus. <br><br>  Webhook ist installiert, aber Sie m√ºssen ein Verzeichnis und eine Dateistruktur erstellen, damit alles ordnungsgem√§√ü funktioniert. <br><br><pre> <i><code class="plaintext hljs">mkdir ~/webhooks mkdir ~/webhooks/deployment-tutorial touch ~/webhooks/hooks.json touch ~/webhooks/deployment-tutorial/deploy.sh chmod +x ~/webhooks/deployment-tutorial/deploy.sh</code></i> </pre> <br>  Die Datei hooks.json ist f√ºr die Konfiguration und das Routing verantwortlich. Deploy.sh dient als Tool zum Ausf√ºhren der Befehle, die f√ºr das Upgrade von GitHub erforderlich sind. <br><br>  Der erste Schritt besteht darin, hooks.json durch √ñffnen in einem Texteditor zu konfigurieren.  Die Datei enth√§lt die Konfiguration f√ºr die Endpunkte, die nach dem Start von Webhook erstellt werden, und besteht aus einer Reihe von Objekten, von denen jedes ein eindeutiger Endpunkt ist. <br><br><pre> <i><code class="plaintext hljs">[{ "id": "deployment-tutorial", "execute-command": "/root/webhooks/deployment-tutorial/deploy.sh", "command-working-directory": "/root/deployed-site/", "response-message": "Executing deploy script...", "trigger-rule": { "match": { "type": "payload-hash-sha1", "secret": "The Returners", "parameter": { "source": "header", "name": "X-Hub-Signature" } } } }]</code></i> </pre> <br>  <b>ID</b> ist der eindeutige Name, der f√ºr die Endpunkt-URL verwendet wird. <br>  <b>execute-command</b> - ein Skript, das ausgef√ºhrt wird, wenn der Endpunkt aktiviert wird; <br>  <b>Befehlsarbeitsverzeichnis</b> - das Verzeichnis, das w√§hrend der Ausf√ºhrung des Befehls execute verwendet wird; <br>  <b>Trigger-Regel</b> - eine Option, die aus Gr√ºnden der Informationssicherheit verwendet wird. Dies ist eine geheime Phrase f√ºr Endpunkte. <br><br>  Ich m√∂chte Sie daran erinnern, dass ich alle Aktionen von root aus ausf√ºhre. Die Startadresse lautet also / root.  Wenn Sie sich als normaler Benutzer anmelden, m√ºssen Sie / home / username registrieren, wobei der logische Benutzername der Name dieses Benutzers ist.  Sie m√ºssen ~ / nicht verwenden, der Pfad muss absolut sein, sonst wird eine Fehlermeldung angezeigt. <br><br>  M√∂glicherweise haben Sie bemerkt, dass wir einen Arbeitsordner eingerichtet haben, der noch nicht vorhanden ist.  Bevor Sie es erstellen, m√ºssen Sie mit deploy.sh fertig sein. <br><br>  Das Skript sollte immer mit "shebang" beginnen.  Bevor Sie die Datei √∂ffnen, sollten Sie welche Bash ausf√ºhren.  Nun, dann werden die folgenden Befehle im Skript ausgef√ºhrt: <br><br><pre> <i><code class="plaintext hljs">#!/bin/bash git fetch --all git checkout --force "origin/master"</code></i> </pre> <br>  Jetzt sind sowohl Go als auch Webhook installiert. Sie m√ºssen die Konfiguration in hooks.json konfigurieren und ein Skript schreiben, das f√ºr die Bereitstellung verantwortlich ist.  Er √§ndert das Zielverzeichnis und arbeitet mit dem Hauptzweig des GitHub-Repositorys zusammen. <br><br>  Schlie√ülich ist es an der Zeit, Webhook in den aktiven Modus zu versetzen und 000.000.000.000 durch die funktionierende IP von Doplet zu ersetzen. <br><br><pre> <i><code class="plaintext hljs">/root/go/bin/webhook -hooks /root/webhooks/hooks.json -ip "000.000.000.000" -verbose</code></i> </pre> <br>  Zur Laufzeit stellen Sie m√∂glicherweise eine URL-Ausgabe mit {id} am Ende fest.  Dies ist die ID des Objekts, das bereits in der Datei hooks.json: Deployment-Tutorial erstellt wurde. <br><br><h3>  Einrichten von Git (Digital Ocean Droplet) </h3><br>  Das Server-Setup ist noch nicht abgeschlossen.  Um dies abzuschlie√üen, m√ºssen Sie ein neues Terminalfenster √∂ffnen und sich erneut auf dem Server authentifizieren, w√§hrend im ersten Fenster Webhook ausgef√ºhrt wird.  Ganz am Anfang haben wir den Repository-URI festgelegt, jetzt m√ºssen wir ihn verwenden. <br><br>  Wechseln Sie dazu in das in hooks.json angegebene Arbeitsverzeichnis und schreiben Sie Folgendes: <br><br><pre> <i><code class="plaintext hljs">git init git remote add origin git@github.com:jhsu98/deployment-tutorial.git</code></i> </pre> <br>  In diesem Fall m√ºssen Sie die URI durch Ihre eigene anstelle der von mir angegebenen ersetzen. <br><br>  Der letzte Schritt besteht darin, SSH-Schl√ºssel zu generieren, um mit ihrer Hilfe eine Verbindung zu GitHub herzustellen.  Geben Sie im Terminalfenster ssh-keygen ein und best√§tigen Sie mit der Eingabetaste, bis die Tasten generiert wurden.  Anschlie√üend m√ºssen Sie die √∂ffentlichen Schl√ºssel anzeigen, indem Sie cat ~ / .ssh / id_rsa.pub eingeben.  Sie bekommen so etwas: <br><br><pre> <i><code class="plaintext hljs">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCyzJrPVOJqsTqD2R3xirTp3VNMwpmJMyLklzJg4sRQyslTUmbNNmDVO573EbXQQf2PqPQljqKDDlSaELdav4OTi1gPCoDary300yUqC/efLGHflZ6pMNuGsP2zTzerD/TMjzl1FXF1wOGTXqcC4TvGBS1bFyUY5n8wSOJ8ntZ6bBNv0zA2t7X1vH8ahIBJLKCayq9ipobKlHPYqxBt6zAoeh/ILQ0PWhGkmbGqqzqN1jcVWOefLgj4Dl8bZWORS1nkqrVg2wFC2nnibH97kZLsNrdQaeK8jUrkUWkJcUELI02mkkqh2RtBx9EwQEvsm9YuDBD9xF+HyuWoAeqcKerb root@github-webhook-tutorial</code></i> </pre> <br>  Nun m√ºssen Sie nur noch das GitHub-Repository einrichten und die Bereitstellung testen. <br><br><h3>  Konfigurieren Sie den Bereitstellungsschl√ºssel und den Webhook (GitHub). </h3><br>  Wechseln Sie im Browser zu den Einstellungen f√ºr das Repository.  Zuerst m√ºssen Sie den Bereitstellungsschl√ºssel hinzuf√ºgen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d65/b02/3aa/d65b023aa5a398c8d6bae9d4227298bd.png"><br><br>  Wenn Sie einen Schl√ºssel hinzuf√ºgen, m√ºssen Sie seinen Namen angeben und in die obige Schl√ºsselausgabe einf√ºgen.  Mit GitHub k√∂nnen Sie nur mit √∂ffentlichen Schl√ºsseln arbeiten. Bei Bedarf m√ºssen Sie also mehrere Schl√ºssel angeben.  Sobald alles fertig ist, ist der Webhook-Bereich an der Reihe. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2da/4e1/936/2da4e1936888f9c617e3938199c24731.png"><br><br>  Die drei Felder in diesem Abschnitt erfordern besondere Aufmerksamkeit.  Dies sind Nutzlast-URL, Inhaltstyp und Geheimnis.  Die Payload-URL ist der Endpunkt, den Webhook abh√∂rt. Der Inhaltstyp ist das Datenformat. Secret ist die benutzerdefinierte Zeile aus der Datei hooks.json.  In unserem Fall ist es "The Returners". <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f7a/763/89e/f7a76389e9e6b66d1ad83eda89ef8e00.png"><br><br>  Nach dem Erstellen von Webhook sollte in den Einstellungen eine entsprechende Markierung angezeigt werden, die angibt, dass der Server verf√ºgbar ist.  Wenn Sie das Terminal mit einem funktionierenden Webhook √ºberpr√ºfen, k√∂nnen Sie feststellen, dass das Repository bereits in Betrieb ist. <br><br>  Um den Workflow zu √ºberpr√ºfen, kopieren Sie das Repository auf den lokalen Computer, falls dies noch nicht geschehen ist, und nehmen Sie √Ñnderungen am Hauptzweig vor.  Danach sollten sie auf dem Server angezeigt werden.  Fertig. <br><br>  Der Entwickler, der dies alles schon mehrmals getan hat, verbringt etwa 10 Minuten mit der Konfiguration.  Aber das ist nach Stunden des Versuchs und Irrtums.  Beachten Sie diese vier wichtigen Anpassungsfunktionen: <br><br><ul><li>  Stellen Sie sicher, dass Sie den absoluten Pfad f√ºr hooks.json verwenden. </li><li>  Machen Sie deploy.sh nicht ausf√ºhrbar. </li><li>  Best√§tigen Sie die SSH-Verbindungen w√§hrend des ersten ‚ÄûKontakts‚Äú von GitHub und dem Produktionsserver. </li><li>  Verwenden Sie nicht das fehlerhafte "shebang" im Bash-Skript. </li></ul><br><blockquote>  <b>Skillbox empfiehlt:</b> <br><br><ul><li>  Zweij√§hriger Praktikumskurs <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">"Ich bin ein PRO-Webentwickler</a> . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">"</a> </li><li>  Online-Kurs <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">"C # Entwickler mit 0"</a> . </li><li>  Praktischer Jahreskurs <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">"PHP-Entwickler von 0 bis PRO"</a> . <br></li></ul></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de456018/">https://habr.com/ru/post/de456018/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de456004/index.html">Wir laden Sie zu einem Front-End-Entwicklungstreffen mit stark ausgelasteten Diensten ein</a></li>
<li><a href="../de456006/index.html">Steigern Sie Ihren Umsatz mit In-App-K√§ufen</a></li>
<li><a href="../de456008/index.html">Entwicklung von Programmen f√ºr den Zentralprozessor Redd am Beispiel des Zugriffs auf das FPGA</a></li>
<li><a href="../de456010/index.html">Wie Java 10 die Art und Weise √§ndert, wie Sie anonyme innere Klassen verwenden</a></li>
<li><a href="../de456016/index.html">Protokoll f√ºr die Kommunikation zwischen iframe und dem Hauptfenster</a></li>
<li><a href="../de456022/index.html">QIWI JS DETOX</a></li>
<li><a href="../de456024/index.html">PHP 2019: Besser als Sie dar√ºber nachdenken</a></li>
<li><a href="../de456026/index.html">NeoQUEST-2019 von Angesicht zu Angesicht: Schie√üen Sie Drohnen ab und erstellen Sie ein VirusTotal im Taschenformat</a></li>
<li><a href="../de456028/index.html">Dub-Dub 2019: WWDC-Nachrichten und meine Eindr√ºcke</a></li>
<li><a href="../de456030/index.html">Figma - als ein einziger Punkt der Wahrheit im Design</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>