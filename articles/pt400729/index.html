<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëã üî£ üë®üèª‚Äçüíª Conectando fontes de alimenta√ß√£o, sensores e rel√©s controlados √†s placas-m√£e do servidor. Sem arduino ‚ôÄÔ∏è „äôÔ∏è üöà</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Conectando v√°rios sensores, sensores, rel√©s, expansores GPIO e outras instala√ß√µes ‚ÄúArduino‚Äù atrav√©s do barramento I¬≤C diretamente √†s placas-m√£e dos se...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Conectando fontes de alimenta√ß√£o, sensores e rel√©s controlados √†s placas-m√£e do servidor. Sem arduino</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/400729/"><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conectando v√°rios sensores, sensores, rel√©s, expansores GPIO e outras instala√ß√µes ‚ÄúArduino‚Äù atrav√©s do barramento I¬≤C diretamente √†s placas-m√£e dos servidores atrav√©s da interface IPMI do controlador on-board (BMC). Exemplos pr√°ticos de dispositivos I¬≤C e trabalhando com eles no utilit√°rio de linha de comando </font></font><code>ipmitool</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Gerenciamento de SMBus, PMBus e fonte de alimenta√ß√£o. Restri√ß√µes n√£o muito documentadas e problemas de seguran√ßa. Expondo a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propriedade</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></blockquote><br>
<img align="left" width="300" height="160" src="https://habrastorage.org/files/74c/158/4d9/74c1584d9f3341ddb97d685b82813161.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Depois de instalar o servidor em um design improvisado, √†s vezes voc√™ deseja conectar outra coisa a ele: por exemplo, temperatura, press√£o, sensores de umidade, telas de LCD ou mesmo drivers de motor PWM. Existem dispositivos externos defeituosos que precisam ser redefinidos remotamente e com hardware, usando rel√©s, n√£o n√≠veis, enquanto todo o servidor. Ou talvez o leitor s√≥ quisesse um pente GPIO com uma guirlanda de LEDs? Se esse n√£o √© um Raspberry Pi de placa √∫nica, mas um servidor de tamanho normal, voc√™ precisa desligar o microcontrolador e mexer com ele: escreva firmware, teste, estabele√ßa uma liga√ß√£o com o host etc. √Äs vezes isso √© interessante por si s√≥, mas acontece o contr√°rio: seria mais r√°pido escrever um script e execut√°-lo, finalmente, se apenas funcionar.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os conectores incomuns no ferro sempre suscitavam sentimentos contradit√≥rios de prurido t√©cnico de engenharia e fetichismo ventilat√≥rio no autor. </font><font style="vertical-align: inherit;">Esses conectores divertidos s√£o discutidos aqui.</font></font><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AVISO LEGAL</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ estiver lendo este artigo em algum lugar fora do portal Geektimes, recomendo que procure um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">link aut√™ntico</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> em uma semana ou duas </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">O fato √© que os coment√°rios mais interessantes dos leitores aparecer√£o l√° (ou seja, aqui) nas inser√ß√µes, n√£o estou falando em eliminar defici√™ncias e erros. </font><font style="vertical-align: inherit;">Acontece que os moradores irritados de um clube literalmente rasgam peda√ßos de um artigo ruim, enviando simultaneamente o autor a um abismo c√°rmico. </font><font style="vertical-align: inherit;">Em outras palavras, se um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">link aut√™ntico</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n√£o abrir, voc√™ n√£o deve ler mais al√©m deste local.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O autor envia seus cumprimentos para o Extremo Oriente (diretamente do c√©u sobre o Atl√¢ntico Norte) e tamb√©m pede desculpas aos rep√≥rteres por marcas comerciais respeitadas: eles n√£o precisam tanto de publicidade que eu forne√ßo nomes c√¥micos para eles. Assim, o artigo √© aplic√°vel aos produtos Super Miron, mas o autor tem poucas d√∫vidas sobre a presen√ßa de mecanismos semelhantes nos produtos de Kharlampiy-Pankrat, Ivan Bral Maryu, Iltan, Dolyan e outros: conectores divertidos podem ser encontrados com mais frequ√™ncia em fontes de alimenta√ß√£o e cestas de discos. Ao mesmo tempo, tentaremos expor o muito elogiado Kobzar Link.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Caros especialistas em plataforma de servidor, IPMI, I¬≤C, SMBus e PMBus, corrija se algo der errado. </font><font style="vertical-align: inherit;">Normalmente, o autor expressa gratid√£o aos leitores criativos com pontos c√°rmicos, mas pede desculpas aos moradores do clube por quem a gratid√£o j√° foi escrita, mas o OVNI n√£o ordena que fa√ßa isso duas vezes. </font><font style="vertical-align: inherit;">Desejo-lhe uma leitura agrad√°vel.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Do que era</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O autor n√£o tem vergonha de comprar placas-m√£e de servidores usadas por um centavo e dar a elas uma segunda vida. </font><font style="vertical-align: inherit;">Mec√¢nicas antigas e barulhentas de servidor (com fontes de alimenta√ß√£o) s√£o enviadas para o refugo e substitu√≠das por novos produtos, embora de classe de consumidor, mas de alta qualidade e tranquilidade. </font><font style="vertical-align: inherit;">Mas at√© as s√©ries Super Miron X8 e X9 vintage ainda produzem </font><font style="vertical-align: inherit;">NAS </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">impressionantes</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para pequenas empresas que combinam fun√ß√µes de empresa, uma ‚Äúm√°quina do tempo‚Äù de arquivo contra Trojans de ransomware e replica√ß√£o de rede ...</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zombando do programa amarelo</font></font></b><div class="spoiler_text">    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">FreeNAS</a>        Windows-,        USB-.    ,   1    -,   .   Linux? -  , . , -    1 ‚Äî   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a> (, ).   USB     <code>jail</code>  VirtualBox  ...</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em geral, h√° cerca de 20 anos, para a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fazenda coletiva</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> como GPIO, os artes√£os usavam uma porta paralela para a impressora, mas tentam encontr√°-la agora. </font><font style="vertical-align: inherit;">O mundo mudou, quanto a mim - para melhor :)</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inspe√ß√£o visual</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu j√° tenho um produto quase f√≥ssil, mas bastante funcional, X9SCM-F (Intel C204 Express), e seu irm√£o mais novo, X9SCL-F (C202), trabalha h√° alguns anos em uma instala√ß√£o pr√≥xima. Se voc√™ ligar o produto, como na documenta√ß√£o, com o conector de alimenta√ß√£o ATX de 24 pinos ao norte, as portas SATA estar√£o em algum lugar na √°rea de Khabarovsk. A leste, como Petropavlovsk-Kamchatsky, h√° um par de conectores T-SGPIO 1 e 2 que chamam a aten√ß√£o com a combina√ß√£o das letras "GPIO". O autor ativou essa combina√ß√£o, mas os reflexos do ge√≥logo-pesquisador da eletr√¥nica f√≥ssil se mostraram falsos. Na verdade, a palavra-chave aqui √© </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SGPIO</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, √© um barramento de sinaliza√ß√£o duplex por divis√£o de tempo usando quadros de comprimento constante. O barramento, por sua vez, transmite tr√™s bits para cada porta SATA: no HBA - o estado da cesta e na cesta - o estado dos discos (ativo, com falha, localizador). Esta √© uma tecnologia ultrapassada: cestas modernas usam I¬≤C. Eu n√£o me aprofundava muito, mas parece que seis portas SATA a bordo foram divididas em grupos de dois do norte e quatro do sul, e cada grupo pendurou seu pr√≥prio pente T-SGPIO. Pesado, desajeitado, mas para a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">agricultura coletiva</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tamb√©m in√∫til. V√° em frente, h√° um pequeno conector JWF1 na √°rea de Yuzhno-Sakhalinsk, mas √© apenas 5V de energia para a unidade SATA DOM, que eu n√£o tenho. No Extremo Oriente, n√£o h√° mais nada a fazer. Ao longo das fronteiras do sul se estende por toda uma s√©rie de conectores USB de 9 pinos e uma segunda porta RS232, tudo fica claro com eles. No noroeste do COM2, um par de jumpers JI2C1 / JI2C2 foi descoberto, permitindo o acesso a dispositivos PCIe. Este kit de ferramentas permaneceu um mist√©rio para mim at√© agora, mas tenho certeza de que, de fato, JI2C1 / JI2C2 s√£o as sa√≠das ao vivo do SCL e SDA, que s√£o simplesmente separadas da fonte de alimenta√ß√£o e do terra de 3,3V, que j√° est√£o no PCIe. Deixe por enquanto. O conector JTPM √© extremamente sofisticado, √© uma emerg√™ncia. E apenas o LED UID pode ser extra√≠do do conector JF1 do painel frontal, conectando-o ao opto-rel√©. A prop√≥sito, isso √© m. at√© conveniente: um resistor de termina√ß√£o j√° est√° integrado no circuito,acendeu o LED do UID - abriu (fechado) o rel√©. Para redefini√ß√£o remota</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">talvez </font><i><font style="vertical-align: inherit;">um dispositivo externo</font></i><font style="vertical-align: inherit;"> seja suficiente. O principal √© que o operador, depois de entrar na interface da Web do BMC um ano depois, n√£o acende o LED UID exatamente assim, ao mesmo tempo em que reinicia o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dispositivo externo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ok, estamos retornando ao extremo </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">servidor</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> norte, ele est√° l√°, pr√≥ximo √† pot√™ncia ATX e o conector JPI2C est√° localizado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Devo dizer que a documenta√ß√£o sobre JPI2C √© bastante otimista. Daqui resulta que esta √© a sa√≠da do barramento I¬≤C para monitorar a sa√∫de da fonte de alimenta√ß√£o ‚Äúnativa‚Äù. Fisicamente, o JPI2C √© um conector SL do tipo Molex de 5 pinos com passo de 0,1 "(2,54 mm) e uma </font><font style="vertical-align: inherit;">chave </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tola</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> com polaridade invertida, presumivelmente o c√≥digo de cat√°logo 70543-0004. A parte da resposta (na imagem no canto inferior esquerdo) √© Molex 70066-0179 para crimpagem Crimper (tamb√©m conhecido como </font></font><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BL-05F</font></font></nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">Suspeito que em todas as placas-m√£e Super Miron o barramento I¬≤C seja usado para monitorar a sa√∫de da fonte de alimenta√ß√£o do servidor e esteja conectado a um conector Molex SL de 5 pinos ( </font></font><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BL-05M</font></font></nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Olhando para o futuro, direi que alguns usu√°rios conseguiram engenharia reversa e encontraram uma maneira de remover todos os tipos de utilit√°rios, como temperatura e volts com amperes, de suas fontes de alimenta√ß√£o Super Miron nativas, continue lendo.</font></font><br>
<br>
<blockquote><img align="right" width="148" height="182" src="https://habrastorage.org/files/7e9/b96/f08/7e9b96f088bd4bcba512615f7e6be477.png"><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conector da fonte de alimenta√ß√£o I¬≤C</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O conector I¬≤C da fonte de alimenta√ß√£o, localizado em JPI2C, monitora o status da fonte de alimenta√ß√£o, da ventoinha e da temperatura do sistema. </font><font style="vertical-align: inherit;">Veja a tabela √† direita para defini√ß√µes de pinos.</font></font><br clear="all">
</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O conector JPI2C vazio provocou abertamente os pinos do barramento I¬≤C padr√£o: SCL, SDA, GND e VCC. </font><font style="vertical-align: inherit;">No meio est√° o alarme de falha da fonte de alimenta√ß√£o. </font><font style="vertical-align: inherit;">Olhando para o futuro, atrevo-me a sugerir que essa falha de energia √© a √∫nica maneira de acionar um alarme para um evento externo sem usar um microcontrolador externo. </font><font style="vertical-align: inherit;">Em seguida, encontramos o artigo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FAQ ID 9492,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de 30 de mar√ßo de 2010, que sugeria claramente a possibilidade de pesquisar o barramento I¬≤C diretamente da linha de comando. </font><font style="vertical-align: inherit;">Como a BMC est√° claramente envolvida no monitoramento da sa√∫de da fonte de alimenta√ß√£o e a equipe √© </font></font><code>ipmitool</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">claramente capaz de "conversar" com o barramento I¬≤C com fontes de alimenta√ß√£o, nada deve interferir na conex√£o de outra coisa √† JPI2C.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qual conector: BL ou BLS?</font></font></b><div class="spoiler_text">        MP3,    4- <i></i>,  CD-   . ,   <i></i>      <nobr>BLS-4</nobr>,   CD-          <i></i>,     . , ,       <i></i>     BL-04F,          .  MP3     ,  <i></i>       ...</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por que eu estou? </font><font style="vertical-align: inherit;">Al√©m disso, o conector JPI2C nas placas Super Miron se parece exatamente com o conector de √°udio em uma unidade de CD antiga; ele possui apenas 5 pinos em vez de 4. O JPI2C incluir√° um </font></font><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BLS-5</font></font></nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> simples de uma linha </font><font style="vertical-align: inherit;">, mas √© melhor ter um conector com uma chave de polaridade f√≠sica tipo </font></font><b><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BL-05F</font></font></nobr></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ao trabalhar com uma placa-m√£e j√° instalada no gabinete, ser√° muito f√°cil cometer um erro. </font><font style="vertical-align: inherit;">Economize seu tempo.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La√ßo universal</font></font></b><div class="spoiler_text"><img width="300" height="238" align="left" src="https://habrastorage.org/files/34f/8f4/335/34f8f4335b8a4b4bafd78c86b3b5ba78.JPG">     ¬´¬ª 40- ,     <i></i>    .     ,    , ..   .        <nobr>BLS-1</nobr> M-F, M-M  F-F.   aliexpress: ¬´dupont cable¬ª.</div></div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trabalhando com dispositivos I¬≤C na linha de comando</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Conectei um sensor BMP180, uma vez comprado no aliexpress, ao JPI2C. </font><font style="vertical-align: inherit;">No come√ßo, nada aconteceu. </font><font style="vertical-align: inherit;">O endere√ßamento como um todo tamb√©m ficou confuso, e o argumento de </font></font><code>bus</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">escolher um barramento n√£o √© claro de quantos. </font><font style="vertical-align: inherit;">Por√©m, acabei de criar um script para iterar (digitalizar) os barramentos e comparar o resultado do seu trabalho antes de conectar o BMP180 e depois. </font><font style="vertical-align: inherit;">Com o X9SCM-F, o sensor foi detectado imediatamente no barramento n ¬∞ 3 nos endere√ßos </font></font><code>0xee</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font><code>0xef</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(veja o coment√°rio abaixo). </font><font style="vertical-align: inherit;">Ser√° necess√°rio reorganizar o JI2C1 / JI2C2 na posi√ß√£o ENABLE e verificar se de repente as placas PCIe respondem ...</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ipmiscan.sh</font></font></b><div class="spoiler_text">      ,  -  progress bar  ,       (0, 1, 2  3).  bash 3.0+.<pre><code class="bash hljs"><span class="hljs-meta"><span class="hljs-meta">#!/bin/bash
</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">for</span></span> bus <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> 0 1 2 3; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>
        <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Bus <span class="hljs-variable"><span class="hljs-variable">$bus</span></span>
        <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> {16..238..2}; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span>
                <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span> -v args <span class="hljs-string"><span class="hljs-string">"i2c bus=%d 0x%02x 0x01"</span></span> <span class="hljs-variable"><span class="hljs-variable">$bus</span></span> <span class="hljs-variable"><span class="hljs-variable">$i</span></span>
                <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span> <span class="hljs-string"><span class="hljs-string">" 0x%02x"</span></span> <span class="hljs-variable"><span class="hljs-variable">$i</span></span>
                ipmitool <span class="hljs-variable"><span class="hljs-variable">$args</span></span> 2&gt;/dev/null &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"(bus </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$bus</span></span></span><span class="hljs-string">)"</span></span>
        <span class="hljs-keyword"><span class="hljs-keyword">done</span></span>
        <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">done</span></span></code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O script enumera apenas endere√ßos pares e n√£o toca nos </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reservados</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Em I¬≤C, o bit menos significativo √© um sinal de leitura e grava√ß√£o: cada dispositivo parece ocupar dois endere√ßos (leia em √≠mpar, escreva em par). Artigo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FAQ ID 9492</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> me confundiu, porque as enquetes apenas ainda. Mas no caso de </font></font><code>ipmitool</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ler ou escrever, n√£o √© determinado pelo endere√ßo, mas pelo contexto do comando, certo? A </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">especifica√ß√£o</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pesada do </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">IPMI 2.0</font></a><font style="vertical-align: inherit;"> coloca tudo no lugar: o bit menos significativo do endere√ßo no comando Master Read-Write ( </font></font><code>0x06 0x52</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">√© </font><font style="vertical-align: inherit;">geralmente reservado e deve ser redefinido (igual a zero). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O sensor BMP180, conectado ao JPI2C no X9SCM-F, respondeu a (barramento = 3) no endere√ßo </font></font><code>0xee</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(e </font></font><code>0xef</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">embora seja o mesmo). I.e. o endere√ßo l√≥gico do dispositivo acabou sendo</font></font><code>0x77</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, como deveria estar na folha de dados (a Bosch pegou o endere√ßo de 8 bits superior). Meu erro inicial foi procurar o BMP180 em um endere√ßo IPMI "bruto" </font></font><code>0x77</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, isso n√£o √© verdade. Para IPMI, basta multiplicar o endere√ßo l√≥gico de I¬≤C por dois (desloque um bit para a esquerda). Ao trabalhar com I¬≤C, esse √© o erro mais comum.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O √¥nibus I¬≤C pendurado assim √© desinteressante no ar, muito menos em um v√°cuo esf√©rico. </font><font style="vertical-align: inherit;">Uma plataforma bem conhecida, a pedido do "sensor i2c", oferecer√° a um leitor respeitado uma ampla gama de sensores j√° vinculados a miniplacas. </font><font style="vertical-align: inherit;">Normalmente, tudo o que resta √© soldar o pente de contato, para isso h√° desejo suficiente e um ferro de solda de 30W com solda e fluxo, habilidades n√£o s√£o necess√°rias. </font><font style="vertical-align: inherit;">Para testar a teoria, decidi medir a temperatura com o sensor BMP180, mas acabou sendo um pouco mais complicado do que eu pensava: o sensor √© um exemplo de um dispositivo stateful complexo e seria mais correto dizer ‚Äúextrair leituras de temperatura e press√£o de um medidor de precis√£o, considerando os coeficientes de calibra√ß√£o‚Äù. </font><font style="vertical-align: inherit;">Mas primeiro, ainda prestamos homenagem ao respeitado fornecedor.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fontes de alimenta√ß√£o para telemetria</font></font></b><div class="spoiler_text"> ,    .. , ,          :       ,  ,           ,     ,  .       IPMI,         .  DIY                 .<br>
<br>
 <b>Andrew Grekhov</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a>       ,    ,   .  ,   ,           .  ,       <code>ipmitool</code>      ,   -H, -U  -P,   <code><nobr>raw 0x06 0x52 0x07</nobr></code>      <code><nobr>i2c bus=3</nobr></code>, ¬´¬ª   , .   Master Read-Write  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> IPMI</a>.<br>
<br>
   <b>Andrew Grekhov</b>,          (  ) .  ,     PMBus,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a>  . .  PMBus     SMBus    ,   SMBus,   ,   I¬≤C.  ,            PMBus.        PMBus  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a>,   :    ?  ,   .<br>
<br>
,   ,     (),    , ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">PMBus rev 1.1</a>.    ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">www.pmbus.org</a>,        PMBus Specification Part II Rev. 1.1.     , .  26   APPENDIX I. Command Summary.  , ,  - 0x78 (STATUS_BYTE), 0x88 (READ_VIN), 0x89 (READ_IIN), 0x95 (READ_FREQUENCY)  :        ,      .    26,     (Read Byte  Read Word)    .    ,       byte  word?<br>
<br>
  :      I¬≤C    0x30 (COEFFICIENTS),     SMBus?  ,   -    ,   ..     ,      SMBus      0x30    2,          (0x88  READ_VIN)   ,       .        1 + 5 + 1    <i>m</i>, <i>B</i>  <i>R</i>,       .   ‚Äî ,  ‚Äî PEC ( ). ..    ,      SMBus  I¬≤C, ,  :<br>
<br>
<pre><code class="bash hljs">ipmitool i2c bus=3 0x70 0x07 0x30 0x02 0x88 0x01</code></pre><br>
      <code><nobr>0x30 0x02 0x88 0x01</nobr></code>     <code>0x70</code>,    ‚Ññ3,      7  (    ,   ,   PEC).        (   <code>0x78</code>,   ‚Äî  ),   7     6 ( PEC).   -      , ,    production,      :)    ,         ,    .</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Medi√ß√£o de temperatura com BMP180</font></font></b><div class="spoiler_text"><img width="200" height="200" align="left" src="https://habrastorage.org/files/ab5/0cc/82d/ab50cc82d6814350887749017115c4f1.jpg"> BMP180    .       ,        IPMI- <code>0xee</code>       .     BMP180 stateful-, ..    ( ..     ).  BMP180  BMP085,   ‚Äî BMP280,    .<br clear="all">
     ,      ,   .        <code>0x2e</code>   <code>0xf4</code>:<br>
<br>
<pre><code class="bash hljs">ipmitool i2c bus=3 0xee 0x00 0xf4 0x2e</code></pre><br>
 <code>0x00</code> ,        <code>0xee</code>,     .   4.5   16-  UT (¬´ ¬ª)   <code>0xf6</code>  :<br>
<br>
<pre><code class="bash hljs">ipmitool i2c bus=3 0xee 0x02 0xf6</code></pre><br>
     <code>0xf6</code>   <code>0xee</code> (..  <code>0x77</code>,  BMP180),       .  IPMI Master Write-Read     stateful-.<br>
<br>
   UT  <code>0x6a 0x48</code>,    27208 (.. -  27¬∞C  ¬´¬ª ,      BMP180, , ).   UT  <code>0x8000</code>,   ,     .<br>
<br>
       :     AC5, AC6, MC  MD   <code>0xb2, 0xb4, 0xbc</code>  <code>0xbe</code>, ,    <i></i>   (,   !).<br>
<br>
<p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>X</mi><mn>1</mn><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>U</mi><mi>T</mi><mo>&amp;#x2212;</mo><mi>A</mi><mi>C</mi><mn>6</mn><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#xB7;</mo><mi>A</mi><mi>C</mi><mn>5</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><msup><mn>2</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>15</mn></mrow></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.533ex" height="3.037ex" viewBox="0 -950 12715.8 1307.5" role="img" focusable="false" style="vertical-align: -0.83ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMATHI-58" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-31" x="852" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-3D" x="1630" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-28" x="2687" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMATHI-55" x="3076" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMATHI-54" x="3844" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-2212" x="4770" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMATHI-41" x="5771" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMATHI-43" x="6522" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-36" x="7282" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-29" x="7783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-22C5" x="8394" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMATHI-41" x="8895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMATHI-43" x="9645" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-35" x="10406" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-2F" x="10906" y="0"></use><g transform="translate(11407,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-32" x="0" y="0"></use><g transform="translate(500,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-35" x="500" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>X</mi><mn>1</mn><mo>=</mo><mo stretchy="false">(</mo><mi>U</mi><mi>T</mi><mo>‚àí</mo><mi>A</mi><mi>C</mi><mn>6</mn><mo stretchy="false">)</mo><mo>¬∑</mo><mi>A</mi><mi>C</mi><mn>5</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><msup><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mn>15</mn></mrow></msup></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1">X1=(UT-AC6)¬∑AC5/2^{15}</script></p><br>
<p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>X</mi><mn>2</mn><mo>=</mo><mi>M</mi><mi>C</mi><mo>&amp;#xB7;</mo><msup><mn>2</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>11</mn></mrow></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mn>1</mn><mo>+</mo><mi>M</mi><mi>D</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="28.488ex" height="3.037ex" viewBox="0 -950 12265.8 1307.5" role="img" focusable="false" style="vertical-align: -0.83ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMATHI-58" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-32" x="852" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-3D" x="1630" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMATHI-4D" x="2687" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMATHI-43" x="3738" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-22C5" x="4721" y="0"></use><g transform="translate(5222,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-32" x="0" y="0"></use><g transform="translate(500,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-31" x="500" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-2F" x="6530" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-28" x="7030" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMATHI-58" x="7420" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-31" x="8272" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-2B" x="8995" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMATHI-4D" x="9996" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMATHI-44" x="11047" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-29" x="11876" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>X</mi><mn>2</mn><mo>=</mo><mi>M</mi><mi>C</mi><mo>¬∑</mo><msup><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msup><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mo stretchy="false">(</mo><mi>X</mi><mn>1</mn><mo>+</mo><mi>M</mi><mi>D</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2">X2=MC¬∑2^{11}/(X1+MD)</script></p><br>
<p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>B</mi><mn>5</mn><mo>=</mo><mi>X</mi><mn>1</mn><mo>+</mo><mi>X</mi><mn>2</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.15ex" height="2.211ex" viewBox="0 -772.3 6523 952" role="img" focusable="false" style="vertical-align: -0.417ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMATHI-42" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-35" x="759" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-3D" x="1537" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMATHI-58" x="2594" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-31" x="3446" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-2B" x="4169" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMATHI-58" x="5170" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-32" x="6022" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>B</mi><mn>5</mn><mo>=</mo><mi>X</mi><mn>1</mn><mo>+</mo><mi>X</mi><mn>2</mn></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-3">B5=X1+X2</script></p><br>
<p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>T</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>B</mi><mn>5</mn><mo>+</mo><mn>8</mn><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><msup><mn>2</mn><mn>4</mn></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mn>10</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.34ex" height="3.174ex" viewBox="0 -1009.3 8757.4 1366.8" role="img" focusable="false" style="vertical-align: -0.83ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMATHI-54" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-3D" x="982" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-28" x="2038" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMATHI-42" x="2428" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-35" x="3187" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-2B" x="3910" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-38" x="4911" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-29" x="5411" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-2F" x="5801" y="0"></use><g transform="translate(6301,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-32" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-34" x="707" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-2F" x="7255" y="0"></use><g transform="translate(7756,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/400729/&amp;usg=ALkJrhjkLhdcyVkkF1R-oqbdMWPG7Mdx7g#MJMAIN-30" x="500" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>T</mi><mo>=</mo><mo stretchy="false">(</mo><mi>B</mi><mn>5</mn><mo>+</mo><mn>8</mn><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><msup><mn>2</mn><mn>4</mn></msup><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>10</mn></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-4">T=(B5 + 8)/2^4/10</script></p><br>
<br>
    10, ..       .        <i>  </i>,      ,     15      11  . ,      ,            <code>0xf4</code>. ?  ,   :)<br>
<br>
   <b>41j</b>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a>.</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GPIO</font></font></b><div class="spoiler_text"><img width="300" height="278" align="left" src="https://habrastorage.org/files/f44/adf/b7b/f44adfb7be3544f89ce78626ac54bbfb.JPG">       ,  ,   ,          .  BMP180    I¬≤C     8-  GPIO   PCF8574AT.<br>
 ,  PCF8574A (   PCF8574)     <code>0x38</code> ( PCF8574  <code>0x20</code>),        .  ,  , -      8 ,         .        8 ,   64  GPIO.   , .   I¬≤C   .</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interruptor I¬≤C</font></font></b><div class="spoiler_text"><img width="300" height="213" align="left" src="https://habrastorage.org/files/062/0b8/71c/0620b871c4984efea9f0f5ecb03c7a4e.JPG"> ,       BMP180,    <code>0x77</code> (.. <code>0xee</code>)  ?      ,   (),       TCA9548A     -  ,    .  ()   8  ,        . <s>       ,          GPIO,     .</s>    : -     I¬≤C SDA  SCL,     .  , ,   8   BMP180,     c    A0-A2      <code>0x70</code> (. <code>0xe0</code>   <code>ipmitool</code>).   A0=A1=A2=1      <code>0x77</code>, , ,    BMP180. ,   TCA9548A,    I¬≤C    56   -.        ,      .  , ,       .</div></div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Limita√ß√µes</font></font></h4><br><font style="vertical-align: inherit;"></font><code>ipmitool(1)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conduzi </font><font style="vertical-align: inherit;">
todos os experimentos usando o </font><font style="vertical-align: inherit;">comando v1.8.15, que funciona atrav√©s da interface do host do FreeBSD 10. Se voc√™ usar esse comando em scripts, ter√° que analisar sua sa√≠da, al√©m disso, stderr, n√£o stdout. Eu evito especificamente analisadores neste artigo. Ficaria agradecido se algum dos leitores compartilharia </font><font style="vertical-align: inherit;">bibliotecas </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comprovadas</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> por trabalhar com IPMI por meio da interface do host em linguagens de script populares (perl, Python), pelo menos no modo de comando bruto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Embora</font></font><code>ipmitool(1)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e pode funcionar em uma rede (623 / tcp), quando o host no JPI2C est√° desligado, n√£o h√° energia em espera, o barramento √© desenergizado. N√£o tentei ligar os sensores separadamente e interrog√°-los atrav√©s da interface de rede IPMI com o host desligado. Mas se voc√™ precisar de sensores aut√¥nomos conectados √† rede, √© melhor usar um dispositivo de placa √∫nica, por exemplo, o mesmo Raspberry Prog (desculpe, liguei para o Raspberry Pi no meu </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artigo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sobre a prote√ß√£o de cart√µes microSD contra desgaste prematuro, mudando para o sistema de arquivos somente leitura).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como j√° mencionado, o m√©todo descrito aqui sem um microcontrolador externo praticamente elimina a rea√ß√£o a interrup√ß√µes por eventos externos, exceto pelo sinal "falha na fonte de alimenta√ß√£o". </font><font style="vertical-align: inherit;">Teoricamente, um sinal de falha de energia pode gerar um evento SNMP, mas eu n√£o tentei. </font><font style="vertical-align: inherit;">E aqui novamente quero dizer: se forem necess√°rias interrup√ß√µes nos sensores, precisamos de um microcontrolador ou, na pior das hip√≥teses, de uma placa √∫nica dedicada. </font><font style="vertical-align: inherit;">C√©sar √© C√©sar.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gerenciamento de Conflitos I¬≤C</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se n√£o houver uma fonte de alimenta√ß√£o "nativa" no barramento I¬≤C, gra√ßas a Deus h√° menos problemas. Mas se uma fonte de alimenta√ß√£o ‚Äúnativa‚Äù com uma interface I¬≤C aparecer no sistema, em teoria, n√£o √© proibido conectar outros dispositivos em paralelo, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ap√≥s a montagem do</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adaptador correspondente. O que acontecer√° neste caso? Se todos os dispositivos estiverem em seus endere√ßos, nada de ruim deve acontecer at√© que o host decida </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">controlar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> rigidamente </font><font style="vertical-align: inherit;">a fonte de alimenta√ß√£o. Se voc√™ n√£o sabe o que est√° fazendo, limite-se √† leitura. A julgar pelo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FAQ ID 9492</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , as fontes de alimenta√ß√£o (simples, duplas, triplas) est√£o localizadas em endere√ßos l√≥gicos </font></font><code>0x38, 0x39, 0x3a, ...</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(s√£o endere√ßos IPMI divididos ao meio).</font></font><br>
<br>
<img width="209" height="241" align="left" src="https://habrastorage.org/files/e66/b36/5f5/e66b365f54d548bca3726e6f4458dd30.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eu tenho uma teoria sobre o IPMI e seu papel no acesso ao I¬≤C: se todos os comandos de grava√ß√£o selecionam apenas um registro para leitura subseq√ºente, cada intera√ß√£o com o dispositivo se encaixa em um comando IPMI Master Write-Read. A partir da </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">especifica√ß√£o IPMI 2.0,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> muito pesada </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">,</font></a><font style="vertical-align: inherit;"> eu recomendo que voc√™ leia o par√°grafo 22.11, que descreve este comando. No meu entendimento, uma </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">opera√ß√£o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no barramento I¬≤C est√° lendo ou gravando uma sequ√™ncia de bytes em um √∫nico endere√ßo. Mas a especifica√ß√£o IPMI com o comando Master Write-Read introduz algo mais: um par de opera√ß√µes de grava√ß√£o / leitura, conveniente para sensores, assemelha-se a uma </font><i><font style="vertical-align: inherit;">transa√ß√£o</font></i><font style="vertical-align: inherit;"> completa</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Al√©m disso, o IPMI estipula comprimentos m√°ximos de buffer (cerca de 30 bytes). Tamb√©m presumo que (a) o BMC √© sempre o dispositivo principal no barramento I¬≤C e (b) o BMC possui um mecanismo de travamento interno, ou seja, ele n√£o tentar√° pegar o √¥nibus dele no meio da transa√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Supondo que o comando IPMI Master Write-Read (de duas opera√ß√µes) seja realmente uma transa√ß√£o indivis√≠vel, o BMC faz mais do que apenas exibir I¬≤C: √© um </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">suplemento transacional</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">acima de I¬≤C, al√©m disso, com um host ou interface de rede. </font><font style="vertical-align: inherit;">Em outras palavras, acaba sendo uma pilha de protocolos primitiva de 4 n√≠veis para trabalhar com sensores de I¬≤C por meio da interface IPMI, que ousei desenhar. </font><font style="vertical-align: inherit;">Se um leitor respeitado n√£o gostou da imagem, imagine que eu sou um artista e veja o mundo assim, lembre-se essencialmente, por favor :) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ali√°s, o barramento SMBus, al√©m de contatos adicionais, difere do I¬≤C precisamente no modo batch, e a </font><font style="vertical-align: inherit;">opera√ß√£o Write / Read √© </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">definida</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nele. </font><font style="vertical-align: inherit;">Bloquear </font><font style="vertical-align: inherit;">Mas isso j√° faz parte do protocolo do barramento SMBus, o IPMI nesse caso desempenharia o papel de um wrapper operacional simples, em vez de um suplemento transacional. </font><font style="vertical-align: inherit;">No entanto, os comprimentos m√°ximos de bloco nas especifica√ß√µes IPMI e SMBus s√£o t√£o semelhantes que eu assumo uma conex√£o direta entre eles, sem sequer mergulhar fundo no assunto.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seguran√ßa</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um BMC conectado a uma rede de computadores √© um servidor e √© potencialmente vulner√°vel. </font><font style="vertical-align: inherit;">√â por isso que, por exemplo, √© necess√°rio fortalecer as medidas de seguran√ßa no console do sistema operacional "local", que atrav√©s do KVM virtual √© de fato exposto √† rede. </font><font style="vertical-align: inherit;">O firmware antigo dos controladores BMC Super Miron cont√©m uma </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vulnerabilidade</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> desagrad√°vel </font><font style="vertical-align: inherit;">; portanto, a opera√ß√£o deve come√ßar com a atualiza√ß√£o do firmware BMC (al√©m do BIOS).</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Controle clim√°tico com feedback</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alguns fabricantes trazem a id√©ia do enforcamento, por assim dizer, ao ar de resfriamento com feedback direto ao culto, bastante polvilhado pelo marketing com um v√©u de segredo:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Culto de Kobzar</font></font></b><div class="spoiler_text">   , , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a>:<br>
<blockquote>In some ways, Corsair Link is one of our best kept secrets. It had a very rocky start, but continued and continuing development has turned it into an extremely useful combination of hardware and software. It allows you to connect several products within our ecosystem to a software-based control panel, but there's so much more to it than that.</blockquote><br>
,      ,       , ,    ,      . ,   <i></i>         <i></i>   .<br>
<br>
,   Corsair Link Commander Mini    USB HID,       SMBus,     ¬´¬ª    PMBus,    .            SMBus,        0x98 (PMBUS_REVISION).    ,  .  PMBus                  .         ,      ,  (  )     .<br>
<br>
,     ¬´¬ª       community-   ,    .   ,     , ..   .  , , .</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enquanto isso, a comunidade n√£o permanece:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Receitas populares</font></font></b><div class="spoiler_text"> <b>Kevin Horton</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a>  FreeNAS          Perl.    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a>  .         ,   -, ,  X10   .       ,      SMART.      ,   .   .<br>
<br>
         X9 (socket 1155)   :   X9SCL/X9SCM <s>   </s>       ¬´¬ª  ¬´¬ª    BIOS     (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a>). , IPMI  ...</div></div><br>
<br>
<blockquote><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD:</font></font></b><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alternativas ao IPMI I¬≤C - Conversores de interface</font></font></h4><br>
 ,     I¬≤C     ?    USB- I¬≤C/SMBus,    USB HID.<br>
<br>
 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">x893</a>     -: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CP2112</a> - Silicon Labs  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">MCP2221A</a> - Microchip.    ,     ¬´A¬ª       460  115.       ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CP2112EK</a>   $40,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ADM00559</a>   MCP2221    . ,    / ,          .<br>
<br>
,    ,  USB   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">  </a>,    USB HID        .      : ,    HID,    ,   CDC, ..  COM-.   USB HID <i></i>      .         ,   ,   Python.      USB HID, Microchip     Linux,     .     ,       :)</blockquote><br>
<br>
<h4></h4><br>
<ul>
<li>         I¬≤C,    IPMI.</li>
<li>  ¬´ ¬ª    I¬≤C- (, , GPIO),        .</li>
<li> ,         I¬≤C-  ,  IPMI.</li>
<li>BMC-,   IPMI,  <i> </i>  I¬≤C     Master Write-Read,      .</li>
<li>             ,  -        .</li>
<li>          PMBus,     I¬≤C/SMBus.</li>
</ul><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><blockquote>Intelligent Platform Management Interface Specification v2.0<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">www.intel.com/content/dam/www/public/us/en/documents/product-briefs/second-gen-interface-spec-v2.pdf</a><br>
<br>
IPMItool<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sourceforge.net/projects/ipmitool</a><br>
<br>
I¬≤C Bus (   telos)<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">www.i2c-bus.org</a><br>
<br>
System Management Bus (SMBus) description<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">www.smbus.org/specs/smbdef.htm</a><br>
<br>
PMBus, Power Management Bus<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pmbus.org</a><br>
<br>
FreeNAS, Enterprise-Grade Features, Open Source, BSD Licensed<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">www.freenas.org</a><br>
<br>
SGPIO, Serial General Purpose Input/Output <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">www.wikipedia.org/wiki/SGPIO</a><br>
<br>
SuperMicro FAQ ID 9242, Monitoring of PSU using IPMITool<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">www.supermicro.com/support/faqs/faq.cfm?faq=9492</a><br>
<br>
LM25056, System Power Measurement IC with PMBus<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">www.ti.com/product/LM25056</a><br>
<br>
PCF8574A, Remote 8-Bit I/O Expander for I2C-Bus<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">www.ti.com/product/PCF8574A</a><br>
<br>
TCA9548A, Low-Voltage 8-Channel I2C Switch With Reset<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">www.ti.com/product/TCA9548A</a><br>
<br>
BMP180, Barometric Pressure Sensor<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">www.bosch-sensortec.com/bst/products/all_products/bmp180</a><br>
<br>
 , BMP180 Barometric Pressure Sensor<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">41j.com/blog/2015/01/bmp180-barometric-pressure-sensor</a><br>
<br>
 ,       .  SuperMicro ( X8)<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3nity.ru/viewtopic.php?p=135736#p135736</a><br>
<br>
 FreeNAS, Script to control fan speed in response to hard drive temperatures<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">forums.freenas.org/index.php?threads/script-to-control-fan-speed-in-response-to-hard-drive-temperatures.41294</a><br>
<br>
Computer Cheese, IPMI Messaging Support commands, <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">computercheese.blogspot.com/2013/05/ipmi-messaging-support-commands.html</a><br>
<br>
Corsair Link<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">www.corsair.com/en/support/faqs/corsair-link</a><br>
<br>
EEVblog Electronics Community Forum<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">www.eevblog.com/forum/chat/corsair-link</a><br>
</blockquote></div></div></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt400729/">https://habr.com/ru/post/pt400729/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt400715/index.html">Como arruinei a produtividade do escrit√≥rio com o Slack Face-Swap Bot</a></li>
<li><a href="../pt400717/index.html">11 incubadoras incomuns para startups de blockchain</a></li>
<li><a href="../pt400723/index.html">Como capturar criminosos na Deep Web</a></li>
<li><a href="../pt400725/index.html">WeChat total ou dom√≠nio do com√©rcio eletr√¥nico</a></li>
<li><a href="../pt400727/index.html">Compara√ß√£o entre Google Home e Amazon Alexa</a></li>
<li><a href="../pt400731/index.html">Impress√£o 3D com metais - tecnologias e impressoras</a></li>
<li><a href="../pt400733/index.html">O anti-smartphone √© uma maneira f√°cil de se livrar do v√≠cio em smartphones. Sexta-feira p√≥s</a></li>
<li><a href="../pt400735/index.html">Da Terra para a Lua. Hist√≥ria e matem√°tica. Parte 2</a></li>
<li><a href="../pt400737/index.html">Cientistas descobriram uma conex√£o entre abuso e honestidade</a></li>
<li><a href="../pt400739/index.html">M√©dicos su√≠√ßos criam marca-passo aut√¥nomo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>