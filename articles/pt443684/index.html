<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚öõÔ∏è üñ•Ô∏è üßîüèæ Uma lista exaustiva de diferen√ßas entre VB.NET e C #. Parte 1 ü•ú üå¶Ô∏è üë®üèø‚Äçü§ù‚Äçüë®üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="De acordo com a classifica√ß√£o TIOBE em 2018, o VB.NET superou o C # em popularidade. Coincid√™ncia ou n√£o, mas em fevereiro Eric Lippert, um dos criado...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Uma lista exaustiva de diferen√ßas entre VB.NET e C #. Parte 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/443684/"><img src="https://habrastorage.org/webt/lv/zu/ex/lvzuexv-rlsyr8aeycle0f9r--4.png" alt="imagem"><br><br>  De acordo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">com a classifica√ß√£o</a> TIOBE em 2018, o VB.NET superou o C # em popularidade.  Coincid√™ncia ou n√£o, mas em fevereiro Eric Lippert, um dos criadores do C #, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pediu aos</a> leitores que prestassem aten√ß√£o no blog de seu amigo, um ex-companheiro de equipe do compilador Roslyn e, em combina√ß√£o, um ardente f√£ do VB.NET, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Anthony Green</a> .  "Esses recursos s√£o detalhes detalhados de especialistas que n√£o s√£o t√£o f√°ceis de encontrar lendo a documenta√ß√£o", escreve Eric.  Apresentamos a sua aten√ß√£o a primeira parte da tradu√ß√£o do artigo de Anthony Green, ‚ÄúUma lista exaustiva de diferen√ßas entre VB.NET e C #‚Äù.  Talvez seja justamente nessas diferen√ßas que reside o segredo da din√¢mica da classifica√ß√£o dessas l√≠nguas. <br><a name="habracut"></a><br>  Por quase metade da minha vida, testemunhei e participei de in√∫meras discuss√µes sobre qu√£o semelhantes ou diferentes s√£o as duas linguagens .NET mais populares.  Primeiro, como amador, depois como profissional e, finalmente, como advogado de clientes, gerente de programas e designer de idiomas, posso dizer sem exagero quantas vezes ouvi ou li algo como: <br><blockquote>  <i>"... VB.NET √© realmente apenas uma camada fina em cima de IL, como C # ..."</i> </blockquote>  ou <blockquote>  <i>"... VB.NET √© na verdade apenas C # sem ponto e v√≠rgula ..."</i> </blockquote> Como se os idiomas fossem uma convers√£o XML ou uma folha de estilos. <br><br>  E se algum visitante ardente n√£o escrever isso em um coment√°rio, muitas vezes isso est√° impl√≠cito em perguntas como: <i>‚ÄúOl√°, Anthony!</i>  <i>Me deparei com uma diferen√ßa t√£o pequena em um √∫nico lugar - isso √© um bug?</i>  <i>Como poderiam essas duas l√≠nguas id√™nticas, que deveriam ser id√™nticas em nome de todos os bons e santos neste mundo, se dispersar nesse √∫nico lugar?</i>  <i>Por que precisamos de tanta injusti√ßa ?!</i> <br><br>  " <b>Separados</b> " <b>,</b> como se fossem os mesmos at√© que uma muta√ß√£o ocorresse e <i>depois</i> se tornassem esp√©cies separadas.  Hah! <br><br>  Mas eu entendo isso.  Antes de ingressar na Microsoft, eu tamb√©m poderia ter se apegado a essa ideia e usado como argumento para responder aos oponentes ou tranquilizar algu√©m.  Eu entendo o charme dela.  √â f√°cil de entender e muito f√°cil de repetir.  Mas trabalhando em Roslyn (essencialmente reescrevendo VB e C # completamente do zero) por 5 anos, percebi o qu√£o <b>inequivocamente essa id√©ia √© falsa</b> .  Trabalhei com uma equipe de desenvolvedores e testadores para reimplementar cada cent√≠metro de ambos os idiomas, bem como suas ferramentas em uma enorme solu√ß√£o de m√∫ltiplos projetos com milh√µes de linhas de c√≥digo escritas nos dois idiomas.  E levando em conta o grande n√∫mero de desenvolvedores que alternam entre eles, o alto n√≠vel de compatibilidade com os resultados e a experi√™ncia das vers√µes anteriores, bem como a necessidade de reproduzir de forma confi√°vel o volume gigantesco da API em grande detalhe, fui for√ßado a conhecer as diferen√ßas de perto.  De fato, √†s vezes me pareceu que aprendi algo novo sobre o VB.NET (meu idioma favorito) todos os dias. <br><br>  E, finalmente, dediquei um tempo para sentar e descarregar do c√©rebro uma part√≠cula do que aprendi usando e criando o VB.NET nos √∫ltimos 15 anos, na esperan√ßa de que eu possa pelo menos economizar meu tempo da pr√≥xima vez. <br><br>  Antes de passar para a lista, descreverei as regras b√°sicas: <br><br><ul><li>  Esta lista n√£o √© exaustiva no sentido usual.  Ele √© exaustivo.  Essas n√£o s√£o todas as diferen√ßas.  Essas nem s√£o todas as diferen√ßas que eu geralmente conhe√ßo.  Essas s√£o apenas as diferen√ßas que me lembro primeiro, at√© ficar cansado demais para continuar;  at√© eu ficar sem for√ßa.  Se eu ou algum de voc√™s conhecer ou recordar outras diferen√ßas, terei o prazer de atualizar esta lista. </li><li>  Iniciarei no in√≠cio da especifica√ß√£o do VB 11 e des√ßo usando seu conte√∫do para me lembrar das diferen√ßas que v√™m √† mente primeiro sobre este t√≥pico. </li><li>  <b>Esta N√ÉO √© uma lista de fun√ß√µes no VB que n√£o est√£o em C #.</b>  Portanto, n√£o h√° "literais XML versus ponteiros".  Isso √© muito comum e j√° existem in√∫meras listas na Internet (algumas das quais foram escritas por mim, e talvez no futuro eu escreva mais).  Vou me concentrar principalmente nas constru√ß√µes que t√™m um an√°logo nos dois idiomas, e onde um observador desinformado pode sugerir que essas duas coisas se comportam da mesma forma, mas onde existem diferen√ßas pequenas ou grandes;  eles podem parecer iguais, mas funcionam de maneira diferente ou, por fim, geram c√≥digo diferente. </li><li>  <b>Esta N√ÉO √© uma lista de diferen√ßas sint√°ticas entre VB e C #</b> (que s√£o incont√°veis).  Vou falar principalmente sobre diferen√ßas sem√¢nticas (o que as coisas significam), e n√£o sobre as sint√°ticas (como as coisas s√£o escritas).  Portanto, nenhuma pe√ßa como "VB inicia coment√°rios com 'e C # usa //" ou "em C # _ √© um identificador v√°lido, mas n√£o em VB".  Mas vou quebrar essa regra em v√°rios casos.  Afinal, a primeira se√ß√£o da especifica√ß√£o √© sobre regras lexicais. </li><li>  Freq√ºentemente, darei exemplos e, √†s vezes, apresentarei justificativas para o design ser de uma maneira ou de outra.  Algumas decis√µes de design foram tomadas diante de meus olhos, mas a grande maioria precedeu meu tempo, e s√≥ posso adivinhar por que elas foram tomadas. </li><li>  Deixe um coment√°rio ou envie um tweet para mim ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">@ThatVBGuy</a> ) para informar suas diferen√ßas favoritas e / ou sobre as quais voc√™ gostaria de saber mais. </li></ul><br>  Tendo definido expectativas e sem mais atrasos ... <br><br><h2>  Conte√∫do </h2><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text"><h4>  Sintaxe e pr√©-processamento </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">1. Palavras-chave e operadores VB podem usar caracteres de largura total</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2. VB suporta aspas inteligentes</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3. As constantes de pr√©-processamento podem ser de qualquer tipo primitivo (incluindo datas) e podem conter qualquer valor constante</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">4. Operadores aritm√©ticos podem ser usados ‚Äã‚Äãem express√µes de pr√©-processamento</a> </li></ul><br><h4>  An√∫ncios, etc. </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">5. O VB √†s vezes ignora as declara√ß√µes de implementos em IL para impedir a implementa√ß√£o impl√≠cita acidental de uma interface por nome</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">6. O VB, por padr√£o, oculta os membros da classe base por nome (Shadows), e n√£o por nome e assinatura (Sobrecargas)</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">7. VB11 e abaixo s√£o mais rigorosos para membros protegidos em gen√©ricos</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">8. A sintaxe ‚Äúargumento nomeado‚Äù nos atributos sempre inicializa propriedades / campos</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">9. Todas as declara√ß√µes de n√≠vel superior (geralmente) est√£o implicitamente localizadas no espa√ßo para nome raiz do projeto.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">10. Os m√≥dulos n√£o s√£o gerados como classes abstratas seladas em IL, portanto, n√£o se parecem exatamente com classes est√°ticas de C # e vice-versa</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">11. Voc√™ n√£o precisa de um m√©todo expl√≠cito para o ponto de entrada (Sub Main) nos aplicativos WinForms</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">12. Se voc√™ chamar alguns m√©todos obsoletos de tempo de execu√ß√£o do VB (por exemplo, FileOpen), o m√©todo de chamada ser√° implicitamente marcado com um atributo para desativar o inlining por motivos de corre√ß√£o.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">13. Se o seu tipo estiver marcado com o atributo DesignerGenerated e n√£o contiver nenhuma declara√ß√£o expl√≠cita do construtor, o compilador gerado por padr√£o chamar√° InitializeComponent se estiver definido para esse tipo.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">14. A aus√™ncia do modificador Parcial N√ÉO significa que o tipo n√£o √© parcial</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">15. Nas classes padr√£o, o n√≠vel de acesso p√∫blico √© para tudo, exceto campos, e em estruturas p√∫blicas, tamb√©m para campos</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">16. VB inicializa os campos AP√ìS o construtor de base ser chamado, enquanto o C # os inicializa ANTES de o construtor de base ser chamado</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">17. O campo de apoio declarado implicitamente dos eventos VB tem um nome diferente do que em C # e √© acess√≠vel por nome</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">18. O campo auxiliar declarado implicitamente das propriedades autom√°ticas do VB tem um nome comum e √© acess√≠vel por esse nome</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">19. O campo auxiliar de leitura autom√°tica implicitamente declarado permite propriedades de grava√ß√£o</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">20. √Äs vezes, os atributos do evento s√£o aplicados a um campo de evento auxiliar</a> </li></ul><br><h4>  Instru√ß√µes </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">21. O escopo do r√≥tulo √© o corpo de todo o m√©todo que o cont√©m;</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Voc√™ pode pular dentro de blocos (n√£o todos)</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">22. O tempo de vida de um escopo de vari√°vel local &lt;&gt;</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">23. As vari√°veis ‚Äã‚Äãs√£o sempre inicializadas com o valor padr√£o para o tipo correspondente.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">24. RaiseEvent N√ÉO lan√ßa uma exce√ß√£o se o campo auxiliar for nulo</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">25. As tarefas nem sempre s√£o as mesmas;</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">√Äs vezes, uma atribui√ß√£o de tipo de refer√™ncia executa um clone superficial</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">26. O Select Case n√£o suporta fall-through;</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nenhuma pausa √© necess√°ria</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">27. Cada bloco Case tem seu pr√≥prio escopo</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">28, 29, 30. Select Case funciona com tipos n√£o primitivos, pode usar express√µes n√£o constantes arbitr√°rias nas verifica√ß√µes e, por padr√£o, usa o operador =</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">31. Vari√°veis ‚Äã‚Äãdeclaradas dentro de loops mant√™m seu significado entre as itera√ß√µes de alguma maneira</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">32. Tr√™s express√µes For loop s√£o avaliadas apenas uma vez no in√≠cio do loop.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">33. Para Cada loop no VB pode usar o m√©todo de extens√£o GetEnumerator</a> </li></ul></div></div><br><h2>  Sintaxe e pr√©-processamento </h2><br><a name="section1"></a><h3>  1. Palavras-chave e operadores VB podem usar caracteres de largura total </h3><br>  Alguns idiomas (n√£o sei exatamente quantos, mas pelo menos em algumas formas de chin√™s, japon√™s e coreano) usam caracteres de largura total.  Em resumo, isso significa que, ao usar uma fonte monoespa√ßada (como a maioria dos programadores), o caractere chin√™s ocupa duas vezes mais espa√ßo horizontal do que os caracteres latinos que costum√°vamos ver no oeste.  Por exemplo: <br><br><img src="https://habrastorage.org/webt/wl/j8/0u/wlj80uri5nr810dqgpwymj5eru0.png"><br><br>  Aqui eu tenho uma declara√ß√£o de vari√°vel escrita em japon√™s e inicializa√ß√£o com uma string tamb√©m escrita em japon√™s.  Segundo o tradutor do Bing, a vari√°vel √© chamada "sauda√ß√£o" e a linha diz "Ol√°, mundo!"  O nome da vari√°vel em japon√™s tem apenas 2 caracteres, mas ocupa o espa√ßo de 4 caracteres de meia largura que meu teclado normalmente fornece, como demonstra o primeiro coment√°rio.  Existem vers√µes de largura total de n√∫meros e todos os outros caracteres ASCII impressos que t√™m a mesma largura que os japoneses.  Para demonstrar isso, escrevi um segundo coment√°rio usando os n√∫meros de largura total "1" e "2".  Estes n√£o s√£o "1" e "2" como no primeiro coment√°rio.  N√£o h√° espa√ßos entre os n√∫meros.  Voc√™ tamb√©m pode ver que o tamanho dos caracteres n√£o tem exatamente 2 caracteres de largura, existe um pequeno deslocamento.  Isso ocorre em parte porque esse programa combina caracteres de largura e meia largura em uma linha e nas tr√™s linhas. <br><br>  Os espa√ßos t√™m meia largura, os caracteres alfanum√©ricos t√™m largura total.  N√£o somos programadores, a menos que seja obcecado pelo alinhamento de texto.  E parece-me que, se voc√™ √© chin√™s, japon√™s ou coreano (ou algu√©m que usa caracteres de tamanho completo no idioma) e usa identificadores ou strings escritos no idioma nativo, esses pequenos erros de alinhamento s√£o irritantes. <br><br>  Pelo que entendi, dependendo do seu teclado japon√™s, √© f√°cil alternar entre hier√≥glifos e latim, mas √© prefer√≠vel usar caracteres latinos de largura total.  O VB suporta isso em palavras-chave, espa√ßos, operadores e at√© aspas.  Ent√£o, tudo isso pode ser escrito assim: <br><br><img src="https://habrastorage.org/webt/me/mq/ph/memqph465sxyx_tvxov6fglrjfw.png"><br><br>  Como voc√™ pode ver, nesta vers√£o, palavras-chave, espa√ßos, coment√°rios, operadores e at√© aspas usam suas vers√µes em tamanho real.  No caos trouxe ordem. <br><br>  Sim  Os japoneses usam VB.  De fato, apesar da sintaxe semelhante ao idioma ingl√™s (e talvez por isso), para a maioria dos usu√°rios de VB que vejo nos f√≥runs, o ingl√™s n√£o √© o idioma principal.  Durante meu trabalho na Microsoft, conheci o MVP VB japon√™s v√°rias vezes, pelo menos um deles sempre trazia doces japoneses.  Se voc√™ √© um programador de VB da China, Jap√£o ou Cor√©ia (ou de qualquer outro pa√≠s que use caracteres de largura total), escreva nos coment√°rios.  (Nos coment√°rios ao autor, eles escreveram que os japoneses est√£o tentando em todo lugar no c√≥digo usar ascii - <i>aprox. Por.</i> ) <br><br>  <i><b>Momento engra√ßado:</b> quando eu implementei linhas interpoladas no VB, eu (para minha vergonha) n√£o levei em conta a possibilidade de colchetes de largura total nos locais de substitui√ß√£o.</i>  <i>Vladimir Reshetnikov ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">@vreshetnikov</a> ) descobriu e corrigiu esse erro, para que a grande tradi√ß√£o de toler√¢ncia de VB na largura de caracteres permanecesse v√°lida.</i> <br><br><a name="section2"></a><h3>  2. VB suporta aspas inteligentes </h3><br>  Ok, isso √©, obviamente, um pouco, mas digno de men√ß√£o.  Voc√™ j√° viu um exemplo de c√≥digo em um documento de texto como este: <br><br><img src="https://habrastorage.org/webt/ls/8l/qc/ls8lqckokgku3b0raqiboefn9bc.png"><br><br>  E depois de copiar o exemplo no seu c√≥digo, voc√™ descobriu que nenhuma das aspas (destacadas) funcionava, porque o Word substitui todas as aspas ASCII comuns por <code>‚Äú</code> aspas inteligentes <code>‚Äù</code> ? <br><br>  Eu n√£o  Ok, eu tinha, mas somente quando copiei os exemplos para o C #.  No VB, aspas inteligentes s√£o delimitadores v√°lidos para seq√º√™ncias de caracteres (√© engra√ßado que as aspas <code>¬´¬ª</code> russas n√£o funcionem - Aprox. Por.): <br><br><img src="https://habrastorage.org/webt/l0/yk/wi/l0ykwi3ebeigkgrkkrzq8lfrwhm.png"><br><br>  Eles tamb√©m trabalham dentro de strings, embora talvez de uma maneira estranha.  Se voc√™ duplica as aspas inteligentes para escapar, tudo o que voc√™ obt√©m no tempo de execu√ß√£o √© apenas as aspas simples ("burras").  Isso pode parecer um pouco estranho, mas, no entanto, muito pr√°tico, j√° que quase em qualquer outro lugar cita√ß√µes inteligentes s√£o permitidas na string.  O compilador N√ÉO faz com que voc√™ termine com uma cota√ß√£o inteligente ou use a correta se voc√™ come√ßou com uma cota√ß√£o inteligente, para que voc√™ possa mistur√°-lo sem se preocupar.  E sim, isso tamb√©m funciona com o caractere de aspas simples usado para coment√°rios: <br><br><img src="https://habrastorage.org/webt/4y/9j/8n/4y9j8n7mexmkyvtx_vmj-jesfak.png"><br><br>  Tentei <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">convencer</a> Paul Wick ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">@panopticoncntrl</a> ) a admitir que ele fez isso apenas porque estava atormentado com esse problema enquanto trabalhava na especifica√ß√£o, mas ele nega qualquer culpa.  Este n√£o foi o caso no VB6, ent√£o algu√©m adicionou isso mais tarde. <br><br><a name="section3"></a><h3>  3. As constantes de pr√©-processamento podem ser de qualquer tipo primitivo (incluindo datas) e podem conter qualquer valor constante </h3><br><p><img src="https://habrastorage.org/webt/sd/0f/jv/sd0fjva0vsarlwmx7vgwn8yf8xq.png"></p><br><a name="section4"></a><h3>  4. Operadores aritm√©ticos podem ser usados ‚Äã‚Äãem express√µes de pr√©-processamento </h3><br><p><img src="https://habrastorage.org/webt/hx/cw/0k/hxcw0k25imfieuvg_ncshwbizim.png"></p><br><br><h2>  An√∫ncios, etc. </h2><br><a name="section5"></a><h3>  5. O VB √†s vezes ignora as declara√ß√µes de implementa√ß√µes de IL para impedir a implementa√ß√£o impl√≠cita acidental de uma interface por nome. </h3><br>  Este item √© da categoria de esoterismo.  No VB, a implementa√ß√£o de uma interface √© sempre feita explicitamente.  Mas, na aus√™ncia de uma implementa√ß√£o expl√≠cita, o comportamento padr√£o do CLR ao chamar um m√©todo de interface √© procurar m√©todos p√∫blicos por nome e assinatura.  Na maioria dos casos, isso √© normal, porque no VB voc√™ <i>geralmente</i> precisa fornecer uma implementa√ß√£o para cada membro da interface implementada, exceto um caso: <br><br><pre> <code class="vbscript hljs">Interface IFoo <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Bar() <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Baz() <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Interface <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Foo Implements IFoo <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Bar() Implements IFoo.Bar <span class="hljs-keyword"><span class="hljs-keyword">Exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> IFoo_Baz() Implements IFoo.Baz <span class="hljs-keyword"><span class="hljs-keyword">Exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> FooDerived Inherits Foo Implements IFoo <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Bar() Implements IFoo.Bar <span class="hljs-keyword"><span class="hljs-keyword">Exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Baz() <span class="hljs-comment"><span class="hljs-comment">' Does something unrelated to what an IFoo.Baz would do. End Sub End Class</span></span></code> </pre><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gist.github.com/AnthonyDGreen/39634fd98a0cacc093719ab62d7ab1e6#file-partial-re-implementation-vb</a> <br><br>  Neste exemplo, a classe <code>FooDerived</code> apenas deseja reatribuir <code>IFoo.Bar</code> para o novo m√©todo, mas mant√©m as implementa√ß√µes restantes inalteradas.  Acontece que se o compilador simplesmente gerar a diretiva implementa para o <code>FooDerived</code> , o CLR tamb√©m selecionar√° o <code>FooDerived.Baz</code> como uma nova implementa√ß√£o do <code>IFoo.Baz</code> (embora neste exemplo n√£o esteja relacionado ao <code>IFoo</code> ).  No C #, isso acontece implicitamente (e n√£o tenho certeza se posso recus√°-lo), mas no VB o compilador realmente omite 'Implementa√ß√µes' de toda a declara√ß√£o para evitar isso e redefine apenas membros espec√≠ficos que foram reimplementados.  Em outras palavras, se voc√™ perguntar ao <code>FooDerived</code> se ele <code>IFoo</code> diretamente, ele dir√° n√£o: <br><p><img src="https://habrastorage.org/webt/kz/u7/fr/kzu7fr0j1zz4eadll-m5gto7f8q.png"></p><br>  Por que eu sei disso e por que √© importante?  Por muitos anos, os usu√°rios do VB solicitaram suporte para implementa√ß√£o impl√≠cita de uma interface (sem especificar explicitamente <code>Implements</code> em cada declara√ß√£o), geralmente para gera√ß√£o de c√≥digo.  Apenas incorporar isso √† sintaxe atual seria uma mudan√ßa <code>FooDerived.Baz</code> , porque o <code>FooDerived.Baz</code> agora implementa implicitamente o <code>IFoo.Baz</code> , embora ainda n√£o tenha feito isso antes.  Mais recentemente, por√©m, aprendi mais sobre esse comportamento ao discutir poss√≠veis problemas de design com o recurso "implementa√ß√£o de interface padr√£o", que permitiria que as interfaces inclu√≠ssem implementa√ß√µes padr√£o de alguns membros e n√£o exigiriam reimplementa√ß√£o em cada classe.  Isso seria √∫til para sobrecargas, por exemplo, quando √© prov√°vel que a implementa√ß√£o seja a mesma para todos os implementadores (delega√ß√£o √† sobrecarga principal).  Outro cen√°rio √© o controle de vers√£o.  Se uma interface puder incluir implementa√ß√µes padr√£o, voc√™ poder√° adicionar novos membros a ela sem interromper as implementa√ß√µes antigas.  Mas h√° um problema.  Como o comportamento padr√£o no CLR √© procurar implementa√ß√µes p√∫blicas por nome e assinatura, se a classe VB n√£o implementar membros da interface com implementa√ß√µes padr√£o, mas tiver membros p√∫blicos com nome e assinatura adequados, eles implicitamente implementar√£o esses membros da interface, mesmo se voc√™ fizer isso completamente. n√£o deveria.  H√° coisas que voc√™ pode fazer para contornar isso quando o conjunto completo de membros da interface √© conhecido no momento da compila√ß√£o.  Por√©m, caso o membro tenha sido adicionado ap√≥s a compila√ß√£o do c√≥digo, ele muda silenciosamente o comportamento no tempo de execu√ß√£o. <br><br><a name="section6"></a><h3>  6. O VB, por padr√£o, oculta os membros da classe base por nome (Shadows), e n√£o por nome e assinatura (Sobrecargas) </h3><br>  Eu acho que essa diferen√ßa √© bem conhecida.  O cen√°rio √© o seguinte: voc√™ herda a classe base ( <code>DomainObject</code> ), possivelmente fora de seu controle, e declara um m√©todo com um nome que faz sentido no contexto da sua classe, por exemplo, <code>Print</code> : <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> DomainObject <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Invoice Inherits DomainObject <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Print(copies As Integer) <span class="hljs-comment"><span class="hljs-comment">' Sends contents of invoice to default printer. End Sub End Class</span></span></code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gist.github.com/AnthonyDGreen/863cfd1e7536fe8bda7cd145795eaf9f#file-shadows-example-vb</a> <br><br>  O fato de uma fatura poder ser impressa faz sentido.  Mas na pr√≥xima vers√£o da API em que sua classe base √© declarada, eles decidem pela depura√ß√£o para adicionar a todos os DomainObjects um m√©todo que exibe o conte√∫do completo do objeto na janela de depura√ß√£o.  Este m√©todo √© chamado brilhantemente de impress√£o.  O problema √© que o cliente da sua API pode perceber que o objeto Invoice possui os m√©todos <code>Print()</code> e <code>Print(Integer)</code> e acha que essas sobrecargas est√£o relacionadas.  Talvez o primeiro apenas imprima uma c√≥pia.  Mas isso n√£o √© exatamente o que voc√™ concebeu como autor da fatura.  Voc√™ n√£o tinha id√©ia de que <code>DomainObject.Print</code> aparecesse.  Ent√£o, sim, isso n√£o funciona no VB.  Quando essa situa√ß√£o aparece, um aviso √© exibido, mas o mais importante √© que o comportamento padr√£o no VB √© ocultar pelo nome.  Ou seja, at√© que voc√™ indique explicitamente com a palavra-chave <code>Overloads</code> que <code>Print</code> √© uma sobrecarga de <code>Print</code> classe base, um membro da classe base (e qualquer sobrecarga dela) fica completamente oculto.  Somente a API que voc√™ declarou originalmente √© mostrada aos seus clientes de classe.  Isso funciona por padr√£o, mas voc√™ pode faz√™-lo explicitamente atrav√©s da palavra-chave Shadows.  O C # s√≥ pode fazer <code>Overloads</code> (embora leve em considera√ß√£o as <code>Shadows</code> quando se refere a uma biblioteca VB) e o faz por padr√£o (usando a <code>new</code> palavra-chave).  Mas essa diferen√ßa aparece de tempos em tempos quando algumas hierarquias de heran√ßa aparecem em projetos nos quais uma classe √© definida em um idioma e outra em outro, e h√° m√©todos sobrecarregados, mas isso est√° al√©m do escopo do item atual na lista de diferen√ßas. <br><br><a name="section7"></a><h3>  7. VB11 e abaixo s√£o mais rigorosos para membros protegidos em gen√©ricos </h3><br>  De fato, alteramos isso entre o VS2013 e o VS2015.  Em particular, decidimos n√£o nos preocupar com a reimplementa√ß√£o.  Mas estou escrevendo essa distin√ß√£o, caso voc√™ use a vers√£o antiga e observe.  Resumindo: se um membro Protegido for declarado no tipo gen√©rico, o herdeiro, sendo tamb√©m um gen√©rico, poder√° acessar esse membro protegido apenas atrav√©s da inst√¢ncia herdada com os mesmos argumentos de tipo. <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Base(Of T) Protected x As T <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Derived</span></span>(Of T) Inherits Base(Of T) <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> F(y As <span class="hljs-built_in"><span class="hljs-built_in">Derived</span></span>(Of <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>)) <span class="hljs-comment"><span class="hljs-comment">' Error: Derived(Of T) cannot access Derived(Of String)'s ' protected members yx = "a" End Sub End Class</span></span></code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gist.github.com/AnthonyDGreen/ce12ac986219eb51d6c85fa02c339a2f#file-protected-in-generics-vb</a> <br><br><a name="section8"></a><h3>  8. A sintaxe ‚Äúargumento nomeado‚Äù nos atributos sempre inicializa propriedades / campos </h3><br>  O VB usa a mesma sintaxe <code>:=</code> para inicializar propriedades / campos de atributos e para passar argumentos de m√©todo por nome.  Portanto, n√£o h√° como passar um argumento para o construtor de atributos por nome. <br><br><a name="section9"></a><h3>  9. Todas as declara√ß√µes de n√≠vel superior (geralmente) est√£o implicitamente localizadas no espa√ßo para nome raiz do projeto </h3><br>  Essa diferen√ßa est√° quase na categoria "recursos avan√ßados", mas eu a inclu√≠ na lista porque altera o significado do c√≥digo.  H√° um campo nas propriedades do projeto VB: <br><br><p><img src="https://habrastorage.org/webt/0y/hy/7_/0yhy7_k2xkchvxq70v1duka5z4a.png"></p><br>  Por padr√£o, este √© simplesmente o nome do seu projeto no momento da cria√ß√£o.  Esse <b>n√£o</b> √© o mesmo campo que o "Namespace padr√£o" nas propriedades de um projeto C #.  O espa√ßo para nome padr√£o simplesmente define qual c√≥digo √© adicionado por padr√£o aos novos arquivos em C #.  Mas o espa√ßo para nome raiz no VB significa que, a menos que seja indicado de outra forma, todas as declara√ß√µes de n√≠vel superior neste projeto est√£o implicitamente nesse espa√ßo para nome.  √â por isso que os modelos de documento do VB geralmente n√£o cont√™m nenhuma declara√ß√£o de namespace.  Al√©m disso, se voc√™ adicionar uma declara√ß√£o de namespace, ela n√£o substitui a raiz, mas √© adicionada a ela: <br><br><pre> <code class="vbscript hljs">Namespace Controllers <span class="hljs-comment"><span class="hljs-comment">' Child namespace. End Namespace Namespace Global.Controllers ' Top-level namespace End Namespace</span></span></code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gist.github.com/AnthonyDGreen/fd1e5e3a58aee862a5082e1d2b078084#file-root-namespace-vb</a> <br><br>  Portanto, o espa√ßo para nome <code>Controllers</code> realmente declara o espa√ßo <code>VBExamples.Controllers</code> nome <code>VBExamples.Controllers</code> , a menos que voc√™ se livre desse mecanismo declarando <code>VBExamples.Controllers</code> explicitamente no espa√ßo para nome. <br><br>  Isso √© conveniente porque salva um n√≠vel de recuo e um conceito extra para cada arquivo VB.  E isso √© especialmente √∫til se voc√™ estiver criando um aplicativo UWP (porque tudo deve estar no espa√ßo para nome no UWP) e √© extremamente conveniente se voc√™ decidir alterar o espa√ßo para nome de n√≠vel superior para todo o seu projeto, por exemplo, de um nome de c√≥digo como Roslyn para uma vers√£o mais longa, como o <code>Microsoft.CodeAnalysis</code> , j√° que voc√™ n√£o precisa atualizar manualmente cada arquivo na solu√ß√£o.  Tamb√©m √© importante ter isso em mente ao trabalhar com geradores de c√≥digo, espa√ßos para nome XAML e o novo <code>.vbproj</code> arquivo <code>.vbproj</code> . <br><br><a name="section10"></a><h3>  10. Os m√≥dulos n√£o s√£o gerados como classes abstratas seladas em IL, portanto, n√£o se parecem exatamente com classes est√°ticas de C # e vice-versa. </h3><br>  Os m√≥dulos no VB existiam antes das classes est√°ticas de C #, embora tent√°ssemos em 2010 torn√°-los iguais em termos de IL.  Infelizmente, essa foi uma mudan√ßa radical, porque o serializador de XML (ou talvez fosse bin√°rio) para essa vers√£o do .NET (acho que eles o corrigiram) n√£o queria serializar o tipo aninhado em um tipo que n√£o p√¥de ser criado (e uma classe abstrata n√£o pode).  Ele lan√ßou uma exce√ß√£o. <br><br>  Descobrimos isso depois de fazer as altera√ß√µes e revert√™-las porque algum c√≥digo em algum lugar usava o tipo de enum incorporado no m√≥dulo.  E como voc√™ n√£o sabe com qual vers√£o do serializador o programa compilado funcionar√°, nunca ser√° poss√≠vel alter√°-lo, pois ele funcionar√° em uma vers√£o do aplicativo e lan√ßar√° exce√ß√µes em outras. <br><br><a name="section11"></a><h3>  11. Voc√™ n√£o precisa de um m√©todo expl√≠cito para o ponto de entrada (Sub Main) nos aplicativos WinForms </h3><br>  Se o seu projeto usa Form como o objeto inicial e n√£o usa o "Application Framework" (mais sobre isso na pr√≥xima postagem), o VB gera um <code>Sub Main</code> , que cria seu formul√°rio inicial e o passa para <code>Application.Run</code> , economizando o arquivo inteiro Para gerenciar esse processo, seja um m√©todo adicional no seu <code>Form</code> ou at√© a necessidade de pensar sobre esse problema. <br><br><a name="section12"></a><h3>  12. Se voc√™ chamar alguns m√©todos de tempo de execu√ß√£o do VB herdados (por exemplo, FileOpen), o m√©todo de chamada ser√° implicitamente marcado com um atributo para desativar o inlining por motivos de corre√ß√£o. </h3><br>  Em resumo, os m√©todos para trabalhar com arquivos no estilo VB6, como o <code>FileOpen</code> contam com contextos espec√≠ficos para o assembly em que o c√≥digo est√° localizado.  Por exemplo, o arquivo 1 pode ser um log em um projeto e uma configura√ß√£o em outro.  Para determinar qual assembly est√° sendo executado, <code>Assembly.GetCallingAssembly()</code> chamado.  Mas se o JIT <i>incluir</i> o m√©todo no chamador, do ponto de vista da pilha, o m√©todo de tempo de execu√ß√£o do VB n√£o ser√° chamado pelo m√©todo, mas pelo chamador, que pode estar em um assembly diferente, o que permitir√° que seu c√≥digo acesse ou viole o estado interno do chamador objeto  Este n√£o √© um problema de seguran√ßa, porque se o c√≥digo comprometedor estiver em execu√ß√£o no seu processo, voc√™ j√° estar√° perdido.  Isso √© uma quest√£o de corre√ß√£o.  Portanto, se voc√™ usar esses m√©todos, o compilador desativar√° o inlining. <br><br>  Essa altera√ß√£o foi feita no √∫ltimo momento em 2010, porque o x64 JIT √© MUITO agressivo ao inserir / otimizar o c√≥digo, e achamos muito tarde, e era a op√ß√£o mais segura. <br><br><a name="section13"></a><h3>  13. Se o seu tipo estiver marcado com o atributo DesignerGenerated e n√£o contiver nenhuma declara√ß√£o expl√≠cita do construtor, o compilador gerado por padr√£o chamar√° InitializeComponent se estiver definido para esse tipo. </h3><br>  Na era anterior ao advento dos tipos Parciais, a equipe do VB travou uma guerra para reduzir o c√≥digo padr√£o nos projetos WinForms.  Mas mesmo com <code>Partial</code> isso √© √∫til porque permite que o arquivo gerado omita completamente o construtor, e o usu√°rio pode declara-lo manualmente em seu arquivo, se necess√°rio, ou n√£o.  Sem isso, o designer seria for√ßado a adicionar um construtor apenas para chamar <code>InitializeComponent</code> , e se o usu√°rio adicionar tamb√©m, eles ser√£o duplicados ou o kit de ferramentas deve ser inteligente o suficiente para mover o construtor do arquivo de designer para o usu√°rio e n√£o o regenerar no designer, se ele j√° existe no arquivo do usu√°rio. <br><br><a name="section14"></a><h3>  14. A aus√™ncia do modificador Parcial N√ÉO significa que o tipo n√£o √© parcial </h3><br>  Tecnicamente, no VB, apenas uma classe deve ser marcada como Parcial.  Isso geralmente √© (em projetos de GUI) um arquivo gerado. <br><br>  <b>Porque</b>  Isso mant√©m o arquivo do usu√°rio bonito e limpo, e pode ser muito conveniente incluir ap√≥s gerar ou adicionar c√≥digo personalizado ao c√≥digo gerado.  No entanto, √© recomend√°vel que no m√°ximo uma classe n√£o tenha modificador Parcial, caso contr√°rio, um aviso ser√° emitido. <br><br><a name="section15"></a><h3>  15. Nas classes padr√£o, o n√≠vel de acesso p√∫blico √© para tudo, exceto campos, e em estruturas p√∫blicas, tamb√©m para campos </h3><br>  Eu tenho sentimentos mistos sobre isso.  No C #, tudo √© <code>private</code> por padr√£o (sa√∫de, encapsulamento!), Mas h√° um argumento a ser feito, dependendo do que voc√™ costuma declarar: um contrato p√∫blico ou detalhes de implementa√ß√£o.  Propriedades e eventos s√£o geralmente destinados ao uso externo ( <code>public</code> ) e os operadores n√£o podem ser acessados ‚Äã‚Äãal√©m de <code>public</code> .  No entanto, raramente confio na acessibilidade padr√£o (com exce√ß√£o de demos como os exemplos deste artigo). <br><br><a name="section16"></a><h3>  16. VB inicializa os campos AP√ìS o construtor de base ser chamado, enquanto o C # os inicializa ANTES de o construtor de base ser chamado </h3><br>  Voc√™ j√° ouviu falar como "alguns" dizem que a primeira coisa que acontece no construtor √© uma chamada para o construtor da classe base?  Bem, esse n√£o √© o caso, pelo menos em C #.  Em C #, antes de chamar <code>base()</code> , expl√≠cita ou impl√≠cita, os inicializadores de campo s√£o executados primeiro, depois a chamada do construtor e, em seguida, o seu c√≥digo.  Essa decis√£o tem consequ√™ncias, e acho que sei por que os desenvolvedores de idiomas podem seguir um caminho ou outro.  Acredito que uma dessas consequ√™ncias √© que o c√≥digo a seguir n√£o pode ser traduzido diretamente para c #: <br><br><pre> <code class="vbscript hljs">Imports System.Reflection <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> ReflectionFoo <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> StringType As Type = GetType(<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> StringLengthProperty As PropertyInfo = StringType.GetProperty(<span class="hljs-string"><span class="hljs-string">"Length"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> StringGetEnumeratorMethod As MethodInfo = StringType.GetMethod(<span class="hljs-string"><span class="hljs-string">"GetEnumerator"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> StringEnumeratorType As Type = StringGetEnumeratorMethod.ReturnType <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">New</span></span>() Console.WriteLine(StringType) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span></code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gist.github.com/AnthonyDGreen/37d01c8e7f085e06172bfaf6a1e567d4#file-field-init-me-reference-vb</a> <br><br>  Nos dias em que eu estava envolvido com o Reflection, muitas vezes escrevia esse c√≥digo.  E eu me lembro vagamente de um colega da Microsoft (Josh), que traduziu meu c√≥digo em C #, √†s vezes reclamando da necessidade de portar todos os meus inicializadores para o construtor.  Em C #, √© proibido se referir a um objeto que est√° sendo criado antes que <code>base()</code> seja chamada.  E como os inicializadores de campo s√£o executados antes da chamada especificada, eles tamb√©m n√£o podem se referir a outros campos ou a nenhum membro da inst√¢ncia do objeto.  Portanto, este exemplo tamb√©m funciona apenas no VB: <br><br><pre> <code class="vbscript hljs">MustInherit <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Base <span class="hljs-comment"><span class="hljs-comment">' OOP OP? Private Cached As Object = DerivedFactory() Protected MustOverride Function DerivedFactory() As Object End Class Class Derived Inherits Base Protected Overrides Function DerivedFactory() As Object Return New Object() End Function End Class</span></span></code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gist.github.com/AnthonyDGreen/fe5ca89e5a98efee97ffee93aa684e50#file-base-derived-init-vb</a> <br><br>  Aqui temos uma classe base, que supostamente possui muita funcionalidade, mas precisa de algum objeto-chave para gerenciamento, trabalho, que √© determinado pelo tipo derivado.  Existem v√°rias maneiras de implementar esse modelo, mas eu geralmente uso esse porque: <br><br><ul><li>  ele √© baixo; </li><li>  n√£o exige que eu declare um construtor; </li><li>  n√£o exige que eu coloque o c√≥digo de inicializa√ß√£o no construtor, se houver; </li><li>  permite que eu armazene em cache o objeto criado e n√£o exige que tipos derivados declarem e gerenciem o armazenamento para o objeto fornecido, embora agora isso n√£o seja um problema com as propriedades autom√°ticas. </li></ul><br>  Al√©m disso, eu j√° estive nas duas situa√ß√µes: quando um campo em um tipo derivado queria chamar um m√©todo declarado na classe base e quando o inicializador da classe de campo precisava chamar o membro <code>MustOverride</code> implementado pelo tipo derivado.  Ambos s√£o v√°lidos em VB e nenhum em C #, e isso faz sentido.  Se o inicializador de campo C # pudesse chamar um membro da classe base, esse membro poderia depender dos campos inicializados no construtor base (que ainda n√£o est√° sendo executado) e os resultados quase certamente estariam errados, e n√£o havia como contornar isso. <br><br>  Mas no VB, o construtor de base j√° funcionou, ent√£o voc√™ pode fazer qualquer coisa!  Na situa√ß√£o oposta, tudo √© um pouco mais complicado, porque chamar o membro <code>Overridable</code> do inicializador (ou construtor) da classe base pode levar ao acesso aos campos antes que eles sejam "inicializados".  Mas apenas sua implementa√ß√£o sabe se isso √© um problema.  Nos meus scripts, isso simplesmente n√£o acontece.  Eles n√£o dependem do estado da inst√¢ncia, mas n√£o podem ser membros <code>Shared</code> porque voc√™ n√£o pode ter um membro <code>Shared Overridable</code> em nenhum idioma por motivos t√©cnicos al√©m do escopo deste artigo.  Al√©m disso, est√° claramente definido o que acontece com os campos antes de iniciar inicializadores personalizados - eles s√£o inicializados com valores padr√£o, como todas as vari√°veis ‚Äã‚Äãno VB.  Sem surpresas. <br><br>  <b>Ent√£o porque?</b>  Na verdade, n√£o sei se meus scripts eram o que a equipe original do VB.NET tinha em mente quando o projetaram.  Apenas funciona no meu caso!  ,       :  VB ,         ,       .              .          . <br><br> <i> ,              ,    ,          C#  VB,       ,    VB  ,   C#.</i> <br><br><a name="section17"></a><h3> 17.     (backing field)  VB   ,   C#,     </h3><br>          (       ).        <code>E</code> ,  VB   (  IDE)    <code>EEvent</code> .  C#     <code>E</code> ,     ,   <code>E</code>   ,    . <br><br><a name="section18"></a><h3> 18.      VB         </h3><br>      <code>P</code> ,      <code>_P'</code> .    IntelliSense,      .  C#    ¬´¬ª ( <i>mangled</i> ) ,  ,            C#     . <br><br> <b> ?</b>  VB    , -,             ¬´WithEvents¬ª,  -,     ,   -     ,        . <br><br><a name="section19"></a><h3> 19.     read-only    </h3><br>    ,        ,  ‚Ä¶.   VB     ¬´ ¬ª    .    <code>WithEvents</code> -, non-Custom           ,       ,     .    IntelliSense,      ,     ,  .   FTW!  ,   VB  ,    private set;   C#. <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Alarm <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> ReadOnly Code As Integer ReadOnly <span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> Status As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> = <span class="hljs-string"><span class="hljs-string">"Disarmed"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">New</span></span>(code As Integer) <span class="hljs-keyword"><span class="hljs-keyword">Me</span></span>.Code = code <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Arm() <span class="hljs-comment"><span class="hljs-comment">' I'm motifying the value of this externally read-only property here. _Status = "Armed" End Sub Function Disarm(code As Integer) As Boolean If code = Me.Code Then ' And here. _Status = "Disarmed" Return True Else Return False End If End Function End Class</span></span></code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gist.github.com/AnthonyDGreen/57ce7962700c5498894ad417296f9066#file-read-only-auto-property-backing-field-is-writeable-vb</a> <br><br><a name="section20"></a><h3> 20.         </h3><br>  ,  <code>NonSerialized</code> . <br><br>   VB       (expanded) Custom-  2005  (?) <b></b>       ,         ,  ,   <code>NonSerialized</code> .  ,     ,   ,   ,       ¬´¬ª       ,    ¬´ ¬ª. <br><br>     ,   ,          ,  ,   . , , ,     ,     two-way bindable ( ,   <code>PropertyChanged</code> ),     ,    , , ,    . <br><br>   ,     ,       CLSA ¬´Expert Business Objects¬ª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">  (Rocky Lhotka)</a> ,      undo/redo (    ,    ,   - ,  ,     ),       .  ,         .  ,  ,        ,    . <br><br><h2>  </h2><br><a name="section21"></a><h3> 21.    ‚Äî    ,  ;      ( ) </h3><br>   ,      <code>GoTo</code>     .   ,        -   . ,       <code>For</code>  <code>For Each</code> ;  <code>Using</code> , <code>SyncLock</code>  <code>With</code> ,   ,     ,        <code>Finally</code> .   <code>If</code>  <code>Select Case</code> ,  <code>Do</code>  <code>While</code> ,    Try ‚Äî    ,        : <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> retryCount = <span class="hljs-number"><span class="hljs-number">0</span></span> Try Retry: <span class="hljs-comment"><span class="hljs-comment">' IO call. Catch ex As IO.IOException When retryCount &lt; 3 retryCount += 1 GoTo Retry End Try End Sub End Module</span></span></code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gist.github.com/AnthonyDGreen/b93adcf3c3705e4768dcab0b05b187a0#file-try-goto-retry-vb</a> <br><br>  ,  ,   ,   .NET  VB      ¬´¬ª.  VB6        Quick Basic  ( )       .      QB,      .     ,       ¬´ ¬ª,           .        GoTo,         ‚Äî   ,        . <br><br> <b></b> :    <code>Try</code>    ,  VB -   <code>await</code>   <code>Catch</code>  <code>Finally</code> ,  ,     <code>GoTo</code>    . <br><br><a name="section22"></a><h3> 22.     &lt;&gt;   </h3><br>    ,  VB   (     )  ( <code>static</code> )        (      ).    ,     .        <code>Catch</code>       3 .      <code>Try</code>      <code>Catch</code> ,      ,   ,       <code>Try</code>     . <br><br>  ,  VB.NET     ,     .       CLR      VB   .      :           ,    . <br><br> <i>, C# ,        ,       ¬´¬ª.   VB.NET     .</i> <br><br><a name="section22"></a><h3> 23.          </h3><br>       ,        ,    C#       ¬´ ¬ª ( <i>definite assignment</i> ).   ,    , ,         ¬´ ¬ª.   ,   ( )           ,   ,          .    C/C++.      , !   ,        .  ,        ,    , ‚Äî  .           ,     ,   ,         ,  ,         ,      ,          ,    .  ,  BASIC   ,          ,      ¬´¬ª ,       <code>= Nothing</code> , <code>= 0</code> , <code>= False</code>  .. <br><br> ,   ( <i>flow analysis</i> )  VB    ,    . <br><br>         ,    C#   ,  ,          ,            . VB    <i></i>  ,       ,        ,       .  Roslyn, , API       ¬´ ¬ª,       ,      . <br><br><a name="section24"></a><h3> 24. RaiseEvent   ,     null </h3><br>     ,  -     C#  VB. <code>RaiseEvent</code>  VB ‚Äî        ,     <code>null</code> ( ),    <code>null</code> - ‚Äî  ,      . <br><br><pre> <code class="vbscript hljs"><span class="hljs-comment"><span class="hljs-comment">' You don't have to write this: If PropertyChangedEvent IsNot Nothing Then RaiseEvent PropertyChanged(Me, e) End If ' You don't have to write this: Dim handlers = PropertyChangedEvent If handlers IsNot Nothing Then handlers(Me, e) End If ' You don't have to write this either: PropertyChangedEvent?(Me, e) ' Just write this: RaiseEvent PropertyChanged(Me, e)</span></span></code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gist.github.com/AnthonyDGreen/c3dea3d91ef4ffc50cfa92c41f967937#file-null-safe-event-raising-vb</a> <br><br> ,    null-conditional   C#  VS2015     C#   ,      VB (  ),       ,     ;   VB.NET    . <br><br><a name="section25"></a><h3> 25.    ;        (shallow clone) </h3><br>     , ,        17 , ,     .     (boxed)      Object,       <code>System.Runtime.CompilerServices.RuntimeHelper.GetObjectValue</code> .   ,   CLR.    ,    : <br><br><ul><li>     ,      . <br></li><li>       ,    (,     Integer ),      . <br></li><li>        ,            . <br></li></ul><br>    ,     ,  ,    ,       ( <i>late-bound situations</i> ). ,        ,     (    )  ,           ,   ,        ,      ( <i>caller's copy</i> ).          ,     ,  - , ‚Äî     . <br><br>          .     : <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> MyEventArgs <span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> Value As Object <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Structure MyStruct <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> X, Y As Integer <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Structure Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> defaultValue As Object = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> MyStruct <span class="hljs-keyword"><span class="hljs-keyword">With</span></span> {.X = <span class="hljs-number"><span class="hljs-number">3</span></span>, .Y = <span class="hljs-number"><span class="hljs-number">5</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> e = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> MyEventArgs <span class="hljs-keyword"><span class="hljs-keyword">With</span></span> {.Value = defaultValue} RaiseEvent DoSomething(<span class="hljs-literal"><span class="hljs-literal">Nothing</span></span>, e) <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> e.Value <span class="hljs-keyword"><span class="hljs-keyword">Is</span></span> defaultValue <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> <span class="hljs-comment"><span class="hljs-comment">' No handlers have changed anything. Console.WriteLine("Unchanged.") End If End Sub Event DoSomething(sender As Object, e As MyEventArgs) End Module</span></span></code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gist.github.com/AnthonyDGreen/422ac4574af92d9bbbf59f0fbc40b74d#file-get-object-value-vb</a> <br><br>      ,     WPF,               .    ,     . ,                     ,        .    ,    .   ,    -   ,  , ,              . <br><br> ,    ,   ¬´ ¬ª         .    IronRuby/Python,    <code>dynamic</code>  C# (  C#): C#    <code>GetObjectValue</code>     .         <code>object.ReferenceEquals</code> ,  ,    ,   <i></i>    -    <code>dynamic</code> C# (     ).       <code>==</code> ,    .   C#,    ,          . <br><br><a name="section26"></a><h3> 26. Select Case   ¬´¬ª (fall-through);   break </h3><br>     Friday    ,  Sunday ‚Äî  ,  5   . <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> Today.DayOfWeek <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Monday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Tuesday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Wednesday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Thursday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Friday: Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Weekday"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Saturday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Sunday: Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Weekend"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gist.github.com/AnthonyDGreen/7b7e136c71dd11b2417a6c7267bb3546#file-select-case-no-fallthrough-vb</a> <br><br>     Roslyn C#  ,  -      : <i>¬´,    ?   !¬ª</i>   <i>¬´,  ¬ª</i> .   . VS    ,    ,   ,    ,      ,     .    ! <br><br>       . C# ,        C,       C.       .  , C#     ,    case   .   -  ,     <code>goto</code> ,  <code>break</code> .     VB   <code>break</code> , <code>Exit Select</code> ,       ,    VB   . <br><br><a name="section27"></a><h3> 27.   Case     </h3><br>      ,      .           C#,   : <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> Today.DayOfWeek <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Monday, DayOfWeek.Tuesday, DayOfWeek.Wednesday, DayOfWeek.Thursday, DayOfWeek.Friday <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> message = <span class="hljs-string"><span class="hljs-string">"Get to work!"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Saturday, DayOfWeek.Sunday <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> message = <span class="hljs-string"><span class="hljs-string">"Funtime!"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gist.github.com/AnthonyDGreen/bd642061896246c9336255881fb78546#file-select-case-scopes-vb</a> <br><br>   ,  <code>message</code>        ,    C#   <code>switch</code>         <code>case</code> ‚Äî   .     . ,  ,  -    (  ,  C):        , , ,  ,     . <br><br><a name="section28to30"></a><h3> 28, 29, 30. Select Case    ,             = </h3><br> ,  ,     ,            ,     <code>Select Case</code>             . <br><br>             ,       ,     .    : <br><br><ul><li> <code>Select Case</code> ‚Äî  ,           , ‚Ä¶ <br></li><li> <code>switch</code> ‚Äî   / ,   ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a>   ¬ª. <br></li></ul><br>  ,    26-30. <code>switch</code>    ,    ,  , ,     <code>if</code> .  IL   <code>switch</code> ,   ,   <code>If</code> ,   VB        ,   .    switch       , ,    C   .  VB    . <br><br><a name="section31"></a><h3> 31. ,   ,         </h3><br>       <code>x</code>    ,      ,      -1, -2, -3: <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> x As Integer x -= <span class="hljs-number"><span class="hljs-number">1</span></span> Console.WriteLine(x) <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gist.github.com/AnthonyDGreen/cbc3a9c70677354973d64f1d993a3c5d#file-loop-variables-retain-their-values-vb</a> <br><br>    <i>¬´     ,    ,    ¬ª</i> ( ).   ,      VB2008  ,    -: <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> lambdas = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> List(Of Action) <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> x As Integer x -= <span class="hljs-number"><span class="hljs-number">1</span></span> lambdas.Add(<span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span>() Console.WriteLine(x)) <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Each</span></span> lambda <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> lambdas lambda() <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gist.github.com/AnthonyDGreen/2ef9ba3dfcf9a1abe0e94b0cde12faf1#file-loop-variables-captured-per-iteration-vb</a> <br><br>     -1, -2, -3.     <code>x</code> ‚Äî ¬´ ¬ª, -   <code>x</code>    ,      .          ,        <code>x</code>     .     flow analysis API ‚Äî ! ( <i>¬´‚Ä¶ ‚Ä¶  ?¬ª</i> ) <br><br> <b>?</b>   ,  ,      ,    ,      ,        #22.         ,        ,       -,         . <br><br> ,   VB  C#      ( <i>control variables</i> )  <code>For Each</code>  VS2012 (?),  -   ¬´ ¬ª.   10000%    ,    (  , VB      ,      ).  ,    VB         <code>For</code> ,        .            ,      .      ,   VB  <code>For</code>      <code>For Each</code> ,  <code>for</code>  <code>foreach</code>  C#.          ,   <code>For</code>  VB -  ,    ,      . <br><br><a name="section32"></a><h3> 32.    For        </h3><br>         <code>For</code> .        ,   ,       1,3,5,7,9,          ,     . <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> lower = <span class="hljs-number"><span class="hljs-number">1</span></span>, upper = <span class="hljs-number"><span class="hljs-number">9</span></span>, increment = <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> i = lower <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> upper <span class="hljs-keyword"><span class="hljs-keyword">Step</span></span> increment Console.WriteLine(i) upper += <span class="hljs-number"><span class="hljs-number">1</span></span> increment -= <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gist.github.com/AnthonyDGreen/1e48113be204f515c51e221858666ac7#file-for-loop-bounds-cached-vb</a> <br><br>    ,          (       ),   ,     ,    ,          <code>IndexOutOfRangeExceptions</code> ,    . <br><br>   ,   ,      , , ,       C,    VB .  - ,  VB ,  <code>For i = a To b Step c</code>   (  ,  <code>i&gt; b</code> )   (  ,  <code>i &lt;b</code> ),   <code>c</code>    ?    ,    ,      ,   <code>b</code>   ,   ‚Äî .    ,     , , ,       . <br><br><a name="section33"></a><h3> 33. For Each   VB     GetEnumerator </h3><br>       <code>For Each</code> ,     <code>IEnumerable</code> ,       <code>GetEnumerator</code>  ,    <code>For Each</code> . <br> ,   ,     <code>For Each</code>  <code>IEnumerator</code>  ,          , : <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> list = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> List(Of Integer) From {<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> info = list.FirstAndRest() <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> info.First IsNot <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Console.Write(info.First.GetValueOrDefault()) <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Each</span></span> other <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> info.Additional Console.Write(<span class="hljs-string"><span class="hljs-string">", "</span></span>) Console.Write(other) <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> Console.WriteLine() <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> &lt;Runtime.CompilerServices.Extension&gt; <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> FirstAndRest(Of T As Structure)(sequence As IEnumerable(Of T)) As (First As T?, Additional As IEnumerator(Of T)) <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> enumerator = sequence.GetEnumerator() <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> enumerator.MoveNext() <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Return (enumerator.Current, enumerator) <span class="hljs-keyword"><span class="hljs-keyword">Else</span></span> Return (<span class="hljs-literal"><span class="hljs-literal">Nothing</span></span>, enumerator) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> &lt;Runtime.CompilerServices.Extension&gt; <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> GetEnumerator(Of T)(enumerator As IEnumerator(Of T)) As IEnumerator(Of T) Return enumerator <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gist.github.com/AnthonyDGreen/d7dbb7a5b98a940765c4adc33e3eaeee#file-for-each-extension-get-enumerator-vb</a> <br><br>           F#        ,    <code>IEnumerator</code> ,     <code>For Each</code>    ,   . <br><br>  VB   ,            ( <i>well-known name</i> ),      .   , ,   Add,   . C#     ,          (. <code>async</code> / <code>await</code> ).      ,    C# Roslyn ()     ,     . <br><blockquote>  Minuto de publicidade. 15-16   -    .NET- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DotNext 2019 Piter</a> .   ,       .       ,      .     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">  </a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a> . </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt443684/">https://habr.com/ru/post/pt443684/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt443672/index.html">Teste Baseado em Risco</a></li>
<li><a href="../pt443676/index.html">Vinil em vez de selo postal: raridade incomum</a></li>
<li><a href="../pt443678/index.html">Legibilidade do c√≥digo</a></li>
<li><a href="../pt443680/index.html">Semana de trabalho de quatro dias. Experi√™ncia russa</a></li>
<li><a href="../pt443682/index.html">Monetiza√ß√£o da nuvem: como atrair clientes e n√£o falir</a></li>
<li><a href="../pt443686/index.html">30 a 31 de mar√ßo, SIBUR DESAFIO em N√≠jni Novgorod</a></li>
<li><a href="../pt443690/index.html">Parallels RAS: o que √© e o que come?</a></li>
<li><a href="../pt443692/index.html">Alquimia do s√©culo XXI: Convertendo Deut√©rio de Metal L√≠quido em Plasma</a></li>
<li><a href="../pt443694/index.html">Como o navegador ajuda o camarada major</a></li>
<li><a href="../pt443698/index.html">O Google parou de "estrangular o ganso": o DuckDuckGo est√° inclu√≠do na lista de mecanismos de pesquisa padr√£o do Chrome para 60 pa√≠ses</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>