<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìπ üë©üèæ‚Äçü§ù‚Äçüë©üèª ü•á Projection de conflit d'entreprise sur la connectivit√© r√©seau ‚õîÔ∏è ü§∑ ü§üüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Un conflit d'entreprise est survenu le 06/10/2019 en raison d'une augmentation du co√ªt de livraison des SMS aux utilisateurs du r√©seau Vimpelcom par M...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Projection de conflit d'entreprise sur la connectivit√© r√©seau</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/456078/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/cp/8x/ty/cp8xty7ejmoaj8gl7q7uhikmku0.png" alt="image"></div><br>  Un conflit d'entreprise est survenu le 06/10/2019 en raison d'une augmentation du co√ªt de livraison des SMS aux utilisateurs du r√©seau Vimpelcom par Mail.RU Group.  En r√©ponse, Mail.RU Group a cess√© de ¬´desservir¬ª les canaux IP russes directs vers le r√©seau Vimpelcom. <br><br>  Vous trouverez ci-dessous une br√®ve analyse de la situation du point de vue d'un ing√©nieur r√©seau. <br><br>  <b>Mise √† jour</b> : 14/06/2019 18:45 - accent mis sur les routes russes vers le r√©seau VimpelCom, conclusions ajust√©es, a ajout√© une explication de <b>Sergey Kubasov (CIO Vkontakte)</b> . <br>  <b>Mise √† jour</b> : 14/06/2019 19:48 - une description de la m√©thode pour restreindre la distribution des itin√©raires le long de la route russe "courte" via Rostelecom, MTS, RETN.NET est ajout√©e. <br>  <b>Mise √† jour</b> : 15/06/2019 09:39 - Mail.ru a bloqu√© son miroir. <br>  <b>Mise √† jour</b> : 18/06/2019 10:10 - La d√©pynchronisation est termin√©e.  VimpelCom et Mail.RU Group ont soulev√© des sessions BGP directes. <br><br><a name="habracut"></a><br>  Introduction: <br>  VimpelCom dispose d'un syst√®me autonome AS3216, tout le reste (8402 - Internet domestique, 16345 - Internet mobile) est situ√© en 3216. <br><br>  Mail.RU Group - syst√®mes autonomes AS47541, AS47542 et AS47764.  Le principal g√©n√©rateur de contenu est le 47542, le soi-disant  CDN VKONTAKTE (films, musique).  Tous les syst√®mes autonomes sont ind√©pendants les uns des autres (de la position d'un syst√®me autonome externe). <br><br>  Voyons d'abord la situation du r√©seau Vimpelcom.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Looking Glass Vimpelcom</a> nous y aidera. <br><br>  Nous examinons le premier syst√®me autonome - AS47541. <br><br><pre><code class="perl hljs"><span class="hljs-number"><span class="hljs-number">2914</span></span> <span class="hljs-number"><span class="hljs-number">47541</span></span> <span class="hljs-number"><span class="hljs-number">79.104</span></span>.<span class="hljs-number"><span class="hljs-number">32.251</span></span> (metric <span class="hljs-number"><span class="hljs-number">10500</span></span>) (<span class="hljs-number"><span class="hljs-number">79.104</span></span>.<span class="hljs-number"><span class="hljs-number">32.251</span></span>) Origin IGP, metric <span class="hljs-number"><span class="hljs-number">30</span></span>, localpref <span class="hljs-number"><span class="hljs-number">87</span></span>, valid, internal, best, group-best, import-candidate, import suspect Received Path ID <span class="hljs-number"><span class="hljs-number">0</span></span>, Local Path ID <span class="hljs-number"><span class="hljs-number">1</span></span>, version <span class="hljs-number"><span class="hljs-number">2865394342</span></span> Community: <span class="hljs-number"><span class="hljs-number">2914</span></span>:<span class="hljs-number"><span class="hljs-number">410</span></span> <span class="hljs-number"><span class="hljs-number">2914</span></span>:<span class="hljs-number"><span class="hljs-number">1214</span></span> <span class="hljs-number"><span class="hljs-number">2914</span></span>:<span class="hljs-number"><span class="hljs-number">2213</span></span> <span class="hljs-number"><span class="hljs-number">2914</span></span>:<span class="hljs-number"><span class="hljs-number">3200</span></span> <span class="hljs-number"><span class="hljs-number">3216</span></span>:<span class="hljs-number"><span class="hljs-number">3000</span></span> <span class="hljs-number"><span class="hljs-number">3216</span></span>:<span class="hljs-number"><span class="hljs-number">3103</span></span> <span class="hljs-number"><span class="hljs-number">47541</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">47541</span></span>:<span class="hljs-number"><span class="hljs-number">40000</span></span> <span class="hljs-number"><span class="hljs-number">47541</span></span>:<span class="hljs-number"><span class="hljs-number">50078</span></span></code> </pre> <br>  AS-PATH contient deux syst√®mes autonomes - 2914 (NTT) et 47541 (VKONTAKTE-SPB-AS). <br>  La m√©trique localpref est d√©finie sur 87, ce qui, comme d√©crit dans la base de donn√©es RIPE pour l'objet AS3216, correspond √† l'homologation internationale. <br><blockquote>  ... <br>  remarques: Les itin√©raires internationaux des pairs obtiennent une pr√©f√©rence locale <br>  remarques: plage de 81 √† 89. <br>  ... </blockquote>  La communaut√© 3216: 3000 et 3216: 3103 (source - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RIPE DB pour AS3216</a> ) confirme √©galement les m√™mes informations: <br><blockquote>  ... <br>  remarques: 3216: 3000 Re√ßu d'une liaison montante ou d'un pair international, en particulier: <br>  ... <br>  remarques: 3216: 3103 AMS-IX <br>  ... </blockquote>  Autrement dit, Vimpelcom voit la route vers VKontakte √† travers la jonction europ√©enne. <br><br>  Voyons une autre autonomie VKontakte - 47542 (VKONTAKTE-MSK-CDN-AS). <br><br><div class="spoiler">  <b class="spoiler_title">Tout est similaire.</b> <div class="spoiler_text"><pre> <code class="perl hljs"> <span class="hljs-number"><span class="hljs-number">2914</span></span> <span class="hljs-number"><span class="hljs-number">47541</span></span> <span class="hljs-number"><span class="hljs-number">79.104</span></span>.<span class="hljs-number"><span class="hljs-number">32.251</span></span> (metric <span class="hljs-number"><span class="hljs-number">10500</span></span>) (<span class="hljs-number"><span class="hljs-number">79.104</span></span>.<span class="hljs-number"><span class="hljs-number">32.251</span></span>) Origin IGP, metric <span class="hljs-number"><span class="hljs-number">30</span></span>, localpref <span class="hljs-number"><span class="hljs-number">87</span></span>, valid, internal, best, group-best, import-candidate, import suspect Received Path ID <span class="hljs-number"><span class="hljs-number">0</span></span>, Local Path ID <span class="hljs-number"><span class="hljs-number">1</span></span>, version <span class="hljs-number"><span class="hljs-number">2865394338</span></span> Community: <span class="hljs-number"><span class="hljs-number">2914</span></span>:<span class="hljs-number"><span class="hljs-number">410</span></span> <span class="hljs-number"><span class="hljs-number">2914</span></span>:<span class="hljs-number"><span class="hljs-number">1214</span></span> <span class="hljs-number"><span class="hljs-number">2914</span></span>:<span class="hljs-number"><span class="hljs-number">2213</span></span> <span class="hljs-number"><span class="hljs-number">2914</span></span>:<span class="hljs-number"><span class="hljs-number">3200</span></span> <span class="hljs-number"><span class="hljs-number">3216</span></span>:<span class="hljs-number"><span class="hljs-number">3000</span></span> <span class="hljs-number"><span class="hljs-number">3216</span></span>:<span class="hljs-number"><span class="hljs-number">3103</span></span> <span class="hljs-number"><span class="hljs-number">47541</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">47541</span></span>:<span class="hljs-number"><span class="hljs-number">40000</span></span> <span class="hljs-number"><span class="hljs-number">47541</span></span>:<span class="hljs-number"><span class="hljs-number">50078</span></span></code> </pre> <br></div></div><br>  Qu'en est-il de Mail.ru lui-m√™me?  Jetons un coup d'≈ìil √† AS47764 (mailru-as). <br><br><pre> <code class="perl hljs"> <span class="hljs-number"><span class="hljs-number">3356</span></span> <span class="hljs-number"><span class="hljs-number">47764</span></span> <span class="hljs-number"><span class="hljs-number">194.67</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">215</span></span> (metric <span class="hljs-number"><span class="hljs-number">10501</span></span>) (<span class="hljs-number"><span class="hljs-number">194.67</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">215</span></span>) Origin IGP, metric <span class="hljs-number"><span class="hljs-number">0</span></span>, localpref <span class="hljs-number"><span class="hljs-number">77</span></span>, valid, internal, best, group-best, import-candidate Received Path ID <span class="hljs-number"><span class="hljs-number">0</span></span>, Local Path ID <span class="hljs-number"><span class="hljs-number">1</span></span>, version <span class="hljs-number"><span class="hljs-number">2867605667</span></span> Community: <span class="hljs-number"><span class="hljs-number">3216</span></span>:<span class="hljs-number"><span class="hljs-number">3000</span></span> <span class="hljs-number"><span class="hljs-number">3216</span></span>:<span class="hljs-number"><span class="hljs-number">3007</span></span> <span class="hljs-number"><span class="hljs-number">3356</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3356</span></span>:<span class="hljs-number"><span class="hljs-number">22</span></span> <span class="hljs-number"><span class="hljs-number">3356</span></span>:<span class="hljs-number"><span class="hljs-number">100</span></span> <span class="hljs-number"><span class="hljs-number">3356</span></span>:<span class="hljs-number"><span class="hljs-number">123</span></span> <span class="hljs-number"><span class="hljs-number">3356</span></span>:<span class="hljs-number"><span class="hljs-number">519</span></span> <span class="hljs-number"><span class="hljs-number">3356</span></span>:<span class="hljs-number"><span class="hljs-number">2094</span></span> <span class="hljs-number"><span class="hljs-number">47764</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">47764</span></span>:<span class="hljs-number"><span class="hljs-number">40000</span></span> <span class="hljs-number"><span class="hljs-number">47764</span></span>:<span class="hljs-number"><span class="hljs-number">50077</span></span></code> </pre> <br>  VimpelCom voit Mail.ru via as3356 (liaison montante de niveau 3, op√©rateur de niveau 1).  Cette information est confirm√©e par localpref 77: <br><blockquote>  ... <br>  remarques: les routes d'Uplink obtiennent une pr√©f√©rence locale dans la plage de 71 √† 79. <br>  remarques: Derni√®re mise √† jour: f√©vrier 2012 ... </blockquote>  et communaut√© (3216: 3000 et 3216: 3007): <br><blockquote>  ... <br>  remarques: 3216: 3000 Re√ßu d'une liaison montante ou d'un pair international, en particulier: <br>  ... <br>  remarques: 3216: 3007 Communications de niveau 3 <br>  ... </blockquote><br>  Les informations re√ßues montrent que le trafic provenant du r√©seau Vimpelcom sur VKontakte et MailRu est distribu√© via des connexions europ√©ennes selon les itin√©raires re√ßus via le protocole BGP.  Il n'y a pas d'itin√©raires alternatifs via les connexions russes √† Looking Glass.  Aucune mesure n'a √©t√© trouv√©e pour rediriger artificiellement le trafic sur des routes sciemment pires. <br><br>  Et comment le groupe Mail.ru voit-il le r√©seau VimpelCom? <br>  Nous utiliserons <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Looking Glass de Mail</a> .  <b>Mise √† jour</b> : √† partir du matin du 15/06/2019 Looking Glass ne fonctionne pas, lorsque 500e erreur est demand√©e: <img src="https://habrastorage.org/getpro/habr/post_images/515/c79/93c/515c7993ccd0f3d6bd9a5a20d3078ee9.png" alt="image"><br><br>  Depuis les routeurs de AS47764 (mailru-as): <pre> <code class="perl hljs"> Path <span class="hljs-comment"><span class="hljs-comment">#6: Received by speaker 0 Advertised to peers (in unique update groups): 188.93.60.188 1299 1299 1273 3216 3216 217.20.147.250 (metric 100) from 217.20.147.250 (217.20.147.253) Origin IGP, metric 500, localpref 200, valid, internal, best, group-best Received Path ID 0, Local Path ID 0, version 1172721494 Community: 1299:20000 47764:701 47764:41100 47764:41108 47764:50077</span></span></code> </pre> <br><br>  AS-PATH contient AS1299 (Telia, op√©rateur Tier1, liaison montante Mail.RU) et as1273 (Vodafon, op√©rateur Tier1, liaison montante Vimpelcom). <br><br>  LocalPreference 200 est la norme pour les interfaces Mail.ru externes (https://net.mail.ru/bgp.html), et le MED 500 correspond √† tout ce qui est re√ßu non depuis une interface directe, ni depuis des IX-s, ni entre homologues. <br><br>  Mais pourquoi n'y a-t-il pas de routes locales via les op√©rateurs t√©l√©coms russes ??? <br>  Ils le sont, mais leur priorit√© est ¬´non standard¬ª! <br>  Voici l'itin√©raire √† travers Rostelecom (as12389): <pre> <code class="perl hljs"> Path <span class="hljs-comment"><span class="hljs-comment">#1: Received by speaker 0 Not advertised to any peer 12389 3216 46.61.178.149 from 46.61.178.149 (213.59.207.79) Origin IGP, metric 500, localpref 199, valid, external Received Path ID 0, Local Path ID 0, version 0 Community: 3216:2001 3216:2999 3216:4100 12389:5 12389:6 12389:1100 12389:1105 12389:1277 47764:701 47764:41100 47764:41104 47764:50077 Origin-AS validity: not-found</span></span></code> </pre> <br>  Voici √† travers le m√©gaphone (as31133): <pre> <code class="perl hljs"> Path <span class="hljs-comment"><span class="hljs-comment">#2: Received by speaker 0 Not advertised to any peer 31133 3216 78.25.77.41 from 78.25.77.41 (10.222.253.97) Origin IGP, metric 500, localpref 199, valid, external Received Path ID 0, Local Path ID 0, version 0 Community: 3216:2001 3216:2999 3216:4100 31133:300 31133:46170 47764:701 47764:41100 47764:41105 47764:50077 Origin-AS validity: not-found</span></span></code> </pre> <br>  Voici via RET.NO: <pre> <code class="perl hljs"> Path <span class="hljs-comment"><span class="hljs-comment">#3: Received by speaker 0 Not advertised to any peer 9002 9002 3216 87.245.253.24 from 87.245.253.24 (87.245.225.1) Origin IGP, metric 500, localpref 199, valid, external Received Path ID 0, Local Path ID 0, version 0 Community: 9002:9002 9002:64667 47764:701 47764:41100 47764:41101 47764:50077 Origin-AS validity: not-found</span></span></code> </pre> <br>  Et m√™me via MTS! <pre> <code class="perl hljs"> Path <span class="hljs-comment"><span class="hljs-comment">#5: Received by speaker 0 Not advertised to any peer 8359 3216 212.188.61.105 from 212.188.61.105 (195.34.52.77) Origin IGP, metric 500, localpref 199, valid, external Received Path ID 0, Local Path ID 0, version 0 Community: 8359:200 8359:609 8359:5012 47764:701 47764:41100 47764:41103 47764:50077 Origin-AS validity: not-found</span></span></code> </pre> <br>  La m√©trique locale pour ces routes russes est sous-estim√©e, c'est-√†-dire que les routes sont d√©grad√©es par rapport aux routes √©trang√®res! <br><br>  De plus, <b>Mail.Ru Group interdit la</b> distribution de ses pr√©fixes √† VimpelCom via des op√©rateurs russes! <br><br>  RET.NO (http://lg.retn.net/): <br>  Les annonces de Mail.RU Group incluent la communaut√© 3216: 65535. <br><div class="spoiler">  <b class="spoiler_title">Conclusion de LG RET.NO</b> <div class="spoiler_text">  inet.0: 762737 destinations, 1734826 routes (762708 actives, 222780 retenue, 277 masqu√©es) <br>  94.100.176.0/20 (1 entr√©e, 1 annonce) <br>  * Pr√©f√©rence BGP: 170 / -201 <br>  ... <br>  ... <br>  Chemin AS: 47764 I <br>  Chemin AS: enregistr√© <br>  Communaut√©s: 3216: 65535 9002: 64667 9002: 65530 <br>  ... <br></div></div><br>  Vimpelcom n'accepte pas les itin√©raires marqu√©s par une telle communaut√© sur son r√©seau.  Extrait de RIPE DB par AS3216: <br><blockquote>  ... <br>  remarques: les divisions internes ne sont affect√©es qu'en interne. <br>  remarques: ils sont compris entre 3216: 0000-3216: 4999 et 3216: 6000-3216: 65535 <br>  remarques: et sont toujours supprim√©s des mises √† jour entrantes √† la fronti√®re <br>  remarques: routeurs. <br>  ... </blockquote><br>  Vers Rostelecom (http://lg.ip.rt.ru) Mail.RU Group propose des itin√©raires similaires avec la communaut√© 12389: 8350. <br><div class="spoiler">  <b class="spoiler_title">Conclusion de LG Rostelecom</b> <div class="spoiler_text">  94.100.176.0/20 via 217.107.65.1 sur eth0.9 [sr2 2019-06-13] * (100 /?) [AS47764i] <br>  Type: monodiffusion BGP univ <br>  BGP.origin: IGP <br>  BGP.as_path: 47764 <br>  BGP.next_hop: 213.59.207.78 <br>  BGP.med: 0 <br>  BGP.local_pref: 850 <br>  BGP.community: (12389.1) (12389.1100) (12389.1105) (12389.1277) (12389.8350) (12389.8380) (47764.1) (47764,40000) (47764,50077) <br>  BGP.originator_id: 213.59.207.78 <br>  BGP.cluster_list: 95.167.88.79 95.167.88.49 95.167.88.17 <br></div></div><br>  Selon les entr√©es de la base de donn√©es RIPE pour l'objet as12389, cette communaut√© signifie ¬´ne pas annoncer sur le r√©seau as3216¬ª: <blockquote>  ... <br>  remarques: |  12389: 835y lors de la publicit√© sur GoldenTelecom (AS3216) | <br>  ... <br>  remarques: |  ... y = 0 - ne pas annoncer | <br>  ... </blockquote><br>  De m√™me, vers MTS (http://lg.mtu.ru): <div class="spoiler">  <b class="spoiler_title">Conclusion de LG MTS</b> <div class="spoiler_text">  Entr√©e de table de routage BGP pour 94.100.176.0/20, version 161717219 <br>  Chemins: (2 disponibles, meilleur # 1, table par d√©faut) <br>  Multipath: eBGP <br>  Annonc√© aux groupes de mise √† jour: <br>  6 <br>  47764, (re√ßu et utilis√©) <br>  195.34.52.77 (m√©trique 16) √† partir de 195.34.52.181 (195.34.52.181) <br>  Origine IGP, m√©trique 0, localpref 140, valide, interne, meilleure <br>  Communaut√©: 8359: 2120 8359: 2150 8359: 5500 8359: 55277 <br>  Initiateur: 195.34.52.77, Liste des groupes: 83.59.83.59 <br>  47764, (re√ßu et utilis√©) <br>  195.34.52.77 (m√©trique 16) √† partir de 195.34.52.182 (195.34.52.182) <br>  Origine IGP, m√©trique 0, localpref 140, valide, interne <br>  Communaut√©: 8359: 2120 8359: 2150 8359: 5500 8359: 55277 <br>  Initiateur: 195.34.52.77, Liste des groupes: 83.59.2.77 <br></div></div><br>  La communaut√© 8359: 2120 signifie: <blockquote>  ... <br>  remarques: 8359: 212x lors de l'annonce √† Sovam (Beeline) <br>  ... <br>  remarques: x = 0 - ne pas annoncer <br>  ... </blockquote><br>  Vous ne pouvez pas regarder les annonces de Mail.RU Group vers Megafon - ce dernier n'a pas Looking Glass. <br><br>  Voyons AS47541 (VKONTAKTE-SPB-AS). <br><br><div class="spoiler">  <b class="spoiler_title">La conclusion est trop grande.</b> <div class="spoiler_text"><pre> <code class="perl hljs"> Router: a9922-e-<span class="hljs-number"><span class="hljs-number">5</span></span> Command: show ip bgp <span class="hljs-number"><span class="hljs-number">81.211</span></span>.<span class="hljs-number"><span class="hljs-number">56.202</span></span> Last switch-over Thu Apr <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">04</span></span>:<span class="hljs-number"><span class="hljs-number">25</span></span>:09 <span class="hljs-number"><span class="hljs-number">2018</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> year, <span class="hljs-number"><span class="hljs-number">10</span></span> weeks, <span class="hljs-number"><span class="hljs-number">6</span></span> hours, <span class="hljs-number"><span class="hljs-number">9</span></span> minutes ago Fri Jun <span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>:<span class="hljs-number"><span class="hljs-number">34</span></span>:<span class="hljs-number"><span class="hljs-number">20.791</span></span> MSK BGP routing table entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">81.211</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">17</span></span> Versions: Process bRIB/RIB SendTblVer Speaker <span class="hljs-number"><span class="hljs-number">913059757</span></span> <span class="hljs-number"><span class="hljs-number">913059757</span></span> Last Modified: May <span class="hljs-number"><span class="hljs-number">21</span></span> <span class="hljs-number"><span class="hljs-number">05</span></span>:<span class="hljs-number"><span class="hljs-number">20</span></span>:<span class="hljs-number"><span class="hljs-number">38.536</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>y03w Paths: (<span class="hljs-number"><span class="hljs-number">6</span></span> available, best <span class="hljs-comment"><span class="hljs-comment">#4) Advertised to update-groups (with more than one peer): 0.2 Advertised to peers (in unique update groups): 188.93.60.188 Path #1: Received by speaker 0 Not advertised to any peer 1299 1273 3216 3216 87.240.191.235 (metric 31) from 87.240.191.235 (87.240.191.235) Origin IGP, metric 5000, localpref 150, valid, internal Received Path ID 0, Local Path ID 0, version 0 Community: 1273:12752 1299:431 1299:4000 1299:20000 1299:20002 1299:20200 3216:2001 3216:2999 3216:4100 47541:701 47541:41100 47541:41111 47541:50078 Path #2: Received by speaker 0 Not advertised to any peer 1299 1273 3216 3216 87.240.191.248 (metric 31) from 87.240.191.248 (87.240.191.248) Origin IGP, metric 5000, localpref 150, valid, internal Received Path ID 0, Local Path ID 0, version 0 Community: 1273:12752 1299:431 1299:4000 1299:20000 1299:20002 1299:20200 3216:2001 3216:2999 3216:4100 47541:701 47541:41100 47541:41111 47541:50078 Path #3: Received by speaker 0 Not advertised to any peer 174 6762 3216 3216 87.240.191.249 (metric 31) from 87.240.191.249 (87.240.191.249) Origin IGP, metric 5000, localpref 150, valid, internal Received Path ID 0, Local Path ID 0, version 0 Community: 174:21100 174:22005 47541:701 47541:41100 47541:41108 47541:50078 Path #4: Received by speaker 0 Advertised to update-groups (with more than one peer): 0.2 Advertised to peers (in unique update groups): 188.93.60.188 174 6762 3216 3216 149.6.169.113 from 149.6.169.113 (38.28.1.236) Origin IGP, metric 5000, localpref 150, valid, external, best, group-best Received Path ID 0, Local Path ID 0, version 913059757 Community: 174:21100 174:22005 47541:701 47541:41100 47541:41108 47541:50078 Origin-AS validity: not-found Path #5: Received by speaker 0 Not advertised to any peer 1273 1273 3216 3216 195.89.114.197 from 195.89.114.197 (195.2.1.107) Origin IGP, metric 5005, localpref 150, valid, external Received Path ID 0, Local Path ID 0, version 0 Community: 1273:12752 3216:2001 3216:2999 3216:4100 47541:701 47541:41100 47541:41110 47541:50078 Origin-AS validity: not-found Path #6: Received by speaker 0 Not advertised to any peer 3356 3356 3216 3216 3216 213.242.69.69 from 213.242.69.69 (4.69.177.130) Origin IGP, metric 5000, localpref 150, valid, external Received Path ID 0, Local Path ID 0, version 0 Community: 3216:2001 3216:2999 3216:4100 3356:2 3356:22 3356:100 3356:123 3356:503 3356:2067 47541:701 47541:41100 47541:41107 47541:50078 Origin-AS validity: not-found</span></span></code> </pre> </div></div><br>  AS-PATH pointe vers AS174 - Cogent (liaison montante Mail.RU, Tier1), puis AS6762 - Telecom Italia (liaison montante Vimpelcom).  Pr√©f√©rence locale partout 150, mais ainsi de suite sur tous les joints externes, quelles que soient les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">politiques √©crites</a> . <br><br>  Voyons l'AS47542 (VKONTAKTE-MSK-CDN-AS). <br><pre> <code class="perl hljs"> Router: mx96<span class="hljs-number"><span class="hljs-number">0</span></span>-m9-<span class="hljs-number"><span class="hljs-number">0</span></span> Command: op lg-sh-bgp prefix <span class="hljs-number"><span class="hljs-number">81.211</span></span>.<span class="hljs-number"><span class="hljs-number">56.202</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> LP:<span class="hljs-number"><span class="hljs-number">151</span></span> MED: NH:<span class="hljs-number"><span class="hljs-number">87.240</span></span>.<span class="hljs-number"><span class="hljs-number">191.222</span></span> AS path: <span class="hljs-number"><span class="hljs-number">47541</span></span> I Communities: Accepted Best <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> LP:<span class="hljs-number"><span class="hljs-number">151</span></span> MED: NH:<span class="hljs-number"><span class="hljs-number">95.142</span></span>.<span class="hljs-number"><span class="hljs-number">204.251</span></span> AS path: <span class="hljs-number"><span class="hljs-number">47541</span></span> I Communities: Accepted Inactive-reason: Interior &gt; Exterior &gt; Exterior via Interior</code> </pre> <br>  Et √† partir du deuxi√®me routeur: <pre> <code class="perl hljs"> Router: mx96<span class="hljs-number"><span class="hljs-number">0</span></span>-m9-<span class="hljs-number"><span class="hljs-number">1</span></span> Command: op lg-sh-bgp prefix <span class="hljs-number"><span class="hljs-number">81.211</span></span>.<span class="hljs-number"><span class="hljs-number">56.202</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> LP:<span class="hljs-number"><span class="hljs-number">151</span></span> MED: NH:<span class="hljs-number"><span class="hljs-number">87.240</span></span>.<span class="hljs-number"><span class="hljs-number">191.224</span></span> AS path: <span class="hljs-number"><span class="hljs-number">47541</span></span> I Communities: Accepted Best <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> LP:<span class="hljs-number"><span class="hljs-number">151</span></span> MED: NH:<span class="hljs-number"><span class="hljs-number">95.142</span></span>.<span class="hljs-number"><span class="hljs-number">204.250</span></span> AS path: <span class="hljs-number"><span class="hljs-number">47541</span></span> I Communities: Accepted Inactive-reason: Interior &gt; Exterior &gt; Exterior via Interior</code> </pre> <br>  Uniquement les routes par d√©faut (0.0.0.0/0).  Cette situation a √©t√© expliqu√©e par un employ√© de Mail.RU Group <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">gourmandise</a> , dont il remercie.  En bref: le segment moscovite du r√©seau VKontakte est la mise en cache (plut√¥t que la g√©n√©ration), dont la t√¢che est d'optimiser la vitesse de t√©l√©chargement du contenu populaire et demand√©.  Prendre soin des utilisateurs, oui. <br><br>  S'il n'y a pas de route vers un r√©seau, ce r√©seau n'est pas desservi par les serveurs de mise en cache.  L'optimisation de la vitesse de t√©l√©chargement ne fonctionne donc pas et les utilisateurs en souffrent.  Mais ici, il faut souligner - les utilisateurs ne sont pas seulement les leurs, mais aussi VimpelCom. <br><br>  <b>Conclusions:</b> <br><br><ol><li>  Depuis Vimpelcom, le trafic vers Mail.RU Group est distribu√© naturellement.  Aucune redirection artificielle via les manipulations des pr√©f√©rences locales d√©tect√©e </li><li>  <b>De la part de Mail.RU Group, il y a des manipulations avec les pr√©fixes Vimpelcom</b> .  Sur les routes existantes vers le r√©seau Vimpelcom via des op√©rateurs russes, les priorit√©s sont sous-estim√©es par rapport aux routes passant par des op√©rateurs Tier1 √©trangers. </li><li>  Des managers de la communaut√© BGP ont √©t√© ajout√©s aux routes transf√©r√©es aux op√©rateurs russes (MTS, Rostelecom, RETN.NET) du groupe Mail.RU pour limiter leur distribution √† Vimpelcom </li></ol><br>  Pourquoi Mail.RU Group priorise-t-il les itin√©raires √† travers l'Europe?  Pourquoi Mail.RU Group interdit une courte connexion domestique avec Vimpelcom? <br><br>  Est-ce moins cher pour eux?  G√©n√©rer du trafic via des canaux √©trangers et payer des devises aux tirvans? <br>  Ou y a-t-il un d√©sir de chasser le trafic pour que ce ne soit pas si pratique de le prendre, hein? <br>  Ceci est inconnu de l'ing√©nieur r√©seau ... <br><br>  <b>R√©sultats d√©pyring:</b> <br>  17/06/2019 BGP-sessions entre Vimpelcom et Mail.RU Group ont √©t√© soulev√©es: <br>  AS47764 (Mail.RU): <br><img src="https://habrastorage.org/webt/8s/pl/gk/8splgktg26dnwc_4ihehoprx8-k.png" alt="image"><br><br>  AS47541 (Vk): <br><img src="https://habrastorage.org/getpro/habr/post_images/867/0b4/829/8670b482948ddb6df8d498e43d9dbd73.png" alt="image"><br><br>  AS47542 (Vk CDN): <br><img src="https://habrastorage.org/webt/vm/fc/8z/vmfc8zpjdbimpe1eox2qi7ojndi.png" alt="image"><br><br>  On ne sait pas qui a initi√© la lev√©e des s√©ances. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr456078/">https://habr.com/ru/post/fr456078/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr456064/index.html">Octobre Approches de s√©curit√© r√©volutionnaires</a></li>
<li><a href="../fr456068/index.html">5 fautes d√©butant</a></li>
<li><a href="../fr456070/index.html">Comment attirer des utilisateurs vers le portail en libre-service</a></li>
<li><a href="../fr456072/index.html">Dav1d - le d√©codeur AV1 le plus rapide maintenant dans Firefox par d√©faut</a></li>
<li><a href="../fr456076/index.html">Meetup PyDaCon au groupe Mail.ru: 22 juin</a></li>
<li><a href="../fr456082/index.html">Comment nous d√©veloppons des recommandations de produits personnalis√©es</a></li>
<li><a href="../fr456084/index.html">Kubernetes 1.15: Aper√ßu des faits saillants</a></li>
<li><a href="../fr456086/index.html">Storyboards iOS: analyse des avantages et des inconv√©nients, meilleures pratiques</a></li>
<li><a href="../fr456088/index.html">Probl√®mes d'analyse du Big Data</a></li>
<li><a href="../fr456090/index.html">Introduction aux tests unitaires dans Unity</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>