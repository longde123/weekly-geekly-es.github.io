<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤟🏻 🐭 🚭 Mon git commit préféré 👩‍👩‍👧‍👦 🦕 🚌</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Remarque perev. : Cette publication d'un programmeur britannique, qui est devenu un véritable succès sur Internet anglophone, fait référence à un enga...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mon git commit préféré</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/472278/">  <i><b>Remarque</b></i>  <i><b>perev.</b></i>  <i>: Cette publication d'un programmeur britannique, qui est devenu un véritable succès sur Internet anglophone, fait référence à un engagement de Git il y a 6 ans.</i>  <i>Il a été enregistré dans l'un des référentiels ouverts du service numérique du gouvernement - un service dédié au développement de services numériques au Royaume-Uni et soutenant le projet GOV.UK.</i>  <i>Le commit lui-même est intéressant non pas tant avec les modifications du code qu'avec la description qui les accompagne ...</i> <br><br><img src="https://habrastorage.org/webt/iw/ez/ls/iwezlskublg1rm-81mn2fcdwmx4.png"><br>  <i>Image de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">xkcd # 1296</a></i> <br><br>  J'adore les descriptions de commit dans Git.  Lorsqu'ils sont utilisés correctement, ils peuvent être appelés l'un des outils les plus puissants pour documenter l'évolution de la base de code au cours de son existence.  Je veux illustrer mon point de vue avec l'exemple de ma description préférée. <a name="habracut"></a><br><br>  Cet engagement remonte à l'époque où je travaillais chez Government Digital Service.  Son auteur est un développeur nommé <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Dan Carley</a> , et il a un titre plutôt banal: " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Converti le modèle en US-ASCII pour corriger l'erreur</a> ." <br><br><blockquote>  «J'ai implémenté plusieurs tests dans la branche des fonctionnalités pour faire correspondre le contenu de« / etc / nginx / router_routes.conf ».  Ils fonctionnaient bien s'ils étaient exécutés avec les commandes `bundle exec rake spec` ou` bundle exec rspec modules / router / spec`.  Mais lors de l'exécution de `bundle exec rake`, chaque bloc devrait échouer: <br><br><pre><code class="plaintext hljs">ArgumentError: invalid byte sequence in US-ASCII</code> </pre> <br>  Au final, j'ai trouvé qu'après l'exception à l'expression `.with_content (//)`, toutes les erreurs disparaissent.  Qu'il n'y a pas de caractères étranges dans le fichier de spécifications.  Et aussi qu'il peut être joué en appelant Puppet dans le même interprète: <br><br><pre> <code class="plaintext hljs"> rake -E 'require "puppet"' spec</code> </pre> <br>  Ce modèle semble être le seul fichier de notre base de code encodé avec 'utf-8'.  Tous les autres fichiers de 'us-ascii': <br><br><pre> <code class="plaintext hljs"> dcarley-MBA:puppet dcarley$ find modules -type f -exec file --mime {} \+ | grep utf modules/router/templates/routes.conf.erb: text/plain; charset=utf-8</code> </pre> <br>  Une tentative de transcodage en US-ASCII a échoué en raison d'un seul caractère qui ressemble à un espace: <br><br><pre> <code class="plaintext hljs"> dcarley-MBA:puppet dcarley$ iconv -f UTF8 -t US-ASCII modules/router/templates/routes.conf.erb 2&gt;&amp;1 | tail -n5 proxy_intercept_errors off; # Set proxy timeout to 50 seconds as a quick fix for problems # iconv: modules/router/templates/routes.conf.erb:458:3: cannot convert</code> </pre> <br>  Après l'avoir remplacé (manuellement), le fichier est redevenu 'US-ASCII': <br><br><pre> <code class="plaintext hljs"> dcarley-MBA:puppet dcarley$ file --mime modules/router/templates/routes.conf.erb modules/router/templates/routes.conf.erb: text/plain; charset=us-ascii</code> </pre> <br>  Maintenant, les tests fonctionnent!  L'heure entière de ma vie ne peut pas être restituée ... " </blockquote><br><div class="spoiler">  <b class="spoiler_title">Dans l'original</b> <div class="spoiler_text"><h2>  Convertir le modèle en US-ASCII pour corriger l'erreur </h2><br><blockquote>  J'ai introduit quelques tests dans une branche de fonctionnalité pour faire correspondre le contenu de <br>  `/ etc / nginx / router_routes.conf`.  Ils ont bien fonctionné lors de l'exécution avec `bundle exec <br>  rake spec` ou `bundle exec rspec modules / router / spec`.  Mais lorsqu'il est exécuté en tant que <br>  `bundle exec rake` chacun devrait bloquer a échoué avec: <br><br><pre> <code class="plaintext hljs"> ArgumentError: invalid byte sequence in US-ASCII</code> </pre> <br>  J'ai finalement trouvé que la suppression des matchers `.with_content (//)` rendait <br>  les erreurs disparaissent.  Qu'il n'y avait pas de caractères étranges dans le fichier de spécifications.  Et <br>  qu'il pourrait être reproduit en exigeant Puppet dans le même interprète avec: <br><br><pre> <code class="plaintext hljs"> rake -E 'require "puppet"' spec</code> </pre> <br>  Ce modèle particulier semble être le seul fichier de notre base de code avec un <br>  codage identifié de «utf-8».  Tous les autres sont «us-ascii»: <br><br><pre> <code class="plaintext hljs"> dcarley-MBA:puppet dcarley$ find modules -type f -exec file --mime {} \+ | grep utf modules/router/templates/routes.conf.erb: text/plain; charset=utf-8</code> </pre> <br>  Tenter de reconvertir ce fichier en US-ASCII a identifié l'infraction <br>  personnage comme quelque chose qui ressemblait à un espace: <br><br><pre> <code class="plaintext hljs"> dcarley-MBA:puppet dcarley$ iconv -f UTF8 -t US-ASCII modules/router/templates/routes.conf.erb 2&gt;&amp;1 | tail -n5 proxy_intercept_errors off; # Set proxy timeout to 50 seconds as a quick fix for problems # iconv: modules/router/templates/routes.conf.erb:458:3: cannot convert</code> </pre> <br>  Après l'avoir remplacé (à la main), le fichier s'identifie à nouveau comme «us-ascii»: <br><br><pre> <code class="plaintext hljs"> dcarley-MBA:puppet dcarley$ file --mime modules/router/templates/routes.conf.erb modules/router/templates/routes.conf.erb: text/plain; charset=us-ascii</code> </pre> <br>  Maintenant, les tests fonctionnent!  Une heure de ma vie, je ne reviendrai pas .. </blockquote></div></div><br><img src="https://habrastorage.org/webt/qt/4_/7e/qt4_7esruvjc41if3v41fpgg_kk.png"><br><br>  Une petite digression: l'un des avantages du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">développement open source</a> pratiqué dans GDS est que vous pouvez partager des exemples comme celui-ci en dehors de l'organisation qui les a créés.  Je ne sais pas qui a proposé ce concept à GDS pour la première fois - au moment où j'ai rejoint l'organisation, il était déjà largement utilisé - mais je suis infiniment reconnaissant envers cette personne. <br><br><h2>  Pourquoi j'aime ce commit </h2><br>  D'innombrables fois, je l'ai cité comme un exemple de ce dont les descriptions de commit sont capables.  C'est un peu drôle à cause du ratio de changements dans le code et de la taille de la description, mais je ne l'aime pas du tout. <br><br>  Dans une autre entreprise, avec un autre développeur, le message entier du commit pourrait être réduit à des phrases comme «remplacé l'espace», «corrigé l'erreur» ou (selon la culture de l'équipe) à des attaques contre l'inventeur d'espaces inextricables.  Au lieu de cela, Dan a pris le temps de créer une description détaillée utile aux autres.  Je voudrais m'attarder sur les raisons pour lesquelles je considère cet engagement comme un très bon exemple. <br><br><h3>  Divulgue la raison des changements </h3><br>  Les meilleures descriptions de commits indiquent non seulement <b>ce qui</b> a changé, mais expliquent également <b>pourquoi</b> .  Dans notre cas: <br><br><blockquote>  J'ai implémenté plusieurs tests dans la branche des fonctionnalités pour faire correspondre le contenu de `/ etc / nginx / router_routes.conf`.  Ils fonctionnaient bien s'ils étaient exécutés avec les commandes `bundle exec rake spec` ou` bundle exec rspec modules / router / spec`.  Mais lors de l'exécution de `bundle exec rake`, chaque bloc devrait échouer: <br><br><pre> <code class="plaintext hljs"> ArgumentError: invalid byte sequence in US-ASCII</code> </pre> </blockquote><br>  Sans un tel niveau de détail, nous pourrions supposer que la validation a corrigé l'erreur d'analyse dans un outil particulier.  Grâce à la description du commit, nous savons de quel type d'outil il s'agissait. <br><br>  Ce type d'informations peut s'avérer très utile et il est trop facile à perdre, car les gens ont tendance à oublier les subtilités de leur travail, à passer à d'autres équipes et, finalement, à quitter l'entreprise. <br><br><h3>  Bon pour la recherche </h3><br>  L'un des éléments clés de cette description est l'erreur elle-même, avec laquelle de nouvelles recherches ont commencé: <br><br><blockquote>  ArgumentError: <br>  séquence d'octets invalide en US-ASCII </blockquote><br>  Quiconque rencontre cette erreur peut rechercher la base de code, soit en exécutant <code>git log --grep "invalid byte sequence"</code> , soit en utilisant la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">recherche de</a> <code>git log --grep "invalid byte sequence"</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">GitHub</a> .  En fait, à en juger par les résultats de la recherche, beaucoup l'ont déjà fait et ont découvert qui et quand faire face à ce problème et comment il a finalement été résolu. <br><br><h3>  Fournit une image complète </h3><br>  Le message de validation détaille l'apparence du problème, la manière dont il a été étudié et résolu.  Par exemple: <br><br><blockquote>  Au final, j'ai trouvé qu'après l'exception à l'expression `.with_content (//)`, toutes les erreurs disparaissent.  Qu'il n'y a pas de caractères étranges dans le fichier de spécifications.  Et aussi qu'il peut être joué en appelant Puppet dans le même interprète. </blockquote><br>  C'est l'un des domaines dans lesquels les messages lors des validations sont vraiment capables de s'afficher, car ils décrivent le changement lui-même, et non un fichier, une fonction ou une ligne de code.  Cela en fait un endroit idéal pour stocker ce type d'informations d'aventure de base de code supplémentaires. <br><br><h3>  Rend tout le monde un peu plus intelligent </h3><br>  Dan a fait une chose ici, que j'apprécie vraiment: faire venir toutes les équipes que j'ai exécutées à chaque étape.  Il s'agit d'un excellent moyen abordable de partager des connaissances en équipe.  En lisant sa description du commit, vous pouvez en apprendre beaucoup sur les outils Unix: <br><br><ul><li>  vous pouvez passer l'argument <code>-exec</code> pour <code>find</code> pour exécuter une commande avec chaque fichier trouvé; </li><li>  ajouter <code>\+</code> à la fin de la commande fait quelque chose de très intéressant (transmet plusieurs noms de fichier à la commande <code>file</code> et n'exécute pas la commande une fois pour chaque fichier); </li><li>  <code>file --mime</code> permet de connaître le type MIME du fichier; </li><li>  il y a un utilitaire <code>iconv</code> . </li></ul><br>  Une personne qui regarde une description peut en apprendre davantage sur toutes ces choses.  Quiconque tombe sur ce commit plus tard en apprendra également davantage sur ces choses.  Si vous multipliez cette approche pour des engagements sur une longue période et un nombre suffisant d'entre eux, cela peut devenir un puissant stimulant pour l'équipe. <br><br><h3>  Développe l'empathie et la confiance </h3><br><blockquote>  Maintenant, les tests fonctionnent!  L'heure entière de ma vie ne peut être restituée ... </blockquote><br>  Le dernier paragraphe ajoute un minimum d'humanité.  En lisant ces mots, il est difficile de ne pas ressentir la déception de Dan, qui a dû passer une heure entière à chercher une erreur cachée, et la satisfaction de la corriger. <br><br>  Imaginez maintenant un message similaire attaché à un hack temporaire ou à un fragment du code prototype qui est entré en production et «a pris racine» (comme c'est souvent le cas avec de tels fragments).  Cette description du commit rappelle à chacun que derrière chaque changement se trouve une personne qui prend la meilleure décision possible, compte tenu des informations disponibles à ce moment-là. <br><br><h2>  Les bons engagements comptent </h2><br>  J'avoue que c'est un exemple extrême, et je ne m'attends pas à ce que tous les commits (en particulier d'une telle portée) offrent le même niveau de détail.  Cependant, je pense toujours que c'est un excellent exemple pour expliquer la raison du changement, aider les autres à apprendre de nouvelles choses et contribuer au modèle mental collectif associé à la base de code. <br><br>  Si vous voulez en savoir un peu plus sur les avantages d'une bonne description des validations et sur certains outils qui facilitent la structuration des modifications, je peux recommander les matériaux suivants: <br><br><ul><li>  « <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Raconter des histoires à travers vos commits</a> » par Joel Chippindale; </li><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Une branche dans le temps</a> " par Tekin Süleyman. </li></ul><br><h2>  PS du traducteur </h2><br>  Lisez aussi dans notre blog: <br><br><ul><li>  « <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Git arrive!</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">6 erreurs Git typiques et comment les corriger</a> "; </li><li>  «Une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">merveilleuse astuce pour faire un mainteneur de projet open source par jour</a> »; </li><li>  « <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Qu'ont en commun les grands projets Open Source réussis?</a>  ". </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr472278/">https://habr.com/ru/post/fr472278/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr472264/index.html">Archéologie numérique et réalité virtuelle ou comment j'ai essayé de me faire des amis avec le BIM et la VR</a></li>
<li><a href="../fr472268/index.html">Amélioration des contrôles Microsoft Edge sur Chromium</a></li>
<li><a href="../fr472270/index.html">«Vous n'avez pas accès à la prière actuelle»: des perles hi-tech du Vatican ont été piratées en 15 minutes</a></li>
<li><a href="../fr472272/index.html">Un nouveau jeu avec une vieille ambiance sur Three.js. 2e partie</a></li>
<li><a href="../fr472274/index.html">SSH à distance: conseils et astuces</a></li>
<li><a href="../fr472280/index.html">La tâche de déterminer la présence d'une paume sur un scanner veineux</a></li>
<li><a href="../fr472288/index.html">9 extensions de navigateur utiles pour les développeurs (liste pour 2020)</a></li>
<li><a href="../fr472290/index.html">Structures vs classes</a></li>
<li><a href="../fr472292/index.html">Blocage de contenu: la scène mondiale</a></li>
<li><a href="../fr472294/index.html">Créez des jeux et des vidéos sur YouTube. Mon expérience d'interaction et les revenus de cette</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>