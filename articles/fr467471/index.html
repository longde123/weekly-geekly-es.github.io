<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👌🏾 🤶🏼 🎱 Soul Mikrotik contre ILV sans âme et le même fournisseur 👩🏻‍🎨 🔇 🤕</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'article décrit un moyen d'accéder à des ressources tombant par erreur dans la distribution de petits pains par Roskomnadzor (ci-après RKN). Il est p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Soul Mikrotik contre ILV sans âme et le même fournisseur</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467471/">  L'article décrit un moyen d'accéder à des ressources tombant par erreur dans la distribution de petits pains par Roskomnadzor (ci-après RKN).  Il est pris par erreur.  Nous sommes des citoyens respectueux des lois et n'allons pas là où nos agences gouvernementales nous l'interdisent.  Donc, si vous décidez soudainement d'utiliser la méthode pour accéder à une sorte de ressources bloquées «légalement», l'épée dure de la justice volera probablement au-dessus de votre tête et je ne suis pas à blâmer pour cela, car en ce moment je vous ai prévenu! <br><a name="habracut"></a><br>  Le problème est survenu de façon inattendue lorsque notre bureau central a déménagé dans un autre endroit et, par conséquent, a changé de fournisseur.  Les employés en masse ont commencé à me plaindre qu'ils ne pouvaient pas accéder aux sites auxquels ils avaient précédemment accès.  Dans le même temps, depuis nos autres bureaux assis sur d'autres prestataires, des sites étaient toujours disponibles. <br><br>  Pendant un certain temps, à cause des tracas de déménager, j'ai ignoré le problème, mais lorsque le service comptable a commencé à se plaindre (avez-vous également le service comptable en importance après la gestion de l'entreprise?), J'ai dû le régler. <br><br>  Tout d'abord, les soupçons portaient sur des problèmes avec MTU et MSS.  Mais avec eux, heureusement, tout s'est avéré être en ordre.  J'ai frappé un domaine problématique basé sur ILV, également OK, le domaine est propre.  J'ai ouvert le site via les passerelles d'autres agences (3 prestataires différents), il ouvre.  Mais grâce à notre fournisseur pour le domaine IP, même les pings ne vont pas.  Et puis j'ai deviné de percer le domaine de problème IP ILV.  Vous avez déjà deviné que l'IP était dans la base de données? <br><br>  Mais où se trouve alors une redirection vers une page indiquant que cette ressource est bloquée, etc.  etc., demandez-vous.  Et j'ai demandé.  Au début, j'ai vraiment essayé d'ouvrir plusieurs sites où auparavant, quand c'était possible, nous cherchions tous quelque chose à voir ou à télécharger.  Et en veillant à ce qu'il n'y ait aucun avertissement concernant le blocage sur ces sites, j'ai appelé le fournisseur. <br><br>  Le prestataire m'a écouté, a admis qu'il y avait un problème, mais il n'y a pas d'avertissement. <br><br>  J'ai sympathisé avec ma situation, mais j'ai refusé de corriger quelque chose.  Par exemple, nous respectons l'exigence de blocage, mais il n'y a aucune exigence de notification.  Sur lequel nous avons dit au revoir. <br><br>  Bien sûr, j'avais un désir de lutter avec le fournisseur, mais la paresse et le manque de temps libre ont profondément poussé ce désir.  À peu près au même endroit où j'ai envoyé un fournisseur avec son Internet dans mon cœur, là où le soleil ne brille pas. <br><br>  Le problème devait être résolu d'une manière ou d'une autre.  Notre entreprise utilise Mikrotiki comme passerelles-routeurs, peu importe lesquels, le routeur OS est le même pour tout le monde.  Après avoir fouillé autour de Habré, j'ai trouvé quelques articles sur la façon de contourner les verrous ILV, de générer et de charger la base de données ILV dans Mikrotik.  Dans le même temps, le routage a bloqué le trafic vers les passerelles où il n'y a pas de verrous.  Par intérêt, j'ai essayé cette méthode.  Cela fonctionne, mais ne convient pas. <br>  Premièrement, le volume de base de 60000 ip (au début de l'été 2019) a envoyé mon Mikrotik dans un coma profond.  Le routeur CHR OS avec une grande capacité de mémoire et plusieurs cœurs s'est senti légèrement mieux, mais a précisé qu'avec une telle attitude consciencieuse de l'ILV envers ses fonctions, il ne durerait pas longtemps. <br><br>  Deuxièmement, l'accès a été obtenu à toutes les ressources bloquées, y compris celles qui ont été bloquées pour des motifs «légaux».  Que moi, en tant que citoyen respectueux des lois, ne me convenait pas non plus. <br><br>  Mais l'idée même de diriger le trafic vers des sites autorisés via ces passerelles où il n'est pas bloqué me vient à l'esprit. <br><br>  Que pouvons-nous faire pour cela? <br><br>  La première chose qui me vient à l'esprit est de découvrir l'IP de la ressource et de déterminer la passerelle pour celle-ci dans le routage pour elle.  Pas une option, une ressource peut avoir plusieurs ip et elles peuvent changer, parfois souvent.  Fatigué d'ajouter. <br><br>  La seconde consiste à analyser IP en utilisant la couche 7 dans le pare-feu, en les entrant dans la liste d'adresses.  Déjà mieux, mais la couche 7 a une fonctionnalité désagréable.  S'il y a plusieurs règles, alors il commence à se rapporter aux ressources du processeur de la même manière que certaines femmes se rapportent au salaire de leur mari.  En conséquence, des querelles, des scandales et d'autres problèmes commencent dans la famille. <br><br>  Diriger tout le trafic via la passerelle distante est également préjudiciable. <br><br>  Heureusement, au MUM de septembre, l'un des orateurs a révélé un terrible secret.  Il s'avère que Mikrotiki a appris pendant un certain temps à analyser un domaine IP directement de son nom dans la feuille d'adresse, en ajoutant IP à la même feuille!  Armé des informations que j'ai reçues, j'ai finalement résolu le problème. <br><br>  Voici un exemple de solution: <br><br>  1. Nous créons dans le pare-feu la feuille d'adresse avec le domaine souhaité. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" title="télécharger une photo"><img src="https://habrastorage.org/getpro/habr/post_images/2d2/80f/c04/2d280fc0483cd7b2f29ac5a25760b845.png" alt="alist.png"></a> <br><br>  2. Dans le Firewall \ Mangle, créez une règle, chaîne: pré-routage, avancé: Dst.Address list = notre nom de feuille, action: marquer le routage, New Routing Mark = nom de marque <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" title="partage de photos"><img src="https://habrastorage.org/getpro/habr/post_images/77e/27b/c92/77e27bc9239c0dc916ea08a37809f116.png" alt="Oui"></a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" title="télécharger un selfie"><img src="https://habrastorage.org/getpro/habr/post_images/71b/9d8/0a4/71b9d80a4ec662ed262743b089292ff5.png" alt="Oui"></a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" title="hébergement d'images"><img src="https://habrastorage.org/getpro/habr/post_images/622/462/778/6224627781f3e0ee32df90b9160d7636.png" alt="Oui"></a> <br><br>  3. Nous allons à IP \ Routes.  Créez une nouvelle route par défaut.  Adresse Dst = 0.0.0.0 / 0, Gateway = Gateway IP, Routing Mark = Your Brand <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" title="télécharger une photo"><img src="https://habrastorage.org/getpro/habr/post_images/681/514/307/6815143074027220adef8abc76be0a8b.png" alt="route.png"></a> <br><br>  C’est tout.  Maintenant, votre Mikrotik analysera l'IP du domaine souhaité sur la feuille d'adresse que vous avez créée pour cela, marquera les itinéraires vers cette IP et les enverra via la passerelle dont vous avez besoin.  Avez-vous une passerelle de sauvegarde?  Sourire <br><br>  Cela a été fait sur le firmware 6.45.5 <br><br>  Merci de votre attention. <cut></cut></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr467471/">https://habr.com/ru/post/fr467471/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr467457/index.html">Le chemin de la chirurgie au développement de jeux ou la première expérience de développement mobile sur Unity</a></li>
<li><a href="../fr467459/index.html">Comment un microcontrôleur peut lire des données à 1,6 Gbit / s</a></li>
<li><a href="../fr467461/index.html">RubyRussia 2019. Julian Pokrovsky: comment optimiser un monolithe</a></li>
<li><a href="../fr467463/index.html">Juste la division, ou comment créer une théorie mathématique et y gagner 400 000 $. Troisième série, finale</a></li>
<li><a href="../fr467465/index.html">Le cloud sauvera-t-il les smartphones ultra-économiques</a></li>
<li><a href="../fr467473/index.html">Et plus sur les sortes</a></li>
<li><a href="../fr467475/index.html">Renvoyez Thread.Abort () à .NET Core. Livraison d'applications avec sa version de CoreCLR et CoreFX</a></li>
<li><a href="../fr467477/index.html">Kubernetes 1.16: Aperçu des faits saillants</a></li>
<li><a href="../fr467479/index.html">Kir Shatrov: Shopify a commencé avec Rails et ici, ils aiment sincèrement ce cadre.</a></li>
<li><a href="../fr467485/index.html">Résolution de problèmes avec pwnable.kr 23 - calculatrice md5. Nous traitons avec Stack Canary. Connexion des bibliothèques C en python</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>