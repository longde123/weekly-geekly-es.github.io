<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôéüèº üîò üôâ Carro para camiones ROS. Parte 8. Controlamos desde el control del tel√©fono ROS, nodo GPS üöó üçÑ ü•™</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Continuaci√≥n de la serie de art√≠culos. 

 Publicaciones en la serie: 
 8. Controlamos desde el control del tel√©fono ROS, nodo GPS 
 7. Localizaci√≥n de...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Carro para camiones ROS. Parte 8. Controlamos desde el control del tel√©fono ROS, nodo GPS</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/474650/">  Continuaci√≥n de la serie de art√≠culos. <br><br>  Publicaciones en la serie: <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">8. Controlamos desde el control del tel√©fono ROS, nodo GPS</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">7. Localizaci√≥n de robots: gmapping, AMCL, puntos de referencia en el mapa de la sala</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">6. Odometr√≠a con codificadores de rueda, mapa de habitaci√≥n, lidar</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">5. Trabajamos en rviz y gazebo: xacro, nuevos sensores.</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">4. Cree una simulaci√≥n de robot utilizando los editores rviz y gazebo.</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">3. Acelera, cambia la c√°mara, arregla la marcha</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">2. Software</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">1. hierro</a> <br><br>  Al construir mapas en un robot dentro de un espacio limitado, no hay problemas.  Al controlar el robot desde el teclado desde la estaci√≥n de control o en el propio robot, puede observar visualmente sus movimientos y evitar obst√°culos no deseados a tiempo.  La situaci√≥n es complicada si hay varias habitaciones.  Y aqu√≠ hay varias opciones para observar a un robot que construye un mapa si sale de la sala del operador: <br>  - conecte la c√°mara directamente al robot; <br>  - utilizar el sistema de videovigilancia existente fuera del robot; <br>  - control con wi-fi, teclado bluetooth, estar cerca del robot <br>  - "lleve el robot en sus brazos" para que el lidar recopile datos; <br>  - Controla el robot desde el tel√©fono. <br><a name="habracut"></a><br>  La √∫ltima opci√≥n puede parecer conveniente.  Para controlar el robot desde el tel√©fono, simplemente incl√≠nelo (el tel√©fono) en la direcci√≥n correcta, mientras el robot est√° construyendo un mapa.  Tal misi√≥n es posible. <br>  Consideremos c√≥mo dirigir el robot desde el tel√©fono, enviando los mensajes apropiados a los temas de ROS en el robot. <br><br>  No es necesario escribir una aplicaci√≥n separada en el tel√©fono para los fines establecidos.  Para aprovechar las pr√°cticas existentes, simplemente descargue en su tel√©fono e instale la aplicaci√≥n de Android del mercado: "ROS Control". <br><br><h3>  Configure la aplicaci√≥n ROS Control en su tel√©fono. </h3><br>  La aplicaci√≥n es intuitiva: se agrega un robot con un signo "+", su ip est√° configurada: <br><div class="spoiler">  <b class="spoiler_title">foto</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/po/3v/9a/po3v9av548trasyybv9wis4sqxo.jpeg"><br></div></div><br>  A continuaci√≥n, seleccione "Mostrar opciones avanzadas" y prescriba temas para el carro robot: <br><div class="spoiler">  <b class="spoiler_title">foto</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/0e/hf/ke/0ehfkefnorviylss6zea5hyphry.jpeg"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">foto</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/it/vh/2m/itvh2mtm6neqjlq7eoxy21ekqpy.jpeg"><br></div></div><br>  Los mensajes del tel√©fono abordar√°n estos temas y tambi√©n ser√°n aceptados en un formato que ROS entienda. <br>  En la aplicaci√≥n, los temas est√°n disponibles para nosotros: <br>  - tema de joystick - control desde el tel√©fono; <br>  - tema de escaneo l√°ser - datos del lidar; <br>  - tema de navegaci√≥n por sat√©lite - datos del robot gps; <br>  - odom - odometr√≠a (todo lo que llega desde codificadores y / o imu y / o lidar); <br>  - pose - "posici√≥n", la ubicaci√≥n del robot. <br><br><h3>  Domina el tema del joystick. </h3><br>  El robot en s√≠ no funcionar√°, por lo tanto, lanzaremos un tema sobre el robot con un controlador de movimiento, que ya ha aparecido en publicaciones anteriores: <br>  1er terminal: <br> <code>rosrun rosbots_driver part2_cmr.py</code> <br> <br>  En el tel√©fono en la aplicaci√≥n ROS Control, haga clic en la l√≠nea con el nombre del robot y falle en el men√∫ de control del robot: <br><div class="spoiler">  <b class="spoiler_title">foto</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/7t/r7/47/7tr747_em8xzhfageitu3ouixwc.jpeg"><br></div></div><br>  Ahora, si tira del joystick con el dedo (en cualquier direcci√≥n), el carro ir√°. Todo es simple aqu√≠. <br>  Si observa lo que sucede con el tema del controlador del motor que se ejecuta en frambuesa, ver√° que el tel√©fono publica y el controlador recibe mensajes en el formato apropiado: <br><img src="https://habrastorage.org/webt/5n/5q/cg/5n5qcgrnjkmnsoiaysvtlvj3bai.jpeg"><br><br>  Todos los dem√°s temas funcionan con el mismo principio. <br><br>  * Si, sin embargo, algo sali√≥ mal, es necesario, estando en el modo de control del robot, haga clic en tres tiras paralelas en la esquina superior izquierda de la pantalla de la aplicaci√≥n.  Falla en las "Preferencias" y luego selecciona "Temas": <br><br><div class="spoiler">  <b class="spoiler_title">foto</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/xs/g3/rb/xsg3rbk8-brl1beefsvz5bmfoju.jpeg"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">foto</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/vu/zn/wl/vuznwlax_iokh-2vvxgg-hinneg.jpeg"><br></div></div><br>  Luego, haciendo clic en el tema apropiado, registre la ruta (Valor): <br><div class="spoiler">  <b class="spoiler_title">foto</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/v2/bx/i8/v2bxi8zehxlcdiwd94z3yf4_zgg.jpeg"><br></div></div><br><br><h3>  Veamos qu√© es lidar en la aplicaci√≥n. </h3><br>  En el robot, ejecute el nodo lidar: <br> <code>roslaunch rplidar_ros rplidar.launch</code> <br>  Si vuelve a ingresar a la aplicaci√≥n, en la pantalla de control del robot veremos puntos caracter√≠sticos y una flecha azul: <br><div class="spoiler">  <b class="spoiler_title">foto</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/da/1q/gv/da1qgv-soj6pzwmwtbqqvzd4_ii.jpeg"><br></div></div><br><br>  * Tambi√©n puede conducir inclinando el tel√©fono en diferentes direcciones y seleccionando el modo de control de inclinaci√≥n: <br><div class="spoiler">  <b class="spoiler_title">foto</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/bl/yq/eh/blyqehz414a4d9lbii_lduqcdm4.jpeg"><br></div></div><br>  Hay otros modos de "conducir", incluso con la capacidad de indicar un punto en el mapa, directamente en el tel√©fono, pero dado que el mapa es muy arbitrario, el viaje tambi√©n ser√° condicional, es decir, en ninguna parte. <br><br><h3>  Con temas de movimiento, como c√°maras (no lo consideraremos), todo est√° m√°s o menos claro, trataremos con gps. </h3><br>  Hay poco sentido en la sala de los gps, pero es interesante ver c√≥mo funciona. <br>  Para las pruebas, cualquier silbato GPS es adecuado.  Mi opci√≥n es la siguiente: <br><div class="spoiler">  <b class="spoiler_title">foto</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/zv/nh/vt/zvnhvtxhlggsnpcl-k2ivylmj14.jpeg"><br></div></div><br>  Para que funcione, primero debe instalar el nodo gps en frambuesa. <br>  Pero primero, verifiquemos si el silbato de GPS funciona, de lo contrario, todas las dem√°s conversaciones ser√°n a favor de los pobres. <br>  Ponemos paquetes en frambuesa: <br> <code>sudo apt-get install gpsd <br> sudo apt-get install gpsd-clients</code> <br>  Verifique que el silbato GPS est√© definido entre los dispositivos usb: <br> <code>lsusb</code> <br> <img src="https://habrastorage.org/webt/c_/yz/9b/c_yz9bousjkzjz-lwlsedxyboj8.jpeg"><br><br>  Ahora, compruebe que gps est√° aceptando algo: <br> <code>gpscat -s 9600 /dev/ttyACM1</code> <br>  * En lugar de ttyACM1, puede haber otros valores (ttyACM0, ttyUSB0, ttyAMA0) dependiendo del puerto en el que est√© activado el silbato GPS. <br>  Los mensajes de GPS aparecer√°n en la terminal: <br><div class="spoiler">  <b class="spoiler_title">foto</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/zx/4m/ur/zx4murhdyoa_m-pxcnkshg5ri9u.jpeg"><br></div></div><br>  Se pueden obtener datos m√°s estructurados (agradables a la vista) de la siguiente manera: <br> <code>gpsmon /dev/ttyACM1</code> <br> <div class="spoiler">  <b class="spoiler_title">foto</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/hl/nv/e4/hlnve4ngkqckcwl5cbgpjcugq30.jpeg"><br></div></div><br>  * las coordenadas no son m√≠as, lo cual es extra√±o.  No est√° claro con qu√© est√° conectado esto. <br><br>  Instale el nodo gps en frambuesa: <br> <code>sudo apt-get install libgps-dev <br> cd catkin_ws/src <br> git clone https://github.com/ros-drivers/nmea_navsat_driver <br> git clone https://github.com/ros/roslint <br> cd /home/pi/rosbots_catkin_ws <br> catkin_make</code> <br> <br>  Ahora que hemos ensamblado el nodo GPS, ejec√∫telo (en el robot): <br> <code>rosrun nmea_navsat_driver nmea_serial_driver _port:=/dev/ttyACM1 _baud:=9600</code> <br> <br>  Si observa los temas (en otra terminal del robot), puede ver que el tel√©fono est√° suscrito a un tema y la publicaci√≥n de un nodo gps va a otro: <br><div class="spoiler">  <b class="spoiler_title">foto</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/up/5l/rc/up5lrcvdckrdta_jie9wchgrk40.jpeg"><br></div></div><br>  Cambie el tema de recepci√≥n en el tel√©fono al tema / corregir a trav√©s de la configuraci√≥n como se describe anteriormente. <br>  Despu√©s del cambio, la publicaci√≥n y recepci√≥n en un tema: <br><div class="spoiler">  <b class="spoiler_title">foto</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/6a/sj/xp/6asjxparvnohhh5zqrmlqtbwfqu.jpeg"><br></div></div><br>  Y en el tel√©fono puedes observar las coordenadas: <br><div class="spoiler">  <b class="spoiler_title">foto</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/9e/e7/xl/9ee7xlxsche7eqca4xfcw0ye904.jpeg"><br></div></div><br><br><h3>  Odometr√≠a (tema / odom). </h3><br>  Si ejecuta la nota del cuentakil√≥metros de publicaciones anteriores, entonces, cuando el robot se mueve, tambi√©n puede obtener las velocidades lineales y angulares del robot en el tel√©fono (las velocidades no se calculan usando gps). <br>  En el robot: <br> <code>cd /home/pi/rosbots_catkin_ws/src/rosbots_driver/scripts/rosbots_driver <br> python diff_tf.py <br></code> <br>  En el tel√©fono: <br><div class="spoiler">  <b class="spoiler_title">foto</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/x7/or/qc/x7orqct4jsqn7cnab_v8unl4nna.jpeg"><br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/474650/">https://habr.com/ru/post/474650/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../474632/index.html">"Chacal": aprieta la interfaz</a></li>
<li><a href="../474638/index.html">Sobre el gato de Schr√∂dinger</a></li>
<li><a href="../474642/index.html">La m√°quina universal para realizar pruebas de bricolaje, parte 2</a></li>
<li><a href="../474646/index.html">Acerca de las perspectivas del formato 360 Reality Audio, fotos del o√≠do y viejos y olvidados</a></li>
<li><a href="../474648/index.html">Reclutamiento de TI. Encontrar un balance de proceso / resultado</a></li>
<li><a href="../474652/index.html">Deja de no hacer tu trabajo</a></li>
<li><a href="../474654/index.html">SSH apret√≥n de manos en palabras simples.</a></li>
<li><a href="../474656/index.html">Reversim MIPS y Golang: los fundamentos del reverso. Resolviendo problemas para revertir con r0ot-mi. Parte 2</a></li>
<li><a href="../474658/index.html">Dolor de mu√±eca y ratones de computadora</a></li>
<li><a href="../474662/index.html">Beta Test: Devdiction for Developers: una plataforma para aprender ingl√©s</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>