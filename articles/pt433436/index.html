<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§æüèª üëéüèΩ üçÅ Introdu√ß√£o √† Pesquisa de Desempenho ‚úäüèª üéñÔ∏è üôÜüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ao desenvolver um produto, eles raramente prestam a devida aten√ß√£o ao seu desempenho com uma alta intensidade de solicita√ß√µes recebidas. Pouco ou nada...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Introdu√ß√£o √† Pesquisa de Desempenho</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yamoney/blog/433436/"><p>  Ao desenvolver um produto, eles raramente prestam a devida aten√ß√£o ao seu desempenho com uma alta intensidade de solicita√ß√µes recebidas.  Pouco ou nada fazendo isso - n√£o h√° tempo suficiente, especialistas, ou eles se justificam com a frase t√≠pica: "Tudo funciona rapidamente conosco no prod, ent√£o por que verificar outra coisa?"  Nesses casos, pode chegar um momento em que uma produ√ß√£o que funcione bem repentinamente devido ao aumento do fluxo de visitantes, por exemplo, sob o efeito Habrae.  Ent√£o fica claro que fazer pesquisas sobre produtividade √© realmente necess√°rio. </p><br><p>  Essa tarefa √© desconcertante para muitos, porque h√° uma necessidade, mas n√£o h√° um entendimento claro do que e como medir e como interpretar o resultado, √†s vezes n√£o h√° requisitos n√£o funcionais formados.  Em seguida, falarei sobre por onde come√ßar, se voc√™ decidir seguir esse caminho, e explicarei quais m√©tricas s√£o importantes na pesquisa de desempenho e como us√°-las. </p><a name="habracut"></a><br><h2 id="nemnogo-teorii">  Pouco de teoria </h2><br><p>  Imagine que temos uma aplica√ß√£o esf√©rica no v√°cuo - ela recebe solicita√ß√µes e fornece respostas para elas.  Por simplicidade, pode ser um microsservi√ßo com um m√©todo que n√£o vai a lugar nenhum e n√£o depende de outros componentes ou aplicativos.  Nesse caso, n√£o estamos muito interessados ‚Äã‚Äãno que est√° escrito, como funciona e em que ambiente √© lan√ßado. </p><br><p>  O que queremos saber sobre o desempenho em geral?  Provavelmente, √© bom conhecer o fluxo m√°ximo de solicita√ß√µes recebidas no qual o servi√ßo √© est√°vel, seu desempenho com esse fluxo e o tempo necess√°rio para concluir uma solicita√ß√£o.  √â muito bom se voc√™ puder determinar os motivos que limitam ainda mais o crescimento da produtividade. </p><br><p>  Obviamente, voc√™ precisa medir o tempo de resposta √† solicita√ß√£o, respectivamente, pelo fluxo de solicita√ß√µes ou intensidade de entrada, o n√∫mero de solicita√ß√µes por unidade de tempo, geralmente por segundo e desempenho - o n√∫mero de respostas para a mesma unidade de tempo.  Os tempos de resposta podem ser espalhados por uma ampla faixa; portanto, para come√ßar, faz sentido apresent√°-los como uma m√©dia por segundo. </p><br><p>  Al√©m disso, podem surgir problemas em v√°rios n√≠veis: come√ßando pelo fato de o servi√ßo responder com um erro (e √© bom se for quinhentos, e n√£o "200 OK {" status ":" error "}" e terminando com o fato de que para de responder ou as respostas come√ßam a se perder no n√≠vel da rede.  As solicita√ß√µes malsucedidas precisam ser capazes de capturar e √© conveniente apresent√°-las como uma porcentagem do total.  O gr√°fico de desempenho, tempo de resposta e taxa de erro versus intensidade √© mais ou menos assim: </p><br><p><img src="https://habrastorage.org/webt/cc/7g/m8/cc7gm8r8urzys-lkfoi-2--xo0e.png"><br>  <em>Com o aumento da intensidade da consulta, o tempo de resposta e a taxa de erros aumentam</em> </p><br><p>  Enquanto a produtividade cresce linearmente com intensidade, o servi√ßo est√° indo bem.  Ele processa com √™xito todo o fluxo de solicita√ß√µes recebidas, o tempo de resposta n√£o muda, n√£o h√° erros.  Continuando a aumentar a intensidade, obtemos uma desacelera√ß√£o no crescimento da produtividade at√© a satura√ß√£o, na qual a produtividade atinge seu m√°ximo e o tempo de resposta come√ßa a crescer.  Um aumento subsequente na intensidade levar√° a uma confus√£o - um aumento significativo no tempo de resposta e uma queda na produtividade, um crescimento ativo de erros come√ßar√°.  No est√°gio de crescimento e satura√ß√£o, existem dois pontos importantes - <strong>desempenho</strong> <strong>normal</strong> e <strong>m√°ximo.</strong> </p><br><p><img src="https://habrastorage.org/webt/sk/w7/-k/skw7-ksf684r4-4e6z92lxhxymi.png"><br>  <em>Posi√ß√£o de desempenho normal e m√°xima</em> </p><br><p>  A produtividade normal √© alcan√ßada no momento em que sua taxa de crescimento come√ßa a diminuir e m√°xima - no momento em que sua taxa de crescimento se torna zero.  Separar o desempenho entre o normal e o m√°ximo √© muito importante.  Em uma intensidade que corresponde ao desempenho normal, o aplicativo deve funcionar de forma est√°vel, e o valor do <strong>desempenho normal caracteriza o limite</strong> ap√≥s o qual o gargalo do servi√ßo come√ßa a aparecer, afetando negativamente sua opera√ß√£o.  Quando o desempenho m√°ximo √© atingido, o gargalo come√ßa a limitar completamente o crescimento adicional, o servi√ßo √© inst√°vel e, como regra, neste momento, um pequeno mas est√°vel hist√≥rico de erros come√ßa a aparecer. </p><br><p>  O problema pode ser causado por v√°rios motivos - as filas est√£o bloqueadas, n√£o h√° threads suficientes, o pool foi esgotado, a CPU ou a RAM foi completamente utilizada, velocidade de leitura / grava√ß√£o insuficiente do disco e similares.  √â importante entender que a corre√ß√£o de um gargalo resultar√° na limita√ß√£o do desempenho no pr√≥ximo e assim por diante.  √â imposs√≠vel se livrar completamente de um gargalo, ele s√≥ pode ser movido. </p><br><h2 id="eksperimenty">  Os experimentos </h2><br><p>  Antes de tudo, √© necess√°rio determinar a magnitude da intensidade em que o servi√ßo atinge desempenho normal e m√°ximo e o tempo m√©dio de resposta correspondente.  Para fazer isso, em um experimento, basta simplesmente aumentar o fluxo de solicita√ß√µes recebidas.  √â mais dif√≠cil determinar o valor da intensidade m√°xima e o tempo do experimento. </p><br><p>  Voc√™ pode come√ßar com o que est√° escrito em requisitos n√£o funcionais (se houver), com a carga m√°xima do usu√°rio na venda ou simplesmente obter valores no teto.  Se a intensidade do fluxo de entrada n√£o for suficiente, o servi√ßo n√£o ter√° tempo para atingir a satura√ß√£o e ser√° necess√°rio repetir o experimento.  Se a intensidade for muito alta, o servi√ßo atingir√° rapidamente a satura√ß√£o e a depura√ß√£o.  Nesse caso, √© conveniente ter um monitoramento para que, com um aumento significativo no n√∫mero de erros, voc√™ n√£o perca tempo em v√£o e interrompa o experimento. </p><br><p>  Em nossas experi√™ncias, aumentamos gradualmente a intensidade de 0 a 1000 solicita√ß√µes por segundo por 10 minutos.  Isso √© suficiente para que o servi√ßo atinja a satura√ß√£o e, se necess√°rio, ajustamos o tempo e a intensidade no pr√≥ximo experimento para obter um resultado mais preciso.  Nos gr√°ficos acima, tudo era suave e bonito, mas no mundo real pode ser dif√≠cil, √† primeira vista, determinar o valor do desempenho normal. </p><br><p><img src="https://habrastorage.org/webt/nh/dz/g-/nhdzg-_z_i_szrl13yabtvzpxvq.png"><br>  <em>A depend√™ncia real do desempenho do servi√ßo no tempo</em> </p><br><p>  Nesse caso, levamos de 80 a 90% do m√°ximo para o desempenho normal.  Se observarmos um crescimento ativo de erros ap√≥s atingir a satura√ß√£o, faz sentido investig√°-los, porque s√£o o resultado de um gargalo, estud√°-los ajudar√° a localiz√°-lo e repass√°-lo para corre√ß√£o. </p><br><p>  Assim, os primeiros resultados s√£o obtidos.  Agora sabemos o desempenho normal e m√°ximo do aplicativo, bem como os tempos de resposta correspondentes a eles.  Isso √© tudo?  Claro que n√£o!  Com desempenho normal, o servi√ßo deve funcionar de forma est√°vel, o que significa que voc√™ precisa verificar seu funcionamento sob carga normal por um tempo.  Qual?  Voc√™ pode novamente examinar requisitos n√£o funcionais, solicitar a analistas ou monitorar a dura√ß√£o dos per√≠odos de atividade m√°xima no produto.  Em nossos experimentos, aumentamos linearmente a carga de 0 para o normal e permanecemos nela por 10 a 15 minutos.  Isso √© suficiente se a carga m√°xima do usu√°rio for significativamente menor que o normal, mas se forem compar√°veis, o tempo da experi√™ncia dever√° ser aumentado. </p><br><p>  Para avaliar rapidamente o resultado de uma experi√™ncia, √© conveniente agregar os dados obtidos na forma das seguintes m√©tricas: </p><br><ul><li>  tempo m√©dio de resposta </li><li>  mediana </li><li>  Percentil 90% </li><li>  % de erros </li><li>  desempenho. </li></ul><br><p>  Qual √© o tempo m√©dio de resposta √© compreens√≠vel, no entanto, a m√©dia √© uma medida adequada apenas no caso de uma distribui√ß√£o normal da amostra, uma vez que √© sens√≠vel demais aos "valores extremos" - valores muito grandes ou muito pequenos que est√£o fortemente fora da tend√™ncia geral.  A mediana √© o meio de toda a amostra de tempos de resposta, metade dos valores √© menor que o restante e o restante √© maior.  Por que √© necess√°rio? </p><br><p>  Em primeiro lugar, com base em sua defini√ß√£o, √© menos sens√≠vel a valores discrepantes, ou seja, √© uma m√©trica mais adequada e, em segundo lugar, comparando-a com a m√©dia, √© poss√≠vel avaliar rapidamente as caracter√≠sticas da distribui√ß√£o de respostas.  Em uma situa√ß√£o ideal, eles s√£o iguais - a distribui√ß√£o dos tempos de resposta √© normal e o servi√ßo √© bom! </p><br><p><img src="https://habrastorage.org/webt/he/cj/6t/hecj6txyjefl8gyzbdsvmz8czq4.png"><br>  <em>Distribui√ß√£o normal dos tempos de resposta.</em>  <em>Com essa distribui√ß√£o, a m√©dia e a mediana s√£o equivalentes</em> </p><br><p>  Se a m√©dia for muito diferente da mediana, a distribui√ß√£o ser√° distorcida e "outliers" poder√£o estar presentes durante o experimento.  Se a m√©dia for maior - houve per√≠odos em que o servi√ßo respondeu muito lentamente, ou seja, diminuiu a velocidade. </p><br><p><img src="https://habrastorage.org/webt/r1/gc/yh/r1gcyhbsothzda-u13htzen-kae.png"><br>  <em>Distribui√ß√£o dos tempos de resposta com "outliers" de respostas longas.</em>  <em>Com essa distribui√ß√£o, a m√©dia √© maior que a mediana.</em> </p><br><p>  Tais casos requerem an√°lises adicionais.  Para estimar a escala de "emiss√µes", quantis ou percentis v√™m em socorro. </p><br><p>  Um quantil, no contexto da amostra obtida, √© o valor do tempo de resposta, ao qual a parte correspondente de todas as solicita√ß√µes se encaixa.  Se voc√™ usar% de consultas, esse √© o percentil (a prop√≥sito, a mediana √© de 50%).  √â conveniente usar um percentil 90% para estimar as emiss√µes.  Por exemplo, como resultado do experimento, foi obtida uma mediana de 100 ms e a m√©dia - 250 ms excede a mediana em 2,5 vezes!  Obviamente, isso n√£o √© totalmente bom, analisamos um quantil de 90% e existem 1000 ms - at√© 10% de todas as solicita√ß√µes bem-sucedidas foram conclu√≠das por mais de um segundo, uma bagun√ßa, voc√™ precisa descobrir.  Para procurar consultas longas, voc√™ pode morder o arquivo com os resultados da experi√™ncia ou imediatamente nos logs de servi√ßo, mas √© ainda melhor apresentar o tempo m√©dio de resposta na forma de um gr√°fico versus o tempo, mostrando imediatamente o tempo e a natureza dos "outliers" dispon√≠veis. </p><br><h2 id="itogi">  Sum√°rio </h2><br><p>  Ent√£o, voc√™ conduziu com sucesso os experimentos e obteve os resultados.  Se √© bom ou ruim, depende dos requisitos para o servi√ßo, mas n√£o os n√∫meros obtidos s√£o mais importantes, mas por que esses n√∫meros s√£o e para entender por que crescimento adicional √© limitado.  Se voc√™ conseguir encontrar um gargalo - muito bom, se n√£o, mais cedo ou mais tarde a necessidade de produtividade poder√° aumentar e voc√™ ainda precisar√° procur√°-lo; portanto, √†s vezes √© mais f√°cil evitar a situa√ß√£o. </p><br><p>  Nesta nota, dei uma abordagem b√°sica para pesquisar desempenho, respondendo √†s perguntas que eu tinha no in√≠cio.  N√£o tenha medo de pesquisar o desempenho, √© necess√°rio! </p><br><p>  <strong>PS</strong> <br>  Visite nossa aconchegante <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sala de bate-papo por telegrama,</a> onde voc√™ pode fazer perguntas, ajudar com conselhos e apenas conversar sobre pesquisa de desempenho. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt433436/">https://habr.com/ru/post/pt433436/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt433424/index.html">√â poss√≠vel carregar um n√≠vel intransit√°vel no Super Mario Maker?</a></li>
<li><a href="../pt433428/index.html">De onde vem a criatividade: an√°lise da atividade das ondas alfa do c√©rebro durante testes RAT</a></li>
<li><a href="../pt433430/index.html">Caixa Mecool KM9 para Android no novo SoC Amlogic S905X2 com 4 GB de RAM e Android TV 8.1 - entenda e perdoe</a></li>
<li><a href="../pt433432/index.html">Dez coisas que voc√™ pode fazer com o GraalVM</a></li>
<li><a href="../pt433434/index.html">‚ÄúPascal e menos ainda o Basic definitivamente n√£o s√£o necess√°rios‚Äù: uma entrevista com treinadores em programa√ß√£o esportiva</a></li>
<li><a href="../pt433438/index.html">A Duma do Estado limitar√° o financiamento coletivo</a></li>
<li><a href="../pt433442/index.html">Lan√ßamento do Entity Framework Core 2.2. Novidades (3 de 3)</a></li>
<li><a href="../pt433446/index.html">Semana da Seguran√ßa 51: bug no WordPress 5.0 e no software Logitech, vulnerabilidade de foto do Facebook</a></li>
<li><a href="../pt433448/index.html">An√°lise comparativa de mercados usados Carros alem√£es e franceses no segmento B e C</a></li>
<li><a href="../pt433450/index.html">Cres√ßa e ensine. Como fizemos amizade com o PEGA</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>