<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤹🏾 🕧 🌔 Quasar, Sobaken und Ungeziefer: Enthüllung von Details der laufenden Cyberspionagekampagne 🙌 🙌🏿 👾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mit Hilfe von Fernzugriffstools, Quasar, Sobaken und Vermin, überwachen Cyberkriminelle ukrainische Regierungsbehörden und stehlen Daten aus ihren Sys...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Quasar, Sobaken und Ungeziefer: Enthüllung von Details der laufenden Cyberspionagekampagne</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/418165/">  Mit Hilfe von Fernzugriffstools, Quasar, Sobaken und Vermin, überwachen Cyberkriminelle ukrainische Regierungsbehörden und stehlen Daten aus ihren Systemen.  Diese Cybergruppe wurde erstmals in einem Bericht im Januar 2018 erwähnt, erregte Mitte 2017 die Aufmerksamkeit von ESET und entwickelt ihre Software heute weiter. <br><br>  In diesem Bericht enthüllen wir die Details der aktuellen Kampagne, stellen Informationen zu Malware bereit und beschreiben die Methoden, mit denen Angreifer die Erkennung verbreiten, zielen und umgehen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/um/d7/91/umd791-uddub2r4pyn_fl32ttkm.jpeg"></div><a name="habracut"></a><br><h2>  Angreiferprofil </h2><br>  Diese Gruppe scheint kein herausragendes technisches Wissen oder keinen Zugang zu Zero-Day-Schwachstellen zu haben.  Sie hat jedoch Social Engineering erfolgreich angewendet, um die Malvari und verdeckte Arbeit für eine lange Zeit zu verbreiten. <br><br>  Wir haben es geschafft, seine Arbeit bis Oktober 2015 zu verfolgen, aber es ist möglich, dass die Gruppe ihre Aktivitäten viel früher begonnen hat. <br><br>  Angreifer verwenden drei Modifikationen der .NET-Malvari: Quasar RAT (Remote Administration Tool), Sobaken (eine Ableitung von RAT von Quasar) und benutzerdefiniertes RAT-Ungeziefer.  Die Tools wurden gleichzeitig auf denselben Zielen verwendet, teilen sich teilweise die Infrastruktur und stellen eine Verbindung zu denselben C &amp; C-Servern her.  Eine mögliche Erklärung für die Verwendung von drei parallelen Modifikationen ist die Tatsache, dass sie unabhängig voneinander entwickelt wurden. <br><br><h2>  Die Opfer </h2><br>  Schädliche Software wird bei Angriffen auf ukrainische Regierungsbehörden eingesetzt.  Laut ESET-Telemetrie wurden Hunderte von Opfern in verschiedenen Organisationen und mehrere hundert ausführbare Dateien im Zusammenhang mit dieser Kampagne aufgezeichnet. <br><br><h2>  Zeitleiste </h2><br>  Abbildung 1 zeigt die wichtigsten Kampagnenereignisse in chronologischer Reihenfolge. <br><br><img src="https://habrastorage.org/webt/8w/9p/4_/8w9p4_dn72fqyzbhonm9xqqvrbq.jpeg"><br>  <i>Abbildung 1. Zeitleiste der Kampagne</i> <br><br><h2>  Verteilung </h2><br>  Laut unseren Telemetriedaten verwenden Angreifer E-Mail als primären Vertriebskanal für drei RATs.  Sie nutzen Social Engineering, um die Opfer davon zu überzeugen, die Malware herunterzuladen und auszuführen. <br><br>  In den meisten Fällen sind die Dateinamen in ukrainischer Sprache verfasst und beziehen sich auf die Arbeit der Opfer.  Hier sind Beispiele für solche Dateien: <br><br><ul><li>  "ANWEISUNGEN zur Organisation des Schutzes des Militärdienstes der Ukraine und dieses Familienmitglieds" ("Verordnung zur Gewährleistung der Sicherheit des Militärpersonals der ukrainischen Armee und ihrer Familienangehörigen") </li><li>  "Ich werde den neuen Entwurf, die Bezeichnung der Revision des Viluchennya, bestrafen" ("Der neue Entwurf des Beschlusses zur Überprüfung des Rückzugs") </li><li>  "Donning OVK Zbіlshennya limitu" ("Beschaffungsabteilung Don HVAC. Erhöhung des Kreditlimits") </li></ul><br>  Zusätzlich zu den grundlegenden Techniken des Social Engineering (die Aufmerksamkeit auf Investitionen lenken) verwenden Angreifer drei technische Methoden.  Dies wird wahrscheinlich die Kampagnenleistung weiter verbessern. <br><br>  <b>Methode 1</b> : E-Mail-Anwendungen verwenden das Unicode <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">-Überschreibungszeichen von rechts nach links</a> , das die Richtung ändert, in der Zeichen gelesen werden, um die wahre Erweiterung auszublenden.  Tatsächlich handelt es sich hierbei um ausführbare Dateien, die Word-, Excel-, PowerPoint- oder Acrobat Reader-Symbole verwenden, um keinen Verdacht zu erregen. <br><br>  Ein Beispiel für einen Dateinamen: Wie in Abbildung 2 dargestellt, sieht „Verschieben von festem Brennholz (Brennholz) zum ungeschützten Brennen _ &lt;&gt; xcod scr“ („Transport von Brennholz zum Heizen“) wie eine .DOCX-Datei für unaufmerksame Benutzer aus. <br><br><img src="https://habrastorage.org/webt/ec/y9/nm/ecy9nmj2acupweqnnlwm4pzlha4.png"><br>  <i>Abbildung 2. Eine ausführbare Datei, die als Word-Dokument getarnt ist</i> <br><br>  <b>Methode 2</b> : E-Mail-Anwendungen, die sich als selbstextrahierende RAR-Archive tarnen. <br><br>  Beispiel: Eine E-Mail mit der Anwendung „Punishment_MOU_Dodatka_do_Instrucii_440_ost.rar“ („Befehl des Verteidigungsministeriums, Anhänge zu Anweisung Nr. 440“), wie in Abbildung 3 dargestellt. <br><br>  Vermutlich führen Opfer diese Datei aus und warten auf das weitere Entpacken des Inhalts des selbstextrahierenden Archivs, starten jedoch unabsichtlich eine schädliche ausführbare Datei. <br><br>  <b>Methode 3</b> : Word-Dokument + CVE-2017-0199 ausnutzen.  Diese Sicherheitsanfälligkeit wird angewendet, wenn ein Opfer ein speziell gestaltetes Word-Dokument öffnet.  Der Word-Prozess sendet eine HTTP-Anforderung an eine HTA-Datei, die ein schädliches Skript auf einem Remoteserver enthält.  Dann wird das schädliche Skript von <code>mshta.exe</code> gestartet.  Die ersten öffentlichen Informationen zu dieser Sicherheitsanfälligkeit wurden <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">im April 2017</a> veröffentlicht. Microsoft hat sie geschlossen, indem ein Sicherheitsupdate für alle Versionen von Windows und Office veröffentlicht wurde. <br><br>  Laut ESET-Telemetrie haben diese Angreifer diese Methode im Mai 2017 angewendet.  Die Angreifer verwendeten hxxp: // chip-tuning lg [] ua /, um die HTA-Dateien und die endgültige Nutzlast zu liefern. <br><br><img src="https://habrastorage.org/webt/fl/3d/ie/fl3diek7ndvyatqlnf0skmg3zs8.png"><br>  <i>Abbildung 3. Als selbstextrahierendes RAR-Archiv getarnte Datei.</i>  <i>Versionsdaten und Copyright deuten darauf hin, dass dies eine Fälschung ist</i> <br><br><h2>  Installation und Persistenz </h2><br>  Das Installationsverfahren ist für die drei Änderungen der von dieser Gruppe verwendeten Malvari identisch.  Der Dropper speichert die Nutzdaten (Vermin, Quasar oder Sobaken) im Ordner <code>%APPDATA%</code> in einem Unterordner mit dem Namen des legitimen Unternehmens (normalerweise Adobe, Intel oder Microsoft).  Anschließend erstellt er, wie in Abbildung 4 dargestellt, im Scheduler eine Aufgabe, mit der die Komponente alle 10 Minuten ausgeführt wird, um die Persistenz sicherzustellen.  Einige Versionen verwenden auch die Methode, die Verknüpfungsfunktion der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Windows-Systemsteuerung</a> zu verwenden, um den Zugriff auf ihre Ordner über den Windows Explorer zu verhindern.  Diese Ordner werden beim Klicken im Windows Explorer nicht geöffnet. Stattdessen wird die Seite "Alle Aufgaben" geöffnet. <br><br><img src="https://habrastorage.org/webt/r_/f8/ag/r_f8agiayao-ya99saiesftwzvq.png"><br>  <i>Abbildung 4. Eine Aufgabe, die alle 10 Minuten eine schädliche Komponente startet</i> <br><br>  Beispiele: <br><br> <code>C:\Users\Admin\AppData\Roaming\Microsoft\Proof\Settings.{ED7BA470-8E54-465E-825C- 99712043E01C}\TransactionBroker32.exe <br> C:\Users\Admin\AppData\Roaming\Adobe\SLStore\Setting.{ED7BA470-8E54-465E-825C- 99712043E01C}\AdobeSLService.exe</code> <br> <br><h2>  Targeting </h2><br>  Angreifer verwenden viele Tricks, damit die Malware nur auf Zielcomputern funktioniert.  Sie achten besonders darauf, automatisierte Analysesysteme und Sandkästen zu vermeiden. <br><br>  <b>Methode 1</b> : Überprüfen des Tastaturlayouts in Windows <br>  Malvar prüft, ob das russische oder ukrainische Tastaturlayout installiert ist.  Wenn nicht, hört ihre Arbeit sofort auf. <br><br>  <b>Methode 2</b> : Überprüfen Sie die IP-Adresse <br>  Malvar erhält die IP-Adresse eines infizierten Computers durch eine Anfrage an einen legitimen Dienst <br>  Ipinfo.io/json.  Die Arbeiten werden abgeschlossen, wenn die IP-Adresse in der Ukraine oder in Russland nicht gefunden wird oder wenn sie bei einem von mehreren ausgewählten Cloud-Dienstanbietern oder Entwicklern von Antivirensoftware registriert ist.  Der Code, der die Überprüfung durchführt, ist in den Demontageergebnissen in den Abbildungen 5 und 6 dargestellt. <br><br><img src="https://habrastorage.org/webt/ca/um/ji/caumjikfr3j6dxoyr2vt3ujlin4.jpeg"><br>  <i>Abbildung 5. Code zur Überprüfung der Geolokalisierung der IP-Adresse des infizierten Computers</i> <br><br><img src="https://habrastorage.org/webt/x4/qv/6l/x4qv6loy2wy9nsy39mbdxauswsi.jpeg"><br>  <i>Abbildung 6. Code, der die IP-Adresse mit einer Liste von Cloud-Dienstanbietern und Antiviren-Anbietern übereinstimmt</i> <br><br>  <b>Methode 3</b> : Testen der Netzwerkemulation <br>  Automatisierte Analysesysteme verwenden häufig Tools wie Fakenet-NG, mit denen die DNS / HTTP-Kommunikation erfolgreich ist und zu Ergebnissen führt.  Malvari-Autoren versuchen, solche Systeme durch die Generierung eines zufälligen Site-Namens / einer zufälligen Site-URL zu identifizieren und zu überprüfen, ob keine Verbindung zu dieser URL besteht (in Abbildung 7), wie dies bei einem realen System der Fall wäre. <br><br><img src="https://habrastorage.org/webt/2i/gd/ht/2igdhtw18kvmfdggtpjlmrzhjio.png"><br>  <i>Abbildung 7. Code, der eine zufällige URL generiert und den Download startet</i> <br><br>  <b>Methode 4</b> : Überprüfen eines bestimmten Benutzernamens <br>  Malware wird nicht unter einem Konto mit einem Benutzernamen gestartet, der für automatisierte Malware-Analysesysteme typisch ist (siehe Abbildung 8). <br><br><img src="https://habrastorage.org/webt/ta/7f/xu/ta7fxutvbu2rh5oouavpnlyrwio.jpeg"><br>  <i>Abbildung 8. Abgleich des aktuellen Benutzernamens mit einer Liste bekannter Malware-Analysesysteme</i> <br><br><h2>  Steganographie-Anwendung </h2><br>  Seit Mitte 2017 verwenden Angreifer Steganografie und verstecken schädliche Komponenten in Bildern auf den kostenlosen Hosting-Sites savedhot.net und ibb.co. <br><br>  Steganographie ist eine Wissenschaft, mit der Sie Daten „in voller Sicht“ in anderen, nicht klassifizierten Informationen verstecken können.  In unserem Fall wurde die schädliche EXE-Datei wie in Abbildung 9 verschlüsselt und in einer JPEG-Datei versteckt. Malvar lädt JPEG herunter und decodiert es, extrahiert versteckte Daten, entschlüsselt die EXE-Datei aus diesen Daten und startet sie. <br><br><img src="https://habrastorage.org/webt/__/pv/dq/__pvdqrrbokglop1ehh9alsv2ng.png"><br>  <i>Abbildung 9. Beispiel eines JPEG-Bilds zum Ausblenden der gelieferten schädlichen Komponente (Größe geändert und entfernt)</i> <br><br>  Der Entschlüsselungsprozess ist ziemlich kompliziert und kann wie folgt beschrieben werden: <br><br>  1. Herunterladen einer JPEG-Datei von einer URL, die in einer Binärdatei fest codiert ist. <br><br>  2. Die rohe Gewalt eines achtstelligen Passworts durch Berechnen seines Hashs und Abgleichen mit einem in der heruntergeladenen Binärdatei fest codierten Hash.  In diesem Schritt wird die CPU intensiv beansprucht. Die Ausführung auf einem normalen Computer dauert mehr als 10 Minuten.  Dies ist höchstwahrscheinlich eine weitere Maßnahme, um automatisierten Malware-Analysesystemen entgegenzuwirken. <br><br>  3. Verarbeiten der JPEG-Datei und Extrahieren der darin verborgenen Daten, wie aus dem zerlegten Code in den Abbildungen 10 und 11 hervorgeht. Der von der Malware verwendete Algorithmus ist dem in JSteg, einem der ältesten und einfachsten Steganografiealgorithmen für JPEG-Dateien, verwendeten sehr ähnlich.  Es verbirgt die Daten in LSB (dem niedrigstwertigen Bit) der diskreten Cosinustransformationskoeffizienten einer JPEG-Datei.  Solche versteckten Daten wirken sich normalerweise nicht auf das mit bloßem Auge sichtbare Bild aus, aber spezielle Algorithmen können dessen Vorhandensein leicht erkennen.  Dieser Steganographiealgorithmus ist jedoch sehr einfach zu implementieren, was wahrscheinlich der Grund für seine Wahl durch die Autoren der Malvari war. <br><br>  4. Daten extrahieren und entpacken mit GZip. <br><br>  5. Entschlüsselung der dekomprimierten Daten auf AES mit dem in Schritt Nr. 2 erhaltenen Passwort. <br><br>  6. Decodieren von Base64-entschlüsselten Daten. <br><br>  7. Schreiben der EXE-Datei auf die Festplatte und Ausführung. <br><br>  Infolgedessen gaben die Autoren dieser Bedrohung die Idee der Verwendung der Steganographie auf und begannen, hxxp: // chip-tuning lg [] ua zu verwenden, um unverschlüsselte ausführbare Dateien zu übertragen. <br><br><img src="https://habrastorage.org/webt/5s/ch/zx/5schzxd_4v0gsywse4wwbanoxj4.png"><br>  <i>Abbildung 10. Steganografie-Code in einem JPEG-Decoder</i> <br><br><img src="https://habrastorage.org/webt/1v/ll/w2/1vllw2olpntevix4tebamq3iuye.jpeg"><br>  <i>Abbildung 11. Steganografie-Code in einem JPEG-Decoder</i> <br><br><h2>  Malvari Mods </h2><br>  Diese Angreifer verwenden bei ihren Angriffen drei Modifikationen der Malvari.  Im Folgenden geben wir jeweils einen kurzen Überblick und konzentrieren uns auf die Beschreibung der charakteristischen Merkmale. <br><br><h3>  Quasar </h3><br>  Quasar ist eine Open Source RAT, die auf GitHub verfügbar ist.  Wir haben mehrere Kampagnen gesehen, in denen diese Cybergruppe Quasar RAT-Binärdateien verwendete.  Die erste bekannte Kampagne dauerte von Oktober 2015 bis April 2016.  Der nächste fand im Februar 2017 statt.  Kompilierungsartefakte zeigen den Pfad zu PDB <code>n:\projects\Viral\baybak_files_only\QRClient\QuasarRAT-master\Library\obj\ Release\Library.pdb</code> <br><br>  Eine weitere Kampagne mit Quasar RAT unter Verwendung der Befehlsserver dieser Angreifer (mailukr.net) wurde von Juli bis September 2017 durchgeführt.  Die Angreifer verwendeten eine alte Version von Quasar RAT namens "xRAT 2.0 RELEASE3".  Compiler-Artefakte in Dropper zeigen den Pfad zu PDB <code>N:\shtorm\WinRARArchive\ obj\Release\WinRAR.pdb</code> <br><br><h3>  Schluchzend </h3><br>  Sobaken ist eine deutlich modifizierte Version von Quasar RAT.  Wenn Sie die Struktur der Programme Quasar und Sobaken vergleichen, können Sie viel gemeinsam beobachten - siehe Abbildung 12. <br><br>  Die Autoren von Sobaken reduzierten die Funktionalität der Malware, sodass die ausführbare Datei kleiner und leichter zu verbergen war.  Sie fügten auch Tricks hinzu, um die Sandbox und andere oben beschriebene zu umgehen. <br><br><img src="https://habrastorage.org/webt/y9/ld/aa/y9ldaavl3hyytmazu3mxftcgnku.png"><br>  <i>Abbildung 12. Schluchzende Evolution.</i>  <i>Links Quasar RAT v1.3, in der Mitte und rechts - zwei Versionen von Sobaken</i> <br><br><h3>  Ungeziefer </h3><br>  Ungeziefer ist eine benutzerdefinierte Hintertür, die nur diese Cybergruppe verwendet.  Zum ersten Mal wurde die Malware im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bericht von Palo Alto Networks vom</a> Januar 2018 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dokumentiert</a> .  Die Hintertür erschien Mitte 2016 und wird noch verwendet.  Wie Quasar mit Sobaken ist es in .NET geschrieben.  Um die Analyse zu erschweren, wird der Code mit dem kommerziellen .NET Reactor-Codeschutzsystem oder dem Open Source-Protector ConfuserEx geschützt. <br><br>  Darüber hinaus verwendet es wie Sobaken die kostenlose Software Vitevic Assembly Embedder zum Einbetten der erforderlichen DLLs in die ausführbare Hauptdatei, die auf dem Visual Studio Marketplace verfügbar ist. <br><br><h4>  Funktionell </h4><br>  Ungeziefer ist eine voll ausgestattete Hintertür mit mehreren optionalen Komponenten.  Die neueste zum Zeitpunkt des Schreibens bekannte Version (Vermin 2.0) unterstützt die folgenden Befehle, deren Kern anhand der Namen verstanden werden kann: <br>  - StartCaptureScreen <br>  - StopCaptureScreen <br>  - ReadDirectory <br>  - UploadFile <br>  - DownloadDatei <br>  - CancelUploadFile <br>  - CancelDownloadFile <br>  - GetMonitors <br>  - DeleteFiles <br>  - ShellExec <br>  - Prozesse abrufen <br>  - KillProcess <br>  - CheckIfProcessIsRunning <br>  - CheckIfTaskIsRunning <br>  - RunKeyLogger <br>  - CreateFolder <br>  - UmbenennenFolder <br>  - DeleteFolder <br>  - UpdateBot <br>  - RenameFile <br>  - ArchiveAndSplit <br>  - StartAudioCapture <br>  - StopAudioCapture <br>  - SetMicVolume <br><br>  Die meisten Befehle sind in der Hauptnutzlast implementiert.  Nur wenige Befehle und zusätzliche Funktionen - durch optionale Komponenten, die von Angreifern auf dem Computer des Opfers geladen werden.  Unter den optionalen Komponenten: <br>  - Audioaufnahme <br>  - Keylogger <br>  - Passwortdiebstahl <br>  - Diebstahl einer Datei von USB (USB File Stealer) <br><br><h4>  Audioaufzeichnungstool (AudioManager) </h4><br>  Eine vollwertige Ungezieferkomponente, die Ton vom Mikrofon des Computers des Opfers aufzeichnen kann.  Es werden drei Ungezieferbefehle akzeptiert: StartAudioCapture, StopAudioCapture und SetMicVolume.  Die empfangenen Daten werden mithilfe von Speex-Codecs komprimiert und im SOAP-Format auf Vermin C &amp; C-Server hochgeladen. <br><br><h4>  Keylogger (KeyboardHookLib) </h4><br>  Keylogger in Vermin ist eine einfache separate ausführbare Datei, die alle Tastenanschläge abfängt und in verschlüsselter Form in die Datei schreibt.  Außerdem werden der Inhalt des Puffers und die Namen der aktiven Fenster geschrieben.  Der Keylogger selbst kann nicht mit Vermin C &amp; C-Servern kommunizieren.  Die Haupt-Hintertür wird verwendet, um die gesammelten Informationen zu übertragen. <br><br>  Der Pfad zum PDB im Keylogger bestätigt die Verbindung mit der Ungeziefer-Malware: <br> <code>Z:\Projects\Vermin\KeyboardHookLib\obj\Release\AdobePrintLib.pdb</code> <br> <br><h4>  Tool zum Diebstahl von Passwörtern (PwdFetcher) </h4><br>  Eine separate Komponente zum Diebstahl von Ungezieferkennwörtern wird verwendet, um gespeicherte Kennwörter aus Browsern (Chrome, Opera) zu extrahieren.  Der Hauptteil des Codes scheint aus einem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel von Habr</a> kopiert zu sein.  Einige Beispiele enthalten auch Code zum Extrahieren von Informationen aus dem Firefox-Browser, der jedoch anscheinend nicht verwendet wird.  Wie in Abbildung 13 dargestellt, enthält diese Komponente auch PDB-Pfade ähnlich der Keylogger-Komponente, die die Verbindung mit Ungeziefer bestätigt. <br><br><img src="https://habrastorage.org/webt/yg/fu/go/ygfugop0kr3ev9ddu34gwnq0nm4.png"><br>  <i>Abbildung 13. Kompilierungsartefakte, mit denen Sie eine Kennwortdiebstahlkomponente mit Ungeziefer verknüpfen können</i> <br><br><h4>  USB-Datei-Diebstahl-Tool (UsbGuard) </h4><br>  <code>UsbGuard.exe</code> ist eine optionale Komponente, die sowohl von Sobaken als auch von Ungeziefer verwendet wird.  Dies ist ein kleines separates Programm, das an den Computer angeschlossene USB-Laufwerke überwacht und alle Dateien kopiert, die dem von den Angreifern konfigurierten Filter entsprechen.  Die gestohlenen Dateien werden dann mit dem Haupt-Backdoor-Modul übertragen.  In der Probe dieser Komponente wurden viele verschiedene Wege zu PDB gefunden, die sie eindeutig an Ungeziefer binden. <br><br>  Seit April 2018 wird die Datei-Diebstahl-Komponente als separates Tool verwendet.  Es kopiert Dateien und lädt sie sofort auf einen vom Angreifer kontrollierten Server hoch. <br><br>  In den analysierten Beispielen suchten Angreifer nach Dateien mit den folgenden Erweiterungen: <br>  - doc <br>  - docx <br>  - xls <br>  - xlsx <br>  - Reißverschluss <br>  - selten <br>  - 7z <br>  - docm <br>  - txt <br>  - RTF <br>  - xlsm <br>  - pdf <br>  - jpg <br>  - JPEG <br>  - tif <br>  - odt <br>  - ods <br><br><h2>  Fazit </h2><br>  Unter den zahlreichen Angriffen mit Malware auf hochrangige Ziele in der Ukraine fand diese Kampagne wenig Beachtung.  Möglicherweise liegt dies an der Verwendung von Code aus Open Source.  Die Gruppe hat jedoch bereits eigene Tools entwickelt. <br><br>  Die Verwendung mehrerer Familien von Malware- und Infektionsmechanismen, einschließlich Social Engineering und Steganografie, in den letzten drei Jahren kann auf die Tatsache zurückzuführen sein, dass Angreifer mit Methoden experimentieren oder in mehreren Gruppen arbeiten. <br><br>  Die erfolgreiche Anwendung trivialer Techniken (z. B. Senden von RAR und EXE per E-Mail) unterstreicht die Bedeutung des Schutzes vor dem menschlichen Faktor. <br><br><h2>  Kompromissindikatoren (IoC) </h2><br><h3>  C &amp; C-Server </h3><br><h4>  Schluchzendes C &amp; C. </h4><br> <code>akamaicdn.ru <br> akamainet021.info <br> cdnakamai.ru <br> windowsupdate.kiev.ua <br> akamainet022.info <br> akamainet066.info <br> akamainet067.info <br> notifymail.ru <br> mailukr.net <br> 188.227.16.73 <br> 212.116.121.46 <br> 206.54.179.160</code> <br> <br><h4>  Quasar C &amp; C. </h4><br> <code>188.227.75.189 <br> mailukr.net <br> cdnakamai.ru <br> notifymail.ru</code> <br> <br><h4>  Ungeziefer C &amp; C. </h4><br> <code>185.158.153.222 <br> 188.227.17.68 <br> 195.78.105.23 <br> tech-adobe.dyndns.biz <br> notifymail.ru <br> akamainet023.info <br> mailukr.net <br> 185.125.46.24 <br> akamainet024.info <br> 206.54.179.196</code> <br> <br><h3>  Komponententransfer, Datenexfiltration </h3><br> <code>chip-tuning.lg.ua <br> www.chip-tuning.lg.ua <br> olx.website <br> news24ua.info <br> rst.website <br> 1ua.eu <br> novaposhta.website</code> <br> <br><h3>  SHA1 </h3><br><h4>  Ungeziefer </h4><br> <code>028EBDBEBAC7239B41A1F4CE8D2CC61B1E09983B <br> 07E1AF6D3F7B42D2E26DF12A217DEBACEDB8B1B9 <br> 09457ACB28C754AA419AB6A7E8B1940201EF3FFE <br> 0EEE92EC2723ED9623F84082DAD962778F4CF776 <br> 10128AB8770FBDECD81B8894208A760A3C266D78 <br> 131F99A2E18A358B60F09FD61EE312E74B02C07C <br> 14F69C7BFAF1DF16E755CCF754017089238B0E7B <br> 1509F85DE302BE83A47D5AFAD9BEE2542BA317FC <br> 170CEE6523B6620124F52201D943D7D9CA7B95E5 <br> 191159F855A0E580290871C945245E3597A5F25C <br> 1F12C32A41D82E978DE333CD4E93FDAA1396BE94 <br> 22B17966B597568DB46B94B253CD37CBCF561321 <br> 2C7332D8247376842BD1B1BD5298844307649C99 <br> 2E08BA5DF30C0718C1733A7836B5F4D98D84905E <br> 2EDF808F8252A4CBCB92F47A0AEDC1AAAE79A777 <br> 360F54B33AC960EE29CA0557A28F6BB8417EF409 <br> 431FCE6A47D0A48A57F699AA084C9FF175A9D15F <br> 45438834FDC5C690DA3BC1F60722BE86B871280D <br> 4A8A8188E3A7A137651B24780DF37CB6F610CC19 <br> 4C1E4E136B7922F9E28D1B38E9760E28929E4F0B <br> 5B6EA57FFC09593C3B65D903368EA5F7FAA2EB68 <br> 61D366939FE36861B2FECB38A4DFF6D86C925A00 <br> 6A72366D8AE09F72F0466FB59E8ED372F8B460D7 <br> 6FECA622B0FB282064F7DE42BA472A8EC908D0D6 <br> 70A772485C5ED330C6876FA901BA722CD44CA05E <br> 70D97367A3DBD5D45482B6AF8C78C58B64D3F3B3 <br> 7803FD9753930522705F2B6B4E73622887892C28 <br> 7B11A84B18DC4B5F1F2826E7925F0B2DC1B936AE <br> 889FD0BEB3197DDD6C88F5C40D6B8E4D74A892CE <br> 9B6FBABFA2A77FA633F7A2EB352979D5C68CEBC6 <br> A451291F17489E3A59F440A1B693D691B053C531 <br> A53D77E55A06CF131D670339BACEC5AC0F0C6D66 <br> A925D0AFB5D4F5FAC65543C993BE4172F1DBF329 <br> B5F81C804E47B76C74C38DF03A5CBE8A4FE69A9A <br> B99DE55043099E9506B304660B8E1374787AB195 <br> C00C104FC3E9F5977D11C67EF0C8C671D4DFC412 <br> CA0296FA9F48E83EA3F26988401B3F4C4E655F7A <br> D4C6540E789BD3839D65E7EDA5CCA8832493649E <br> D5EDE1BBB9A12757E24BE283AFC8D746ADC4A0D4 <br> DEFBFD98C74BEFF839EEB189F0F6C385AD6BA19B <br> ECF152EB6417A069573F2C7D9A35B9CC31EC8F56 <br> EE2D40825C77C8DFEF67999F0C521919E6672A10 <br> EF09AC6BA08A116F2C4080CBEE8CEF9523E21265 <br> F414C49CF502D1B6CC46E08F3AC97D7846B30732</code> <br> <br><h4>  Schluchzend </h4><br> <code>087F77998004207BCCFFBF3030B6789648930FA5 <br> 0A4A2BCB3EF4E19973D5C4BE4E141B665CC0BFE0 <br> 1CEEF0813C0F096E6DA5461DC4B3BF901C500C56 <br> 293DBFF0230DAB3C4C21428F90C8EF06E9F35608 <br> 37E2947BFB5FC0839087C5BCE194EC193F824C85 <br> 39525CBCA591F2A10946BA62A56E4C3382CD4FC0 <br> 3CE0A18E9A8A2B95827008DBFF16364B6FEDF361 <br> 3E869038080DAE006FF6B20DF9B0CD9CB3A5E1A1 <br> 400830AB6DD46789B00D081ADF0F82623472FB13 <br> 43F382A330A454FF83F4F35FB571ECF587A4694A <br> 4449FBE2B28A81B760B284880ADBED43462C2030 <br> 4712AF28168FD728A13EFD520E0665FFD076B6FB <br> 4F504D7B35660943B206D6034752C686365EA58D <br> 53239A62E09BB0B4E49B7954D533258FEF3342C4 <br> 540292753FA0CC4ACB49E5F11FEDEA4B7DEF11D8 <br> 5589E8018DC7F934A8FDAB62670C9140AF31CAB6 <br> 57BBA7D8786D3B0C5F93BC20AB505DF3F69C72D4 <br> 630FE59D60F6882A0B9E35ED606BF06AD4BA048C <br> 63EA7C844D86882F491812813AAAD746738A6BE9 <br> 64121FA2FD2E38AC85A911A9F7ADD8CA1E1A9820 <br> 64DBA711FDD52FECF534CAC0C6FE8848FE36F196 <br> 650AB5E674FEF431EBC8CF98141506DDC80C5E64 <br> 6EF13E9D5B0B6FCB5EB2A7439AAD7B21EA7FB7AC <br> 7177F64362A504F3DF8AA815CEF7136D5A819C04 <br> 9B91EC03A09C4CF6DBEC637B3551BDCA11F04A9B <br> A26764AFB1DAC34CAA2123F7BF3543D385147024 <br> A55319D3DBD7B9A587F5156CF201C327C803FBC9 <br> A841FF1EE379269F00261337A043448D3D72E6FD <br> AAB5BAAAE8A2577E1036769F0D349F553E4D129B <br> ACB989B3401780999474C5B1D7F9198ECA11549A <br> B65372E41E7761A68AEF87001BBB698D8D8D5EC6 <br> BDB5E0B6CA0AA03E0BECA23B46A8420473091DFF <br> C4421084C19423D311A94D7BB6CB0169C44CBECD <br> C7E76993BB419DC755BD0C04255AB88E6C77B294 <br> CF5238C467EBE2704528EED18AB4259BFDC604E3 <br> D2334E161A1720E2DF048E4366150729B9395144 <br> D35FB6E031720876482E728A40532703EF02A305 <br> D82DF2903AA4BC5FD4274B5D1BFAF9E081771628 <br> E4B3CBCA9A53B7B93177A270C2A76F981D157C34 <br> E585AA2C5BFB9D42D2E58DB3833330D056713B9A <br> F4A485696FC871307C22906701CBBB3FA522499B <br> F5C75450108440D0BC9E7B210F072EF25A196D20</code> <br> <br><h4>  Quasar </h4><br> <code>0A4915B81D9A9ACF4E19181DEEEBBE244430C16B <br> 323160C88A254127D9ADB2848AE044AFFF376A4D <br> 395166835495B418773C9690227779D592F94F71 <br> 3EE410DD50FC64F39DFF0C4EE8CC676F0F7D5A74 <br> 5B665152F6596D4412267F9C490878455BA235F9 <br> 5FE8558EB8A3C244BE2DA8BE750221B9A9EE8539 <br> 61CB5E535F0AC90A1F904EC9937298F50E2B4974 <br> 6A1CD05F07B1024287CEA400237E1EA9D2FE1678 <br> 7676AFF05A3550E5BBFF78CF4D10C9E094447D72 <br> 86165F464EC1912A43445D80559D65C165E2CF76 <br> AB3CD05BE6B0BA8567B84D10EDE28ABF87E115AC <br> BFD7158E1C2F6BA525E24F85ED8CCF8EF40FD370 <br> CFEBEFC92DCDF1687FD0BC1B50457EBDEA8672A2 <br> D21B8514990B0CEAC5EAE687DEAA60B447139B9D</code> <br> <br><h4>  Steganographie </h4><br> <code>04DA3E81684E4963ABEC4C0F6D56DF9F00D2EF26 <br> 3C618A0C4BF4D3D24C9F2A84D191FC296ED22FA4 <br> 746155881D5AB2635566399ACC89E43F6F3DA91A <br> CADBC40A4EFB10F4E9BD8F4EC3742FA8C37F4231 <br> E22CE72406B14EF32A469569FBE77839B56F2D69</code> <br> <br><h4>  Hta-Dateien </h4><br> <code>39F5B17471FD839CC6108266826A4AD8F6ECD6A3 <br> 751FBD034D63A5E0A3CA64F55045AE24E575384A <br> 76433D1D13DF60EC0461ED6D8007A95C7A163FF9 <br> 89DF6A7551B00969E22DC1CAE7147447ACA10988 <br> D6D148050F03F5B14681A1BBF457572B9401B664</code> <br> <br><h4>  Audio-Aufnahme-Tool </h4><br> <code>1F49946CA2CE51DC51615000BAA63F6C5A9961F1 <br> 98F62C2E6045D5A15D33C8383ADACF9232E5FBE3 <br> E7C4A69EBD7B41A6AF914DD3D3F64E1AA1ABE9B4 <br> F233A0F2997BB554D4F1A4B7AC77DAE4180850FA</code> <br> <br><h4>  Keylogger </h4><br> <code>21921864D2F1AB2761C36031A2E1D2C00C9B304A <br> 3C2D0615BEF6F88FED6E308D4F45B6133080C74F <br> 91E8346910E0E6783ACFC4F2B9A745C81BD7573A</code> <br> <br><h4>  Tool zum Diebstahl von Passwörtern </h4><br> <code>2A5C9D4DAE5E53B2962FBE2B7FA8798A127BC9A6 <br> 9B1586766AF9885EF960F05F8606D1230B36AC15 <br> A2F0D5AF81D93752CFF1CF1E8BB9E6CAEE6D1B5E <br> CE18467B33161E39C36FC6C5B52F68D49ABCFC2A</code> <br> <br><h4>  USB-Tool zum Diebstahl von Dateien </h4><br> <code>050EB7D20EE8EF1E1DAEE2F421E5BF648FB645DF <br> 069A919B3BC8070BB2D71D3E1AD9F7642D8ECF0F <br> 0D265E0BDA9DF83815759ABCA64938EC0FF65733 <br> 0D7DF910D0FB7B100F084BFB8DFA0A9F2371171A <br> 2FF3F5DA2960BE95E50B751680F450896AD1ED67 <br> 3200ECC7503F184F72AB9DA1DC3E1F8D43DDFD48 <br> 46D256EF277328E803D2B15CA7C188267059949D <br> 524EE1B7269D02F725E55254A015200BB472463A <br> 53A0EFD3D448DA8E32CFDDA5848312D3CF802B06 <br> 6FC150A9CAFA75813E7473C687935E7E4A5DCE24 <br> 70559245303F99630A27CB47B328C20C9666F0BB <br> 7D8044A5CBEFE3B016F2132A5750C30BB647E599 <br> 8FD919D531A7A80615517E1AC13C2D0F050AF20D <br> 9D22421DA9696B535C708178C72323F64D31FC80 <br> BFD2DFA3D6AF31DF4B9CC2F6B31B239ADF1CECA1 <br> C08A6222B59A187F3CF27A7BAE4CACFACC97DDEE <br> C2F6A65E14605828880927B9BA3C386507BD8161 <br> C562006D2FA53B15052A4B80C94B86355CCA7427 <br> CB43058D9EBB517832DF7058641AEDF6B303E736 <br> CC8A9C28E884FDA0E1B3F6CEAB12805FEA17D3C1 <br> D3CC27CA772E30C6260C5A3B6309D27F08A295CD <br> E7A2DE3776BA7D939711E620C7D6AB25946C9881 <br> EE6EFA7A6A85A1B2FA6351787A1612F060086320 <br> EF0ABB3A0CD1E65B33C0F109DD18F156FC0F0CDE <br> F63BE193C8A0FBB430F3B88CC8194D755BAD9CD1</code> <br> <br><h3>  ESET-Erkennung </h3><br>  Die meisten Dateien wurden von ESET automatisch anhand eines Malware-Ähnlichkeitsprinzips erkannt.  Entdeckungen stehen in direktem Zusammenhang mit den meisten Dateien in der Kampagne: <br> <code>MSIL/Agent AWB <br> MSIL/Agent AZG <br> MSIL/Agent AZJ <br> MSIL/Agent AZX <br> MSIL/Agent BCH <br> MSIL/Agent BCV <br> MSIL/Agent BCY <br> MSIL/Agent BFT <br> MSIL/Agent BGB <br> MSIL/Agent BGC <br> MSIL/Agent BGE <br> MSIL/Agent BGM <br> MSIL/Agent BJU <br> MSIL/Agent SCM <br> MSIL/Spy Agent BBB <br> MSIL/Spy Agent BIF <br> MSIL/TrojanDownloader Agent DYV <br> MSIL/TrojanDownloader Small BBM <br> MSIL/TrojanDropper Agent DBE <br> MSIL/TrojanDropper Agent DJQ <br> MSIL/TrojanDropper Agent DJR <br></code> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de418165/">https://habr.com/ru/post/de418165/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de418153/index.html">Kolesa Android Meetup Video: Informationen zu MVVM, Antipatterns und modularer Entwicklung</a></li>
<li><a href="../de418155/index.html">Diode LED Zenerdiode</a></li>
<li><a href="../de418159/index.html">Wohin zum Designer: renommierte Auszeichnungen für Russland, Osteuropa und die GUS-Staaten</a></li>
<li><a href="../de418161/index.html">In Stanford entwickelten sich Streaming-Batterien für Raumtemperatur</a></li>
<li><a href="../de418163/index.html">Produktionstests: Netflix Chaos Automation Platform</a></li>
<li><a href="../de418167/index.html">ScadaPy: Fügen Sie das IEC 60870-5-104-Protokoll hinzu</a></li>
<li><a href="../de418169/index.html">Was ist neu in Veeam Availability Console 2.0 Update 1?</a></li>
<li><a href="../de418171/index.html">Auf welche Metriken sollten Sie sich verlassen, wenn Benutzer nur wenige Conversions auf der Website durchführen?</a></li>
<li><a href="../de418173/index.html">Roundtrip für neuronale Netze oder eine Überprüfung der Verwendung von Auto-Encodern in der Textanalyse</a></li>
<li><a href="../de418177/index.html">Bearbeiten von .heic-Bildern ohne Farbverlust</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>