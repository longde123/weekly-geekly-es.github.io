<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèø‚Äçüé® üôèüèº üì• Interaksi R dengan database pada contoh Microsoft SQL Server dan DBMS lainnya üòá üë©üèø‚Äçü§ù‚Äçüë©üèæ üßíüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Karena bagian terbesar dari informasi bisnis disimpan dalam database. Dalam bahasa pemrograman apa pun yang Anda tulis, Anda harus melakukan berbagai ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Interaksi R dengan database pada contoh Microsoft SQL Server dan DBMS lainnya</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/461063/"><p>  Karena bagian terbesar dari informasi bisnis disimpan dalam database.  Dalam bahasa pemrograman apa pun yang Anda tulis, Anda harus melakukan berbagai tindakan dengannya. </p><br><p>  Pada artikel ini saya akan berbicara tentang dua antarmuka untuk bekerja dengan database di R. Sebagian besar contoh menunjukkan bekerja dengan Microsoft SQL Server, namun, semua contoh kode akan bekerja dengan database lain, seperti: MySQL, PostgreSQL, SQLite, ClickHouse , Google BigQuery, dll. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/925/a23/786/925a23786a89917d9a314a793545cbb1.jpg" alt="gambar"></p><a name="habracut"></a><br><h1 id="soderzhanie">  Isi </h1><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Diperlukan perangkat lunak</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Paket DBI</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Daftar fungsi dasar DBI</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Konektivitas Basis Data</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Contoh menghubungkan ke Microsoft SQL Server menggunakan paket odbc</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Contoh menghubungkan ke Microsoft SQL Server menggunakan paket RMSSQL</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Cara menyembunyikan kata sandi basis data dalam skrip R.</a> </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Membuat tabel dan menulis ke database</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Membaca data dari DBMS</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Manipulasi data dalam DBMS (DML)</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Transaksi dalam DBMS</a> </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Paket RODBC</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Fitur utama dari paket RODBC</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Contoh bekerja dengan RODBC</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Transaksional</a> </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Kesimpulan</a> </li></ul><br><h1 id="trebuemoe-programmnoe-obespechenie">  Diperlukan perangkat lunak </h1><br><p>  Untuk mengulangi semua contoh bekerja dengan DBMS yang dijelaskan dalam artikel, Anda akan memerlukan perangkat lunak gratis berikut yang tercantum di bawah ini: </p><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bahasa R</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Lingkungan</a> pengembangan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">RStudio</a> ; </li><li>  Sistem Manajemen Basis Data, untuk dipilih: <br>  3.1.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Microsoft SQL Server</a> <br>  3.2.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">MySQL</a> <br>  3.3.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">PostgreSQL</a> </li></ol><br><h1 id="paket-dbi">  Paket DBI </h1><br><p> Paket <code>DBI</code> adalah cara yang paling populer dan mudah untuk berinteraksi dengan basis data di R. </p><br><p>  <code>DBI</code> menyediakan Anda serangkaian fungsi yang dapat digunakan untuk mengelola basis data.  Tetapi untuk terhubung ke database, Anda perlu menginstal paket tambahan yang merupakan driver untuk berbagai sistem manajemen basis data (DBMS). </p><br><h3 id="spisok-osnovnyh-funkciy-dbi">  Daftar fungsi dasar DBI </h3><br><ul><li>  <code>dbConnect</code> - koneksi ke database; </li><li>  <code>dbWriteTable</code> - menulis tabel ke database; </li><li>  <code>dbReadTable</code> - memuat tabel dari database; </li><li>  <code>dbGetQuery</code> - memuat hasil eksekusi permintaan; </li><li>  <code>dbSendQuery</code> - mengirim kueri ke basis data; </li><li>  <code>dbFetch</code> - ekstrak elemen dari set hasil; </li><li>  <code>dbExecute</code> - eksekusi permintaan untuk memperbarui / menghapus / memasukkan data ke dalam tabel; </li><li>  <code>dbGetInfo</code> - informasi permintaan tentang hasil permintaan atau koneksi; </li><li>  <code>dbListFields</code> - permintaan daftar bidang tabel; </li><li>  <code>dbListTables</code> - kueri daftar tabel basis data; </li><li>  <code>dbExistsTable</code> - periksa keberadaan tabel dalam database; </li><li>  <code>dbRemoveTable</code> - menghapus tabel dari database; </li><li>  <code>dbDisconnect</code> - putuskan sambungan dari basis data. </li></ul><br><h3 id="podklyuchenie-k-bazam-dannyh">  Konektivitas Basis Data </h3><br><p>  Untuk berinteraksi dengan basis data, Anda harus terlebih dahulu terhubung dengannya.  Bergantung pada DBMS yang Anda rencanakan untuk bekerja, Anda akan memerlukan paket tambahan, di bawah ini adalah daftar yang paling sering digunakan. </p><br><ul><li>  <code>odbc</code> - Driver untuk terhubung melalui antarmuka ODBC; </li><li>  <code>RSQLite</code> - Driver untuk SQLite; </li><li>  <code>RMySQL</code> / <code>RMariaDB</code> - Driver untuk MySQL dan MariaDB; </li><li>  <code>RPostgreSQL</code> - Driver untuk PosrtgreSQL; </li><li>  <code>bigrquery</code> - Driver untuk Google BigQuery; </li><li>  <code>RClickhouse</code> / <code>clickhouse</code> - Driver untuk ClickHouse; </li><li>  <code>RMSSQL</code> - Driver untuk Microsoft SQL Server (MS SQL), <em>pada saat penulisan, hanya ada di GitHub</em> . </li></ul><br><p>  Paket <code>DBI</code> dilengkapi dengan paket R dasar, tetapi paket yang merupakan driver basis data harus diinstal menggunakan perintah <code>install.packages(" ")</code> . </p><br><p>  Untuk menginstal paket dari GitHub, Anda juga memerlukan paket tambahan - <code>devtools</code> .  Misalnya, paket <code>RMSSQL</code> saat ini tidak dipublikasikan di repositori paket R utama, gunakan kode berikut untuk menginstalnya: </p><br><pre> <code class="plaintext hljs">install.packages("devtools") devtools::install_github("bescoto/RMSSQL")</code> </pre> <br><h4 id="primer-podklyucheniya-k-microsoft-sql-server-s-pomoschyu-paketa-odbc">  Contoh menghubungkan ke Microsoft SQL Server menggunakan paket odbc </h4><br><p>  Sebelum menggunakan paket apa pun dalam sesi R, terlebih dahulu harus terhubung menggunakan fungsi <code>library(" ")</code> . </p><br><p>  Bukan tanpa alasan saya memilih Microsoft SQL Server sebagai DBMS utama, yang akan memberikan sebagian besar contoh dalam artikel ini.  Faktanya adalah bahwa ini adalah basis data yang cukup populer, tetapi pada saat yang sama masih tidak memiliki driver untuk terhubung dari R yang diterbitkan pada CRAN. </p><br><p>  Tetapi untungnya, SQL Server, seperti hampir semua database lain, memiliki antarmuka <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ODBC</a> (English Open Database Connectivity) untuk menghubungkan.  Ada sejumlah paket untuk terhubung ke DBMS melalui antarmuka ODBC di R.  Pertama, kita akan melihat menghubungkan melalui paket <code>odbc</code> . </p><br><div class="spoiler">  <b class="spoiler_title">Koneksi basis data yang mudah melalui antarmuka odbc</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   odbc install.packages("odbc") #   library(odbc) #   MS SQL con &lt;- dbConnect(drv = odbc(), Driver = "SQL Server", Server = "localhost", Database = "mybase", UID = "my_username", PWD = "my_password", Port = 1433)</code> </pre> </div></div><br><p>  Dalam fungsi <code>dbConnect()</code> , Anda harus melewati fungsi, yang merupakan driver untuk menyambungkan ke DBMS ( <code>odbc()</code> ), sebagai argumen pertama ke <em>drv</em> .  Fungsi seperti itu biasanya disebut sama dengan DBMS, dan datang dengan paket yang merupakan driver untuk <code>DBI</code> . </p><br><p>  Selanjutnya, Anda perlu mendaftar parameter koneksi.  Untuk terhubung ke MS SQL melalui ODBC, Anda harus menentukan parameter berikut: </p><br><ul><li>  Driver - Nama driver ODBC; </li><li>  Server - alamat IP dari server SQL; </li><li>  Database - Nama database yang akan dihubungkan; </li><li>  UID - Nama pengguna basis data; </li><li>  PWD - Kata Sandi; </li><li>  Port - Port yang akan dihubungkan, dengan SQL Server, port default adalah 1433. </li></ul><br><p>  Pengandar ODBC untuk menghubungkan ke Microsoft SQL Server disertakan dengan Windows, tetapi mungkin memiliki nama yang berbeda.  Anda dapat melihat daftar driver yang diinstal di ODBC Data Source Administrator.  Anda dapat memulai administrator sumber data di Windows 10 dengan cara berikut: </p><br><ul><li>  Versi 32-bit: <code>%systemdrive%\Windows\SysWoW64\Odbcad32.exe</code> </li><li>  Versi 64-bit: <code>%systemdrive%\Windows\System32\Odbcad32.exe</code> </li></ul><br><p><img src="https://habrastorage.org/getpro/habr/post_images/c6c/816/934/c6c816934a70e2386a4547d7626d515f.png"></p><br><p>  Anda juga bisa mendapatkan daftar semua driver yang diinstal pada PC Anda menggunakan fungsi <code>odbcListDrivers()</code> . </p><br><pre> <code class="plaintext hljs"> name attribute value &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; 1 SQL Server APILevel 2 2 SQL Server ConnectFunctions YYY 3 SQL Server CPTimeout 60 4 SQL Server DriverODBCVer 03.50 5 SQL Server FileUsage 0 6 SQL Server SQLLevel 1 7 SQL Server UsageCount 1 8 MySQL ODBC 5.3 ANSI Driver UsageCount 1 9 MySQL ODBC 5.3 Unicode Driver UsageCount 1 10 Simba ODBC Driver for Google BigQuery Description Simba ODBC Driver for Google BigQuery2.0 # ... with 50 more rows</code> </pre> <br><p>  Anda dapat mengunduh driver ODBC untuk DBMS lain di tautan berikut: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">MySQL</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">PostgreSQL</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Google bigquery</a> </li></ul><br><p>  Untuk berbagai DBMS, nama parameter untuk koneksi mungkin berbeda, misalnya: </p><br><ul><li>  PostgreSQL / MySQL / MariaDB - pengguna, kata sandi, host, port, dbname; </li><li>  GoogleBigQuery - proyek, set data; </li><li>  ClickHouse - pengguna, kata sandi, db, port, host; </li></ul><br><p>  Menggunakan administrator sumber data ODBC, Anda bisa menjalankan panduan untuk membuat sumber data ODBC.  Untuk melakukan ini, cukup buka administrator, buka tab "Custom DSN" dan klik tombol "Add ...". </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/9ae/e92/ba3/9aee92ba30bdc8de811623aae1fb58fa.png"></p><br><p>  Saat membuat sumber data menggunakan administrator, Anda memberinya nama, DSN (Nama Sumber Data). </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b03/a0c/a7c/b03a0ca7c90fa0d5bddccb53575563a3.png"></p><br><p>  Pada contoh di atas, kami membuat sumber data dengan DSN "my_test_source".  Sekarang kita dapat menggunakan sumber ini untuk terhubung ke Microsoft SQL Server, dan tidak menentukan parameter koneksi lain dalam kode. </p><br><div class="spoiler">  <b class="spoiler_title">Menghubungkan ke database melalui antarmuka odbc menggunakan DSN</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   DSN con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password")</code> </pre> </div></div><br><p>  Anda dapat melihat nama semua sumber data ODBC yang dibuat pada PC Anda menggunakan fungsi <code>odbcListDataSources()</code> . </p><br><pre> <code class="plaintext hljs"> name description &lt;chr&gt; &lt;chr&gt; 1 BQ Simba ODBC Driver for Google BigQuery 2 BQ_main Simba ODBC Driver for Google BigQuery 3 BQ ODBC Simba ODBC Driver for Google BigQuery 4 OLX Simba ODBC Driver for Google BigQuery 5 Multicharts Simba ODBC Driver for Google BigQuery 6 PostgreSQL35W PostgreSQL Unicode(x64) 7 hillel_bq Simba ODBC Driver for Google BigQuery 8 blog_bq Simba ODBC Driver for Google BigQuery 9 MyClientMSSQL SQL Server 10 local_mssql SQL Server 11 MSSQL_localhost SQL Server 12 my_test_source SQL Server 13 Google BigQuery Simba ODBC Driver for Google BigQuery</code> </pre> <br><h3 id="primer-podklyucheniya-k-microsoft-sql-server-s-pomoschyu-paketa-rmssql">  Contoh menghubungkan ke Microsoft SQL Server menggunakan paket RMSSQL </h3><br><p>  <code>RMSSQL</code> tidak dipublikasikan di CRAN, jadi Anda dapat menginstalnya dari GitHub menggunakan paket <code>devtools</code> . </p><br><pre> <code class="plaintext hljs">install.packages("devtools") devtools::install_github("bescoto/RMSSQL")</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Contoh koneksi menggunakan driver DBI RMSSQL</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#    library(RJDBC) library(RMSSQL) library(DBI) #  RMSSQL con &lt;- dbConnect(MSSQLServer(), host = 'localhost', user = 'my_username', password = 'my_password', dbname = "mybase")</code> </pre> </div></div><br><p>  Dalam kebanyakan kasus, menggunakan paket <code>DBI</code> untuk bekerja dengan database, Anda akan terhubung dengan cara ini.  Yaitu  instal salah satu paket driver yang diperlukan, melewati fungsi <code>dbConnect</code> sebagai nilai argumen <em>drv</em> , fungsi driver untuk terhubung ke DBMS yang Anda butuhkan. </p><br><div class="spoiler">  <b class="spoiler_title">Contoh menghubungkan ke MySQL, PostgreSQL, SQLite dan BigQuery</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   MySQL library(RMySQL) con &lt;- dbConnect(MySQL(), host = 'localhost', user = 'my_username', password = 'my_password', dbname = "mybase", host = "localhost") #   PostrgeSQL library(RPostgreSQL) con &lt;- dbConnect(PostgreSQL(), host = 'localhost', user = 'my_username', password = 'my_password', dbname = "mybase", host = "localhost") #   PostrgeSQL library(RPostgreSQL) con &lt;- dbConnect(PostgreSQL(), host = 'localhost', user = 'my_username', password = 'my_password', dbname = "mybase", host = "localhost") #   SQLite library(RSQLite) # connection or create base con &lt;- dbConnect(drv = SQLite(), "localhost.db") #   Google BigQuery library(bigrquery) con &lt;- dbConnect(drv = bigquery(), project = "my_proj_id", dataset = "dataset_name")</code> </pre> </div></div><br><h3 id="kak-skryt-paroli-ot-bazy-dannyh-v-r-skriptah">  Cara menyembunyikan kata sandi basis data dalam skrip R. </h3><br><p>  Di atas, saya memberikan beberapa contoh yang dapat digunakan untuk terhubung ke basis data apa pun, tetapi ada satu minus di dalamnya, dalam bentuk ini semua akses basis data, termasuk kata sandi, disimpan sebagai teks dalam skrip itu sendiri. </p><br><p>  Jika semua skrip Anda dikerahkan dan dijalankan secara eksklusif di PC Anda, dan itu dilindungi kata sandi pada saat yang sama, maka kemungkinan besar tidak akan ada masalah.  Tetapi jika Anda bekerja dengan seseorang di server yang sama, maka menyimpan kata sandi dari database dalam teks skrip Anda bukanlah solusi terbaik. </p><br><p>  Setiap sistem operasi memiliki utilitas untuk mengelola kredensial.  Misalnya, pada Windows, ini adalah Manajer Kredensial.  Anda dapat menambahkan kata sandi yang Anda gunakan untuk terhubung ke database melalui paket <code>keyring</code> ke repositori ini.  Paket ini adalah cross-platform dan contoh di atas akan bekerja di sistem operasi apa pun, setidaknya pada Windows, MacOS dan Linux. </p><br><pre> <code class="plaintext hljs"># install.packages("keyring") #   library(keyring) library(RMSSQL) #   key_set_with_value(service = "mssql", username = "my_username", password = "my_password") #   RMSSQL con &lt;- dbConnect(MSSQLServer(), host = 'localhost', user = 'my_username', password = key_get("mssql", "my_username"), dbname = "mybase")</code> </pre> <br><p>  Yaitu  menggunakan fungsi <code>key_set_with_value()</code> , Anda menambahkan kata sandi ke penyimpanan kredensial, dan menggunakan <code>key_get()</code> minta, dan hanya pengguna yang menambahkannya ke toko yang dapat meminta kata sandi.  Dengan menggunakan <code>keyring</code> Anda dapat menyimpan kata sandi tidak hanya dari database, tetapi juga dari layanan apa pun, serta token otorisasi ketika bekerja dengan API. </p><br><h3 id="sozdanie-tablic-i-zapis-v-bazu-dannyh">  Membuat tabel dan menulis ke database </h3><br><p>  Menulis ke database dilakukan oleh fungsi <code>dbWriteTable()</code> . </p><br><p>  Argumen untuk fungsi <code>dbWriteTable()</code> : </p><br><p>  <em>Argumen yang diperlukan dalam huruf tebal, huruf miring adalah opsional</em> </p><br><ul><li>  objek koneksi <strong>conn</strong> - DBMS dibuat menggunakan fungsi <code>dbConnect</code> ; </li><li>  <strong>nama</strong> - nama tabel dalam DBMS dimana data akan ditulis; </li><li>  <strong>value</strong> - tabel (objek dari kelas data.frame / data.table / tibble_frame) dalam R, data yang darinya akan ditulis ke DBMS; </li><li>  <em>row.names</em> - Menambahkan kolom row_names dengan nomor baris ke tabel, <em>default ke FALSE</em> . </li><li>  <em>overwrite</em> - Timpa tabel jika tabel dengan nama yang ditentukan dalam argumen <em>nama</em> sudah ada dalam DBMS, <em>nilai defaultnya adalah SALAH</em> ; </li><li>  <em>append</em> - Menambahkan data jika tabel dengan nama yang ditentukan dalam argumen <em>nama</em> sudah ada dalam DBMS, <em>nilai defaultnya adalah SALAH</em> ; </li><li>  <em>field.types</em> - Menerima vektor bernama, dan menetapkan tipe data di setiap bidang saat menulis ke DBMS, <em>default ke NULL</em> ; </li><li>  <em>temporary</em> - Memungkinkan Anda untuk membuat tabel sementara dalam DBMS, yang akan tersedia hingga koneksi dengan database terputus; <em>nilai defaultnya adalah SALAH</em> . </li></ul><br><div class="spoiler">  <b class="spoiler_title">Contoh penulisan data ke DBMS melalui DBI</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #     DSN con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #     iris,         R  iris dbWriteTable(conn = con, name = "iris", value = iris) #     dbDisconnect(con)</code> </pre> </div></div><br><p>  Untuk melihat tabel dalam database, gunakan fungsi <code>dbListTables()</code> , untuk menghapus tabel <code>dbRemoveTable()</code> </p><br><div class="spoiler">  <b class="spoiler_title">Contoh meminta daftar tabel dan menghapus tabel dari DBMS</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #    con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #    dbListTables(con) #   iris dbRemoveTable(con, "iris") #     dbDisconnect(con)</code> </pre> </div></div><br><h3 id="chtenie-dannyh-iz-subd">  Membaca data dari DBMS </h3><br><p>  Menggunakan <code>DBI</code> Anda bisa meminta seluruh tabel atau hasil dari mengeksekusi query SQL Anda.  Fungsi <code>dbReadTable()</code> dan <code>dbGetQuery()</code> digunakan untuk melakukan operasi ini. </p><br><div class="spoiler">  <b class="spoiler_title">Contoh permintaan tabel iris dari DBMS</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #    con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #   iris   iris dbiris &lt;- dbReadTable(con, "iris") #     dbDisconnect(con)</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Contoh memuat hasil mengeksekusi SQL dari DBMS</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #    con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #     setosa &lt;- dbGetQuery(con, "SELECT * FROM iris WHERE Species = 'setosa'") #     dbDisconnect(con)</code> </pre> </div></div><br><h3 id="manipulirovanie-dannymi-v-subd-dml">  Manipulasi data dalam DBMS (DML) </h3><br><p>  Fungsi <code>dbGetQuery()</code> atas digunakan secara eksklusif untuk meminta sampel data (SELECT). </p><br><p>  Untuk operasi manipulasi data, seperti UPDATE, INSERT, DELETE, fungsi <code>dbExecute()</code> ada di <code>DBI</code> . </p><br><div class="spoiler">  <b class="spoiler_title">Kode sampel untuk memanipulasi data dalam DBMS</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #    con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #   (INSERT) dbExecute(con, "INSERT INTO iris (row_names, [Sepal.Length], [Sepal.Width], [Petal.Length], [Petal.Width], [Species]) VALUES (51, 5.0, 3.3, 1.7, 0.3, 'new_values')") #   (UPDATE) dbExecute(con, "UPDATE iris SET [Species] = 'old_value' WHERE row_names = 51") #     (DELETE) dbExecute(con, "DELETE FROM iris WHERE row_names = 51") #     dbDisconnect(con)</code> </pre> </div></div><br><h3 id="tranzakcii-v-subd">  Transaksi dalam DBMS </h3><br><blockquote>  Transaksi adalah operasi baca dan tulis berurutan.  Akhir transaksi dapat berupa menyimpan perubahan (komit, komit) atau membatalkan perubahan (rollback, rollback).  Sehubungan dengan database, transaksi adalah serangkaian pertanyaan, yang diperlakukan sebagai permintaan tunggal. </blockquote><p>  <em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Kutipan dari artikel "Transaksi dan mekanisme kendali mereka"</a></em> </p><br><p>  Suatu transaksi merangkum beberapa pernyataan SQL dalam sebuah unit dasar.  Di <code>DBI</code> awal transaksi dimulai dengan <code>dbBegin()</code> dan kemudian dikonfirmasi dengan <code>dbCommit()</code> atau dibatalkan dengan <code>dbRollback()</code> .  Dalam hal apa pun, DBMS menjamin bahwa: semua atau tidak satu pun pernyataan akan diterapkan pada data. </p><br><p>  Misalnya, selama transaksi, mari tambahkan 51 baris ke tabel iris, lalu ubah nilai <em>Sepal.Width</em> menjadi 5 baris dan hapus 43 baris dari tabel. </p><br><div class="spoiler">  <b class="spoiler_title">Contoh kode transaksi</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #    con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #      dbGetQuery(con, "SELECT * FROM iris WHERE row_names IN (5, 43, 51)") # row_names Sepal.Length Sepal.Width Petal.Length Petal.Width Species # 1 5 5.0 3.6 1.4 0.2 setosa # 2 43 4.4 3.2 1.3 0.2 setosa # 3 51 7.0 3.2 4.7 1.4 versicolor #    dbBegin(con) #   dbExecute(con, "INSERT INTO iris (row_names, [Sepal.Length], [Sepal.Width], [Petal.Length], [Petal.Width], [Species]) VALUES (51, 5.0, 3.3, 1.7, 0.3, 'new_values')") #   dbExecute(con, "UPDATE iris SET [Sepal.Width] = 8 WHERE row_names = 5") #   43 dbExecute(con, "DELETE FROM iris WHERE row_names = 43") #   dbCommit(con) #      dbGetQuery(con, "SELECT * FROM iris WHERE row_names IN (5, 43, 51)") # row_names Sepal.Length Sepal.Width Petal.Length Petal.Width Species # 1 5 5 8.0 1.4 0.2 setosa # 2 51 7 3.2 4.7 1.4 versicolor # 3 51 5 3.3 1.7 0.3 new_values</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Contoh Kode Pembatalan Transaksi</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #    con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #      dbGetQuery(con, "SELECT * FROM iris WHERE row_names IN (5, 43, 51)") # row_names Sepal.Length Sepal.Width Petal.Length Petal.Width Species # 1 5 5.0 3.6 1.4 0.2 setosa # 2 43 4.4 3.2 1.3 0.2 setosa # 3 51 7.0 3.2 4.7 1.4 versicolor #    dbBegin(con) #   dbExecute(con, "INSERT INTO iris (row_names, [Sepal.Length], [Sepal.Width], [Petal.Length], [Petal.Width], [Species]) VALUES (51, 5.0, 3.3, 1.7, 0.3, 'new_values')") #   dbExecute(con, "UPDATE iris SET [Sepal.Width] = 8 WHERE row_names = 5") #   43 dbExecute(con, "DELETE FROM iris WHERE row_names = 43") #   dbRollback(con) #      dbGetQuery(con, "SELECT * FROM iris WHERE row_names IN (5, 43, 51)") # row_names Sepal.Length Sepal.Width Petal.Length Petal.Width Species # 1 5 5.0 3.6 1.4 0.2 setosa # 2 43 4.4 3.2 1.3 0.2 setosa # 3 51 7.0 3.2 4.7 1.4 versicolor</code> </pre> </div></div><br><h1 id="paket-rodbc">  Paket RODBC </h1><br><p>  Paket <code>RODBC</code> menyediakan antarmuka yang berdiri sendiri untuk menghubungkan dan bekerja dengan DBMS melalui antarmuka ODBC. </p><br><p>  <code>RODBC</code> tidak kompatibel dengan <code>DBI</code> , mis.  Anda tidak dapat menggunakan objek koneksi yang dibuat menggunakan <code>RODBC</code> dalam fungsi yang disediakan oleh paket <code>DBI</code> . </p><br><h3 id="osnovnye-funkcii-paketa-rodbc">  Fitur utama dari paket RODBC </h3><br><ul><li>  <code>odbcConnect</code> - Koneksi ke DBMS melalui DSN; </li><li>  <code>odbcDriverConnect</code> - Koneksi ke database melalui string koneksi; </li><li>  <code>sqlQuery</code> - Mengirim kueri ke DBMS, dan mendapatkan hasil eksekusi.  Mendukung kueri apa pun: SELECT, UPDATE, INSERT, DELETE. </li><li>  <code>sqlFetch</code> - Dapatkan seluruh tabel dari DBMS; </li><li>  <code>sqlTables</code> - Dapatkan daftar tabel dalam database. </li><li>  <code>sqlSave</code> - Buat tabel baru di database, atau tambahkan data baru ke tabel yang ada; </li><li>  <code>sqlUpdate</code> - Memperbarui data dalam tabel yang sudah ada di DBMS; </li><li>  <code>sqlDrop</code> - Hapus tabel dalam DBMS; </li><li>  <code>odbcClose</code> - Akhiri koneksi ke DBMS. </li></ul><br><h3 id="primer-raboty-s-rodbc">  Contoh bekerja dengan RODBC </h3><br><p>  Dari sudut pandang saya, <code>RODBC</code> kurang fungsional daripada <code>DBI</code> , tetapi memiliki semua fungsi yang diperlukan untuk bekerja dengan DBMS. </p><br><div class="spoiler">  <b class="spoiler_title">Contoh interaksi dengan DBMS melalui RODBC</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(RODBC) #   con_string &lt;- odbcDriverConnect(connection = "Driver=SQL Server;Server=localhost;Database=mybase;UID=my_username;PWD=my_password;Port=1433") #   DSN con_dsn &lt;- odbcConnect(dsn = "my_test_source", uid = "my_username", pwd = "my_password") #     sqlSave(con_dsn, dat = iris, tablename = "iris") #     iris sqlSave(con_dsn, dat = iris, tablename = "iris", append = TRUE) #   4  sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4) #      R iris[1, 5] &lt;- "virginica" #     sqlUpdate(con_dsn, dat = iris, tablename = "iris") #   4     sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4) #   sqlDrop(con_dsn, sqtable = "iris") #     odbcCloseAll()</code> </pre> </div></div><br><h1 id="tranzakcionnost">  Transaksional </h1><br><p>  Secara default, transaksionalitas dalam <code>RODBC</code> dimatikan.  Manajemen transaksi dilakukan oleh dua fungsi. </p><br><ul><li>  <code>odbcSetAutoCommit</code> - Beralih antara mode operasi DBMS normal dan transaksional; </li><li>  <code>odbcEndTran</code> - Konfirmasikan atau batalkan transaksi. </li></ul><br><p>  Mengaktifkan dan menonaktifkan mode transaksi dilakukan oleh fungsi <code>odbcSetAutoCommit</code> menggunakan argumen <em>autoCommit</em> . </p><br><div class="spoiler">  <b class="spoiler_title">Contoh bekerja dalam mode transaksional dalam RODBC</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(RODBC) #   DSN con_dsn &lt;- odbcConnect(dsn = "my_test_source", uid = "my_username", pwd = "my_password") #     sqlSave(con_dsn, dat = iris, tablename = "iris") #    odbcSetAutoCommit(con_dsn, autoCommit = FALSE) #   4  sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4) # rownames SepalLength SepalWidth PetalLength PetalWidth Species # 1 1 5.1 3.5 1.4 0.2 setosa # 2 2 4.9 3.0 1.4 0.2 setosa # 3 3 4.7 3.2 1.3 0.2 setosa # 4 4 4.6 3.1 1.5 0.2 setosa #      R iris[1, 5] &lt;- "virginica" #     sqlUpdate(con_dsn, dat = iris, tablename = "iris") #   4  sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4) # rownames SepalLength SepalWidth PetalLength PetalWidth Species # 1 1 5.1 3.5 1.4 0.2 virginica # 2 2 4.9 3.0 1.4 0.2 setosa # 3 3 4.7 3.2 1.3 0.2 setosa # 4 4 4.6 3.1 1.5 0.2 setosa #   odbcEndTran(con_dsn, commit = FALSE) #   4  sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4) # rownames SepalLength SepalWidth PetalLength PetalWidth Species # 1 1 5.1 3.5 1.4 0.2 setosa # 2 2 4.9 3.0 1.4 0.2 setosa # 3 3 4.7 3.2 1.3 0.2 setosa # 4 4 4.6 3.1 1.5 0.2 setosa #     sqlUpdate(con_dsn, dat = iris, tablename = "iris") #   odbcEndTran(con_dsn, commit = TRUE) #   4     sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4) # rownames SepalLength SepalWidth PetalLength PetalWidth Species # 1 1 5.1 3.5 1.4 0.2 virginica # 2 2 4.9 3.0 1.4 0.2 setosa # 3 3 4.7 3.2 1.3 0.2 setosa # 4 4 4.6 3.1 1.5 0.2 setosa #     odbcClose(con_dsn)</code> </pre> </div></div><br><h1 id="zaklyuchenie">  Kesimpulan </h1><br><p>  Dua metode bekerja dengan database dalam bahasa R, <code>DBI</code> dan <code>RODBC</code> yang dijelaskan dalam artikel ini cukup universal dan akan bekerja dengan hampir semua DBMS. </p><br><p>  Satu-satunya perbedaan dalam operasi antara DBMS yang berbeda adalah proses koneksi.  Untuk sebagian besar DBMS populer, ada paket terpisah yang merupakan driver.  Untuk sisa DBMS, perlu untuk mengkonfigurasi koneksi melalui antarmuka ODBC menggunakan <code>RODBC</code> <code>odbc</code> atau <code>RODBC</code> .  Semua manipulasi lain, terlepas dari DBMS yang Anda pilih, tidak akan berubah.  Pengecualian mengirim kueri SQL, tergantung pada dialek SQL yang didukung oleh DBMS yang Anda gunakan. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id461063/">https://habr.com/ru/post/id461063/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id461053/index.html">Kami menghubungkan peta online ke navigator di smartphone. Bagian 2 - kartu vektor</a></li>
<li><a href="../id461055/index.html">Tantangan Rekko 2019: bagaimana itu</a></li>
<li><a href="../id461057/index.html">Saluran telegram tentang pengembangan game</a></li>
<li><a href="../id461059/index.html">Menulis Aplikasi Android untuk Penggemar Film - Bagian 1 (Prototyping)</a></li>
<li><a href="../id461061/index.html">Paduan magnesium, batas kembar, dan pemisahan</a></li>
<li><a href="../id461067/index.html">65 pertanyaan SQL teratas dari wawancara kerja yang harus Anda persiapkan di tahun 2019. Bagian I</a></li>
<li><a href="../id461069/index.html">Kamera IP Luar Ruangan Nobelic: Tes, Teknologi, dan Kemampuan Sistem Pengawasan Video Ivideon</a></li>
<li><a href="../id461071/index.html">Optimalisasi permintaan basis data pada contoh layanan B2B untuk pembangun</a></li>
<li><a href="../id461073/index.html">Kami menghubungkan peta online ke navigator di smartphone. Bagian 3 - OverpassTurbo</a></li>
<li><a href="../id461075/index.html">Kecerdasan bisnis. Objek IT, komponen, alat</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>