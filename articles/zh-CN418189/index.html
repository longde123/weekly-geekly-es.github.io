<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧙🏻 ⛹🏿 🚵🏻 宙斯的继承人：为什么IcedID木马对银行客户有害 🌈 💌 ⏏️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="IB组专家分析了木马攻击美国银行客户的情况，并使用Python脚本和CnC服务器上的信息对动态配置数据格式进行了深入分析，并向公众公开。 


 2017年11月，来自IBM X-Force的一组研究人员发布了有关新木马-IcedID的报告，该报告主要针对美国银行的客户。 该机器人具有臭名昭著的Ze...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>宙斯的继承人：为什么IcedID木马对银行客户有害</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/group-ib/blog/418189/">  <b>IB组专家分析了木马攻击美国银行客户的情况，并使用Python脚本和CnC服务器上的信息对动态配置数据格式进行了深入分析，并向公众公开。</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/b0/4i/rd/b04ird-g1xlcbwcd27zrl3rzg90.png" alt="图片"></div><br>  2017年11月，来自IBM X-Force的一组研究人员发布了有关新木马<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-IcedID</a>的报告，该报告主要针对美国银行的客户。 该机器人具有臭名昭著的Zeus恶意软件的许多功能，包括：下载和运行模块，收集身份验证数据并将其传输到服务器，有关受感染设备的信息以及进行浏览器人（MITB）攻击。 尽管事实证明，新的特洛伊木马实际上与其他攻击银行客户的流行银行家-Trickbot，GOZI和Dridex类似，但IcedID使用非标准二进制格式存储配置数据。 该恶意软件的另一个显着特征是能够在受感染的计算机上直接部署代理服务器以进行MITB攻击的能力。 <a name="habracut"></a><br><br>  <b>文字：IB恶意软件分析专家Ivan Pisarev</b> <b><br></b> <br> 立即，与其他木马相比，IcedID并没有普及，但是现在它具有足够的功能来实现其目标，其中主要是盗窃受害人的凭据。 这可以通过多种方式来实现，从从受感染计算机中非法窃取文件和注册表项开始，到最后是拦截和更改加密的浏览器流量（浏览器攻击）。 <br><br> 在IcedID的情况下，数据从帐户中被盗：Windows Live Mail，Windows Mail，RimArts，Poco Systems Inc，IncrediMail，The Bat！ 和Outlook。  MITB攻击是使用代理服务器执行的，该代理服务器在受感染的设备上拾取木马，从而使所有网络流量通过自身并进行修改。  IcedID还具有服务器命令处理模块，该模块可让您远程下载并运行文件（例如，在研究中的示例中，样本加载了VNC模块，其程序代码与IcedID的代码段相似）。 <br><br> 对于这种类型的木马，将代理服务器用于MITB是一种非典型行为。 通常，恶意软件会嵌入浏览器上下文中，并将函数调用从标准库重定向到其处理函数（例如： <b>WinHttpConnect（）</b> ， <b>InternetConnect（）</b> ， <b>InternetReadFile（）</b> ， <b>WinHttpReadData（）</b>等）。 以前，代理技巧已在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GootKit中使用</a> 。 <br><br>  IcedID是使用另一种恶意软件Emotet分发的（尽管Emotet具有高级功能，但现在经常用作引导加载程序），并且一开始就已经包含了广泛的现代窃取用户数据的方法。 <br><br> 现在，该木马具有相当弱的反解析机制（字符串加密，标头损坏），并且没有VM检测方法。 从研究人员的角度来看，恶意软件仍在开发中，这些保护机制将在以后添加。 <br><br>  Group-IB威胁情报网络情报系统未在主题论坛上检测到IcedID的销售，这意味着在银行木马领域中出现了一个新的团体，或者通过私人渠道销售了该木马。 根据动态配置数据（以下称为config）判断，该机器人的目标主要位于美国。 <br><br><div class="spoiler">  <b class="spoiler_title">目标清单</b> <div class="spoiler_text"> 追逐 <br> 查尔斯·施瓦布 <br> 美国银行 <br> 美国航空 <br> 美国运通 <br> 富国银行 <br> 大写一 <br>  TD商业银行 <br> 道明银行 <br> 中央银行 <br> 美国银行 <br> 加利福尼亚联合银行 <br> 亚马孙 <br>  PNC网上银行 <br> 滑膜 <br>  BB＆T银行 <br> 花旗银行 <br> 电子银行 <br> 亨廷顿 <br>  ashanalyzer <br> 电子贸易 <br> 摩根大通 <br> 西伯 <br> 区域OnePass <br> 邮政橡树银行 <br> 美洲 <br> 发现银行 <br> 钥匙库 <br> 弗罗斯特现金经理 <br> 汇丰银行 <br> 红细胞 <br> 哈利法克斯 <br> 威瑞森无线 <br> 劳埃德银行 <br>  M＆T银行 <br>  Virwox <br>  ADP <br></div></div><br> 本文包括对该木马的详细分析，对使用Python脚本的动态配置格式的深入分析以及有关CnC的信息。 <br><br><h2> 技术部分 </h2><br><h3> 木马工作概述 </h3><br> 最初，该木马的<b>.data</b>部分被加密。 首先，启动它之后，它将根据算法解密该部分： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/a-/q0/ix/a-q0ixeg0onp--szzafmr9on6os.png" alt="图片"></div><br> 变量<b>initial_seed</b>和<b>size_seed</b>位于数据段的开头（该段的前8个字节），此后找到大小为<b>size</b>字节的加密数据。  <b>make_seed（）</b>函数是<b>IcedID</b>的唯一伪随机数生成器（ <b>PRNG）</b>函数，我们将返回多次。 您可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">此处</a>找到该函数的Python版本。 <br><br> 最初，该漫游器包含加密的字符串。 为了便于分析，已为IDA Pro解码了一个<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">脚本</a>以解密字符串（您必须在示例中插入解密函数的地址）。 <br><br> 下一步是使用<b>SetUnhandledExceptionFilter（）</b>函数添加异常处理程序。 如果在应用程序操作期间发生任何异常，则只需重新启动即可。 <br><br> 添加异常处理程序后，木马会收集有关受感染系统的信息： <br><br><ol><li> 作业系统版本 </li><li> 操作系统内部版本号 </li><li> 服务包版本 </li><li> 系统容量 </li><li> 操作系统类型 </li></ol><br> 该应用程序创建一个安全描述符： <b>D：（A ;; GA ;;; WD）（A ;; GA ;;; AN）S：（ML ;; NW ;;; S-1-16-0）</b> ，然后分配内存在木马运行期间记录信息。 记录的字符串示例（使用IDA中的脚本获得字符串）： <br><br><ol><li>  E | C | IN | INS | ISF | CP％u </li><li>  I | C | IN | INT | CI |  ％u </li><li>  W | C | IN | INT | CI | CRLL </li></ol><br>  IcedID可以采用多个参数。 其中包括： <br><br><ul><li>  <b>--svc =</b> -通过名称为<b>IcedID_reg（“ * p *”）</b>的键将参数中的字符串保存到注册表中，其中<b>IcedID_reg（str）</b>是从字符串<b>str</b>生成键名的功能（生成注册表键名的算法将在后面说明）。该特洛伊木马访问名称为<b>Global \ &lt;％random string％&gt;的事件</b> 。 出现错误时，漫游器会使用<b>/ w =</b>参数创建其进程的副本。 如果无法完成，则会在注册表中创建一个值： </li></ul><br><blockquote>  HKEY_CURRENT_USER \ Software \ Microsoft \ Windows \ CurrentVersion \ Run \ &lt;％由字母[az]％中的随机字符组成的长度为9的字符串 </blockquote><br> 从而确保系统的持久性。 该密钥用于首次启动该木马。 <br><br><ul><li>  <b>/ u-</b>默认情况下，恶意软件会尝试以域管理员的身份运行自身（使用<b>runas</b>程序）。 如果存在此标志，该木马将不执行此操作，仅在目录<b>C中</b>创建其副本<b>：\ Users \ &lt;％username％&gt; \ AppData \ Local \ &lt;％字符串，长度为9，由字母[az]％&gt;的随机字符组成，</b>名称为<b>&lt;％由字母[az]％&gt;。exe的随机字符组成的长度为9的字符串</b> ，并将路径写入注册表中的文件，从而确保了系统的持久性。 </li></ul><br><blockquote>  HKEY_CURRENT_USER \ Software \ Microsoft \ Windows \ CurrentVersion \ Run \ &lt;％由字母[az]％中的随机字符组成的长度为9的字符串 </blockquote><br> 似乎在更新银行家时使用了此密钥。 在重新启动之前，特洛伊木马“入睡”了5秒钟。 <br><br><ul><li>  <b>/ c-</b>在执行恶意功能之前，木马“入睡” 5秒钟 </li><li>  <b>/ w =</b> -通过名为<b>IcedID_reg（“ * p *”）的</b>键将参数中的字符串保存到注册表 </li></ul><br> 处理完参数后，应用程序访问注册表并获取包含CnC地址以及Web注入的动态配置数据。 以下各节介绍了在注册表中存储数据的格式。 <br><br> 访问注册表后，程序将创建一个线程，该线程每5或10分钟一次（取决于内部标志）与CnC联系以接收命令。 值得注意的是，两次CnC调用之间“入睡”机器人的非标准机制：开发人员没有使用标准的<b>Sleep（）</b>函数，而是在非信号状态下创建了一个事件，并且在不将其转换为信号状态的情况下，调用了<b>WaitForSingleObject（）</b>函数。  CnC呼叫流程创建功能： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vu/bg/1_/vubg1_zk61_dw8auvz80yi1lhxc.png" alt="图片"></div><br>  IcedID中的<b>Sleep（）</b>函数的类似物： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yd/if/f3/ydiff39eemw9rymerxmj82rintw.png" alt="图片"></div><br> 长时间访问服务器以及非标准的“睡眠功能”很可能旨在抵消分析。 <br><br>  SSL用于隐藏服务器与应用程序之间的流量。 <br><br> 启动线程后，僵尸程序会“提升”本地计算机上的代理服务器，以处理受感染计算机上的流量。 <br><br> 服务器和受感染设备的通信协议将在以下各节中讨论。 但是，值得注意的是，服务器命令中的恶意软件可以更新配置，启动和停止VNC服务器，执行cmd.exe命令，下载文件。 <br><br><h3>  IcedID与CnC服务器之间的交互 </h3><br>  CnC地址列表以加密形式存储在银行家的正文中，以及以动态配置形式存储在注册表中。 服务器和木马之间的交互是使用HTTPS协议进行的。 使用POST请求将数据发送到服务器，使用GET接收数据。 <br><br> 服务器查询字符串如下： <br><br><blockquote>  &lt;％CnC％&gt; /forum/viewtopic.php?a=&lt;%Integer%&gt;&amp;b=&lt;%长整数％&gt;＆d = &lt;％Integer％&gt;＆e = &lt;％Integer％&gt;＆&lt;％其他数据％&gt; </blockquote><br> 栏位值： <br><br><ul><li>  -请求类型，此字段可以采用以下值： <br><div class="scrollable-table"><table><tbody><tr><th>  <nobr>价值</nobr> </th><th> 动作片 </th></tr><tr><td>  0.1 </td><td> 发送有关受感染机器的信息 </td></tr><tr><td>  2,3 </td><td> 将其他数据发送到服务器 </td></tr><tr><td>  4 </td><td> 获取最新版本的动态配置，并使用名称为<b>IcedID_reg（“ * cfg1”）</b>的项将其放入注册表中 <br></td></tr><tr><td>  5 </td><td> 获取最新版本的动态配置，并使用名称为<b>IcedID_reg（“ * cfg0”）</b>的项将其放入注册表中 <br></td></tr><tr><td>  6 </td><td> 获取最新版本的动态配置，并使用名称为<b>IcedID_reg（“ * rtd”）</b> （CnC地址）的项将其放入注册表中 <br></td></tr><tr><td>  7 </td><td> 获取最新版本的VNC模块 </td></tr><tr><td>  8 </td><td> 获取最新的机器人版本 </td></tr></tbody></table></div></li><li>  b-机器人ID </li><li>  d-标志 </li><li>  e-常量，直接位于机器人代码中 </li></ul><br> 此外，字段值取决于字段“ a”。 如果为0或1，则查询如下所示： <br><br><blockquote>  POST /forum/viewtopic.php?a=&lt;%0或1％&gt;＆b = &lt;％BotID％&gt;＆d = &lt;％Integer％&gt;＆e = &lt;％常量％&gt;＆f = &lt;％Cfg1 Checksum％&gt;＆g = &lt;％ Cfg0校验和％&gt;＆h = &lt;％Rtd校验和％&gt;＆r = &lt;％VNC校验和％&gt;＆i = &lt;％请求时间％&gt; HTTP / 1.1 <br> 连接方式：关闭 <br> 内容类型：应用程序/ x-www-form-urlencoded <br> 内容长度： </blockquote><br> 请求正文包含有关受感染机器的信息。 信息以以下形式提供： <br><br><blockquote>  k = &lt;％String％&gt;＆l = &lt;％String％&gt;％j = &lt;％Integer％&gt;＆n = &lt;％Integer％&gt;＆m = &lt;％String％&gt; </blockquote><br> 其中： <br><br><ul><li>  k-UNICODE中的计算机名称 </li><li>  l-UNICODE中的域成员 </li><li>  m-系统信息： <br><ol><li> 作业系统版本 </li><li> 操作系统内部版本号 </li><li> 服务包版本 </li><li> 系统容量 </li><li> 操作系统类型 </li></ol></li></ul><br> 如果字段是2或3，则查询如下所示： <br><br><blockquote>  POST /forum/viewtopic.php?a=&lt;%3或2％&gt;＆b = &lt;％BotID％&gt;＆d = &lt;％Integer％&gt;＆e = &lt;％Constant％&gt; HTTP / 1.1 <br> 连接方式：关闭 <br> 内容类型：应用程序/八位字节流 <br> 内容长度： </blockquote><br> 否则，请求如下： <br><br><blockquote>  GET /forum/viewtopic.php?a=&lt;%4-8%&gt;&amp;b=&lt;%BotID%&gt;&amp;d=&lt;%Integer%&gt;&amp;e=&lt;%Constant%&gt;&amp;o=&lt;%Object checksum％&gt; <br>  HTTP / 1.1 <br> 连接方式：关闭 <br><br> 内容类型：应用程序/ x-www-form-urlencoded <br> 内容长度： </blockquote><br> 下图显示了查询示例。 访问服务器时的包头： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4t/yj/cw/4tyjcwlgccfqrer5fkblehqaza0.png" alt="图片"></div><br> 邮件正文： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nx/iu/7r/nxiu7r72nmfovwhqcz85fdjwoga.png" alt="图片"></div><br> 该木马可以从服务器接收命令。 命令以整数值表示。 所有命令都以字符串形式到达机器人，其参数由符号“;”分隔。 该程序可以处理23个命令： <br><br><div class="scrollable-table"><table><tbody><tr><th>  <nobr>团队</nobr> </th><th> 价值 </th></tr><tr><td>  0 </td><td> 不执行任何操作（可能会在将来添加功能） <br></td></tr><tr><td>  1个 </td><td> 使用名为<b>IcedID_reg（“ * cfg0”）</b>的注册表项更新值 <br></td></tr><tr><td>  2 </td><td> 使用名为<b>IcedID_reg（“ * cfg1”）</b>的注册表项更新值 <br></td></tr><tr><td>  3 </td><td> 用名称<b>IcedID_reg（“ * rtd”）</b>更新注册表项的值 <br></td></tr><tr><td>  4 </td><td> 下载文件，保存到AppData目录并执行 <br></td></tr><tr><td>  5 </td><td> 运行程序，名称和开始参数作为参数 <br></td></tr><tr><td>  6 </td><td> 获取有关正在运行的进程的信息，包括：PID和进程名称 <br></td></tr><tr><td>  7 </td><td> 使用信息作为功能参数关闭计算机： <br>  <b>SHTDN_REASON_FLAG_PLANNED</b> <b><br></b>  <b>SHTDN_REASON_MINOR_INSTALLATION</b> <b><br></b>  <b>SHTDN_REASON_MAJOR_APPLICATION</b> <br></td></tr><tr><td>  8 </td><td> 将值写入注册表（名称是根据以下描述的算法生成的） <br></td></tr><tr><td>  9 </td><td> 读取注册表中的值（名称是根据以下描述的算法生成的） <br></td></tr><tr><td>  10 </td><td> 从注册表中删除密钥（名称是根据以下描述的算法生成的） <br></td></tr><tr><td>  11 </td><td> 运行高级模块以处理来自服务器的命令 <br></td></tr><tr><td>  12 </td><td> 停止扩展模块以处理来自服务器的命令 <br></td></tr><tr><td>  13 </td><td> 更新VNC模块（位于％TEMP％目录中） <br></td></tr><tr><td>  14 </td><td> 获取受感染设备桌面上的文件列表 <br></td></tr><tr><td>  15 </td><td> 下载文件，将其保存为名称<b>&lt;％随机字符字符串％&gt;。Tmp</b>并使用密钥<b>\ u</b>运行它。 看来此命令对于更新受感染设备上的bot版本很有必要。 <br></td></tr><tr><td>  16 </td><td> 删除名称包含字符串（作为参数）的文件 <br></td></tr><tr><td>  17 </td><td> 启动网络分发模块。 通过使用LDAP协议将漫游器复制并启动到另一台设备上的Windows目录中来进行分发。 <br></td></tr><tr><td>  18岁 </td><td> 获取机器人日志数据 <br></td></tr><tr><td>  19 </td><td> 将服务器访问事件设置为警报状态 <br></td></tr><tr><td>  20 </td><td> 获取以下应用程序的帐户信息：Windows Live Mail，Windows Mail，RimArts，Poco Systems Inc，IncrediMail，The Bat！ 和展望 <br></td></tr><tr><td>  21 </td><td> 更改服务器调用之间的间隔 <br></td></tr><tr><td>  22 </td><td> 从环境变量获取路径，下载文件并沿该路径保存 <br></td></tr><tr><td>  21 </td><td> 将文件上传到AppData目录，并使用参数<b>/ t = &lt;特制事件％的句柄&gt; / f = &lt;特制事件％的句柄2&gt;运行它</b> 。 将事件转换为警报状态后，将从AppData目录中删除下载的文件 <br></td></tr></tbody></table></div><br> 如果命令成功执行，木马会将字符串“ True”发送到服务器，否则将“ False”发送给服务器。 <br><br> 在接收到启动高级命令模块的命令的情况下，应用程序将两个字节发送到服务器，然后等待响应。 从服务器收到的第一个字节对应于表中的扩展命令： <br><br><div class="scrollable-table"><table><tbody><tr><th>  <nobr>团队</nobr> </th><th> 价值 </th></tr><tr><td>  5 </td><td> 启动一个在受感染计算机上执行cmd.exe命令的线程。 <br></td></tr><tr><td>  6 </td><td> 启动VNC服务器。 在所研究的案例中，VNC服务器被提供为DLL库，该库具有类似的字符串加密算法。 <br></td></tr><tr><td>  7 </td><td> 从上表执行命令。 为了接收正常命令，该木马会向服务器发送两个字符，并通过接受命令bot来通知服务器已准备就绪。 <br></td></tr></tbody></table></div><br> 可以通过两种可能的方式启动VNC服务器（取决于内部标志）： <br><br><ol><li> 将<b>CreateProcessA（）</b>函数与<b>rundll32.exe kernel32</b>参数一起使用<b>，Sleep -s &lt;％param％&gt;</b> </li><li> 通过<b>svchost.exe -s &lt;％param％&gt;</b>参数使用<b>CreateProcessA（）</b>函数 </li></ol><br> 其中<b>&lt;％param％&gt;</b>是字符串表示形式中的16个字节，如下所示： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4o/st/i2/4osti2buinqlg7gegp8decyoiio.png" alt="图片"></div><br> 启动后，VNC模块立即检查<b>-s开关</b>的存在，然后读取传递的参数并检查条件： <br><pre><code class="cpp hljs">paramValue[<span class="hljs-number"><span class="hljs-number">0</span></span>] == paramValue[<span class="hljs-number"><span class="hljs-number">1</span></span>] ^ (paramValue[<span class="hljs-number"><span class="hljs-number">3</span></span>] | (paramValue[<span class="hljs-number"><span class="hljs-number">2</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">16</span></span>))</code> </pre> <br> 并使用<b>DuplicateHandle（）</b>函数创建套接字句柄的副本，以便与服务器进行进一步的交互。 <br><br>  <b>CreateProcessA（）</b>函数的<b>StartupInfo</b>参数包含专门生成的Desktop'a的名称： <b>Default &lt;％flag％&gt;</b> 。 同样，在函数调用之前，VNC模块的地址位于<b>ProcessInformation</b>参数中： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/na/fd/zu/nafdzutb3bptvxfmbis9ver33v8.png" alt="图片"></div><br><br> 从列表中可以看出，IcedID具有广泛的功能，可以完全控制受感染的计算机。 即使操作员遇到缺少任何功能的问题，他也可以在木马的帮助下简单地下载另一个程序并执行分配给它的任务。 例如，在2017年12月，我们记录了该银行家的TrickBot分布。 <br><br><h3> 配置信息 </h3><br><h4> 注册表项名称的生成 </h4><br> 程序从服务器收到的所有配置数据都存储在受感染设备的注册表中（VNC模块除外，VNC模块以<b>tmp％0.8X01.dat</b>格式存储在％TEMP％目录中）。 <br><br> 使用以下函数计算存储我们感兴趣的配置数据的注册表项的名称： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/v5/bf/nj/v5bfnjuhkwpc3koekqfmclrrffk.png" alt="图片"></div><br> 从图中可以看到，键名是来自两个变量<b>str</b>和<b>computerSeed</b>的MD5哈希值。 注册表变量中存储哪种类型的数据取决于第一个变量的值。 例如，变量值为<b>* cfg0</b>或<b>* cfg1</b> <b>，</b>则注册表项存储Web注入，值为<b>* rtd时，</b>注册表项存储一个CnC列表。 <br><br>  <b>computerSeed</b>是用户唯一的变量。 它是根据用户的SID计算的。 该<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">脚本</a>提供了此变量计算的python版本。 <br><br> 注册表中配置条目的完整路径： <br><br><blockquote>  HKEY_CLASSES_ROOT \ CLSID \ &lt;％MD5值，格式为：{％0.8X-％0.4X-％0.4X-％0.4X-％0.4X％0.8X}％&gt; <br></blockquote><br> 上面描述的算法恰好是用于生成名称<b>IcedID_reg（）</b>的算法，上面已经重复提到了该算法。 <br><br> 我们发现以下字符串值与生成对银行家重要的信息的注册表名称有关： <br><br><ul><li>  <b>* cfg0-</b>包含网络注入的常见列表 </li><li>  <b>* cfg1-</b>包含地址和字符串列表，以完全窃取页面数据 </li><li>  <b>* rtd</b> -CnC地址列表 </li><li>  <b>* bc *</b> -通知模块状态，以处理来自服务器的扩展命令。 如果此条目在注册表中-模块正在运行 </li><li>  <b>* p *</b> -使用<b>--svc =</b>和<b>/ w =</b>键保存启动参数 </li></ul><br><h4> 动态配置文件的存储结构 </h4><br> 动态配置以加密形式存储在注册表中。 位于TEMP％目录中的VNC服务器以相同的方式加密。 <br><br> 两种算法用于数据加密：专有的Trojan算法和RC4。 解密算法方案： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/j8/2j/g8/j82jg8lcmeg3l9tv9cmge5erbbs.png" alt="图片"></div><br> 让我们从理论转向实践。 从注册表读取后的初始加密数据： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/q5/2f/7r/q52f7rrl9zsv9wqv9lf6anr9-hq.png" alt="图片"></div><br> 收到数据后，恶意软件会使用自己的算法对其进行解密： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ji/fx/ik/jifxik3og5ezrfp9wufshxhbc5k.png" alt="图片"></div><br> 再一次，我们遇到了<b>make_seed（）</b>函数！ <br><br> 解密后，我们拥有了（注意地址-它在内存的同一部分被解密）： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ok/-1/ek/ok-1ek0zschromjam2tbv2am-um.png" alt="图片"></div><br> 在内存中进行第二次解密后，我们将看到以下内容： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kx/ct/nb/kxctnbronnbv-hovhydbmqb9wx4.png" alt="图片"></div><br> 数据解压缩并解析后。 值得注意的是，在释放数据之前，将使用RC4对数据进行回加密-防止对应用程序进行动态分析。 <br><br> 其他数据结构取决于配置数据的类型。 例如，带有<b>rtd</b>前缀的配置数据以以下格式存储： <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CNCStruct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> signedMD5sum[<span class="hljs-number"><span class="hljs-number">128</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> checksum; BStrings cnc[N]; } CNCStruct; <span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BStrings</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> length; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> str[length]; } BStrings;</code> </pre><br> 一项研究中的CnC地址列表： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ne/xi/ta/nexitapjnsiyirmq7heoidb2jcw.png" alt="图片"></div><br> 僵尸程序在从接收到的列表访问CnC地址之前，会检查数字签名。 验证签名的公共密钥以加密形式存储在机器人主体中。 在签名验证过程之后，应用程序首先用随机数据然后用零“覆盖”公钥： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/oa/ns/tt/oansttaenay3ehss5praybpcenw.png" alt="图片"></div><br> 带有<b>cfg</b>前缀的配置以以下格式存储： <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CfgStruct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> checksum; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> elements_count; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> config[]; } CfgStruct;</code> </pre> <br> 在研究的案例中，我们看到了以下数据： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/o3/wj/qp/o3wjqphnlymrn0yeydqqsxu8-ca.png" alt="图片"></div><br> 数据以唯一的二进制格式存储，稍后将进行讨论。 <br><br> 您可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">脚本中</a>看到用于生成注册表项和解密配置数据的算法。 <br><br><h4> 配置数据解析算法 </h4><br> 解密数据后，程序将解析它们并以链接列表的形式保存它们，该列表随后将参与受感染设备（MITB）上流量的分析。 首先，将数据分为具有以下结构的块： <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseBlock</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> size; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> type; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> global_flag; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> data[size - <span class="hljs-number"><span class="hljs-number">6</span></span>]; } BaseBlock;</code> </pre> <br>  <b>数据</b>字段的结构取决于<b>类型</b>标志。 此结构中的标志指示在请求的URL /正文中找到字符串时会发生什么。 该字段可以采用以下值： <br><br><div class="scrollable-table"><table><tbody><tr><th>  <nobr>旗</nobr> </th><th> 价值 </th></tr><tr><td>  0x10 </td><td> 页面正文的部分替换，作为参数-必须在其间进行替换的标签以及替换正文的值 <br></td></tr><tr><td>  <nobr>0x11.0x13</nobr> </td><td> 页面主体的部分替换，作为参数-页面需要替换的部分，以及替换主体的值 <br></td></tr><tr><td>  0x12 </td><td> 全页正文替换 <br></td></tr><tr><td>  0x20 </td><td> 页面正文被盗。 作为参数-标签，在标签之间有一个感兴趣的页面部分 </td></tr><tr><td>  0x21 </td><td> 整页盗窃 </td></tr><tr><td>  0x22 </td><td> 页面主体完全被盗，主体保存在注册表中 </td></tr><tr><td>  0x2E </td><td> 在检测到的情况下，在页面正文中搜索带有标签0x40和0x41的行-盗窃页面正文 </td></tr><tr><td>  0x30 </td><td> 请求阻止 </td></tr><tr><td>  0x31 </td><td> 拍摄页面截图 </td></tr><tr><td>  <nobr>0x32,0x33</nobr> </td><td> 重定向到另一个页面（页面的路径是参数之一）。 此外，参数是字符串<b>&lt;％Registry Salt％&gt;＃&lt;％URL％&gt;</b> ，机器人访问<b>&lt;％URL％&gt;</b> ，从那里加载数据，然后使用键<b>IcedID_reg（&lt;％Registry Salt％&gt;）</b>将其保存到注册表中。 </td></tr><tr><td>  0x34 </td><td> 重定向到另一个页面（页面的路径是参数之一） </td></tr><tr><td>  <nobr>0x40,0x41</nobr> </td><td> 页面正文中的正文字符串 </td></tr><tr><td>  0x51 </td><td> 忽略页面 </td></tr><tr><td>  0x60 </td><td> 将变量的值保存到注册表中（根据命令的结果将页面正文替换为“ True”或“ False”，该名称是根据上述算法生成的） </td></tr><tr><td>  0x61 </td><td> 从注册表中演示一个变量（名称是根据上述算法生成的） </td></tr><tr><td>  0x62 </td><td> 从注册表中删除一个变量（根据命令的结果将页面正文替换为“ True”或“ False”，该名称是根据上述算法生成的） </td></tr><tr><td>  0x63 </td><td> 运行高级模块以处理来自服务器的命令（根据命令的结果将页面正文替换为“ True”或“ False”） </td></tr><tr><td>  0x64 </td><td> 将页面正文保存到机器人的内存中（根据命令的结果，将页面正文替换为“ True”或“ False”） </td></tr></tbody></table></div> 如果<b>类型</b>为0x40或0x41，则<b>数据</b>字段的结构： <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ConfigBlock</span></span></span><span class="hljs-class"> {</span></span> BStrings patterns[N]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>); } ConfigBlock;</code> </pre> <br> 否则，字段结构为： <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseBlock</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> typeSizeStr; <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> urlStr; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> flagSize; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> flag[flagSize]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> firstOptStrSize; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> firstOptStr[firstOptStrSize]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> secondOptStrSize; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> secondOptStr[secondOptStrSize]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> thirdOptStrSize; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> thirdOptStr[thirdOptStrSize]; } BaseBlock;</code> </pre> <br> 让我们仔细看一下示例块之一： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/k2/um/x_/k2umx_oc-ftptuundim8rft1yaw.png" alt="图片"></div><br> 首先，请注意“ Config block common information”块中的“ Config block type”字段。 它是0x11，这意味着当用户加载URL <b>服从</b>正则表达式规则<b>^ [^ =] * \ / wcmfd \ / wcmpw \ / CustomerLogin $的页面时</b> ，行<b>&lt;body</b> （第二个参数）替换为行<b>&lt;正文样式=“显示：无；”</b>  （第三个论点）。 <br><br> 在应用程序内存中，为每种类型创建一个链表。 下图以IDA Pro屏幕的形式显示了链表的解析算法。 您可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">此处</a>查看用于配置数据解析的Python脚本。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/e9/5m/ke/e95mkeu6eqisfys7fnhe63fqvtg.png" alt="图片"></div><br><h3>  CnC信息 </h3><br> 在监视IcedID的发展几个月后，我们发现了该木马包含在CnC部分的动态配置列表中的许多域。 我们将以通信的形式代表域（进行注册的电子邮件→域）： <br><div class="scrollable-table"><table><tbody><tr><th>  <nobr>邮寄</nobr> </th><th> 域 </th></tr><tr><td>  davidphugley@jourrapide.com </td><td>  percalabia.com <br>  borrespons.com <br>  divorough.com <br>  eyrannon.com <br>  britically.com <br></td></tr><tr><td>  joshuastaube@dayrep.com </td><td>  manismay.com <br>  deterhood.com <br>  marrivate.com <br>  greatoric.com <br>  phonetarif.com <br></td></tr><tr><td> 辛西娅·泰勒@ grr.la </td><td>  binncu.net </td></tr><tr><td>  PatriceAAdams@grr.la </td><td>  arcadyflyff.com </td></tr><tr><td>  LindaJRowan@dayrep.com </td><td>  yutlitsi.com </td></tr><tr><td>  SeanHumphreys@pokemail.net </td><td>  urnachay.com </td></tr><tr><td>  RuthFThigpen@pokemail.net </td><td>  oksigur.net </td></tr><tr><td>  FlorenceTButler@pokemail.net </td><td>  rfisoty.com </td></tr><tr><td>  FreidaDDelgado@pokemail.net </td><td>  urnisim.net </td></tr><tr><td> 蒂娜·霍布森（TinaLHobson@grr.la） </td><td>  cupicratings.com </td></tr><tr><td>  ElisaRTucker@pokemail.net </td><td>  freegameshacks.net </td></tr><tr><td>  DaleKMontes@pokemail.net </td><td>  gordondeen.net </td></tr><tr><td>  patrickggutierez@dayrep.com </td><td> 贫民窟.com <br>  dismissey.com <br>  euphratt.com <br>  detrole.com <br></td></tr><tr><td>  JustineRBoatner@pokemail.net </td><td>  lumpyve.com </td></tr><tr><td> 马修APerkins@grr.la </td><td>  gooblesooq.com <br>  fzlajsf.net <br></td></tr><tr><td> 约瑟夫LSmith@grr.la </td><td>  newpctoday.com <br>  triodgt.com <br></td></tr><tr><td>  DominicNDecker@pokemail.net </td><td>  onsunga.net </td></tr><tr><td>  MarcellaBCraighead@pokemail.net </td><td>  rybatas.com </td></tr><tr><td>  KellyJMaldonado@grr.la </td><td>  netocraze.net <br>  irtazin.net <br></td></tr></tbody></table></div><br> 现在，让我们仔细看看已注册域的用户： <br><br><div class="spoiler">  <b class="spoiler_title">注册人信息</b> <div class="spoiler_text"> 电子邮件<b>davidphugley@jourrapide.com</b> ： <br><br><ul><li> 注册商：PDR Ltd.  d / b / a PublicDomainRegistry.com </li><li> 姓名：David P. Hugley（注册人，管理员，技术人员） </li><li> 街道：2453圆桌驱动器（注册人，管理员，技术人员） </li><li> 城市：汉密尔顿（注册人，管理员，技术人员） </li><li> 州：俄亥俄州（注册人，管理员，技术人员） </li><li> 邮政：45011（注册人，管理人员，技术人员） </li><li> 国家/地区：美国（注册人，管理员，技术人员） </li><li> 电话：15138878784（注册人，管理员，技术人员） </li></ul><br> 电子邮件<b>joshuastaube@dayrep.com</b> ： <br><br><ul><li> 注册商：PDR Ltd.  d / b / a PublicDomainRegistry.com </li><li> 姓名：Joshua S. Taube（注册人，管理员，技术人员） </li><li> 组织机构： </li><li> 街道：2173 Kyle Street（注册人，管理员，技术人员） </li><li> 城市：Hay Springs（注册人，管理人员，技术人员） </li><li> 州：内华达州（注册人，管理员，技术人员） </li><li> 邮政：69347（注册人，管理员，技术人员） </li><li> 国家/地区：美国（注册人，管理员，技术人员） </li><li> 电话：13086385612（注册人，管理员，技术人员） </li></ul><br> 电子邮件<b>CynthiaTHeller@grr.la</b> ： <br><br><ul><li> 注册商：Eranet International Limited </li><li> 名称：辛西娅·海勒（Cynthia Heller）（注册人，管理员，账单，技术人员） </li><li> 组织机构： </li><li> 街道：田纳西大道396号（注册人，管理员，账单，技术人员） </li><li> 城市：Southfield（注册人，管理员，账单，技术人员） </li><li> 州：MX（注册人，管理员，帐单，技术人员） </li><li> 邮政：48034（注册人，管理员，账单，技术人员） </li><li> 国家/地区：美国（注册人，管理员，帐单，技术人员） </li><li> 电话：12482469621（注册人，管理员，计费，技术人员） </li></ul><br> 电子邮件<b>PatriceAAdams@grr.la</b> ： <br><br><ul><li> 注册商：Eranet International Limited </li><li> 姓名：Patrice Adams（注册人，管理员，账单，技术人员） </li><li> 组织机构 </li><li> 街：3997 Marietta街（注册人，管理员，计费，技术人员） </li><li> 城市：Cazadero（注册人，管理员，计费，技术人员） </li><li> 州：JL（注册人，管理员，帐单，技术人员） </li><li> 邮政：95421（注册人，管理员，账单，技术人员） </li><li> 国家/地区：美国（注册人，管理员，帐单，技术人员） </li><li> 电话：17076322681（注册人，管理员，帐单，技术人员） </li></ul><br> 电子邮件<b>LindaJRowan@dayrep.com</b> ： <br><br><ul><li> 注册商：Eranet International Limited </li><li> 姓名：Linda Rowan（注册人，管理员，账单，技术人员） </li><li> 组织机构： </li><li> 街：1908 Luke Lane（注册人，管理员，账单，技术人员） </li><li> 城市：麋鹿城（注册人，管理员，账单，技术人员） </li><li> 州：EK（注册人，管理员，帐单，技术人员） </li><li> 邮政：73644（注册人，管理员，账单，技术人员） </li><li> 国家/地区：美国（注册人，管理员，帐单，技术人员） </li><li> 电话：15802259140（注册人，管理员，帐单，技术人员） </li></ul><br> 电子邮件<b>SeanHumphreys@pokemail.net</b> ： <br><br><ul><li> 注册商：Eranet International Limited </li><li> 姓名：Sean Humphreys（注册人，管理员，账单，技术人员） </li><li> 组织机构： </li><li> 街道：4661 Kincheloe Road（注册人，管理员，账单，技术人员） </li><li> 城市：波特兰（注册人，管理员，账单，技术人员） </li><li> 州：EL（注册人，管理员，账单，技术人员） </li><li> 邮政：97205（注册人，管理员，帐单，技术人员） </li><li> 国家/地区：美国（注册人，管理员，帐单，技术人员） </li><li> 电话：16384273711（注册人，管理员，帐单，技术人员） </li></ul><br> 电子邮件<b>RuthFThigpen@pokemail.net</b> ： <br><br><ul><li> 注册商：Eranet International Limited </li><li> 姓名：Ruth Thigpen（注册人，管理员，账单，技术人员） </li><li> 组织机构 </li><li> 大街：迈克尔街765号（注册人，管理员，计费，技术人员） </li><li> 城市：休斯敦（注册人，管理员，账单，技术人员） </li><li> 州：DK（注册人，管理员，帐单，技术人员） </li><li> 邮政：77021（注册人，管理员，账单，技术人员） </li><li> 国家/地区：美国（注册人，管理员，帐单，技术人员） </li><li> 电话：17137485876（注册人，管理员，帐单，技术人员） </li></ul><br> 电子邮件<b>FlorenceTButler@pokemail.net</b> ： <br><br><ul><li> 注册商：Eranet International Limited </li><li> 姓名：Florence Butler（注册人，管理员，计费，技术人员） </li><li> 组织机构： </li><li> 街道：4554 Par Drive（注册，管理，计费，技术） </li><li> 城市：Lompoc（注册人，管理员，计费，技术人员） </li><li> 州：JL（注册人，管理员，帐单，技术人员） </li><li> 邮政：93436（注册人，管理员，计费，技术人员） </li><li> 国家/地区：美国（注册人，管理员，帐单，技术人员） </li><li> 电话：198058660048（注册人，管理员，帐单，技术人员） </li></ul><br> 电子邮件<b>FreidaDDelgado@pokemail.net</b> ： <br><br><ul><li> 注册商：Eranet International Limited </li><li> 姓名：Freida Delgado（注册人，管理员，账单，技术人员） </li><li> 组织机构： </li><li> 大街：4439 Burning Memory Lane（注册者，管理员，账单，技术人员） </li><li> 城市：费城（注册人，管理员，账单，技术人员） </li><li> 州：BX（注册人，管理员，帐单，技术人员） </li><li> 邮政：19115（注册人，管理员，账单，技术人员） </li><li> 国家/地区：美国（注册人，管理员，帐单，技术人员） </li><li> 电话：12153306416（注册人，管理员，帐单，技术人员） </li></ul><br> 电子邮件<b>TinaLHobson@grr.la</b> ： <br><br><ul><li> 注册商：Eranet International Limited </li><li> 姓名：蒂娜·霍布森（Tina Hobson）（注册人，管理员，计费，技术人员） </li><li> 组织机构： </li><li> 街道：3960 Woodridge Lane（注册人，管理员，账单，技术人员） </li><li> 城市：孟菲斯（注册人，管理员，账单，技术人员） </li><li> 州：TN（注册人，管理员，账单，技术人员） </li><li> 邮政：38110（注册人，管理员，账单，技术人员） </li><li> 国家/地区：美国（注册人，管理员，帐单，技术人员） </li><li> 电话：19012994734（注册人，管理员，帐单，技术人员） </li></ul><br> 电子邮件<b>ElisaRTucker@pokemail.net</b> ： <br><br><ul><li> 注册商：Eranet International Limited </li><li> 姓名：Elisa Tucker（注册人，管理员，账单，技术人员） </li><li> 组织机构 </li><li> 街道：3316 Corbin Branch Road（注册，管理，计费，技术） </li><li> 城市：约翰逊城（注册人，管理员，账单，技术人员） </li><li> 州：TN（注册人，管理员，账单，技术人员） </li><li> 邮政：37601（注册人，管理员，账单，技术人员） </li><li> 国家/地区：美国（注册人，管理员，帐单，技术人员） </li><li> 电话：14234332211（注册人，管理员，计费，技术人员） </li></ul><br> 电子邮件<b>DaleKMontes@pokemail.net</b> ： <br><br><ul><li> 注册商：Eranet International Limited </li><li> 姓名：Dale Montes（注册人，管理员，账单，技术人员） </li><li> 组织机构： </li><li> 大街：诺曼大街2719号（注册人，管理员，账单，技术人员） </li><li> 城市：洛杉矶（注册人，管理员，计费，技术人员） </li><li> 州：JL（注册人，管理员，帐单，技术人员） </li><li> 邮政：90008（注册人，管理员，账单，技术人员） </li><li> 国家/地区：美国（注册人，管理员，帐单，技术人员） </li><li> 电话：13232919311（注册人，管理员，计费，技术人员） </li></ul><br> 电子邮件<b>patrickggutierez@dayrep.com</b> ： <br><br><ul><li> 注册商：PDR Ltd.  d / b / a PublicDomainRegistry.com </li><li> 姓名：Patrick G. Gutierez（注册人，管理员，技术人员） </li><li> 组织机构： </li><li> 街：1146 Mount Olive Road（注册人，管理人员，技术人员） </li><li> 城市：亚特兰大（注册人，管理员，技术人员） </li><li> 州：佐治亚州（注册人，管理员，技术人员） </li><li> 邮政：30328（注册，管理，技术） </li><li> 国家/地区：美国（注册人，管理员，技术人员） </li><li> 电话：16789874672（注册人，管理员，技术人员） </li></ul><br> 电子邮件<b>JustineRBoatner@pokemail.net</b> ： <br><br><ul><li> 注册商：Eranet International Limited </li><li> 姓名：Justine Boatner（注册人，管理员，账单，技术人员） </li><li> 组织机构： </li><li> 街道：2875 Kemper Lane（注册人，管理员，计费，技术人员） </li><li> 城市：Kearns（注册人，管理员，计费，技术人员） </li><li> 州：YT（注册人，管理员，帐单，技术人员） </li><li> 邮政：84118（注册人，管理员，账单，技术人员） </li><li> 国家/地区：美国（注册人，管理员，帐单，技术人员） </li><li> 电话：18019026902（注册人，管理员，帐单，技术人员） </li></ul><br> 电子邮件<b>MatthewAPerkins@grr.la</b> ： <br><br><ul><li> 注册商：Eranet International Limited </li><li> 姓名：Matthew Perkins（注册人，管理员，账单，技术人员） </li><li> 组织机构： </li><li> 街道：蝗虫街2507号（注册人，管理员，账单，技术人员） </li><li> 城市：Ellaville（注册人，管理员，计费，技术人员） </li><li> 州：QZ（注册人，管理员，账单，技术人员） </li><li> 邮政：31806（注册人，管理员，账单，技术人员） </li><li> 国家/地区：美国（注册人，管理员，帐单，技术人员） </li><li> 电话：12299379022（注册人，管理员，帐单，技术人员） </li></ul><br> 电子邮件<b>JosephLSmith@grr.la</b> ： <br><br><ul><li> 注册商：Eranet International Limited </li><li> 姓名：Joseph Smith（注册人，管理员，账单，技术人员） </li><li> 组织机构： </li><li> 街道：2808 Ruckman Road（注册人，管理员，计费，技术人员） </li><li> 城市：俄克拉荷马城（注册人，管理员，账单，技术人员） </li><li> 州：EK（注册人，管理员，帐单，技术人员） </li><li> 邮政：73102（注册人，管理员，账单，技术人员） </li><li> 国家/地区：美国（注册人，管理员，帐单，技术人员） </li><li> 电话：14058506091（注册人，管理员，账单，技术人员） </li></ul><br> 电子邮件<b>DominicNDecker@pokemail.net</b> ： <br><br><ul><li> 注册商：Eranet International Limited </li><li> 姓名：Dominic Decker（注册人，管理员，账单，技术人员） </li><li> 组织机构： </li><li> 街：1169 Golden Ridge Road（注册人，管理员，账单，技术人员） </li><li> 城市：Gloversville（注册人，管理员，计费，技术人员） </li><li> 州：纽约州（注册人，管理员，账单，技术人员） </li><li> 邮政：12078（注册人，管理员，账单，技术人员） </li><li> 国家/地区：美国（注册人，管理员，帐单，技术人员） </li><li> 电话：15187485876（注册人，管理员，帐单，技术人员） </li></ul><br> 电子邮件<b>MarcellaBCraighead@pokemail.net</b> ： <br><br><ul><li> 注册商：Eranet International Limited </li><li> 姓名：Marcella Craighead（注册人，管理员，账单，技术人员） </li><li> 组织机构： </li><li> 街道：1659 Lilac Lane（注册人，管理人，计费人，技术人员） </li><li> 城市：萨凡纳（注册人，管理员，账单，技术人员） </li><li> 州：QZ（注册人，管理员，账单，技术人员） </li><li> 邮政：31401（注册，管理，计费，技术） </li><li> 国家/地区：美国（注册人，管理员，帐单，技术人员） </li><li> 电话：19125956971（注册人，管理员，帐单，技术人员） </li></ul><br> 电子邮件<b>KellyJMaldonado@grr.la</b> ： <br><br><ul><li> 注册商：Eranet International Limited </li><li> 姓名：Kelly Maldonado（注册人，管理员，账单，技术人员） </li><li> 机构：不适用 </li><li> 大街：Ben Street 4391（注册，管理，计费，技术） </li><li> 城市：奥尔巴尼（注册人，管理员，账单，技术人员） </li><li> 州：纽约州（注册人，管理员，账单，技术人员） </li><li> 邮政：12207（注册人，管理员，计费，技术人员） </li><li> 国家/地区：美国（注册人，管理员，帐单，技术人员） </li><li> 电话：15182623616（注册人，管理员，账单，技术人员） </li></ul><br></div></div><br> 最后，考虑更改域IP地址的时间顺序。 自2017年11月以来，所有IP地址均已添加到表中： <br><br><div class="spoiler">  <b class="spoiler_title">IP地址表</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><th> 域 </th><th> 知识产权 </th><th> 国别 </th><th> 首次在野外看到 </th></tr><tr><td>  gooblesooq.com </td><td>  185.127.26.227 </td><td>  RU </td><td>  2017/07/11 </td></tr><tr><td>  irtazin.net </td><td>  185.127.26.227 </td><td>  RU </td><td>  2017/07/11 </td></tr><tr><td>  netocraze.net </td><td>  185.5.251.33 </td><td>  RU </td><td>  2017/07/11 </td></tr><tr><td>  triodgt.com </td><td>  185.5.251.33 </td><td>  RU </td><td>  2017/07/11 </td></tr><tr><td>  newpctoday.com </td><td>  185.5.251.33 </td><td>  RU </td><td>  2017/07/11 </td></tr><tr><td>  fzlajsf.net </td><td>  185.127.26.227 </td><td>  RU </td><td>  2017年11月25日 </td></tr><tr><td>  netocraze.net </td><td>  185.48.56.139 </td><td>  Nl </td><td>  2017年11月27日 </td></tr><tr><td>  triodgt.com </td><td>  185.48.56.139 </td><td>  Nl </td><td>  2017年11月27日 </td></tr><tr><td>  newpctoday.com </td><td>  185.48.56.139 </td><td>  Nl </td><td>  2017年11月29日 </td></tr><tr><td>  netocraze.net </td><td>  185.22.65.17 </td><td>  KZ </td><td>  2017/12/1 </td></tr><tr><td>  triodgt.com </td><td>  185.22.65.17 </td><td>  KZ </td><td>  2017/12/1 </td></tr><tr><td>  newpctoday.com </td><td>  185.22.65.17 </td><td>  KZ </td><td>  2017/12/1 </td></tr><tr><td>  gordondeen.net </td><td>  185.127.26.227 </td><td>  RU </td><td>  2017/11/11 </td></tr><tr><td>  netocraze.net </td><td>  46.148.26.106 </td><td>  UA </td><td>  2017/11/11 </td></tr><tr><td>  arcadyflyff.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  2017/12/12 </td></tr><tr><td>  cupicratings.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  2017/12/12 </td></tr><tr><td>  freegameshacks.net </td><td>  185.127.26.227 </td><td>  RU </td><td>  2017/12/12 </td></tr><tr><td>  newpctoday.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  12/12/2018 </td></tr><tr><td>  onsunga.net </td><td>  107.150.99.20 </td><td>  CN </td><td>  2017/12/12 </td></tr><tr><td>  oksigur.net </td><td>  107.150.99.20 </td><td>  CN </td><td>  2017/12/12 </td></tr><tr><td>  rfisoty.com </td><td>  107.150.99.20 </td><td>  CN </td><td>  2017/12/12 </td></tr><tr><td>  rybatas.com </td><td>  107.150.99.20 </td><td>  CN </td><td>  2017/12/12 </td></tr><tr><td>  urnachay.com </td><td>  107.150.99.20 </td><td>  CN </td><td>  2017/12/12 </td></tr><tr><td>  rfisoty.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  2018年1月4日 </td></tr><tr><td>  rybatas.com </td><td>  185.127.26.227 </td><td>  RU </td><td>  2018年1月4日 </td></tr><tr><td>  urnachay.com </td><td>  185.127.26.227 </td><td>  RU </td><td>  2018年1月4日 </td></tr><tr><td>  yutlitsi.com </td><td>  185.127.26.227 </td><td>  RU </td><td>  2018年1月4日 </td></tr><tr><td>  urnisim.net </td><td>  185.127.26.227 </td><td>  RU </td><td>  2018年1月4日 </td></tr><tr><td>  oksigur.net </td><td>  185.127.26.227 </td><td>  RU </td><td>  2018年1月6日 </td></tr><tr><td>  urnachay.com </td><td>  109.234.35.121 </td><td>  RU </td><td>  1/31/2018 </td></tr><tr><td>  oksigur.net </td><td>  109.234.35.121 </td><td>  RU </td><td>  1/31/2018 </td></tr><tr><td>  yutlitsi.com </td><td>  109.234.35.121 </td><td>  RU </td><td>  1/2/2018 </td></tr><tr><td>  urnisim.net </td><td>  109.234.35.121 </td><td>  RU </td><td>  1/2/2018 </td></tr><tr><td>  divorough.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  2018/02/21 </td></tr><tr><td>  percalabia.com </td><td>  109.234.35.121 </td><td>  RU </td><td>  2018/02/22 </td></tr><tr><td>  borrespons.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  2018/02/26 </td></tr><tr><td>  britically.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  2018/02/26 </td></tr><tr><td>  eyrannon.com </td><td>  109.234.35.121 </td><td>  RU </td><td>  2018/02/26 </td></tr><tr><td>  deterhood.com </td><td>  109.234.35.121 </td><td>  RU </td><td>  1/3/2018 </td></tr><tr><td>  greatoric.com </td><td>  109.234.35.121 </td><td>  RU </td><td>  1/3/2018 </td></tr><tr><td>  manismay.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  1/3/2018 </td></tr><tr><td>  marrivate.com </td><td>  109.234.35.121 </td><td>  RU </td><td>  1/3/2018 </td></tr><tr><td>  moindal.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  1/3/2018 </td></tr><tr><td>  phonetarif.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  1/3/2018 </td></tr><tr><td>  moindal.com </td><td>  185.169.229.119 </td><td>  CH </td><td>  3/5/2018 </td></tr><tr><td>  dismissey.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  3/4/2018 </td></tr><tr><td>  euphratt.com </td><td>  109.234.35.121 </td><td>  RU </td><td>  4/4/2018 </td></tr><tr><td>  percalabia.com </td><td>  46.148.26.11 </td><td>  UA </td><td>  3/4/2018 </td></tr><tr><td>  deterhood.com </td><td>  46.148.26.11 </td><td>  UA </td><td>  2018年04月24日 </td></tr><tr><td>  eyrannon.com </td><td>  46.148.26.11 </td><td>  UA </td><td>  2018年04月24日 </td></tr><tr><td>  greatoric.com </td><td>  46.148.26.11 </td><td>  UA </td><td>  2018年04月24日 </td></tr><tr><td>  marrivate.com </td><td>  46.148.26.11 </td><td>  UA </td><td>  2018年04月24日 </td></tr><tr><td>  euphratt.com </td><td>  46.148.26.11 </td><td>  UA </td><td>  2018/4/25 </td></tr><tr><td>  borrespons.com </td><td>  185.48.56.134 </td><td>  Nl </td><td>  5/7/2018 </td></tr><tr><td>  britically.com </td><td>  185.48.56.134 </td><td>  Nl </td><td>  5/7/2018 </td></tr><tr><td>  dismissey.com </td><td>  185.48.56.134 </td><td>  Nl </td><td>  5/7/2018 </td></tr><tr><td>  divorough.com </td><td>  185.48.56.134 </td><td>  Nl </td><td>  5/7/2018 </td></tr><tr><td>  rfisoty.com </td><td>  185.48.56.134 </td><td>  Nl </td><td>  5/7/2018 </td></tr><tr><td>  detrole.com </td><td>  109.236.87.25 </td><td>  Nl </td><td>  5/8/2018 </td></tr><tr><td>  manismay.com </td><td>  185.48.56.134 </td><td>  Nl </td><td>  5/8/2018 </td></tr><tr><td>  phonetarif.com </td><td>  185.48.56.134 </td><td>  Nl </td><td>  2018/05/13 </td></tr><tr><td>  binncu.net </td><td>  46.148.26.106 </td><td>  UA </td><td>  2018/05/17 </td></tr><tr><td>  urnisim.net </td><td>  46.148.26.11 </td><td>  UA </td><td>  2018/05/17 </td></tr><tr><td>  urnachay.com </td><td>  46.148.26.11 </td><td>  UA </td><td>  2018/05/18 </td></tr><tr><td>  yutlitsi.com </td><td>  46.148.26.11 </td><td>  UA </td><td>  2018/05/18 </td></tr><tr><td>  oksigur.net </td><td>  46.148.26.11 </td><td>  UA </td><td>  2018/05/21 </td></tr><tr><td>  greatoric.com </td><td>  5.187.0.158 </td><td> 德 </td><td>  5/22/2018 </td></tr><tr><td>  marrivate.com </td><td>  5.187.0.158 </td><td> 德 </td><td>  5/22/2018 </td></tr><tr><td>  percalabia.com </td><td>  5.187.0.158 </td><td> 德 </td><td>  5/22/2018 </td></tr><tr><td>  urnachay.com </td><td>  5.187.0.158 </td><td> 德 </td><td>  5/22/2018 </td></tr><tr><td>  yutlitsi.com </td><td>  5.187.0.158 </td><td> 德 </td><td>  5/22/2018 </td></tr><tr><td>  lumpyve.com </td><td>  185.48.56.134 </td><td>  Nl </td><td>  2018/05/24 </td></tr><tr><td>  urnisim.net </td><td>  5.187.0.158 </td><td> 德 </td><td>  2018/05/27 </td></tr><tr><td>  borrespons.com </td><td>  85.143.202.82 </td><td>  RU </td><td>  2018年7月6日 </td></tr><tr><td>  manismay.com </td><td>  85.143.202.82 </td><td>  RU </td><td>  2018年7月6日 </td></tr><tr><td>  phonetarif.com </td><td>  85.143.202.82 </td><td>  RU </td><td>  2018年7月6日 </td></tr><tr><td>  rfisoty.com </td><td>  85.143.202.82 </td><td>  RU </td><td>  2018年7月6日 </td></tr><tr><td>  borrespons.com </td><td>  212.83.61.213 </td><td> 德 </td><td>  6/20/2018 </td></tr><tr><td>  manismay.com </td><td>  212.83.61.213 </td><td> 德 </td><td>  6/20/2018 </td></tr><tr><td>  rfisoty.com </td><td>  212.83.61.213 </td><td> 德 </td><td>  6/20/2018 </td></tr><tr><td>  lumpyve.com </td><td>  212.83.61.213 </td><td> 德 </td><td>  6/20/2018 </td></tr><tr><td>  phonetarif.com </td><td>  212.83.61.213 </td><td> 德 </td><td>  6/20/2018 </td></tr></tbody></table></div><br></div></div><br> 研究了所提供的数据之后，我们可以总结出所有域都已注册到使用临时邮件服务生成的邮件中。 虚拟注册人位于美国，而域名本身位于俄罗斯，乌克兰，荷兰，中国，哈萨克斯坦和德国（最近有一种将域名“迁移”到乌克兰和德国的趋势）。 所有域都在域区域“ com”和“ net”中。 域组成的字母仅包括英语字母。 在CnC端，将引发OpenResty Web服务器。 <br><br><h2> 结论 </h2><br> 尽管像宙斯一样的木马“古老”，但它们的相关性并没有下降。 结果，IcedID出现在针对银行客户的特洛伊木马程序中。 尽管这位银行家一开始就已经拥有了广泛的机会清单，但他仍在改进：拆箱方法变得越来越复杂，目标清单也在不断扩大。 将来很有可能该恶意软件将获得反分析机制，而CnC服务器将有选择地向受感染的设备进行Web注入。 同时，木马不能满足其“用户”的所有要求，去年12月与IcedID一起使用TrickBot便证明了这一点。 <br><br>  IB集团对网络犯罪一无所知，但却讲述了最有趣的事情。 <br><br> 充满动感的电报频道（https://t.me/Group_IB），涉及信息安全，黑客和网络攻击，黑客主义者和互联网盗版者。 逐步调查轰动性网络犯罪，使用Group-IB技术的实际案例，当然，还提供有关如何避免成为Internet受害者的建议。 <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">YouTube Channel</a> Group-IB <br>  Instagram上的Group-IB Photowire <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">网站www.instagram.com/group_ib</a> <br>  Twitter短消息twitter.com/GroupIB <br><br>  Group-IB是总部位于新加坡的网络中用于检测和预防网络攻击，检测欺诈和保护知识产权的解决方案的领先开发商之一。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN418189/">https://habr.com/ru/post/zh-CN418189/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN418173/index.html">神经网络的往返或文本分析中自动编码器使用的回顾</a></li>
<li><a href="../zh-CN418177/index.html">编辑.heic图像而不会丢失颜色</a></li>
<li><a href="../zh-CN418183/index.html">语音分析在商业中的应用</a></li>
<li><a href="../zh-CN418185/index.html">验尸故事：我们如何扭转汉西托</a></li>
<li><a href="../zh-CN418187/index.html">在美国，他们建议使用Amazon集线器替换所有库。 公众很愤慨</a></li>
<li><a href="../zh-CN418191/index.html">Python和JavaScript中的类似物。 第三部分</a></li>
<li><a href="../zh-CN418193/index.html">在2017年为Game Boy制作游戏的感觉如何</a></li>
<li><a href="../zh-CN418195/index.html">麻省理工学院的课程“计算机系统安全”。 讲座4：“共享特权”，第1部分</a></li>
<li><a href="../zh-CN418197/index.html">麻省理工学院的课程“计算机系统安全”。 讲座4：“共享特权”，第2部分</a></li>
<li><a href="../zh-CN418199/index.html">如何做一个简单的技术任务而又不浪费金钱和神经</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>