<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏻‍🎓 🅱️ 🎞️ Comment supprimer et «coller» un panorama sphérique sur DJI Mavic Air 🏂 🧖 🌩️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Avec la sortie de Dji Mavic Air, le processus de création de panoramas sphériques semble avoir été simplifié à la limite - il a appuyé sur un bouton e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment supprimer et «coller» un panorama sphérique sur DJI Mavic Air</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/coptertime/blog/418775/">  Avec la sortie de Dji Mavic Air, le processus de création de panoramas sphériques semble avoir été simplifié à la limite - il a appuyé sur un bouton et la sphère est prête.  C’est ce que dit la publicité.  Pour être honnête, je m'attendais déjà à ce que notre balle entière soit tirée au cours des premiers mois de vente, mais pour une raison quelconque, cela ne s'est pas produit. <br><br><img src="https://habrastorage.org/webt/jx/h4/lo/jxh4lof5xrcketwjgopnrbsckgq.jpeg"><br>  <i>photo de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Paul Oostveen</a></i> <br><a name="habracut"></a><br>  Il y a très probablement plusieurs raisons - le logiciel intégré est extrêmement primitif et n'est pas capable de faire un panorama décent si les conditions sont au moins légèrement différentes de l'idéal.  Au-dessus de l'eau ou sur la neige par temps nuageux, vous pouvez obtenir des morceaux de ciel au sol et d'autres «beautés», eh bien, je ne parle pas des couleurs médiocres du fichier jpeg fini et absolument pas de résolution.  Les objets situés près de la caméra posent également un problème - par exemple, pour supprimer une sphère où une tour sera au premier plan ou quelque chose de similaire sur la machine ne fonctionnera probablement pas.  La raison en est la parallaxe, à savoir la dérive de l’hélicoptère lors de la prise de vue (malgré la très bonne rétention GPS du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Mavic Air</a> - une dizaine de centimètres suffira à stupéfier l’automatisation des systèmes embarqués). <br><br>  En publicité, la résolution panoramique est de 32mp, mais est-ce tellement le cas lorsque nous photographions à 360 degrés, et partout avec des écrans avec une résolution de 4K ou même plus?  De plus, le firmware ne sait pas coller le ciel et ne comprend pas quelles sont les bonnes couleurs, ce qui est impossible.  Bien que l'hélicoptère puisse tirer à +15 degrés, ce n'est pas encore suffisant pour obtenir un «toit». <br><br><img src="https://habrastorage.org/webt/ih/ov/wu/ihovwufh8nhz3r-d83_9sxaj6vs.png"><br><br>  Mais tout n'est pas si mal.  Si vous êtes déterminé à obtenir un bon panorama - c'est tout à fait possible avec Mavic Air.  Au début, j'étais quelque peu sceptique quant à la prise de vue standard de 25 images, mais j'ai ensuite conclu que cela suffisait.  Plus tôt, lors de la prise de vue sur DJI Phantom ¾ ou DJI Mavic Pro à l'aide de Litchi, j'ai essayé de prendre de 32 à 48 photos.  Plus ou moins.  Les 25 proposés par Mavic Air m'ont d'abord paru un peu, j'ai essayé le Litchi, mais aucune augmentation significative n'est sortie.  Au cours de la formation, j'ai développé une technique claire et optimisé le processus.  Maintenant, pour une batterie pas très grande, je parviens à créer jusqu'à 4 à 5 sphères, et le collage avec correction des couleurs prend environ 10 à 15 minutes.  À la sortie, nous avons un panorama avec une résolution allant jusqu'à 177mp avec de bonnes couleurs, un ciel normal et un contrôle total de ce qui se passe. <br><br>  Alors, que faut-il pour obtenir un bon résultat? <br><br><ul><li>  Logiciel DJI GO 4 standard et sauvegarde des photos dans DNG Raw </li><li>  Adobe lightroom </li><li>  PtGui Pro </li><li>  Adobe Photoshop ...  10-20 minutes pour chaque panorama </li></ul><br>  Tout d'abord, il est conseillé de tout supprimer correctement afin de minimiser le temps de traitement.  Bien sûr, la prise de vue au lever / coucher du soleil est très belle, mais en raison du faible soleil et des éventuels reflets, le collage peut être difficile.  Vous pouvez utiliser un pare-soleil supplémentaire - cela facilitera le travail, mais vous aurez toujours des cadres où le soleil brille directement dans l'appareil photo.  Pour les premières expériences, choisissez une horloge plus proche de midi - le soleil ne pourra pas entrer dans le cadre.  Il convient également d'éviter les objets très proches de l'hélicoptère.  Sélectionnez des plans avec des objets équidistants.  Les grands espaces peuvent être très difficiles à coller sans une texture évidente - lac / mer / neige / sable.  Je recommande de désactiver l'exposition automatique de l'appareil photo.  Regardez autour de vous et sélectionnez la vitesse d'obturation et l'ouverture moyennes (dans le cas du DJI Phantom 4 Pro), fixez la sensibilité (ISO).  Même si, dans une certaine direction, l'exposition n'est pas idéale, elle peut être corrigée dans Lightroom lors de la conversion de RAW.  C'est beaucoup plus facile que de lutter contre les erreurs d'automatisation qui peuvent se produire si la caméra est dirigée vers le soleil ou si le fond est une forêt / eau solide et des surfaces similaires. <br><br>  Assurez-vous que la sauvegarde des originaux est activée.  Lorsque tous les paramètres sont définis - vous pouvez commencer la prise de vue.  Dans le processus, je recommande de surveiller ce que l'appareil supprime.  S'il y a un objet principal dans le cadre, vous devez vous assurer qu'il est tourné avec tout le cadre, c'est-à-dire qu'il ne tombe pas dans la jonction de 2 cadres et n'est pas trop près du bord du cadre.  Si cela se produisait néanmoins - il vaut mieux ne pas déplacer l'hélicoptère à la fin du levé, en n'utilisant que la rotation autour de son axe et en inclinant la caméra pour prendre manuellement quelques images de l'objet - cela peut grandement simplifier le collage.  Pour obtenir un beau panorama, il n'est pas nécessaire d'aller trop haut.  Les panoramas sont superbes, où vous plongez à l'intérieur, vous pouvez être situé non plus haut, mais entre les objets de prise de vue, mais vous devez vous assurer que l'hélicoptère est capable de supprimer les bords supérieurs des objets afin qu'ils ne soient pas flous. <br><br><img src="https://habrastorage.org/webt/r1/12/cu/r112cueigjsmwytgjbde7hggtmc.jpeg"><br>  <i>Un exemple où l'hélicoptère était trop bas.</i>  <i>Le panorama est collé avec le logiciel DJI Mavic Air intégré.</i>  <i>Cependant, il est probable que si vous prenez le code source et le collez avec un programme panorama externe, vous pouvez l'enregistrer.</i> <br><br>  Et maintenant - les trames sont reçues - nous procédons au traitement.  DJI Go 4 enregistre toutes les sources dans un dossier séparé - «Panorama» - copiez le contenu du dossier souhaité sur le disque dur et déposez-le dans Lightroom.  Notre tâche consiste à préparer des cadres individuels à coller dans PTGUI - pour cela, il est important non seulement de traiter l'exposition et la couleur de chaque cadre, mais également de rendre toutes les parties du futur panorama aussi proches que possible de la luminosité et du contraste. <br><br><img src="https://habrastorage.org/webt/a0/z9/q1/a0z9q16uscbohtlohciwtafqggy.png"><br><br>  Si une correction de luminosité locale est utilisée - retirez n'importe quel objet - assurez-vous que, sur toutes les images où elle est présente, cela est fait aussi près que possible.  PTGUI a une fonction d'égalisation de la luminosité, mais il est préférable de le faire à l'avance.  De plus, le matériel résultant peut être exporté (je recommande d'utiliser Tiff avec une compression LZW de 8/16 bits par canal, selon la puissance de votre PC). <br><br><img src="https://habrastorage.org/webt/ei/za/h2/eizah2wfiaszg0f1mmbjclpvj1g.png"><br><br>  La prochaine étape sera l'assemblage direct du panorama.  Téléchargez des fichiers sur PTGUI PRO et cliquez sur Aligner les images. <br><br><img src="https://habrastorage.org/webt/un/ar/z2/unarz2i0cb4uwldz0rzi3yng_eu.png"><br><br>  Le système analyse les données et essaie de comparer les trames par points de contrôle. <br><br>  Dans certains cas (eau / neige, etc.), le programme peut afficher un message sur l'absence de correspondances sur certaines images - cela signifie que vous devrez définir les points de contrôle manuellement. <br><br>  Si ce n'est pas le cas, le programme nous donnera une fenêtre avec un panorama panoramique, où il est souhaitable de définir le centre - l'endroit qui sera affiché lors du chargement - le visage du panorama, vous pouvez également ajuster l'horizon. <br><br><img src="https://habrastorage.org/webt/eh/iu/bh/ehiubhvol5md_hd68rj_kcl9hdk.png"><br><br>  Ensuite, nous pouvons ouvrir un aperçu du panorama, qui peut être tordu et pré-évaluer le résultat. <br><br><img src="https://habrastorage.org/webt/qu/rd/p5/qurdp5vci_el4jhywlvxccueusk.png"><br><br>  Ici, vous pouvez remarquer des problèmes particulièrement forts et, le cas échéant, passez à l'édition des points de contrôle et essayez de le résoudre. <br><br><img src="https://habrastorage.org/webt/yq/sx/4p/yqsx4pdng2errceagbvlie1liiq.png"><br><br>  S'il n'y a pas de problèmes particuliers - le dernier onglet - Créer un panorama - est défini comme dans Lightroom - Tiff avec compression LZW. <br><br><img src="https://habrastorage.org/webt/tw/r3/91/twr391f4kmzgn6w0bxuomof3r04.png"><br><br>  La prochaine étape est l'inspection et l'ajustement final dans Photoshop.  Nous examinons lentement l'ensemble du panorama par parties pour détecter les incohérences - l'horizon et les problèmes des principaux objets sont particulièrement frappants.  Eh bien, si le joint sur l'objet sans texture spéciale. <br><br><img src="https://habrastorage.org/webt/u0/sw/-5/u0sw-5hap33vcbepdtaj0unwits.png"><br><br>  Ici, tous les outils sont déjà bons - nous essayons d'abord d'allouer par divergence par sélection polygonale, puis par transformation - distorsion et autres options - nous personnalisons la pièce «abandonnée».  L'ombrage de la sélection peut être réglé petit - 1-2 pixels, et parfois il vaut mieux laisser des bords nets, nous fermons les zones résultantes à la suite du décalage, comme d'habitude avec un tampon ou une brosse de cicatrisation. <br><br><img src="https://habrastorage.org/webt/o0/ev/-u/o0ev-us8vs3jrgyfqr85fz4optw.png"><br><br>  Bien sûr, il y a des cas plus compliqués - alors nous ouvrons un fichier séparé avec l'objet, le copions dans un nouveau calque, ajustons l'échelle, supprimons l'excédent - nous obtenons un patch.  Dans le cas de l'utilisation de déformations - en particulier la déformation des marionnettes, il est très important de limiter les points et de ne pas toucher les bords du panorama - sinon il ne collera plus ensemble. <br><br>  Il est temps de donner effet et richesse au panorama.  Maintenant, nous pouvons tordre les niveaux / courbes / couleurs en toute sécurité pour obtenir l'effet souhaité.  Vous devrez peut-être utiliser les outils Dodge / burn, travailler sur des objets individuels - en fait, pour l'instant, nous avons exporté vers Tiff et mis en place avec d'énormes tailles de fichier. <br><br><img src="https://habrastorage.org/webt/su/br/zr/subrzrgwexa9ypzhwz9sv5sidnw.png"><br><br>  À la fin, vous devez ramasser le ciel.  J'ai déjà accumulé un certain montant de mes réserves + j'ai trouvé quelque chose sur le réseau.  S'il n'y a pas de stock ou d'options enregistrées, étirez simplement le ciel jusqu'à l'arrêt.  ce ne sera pas très beau, mais du moins pas un dôme noir. <br><br><img src="https://habrastorage.org/webt/xy/xy/xx/xyxyxxp0vsdvldheoauwfdrxxt0.png"><br><br>  Nous insérons l'objet ciel, le pixellisons immédiatement (si avant que le panorama du ciel soit fait correctement, aucun changement ne sera nécessaire), puis créons le masque, utilisez le dégradé pour passer du ciel à notre arrière-plan et ajustez la luminosité du calque inséré avec des courbes.  Faites attention à la jonction du ciel et de votre panorama, parfois même lorsque vous utilisez un masque et un dégradé - des objets sombres peuvent briller et vous pouvez facilement obtenir des montagnes translucides au-dessus de la ville.  Il est préférable de désactiver le calque panoramique et lentement, si vous avez besoin d'effacer toute la gomme suspecte. <br><br><img src="https://habrastorage.org/webt/nt/nx/l_/ntnxl__-qsve95gnluixnfm2iko.png"><br><br>  Cela peut être fait.  Collez dans une couche la fonction "réduire" pour minimiser le volume, enregistrez Tiff juste au cas où, puis réduisez l'image à 10 000 points sous le côté long, car la plupart des services (Sferika.ru ou le même Google Maps) ne manqueront pas un panorama trop volumineux - Oui, et il n'est pas nécessaire de transporter une charge aussi énorme (pour les téléphones sur 4g, cela sera généralement insupportable).  Nous enregistrons le résultat du travail en JPEG - la qualité est suffisante 10 et la sortie a un panorama de 50 mégapixels et une taille de fichier de 10-15 mb (selon les détails). <br><br><img src="https://habrastorage.org/webt/ui/ea/vx/uieavxgqssxn5o-rgzc9c_ifpn4.png"><br><br>  Notre panorama est prêt - il ne reste plus qu'à trouver un service de publication. <br><img src="https://habrastorage.org/webt/9w/pj/bx/9wpjbx-ml7dzugyjwm-11cdpp-q.png"><br><br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Panorama prêt ici</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr418775/">https://habr.com/ru/post/fr418775/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr418761/index.html">Le livre «Pure Python. Les subtilités de la programmation pour les pros »</a></li>
<li><a href="../fr418763/index.html">Moyen / senior: comment sortir du marais?</a></li>
<li><a href="../fr418765/index.html">Les conseils Dadata aident à remplir tout formulaire de saisie. Maintenant guéris</a></li>
<li><a href="../fr418767/index.html">L'énorme héritage de jeu d'Adobe Flash et mes tentatives pour le sauver</a></li>
<li><a href="../fr418769/index.html">Exemple de calcul du «facteur de disponibilité» pour un système informatique</a></li>
<li><a href="../fr418777/index.html">«Il n'y a pas de patron ici»: à propos de travailler avec Open Source et Apache Ignite dans Sberbank Technologies</a></li>
<li><a href="../fr418779/index.html">Caissier sur la base de la tablette: pourquoi les détaillants du réseau en ont besoin (nous le disons sur l'exemple de notre caissier)</a></li>
<li><a href="../fr418781/index.html">Ajoutez le cryptage des e-mails et la signature électronique à Zimbra</a></li>
<li><a href="../fr418783/index.html">"Qui hier était un géant monopolistique, demain pourrait devenir rien." Entretien avec Evgeny Chereshnev de Biolink.Tech</a></li>
<li><a href="../fr418785/index.html">Amigo tout. Maintenant c'est officiel</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>