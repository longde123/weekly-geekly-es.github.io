<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>тШпя╕П ЁЯед ЁЯзСтАНЁЯдЭтАНЁЯзС рдПрдХ рд╕рд┐рдВрдЧрд▓рдЯрди рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдкрд░ рдЕрдкрд░рд┐рднрд╛рд╖рд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░ рд╕реЗ рдмрдЪрдиреЗ рдХреА рддрдХрдиреАрдХ ЁЯХ┤ЁЯП╜ ЁЯЪЪ тШЭЁЯП┐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдЖрдзреБрдирд┐рдХ рд╕реА ++ рдореЗрдВ рдПрдХ рд╕рд┐рдВрдЧрд▓рдЯрди рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдкрд░ рд▓реЗрдЦ рдЕрдкрд░рд┐рднрд╛рд╖рд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рдХрд╛рд░рдгреЛрдВ рдФрд░ рддрд░реАрдХреЛрдВ рдкрд░ рдЪрд░реНрдЪрд╛ рдХрд░рддрд╛ рд╣реИред рдПрдХрд▓-рдереНрд░реЗрдбреЗрдб рдХреЛрдб рдХреЗ рдЙрджрд╛рд╣рд░рдг рджрд┐рдП рдЧрдП рд╣реИрдВред рд╕рдВ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдПрдХ рд╕рд┐рдВрдЧрд▓рдЯрди рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдкрд░ рдЕрдкрд░рд┐рднрд╛рд╖рд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░ рд╕реЗ рдмрдЪрдиреЗ рдХреА рддрдХрдиреАрдХ</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/455848/">  рдЖрдзреБрдирд┐рдХ рд╕реА ++ рдореЗрдВ рдПрдХ рд╕рд┐рдВрдЧрд▓рдЯрди рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдкрд░ рд▓реЗрдЦ рдЕрдкрд░рд┐рднрд╛рд╖рд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рдХрд╛рд░рдгреЛрдВ рдФрд░ рддрд░реАрдХреЛрдВ рдкрд░ рдЪрд░реНрдЪрд╛ рдХрд░рддрд╛ рд╣реИред  рдПрдХрд▓-рдереНрд░реЗрдбреЗрдб рдХреЛрдб рдХреЗ рдЙрджрд╛рд╣рд░рдг рджрд┐рдП рдЧрдП рд╣реИрдВред  рд╕рдВрдХрд▓рдХ-рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХреБрдЫ рднреА рдирд╣реАрдВ, рд╕рднреА рдорд╛рдирдХ рдХреЗ рдЕрдиреБрд╕рд╛рд░ред <br><a name="habracut"></a><br><h3>  рдкрд░рд┐рдЪрдп </h3><br>  рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдореЗрд░рд╛ рд╕реБрдЭрд╛рд╡ рд╣реИ рдХрд┐ рдЖрдк рд╣реИрдмрд░ рдкрд░ рд╕рд┐рдВрдЧрд▓рдЯрди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдиреНрдп рд▓реЗрдЦ рдкрдврд╝реЗрдВ: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рд┐рдВрдЧрд▓рдЯрди рдкреИрдЯрд░реНрди рдХреЗ рддреАрди рдпреБрдЧ</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рд┐рдВрдЧрд▓рдЯрди рдФрд░ рдХреЙрдорди рдЗрдВрд╕реНрдЯреИрдВрд╕</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдПрдХрд▓ рдЬрд┐рдореНрдореЗрджрд╛рд░реА рд╕рд┐рджреНрдзрд╛рдВрдд рдХреЛ рддреЛрдбрд╝рдиреЗ рдХреЗ 3 рддрд░реАрдХреЗ</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рд┐рдВрдЧрд▓рдЯрди - рдкреИрдЯрд░реНрди рдпрд╛ рдПрдВрдЯреАрдкреИрдЯрд░реНрди?</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рд┐рдВрдЧрд▓рдЯрди рдкреИрдЯрд░реНрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛</a> <br><br>  рдФрд░, рдЕрдВрдд рдореЗрдВ, рдПрдХ рд▓реЗрдЦ рдЬреЛ рдПрдХ рд╣реА рд╡рд┐рд╖рдп рдкрд░ рдЫреБрдЖ, рд▓реЗрдХрд┐рди рдЗрд╕рдореЗрдВ рдлрд┐рд╕рд▓ рдЧрдпрд╛ (рдпрджрд┐ рдХреЗрд╡рд▓ рдЗрд╕рд▓рд┐рдП рдХрд┐ рдиреБрдХрд╕рд╛рди рдФрд░ рд╕реАрдорд╛рдУрдВ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛): <br>  tialized рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ (рдпрд╛рдиреА рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕) <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рд┐рдВрдЧрд▓рдЯрди рдФрд░ рдСрдмреНрдЬреЗрдХреНрдЯ рд▓рд╛рдЗрдлрдЯрд╛рдЗрдо</a> <br><br>  рдЕрдЧрд▓рд╛: <br><br><ul><li>  рдпрд╣ рд╕рд┐рдВрдЧрд▓рдЯрди рдХреЗ рд╡рд╛рд╕реНрддреБ рдЧреБрдгреЛрдВ рдкрд░ рдПрдХ рд▓реЗрдЦ <b>рдирд╣реАрдВ рд╣реИ</b> ; </li><li>  рдпрд╣ рдПрдХ рд▓реЗрдЦ "рдХреИрд╕реЗ рдПрдХ рднрдпрд╛рдирдХ рдФрд░ рднрдпрд╛рдирдХ рд╕рд┐рдВрдЧрд▓рдЯрди рд╕реЗ рдмрд╛рд╣рд░ рдПрдХ рд╕рдлреЗрдж рдФрд░ рд╢рд░рд╛рдмреА рд╕рд┐рдВрдЧрд▓рдЯрди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП <b>рдирд╣реАрдВ рд╣реИ</b> "; </li><li>  рдпрд╣ <b>рдПрдХ</b> рдПрдХрд▓ рдЕрднрд┐рдпрд╛рди <b>рдирд╣реАрдВ рд╣реИ</b> ; </li><li>  рдпрд╣ рд╕рд┐рдВрдЧрд▓рдЯрди рдХреЗ рдЦрд┐рд▓рд╛рдл рдзрд░реНрдордпреБрджреНрдз <b>рдирд╣реАрдВ</b> рд╣реИ; </li><li>  рдпрд╣ <b>рдПрдХ</b> рд╕реБрдЦрдж рдЕрдВрдд рд▓реЗрдЦ рдирд╣реАрдВ рд╣реИред </li></ul><br>  рдпрд╣ рд▓реЗрдЦ рдЖрдзреБрдирд┐рдХ C ++ рдореЗрдВ рд╕рд┐рдВрдЧрд▓рдЯрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рдПрдХ рдмрд╣реБрдд рдорд╣рддреНрд╡рдкреВрд░реНрдг, рд▓реЗрдХрд┐рди рдЕрднреА рднреА рддрдХрдиреАрдХреА рдкрд╣рд▓реВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╣реИред  рд▓реЗрдЦ рдореЗрдВ рдореБрдЦреНрдп рдзреНрдпрд╛рди рд╕рд┐рдВрдЧрд▓рдЯрди рдХреЗ рд╡рд┐рдирд╛рд╢ рдХреЗ рдХреНрд╖рдг рдкрд░ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреИрд╕реЗ  рдЕрдзрд┐рдХрд╛рдВрд╢ рд╕реНрд░реЛрддреЛрдВ рдореЗрдВ, рд╡рд┐рдирд╛рд╢ рдХреЗ рдореБрджреНрджреЗ рдХрд╛ рдЦреБрд▓рд╛рд╕рд╛ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рдЖрдорддреМрд░ рдкрд░, рдЙрд╕ рдХреНрд╖рдг рдкрд░ рдЬреЛрд░ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрдм рд╕рд┐рдВрдЧрд▓рдЯрди рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛, рдФрд░ рд╡рд┐рдирд╛рд╢ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ, рд╕рдмрд╕реЗ рдЕрдЪреНрдЫреЗ рд░реВрдк рдореЗрдВ, рдпрд╣ рдХреБрдЫ рдРрд╕рд╛ рдХрд╣рддрд╛ рд╣реИ рдЬреИрд╕реЗ "рд░рд┐рд╡рд░реНрд╕ рдСрд░реНрдбрд░ рдореЗрдВ рдирд╖реНрдЯ рд╣реЛ рдЧрдпрд╛ред" <br><br>  <b>рдореИрдВ рдЖрдкрдХреЛ рдЯрд┐рдкреНрдкрдгрд┐рдпреЛрдВ рдореЗрдВ рд▓реЗрдЦ рдХреЗ рджрд╛рдпрд░реЗ рдХрд╛ рдкрд╛рд▓рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣реВрдВрдЧрд╛, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╕рд┐рдВрдЧрд▓рдЯрди рдкреИрдЯрд░реНрди рдмрдирд╛рдо рд╕рд┐рдВрдЧрд▓рдЯрди рдПрдВрдЯреАрдкреИрдЯрд░реНрди рд╣реЛрд▓рдХрд░ рдХреА рд╡реНрдпрд╡рд╕реНрдерд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд╣реАрдВред</b> <br><br>  рддреЛ рдЪрд▓рд┐рдП рдЪрд▓рддреЗ рд╣реИрдВред <br><br><h3>  рдорд╛рдирдХ рдХреНрдпрд╛ рдХрд╣рддрд╛ рд╣реИ </h3><br>  рдЙрджреНрдзрд░рдг C ++ 14 рдЕрдВрддрд┐рдо рдбреНрд░рд╛рдлреНрдЯ N3936 рдХреЗ рд░реВрдк рдореЗрдВ рд╣реИрдВ  рдЙрдкрд▓рдмреНрдз C ++ 17 рдбреНрд░рд╛рдлреНрдЯ "рдЕрдВрддрд┐рдо" рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд┐рд╣реНрдирд┐рдд рдирд╣реАрдВ рд╣реИрдВред <br>  рдореИрдВ рдЗрд╕рдХреА рд╕рдВрдкреВрд░реНрдгрддрд╛ рдореЗрдВ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЦрдВрдб рджреЗрддрд╛ рд╣реВрдВред  рдореЗрд░реЗ рджреНрд╡рд╛рд░рд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕реНрдерд╛рдиреЛрдВ рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред <br><br><blockquote>  3.6.3 рд╕рдорд╛рдкреНрддрд┐ [basic.start.term] <br><br>  1. рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╡рд╕реНрддреБрдУрдВ рдХреЗ рд▓рд┐рдП рдбрд┐рд╕реНрдЯреНрд░рдХреНрдЯрд░реНрд╕ (12.4) (рдпрд╛рдиреА, рдРрд╕реА рд╡рд╕реНрддреБрдПрдВ рдЬрд┐рдирдХрд╛ рдЬреАрд╡рдирдХрд╛рд▓ (3.8) рд╢реБрд░реВ рд╣реЛ рдЪреБрдХрд╛ рд╣реИ) рд╕реНрдерд┐рд░ рднрдВрдбрд╛рд░рдг рдЕрд╡рдзрд┐ рдХреЗ рд╕рд╛рде рдореБрдЦреНрдп рд╕реЗ рд▓реМрдЯрдиреЗ рдФрд░ рдПрд╕рдЯреАрдбреА рдХреЙрд▓рд┐рдВрдЧ рдХреЗ рдкрд░рд┐рдгрд╛рдо рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ :: рдмрд╛рд╣рд░ рдирд┐рдХрд▓реЗрдВ (18.5)ред  рдХрд┐рд╕реА рджрд┐рдП рдЧрдП рдзрд╛рдЧреЗ рдХреЗ рднреАрддрд░ рдереНрд░реЗрдб рд╕реНрдЯреЛрд░реЗрдЬ рдЕрд╡рдзрд┐ рдХреЗ рд╕рд╛рде рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╡рд╕реНрддреБрдУрдВ рдХреЗ рд▓рд┐рдП рд╡рд┐рдирд╛рд╢рдХреЛрдВ рдХреЛ рдЙрд╕ рдереНрд░реЗрдб рдХреЗ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдлрд╝рдВрдХреНрд╢рди рд╕реЗ рд▓реМрдЯрдиреЗ рдФрд░ рдЙрд╕ рдереНрд░реЗрдб рдХреЙрд▓рд┐рдВрдЧ std :: рдмрд╛рд╣рд░ рдирд┐рдХрд▓рдиреЗ рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред  <b>рдЙрд╕ рдереНрд░реЗрдб рдХреЗ рднреАрддрд░ рдереНрд░реЗрдб рд╕реНрдЯреЛрд░реЗрдЬ рдЕрд╡рдзрд┐ рдХреЗ рд╕рд╛рде рд╕рднреА рдЖрд░рдВрднреАрдХреГрдд рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рдбрд┐рд╕реНрдЯреНрд░рдХреНрдЯрд░реНрд╕ рдХреА рдкреВрд░реНрдгрддрд╛ рдХреЛ рд╕реНрдерд┐рд░ рд╕реНрдЯреЛрд░реЗрдЬ рдЕрд╡рдзрд┐ рдХреЗ рд╕рд╛рде рдХрд┐рд╕реА рднреА рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рдбрд┐рд╕реНрдЯреНрд░рдХреНрдЯрд░реНрд╕ рдХреА рджреАрдХреНрд╖рд╛ рд╕реЗ рдкрд╣рд▓реЗ рдЕрдиреБрдХреНрд░рдорд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред</b>  <b>рдпрджрд┐ рдереНрд░реЗрдб рд╕реНрдЯреЛрд░реЗрдЬ рдХреА рдЕрд╡рдзрд┐ рдХреЗ рд╕рд╛рде рдХрд┐рд╕реА рдСрдмреНрдЬреЗрдХреНрдЯ рдХрд╛ рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рдпрд╛ рдбрд╛рдпрдиреЗрдорд┐рдХ рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рдкреВрд░рд╛ рд╣реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рджреВрд╕рд░реЗ рдХреЗ рдбрд┐рд╕реНрдЯреНрд░рдХреНрдЯрд░ рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╣рд▓реЗ рдХреЗ рдбрд┐рд╕реНрдЯреНрд░реЙрдпрд░ рдХреЗ рдЖрд░рдВрдн рд╕реЗ рдкрд╣рд▓реЗ рдЕрдиреБрдХреНрд░рдо рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред</b>  <b>рдпрджрд┐ рд╕реНрдерд┐рд░ рднрдВрдбрд╛рд░рдг рдЕрд╡рдзрд┐ рдХреЗ рд╕рд╛рде рдХрд┐рд╕реА рдСрдмреНрдЬреЗрдХреНрдЯ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдпрд╛ рдЧрддрд┐рд╢реАрд▓ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдкреВрд░рд╛ рд╣реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рджреВрд╕рд░реЗ рдХрд╛ рдЕрдиреБрдХреНрд░рдо рд╣реЛрддрд╛ рд╣реИ, рддреЛ рджреВрд╕рд░реЗ рдХреЗ рд╡рд┐рдзреНрд╡рдВрд╕рдХ рдХреЗ рдкреВрд░рд╛ рд╣реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдХреЗ рд╡рд┐рдирд╛рд╢рдХрд░реНрддрд╛ рдХреЗ рдЖрд░рдВрдн рд╕реЗ рдкрд╣рд▓реЗ рдЕрдиреБрдХреНрд░рдо рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред</b>  [рдиреЛрдЯ: рдпрд╣ рдкрд░рд┐рднрд╛рд╖рд╛ рд╕рдорд╡рд░реНрддреА рд╡рд┐рдирд╛рд╢ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред  тАУрдФрд░ рдзреНрдпрд╛рди рджреЗрдВ] рдпрджрд┐ рдХрд┐рд╕реА рд╡рд╕реНрддреБ рдХреЛ рд╡реИрдзрд╛рдирд┐рдХ рд░реВрдк рд╕реЗ рдЖрд░рдореНрдн рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╡рд╕реНрддреБ рдЙрд╕реА рдХреНрд░рдо рдореЗрдВ рдирд╖реНрдЯ рд╣реЛ рдЬрд╛рддреА рд╣реИ рдЬреИрд╕реЗ рдХрд┐ рд╡рд╕реНрддреБ рдХреЛ рдЧрддрд┐рд╢реАрд▓ рд░реВрдк рд╕реЗ рдЖрд░рдореНрдн рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред  рдХрд┐рд╕реА рдСрдмреНрдЬреЗрдХреНрдЯ рдпрд╛ рд╢реНрд░реЗрдгреА рдкреНрд░рдХрд╛рд░ рдХреЗ рд▓рд┐рдП, рд╕рдм -рдЬреЗрдХреНрдЯ рдХреЗ рдирд┐рд░реНрдорд╛рдг рдХреЗ рджреМрд░рд╛рди рд╢реБрд░реВ рдХреА рдЧрдИ рд╕реНрдЯреИрдЯрд┐рдХ рд╕реНрдЯреЛрд░реЗрдЬ рдЕрд╡рдзрд┐ рдХреЗ рд╕рд╛рде рдХрд┐рд╕реА рднреА рдмреНрд▓реЙрдХ-рд╕реНрдХреЛрдк рдСрдмреНрдЬреЗрдХреНрдЯ рд╕реЗ рдкрд╣рд▓реЗ рдЙрд╕ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рд╕рднреА рд╕рдмреЛрдмрд┐рдЬ рдХреЛ рдирд╖реНрдЯ рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдпрджрд┐ рд╕реНрдерд┐рд░ рдпрд╛ рдереНрд░реЗрдб рд╕реНрдЯреЛрд░реЗрдЬ рдЕрд╡рдзрд┐ рд╡рд╛рд▓реА рдХрд┐рд╕реА рд╡рд╕реНрддреБ рдХрд╛ рд╡рд┐рдирд╛рд╢ рдПрдХ рдЕрдкрд╡рд╛рдж рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рддрд╛ рд╣реИ, рддреЛ std :: рд╕рдорд╛рдкреНрддрд┐ рдХреЛ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ (15.5.1)ред <br><br>  2. <b>рдпрджрд┐ рдХрд┐рд╕реА рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рд╕реНрдереИрддрд┐рдХ рдпрд╛ рдереНрд░реЗрдб рд╕реНрдЯреЛрд░реЗрдЬ рдЕрд╡рдзрд┐ рдХрд╛ рдмреНрд▓реЙрдХ-рд╕реНрдХреЛрдк рдСрдмреНрдЬреЗрдХреНрдЯ рд╣реИ рдЬреЛ рдирд╖реНрдЯ рд╣реЛ рдЧрдпрд╛ рд╣реИ рдФрд░ рд╕реНрдерд┐рд░ рдпрд╛ рдереНрд░реЗрдб рд╕реНрдЯреЛрд░реЗрдЬ рдЕрд╡рдзрд┐ рдХреЗ рд╕рд╛рде рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рдирд╖реНрдЯ рдХрд░рдиреЗ рдХреЗ рджреМрд░рд╛рди рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХрд╛ рдЕрдкрд░рд┐рднрд╛рд╖рд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░ рд╣реЛрддрд╛ рд╣реИ рдпрджрд┐ рдирд┐рдпрдВрддреНрд░рдг рдХрд╛ рдкреНрд░рд╡рд╛рд╣ рдЧреБрдЬрд░рддрд╛ рд╣реИ рдкрд╣рд▓реЗ рдирд╖реНрдЯ рдХреА рдЧрдИ рдмреНрд▓реЙрдХрдЪреЛрдк рдСрдмреНрдЬреЗрдХреНрдЯ рдХреА рдкрд░рд┐рднрд╛рд╖рд╛ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗред</b>  рдЗрд╕реА рддрд░рд╣, рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рдЕрдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдпрджрд┐ рдмреНрд▓реЙрдХ-рд╕реНрдХреЛрдк рдСрдмреНрдЬреЗрдХреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдкреНрд░рддреНрдпрдХреНрд╖ рд░реВрдк рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдпрд╛рдиреА, рдПрдХ рд╕реВрдЪрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ) рдЙрд╕рдХреЗ рд╡рд┐рдирд╛рд╢ рдХреЗ рдмрд╛рджред <br><br>  <b>3. рдпрджрд┐ рд╕реНрдереИрддрд┐рдХ рднрдВрдбрд╛рд░рдг рдЕрд╡рдзрд┐ рдХреЗ рд╕рд╛рде рдХрд┐рд╕реА рд╡рд╕реНрддреБ рдХреЗ рдЖрд░рдВрднреАрдХрд░рдг рдХреЗ рдкреВрд░рд╛ рд╣реЛрдиреЗ рдкрд░ std :: atexit (тАЬcstdlibтАЭ, 18.5 рджреЗрдЦреЗрдВ) рдкрд░ рдХреЙрд▓ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЕрдиреБрдХреНрд░рдо рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ std :: atexit рдХреЛ рджрд┐рдП рдЧрдП рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдХреЙрд▓ рдХреЙрд▓ рд╕реЗ рдкрд╣рд▓реЗ рдЕрдиреБрдХреНрд░рдорд┐рдд рд╣реЛрддрд╛ рд╣реИред рд╡рд╕реНрддреБ рдХреЗ рд▓рд┐рдП рд╡рд┐рдирд╛рд╢рдХред</b>  <b>рдпрджрд┐ std :: atexit рдкрд░ рдХреЙрд▓ рд╕реНрдерд┐рд░ рд╕реНрдЯреЛрд░реЗрдЬ рдЕрд╡рдзрд┐ рдХреЗ рд╕рд╛рде рдХрд┐рд╕реА рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рдЖрд░рдВрднреАрдХрд░рдг рдХреЗ рдкреВрд░рд╛ рд╣реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЕрдиреБрдХреНрд░рдорд┐рдд рд╣реИ, рддреЛ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рд▓рд┐рдП рд╡рд┐рдзреНрд╡рдВрд╕рдХ рдХреЛ рдХреЙрд▓ std :: atexit рдХреЛ рджрд┐рдП рдЧрдП рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЕрдиреБрдХреНрд░рдорд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред</b>  <b>рдЕрдЧрд░ std :: atexit рдХреЛ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ std :: atexit рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рджреВрд╕рд░реЗ std рдХреЛ рджрд┐рдП рдЧрдП рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ :: atexit рдХреЙрд▓ рдХреЛ рдкрд╣рд▓реЗ std :: toexit рдХреЙрд▓ рдХреЛ рджрд┐рдП рдЧрдП рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЕрдиреБрдХреНрд░рдорд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ ред</b> <br><br>  4. рдпрджрд┐ рд╕рд┐рдЧреНрдирд▓ рд╣реИрдВрдбрд▓рд░ (18.10) рдХреЗ рднреАрддрд░ рдорд╛рдирдХ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдСрдмреНрдЬреЗрдХреНрдЯ рдпрд╛ рдлрд╝рдВрдХреНрд╢рди рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реИ, рдЬреЛ рд╕реНрдерд┐рд░ рднрдВрдбрд╛рд░рдг рдЕрд╡рдзрд┐ рдФрд░ рдПрд╕рдЯреАрдбреА рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд╕рд╛рде рд╡рд╕реНрддреБрдУрдВ рдХреЗ рд╡рд┐рдирд╛рд╢ рд╕реЗ рдкрд╣рд▓реЗ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ (1.10) :: atexit рдкрдВрдЬреАрдХреГрдд рдлрд╝рдВрдХреНрд╢рди (18.5) ), рдХрд╛рд░реНрдпрдХреНрд░рдо рдореЗрдВ рдЕрдкрд░рд┐рднрд╛рд╖рд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░ рд╣реЛрддрд╛ рд╣реИред  [рдиреЛрдЯ: рдпрджрд┐ рд╕реНрдереИрддрд┐рдХ рднрдВрдбрд╛рд░рдг рдЕрд╡рдзрд┐ рдХреЗ рд╕рд╛рде рдПрдХ рд╡рд╕реНрддреБ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдХрд┐ рд╡рд╕реНрддреБ рдХреЗ рд╡рд┐рдирд╛рд╢ рд╕реЗ рдкрд╣рд▓реЗ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдХрд╛рд░реНрдпрдХреНрд░рдо рдореЗрдВ рдЕрдкрд░рд┐рднрд╛рд╖рд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░ рд╣реЛрддрд╛ рд╣реИред  рдХреЙрд▓ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд╣рд░ рдереНрд░реЗрдб рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░рдирд╛ :: рдореБрдЦреНрдп рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рдирд╛ рдпрд╛ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рдирд╛ рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ, рд▓реЗрдХрд┐рди рдЗрди рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реИред  рдпреЗ рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдВ рдереНрд░реЗрдб рдкреНрд░рдмрдВрдзрдХреЛрдВ рдХреЛ рд╕реНрдереИрддрд┐рдХ-рд╕рдВрдЧреНрд░рд╣рдг-рдЕрд╡рдзрд┐ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИрдВред  -рдФрд░ рдиреЛрдЯ] <br><br>  5. рдлрд╝рдВрдХреНрд╢рди std :: abort ("cstdlib") рдореЗрдВ рдШреЛрд╖рд┐рдд рдХрд┐рдП рдЧрдП рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЛ рдмрд┐рдирд╛ рдХрд┐рд╕реА рд╡рд┐рдзреНрд╡рдВрд╕рдХ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдП рдмрд┐рдирд╛ рдФрд░ std :: atexit () рдпрд╛ std :: at_quick_bit () рдореЗрдВ рджрд┐рдП рдЧрдП рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд┐рдП рдмрд┐рдирд╛ рд╕рдорд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред </blockquote>  рд╡реНрдпрд╛рдЦреНрдпрд╛: <br><br><ul><li>  рдзрд╛рдЧрд╛ рднрдВрдбрд╛рд░рдг рдЕрд╡рдзрд┐ рдХреЗ рд╕рд╛рде рд╡рд╕реНрддреБрдУрдВ рдХрд╛ рд╡рд┐рдирд╛рд╢ рдЙрдирдХреА рд░рдЪрдирд╛ рдХреЗ рд░рд┐рд╡рд░реНрд╕ рдСрд░реНрдбрд░ рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ; </li><li>  рдХрдбрд╝рд╛рдИ рд╕реЗ рдЙрд╕рдХреЗ рдмрд╛рдж, рд╕реНрдерд┐рд░ рднрдВрдбрд╛рд░рдг рдЕрд╡рдзрд┐ рд╡рд╛рд▓реА рд╡рд╕реНрддреБрдУрдВ рдХреЛ рдирд╖реНрдЯ рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдРрд╕реА рд╡рд╕реНрддреБрдУрдВ рдХреЗ рдирд┐рд░реНрдорд╛рдг рдХреЗ рд░рд┐рд╡рд░реНрд╕ рдСрд░реНрдбрд░ рдореЗрдВ std :: atexit рдХреЗ рд╕рд╛рде рдкрдВрдЬреАрдХреГрдд рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдХреЙрд▓ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ рдРрд╕реЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдкрдВрдЬреАрдХреГрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ; </li><li>  рдереНрд░реЗрдб рд╕реНрдЯреЛрд░реЗрдЬ рдЕрд╡рдзрд┐ рдпрд╛ рд╕реНрдерд┐рд░ рднрдВрдбрд╛рд░рдг рдЕрд╡рдзрд┐ рдХреЗ рд╕рд╛рде рдирд╖реНрдЯ рд╣реБрдИ рд╡рд╕реНрддреБ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рдкреНрд░рдпрд╛рд╕ рдореЗрдВ рдЕрдкрд░рд┐рднрд╛рд╖рд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░ рд╣реЛрддрд╛ рд╣реИред  рдРрд╕реА рд╡рд╕реНрддреБрдУрдВ рдХрд╛ рдкреБрди: рдкреНрд░рд╛рд░рдВрдн рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </li></ul><br>  рдиреЛрдЯ: рдорд╛рдирдХ рдореЗрдВ рд╡реИрд╢реНрд╡рд┐рдХ рдЪрд░ рдХреЛ "рд╕реНрдерд┐рд░ рднрдВрдбрд╛рд░рдг рдЕрд╡рдзрд┐ рдХреЗ рд╕рд╛рде рдЧреИрд░-рд╕реНрдерд╛рдиреАрдп рдЪрд░" рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред  рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдпрд╣ рдкрддрд╛ рдЪрд▓рд╛ рд╣реИ рдХрд┐ рд╕рднреА рд╡реИрд╢реНрд╡рд┐рдХ рдЪрд░, рд╕рднреА рд╕рд┐рдВрдЧрд▓реЗрдЯреЛрди (рд╕реНрдерд╛рдиреАрдп рд╕реНрдЯреЗрдЯрд┐рдХреНрд╕) рдФрд░ рд╕рднреА рдХреЙрд▓ std :: atexit рдПрдХ рд╣реА LIFO рдХрддрд╛рд░ рдореЗрдВ рдЖрддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ рдирд┐рд░реНрдорд┐рдд / рдкрдВрдЬреАрдХреГрдд рд╣реЛрддреЗ рд╣реИрдВред <br><br>  рд▓реЗрдЦ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рдЬрд╛рдирдХрд╛рд░реА рднреА <b>рдЧреИрд░-рд╕реНрдерд╛рдиреАрдп рдЪрд░ [рдмреЗрд╕рд┐рдХ.рд╕реНрдЯрд╛рд░реНрдЯ.рдЗрди] рдХреА</b> рдзрд╛рд░рд╛ <b>3.6.2</b> рдореЗрдВ рдирд┐рд╣рд┐рдд рд╣реИред  рдореИрдВ рдХреЗрд╡рд▓ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд▓рд╛рддрд╛ рд╣реВрдВ: <br><blockquote>  рд╕реНрдереИрддрд┐рдХ рднрдВрдбрд╛рд░рдг рдЕрд╡рдзрд┐ рдХреЗ рд╕рд╛рде рдПрдХ рдЧреИрд░-рд╕реНрдерд╛рдиреАрдп рдЪрд░ рдХрд╛ рдЧрддрд┐рд╢реАрд▓ рдкреНрд░рд╛рд░рдВрдн рдпрд╛ рддреЛ рдЖрджреЗрд╢ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдпрд╛ рдЕрдирд┐рдпрдВрддреНрд░рд┐рдд рд╣реИред  [...] рдПрдХрд▓ рдЕрдиреБрд╡рд╛рдж рдЗрдХрд╛рдИ рдХреЗ рднреАрддрд░ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЖрд░рдВрднреАрдХрд░рдг рдХреЗ рд╕рд╛рде рдЪрд░ рдЕрдиреБрд╡рд╛рдж рдЗрдХрд╛рдИ рдореЗрдВ рдЙрдирдХреА рдкрд░рд┐рднрд╛рд╖рд╛рдУрдВ рдХреЗ рдХреНрд░рдо рдореЗрдВ рдЖрд░рдВрдн рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред </blockquote>  рд╡реНрдпрд╛рдЦреНрдпрд╛ (рдЕрдиреБрднрд╛рдЧ рдХреЗ рдкреВрд░реНрдг рдкрд╛рда рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрддреЗ рд╣реБрдП): рдПрдХ рдЕрдиреБрд╡рд╛рдж рдЗрдХрд╛рдИ рдХреЗ рднреАрддрд░ рд╡реИрд╢реНрд╡рд┐рдХ рдЪрд░ рдХреЛ рдШреЛрд╖рдгрд╛ рдХреНрд░рдо рдореЗрдВ рдкреНрд░рд╛рд░рдВрдн рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br><h3>  рдХреЛрдб рдореЗрдВ рдХреНрдпрд╛ рд╣реЛрдЧрд╛ </h3><br>  рд▓реЗрдЦ рдореЗрдВ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рд╕рднреА рдХреЛрдб рдЙрджрд╛рд╣рд░рдг <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЬреАрдердм</a> рдкрд░ рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд┐рдП рдЧрдП рд╣реИрдВред <br><br>  рдХреЛрдб рдореЗрдВ рддреАрди рдкрд░рддреЗрдВ рд╣реЛрддреА рд╣реИрдВ, рдЬреИрд╕реЗ рдХрд┐ рд╡рд┐рднрд┐рдиреНрди рд▓реЛрдЧреЛрдВ рджреНрд╡рд╛рд░рд╛ рд▓рд┐рдЦрд┐рдд: <br><br><ul><li>  рд╕рд┐рдВрдЧрд▓рдЯрди; </li><li>  рдЙрдкрдпреЛрдЧрд┐рддрд╛ (рд╕рд┐рдВрдЧрд▓рдЯрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рд╡рд░реНрдЧ); </li><li>  рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ (рд╡реИрд╢реНрд╡рд┐рдХ рдЪрд░ рдФрд░ рдореБрдЦреНрдп)ред </li></ul><br>  рд╕рд┐рдВрдЧрд▓рдЯрди рдФрд░ рдпреВрдЯрд┐рд▓рд┐рдЯреА рдПрдХ рдерд░реНрдб-рдкрд╛рд░реНрдЯреА рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреА рддрд░рд╣ рд╣реИ, рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╣реИред <br>  рдпреВрдЯрд┐рд▓рд┐рдЯреА рд▓реЗрдпрд░ рдХреЛ рд╕рд┐рдВрдЧрд▓рдЯрди рд▓реЗрдпрд░ рд╕реЗ рдпреВрдЬрд░ рд▓реЗрдпрд░ рдХреЛ рдЕрд▓рдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкрд╛рд╕ рд╕рд┐рдВрдЧрд▓рдЯрди рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХрд╛ рдЕрд╡рд╕рд░ рд╣реИ, рд▓реЗрдХрд┐рди рд╣рдо рдРрд╕рд╛ рдХрд╛рд░реНрдп рдХрд░реЗрдВрдЧреЗ рдЬреИрд╕реЗ рдХрд┐ рдпрд╣ рдЕрд╕рдВрднрд╡ рд╣реИред <br><br>  рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкрд╣рд▓реЗ рд╕рдм рдХреБрдЫ рд╕рд╣реА рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рдХрд▓рд╛рдИ рдХреЗ рдПрдХ рдЭрдЯрдХрд╛ рдХреЗ рд╕рд╛рде рд╕рдм рдХреБрдЫ рдЯреВрдЯ рдЬрд╛рддрд╛ рд╣реИред  рдкрд╣рд▓реЗ рд╣рдо рдЗрд╕реЗ рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдкрд░рдд рдореЗрдВ рдареАрдХ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ рдпрджрд┐ рдпрд╣ рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рддреЛ рд╕рд┐рдВрдЧрд▓рдЯрди рдкрд░рдд рдореЗрдВред <br><br>  рдХреЛрдб рдореЗрдВ, рд╣рдо рд▓рдЧрд╛рддрд╛рд░ рдХрд┐рдирд╛рд░реЗ рдкрд░ рдЪрд▓реЗрдВрдЧреЗ - рдЕрдм рдкреНрд░рдХрд╛рд╢ рдХреА рддрд░рдл, рдлрд┐рд░ рдЕрдВрдзреЗрд░реЗ рдкрд░ред  рдЕрдВрдзреЗрд░реЗ рдкрдХреНрд╖ рдореЗрдВ рд╕реНрд╡рд┐рдЪ рдХрд░рдирд╛ рдЖрд╕рд╛рди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╕рдмрд╕реЗ рдХрдард┐рди рдорд╛рдорд▓рд╛ рдЪреБрдирд╛ рдЧрдпрд╛ рдерд╛ - рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдбрд┐рд╕реНрдЯреНрд░рдХреНрдЯрд░ рд╕реЗ рдПрдХ рд╕рд┐рдВрдЧрд▓рдЯрди рддрдХ рдкрд╣реБрдВрдЪрдирд╛ред <br><br>  <b>рд╡рд┐рдзреНрд╡рдВрд╕рдХ рд╕реЗ рдХреЙрд▓ рдХрд░рдиреЗ рдХрд╛ рдорд╛рдорд▓рд╛ рд╕рдмрд╕реЗ рдореБрд╢реНрдХрд┐рд▓ рдХреНрдпреЛрдВ рд╣реИ?</b>  рдХреНрдпреЛрдВрдХрд┐ рдЙрдкрдпреЛрдЧрд┐рддрд╛ рд╡рд┐рдзреНрд╡рдВрд╕рдХ рдХреЛ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдХрд╣рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрдм рдкреНрд░рд╢реНрди "рд╕рд┐рдВрдЧрд▓рдЯрди рдирд╖реНрдЯ рд╣реЛ рдЧрдпрд╛ рд╣реИ рдпрд╛ рдЕрднреА рддрдХ рдирд╣реАрдВ" рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рд╣реЛ рдЧрдпрд╛ рд╣реИред <br><br>  <b>рдорд╛рдорд▓рд╛ рдХрд┐рд╕реА рддрд░рд╣ рдХрд╛ рд╕рд┐рдВрдереЗрдЯрд┐рдХ рд╣реИред</b>  <b>рд╡реНрдпрд╡рд╣рд╛рд░ рдореЗрдВ, рд╡рд┐рдзреНрд╡рдВрд╕рдХ рд╕реЗ рдПрдХ рд╕рд┐рдВрдЧрд▓рдЯрди рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред</b>  рдЖрд╡рд╢реНрдпрдХрддрд╛рдиреБрд╕рд╛рд░ рднреАред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╡рд╕реНрддреБрдУрдВ рдХрд╛ рд╡рд┐рдирд╛рд╢ рд▓реЙрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред <br><br>  рд╕рд┐рдВрдЧрд▓рдЯрди рдХреЗ рддреАрди рд╡рд░реНрдЧреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: <br><br><ul><li>  рд╕рд┐рдВрдЧреНрд▓рдЯрдирдХреНрд▓рд╛рд╕рд┐рдХ - рдХреЛрдИ рд╕реНрдорд╛рд░реНрдЯ рдкреЙрдЗрдВрдЯрд░реНрд╕ рдирд╣реАрдВред  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдпрд╣ рд╕реАрдзреЗ рддреМрд░ рдкрд░ рдХрд╛рдлреА рд╢рд╛рд╕реНрддреНрд░реАрдп рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рдорд╛рдирд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рддреАрдиреЛрдВ рдореЗрдВ рд╕рдмрд╕реЗ рд╢рд╛рд╕реНрддреНрд░реАрдп рд╣реИ; </li><li>  рд╕рд┐рдВрдЧрд▓рдЯрдирд╢реЗрдпрд░реЗрдб - рдПрд╕рдЯреАрдбреА рдХреЗ рд╕рд╛рде :: рд╕рд╛рдЭрд╛_рдкреНрдЯреНрд░; </li><li>  рд╕рд┐рдВрдЧрд▓рдЯрдирд╡реИрдХ - рдПрд╕рдЯреАрдбреА рдХреЗ рд╕рд╛рде :: рдХрдордЬреЛрд░_рдкреНрд░рддрд┐ред </li></ul><br>  рд╕рднреА рд╕рд┐рдВрдЧрд▓реЗрдЯреНрд╕ рдЯреЗрдореНрдкреНрд▓реЗрдЯ рд╣реИрдВред  рдЯреЗрдореНрдкреНрд▓реЗрдЯ рдкреИрд░рд╛рдореАрдЯрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЗрдирд╣реЗрд░рд┐рдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЬреНрдпрд╛рджрд╛рддрд░ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ, рдЙрдиреНрд╣реЗрдВ рдкреЗрд▓реЛрдб рд╡рд░реНрдЧ рджреНрд╡рд╛рд░рд╛ рдкрд░рд┐рдЪрд╛рд▓рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдбреЗрдЯрд╛ рдХреЛ std :: set рдореЗрдВ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдлрд╝рдВрдХреНрд╢рди рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред <br><br>  рдЕрдзрд┐рдХрд╛рдВрд╢ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧрд┐рддрд╛ рд╡рд┐рдзреНрд╡рдВрд╕рдХ рд╡рд╣рд╛рдБ рдПрдХ рд╕реМ рдорд╛рди рднрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддрд╛ рд╣реИред  рдХрдВрд╕реЛрд▓ рдХреЗ рд▓рд┐рдП рдбрд╛рдпрдЧреНрдиреЛрд╕реНрдЯрд┐рдХ рдЖрдЙрдЯрдкреБрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рд┐рдВрдЧрд▓рдЯрди рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░, рд╕рд┐рдВрдЧрд▓рдЯрди рдбрд┐рд╕реНрдЯреНрд░реЙрдХреНрдЯрд░ рдФрд░ рдЙрджрд╛рд╣рд░рдг () рд╕реЗ рднреА рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br>  <b>рдЗрддрдиреА рдореЗрд╣рдирдд рдХреНрдпреЛрдВ?</b>  рдпрд╣ рд╕рдордЭрдирд╛ рдЖрд╕рд╛рди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рд╣рдо рдЕрдВрдзреЗрд░реЗ рдХреА рддрд░рдл рд╣реИрдВред  рдирд╖реНрдЯ рдХрд┐рдП рдЧрдП рдПрдХрд▓ рдХреЗ рд▓рд┐рдП рдЕрдкреАрд▓ рдПрдХ рдЕрдкрд░рд┐рднрд╛рд╖рд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдХрд┐рд╕реА рднреА рддрд░рд╣ рд╕реЗ рдмрд╛рд╣рд░реА рд░реВрдк рд╕реЗ рдкреНрд░рдХрдЯ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред  рдирд╖реНрдЯ рдХрд┐рдП рдЧрдП рдПрд╕рдЯреАрдбреА рдореЗрдВ рдореВрд▓реНрдпреЛрдВ рдХреЛ рднрд░ рджреЗрдирд╛: рд╕реЗрдЯ рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рдмрд╛рд╣рд░реА рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐рдпреЛрдВ рдХреА рдЧрд╛рд░рдВрдЯреА рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдХреЛрдИ рдФрд░ рдЕрдзрд┐рдХ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рддрд░реАрдХрд╛ рдирд╣реАрдВ рд╣реИ (рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдЬреАрд╕реАрд╕реА рдХреЗ рддрд╣рдд рд▓рд┐рдирдХреНрд╕ рдореЗрдВ рдХреНрд▓рд╛рд╕рд┐рдХ рд╕рд┐рдВрдЧрд▓рдЯрди рдХреЗ рд╕рд╛рде рдЧрд▓рдд рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ, рдирд╖реНрдЯ рдХрд┐рдП рдЧрдП рдПрд╕рдЯреАрдбреА :: рд╕реЗрдЯ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рднрд░ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдПрдордПрд╕рд╡реАрдПрд╕ рдХреЗ рддрд╣рддред рд╡рд┐рдВрдбреЛрдЬ - рд╣реИрдВрдЧ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ)ред  рдЕрдкрд░рд┐рднрд╛рд╖рд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЗ рд╕рд╛рде, рдХрдВрд╕реЛрд▓ рдореЗрдВ рдЖрдЙрдЯрдкреБрдЯ <b>рдирд╣реАрдВ</b> рд╣реЛ рд╕рдХрддрд╛ рд╣реИред  рдЗрд╕рд▓рд┐рдП рд╕рд╣реА рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ, рд╣рдо рд╡рд┐рдзреНрд╡рдВрд╕рдХ рдХреЗ рдмрд╛рдж рдЙрджрд╛рд╣рд░рдг () рддрдХ рдкрд╣реБрдВрдЪ рдХреА рдЕрдиреБрдкрд╕реНрдерд┐рддрд┐ рдХреА рдЙрдореНрдореАрдж рдХрд░рддреЗ рд╣реИрдВ, рд╕рд╛рде рд╣реА рдПрдХ рджреБрд░реНрдШрдЯрдирд╛ рдХреА рдЕрдиреБрдкрд╕реНрдерд┐рддрд┐ рдФрд░ рдПрдХ рд╣реИрдВрдЧ рдХреА рдЕрдиреБрдкрд╕реНрдерд┐рддрд┐, рдФрд░ рдЧрд▓рдд рд▓реЛрдЧреЛрдВ рдореЗрдВ, рдпрд╛ рддреЛ рдЗрд╕ рддрд░рд╣ рдХреА рдЕрдкреАрд▓ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐, рдпрд╛ рдПрдХ рджреБрд░реНрдШрдЯрдирд╛, рдпрд╛ рдПрдХ рд╣реИрдВрдЧ, рдпрд╛ рдХрд┐рд╕реА рднреА рд╕рдВрдпреЛрдЬрди рдореЗрдВ рдПрдХ рдмрд╛рд░, рдпрд╛ рдЬреЛ рднреА рд╣реЛред <br><br><h3>  рдХреНрд▓рд╛рд╕рд┐рдХ рд╕рд┐рдВрдЧрд▓рдЯрди </h3><br><div class="spoiler">  <b class="spoiler_title">Payload.h</b> <div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> once #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;set&gt; class Payload { public: Payload() = default; ~Payload() = default; Payload(const Payload &amp;) = delete; Payload(Payload &amp;&amp;) = delete; Payload&amp; operator=(const Payload &amp;) = delete; Payload&amp; operator=(Payload &amp;&amp;) = delete; void add(int value) { m_data.emplace(value); } private: std::set&lt;int&gt; m_data; };</span></span></span></span></code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">SingletonClassic.h</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> once #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;iostream&gt; template&lt;typename T&gt; class SingletonClassic : public T { public: ~SingletonClassic() { std::cout &lt;&lt; "~SingletonClassic()" &lt;&lt; std::endl; } SingletonClassic(const SingletonClassic &amp;) = delete; SingletonClassic(SingletonClassic &amp;&amp;) = delete; SingletonClassic&amp; operator=(const SingletonClassic &amp;) = delete; SingletonClassic&amp; operator=(SingletonClassic &amp;&amp;) = delete; static SingletonClassic&amp; instance() { std::cout &lt;&lt; "instance()" &lt;&lt; std::endl; static SingletonClassic inst; return inst; } private: SingletonClassic() { std::cout &lt;&lt; "SingletonClassic()" &lt;&lt; std::endl; } };</span></span></span></span></code> </pre><br></div></div><br><h3>  рд╕рд┐рдВрдЧрд▓рдЯрдирдХреНрд▓рд╛рд╕рд┐рдХ рдЙрджрд╛рд╣рд░рдг 1 </h3><br><div class="spoiler">  <b class="spoiler_title">Classic_Example1_correct.cpp</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SingletonClassic.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Payload.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;memory&gt; class ClassicSingleThreadedUtility { public: ClassicSingleThreadedUtility() { // To ensure that singleton will be constucted before utility SingletonClassic&lt;Payload&gt;::instance(); } ~ClassicSingleThreadedUtility() { auto &amp;instance = SingletonClassic&lt;Payload&gt;::instance(); for ( int i = 0; i &lt; 100; ++i ) instance.add(i); } }; // 1. Create an empty unique_ptr // 2. Create singleton (because of modified ClassicSingleThreadedUtility c-tor) // 3. Create utility std::unique_ptr&lt;ClassicSingleThreadedUtility&gt; emptyUnique; auto utilityUnique = std::make_unique&lt;ClassicSingleThreadedUtility&gt;(); // This guarantee destruction in order: // - utilityUnique; // - singleton; // - emptyUnique. // This order is correct int main() { return 0; }</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">рдХрдВрд╕реЛрд▓ рдЖрдЙрдЯрдкреБрдЯ</b> <div class="spoiler_text">  рдЙрджрд╛рд╣рд░рдг () <br>  рд╕рд┐рдВрдЧрд▓рдЯрдирдХреНрд▓рд╛рд╕рд┐рдХ () <br>  рдЙрджрд╛рд╣рд░рдг () <br>  ~ рд╕рд┐рдВрдЧрд▓рдЯрдирдХреНрд▓рд╛рд╕рд┐рдХ () <br></div></div><br>  рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рдореЗрдВ рд╕рд┐рдВрдЧрд▓рдЯрди рдХреЛ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмреБрд▓рд╛рддреА рд╣реИ рдХрд┐ рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдмрдирдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд╕рд┐рдВрдЧрд▓рдЯрди рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред <br><br>  рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреЛ std :: unique_ptr рдмрдирд╛рддрд╛ рд╣реИ: рдПрдХ рдЦрд╛рд▓реА, рджреВрд╕рд░рд╛ рдЬрд┐рд╕рдореЗрдВ рдЙрдкрдпреЛрдЧрд┐рддрд╛ рд╣реИред <br><br>  рдирд┐рд░реНрдорд╛рдг рдХрд╛ рдХреНрд░рдо: <br><br>  - рдЦрд╛рд▓реА рдПрд╕рдЯреАрдбреА :: unique_ptrред <br>  - рд╕рд┐рдВрдЧрд▓рдЯрди; <br>  - рдЙрдкрдпреЛрдЧрд┐рддрд╛ред <br><br>  рдФрд░ рддрджрдиреБрд╕рд╛рд░, рд╡рд┐рдирд╛рд╢ рдХрд╛ рдХреНрд░рдо: <br><br>  - рдЙрдкрдпреЛрдЧрд┐рддрд╛; <br>  - рд╕рд┐рдВрдЧрд▓рдЯрди; <br>  - рдЦрд╛рд▓реА рдПрд╕рдЯреАрдбреА :: unique_ptrред <br><br>  рдпреВрдЯрд┐рд▓рд┐рдЯреА рдбрд┐рд╕реНрдЯреНрд░рдХреНрдЯрд░ рд╕реЗ рд╕рд┐рдВрдЧрд▓рдЯрди рдкрд░ рдХреЙрд▓ рд╕рд╣реА рд╣реИред <br><br><h3>  рд╕рд┐рдВрдЧрд▓рдЯрдирдХреНрд▓рд╛рд╕рд┐рдХ рдЙрджрд╛рд╣рд░рдг 2 </h3><br>  рд╕рдм рдХреБрдЫ рд╕рдорд╛рди рд╣реИ, рд▓реЗрдХрд┐рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдиреЗ рдЗрд╕реЗ рд▓реЗ рд▓рд┐рдпрд╛ рдФрд░ рдПрдХ рдкрдВрдХреНрддрд┐ рдХреЗ рд╕рд╛рде рд╕рдм рдХреБрдЫ рдмрд░реНрдмрд╛рдж рдХрд░ рджрд┐рдпрд╛ред <br><br><div class="spoiler">  <b class="spoiler_title">Classic_Example2_incorrect.cpp</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SingletonClassic.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Payload.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;memory&gt; class ClassicSingleThreadedUtility { public: ClassicSingleThreadedUtility() { // To ensure that singleton will be constucted before utility SingletonClassic&lt;Payload&gt;::instance(); } ~ClassicSingleThreadedUtility() { auto &amp;instance = SingletonClassic&lt;Payload&gt;::instance(); for ( int i = 0; i &lt; 100; ++i ) instance.add(i); } }; // 1. Create an empty unique_ptr // 2. Create singleton (because of modified ClassicSingleThreadedUtility c-tor) // 3. Create utility std::unique_ptr&lt;ClassicSingleThreadedUtility&gt; emptyUnique; auto utilityUnique = std::make_unique&lt;ClassicSingleThreadedUtility&gt;(); // This guarantee destruction in order: // - utilityUnique; // - singleton; // - emptyUnique. // This order seems to be correct ... int main() { // ... but user swaps unique_ptrs emptyUnique.swap(utilityUnique); // Guaranteed destruction order is still the same: // - utilityUnique; // - singleton; // - emptyUnique, // but now utilityUnique is empty, and emptyUnique is filled, // so destruction order is incorrect return 0; }</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">рдХрдВрд╕реЛрд▓ рдЖрдЙрдЯрдкреБрдЯ</b> <div class="spoiler_text">  рдЙрджрд╛рд╣рд░рдг () <br>  рд╕рд┐рдВрдЧрд▓рдЯрдирдХреНрд▓рд╛рд╕рд┐рдХ () <br>  ~ рд╕рд┐рдВрдЧрд▓рдЯрдирдХреНрд▓рд╛рд╕рд┐рдХ () <br>  рдЙрджрд╛рд╣рд░рдг () <br></div></div><br>  рд╕реГрд╖реНрдЯрд┐ рдФрд░ рд╡рд┐рдирд╛рд╢ рдХрд╛ рдХреНрд░рдо рд╕рдВрд░рдХреНрд╖рд┐рдд рд╣реИред  рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рд╕рдм рдХреБрдЫ рдЕрднреА рднреА рд╣реИред  рд▓реЗрдХрд┐рди рдирд╣реАрдВред  рдЦрд╛рд▓реА рдпреВрдиреАрдХ.рд╕реНрд╡рд╛рдк (рдпреВрдЯрд┐рд▓рд┐рдЯреА) рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдХреЗ, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдиреЗ рдЕрдкрд░рд┐рднрд╛рд╖рд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд┐рдпрд╛ред <br><br>  <b>рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдиреЗ рдРрд╕реА рдореВрд░реНрдЦрддрд╛рдкреВрд░реНрдг рдмрд╛рддреЗрдВ рдХреНрдпреЛрдВ рдХреАрдВ?</b>  рдХреНрдпреЛрдВрдХрд┐ рдЙрдиреНрд╣реЗрдВ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреА рдЖрдВрддрд░рд┐рдХ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреБрдЫ рднреА рдкрддрд╛ рдирд╣реАрдВ рд╣реИ, рдЬрд┐рд╕рдиреЗ рдЙрдиреНрд╣реЗрдВ рдПрдХ рдПрдХрд▓ рдФрд░ рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдкреНрд░рджрд╛рди рдХреАред <br><br>  <b>рдФрд░ рдпрджрд┐ рдЖрдк рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреА рдЖрдВрддрд░рд┐рдХ рд╕рдВрд░рдЪрдирд╛ рдХреЛ рдЬрд╛рдирддреЗ рд╣реИрдВ?</b>  ... рдлрд┐рд░ рд╡реИрд╕реЗ рднреА, рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдХреЛрдб рдореЗрдВ рдЗрд╕реЗ рд╢рд╛рдорд┐рд▓ рдХрд░рдирд╛ рдмрд╣реБрдд рдЖрд╕рд╛рди рд╣реИред  рдФрд░ рдЖрдкрдХреЛ рджрд░реНрджрдирд╛рдХ рдмрд╣рд╕ рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рдирд╛ рд╣реЛрдЧрд╛, рдХреНрдпреЛрдВрдХрд┐  рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдХреНрдпрд╛ рд╣реБрдЖ рдЖрд╕рд╛рди рдирд╣реАрдВ рд╣реЛрдЧрд╛ред <br><br>  <b>рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреНрдпреЛрдВ рдирд╣реАрдВ рд╣реИ?</b>  <b>рдЦреИрд░, рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреЗ рдЧреЛрджреА рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг ...</b> рдФрд░ рдХреНрдпреЛрдВ рдирд╣реАрдВ рдПрдХ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдмрдирд╛рдпрд╛ рдЬрд╛рдП рдЬреЛ рдЦрд░рд╛рдм рдХрд░рдирд╛ рдЗрддрдирд╛ рдЖрд╕рд╛рди рдирд╣реАрдВ рд╣реИ? <br><br><h3>  рд╕рд┐рдВрдЧреНрд▓рдЯрдирдХреНрд▓рд╛рд╕рд┐рдХ рдЙрджрд╛рд╣рд░рдг 3 </h3><br>  рдХрдИ рджрд┐рдиреЛрдВ рддрдХ рд▓реЗрдЦ рддреИрдпрд╛рд░ рдХрд░рдиреЗ рдХреЗ рджреМрд░рд╛рди, рдореЗрд░рд╛ рдорд╛рдирдирд╛ тАЛтАЛрдерд╛ рдХрд┐ рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдкрд░рдд рдореЗрдВ рдкрд┐рдЫрд▓реЗ рдЙрджрд╛рд╣рд░рдг рд╕реЗ рдЕрдирд┐рд╢реНрдЪрд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░рдирд╛ рдЕрд╕рдВрднрд╡ рдерд╛, рдФрд░ рд╕рдорд╛рдзрд╛рди рдХреЗрд╡рд▓ рд╕рд┐рдВрдЧрд▓рдЯрди рдкрд░рдд рдореЗрдВ рдЙрдкрд▓рдмреНрдз рдерд╛ред  рд▓реЗрдХрд┐рди рд╕рдордп рдХреЗ рд╕рд╛рде, рдПрдХ рд╕рдорд╛рдзрд╛рди рдлрд┐рд░ рднреА рдЖрдпрд╛ред <br><br>  рдХреЛрдб рдФрд░ рд╕реНрдкрд╖реНрдЯреАрдХрд░рдг рдХреЗ рд╕рд╛рде рд╕реНрдкреЙрдЗрд▓рд░ рдЦреЛрд▓рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдореИрдВ рдкрд╛рдардХ рдХреЛ рд╕реБрдЭрд╛рд╡ рджреЗрддрд╛ рд╣реВрдВ рдХрд┐ рд╡реЗ рдЕрдкрдиреЗ рджрдо рдкрд░ рд╕реНрдерд┐рддрд┐ рд╕реЗ рдмрд╛рд╣рд░ рдХрд╛ рд░рд╛рд╕реНрддрд╛ рдЦреЛрдЬрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ (рдХреЗрд╡рд▓ рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдкрд░рдд рдореЗрдВ!)ред  рдореИрдВ рдмрд╛рд╣рд░ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реВрдВ рдХрд┐ рдмреЗрд╣рддрд░ рд╕рдорд╛рдзрд╛рди рд╣реИрдВред <br><br><div class="spoiler">  <b class="spoiler_title">Classic_Example3_correct.cpp</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SingletonClassic.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Payload.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;memory&gt; #include &lt;iostream&gt; class ClassicSingleThreadedUtility { public: ClassicSingleThreadedUtility() { thread_local auto flag_strong = std::make_shared&lt;char&gt;(0); m_flag_weak = flag_strong; SingletonClassic&lt;Payload&gt;::instance(); } ~ClassicSingleThreadedUtility() { if ( !m_flag_weak.expired() ) { auto &amp;instance = SingletonClassic&lt;Payload&gt;::instance(); for ( int i = 0; i &lt; 100; ++i ) instance.add(i); } } private: std::weak_ptr&lt;char&gt; m_flag_weak; }; // 1. Create an empty unique_ptr // 2. Create singleton (because of modified ClassicSingleThreadedUtility c-tor) // 3. Create utility std::unique_ptr&lt;ClassicSingleThreadedUtility&gt; emptyUnique; auto utilityUnique = std::make_unique&lt;ClassicSingleThreadedUtility&gt;(); // This guarantee destruction in order: // - utilityUnique; // - singleton; // - emptyUnique. // This order seems to be correct ... int main() { // ... but user swaps unique_ptrs emptyUnique.swap(utilityUnique); { // To demonstrate normal processing before application ends auto utility = ClassicSingleThreadedUtility(); } // Guaranteed destruction order is still the same: // - utilityUnique; // - singleton; // - emptyUnique, // but now utilityUnique is empty, and emptyUnique is filled, // so destruction order is incorrect ... // ... but utility uses a variable with thread storage duration to detect thread termination. return 0; }</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">рдХрдВрд╕реЛрд▓ рдЖрдЙрдЯрдкреБрдЯ</b> <div class="spoiler_text">  рдЙрджрд╛рд╣рд░рдг () <br>  рд╕рд┐рдВрдЧрд▓рдЯрдирдХреНрд▓рд╛рд╕рд┐рдХ () <br>  рдЙрджрд╛рд╣рд░рдг () <br>  рдЙрджрд╛рд╣рд░рдг () <br>  ~ рд╕рд┐рдВрдЧрд▓рдЯрдирдХреНрд▓рд╛рд╕рд┐рдХ () <br></div></div><br><div class="spoiler">  <b class="spoiler_title">рд╕реНрдкрд╖реНрдЯреАрдХрд░рдг</b> <div class="spoiler_text">  рд╕рдорд╕реНрдпрд╛ рдХреЗрд╡рд▓ рддрдм рд╣реЛрддреА рд╣реИ рдЬрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдХрдо рд╕реЗ рдХрдо рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЬрдм рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЛ рдЫреЛрдЯрд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдкрд╣рдЪрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧрд┐рддрд╛ рд╕рд┐рдЦрд╛рдХрд░ рдЕрдкрд░рд┐рднрд╛рд╖рд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдордиреЗ std :: рд╕рд╛рдЭрд╛_ptr рдкреНрд░рдХрд╛рд░ рдХрд╛ рдлреНрд▓реИрдЧ_рд╕реНрдЯреНрд░реЙрдиреНрдЧ рд╡реИрд░рд┐рдПрдмрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛, рдЬрд┐рд╕рдореЗрдВ рдереНрд░реЗрдб рд╕реНрдЯреЛрд░реЗрдЬ рдХреА рдЕрд╡рдзрд┐ рдХреНрд╡рд╛рд▓рд┐рдлрд╛рдпрд░ рд╣реИ (рдКрдкрд░ рдЖрд▓реЗрдЦ рдореЗрдВ рдорд╛рдирдХ рд╕реЗ рдЕрдВрд╢ рджреЗрдЦреЗрдВ) - рдпрд╣ рдПрдХ рд╕реНрдЯреЗрдЯрд┐рдХ рдХреА рддрд░рд╣ рд╣реИ, рд▓реЗрдХрд┐рди рдХреЗрд╡рд▓ рддрдм рдирд╖реНрдЯ рд╣реЛрддрд╛ рд╣реИ рдЬрдм <b>рд╕реНрдЯреИрдЯрд┐рдХреНрд╕ рдирд╖реНрдЯ</b> рд╣реЛрдиреЗ <b>рд╕реЗ рдкрд╣рд▓реЗ рд╕реНрдЯреИрдЯрд┐рдХреНрд╕ рдХреЗ рдХрд┐рд╕реА рднреА рдирд╖реНрдЯ</b> рд╣реЛрдиреЗ <b>рд╕реЗ рдкрд╣рд▓реЗ</b> рд╕рдорд╛рдкреНрдд <b>рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ</b> ред рд╕рд┐рдВрдЧрд▓рдЯрдиред  рдлреНрд▓реИрдЧ_рд╕реНрдЯреНрд░реЙрдиреНрдЧ рд╡реЗрд░рд┐рдПрдмрд▓ рд╕рдВрдкреВрд░реНрдг рд╕реНрдЯреНрд░реАрдо рдХреЗ рд▓рд┐рдП рдПрдХ рд╣реИ, рдФрд░ рдпреВрдЯрд┐рд▓рд┐рдЯреА рдХрд╛ рдкреНрд░рддреНрдпреЗрдХ рдЙрджрд╛рд╣рд░рдг рдЗрд╕рдХреА рдХрдордЬреЛрд░ рдХреЙрдкреА рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИред <br><br>  рд╕рдВрдХреАрд░реНрдг рдЕрд░реНрде рдореЗрдВ, рд╕рдорд╛рдзрд╛рди рдХреЛ рд╣реИрдХ рдХрд╣рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐  рдпрд╣ рдЕрдкреНрд░рддреНрдпрдХреНрд╖ рдФрд░ рдЧреИрд░-рд╕реНрдкрд╖реНрдЯ рд╣реИред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдпрд╣ рдмрд╣реБрдд рдЬрд▓реНрджреА рдЪреЗрддрд╛рд╡рдиреА рджреЗрддрд╛ рд╣реИ, рдФрд░ рдХрднреА-рдХрднреА (рдПрдХ рдмрд╣реБ-рдереНрд░реЗрдбреЗрдб рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ) рдЖрдо рддреМрд░ рдкрд░ рдЧрд▓рдд рдЪреЗрддрд╛рд╡рдиреА рджреЗрддрд╛ рд╣реИред  рд▓реЗрдХрд┐рди рдПрдХ рд╡реНрдпрд╛рдкрдХ рдЕрд░реНрде рдореЗрдВ, рдпрд╣ рд╣реИрдХ рдирд╣реАрдВ рд╣реИ, рдмрд▓реНрдХрд┐ рдорд╛рдирдХ рдЧреБрдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдПрдХ рд╕рдорд╛рдзрд╛рди рд╣реИ - рдиреБрдХрд╕рд╛рди рдФрд░ рдлрд╛рдпрджреЗ рджреЛрдиреЛрдВред <br></div></div><br><h3>  SingletonShared </h3><br>  рдЪрд▓рд┐рдП std :: shared_ptr рдкрд░ рдЖрдзрд╛рд░рд┐рдд рдПрдХ рд╕рдВрд╢реЛрдзрд┐рдд рд╕рд┐рдВрдЧрд▓рдЯрди рдкрд░ рдЪрд▓рддреЗ рд╣реИрдВред <br><br><div class="spoiler">  <b class="spoiler_title">SingletonShared.h</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> once #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;memory&gt; #include &lt;iostream&gt; template&lt;typename T&gt; class SingletonShared : public T { public: ~SingletonShared() { std::cout &lt;&lt; "~SingletonShared()" &lt;&lt; std::endl; } SingletonShared(const SingletonShared &amp;) = delete; SingletonShared(SingletonShared &amp;&amp;) = delete; SingletonShared&amp; operator=(const SingletonShared &amp;) = delete; SingletonShared&amp; operator=(SingletonShared &amp;&amp;) = delete; static std::shared_ptr&lt;SingletonShared&gt; instance() { std::cout &lt;&lt; "instance()" &lt;&lt; std::endl; // "new" and no std::make_shared because of private c-tor static auto inst = std::shared_ptr&lt;SingletonShared&gt;(new SingletonShared); return inst; } private: SingletonShared() { std::cout &lt;&lt; "SingletonShared()" &lt;&lt; std::endl; } };</span></span></span></span></code> </pre><br></div></div><br>  <b>рдПрдЖрдИ-рдП-рдЖрдИ, рдирдП рдСрдкрд░реЗрдЯрд░ рдХреЛ рдЖрдзреБрдирд┐рдХ рдХреЛрдб рдореЗрдВ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЗрд╕рдХреЗ рдмрдЬрд╛рдп std :: make_sared рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ!</b>  рдФрд░ рдЗрд╕реЗ рд╕рд┐рдВрдЧрд▓рдЯрди рдХреЗ рдирд┐рдЬреА рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рджреНрд╡рд╛рд░рд╛ рд░реЛрдХрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br>  <b>рд╣рд╛!</b>  <b>рдореБрдЭреЗ рднреА рдПрдХ рд╕рдорд╕реНрдпрд╛ рд╣реИ!</b>  <b>Decdare std :: make_sared рдПрдХ рд╕рд┐рдВрдЧрд▓рдЯрди рдлреНрд░реАрдб!</b>  ... рдФрд░ рдПрдВрдЯреАрдкрд╛рд░реНрдЯрд░реНрди рдкрдмреНрд▓рд┐рдХрдореЛрд░реЛрдЬрд╝реЛрд╡ рдХреА рдПрдХ рд╡рд┐рд╡рд┐рдзрддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ: рдПрдХ рд╣реА рдПрд╕рдЯреАрдбреА :: рдореЗрдХ_рд╢реЗрдпрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдПрдХрд▓ рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд рдЙрджрд╛рд╣рд░рдг рдмрдирд╛рдирд╛ рд╕рдВрднрд╡ рд╣реЛрдЧрд╛ рдЬреЛ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдирд╣реАрдВ рдХрд┐рдП рдЧрдП рд╣реИрдВред <br><br><h3>  рд╕рд┐рдВрдЧрд▓рдЯрдирд╢реЗрдпрд░рд┐рдВрдЧ рдЙрджрд╛рд╣рд░рдг 1 рдФрд░ 2 </h3><br>  рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдХреНрд▓рд╛рд╕рд┐рдХ рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд▓рд┐рдП рдирдВрдмрд░ 1 рдФрд░ 2 рдХреЗ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЗ рдЕрдиреБрд░реВрдк рд╣реИред  рдХреЗрд╡рд▓ рд╕рд┐рдВрдЧрд▓рдЯрди рд▓реЗрдпрд░ рдореЗрдВ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкрд░рд┐рд╡рд░реНрддрди рдХрд┐рдП рдЧрдП рдереЗ, рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдЕрдирд┐рд╡рд╛рд░реНрдп рд░реВрдк рд╕реЗ рд╕рдорд╛рди рдереАред  рдЬрд┐рд╕ рддрд░рд╣ рдХреНрд▓рд╛рд╕рд┐рдХ рд╕рд┐рдВрдЧрд▓рдЯрди рдХреЗ рд╕рд╛рде рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ, рдЙрджрд╛рд╣рд░рдг -1 рд╕рд╣реА рд╣реИ, рдФрд░ рдЙрджрд╛рд╣рд░рдг -2 рдЕрдкрд░рд┐рднрд╛рд╖рд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред <br><br><div class="spoiler">  <b class="spoiler_title">Shared_Example1_correct.cpp</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SingletonShared.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;Payload.h&gt; #include &lt;memory&gt; class SharedSingleThreadedUtility { public: SharedSingleThreadedUtility() { // To ensure that singleton will be constucted before utility SingletonShared&lt;Payload&gt;::instance(); } ~SharedSingleThreadedUtility() { if ( auto instance = SingletonShared&lt;Payload&gt;::instance() ) for ( int i = 0; i &lt; 100; ++i ) instance-&gt;add(i); } }; // 1. Create an empty unique_ptr // 2. Create singleton (because of modified SharedSingleThreadedUtility c-tor) // 3. Create utility std::unique_ptr&lt;SharedSingleThreadedUtility&gt; emptyUnique; auto utilityUnique = std::make_unique&lt;SharedSingleThreadedUtility&gt;(); // This guarantee destruction in order: // - utilityUnique; // - singleton; // - emptyUnique. // This order is correct int main() { return 0; }</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">рдХрдВрд╕реЛрд▓ рдЖрдЙрдЯрдкреБрдЯ</b> <div class="spoiler_text">  рдЙрджрд╛рд╣рд░рдг () <br>  рд╕рд┐рдВрдЧрд▓рдЯрдирд╢реЗрдпрд░ () <br>  рдЙрджрд╛рд╣рд░рдг () <br>  ~ рд╕рд┐рдВрдЧрд▓рдЯрдирд╢реЗрдпрд░рд┐рдВрдЧ () <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Shared_Example2_incorrect.cpp</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SingletonShared.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Payload.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;memory&gt; class SharedSingleThreadedUtility { public: SharedSingleThreadedUtility() { // To ensure that singleton will be constucted before utility SingletonShared&lt;Payload&gt;::instance(); } ~SharedSingleThreadedUtility() { // Sometimes this check may result as "false" even for destroyed singleton // preventing from visual effects of undefined behaviour ... //if ( auto instance = SingletonShared::instance() ) // for ( int i = 0; i &lt; 100; ++i ) // instance-&gt;add(i); // ... so this code will demonstrate UB in colour auto instance = SingletonShared&lt;Payload&gt;::instance(); for ( int i = 0; i &lt; 100; ++i ) instance-&gt;add(i); } }; // 1. Create an empty unique_ptr // 2. Create singleton (because of modified SharedSingleThreadedUtility c-tor) // 3. Create utility std::unique_ptr&lt;SharedSingleThreadedUtility&gt; emptyUnique; auto utilityUnique = std::make_unique&lt;SharedSingleThreadedUtility&gt;(); // This guarantee destruction in order: // - utilityUnique; // - singleton; // - emptyUnique. // This order seems to be correct ... int main() { // ... but user swaps unique_ptrs emptyUnique.swap(utilityUnique); // Guaranteed destruction order is the same: // - utilityUnique; // - singleton; // - emptyUnique, // but now utilityUnique is empty, and emptyUnique is filled, // so destruction order is incorrect return 0; }</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">рдХрдВрд╕реЛрд▓ рдЖрдЙрдЯрдкреБрдЯ</b> <div class="spoiler_text">  рдЙрджрд╛рд╣рд░рдг () <br>  рд╕рд┐рдВрдЧрд▓рдЯрдирд╢реЗрдпрд░ () <br>  ~ рд╕рд┐рдВрдЧрд▓рдЯрдирд╢реЗрдпрд░рд┐рдВрдЧ () <br>  рдЙрджрд╛рд╣рд░рдг () <br></div></div><br><h3>  рд╕рд┐рдВрдЧрд▓рдЯрди рдЙрджрд╛рд╣рд░рдг 3 </h3><br>  рдФрд░ рдЕрдм рд╣рдо рдХреНрд▓рд╛рд╕рд┐рдХреНрд╕ рд╕реЗ рдЙрджрд╛рд╣рд░рдг рд╕рдВрдЦреНрдпрд╛ 3 рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХреЛ рдареАрдХ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВрдЧреЗред <br>  рд╕рдорд╛рдзрд╛рди рд╕реНрдкрд╖реНрдЯ рд╣реИ: рдЖрдкрдХреЛ рдХреЗрд╡рд▓ рдПрдХ рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ std :: share_ptr рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдореЗрдВ рд╕рд┐рдВрдЧрд▓рдЯрди рджреНрд╡рд╛рд░рд╛ рд▓реМрдЯрд╛рдХрд░ рд╕рд┐рдВрдЧрд▓рдЯрди рдХреЗ рдЬреАрд╡рди рдХрд╛ рд╡рд┐рд╕реНрддрд╛рд░ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдФрд░ рд╕рд┐рдВрдЧрд▓рдЯрди рдХреЗ рд╕рд╛рде рдкреВрд░рд╛ рд╣реЛрдиреЗ рд╡рд╛рд▓рд╛ рдпрд╣ рд╕рдорд╛рдзрд╛рди, рдЦреБрд▓реЗ рд╕реНрд░реЛрддреЛрдВ рдореЗрдВ рд╡реНрдпрд╛рдкрдХ рд░реВрдк рд╕реЗ рджреЛрд╣рд░рд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред <br><br><div class="spoiler">  <b class="spoiler_title">Shared_Example3_correct.cpp</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SingletonShared.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Payload.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;memory&gt; class SharedSingleThreadedUtility { public: SharedSingleThreadedUtility() // To ensure that singleton will be constucted before utility : m_singleton(SingletonShared&lt;Payload&gt;::instance()) { } ~SharedSingleThreadedUtility() { // Sometimes this check may result as "false" even for destroyed singleton // preventing from visual effects of undefined behaviour ... //if ( m_singleton ) // for ( int i = 0; i &lt; 100; ++i ) // m_singleton-&gt;add(i); // ... so this code will allow to demonstrate UB in colour for ( int i = 0; i &lt; 100; ++i ) m_singleton-&gt;add(i); } private: // A copy of smart pointer, not a reference std::shared_ptr&lt;SingletonShared&lt;Payload&gt;&gt; m_singleton; }; // 1. Create an empty unique_ptr // 2. Create singleton (because of SharedSingleThreadedUtility c-tor) // 3. Create utility std::unique_ptr&lt;SharedSingleThreadedUtility&gt; emptyUnique; auto utilityUnique = std::make_unique&lt;SharedSingleThreadedUtility&gt;(); int main() { // This guarantee destruction in order: // - utilityUnique; // - singleton; // - emptyUnique. // This order is correct ... // ... but user swaps unique_ptrs emptyUnique.swap(utilityUnique); // Guaranteed destruction order is the same: // - utilityUnique; // - singleton; // - emptyUnique, // but now utilityUnique is empty, and emptyUnique is filled, // so destruction order is incorrect... // ... but utility have made a copy of shared_ptr when it was available, // so it's correct again. return 0; }</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">рдХрдВрд╕реЛрд▓ рдЖрдЙрдЯрдкреБрдЯ</b> <div class="spoiler_text">  рдЙрджрд╛рд╣рд░рдг () <br>  рд╕рд┐рдВрдЧрд▓рдЯрдирд╢реЗрдпрд░ () <br>  ~ рд╕рд┐рдВрдЧрд▓рдЯрдирд╢реЗрдпрд░рд┐рдВрдЧ () <br></div></div><br>  рдФрд░ рдЕрдм, рдзреНрдпрд╛рди, рд╕рд╡рд╛рд▓ рдпрд╣ рд╣реИ: <b>рдХреНрдпрд╛ рдЖрдк рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдПрдХ рд╕рд┐рдВрдЧрд▓рдЯрди рдХреЗ рдЬреАрд╡рди рдХрд╛ рд╡рд┐рд╕реНрддрд╛рд░ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рдереЗ?</b> <br>  рдпрд╛ рдХреНрдпрд╛ рдЖрдк рдЕрдирд┐рд╢реНрдЪрд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░ рд╕реЗ рдЫреБрдЯрдХрд╛рд░рд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рдФрд░ рд╕рддрд╣ рдкрд░ рдЭреВрда рдмреЛрд▓рдиреЗ рдХреЗ рддрд░реАрдХреЗ рдХреЗ рд░реВрдк рдореЗрдВ рдЬреАрд╡рди рд╡рд┐рд╕реНрддрд╛рд░ рдХрд╛ рдЪрдпрди рдХрд░рддреЗ рд╣реИрдВ? <br><br>  рд╕рд╛рдзрдиреЛрдВ рджреНрд╡рд╛рд░рд╛ рд▓рдХреНрд╖реНрдпреЛрдВ рдХреЗ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди рдХреЗ рд░реВрдк рдореЗрдВ рд╕реИрджреНрдзрд╛рдВрддрд┐рдХ рдЧрд▓рддрдлрд╣рдореА рдЧрддрд┐рд░реЛрдз (рдпрд╛ рдЪрдХреНрд░реАрдп рд╕рдВрджрд░реНрдн - рдЬрд┐рд╕реЗ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдЙрд╕реЗ рдХреЙрд▓ рдХрд░реЗрдВ) рдХрд╛ рдЬреЛрдЦрд┐рдо рд╣реЛрддрд╛ рд╣реИред <br><br>  <b>рд╣рд╛рдБ, рдиреВрдКрдКрдКрдК, рдпрд╣ рдЖрдкрдХреЛ рдЗрддрдирд╛ рдХрдард┐рди рдкреНрд░рдпрд╛рд╕ рдХрд░рдирд╛ рд╣реИ!</b>  <b>рдЖрдкрдХреЛ рдЗрддрдиреЗ рд▓рдВрдмреЗ рд╕рдордп рдХреЗ рд╕рд╛рде рдЖрдирд╛ рд╣реЛрдЧрд╛, рдФрд░ рдЖрдк рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рдЗрд╕реЗ рджреБрд░реНрдШрдЯрдирд╛ рд╕реЗ рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗ!</b> <br><br><div class="spoiler">  <b class="spoiler_title">CallbackPayload.h</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> once #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;functional&gt; class CallbackPayload { public: CallbackPayload() = default; ~CallbackPayload() = default; CallbackPayload(const CallbackPayload &amp;) = delete; CallbackPayload(CallbackPayload &amp;&amp;) = delete; CallbackPayload&amp; operator=(const CallbackPayload &amp;) = delete; CallbackPayload&amp; operator=(CallbackPayload &amp;&amp;) = delete; void setCallback(std::function&lt;void()&gt; &amp;&amp;fn) { m_callbackFn = std::move(fn); } private: std::function&lt;void()&gt; m_callbackFn; };</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">SomethingWithVeryImportantDestructor.h</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> once #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;iostream&gt; class SomethingWithVeryImportantDestructor { public: SomethingWithVeryImportantDestructor() { std::cout &lt;&lt; "SomethingWithVeryImportantDestructor()" &lt;&lt; std::endl; } ~SomethingWithVeryImportantDestructor() { std::cout &lt;&lt; "~SomethingWithVeryImportantDestructor()" &lt;&lt; std::endl; } SomethingWithVeryImportantDestructor(const SomethingWithVeryImportantDestructor &amp;) = delete; SomethingWithVeryImportantDestructor(SomethingWithVeryImportantDestructor &amp;&amp;) = delete; SomethingWithVeryImportantDestructor&amp; operator=(const SomethingWithVeryImportantDestructor &amp;) = delete; SomethingWithVeryImportantDestructor&amp; operator=(SomethingWithVeryImportantDestructor &amp;&amp;) = delete; };</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Shared_Example4_incorrect.cpp</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SingletonShared.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"CallbackPayload.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SomethingWithVeryImportantDestructor.h"</span></span></span><span class="hljs-meta"> class SharedSingleThreadedUtility { public: SharedSingleThreadedUtility() </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// To ensure that singleton will be constucted before utility : m_singleton(SingletonShared&lt;CallbackPayload&gt;::instance()) { std::cout &lt;&lt; "SharedSingleThreadedUtility()" &lt;&lt; std::endl; } ~SharedSingleThreadedUtility() { std::cout &lt;&lt; "~SharedSingleThreadedUtility()" &lt;&lt; std::endl; } void setCallback(std::function&lt;void()&gt; &amp;&amp;fn) { if ( m_singleton ) m_singleton-&gt;setCallback(std::move(fn)); } private: // A copy of smart pointer, not a reference std::shared_ptr&lt;SingletonShared&lt;CallbackPayload&gt;&gt; m_singleton; }; int main() { auto utility = std::make_shared&lt;SharedSingleThreadedUtility&gt;(); auto something = std::make_shared&lt;SomethingWithVeryImportantDestructor&gt;(); // lambda with "utility" and "something" captured utility-&gt;setCallback( [utility, something](){} ); return 0; }</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">рдХрдВрд╕реЛрд▓ рдЖрдЙрдЯрдкреБрдЯ</b> <div class="spoiler_text">  рдЙрджрд╛рд╣рд░рдг () <br>  рд╕рд┐рдВрдЧрд▓рдЯрдирд╢реЗрдпрд░ () <br>  SharedSingleThreadedUtility () <br>  рд╕рдордерд┐рдВрдЧрд╡рд░реНрдердЗрдореНрдкреЛрд░реНрдЯреЗрдВрдЯрдбрд┐рд╕реНрдЯреНрд░рдХреНрдЯрд░ () <br></div></div><br>  рдПрдХ рд╕рд┐рдВрдЧрд▓рдЯрди рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ред <br><br>  рдПрдХ рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдмрдирд╛рдИ рдЧрдИ рд╣реИред <br><br>  <b>рдХреБрдЫ рдПрд╕-рд╡реЗрд░реА-рдорд╣рддреНрд╡рдкреВрд░реНрдг-рд╡рд┐рдирд╛рд╢рдХрд╛рд░реА рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛</b> (рдореИрдВрдиреЗ рдЗрд╕реЗ рдбрд░рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЬреЛрдбрд╝рд╛ <b>рдерд╛</b> , рдХреНрдпреЛрдВрдХрд┐ рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд░ "рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ" рдЬреИрд╕реЗ рдкреЛрд╕реНрдЯ рд╣реИрдВ, рд╕рд┐рдВрдЧрд▓рдЯрди рдбрд┐рд╕реНрдЯреНрд░реЙрдХреНрдЯрд░ рдХреЛ рдирд╣реАрдВ рдмреБрд▓рд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдХреНрдпрд╛ рд╣реИ, рдпрд╣ рд╣рд░ рд╕рдордп рдореМрдЬреВрдж рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд╛рд░реНрдпрдХреНрд░рдо тАЭ)ред <br><br>  рд▓реЗрдХрд┐рди рдЗрдирдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рднреА рд╡рд╕реНрддреБ рдХреЗ рд▓рд┐рдП рдХреЛрдИ рд╡рд┐рдзреНрд╡рдВрд╕рдХ рдирд╣реАрдВ рдХрд╣рд╛ рдЧрдпрд╛! <br><br>  рдХрд┐рд╕ рд╡рдЬрд╣ рд╕реЗ?  рд╕рд╛рдзрдиреЛрдВ рджреНрд╡рд╛рд░рд╛ рд▓рдХреНрд╖реНрдпреЛрдВ рдХреЗ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди рдХреЗ рдХрд╛рд░рдгред <br><br><h3>  SingletonWeak </h3><br><div class="spoiler">  <b class="spoiler_title">SingletonWeak.h</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> once #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;memory&gt; #include &lt;iostream&gt; template&lt;typename T&gt; class SingletonWeak : public T { public: ~SingletonWeak() { std::cout &lt;&lt; "~SingletonWeak()" &lt;&lt; std::endl; } SingletonWeak(const SingletonWeak &amp;) = delete; SingletonWeak(SingletonWeak &amp;&amp;) = delete; SingletonWeak&amp; operator=(const SingletonWeak &amp;) = delete; SingletonWeak&amp; operator=(SingletonWeak &amp;&amp;) = delete; static std::weak_ptr&lt;SingletonWeak&gt; instance() { std::cout &lt;&lt; "instance()" &lt;&lt; std::endl; // "new" and no std::make_shared because of private c-tor static auto inst = std::shared_ptr&lt;SingletonWeak&gt;(new SingletonWeak); return inst; } private: SingletonWeak() { std::cout &lt;&lt; "SingletonWeak()" &lt;&lt; std::endl; } };</span></span></span></span></code> </pre><br></div></div><br>  рдЦреБрд▓реЗ рд╕реНрд░реЛрддреЛрдВ рдореЗрдВ рд╕рд┐рдВрдЧрд▓рдЯрди рдХрд╛ рдРрд╕рд╛ рд╕рдВрд╢реЛрдзрди, рдпрджрд┐ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рдЕрдХреНрд╕рд░ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред  рдореИрдВ рдХреБрдЫ рдЕрдЬреАрдм рддрд░рд╣ рдХреЗ рд╕реНрдЯреИрдб рдХреЗ рд╕рд╛рде рдмрд╛рд╣рд░ рдШреВрдорддрд╛ рд╣реБрдЖ рдорд┐рд▓рд╛: рдХрдордЬреЛрд░_рдкреНрд░рддрд┐, рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, рдЬреЛ, рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ, рдПрдХ рд╕рд┐рдВрдЧрд▓рдЯрди рдХреЗ рдЬреАрд╡рди рдХреЛ рд▓рдореНрдмрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧрд┐рддрд╛ рд╕реЗ рдЕрдзрд┐рдХ рдХреБрдЫ рдирд╣реАрдВ рд╣реИ: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Std :: weak_ptr рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдПрдХрд▓</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХреНрдпрд╛ рдпрд╣ рдХрдордЬреЛрд░_рдкрд╛рддреНрд░ рджреНрд╡рд╛рд░рд╛ рд╕рд╛рдЗрдирдЧреЗрдЯрди рд╡рд░реНрдЧ рдмрдирд╛рдиреЗ рдХрд╛ рд╕рд╣реА рддрд░реАрдХрд╛ рд╣реИ</a> </li></ul><br>  рд╡рд╣ рд╡рд┐рдХрд▓реНрдк рдЬреЛ рдореИрдВ рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рдХрд░рддрд╛ рд╣реВрдВ, рдЬрдм рд╕рд┐рдВрдЧрд▓рдЯрди рдФрд░ рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдкрд░рддреЛрдВ рдореЗрдВ рд╕рд╣реА рддрд░реАрдХреЗ рд╕реЗ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: <br><br><ul><li>  рдЙрдкрд░реНрдпреБрдХреНрдд рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ рд╡рд░реНрдгрд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкрд░рдд рдореЗрдВ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рдЦрд┐рд▓рд╛рдл рд╕реБрд░рдХреНрд╖рд╛, рдЧрддрд┐рд░реЛрдз рдХреЛ рд░реЛрдХрддрд╛ рд╣реИ; </li><li>  Classic_Example3_correct рдореЗрдВ рдереНрд░реЗрдб_рд▓реЛрдХрд▓ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реЗ рдЕрдзрд┐рдХ рд╕рдЯреАрдХ рд░реВрдк рд╕реЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдлреЛрд▓реНрдбрд┐рдВрдЧ рдХреЗ рдХреНрд╖рдг рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЕрд░реНрдерд╛рдд  рдЖрдкрдХреЛ рдХрд┐рдирд╛рд░реЗ рдХреЗ рдХрд░реАрдм рдЖрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ; </li><li>  рдореИрдВ рд╕рд╛рдзрдиреЛрдВ рдХреЗ рд╕рд╛рде рд▓рдХреНрд╖реНрдпреЛрдВ рдХреЛ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреА рд╕реИрджреНрдзрд╛рдВрддрд┐рдХ рд╕рдорд╕реНрдпрд╛ рд╕реЗ рдЧреНрд░рд╕реНрдд рдирд╣реАрдВ рд╣реВрдБ (рдореБрдЭреЗ рдирд╣реАрдВ рдкрддрд╛ рдХрд┐ рдЧрддрд┐рд░реЛрдз рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдЕрдиреНрдп рдХреЛрдИ рдареЛрд╕ рдЪреАрдЬрд╝ рдЗрд╕ рд╕реИрджреНрдзрд╛рдВрддрд┐рдХ рд╕рдорд╕реНрдпрд╛ рд╕реЗ рдкреНрд░рдХрдЯ рд╣реЛ рд╕рдХрддреА рд╣реИ)ред </li></ul><br>  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдПрдХ рдЦрд╛рдореА рд╣реИ: рдПрдХ рд╕рд┐рдВрдЧрд▓рдЯрди рдХреЗ рдЬреАрд╡рди рдХрд╛ рд╡рд┐рд╕реНрддрд╛рд░ <b>рдЕрднреА рднреА рдЗрд╕реЗ</b> рдХрд┐рдирд╛рд░реЗ рдХреЗ <b>рдХрд░реАрдм</b> рдЖрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ <b>рд╕рдХрддрд╛ рд╣реИ</b> ред <br><br><h3>  рд╕рд┐рдВрдЧрд▓рдЯрди рдЙрджрд╛рд╣рд░рдг 1 </h3><br>  Shared_Example3_correct.cpp рдХреЗ рд╕рдорд╛рдиред <br><br><div class="spoiler">  <b class="spoiler_title">Weak_Example1_correct.cpp</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SingletonWeak.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Payload.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;memory&gt; class WeakSingleThreadedUtility { public: WeakSingleThreadedUtility() // To ensure that singleton will be constucted before utility : m_weak(SingletonWeak&lt;Payload&gt;::instance()) { } ~WeakSingleThreadedUtility() { // Sometimes this check may result as "false" even in case of incorrect usage, // and there's no way to guarantee a demonstration of undefined behaviour in colour if ( auto strong = m_weak.lock() ) for ( int i = 0; i &lt; 100; ++i ) strong-&gt;add(i); } private: // A weak copy of smart pointer, not a reference std::weak_ptr&lt;SingletonWeak&lt;Payload&gt;&gt; m_weak; }; // 1. Create an empty unique_ptr // 2. Create singleton (because of WeakSingleThreadedUtility c-tor) // 3. Create utility std::unique_ptr&lt;WeakSingleThreadedUtility&gt; emptyUnique; auto utilityUnique = std::make_unique&lt;WeakSingleThreadedUtility&gt;(); int main() { // This guarantee destruction in order: // - utilityUnique; // - singleton; // - emptyUnique. // This order is correct ... // ... but user swaps unique_ptrs emptyUnique.swap(utilityUnique); // Guaranteed destruction order is the same: // - utilityUnique; // - singleton; // - emptyUnique, // but now utilityUnique is empty, and emptyUnique is filled, // so destruction order is incorrect... // ... but utility have made a weak copy of shared_ptr when it was available, // so it's correct again. return 0; }</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">рдХрдВрд╕реЛрд▓ рдЖрдЙрдЯрдкреБрдЯ</b> <div class="spoiler_text">  рдЙрджрд╛рд╣рд░рдг () <br>  рд╕рд┐рдВрдЧрд▓рдЯрдирд╡реЙрдХ () <br>  ~ рд╕рд┐рдВрдЧрд▓рдЯрдирд╡реЗрдХ () <br></div></div><br>  <b>рд╣рдореЗрдВ SingletonWeak рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреНрдпреЛрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдХреЛрдИ рднреА рд╡реНрдпрдХреНрддрд┐ рд╕рд┐рдВрдЧрд▓рдЯрди рдХреЗ рд░реВрдк рдореЗрдВ рд╕рд┐рдВрдЧрд▓рдЯрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдХреЛ рдкрд░реЗрд╢рд╛рди рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ?</b>  рд╣рд╛рдВ, рдХреЛрдИ рдкрд░реЗрд╢рд╛рди рдирд╣реАрдВ рдХрд░рддрд╛ред  рдФрд░ рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдХреЛрдИ рднреА рд╕рд┐рдВрдЧрд▓рдЯрди рд╢реЗрд▓реНрдб рдХреЗ рд░реВрдк рдореЗрдВ рд╕рд┐рдВрдЧрд▓рдЯрдирд╡реЗрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдХреЛ рдкрд░реЗрд╢рд╛рди рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред  рд▓реЗрдХрд┐рди рдЙрдирдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдкрдиреЗ рдЗрдЪреНрдЫрд┐рдд рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рд▓рд┐рдП рдХрд░рдирд╛ рдЕрдиреНрдп рдЙрджреНрджреЗрд╢реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдереЛрдбрд╝рд╛ рдЖрд╕рд╛рди рд╣реИред <br><br><h3>  рд╕рд┐рдВрдЧрд▓рдЯрди рдЙрджрд╛рд╣рд░рдг 2 </h3><br>  Shared_Example4_incorrect рдХреЗ рд╕рдорд╛рди, рд▓реЗрдХрд┐рди рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдХреЗрд╡рд▓ рдЧрддрд┐рд░реЛрдз рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред <br><br><div class="spoiler">  <b class="spoiler_title">Weak_Example2_correct.cpp</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SingletonWeak.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"CallbackPayload.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SomethingWithVeryImportantDestructor.h"</span></span></span><span class="hljs-meta"> class WeakSingleThreadedUtility { public: WeakSingleThreadedUtility() </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// To ensure that singleton will be constucted before utility : m_weak(SingletonWeak&lt;CallbackPayload&gt;::instance()) { std::cout &lt;&lt; "WeakSingleThreadedUtility()" &lt;&lt; std::endl; } ~WeakSingleThreadedUtility() { std::cout &lt;&lt; "~WeakSingleThreadedUtility()" &lt;&lt; std::endl; } void setCallback(std::function&lt;void()&gt; &amp;&amp;fn) { if ( auto strong = m_weak.lock() ) strong-&gt;setCallback(std::move(fn)); } private: // A weak copy of smart pointer, not a reference std::weak_ptr&lt;SingletonWeak&lt;CallbackPayload&gt;&gt; m_weak; }; int main() { auto utility = std::make_shared&lt;WeakSingleThreadedUtility&gt;(); auto something = std::make_shared&lt;SomethingWithVeryImportantDestructor&gt;(); // lambda with "utility" and "something" captured utility-&gt;setCallback( [utility, something](){} ); return 0; }</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">рдХрдВрд╕реЛрд▓ рдЖрдЙрдЯрдкреБрдЯ</b> <div class="spoiler_text">  рдЙрджрд╛рд╣рд░рдг () <br>  рд╕рд┐рдВрдЧрд▓рдЯрдирд╡реЙрдХ () <br>  рдХрдордЬрд╝реЛрд░рдкрди <br>  рд╕рдордерд┐рдВрдЧрд╡рд░реНрдердЗрдореНрдкреЛрд░реНрдЯреЗрдВрдЯрдбрд┐рд╕реНрдЯреНрд░рдХреНрдЯрд░ () <br>  ~ рд╕рд┐рдВрдЧрд▓рдЯрдирд╡реЗрдХ () <br>  ~ рд╕рдордерд┐рдВрдЧрд╡рд░реНрдердЗрдореНрдкреЛрд░реНрдЯреЗрдВрдЯрдбрд┐рд╕реНрдЯреНрд░рдХреНрдЯрд░ () <br>  ~ рдХрдордЬрд╝реЛрд░ рдереНрд░реЗрдбреЗрдб рдпреВрдЯрд┐рд▓рд┐рдЯреА () <br></div></div><br><h3>  рдПрдХ рдирд┐рд╖реНрдХрд░реНрд╖ рдХреЗ рдмрдЬрд╛рдп </h3><br>  <b>рдФрд░ рдХреНрдпрд╛, рдПрдХ рд╕рд┐рдВрдЧрд▓рдЯрди рдХрд╛ рдРрд╕рд╛ рд╕рдВрд╢реЛрдзрди рдЕрдкрд░рд┐рднрд╛рд╖рд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░ рджреЗрдЧрд╛?</b>  рдореИрдВрдиреЗ рд╡рд╛рджрд╛ рдХрд┐рдпрд╛ рдХрд┐ рдХреЛрдИ рд╕реБрдЦрдж рдЕрдВрдд рдирд╣реАрдВ рд╣реЛрдЧрд╛ред  рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрджрд╛рд╣рд░рдг рдмрддрд╛рддреЗ рд╣реИрдВ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкрд░рдд рдореЗрдВ рдХреБрд╢рд▓ рддреЛрдбрд╝рдлреЛрдбрд╝ рдХреА рдХрд╛рд░реНрд░рд╡рд╛рдИ рдПрдХ рд╕рд┐рдВрдЧрд▓рдЯрди рдХреЗ рд╕рд╛рде рд╕рд╣реА рд╕реЛрдЪрд╛-рд╕рдордЭрд╛ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЛ рднреА рдирд╖реНрдЯ рдХрд░ рд╕рдХрддреА рд╣реИ (рд▓реЗрдХрд┐рди рд╣рдореЗрдВ рдпрд╣ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ <b>рдпрд╣</b> рд╢рд╛рдпрдж рд╣реА рджреБрд░реНрдШрдЯрдирд╛ рд╕реЗ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ)ред <br><br><div class="spoiler">  <b class="spoiler_title">Shared_Example5_incorrect.cpp</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SingletonShared.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Payload.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;memory&gt; #include &lt;cstdlib&gt; class SharedSingleThreadedUtility { public: SharedSingleThreadedUtility() // To ensure that singleton will be constucted before utility : m_singleton(SingletonShared&lt;Payload&gt;::instance()) { } ~SharedSingleThreadedUtility() { // Sometimes this check may result as "false" even for destroyed singleton // preventing from visual effects of undefined behaviour ... //if ( m_singleton ) // for ( int i = 0; i &lt; 100; ++i ) // m_singleton-&gt;add(i); // ... so this code will allow to demonstrate UB in colour for ( int i = 0; i &lt; 100; ++i ) m_singleton-&gt;add(i); } private: // A copy of smart pointer, not a reference std::shared_ptr&lt;SingletonShared&lt;Payload&gt;&gt; m_singleton; }; void cracker() { SharedSingleThreadedUtility(); } // 1. Register cracker() using std::atexit // 2. Create singleton // 3. Create utility auto reg = [](){ std::atexit(&amp;cracker); return 0; }(); auto utility = SharedSingleThreadedUtility(); // This guarantee destruction in order: // - utility; // - singleton. // This order is correct. // Additionally, there's a copy of shared_ptr in the class instance... // ... but there was std::atexit registered before singleton, // so cracker() will be invoked after destruction of utility and singleton. // There's second try to create a singleton - and it's incorrect. int main() { return 0; }</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">рдХрдВрд╕реЛрд▓ рдЖрдЙрдЯрдкреБрдЯ</b> <div class="spoiler_text">  рдЙрджрд╛рд╣рд░рдг () <br>  рд╕рд┐рдВрдЧрд▓рдЯрдирд╢реЗрдпрд░ () <br>  ~ рд╕рд┐рдВрдЧрд▓рдЯрдирд╢реЗрдпрд░рд┐рдВрдЧ () <br>  рдЙрджрд╛рд╣рд░рдг () <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Weak_Example3_incorrect.cpp</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SingletonWeak.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Payload.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;memory&gt; #include &lt;cstdlib&gt; class WeakSingleThreadedUtility { public: WeakSingleThreadedUtility() // To ensure that singleton will be constucted before utility : m_weak(SingletonWeak&lt;Payload&gt;::instance()) { } ~WeakSingleThreadedUtility() { // Sometimes this check may result as "false" even in case of incorrect usage, // and there's no way to guarantee a demonstration of undefined behaviour in colour if ( auto strong = m_weak.lock() ) for ( int i = 0; i &lt; 100; ++i ) strong-&gt;add(i); } private: // A weak copy of smart pointer, not a reference std::weak_ptr&lt;SingletonWeak&lt;Payload&gt;&gt; m_weak; }; void cracker() { WeakSingleThreadedUtility(); } // 1. Register cracker() using std::atexit // 2. Create singleton // 3. Create utility auto reg = [](){ std::atexit(&amp;cracker); return 0; }(); auto utility = WeakSingleThreadedUtility(); // This guarantee destruction in order: // - utility; // - singleton. // This order is correct. // Additionally, there's a copy of shared_ptr in the class instance... // ... but there was std::atexit registered before singleton, // so cracker() will be invoked after destruction of utility and singleton. // There's second try to create a singleton - and it's incorrect. int main() { return 0; }</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">рдХрдВрд╕реЛрд▓ рдЖрдЙрдЯрдкреБрдЯ</b> <div class="spoiler_text">  рдЙрджрд╛рд╣рд░рдг () <br>  рд╕рд┐рдВрдЧрд▓рдЯрдирд╡реЙрдХ () <br>  ~ рд╕рд┐рдВрдЧрд▓рдЯрдирд╡реЗрдХ () <br>  рдЙрджрд╛рд╣рд░рдг () <br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi455848/">https://habr.com/ru/post/hi455848/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi455834/index.html">рд▓рд┐рдирдХреНрд╕ рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП рдмреЗрдВрдЪрдорд╛рд░реНрдХ: 5 рдЦреБрд▓реЗ рдЙрдкрдХрд░рдг</a></li>
<li><a href="../hi455840/index.html">рдПрдХрд╛рдзрд┐рдХ рдкреНрд░рд╢реНрдиреЛрдВ рдХреЗ рд╕рд╛рде рдХреИрд╕реЗ рдХрд╛рдо рдХрд░реЗрдВред рд░рдЪрдирд╛, Reducer, FP</a></li>
<li><a href="../hi455842/index.html">рдПрдХ рд▓рд┐рдВрдХ рдХреА рдЧрдИ рд╕реВрдЪреА рдХреЛ рдлреИрд▓рд╛рдПрдВред рд╕реНрд╡рд┐рдлреНрдЯ рд╕рдВрд╕реНрдХрд░рдг</a></li>
<li><a href="../hi455844/index.html">рдЙрджрд╛рд╣рд░рдг рдХреЗ рд░реВрдк рдореЗрдВ рдПрдирдХреИрдкреНрд╕реБрд▓реЗрд╢рди рдкрд░реАрдХреНрд╖рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рдПрдХ рд░реЛрд╕рд▓рд┐рди рд╡рд┐рд╢реНрд▓реЗрд╖рдХ рдмрдирд╛рдирд╛</a></li>
<li><a href="../hi455846/index.html">рдЬреВрд▓рд┐рдпрд╛ рдореЗрдВ рд╡рд┐рддрд░рд┐рдд рдХрдореНрдкреНрдпреВрдЯрд┐рдВрдЧ</a></li>
<li><a href="../hi455850/index.html">рд╢реЛрдзрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдЯреВрд▓рдмреЙрдХреНрд╕ - рддреАрд╕рд░рд╛ рд╕рдВрд╕реНрдХрд░рдг: рд╕реВрддреНрд░реЛрдВ рдХреЗ рд╕рд╛рде рдвреВрдБрдврдирд╛ рдФрд░ рдХрд╛рдо рдХрд░рдирд╛</a></li>
<li><a href="../hi455852/index.html">рд╕рд╛рдЗрдирд╕ рдЙрдард╛рдиреЗ рдФрд░ рдПрдХ рд╕рд╛рде рдЖрд░реЛрдкрдг</a></li>
<li><a href="../hi455854/index.html">IOS 13 рдореЗрдВ рдкреНрд░рд╕рдВрдЧ рдореЗрдиреВ рдХреЛ рдХреИрд╕реЗ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рдП</a></li>
<li><a href="../hi455856/index.html">рд╡рд╛рдпрд░рд▓реЗрд╕ рддрд╛рдкрдорд╛рди, рдЖрд░реНрджреНрд░рддрд╛ рдФрд░ рд╡рд╛рдпреБрдордВрдбрд▓реАрдп рджрдмрд╛рд╡ рд╕реЗрдВрд╕рд░ nRF52832 рдкрд░</a></li>
<li><a href="../hi455858/index.html">рд╕рдмрд╕реЗ рдЫреЛрдЯреЗ рдХреЗ рд▓рд┐рдП рдХреЗрдмрд▓ рдЯреАрд╡реА рдиреЗрдЯрд╡рд░реНрдХред рднрд╛рдЧ 9: рд╕рд┐рд░</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>