<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõ∑ üè∞ „äôÔ∏è Chita para redes em Kubernetes: conhecendo e um pouco de experi√™ncia üèÇüèΩ üë§ ‚è∫Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O objetivo do artigo √© apresentar ao leitor os conceitos b√°sicos de rede e gerenciamento de pol√≠ticas de rede no Kubernetes, bem como um plug-in Calic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Chita para redes em Kubernetes: conhecendo e um pouco de experi√™ncia</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/485716/"><img src="https://habrastorage.org/webt/ij/rp/cx/ijrpcxvves8bmv7mgj1uc-ycrvs.png"><br><br>  O objetivo do artigo √© apresentar ao leitor os conceitos b√°sicos de rede e gerenciamento de pol√≠ticas de rede no Kubernetes, bem como um plug-in Calico de terceiros que amplia os recursos padr√£o.  Ao longo do caminho, a conveni√™ncia da configura√ß√£o e alguns recursos ser√£o demonstrados com exemplos reais da experi√™ncia de nossa opera√ß√£o. <a name="habracut"></a><br><br><h2>  Introdu√ß√£o r√°pida ao dispositivo de rede Kubernetes </h2><br>  Um cluster Kubernetes n√£o pode ser imaginado sem uma rede.  J√° publicamos materiais sobre seus fundamentos: ‚Äú <a href="https://habr.com/ru/company/flant/blog/346304/">Um guia ilustrado para redes no Kubernetes</a> ‚Äù e ‚Äú <a href="https://habr.com/ru/company/flant/blog/443190/">Introdu√ß√£o √†s pol√≠ticas de rede Kubernetes para profissionais de seguran√ßa</a> ‚Äù. <br><br>  No contexto deste artigo, √© importante observar que o K8s n√£o √© respons√°vel pela conectividade de rede entre cont√™ineres e n√≥s: todos os tipos de <b>plug-ins CNI</b> (Container Networking Interface) s√£o usados ‚Äã‚Äãpara isso.  <a href="https://habr.com/ru/company/flant/blog/329830/">Tamb√©m conversamos</a> mais sobre esse conceito. <br><br>  Por exemplo, o mais comum desses plug-ins - <a href="https://github.com/coreos/flannel">Flannel</a> - fornece conectividade de rede completa entre todos os n√≥s do cluster levantando pontes em cada n√≥, protegendo uma sub-rede para ele.  No entanto, a disponibilidade total e n√£o regulamentada nem sempre √© √∫til.  Para fornecer um isolamento m√≠nimo no cluster, √© necess√°rio intervir na configura√ß√£o do firewall.  No caso geral, √© dado √† administra√ß√£o da pr√≥pria CNI, devido √† qual qualquer interven√ß√£o de terceiros nas tabelas de ip pode ser interpretada incorretamente ou totalmente ignorada. <br><br>  E <a href="https://kubernetes.io/docs/concepts/services-networking/network-policies/"><b>pronto</b></a> , a <a href="https://kubernetes.io/docs/concepts/services-networking/network-policies/"><b>API NetworkPolicy √©</b></a> fornecida para organizar o gerenciamento de diretivas de rede no cluster Kubernetes.  Esse recurso, que se estende aos namespaces selecionados, pode conter regras para restringir o acesso de um aplicativo para outro.  Tamb√©m permite configurar a acessibilidade entre pods, ambientes (namespaces) ou blocos de endere√ßos IP espec√≠ficos: <br><br><pre><code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: test-network-policy namespace: default spec: podSelector: matchLabels: role: db policyTypes: - Ingress - Egress ingress: - from: - ipBlock: cidr: 172.17.0.0/16 except: - 172.17.1.0/24 - namespaceSelector: matchLabels: project: myproject - podSelector: matchLabels: role: frontend ports: - protocol: TCP port: 6379 egress: - to: - ipBlock: cidr: 10.0.0.0/24 ports: - protocol: TCP port: 5978</code> </pre> <br>  Este n√£o √© o exemplo mais primitivo da <a href="https://kubernetes.io/docs/concepts/services-networking/network-policies/">documenta√ß√£o oficial que</a> pode de uma vez por todas desencorajar o desejo de entender a l√≥gica das pol√≠ticas de rede.  No entanto, ainda tentamos entender os princ√≠pios e m√©todos b√°sicos de processamento de fluxos de tr√°fego usando pol√≠ticas de rede ... <br><br>  √â l√≥gico que existem 2 tipos de tr√°fego: de entrada para o pod (entrada) e de sa√≠da (sa√≠da). <br><br><img src="https://habrastorage.org/webt/a7/zb/-5/a7zb-5tetbhwgbmagjou3liglyg.png"><br><br>  Na verdade, a pol√≠tica √© dividida nessas 2 categorias na dire√ß√£o do movimento. <br><br>  O pr√≥ximo atributo necess√°rio √© um seletor;  aquele a quem a regra se aplica.  Pode ser um pod (ou um grupo de pods) ou um ambiente (ou seja, um espa√ßo para nome).  Um detalhe importante: ambos os tipos desses objetos devem conter um r√≥tulo ( <i>r√≥tulo</i> na terminologia do Kubernetes) - essas s√£o as pol√≠ticas que operam. <br><br>  Al√©m de um n√∫mero finito de seletores unidos por algum r√≥tulo, existe a possibilidade de escrever regras como "Permitir / Negar tudo / Tudo" em diferentes varia√ß√µes.  Para isso, constru√ß√µes do formul√°rio s√£o usadas: <br><br><pre> <code class="plaintext hljs"> podSelector: {} ingress: [] policyTypes: - Ingress</code> </pre> <br>  - neste exemplo, todos os pods do ambiente fecham o tr√°fego de entrada.  O comportamento oposto pode ser alcan√ßado por essa constru√ß√£o: <br><br><pre> <code class="plaintext hljs"> podSelector: {} ingress: - {} policyTypes: - Ingress</code> </pre> <br>  Da mesma forma para sa√≠da: <br><br><pre> <code class="plaintext hljs"> podSelector: {} policyTypes: - Egress</code> </pre> <br>  - para desativ√°-lo.  E aqui est√° o que incluir: <br><br><pre> <code class="plaintext hljs"> podSelector: {} egress: - {} policyTypes: - Egress</code> </pre> <br>  Voltando √† escolha de um plug-in CNI para um cluster, √© importante notar que <b>nem todo plug-in de rede suporta o trabalho com o NetworkPolicy</b> .  Por exemplo, o j√° mencionado Flannel n√£o sabe como configurar pol√≠ticas de rede, conforme <a href="https://github.com/coreos/flannel">explicitamente declarado</a> no reposit√≥rio oficial.  Uma alternativa tamb√©m √© mencionada l√° - o projeto <a href="https://www.projectcalico.org/">Calico</a> Open Source, que estende significativamente a API Kubernetes padr√£o em termos de pol√≠ticas de rede. <br><br><img src="https://habrastorage.org/webt/ut/_g/o1/ut_go1ror_jprp6n0bbwthgdkvs.png"><br><br><h2>  Conhe√ßa Calico: Theory </h2><br>  O plug-in Calico pode ser usado em integra√ß√£o com o Flannel (um subprojeto do <a href="https://github.com/projectcalico/canal">Canal</a> ) ou por conta pr√≥pria, cobrindo os recursos de gerenciamento de disponibilidade e conectividade de rede. <br><br>  Quais recursos a solu√ß√£o in a box K8s e o conjunto de API Calico fornecem? <br><br>  Aqui est√° o que √© incorporado ao NetworkPolicy: <br><br><ul><li>  os pol√≠ticos s√£o limitados pelo meio ambiente; </li><li>  As pol√≠ticas se aplicam aos pods marcados com r√≥tulos. </li><li>  regras podem ser aplicadas a pods, ambientes ou sub-redes; </li><li>  As regras podem conter protocolos, instru√ß√µes de porta nomeadas ou simb√≥licas. </li></ul><br>  E aqui est√° como o Calico estende esses recursos: <br><br><ul><li>  as pol√≠ticas podem ser aplicadas a qualquer objeto: pod, cont√™iner, m√°quina virtual ou interface; </li><li>  as regras podem conter uma a√ß√£o espec√≠fica (proibi√ß√£o, permiss√£o, registro); </li><li>  o destino ou a origem das regras pode ser uma porta, intervalo de portas, protocolos, atributos HTTP ou ICMP, IP ou sub-rede (4 ou 6 gera√ß√µes), qualquer seletor (n√≥s, hosts, ambientes); </li><li>  Al√©m disso, o fluxo de tr√°fego pode ser controlado usando as configura√ß√µes DNAT e as pol√≠ticas de encaminhamento de tr√°fego. </li></ul><br>  O primeiro commit do GitHub no reposit√≥rio Calico data de julho de 2016 e, um ano depois, o projeto assumiu uma posi√ß√£o de lideran√ßa na organiza√ß√£o da conectividade de rede Kubernetes - isso √© indicado, por exemplo, pelos resultados de uma pesquisa <a href="https://thenewstack.io/tigera-aims-ease-connectivity-pain-kubernetes/">realizada pelo The New Stack</a> : <br><br><img src="https://habrastorage.org/webt/0z/nq/8b/0znq8behc5xpv33ynlafbce9kr4.png"><br><br>  Muitas solu√ß√µes grandes gerenciadas com K8s, como <a href="https://docs.aws.amazon.com/en_us/eks/latest/userguide/calico.html">Amazon EKS</a> , <a href="https://docs.microsoft.com/ru-ru/azure/aks/use-network-policies">Azure AKS</a> , <a href="https://cloud.google.com/kubernetes-engine/docs/how-to/network-policy">Google GKE</a> e outros, come√ßaram a recomend√°-lo para uso. <br><br>  Quanto ao desempenho, tudo est√° √≥timo aqui.  Ao testar seu produto, a equipe de desenvolvimento do Calico demonstrou desempenho astron√¥mico ao lan√ßar mais de 50.000 cont√™ineres em 500 n√≥s f√≠sicos, com uma velocidade de cria√ß√£o de 20 cont√™ineres por segundo.  N√£o houve problemas com a escala.  Tais resultados j√° <a href="https://www.projectcalico.org/announcing-calico-v1-0/">foram anunciados</a> no an√∫ncio da primeira vers√£o.  Pesquisas independentes sobre largura de banda e consumo de recursos tamb√©m confirmam o desempenho do Calico, que √© quase o mesmo do Flannel.  <a href="https://itnext.io/benchmark-results-of-kubernetes-network-plugins-cni-over-10gbit-s-network-updated-april-2019-4a9886efe9c4">Por exemplo</a> : <br><br><img src="https://habrastorage.org/webt/7j/k9/b7/7jk9b7obg2mb12rwmsddeyqiybq.png"><br><br>  O projeto est√° se desenvolvendo muito r√°pido, ele suporta o trabalho nas solu√ß√µes populares K8s gerenciadas, OpenShift, OpenStack, √© poss√≠vel usar o Calico ao implantar um cluster usando o <a href="">kops</a> , existem refer√™ncias √† cria√ß√£o de redes do Service Mesh (veja <a href="https://docs.projectcalico.org/v3.10/security/enforce-policy-istio">um exemplo de como</a> us√°-lo com o Istio). <br><br><h2>  Pratique com Calico </h2><br>  No caso geral de usar o Kubernetes de baunilha, a instala√ß√£o da CNI se resume ao uso do arquivo <code>calico.yaml</code> <a href="https://docs.projectcalico.org/v3.10/getting-started/kubernetes/installation/calico">baixado do site oficial</a> usando o <code>kubectl apply -f</code> . <br><br>  Como regra, a vers√£o atual do plug-in √© compat√≠vel com as 2-3 vers√µes mais recentes do Kubernetes: o trabalho em vers√µes mais antigas n√£o √© testado e n√£o garante.  Segundo os desenvolvedores, o Calico roda no kernel Linux acima de 3.10 no CentOS 7, Ubuntu 16 ou Debian 8, al√©m de iptables ou IPVS. <br><br><h3>  Isolamento dentro do ambiente </h3><br>  Para um entendimento geral, considere um caso simples para entender como as pol√≠ticas de rede na nota√ß√£o Calico diferem das padr√£o e como a abordagem para compilar regras simplifica sua legibilidade e flexibilidade de configura√ß√£o: <br><br><img src="https://habrastorage.org/webt/ke/5n/ca/ke5ncaoa_gtjrzrckxd-yhw88sm.png"><br><br>  Existem 2 aplicativos da web implantados no cluster: Node.js e PHP, um dos quais usa Redis.  Para bloquear o acesso ao Redis a partir do PHP, deixando a conectividade com o Node.js, basta aplicar a seguinte pol√≠tica: <br><br><pre> <code class="plaintext hljs">kind: NetworkPolicy apiVersion: networking.k8s.io/v1 metadata: name: allow-redis-nodejs spec: podSelector: matchLabels: service: redis ingress: - from: - podSelector: matchLabels: service: nodejs ports: - protocol: TCP port: 6379</code> </pre> <br>  Essencialmente, permitimos tr√°fego de entrada para a porta Redis do Node.js.  E, obviamente, eles n√£o proibiram mais nada.  Assim que o NetworkPolicy aparecer, todos os seletores mencionados nele come√ßar√£o a ser isolados, a menos que seja indicado o contr√°rio.  Al√©m disso, as regras de isolamento n√£o se aplicam a outros objetos que n√£o s√£o cobertos pelo seletor. <br><br>  O exemplo usa a <code>apiVersion</code> Kubernetes "pronta para uso", mas nada impede o uso <a href="https://docs.projectcalico.org/latest/reference/resources/networkpolicy">do recurso com o mesmo nome na entrega do Calico</a> .  A sintaxe √© mais extensa, portanto, √© necess√°rio reescrever a regra para o caso acima, da seguinte forma: <br><br><pre> <code class="plaintext hljs">apiVersion: crd.projectcalico.org/v1 kind: NetworkPolicy metadata: name: allow-redis-nodejs spec: selector: service == 'redis' ingress: - action: Allow protocol: TCP source: selector: service == 'nodejs' destination: ports: - 6379</code> </pre> <br>  As constru√ß√µes mencionadas acima para permitir ou proibir todo o tr√°fego atrav√©s da API NetworkPolicy usual cont√™m estruturas com colchetes que s√£o dif√≠ceis de entender e lembrar.  No caso do Calico, para alterar a l√≥gica da regra do firewall para o oposto, basta alterar a <code>action: Allow</code> para a <code>action: Deny</code> . <br><br><h3>  Isolamento do ambiente </h3><br>  Agora imagine uma situa√ß√£o em que um aplicativo gere m√©tricas de neg√≥cios para colet√°-las no Prometheus e an√°lises adicionais atrav√©s da Grafana.  O descarregamento pode conter dados confidenciais, que, por padr√£o, est√£o novamente dispon√≠veis ao p√∫blico.  Vamos fechar esses dados de olhares indiscretos: <br><br><img src="https://habrastorage.org/webt/e-/u1/1m/e-u11mldmjhyjqhzal7ndgbcbwy.png"><br><br>  O Prometheus, em regra, √© colocado em um ambiente de servi√ßo separado - no exemplo, ser√° um espa√ßo para nome do seguinte formato: <br><br><pre> <code class="plaintext hljs">apiVersion: v1 kind: Namespace metadata: labels: module: prometheus name: kube-prometheus</code> </pre> <br>  O campo <code>metadata.labels</code> aqui n√£o foi acidental.  Como mencionado acima, <code>namespaceSelector</code> (como <code>podSelector</code> ) opera em r√≥tulos.  Portanto, para permitir a obten√ß√£o de m√©tricas de todos os pods em uma porta espec√≠fica, voc√™ precisar√° adicionar algum r√≥tulo (ou retirar dos existentes) e aplicar uma configura√ß√£o como: <br><br><pre> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: allow-metrics-prom spec: podSelector: {} ingress: - from: - namespaceSelector: matchLabels: module: prometheus ports: - protocol: TCP port: 9100</code> </pre> <br>  E se voc√™ usar pol√≠ticas Calico, a sintaxe seria: <br><br><pre> <code class="plaintext hljs">apiVersion: crd.projectcalico.org/v1 kind: NetworkPolicy metadata: name: allow-metrics-prom spec: ingress: - action: Allow protocol: TCP source: namespaceSelector: module == 'prometheus' destination: ports: - 9100</code> </pre> <br>  Em geral, adicionando esse tipo de pol√≠tica a necessidades espec√≠ficas, voc√™ pode se proteger contra interfer√™ncias maliciosas ou acidentais na opera√ß√£o de aplicativos no cluster. <br><br>  A melhor pr√°tica, de acordo com os criadores do Calico, √© a abordagem "Proibir tudo e descobrir explicitamente o necess√°rio", conforme registrada na <a href="https://docs.projectcalico.org/v3.10/security/kubernetes-default-deny">documenta√ß√£o oficial</a> (outros seguem uma abordagem semelhante, em particular no <a href="https://habr.com/ru/company/flant/blog/443190/">artigo j√° mencionado</a> ). <br><br><h3>  Usando objetos opcionais do Calico </h3><br>  Deixe-me lembr√°-lo de que, atrav√©s do conjunto estendido de APIs do Calico, voc√™ pode controlar a disponibilidade de n√≥s, n√£o se limitando a pods.  No exemplo a seguir, o uso de <code>GlobalNetworkPolicy</code> fecha a possibilidade de transmitir solicita√ß√µes de ICMP no cluster (por exemplo, pings do pod para um n√≥, entre pods ou de um n√≥ para o pod IP): <br><br><pre> <code class="plaintext hljs">apiVersion: crd.projectcalico.org/v1 kind: GlobalNetworkPolicy metadata: name: block-icmp spec: order: 200 selector: all() types: - Ingress - Egress ingress: - action: Deny protocol: ICMP egress: - action: Deny protocol: ICMP</code> </pre> <br>  No caso acima, os n√≥s do cluster ainda podem "alcan√ßar" um ao outro via ICMP.  E essa pergunta √© resolvida por meio de <code>GlobalNetworkPolicy</code> aplicado √† entidade <code>HostEndpoint</code> : <br><br><pre> <code class="plaintext hljs">apiVersion: crd.projectcalico.org/v1 kind: GlobalNetworkPolicy metadata: name: deny-icmp-kube-02 spec: selector: "role == 'k8s-node'" order: 0 ingress: - action: Allow protocol: ICMP egress: - action: Allow protocol: ICMP --- apiVersion: crd.projectcalico.org/v1 kind: HostEndpoint metadata: name: kube-02-eth0 labels: role: k8s-node spec: interfaceName: eth0 node: kube-02 expectedIPs: ["192.168.2.2"]</code> </pre> <br><h3>  Caso VPN </h3><br>  Por fim, darei um exemplo muito real do uso de fun√ß√µes do Calico para o caso com intera√ß√£o quase cluster, quando o conjunto padr√£o de pol√≠ticas n√£o for suficiente.  Um t√∫nel VPN √© usado pelos clientes para acessar o aplicativo Web, e esse acesso √© rigidamente controlado e limitado a uma lista espec√≠fica de servi√ßos permitidos: <br><br><img src="https://habrastorage.org/webt/ft/sy/zt/ftsyztco2pulpbcbrunwdlnhn1u.png"><br><br>  Os clientes se conectam √† VPN atrav√©s da porta UDP padr√£o 1194 e, quando conectados, recebem rotas para as sub-redes de pods e servi√ßos do cluster.  As sub-redes push s√£o inteiramente para n√£o perder servi√ßos durante as reinicializa√ß√µes e as altera√ß√µes de endere√ßo. <br><br>  A porta na configura√ß√£o √© padr√£o, o que imp√µe algumas nuances ao processo de configura√ß√£o do aplicativo e sua transfer√™ncia para o cluster Kubernetes.  Por exemplo, na mesma AWS, o LoadBalancer for UDP apareceu literalmente no final do ano passado em uma lista limitada de regi√µes, e o NodePort n√£o pode ser usado devido ao encaminhamento em todos os n√≥s do cluster e √© imposs√≠vel dimensionar o n√∫mero de inst√¢ncias do servidor para toler√¢ncia a falhas.  Al√©m disso, voc√™ precisa alterar o intervalo de portas padr√£o ... <br><br>  Como resultado de uma pesquisa de poss√≠veis solu√ß√µes, foi escolhido o seguinte: <br><br><ol><li>  Os pods de VPN s√£o agendados por host no modo <code>hostNetwork</code> , ou seja, no IP real. </li><li>  O servi√ßo √© lan√ßado atrav√©s do <code>ClusterIP</code> .  A porta sobe fisicamente no host, acess√≠vel externamente com algumas advert√™ncias (disponibilidade condicional de um endere√ßo IP real). </li><li>  A defini√ß√£o do n√≥ no qual o pod subiu est√° al√©m do escopo de nossa hist√≥ria.  S√≥ posso dizer que voc√™ pode "fixar" firmemente o servi√ßo no host ou gravar um pequeno servi√ßo de side-car que monitora o endere√ßo IP atual do servi√ßo VPN e edita os registros DNS registrados nos clientes - que t√™m imagina√ß√£o suficiente. </li></ol><br>  Do ponto de vista do roteamento, podemos identificar exclusivamente o cliente para a VPN por seu endere√ßo IP emitido pelo servidor VPN.  Abaixo est√° um exemplo primitivo de restri√ß√£o de acesso a esse cliente aos servi√ßos, uma ilustra√ß√£o dos Redis mencionados acima: <br><br><pre> <code class="plaintext hljs">apiVersion: crd.projectcalico.org/v1 kind: HostEndpoint metadata: name: vpnclient-eth0 labels: role: vpnclient environment: production spec: interfaceName: "*" node: kube-02 expectedIPs: ["172.176.176.2"] --- apiVersion: crd.projectcalico.org/v1 kind: GlobalNetworkPolicy metadata: name: vpn-rules spec: selector: "role == 'vpnclient'" order: 0 applyOnForward: true preDNAT: true ingress: - action: Deny protocol: TCP destination: ports: [6379] - action: Allow protocol: UDP destination: ports: [53, 67]</code> </pre> <br>  Aqui, √© estritamente proibido conectar-se √† porta 6379, mas, ao mesmo tempo, o servi√ßo DNS √© preservado, cujo funcionamento geralmente sofre ao elaborar as regras.  Porque, como mencionado anteriormente, quando um seletor aparece, uma pol√≠tica padr√£o proibitiva √© aplicada a ele, a menos que especificado de outra forma. <br><br><h2>  Sum√°rio </h2><br>  Portanto, usando a API Calico Advanced, voc√™ pode configurar com flexibilidade e alterar dinamicamente o roteamento dentro e ao redor do cluster.  Em geral, seu uso pode parecer disparar contra pardais, e a introdu√ß√£o de uma rede L3 com t√∫neis IP BGP e IP parece monstruosa em uma instala√ß√£o simples do Kubernetes em uma rede plana ... No entanto, o restante da ferramenta parece bastante vi√°vel e √∫til. <br><br>  O isolamento de cluster para requisitos de seguran√ßa nem sempre √© vi√°vel e √© nesses casos que o Calico (ou uma solu√ß√£o semelhante) vem em socorro.  Os exemplos neste artigo (com um pouco de refinamento) s√£o usados ‚Äã‚Äãem v√°rias instala√ß√µes de nossos clientes na AWS. <br><br><h2>  PS </h2><br>  Leia tamb√©m em nosso blog: <br><br><ul><li>  ‚Äú <a href="https://habr.com/ru/company/flant/blog/443190/">Introdu√ß√£o √†s pol√≠ticas de rede Kubernetes para profissionais de seguran√ßa</a> ‚Äù; </li><li>  ‚ÄúGuia Ilustrado de Rede em Kubernetes‚Äù: <a href="https://habr.com/ru/company/flant/blog/346304/">partes 1 e 2 (modelo de rede, redes overlay)</a> , <a href="https://habr.com/ru/company/flant/blog/433382/">parte 3 (servi√ßos e processamento de tr√°fego)</a> ; </li><li>  ‚Äú <a href="https://habr.com/ru/company/flant/blog/329830/">CNI (Container Networking Interface) √© a interface de rede e padr√£o para cont√™ineres Linux</a> .‚Äù </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt485716/">https://habr.com/ru/post/pt485716/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt485704/index.html">Pixel art para iniciantes: corrigindo erros comuns</a></li>
<li><a href="../pt485706/index.html">Convidamos voc√™ para a reuni√£o "Transforma√ß√£o digital e novos pap√©is na ci√™ncia de dados"</a></li>
<li><a href="../pt485708/index.html">Blockchain est√° mudando a maneira como a ind√∫stria ferrovi√°ria funciona</a></li>
<li><a href="../pt485710/index.html">Solu√ß√£o simples para teste de regress√£o visual em Java + Selenium Webdriver + aShot</a></li>
<li><a href="../pt485712/index.html">Gest√£o n√£o √© uma senten√ßa</a></li>
<li><a href="../pt485726/index.html">Avi√µes de Corte - 3</a></li>
<li><a href="../pt485732/index.html">15 de fevereiro Badoo PHP Meetup # 4. Legado</a></li>
<li><a href="../pt485738/index.html">Semana da seguran√ßa 05: vulnerabilidades cr√≠ticas de dispositivos m√©dicos</a></li>
<li><a href="../pt485740/index.html">O impasse na PHDays: participe da batalha de anivers√°rio de hackers e defensores</a></li>
<li><a href="../pt485742/index.html">Como criamos o diret√≥rio de endere√ßos da Rostelecom</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>