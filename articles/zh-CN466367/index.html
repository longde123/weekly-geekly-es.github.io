<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏻‍🍳 ⛸️ ⬛️ Android API级别，向后和向前兼容 💀 👩🏿‍🌾 ✌🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="晚上好，朋友们。 我们为Android开发者的未来学生准备了有用的翻译。 高级课程 。 ” 我们很高兴与您分享这些材料。 



 如果您正在阅读本文，则意味着您可能对以下内容感兴趣： 



- API级别是什么意思？ 
- 如何使用compileSdkVersion ， minSdkVersio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Android API级别，向后和向前兼容</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/466367/">  <i>晚上好，朋友们。</i>  <i>我们为<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Android开发者的</a>未来学生准备了有用的翻译<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">。</a></i>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">高级课程</a> 。 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">”</a></i>  <i>我们很高兴与您分享这些材料。</i> <br><br><img src="https://habrastorage.org/webt/h7/or/w_/h7orw_8qlhdvvtv8_gmx_tmbuug.png"><br><hr><br> 如果您正在阅读本文，则意味着您可能对以下内容感兴趣： <br><br><ul><li>  API级别是什么意思？ </li><li>如何使用<code>compileSdkVersion</code> ， <code>minSdkVersion</code>或<code>targetSdkVersion</code> ？ </li><li> 如何保证应用程序可以在具有不同版本OS的设备上正常运行？ </li></ul><a name="habracut"></a><br><img src="https://habrastorage.org/webt/mc/-0/ne/mc-0ne_srm9jhb3vffswxbclguy.jpeg"><br><br> 所有这些概念都是相互关联的，在本文中，我将尝试以一种简单而有效的方式向您解释它们。 <br><br> 为此，您需要了解<b>SDK</b>和<b>API</b>之间的区别，并了解Android生态系统中<b>的API级别</b> 。 <br><br> 的确，在Android中，SDK和API之间存在1：1的关系，并且经常经常将这两个术语作为同义词使用，但请务必理解这不是同一回事。 <br><br> 正确地说，每个Android版本都有一个SDK和一个等效的API，以及此API的级别。 <br><br><h2> 开发包 </h2><br> 它代表<i>软件开发套件</i> 。 请注意“工具包”（kit）一词，它仅由一组各种工具，库，文档，示例组成，可帮助开发人员创建，调试和运行Android应用程序。  SDK随附了一个API。 <br><br> 如果您在Android Studio中打开<i>SDK Manager</i> ，则可以更清楚地看到Android SDK的组成。 <br><br>  <i>Platform</i> SDK的第一个标签列出了每个Android版本的SDK。 <br><br> 如下图所示，Android 9.0 SDK（也称为Pie）包含： <br><br><ul><li>  Android SDK Platform 28（这是框架<b>API</b> ）。 </li><li>  Android 28的源代码（这是API的<b>实现</b> ，如您所见，它是可选的...记住这一点）。 </li><li> 以及其他很多东西，例如Android模拟器的各种系统映像。 </li></ul><br><img src="https://habrastorage.org/webt/vp/7o/dr/vp7odrlxx0lcpkhne3dw9cqzcbq.png"><br>  <i>Android Studio SDK管理器中的SDK概述。</i> <br><br>  <i>SDK工具</i>的第二个选项卡显示了其他工具，这些工具也是SDK的一部分，但与平台版本无关。 这意味着它们可以单独发布或更新。 <br><br><h2>  API </h2><br> 它代表<i>应用程序编程接口</i> 。 它只是一个接口，是一个抽象层，提供了软件的两个不同“部分”之间的链接。 它的工作方式就像提供者（例如，图书馆）和使用者（例如，应用程序）之间的合同。 <br><br> 这是一组正式定义，例如类，方法，函数，模块，常量，其他开发人员可以使用这些定义来编写其代码。 但是，API不包含实现。 <br><br><h2>  API级别 </h2><br>  API级别是一个整数值，可唯一标识Android平台提供的框架API的版本。 <br><br> 通常，对平台框架API进行更新的目的是使新版本的API保持与早期版本的兼容性，因此对新API的大部分更改都是加性的，并且API的旧部分已过时但未被删除。 <br><br> 现在有人可能会怀疑... <br><br> 如果Android API没有提供实现，并且<i>SDK Manager</i>提供了可选的可下载API源代码作为SDK的一部分，那么相应的实现在哪里？ <br><br> 答案很简单。  <b>在设备上。</b> <br><br> 让我们弄清楚... <br><br><h2> 从源代码到APK文件 </h2><br> 通常，一个Android项目由开发人员使用Android API（应用程序模块）编写的代码以及其他一些库/依赖项（.jar文件，AAR，模块等）和资源组成。 <br><br> 编译过程会将用Java或Kotlin编写的代码（包括依赖项（减少代码的原因之一！），DEX字节码）转换为DEX字节码，然后将所有内容连同资源压缩为APK文件。 在此阶段，API的实现未包含在最终的APK中！ <br><br><img src="https://habrastorage.org/webt/5i/6m/qe/5i6mqedjxixkhjebt7jyjjztqvc.png"><br>  <i>构建过程<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-Android开发人员</a></i> <br><br><h2>  DEX文件和Android运行时 </h2><br><img src="https://habrastorage.org/webt/0h/j1/31/0hj131p-dmmdvvp9aoyrsh7xup8.png"><br>  <i>Android体系结构<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-Android开发人员</a></i> <br><br>  Android Runtime是完成所有肮脏工作和执行DEX文件的地方。 它包含两个主要组件： <br><br><ul><li>  <b>虚拟机</b>可利用代码的可移植性和平台独立性。 从Android 5.0（Lollipop）开始，旧的运行时Dalvik虚拟机已被新的Android RunTime（ART）完全取代。  Dalvik使用JIT编译器，而ART使用AOT（提前）编译和JIT来在运行时分析代码。 </li><li>  <b>基本库</b>是标准的Java和Android库。 简而言之，这就是API实现所在的位置。 </li></ul><br><blockquote> 此级别上可用的API版本与运行该应用程序的Android平台的版本相对应。 </blockquote> 例如，如果实际设备上安装了Android 9（Pie），则所有级别28以上的API均可用。 <br><br> 如果您了解Android Runtime的关键点以及API的作用，那么应该很容易理解<b>向后和向前的兼容性</b> ，以及<code>compileSdkVersion</code> ， <code>minSdkVersion</code>和<code>targetSdkVersion</code> 。 <br><br><h3> 编译器 </h3><br> 该值仅用于<i>告诉Gradle</i>用来编译应用程序的SDK版本。 这使开发人员可以访问所有为<code>compileSdkVersion</code>设置的API级别之前可用的API。 <br><br>  <b>强烈建议使用最新的SDK进行编译：</b> <br><br><ul><li> 高级别的API使开发人员可以利用最新的API和新平台提供的机会。 </li><li> 要使用最新版本的<code>SupportLibrary</code> ， <code>compileSdkVersion</code>必须与<code>SupportLibrary</code>的版本匹配。 </li></ul><br> 例如，要使用<code>SupportLibrary-28.xx</code> ， <code>compileSdkVersion</code>也必须为28。 <br><br><ul><li> 要切换到<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">AndroidX</a>或使用它，必须将compileSdkVersion设置为至少28。 </li><li> 准备好满足<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Google Play中目标API级别</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">要求</a> 。  Google宣布，每年将为新应用程序和更新设置最低API目标级别，以将新的Android版本更快地传播到Google市场。 您可以<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在此处</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">此处</a>找到更多信息。 </li></ul><br>  Android应用程序与Android平台的新版本兼容，因为对API的更改通常是附加的，并且旧的API可能会过时，但不会删除。 <br><br> 这意味着<b>直接兼容性</b>主要由平台来保证，并且当您在具有比<code>compileSdkVersion</code>指定的API更高的API级别的设备上运行应用程序时，在运行时没有问题，该应用程序将按预期运行较新版本的平台。 <br><br> 例如： <br><br>  <b>应用程序</b> + <b>compileSdkVersion</b> = <b>26</b>和<b>API级别26中</b>引入的API <code>xyz()</code>方法可以在具有Android 8 Oreo（API级别26）的设备上运行。 <br><br> 同一应用程序可以在具有Android 9 Pie（API级别28）的设备上运行，因为API <code>xyz()</code>方法在API级别28上仍然可用。 <br><br><h3>  minSdkVersion </h3><br> 该值指示应用程序可以运行的最低API级别。  <b>这是最低要求。</b>  <b>如果未指定，则默认值为1</b> 。 <br><br> 开发人员需要设置正确的值，并确保在此API级别以下的应用程序正确运行。 这称为<b>向后兼容</b> 。 <br><br> 在开发期间，当开发人员尝试使用低于<code>minSdkVersion</code>中指定的任何API时， <code>Lint</code>警告开发人员。  <b>重要的是不要忽略警告并进行纠正！</b> <br><br> 为了确保<b>向后兼容</b> ，开发人员可以在运行时检查平台的版本，并在平台的较新版本中使用新的API，在较旧的版本中使用旧的API，或者根据情况使用某些提供向后兼容性的静态库。 <br><br> 同样重要的是要提及，Google Play商店使用此值通过将设备平台的版本与<code>minSdkVersion</code>应用程序进行比较来确定是否可以在特定设备上安装该应用程序。 <br><br> 选择该值时，开发人员应格外小心，因为平台无法保证向后兼容性。 <br><br> 为项目选择“正确的”价值也是一项业务决策，因为它会影响应用程序的受众人数。 看<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">平台</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">分布</a> 。 <br><br> 例如： <br><br>  <b>应用程序</b> + <b>compileSdkVersion</b> = <b>26</b> + <code>minSdkVersion</code> = <b>22</b> ，API级别26中引入的API <code>xyz()</code>方法可以在具有Android 8 Oreo（API级别26）的设备上运行。 <br><br> 可以在具有Android 5.1 Lollipop（API级别22）的旧设备上安装并运行相同的应用程序，而该API方法<code>xyz()</code>不存在。 如果开发人员没有通过运行时检查或任何库提供向后兼容性，则该应用程序将在尝试访问<code>xyz()</code> API方法时崩溃。 <br><br><h3>  targetSdkVersion </h3><br> 此值指示开发应用程序时使用的API级别。 <br><br> 不要将其与<code>compileSdkVersion</code>混淆。 后者仅在编译时使用，并使开发人员可以使用新的API。 相比之下，第一个是APK的一部分（以及<code>minSdkVersion</code> ），它会更改运行时的行为。 这是开发人员可以控制<b>直接兼容性的方法</b> 。 <br><br> 有时，在新的运行时环境中工作时，基本系统中可能会有一些API更改，这些更改可能影响应用程序的行为。 <br><br> 目标应用程序级别包括特定于平台版本的运行时行为。 如果应用程序尚未准备好支持运行时行为的这些更改，则可能会失败。 <br><br> 一个简单的示例是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Runtime Permission</a> ，它是Android 6棉花糖（API级别23）中引入的。 <br><br> 可以使用23级API编译应用程序，但如果尚未准备好支持新的运行时权限模型，则具有目标22级API。 <br><br> 因此，在不包括新的运行时行为的情况下，应用程序仍然可以兼容。 <br><br> 无论如何，正如已经提到的，Google要求应用程序满足目标API级别的新要求，因此您应该始终具有较高的优先级来更新此值。 <br><br> 现在放在一起，我们看到了明确的关系 <br><br> <code>minSdkVersion ≤ targetSdkVersion ≤ compileSdkVersion</code> <br> <br> 请记住，强烈建议您使用最新的API级别进行编译，并尝试使用<b>targetSdkVersion</b> == <b>compileSdkVersion</b> 。 <br><br><h4> 资料来源 </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">use-sdk-element文档-Android开发人员</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Android Runtime-维基百科</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Android Apps的构建和运行方式-David Griffiths GitHub</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">平台架构-Android开发人员</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Android RunTime（ART）和Dalvik-Android源</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">满足Google Play的目标API级别要求-Android开发人员</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">配置构建-Android开发人员</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">选择您的compileSdkVersion，minSdkVersion和targetSdkVersion-Ian Late Medium</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN466367/">https://habr.com/ru/post/zh-CN466367/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN466355/index.html">鳄鱼会飞，但是低低（大约不带情绪但有离题的ekranoplans）</a></li>
<li><a href="../zh-CN466359/index.html">为什么世界生态债务日和环境足迹是伪科学的废话</a></li>
<li><a href="../zh-CN466361/index.html">如何获得哥萨克GICSP证书</a></li>
<li><a href="../zh-CN466363/index.html">lur饮DevOps。 第一天 Git，CI / CD，IaC和绿色恐龙</a></li>
<li><a href="../zh-CN466365/index.html">开发单片类Unix操作系统-入门（1）</a></li>
<li><a href="../zh-CN466371/index.html">使用趋势技术可能遇到的三大销售异议</a></li>
<li><a href="../zh-CN466373/index.html">Python TamTam机器人开发</a></li>
<li><a href="../zh-CN466375/index.html">博物馆数据艺术。 KUVT2-学习和玩乐</a></li>
<li><a href="../zh-CN466379/index.html">在微控制器上运行“桌面”软件</a></li>
<li><a href="../zh-CN466381/index.html">时代LED灯泡在2019年如何变化</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>