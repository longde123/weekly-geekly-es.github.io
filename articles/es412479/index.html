<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§µüèø ü§æ ü¶ì Esc√°ner l√°ser 3D en tel√©fonos Android üë®üèª‚Äçüè≠ üÜñ üëéüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Te presento un esc√°ner de bricolaje basado en un tel√©fono inteligente Android. 

 Al dise√±ar y crear un esc√°ner, en primer lugar, me interesaba escane...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Esc√°ner l√°ser 3D en tel√©fonos Android</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/412479/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/mb/dd/op/mbddoptooexgtjkqnnpchqsfkiq.jpeg"></div><br>  Te presento un esc√°ner de bricolaje basado en un tel√©fono inteligente Android. <br><br>  Al dise√±ar y crear un esc√°ner, en primer lugar, me interesaba escanear objetos grandes.  M√≠nimo: la figura de una persona en pleno crecimiento con precisi√≥n: al menos 1-2 mm. <br><br>  Estos criterios se han logrado con √©xito.  Objetos escaneados con √©xito en luz natural (sin luz solar directa).  El campo de escaneo est√° determinado por el √°ngulo de captura de la c√°mara del tel√©fono inteligente y la distancia a la que el rayo l√°ser mantiene suficiente brillo para la detecci√≥n (durante el d√≠a en la habitaci√≥n).  Esta es una figura de una persona en toda su altura (1,8 metros) con un ancho de trabajo de 1,2 metros. <br><br>  El esc√°ner fue hecho por consideraciones "y si hacer algo m√°s o menos √∫til e interesante cuando no hay nada que hacer".  Todas las ilustraciones se basan en el ejemplo de un objeto de "prueba" (cargar escaneos humanos no es correcto). <br><br>  Como lo ha demostrado la experiencia, para un esc√°ner de este tipo de software es secundario y se le dedica el menor tiempo (para la versi√≥n final. Aparte de los experimentos y las opciones sin salida).  Por lo tanto, no tocar√© las caracter√≠sticas del software en el art√≠culo (Enlace a los c√≥digos fuente al final del art√≠culo). <br><br>  El prop√≥sito del art√≠culo es hablar sobre las ramas de punto muerto y los problemas recopilados en el camino hacia la creaci√≥n de la versi√≥n de trabajo final. <br><a name="habracut"></a><br>  Para el esc√°ner, la versi√≥n final usa: <br><br><ol><li>  Tel√©fono Samsung S5 </li><li>  L√°seres rojos y verdes con una lente para una l√≠nea (l√≠nea de 90 grados) a 30 mW con √≥ptica de vidrio (no la m√°s barata). </li><li>  Motores paso a paso 35BYGHM302-06LA 0.3A, 0.9 ¬∞ </li><li>  Controladores de motor paso a paso A4988 </li><li>  M√≥dulo Bluetooth HC-05 </li><li>  Tablero STM32F103C8t </li></ol><br>  Los controladores A4988 est√°n configurados en medio paso, que con una caja de cambios 15-&gt; 120 da 400 * 2 * 8 pasos por PI. <br><br><h2>  La elecci√≥n de la tecnolog√≠a de escaneo. </h2><br>  Se consideraron las siguientes opciones. <br><br><h4>  Proyector LED. </h4><br>  La opci√≥n fue considerada y calculada.  Incluso los proyectores caros no tienen la resoluci√≥n correcta para lograr la precisi√≥n requerida.  Y ni siquiera vale la pena hablar de los baratos. <br><br><h4>  Escaneo mec√°nico de un rayo l√°ser en combinaci√≥n con una rejilla de difracci√≥n. </h4><br>  La idea fue probada y considerada adecuada.  Pero no por el rendimiento de bricolaje, por razones: <br><br><ol><li>  Necesitamos un l√°ser suficientemente potente, de modo que despu√©s de la difracci√≥n, las marcas sean lo suficientemente brillantes (la distancia a la lente del tel√©fono inteligente es de 1..2 metros).  Y mis ojos lo sienten.  Un punto l√°ser ya con 30 mW no es √∫til. </li><li>  Los requisitos para el escaneo mec√°nico de precisi√≥n en 2 planos son demasiado altos para el rendimiento de bricolaje. </li></ol><br><h3>  Escaneo mec√°nico est√°ndar de una l√≠nea l√°ser en un objeto estacionario de escaneo. </h3><br>  Finalmente, la opci√≥n se eligi√≥ con dos l√°seres de diferentes colores. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/2i/uf/ue/2iufuep6mdd8uemj582b1fkhpja.jpeg"></div><br><ol><li>  Los diferentes colores de los l√°seres permiten detectarlos independientemente en un solo marco. </li><li>  La ubicaci√≥n de los l√°seres en lados opuestos de la c√°mara le permite obtener dos escaneos en una sola pasada. </li><li>  Dos escaneos a la vez le permiten evaluar objetivamente la calidad de la alineaci√≥n del esc√°ner (los escaneos deben converger y superponerse). </li></ol><br>  Al final result√≥ que, el √∫ltimo criterio es el m√°s importante.  La calidad del escaneo est√° completamente determinada por la precisi√≥n de medir las dimensiones geom√©tricas y los √°ngulos del esc√°ner.  Y la presencia de dos escaneos de dos l√°seres le permite evaluar de inmediato la calidad del escaneo: <br>  Nubes de puntos convergieron.  Es decir  Los aviones capturados por dos l√°seres convergieron en toda la superficie. <br><br><h1>  Versi√≥n fallida de la parte mec√°nica en el 28BYJ-48. </h1><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/f5/bd/d7/f5bdd7gj652kanczlquqybadyv8.jpeg"></div><br>  Aunque desde el principio supuse que esta es una opci√≥n de callej√≥n sin salida que no proporciona la precisi√≥n necesaria, a√∫n la verifiqu√© con varios trucos: <br><br><ol><li>  El eje del motor est√° fijado por el rodamiento. </li><li>  Se agreg√≥ un elemento de fricci√≥n y un tap√≥n para el muestreo del espacio libre de la caja de engranajes. </li><li>  Un intento de determinar la "posici√≥n exacta" por un fototransistor por exposici√≥n al l√°ser </li></ol><br>  La repetibilidad de volver al mismo lugar de la l√≠nea l√°ser result√≥ ser baja: 2-3 mm a una distancia de 1,5 metros.  Durante la operaci√≥n del engranaje, a pesar de la aparente suavidad, se notan sacudidas de 1-3 mm a una distancia de 1.5 metros. <br><br>  Es decir  28BYJ-48 es completamente inadecuado para un esc√°ner m√°s o menos preciso de objetos grandes. <br><br><h2>  Requisitos de escaneo basados ‚Äã‚Äãen mi experiencia </h2><br>  <u>Un elemento obligatorio del barrido debe ser una caja de cambios.</u> <br><br>  No se equivoque sobre el modo de pasos 1 / x.  Los experimentos mostraron que en el modo 1/16 en los micro pasos A4988 no son uniformes.  Y para el 1/8, esta irregularidad es notable en el ojo. <br><br>  La soluci√≥n m√°s √≥ptima para la caja de cambios fue el uso de un engranaje de correa.  Aunque result√≥ ser bastante engorroso, es f√°cil de crear y preciso. <br>  La precisi√≥n de posicionamiento (m√°s precisamente, la repetibilidad de posicionamiento de la posici√≥n inicial de los l√°seres para el escaneo) de los l√°seres result√≥ ser de aproximadamente 0,5 mm para un ancho de l√≠nea l√°ser de 5 mm a m√°s de 4 metros de distancia.  Es decir  a una distancia de escaneo (1.2-1.8 metros) generalmente es dif√≠cil de medir. <br><br>  Posicionamiento: optoacopladores (no chinos) en las ranuras del disco debajo de los l√°seres. <br><br><h2>  Problemas con la transmisi√≥n de se√±ales de control desde el tel√©fono al m√≥dulo de control para l√°seres y motores paso a paso </h2><br>  El canal de control result√≥ ser un cuello de botella en t√©rminos de velocidad de exploraci√≥n.  Como se trataba de un desarrollo pausado de bricolaje para su propio placer, se probaron todos los m√©todos de comunicaci√≥n con un tel√©fono inteligente. <br><br><h4>  Transmisi√≥n de se√±ales de control a trav√©s del conector de audio (conector de audio del tel√©fono =&gt; osciloscopio) </h4><br>  La forma m√°s inhibitoria de transmitir datos en tiempo real.  S√≠, incluso con tiempo flotante.  Hasta 500 ms (!) Desde la activaci√≥n del software de transmisi√≥n de datos de audio hasta la apariencia real de la se√±al en el conector de audio. <br><br>  Este ex√≥tico se comprob√≥ porque, en el trabajo, ten√≠a que lidiar con lectores de tarjetas con chip m√≥viles. <br><br><h4>  Fotodiodos en la pantalla del tel√©fono inteligente (segmento de la pantalla del tel√©fono =&gt; fototransistores + STM32F103) </h4><br>  Por inter√©s, incluso un m√©todo tan ex√≥tico se prob√≥ como fototransistores con una matriz de 2x2 en forma de pinzas para la ropa en la pantalla. <br><br>  Aunque este m√©todo de transmisi√≥n de informaci√≥n desde el tel√©fono fue el m√°s r√°pido, pero no tan fundamentalmente m√°s r√°pido (10 ms frente a 50 ms) que Bluetooth, lo que soportar√≠a sus deficiencias (pinza para la ropa en la pantalla). <br><br><h4>  Canal IR (tel√©fono =&gt; TSOP1736-&gt; STM32F103) </h4><br>  Pr√°cticamente verificado y el m√©todo de transmisi√≥n a trav√©s del canal IR.  Incluso se tuvo que realizar alguna implementaci√≥n del protocolo de transferencia de datos. <br><br>  Pero IR tambi√©n result√≥ no ser muy conveniente (es inconveniente montar el fotosensor en el tel√©fono), y no mucho m√°s r√°pido que Bluetooth. <br><br><h4>  M√≥dulo WiFi (tel√©fono =&gt; ESP8266-RS232-&gt; STM32F103) </h4><br>  Los resultados de verificar este m√≥dulo resultaron ser completamente desalentadores.  El tiempo de ejecuci√≥n de solicitud-respuesta (eco) result√≥ estar flotando de manera impredecible en el rango de 20-300 ms (un promedio de 150 ms).  Por qu√© y qu√©, no entend√≠.  Me encontr√© solo con un art√≠culo que describ√≠a un intento fallido de usar el ESP8266 para el intercambio de datos en tiempo real con requisitos estrictos de solicitud / tiempo de respuesta. <br><br>  Es decir  ESP8266 con firmware "est√°ndar" TCP -&gt; RS232 no es adecuado para tales fines. <br><br><h3>  Opci√≥n seleccionada para m√≥dulo de control y transmisi√≥n de se√±al </h3><br>  Finalmente, despu√©s de todos los experimentos, se seleccion√≥ el canal Bluetooth (m√≥dulo HC-05).  Proporciona un tiempo de solicitud-respuesta de transferencia de datos estable (y este es el m√°s importante) de 40 ms. <br><br>  El tiempo es bastante grande y afecta en gran medida el tiempo de exploraci√≥n (la mitad del tiempo total). <br>  Pero la mejor opci√≥n no se logr√≥. <br><br>  Como m√≥dulo de control, una placa extendida con SM32F103C8T. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zt/v4/h_/ztv4h_9yaihwssmvespqbnixnv8.jpeg"></div><br><h2>  M√©todos para detectar una l√≠nea en un marco. </h2><br>  La forma m√°s f√°cil de aislar las l√≠neas l√°ser en el marco es usar la resta del marco con el l√°ser apagado y el marco con el l√°ser. <br><br>  En principio, la b√∫squeda por cuadro tambi√©n funciona sin sustracci√≥n.  Pero funciona mucho peor a la luz del d√≠a.  Aunque este modo se dej√≥ en el software para pruebas comparativas (foto del modo a continuaci√≥n. Todas las dem√°s fotos con el modo de sustracci√≥n de cuadros). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/u8/ui/er/u8uieroxdwngl1vbhe8xqq_wxi4.jpeg"></div><br>  El valor pr√°ctico de la opci√≥n sin restar cuadros era bajo. <br><br>  Es posible y posible extraer la se√±al l√°ser de esta informaci√≥n ruidosa.  Sin embargo, no se molest√≥. <br><br>  La opci√≥n con sustracci√≥n de cuadros funciona bien. <br><br>  Cualquier experimento con intentos de aproximar la l√≠nea y procesar el marco completo mostr√≥ que cuanto m√°s complejo es el algoritmo, m√°s a menudo "comete errores" e incluso ralentiza el procesamiento sobre la marcha.  El algoritmo m√°s r√°pido (y m√°s f√°cil) para encontrar un l√°ser (punto l√°ser) en una l√≠nea horizontal fue: <br><br><ul><li>  Para cada punto de la l√≠nea, se considera la suma de los cuadrados del nivel de color del l√°ser (RGB) en la ventana especificada en la configuraci√≥n (13 px - valor experimentalmente √≥ptimo para la ventana) </li><li>  El punto l√°ser es el centro de la ventana con el valor m√°ximo de las sumas de los niveles de "color". </li></ul><br>  El tiempo para procesar un cuadro buscando las l√≠neas "verde" y "roja" es de 3 ms. <br><br>  Las nubes de puntos para el l√°ser rojo y verde se cuentan por separado.  Con un ajuste mec√°nico adecuado, se reducen con una precisi√≥n de &lt;1 mm. <br><br><h2>  Precisi√≥n y alineaci√≥n </h2><br>  La precisi√≥n estaba dentro de 1 mm a una distancia de 1,2 metros.  Principalmente debido a la resoluci√≥n de la c√°mara del tel√©fono (1920x1080) y el ancho del rayo l√°ser. <br><br>  Es muy importante obtener los escaneos correctos para configurar est√°tica y din√°mica.  La precisi√≥n / inexactitud es claramente visible al cargar ambas nubes de puntos en MeshLab.  Idealmente, las nubes de puntos deber√≠an converger, complementarse entre s√≠. <br><br>  Los par√°metros est√°ticos se configuran con la mayor precisi√≥n posible una vez: <br><br><ol><li>  La tangente del √°ngulo de visi√≥n de la c√°mara. </li><li>  La longitud de los "hombros" de los l√°seres (desde el centro de la lente hasta el eje de rotaci√≥n). </li></ol><br>  Y, por supuesto, el enfoque m√°ximo de las lentes l√°ser a una distancia de exploraci√≥n determinada y la "verticalidad" de las l√≠neas l√°ser. <br><br>  El par√°metro din√°mico del √°ngulo real de la posici√≥n de los l√°seres en relaci√≥n con el plano virtual del marco debe ajustarse cada vez m√°s al mezclar el tel√©fono en el soporte.  Para esto, se realiza el modo de configuraci√≥n en el software.  Al reducir la pantalla del l√°ser al centro y ajustar el √°ngulo, es necesario establecer la distancia calculada lo m√°s cerca posible de la distancia real (medida) para ambos l√°seres. <br><br>  Antes del ajuste fino: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/om/bi/zn/ombiznxwfxp9omvn9iykl7r2euk.jpeg"></div><br>  Despu√©s del ajuste: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4-/5y/jq/4-5yjqvqndfskpdqsqozgtjl6cs.jpeg"></div><br><h2>  Conclusiones </h2><br>  Quiz√°s este dise√±o pueda ser repetido por cualquiera.  Cort√© todos los detalles de fibra de vidrio a CNC. <br><br>  Por supuesto, sin una fresadora CNC, es dif√≠cil hacer una polea debajo del l√°ser.  Pero teniendo en cuenta el hecho de que necesita un √°ngulo de rotaci√≥n de un m√°ximo de 90 grados, con la paciencia adecuada, la polea tambi√©n se puede cortar con una lima. <br><br>  Pero es mejor hacerlo en CNC.  Los requisitos para el juego axial del conjunto rotativo son altos.  La calidad de los escaneos est√° 100% determinada por la precisi√≥n de fabricaci√≥n y alineaci√≥n. <br><br>  El esc√°ner lo hizo en el fondo.  A veces, de forma intermitente durante un par de meses.  Por lo tanto, no puedo evaluar la complejidad total de su creaci√≥n. <br><br>  El costo total de la estructura no es demasiado alto.  Como mostraron mis experimentos, aunque est√° lejos de los esc√°neres industriales de objetos grandes, puede obtener escaneos bastante decentes. <br>  La calidad de los escaneos se ve afectada principalmente por la precisi√≥n de la parte mec√°nica.  En este sentido, en bricolaje es dif√≠cil lidiar con la mec√°nica creada para esc√°neres industriales. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">C√≥digo fuente</a> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/86_ZMUdhrN4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es412479/">https://habr.com/ru/post/es412479/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es412469/index.html">EmDrive brinda tracci√≥n debido a un blindaje deficiente</a></li>
<li><a href="../es412471/index.html">Manejo de art√≠culos: nivel avanzado</a></li>
<li><a href="../es412473/index.html">EW contra internet satelital</a></li>
<li><a href="../es412475/index.html">Encontr√≥ una nueva vulnerabilidad en los procesadores</a></li>
<li><a href="../es412477/index.html">Elon Musk: por ahora, no venderemos la versi√≥n base del Modelo 3</a></li>
<li><a href="../es412481/index.html">¬øQu√© tiene de malo el m√©todo Bates?</a></li>
<li><a href="../es412483/index.html">La falta de sue√±o conduce a una ca√≠da radical en la atenci√≥n y el rendimiento.</a></li>
<li><a href="../es412485/index.html">[GT-H]: Sobre problemas sist√©micos, el futuro y (un poco) Tesla, ¬ød√≥nde estar√≠a sin ella?</a></li>
<li><a href="../es412487/index.html">Llamadas a las 5 a.m. y arreglos con el Parlamento Europeo: c√≥mo preparamos nuestras conferencias blockchain</a></li>
<li><a href="../es412489/index.html">Una breve historia de las alternativas cu√°nticas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>