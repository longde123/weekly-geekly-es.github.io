<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöõ üë©üèΩ‚Äçü§ù‚Äçüë®üèæ üò∫ VBA y Python para automatizaci√≥n de Excel y MS Office ü§úüèæ üßöüèø ‚òØÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="El motivo de la nota fue un art√≠culo sobre Habr√©, en el que el autor describi√≥ c√≥mo resolvi√≥ en Python la tarea de recopilar y analizar metadatos de a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>VBA y Python para automatizaci√≥n de Excel y MS Office</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439898/"><p>  El motivo de la nota fue un art√≠culo sobre Habr√©, en el que el autor describi√≥ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">c√≥mo resolvi√≥ en Python la tarea de recopilar y analizar metadatos de archivos de Excel</a> . </p><br><p>  Esta nota revela con m√°s detalle la tesis bien conocida: <strong>para una tarea espec√≠fica, debe elegir la herramienta m√°s adecuada</strong> aplicable a la automatizaci√≥n de la oficina. </p><br><h2 id="vba-i-python">  VBA y Python </h2><br><p>  <strong>VBA (Visual Basic para Aplicaciones)</strong> , de facto, el lenguaje m√°s popular para automatizar Microsoft Office.  Disponible desde el cuadro, adem√°s de Excel, funciona en PowerPoint, Outlook, Access, Project y otras aplicaciones. </p><br><p>  Si hace la pregunta: "Qu√© lenguaje de programaci√≥n elegir primero", se ofrecer√° <strong>Python</strong> en alg√∫n lugar del 90% de los casos.  En la pr√°ctica, puede haber cualquier otro idioma, pero, seg√∫n la popularidad del idioma y mi experiencia, lo comparar√©. </p><br><p>  En general, puede describir la situaci√≥n a trav√©s de un horario similar: </p><br><p><img src="https://habrastorage.org/webt/2h/aa/jd/2haajdadetskoq8fatfts8tmmfm.png"></p><a name="habracut"></a><br><p>  No habr√° una comparaci√≥n detallada, tenga en cuenta las principales caracter√≠sticas asesinas en una situaci√≥n en la que un programador junior / empleado de oficina quiere automatizar algo relacionado con MS Office, y tiene la oportunidad de elegir entre idiomas. </p><br><p>  Si por varias razones no hay otra opci√≥n, entonces no hay nada que comparar. </p><br><h2 id="v-polzu-vba">  A favor de VBA </h2><br><p><img src="https://habrastorage.org/webt/24/en/7t/24en7tgsjs2fjinoerx18pjnlhw.png"></p><br><ul><li>  <strong>Excelente trabajo con el modelo de objetos de Excel y otras aplicaciones de MS Office</strong> .  Escribir c√≥digo VBA para la mayor√≠a de las operaciones internas es trivial.  En Python, en comparaci√≥n con VBA, la compatibilidad con el modelo de objetos de Office es muy d√©bil. </li><li>  <strong>Soporte para varios formatos de MS Office.</strong>  El mayor problema para los idiomas externos es trabajar con diferentes formatos de archivo de MS Office.  Por ejemplo, los archivos xls, xlsx, xlsm pueden requerir bibliotecas diferentes, ya que cada uno funciona bien solo con su propio formato de archivo.  Para VBA, todo esto es un "archivo de Excel" que funciona igual de bien en general. </li><li>  <strong>Trabaja con MS Exchange.</strong>  Si es necesario proporcionar trabajo con el correo / calendario corporativo en Exchange, no todos los idiomas tienen una biblioteca normal para trabajar con el protocolo de Exchange.  En VBA, esto se resuelve de manera relativamente simple mediante el uso del modelo de objetos de MS Outlook en una macro. </li><li>  <strong>F√°cil instalaci√≥n y distribuci√≥n.</strong>  No es necesario instalar nada en una oficina ya instalada.  Para que un colega use el programa, es suficiente transferirle un archivo con una macro.  Es f√°cil agregar un complemento que le permite "instalar" un modelo de macro en el fondo de la oficina. </li><li>  <strong>Interactividad dentro de las aplicaciones de MS Office.</strong>  Dentro de los programas de Office, solo puede poner botones de inicio de macro y (un poco m√°s complicado) hacer una IU completamente separada.  Esto tambi√©n incluye escribir sus f√≥rmulas en Excel y el hecho de que las macros pueden afectar objetos dentro de documentos de Office en tiempo real. </li><li>  <strong>Grabaci√≥n de macros.</strong>  Una herramienta conveniente que le permite grabar las acciones de una persona en el c√≥digo terminado, para su posterior uso de edici√≥n. </li></ul><br><h2 id="v-polzu-python-i-drugih-vneshnih-yazykov-programmirovaniya">  A favor de Python (y otros lenguajes de programaci√≥n externos) </h2><br><p><img src="https://habrastorage.org/webt/v_/em/lj/v_emljdiuncy8dk-xxzawv4eyq4.png"></p><br><ul><li>  <strong>Buena sintaxis y az√∫car sint√°ctico.</strong>  En resumen, VBA no es expresivo y conveniente.  Esto es una cuesti√≥n de gusto personal, pero Python es mucho m√°s conveniente para m√≠. </li><li>  <strong>Un rico ecosistema de bibliotecas.</strong>  Una gran selecci√≥n de bibliotecas preparadas para trabajar con el mundo exterior.  Intentar hacer un programa en VBA que interact√∫e con alguna API externa sigue siendo un problema.  Es interesante que solo por trabajar con archivos de Office de la biblioteca de la misma Python, francamente "en la C". </li><li>  <strong>Buenas herramientas de desarrollo.</strong>  Puede elegir entre una gran selecci√≥n de programas que facilitan el proceso de desarrollo.  El editor est√°ndar de VBA de Office ofrece una funcionalidad muy pobre y, en comparaci√≥n con las alternativas del mundo de Python, es francamente inconveniente.  Escribir c√≥digo VBA en un editor externo y luego copiarlo dentro de la oficina para su depuraci√≥n tambi√©n es inconveniente. </li><li>  <strong>Velocidad de trabajo.</strong>  No verifiqu√© la velocidad del trabajo de un solo subproceso, pero supongo que en el caso del trabajo de un solo subproceso, Python tendr√° una ventaja.  En cualquier caso, el procesamiento multiproceso de datos / archivos est√° organizado de manera bastante trivial, lo que le permite hablar a una velocidad m√°s alta posible. </li></ul><br><h2 id="keysy">  Casos </h2><br><p><img src="https://habrastorage.org/webt/xu/1t/yw/xu1tywsboyqon2cw3j8ivenwdqs.jpeg"></p><br><p>  Las siguientes son tareas espec√≠ficas que yo mismo resolv√≠ o automatic√©, y cuando necesitaba elegir una pila: VBA o Python.  Para cada tarea, se indica la pila seleccionada y se explican por qu√©: </p><br><ul><li>  <strong>Tarea: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">un programa para verificar todos los archivos de Excel en un directorio en busca de hojas ocultas</a></strong> <br><ul><li>  Mi elecci√≥n: <strong>VBA</strong> .  Motivos: simplicidad de trabajo con diferentes formatos de archivo Excel y falta de interacciones externas. </li></ul></li><li>  <strong>Objetivo: un servicio que supuestamente permitir√≠a a un usuario convertir archivos de PowerPoint a PDF desde un dispositivo m√≥vil para verlos</strong> <br><ul><li>  El servicio se implement√≥ como un bot de correo, a la direcci√≥n de la cual el usuario puede enviar archivos de Office, y una respuesta con archivos PDF se env√≠a al usuario por correo. </li><li>  Mi elecci√≥n: <strong>l√≥gica VBA + Python para monitoreo</strong> <br><ul><li>  En primer lugar, las funciones internas est√°n garantizadas para preservar un PDF que sea aut√©ntico en un archivo de PowerPoint (las bibliotecas externas funcionan mal con la representaci√≥n de PowerPoint). </li><li>  En segundo lugar, la implementaci√≥n del bot de correo como una macro en MS Outlook resolvi√≥ los problemas de trabajar con el correo de Exchange corporativo.  Entonces, en Python no hay una biblioteca normal para trabajar con MS Exchange. </li><li>  Python se us√≥ para organizar el monitoreo del servicio y la notificaci√≥n de posibles problemas. </li></ul></li></ul></li><li>  <strong>Tarea: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Un programa para combinar archivos de Powerpoint con "interlineal" (texto de altavoz) en un archivo de impresi√≥n</a></strong> <br><ul><li>  Mi elecci√≥n: <strong>VBA</strong> .  El problema se resolvi√≥ convirtiendo dos archivos a PDF y combin√°ndolos con Riffle Shuffle.  Dado que la calidad de la conversi√≥n a PDF es importante, las funciones integradas de Office se utilizaron para exportar a PDF. </li></ul></li><li>  <strong>Tarea: Dada una base de datos de empresas de la industria en forma de tarjetas, archivos html separados que deben filtrarse y combinarse en 1 archivo Excel para calcular una serie de indicadores.</strong> <br><ul><li>  Mi elecci√≥n: <strong>Python</strong> . <br><ul><li>  Para extraer datos de tarjetas html, fue √∫til una biblioteca para analizar html BeautifulSoup. </li><li>  El programa crea el archivo de Excel, por lo que nosotros mismos podemos decidir qu√© an√°lisis calcular en √©l y qu√© m√°s en la etapa de preparaci√≥n de datos en Python. </li></ul></li></ul></li><li>  <strong>Tarea: traducir todo el texto de una presentaci√≥n de PowerPoint a otro idioma por un traductor autom√°tico</strong> <br><ul><li>  Mi elecci√≥n: <strong>VBA</strong> .  Era importante trabajar cuidadosamente con el texto en los objetos internos del archivo de PowerPoint.  La API de Yandex se utiliz√≥ para la traducci√≥n, ya que es gratuita para vol√∫menes peque√±os y f√°cil de conectar.  Por ejemplo, no pude hacer que la API del traductor de Bing funcione en VBA, porque all√≠ necesito OAuth con mis problemas para trabajar.  Si tuviera que trabajar con Bing, entonces, probablemente, har√≠a un intermediario de servicios en Python. </li></ul></li><li>  <strong>Tarea: Para los tickers de acciones dados, tome datos de la API con indicadores financieros (la API emite un archivo CSV generado a solicitud) y lea una serie de puntos de referencia para su an√°lisis en base a</strong> <br><ul><li>  Mi elecci√≥n: <strong>Python</strong> .  Aunque la API es simple (no requiere ninguna firma de solicitudes o autorizaci√≥n) y env√≠a datos a CSV, Python est√° seleccionado, ya que no hay raz√≥n para elegir VBA, y es m√°s conveniente escribir en Python. </li></ul></li><li>  <strong>Tarea: Mantener una base de instrucciones, enviar notificaciones a los artistas, generar un informe para imprimir</strong> <br><ul><li>  Aqu√≠ eleg√≠ por mucho tiempo, ya que hay muchas alternativas: <br><ul><li>  Sistema de pedido listo para usar de terceros </li><li>  Base de datos con alg√∫n tipo de manejador </li><li>  Acceso </li><li>  Excel </li></ul></li><li>  Mi elecci√≥n: <strong>VBA</strong> <br><ul><li>  En primer lugar, Excel es una interfaz de usuario lista para usar para el trabajo. </li><li>  En segundo lugar, VBA resuelve el problema de trabajar con Exchange corporativo a trav√©s de la conexi√≥n MS Outlook. </li><li>  En tercer lugar, esta decisi√≥n se tom√≥ con la vista puesta en colegas, a quienes Excel era m√°s claros que cualquier cosa completamente nueva. </li></ul></li></ul></li></ul><br><h2 id="zaklyuchenie">  Conclusi√≥n </h2><br><p>  Espero que para alguien la nota sea √∫til y ahorre tiempo al elegir una pila para resolver sus problemas. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/439898/">https://habr.com/ru/post/439898/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../439886/index.html">C√≥mo ense√±√© a una red neuronal a implementar la funci√≥n de evaluaci√≥n de posici√≥n en la Copa AI de Rusia CodeBall 2018</a></li>
<li><a href="../439890/index.html">Las habilidades son 100% o menos.</a></li>
<li><a href="../439892/index.html">C√≥mo planificar para un a√±o. Estudio de caso de la empresa de TI 120 personas y dos pr√°cticas para equipos peque√±os.</a></li>
<li><a href="../439894/index.html">C√≥mo simplemente monitorear el estado del sitio</a></li>
<li><a href="../439896/index.html">Etica de las contribuciones autom√°ticas.</a></li>
<li><a href="../439900/index.html">Julia y el m√©todo de descenso coordinado</a></li>
<li><a href="../439902/index.html">Explicaci√≥n de la naturaleza f√≠sica del fen√≥meno de "Fuerza de elevaci√≥n del ala" sin utilizar la ecuaci√≥n de Bernoulli. Parte 2</a></li>
<li><a href="../439906/index.html">Vulnerabilidad cr√≠tica en los productos antivirus de Zemana y m√°s</a></li>
<li><a href="../439908/index.html">Kohl, vete a la mierda ... Coaxial</a></li>
<li><a href="../439910/index.html">Digital Rights Center invita al D√≠a de Privacidad 2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>