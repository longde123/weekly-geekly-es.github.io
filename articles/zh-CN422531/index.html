<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧑🏿 🌺 🤭 网站优化：最重要 🕺🏼 😉 👩🏽‍🔧</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="电子书作者-Google Chrome开发经理Eddie Osmani 

 tl;博士 
 图像压缩应始终是自动化的。 
 图形优化必须是自动化的。 很容易忘记它，建议会发生变化，内容本身也很容易滑过装配线。 要自动化构建，请使用imagemin或libvips 。 还有很多。 

 大多数CDN...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>网站优化：最重要</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/422531/">  <font color="gray">电子书作者-Google Chrome开发经理Eddie Osmani</font> <br><br><h1>  tl;博士 </h1><br><h4> 图像压缩应始终是自动化的。 </h4><br> 图形优化必须是自动化的。 很容易忘记它，建议会发生变化，内容本身也很容易滑过装配线。 要自动化构建，请使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">imagemin</a>或<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">libvips</a> 。 还有很多。 <br><br> 大多数CDN（例如<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Akamai</a> ）和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Cloudinary</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">imgix</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Fastly Image Optimizer</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Instart Logic</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SmartVision</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ImageOptim API</a>的第三方解决方案都提供了全面的自动化图像优化解决方案。 <br><br> 您将花费时间阅读文章并对其进行配置，这比为它们的服务付费要昂贵得多（Cloudinary收取<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">免费费用</a> ）。 但是，如果您仍然出于成本原因或由于额外的延迟而不想外包工作，请选择上面的开源选项。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Imageflow</a>或<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Thumbor项目</a>在自己的托管上提供了替代方法。 <br><a name="habracut"></a><br><h4> 每个人都需要有效地压缩图像 </h4><br> 至少使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ImageOptim</a> 。 它在保持视觉质量的同时显着减小了尺寸。 有<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">适用</a>于Windows和Linux的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">版本</a> 。 <br><br> 一种更彻底的方法：通过<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">MozJPEG</a>运行JPEG文件（对于可接受的Web内容质量， <code>q=80</code>或更低），并考虑支持<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Progressive JPEG</a> 。 通过<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">pngquant</a>传递PNG文件，通过<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SVGO</a>传递SVG。 明确指定元数据清除（ <code>--strip</code>为<code>--strip</code> ），以避免文件过大。 向用户提供<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">H.264</a>视频（或适用于Chrome，Firefox和Opera的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">WebM）</a> ，而不是疯狂的巨型动画GIF！ 如果您负担不起，请至少使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Giflossy</a> 。 如果可能要花费几个CPU周期，并且您需要质量更好的图像并且可以忍受较长的编码时间，那么可以尝试<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Guetzli</a> 。 <br><br> 一些浏览器通过Accept标头宣布支持图像格式。 在选择发布格式时可以使用此格式：例如，基于Blink的浏览器（例如Chrome）的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">WebP</a>格式，以及其他浏览器的JPEG / PNG选项。 <br><br> 压缩总是可以提高的。 有一些用于生成和发行<code>srcset</code>工具。 在基于Blink的浏览器中，资源选择是使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">客户端提示</a>自动进行<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">的</a> -您将通过“保存数据”提示在浏览器中指定了“保存数据”选项的用户上保存流量。 <br><br> 图像的尺寸越小，用户使用起来就越方便-特别是在移动电话上。 在本文中，我们将研究使用现代方法压缩图形而对质量影响最小的方法。 <br><br><h1> 目录内容 </h1><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">引言</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">我如何知道是否需要优化图像？</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">如何选择格式？</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">适度的jpeg</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">JPEG压缩模式</a> <ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">渐进式JPEG的好处</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">谁在生产中使用渐进式JPEG？</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">渐进式JPEG缺点</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">如何编码渐进式JPEG文件？</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">颜色下采样</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">上乘JPEG</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">JPEG优化器</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">什么是MozJPEG？</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">什么是格兹利？</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">MozJPEG与Guetzli的比较？</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">巴特劳利</a> </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">什么是WebP？</a> <ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">webp如何工作？</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">谁在生产中使用WebP？</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Webp编码如何工作？</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">WebP浏览器支持</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">如何将图像转换为WebP？</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">如何在我的操作系统上查看WebP图像？</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">如何提供WebP？</a> </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SVG优化</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">避免挤压质量下降的图形</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">减少不必要的解码和调整大小成本</a> <ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">使用srcset传递HiDPI图像</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">艺术改造</a> </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">色彩管理</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">精灵</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">延迟加载非关键图像</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">如何避免显示：无陷阱</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">使用CDN进行图像处理有意义吗？</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">图像缓存</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">预载重要资源</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">图像的Web性能预算</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">最终建议</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">小事</a> </li></ul><br><a name="01"></a><h1> 引言 </h1><br><h4> 图形仍然是肥胖网页的主要原因 </h4><br> 图像占Internet流量的很大份额。 根据<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=http://">HTTP Archive的数据</a> ，60％的网页是JPEG，PNG和GIF图形。 截至2017年7月，图像在3.0 MB的平均网页上为1.7 MB。 <br><br>  Tammy Everts实验<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">证明</a> ，将图像添加到页面或放大现有图像可以提高转换率（成为客户的访问者的百分比-大约每位）。 因此，这些图片不会随处可见-这就是为什么投资有效的压缩它们策略很重要的原因。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4a3/3b0/2b6/4a33b02b6a5429884129920cb5795047.jpg"><br>  <i><font color="gray"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">2016年Soasta / Google的</a>一项研究表明，插图是转化的第二个预测指标，有效页面的图片减少了38％。</font></i> <br><br> 图像优化涉及许多措施。 选择取决于哪个质量损失被认为可以接受。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/717/0e8/588/7170e85883225b9e08b09ea84cc3ae72.jpg"><br>  <i><font color="gray">优化：选择正确的格式，轻轻压缩并优先加载不同的图像</font></i> <br><br> 典型的优化包括压缩，使用<code>&lt;picture&gt;/&lt;img srcset&gt;</code>基于大小的图像智能渲染以及调整大小。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8ba/36c/69c/8ba36c69c745b99a1bb0b25d803ae15c.jpg"><br>  <i><font color="gray">根据<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">HTTP存档</a> ，在第95个百分点（在累积分布函数中），每张图片可以减少30 KB！</font></i> <br><br> 我们还有很多可以优化的图像。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/640/bb3/f22/640bb3f22116b34da321bc72f5ffd360.jpg"><br>  <i><font color="gray">ImageOptim免费软件使用现代压缩方法来减小图形大小，并删除不必要的EXIF元数据</font></i> <br><br> 如果您是设计师，那么还有<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Sketch</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ImageOptim插件</a> ，可以在导出时优化资源。 我发现它可以节省大量时间。 <br><br><a name="02"></a><h1> 我如何知道是否需要优化图像？ </h1><br> 使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">WebPageTest.org</a>审核您的站点。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bd7/5ed/eb7/bd75edeb7a6ded48fcb74b79acc9b01f.jpg"><br>  <i><font color="gray">WebPageTest报告的“压缩图像”部分列出了可以更有效地压缩的图像，同时评估了文件大小的潜在收益</font></i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c45/d66/afa/c45d66afa348cb8c00124c6d3c95bb99.jpg"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Lighthouse</a>还进行性能审计，包括图像优化验证。 它显示了可以更强地压缩并且可以延迟加载的图片。 <br><br> 从Chrome 60开始，此服务可在Chrome DevTools <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">审核</a>仪表板中使用： <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f98/cbe/eb0/f98cbeeb0a10a2faf610981cecf07400.jpg"><br>  <i><font color="gray">Lighthouse着眼于生产力，最佳实践或Web应用程序的高级功能（可选）进行审核</font></i> <br><br> 您可能知道其他审核工具，例如<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PageSpeed Insights</a>和Cloudinary的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Website Speed Test</a> ，其中包括详细的图像审核。 <br><br><a name="03"></a><h1> 如何选择格式？ </h1><br> 正如Ilya Grigorik在其出色的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">图像优化指南中</a>指出的那样，“正确格式”结合了所需的视觉效果和功能要求。 您有栅格或矢量图形吗？ <br><br><img src="https://habrastorage.org/getpro/habr/post_images/69b/fc1/e44/69bfc1e44304fbf9877fe53a86ff80b2.png"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">栅格图形</a>将每个像素的值编码在像素的矩形网格上。 它们与分辨率或比例无关。  WebP或受广泛支持的格式（例如JPEG或PNG）可以执行这种图形处理。 光栅图形用于需要真实感的地方。  Guetzli，MozJPEG和其他提到的工具适用于栅格图形。 <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">矢量图形</a>使用点，线和多边形来表示具有简单几何形状（例如徽标）的图像。 它提供高分辨率和缩放。 对于此选项，像SVG这样的格式更适合。 <br><br> 选择错误的格式将花费您很多钱。 请谨慎更改格式，并进行实验以节省各种格式。 <br><br> 杰里米·瓦格纳（Jeremy Wagner）在演讲中<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">强调了</a>在优化过程中评估不同格式时应考虑<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">的权衡</a> 。 <br><br><a name="04"></a><h1> 适度的jpeg </h1><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">JPEG</a>可能是世界上最受欢迎的图形格式。 如前所述，HTTP存档中站点<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=http://">上的图像中有45％</a>是JPEG图像。 您的电话，数码相机，旧网络摄像头-它们通常都支持此编解码器。 它非常古老，自1992年以来一直使用。 在这段时间里，已经进行了大量有关如何改善JPEG压缩的研究。 <br><br>  JPEG是一种有损压缩算法，可丢弃“多余”信息以节省空间。 面临的挑战是最大程度地提高视觉准确性，同时最小化文件大小。 <br><br><h4> 您所接受的图像质量是多少？ </h4><br>  JPEG之类的格式最适合具有多种颜色的照片或图像。 大多数优化工具将允许您选择可接受的压缩级别：更高的压缩程度会减小文件的大小，但会带来瑕疵：光晕或块状。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ef8/c24/b8e/ef8c24b8ea845d7f5ba216762c72f60c.jpg"><br>  <i><font color="gray">JPEG压缩伪影会随着您从最佳到最坏的情况而增加。</font></i>  <i><font color="gray">请注意，不同工具中的图像质量可能会有很大差异。</font></i> <br><br> 选择压缩级别时，应考虑图像的质量： <br><br><ul><li>  <b>最好的</b> ：质量比文件大小更重要。 这可能是由于图像在设计中占据突出位置或以全分辨率显示的事实。 </li><li>  <b>很好</b> ：考虑节省流量时，不想过分影响图片质量。 尽管如此，插图的质量对用户来说仍然很重要。 </li><li>  <b>低</b> ：当您关心流量最小并忍受图像质量下降时。 此配置文件适用于覆盖范围较差且信道较薄的网络。 </li><li>  <b>最低</b> ：节省带宽至关重要。 用户同意质量很差才能更快地加载页面。 </li></ul><br> 接下来，让我们讨论对结果有很大影响的JPEG压缩模式。 <br><br><blockquote>  <b>注意：</b>有时我们可能会高估用户所需图像的质量。 质量可以被认为是与理想来源的偏离。 这是一个主观指标。 </blockquote><br><a name="05"></a><h1>  JPEG压缩模式 </h1><br>  JPEG格式具有多种不同的压缩模式。 三种流行的格式：基本（顺序），渐进JPEG（PJPEG）和无损压缩。 <br><br><h4> 基本（或顺序）和渐进JPEG有什么区别？ </h4><br> 基本JPEG（大多数编辑器和优化器的默认模式）相对简单地进行编码和解码：从上到下。 通过慢速或不稳定的连接加载基本JPEG时，用户将首先看到图片的顶部。 无损JPEG压缩模式类似于基本压缩模式，只是压缩率较低。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d23/6db/cbe/d236dbcbedb51e84a7ab3531543008f9.jpg"><br>  <i><font color="gray">从顶部到底部加载基本JPEG（基线JPEG），从模糊到清晰下载渐进JPEG。</font></i> <br><br> 渐进式JPEG将图像分为一系列遍。 第一遍显示图像的形式模糊且质量低劣，随后的遍历逐渐改善质量。 每次通过都会提高细节水平。 最后，将创建完整图像。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/576/cd4/82c/576cd482ced17692a2dd98fc68cf7eb7.jpg"><br>  <i><font color="gray">基本JPEG从上到下上传图像。</font></i>  <i><font color="gray">PJPEG首先显示模糊的图片，然后提高分辨率。</font></i>  <i><font color="gray">Pat Minan开发<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=http://www.patrickmeenan.com/progressive/view.php%3Fimg%3D">了一种交互式工具，</a>用于测试和研究渐进式JPEG文件</font></i> <br><br> 通过从数码相机和编辑器中<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">删除EXIF标头</a> ，优化<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">霍夫曼表</a>并重新扫描图像，可以实现无损JPEG优化。 诸如<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">jpegtran之类的</a>工具可通过重建压缩数据而不损害图像质量<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">来</a>提供无损压缩。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">jpegrescan</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">jpegoptim</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">mozjpeg</a> （我们将在后面介绍）也支持无损JPEG压缩。 <br><br><a name="06"></a><h2> 渐进式JPEG的好处 </h2><br>  PJPEG在启动时显示预览的能力提高了性能-用户看来，图像的加载速度比标准图形更快。 <br><br> 在3G连接速度较慢的情况下，当仅接收部分文件时，这可使您大致看到图片-并决定是否等待其完全下载。 与在基本JPEG中从顶部到底部加载图像相比，这可能更方便。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f54/39b/acc/f5439bacc4fb55239d2895ac9817b492.png"><br>  <i><font color="gray">2015年， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Facebook改用PJPEG（针对其iOS应用程序）</a> ，流量减少了10％。</font></i>  <i><font color="gray">他们能够以比以前快15％的速度显示高质量的图像，从而优化了感知的加载时间，如上图所示。</font></i> <br><br> 与10 KB以上的基本/简单JPEG相比，PJPEG可以将文件大小减少2-10％。 由于每次编译都可以编译一个单独的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">霍夫曼表，</a>因此可以实现较高的压缩率。 现代JPEG编码器（例如<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">libjpeg-turbo</a> ，MozJPEG等）使用PJPEG的灵活性来实现更好的数据压缩。 <br><br><blockquote>  <b>注意：</b>为什么PJPEG压缩效果更好？ 因为基本JPEG块一次被编码一次，并且在PJPEG中，来自几个块的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">离散余弦变换</a>系数可以一起编码，所以压缩效果更好。 </blockquote><br><a name="07"></a><h2> 谁在生产中使用渐进式JPEG？ </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Twitter.com产生</a>基本质量为85％的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">渐进式JPEG</a> 。 他们测量了用户感知到的主观延迟（到第一遍的时间和总下载时间），并基于压缩，编码和解码速度的质量决定PJPEG通常是合适的。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Facebook在iOS应用程序中生成渐进式JPEG</a> 。 这将流量减少了10％，并将“高质量”图像的发布速度提高了15％。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Yelp切换为渐进式JPEG</a> 。 这是使图像尺寸减少约4.5％的措施之一。 由于MozJPEG，它又下跌了13.8％。 </li></ul><br> 许多其他具有大量图像文件的网站，例如<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Pinterest</a> ，也在生产中使用逐行JPEG。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/106/3da/c22/1063dac226ca94466d408d5eb660ebce.png"><br>  <i><font color="gray">在Pinterest上，图像仅以渐进JPEG编码。</font></i>  <i><font color="gray">当图片逐渐出现时，对用户来说更方便</font></i> <br><br><a name="08"></a><h2> 渐进式JPEG缺点 </h2><br>  PJPEG解码比基本JPEG慢-有时慢三倍。 在具有强大处理器的台式机上，这并不像在资源有限的移动设备上那样重要。 显示不完整的图层需要工作，因为您实际上对图像进行了多次解码。 这些多段占用了CPU周期。 <br><br> 同样，渐进式JPEG图像<i>并不总是</i>较小。 逐渐对非常小的图像（例如预览缩略图）进行编码会增加其尺寸。 对于这样的图片，多次渲染通常毫无意义。 <br><br> 因此，在选择PJPEG之前，建议先进行实验并在文件大小，网络延迟和CPU使用率之间找到适当的平衡。 <br><br><blockquote>  <b>注意：</b>移动设备可以支持PJPEG（和所有JPEG）硬件解码。 这不会减少内存消耗，但会减少处理器的负载。 并非所有的Android智能手机都具有硬件加速功能，但在高端设备和iOS设备中却是如此。 </blockquote><br> 一些用户可能会认为渐进式下载是一个缺点，因为它使映像下载何时完成变得难以理解。 尝试评估您的听众如何与此相关。 <br><br><a name="09"></a><h2> 如何编码渐进式JPEG文件？ </h2><br> 诸如<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ImageMagick</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">libjpeg</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">jpegtran</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">jpeg-recompress</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">imagemin之</a>类的工具和库<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">都</a>支持渐进JPEG。 如果您已经设置了优化管道，则更改JPEG编码方法可能不会成为问题： <br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> gulp = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'gulp'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> imagemin = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'gulp-imagemin'</span></span>); gulp.task(<span class="hljs-string"><span class="hljs-string">'images'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> gulp.src(<span class="hljs-string"><span class="hljs-string">'images/*.jpg'</span></span>) .pipe(imagemin({ <span class="hljs-attr"><span class="hljs-attr">progressive</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> })) .pipe(gulp.dest(<span class="hljs-string"><span class="hljs-string">'dist'</span></span>)); });</code> </pre> <br> 默认情况下，大多数编辑器都保存为基本JPEG。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1fe/8fe/189/1fe8fe189888206150a2c92ad28b590f.jpg"><br>  <i><font color="gray">默认情况下，大多数编辑器都保存为基本JPEG，但是可以在设置中进行更改。</font></i>  <i><font color="gray">在Photoshop中，需要选择命令“文件”→“导出”→“保存为Web”，并在其中指示渐进JPEG格式。</font></i>  <i><font color="gray">通过选中JPG导出菜单中的复选框，Sketch还支持导出渐进JPEG。</font></i> <br><br><a name="10"></a><h2> 颜色下采样 </h2><br> 我们的眼睛注意到颜色损失少于亮度损失。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">颜色子采样</a> （色度子采样）-一种压缩类型，由于亮度（亮度）而降低了颜色精度。 这样可以将文件大小减小<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">到15-17％</a> ，而不会显着影响图像质量。 过采样还可以减少内存使用量。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/41b/040/dd9/41b040dd91221b76f82d9f207646ef4a.jpg"><br><br> 对比度负责图片的清晰度，因此亮度非常重要。 黑白照片没有颜色，但是由于亮度，它们看起来和彩色照片一样详细。 色度对视觉的影响较小。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1d7/518/d2e/1d7518d2e4020bf3c7b4f58500d2b4e5.jpg"><br>  <i><font color="gray">JPEG支持各种类型的子采样：无子采样，水平，水平+垂直。</font></i>  <i><font color="gray">这是Frederick Kaiser的文章<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“ JPEG for Crabs”</a>的插图</font></i> <br><br> 在讨论子样本时，通常会引用许多常见示例：4：4：4，4：2：2和4：2：0。 什么啊 假设子样本的格式为A：B：C。 这里A是一行中的像素数，对于JPEG通常是4，B是第一行中的颜色数，而C是第二行中的颜色数。 <br><br><ul><li> 在<code>4:4:4</code>中没有压缩，色彩和亮度可以完全传输。 </li><li> 在<code>4:2:2</code>水平采样一半，垂直采样一半。 </li><li> 在<code>4:2:0</code> ，使用第一行像素一半的颜色。 </li></ul><br><blockquote>  <b>注意：</b> jpegtran和cjpeg通过<code>-sample</code>标志（例如， <code>-sample 2x1</code> ）支持亮度和颜色的单独配置。 一些通用规则：下采样（ <code>-sample 2x2</code> ）非常适合照片。 最好为屏幕截图，横幅和按钮禁用它（ <code>-sample 1x1</code> ）。 最后，如果不确定使用哪个选项， <code>2x1</code> 。 </blockquote><br> 通过减少像素数，可以显着减小颜色分量的大小，最终减小文件的大小。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6d5/cbd/8d3/6d5cbd8d354285776369025a20c3390c.jpg"><br>  <i><font color="gray">80种颜色子采样选项可实现JPEG质量80</font></i> <br><br> 颜色下采样对于大多数图像很有用，尽管有明显的例外：最好不要在颜色细节与亮度同样重要的情况下使用它（例如医学图像）。 <br><br> 带有字体的图像也会受到影响。 清晰的边缘很难用JPEG压缩，因为它可以更好地处理柔和过渡的摄影场景。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/792/434/e28/792434e286dd698afecc7de662c8ab18.jpg"><br>  <i><font color="gray">处理文本时<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">，Learning JPEG</a>教程建议坚持4：4：4（1×1）二次采样</font></i> <br><br> 顺便说一句：在JPEG规范中，没有指出颜色二次采样的确切方法，因此不同的编码器/解码器的行为不同。  MozJPEG和libjpeg-turbo使用相同的方法，而旧版本的libjpeg使用另一个方法，这会增加构件。 <br><br><blockquote>  <b>注意：</b>当保存到Web时，Photoshop会自动选择颜色子采样。 如果质量设置在51-100范围内，则不使用子采样（4：4：4）。 当质量较低时，设置为4：2：0。 这是将质量从51切换到50时文件大小急剧减少的原因之一。 </blockquote><br><blockquote>  <b>注意：</b>术语<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">YCbCr</a>在子采样的讨论中经常被提及。 这是伽玛校正<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">RGB</a>颜色空间<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">模型</a> 。  Y是经过伽马校正的亮度，Cb是蓝色的色度分量，Cr是红色。 如果查看ExifData，您将在样本级别旁边看到YCbCr。 </blockquote><br> 有关更多信息，请参见文章<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“为什么不使用颜色子采样？”</a> <br><br><a name="11"></a><h2> 上乘JPEG </h2><br><h4> 互联网上JPEG的当前状态是什么？ </h4><br> <i>tl;dr:     .    ,        .</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3e2/26c/f29/3e226cf294bca6151e7ab29b3cc8e05d.jpg"><br> <i><font color="gray">   ( )        26 .    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SSIM</a> ( )  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Butteraugli</a> ,      .</font></i> <br><br><ul><li> <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">JPEG 2000</a> (2000)</b> —          . <b>  :  Safari  iOS</b> . </li><li> <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">JPEG XR</a> (2009)</b> —  JPEG  JPEG 2000,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">HDR</a>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a> .    ,  JPEG,      /. <b>  : Edge, IE</b> . </li><li> <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">WebP</a> (2010)</b> —       Google       .   ,  JPEG,   ,  PNG.        .   ,   JPEG. <b>  : Chrome, Opera.    Safari  Firefox</b> . </li><li> <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">FLIF</a> (2015)</b> —    ,  PNG, WebP  , BPG    JPEG 2000     . <b>  : ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">JS-</a></b> . </li><li> <b>HEIF  BPG</b> .      ,     : </li><li> <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">BPG</a> (2015)</b> —  JPEG      HEVC ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">High Efficiency Video Coding</a> ). ,        MozJPEG  WebP.      -   . <b>  : ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">JS-</a></b> . </li><li> <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">HEIF</a> (2015)</b> —      ,  HEVC   . Apple   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">WWDC</a> ,     c JPEG  HEIF    iOS,        . <b>  :     .     Safari  iOS 11</b> . </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您希望收到以图形形式的信息，您可以欣赏</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这些</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">工具的视觉对比上面的一些格式。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因此，</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">浏览器支持非常不同</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。要使用上述任何一种格式，您可能必须为每个目标浏览器提供不同的副本。我们在Google看到了某些WebP前景，因此我们将尽快仔细研究这种格式。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您还可以生成具有相同.jpg扩展名（或任何其他扩展名）的不同格式（例如WebP，JPEG 2000），因为浏览器可以选择内容类型进行渲染，而无需考虑扩展名。这使您可以</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指定内容类型</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在服务器端，根本不需要更改HTML文档。</font><font style="vertical-align: inherit;">像Instart Logic这样的服务都采用这种方法。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接下来，我们将讨论无法输出不同格式图像的情况：</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JPEG优化器</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将在此提供帮助</font><font style="vertical-align: inherit;">。</font></font><br><br><a name="12"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> JPEG优化器 </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现代JPEG编解码器在保持质量和与现有浏览器和应用程序兼容的同时，试图减小JPEG文件的大小。</font><font style="vertical-align: inherit;">他们消除了使用新图像格式并改变生态系统的需要。</font><font style="vertical-align: inherit;">这些编码器中的两个是MozJPEG和Guetzli。</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tl; dr：要使用哪个优化的JPEG编解码器？</font></font></b> <br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 多数文件：MozJPEG </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 如果质量很重要并且您同意连续编码：Guetzli </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 如果您需要可配置性： </font></font></li></ul><br><a name="13"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 什么是MozJPEG？ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mozilla提供了升级的JPEG编码器</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-MozJPEG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。根据</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">声明</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的开发商，它减少了JPEG文件的大小高达10％。 MozJPEG压缩文件可在所有浏览器中打开，并且受支持的功能包括逐行扫描，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">网格量化</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（删除压缩最差的细节）和几个高级</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">量化表模板</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，这些</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">模板</font></a><font style="vertical-align: inherit;">可帮助创建更平滑的High-DPI图像（尽管这是可能的）如果您已经准备好遍历XML配置的丛林，请使用ImageMagick。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageOptim支持</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MozJPEG，</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且有一个相对可靠的可自定义</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagemin插件</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。这是使用Gulp的示例实现：</font></font><br><br><pre> <code class="hljs php"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> gulp = <span class="hljs-keyword"><span class="hljs-keyword">require</span></span>(<span class="hljs-string"><span class="hljs-string">'gulp'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> imagemin = <span class="hljs-keyword"><span class="hljs-keyword">require</span></span>(<span class="hljs-string"><span class="hljs-string">'gulp-imagemin'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> imageminMozjpeg = <span class="hljs-keyword"><span class="hljs-keyword">require</span></span>(<span class="hljs-string"><span class="hljs-string">'imagemin-mozjpeg'</span></span>); gulp.task(<span class="hljs-string"><span class="hljs-string">'mozjpeg'</span></span>, () =&gt; gulp.src(<span class="hljs-string"><span class="hljs-string">'src/*.jpg'</span></span>) .pipe(imagemin([imageminMozjpeg({ quality: <span class="hljs-number"><span class="hljs-number">85</span></span> })])) .pipe(gulp.dest(<span class="hljs-string"><span class="hljs-string">'dist'</span></span>)) );</code> </pre> <br><img src="https://habrastorage.org/getpro/habr/post_images/4f4/7fe/93a/4f47fe93a97da4bb6e0d1fb491f99d32.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c90/265/8a2/c902658a2ad04db50cf3a5e76d8cffb5.jpg"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MozJPEG：比较文件大小和不同质量的视觉相似性评级。</font></font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为了计算SSIM评级（与原始图像的结构相似性），我使用</font><font style="vertical-align: inherit;">了</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"> jpeg-archive</font></a><font style="vertical-align: inherit;">项目中的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> jpeg-compress</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">以我的经验，MozJPEG是压缩Internet上高质量图像同时减小文件大小的不错选择。对于中小型图像，MozJPEG（质量为80–85）可将文件减少30–40％，同时保持可接受的SSIM，而使用jpeg-turbo可以提高5–6％。它的编码</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">速度比基本JPEG慢</font></a><font style="vertical-align: inherit;">，但差异并不严重。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br><br><blockquote> <b>:</b>    ,  MozJPEG          ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">jpeg-recompress</a> .   «-  »        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a> . </blockquote><br><a name="14"></a><h2>   Guetzli? </h2><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Guetzli</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是来自Google的有前途但非常缓慢的感知JPEG编解码器。他试图找到最小的JPEG，与原版在感觉上没有区别。编解码器执行了一系列实验，提供了可供比较的选项，并考虑了每个选项的心理视觉错误。评分最高的选项被选为最终结果。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Guetzli使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Butteraugli</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（一种基于人类感知的模型（如下所述））</font><font style="vertical-align: inherit;">来测量图像之间的差异</font><font style="vertical-align: inherit;">。 Guetzli考虑了人类视觉的某些属性，而其他JPEG编解码器并未考虑这些属性。例如，可见的绿色光量与对蓝色的敏感度之间存在关系，因此，绿色周围的蓝色变化可能不太准确。</font></font><br><br><blockquote> <b>:</b>   <b></b>     <b> </b> ,    .         JPEG ,  ó ,    .       .      ,      . </blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Guetzli </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">声称</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与其他压缩程序相比，文件大小差异为20-30％，而不会降低Butteraugli的得分。格茨利（Guetzli）的最大缺点是他的极慢，因此目前仅适用于静态内容。 README表示消耗了大量内存：编码大约需要1分钟，每兆像素需要200 MB RAM。 GitHub上有一个</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">很好的线程</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">讨论了Guetzli的真实经验。编解码器是在构建静态站点时优化图像的理想选择，但不太适合按需启动。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">诸如ImageOptim之类的工具均支持Guetzli优化（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最新版本</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br><br><pre> <code class="hljs php"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> gulp = <span class="hljs-keyword"><span class="hljs-keyword">require</span></span>(<span class="hljs-string"><span class="hljs-string">'gulp'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> imagemin = <span class="hljs-keyword"><span class="hljs-keyword">require</span></span>(<span class="hljs-string"><span class="hljs-string">'gulp-imagemin'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> imageminGuetzli = <span class="hljs-keyword"><span class="hljs-keyword">require</span></span>(<span class="hljs-string"><span class="hljs-string">'imagemin-guetzli'</span></span>); gulp.task(<span class="hljs-string"><span class="hljs-string">'guetzli'</span></span>, () =&gt; gulp.src(<span class="hljs-string"><span class="hljs-string">'src/*.jpg'</span></span>) .pipe(imagemin([ imageminGuetzli({ quality: <span class="hljs-number"><span class="hljs-number">85</span></span> }) ])) .pipe(gulp.dest(<span class="hljs-string"><span class="hljs-string">'dist'</span></span>)) );</code> </pre> <br><img src="https://habrastorage.org/getpro/habr/post_images/734/9a0/698/7349a069854fef62982512c8e3a08f1a.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用不同级别对3000×3000像素的Guetzli图像进行编码将近7分钟。</font><font style="vertical-align: inherit;">这对于存档高分辨率照片是有意义的。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/b2b/6a4/1a8/b2b6a41a8799620ebc175fb9c63c1bb0.jpg"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Guetzli：比较文件大小并评估不同质量的视觉相似度</font></font></font></i> <br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">建议您在高质量图像上运行Guetzli（例如，未压缩的源图像，质量约为100％的PNG或JPEG）。</font><font style="vertical-align: inherit;">尽管对其他图像（例如JPEG质量84或更低）也有影响，但是效果较差。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Guetzli花费非常（非常）的时间，这将使CPU冷却器完全旋转，但这是值得的。</font><font style="vertical-align: inherit;">我看到了许多示例，这些示例在保持视觉准确性的同时将文件大小减小了40％。</font><font style="vertical-align: inherit;">这使其成为存档照片的理想选择。</font><font style="vertical-align: inherit;">在中小型图像上，还可以节省一些费用（在10-15 KB范围内），但并不是很明显。</font><font style="vertical-align: inherit;">当压缩非常小的图像时，Guetzli会引入类似流体的变形。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于各种用</font><font style="vertical-align: inherit;">例</font><font style="vertical-align: inherit;">，您可能有兴趣</font><font style="vertical-align: inherit;">在Eric Portis的研究中将Guetzli与Cloudinary自动压缩</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">进行比较</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><br><a name="15"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> MozJPEG和Guetzli的比较 </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">比较不同的JPEG编解码器很困难：您需要评估压缩图像的质量和准确性，而不仅仅是大小。</font><font style="vertical-align: inherit;">正如图像压缩专家Cornel Lesinsky指出的那样，只有一个基准（而不是两个基准）可以</font><font style="vertical-align: inherit;">得出</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误的</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结论。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">比较起来，Guetzli和MozJPEG的外观如何？</font><font style="vertical-align: inherit;">康奈尔大学的方法：</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Guetzli适用于更高质量的图像（q = 90 +和MozJPEG-大约q = 75被认为是最佳等级的butteraugli） </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Guetzli慢得多（两者均产生标准JPEG，因此解码速度与往常一样快） </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MozJPEG不会自动选择质量设置，但是您可以使用外部工具（例如</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">jpeg-archive）</font></a><font style="vertical-align: inherit;">找到最佳质量</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a> </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有许多方法可以确定压缩图像与源之间的视觉或感知相似性。</font><font style="vertical-align: inherit;">研究通常使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSIM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（结构相似性）。</font><font style="vertical-align: inherit;">但是，Guetzli已针对Butteraugli进行了优化。</font></font><br><br><a name="16"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 巴特劳利 </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Butteraugli系统确定一个人开始注意到两个图像之间的差异（心理-视觉相似性）的时刻。 Butteraugli不仅可以提供估计值，还可以绘制差异程度的空间图。虽然SSIM会汇总所有错误，但Butteraugli会寻找最大错误。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/798/5b0/df8/7985b0df81227135fd3b432abf490a1b.jpg"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在此示例中，Butteraugli寻找JPEG质量的最小阈值，以使用户不会注意到图像之间的视觉差异。这样一来，我们就可以将文件大小减少65％</font></font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">；实际上，您可以确定视觉质量水平，然后运行多种图像优化策略（查看Butteraugli估算值），然后选择与文件大小和压缩级别达到最佳平衡的结果。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/bf8/9e1/b18/bf89e1b182b3c5e8b89ffab674e1488d.jpg"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装Bazel并构建C ++源代码以在Mac上正确编译之后，我花了大约30分钟的时间在本地配置Butteraugli。</font><font style="vertical-align: inherit;">它的使用相对简单：指定两个图像进行比较（源和压缩版本）-并获得估计值</font></font></font></i> <br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Butteraugli与其他评估视觉相似度的方法有何不同？ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Guetzli的一位开发人员</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，Guetzli在Butteraugli方面更好，在SSIM方面更差，而MozJPEG在这两个指标上同样出色。</font><font style="vertical-align: inherit;">这是我用来优化图像的策略。</font><font style="vertical-align: inherit;">我正在运行Butteraugli和类似</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">img-ssim</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的Node模块，</font><font style="vertical-align: inherit;">以比较Guetzli和MozJPEG之前/之后的SSIM评级。</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 编码器协会？ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实践证明，结合使用Guetzli和MozJPEG </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不会造成任何损失</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（jpegtran，而不是cjpeg，以便不放弃Guetzli所做的工作），可以进一步将文件大小减少10-15％（总体占55％），而SSIM得分却略有下降。</font><font style="vertical-align: inherit;">这需要进行验证和分析，但是其他专家（例如</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aria Khidayat）进行了</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尝试，并获得了同样可喜的结果。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MozJPEG是适合初学者的便捷编解码器，它可以较快速地为Web压缩文件并提供良好的图像质量。</font><font style="vertical-align: inherit;">同时，Guetzli占用大量资源，并且在处理大型高质量图像时效果最佳：我建议高级和专业用户使用此选项。</font></font><br><br><a name="17"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 什么是WebP？ </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebP是Google最新的图形格式，旨在通过无损和有损压缩来减小文件大小，以提供可接受的视觉质量。</font><font style="vertical-align: inherit;">支持Alpha通道（透明度）和动画。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebP正在改进：在过去的一年中，WebP在无损和有损压缩方面增加了百分之几，在编码速度方面提高了两倍，解码速度提高了10％。</font><font style="vertical-align: inherit;">WebP不是通用工具，但其普及度正在增长。</font><font style="vertical-align: inherit;">让我们看看为什么。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f9a/25d/5ca/f9a25d5cafa3418ab89008985e8784d4.jpg"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebP：比较文件大小并评估不同质量级别的视觉相似度</font></font></font></i> <br><br><a name="18"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> webp如何工作？ </font></font></h2><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 损耗压缩 </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开发人员说，使用VP8或VP9编解码器进行有损压缩后，</font><font style="vertical-align: inherit;">与JPEG相比</font><font style="vertical-align: inherit;">，文件平均减少了</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25–34％</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在低质量范围（0–50）中，WebP具有比JPEG更大的优势，因为它侵蚀了难看的块状伪像。</font><font style="vertical-align: inherit;">中等质量设置（-m 4 -q 75）-速度和文件大小的默认平衡。</font><font style="vertical-align: inherit;">在高质量范围（80–99）中，WebP的好处是微不足道的。</font><font style="vertical-align: inherit;">在速度比质量更重要的地方建议使用WebP。</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 无损压缩 </font></font></h4><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">具有无损压缩的WebP文件比PNG文件小26％</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">与PNG相比，下载时间减少了3％。</font><font style="vertical-align: inherit;">但是，在Internet上，不普遍使用无损压缩。</font><font style="vertical-align: inherit;">此选项更适合归档存储。</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 透明性 </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebP具有8位透明通道，其无损压缩比PNG多22％的字节。</font><font style="vertical-align: inherit;">它还支持有损RGB透明性，这是WebP的独特功能。</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 元数据 </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebP格式支持EXIF照片元数据和XMP数字文档，并且还包含ICC颜色配置文件。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebP由于具有更高的CPU使用率而提供了更好的压缩。</font><font style="vertical-align: inherit;">早在2013年，WebP压缩的速度大约是JPEG的10倍，但是现在两者之间的差异并不显着（某些图像的压缩速度是其两倍。</font><font style="vertical-align: inherit;">对于在组装过程中处理的静态图像，这应该不是什么大问题。</font><font style="vertical-align: inherit;">动态生成的映像可能会导致必须注意的CPU使用率显着下降。</font></font><br><br><blockquote> <b>:</b>   WebP      JPEG. , JPEG   70%      WebP   70%,   WebP    ,   . </blockquote><br><a name="19"></a><h2>   WebP  ? </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">许多大公司在生产中使用WebP来降低成本并提高页面加载速度。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google报告说，与其他有损压缩方案相比，WebP节省了30-35％。 Google每天产生430亿张图片，其中26％被无损压缩。这有很多要求，而且可以节省很多钱。毫无疑问，当浏览器改进</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebP支持</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">时，它将增加</font><font style="vertical-align: inherit;">。 Google在Google Play，YouTube和其他网站上使用这种格式。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Netflix，亚马逊，Quora，雅虎，沃尔玛，Ebay，《卫报》，《财富》和《今日美国》为支持它的浏览器压缩并生成WebP图像。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过</font></font></a> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为Chrome用户切换到WebP，</font><font style="vertical-align: inherit;">VoxMedia发布</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">者将</font></a></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">合并” </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">页面的加载时间减少了1-3秒</font></a><font style="vertical-align: inherit;">。网站</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">500px的</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相同或更好的质量记录的平均25％的文件的大小减小。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">除上述之外，其他公司也使用WebP。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c9f/2a1/51f/c9f2a151ff30b5a3dd8b20178a78e64b.jpg"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在Google使用WebP：每天在YouTube，Google Play，Chrome数据保护程序和Google+上显示430亿幅WebP图像</font></font></font></i> <br><br><a name="20"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> WebP编码如何工作？ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于静态图像，WebP是JPEG的替代方法。在有损编码中，有三个关键步骤：</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">宏</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">块-将图像分成亮度为16×16像素的（宏）块和色彩为8×8像素的（宏）块。这类似于JPEG变换颜色空间，将其分成块并减少颜色通道上的像素数的方式。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/65f/45b/705/65f45b70532300058c0e9a00fe08b6de.png"><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">预测</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -对于每个4×4子块，将编译一个有效执行滤波的预测模型。它由块周围的两组像素定义：A（紧邻行）和L（左行）。使用这两个集合，编码器用像素填充4×4测试块，并确定哪些值最接近原始块。 Colt Macanlis在一篇</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">文章中</font></a><font style="vertical-align: inherit;">谈到了更多</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> WebP如何在有损压缩模式下工作。 </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cd2/863/50a/cd286350a67629c8fa14233af6973893.png"></div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与JPEG一样，离散余弦变换（DCT）应用于多个阶段。</font><font style="vertical-align: inherit;">关键区别在于使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">算术压缩</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而不是像JPEG那样使用霍夫曼算法。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有关更多信息，我建议阅读</font><font style="vertical-align: inherit;">Google Developer </font><font style="vertical-align: inherit;">的文章</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ WebP压缩方法”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><br><a name="21"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> WebP浏览器支持 </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并非所有浏览器都支持WebP，但是根据</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CanIUse.com的说法</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，全球支持约为74％。</font><font style="vertical-align: inherit;">Chrome和Opera支持该格式。</font><font style="vertical-align: inherit;">Safari，Edge和Firefox正在试验中，但尚未在正式版本中实现支持。</font><font style="vertical-align: inherit;">因此，WebP发行通常取决于Web开发人员。</font><font style="vertical-align: inherit;">稍后再详细介绍。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下是每个浏览器的主要浏览器和支持信息：</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Chrome：自版本23起提供全面支持 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Chrome for Android：从Chrome 50开始 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Android：从4.2开始 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 歌剧：12.1起 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Opera Mini：所有版本 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Firefox：一些Beta支持 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Edge：一些beta支持 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Internet Explorer：否 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Safari：一些Beta支持 </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebP并非没有缺陷。</font><font style="vertical-align: inherit;">它缺少全分辨率的色彩空间选项，并且不支持渐进式解码。</font><font style="vertical-align: inherit;">尽管如此，已经为WebP创建了一个不错的工具包，并且浏览器支持足以将发布WebP作为一种选择。</font></font><br><br><a name="22"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 如何将图像转换为WebP？ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一些商业和免费编辑器支持WebP。</font><font style="vertical-align: inherit;">XnConvert是最有用的应用程序之一：它是一个免费的跨平台批处理转换器。</font></font><br><br><blockquote> <b>:</b>      WebP  JPEG    .   ,      WebP    JPEG.    WebP,      , <i>  JPEG</i> ,      .      ,  . </blockquote><br><h4> XnConvert </h4><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XnConvert可以</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">处理500多种格式的批处理图像。</font><font style="vertical-align: inherit;">您可以组合80多个单独的操作来转换或编辑图像。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/507/572/44f/50757244ffc4338222e3960f09485c31.png"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XnConvert通过执行从源文件到WebP和其他格式的直接转换来支持批处理图像优化。</font><font style="vertical-align: inherit;">除压缩外，XnConvert还可以删除元数据，裁剪图像，调整颜色深度和执行其他转换，xnview</font></font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">网站上列出的一些参数包括：</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 元数据：编辑 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 转换：旋转，裁剪，调整大小 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 调整：亮度，对比度，饱和度 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 过滤器：模糊，凹凸，清晰度 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 效果：遮罩，水印，渐晕（部分变暗） </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作结果可以导出为大约70种不同的文件格式，包括WebP。</font><font style="vertical-align: inherit;">XnConvert是针对Linux，Mac和Windows的免费程序。</font><font style="vertical-align: inherit;">这是一个不错的选择，尤其是对于小型企业。</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 节点模块 </font></font></h4><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Imagemin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一种流行的图像压缩模块，具有用于转换为WebP（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagemin-webp</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">的扩展</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">支持无损和无损压缩。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要安装imagemin和imagemin-webp，请运行：</font></font><br><br> <code>&gt; npm install --save imagemin imagemin-webp</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后，我们可以在两个模块中编写require（）并在项目目录中的任何图像（例如JPEG）上运行它们。</font><font style="vertical-align: inherit;">下面我们使用有损编码和WebP 60编码器质量：</font></font><br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> imagemin = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'imagemin'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> imageminWebp = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'imagemin-webp'</span></span>); imagemin([<span class="hljs-string"><span class="hljs-string">'images/*.{jpg}'</span></span>], <span class="hljs-string"><span class="hljs-string">'images'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">use</span></span>: [ imageminWebp({<span class="hljs-attr"><span class="hljs-attr">quality</span></span>: <span class="hljs-number"><span class="hljs-number">60</span></span>}) ] }).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Images optimized'</span></span>); });</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与JPEG中一样，您可以在最终图像中看到压缩伪像。</font><font style="vertical-align: inherit;">亲自查看哪种压缩级别适合您的文件。</font><font style="vertical-align: inherit;">通过指定参数，Imagemin-webp也可以用于编码WebP图像而不会降低质量（支持24位彩色和全透明）</font></font><code>lossless: true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> imagemin = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'imagemin'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> imageminWebp = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'imagemin-webp'</span></span>); imagemin([<span class="hljs-string"><span class="hljs-string">'images/*.{jpg,png}'</span></span>], <span class="hljs-string"><span class="hljs-string">'build/images'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">use</span></span>: [ imageminWebp({<span class="hljs-attr"><span class="hljs-attr">lossless</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>}) ] }).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Images optimized'</span></span>); });</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sorhus Syndrome的</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">Gulp的WebP插件</font></a><font style="vertical-align: inherit;">是基于imagemin-webp制作的，还有</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个WebPack的WebP加载器</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">Gulp插件了解所有imagemin扩展选项：</font></font><br><br><pre> <code class="hljs coffeescript">const gulp = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'gulp'</span></span>); const webp = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'gulp-webp'</span></span>); gulp.task(<span class="hljs-string"><span class="hljs-string">'webp'</span></span>, <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> gulp.src(<span class="hljs-string"><span class="hljs-string">'src/*.jpg'</span></span>) .pipe(webp({ quality: <span class="hljs-number"><span class="hljs-number">80</span></span>, preset: <span class="hljs-string"><span class="hljs-string">'photo'</span></span>, method: <span class="hljs-number"><span class="hljs-number">6</span></span> })) .pipe(gulp.dest(<span class="hljs-string"><span class="hljs-string">'dist'</span></span>)) );</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 或无损压缩： </font></font><br><br><pre> <code class="hljs coffeescript">const gulp = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'gulp'</span></span>); const webp = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'gulp-webp'</span></span>); gulp.task(<span class="hljs-string"><span class="hljs-string">'webp-lossless'</span></span>, <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> gulp.src(<span class="hljs-string"><span class="hljs-string">'src/*.jpg'</span></span>) .pipe(webp({ lossless: <span class="hljs-literal"><span class="hljs-literal">true</span></span> })) .pipe(gulp.dest(<span class="hljs-string"><span class="hljs-string">'dist'</span></span>)) );</code> </pre> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 使用Bash进行批量图像优化 </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XNConvert支持批量压缩，但是您可以从命令行执行所有操作。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cwebp</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将图像批量转换为WebP </font><font style="vertical-align: inherit;">：</font></font><br><br><pre> <code class="bash hljs">find ./ -<span class="hljs-built_in"><span class="hljs-built_in">type</span></span> f -name <span class="hljs-string"><span class="hljs-string">'*.jpg'</span></span> -<span class="hljs-built_in"><span class="hljs-built_in">exec</span></span> cwebp -q 70 {} -o {}.webp \;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MozJPEG编解码器使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jpeg-recompress进行</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">优化</font><font style="vertical-align: inherit;">：</font></font><br><br><pre> <code class="bash hljs">find ./ -<span class="hljs-built_in"><span class="hljs-built_in">type</span></span> f -name <span class="hljs-string"><span class="hljs-string">'*.jpg'</span></span> -<span class="hljs-built_in"><span class="hljs-built_in">exec</span></span> jpeg-recompress {} {} \;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">svgo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">程序</font><font style="vertical-align: inherit;">（我们将在后面讨论）</font><font style="vertical-align: inherit;">对SVG进行修整</font><font style="vertical-align: inherit;">：</font></font><br><br><pre> <code class="bash hljs">find ./ -<span class="hljs-built_in"><span class="hljs-built_in">type</span></span> f -name <span class="hljs-string"><span class="hljs-string">'*.svg'</span></span> -<span class="hljs-built_in"><span class="hljs-built_in">exec</span></span> svgo {} \;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">杰里米·瓦格纳（Jeremy Wagner）写了一篇更完整的文章，内容涉及</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在Bash中优化图像</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，另一篇关于</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并行化</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此任务。</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 其他WebP处理和编辑应用程序 </font></font></h4><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Leptonica是一个免费图像处理和分析应用程序的完整网站。 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sketch支持保存到WebP。 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GIMP是Photoshop的免费开源替代品。 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageMagick-栅格图形的创建，布局，转换和编辑。</font><font style="vertical-align: inherit;">免费，可从命令行运行。</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pixelmator是Mac的商业图像编辑器。 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Photoshop WebP插件是Google提供的免费插件。</font><font style="vertical-align: inherit;">在Photoshop中导入和导出图像。</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于Android，您可以使用Android Studio将现有的BMP，JPG，PNG和静态GIF转换为WebP格式。</font><font style="vertical-align: inherit;">有关更多信息，请参见</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“使用Android Studio创建WebP图像”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><br><a name="23"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 如何在我的操作系统上查看WebP图像？ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尽管WebP图像始终使用Blink引擎（Chrome，Opera，Brave）在浏览器中打开，但可以使用Mac或Windows的外接程序从OS直接查看它们。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">几年前，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Facebook对WebP进行了试验，</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发现一个问题：一些用户将图片保存到磁盘上，然后无法打开它们。</font><font style="vertical-align: inherit;">这里有三个关键问题：</font></font><br><br><ul><li>       WebP .    Chrome,       .webp. </li><li>        ,    Chrome. Facebook  ,    «»,    JPEG. </li><li>  URL         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> content-type</a> . </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您的用户可能没有此类问题，但这是一个有趣的边注。</font><font style="vertical-align: inherit;">幸运的是，今天有实用程序可以在不同的操作系统下查看WebP。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在Mac上，尝试使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">Quick Look插件</font></a><font style="vertical-align: inherit;">（qlImageSize）。</font><font style="vertical-align: inherit;">它运作良好：</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/31f/440/5f5/31f4405f5b2c5e9fe146d00c77566621.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在Windows下，您可以下载</font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebP编解码器软件包</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，该</font><a href=""><font style="vertical-align: inherit;">软件包</font></a><font style="vertical-align: inherit;">添加了在File Explorer和Windows Photo Viewer中查看WebP的选项。</font></font><br><br><a name="24"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 如何提供WebP？ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有WebP支持的浏览器将不会显示任何图片。</font><font style="vertical-align: inherit;">为了避免这种情况，有几种策略。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/921/075/af2/921075af2ee07862f7dc586ee402793d.jpg"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chrome DevTools的“网络”面板提供给Blink引擎上的浏览器的WebP文件选择</font></font></font></i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a88/8c9/56d/a888c956d80db06c0b4a170be510135e.jpg"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Play商店为WebP浏览器提供了Blink和JPEG到其他浏览器的支持，例如Firefox</font></font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下是向用户传递WebP图像的一些选项：</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 使用.htaccess发行WebP副本 </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果服务器具有JPEG / PNG文件的Webp版本，则以下是使用.htaccess在受支持的浏览器中发布WebP文件的方法。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vincent Orbach建议使用这种方法：</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">浏览器可以</font><font style="vertical-align: inherit;">通过</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">Accept标头</font></a><font style="vertical-align: inherit;">显式</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示WebP支持</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在这种情况下，您可以从服务器发送图像的WebP版本。</font><font style="vertical-align: inherit;">但这并非总是可能的（例如，对于静态主机，例如GitHub或S3页面），因此请务必在考虑此选项之前进行检查。</font><font style="vertical-align: inherit;">以下是Apache Web服务器的示例.htaccess文件：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><pre> <code class="hljs pgsql">&lt;IfModule mod_rewrite.c&gt; RewriteEngine <span class="hljs-keyword"><span class="hljs-keyword">On</span></span> # <span class="hljs-keyword"><span class="hljs-keyword">Check</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> browser support WebP images RewriteCond %{HTTP_ACCEPT} image/webp # <span class="hljs-keyword"><span class="hljs-keyword">Check</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> WebP replacement image <span class="hljs-keyword"><span class="hljs-keyword">exists</span></span> RewriteCond %{DOCUMENT_ROOT}/<span class="hljs-meta"><span class="hljs-meta">$1</span></span>.webp -f # Serve WebP image <span class="hljs-keyword"><span class="hljs-keyword">instead</span></span> RewriteRule (.+)\.(jpe?g|png)$ <span class="hljs-meta"><span class="hljs-meta">$1</span></span>.webp [T=image/webp,E=accept:<span class="hljs-number"><span class="hljs-number">1</span></span>] &lt;/IfModule&gt; &lt;IfModule mod_headers.c&gt; <span class="hljs-keyword"><span class="hljs-keyword">Header</span></span> append Vary Accept env=REDIRECT_accept &lt;/IfModule&gt; AddType image/webp .webp</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您在显示WebP图形时遇到问题，请确保在服务器上启用了MIME类型image / webp。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在Apache上，将以下代码添加到您的.htaccess文件中：</font></font><br><br><pre> <code class="hljs mel">AddType <span class="hljs-keyword"><span class="hljs-keyword">image</span></span>/webp .webp</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 在Nginx上，将以下代码添加到mime.types文件中： </font></font><br><br><pre> <code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">image</span></span>/webp webp;</code> </pre> <br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Vincent Orback提供了</font><font style="vertical-align: inherit;">WebP </font><font style="vertical-align: inherit;">的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">htaccess示例</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，Ilya Grigorik维护了一些</font><font style="vertical-align: inherit;">有用的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebP配置脚本</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></blockquote><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 使用&lt;picture&gt;标签 </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">浏览器本身可以使用&lt;picture&gt;标签选择图像格式。</font><font style="vertical-align: inherit;">在&lt;picture&gt;中，有许多&lt;source&gt;元素，每个实际包含图像的元素都有一个&lt;img&gt;标记。</font><font style="vertical-align: inherit;">浏览器扫描&lt;source&gt;并请求第一个合适的。</font><font style="vertical-align: inherit;">如果不支持&lt;picture&gt;标记，则使用&lt;img&gt;标记呈现&lt;div&gt;。</font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意&lt;source&gt;元素的顺序。</font><font style="vertical-align: inherit;">不要将图像/ webp源放置在过时的格式之后，而是将它们放在它们的前面。</font><font style="vertical-align: inherit;">如果图像的像素大小相同（不使用属性时），则还可以按文件大小的升序放置图像</font></font><code>media</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">通常，获得的顺序与首先指定较新格式的顺序相同。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 以下是一些HTML示例： </font></font><br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">picture</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">source</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">srcset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/path/to/image.webp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"image/webp"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/path/to/image.jpg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">alt</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">picture</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">picture</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">source</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">srcset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'paul_irish.jxr'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'image/vnd.ms-photo'</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">source</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">srcset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'paul_irish.jp2'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'image/jp2'</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">source</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">srcset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'paul_irish.webp'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'image/webp'</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'paul_irish.jpg'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">alt</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'paul'</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">picture</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">picture</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">source</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">srcset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"photo.jxr"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"image/vnd.ms-photo"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">source</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">srcset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"photo.jp2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"image/jp2"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">source</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">srcset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"photo.webp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"image/webp"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"photo.jpg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">alt</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"My beautiful face"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">picture</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 在CDN端自动转换为WebP </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一些CDN </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在可能的情况下</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持自动转换和WebP发行（应客户要求）</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">检查您的CDN以获取支持。</font><font style="vertical-align: inherit;">也许问题很容易解决。</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> WordPress支持 </font></font></h4><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jetpack</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：流行的WordPress插件，包括</font><font style="vertical-align: inherit;">具有WebP支持的</font><font style="vertical-align: inherit;">名为</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Photon</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的CDN图像服务</font><font style="vertical-align: inherit;">。它包含在免费版本的Jetpack中，非常实用且有用。缺点是Photon会自动调整图像大小，将查询字符串放置在URL中，并对每个图像执行附加的DNS查询。</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">缓存启动器和优化器</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：如果您使用的是WordPress，则至少有一个开源选项。在“ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">缓存启动器”</font></a><font style="vertical-align: inherit;">插件菜单中</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果用户的浏览器支持，则有一个用于缓存和发布WebP图像的标志。</font><font style="vertical-align: inherit;">这简化了使用WebP的工作。</font><font style="vertical-align: inherit;">还有一个缺点：Cache Enabler需要使用姐妹程序Optimizer，为此，他们需要收取年费。</font><font style="vertical-align: inherit;">这在开源解决方案中不是很常见。</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">短像素</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：Cache Enabler的另一个优化器选项，也已支付。</font><font style="vertical-align: inherit;">在功能方面，Short Pixel与上述优化器非常相似。</font><font style="vertical-align: inherit;">每月最多可免费优化100张照片。</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GIF压缩以及&lt;video&gt;为什么更好 </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尽管GIF动画的专业范围很窄，但它们仍被广泛使用。尽管从社交网络到流行媒体站点的所有内容都大量使用了GIF动画，但是这种格式</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从未</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">打算用于视频或动画。实际上，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GIF89a规范</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">明确指出“ GIF并非旨在用作动画平台。” </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">颜色的数量，帧的数量和纵横比</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -所有这些都会影响动画GIF的大小。替换视频格式可最大程度地节省费用。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/56b/bda/eb7/56bbdaeb754a883674dc575a36542d8e.jpg"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">比较GIF动画大小和等效质量</font></font></font></i> <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的视频以MP4格式制作相同的视频可使文件大小减少80％或更多。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">除了GIF文件浪费流量之外，它们还需要花费更长的时间加载，包含更少的颜色并且通常看起来不是很好。您可能已经注意到，Twitter动画GIF在那里比其他网站上更好。这是因为</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Twitter上的动画GIF并不是真正的GIF</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。为了提高质量并减少流量，Twitter自动将它们转换为视频。同样，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Imgur在加载时将GIF转换为MP4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为什么GIF大小要大很多倍？</font><font style="vertical-align: inherit;">因为它们将每一帧存储为无损GIF图像-是的，无损。</font><font style="vertical-align: inherit;">GIF品质不佳不是由压缩引起的，而是由256色调色板造成的。</font><font style="vertical-align: inherit;">与视频编解码器（例如H.264）不同，该格式不会分析相邻帧进行压缩。</font><font style="vertical-align: inherit;">MP4视频将每个关键帧存储为有损JPEG，从而丢弃一些原始数据以获得更好的压缩效果。</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 如果可以切换到视频 </font></font></h4><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ffmpeg</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将动画GIF（或源文件）转换为MP4（H.264）格式。</font><font style="vertical-align: inherit;">我从里格（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rigor）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">经营这样的一线客</font><font style="vertical-align: inherit;">：</font></font><br><br> <code>ffmpeg -i animated.gif -movflags faststart -pix_fmt yuv420p -vf "scale=trunc(iw/2)2:trunc(ih/2)2" video.mp4</code> </li> <li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ImageOptim API还支持将动画GIF转换为WebM / H.264，并删除了抗锯齿GIF，从而进一步提高了压缩率 </font></font></li></ul><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 如果您必须使用动画GIF </font></font></h4><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 像Gifsicle这样的工具可以删除元数据，未使用的调色板颜色，并最大程度地减少帧之间的变化。 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">考虑有损GIF编码。</font><font style="vertical-align: inherit;">Giflossy是Gifsicle的一个分叉，它支持该标志</font></font><code>-lossy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并将动画压缩60–65％。</font><font style="vertical-align: inherit;">在此基础上，制作了一个好的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gifify</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">工具</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">将非动画GIF转换为PNG或WebP格式。</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有关更多信息，请参见</font><font style="vertical-align: inherit;">Rigor </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的GIF书</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><br><a name="25"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SVG优化 </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最小化SVG文件意味着删除所有不必要的文件。</font><font style="vertical-align: inherit;">通常，编辑器中的SVG包含许多冗余信息（元数据，注释，隐藏层等）。</font><font style="vertical-align: inherit;">通常可以安全地删除它或将其最小化而不会影响视觉效果。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/cb6/e7e/747/cb6e7e747134071886e39623f818a8b1.jpg"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JVG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Archibald </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">SVGOMG</font></a><font style="vertical-align: inherit;">服务中，</font><font style="vertical-align: inherit;">您可以选择不同的优化方法并即时查看结果</font></font></font></i> <br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 一些通用的SVG优化规则（SVGO） </font></font></h4><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">压缩SVG文件并压缩为gzip，因为SVG只是XML文本资源，例如CSS，HTML和JavaScript。</font><font style="vertical-align: inherit;">为了提高生产率，应将它们最小化并压缩。</font></font></li><li>      SVG,   <code>&lt;rect&gt;</code> , <code>&lt;circle&gt;</code> , <code>&lt;ellipse&gt;</code> , <code>&lt;line&gt;</code>  <code>&lt;polygon&gt;</code> .              . </li><li>    ,   .      ,  .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">simplify</a>  Illustrator        ,  . </li><li>  .   ,   . </li><li>   . </li><li>   Photoshop  Illustrator.       . </li><li>      ,     SVG. </li><li>     SVG,   - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SVGOMG</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SVGO</a> .   Sketch,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> Sketch  SVGO</a>     . </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/d9f/f9c/4d9/d9ff9c4d9f37684e7997d4a4fc3fcfee.jpg"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SVGO在高精度（原始文件大小的-29％）和低精度（-38％）中的</font></font></font></i> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有效性</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是Node上的SVG优化工具。</font><font style="vertical-align: inherit;">它通过降低定义中数字的精度来减小文件大小。</font><font style="vertical-align: inherit;">点后的每个数字都是一个额外的字节，因此更改精度（数字数量）会极大地影响文件大小。</font><font style="vertical-align: inherit;">但是要非常小心，因为降低的精度会在视觉上影响图像形状。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/928/573/607/9285736076b2d09166f936d1595ffe81.jpg"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重要的是要注意：尽管SVGO在前面的示例中成功了，但并没有过度简化路径和形式，但是它发生的方式常常不同。</font><font style="vertical-align: inherit;">了解火箭的耀斑如何以降低的精度失真</font></font></font></i> <br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 从命令行SVGO： </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您更喜欢命令行，则</font><font style="vertical-align: inherit;">可以将SVGO </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装为CLI</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br><br> <code>npm i -g svgo</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SVG文件优化：</font></font><br><br> <code>svgo input.svg -o output.svg</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持所有可能的参数，包括浮点精度设置：</font></font><br><br> <code>svgo input.svg --precision=1 -o output.svg</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有关</font><font style="vertical-align: inherit;">支持的参数的完整列表，</font><font style="vertical-align: inherit;">请参阅</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自述文件</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 不要忘记压缩SVG！ </font></font></h4><br><img src="https://habrastorage.org/getpro/habr/post_images/ea1/243/9dc/ea12439dcd3c53d5e99931e019593306.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">另外，请确保</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">压缩SVG文件</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或使用Brotli协议发布它们。</font><font style="vertical-align: inherit;">文本格式将很好地压缩（约占源代码的50％）。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google发布新徽标时，我们宣布其</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最低</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">版本仅为305字节。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/817/219/f48/817219f4818aab93aa611df402f5db60.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">很多高级技巧</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以使文件更难压缩（最多146个字节）！</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SVG精灵 </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SVG </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非常</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">适合图标使用，可提供子画面可视化效果，而无需字体所需的躲避方法。与字体（SVG笔触属性）相比，它具有更好的CSS样式控制，更好的定位控制（无需打扰伪元素和</font></font><code>display</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），并且</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在浏览器中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更好地</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">支持</font></a><font style="vertical-align: inherit;"> SVG </font><font style="vertical-align: inherit;">。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">诸如</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">svg-sprite</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IcoMoon之</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类的工具</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">可</font></a><font style="vertical-align: inherit;">自动将</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">SVG</font></a><font style="vertical-align: inherit;">集成到可在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSS Sprite</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symbol Sprite</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stacked Sprite中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用的sprite中</font><font style="vertical-align: inherit;">。学习</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实用技巧</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来自Una Kravets的文章，介绍如何在工作流中使用gulp-svg-sprite。</font><font style="vertical-align: inherit;">Sarah Sudein在她的博客上描述了</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从图标字体到SVG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">过渡</font></a><font style="vertical-align: inherit;">。</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 附加材料 </font></font></h4><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sarah Sowaydan关于优化SVG发行的建议</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font><font style="vertical-align: inherit;">Chris </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">Coyier的SVG </font></a></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实用手册</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">都是极好的。</font><font style="vertical-align: inherit;">我发现Andreas Larsen撰写了关于SVG优化的非常有用的文章（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第1 </font></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">第2部分</font></a><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">我也可以推荐文章</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“在Sketch中准备和导出SVG图标”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><br><a name="26"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 避免挤压质量下降的图形 </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">始终建议从源头压缩图像。反复夹紧会带来不愉快的后果。假设您已使用质量60进行压缩的JPEG。如果以损失进行重新压缩，它将看起来更糟。每增加一轮压缩都会导致质量的额外损失-信息被删除，工件被累积。即使您捏捏高质量设置。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为避免此陷阱，请</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">立即设置最​​低可接受的质量</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并从一开始就获得最大的节省。这样一来，您就无需进行重新压缩，因为尽管有损文件压缩会减小文件的大小，但看起来会很糟糕。</font><i><font color="gray"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">精彩视频</font></a></font></i><i><font color="gray"><font style="vertical-align: inherit;">和</font></font></i><i><font color="gray"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">封面文章中</font></a></font></i></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/fa9/6dc/866/fa96dc866135f21f0a9bfe022ab8211f.jpg"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的示例</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">John Sneijers展示了多种形式夹紧的影响。如果您从社交网络保存（已压缩）图片并重新上传（带有重新压缩）图片，则会遇到此问题。质量损失正在增加</font></font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> MozJPEG（可能是偶然的）由于网格量化而更能抵抗这种退化。它不是按原样压缩所有DCT值，而是搜索+ 1 / -1范围内的接近值以较少的位数压缩它们。质量下降的FLIF使用类似于质量下降的PNG的破解方法，在此情况下，编解码器会分析数据并确定在（重新）压缩之前要抛出的内容。</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以无损格式存储源文件，例如PNG或TIFF，以保持最高质量</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">然后，组装工具或压缩器将准备压缩版本，您可以在质量损失最小的情况下将其分发给用户。</font></font><br><br><a name="27"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 减少不必要的解码和调整大小成本 </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们所有人都为用户提供了高分辨率的大图像。您必须为此付费。对于普通手机上的浏览器，解码和调整大小是资源密集型操作。如果渲染大图像，使用CSS或width / height属性缩放图像，您将看到这将如何影响性能。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/750/7de/e00/7507dee00658db123ac3a0519cbacd86.jpg"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当浏览器收到图像时，它必须将其从原始源格式（例如JPEG）解码为内存中的位图图像。通常，图像需要调整大小（例如，宽度设置为百分比）。图像解码和调整大小是资源密集型操作，会减慢渲染速度</font></font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">理想情况下，您应提供浏览器显示的图像而无需调整大小。因此，请使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><code>srcset/sizes</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-在不远的将来考虑</font><font style="vertical-align: inherit;">为相应的屏幕和分辨率提供最小尺寸的图片</font></font><code>srcset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">跳绳属性</font></font><code>width</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>height</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也表现产生不利影响。如果没有它们，浏览器将为图像分配最小的占位符区域，直到它收到足够的字节来确定正确的大小为止。此时，必须使用资源密集型重排操作来更新文档的标记。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ebb/33b/9ab/ebb33b9abfffafce7253dffa0c637175.jpg"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">浏览器需要采取几个步骤才能在屏幕上绘制图片。收到图像后，必须对其进行解码并经常调整其大小。这些事件可以在</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">时间轴</font></a><font style="vertical-align: inherit;">上跟踪</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chrome DevTools</font></font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">大图像也会占用内存：解码后每像素约4个字节。如果不太谨慎，可以直接挂起浏览器。在低预算的设备上，将情况进行互换并不难。因此，请跟踪解码，调整大小和内存消耗的成本。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/97b/2cb/a04/97b2cba04d8de16112c91508bfe387f1.jpg"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在中端和低端手机上，图像解码可能会占用大量资源。在某些情况下，它比台式机慢5倍或更多倍；</font></font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在开发新的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">移动版本时，</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Twitter通过设置正确的大小大大提高了图像解码的速度。对于许多图像，解码时间从〜400 ms减少到〜19 ms！</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/695/cfe/d7c/695cfed7c10f6fde08830c7783c874a5.jpg"><br> <i><font color="gray"> Timeline/Performance  Chrome DevTools      Twitter Lite    </font></i> <br><br><a name="28"></a><h2>   HiDPI   <code>srcset</code> </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户可以通过带有高分辨率屏幕的各种移动和台式设备访问该站点。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设备像素比率</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（DPR）（也称为“ CSS像素比率”）确定CSS应该如何解释屏幕分辨率。 DPR标准是由电话制造商创建的，目的是在不减少元素的情况下提高手机屏幕的分辨率和清晰度。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为了获得最高质量，您应该为图像提供最合适的分辨率。高清晰度图像（DPR为2×，3×）被提供给具有高分辨率屏幕的设备，而普通图像则被提供给标准屏幕，因为DPR 2×和3×的图像要重得多。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d00/ca2/7b1/d00ca27b1325ed096734db4e125cdf31.jpg"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设备像素比率：许多站点通过</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">material.io</font></a><font style="vertical-align: inherit;">跟踪流行设备的DPR</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mydevice.io</font></font></a></font></i> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> srcset</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许浏览器为每个设备选择最佳图像。</font><font style="vertical-align: inherit;">例如，为2×DPR的移动显示器拍摄2×图片。</font><font style="vertical-align: inherit;">不支持的浏览器</font></font><code>srcset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以采用</font></font><code>src</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标记中指定</font><font style="vertical-align: inherit;">的默认值</font></font><code>&lt;img&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">srcset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"paul-irish-320w.jpg, paul-irish-640w.jpg 2x, paul-irish-960w.jpg 3x"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"paul-irish-960w.jpg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">alt</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Paul Irish cameo"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">像</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cloudinary</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Imgix</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这样的图像CDN </font><font style="vertical-align: inherit;">支持DPR，以从单一来源提供最佳分辨率的图像。</font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意：您可以</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在此</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">免费的Udacity课程</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font><font style="vertical-align: inherit;">Web基础知识</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像指南中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">了解有关设备像素比率和响应图像的更多信息</font><font style="vertical-align: inherit;">。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我提醒您，“ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户端提示”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也是在响应标记中指定所有可能的DPR和格式的合适替代方法。</font><font style="vertical-align: inherit;">而是将相关信息添加到HTTP请求，以便Web服务器为特定屏幕选择最合适的选项。</font></font><br><br><a name="29"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 艺术改造 </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尽管选择正确的分辨率很重要，但某些网站仍在考虑美观。</font><font style="vertical-align: inherit;">如果用户的屏幕较小，则可以裁剪或放大-并以不同的方式显示对象，从而充分利用可用空间。</font><font style="vertical-align: inherit;">虽然</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">艺术转型</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（美术方向）超出了本文的范围，像一些服务</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cloudinary</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供API接口，以这样的任务自动化。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/812/9d1/081/8129d10818e6ffb6cae71fca47a071fb.jpg"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">埃里克·波蒂斯（Eric Portis）展示了一个</font><font style="vertical-align: inherit;">如何创造性地使用响应式图像</font><font style="vertical-align: inherit;">的好</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例子</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在此示例中，图示中主要对象的特征被修改以充分利用可用空间。</font></font></font></i> <br><br><a name="30"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 色彩管理 </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以从至少三个角度查看颜色：生物学，物理学和印刷。</font><font style="vertical-align: inherit;">在生物学中，颜色是一种</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">感知现象</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">物体反射各种波长组合的光。</font><font style="vertical-align: inherit;">眼睛中的受光器将这些波转化为一种色彩感。</font><font style="vertical-align: inherit;">在物理学中，波频率和能量（亮度）很重要。</font><font style="vertical-align: inherit;">印刷更多地涉及色域，颜色和美术模型。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">理想情况下，世界上所有屏幕和Web浏览器都应显示完全相同的颜色。</font><font style="vertical-align: inherit;">不幸的是，事实并非如此。</font><font style="vertical-align: inherit;">颜色管理在使用颜色模型，空间和配置文件显示颜色时提供了一种折衷方案。</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 颜色模型 </font></font></h3><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">颜色模型</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是用于创建较小原色集的全部光谱的系统。有多种类型的颜色空间，具有用于管理颜色的不同选项。在某些空间中，控制参数要比其他空间少-例如，对于所有灰色阴影，黑色和白色之间的一个亮度参数就足够了。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">颜色模型的两种常见类型是加性和减性。 RGB类型的加性颜色模型显示带有发光的颜色，而减色的CMYK类型的颜色显示带有反射（减法）的颜色。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/831/b9c/52c/831b9c52cc2059f46e5c63ba3c6d5624.jpg"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在RGB中，以各种组合添加红，绿和蓝光以产生各种颜色。 CMYK（青色，品红色，黄色和黑色），不同颜色的油墨的工作原理是带走了白皮书的频谱的一部分</font></font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文章</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“颜色模型和颜色系统的概念”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">很好地描述了其他颜色模型和模式，例如HSL，HSV和LAB。</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 色彩空间 </font></font></h1><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">颜色空间</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是可以为给定图像显示的特定颜色范围。例如，在图像中最多可显示1670万种颜色，并且各种颜色空间可让您缩小或扩展此范围。一些开发人员认为颜色模型和颜色空间是相同的。</font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sRGB是</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基于RGB设计的</font><font style="vertical-align: inherit;">，是Internet </font><font style="vertical-align: inherit;">的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标准</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。这是一个很小的色彩空间，通常被认为是最小公分母，并且是浏览器中色彩管理的最安全选项。其他色彩空间（例如</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adobe RGB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ProPhoto RGB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（在Photoshop和Lightroom中使用）包含更多种颜色，但是由于sRGB在浏览器，游戏和监视器中很常见，因此他们通常会使用它。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/6dd/0bf/4f0/6dd0bf4f0a627d651a95f94ba30a4d26.jpg"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">伽玛的可视化-颜色空间中的颜色范围在颜色空间</font></font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中，使用了三个通道（红色，绿色和蓝色），每个通道在8位模式下具有255种颜色，从而提供1670万种颜色。 16位图片可以显示数万亿种颜色。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/a55/90d/d1b/a5590dd1bf6c059ec89e984d0108f878.jpg"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的sRGB，Adobe RGB和ProPhoto RGB与图像中的比较</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尺度</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。如果您的屏幕仅显示sRGB颜色，则很难说明这个概念。比较具有sRGB和宽色域的常规照片时，除了最饱和的“丰富”色彩之外，其他所有内容都相同</font></font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">色彩空间的色域（可以用阴影重现的颜色范围），光谱和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">伽玛曲线</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来区分</font><font style="vertical-align: inherit;">。 sRGB大约比Adobe RGB小20％，ProPhoto RGB </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">大约</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">比Adobe RGB </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">宽50％</font></a><font style="vertical-align: inherit;">。上面的照片来自“ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">剪切路径”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">宽</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">色域是一个术语，表示色空间比sRGB宽。这些类型的显示器变得越来越普遍。但是，许多数字显示器仍然根本无法显示明显优于sRGB的颜色配置文件。在Photoshop中保存到Web时，除非要使用具有宽色域的显示器，否则请使用sRGB的转换选项。</font></font><br><br><blockquote> <b>:</b>        sRGB     .  ,           .        (, ProPhoto RGB),    sRGB     . </blockquote><br><h4>   ,       -? </h4><br> 是的<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果图像包含非常饱和/丰富/明亮的颜色-您想在兼容的屏幕上显示它。</font><font style="vertical-align: inherit;">但是，在真实照片中，这种情况很少发生。</font><font style="vertical-align: inherit;">通常，您可以轻松地调整设置，以使颜色看起来明亮而不会超出sRGB色域。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">原因是人类对颜色的感知不是绝对的。</font><font style="vertical-align: inherit;">感知相对于环境有效-而且很容易傻。</font><font style="vertical-align: inherit;">但是，如果图片显示了荧光标记的痕迹，那么当然可以在宽范围内显示它。</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 伽玛校正和压缩 </font></font></h3><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">伽玛校正</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（或仅伽玛）控制图像的整体亮度。更改伽玛值也可以更改红色与绿色的比率。没有伽玛校正的图像通常看起来褪色或暗淡。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在视频和计算机图形学中，伽玛用于压缩，类似于数据压缩。这使我们能够以更少的位（8，而不是12或16）压缩有用的亮度级别。人类对亮度的感知与光的物理量不成线性比例。当以人眼编码时，以其真实的物理形式表示花朵会很浪费。伽玛压缩用于以更接近人类感知的比例编码亮度。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用伽玛压缩时，有用的亮度标度适合8位精度（大多数RGB颜色为0-255），因为亮度单位是非线性编码的。想象一下，您在一支蜡烛的黑暗房间里。点亮第二个-并注意到亮度显着增加。添加第三支蜡烛，房间将变得更加明亮。现在想象一下自己在一个有一百支蜡烛的房间里。点燃101、102支蜡烛-您将不会发现任何变化。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在这两种情况下，物理上添加了相同数量的光。但是，由于眼睛对明亮的光线不太敏感，因此伽玛压缩会“压缩”明亮的值，因此，以物理单位编码的精度较低，但是可以针对人调整刻度尺本身-从人的角度来看，所有值都同样准确。</font></font><br><br><blockquote> <b>:</b> -      -  «»,  -     . </blockquote><br><h3>   </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">颜色配置文件是描述设备颜色空间的信息。它用于在不同的色彩空间之间进行转换。配置文件的任务是使所有类型的屏幕和媒体上的图像尽可能相似。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像可以具有符合</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">国际色彩联盟</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ICC）</font><font style="vertical-align: inherit;">标准的集成色彩配置文件，</font><font style="vertical-align: inherit;">以查明颜色。支持多种格式的配置文件，包括JPEG，PNG，SVG和WebP，并且大多数主流浏览器还支持内置的ICC配置文件。如果在程序中打开了图片，并且知道了监视器配置文件，则将相应地调整颜色。</font></font><br><br><blockquote> <b>:</b>      sRGB,           .         .     . </blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">内置的颜色配置文件还会显着增加图像的大小（有时会增加100 KB或更多），因此请当心。</font><font style="vertical-align: inherit;">诸如ImageOptim之类的工具会自动删除找到的所有颜色配置文件。</font><font style="vertical-align: inherit;">如果删除了ICC配置文件，浏览器将开始在显示器的色彩空间中显示图片，这可能导致饱和度和对比度发生变化。</font><font style="vertical-align: inherit;">因此，针对每个特定案例寻求妥协是有意义的。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该网站</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">九度以下</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的ICC色彩配置文件管理资源的优秀选择，如果你需要更多的信息。</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 颜色配置文件和浏览器 </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在以前的Chrome版本中，对颜色管理的支持不多，但在2017年通过引入</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">颜色校正渲染</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能纠正了这种情况</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果显示配置文件与sRGB（最新的MacBook Pro）不同，则它将颜色从sRGB转换为显示配置文件。</font><font style="vertical-align: inherit;">这意味着颜色将在不同的系统和浏览器中变得更加相似。</font><font style="vertical-align: inherit;">Safari，Edge和Firefox浏览器也考虑到了ICC配置文件，因此，无论您是否具有宽色域显示，具有不同配置文件的图像现在都可以正确显示。</font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sarah Drazner </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的Internet上的Color</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nerd </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">指南</font></a><font style="vertical-align: inherit;">是有关在网络上使用各种颜色</font><b><font style="vertical-align: inherit;">的</font></b><font style="vertical-align: inherit;">出色指南</font><font style="vertical-align: inherit;">。</font></font></blockquote><br><a name="31"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 精灵 </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像精灵</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（或CSS精灵）有着悠久的历史，他们是所有浏览器都支持，并已通过它们合并成一个较大的图像，这是切成片，以减少上传的图片数量的流行方式。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/dc1/d7c/68f/dc1d7c68f3fdeef1c56234d17122d7bc.jpg"><br> <font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像精灵仍然在包括Google主页在内的大型生产站点上得到广泛使用，</font></font></font> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据HTTP / 1.x标准，一些精灵用于减少HTTP请求的数量。这具有许多优点，但是由于存在使缓存无效的问题，因此需要准确性-对子画面的任何小部分进行更改都会使缓存中的整个图像无效。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在的Spriting与</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://hpbn.co/"><font style="vertical-align: inherit;">HTTP / 2</font></a><font style="vertical-align: inherit;">准则矛盾</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://hpbn.co/"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">由于可以在一个连接中发送许多请求，因此最好</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://deliciousbrains.com/performance-best-practices-"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">单独上传图片</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请为您的情况评分。</font></font><br><br><a name="32"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 延迟加载非关键图像 </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">延迟（延迟）加载是在将图像下载到浏览器时延迟到用户真正需要它时提高生产率的一种做法。</font><font style="vertical-align: inherit;">例如，滚动浏览页面时异步加载图片。</font><font style="vertical-align: inherit;">除了图像压缩外，这还可以节省流量。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d04/326/c74/d04326c7499058e1cff821d707cb53dd.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">屏幕上的图像会立即下载。</font><font style="vertical-align: inherit;">但是目前尚无其他信息。</font><font style="vertical-align: inherit;">不应该立即下载它们，而是稍后下载-这是延迟加载。</font><font style="vertical-align: inherit;">仅当用户向下滚动页面时才会发生。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">浏览器本身尚不支持延迟加载（尽管过去</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">已经讨论</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">过</font><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">而是使用JavaScript。</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 为什么延迟加载有用？ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 它具有许多优点： </font></font><br><br><ul><li> <b> </b> .     .   ,       . </li><li> <b>  </b> .     —   . </li><li> <b>  </b> .                . ,       ,       . </li></ul><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但是，与其他工具一样，巨大的责任伴随着强大的力量。</font></font></b> <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">避免延迟加载示波器中的图像。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将其用于较长的列表（例如产品或自定义头像）。请勿将其用于页面上的主图像。范围上的延迟加载会从技术上和人类的感知降低加载速度。它消除了预加载和渐进式加载，并且JavaScript为浏览器生成了额外的工作。</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">滚动时，请务必小心延迟加载图像。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果直接等待滚动事件，则用户可以看到占位符而不是图片，也可以在滚动到它们之前获取图片。</font><font style="vertical-align: inherit;">建议之一是在屏幕上显示前一个图像后立即立即开始延迟加载以下图像，而不考虑用户的交互作用。</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 谁使用延迟加载？ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">大多数具有大量图像的大型站点都使用延迟加载。例如，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Medium</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pinterest</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/fd8/c9d/134/fd8c9d134f3bf1b461cd66b8edddc29d.jpg"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">带有中等模糊插图插图的预览示例，</font></font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在某些站点（例如，中等）上，显示了一个小的模糊图片（约100字节）以供预览，在延迟下载后，该图片变成了正常质量的插图。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jose M. Perez讨论了如何使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSS过滤器</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实现Medium效果</font><font style="vertical-align: inherit;">。他尝试了</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不同的图形格式</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 Facebook还描述了其著名的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法，即</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用200字节的占位符作为标题照片。如果您使用Webpack，则</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LQIP加载程序</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将帮助使其中一些过程自动化。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要查看延迟加载，只需打开您喜欢的高质量照片目录，然后向下滚动页面即可。您几乎总是会看到该站点仅上传一些全分辨率图像，其余为占位符。滚动时，占位符将替换为全分辨率图像。这是延迟加载。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最近，一种</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">矢量</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而不是栅格占位符</font><font style="vertical-align: inherit;">的新技术获得了普及</font><font style="vertical-align: inherit;">。它由Tobias Baldauf在他的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQIP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">工具中提出</font><font style="vertical-align: inherit;">。在那里，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Primitive</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实用程序</font><font style="vertical-align: inherit;">从几种简单形式生成SVG预览，大致与图像的主要特征一致。然后使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SVGO-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并应用了高斯模糊滤镜。</font><font style="vertical-align: inherit;">结果是只有800-1000字节大小的SVG占位符，在任何屏幕上看起来都很清晰，并提供了真实图片的有意义的视图。</font><font style="vertical-align: inherit;">显然，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以将</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">低质量的延迟加载和预览图像</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">结合在一起</font></a><font style="vertical-align: inherit;">。</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 如何应用延迟加载？ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有许多方法和插件可用于延迟加载。</font><font style="vertical-align: inherit;">我建议使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lazysizes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Alexander Farkas，因为他的性能，功能，与</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intersection Observer的</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">附加集成</font><font style="vertical-align: inherit;">以及插件支持。</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Lazysizes可以做什么？ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lazysizes是一个JavaScript库；它不需要自定义。</font><font style="vertical-align: inherit;">只需下载缩小的js文件并将其包含在网页中即可。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下面是README文件中的示例代码：</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将“ lazyload”类与data-src和/或data-srcset属性一起添加到图像/帧。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此外，您可以添加具有低质量图像的src属性：</font></font><br><br><pre> <code class="html hljs xml"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- non-responsive: --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"image.jpg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"lazyload"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- responsive example with automatic sizes calculation: --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-sizes</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"auto"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"image2.jpg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-srcset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"image1.jpg 300w, image2.jpg 600w, image3.jpg 900w"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"lazyload"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- iframe example --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">frameborder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"lazyload"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">allowfullscreen</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"//www.youtube.com/embed/ZfV-aYdU4uE"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于本书的网络版本，我将Lazysizes与Cloudinary关联了（尽管您可以使用任何替代方法）。</font><font style="vertical-align: inherit;">这样一来，您就可以自由，轻松地尝试不同的音阶，质量，格式，并且是否需要逐步下载：</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/377/f20/d09/377f20d09d2e11b1037a62777ad25e3e.jpg"><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 特点Lazysizes： </font></font></h4><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 自动检测延迟加载的当前和将来元素的可见性变化 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 支持标准响应图像（图片和srcset） </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 自动计算媒体查询的大小和别名 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 在脚本丰富的页面和Web应用程序中可处理数百个CSS图像/框架 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 可扩展性：支持插件 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 简单但成熟的解决方案 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SEO改进：不会隐藏爬网程序的图像/资产 </font></font></li></ul><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 延迟加载的其他方法 </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lazysizes不是唯一的选择。</font><font style="vertical-align: inherit;">还有其他库：</font></font><br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">延迟加载XT</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BLazy.js</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（或[Be] Lazy）</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">揭幕</font></font></a> </li><li> <a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yall.js（还有另一个惰性加载器）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，大小约为1 KB，它会尽可能使用Intersection Observer。</font></font></li></ul><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 延迟加载的缺点是什么？ </font></font></h4><br><ul><li>    ,        JavaScript   ,    JavaScript.        &lt;noscript&gt;. </li><li>         .      (redraw),             .     — Intersection Observer,     lazysizes. </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">延迟加载是节省流量，降低成本和改善用户体验的常用方法。</font><font style="vertical-align: inherit;">评估它在您的情况下有多有用。</font><font style="vertical-align: inherit;">有关更多信息，请参见文章</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“图像的延迟加载”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“在介质中实现渐进式加载”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><br><a name="33"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 如何避免显示：无陷阱 </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置CSS属性时，较早的响应式图像解决方案错误地处理了图像请求</font></font><code>display</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这可能导致请求数量显着增加，这是为什么最好使用&lt;picture&gt;和&lt;img srcset&gt;的另一个原因。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您是否编写过某种媒体查询，在某些情况下会在其中隐藏图片</font></font><code>display:none</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">？</font></font><br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"img.jpg"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span><span class="css"><span class="css"> @</span><span class="hljs-keyword"><span class="css"><span class="hljs-keyword">media</span></span></span><span class="css"> (max-width: </span><span class="hljs-number"><span class="css"><span class="hljs-number">640px</span></span></span><span class="css">) { </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">img</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">display</span></span></span><span class="css">: none; } } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还是隐藏带有类的图像</font></font><code>display:none</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">？</font></font><br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span><span class="css"><span class="css"> </span><span class="hljs-selector-class"><span class="css"><span class="hljs-selector-class">.hidden</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">display</span></span></span><span class="css">: none; } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"img.jpg"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">“img-hidden.jpg</span></span></span><span class="hljs-tag">" </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在Chrome DevTools网络面板中进行的快速检查显示，此类“隐藏”图像仍在加载中。</font><font style="vertical-align: inherit;">根据嵌入式资源的规范，这实际上是浏览器的正确行为。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/a67/471/222/a67471222582a069b511993bab0c0b51.jpg"><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 是否显示：none有助于避免src请求？ </font></font></h4><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"display:none"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"img.jpg"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br> 不行<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仍将请求指定的图像。</font><font style="vertical-align: inherit;">这里的库不能依赖于display：none，因为请求是在JavaScript更改src之前发送的。</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 是否显示：none有助于避免背景：url（）查询？ </font></font></h4><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"display:none"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"background: url(img.jpg)"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">肯定的答案。</font><font style="vertical-align: inherit;">解析元素时不会提取CSS背景。</font><font style="vertical-align: inherit;">为儿童计算CSS样式的</font></font><code>display:none</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用处不大，因为它们不会影响文档的呈现。</font><font style="vertical-align: inherit;">未计算或加载儿童的背景图像。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">杰克阿奇博尔德（Jake Archibald）有出色的</font><font style="vertical-align: inherit;">陷阱</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">测验任务</font></font></a><font style="vertical-align: inherit;"></font><code>display:none</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果对特定浏览器如何处理图像请求有疑问，请打开DevTools并亲自查看。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同样，尽可能使用&lt;picture&gt;和&lt;img srcset&gt;而不是依赖&lt;display：none&gt;。</font></font><br><br><a name="34"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 使用CDN进行图像处理有意义吗？ </font></font></h1><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">阅读文章以建立图像处理管道，然后对其进行优化所花费的时间通常比为此服务付费要昂贵得多。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cloudinary</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供免费服务，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Imgix</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供免费试用</font><font style="vertical-align: inherit;">，</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">Thumbor</font></a><font style="vertical-align: inherit;">有免费替代</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">品</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，因此有很多选择。</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为了最快地加载页面，您需要优化图像加载，包括通过服务器端压缩输出响应图像，自动选择最佳格式和调整大小。</font><font style="vertical-align: inherit;">以正确的分辨率-尽快将正确大小的图像发送到正确的设备很重要。</font><font style="vertical-align: inherit;">这并不像看起来那样容易。</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 您的服务器还是CDN？ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像处理是一个特定的主题。</font><font style="vertical-align: inherit;">这里的一切都在不断变化，所以让我们从经验丰富的专家的报价开始，然后继续。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“如果您的产品本身与图像处理无关，那么请不要自己做。</font><font style="vertical-align: inherit;">诸如Cloudinary [或Imgix的服务。</font><font style="vertical-align: inherit;">ed。]将更好，更有效地应对。</font><font style="vertical-align: inherit;">并且，如果您担心价格，请考虑开发和维护以及托管，存储和交付将花费</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">多少</font></font></a> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">考虑两个这样的服务-它们如何与提到的任务列表相对应。</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cloudinary和Imgix </font></font></h4><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cloudinary</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Imgix</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是众所周知的图像处理CDN。它们被Netflix和Red Bull等全球数十万开发商和公司所使用。</font></font><br><br><h4> 主要的 </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CDN相对于他们自己的解决方案的第一个巨大优势是，他们使用分布式全球网络系统来使您的图像更贴近用户。使用CDN，您可以更轻松地保证服务与未来技术变更的相关性，因为并非每个人都能够独立监视趋势，进行变更-这需要维护，跟踪浏览器对新格式的支持以及沉浸在图像压缩所涉及的社区的生活中。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第二：每个服务都有一个多层次的收费计划：Cloudinary有</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">免费收费</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，Imgix有便宜的启动计划。 Imgix提供免费</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">试用</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，几乎与免费关税相同。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第三：两个服务都有一个API。</font><font style="vertical-align: inherit;">开发人员可以以编程方式连接到CDN并自动执行该过程。</font><font style="vertical-align: inherit;">客户端库，用于框架的插件和API文档可用，尽管某些选项仅以昂贵的价格提供。</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 让我们继续进行图像处理。 </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将讨论限制在静态图像上。</font><font style="vertical-align: inherit;">Cloudinary和Imgix提供了广泛的图像处理技术。</font><font style="vertical-align: inherit;">在标准关税和免费关税中，两者都支持基本功能：压缩，调整大小，裁剪，生成小副本。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/e27/b9f/e79/e27b9fe792a444abd15ed71fa10387ae.jpg"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cloudinary媒体库：默认情况下，Cloudinary生成</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">常规而不是渐进式JPEG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要激活此选项，请将相应的图标放在“高级选项”中，或使用标志fl_progressive</font></font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cloudinary命名</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">七个广泛的转换类别</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，共48个子类别。</font><font style="vertical-align: inherit;">Imgix具有</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100多个图像处理操作</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 默认情况下会发生什么？ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cloudinary默认情况下执行以下优化： </font></font><br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用MozJPEG的JPEG编码</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（默认选择而不是Guetzli）。</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">清除元数据（原始图像保持不变）。</font><font style="vertical-align: inherit;">要更改此行为并使用元数据渲染图像，请添加keep_iptc标志。</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">能够自动生成WebP，GIF，JPEG和JPEG-XR。</font><font style="vertical-align: inherit;">要更改默认设置，请手动设置质量参数。</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 优化文件大小，在生成PNG，JPEG或GIF时对质量的影响最小。 </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Imgix默认情况下不启动诸如Cloudinary之类的优化，但允许您设置默认质量。</font><font style="vertical-align: inherit;">在Imgix中，自动设置可帮助自动化图像目录中的基本优化级别。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当前使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">四种方法</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 压缩方式 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 视觉改善 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 文件格式转换 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 消除红眼 </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Imgix支持以下图像格式：JPEG，JPEG2000，PNG，GIF，动画GIF，TIFF，BMP，ICNS，ICO，PDF，PCT，PSD，AI。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cloudinary支持以下格式：JPEG，JPEG 2000，JPEG XR，PNG，GIF，动画GIF，WebP，动画WebP，BMP，TIFF，ICO，PDF，EPS，PSD，SVG，AI，DjVu，FLIF，TARGA。</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 性能如何？ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CDN性能主要取决于</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">延迟</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和速度。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于完全未缓存的图像，延迟始终会更长一些。</font><font style="vertical-align: inherit;">但是，一旦图片到达缓存并通过网络上的服务器分散，全局CDN就会找到最接近用户的路由。</font><font style="vertical-align: inherit;">与节省文件大小一起，与未优化的映像或试图为整个地球服务的单个服务器相比，这几乎总能消除延迟问题。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">两种CDN都具有广泛的覆盖范围和快速的服务器，从而减少了延迟并提高了下载速度。</font><font style="vertical-align: inherit;">速度影响页面加载时间，这是用户和转化的最重要指标之一。</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 哪个更好？ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cloudinary拥有约</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">160,000个客户</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，其中包括Netflix，eBay和Dropbox。 Imgix不报告用户数量，但是少于Cloudinary。但是，Imgix基础包括Kickstarter，Exposure，unsplash和Eventbrite等重量级人物。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在图像处理中，无法客观地评估如此众多的参数，这使得很难比较这两种服务的性能。很大程度上取决于您要如何处理图像（这将花费不同的时间），最终所需的大小和分辨率。最后，对您来说最重要的因素可能是成本。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CDN花费金钱。</font><font style="vertical-align: inherit;">一个拥有大量流量的繁重站点可以每月在CDN上支付数百美元。</font><font style="vertical-align: inherit;">为了充分利用这些服务，需要一定水平的知识和编程技能。</font><font style="vertical-align: inherit;">但是，如果您不做任何异常的事情，那么就不会有任何特殊的问题。</font></font><br><br><h4> 结论 </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 如果您当前正在从自己的服务器上传图像或计划上传图像，则可能需要考虑CDN。 </font></font><br><br><a name="35"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 图像缓存 </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">资源可以通过</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTP缓存头</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置缓存规则</font><font style="vertical-align: inherit;">。特别是，它</font></font><code>Cache-Control</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">确定谁应将响应缓存多长时间。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">大多数图像是静态资源，将来</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不会更改</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。对于他们来说，最好的策略是主动缓存。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在配置HTTP缓存标头时，请将Cache-Control设置为</font></font><code>max-age</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一年（例如</font></font><code>Cache-Control:public; max-age=31536000</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。这种激进式缓存对大多数图像都适用，特别是对于长寿命的图像，例如头像和页面标题中的图像。</font></font><br><br><blockquote> <b>:</b>       PHP,    -   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">session_cache_limiter</a> .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a>   <code>session_cache_limiter('public')</code> ,  <code>public</code>  <code>max-age=</code> .  ,        . </blockquote><br><a name="36"></a><h1>     </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关键资源可以使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;link rel = preload&gt;</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">进行预</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">加载</font></a><font style="vertical-align: inherit;">。</font></font><br><br> <code>&lt;link rel=preload&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-这是一个声明性下载，它强制浏览器发送对资源的请求，而不会阻止</font></font><code>onload</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文档</font><font style="vertical-align: inherit;">事件</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这增加了对资源请求的优先级，否则这些资源只有在解析期间稍后才能检测到。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要预加载图像，该值</font></font><code>as</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示为</font></font><code>image</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br><br><pre> <code class="hljs swift">&lt;link rel=<span class="hljs-string"><span class="hljs-string">"preload"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>=<span class="hljs-string"><span class="hljs-string">"image"</span></span> href=<span class="hljs-string"><span class="hljs-string">"logo.jpg"</span></span>/&gt;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过这种方式，优化资源利用率</font></font><code>&lt;img&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>&lt;picture&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>srcset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和SVG。</font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：</font></font></b> <code>&lt;link rel=preload&gt;</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在Chrome和浏览器引擎闪烁，如Opera和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Safari的技术预览</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，以及</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实现</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在Firefox。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">网站如</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">飞利浦</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Flipkart</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">施乐</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，使用</font></font><code>&lt;link rel=preload&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">预加载的标识（通常在文档的开头使用）。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">皮划艇</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还应用预加载，以便标题中的主图片尽快加载。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/492/932/3d3/4929323d36c4089f7c5ab7d94ced76c0.jpg"><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 链接预加载头是什么？ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">链接预加载是通过HTML标记或</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTP链接头标头设置的</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">无论如何，该链接告诉浏览器开始将资源加载到内存缓存中，因为页面很有可能正在等待该资源，并且您不能等待预加载扫描器或解析器检测到它。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图片的标题如下所示：</font></font><br><br><pre> <code class="hljs objectivec">Link: &lt;https:<span class="hljs-comment"><span class="hljs-comment">//example.com/logo-hires.jpg&gt;; rel=preload; as=image</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当《金融时报》在其网站上引入这样的标题时，用户开始</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更快</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">地打开内容</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">1秒钟</font></a><font style="vertical-align: inherit;">：</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/5e6/1f8/9ad/5e61f89ad2148c7ed6ab04d1a226c986.jpg"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">底部：使用&lt;link rel = preload&gt;，顶部：不使用。</font><font style="vertical-align: inherit;">在WebPageTest测试比较，以摩托G4在3G频道</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">之前</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">之后</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的优化</font></font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同样，维基百科的加速加载“标志上”，在他们的描述</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">研究</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 此优化有哪些陷阱？ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您需要确保绝对有必要预加载此特定资源，因为它会将其余内容移到队列的末尾。</font><font style="vertical-align: inherit;">也许您应该专注于其他内容？</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重要的是要避免</font></font><code>rel=preload</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在浏览器（例如WebP）中没有广泛支持的情况下预加载图像，并避免使用srcset中定义的响应图像，其中图像的来源取决于设备的类型。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有关更多信息，请参阅文章</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ Chrome中的预加载和优先级”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“预加载：为什么对什么有好处？”</font></font></a> <br><br><a name="37"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 图像的Web性能预算 </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">性能预算是开发人员尝试不超过的最大限制。例如，“一页上的图像不超过200 KB”或“用户界面的加载速度应超过3秒”。当预算未实现时-了解为什么会发生这种情况以及如何解决这种情况。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">预算有助于讨论工作结果。当设计或业务决策影响生产率时，请检查预算。如果更改不适合预算，则这是推迟或修改预算的基础。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我发现，如果将监视自动化，则性能预算最有效。无需研究网络计划，而是手动启动服务，该服务会自动发出已超出预算的信号。两项有用的服务是</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">口径</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SpeedCurve</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一旦确定了图像大小的预算，SpeedCurve就会开始监视并发出有关超出的警报：</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/7b7/ecb/206/7b7ecb2062b83d9a3af42d0c8f1a2b4d.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Calibre为每种设备提供预算设置。</font><font style="vertical-align: inherit;">这很有用，因为通过WiFi台式PC的图片大小预算可能与手机预算大不相同。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ac9/a20/dfd/ac9a20dfdeb3a76f937b298c83994feb.jpg"><br><br><a name="38"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 最终建议 </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最终，图像优化策略的选择取决于您提供给用户的图像类型以及一组合理的选择评估标准。</font><font style="vertical-align: inherit;">它可以是SSIM或Butteraugli，在少量插图中，您可以相信自己的眼睛：什么看起来更好和什么不好。</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 这是我的最终建议： </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">无法</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供不同格式的图像，则取决于浏览器的支持：</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> MozJPEG的Guetzli + jpegtran已针对90以上的JPEG进行了优化。 </font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于网络而言，质量</font></font><code>q=90</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">太浪费了。</font><font style="vertical-align: inherit;">普通图片就足够了</font></font><code>q=80</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，DPR甚至是2× </font></font><code>q=50</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">由于Guetzli的级别不高，因此可以将MozJPEG用于Web。</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cornel Lesinsky最近通过添加一个小的sRGB配置文件来帮助Chrome在宽色域显示器上显示自然色彩，从而改进了mozjpeg上的cjpeg团队。 </font></font></li></ul></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> PNG pngquant + advpng提供了相当不错的速度/压缩比。 </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用&lt;picture&gt;，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Accept</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Picturefill标头</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，根据浏览器支持以不同的格式渲染图像</font><font style="vertical-align: inherit;">：</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 将WebP提供给支持WebP的浏览器 </font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从100％质量的原始图像创建WebP。</font><font style="vertical-align: inherit;">否则，您将向您的浏览器发送JPEG </font><font style="vertical-align: inherit;">失真</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> WebP失真</font><font style="vertical-align: inherit;">的较低质量和较大体积的图片</font><font style="vertical-align: inherit;">！</font><font style="vertical-align: inherit;">如果使用WebP编解码器压缩源图像，则失真将不太明显，并且压缩级别较高。</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认的WebP设置</font></font><code>-m 4 -q 75</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在大多数情况下是最佳的速度和压缩率之比。</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebP具有特殊的无损压缩模式（</font></font><code>-m 6 -q 100</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），可通过检查所有参数组合来减少文件。</font><font style="vertical-align: inherit;">这慢了一个数量级，但对于静态资源来说值得。</font></font></li></ul></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 对于不支持WebP的浏览器，回退是Guetzli / MozJPEG。 </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 压缩好！ </font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有关更多实用的图像优化技巧，我强烈建议</font><font style="vertical-align: inherit;">Jeremy Wagner的</font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Web Performance in Action</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">《</font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高效能图像》</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这本书</font><font style="vertical-align: inherit;">也有很多很棒的技巧和细微差别。</font></font></blockquote><br><a name="39"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 小事 </font></font></h1><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">JPEG XT</a>    JPEG 1992 .           1992 ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">libjpeg-turbo</a>      (  ). </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PIK</a> —    ,    .    JPEG,         Guetzli.    33%  JPEG,      54%   ,  libjpeg.    Guetzli  . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a>     ,  PIK   .  ,      ,      (    2017 ). </li><li>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ImageMagick</a> .   ,         ,     .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">libvips</a> ,            .  ImageMagick   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a>   ,    . </li><li> Blink (   Chrome)     .             .     .               ,          . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">img.decode()</a> API    . </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN422531/">https://habr.com/ru/post/zh-CN422531/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN422519/index.html">免费赠品发行：Java中的非编织线程。 项目织机</a></li>
<li><a href="../zh-CN422521/index.html">不可避免的预感</a></li>
<li><a href="../zh-CN422525/index.html">“友谊的矩阵。” 年龄最小的社交图谱最早</a></li>
<li><a href="../zh-CN422527/index.html">PostgreSQL新闻摘要。 第10期</a></li>
<li><a href="../zh-CN422529/index.html">IB组特别课程：“移动应用程序安全性”</a></li>
<li><a href="../zh-CN422535/index.html">见无形。 远红外极化（8-12μm）</a></li>
<li><a href="../zh-CN422537/index.html">BEM不应该存在</a></li>
<li><a href="../zh-CN422539/index.html">关于数字经济，火灾和互联网</a></li>
<li><a href="../zh-CN422541/index.html">联盟漏洞的戏剧化成了幻影</a></li>
<li><a href="../zh-CN422543/index.html">像程序员一样思考。 任务课</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>