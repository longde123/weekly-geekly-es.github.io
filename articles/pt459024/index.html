<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöµ ü§õüèæ üë®üèΩ‚Äçüíª Como perfuramos o grande firewall chin√™s (parte 3) üíï üßïüèø üìá</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Oi 
 Todas as boas hist√≥rias terminam. E nossa hist√≥ria sobre como criamos uma solu√ß√£o para a r√°pida passagem do firewall chin√™s n√£o √© exce√ß√£o. Portan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como perfuramos o grande firewall chin√™s (parte 3)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/semrush/blog/459024/"><p>  Oi <br>  Todas as boas hist√≥rias terminam.  E nossa hist√≥ria sobre como criamos uma solu√ß√£o para a r√°pida passagem do firewall chin√™s n√£o √© exce√ß√£o.  Portanto, apresso-me em compartilhar com voc√™ a √∫ltima <strong>parte final</strong> sobre esse t√≥pico. </p><br><p>  Na parte anterior, falamos sobre muitos bancos de teste inventados por n√≥s e quais resultados eles deram.  E decidimos que seria bom adicionar uma <strong>CDN!</strong>  <s>viscosidade</s> em nosso circuito. </p><br><p>  Vou lhe contar como testamos o Alibaba Cloud CDN, Tencent Cloud CDN e Akamai e o que acabei fazendo.  E, claro, para resumir. </p><br><img src="https://habrastorage.org/webt/8n/xq/ur/8nxqurgug_z7ij3eqorfl5hdm0y.png"><a name="habracut"></a><br><h2 id="alibaba-cloud-cdn">  Alibaba Cloud CDN </h2><br><p>  Estamos hospedados no Alibaba Cloud, usamos o IPSEC e o CEN a partir deles.  Seria l√≥gico tentar suas solu√ß√µes primeiro. </p><br><p>  O Alibaba Cloud possui dois tipos de produtos que podem nos atender: <strong>CDN</strong> e <strong>DCDN</strong> .  A primeira op√ß√£o √© uma CDN cl√°ssica para um dom√≠nio espec√≠fico (subdom√≠nio).  A segunda op√ß√£o significa <em>Rota din√¢mica para CDN</em> (eu chamo de CDN din√¢mico), pode ser ativada no modo de site completo (para dom√≠nios curinga), tamb√©m armazena em cache a est√°tica e acelera o conte√∫do din√¢mico, ou seja, a din√¢mica da p√°gina tamb√©m carrega rapidamente provedor de rede.  Isso √© importante para n√≥s, porque basicamente nosso site √© din√¢mico, usa muitos subdom√≠nios e √© mais conveniente configurar a CDN uma vez para a "estrela" - * .semrushchina.cn. </p><br><p>  J√° vimos esse produto nos est√°gios iniciais do nosso projeto chin√™s, mas ele ainda n√£o funcionava, e os desenvolvedores prometeram que o produto estaria dispon√≠vel para todos os clientes em breve.  E ele se tornou. </p><br><p>  No DCDN, voc√™ pode: </p><br><ul><li>  configure a termina√ß√£o SSL com seu certificado, </li><li>  habilitar a acelera√ß√£o din√¢mica de conte√∫do, </li><li>  configurar de forma flex√≠vel o cache de arquivos est√°ticos, </li><li>  limpe o cache, </li><li>  jogue soquetes da web, </li><li>  habilite a compacta√ß√£o e at√© o embelezador de HTML. </li></ul><br><p>  Em geral, tudo √© como adultos e grandes fornecedores de CDN. </p><br><p>  Depois que o Origin (o local para onde os servidores de borda da CDN ir√£o) for indicado, resta criar um CNAME para o asterisco, <em>vinculando</em> a <em>all.semrushchina.cn.w.kunluncan.com</em> (esse CNAME foi obtido no console do Alibaba Cloud) e CDN vai funcionar. </p><br><p>  De acordo com os resultados do teste, este CDN nos ajudou muito.  As estat√≠sticas s√£o fornecidas abaixo. </p><br><div class="scrollable-table"><table><thead><tr><th>  Solu√ß√£o </th><th>  Upime </th><th>  Mediana </th><th>  Percentil 75 </th><th>  Percentil 95 </th></tr></thead><tbody><tr><td>  Cloudflare </td><td>  86,6 </td><td>  18 anos </td><td>  30s </td><td>  Anos 60 </td></tr><tr><td>  IPsec </td><td>  99,79 </td><td>  18 anos </td><td>  21s </td><td>  30s </td></tr><tr><td>  Cen </td><td>  99,75 </td><td>  16s </td><td>  21s </td><td>  27s </td></tr><tr><td>  CEN / IPsec + GLB </td><td>  99,79 </td><td>  13s </td><td>  16s </td><td>  25s </td></tr><tr><td>  <strong>Ali CDN + CEN / IPsec + GLB</strong> </td><td>  <strong>99,75</strong> </td><td>  <strong>10s</strong> </td><td>  <strong>12.8s</strong> </td><td>  <strong>17.3s</strong> </td></tr></tbody></table></div><br><p>  Estes s√£o resultados muito bons, especialmente se os compararmos com os n√∫meros que estavam no in√≠cio.  Mas sab√≠amos que o teste do navegador da vers√£o americana do nosso site www.semrush.com estava funcionando nos EUA em m√©dia por 8,3s (um valor muito aproximado).  H√° muito pelo que lutar.  Al√©m disso, havia provedores de CDN interessados ‚Äã‚Äãem testar. </p><br><p>  Por isso, mudamos sem problemas para outro gigante no mercado chin√™s - a <strong>Tencent</strong> . </p><br><h2 id="tencent-cloud">  Nuvem Tencent </h2><br><p> A Tencent est√° apenas desenvolvendo sua nuvem - isso √© evidente em um pequeno n√∫mero de produtos.  No decorrer de seu uso, quer√≠amos testar n√£o apenas a CDN, mas tamb√©m a infraestrutura de rede como um todo: </p><br><ul><li>  Eles t√™m algo parecido com o CEN? </li><li>  Como o IPSEC funciona para eles?  √â r√°pido, o que √© tempo de atividade? </li><li>  Eles t√™m anycast? </li></ul><br><img src="https://habrastorage.org/webt/jf/ci/aa/jfciaauffli76osi1qyzel6vepq.jpeg"><br><p>  Analisaremos essas perguntas separadamente. </p><br><h4 id="analog-cen">  CEN anal√≥gico </h4><br><p>  A Tencent possui um produto <strong>Cloud Connect Network</strong> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CCN</a> ) que permite interconectar VPCs de diferentes regi√µes, incluindo regi√µes dentro e fora da China.  Agora, o produto est√° na vers√£o beta interna e voc√™ precisa criar um ticket com uma solicita√ß√£o para se conectar a ele.  Com o suporte, aprendemos que as contas globais (n√£o sobre cidad√£os e entidades legais chinesas) n√£o podem participar do programa de testes beta e geralmente conectam a regi√£o dentro da China √† regi√£o externa.  1-0 a favor do Ali Cloud </p><br><h4 id="ipsec">  IPSEC </h4><br><p>  A regi√£o mais ao sul de Tencent √© <em>Guangzhou</em> .  Constru√≠mos um t√∫nel e o conectamos √† regi√£o de Hong Kong no GCP (ent√£o essa regi√£o j√° estava dispon√≠vel).  Eles tamb√©m levantaram o segundo t√∫nel para Ali Cloud de Shenzhen para Hong Kong ao mesmo tempo.  Verificou-se que, atrav√©s da rede de lat√™ncia Tencent, Hong Kong √© geralmente melhor (10 ms) do que de Shenzhen a Hong Kong e Ali (120 ms - o que?).  Mas isso n√£o acelerou o trabalho do site destinado a trabalhar com a Tencent e esse t√∫nel, que por si s√≥ era um fato surpreendente e mais uma vez provou o seguinte: lat√™ncia - para a China, este n√£o √© um indicador ao qual voc√™ realmente deve prestar aten√ß√£o ao desenvolver uma solu√ß√£o para passar pelos chineses firewall. </p><br><h4 id="anycast-internet-acceleration">  Anycast Internet Acceleration </h4><br><p>  Outro produto que permite trabalhar com o IP anycast √© o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">AIA</a> .  Mas tamb√©m √© inacess√≠vel para contas globais, por isso n√£o falarei sobre isso, mas saber que esse produto existe pode ser √∫til. </p><br><p>  Mas o teste CDN mostrou resultados bastante interessantes.  A CDN da Tencent n√£o pode ser ativada em um site completo, apenas em dom√≠nios espec√≠ficos.  Temos dom√≠nios e come√ßamos a trafegar neles: </p><br><img src="https://habrastorage.org/webt/4f/hv/ca/4fhvcabi1rmeqmircvjjlv1dhpa.png"><br><p>  Verificou-se que este CDN tem a seguinte fun√ß√£o: <strong>Otimiza√ß√£o do tr√°fego entre fronteiras</strong> .  Esse recurso deve reduzir os custos quando o tr√°fego flui atrav√©s do firewall chin√™s.  Como <em>origem</em> , o endere√ßo IP do Google GLB (GLB anycast) foi especificado.  Ent√£o, quer√≠amos simplificar a arquitetura do projeto. </p><br><p>  Os resultados foram muito bons - no n√≠vel da Ali Cloud CDN e, em alguns lugares, ainda melhores.  Isso √© surpreendente, porque, se os testes forem bem-sucedidos, voc√™ poder√° abandonar uma parte significativa da infraestrutura, t√∫neis, CEN, m√°quinas virtuais etc. </p><br><p>  N√£o ficamos felizes por muito tempo, porque o problema foi revelado: os testes no Catchpoint falsificaram para o provedor de Internet China Mobile.  Em qualquer local, tivemos um tempo limite pela CDN da Tencent.  A correspond√™ncia com o suporte t√©cnico n√£o levou a nada.  Cerca de um dia, tentamos resolver esse problema, mas nada aconteceu. </p><br><p>  Eu estava na China naquele momento, mas n√£o consegui encontrar o Wi-Fi p√∫blico na rede desse provedor para verificar o problema pessoalmente.  Caso contr√°rio, tudo parecia r√°pido e bom. <br>  No entanto, devido ao fato de a China Mobile ser uma das tr√™s maiores operadoras, fomos for√ßados a devolver o tr√°fego √† Ali CDN. <br>  Mas, em geral, essa foi uma solu√ß√£o bastante interessante, que merece mais testes e solu√ß√£o de problemas desse problema. </p><br><h2 id="akamai">  Akamai </h2><br><p>  O √∫ltimo provedor de CDN que testamos √© o <strong>Akamai</strong> .  Este √© um grande fornecedor que possui sua pr√≥pria rede na China.  Claro, n√£o pod√≠amos passar por ele. </p><br><img src="https://habrastorage.org/webt/vj/pd/am/vjpdamb4wn9kdn_1vlvepokaeb4.png"><br><p>  Desde o in√≠cio, concordamos com a Akamai em um per√≠odo de teste para que possamos mudar o dom√≠nio e ver como ele funcionar√° na rede deles.  Descreverei o resultado de todos os testes na forma de "O que eu gostei" e "O que eu n√£o gostei", bem como os resultados do teste. </p><br><p>  <strong>Do que voc√™ gostou:</strong> </p><br><ul><li>  Os caras da Akamai ajudaram muito em todos os assuntos e nos acompanharam em todas as etapas dos testes.  Constantemente tentando melhorar algo do seu lado.  Eles deram bons conselhos t√©cnicos. </li><li>  A Akamai roda cerca de 10 a 15% mais lenta que a nossa solu√ß√£o atrav√©s do Ali Cloud CDN.  √â impressionante que no Origin tenha especificado o endere√ßo IP GLB da Akamai, ou seja, o tr√°fego n√£o passou pela nossa solu√ß√£o (voc√™ pode potencialmente abandonar parte da infraestrutura).  Ainda assim, os resultados dos testes mostraram que esta solu√ß√£o √© pior que a nossa vers√£o atual (resultados comparativos abaixo). </li><li>  Testou o Origin GLB e o Origin na China.  Ambas as op√ß√µes s√£o iguais. </li><li>  H√° uma <em>rota segura</em> (otimiza√ß√£o autom√°tica de roteamento).  Voc√™ pode hospedar o objeto de teste no Origin, e o servidor Akamai Edge tentar√° busc√°-lo (GET normal).  Para essas solicita√ß√µes, a velocidade e outras m√©tricas s√£o medidas, com base nas quais a rede Akamai otimiza as rotas para que o tr√°fego acelere em nosso site e pode-se observar que a inclus√£o desse recurso realmente teve um grande efeito na velocidade do site. </li><li>  A vers√£o da configura√ß√£o na interface da web √© legal.  Voc√™ pode comparar para vers√µes, consulte diff.  Ver vers√µes anteriores. </li><li>  Voc√™ pode lan√ßar a nova vers√£o primeiro apenas na rede Akamai Staging - a mesma rede que a produ√ß√£o, mas dessa maneira n√£o afeta usu√°rios reais.  Para este teste, voc√™ precisa falsificar registros DNS na m√°quina local. </li><li>  Velocidade de download muito r√°pida atrav√©s de sua rede de grandes est√°ticas e, aparentemente, de quaisquer outros arquivos.  Um arquivo do cache "frio" √© obtido v√°rias vezes mais r√°pido que o mesmo arquivo do cache Ali CDN "frio".  No cache "quente", a velocidade j√° √© mais ou menos a mesma. </li></ul><br><p>  <strong>Ali teste CDN:</strong> </p><br><pre><code class="bash hljs">root@shenzhen1:~<span class="hljs-comment"><span class="hljs-comment"># curl -o /dev/null -w@curl_time https://en.semrushchina.cn/my_reports/build/scripts/simpleInit.js?v=1551879212 % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 5757k 0 5757k 0 0 513k 0 --:--:-- 0:00:11 --:--:-- 526k time_namelookup: 0.004286 time_connect: 0.030107 time_appconnect: 0.117525 time_pretransfer: 0.117606 time_redirect: 0.000000 time_starttransfer: 0.840348 ---------- time_total: 11.208119 ---------- size_download: 5895467 Bytes speed_download: 525999.000B/s</span></span></code> </pre> <br><p>  <strong>Teste Akamai:</strong> </p><br><pre> <code class="bash hljs">root@shenzhen1:~<span class="hljs-comment"><span class="hljs-comment"># curl -o /dev/null -w@curl_time https://www.semrushchina.cn/my_reports/build/scripts/simpleInit.js?v=1551879212 % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 5757k 0 5757k 0 0 1824k 0 --:--:-- 0:00:03 --:--:-- 1825k time_namelookup: 0.509005 time_connect: 0.528261 time_appconnect: 0.577235 time_pretransfer: 0.577324 time_redirect: 0.000000 time_starttransfer: 1.327013 ---------- time_total: 3.154850 ---------- size_download: 5895467 Bytes speed_download: 1868699.000B/s</span></span></code> </pre> <br><p>  Percebemos que a situa√ß√£o do exemplo acima depende de v√°rios fatores.  No momento da reda√ß√£o deste texto, eu executei o teste novamente.  Os resultados para ambas as plataformas foram aproximadamente os mesmos.  Isso nos diz que a Internet na China, mesmo para grandes operadoras e provedores de nuvem, se comporta de maneira diferente de tempos em tempos. </p><br><p>  Acrescentarei uma grande vantagem √† Akamai no par√°grafo anterior: se Ali mostrar flashes de alto desempenho e muito baixos (isso se aplica a Ali CDN, Ali CEN e Ali IPSEC), ent√£o na Akamai sempre, n√£o importa como eu teste sua rede, tudo funciona de forma est√°vel. <br>  A Akamai realmente tem muita cobertura na China e trabalha com muitos fornecedores. </p><br><p>  <strong>O que n√£o gostou:</strong> </p><br><ul><li>  Eu n√£o gosto da interface web e do esquema de trabalho - como zero.  Mas basicamente voc√™ se acostuma (provavelmente). </li><li>  Os resultados dos testes s√£o piores que o nosso site. </li><li>  H√° mais erros durante os testes do que em nosso site (tempo de atividade abaixo). </li><li>  N√£o h√° servidores DNS na China.  A partir daqui, existem muitos erros nos testes devido ao tempo limite da resolu√ß√£o do DNS. </li><li>  N√£o forne√ßa seus intervalos de IP -&gt; n√£o h√° como registrar o <em>set_real_ip_from</em> correto em nossos servidores. </li></ul><br><p>  M√©tricas (~ 3626 executadas; todas as m√©tricas, exceto Uptime em ms; estat√≠sticas por um per√≠odo de tempo): </p><br><div class="scrollable-table"><table><thead><tr><th>  Fornecedor de CDN </th><th>  Mediana </th><th>  75% </th><th>  95% </th><th>  Resposta </th><th>  Resposta da p√°gina da Web </th><th>  Upime </th><th>  DNS </th><th>  Conectar </th><th>  Espera </th><th>  Carregar </th><th>  SSL </th></tr></thead><tbody><tr><td>  Ali CDN </td><td>  9195 </td><td>  10749 </td><td>  17489 </td><td>  1.715 </td><td>  10.745 </td><td>  99.531 </td><td>  57 </td><td>  17 </td><td>  927 </td><td>  479 </td><td>  200 </td></tr><tr><td>  Akamai </td><td>  9783 </td><td>  11887 </td><td>  19888 </td><td>  2.352 </td><td>  11.550 </td><td>  98.980 </td><td>  424 </td><td>  91 </td><td>  1408 </td><td>  381 </td><td>  50. </td></tr></tbody></table></div><br><p>  Distribui√ß√£o percentual (em ms): </p><br><div class="scrollable-table"><table><thead><tr><th>  Percentil </th><th>  Akamai </th><th>  Ali CDN </th></tr></thead><tbody><tr><td>  10 </td><td>  7.092 </td><td>  6.942 </td></tr><tr><td>  20 </td><td>  7.775 </td><td>  7.583 </td></tr><tr><td>  30 </td><td>  8.446 </td><td>  8.092 </td></tr><tr><td>  40. </td><td>  9.146 </td><td>  8.596 </td></tr><tr><td>  50. </td><td>  9.783 </td><td>  9.195 </td></tr><tr><td>  60 </td><td>  10.497 </td><td>  9.770 </td></tr><tr><td>  70 </td><td>  11.371 </td><td>  10.383 </td></tr><tr><td>  80 </td><td>  12.670 </td><td>  11.255 </td></tr><tr><td>  90 </td><td>  15.882 </td><td>  13.165 </td></tr><tr><td>  100 </td><td>  91.592 </td><td>  91.596 </td></tr></tbody></table></div><br><p>  A conclus√£o √© a seguinte: a op√ß√£o com a Akamai √© vi√°vel, mas n√£o fornece os mesmos indicadores de estabilidade e velocidade da nossa solu√ß√£o, juntamente com o Ali CDN. </p><br><h2 id="malenkie-zametki">  Pequenas notas </h2><br><p>  Alguns pontos n√£o foram inclu√≠dos na hist√≥ria, mas eu gostaria de escrever sobre eles tamb√©m. </p><br><h3 id="pekin--tokio-i-gonkong">  Pequim + T√≥quio e Hong Kong </h3><br><p>  Como eu disse acima, testamos o t√∫nel IPSEC para Hong Kong (HK).  Mas tamb√©m testamos o CEN antes da HK.  Custa um pouco mais barato e foi interessante como funcionar√° entre cidades com uma dist√¢ncia de ~ 100 km.  Acabou sendo interessante que a lat√™ncia entre essas cidades seja 100ms maior que em nossa vers√£o original (para Taiwan).  Velocidade, estabilidade tamb√©m foi melhor para Taiwan.  Como resultado, deixamos HK como uma regi√£o IPSEC de backup. </p><br><p>  Al√©m disso, tentamos criar uma instala√ß√£o desse tipo: </p><br><ul><li>  rescis√£o do cliente em Pequim, </li><li>  IPSEC e CEN para T√≥quio, </li><li>  em Ali, a CDN foi listada como o servidor de origem em Pequim. </li></ul><br><p>  Esse esquema n√£o era t√£o est√°vel, embora em termos de velocidade como um todo, n√£o fosse inferior √† nossa solu√ß√£o.  Quanto ao t√∫nel, vi quedas peri√≥dicas at√© para o CEN, que deveria ser est√°vel.  Portanto, retornamos ao esquema antigo e desmontamos esse teste. </p><br><p>  Abaixo est√£o as estat√≠sticas de lat√™ncia entre diferentes regi√µes em diferentes canais.  Talvez algu√©m se interesse por isso. </p><br><p>  <em>IPsec</em> <br>  Ali cn-beijing &lt;--&gt; GCP asia-nordeste1 - 193ms <br>  Ali cn-shenzhen &lt;--&gt; GCP asia-east2 - 91ms <br>  Ali cn-shenzhen &lt;--&gt; GCP us-east4 - 200ms </p><br><p>  <em>Cen</em> <br>  Ali cn-beijing &lt;---&gt; Ali ap-nordeste-1 - 54ms (!) <br>  Ali cn-shenzhen &lt;---&gt; Ali cn-hong kong - 6ms (!) <br>  Ali cn-shenzhen &lt;---&gt; Ali us-east1 - 216ms </p><br><h3 id="obschaya-informaciya-pro-internet-v-kitae">  Informa√ß√µes gerais sobre a Internet na China </h3><br><p>  Como complemento aos problemas com a Internet, descritos no in√≠cio, na primeira parte do artigo. </p><br><ul><li>  A Internet na China √© bem r√°pida por dentro. <br><ul><li>  A conclus√£o √© feita com base no teste de redes Wi-Fi p√∫blicas em v√°rios locais onde essas redes s√£o usadas por um grande n√∫mero de pessoas. </li><li>  As velocidades de download e upload para servidores na China eram de aproximadamente 20 Mbps e 5-10 Mbps, respectivamente. </li><li>  A velocidade dos servidores fora da China √© miser√°vel, menos de 1 Mbps. </li></ul></li><li>  A Internet na China n√£o √© muito est√°vel. <br><ul><li>  √Äs vezes, os sites podem abrir rapidamente, √†s vezes lentamente (na mesma hora do dia em dias diferentes), desde que a configura√ß√£o n√£o seja alterada.  Observamos isso com o exemplo de semrushchina.cn.  Isso pode ser atribu√≠do ao Ali CDN, que tamb√©m funciona dessa maneira e que, dependendo da hora do dia, da posi√ß√£o das estrelas, etc. </li></ul></li><li>  A Internet m√≥vel est√° em quase todos os lugares 4G ou 4G +.  Capturas no metr√¥, elevadores - em suma, em todos os lugares. </li><li>  O fato de os usu√°rios chineses confiarem apenas em dom√≠nios na zona .cn √© um mito.  Aprendemos isso diretamente dos usu√°rios. <br><ul><li>  Voc√™ pode ver como o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http://baidu.cn √©</a> redirecionado para www.baidu.com (tamb√©m na China continental). </li></ul></li><li>  Muitos recursos est√£o realmente bloqueados.  Primitivo: google.com, Facebook, Twitter.  Mas muitos recursos do Google funcionam (√© claro, nem todos os Wi-Fi e VPNs s√£o usados ‚Äã‚Äãao mesmo tempo (tamb√©m no lado do roteador, isso √© certo). </li><li>  Muitos dom√≠nios "t√©cnicos" de empresas bloqueadas tamb√©m funcionam.  Isso significa que voc√™ nem sempre deve cortar de forma imprudente todo o Google e outros recursos aparentemente bloqueados.  Voc√™ precisa procurar uma lista de dom√≠nios proibidos. </li><li>  Eles t√™m apenas tr√™s principais provedores de Internet: China Unicom, China Telecom, China Mobile.  Existem ainda menores, mas sua participa√ß√£o no mercado √© insignificante </li></ul><br><h3 id="bonus-itogovaya-shema-resheniya">  B√¥nus: esquema de decis√£o final </h3><br><img src="https://habrastorage.org/webt/jr/qe/uq/jrqeuqrsssdnjbnkp43rqjm29ro.png"><br><h2 id="itog">  Sum√°rio </h2><br><p>  Um ano se passou desde o in√≠cio do projeto.  Come√ßamos com o fato de que nosso site geralmente se recusava a trabalhar normalmente na China, mas apenas o GET curl levou 5,5 segundos. </p><br><p>  Ent√£o, com esses indicadores na primeira decis√£o (Cloudflare): </p><br><div class="scrollable-table"><table><thead><tr><th>  Solu√ß√£o </th><th>  Upime </th><th>  Mediana </th><th>  Percentil 75 </th><th>  Percentil 95 </th></tr></thead><tbody><tr><td>  Cloudflare </td><td>  86,6 </td><td>  18 anos </td><td>  30s </td><td>  Anos 60 </td></tr></tbody></table></div><br><p>  Como resultado, chegamos aos seguintes resultados (estat√≠sticas do √∫ltimo m√™s): </p><br><div class="scrollable-table"><table><thead><tr><th>  Solu√ß√£o </th><th>  Upime </th><th>  Mediana </th><th>  Percentil 75 </th><th>  Percentil 95 </th></tr></thead><tbody><tr><td>  Ali CDN + CEN / IPsec + GLB </td><td>  99,86 </td><td>  8.8s </td><td>  9.5s </td><td>  13.7s </td></tr></tbody></table></div><br><p>  Como voc√™ pode ver, o tempo de atividade em 100% ainda n√£o foi alcan√ßado, mas criaremos algo e depois falaremos sobre os resultados em um novo artigo :) </p><br><p>  Para quem leu todas as tr√™s partes at√© o fim - respeito.  Espero que voc√™s tenham ficado t√£o interessados ‚Äã‚Äãquanto eu quando fiz isso. </p><br><h3 id="ps-predyduschie-chasti">  Pe√ßas anteriores PS </h3><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt459024/">https://habr.com/ru/post/pt459024/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt459012/index.html">Criando um aplicativo para Bitrix24 do zero</a></li>
<li><a href="../pt459014/index.html">Saindo da sua zona de conforto: de nodejs a dlang</a></li>
<li><a href="../pt459018/index.html">T√°ticas de role-playing no desktop</a></li>
<li><a href="../pt459020/index.html">Por que o DFSR n√£o replica alguns arquivos e como lidar com isso</a></li>
<li><a href="../pt459022/index.html">Comunica√ß√£o por v√≠deo olho no olho: tentativas de resolver o problema da falta de contato visual</a></li>
<li><a href="../pt459028/index.html">Aloca√ß√£o de mem√≥ria est√°tica em microcontroladores</a></li>
<li><a href="../pt459030/index.html">Um vislumbre da caixa preta - um novo sistema do MIT mostrar√° como os algoritmos de aprendizado de m√°quina funcionam</a></li>
<li><a href="../pt459034/index.html">Algumas dicas simples, mas √∫teis, para trabalhar com getters no Vuex</a></li>
<li><a href="../pt459038/index.html">A orienta√ß√£o por voz da c√¢mera tornou-se mais acess√≠vel - a solu√ß√£o universal SmartCam A12 Voice Tracking</a></li>
<li><a href="../pt459046/index.html">Como implementar independentemente (Prova de Exist√™ncia) em 2 etapas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>