<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤛🏾 🛑 🖐🏻 Cara membuat bot yang mengubah foto menjadi komik. Bagian Dua Pelatihan model 🚹 ♿️ 🌪️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="⇨ Bagian pertama 
 ⇨ Bagian ketiga 

 Halo lagi! 

 Seperti yang Anda lihat, liburan agak melumpuhkan timeline untuk artikel. 
 Saya pikir banyak sela...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cara membuat bot yang mengubah foto menjadi komik. Bagian Dua Pelatihan model</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483168/">  <a href="https://habr.com/ru/post/479218/">⇨ Bagian pertama</a> <br>  <a href="https://habr.com/ru/post/485824/">⇨ Bagian ketiga</a> <br><br>  Halo lagi! <br><br>  Seperti yang Anda lihat, liburan agak melumpuhkan timeline untuk artikel. <br>  Saya pikir banyak selama ini berhasil, jika tidak sepenuhnya melatih model mereka, maka paling tidak bereksperimen dengan set data yang berbeda. <br><blockquote>  1. Masukkan distribusi <br>  2. Mengunduh gambar <br>  3. ??? <br>  4. Keuntungan! <br></blockquote>  Jika Anda tidak sesuai dengan jaringan saraf kami ini, atau Anda mulai membaca dari artikel ini, maka, seperti yang mereka katakan, tidak ada waktu untuk menjelaskan, kami mengambil kit distribusi, mengunduh gambar yang diperlukan, dan mari kita pergi! <br><a name="habracut"></a><br>  Instruksi terperinci ada <a href="https://habr.com/ru/post/479218/">di artikel sebelumnya dalam seri</a> . <br><br><h2>  Pancake pertama kental </h2><br>  Ketika saya melatih model untuk <a href="https://t.me/photo2comicsbot" rel="nofollow">@ photo2comicsbot</a> untuk pertama kalinya, tanpa basa-basi lagi, saya hanya memasukkan sekitar 1.000 halaman komik ke dalam dataset. <br>  Ya, bersama dengan sampul, pengumuman, dan pengisi lainnya. <br><br>  Di pintu masuk tampak seperti ini: <br><br><img src="https://habrastorage.org/webt/vs/7t/p8/vs7tp8lqmuevcrv_3cpuzbyaef4.png"><br><br>  Hasilnya sesuai: <br><br><img src="https://habrastorage.org/webt/2s/sf/5s/2ssf5st8mk1oge_9rrfbyepmlhk.png"><br><br><img src="https://habrastorage.org/webt/7x/dl/kp/7xdlkpn70yzd8qfljqusgn6jy5y.png"><br><br><img src="https://habrastorage.org/webt/ll/ll/v8/llllv8gmtfys_udt5euohplcjzw.png"><br><br><div class="spoiler">  <b class="spoiler_title">Lebih banyak gambar</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/tl/ey/8e/tley8enuh1qlcjt3nc7e9-wnzse.png"><br><br><img src="https://habrastorage.org/webt/2u/cz/5n/2ucz5nwpenvhonfh84m080tj_t0.png"><br><br><img src="https://habrastorage.org/webt/o7/qb/xt/o7qbxtxqcrgdcih_4m-ysiksd_e.png"><br><br><img src="https://habrastorage.org/webt/xc/-8/yl/xc-8ylyfuk71me4v59xxvn3qhj4.png"><br><br><img src="https://habrastorage.org/webt/ys/zx/vm/yszxvm-2hc8xt6rjsvvxcpuyy3w.png"><br><br><img src="https://habrastorage.org/webt/jl/p9/3t/jlp93trm26hwitdzgmdt_kylhfw.png"><br><br><img src="https://habrastorage.org/webt/3l/fb/y6/3lfby6xuenl47xlggsv9n2p9hss.png"><br><br><img src="https://habrastorage.org/webt/bq/mt/sd/bqmtsdr7xedmcxsogpa4j8olk8c.png"><br><br></div></div><br>  Model ini dengan sempurna menyampaikan perbedaan umum antara komik dan foto: <br><br><ul><li>  Pemeringkatan warna tipikal </li><li>  Seleksi garis besar </li><li>  Memblokir </li><li>  Cloud teks </li></ul><br>  Pada prinsipnya, opsi ini mungkin cukup untuk produksi. <br><br>  Tapi saya bertanya-tanya hasil apa yang bisa diperoleh pada dataset "bersih". <br><br><h2>  Ambil dua </h2><br>  Untuk percobaan berikutnya, saya meninggalkan halaman dengan satu blok, dan dari sisanya saya memotong bagian terbesar, yang terdiri dari satu blok, untuk menghilangkan garis pemisah vertikal dan horizontal dalam model akhir. <br><blockquote>  Jika Anda membuat perubahan pada dataset Anda, misalnya, menghapus atau menambahkan foto, jangan lupa untuk menyimpan versi sebelumnya.  Anda akan memiliki tempat untuk kembali jika terjadi kesalahan. </blockquote>  Dataset kedua terlihat seperti ini: <br><br><img src="https://habrastorage.org/webt/ww/j9/8f/wwj98fxmy0d15c0xgxfz8w9bfs4.png"><br><br>  Hasilnya, seperti yang mereka katakan, jelas: <br><br><img src="https://habrastorage.org/webt/zn/b3/sc/znb3sczf0ypubx8jya-uryrqbxm.png"><br><br><img src="https://habrastorage.org/webt/xp/n9/zv/xpn9zvimruobxodr4wa2vhrutxk.png"><br><br><img src="https://habrastorage.org/webt/xh/nf/sp/xhnfspsgqrkxvuvhdkj7vaqz5yy.png"><br><br><div class="spoiler">  <b class="spoiler_title">Lebih banyak gambar</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ag/6b/pw/ag6bpwlw1xefb9o8igrdixarhqc.png"><br><br><img src="https://habrastorage.org/webt/h7/xb/di/h7xbdiuyzdmukmjalf3o6rdou8e.png"><br><br><img src="https://habrastorage.org/webt/by/j8/zk/byj8zkaujwhx52po8xqw37un2oo.png"><br><br><img src="https://habrastorage.org/webt/pl/po/0y/plpo0yucjtvt0sbfc-pefnxz940.png"><br><br><img src="https://habrastorage.org/webt/65/4f/el/654fellkdx6_ebimev8ardha_e0.png"><br><br><img src="https://habrastorage.org/webt/zj/9u/vq/zj9uvqeres9m1kr2nmzcpgt-8uc.png"><br></div></div><br>  Garis pemisah menghilang, tetapi dengan mereka ekspresi yang tersisa di awan dengan teks: mereka mulai bertemu jauh lebih jarang dalam dataset dan tidak lagi menjadi fitur utama. <br><br>  Ruang kosong yang dulu diisi dengan teks sekarang dipenuhi dengan suara psychedelic. <br><br><h2>  Ketiga kalinya pesona </h2><br>  Saya memutuskan untuk menyingkirkan teks sepenuhnya, hanya menyisakan bagian-bagian komik di mana tidak.  Tidak ada yang selamat: tidak ada cloud, tidak ada berita utama, atau nama seri. <br><br>  Dataset setelah "genosida linguistik": <br><br><img src="https://habrastorage.org/webt/zu/pw/az/zupwaz8q1toeo9qvqncmfamino8.png"><br><br>  Hasil akhir: <br><br><img src="https://habrastorage.org/webt/9s/o2/qg/9so2qgo6e6jpkdazfsqf2wlu1-w.png"><br><br><img src="https://habrastorage.org/webt/gs/nr/7p/gsnr7pfyfu4bcowe0bpyqlqn1vc.png"><br><br><img src="https://habrastorage.org/webt/me/vs/m6/mevsm6y3hlgvrvsa8qce0xhenqa.png"><br><br><div class="spoiler">  <b class="spoiler_title">Lebih banyak gambar</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/uv/hn/ua/uvhnuapobrpzdu8fxhyjqnz-ozg.png"><br><br><img src="https://habrastorage.org/webt/w1/gu/2e/w1gu2enojimz-lrpkzrzlkvihv8.png"><br><br><img src="https://habrastorage.org/webt/_e/j0/91/_ej091msilwm4hhlmbl3j7nw6sq.png"><br><br><img src="https://habrastorage.org/webt/ql/o6/th/qlo6thuiesfbqx_f2yx6yanf4ne.png"><br><br><img src="https://habrastorage.org/webt/cm/xg/4t/cmxg4tu9jp4-6dcjvjp2nwei3gq.png"><br></div></div><br>  Di satu sisi, ada lebih sedikit artefak, di sisi lain, ekspresif telah hilang.  Karena dalam pelatihan GAN kualitas hasil sangat ditentukan oleh Anda dan saya, tidak ada resep tunggal untuk model yang baik. <br><br>  Kecantikan ada di mata yang melihatnya, jadi jangan takut untuk bereksperimen dan memilih yang paling Anda sukai. <br><br><h2>  Untuk senjatanya! </h2><br>  Yah, kita sudah bicara tentang jebakan utama dan metode berurusan dengan mereka, saatnya untuk turun ke bisnis. <br><br>  Buka folder tempat kami mengunduh distribusi.  Biarkan saya mengingatkan Anda bahwa itu disebut <b>pytorch-CycleGAN-and-pix2pix</b> <br><br>  Karena kami memiliki instruksi untuk boneka, kami tidak akan menyentuh kode distribusi, karena semua parameter yang diperlukan dapat ditetapkan dari baris perintah. <br><br>  Dalam distribusi ini, pelatihan standar berlangsung lebih dari dua ratus era, dengan pelemahan linier dari tingkat pembelajaran setelah zaman keseratus. <br><blockquote>  Resolusi maksimum yang dapat dikuasai kartu delapan gigabyte saya adalah 400x400.  Pelatihan penuh membutuhkan waktu sekitar 33 jam, jadi kami akan menggunakan hack kecil.  Pertama, kita akan melatih model dalam gambar 128x128, kemudian 256x256, dan hanya pada tahap akhir kita akan menunjukkan padanya 400x400 kita yang cantik. <br>  Tahap pertama akan berlangsung 100 era, yang kedua dan ketiga - masing-masing 50, yang akan memungkinkan kita untuk mengurangi waktu pelatihan hampir setengahnya. <br><br>  Seperti yang diperlihatkan oleh praktik, hasil dengan pendekatan ini tidak lebih buruk, dan kadang-kadang lebih baik, daripada ketika berlatih segera dengan resolusi maksimal. </blockquote>  Mungkin cukup teori, sudah waktunya untuk melanjutkan berlatih. <br><br>  Pada prompt perintah, masukkan. <br><br><h3>  Tahap satu </h3><br><pre><code class="bash hljs">python train.py --dataroot {dataset root folder} --name {model name} --model cycle_gan --crop_size 128 --load_size 180 --init_type kaiming --netG resnet_9blocks --no_dropout --batch_size 4</code> </pre> <br>  <i>Jangan lupa untuk mengganti kawat gigi dengan nilai Anda sendiri.</i> <i><br></i> <br>  Kami akan menganalisis beberapa parameter secara lebih rinci: <br><br><pre> <code class="bash hljs">--batch_size {number}</code> </pre> <br>  Parameter ini bertanggung jawab atas jumlah gambar yang diproses per siklus, secara positif mempengaruhi kecepatan dan secara negatif pada kerakusan model. <br><br>  Pada setiap tahap, pilih kemungkinan maksimum --batch_size, yang tidak menyebabkan kesalahan karena kekurangan memori GPU. <br><br><pre> <code class="bash hljs">-- dataroot {dataset root folder}</code> </pre> <br>  - folder dengan dataset kami.  Di dalamnya harus folder trainA, trainB, testA, testB, seperti yang dijelaskan dalam artikel sebelumnya. <br><br><pre> <code class="bash hljs">--name {model name}</code> </pre> <br>  - Nama proyek Anda.  Mungkin sewenang-wenang, tapi saya sarankan untuk memasukkan arsitektur model, resolusi maksimum dan nama dataset dalam nama. <br>  Misalnya: “resnet9_128to400_comics8” <br>  Jadi, Anda dapat membedakan antara percobaan dengan berbagai parameter dan data. <br><br>  Tahap pertama pelatihan bisa dihentikan di era keseratus. <br><br>  Anda dapat mengamati kemajuan dari browser: <a href="http://localhost/" rel="nofollow">localhost</a> : 8097 / <br>  (atau tautan lain yang akan terlihat di konsol) <br><br><h3>  Tahap Dua </h3><br><pre> <code class="bash hljs">python train.py --dataroot {dataset root folder} --name {model name} --model cycle_gan --crop_size 256 --load_size 290 --init_type kaiming --netG resnet_9blocks --no_dropout --batch_size 2 --epoch 100 --epoch_count 0 --continue_train</code> </pre> <br>  Penting untuk menunjukkan era di mana kami menyelesaikan studi kami di tahap pertama. <br>  "--Epoch 100" berarti bahwa kami akan memuat model dari pos pemeriksaan era keseratus <br>  “--Epoch_count 0” berarti kita akan memulai pelatihan dari awal, dengan kecepatan belajar maksimum. <br><br>  Pelatihan tahap kedua bisa dihentikan di era ke-50. <br><br><h3>  Tahap Tiga </h3><br><pre> <code class="bash hljs">python train.py --dataroot {dataset root folder} --name {model name} --model cycle_gan --crop_size 400 --load_size 430 --init_type kaiming --netG resnet_9blocks --no_dropout --batch_size 1 --epoch 50 --epoch_count 0 --continue_train</code> </pre> <br><br>  Pelatihan tahap ketiga dapat dihentikan pada era ke-50, tetapi ini adalah masalah selera.  Anda dapat menyelesaikan hingga akhir, dan memilih hasil antara yang Anda suka.  Penting untuk diingat bahwa hasil pada era ke-200 mungkin lebih buruk daripada pada ke-150. <br><br><h2>  Sekarang pergilah dan lihat apa yang telah Anda lakukan </h2><br>  Selama pelatihan, model dan hasil antara akan disimpan dalam folder <br>  / pytorch-CycleGAN-and-pix2pix / checkpoints / {nama model} <br><br>  Untuk menguji model, cukup masukkan baris perintah: <br><br><pre> <code class="bash hljs">python test.py --dataroot {dataset root folder} --name {model name} --model cycle_gan --netG resnet_9blocks --crop_size 512 --load_size 580 --epoch {epoch name}</code> </pre> <br>  Anda dapat melihat hasilnya pada dataset uji untuk setiap pos pemeriksaan, cukup tentukan sebagai {epoch name}.  Jika {epoch name} tidak ditentukan, pos pemeriksaan terakhir akan diambil. <br><br>  Hasilnya akan disimpan dalam folder: <br> <code>/pytorch-CycleGAN-and-pix2pix/results/{model name}/test_{epoch name}</code> <br> <blockquote>  Agar tidak bingung model mana pada dataset mana memberikan hasil apa, <br>  mulai membuat buku harian kecil.  Catat data dasar dan hasil pembelajaran. <br><br>  Misalnya, baris perintah dan era yang telah Anda capai.  Data ini cukup untuk menyimpan parameter pelatihan dan set data yang kami latih. <br><br>  Lagi pula, apa perbedaan antara percobaan ilmiah dan bermain-main?  Fakta bahwa semuanya didokumentasikan bersama kami! </blockquote>  Itu saja untuk hari ini!  Pada artikel selanjutnya, kita akan belajar bagaimana mengekspor model yang sudah jadi dan menyimpannya di cloud. <br><br>  Jangan takut untuk bereksperimen.  Pastikan untuk mencoba beberapa set data yang berbeda, bandingkan hasilnya dan bagikan dalam komentar! <br><br>  Sampai ketemu lagi! <br><br>  <a href="https://habr.com/ru/post/485824/">⇨ Bagian selanjutnya</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id483168/">https://habr.com/ru/post/id483168/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id483148/index.html">Kami membahas kembar digital dan simulasi dengan pendiri perusahaan konsultan</a></li>
<li><a href="../id483154/index.html">Saya menghabiskan $ 40 ribu dan merusak ide bagus untuk startup</a></li>
<li><a href="../id483156/index.html">Letakkan kucing di atas kakinya</a></li>
<li><a href="../id483160/index.html">Ruang 2020: Mars, rasi bintang satelit dan roket baru</a></li>
<li><a href="../id483166/index.html">Secara otomatis mendeteksi penyandian teks</a></li>
<li><a href="../id483170/index.html">Database messenger (bagian 2): kami mempartisi "untung"</a></li>
<li><a href="../id483172/index.html">Bagaimana cara Melokalkan Aplikasi atau Game? Sepuluh Sumber E-learning Gratis</a></li>
<li><a href="../id483174/index.html">Rekam dan transfer suara dari perangkat ke perangkat menggunakan Konektivitas Multipeer</a></li>
<li><a href="../id483176/index.html">Database messenger (bagian 1): kami merancang bingkai dasar</a></li>
<li><a href="../id483178/index.html">Berikut adalah Pembaruan pada Flutter 1.9 Rilis Ditambah dengan Pemrograman Dart 2.5</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>