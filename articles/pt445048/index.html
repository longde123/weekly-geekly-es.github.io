<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üç° üë©‚Äç‚öïÔ∏è üßëüèº‚Äçü§ù‚Äçüßëüèº Algoritmo de triangula√ß√£o de Delaunay pelo m√©todo da linha de varredura üë®üèΩ‚Äçüè≠ üë®üèø‚Äçüç≥ üï∫üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bom dia 

 Neste artigo, descreverei em detalhes o algoritmo que obtive como resultado da id√©ia de "varrer a linha reta" para construir a triangula√ß√£o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Algoritmo de triangula√ß√£o de Delaunay pelo m√©todo da linha de varredura</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/445048/">  Bom dia <br><br>  Neste artigo, descreverei em detalhes o algoritmo que obtive como resultado da id√©ia de "varrer a linha reta" para construir a triangula√ß√£o de Delaunay em um plano.  Existem v√°rias id√©ias que nunca encontrei quando li artigos sobre triangula√ß√£o. <br>  Talvez algu√©m tamb√©m os ache incomuns.  Tentarei fazer tudo da melhor tradi√ß√£o e incluir o seguinte na hist√≥ria: uma descri√ß√£o das estruturas de dados usadas, uma descri√ß√£o das etapas do algoritmo, prova de corre√ß√£o, estimativas de tempo e uma compara√ß√£o com um algoritmo iterativo usando a √°rvore kD. <br><a name="habracut"></a><br><h2>  Defini√ß√µes e declara√ß√£o do problema </h2><br><h4>  Triangula√ß√£o </h4><br>  Diz-se que a triangula√ß√£o √© dada no conjunto de pontos no plano se alguns pares de pontos s√£o conectados por uma aresta, qualquer face finita no gr√°fico resultante forma um tri√¢ngulo, as arestas n√£o se cruzam e o gr√°fico √© m√°ximo no n√∫mero de arestas. <br><br><p><img src="https://habrastorage.org/webt/go/f6/x5/gof6x5u4p967b-k_rkp5vur3-wc.png" width="511" height="300"></p><br><br><h4>  Triangula√ß√£o de Delaunay </h4><br>  Uma triangula√ß√£o de Delaunay √© uma triangula√ß√£o na qual, para qualquer tri√¢ngulo, √© verdade que n√£o h√° pontos do conjunto original dentro do c√≠rculo circunscrito ao seu redor. <br><br><p><img src="https://habrastorage.org/webt/fz/vv/az/fzvvaz-xuli8vyiit6xskbrysfa.png" width="508" height="300"></p><br><br>  <i>Nota</i> : para um determinado conjunto de pontos em que n√£o h√° 4 pontos no mesmo c√≠rculo, existe exatamente uma triangula√ß√£o em Delaunay. <br><br><h4>  A Condi√ß√£o de Delaunay </h4><br>  Seja dada uma triangula√ß√£o no conjunto de pontos.  Dizemos que um determinado subconjunto de pontos satisfaz a condi√ß√£o de Delaunay se a triangula√ß√£o delimitada nesse subconjunto for a triangula√ß√£o de Delaunay para ele. <br><br><h4>  Crit√©rio para triangula√ß√£o de Delaunay </h4><br>  O cumprimento da condi√ß√£o de Delaunay para todos os pontos que formam um quadr√¢ngulo em uma triangula√ß√£o √© equivalente ao fato de que essa triangula√ß√£o √© uma triangula√ß√£o de Delaunay. <br><br>  <i>Nota</i> : para quadr√¢ngulos n√£o convexos, a condi√ß√£o de Delaunay √© sempre preenchida e para quadr√¢ngulos convexos (cujos v√©rtices n√£o est√£o no mesmo c√≠rculo), existem exatamente 2 triangula√ß√µes poss√≠veis (uma das quais √© a triangula√ß√£o de Delaunay). <br><br><p><img src="https://habrastorage.org/webt/32/qt/bv/32qtbvo-eil1x1o3w5-h86hb_ee.png" width="470" height="300"></p><br><br>  <b>A tarefa √© construir uma triangula√ß√£o de Delaunay para um determinado conjunto de pontos.</b> <br><br><h2>  Descri√ß√£o do algoritmo </h2><br><h4>  Pontos vis√≠veis e arestas vis√≠veis </h4><br>  Seja dado um casco m√≠nimo convexo (doravante, MBO) de um conjunto finito de pontos (arestas conectando alguns dos pontos para formar um pol√≠gono contendo todos os pontos do conjunto) e um ponto A localizado fora do casco.  Em seguida, o ponto do plano √© chamado vis√≠vel para o ponto A, se o segmento que o conectar ao ponto A n√£o cruzar o MBO. <br><br>  Uma borda do MBO √© chamada vis√≠vel para o ponto A se suas extremidades s√£o vis√≠veis para A. <br><br>  Na imagem a seguir, as bordas vis√≠veis para o ponto vermelho est√£o marcadas em vermelho: <br><br><p><img src="https://habrastorage.org/webt/lv/jz/s9/lvjzs9fxcxn1yqvu4aqdo8mohwy.png" width="456" height="400"></p><br><br>  <i>Nota</i> : o contorno da triangula√ß√£o de Delaunay √© o MBO para os pontos nos quais √© constru√≠do. <br><br>  <i>Observa√ß√£o 2</i> : no algoritmo, as arestas vis√≠veis para o ponto adicionado A formam uma cadeia, ou seja, v√°rias arestas de MBO seguidas <br><br><h4>  Armazenando triangula√ß√£o na mem√≥ria </h4><br>  Existem alguns m√©todos padr√£o que s√£o bem descritos no livro de Skvortsov [1].  Devido √†s especificidades do algoritmo, vou oferecer minha pr√≥pria vers√£o.  Como queremos verificar as 4 gons para a condi√ß√£o de Delaunay, consideramos sua estrutura.  Cada quadr√¢ngulo em triangula√ß√£o √© de 2 tri√¢ngulos com uma aresta comum.  Cada aresta tem exatamente 2 tri√¢ngulos adjacentes.  Assim, cada quadr√¢ngulo em triangula√ß√£o √© gerado por uma aresta e dois v√©rtices opostos √† aresta em tri√¢ngulos adjacentes. <br>  Como dois tri√¢ngulos e sua adjac√™ncia s√£o restaurados ao longo da aresta e dois v√©rtices, podemos restaurar a triangula√ß√£o para todas essas estruturas.  Assim, prop√µe-se armazenar uma aresta com dois v√©rtices no conjunto e realizar uma pesquisa ao longo da aresta (um par de v√©rtices ordenados). <br><br><p><img src="https://habrastorage.org/webt/kp/yx/hf/kpyxhfrurcwtwf53gvu37-nkdko.png" width="309" height="200"></p><br><br><h3>  Algoritmo </h3><br>  A id√©ia da linha de varredura √© que todos os pontos sejam classificados em uma dire√ß√£o e depois processados ‚Äã‚Äãpor sua vez. <br><br><ol><li>  Classifique todos os pontos em uma linha reta (por simplicidade, por coordenadas <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-78" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-1"> x </script>  ) </li><li>  Constru√≠mos um tri√¢ngulo nos 3 primeiros pontos. <br><br>  Al√©m disso, para cada pr√≥ximo ponto, executaremos etapas que preservam a invariante de que existe uma triangula√ß√£o em Delaunay para pontos j√° adicionados e, consequentemente, um MBO para eles. </li><li>  Adicione os tri√¢ngulos formados pelas arestas vis√≠veis e pelo pr√≥prio ponto (ou seja, adicione as arestas do ponto em quest√£o a todas as extremidades das arestas vis√≠veis). </li><li>  Verificamos na condi√ß√£o de Delaunay todos os quadr√¢ngulos gerados pelas arestas vis√≠veis.  Se em algum lugar a condi√ß√£o n√£o for atendida, reconstru√≠mos a triangula√ß√£o no quadril√°tero (lembro-me de que existem apenas dois deles) e executamos recursivamente a verifica√ß√£o dos quadril√°teros gerados pelas bordas do quadril√°tero atual (porque somente depois deles a condi√ß√£o de Delaunay poderia ser violada). </li></ol><br>  <i>Nota</i> : na etapa (4) durante uma partida recursiva, n√£o √© poss√≠vel verificar os quadr√¢ngulos gerados pelas arestas provenientes do ponto considerado nesta itera√ß√£o (sempre existem duas em cada quatro).  Na maioria das vezes eles ser√£o n√£o convexos, pois convexa a prova √© puramente geom√©trica, deixarei para o leitor.  Al√©m disso, assumimos que apenas 2 partidas recursivas s√£o executadas para cada reconstru√ß√£o. <br><br><h4>  Verificando uma condi√ß√£o de Delaunay </h4><br>  Formas de testar quadr√¢ngulos para a condi√ß√£o de Delaunay podem ser encontradas no mesmo livro [1].  Observo apenas que, ao escolher um m√©todo com fun√ß√µes trigonom√©tricas a partir da√≠, com implementa√ß√£o imprecisa, valores negativos de senos podem ser obtidos, faz sentido lev√°-los ao m√≥dulo. <br><br><h4>  Procure arestas vis√≠veis </h4><br>  Resta entender como encontrar efetivamente arestas vis√≠veis.  Observe que o ponto adicionado anterior S est√° no MBO na itera√ß√£o atual, pois possui a maior coordenada <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-78" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-2"> x </script>  e tamb√©m √© vis√≠vel para o ponto atual.  Depois, observando que as extremidades das arestas vis√≠veis formam uma cadeia cont√≠nua de pontos vis√≠veis, podemos ir do ponto S em ambas as dire√ß√µes ao longo do MBO e coletar as arestas enquanto est√£o vis√≠veis (a visibilidade da aresta √© verificada usando o produto vetorial).  Portanto, √© conveniente armazenar o MBO como uma lista duplamente conectada, a cada itera√ß√£o, removendo as arestas vis√≠veis e adicionando 2 novas a partir do ponto considerado. <br><br><p><img src="https://habrastorage.org/webt/n9/0_/ub/n90_ubf1nbeabdhapitulxvuxgo.png" width="429" height="500"></p><br><br><h4>  Visualiza√ß√£o de algoritmo </h4><br>  Dois pontos vermelhos - adicionados e anteriores.  Bordas vermelhas a cada momento comp√µem a pilha de recurs√£o da etapa (4): <br><br><p><img src="https://habrastorage.org/webt/yq/0a/jc/yq0ajcb3zw7403xa4mvtds17xcs.gif"></p><br><br><h2>  Corre√ß√£o do algoritmo </h2><br>  Para provar a corre√ß√£o do algoritmo, basta provar a conserva√ß√£o do invariante nas etapas (3) e (4). <br><br><h4>  Etapa (3) </h4><br>  Ap√≥s o passo (3), obviamente, obtemos alguma triangula√ß√£o do atual conjunto de pontos. <br><br><h4>  Etapa (4) </h4><br>  No processo da etapa (4), todos os quadr√¢ngulos que n√£o satisfazem a condi√ß√£o de Delaunay est√£o na pilha de recurs√£o (segue a descri√ß√£o), o que significa que no final da etapa (4) todos os quadr√¢ngulos satisfazem a condi√ß√£o de Delaunay, ou seja, a triangula√ß√£o de Delaunay √© realmente constru√≠da.  Ent√£o resta provar que o processo na etapa (4) terminar√° algum dia.  Isso decorre do fato de que todas as arestas adicionadas durante a reconstru√ß√£o v√™m do v√©rtice atual em quest√£o (ou seja, na etapa <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.057ex" viewBox="0 -780.1 521.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-6B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-3"> k </script>  n√£o h√° mais do que <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.214ex" height="2.178ex" viewBox="0 -780.1 2244.9 937.7" role="img" focusable="false" style="vertical-align: -0.366ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-6B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-2212" x="743" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-31" x="1744" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>‚àí</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-4"> k-1 </script>  ) e do fato de que, depois de adicionar essas arestas, n√£o consideraremos os quadr√¢ngulos gerados por elas (veja a observa√ß√£o anterior), o que significa que n√£o adicionaremos mais de uma vez. <br><br><h2>  Complexidade do tempo </h2><br>  Em m√©dia, o algoritmo funciona muito bem em distribui√ß√µes uniformes e normais (os resultados s√£o mostrados na tabela abaixo).  Sup√µe-se que seu tempo de trabalho seja <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.647ex" height="2.66ex" viewBox="0 -832 4584 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-4E" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-6C" x="2041" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-6F" x="2340" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-67" x="2825" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-4E" x="3306" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-29" x="4194" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-5"> O (NlogN) </script>  .  No pior dos casos, uma avalia√ß√£o ocorre <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.76ex" height="2.901ex" viewBox="0 -935.7 2910.5 1249" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-28" x="763" y="0"></use><g transform="translate(1153,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-4E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-32" x="1292" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-29" x="2520" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-6"> O (N ^ 2) </script>  . <br><br><p><img src="https://habrastorage.org/webt/bw/9s/qt/bw9sqtpuuwm9vtnsdcfhhluyaew.png"></p><br><br>  Vamos dar uma olhada no tempo de trabalho em partes e entender qual deles tem o maior impacto no tempo total: <br><br><h4>  Classificar por dire√ß√£o </h4><br>  Para classifica√ß√£o, usaremos a estimativa <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.647ex" height="2.66ex" viewBox="0 -832 4584 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-4E" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-6C" x="2041" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-6F" x="2340" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-67" x="2825" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-4E" x="3306" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-29" x="4194" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-7"> O (NlogN) </script>  . <br><br><h4>  Procure arestas vis√≠veis </h4><br>  Primeiro, mostramos que o tempo total gasto na busca de bordas vis√≠veis √© <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mi>N</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.646ex" height="2.66ex" viewBox="0 -832 2431 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-4E" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-29" x="2041" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-8"> O (N) </script>  .  Observe que a cada itera√ß√£o encontramos todas as arestas vis√≠veis e mais 2 (primeiro n√£o vis√≠veis) em tempo linear.  Na etapa (3), adicionamos novas 2 arestas ao MBO.  Assim, no total, n√£o mais que <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>2</mn><mi>N</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.226ex" height="2.057ex" viewBox="0 -780.1 1389 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-32" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-4E" x="500" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-9"> 2N </script>  costelas, portanto, e v√°rias costelas vis√≠veis n√£o ser√£o mais <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>2</mn><mi>N</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.226ex" height="2.057ex" viewBox="0 -780.1 1389 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-32" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-4E" x="500" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-10"> 2N </script>  .  Tamb√©m vamos encontrar <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>2</mn><mi>N</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.226ex" height="2.057ex" viewBox="0 -780.1 1389 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-32" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-4E" x="500" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-11"> 2N </script>  arestas que n√£o s√£o vis√≠veis.  Assim, no total, n√£o h√° mais <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>4</mn><mi>N</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.226ex" height="2.057ex" viewBox="0 -780.1 1389 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-34" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-4E" x="500" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>4</mn><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-12"> 4N </script>  costelas que correspondem ao tempo <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mi>N</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.646ex" height="2.66ex" viewBox="0 -832 2431 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-4E" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-29" x="2041" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-13"> O (N) </script>  . <br><br><h4>  Construindo novos tri√¢ngulos </h4><br>  O tempo total para a constru√ß√£o de tri√¢ngulos do passo (3) com arestas vis√≠veis j√° encontradas √© obviamente <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mi>N</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.646ex" height="2.66ex" viewBox="0 -832 2431 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-4E" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-29" x="2041" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-14"> O (N) </script>  . <br><br><h4>  Reconstruindo a triangula√ß√£o </h4><br>  Resta lidar com a etapa (4).  Primeiro, observe que verificar a condi√ß√£o de Delaunay e reconstruir se ela n√£o for atendida s√£o a√ß√µes bastante caras (embora funcionem para <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.745ex" height="2.66ex" viewBox="0 -832 2043 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-31" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-29" x="1653" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-15"> O (1) </script>  )  Somente ao verificar a condi√ß√£o de Delaunay, s√£o necess√°rias cerca de 28 opera√ß√µes aritm√©ticas.  Vejamos o n√∫mero m√©dio de reconstru√ß√µes durante esta etapa.  Os resultados pr√°ticos de algumas distribui√ß√µes s√£o apresentados abaixo.  Para eles, quero realmente dizer que o n√∫mero m√©dio de rearranjos cresce com uma velocidade logar√≠tmica, mas vamos deixar isso como uma suposi√ß√£o. <br><br><p><img src="https://habrastorage.org/webt/vm/ld/5u/vmld5u3pzetnfsdkyjx2cuhkabg.png"></p><br><br>  Aqui tamb√©m quero observar que o n√∫mero m√©dio de rearranjos por ponto pode variar muito da dire√ß√£o na qual a classifica√ß√£o √© realizada.  Portanto, para um milh√£o distribu√≠do uniformemente em um ret√¢ngulo baixo longo com uma propor√ß√£o de 100000: 1, esse n√∫mero varia de 1,2 a 24 (esses valores s√£o alcan√ßados ao classificar os dados horizontal e verticalmente, respectivamente).  Portanto, vejo o ponto de escolher a dire√ß√£o da classifica√ß√£o de maneira arbitr√°ria (neste exemplo, com sele√ß√£o arbitr√°ria, em m√©dia, foram obtidas cerca de 2 reconstru√ß√µes) ou selecion√°-la manualmente se os dados forem conhecidos antecipadamente. <br><br>  Assim, o tempo principal que o programa normalmente leva para a etapa (4).  Se for executado rapidamente, faz sentido pensar em acelerar a classifica√ß√£o. <br><br><h4>  Pior caso </h4><br>  Pior caso em <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.057ex" viewBox="0 -780.1 521.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-6B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-16"> k </script>  a itera√ß√£o ocorre <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.214ex" height="2.178ex" viewBox="0 -780.1 2244.9 937.7" role="img" focusable="false" style="vertical-align: -0.366ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-6B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-2212" x="743" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-31" x="1744" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>‚àí</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-17"> k-1 </script>  a chamada recursiva na etapa (4), ou seja, somando todo i, obtemos o comportamento assint√≥tico no pior caso <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.76ex" height="2.901ex" viewBox="0 -935.7 2910.5 1249" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-28" x="763" y="0"></use><g transform="translate(1153,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-4E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-32" x="1292" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-29" x="2520" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-18"> O (N ^ 2) </script>  .  A figura a seguir ilustra um belo exemplo no qual o programa pode funcionar por muito tempo (1100 recria em m√©dia ao adicionar um novo ponto com uma entrada de 10.000 pontos). <br><br><p><img src="https://habrastorage.org/webt/mq/jm/xe/mqjmxeapcrztwr_rrelmjd9to4e.png" width="355" height="400"></p><br><br><h2>  Compara√ß√£o com um algoritmo iterativo para construir uma triangula√ß√£o de Delaunay usando kD-tree </h2><br><h4>  Descri√ß√£o do algoritmo iterativo </h4><br>  Descreverei brevemente o algoritmo acima.  Quando chega o pr√≥ximo ponto, usamos a √°rvore kD (eu aconselho voc√™ a ler sobre isso em algum lugar, se voc√™ n√£o souber), encontramos um tri√¢ngulo que j√° est√° bem pr√≥ximo a ele.  Contornando em profundidade, procuramos um tri√¢ngulo, no qual o ponto em si cai.  Estendemos as arestas aos v√©rtices do tri√¢ngulo encontrado e, na verdade, executamos a etapa (4) do nosso algoritmo para os novos quadr√¢ngulos.  Como o ponto pode estar fora da triangula√ß√£o, para simplifica√ß√£o, prop√µe-se cobrir todos os pontos com um tri√¢ngulo grande (para constru√≠-lo antecipadamente), isso resolver√° o problema. <br><br><h4>  Similaridade de algoritmos </h4><br>  De fato, se pontos s√£o adicionados em ordem classificada em dire√ß√£o, ent√£o nosso algoritmo funciona da mesma forma que iterativo, exceto que o n√∫mero de rearranjos √© menor.  A anima√ß√£o a seguir demonstra isso perfeitamente.  Nela, foram adicionados pontos da direita para a esquerda e todos s√£o cobertos por um grande tri√¢ngulo, que √© posteriormente removido. <br><p><img src="https://habrastorage.org/webt/va/hk/hv/vahkhve0ibbfy9mh3daeqcqkxjk.gif"></p><br><br><h4>  Diferen√ßas de algoritmo </h4><br>  Em um algoritmo iterativo, a localiza√ß√£o de um ponto (busca pelo tri√¢ngulo desejado) ocorre em m√©dia acima de <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.583ex" height="2.66ex" viewBox="0 -832 3695.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-6C" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-6F" x="1451" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-67" x="1937" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMATHI-4E" x="2417" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/445048/&amp;usg=ALkJrhicGA9rn2DYOi8c8Ezqa-ITNqTetg#MJMAIN-29" x="3306" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-19"> O (logN) </script>  , nas distribui√ß√µes acima, ocorrem, em m√©dia, tr√™s rearranjos (como mostrado em [1]) sob a condi√ß√£o de uma ordem arbitr√°ria de fornecimento de pontos.  Assim, a linha de varredura ganha o tempo do algoritmo iterativo na localiza√ß√£o, mas perde na reconstru√ß√£o (o que, lembro-me, √© bastante dif√≠cil).  Al√©m disso, o algoritmo iterativo funciona on-line, que tamb√©m √© seu recurso distintivo. <br><br><h2>  Conclus√£o </h2><br>  Aqui apenas mostro algumas triangula√ß√µes interessantes resultantes da opera√ß√£o do algoritmo. <br><br><h4>  Belo padr√£o </h4><br><p><img src="https://habrastorage.org/webt/tm/gz/0w/tmgz0wuwxltnm3qsyylyz_lfbhs.png" width="703" height="600"></p><br><br><h4>  Distribui√ß√£o normal, 1000 pontos </h4><br><p><img src="https://habrastorage.org/webt/gu/1g/ga/gu1ggatmijtapwt1macmzovasuo.png" width="648" height="600"></p><br><br><h4>  Distribui√ß√£o uniforme, 1000 pontos </h4><br><p><img src="https://habrastorage.org/webt/vt/er/mn/vtermnwtifbyshrnan2nckbkqqw.png" width="686" height="600"></p><br><br><h4>  Triangula√ß√£o constru√≠da nas localiza√ß√µes de todas as cidades da R√∫ssia </h4><br><p><img src="https://habrastorage.org/webt/tz/fw/bj/tzfwbjwjhaevthspbs3gsxv89oy.png"></p><br><p><img src="https://habrastorage.org/webt/ex/fw/9e/exfw9epur4gydutw6ok3dxpt1vc.png"></p><br><br>  Aqui voc√™ pode ver um exemplo do meu c√≥digo para este algoritmo: <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">github.com/Vemmy124/Delaunay-Triangulation-Algorithm</a> <br><br>  <b>Obrigado pela aten√ß√£o!</b> <br><br><h3>  Literatura </h3><br>  [1] Skvortsov A.V.  Triangula√ß√£o de Delaunay e sua aplica√ß√£o.  - Tomsk: Editora Tom.  Universidade, 2002 - 128 p.  ISBN 5-7511-1501-5 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt445048/">https://habr.com/ru/post/pt445048/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt445036/index.html">Qual foi o primeiro iPhone?</a></li>
<li><a href="../pt445038/index.html">Vazamentos de informa√ß√µes classificadas encontradas em 100.000 reposit√≥rios no GitHub</a></li>
<li><a href="../pt445040/index.html">Criamos modelos, "vendemos" a gest√£o do conhecimento para a ger√™ncia e corrigimos o erro do sobrevivente</a></li>
<li><a href="../pt445042/index.html">Hist√≥ria de sucesso Delphic de um programador de Ulan-Ude</a></li>
<li><a href="../pt445044/index.html">Ir aplica√ß√£o em sistemas de produ√ß√£o. Validadores</a></li>
<li><a href="../pt445052/index.html">Por que n√£o consigo definir o tamanho da fonte do link visitado?</a></li>
<li><a href="../pt445054/index.html">A IA agora classifica o c√¢ncer de pulm√£o e os diagn√≥sticos de laborat√≥rio</a></li>
<li><a href="../pt445056/index.html">Vis√£o Geral dos Cursos de Desenvolvimento Web</a></li>
<li><a href="../pt445058/index.html">O piloto autom√°tico da Tesla aprendeu a determinar as mudan√ßas de pista nos carros vizinhos</a></li>
<li><a href="../pt445060/index.html">Organizando pesquisas de dados usando os reposit√≥rios de dados-chave do Spring Data</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>