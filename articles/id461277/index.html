<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêí üê≤ üòï Ikhtisar alat SQLIndexManager gratis üÜö üßñüèæ üè´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Seperti yang Anda ketahui, indeks memainkan peran penting dalam DBMS, menyediakan pencarian cepat dari catatan yang diperlukan. Karena itu, sangat pen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ikhtisar alat SQLIndexManager gratis</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/461277/">  Seperti yang Anda ketahui, indeks memainkan peran penting dalam DBMS, menyediakan pencarian cepat dari catatan yang diperlukan.  Karena itu, sangat penting untuk melayani mereka tepat waktu.  Cukup banyak materi yang telah ditulis tentang analisis dan optimisasi, termasuk di Internet.  Misalnya, ulasan terbaru tentang topik ini dibuat dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">publikasi ini</a> . <br><br>  Ada banyak solusi berbayar dan gratis untuk ini.  Misalnya, ada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">solusi</a> turnkey berdasarkan metode optimasi indeks adaptif. <br><br>  Selanjutnya, pertimbangkan utilitas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">SQLIndexManager</a> gratis, yang ditulis oleh <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link">AlanDenton</a> . <br><a name="habracut"></a><br>  Perbedaan teknis utama antara SQLIndexManager dan sejumlah analog lainnya dibuat oleh penulis di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> dan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . <br><br>  Dalam artikel yang sama, kami melihat proyek dan kemungkinan menggunakan solusi perangkat lunak ini. <br><br>  Diskusikan utilitas ini di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . <br>  Seiring waktu, sebagian besar komentar dan bug telah diperbaiki. <br><br>  Jadi, sekarang mari kita beralih ke utilitas SQLIndexManager itu sendiri. <br><br>  Aplikasi ini ditulis dalam C # .NET Framework 4.5 di Visual Studio 2017 dan menggunakan DevExpress untuk formulir: <br><br> <a href=""><img src="https://habrastorage.org/webt/i0/wo/do/i0wodozvszemgmmash24snfzrgk.jpeg"></a> <br><br>  dan terlihat seperti ini: <br><br> <a href=""><img src="https://habrastorage.org/webt/xc/mf/ac/xcmfacmb7wxiz5pfvg5m2ybyet4.jpeg"></a> <br><br>  Semua permintaan dihasilkan dalam file berikut: <br><br><ol><li>  Indeks </li><li>  Pertanyaan </li><li>  Queryengine </li><li>  ServerInfo </li></ol><br> <a href=""><img src="https://habrastorage.org/webt/ya/ox/fo/yaoxfojk1yhfujv5nhu8wxfjx64.jpeg"></a> <br><br>  Saat menghubungkan ke database dan mengirim permintaan ke DBMS, aplikasi ditandatangani sebagai berikut: <br><br><pre><code class="1c hljs">ApplicationName=‚ÄùSQLIndexManager‚Äù</code> </pre> <br>  Saat aplikasi dimulai, jendela modal terbuka untuk menambahkan koneksi: <br> <a href=""><img src="https://habrastorage.org/webt/77/kw/uh/77kwuhjmxnartbvfvmpnk8fpi7k.jpeg"></a> <br><br>  Di sini memuat daftar lengkap semua contoh MS SQL Server yang tersedia melalui jaringan lokal belum berfungsi. <br><br>  Anda juga dapat menambahkan koneksi menggunakan tombol paling kiri pada menu utama: <br><br> <a href=""><img src="https://habrastorage.org/webt/id/l0/w_/idl0w_a4afakmyqmegzbrbomksc.jpeg"></a> <br><br>  Selanjutnya, permintaan DBMS berikut akan diluncurkan: <br><br><ol><li><div class="spoiler">  <b class="spoiler_title">Memperoleh Informasi DBMS</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> ProductLevel = SERVERPROPERTY(<span class="hljs-string"><span class="hljs-string">'ProductLevel'</span></span>) , <span class="hljs-keyword"><span class="hljs-keyword">Edition</span></span> = SERVERPROPERTY(<span class="hljs-string"><span class="hljs-string">'Edition'</span></span>) , ServerVersion = SERVERPROPERTY(<span class="hljs-string"><span class="hljs-string">'ProductVersion'</span></span>) , IsSysAdmin = <span class="hljs-keyword"><span class="hljs-keyword">CAST</span></span>(IS_SRVROLEMEMBER(<span class="hljs-string"><span class="hljs-string">'sysadmin'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-built_in"><span class="hljs-built_in">BIT</span></span>)</code> </pre><br></div></div></li><li><div class="spoiler">  <b class="spoiler_title">Mendapatkan daftar database yang tersedia dengan properti singkatnya</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> DatabaseName = t.[<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>] , d.DataSize , DataUsedSize = <span class="hljs-keyword"><span class="hljs-keyword">CAST</span></span>(<span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span>) , d.LogSize , LogUsedSize = <span class="hljs-keyword"><span class="hljs-keyword">CAST</span></span>(<span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span>) , RecoveryModel = t.recovery_model_desc , LogReuseWait = t.log_reuse_wait_desc <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> sys.databases t <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span>(NOLOCK) <span class="hljs-keyword"><span class="hljs-keyword">LEFT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> [database_id] , DataSize = <span class="hljs-keyword"><span class="hljs-keyword">SUM</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">type</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CAST</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">size</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>) , LogSize = <span class="hljs-keyword"><span class="hljs-keyword">SUM</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">type</span></span>] = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CAST</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">size</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> sys.master_files <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span>(NOLOCK) <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> [database_id] ) d <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> d.[database_id] = t.[database_id] <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> t.[state] = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> t.[database_id] != <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ISNULL</span></span>(HAS_DBACCESS(t.[<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>]), <span class="hljs-number"><span class="hljs-number">1</span></span>) = <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre><br></div></div></li></ol><br>  Setelah mengeksekusi skrip di atas, sebuah jendela muncul yang berisi informasi singkat tentang database dari instance MS SQL Server yang dipilih: <br><br> <a href=""><img src="https://habrastorage.org/webt/bc/fy/gz/bcfygzsztslx32ll82uxflshfhi.jpeg"></a> <br><br>  Perlu dicatat bahwa informasi tambahan ditampilkan berdasarkan hak.  Jika ada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sysadmin</a> , maka Anda dapat memilih data dari tampilan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sys.master_files</a> .  Jika tidak ada hak seperti itu, maka lebih sedikit data yang dikembalikan agar tidak memperlambat permintaan. <br><br>  Di sini Anda perlu memilih basis data yang menarik dan klik tombol "OK". <br><br>  Selanjutnya, skrip berikut akan dieksekusi untuk setiap database yang dipilih untuk menganalisis status indeks: <br><br><div class="spoiler">  <b class="spoiler_title">Analisis Status Indeks</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">declare</span></span> @Fragmentation <span class="hljs-built_in"><span class="hljs-built_in">float</span></span>=<span class="hljs-number"><span class="hljs-number">15</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">declare</span></span> @MinIndexSize <span class="hljs-built_in"><span class="hljs-built_in">bigint</span></span>=<span class="hljs-number"><span class="hljs-number">768</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">declare</span></span> @MaxIndexSize <span class="hljs-built_in"><span class="hljs-built_in">bigint</span></span>=<span class="hljs-number"><span class="hljs-number">1048576</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">declare</span></span> @PreDescribeSize <span class="hljs-built_in"><span class="hljs-built_in">bigint</span></span>=<span class="hljs-number"><span class="hljs-number">32768</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> NOCOUNT <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> ARITHABORT <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> NUMERIC_ROUNDABORT <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> OBJECT_ID(<span class="hljs-string"><span class="hljs-string">'tempdb.dbo.#AllocationUnits'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DROP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-comment"><span class="hljs-comment">#AllocationUnits CREATE TABLE #AllocationUnits ( ContainerID BIGINT PRIMARY KEY , ReservedPages BIGINT NOT NULL , UsedPages BIGINT NOT NULL ) INSERT INTO #AllocationUnits (ContainerID, ReservedPages, UsedPages) SELECT [container_id] , SUM([total_pages]) , SUM([used_pages]) FROM sys.allocation_units WITH(NOLOCK) GROUP BY [container_id] HAVING SUM([total_pages]) BETWEEN @MinIndexSize AND @MaxIndexSize IF OBJECT_ID('tempdb.dbo.#ExcludeList') IS NOT NULL DROP TABLE #ExcludeList CREATE TABLE #ExcludeList (ID INT PRIMARY KEY) INSERT INTO #ExcludeList SELECT [object_id] FROM sys.objects WITH(NOLOCK) WHERE [type] IN ('V', 'U') AND ( [is_ms_shipped] = 1 ) IF OBJECT_ID('tempdb.dbo.#Partitions') IS NOT NULL DROP TABLE #Partitions SELECT [object_id] , [index_id] , [partition_id] , [partition_number] , [rows] , [data_compression] INTO #Partitions FROM sys.partitions WITH(NOLOCK) WHERE [object_id] &gt; 255 AND [rows] &gt; 0 AND [object_id] NOT IN (SELECT * FROM #ExcludeList) IF OBJECT_ID('tempdb.dbo.#Indexes') IS NOT NULL DROP TABLE #Indexes CREATE TABLE #Indexes ( ObjectID INT NOT NULL , IndexID INT NOT NULL , IndexName SYSNAME NULL , PagesCount BIGINT NOT NULL , UnusedPagesCount BIGINT NOT NULL , PartitionNumber INT NOT NULL , RowsCount BIGINT NOT NULL , IndexType TINYINT NOT NULL , IsAllowPageLocks BIT NOT NULL , DataSpaceID INT NOT NULL , DataCompression TINYINT NOT NULL , IsUnique BIT NOT NULL , IsPK BIT NOT NULL , FillFactorValue INT NOT NULL , IsFiltered BIT NOT NULL , PRIMARY KEY (ObjectID, IndexID, PartitionNumber) ) INSERT INTO #Indexes SELECT ObjectID = i.[object_id] , IndexID = i.index_id , IndexName = i.[name] , PagesCount = a.ReservedPages , UnusedPagesCount = CASE WHEN ABS(a.ReservedPages - a.UsedPages) &gt; 32 THEN a.ReservedPages - a.UsedPages ELSE 0 END , PartitionNumber = p.[partition_number] , RowsCount = ISNULL(p.[rows], 0) , IndexType = i.[type] , IsAllowPageLocks = i.[allow_page_locks] , DataSpaceID = i.[data_space_id] , DataCompression = p.[data_compression] , IsUnique = i.[is_unique] , IsPK = i.[is_primary_key] , FillFactorValue = i.[fill_factor] , IsFiltered = i.[has_filter] FROM #AllocationUnits a JOIN #Partitions p ON a.ContainerID = p.[partition_id] JOIN sys.indexes i WITH(NOLOCK) ON i.[object_id] = p.[object_id] AND p.[index_id] = i.[index_id] WHERE i.[type] IN (0, 1, 2, 5, 6) AND i.[object_id] &gt; 255 DECLARE @files TABLE (ID INT PRIMARY KEY) INSERT INTO @files SELECT DISTINCT [data_space_id] FROM sys.database_files WITH(NOLOCK) WHERE [state] != 0 AND [type] = 0 IF @@ROWCOUNT &gt; 0 BEGIN DELETE FROM i FROM #Indexes i LEFT JOIN sys.destination_data_spaces dds WITH(NOLOCK) ON i.DataSpaceID = dds.[partition_scheme_id] AND i.PartitionNumber = dds.[destination_id] WHERE ISNULL(dds.[data_space_id], i.DataSpaceID) IN (SELECT * FROM @files) END DECLARE @DBID INT , @DBNAME SYSNAME SET @DBNAME = DB_NAME() SELECT @DBID = [database_id] FROM sys.databases WITH(NOLOCK) WHERE [name] = @DBNAME IF OBJECT_ID('tempdb.dbo.#Fragmentation') IS NOT NULL DROP TABLE #Fragmentation CREATE TABLE #Fragmentation ( ObjectID INT NOT NULL , IndexID INT NOT NULL , PartitionNumber INT NOT NULL , Fragmentation FLOAT NOT NULL , PRIMARY KEY (ObjectID, IndexID, PartitionNumber) ) INSERT INTO #Fragmentation (ObjectID, IndexID, PartitionNumber, Fragmentation) SELECT i.ObjectID , i.IndexID , i.PartitionNumber , r.[avg_fragmentation_in_percent] FROM #Indexes i CROSS APPLY sys.dm_db_index_physical_stats(@DBID, i.ObjectID, i.IndexID, i.PartitionNumber, 'LIMITED') r WHERE i.PagesCount &lt;= @PreDescribeSize AND r.[index_level] = 0 AND r.[alloc_unit_type_desc] = 'IN_ROW_DATA' AND i.IndexType IN (0, 1, 2) IF OBJECT_ID('tempdb.dbo.#Columns') IS NOT NULL DROP TABLE #Columns CREATE TABLE #Columns ( ObjectID INT NOT NULL , ColumnID INT NOT NULL , ColumnName SYSNAME NULL , SystemTypeID TINYINT NULL , IsSparse BIT , IsColumnSet BIT , MaxLen INT , PRIMARY KEY (ObjectID, ColumnID) ) INSERT INTO #Columns SELECT ObjectID = [object_id] , ColumnID = [column_id] , ColumnName = [name] , SystemTypeID = [system_type_id] , IsSparse = [is_sparse] , IsColumnSet = [is_column_set] , MaxLen = [max_length] FROM sys.columns WITH(NOLOCK) WHERE [object_id] IN (SELECT DISTINCT i.ObjectID FROM #Indexes i) IF OBJECT_ID('tempdb.dbo.#IndexColumns') IS NOT NULL DROP TABLE #IndexColumns CREATE TABLE #IndexColumns ( ObjectID INT NOT NULL , IndexID INT NOT NULL , OrderID INT NOT NULL , ColumnID INT NOT NULL , IsIncluded BIT NOT NULL , PRIMARY KEY (ObjectID, IndexID, ColumnID) ) INSERT INTO #IndexColumns SELECT ObjectID = [object_id] , IndexID = [index_id] , OrderID = CASE WHEN [is_included_column] = 0 THEN [key_ordinal] ELSE [index_column_id] END , ColumnID = [column_id] , IsIncluded = ISNULL([is_included_column], 0) FROM sys.index_columns ic WITH(NOLOCK) WHERE EXISTS( SELECT * FROM #Indexes i WHERE i.ObjectID = ic.[object_id] AND i.IndexID = ic.[index_id] AND i.IndexType IN (1, 2) ) IF OBJECT_ID('tempdb.dbo.#Lob') IS NOT NULL DROP TABLE #Lob CREATE TABLE #Lob ( ObjectID INT NOT NULL , IndexID INT NOT NULL , IsLobLegacy BIT , IsLob BIT , PRIMARY KEY (ObjectID, IndexID) ) INSERT INTO #Lob (ObjectID, IndexID, IsLobLegacy, IsLob) SELECT c.ObjectID , IndexID = ISNULL(i.IndexID, 1) , IsLobLegacy = MAX(CASE WHEN c.SystemTypeID IN (34, 35, 99) THEN 1 END) , IsLob = 0 FROM #Columns c LEFT JOIN #IndexColumns i ON c.ObjectID = i.ObjectID AND c.ColumnID = i.ColumnID WHERE c.SystemTypeID IN (34, 35, 99) GROUP BY c.ObjectID , i.IndexID IF OBJECT_ID('tempdb.dbo.#Sparse') IS NOT NULL DROP TABLE #Sparse CREATE TABLE #Sparse (ObjectID INT PRIMARY KEY) INSERT INTO #Sparse SELECT DISTINCT ObjectID FROM #Columns WHERE IsSparse = 1 OR IsColumnSet = 1 IF OBJECT_ID('tempdb.dbo.#AggColumns') IS NOT NULL DROP TABLE #AggColumns CREATE TABLE #AggColumns ( ObjectID INT NOT NULL , IndexID INT NOT NULL , IndexColumns NVARCHAR(MAX) , IncludedColumns NVARCHAR(MAX) , PRIMARY KEY (ObjectID, IndexID) ) INSERT INTO #AggColumns SELECT t.ObjectID , t.IndexID , IndexColumns = STUFF(( SELECT ', [' + c.ColumnName + ']' FROM #IndexColumns i JOIN #Columns c ON i.ObjectID = c.ObjectID AND i.ColumnID = c.ColumnID WHERE i.ObjectID = t.ObjectID AND i.IndexID = t.IndexID AND i.IsIncluded = 0 ORDER BY i.OrderID FOR XML PATH(''), TYPE).value('(./text())[1]', 'NVARCHAR(MAX)'), 1, 2, '') , IncludedColumns = STUFF(( SELECT ', [' + c.ColumnName + ']' FROM #IndexColumns i JOIN #Columns c ON i.ObjectID = c.ObjectID AND i.ColumnID = c.ColumnID WHERE i.ObjectID = t.ObjectID AND i.IndexID = t.IndexID AND i.IsIncluded = 1 ORDER BY i.OrderID FOR XML PATH(''), TYPE).value('(./text())[1]', 'NVARCHAR(MAX)'), 1, 2, '') FROM ( SELECT DISTINCT ObjectID, IndexID FROM #Indexes WHERE IndexType IN (1, 2) ) t SELECT i.ObjectID , i.IndexID , i.IndexName , ObjectName = o.[name] , SchemaName = s.[name] , i.PagesCount , i.UnusedPagesCount , i.PartitionNumber , i.RowsCount , i.IndexType , i.IsAllowPageLocks , u.TotalWrites , u.TotalReads , u.TotalSeeks , u.TotalScans , u.TotalLookups , u.LastUsage , i.DataCompression , f.Fragmentation , IndexStats = STATS_DATE(i.ObjectID, i.IndexID) , IsLobLegacy = ISNULL(lob.IsLobLegacy, 0) , IsLob = ISNULL(lob.IsLob, 0) , IsSparse = CAST(CASE WHEN p.ObjectID IS NULL THEN 0 ELSE 1 END AS BIT) , IsPartitioned = CAST(CASE WHEN dds.[data_space_id] IS NOT NULL THEN 1 ELSE 0 END AS BIT) , FileGroupName = fg.[name] , i.IsUnique , i.IsPK , i.FillFactorValue , i.IsFiltered , a.IndexColumns , a.IncludedColumns FROM #Indexes i JOIN sys.objects o WITH(NOLOCK) ON o.[object_id] = i.ObjectID JOIN sys.schemas s WITH(NOLOCK) ON s.[schema_id] = o.[schema_id] LEFT JOIN #AggColumns a ON a.ObjectID = i.ObjectID AND a.IndexID = i.IndexID LEFT JOIN #Sparse p ON p.ObjectID = i.ObjectID LEFT JOIN #Fragmentation f ON f.ObjectID = i.ObjectID AND f.IndexID = i.IndexID AND f.PartitionNumber = i.PartitionNumber LEFT JOIN ( SELECT ObjectID = [object_id] , IndexID = [index_id] , TotalWrites = NULLIF([user_updates], 0) , TotalReads = NULLIF([user_seeks] + [user_scans] + [user_lookups], 0) , TotalSeeks = NULLIF([user_seeks], 0) , TotalScans = NULLIF([user_scans], 0) , TotalLookups = NULLIF([user_lookups], 0) , LastUsage = ( SELECT MAX(dt) FROM ( VALUES ([last_user_seek]) , ([last_user_scan]) , ([last_user_lookup]) , ([last_user_update]) ) t(dt) ) FROM sys.dm_db_index_usage_stats WITH(NOLOCK) WHERE [database_id] = @DBID ) u ON i.ObjectID = u.ObjectID AND i.IndexID = u.IndexID LEFT JOIN #Lob lob ON lob.ObjectID = i.ObjectID AND lob.IndexID = i.IndexID LEFT JOIN sys.destination_data_spaces dds WITH(NOLOCK) ON i.DataSpaceID = dds.[partition_scheme_id] AND i.PartitionNumber = dds.[destination_id] JOIN sys.filegroups fg WITH(NOLOCK) ON ISNULL(dds.[data_space_id], i.DataSpaceID) = fg.[data_space_id] WHERE o.[type] IN ('V', 'U') AND ( f.Fragmentation &gt;= @Fragmentation OR i.PagesCount &gt; @PreDescribeSize OR i.IndexType IN (5, 6) )</span></span></code> </pre><br></div></div><br>  Seperti yang Anda lihat dari kueri sendiri, tabel sementara sering digunakan.  Hal ini dilakukan agar tidak ada kompilasi ulang, dan dalam kasus skema besar, rencana dapat dihasilkan secara paralel saat memasukkan data, karena memasukkan dengan variabel tabel dimungkinkan hanya dalam satu aliran. <br><br>  Setelah menjalankan skrip di atas, sebuah jendela dengan tabel indeks akan muncul: <br><br> <a href=""><img src="https://habrastorage.org/webt/yd/rl/oh/ydrlohqwbtggc8n8equratfkkr0.jpeg"></a> <br><br>  Di sini Anda juga dapat menampilkan informasi terperinci lainnya, seperti: <br><br><ol><li>  sebuah database </li><li>  jumlah bagian </li><li>  tanggal dan waktu panggilan terakhir </li><li>  kompresi </li><li>  filegroup </li></ol><br>  dll. <br>  Kolom itu sendiri dapat disesuaikan: <br><br> <a href=""><img src="https://habrastorage.org/webt/7z/qw/jf/7zqwjfox2zagl5ox0oji648jnta.jpeg"></a> <br><br>  Di sel-sel kolom Fix, Anda dapat memilih tindakan apa yang akan dilakukan selama optimasi.  Juga, ketika pemindaian selesai, tindakan default dipilih berdasarkan pengaturan yang dipilih: <br><br> <a href=""><img src="https://habrastorage.org/webt/yp/c9/o2/ypc9o2ooiylu7n0pw7zbdo97tbi.jpeg"></a> <br><br>  Anda harus memilih indeks yang diinginkan untuk diproses. <br><br>  Dengan menggunakan menu utama, Anda dapat menyimpan skrip (tombol yang sama memulai proses pengoptimalan indeks itu sendiri): <br><br> <a href=""><img src="https://habrastorage.org/webt/tt/tu/fn/tttufnve3kmo_siz_d0ahcxfew8.jpeg"></a> <br><br>  simpan tabel dalam berbagai format (tombol yang sama memungkinkan Anda membuka pengaturan terperinci untuk analisis dan optimalisasi indeks): <br><br> <a href=""><img src="https://habrastorage.org/webt/tt/8w/gv/tt8wgvpzqx1cl0a1qvkdfxf1ffm.jpeg"></a> <br><br>  Juga, informasi dapat diperbarui dengan mengklik tombol ketiga di sebelah kiri di menu utama di sebelah kaca pembesar. <br><br>  Sebuah tombol dengan kaca pembesar memungkinkan Anda memilih basis data yang diinginkan untuk dipertimbangkan. <br><br>  Saat ini tidak ada sistem bantuan lengkap.  Karena itu, menekan tombol ‚Äú?‚Äù  itu hanya akan menyebabkan munculnya jendela modal yang berisi informasi dasar tentang produk perangkat lunak: <br><br> <a href=""><img src="https://habrastorage.org/webt/e5/p_/mq/e5p_mqbcsumjihbb3qnwurxyqdk.jpeg"></a> <br><br>  Selain semua hal di atas, menu utama memiliki bilah pencarian: <br><br> <a href=""><img src="https://habrastorage.org/webt/bm/1c/nn/bm1cnnxagvohdo3a4qtprhvpqbe.jpeg"></a> <br><br>  Saat memulai proses pengoptimalan indeks: <br><br> <a href=""><img src="https://habrastorage.org/webt/qn/xa/en/qnxaenzm91ifrvoc2l0aipezq5o.jpeg"></a> <br><br>  Juga di bagian bawah jendela Anda dapat melihat log tindakan yang dilakukan: <br><br> <a href=""><img src="https://habrastorage.org/webt/wc/aq/zs/wcaqzsz72m6dbuwe3bv1fxqm_3k.jpeg"></a> <br><br>  Di jendela untuk analisis terperinci dan optimalisasi indeks, Anda dapat mengonfigurasi opsi yang lebih halus: <br><br> <a href=""><img src="https://habrastorage.org/webt/kc/6x/gp/kc6xgpndlhe19ueeehpobprsomc.jpeg"></a> <br><br>  <b>Saran untuk aplikasi:</b> <br><br><ol><li>  memungkinkan pembaruan statistik selektif tidak hanya untuk indeks tetapi juga dengan cara yang berbeda (sepenuhnya diperbarui atau sebagian) </li><li>  memungkinkan tidak hanya untuk memilih database, tetapi juga server yang berbeda (ini sangat nyaman ketika ada banyak contoh MS SQL Server) </li><li>  untuk fleksibilitas yang lebih besar dalam penggunaan, diusulkan untuk membungkus perintah di perpustakaan, dan mengeluarkannya ke perintah PowerShell, seperti yang dilakukan, misalnya, di sini: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dbatools.io/commands</a> </li><li>  memungkinkan untuk menyimpan dan mengubah pengaturan pribadi baik untuk seluruh aplikasi dan, jika perlu, untuk setiap instance dari MS SQL Server dan setiap database </li><li>  dari klausa 2 dan 4 mengikuti keinginan untuk membuat grup pada database dan grup pada contoh MS SQL Server, yang pengaturannya sama </li><li>  mencari indeks duplikat (penuh dan tidak lengkap, yang sedikit berbeda atau hanya berbeda dalam kolom yang disertakan) </li><li>  Karena SQLIndexManager hanya digunakan untuk DBMS MS SQL Server, Anda perlu mencerminkan ini dalam nama, misalnya, sebagai berikut: SQLIndexManager untuk MS SQL Server </li><li>  Hapus semua bagian aplikasi dari GUI ke dalam modul terpisah dan tulis ulang menjadi .NET Core 2.1 </li></ol><br>  Pada saat penulisan, artikel 6 dari keinginan sedang dikembangkan secara aktif dan sudah ada dukungan dalam bentuk pencarian untuk duplikat lengkap dan serupa: <br><br> <a href=""><img src="https://habrastorage.org/webt/zk/bw/d3/zkbwd3hem7xtdtj_5yuqhctasac.jpeg"></a> <br><br><h3>  Sumber </h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">metode optimasi indeks adaptif</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Utilitas SQLIndexManager</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">gambaran teknis singkat dari utilitas SQLIndexManager</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">diskusi tentang utilitas SQLIndexManager</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">SQL Index Manager - Alat GUI Gratis untuk Pemeliharaan Indeks pada SQL Server dan Azure</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Analisis dan Optimasi Indeks SQL Server</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id461277/">https://habr.com/ru/post/id461277/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id461265/index.html">Tentang penyalahgunaan penggunaan sistem operasi dalam proyek untuk mikrokontroler</a></li>
<li><a href="../id461267/index.html">Teknologi Intel Baru untuk Kemasan Chip</a></li>
<li><a href="../id461269/index.html">Solusi pekerjaan dengan pwnable.kr 08 adalah leg dan 10 adalah shellshock. Assembler ARM. Kerentanan Bash</a></li>
<li><a href="../id461271/index.html">Cara mempromosikan aplikasi seluler pada 2019: 4 cara praktis + alat yang bermanfaat</a></li>
<li><a href="../id461273/index.html">Pendekatan serakah dan mesin slot. Analisis tugas ML-track kejuaraan pemrograman</a></li>
<li><a href="../id461279/index.html">Cara membuat microservice sederhana di Golang dan gRPC dan kemas menggunakan Docker</a></li>
<li><a href="../id461281/index.html">Panduan untuk menyiapkan server BIND DNS di lingkungan chroot untuk Red Hat (RHEL / CentOS) 7</a></li>
<li><a href="../id461283/index.html">Arsitektur Perangkat Lunak dan Desain Sistem: Gambaran Besar dan Panduan Sumber Daya</a></li>
<li><a href="../id461285/index.html">5 algoritma pengambilan sampel utama</a></li>
<li><a href="../id461287/index.html">Mengembangkan AI yang licik dalam permainan taktis berdasarkan heuristik dan mutasi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>