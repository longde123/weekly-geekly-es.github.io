<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëÇüèø üë®üèø‚Äçü§ù‚Äçüë®üèΩ üÜí Pro Demand Planning, Holt-Winters et XGboost üë∏üèø üë®‚Äçüç≥ üë©üèº‚Äçü§ù‚Äçüë®üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Habr, bonjour! 

 Le site contient de nombreux articles sur la pr√©vision des ventes de diverses cat√©gories de produits de grande consommation, tandis ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pro Demand Planning, Holt-Winters et XGboost</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/479308/">  Habr, bonjour! <br><br>  Le site contient de nombreux articles sur la pr√©vision des ventes de diverses cat√©gories de produits de grande consommation, tandis que d'autres cat√©gories de produits ne sont pas si populaires.  De plus, le commerce de d√©tail est g√©n√©ralement √©tudi√© avec une pr√©vision de plusieurs jours √† l'avance, mais pas un distributeur avec une pr√©vision de 2 mois √† l'avance - bien que ce dernier s'int√©resse plus souvent √† une pr√©vision qualitative que m√™me un d√©taillant.  En tant que d√©fi suppl√©mentaire, il convient de consid√©rer le conservatisme d'une partie importante des distributeurs dans le sens du choix des technologies de pr√©vision.  Il est assez facile d'imaginer la pratique de la pr√©vision des ventes interm√©diaires de l'entreprise: collecte des ventes √† partir des donn√©es de base SAP + dans l'outil Excel cr√©√© par l'homme, l'automatisation dans ces cas est limit√©e par une m√©thode de pr√©vision assez simple, qui ne va pas loin de la tendance moyenne / lin√©aire avec la science des fus√©es sous la forme de HoltWinters. <br><br>  Il se trouve que, en service, je suis tomb√© sur un fabricant d'une marque de cosm√©tiques d√©coratifs bon march√© (environ 500 SKU) et j'ai vu les tristes cons√©quences des pr√©visions prudentes sous la forme de KPI bas.  Il a fallu apporter de petits changements au syst√®me de planification, y compris le processus de pr√©vision, puis je parlerai de mes recherches. <br><a name="habracut"></a><br><h3>  Status Quo Ante Bellum </h3><br>  Le principal casse-t√™te de la marque depuis plusieurs ann√©es a √©t√© le niveau de service extr√™mement bas ( <i>CSS = Shipped / Ordered</i> ), nettement inf√©rieur √† la moyenne de l'entreprise, aggrav√© par les pr√©visions bas√©es sur les ventes moyennes ( <i>Forecast = Average sales</i> ).  Le cercle vicieux: le client commande des volumes, ne re√ßoit pas toutes les quantit√©s et la prochaine fois vient avec une demande accrue, et nous ne planifions l'avenir qu'en fonction du besoin satisfait. <br><br>  Sur cette base, il a √©t√© d√©cid√© de ne pas pr√©voir les ventes, mais les commandes effac√©es des r√©p√©titions (c'est-√†-dire si le client veut 100 pi√®ces et commandes chaque semaine, nous supposons que la demande par mois est de 100 pi√®ces, pas 400), alors ici d'autres ventes, nous appellerons les commandes d√©barrass√©es des doublons.  Apr√®s avoir am√©lior√© le niveau de service, la diff√©rence entre les termes est nivel√©e.  L'entreprise utilise la formule ( <i>pr√©cision des pr√©visions = (1 - somme des modules des √©carts entre les faits et les pr√©visions) / pr√©visions</i> ) pour estimer la pr√©cision des pr√©visions dans l'entreprise, et nous l'utiliserons.  Un point important: la pr√©vision dans ce cas est une pr√©vision avec un d√©calage de 2, c'est-√†-dire  si nous √©valuons l'exactitude en octobre, nous comparons les ventes d'octobre avec les pr√©visions faites en ao√ªt.  On pense qu'un r√©sultat sup√©rieur √† 35% peut √™tre interpr√©t√© comme satisfaisant.  Soit dit en passant, il convient de noter ici que nous ne nous attendions pas, en fait, √† une augmentation de la pr√©cision au d√©but - nous nous attendions √† une augmentation du niveau de service et nous √©valuerons les r√©sultats sur la base de la qualit√© des exp√©ditions de marchandises aux clients. <br><br>  Je n'ai pas eu √† transpirer beaucoup sur l'√©chantillon pour la formation - bien que la soci√©t√© ne dispose pas d'un DWH analytique, mais il y a un t√©l√©chargement de commandes par mois, qu'un petit cycle Python a collect√© et effac√©.  De m√™me, nous avons obtenu des donn√©es de base.  Les √©v√©nements et les promotions devaient √™tre ignor√©s dans les calculs en raison d'un bruit excessif (nous avions peur d'ajouter plus de bruit que d'informations utiles), car le plus grand d√©taillant effectuait p√©riodiquement des promotions sans accord ni pr√©avis, estimait le volume des √©v√©nements, etc. <br><br>  Comme mod√®le, nous avons d√©cid√© d'utiliser 3 branches - na√Øve, lissage exponentiel et apprentissage machine. <br><br><h3>  Pr√©vision na√Øve </h3><br>  La principale raison pour laquelle les pr√©visions na√Øves sont toujours utilis√©es est la facilit√© d'interpr√©tation pour les humains.  En effet, s'il est habituel pour une entreprise d'analyser chaque code en d√©tail, en utilisant la m√©thodologie 5 Why, alors la pr√©vision moyenne s'ajuste parfaitement.  Le client commande-t-il en moyenne 10 pi√®ces par mois?  Il est logique qu'il commandera 10 pi√®ces le mois prochain.  Le r√©sultat n'est pas ce que nous attendions et le client a command√© 50 pi√®ces?  Probablement, le client ne sait tout simplement pas comment pr√©dire / la commande automatique est cass√©e / le robot est furieux, etc., vous devez impl√©menter Joint Forecasting et √©changer des fichiers afin de soulager le stress et d'am√©liorer la pr√©cision des pr√©visions (bien s√ªr, une blague, mais avec une certaine v√©rit√©). <br><br>  Pour ajouter un peu de pertinence aux m√©thodes, nous avons sugg√©r√© que la saisonnalit√© des marchandises est identique √† la saisonnalit√© de la cat√©gorie (le package statmodels a √©t√© utilis√© pour identifier la saisonnalit√©, la photo montre 3 r√©sultats principaux). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f31/5d1/a69/f315d1a692d08a1ea53b3b83fd839eba.png" alt="image"><br><br>  Nous avons retenu 4 m√©thodes: la moyenne et la m√©diane pour l'ensemble de l'historique des ventes (pr√©cision 0,32 et 0,30 respectivement) et les 6 derniers points (0,36 et 0,26).  0,36 sera notre r√©f√©rence - √† l'avenir, nous devons obtenir de meilleurs r√©sultats. <br><br><h3>  Pr√©vision ESM </h3><br>  Le lissage exponentiel est souvent le r√™ve ultime de la planification de la demande et il est facile de comprendre pourquoi.  Les estimations de la pr√©cision du front montrent les r√©sultats les moins comparables pour ESM et ML en termes de pr√©cision, elles sont incluses dans tous les syst√®mes de pr√©vision industrielle (JDA, Oracle RDF, etc.), le calcul est plus rapide et plus facile √† interpr√©ter - c'est pourquoi les classiques sont plus vivants que tous les √™tres vivants.  En revanche, le r√©sultat peut ne pas √™tre enti√®rement honn√™te en raison d'une pr√©paration insuffisante des fonctionnalit√©s. <br><br>  Pour les pr√©visions, nous avons utilis√© le m√™me package statmodels.  Pour commencer, nous avons pris la classe Holt pour l'ensemble de l'historique des ventes avec une saisonnalit√© de groupe effac√©e et pour les 6 derniers points (pr√©cision 0,34 et 0,37). <br><br>  Ensuite, nous avons divis√© SKU en 2 groupes - les produits avec une longue histoire ont √©t√© pr√©dits par la classe HoltWinters, et pour une courte histoire, nous avons laiss√© Holt √† 6 points.  Le r√©sultat √©tait bien meilleur - 0,44, cela s'explique facilement.  Si au niveau sup√©rieur, il semble que tous les produits soient des fr√®res jumeaux, alors, en descendant dans la sous-cat√©gorie, nous pouvons voir les diff√©rences. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5dc/f82/5d0/5dcf825d060be8999bc8b4aec199324f.png" alt="image"><br><br><h3>  ML Forecasting </h3><br>  Le principal inconv√©nient des m√©thodes standard est le manque de profondeur des calculs, car  nous n'utilisons pas toutes les informations disponibles.  Par exemple, l'historique des √©v√©nements: g√©n√©ralement, dans l'approche classique, nous devons soustraire les tuyaux qui se sont produits de l'historique, faire une pr√©vision de base et ajouter les tuyaux pr√©vus avec le calendrier appropri√©.  Dans le cas d'un enregistrement des √©v√©nements insuffisamment pr√©cis, le r√©sultat peut √™tre d√©cevant (dans le cas de Holt-Winters, nous avons r√©ussi √† obtenir une pr√©cision de 5 pp).  De nombreuses raisons peuvent √™tre pr√©sent√©es - par exemple, les cat√©gories KAM sous-estiment les volumes afin de montrer un exc√®s de satisfaction et de recevoir des bonus.  Si nous passons de l'approche ( <i>Forecast = Baseline + Pipes</i> ) √† une pr√©vision bas√©e sur des fonctionnalit√©s, nous pourrons ajouter une partie des informations √† notre disposition.  Pour ce faire, nous avons compil√© une liste de 50 fonctionnalit√©s (prix, donn√©es de base, ventes, clients fractionn√©s, etc.).  De la biblioth√®que Sklearn, nous avons pris la base Lasso / Ridge / KNN Regressor, qui donne souvent une victoire rapide, mais dans notre cas, seul KNN √©tait satisfait d'une pr√©cision de 0,44.  Une for√™t al√©atoire a de bonnes performances dans de petits √©chantillons, dans notre cas, la pr√©cision est de 0,48.  Eh bien, bien s√ªr, nous n'avons pas oubli√© Xgboost, qui apr√®s un peu de validation crois√©e a produit le meilleur r√©sultat - 0,51.  Voici un graphique avec la pr√©cision de chaque mod√®le <br><br><img src="https://habrastorage.org/getpro/habr/post_images/83a/fbf/2bb/83afbf2bb6c89ddb0bb16ea900bb6c5b.png" alt="image"><br><br><h3>  Pr√©occupations </h3><br>  Que peuvent √™tre les conservateurs concernant l'utilisation du ML dans la pr√©vision des ventes?  Par exemple, la r√©troaction: un certain nombre de d√©taillants ecom et hors ligne utilisent des r√©seaux de neurones et une augmentation du gradient et vous font p√©riodiquement peur avec des commandes folles.  Oui, bien s√ªr, si le d√©taillant mesurera l'exactitude des pr√©visions, le r√©sultat peut √™tre optimiste, mais il s'agit dans une certaine mesure d'une proph√©tie auto-r√©alisatrice: s'il y a une erreur, la vente / le vendredi noir / l'anniversaire du r√©seau est activ√©, etc. <br><br>  Par cons√©quent, il est important pour nous de montrer que le r√©sultat de Xgboost est non seulement plus pr√©cis, mais aussi plus stable (et non la roulette al√©atoire, comme un planeur non pr√©par√© peut sembler).  Pour ce faire, nous avons compar√© la distribution des distributions d'erreur HoltWinters et Xgboost et veill√© √† ce que les r√©sultats de ces derniers aient un centre plus dense autour de z√©ro et √† queue claire <br><br><img src="https://habrastorage.org/getpro/habr/post_images/622/6b4/b9e/6226b4b9ee71a1edf023f28aab80f628.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/68b/6c4/62c/68b6c462c43a9d240b5ab42acbf4eb45.png" alt="image"><br><br><h3>  R√©sultats interm√©diaires </h3><br>  Depuis le d√©but de la r√©daction de l'article / pr√©visions de premi√®re ex√©cution, 2 autres marques de cosm√©tiques d√©coratifs ont √©t√© transf√©r√©es vers Xgboost, en raison de r√©sultats positifs.  Fin novembre, l'augmentation moyenne du niveau de service √©tait de + 16%, soit  le niveau moyen de l'entreprise a √©t√© atteint <br><br><div class="scrollable-table"><table><tbody><tr><th>  Marque </th><th>  Novembre SL FY19 </th><th>  Novembre SL FY20 </th><th>  SL Delta </th></tr><tr><td>  Marque1 </td><td>  73% </td><td>  89% </td><td>  16% </td></tr><tr><td>  Marque2 </td><td>  80% </td><td>  85% </td><td>  5% </td></tr><tr><td>  Marque3 </td><td>  63% </td><td>  93% </td><td>  30% </td></tr><tr><td>  Total </td><td>  73% </td><td>  89% </td><td>  16% </td></tr></tbody></table></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr479308/">https://habr.com/ru/post/fr479308/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr479298/index.html">Antipatterns PostgreSQL: CTE x CTE</a></li>
<li><a href="../fr479300/index.html">√âcologie et centres de donn√©es. Comme en Russie et √† l'√©tranger, les ¬´donn√©es vertes¬ª</a></li>
<li><a href="../fr479302/index.html">Unity Shader Graph Basics</a></li>
<li><a href="../fr479304/index.html">Conteneurs √©ph√©m√®res Kubernetes Premiers pas</a></li>
<li><a href="../fr479306/index.html">PHP Digest n ¬∞ 169 (26 novembre - 9 d√©cembre 2019)</a></li>
<li><a href="../fr479310/index.html">Comment programmer 1C pour devenir d√©veloppeur Java</a></li>
<li><a href="../fr479312/index.html">Cr√©ation d'un serveur incr√©mentiel pour iOS Team</a></li>
<li><a href="../fr479316/index.html">Bus d'int√©gration pour Bank SOYUZ (AO): conception et auto-test</a></li>
<li><a href="../fr479318/index.html">CLion 2019.3 est arriv√©! Am√©lioration de la vitesse de l'√©diteur et des nouvelles fonctionnalit√©s les plus attendues</a></li>
<li><a href="../fr479320/index.html">Num√©ro 28: Formation informatique - probl√®mes et d√©fis actuels des grandes entreprises</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>