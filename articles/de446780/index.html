<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßú üç¶ üë®üèΩ Wie man ein dunkles Thema erstellt und nicht schadet. Yandex.Mail Team Erfahrung üëâüèΩ üë©üèæ üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mein Name ist Vladimir, ich bin mit einem mobilen Frontend in Yandex.Mail besch√§ftigt. In unserer Anwendung gab es bereits ein dunkles Thema, aber nic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie man ein dunkles Thema erstellt und nicht schadet. Yandex.Mail Team Erfahrung</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/446780/"><p><img src="https://habrastorage.org/webt/ji/4q/pr/ji4qprfkpuotssmzabus4cjflrq.png"></p><br><p>  Mein Name ist Vladimir, ich bin mit einem mobilen Frontend in Yandex.Mail besch√§ftigt.  In unserer Anwendung gab es bereits ein dunkles Thema, aber nicht genug: Wir konnten die Benutzeroberfl√§che und einfache Buchstaben neu streichen.  Aber formatierte Buchstaben blieben hell und kontrastierten mit einer dunklen Oberfl√§che, die meine Augen nachts m√ºde machen k√∂nnte. </p><br><p>  Heute werde ich den Lesern von Habr erz√§hlen, wie wir dieses Problem gel√∂st haben.  Sie lernen zwei einfache Methoden kennen, die uns nicht gepasst haben - unsere Hauptmethode f√ºr das adaptive Neulackieren von Seiten und schlie√ülich die Richtung f√ºr die n√§chste Iteration: das Neulackieren von Bildern.  Obwohl die Aufgabe selbst - das Neulackieren von Seiten mit beliebiger Formatierung - spezifisch ist, denke ich, dass unsere Erfahrung auch f√ºr Sie n√ºtzlich sein wird. </p><a name="habracut"></a><br><h2 id="prostye-sposoby">  Einfache Wege </h2><br><p>  Bevor wir zu unserem magischen ‚ÄûRepainter‚Äú kommen, haben wir zwei einfache Optionen wie einen Korken ausprobiert: H√§ngen Sie einen zus√§tzlichen dunklen Stil oder einen CSS-Filter an das Element.  Sie passten nicht zu uns, aber vielleicht sind sie in einigen F√§llen sogar noch besser (weil es einfach = cool ist). </p><br><h3 id="pereopredelenie-stiley">  Stile √ºberschreiben </h3><br><p>  Der einfachste Weg, das dunkle Thema der Anwendung selbst in CSS logisch zu erweitern: Wir h√§ngen dunkle Stile an einen Container f√ºr Buchstaben (im Allgemeinen f√ºr den Inhalt einer anderen Person, der neu gestrichen werden muss): </p><br><pre><code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.message--dark</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-color</span></span>: black; <span class="hljs-attribute"><span class="hljs-attribute">color</span></span>: white; }</code> </pre> <br><p>  Wenn die Elemente im Buchstaben jedoch ihre eigenen Stile haben, definieren sie unseren Stammstil neu.  Nein <code>!important</code> wird nicht helfen.  Sie k√∂nnen eine Idee quetschen, indem Sie die Vererbung abhacken: </p><br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.message--dark</span></span> * { <span class="hljs-attribute"><span class="hljs-attribute">background-color</span></span>: black <span class="hljs-meta"><span class="hljs-meta">!important</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">color</span></span>: white <span class="hljs-meta"><span class="hljs-meta">!important</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">border-color</span></span>: <span class="hljs-number"><span class="hljs-number">#333</span></span> <span class="hljs-meta"><span class="hljs-meta">!important</span></span>; }</code> </pre> <br><p>  In diesem Fall k√∂nnen Sie nicht darauf verzichten <code>!important</code> , da der Selektor selbst nicht sehr spezifisch ist.  Dar√ºber hinaus m√ºssen Inline-Stile neu definiert werden (und Inline-Stile mit <code>!important</code> wird trotzdem gecrawlt, es ist nichts zu tun). </p><br><p>  Unser Stil ist ziemlich ungeschickt und f√§rbt alles gleich, daher kommt ein weiteres Problem heraus: Wahrscheinlich wollte der Designer etwas sagen, indem er Farben (Elementpriorit√§ten und andere Designer-Dinge) arrangierte, aber wir haben diese ganze Idee aufgegriffen und verworfen. </p><br><p><img src="https://habrastorage.org/webt/cu/-1/ka/cu-1kav8ydvyjxlobshlklgio9u.png"></p><br><p>  Wenn Sie Designer weniger respektieren als ich und sich dennoch f√ºr diese Methode entscheiden, vergessen Sie nicht, nicht offensichtliche Kleinigkeiten zu beenden: </p><br><ul><li>  <code>box-shadow</code> - nur die Farbe kann nicht neu definiert werden, Sie m√ºssen alle Schatten entfernen oder mit hellen leben. </li><li>  Farben semantischer Elemente - Links, Eingabeelemente. </li><li>  Inline-SVG - anstelle des <code>background</code> m√ºssen die <code>fill</code> und anstelle des <code>stroke</code> werden. Dies ist jedoch nicht genau, je nachdem, welches SVG es sein kann, und umgekehrt. </li></ul><br><p>  Technisch gesehen ist die Methode nicht schlecht: Dies sind drei Codezeilen (okay, drei√üig f√ºr die Produktions-Redi-Version mit Eckf√§llen), Kompatibilit√§t mit allen Browsern der Welt, sofort einsatzbereite Verarbeitung dynamischer Seiten und keine Bindung an die Art und Weise, wie Stile im Originaldokument verbunden werden.  Ein besonderer Bonus ist, dass Sie die Farben im Stil einfach so anpassen k√∂nnen, dass sie zur Hauptanwendung passen (z. B. Hintergrund <code>#bbbbb8</code> anstelle von Schwarz). </p><br><p>  √úbrigens haben wir Buchstaben auf diese Weise neu gestrichen, aber wenn wir Stile im Buchstaben fanden, hatten wir Angst und lie√üen das Buchstabenlicht. </p><br><h3 id="css-filtr">  CSS-Filter </h3><br><p>  Sehr witzige und elegante Option.  Sie k√∂nnen die Seite mit einem CSS-Filter neu malen: </p><br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.message--dark</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">filter</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">invert</span></span>(100) <span class="hljs-built_in"><span class="hljs-built_in">hue-rotate</span></span>(180deg); <span class="hljs-comment"><span class="hljs-comment">/* hue-rotate    */</span></span> }</code> </pre> <br><p>  Danach werden die Fotos gruselig, aber es spielt keine Rolle - wir werden sie wieder neu streichen: </p><br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.message-dark</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">img</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">filter</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">invert</span></span>(100) <span class="hljs-built_in"><span class="hljs-built_in">hue-rotate</span></span>(180deg); }</code> </pre> <br><p><img src="https://habrastorage.org/webt/dr/3a/ix/dr3aix8opihd2nlq6oqzjfbdtvs.png"></p><br><p>  Es gibt immer noch Probleme mit Inhaltsbildern, die √ºber den <code>background</code> gebunden sind (wir wissen, dass es bequemer ist, das Seitenverh√§ltnis anzupassen, aber was ist mit der Semantik?).  Angenommen, wir k√∂nnen alle diese Elemente finden, explizit markieren und neu streichen. </p><br><p>  Die Methode ist insofern gut, als sie das urspr√ºngliche Verh√§ltnis von Helligkeit und Kontrasten beibeh√§lt.  Auf der anderen Seite gibt es viele Probleme, die die Vorteile eher √ºberwiegen: </p><br><p><img src="https://habrastorage.org/webt/ed/qe/h1/edqeh1dpkqv-w2gydobzojuaia0.png" width="300"></p><br><ol><li>  Dunkle Seiten werden heller. </li><li>  Die resultierenden Farben k√∂nnen nicht gesteuert werden. <code>#bbbbb8</code> Filter muss angewendet werden, um den Hintergrund f√ºr Ihre Unternehmensnummer <code>#bbbbb8</code> ?  Das R√§tsel. </li><li>  Nach zwei Neulackierungen verblassen die Bilder. </li><li>  Alles verlangsamt sich (insbesondere auf Telefonen) - es ist logisch, dass der Browser anstelle eines einfachen Renderns die Bildverarbeitung auf jedem Bildschirm steuern muss. </li></ol><br><p>  Diese Methode w√§re f√ºr Buchstaben geeignet, die aus Text in neutralen T√∂nen bestehen. Aber wer sind diese √Ñsthetiker, die einen vollst√§ndigen Posteingang mit solch eigenartigen Inhalten erhalten?  Filter k√∂nnen jedoch Elemente neu streichen, auf deren Inhalt nicht zugegriffen werden kann - Frames, Webkomponenten, Bilder. </p><br><h2 id="adaptivnaya-tema">  Responsive Theme </h2><br><p>  Es ist Zeit f√ºr Magie!  Aus den M√§ngeln der ersten beiden Ans√§tze sammeln wir eine Checkliste: </p><br><ol><li>  Machen Sie den Hintergrund dunkel, den Text hell, die R√§nder mittel. </li><li>  Identifizieren Sie bereits dunkle Seiten und streichen Sie sie nicht neu. </li><li>  Behalten Sie das urspr√ºngliche Verh√§ltnis von Helligkeit und Kontrast bei. </li><li>  Geben Sie die M√∂glichkeit, Farben anzupassen. </li><li>  Lassen Sie die T√∂ne wie am Anfang. </li></ol><br><p>  Wir m√ºssen die Farben der Stile √§ndern, damit der Hintergrund dunkel ist.  Und warum nicht buchst√§blich?  Wir nehmen einfach alle Stile, suchen nach den Regeln f√ºr die Farben ( <code>color</code> , <code>background</code> , Rahmen, <code>box-shadow</code> , deren Untereigenschaften) und ersetzen sie durch ‚Äûabgedunkelt‚Äú - verdunkeln Sie den Hintergrund, hellen Sie den Text auf, verdunkeln Sie die R√§nder weniger als den Hintergrund usw. </p><br><p>  Diese Methode hat einen unglaublichen Vorteil, der die Seele eines jeden Entwicklers w√§rmt.  Jede Eigenschaft kann konfiguriert werden (ja, direkt mit einem Code beschreiben!). Ihre eigenen Regeln f√ºr die Farbkonvertierung.  Mit ausreichender Vorstellungskraft k√∂nnen Sie in jedes externe Thema integrieren, Farbkorrekturen vornehmen (z. B. helle oder graubraune Himbeeren anstelle eines dunklen Themas) und sogar einen kleinen Kontext hinzuf√ºgen - beispielsweise breite und schmale R√§nder unterschiedlich behandeln. </p><br><p>  Nachteile sind Standard f√ºr alles in js.  Ja, wir f√ºhren Skripte aus, unterbrechen die Kapselung von Stilen und analysieren CSS-Regexp.  Nun, im Gegensatz zu HTML ist letzteres nicht so besch√§mend, weil die CSS-Grammatik (der von uns ben√∂tigten Ebene) immer noch regelm√§√üig ist. </p><br><p>  Der Neulackierungsplan lautet wie folgt: </p><br><ol><li>  Wir normalisieren die Legacy-Eigenschaften des Stils ( <code>bgcolor</code> und friends) und verschieben sie in <code>style="..."</code> . </li><li>  Hier finden Sie alle Inline-Stile. </li><li>  In jedem Stil finden wir alle Farbregeln ( <code>background-color</code> , <code>color</code> , <code>box-shadow</code> usw.). </li><li>  Aus allen Farbregeln erhalten wir die Farben, wir finden den gew√ºnschten Konverter (Dunkler f√ºr den Hintergrund, Kl√§rer f√ºr Text). </li><li>  Wir nennen den Konverter. </li><li>  Zur√ºcksetzen der konvertierten Regeln in CSS. </li></ol><br><p>  Die Bindung (Normalisierung, Stilsuche, Analyse) ist recht einfach.  Wir werden herausfinden, wie genau unser magischer <em>Konverter</em> funktioniert. </p><br><h3 id="hsl-preobrazovaniya">  HSL-Konvertierungen </h3><br><p>  "Dimmen der Farbe" ist keine so einfache Aktion, wie es scheint, besonders wenn wir den Ton beibehalten m√∂chten (Cyan wird dunkelblau, nicht orange).  Dies kann in normalem RGB erfolgen, ist jedoch problematisch.  Fans des algorithmischen Designs wissen, dass selbst die Farbverl√§ufe dort schief sind.  Die Arbeit mit Farben in HSL ist jedoch ein reines Vergn√ºgen: Anstelle von Rot, Gr√ºn und Blau, bei denen nicht klar ist, was zu tun ist, haben wir drei weitere Kan√§le: </p><br><ul><li>  Der Farbton ist genau der Ton, den wir beibehalten m√∂chten. </li><li>  Saturaion - S√§ttigung, die uns jetzt nicht sehr wichtig ist. </li><li>  Helligkeit - die Helligkeit, die wir √§ndern werden. </li></ul><br><p>  Es ist zweckm√§√üig, sich einen solchen Raum in Form eines Zylinders vorzustellen.  Und unsere Aufgabe ist es, diesen Zylinder auf den Kopf zu stellen.  Die Farbkorrekturfunktionen machen so etwas wie <code>(h, s, l) =&gt; [h, s, 1 - l]</code> . </p><br><h3 id="cveta-s-kotorymi-i-tak-vsyo-horosho">  Die Farben, mit denen alles gut ist </h3><br><p>  Manchmal ist die Situation erfolgreich: Das exklusive Design des Briefes (oder eines Teils davon) ist bereits dunkel.  In diesem Fall m√ºssen Sie nichts √§ndern. Es ist besser, einfach nur ruhig gl√ºcklich zu sein. Wahrscheinlich hat der Designer die Farben nicht schlechter als unseren Algorithmus ausgew√§hlt.  Schauen Sie sich in HSL nur die L - Helligkeit an.  Wenn der Schwellenwert h√∂her (f√ºr Text) oder niedriger (f√ºr Hintergrund) ist (was nat√ºrlich anpassbar ist), tun wir nichts. </p><br><h3 id="dinamicheskiy-cirk">  Dynamischer Zirkus </h3><br><p>  Obwohl wir es nicht brauchten (nochmals vielen Dank, Desinfektionsmittel, Sie haben mich vor dem Wahnsinn gerettet!), Werde ich Ihnen trotzdem sagen, welche Art von Add-Ons ein adaptives Thema ben√∂tigt, um ganze Seiten abzudunkeln, und nicht nur dumme statische Buchstaben aus den neunziger Jahren.  Genauer gesagt ist dies eine Aufgabe f√ºr diejenigen, die den Geruch von Selektoren am Morgen m√∂gen. </p><br><h4 id="dinamicheskie-inlayn-stili">  Dynamische Inline-Stile </h4><br><p>  Der einfachste Fall, der unsere abgedunkelte Seite besch√§digt, ist das √Ñndern von Inline-Stilen.  Die Operation ist h√§ufig, aber die Korrektur ist einfach: F√ºgen Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>MutationObserver</code></a> und reparieren Sie die Inline-Stile beim √Ñndern schnell. </p><br><h4 id="vneshnie-stili">  Externe Stile </h4><br><p>  Das Arbeiten mit Stilen von <code>&lt;link&gt;</code> aus dem Inneren der Seite ist aufgrund von Asynchronit√§t und <code>@import</code> ziemlich schmerzhaft, und CORS macht keinen Spa√ü mehr.  Es scheint, dass dieses Problem durch einen Web-Worker (Proxy f√ºr <code>*.css</code> ) recht elegant gel√∂st werden k√∂nnte. </p><br><h4 id="dinamicheskie-stili">  Dynamische Stile </h4><br><p>  Wenn wir schlie√ülich alle unsere Probleme zusammenfassen, erinnern wir uns, dass das Skript im Allgemeinen <code>&lt;style&gt;</code> und <code>&lt;link&gt;</code> hinzuf√ºgen, l√∂schen und neu anordnen kann (Spezifit√§t! Kaskade!) Und sogar die Regeln in <code>&lt;style&gt;</code> √§ndern kann.  Alles wird von demselben <code>MutationObserver</code> f√ºr Stilelemente gel√∂st, aber f√ºr jede √Ñnderung wird mehr verarbeitet. </p><br><h4 id="css-peremennye">  CSS-Variablen </h4><br><p>  Eine ganz neue Runde des Wahnsinns kommt, wenn CSS-Variablen ins Spiel kommen.  Wir k√∂nnen die Variablen selbst nicht verschleiern: Selbst wenn wir davon ausgehen, dass wir anhand des Formats erraten werden, dass die Variable Farbe enth√§lt (obwohl ich Ihnen nicht raten w√ºrde, dies zu tun), ist nicht bekannt, in welcher Rolle sie uns treffen wird - Hintergrund, Text, Rahmen auf einmal?  Dar√ºber hinaus werden die Werte der Variablen vererbt, sodass wir nicht nur die Stile ber√ºcksichtigen m√ºssen, sondern auch die Elemente, auf die sie angewendet werden. All dies eskaliert schnell und explodiert. </p><br><p>  Wenn CSS-Variablen in den Mainstream gelangen, haben wir ein Problem.  Andererseits wird zu diesem Zeitpunkt bereits <code>color()</code> gestartet, mit dem es m√∂glich sein wird, die Farben in JS nicht zu √§ndern, sondern die Farben einfach durch <code>color(var(--bg) lightness(-50%))</code> ersetzen. </p><br><h3 id="rezyume">  Zusammenfassung </h3><br><p><img src="https://habrastorage.org/webt/46/rl/mz/46rlmzxvgus52n7_77t3ydz2ms0.png"></p><br><p>  In unserem Fall funktioniert das adaptive Dimmen auf CSS-Ebene einwandfrei, wenn das Desinfektionsmittel nur Inline-Stile bel√§sst: Es bietet die beste Dimmqualit√§t, bricht keine Buchstaben und arbeitet relativ schnell und einfach.  Ich bin mir nicht sicher, ob sich die Option mit all der F√ºllung f√ºr die Dynamik lohnt.  Wenn Sie mit benutzergenerierten Inhalten arbeiten und keinen Browser schreiben, sollte Ihr Desinfektionsprogramm dies ebenfalls tun. </p><br><p>  In der Praxis sollte der adaptive Modus zusammen mit der Neudefinition von Stilen verwendet werden: Stile werden normalerweise nicht explizit auf Standardelemente wie <code>&lt;input&gt;</code> oder <code>&lt;a&gt;</code> angewendet, sind jedoch standardm√§√üig leicht. </p><br><h2 id="kak-zatemnyat-kartinki">  So verdunkeln Sie Bilder </h2><br><p>  Das Neulackieren von Bildern ist ein separates Problem, das mich pers√∂nlich st√∂rt.  Das ist interessant und ich habe endlich die M√∂glichkeit, den Ausdruck ‚ÄûSpektralanalyse‚Äú zu verwenden.  Bei Bildern in einem dunklen Motiv treten h√§ufig Probleme auf. </p><br><p>  Erstens sind die Bilder zu hell.  Es funktioniert genauso wie unbemalte Buchstaben, mit denen alles begann.  Oft (aber nicht unbedingt) sind dies gew√∂hnliche Fotografien.  Da das Layout der Newsletter nicht sehr lustig ist, exportieren viele Leute einfach den schwierigen Teil des Briefes als Bild, es malt nicht neu und beleuchtet nachts meinen Perfektionismus.  Solche Bilder m√ºssen abgedunkelt, aber nicht invertiert werden - sonst kommt ein schreckliches Negativ heraus. </p><br><p><img src="https://habrastorage.org/webt/6-/zz/nx/6-zznxvkap9ywdvgjpglm5v6wqc.png"></p><br><p>  Zweitens dunkle Bilder mit echter Transparenz.  Dieses Problem tritt h√§ufig bei Logos auf - sie sind f√ºr einen hellen Hintergrund konzipiert und werden, wenn wir sie durch einen dunklen ersetzen, mit diesem zusammengef√ºhrt.  Solche Bilder m√ºssen invertiert werden. </p><br><p><img src="https://habrastorage.org/webt/xo/at/cc/xoatcc7dg3nhb_ufdoyye4hxsoo.png"></p><br><p>  Irgendwo in der Mitte gibt es Bilder, f√ºr die Wei√ü einen "transparenten Hintergrund" darstellt, aber jetzt stehen sie nur noch in einem seltsamen wei√üen Rechteck.  In einer idealen Welt w√ºrden wir einen wei√üen Hintergrund durch einen transparenten ersetzen. Wenn Sie jedoch jemals mit einem Zauberstab in einem Bildbearbeitungsprogramm gearbeitet haben, wissen Sie, dass dies nicht so einfach ist. </p><br><p><img src="https://habrastorage.org/webt/fi/o4/v9/fio4v9n1lcpve_wa1jhj5usj4yo.png"></p><br><p>  Es ist interessant, dass Bilder manchmal √ºberhaupt keine Bedeutung haben - dies sind Tracking-Pixel und ‚ÄûFormathalter‚Äú in einem besonders perversen Layout.  Diese k√∂nnen sicher unsichtbar gemacht werden (z. B. <code>opacity: 0</code> ). </p><br><p><img src="https://habrastorage.org/webt/5y/ba/tu/5ybatucrfhczsgc_aqykbgtnop0.png"></p><br><h3 id="evristiki-s-introspekciey">  Introspektionsheuristik </h3><br><p>  Um zu entscheiden, was mit dem Bild geschehen soll, m√ºssen wir hineingehen und seinen Inhalt analysieren - und das auf einfache und schnelle Weise.  Entsprechend unseren Problemen taucht die erste Version des Algorithmus auf.  Da ist sie. </p><br><p>  Wir betrachten dunkle, helle und transparente Pixel im Bild und nicht alle, sondern selektiv - offensichtliche Optimierung.  Wir bestimmen die Gesamthelligkeit des Bildes (hell, dunkel, mittel) und das Vorhandensein von Transparenz.  Dunkle Bilder mit Transparenz umkehren, Licht ohne Transparenz - stumm schalten, den Rest nicht ber√ºhren. </p><br><p>  Die Freude an dieser wunderbaren Heuristik endete, als ich auf einen Wohlt√§tigkeits-Newsletter mit einem Foto einer Lektion in einer afrikanischen Schule stie√ü.  Alles w√§re in Ordnung, aber der Designer zentrierte es und f√ºgte transparente Pixel entlang der R√§nder hinzu.  Wir wollten uns nicht im Zentrum einer neuen Geschichte √ºber die anst√∂√üige Erkennung von Bildern befinden, und wir haben beschlossen, in der ersten Version √ºberhaupt keine Bildverarbeitung durchzuf√ºhren. </p><br><p>  In Zukunft sollten zus√§tzliche Heuristiken, die ich nur als ‚ÄûSpektralanalyse‚Äú bezeichne, vor solchen Problemen sch√ºtzen - wir z√§hlen die Anzahl der verschiedenen Farben im Bild und invertieren nur, wenn es nur wenige davon gibt.  Das gleiche Kriterium kann verwendet werden, um nach grafischen Lichtbildern zu suchen und diese auch neu zu streichen - es klingt verlockend. </p><br><p><img src="https://habrastorage.org/webt/sj/c1/di/sjc1diiz68fpljjzii64f9j7nrq.png"></p><br><h2 id="itog">  Zusammenfassung </h2><br><p>  F√ºr ein vollwertiges dunkles Thema in der Mail fehlten uns das Neulackieren von Buchstaben mit Stilen, und wir fanden heraus, wie wir es arrangieren sollten.  Zwei einfache Optionen in reinem CSS - die Neudefinition von Stilen und ein CSS-Filter - haben nicht funktioniert: Die erste ist zu hart f√ºr das urspr√ºngliche Design, die zweite funktioniert einfach nicht gut.  Aus diesem Grund verwenden wir adaptives Dimmen - wir analysieren Stile, ersetzen Farben durch geeignetere und sammeln sie zur√ºck.  Jetzt arbeiten wir daran, das Thema in Bilder zu erweitern - daf√ºr m√ºssen wir deren Inhalt analysieren und nur wenige neu streichen. </p><br><p>  Wenn Sie jemals benutzerdefiniertes HTML f√ºr ein dunkles Thema neu streichen m√ºssen, beachten Sie drei Methoden: </p><br><ul><li>  √úberschreiben von Stilen - Sie ben√∂tigen es trotzdem f√ºr Ihre Hauptanwendung, billig und ver√§rgert, aber es t√∂tet alle Originalfarben. </li><li>  CSS-Filter ist cool, aber es funktioniert so lala.  Nur f√ºr undurchsichtige (in Bezug auf den Zugriff) Elemente wie Frames oder Webkomponenten verwenden. </li><li>  Konvertieren von Stilen - verdunkelt sehr hohe Qualit√§t, ist jedoch komplizierter als andere Methoden. </li></ul><br><p>  Auch wenn Sie dies nie tun, hoffe ich, dass Sie Spa√ü hatten! </p><br><p>  <strong>N√ºtzliche Links</strong> : </p><br><ol><li><p>  Wenn Sie daran interessiert sind, dieses Thema lebhaft und im Kontext der Entwicklung f√ºr Android zu diskutieren, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">laden</a> wir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sie ein,</a> am 18. April das B√ºro von Yandex in Petersburg <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zu besuchen</a> . </p><br></li><li><p>  K√ºrzlich haben wir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dar√ºber gesprochen</a> , ein anderes Problem von Mail-Benutzern zu l√∂sen - Mailing-Probleme. </p><br></li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de446780/">https://habr.com/ru/post/de446780/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de446768/index.html">Nominelle Eingabe in TypeScript oder Schutz Ihrer Benutzeroberfl√§che vor fremden Kennungen</a></li>
<li><a href="../de446770/index.html">12 JavaScript-Tricks, die in den meisten Tutorials nicht zu finden sind</a></li>
<li><a href="../de446772/index.html">√ñffnen Sie keine H√§fen f√ºr die Welt - sie werden Sie brechen (Risiken)</a></li>
<li><a href="../de446774/index.html">Low Poly Character Design</a></li>
<li><a href="../de446776/index.html">Arbeitsnachweis wirksam</a></li>
<li><a href="../de446782/index.html">Yo-ho-ho und eine Flasche Rum</a></li>
<li><a href="../de446786/index.html">Warum ich Disqus verlassen habe und du gehen musst</a></li>
<li><a href="../de446788/index.html">Tipps und Tricks von Kubernetes: Informationen zur lokalen Entwicklung und Telepr√§senz</a></li>
<li><a href="../de446790/index.html">Wie ich in der Sicherheit von Android ein Osterei entdeckte und keinen Job bei Google bekam</a></li>
<li><a href="../de446794/index.html">Wir arbeiten korrekt mit Wordstat. Komplette Anleitung</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>