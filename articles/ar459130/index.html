<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฉ๐ปโ๐ผ ๐ด๐พ ๐ ุฎุทุฃ ูุทูู ูู ุงูุชุนุงูู ูุน microservices ๐๐ฟ ๐จ๐ผโโ๏ธ ๐ฆ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุชูุถุญ ุงูููุงูุฉ ููููุฉ ุชูููุฐ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ูุงูุชุณุฌูู ุนูู ุฃุณุงุณ ูุจุฏุฃ "Made and ูุณูุช" ูู Go. ุชู ุชุตููู ูุฐู ุงูุทุฑููุฉ ูุฎุฏูุฉ microservices on Go ุ ุงูุชู ุชุนูู ูู ุญุง...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุฎุทุฃ ูุทูู ูู ุงูุชุนุงูู ูุน microservices</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/459130/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ุชูุถุญ ุงูููุงูุฉ ููููุฉ ุชูููุฐ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ูุงูุชุณุฌูู ุนูู ุฃุณุงุณ ูุจุฏุฃ "Made and ูุณูุช" ูู Go.  ุชู ุชุตููู ูุฐู ุงูุทุฑููุฉ ูุฎุฏูุฉ microservices on Go ุ ุงูุชู ุชุนูู ูู ุญุงููุฉ Docker ูุตูููุช ููููุง ููุจุงุฏุฆ ุงูููุฏุณุฉ ุงููุนูุงุฑูุฉ ุงููุธููุฉ. </p><a name="habracut"></a><br><p style=";text-align:right;direction:rtl">  ูุฐู ุงูููุงูุฉ ูู ูุณุฎุฉ ููุตูุฉ ูุชูุฑูุฑ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงุฌุชูุงุน ุฌู</a> ุงูุฃุฎูุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูู ูุงุฒุงู</a> .  ุฅุฐุง ููุช ููุชููุง ุจู Go ูุชุนูุด ูู ูุงุฒุงู ุฃู Innopolis ุฃู Yoshkar-Ola ุงูุฌูููุฉ ุฃู ูู ูุฏููุฉ ุฃุฎุฑู ูุฑูุจุฉ ุ ููุฌุจ ุนููู ุฒูุงุฑุฉ ุตูุญุฉ ุงููุฌุชูุน: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">golangkazan.github.io</a> . </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูุงุฌุชูุงุน ุ ุฃุธูุฑ ูุฑูููุง ูู ุชูุฑูุฑูู ููู ูููู ุจุชุทููุฑ ุงูุฎุฏูุงุช ุงููุตุบุฑุฉ ุนูู ุงูุฐูุงุจ - ูุง ูู ุงููุจุงุฏุฆ ุงูุชู ูุชุจุนูุง ูููู ูููููุง ุชุจุณูุท ุญูุงุชูุง.  ุชุฑูุฒ ูุฐู ุงูููุงูุฉ ุนูู ููููููุง ููุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุ ูุงูุฐู ููุฏู ุงูุขู ููุดูู ุฌููุน ุฎุฏูุงุชูุง ุงููุตุบุฑุฉ ุงูุฌุฏูุฏุฉ. </p><br>
<h2 id="soglasheniya-o-strukture-mikroservisa" style=";text-align:right;direction:rtl">  ุงุชูุงูุงุช ูููู Microservice </h2><br><p style=";text-align:right;direction:rtl">  ูุจู ุงูุชุทุฑู ุฅูู ููุงุนุฏ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุ ูุฌุฏุฑ ุชุญุฏูุฏ ุงููููุฏ ุงูุชู ููุงุญุธูุง ุนูุฏ ุงูุชุตููู ูุงูุชุฑููุฒ.  ููููุงู ุจุฐูู ุ ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุดูู ุฎุฏูุงุชูุง ุงููููุฑููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุจุงุฏุฆ ุฐู ุจุฏุก ุ ูุญู ูุญุชุฑู ุงูููุฏุณุฉ ุงููุนูุงุฑูุฉ ุงููุธููุฉ.  ููุณู ุงูุดูุฑุฉ ุฅูู ุซูุงุซุฉ ูุณุชููุงุช ูููุงุญุธ ูุงุนุฏุฉ ุงูุชุจุนูุฉ: ุงูุญุฒู ูู ูุณุชูู ุฃุนูู ูุณุชููุฉ ุนู ุงูุญุฒู ุงูุฎุงุฑุฌูุฉ ููุง ุชูุฌุฏ ุชุจุนูุงุช ุฏูุฑูุฉ.  ูุญุณู ุงูุญุธ ุ ูุฅู ุงูุชุจุนูุงุช ุงููุจุงุดุฑุฉ ููุฑูุจู ุงููุณุชุฏูุฑุฉ ููุญุฒู ูุญุธูุฑุฉ ูู Go.  ูุง ุชุฒุงู ุชุธูุฑ ุงูุชุจุนูุงุช ุบูุฑ ุงููุจุงุดุฑุฉ ูู ุฎูุงู ุงุณุชุนุงุฑุฉ ุงููุตุทูุญุงุช ุฃู ุงูุงูุชุฑุงุถุงุช ุงููุชุนููุฉ ุจุงูุณููู ุฃู ุงูุฅูุญุงุก ุจููุน ูุง ุ ููุฌุจ ุชุฌูุจูุง. </p><br><p style=";text-align:right;direction:rtl">  ููุฐุง ุชุจุฏู ูุณุชููุงุชูุง: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุญุชูู ูุณุชูู ุงููุฌุงู ุนูู ููุงุนุฏ ููุทู ุงูุฃุนูุงู ุงูุชู ุชููููุง ูุฌุงู ุงูููุถูุน. <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูู ุจุนุถ ุงูุฃุญูุงู ูููู ุจู ุฏูู ูุฌุงู ุฅุฐุง ูุงูุช ุงููููุฉ ุจุณูุทุฉ </li><li style=";text-align:right;direction:rtl">  <em>ุงููุงุนุฏุฉ:</em> ูุนุชูุฏ ุงูุฑูุฒ ุนูู ูุณุชูู ุงููุฌุงู ููุท ุนูู ุฅููุงููุงุช Go ุ ูููุชุจุฉ Go ุงูููุงุณูุฉ ูุงูููุชุจุงุช ุงููุญุฏุฏุฉ ุงูุชู ุชูุฏุฏ ูุบุฉ Go </li></ul></li><li style=";text-align:right;direction:rtl">  ุชุญุชูู ุทุจูุฉ ุงูุชุทุจูู ุนูู ููุงุนุฏ ููุทู ุงูุฃุนูุงู ุงูุชู ุชููููุง ููุงู ุงูุชุทุจูู. <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <em>ุงููุงุนุฏุฉ:</em> ูุฏ ูุนุชูุฏ ุงูุฑูุฒ ุนูู ูุณุชูู ุงูุชุทุจูู ุนูู ุงููุฌุงู </li></ul></li><li style=";text-align:right;direction:rtl">  ูุญุชูู ูุณุชูู ุงูุจููุฉ ุงูุชุญุชูุฉ ุนูู ุฑูุฒ ุงูุจููุฉ ุงูุฃุณุงุณูุฉ ุงูุฐู ูุฑุจุท ุงูุชุทุจูู ูุน ุงูุนุฏูุฏ ูู ุงูุชูููุงุช ููุชุฎุฒูู (MySQL ุ Redis) ุ ุงูููู (GRPC ุ HTTP) ุ ุงูุชูุงุนู ูุน ุงูุจูุฆุฉ ุงูุฎุงุฑุฌูุฉ ููุน ุงูุฎุฏูุงุช ุงูุฃุฎุฑู <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <em>ุงููุงุนุฏุฉ:</em> ูุฏ ูุนุชูุฏ ุงูุฑูุฒ ุนูู ูุณุชูู ุงูุจููุฉ ุงูุฃุณุงุณูุฉ ุนูู ุงููุฌุงู ูุงูุชุทุจูู </li><li style=";text-align:right;direction:rtl">  <em>ุงููุงุนุฏุฉ:</em> ุชูููุฉ ูุงุญุฏุฉ ููุท ููู ุญุฒูุฉ Go </li></ul></li><li style=";text-align:right;direction:rtl">  ุชููู ุงูุญุฒูุฉ ุงูุฑุฆูุณูุฉ ุจุฅูุดุงุก ุฌููุน ุงููุงุฆูุงุช - "ููุฑุฏุฉ ุงูุนูุฑ" ุ ูุชุฑุจุทูุง ูุนูุง ูุชุทูู ุฎุทูุทูุง ุทูููุฉ ุงูุนูุฑ - ุนูู ุณุจูู ุงููุซุงู ุ ุชุจุฏุฃ ุจูุนุงูุฌุฉ ุทูุจุงุช HTTP ูู ุงููููุฐ 8081 </li></ol><br><p style=";text-align:right;direction:rtl">  ูุฐู ูู ุงูุทุฑููุฉ ุงูุชู ุชุจุฏู ุจูุง ุดุฌุฑุฉ ุฏููู microservice (ุงูุฌุฒุก ุงูุฐู ููุฌุฏ ุจู ุฑูุฒ Go): </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/dk/ft/id/dkftidhxmqh30yy9zbdaeajfbgy.png" alt="ุงูุตูุฑุฉ: ุงุฐูุจ ุดุฌุฑุฉ ุงููุดุฑูุน"></p><br><p style=";text-align:right;direction:rtl">  ููู ุณูุงู ูู ุณูุงูุงุช ุงูุชุทุจูู (ุงููุญุฏุงุช ุงูููุทูุฉ) ุ ุชุจุฏู ุจููุฉ ุงูุญุฒูุฉ ููุง ููู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> ุชุนูู ุญุฒูุฉ ุงูุชุทุจูู ุนู ูุงุฌูุฉ ุงูุฎุฏูุฉ ุ ูุงูุชู ุชุญุชูู ุนูู ุฌููุน ุงูุฅุฌุฑุงุกุงุช ุงูููููุฉ ูู ูุฐุง ุงููุณุชูู ุ ูุชูููุฐ ูุงุฌูุฉ ูููู ุงูุฎุฏูุฉ ูุฎุฏูุฉ <code>func NewService(...) Service</code> </li><li style=";text-align:right;direction:rtl">  ูุชู ุชุญููู ุนุฒู ุงูุนูู ูุน ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจุณุจุจ ุญูููุฉ ุฃู ุญุฒูุฉ ุงููุฌุงู ุฃู ุงูุชุทุจูู ุชุนูู ุนู ูุงุฌูุฉ ูุณุชูุฏุน ุงูุชุฎุฒูู ุ ูุงูุชู ูุชู ุชูููุฐูุง ุนูู ูุณุชูู ุงูุจููุฉ ุงูุชุญุชูุฉ ูู ุงูุญุฒูุฉ ูุน ุงูุงุณู ุงููุฑุฆู "mysql" </li><li style=";text-align:right;direction:rtl">  ููุน ุฑูุฒ ุงูููู ูู ุญุฒูุฉ <code>infrastructure/transport</code> <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุญู ูุณุชุฎุฏู GRPC ุ ูุฐูู ูุชู ุฅูุดุงุก ูุนุจ ุฑูุชูู ุงูุฎุงุฏู ูู ููู proto (ูุซู ูุงุฌูุฉ ุงูุฎุงุฏู ูููุงูู ุงูุงุณุชุฌุงุจุฉ / ุงูุทูุจ ููู ุฑูุฒ ุชูุงุนู ุงูุนููู) </li></ul></li></ul><br><p style=";text-align:right;direction:rtl">  ูู ูุฐุง ูุจูู ูู ุงูุฑุณู ุงูุจูุงูู: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/-p/gm/hi/-pgmhid0ohkvijl2zmghnlokz7y.png" alt="ุงูุตูุฑุฉ: ุงุฐูุจ ูุฎุทุท ุญุฒูุฉ ุงููุดุฑูุน"></p><br><h2 id="principy-obrabotki-oshibok" style=";text-align:right;direction:rtl">  ุฎุทุฃ ูู ูุนุงูุฌุฉ ุงููุจุงุฏุฆ </h2><br><p style=";text-align:right;direction:rtl">  ูู ุดูุก ุจุณูุท ููุง: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุนุชูุฏ ุฃู ุงูุฃุฎุทุงุก ูุงููุฒุน ูุญุฏุซ ุนูุฏ ูุนุงูุฌุฉ ุงูุทูุจุงุช ุฅูู API - ููุง ูุนูู ุฃู ุงูุฎุทุฃ ุฃู ุงูุฐุนุฑ ูุฌุจ ุฃู ูุคุซุฑ ุนูู ุทูุจ ูุงุญุฏ ููุท </li><li style=";text-align:right;direction:rtl">  ูุนุชูุฏ ุฃู ุงูุณุฌูุงุช ูุทููุจุฉ ููุท ูุชุญููู ุงูุญูุงุฏุซ (ูููุงู ูุตุญุญ ุฃุฎุทุงุก ูุชุตุญูุญ ุงูุฃุฎุทุงุก) ุ ูุจุงูุชุงูู ุ ูุชู ุชููู ูุนูููุงุช ุญูู ุงูุทูุจุงุช ูู ุงูุณุฌู ุ ููุจู ูู ุดูุก ุ ุฃุฎุทุงุก ุบูุฑ ูุชููุนุฉ ุนูุฏ ูุนุงูุฌุฉ ุงูุทูุจุงุช </li><li style=";text-align:right;direction:rtl">  ูุนุชูุฏ ุฃู ุงูุจููุฉ ุงูุฃุณุงุณูุฉ ุจุฃููููุง ูุตููุฉ ููุนุงูุฌุฉ ุงูุณุฌูุงุช (ุนูู ุณุจูู ุงููุซุงู ุ ุจูุงุกู ุนูู ELK) - ูุชูุนุจ ุงูุฎุฏูุงุช ุงููุตุบุฑุฉ ุฏูุฑูุง ุณูุจููุง ูููุง ุ ุญูุซ ุชููู ุจูุชุงุจุฉ ุณุฌูุงุช ุฅูู stderr </li></ol><br><p style=";text-align:right;direction:rtl">  ูู ูุฑูุฒ ุนูู ุงูุฐุนุฑ: ูุง ุชูุณู ุงูุชุนุงูู ูุน ุงูุฐุนุฑ ูู ูู ูุฌููุนุฉ goroutine ูุฃุซูุงุก ูุนุงูุฌุฉ ูู ุทูุจ ููู ุฑุณุงูุฉ ููู ูููุฉ ุบูุฑ ูุชุฒุงููุฉ ูุทูููุง ุงูุทูุจ.  ุฏุงุฆูุง ุชูุฑูุจุง ุ ูููู ุฃู ูุชุญูู ุงูุฐุนุฑ ุฅูู ุฎุทุฃ ูููุน ุงูุชุทุจูู ุจุฃูููู ูู ุงูุงูุชูุงุก. </p><br><h2 id="idioma-sentinel-errors" style=";text-align:right;direction:rtl">  ุงููุตุทูุญ ุงูุญุงุฑุณ ุงูุฃุฎุทุงุก </h2><br><p style=";text-align:right;direction:rtl">  ุนูู ูุณุชูู ููุทู ุงูุฃุนูุงู ุ ุชุชู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุงููุชููุนุฉ ููุท ุงููุนุฑูุฉ ุจูุงุณุทุฉ ููุงุนุฏ ุงูุนูู.  ุณุชุณุงุนุฏู ุฃุฎุทุงุก Sentinel ูู ุชุญุฏูุฏ ูุฐู ุงูุฃุฎุทุงุก - ูุณุชุฎุฏู ูุฐุง ุงููุตุทูุญ ุจุฏูุงู ูู ูุชุงุจุฉ ุฃููุงุน ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจูุง ููุฃุฎุทุงุก.  ูุซุงู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> app <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"errors"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ErrNoCake = errors.New(<span class="hljs-string"><span class="hljs-string">"no cake found"</span></span>)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุชู ุงูุฅุนูุงู ุนู ูุชุบูุฑ ุนุงููู ููุง ุ ูุงูุฐู ุ ุจุงุชูุงู ุงูุณูุฏ ุงููุญุชุฑู ุ ูุฌุจ ุฃูุง ูุชุบูุฑ ูู ุฃู ููุงู.  ุฅุฐุง ูู ุชุนุฌุจู ุงููุชุบูุฑุงุช ุงูุนุงูููุฉ ูุงุณุชุฎุฏูุช linter ูููุดู ุนููุง ุ ูููููู ุงูุญุตูู ุนูู ุจุนุถ ุงูุซูุงุจุช ุ ููุง ููุชุฑุญ ุฏูู ุชุดููู ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุดูุฑ ุฃุฎุทุงุก ุซุงุจุช</a> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> app <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Error <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e Error)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Error</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>(e) } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ErrNoCake = Error(<span class="hljs-string"><span class="hljs-string">"no cake found"</span></span>)</code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  ุฅุฐุง ููุช ุชุญุจ ูุฐู <code>ConstError</code> ุ ููุฏ ุชุฑุบุจ ูู ุฅุถุงูุฉ ููุน <code>ConstError</code> ุฅูู ููุชุจุฉ ูุบุงุช Go ุงูุฎุงุตุฉ <code>ConstError</code> . </blockquote><br><h2 id="kompoziciya-oshibok" style=";text-align:right;direction:rtl">  ุชูููู ุงูุฃุฎุทุงุก </h2><br><p style=";text-align:right;direction:rtl">  ุงูููุฒุฉ ุงูุฑุฆูุณูุฉ ูุฃุฎุทุงุก ุงูุญุงุฑุณ ูู ุงููุฏุฑุฉ ุนูู ุชูููู ุงูุฃุฎุทุงุก ุจุณูููุฉ.  ุนูู ูุฌู ุงูุฎุตูุต ุ ุนูุฏ ุฅูุดุงุก ุฎุทุฃ ุฃู ุชููู ุฎุทุฃ ูู ุงูุฎุงุฑุฌ ุ ุณูููู ูู ุงูุฌููู ุฅุถุงูุฉ stacktrace ุฅููู.  ููุฐู ุงูุฃุบุฑุงุถ ุ ููุงู ุญูุงู ุดุงุฆุนุงู. </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุญุฒูุฉ xerrors ุ ูุงูุชู ุณูุชู ุชุถููููุง ูู Go 1.13 ูู ุงูููุชุจุฉ ุงูููุงุณูุฉ ูุชุฌุฑุจุฉ </li><li style=";text-align:right;direction:rtl">  ุญุฒูุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">github.com/pkg/errors</a> ุจูุงุณุทุฉ ุฏูู ุชุดููู <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูุญุฒูุฉ ูุฌูุฏุฉ ููุง ุชุชูุณุน ุ ููููุง ูุน ุฐูู ุฌูุฏุฉ </li></ul></li></ul><br><p style=";text-align:right;direction:rtl">  ูุง ูุฒุงู ูุฑูููุง ูุณุชุฎุฏู <code>errors.WithStack</code> ูุธุงุฆู <code>errors.WithStack</code> (ุนูุฏูุง ูุง ูููู ูุฏููุง ุดูุก ูุถููู ุ ุจุงุณุชุซูุงุก stacktrace) ุฃู <code>errors.Wrap</code> (ุนูุฏูุง ูููู ูุฏููุง ุดูุก ููููู ุญูู ูุฐุง ุงูุฎุทุฃ).  ููุชุง ุงูุฏุงูุชูู ุชูุจูุงู ุฎุทุฃู ูู ุงููุฏุฎูุงุช ูุชุนูุฏุงู ุฎุทุฃู ุฌุฏูุฏุงู ุ ููู ุจุงุณุชุฎุฏุงู stacktrace.  ูุซุงู ูู ุทุจูุฉ ุงูุจููุฉ ุงูุชุญุชูุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> mysql <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/pkg/errors"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(r *repository)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FindOne</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(...)</span></span></span></span> { row := r.client.QueryRow(sql, params...) <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> err := row.Scan(...) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> sql.ErrNoRows: <span class="hljs-comment"><span class="hljs-comment">//     stacktrace return nil, errors.WithStack(app.ErrNoCake) } }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุตู ุจุฃู ูุชู ุชุบููู ูู ุฎุทุฃ ูุฑุฉ ูุงุญุฏุฉ ููุท.  ูู ุงูุณูู ุงูููุงู ุจุฐูู ุฅุฐุง ุงุชุจุนุช ุงูููุงุนุฏ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุชู ุงูุชูุงู ุฃู ุฃุฎุทุงุก ุฎุงุฑุฌูุฉ ูุฑุฉ ูุงุญุฏุฉ ูู ูุงุญุฏุฉ ูู ุญุฒู ุงูุจููุฉ ุงูุชุญุชูุฉ </li><li style=";text-align:right;direction:rtl">  ุฃู ุฃุฎุทุงุก ุชูุดุฃ ุนู ููุงุนุฏ ููุทู ุงูุฃุนูุงู ูุชู ุงุณุชููุงููุง ุจูุงุณุทุฉ stacktrace ูู ููุช ุงูุฅูุดุงุก </li></ul><br><h2 id="pervoprichina-oshibki" style=";text-align:right;direction:rtl">  ุงูุณุจุจ ุงูุฌุฐุฑู ููุฎุทุฃ </h2><br><p style=";text-align:right;direction:rtl">  ุฌููุน ุงูุฃุฎุทุงุก ุชููุณู ุจุดูู ูุชููุน ุฅูู ุบูุฑ ูุชููุน.  ููุชุนุงูู ูุน ุงูุฎุทุฃ ุงููุชููุน ุ ุชุญุชุงุฌ ุฅูู ุงูุชุฎูุต ูู ุขุซุงุฑ ุงูุชูููู.  ุชุญุชูู ุญุฒู xerrors ู github.com/pkg/errors ุนูู ูู ูุง ุชุญุชุงุฌู: ุนูู ูุฌู ุงูุฎุตูุต ุ ุชุญุชูู ุญุฒูุฉ ุงูุฃุฎุทุงุก ุนูู <code>errors.Cause</code> ุ ูุงูุชู ุชูุฑุฌุน ุงูุณุจุจ ุงูุฌุฐุฑู ููุฎุทุฃ.  ูุฐู ุงููุธููุฉ ูู ุญููุฉ ุ ูุงุญุฏุฉ ุชูู ุงูุฃุฎุฑู ุ ุจุงุณุชุฑุฏุงุฏ ุงูุฃุฎุทุงุก ุงูุณุงุจูุฉ ุจูููุง ุงูุฎุทุฃ ุงููุณุชุฎุฑุฌ ุงูุชุงูู ูุฏูู ุฃุณููุจ <code>Cause() error</code> . </p><br><p style=";text-align:right;direction:rtl">  ูุซุงู ุนูู ุฃููุง ูุณุชุฎูุต ุงูุณุจุจ ุงูุฌุฐุฑู ูููุงุฑูู ูุจุงุดุฑุฉ ูุน ุฎุทุฃ ุงูุญุงุฑุณ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(s *service)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SaveCake</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(...)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span></span> { state, err := s.repo.FindOne(...) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> errors.Cause(err) == ErrNoCake { err = <span class="hljs-literal"><span class="hljs-literal">nil</span></span> <span class="hljs-comment"><span class="hljs-comment">// No cake is OK, create a new one // ... } else if err != nil { // ... } }</span></span></code> </pre> <br><h2 id="obrabotka-oshibok-v-defer" style=";text-align:right;direction:rtl">  ุฎุทุฃ ูู ูุนุงูุฌุฉ ูู ุชุฃุฌูู </h2><br><p style=";text-align:right;direction:rtl">  ุฑุจูุง ููุช ุชุณุชุฎุฏู linter ุ ููุง ูุฌุนูู ุชุญูู ูุฏูููุง ูู ุฌููุน ุงูุฃุฎุทุงุก.  ูู ูุฐู ุงูุญุงูุฉ ุ ูู ุงููุญุชูู ุฃู ุชุดุนุฑ ุจุงูุบุถุจ ุนูุฏูุง ูุทูุจ ููู linter ุงูุชุญูู ูู ุงูุฃุฎุทุงุก ุจุงุณุชุฎุฏุงู ุทุฑู <code>.Close()</code> ูุบูุฑูุง ูู ุงูุทุฑู ุงูุชู <code>defer</code> ููุท.  ูู ุณุจู ูู ุฃู ุญุงููุช ูุนุงูุฌุฉ ุงูุฎุทุฃ ูู ุงูุชุฃุฌูู ุจุดูู ุตุญูุญ ุ ุฎุงุตุฉ ุฅุฐุง ูุงู ููุงู ุฎุทุฃ ุขุฎุฑ ูุจู ุฐููุ  ููุฏ ุฌุฑุจูุง ููุญู ูู ุนุฌูุฉ ูู ุฃูุฑูุง ููุดุงุฑูุฉ ุงููุตูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุชุฎูู ุฃู ูุฏููุง ูู ุงูุนูู ูุน ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจุดูู ุตุงุฑู ูู ุฎูุงู ุงููุนุงููุงุช.  ููููุง ููุงุนุฏุฉ ุงูุชุจุนูุฉ ุ ูุฌุจ ุฃูุง ุชุนุชูุฏ ูุณุชููุงุช ุงูุชุทุจูู ูุงููุฌุงู ุจุดูู ูุจุงุดุฑ ุฃู ุบูุฑ ูุจุงุดุฑ ุนูู ุงูุจููุฉ ุงูุชุญุชูุฉ ูุชูููููุฌูุง SQL.  ูุฐุง ูุนูู ุฃูู <strong>ุนูู ูุณุชูู ุงูุชุทุจูู ูุงููุฌุงู ูุง ุชูุฌุฏ ูููุฉ "ูุนุงููุฉ"</strong> . </p><br><p style=";text-align:right;direction:rtl">  ุฅู ุฃุจุณุท ุงูุญููู ูู ุงุณุชุจุฏุงู ูููุฉ "ูุนุงููุฉ" ุจุดูุก ุชุฌุฑูุฏู ุ  ูุจุงูุชุงูู ููุฏุช ูุญุฏุฉ ููุท ุงูุนูู.  ูู ุชุทุจูููุง ุ ุชุณุชูุจู ุงูุฎุฏูุฉ ูู ุญุฒูุฉ ุงูุชุทุจูู ุงููุตูุน ูู ุฎูุงู ูุงุฌูุฉ UnitOfWorkFactory ุ ูุฎูุงู ูู ุนูููุฉ ุชููู ุจุฅูุดุงุก ูุงุฆู UnitOfWork ูุฎูู ุงููุนุงููุฉ.  ูุณูุญ ูู ูุงุฆู UnitOfWork ุจุงูุญุตูู ุนูู ูุณุชูุฏุน. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงููุฒูุฏ ุนู UnitOfWork</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ูููู ุงุณุชุฎุฏุงู ูุญุฏุฉ ุงูุนูู ุจุดูู ุฃูุถู ุ ุฃูู ูุธุฑุฉ ุนูู ุงููุฎุทุท: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/08/hi/iy/08hiiyavd51o3_aof9ys_s9noue.png" alt="ุตูุฑุฉ ุงูุฐูุงุจ ูุญุฏุฉ ุงูุนูู"></p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููุซู ุงููุณุชูุฏุน ูุฌููุนุฉ ูุชูุงุตูุฉ ูุฌุฑุฏุฉ ูู ุงููุงุฆูุงุช (ุนูู ุณุจูู ุงููุซุงู ุ ูุฌุงููุน ูุณุชูู ุงููุฌุงู) ูู ุงูููุน ุงููุญุฏุฏ </li><li style=";text-align:right;direction:rtl">  ูุฎูู UnitOfWork ุงููุนุงููุฉ ููููู ุจุฅูุดุงุก ูุงุฆูุงุช ูุณุชูุฏุน </li><li style=";text-align:right;direction:rtl">  UnitOfWorkFactory ุจุจุณุงุทุฉ ูุณูุญ ููุฎุฏูุฉ ุจุฅูุดุงุก ูุนุงููุงุช ุฌุฏูุฏุฉ ุฏูู ูุนุฑูุฉ ุฃู ุดูุก ุนู ุงููุนุงููุงุช. </li></ul><br><p style=";text-align:right;direction:rtl">  ุฃููุณ ูู ุงูููุฑุท ุฅูุดุงุก ูุนุงููุฉ ููู ุนูููุฉ ุ ุญุชู ูู ุงูุจุฏุงูุฉ ุงูุฐุฑูุฉุ  ุงูุฃูุฑ ูุชุฑูู ูู ุ  ูุนุชูุฏ ุฃู ุงูุญูุงุธ ุนูู ุงุณุชููุงููุฉ ููุทู ุงูุนูู ุฃูุซุฑ ุฃูููุฉ ูู ุงูุชูููุฑ ุนูุฏ ุฅูุดุงุก ูุนุงููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูู ูู ุงููููู ุงูุฌูุน ุจูู UnitOfWork ู Repositoryุ  ุฅูู ูููู ุ ููููุง ูุนุชูุฏ ุฃู ูุฐุง ููุชูู ูุจุฏุฃ ุงููุณุคูููุฉ ุงููุฑุฏูุฉ. </p></div></div><br><p style=";text-align:right;direction:rtl">  ูุฐุง ูุง ุชุจุฏู ุนููู ุงููุงุฌูุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> UnitOfWork <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { Repository() Repository Complete(err *error) }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชููุฑ ูุงุฌูุฉ UnitOfWork ุงูุทุฑููุฉ ุงููุงููุฉ ุ ูุงูุชู ุชุฃุฎุฐ ูุนููุฉ ููุฏุงุฎู ูุงุญุฏุฉ: ูุคุดุฑ ุฅูู ูุงุฌูุฉ ุงูุฎุทุฃ.  ูุนู ุ ุฅูู ุงููุคุดุฑ ุ ููู ุงููุนููุฉ ุงูุฏุงุฎููุฉ - ูู ุฃู ุญุงูุงุช ุฃุฎุฑู ุ ุณูููู ุงูููุฏ ุงูููุฌูุฏ ุนูู ุฌุงูุจ ุงูุงุชุตุงู ุฃูุซุฑ ุชุนููุฏูุง. </p><br><p style=";text-align:right;direction:rtl">  ูุซุงู ุงูุนูููุฉ ูุน unitOfWork: </p><br><blockquote style=";text-align:right;direction:rtl">  ุชุญุฐูุฑ: <strong>ูุฌุจ</strong> ุงูุชุตุฑูุญ ุนู ุงูุฎุทุฃ ููููุฉ ุฅุฑุฌุงุน ูุณูุงุฉ.  ุฅุฐุง ููุช ุชุณุชุฎุฏู ุงููุชุบูุฑ ุงููุญูู ูุฎุทุฆ ุจุฏูุงู ูู ุงููููุฉ ุงููุฑุชุฌุนุฉ ุงููุณูุงุฉ ุ ููุง ููููู ุงุณุชุฎุฏุงููุง ูู ุชุฃุฌูู!  ููู ููุดู ูู linter ุนู ุฐูู ุญุชู ุงูุขู - ุฑุงุฌุน <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">go-ุงููุงูุฏ # 801</a> </blockquote><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(s *service)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CookCake</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(err error)</span></span></span></span> { unitOfWork, err := s.unitOfWorkFactory.New() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> err } <span class="hljs-keyword"><span class="hljs-keyword">defer</span></span> unitOfWork.Complete(&amp;err) repo := unitOfWork.Repository() } <span class="hljs-comment"><span class="hljs-comment">// ...  </span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุญุชู ูุชุญูู ุงูุงูุชูุงุก <del>  ุงููุนุงููุงุช </del>  UnitOfWork: </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(u *unitOfWork)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Complete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(err *error)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> *err == <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-comment"><span class="hljs-comment">//     -  commit txErr := u.tx.Commit() *err = errors.Wrap(txErr, "cannot complete transaction") } else { //    -  rollback txErr := return u.tx.Rollback() //  rollback   ,    *err = mergeErrors(*err, errors.Wrap(txErr, "cannot rollback transaction")) } }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชููู ุฏุงูุฉ <code>mergeErrors</code> ุจุฏูุฌ ุฎุทุฃูู ุ ููููุง ุชููู ุจูุนุงูุฌุฉ ุตูุฑ ุจุฏูู ูุดุงูู ุจุฏูุงู ูู ุฎุทุฃ ูุงุญุฏ ุฃู ููุง ุงูุฎุทุฃูู.  ูู ุงูููุช ููุณู ุ ูุนุชูุฏ ุฃู ููุง ุงูุฎุทุฃูู ูุฏ ุญุฏุซ ุฃุซูุงุก ุชูููุฐ ุนูููุฉ ูุงุญุฏุฉ ูู ูุฑุงุญู ูุฎุชููุฉ ุ ูุงูุฎุทุฃ ุงูุฃูู ุฃูุซุฑ ุฃูููุฉ - ูุฐูู ุ ุนูุฏูุง ูุง ูููู ููุง ุงูุฎุทุฃูู ุตูุฑููุง ุ ูุฅููุง ูููู ุจุญูุธ ุงูุฎุทุฃ ุงูุฃูู ุ ููุชู ุญูุธ ุงูุฑุณุงูุฉ ููุท ูู ุงูุฎุทุฃ ุงูุซุงูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> errors <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mergeErrors</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(err error, nextErr error)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err == <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { err = nextErr } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> nextErr != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { err = errors.Wrap(err, nextErr.Error()) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> err }</code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  ุฑุจูุง ูุฌุจ ุนููู ุฅุถุงูุฉ ูุธููุฉ <code>mergeErrors</code> ุฅูู ููุชุจุฉ ุงูุดุฑูุฉ ุงูุฎุงุตุฉ ุจู ูู Go. </blockquote><br><h2 id="podsistema-logirovaniya" style=";text-align:right;direction:rtl">  ุชุณุฌูู ุงููุธุงู ุงููุฑุนู </h2><br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุงุฆูุฉ ูุฑุงุฌุนุฉ</a> ุงูููุงูุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">: ูุง ูุงู ุนููู ูุนูู ูุจู ุจุฏุก ุฎุฏูุงุช micros ูู prod</a> ุชูุตุญ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุณุฌูุงุช ููุชูุจุฉ ูู stderr </li><li style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ุชููู ุงูุณุฌูุงุช ูู JSON ุ ูุงุฆู JSON ูุถุบูุท ูุงุญุฏ ููู ุณุทุฑ </li><li style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ูููู ููุงู ูุฌููุนุฉ ููุงุณูุฉ ูู ุงูุญููู: <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูุทุงุจุน ุงูุฒููู - ููุช ุงูุญุฏุซ <strong>ุจุงููููู ุซุงููุฉ</strong> ุ ูููุถู ุจุชูุณูู RFC 3339 (ูุซุงู: "1985-04-12T23: 20: 50.52Z") </li><li style=";text-align:right;direction:rtl">  ุงููุณุชูู - ูุณุชูู ุงูุฃูููุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ "ูุนูููุงุช" ุฃู "ุฎุทุฃ" </li><li style=";text-align:right;direction:rtl">  app_name - ุงุณู ุงูุชุทุจูู </li><li style=";text-align:right;direction:rtl">  ูุบูุฑูุง ูู ุงููุฌุงูุงุช </li></ul></li></ul><br><p style=";text-align:right;direction:rtl">  ููุถู ุฅุถุงูุฉ ุญูููู ุขุฎุฑูู ุฅูู ุฑุณุงุฆู ุงูุฎุทุฃ: <code>"error"</code> ู <code>"stacktrace"</code> . </p><br><p style=";text-align:right;direction:rtl">  ููุงู ุงูุนุฏูุฏ ูู ููุชุจุงุช ุชุณุฌูู ุงูุฌูุฏุฉ ููุบุฉ Golang ุ ุนูู ุณุจูู ุงููุซุงู ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">sirupsen / logrus</a> ุ ุงูุชู ูุณุชุฎุฏููุง.  ููููุง ูุง ูุณุชุฎุฏู ุงูููุชุจุฉ ูุจุงุดุฑุฉ.  ุจุงุฏุฆ ุฐู ุจุฏุก ุ ูู ุญุฒูุฉ <code>log</code> ุจูุง ุ ูููู ุจุชูููู ูุงุฌูุฉ ุงูููุชุจุฉ ุงููุงุณุนุฉ ููุบุงูุฉ ุฅูู ูุงุฌูุฉ Logger ูุงุญุฏุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> log <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Logger <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { WithField(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>{}) Logger WithFields(Fields) Logger Debug(...<span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>{}) Info(...<span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>{}) Error(error, ...<span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>{}) }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ุฃุฑุงุฏ ุงููุจุฑูุฌ ูุชุงุจุฉ ุงูุณุฌูุงุช ุ ููุฌุจ ุนููู ุงูุญุตูู ุนูู ูุงุฌูุฉ Logger ูู ุงูุฎุงุฑุฌ ุ ููุฌุจ ุฃู ูุชู ุฐูู ุนูู ูุณุชูู ุงูุจููุฉ ุงูุฃุณุงุณูุฉ ุ ูููุณ ุงูุชุทุจูู ุฃู ุงููุฌุงู.  ูุงุฌูุฉ ุงููุณุฌู ููุฌุฒุฉ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููู ูููู ูู ุนุฏุฏ ูุณุชููุงุช ุงูุฎุทูุฑุฉ ูุชุตุญูุญ ุงูุฃุฎุทุงุก ูุงููุนูููุงุช ูุงูุฎุทุฃ ุ ููุง ุชูุตุญ ุงูููุงูุฉ ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฏุนูุง ูุชุญุฏุซ ุนู ุงูุชุณุฌูู.</a> </li><li style=";text-align:right;direction:rtl">  ููุฏู ููุงุนุฏ ุฎุงุตุฉ ูุฃุณููุจ Error: ุงูุฃุณููุจ ููุจู ุฏุงุฆููุง ูุงุฆู ุฎุทุฃ </li></ul><br><p style=";text-align:right;direction:rtl">  ุชุณูุญ ูุซู ูุฐู ุงูุตุฑุงูุฉ ุจุชูุฌูู ุงููุจุฑูุฌูู ูู ุงูุงุชุฌุงู ุงูุตุญูุญ: ุฅุฐุง ุฃุฑุงุฏ ุดุฎุต ูุง ุฅุฌุฑุงุก ุชุญุณูู ูู ูุธุงู ุงูุชุณุฌูู ููุณู ุ ูุนููู ุฃู ูุฃุฎุฐ ุฐูู ูู ุงูุงุนุชุจุงุฑ ุงูุจููุฉ ุงูุชุญุชูุฉ ุจุฃููููุง ูุฌูุนูุง ููุนุงูุฌุชูุง ุ ูุงูุชู ุชุจุฏุฃ ููุท ูู ุงูุฎุฏูุฉ ุงููุฌูุฑูุฉ (ูุนุงุฏุฉ ูุง ุชูุชูู ูู ููุงู ูุง ูู Kibana ู zabbix). </p><br><p style=";text-align:right;direction:rtl">  ููุน ุฐูู ุ ุชูุฌุฏ ูู ุญุฒูุฉ ุงูุณุฌู ูุงุฌูุฉ ุฃุฎุฑู ุชุณูุญ ูู ุจููุงุทุนุฉ ุงูุจุฑูุงูุฌ ุนูุฏ ุญุฏูุซ ุฎุทุฃ ูุงุฏุญ ูุจุงูุชุงูู ูุง ูููู ุงุณุชุฎุฏุงูู ุฅูุง ูู ุงูุญุฒูุฉ ุงูุฑุฆูุณูุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> log <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> MainLogger <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { Logger FatalError(error, ...<span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>{}) }</code> </pre> <br><h2 id="paket-jsonlog" style=";text-align:right;direction:rtl">  ุญุฒูุฉ Jsonlog </h2><br><p style=";text-align:right;direction:rtl">  <code>jsonlog</code> ูุงุฌูุฉ Logger ุนูู ุญุฒูุฉ <code>jsonlog</code> ุจูุง ุ ูุงูุชู ุชููู ุจุชูููู ููุชุจุฉ logrus ูุชูุฎุต ุงูุนูู ูุนูุง.  ุจุดูู ุชุฎุทูุทู ูุจุฏู ูุซู ูุฐุง: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/g4/we/6m/g4we6m81oxxtd1nlvwklblru6eq.png" alt="ูุฎุทุท ุญุฒูุฉ ูุณุฌู ุงูุตูุฑ"></p><br><p style=";text-align:right;direction:rtl">  ุชุณูุญ ูู ุงูุญุฒูุฉ ุงูุงุญุชูุงุฑูุฉ ุจุชูุตูู ุงุญุชูุงุฌุงุช ุงูุฎุฏูุฉ ุงููุฌูุฑูุฉ (ุงูุชู ูุชู ุงูุชุนุจูุฑ ุนููุง ุจูุงุณุทุฉ ูุงุฌูุฉ <code>log.Logger</code> ) ุ ูุฅููุงููุงุช ููุชุจุฉ logrus ุ ูููุฒุงุช ุงูุจููุฉ ุงูุฃุณุงุณูุฉ ูุฏูู. </p><br><p style=";text-align:right;direction:rtl">  ุนูู ุณุจูู ุงููุซุงู ุ ูุณุชุฎุฏู ELK (ุงูุจุญุซ ุงููุฑู ุ Logstash ุ Kibana) ุ ูุจุงูุชุงูู ูู ุญุฒูุฉ jsonlog: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุนููู logrus.JSONFormatter ุชูุณูู ู <code>logrus.JSONFormatter</code> <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูู ููุณ ุงูููุช ุ ูููุง ุจุชุนููู ุฎูุงุฑ FieldMap ุ ูุงูุฐู ูุญูู ุจู ุญูู <code>"time"</code> ุฅูู <code>"@timestamp"</code> ุ <code>"@timestamp"</code> <code>"msg"</code> ุฅูู <code>"message"</code> </li></ul></li><li style=";text-align:right;direction:rtl">  ุญุฏุฏ ูุณุชูู ุงูุณุฌู </li><li style=";text-align:right;direction:rtl">  ุฃุถู ุฎุทุงููุง ูููู ุจุงุณุชุฎุฑุงุฌ stacktrace ูู ูุงุฆู <code>Error(error, ...interface{})</code> ุชู ุชูุฑูุฑู ุฅูู ุฃุณููุจ <code>Error(error, ...interface{})</code> </li></ul><br><p style=";text-align:right;direction:rtl">  ุชููุฆุฉ microservice ุงููุณุฌู ูู ุงููุธููุฉ ุงูุฑุฆูุณูุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initLogger</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(config Config)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(log.MainLogger, error)</span></span></span></span> { logLevel, err := jsonlog.ParseLevel(config.LogLevel) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, errors.Wrap(err, <span class="hljs-string"><span class="hljs-string">"failed to parse log level"</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> jsonlog.NewLogger(&amp;jsonlog.Config{ Level: logLevel, AppName: <span class="hljs-string"><span class="hljs-string">"cookingservice"</span></span> }), <span class="hljs-literal"><span class="hljs-literal">nil</span></span> }</code> </pre> <br><h2 id="obrabotka-oshibok-i-logirovanie-s-pomoschyu-middleware" style=";text-align:right;direction:rtl">  ุฎุทุฃ ูู ูุนุงูุฌุฉ ูุชุณุฌูู ูุน ุงููุณูุทุฉ </h2><br><p style=";text-align:right;direction:rtl">  ูุญู ูุชุญูู ุฅูู GRPC ูู ุฎุฏูุงุชูุง ุงููุตุบุฑุฉ ุฃุซูุงุก ุงูุชููู.  ูููู ุญุชู ูู ููุช ุชุณุชุฎุฏู HTTP API ุ ูุฅู ุงููุจุงุฏุฆ ุงูุนุงูุฉ ุชูุงุณุจู. </p><br><p style=";text-align:right;direction:rtl">  ุจุงุฏุฆ ุฐู ุจุฏุก ุ ูุฌุจ ุฃู ุชุญุฏุซ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก <code>app.Service</code> ุนูู ูุณุชูู <code>infrastructure</code> ูู ุงูุญุฒูุฉ ุงููุณุคููุฉ ุนู ุงูููู ุ ูุฃูู ูู ุงูุฐู ูุฌูุน ุจูู ูุนุฑูุฉ ููุงุนุฏ ุจุฑูุชูููู ุงูููู ููุนุฑูุฉ <code>app.Service</code> ูุงุฌูุฉ <code>app.Service</code> .  ุฃุฐูุฑ ุดูู ุนูุงูุฉ ุงูุญุฒูุฉ: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/fw/zn/hz/fwznhzsxd35ydgajmotnvprqbum.png" alt="ุตูุฑุฉ ูุฎุทุท ุญุฒูุฉ GRPC"></p><br><p style=";text-align:right;direction:rtl">  ูู ุงูููุงุฆู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ูุงูุญูุงุธ ุนูู ุงูุณุฌูุงุช ุจุงุณุชุฎุฏุงู ููุท ุงููุณูุทุฉ (ุงููุณูุทุฉ ูู ุงุณู ููุท ุงูุฏูููุฑ ูู ุนุงูู Golang ู Node.js): </p><br><p style=";text-align:right;direction:rtl">  ุญูุซ ูุฅุถุงูุฉ ุงููุณูุทุฉุ  ูู ูุฌุจ ุฃู ูููู ููุงูุ </p><br><p style=";text-align:right;direction:rtl">  ููุงู ุฎูุงุฑุงุช ูุฎุชููุฉ ูุฅุถุงูุฉ ุจุฑูุงูุฌ Middleware ุ ููููู ุงุฎุชูุงุฑ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููููู ุชุฒููู ูุงุฌูุฉ <code>app.Service</code> . ููู ูุง ููุตู ุจุงูููุงู ุจุฐูู ูุฃู ูุฐู ุงููุงุฌูุฉ ูุง ุชุชููู ูุนูููุงุช ุทุจูุฉ ุงูููู ุ ูุซู ุนููู IP </li><li style=";text-align:right;direction:rtl">  ุจุงุณุชุฎุฏุงู GRPC ุ ููููู ุชุนููู ูุนุงูุฌ ูุงุญุฏ ุนูู ุฌููุน ุงูุทูุจุงุช (ุจุดูู ุฃูุซุฑ ุฏูุฉ ุ ุงุซูุงู - ุฃุญุงุฏูุงู ูุจุฎุงุฑุงู) ุ ูููู ุจุนุฏ ุฐูู ุณูุชู ุชุณุฌูู ุฌููุน ุฃุณุงููุจ ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุจููุณ ุงูููุท ูุน ูุฌููุนุฉ ุงูุญููู ููุณูุง </li><li style=";text-align:right;direction:rtl">  ุจุงุณุชุฎุฏุงู GRPC ุ ููุดุฆ ููุดุฆ ุงูุดูุฑุฉ ูุงุฌูุฉ ุฎุงุฏู ูุฏุนู ูููุง ุฅูู <code>app.Service</code> ุทุฑููุฉ ุงูุฎุฏูุฉ - ูููู ุจุชุฒููู ูุฐู ุงููุงุฌูุฉ ูุฃููุง ุชุญุชูู ุนูู ูุนูููุงุช ุนูู ูุณุชูู ุงูููู ููุฏุฑุฉ ุนูู ุชุณุฌูู ุทุฑู API ูุฎุชููุฉ ุจุทุฑู ูุฎุชููุฉ </li></ul><br><p style=";text-align:right;direction:rtl">  ุจุดูู ุชุฎุทูุทู ูุจุฏู ูุซู ูุฐุง: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/vn/dl/eh/vndlehx5hogpu09hj3zekrzmyie.png" alt="ุตูุฑุฉ GRPC ุงููุณูุทุฉ ุญุฒูุฉ ุงูุฑุณู"></p><br><p style=";text-align:right;direction:rtl">  ููููู ุฅูุดุงุก Middlewares ูุฎุชููุฉ ููุนุงูุฌุฉ ุงูุฃุฎุทุงุก (ูุงูุฐุนุฑ) ูููุชุณุฌูู.  ููููู ุนุจูุฑ ูู ุดูุก ูู ูุงุญุฏ.  ุณููุธุฑ ูู ูุซุงู ูุชู ููู ุนุจูุฑ ูู ุดูุก ุฅูู ุฃุญุฏ ุงูุจุฑุงูุฌ ุงููุณูุทุฉ ุ ูุงูุฐู ูุชู ุฅูุดุงุคู ูุซู ูุฐุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NewMiddleware</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(next api.BackendService, logger log.Logger)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">api</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BackendService</span></span></span></span> { server := &amp;errorHandlingMiddleware{ next: next, logger: logger, } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> server }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุญุตู ุนูู ูุงุฌูุฉ <code>api.BackendService</code> ุ <code>api.BackendService</code> ุชูููุฐ ูุงุฌูุฉ <code>api.BackendService</code> . </p><br><p style=";text-align:right;direction:rtl">  ูุชู ุชุทุจูู ุทุฑููุฉ API ุงูุชุนุณูู ูู Middleware ุนูู ุงููุญู ุงูุชุงูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(m *errorHandlingMiddleware)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ListCakes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( ctx context.Context, req *api.ListCakesRequest)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(*api.ListCakesResponse, error)</span></span></span></span> { start := time.Now() res, err := m.next.ListCakes(ctx, req) m.logCall(start, err, <span class="hljs-string"><span class="hljs-string">"ListCakes"</span></span>, log.Fields{ <span class="hljs-string"><span class="hljs-string">"cookIDs"</span></span>: req.CookIDs, }) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res, translateError(err) }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุญู ููุง ูุคุฏู ุซูุงุซ ููุงู: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงุณุชุฏุนุงุก ุงูุฃุณููุจ ListCakes ูููุงุฆู ุงููุฒูู </li><li style=";text-align:right;direction:rtl">  ูุญู <code>logCall</code> ุทุฑููุฉ <code>logCall</code> ูููุง ุฌููุน ุงููุนูููุงุช ุงููููุฉ ุ ุจูุง ูู ุฐูู ูุฌููุนุฉ ูู ุงูุญููู ุงููุญุฏุฏุฉ ุจุดูู ูุฑุฏู ูุงูุชู ุชุฏุฎู ูู ุงูุณุฌู </li><li style=";text-align:right;direction:rtl">  ูู ุงูููุงูุฉ ุ ุงุณุชุจุฏููุง ุงูุฎุทุฃ ุนู ุทุฑูู ุงุณุชุฏุนุงุก translateError. </li></ol><br><p style=";text-align:right;direction:rtl">  ุณุชุชู ููุงูุดุฉ ุชุฑุฌูุฉ ุงูุฎุทุฃ ูุงุญููุง.  ููุชู ุฅุฌุฑุงุก ุงูุชุณุฌูู ุจูุงุณุทุฉ ุทุฑููุฉ <code>logCall</code> ุ ูุงูุชู ุชุณุชุฏุนู ุจุจุณุงุทุฉ ุทุฑููุฉ ูุงุฌูุฉ Logger ุงูุตุญูุญุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(m *errorHandlingMiddleware)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">logCall</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(start time.Time, err error, method </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">, fields log.Fields)</span></span></span></span> { fields[<span class="hljs-string"><span class="hljs-string">"duration"</span></span>] = fmt.Sprintf(<span class="hljs-string"><span class="hljs-string">"%v"</span></span>, time.Since(start)) fields[<span class="hljs-string"><span class="hljs-string">"method"</span></span>] = method logger := m.logger.WithFields(fields) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { logger.Error(err, <span class="hljs-string"><span class="hljs-string">"call failed"</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { logger.Info(<span class="hljs-string"><span class="hljs-string">"call finished"</span></span>) } }</code> </pre> <br><h2 id="translyaciya-oshibok" style=";text-align:right;direction:rtl">  ุฎุทุฃ ูู ุงูุชุฑุฌูุฉ </h2><br><p style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ูุญุตู ุนูู ุงูุณุจุจ ุงูุฌุฐุฑู ููุฎุทุฃ ููุญููู ุฅูู ุฎุทุฃ ูููู ูููู ุนูู ูุณุชูู ุงูููู ูููุซู ูู API ูุฎุฏูุชู. </p><br><p style=";text-align:right;direction:rtl">  ูู GRPC ุ ุงูุฃูุฑ ุจุณูุท - ุงุณุชุฎุฏู ุฏุงูุฉ <code>status.Errorf</code> ูุฅูุดุงุก ุฎุทุฃ ุจุฑูุฒ ุงูุญุงูุฉ.  ุฅุฐุง ูุงู ูุฏูู HTTP API (REST API) ุ ูููููู ุฅูุดุงุก ููุน ุงูุฎุทุฃ ุงูุฎุงุต ุจู ุงูุฐู <strong>ูุฌุจ ุฃูุง ูููู ูุณุชูู ุงูุชุทุจูู ูุงููุฌุงู ุนูู ุนูู ุจู.</strong> </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูุชูุฑูุจ ุงูุฃูู ุ ุชุจุฏู ุชุฑุฌูุฉ ุงูุฎุทุฃ ููุง ููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// ! ! -   err  status.Error func translateError(err error) error { switch errors.Cause(err) { case app.ErrNoCake: err = status.Errorf(codes.NotFound, err.Error()) default: err = status.Errorf(codes.Internal, err.Error()) } return err }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุนูุฏ ุงูุชุญูู ูู ุตุญุฉ ูุณูุทุงุช ุงูุฅุฏุฎุงู ุ ูููู ูููุงุฌูุฉ ุงููุฒุฎุฑูุฉ ุฅุฑุฌุงุน ุฎุทุฃ ูู ุงูุญุงูุฉ <code>status.Status</code> ููุน ุงูุฌูุงุฒ ูุน ุฑูุฒ ุงูุญุงูุฉ ุ ูุณูู ุชููุฏ ุงููุณุฎุฉ ุงูุฃููู ูู translateError ุฑูุฒ ุงูุญุงูุฉ ูุฐุง. </p><br><p style=";text-align:right;direction:rtl">  ุฏุนูุง ูุฌุนู ูุณุฎุฉ ูุญุณููุฉ ุจุงูุงูุชูุงู ุฅูู ููุน ุงููุงุฌูุฉ (ูุชุงุจุฉ ุงูุจุท ุงูุญู!): </p><br><pre style=";text-align:right;direction:rtl"> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> statusError <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { GRPCStatus() *status.Status } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isGrpcStatusError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(er error)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bool</span></span></span></span> { _, ok := err.(statusError) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ok } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">translateError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(err error)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> isGrpcStatusError(err) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> err } <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> errors.Cause(err) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> app.ErrNoCake: err = status.Errorf(codes.NotFound, err.Error()) <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: err = status.Errorf(codes.Internal, err.Error()) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> err }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุชู ุฅูุดุงุก ูุธููุฉ <code>translateError</code> ุจุดูู ูุฑุฏู ููู ุณูุงู (ูุญุฏุฉ ูุณุชููุฉ) ูู microservice ูุชุฑุฌูุฉ ุฃุฎุทุงุก ููุทู ุงูุฃุนูุงู ุฅูู ุฃุฎุทุงุก ุนูู ูุณุชูู ุงูููู. </p><br><h2 id="podvedyom-itogi" style=";text-align:right;direction:rtl">  ูุชูุฎูุต </h2><br><p style=";text-align:right;direction:rtl">  ูุญู ููุฏู ูู ุงูุนุฏูุฏ ูู ุงูููุงุนุฏ ููุชุนุงูู ูุน ุงูุฃุฎุทุงุก ูุงูุนูู ูุน ุงูุณุฌูุงุช.  ุณูุงุก ููุช ุชุฑูุฏ ูุชุงุจุนุชู ุฃู ูุง. </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงุชุจุน ูุจุงุฏุฆ ุงูููุฏุณุฉ ุงููุนูุงุฑูุฉ ุงููุธููุฉ ุ ูุง ุชุฎุฑู ุจุดูู ูุจุงุดุฑ ุฃู ุบูุฑ ูุจุงุดุฑ ูุงุนุฏุฉ ุงูุชุจุนูุงุช.  ูุฌุจ ุฃู ูุนุชูุฏ ููุทู ุงูุฃุนูุงู ุนูู ูุบุฉ ุงูุจุฑูุฌุฉ ููุท ูููุณ ุนูู ุงูุชูููุงุช ุงูุฎุงุฑุฌูุฉ. </li><li style=";text-align:right;direction:rtl">  ุงุณุชุฎุฏู ุญุฒูุฉ ุชููุฑ ุชูููู ุงูุฃุฎุทุงุก ูุฅูุดุงุก stacktrace.  ุนูู ุณุจูู ุงููุซุงู ุ "github.com/pkg/errors" ุฃู ุงูุญุฒูุฉ xerrors ุ ูุงูุชู ุณุชุตุจุญ ูุฑูุจูุง ุฌุฒุกูุง ูู ููุชุจุฉ Go ุงูููุงุณูุฉ. </li><li style=";text-align:right;direction:rtl">  ูุง ุชุณุชุฎุฏู ููุชุจุงุช ุชุณุฌูู ุงูุฌูุงุช ุงูุฎุงุฑุฌูุฉ ูู ุงูุฎุฏูุฉ ุงููุตุบุฑุฉ - ูู ุจุฅูุดุงุก ููุชุจุชู ุงูุฎุงุตุฉ ุจุงุณุชุฎุฏุงู ุญุฒู ุงูุณุฌู ู jsonlog ุ ูุงูุชู ุณุชุฎูู ุชูุงุตูู ุชูููุฐ ุงูุชุณุฌูู </li><li style=";text-align:right;direction:rtl">  ุงุณุชุฎุฏู ููุท Middleware ููุนุงูุฌุฉ ุงูุฃุฎุทุงุก ููุชุงุจุฉ ุงูุณุฌูุงุช ูู ุงุชุฌุงู ุงูููู ููุณุชูู ุงูุจููุฉ ุงูุฃุณุงุณูุฉ ููุจุฑูุงูุฌ </li></ol><br><p style=";text-align:right;direction:rtl">  ูู ูุฐูุฑ ููุง ุฃู ุดูุก ุญูู ุชูููุงุช ุชุชุจุน ุงูุงุณุชุนูุงู (ุนูู ุณุจูู ุงููุซุงู ุ OpenTracing) ุ ููุฑุงูุจุฉ ุงูููุงููุณ (ุนูู ุณุจูู ุงููุซุงู ุ ุฃุฏุงุก ุงุณุชุนูุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช) ูุฃุดูุงุก ุฃุฎุฑู ูุซู ุงูุชุณุฌูู.  ุฃูุช ููุณู ุณูู ุชุชุนุงูู ูุน ูุฐุง ุ ููุญู ูุคูู ุจู. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar459130/">https://habr.com/ru/post/ar459130/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar459118/index.html">ููู ูููุง ุจุชุตููู ูุชูููุฐ ุงูุดุจูุฉ ุงูุฌุฏูุฏุฉ ุนูู Huawei ูู ููุชุจ ููุณูู ุ ุงูุฌุฒุก 2</a></li>
<li><a href="../ar459120/index.html">ุฃุฌูุฒุฉ UNO-1000/2000 ุณูุณูุฉ ุญูุงุณุจ ูุฏูุฌุฉ</a></li>
<li><a href="../ar459122/index.html">ุฃูููุณู ุณุงูุงุชูู: ุฌุงุฆุฒุฉ ููุจู ูุฌูู ุชูุฑูู ูุชุญููู ุงูุฃุณูุงู ุบูุฑ ุงููุงููุฉ (2014) ูุงูุณูุนุฉ ุงูุฌูุงุนูุฉ</a></li>
<li><a href="../ar459126/index.html">ุชูุช ุงูุนููู ุฑูุจูุช ุฏุจุงุจุงุช ูุน ุฅูุชู ุงูุนุตุจูุฉ ุงูุญุงุณูุจ ุนุตุง 2</a></li>
<li><a href="../ar459128/index.html">ูุงุฌูุงุช ุงููุงุจุงููุฉ ูู ุงูุนุงูู ุงูุญูููู</a></li>
<li><a href="../ar459134/index.html">ุชุฌุฑุจุฉ ุงุณุชุฎุฏุงู BDD</a></li>
<li><a href="../ar459136/index.html">ุญุจูุจ ููุน ุงูุญูู ุงูุฃุฒุฑู ููููุฉ</a></li>
<li><a href="../ar459138/index.html">ููู ูุตู ุงูููุชุงุญ ุงูุณุฑู ูู Huawei ุฅูู ุงูุจุฑุงูุฌ ุงูุซุงุจุชุฉ ูุฃุฌูุฒุฉ ุชูุฌูู Cisco</a></li>
<li><a href="../ar459140/index.html">ููุถุน ุงูุฒุฑุน: ููู ูุชู ุฐููุ</a></li>
<li><a href="../ar459142/index.html">ุจูุงุก ุฑุณู ูุชุญุฑู ูุชูุณุท โโุฎุท ูุชุญุฑู ูู R. ุงุณุชุฑุฏุงุฏ ุงูุจูุงูุงุช ูู ุฎูุงู NBA API</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>