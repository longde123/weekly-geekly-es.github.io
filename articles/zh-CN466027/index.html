<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ³ï¸ ğŸŸ ğŸ•°ï¸ ã€Š Pythonä¹‹è·¯ã€‹ä¸€ä¹¦ã€‚ å¼€å‘ï¼Œæ‰©å±•ï¼Œæµ‹è¯•å’Œéƒ¨ç½²çš„é»‘å¸¦â€ ğŸ”¦ ğŸ¦† â¬›ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å—¨ï¼Œhabrozhiteliï¼ Pythonè·¯å¾„ä½¿æ‚¨å¯ä»¥ç£¨ç»ƒä¸“ä¸šæŠ€èƒ½å¹¶å°½å¯èƒ½å¤šåœ°äº†è§£æœ€æµè¡Œçš„ç¼–ç¨‹è¯­è¨€çš„åŠŸèƒ½ã€‚ æ‚¨å°†å­¦ä¹ å¦‚ä½•ç¼–å†™æœ‰æ•ˆçš„ä»£ç ï¼Œåœ¨æœ€çŸ­çš„æ—¶é—´å†…åˆ›å»ºæœ€ä½³çš„ç¨‹åºå¹¶é¿å…å¸¸è§çš„é”™è¯¯ã€‚ ç°åœ¨æ˜¯æ—¶å€™äº†è§£å¤šçº¿ç¨‹è®¡ç®—å’Œå¤‡æ³¨ï¼Œè·å–APIå’Œæ•°æ®åº“è®¾è®¡é¢†åŸŸçš„ä¸“å®¶æ„è§ï¼Œä»¥åŠæ·±å…¥äº†è§£Pythonæ¥åŠ æ·±å¯¹è¯­è¨€çš„äº†è§£çš„...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ã€Š Pythonä¹‹è·¯ã€‹ä¸€ä¹¦ã€‚ å¼€å‘ï¼Œæ‰©å±•ï¼Œæµ‹è¯•å’Œéƒ¨ç½²çš„é»‘å¸¦â€</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/466027/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/kq/of/aw/kqofawsaidazmnefdopvktmtxei.jpeg" align="left" alt="å›¾ç‰‡"></a> å—¨ï¼Œhabrozhiteliï¼  Pythonè·¯å¾„ä½¿æ‚¨å¯ä»¥ç£¨ç»ƒä¸“ä¸šæŠ€èƒ½å¹¶å°½å¯èƒ½å¤šåœ°äº†è§£æœ€æµè¡Œçš„ç¼–ç¨‹è¯­è¨€çš„åŠŸèƒ½ã€‚ æ‚¨å°†å­¦ä¹ å¦‚ä½•ç¼–å†™æœ‰æ•ˆçš„ä»£ç ï¼Œåœ¨æœ€çŸ­çš„æ—¶é—´å†…åˆ›å»ºæœ€ä½³çš„ç¨‹åºå¹¶é¿å…å¸¸è§çš„é”™è¯¯ã€‚ ç°åœ¨æ˜¯æ—¶å€™äº†è§£å¤šçº¿ç¨‹è®¡ç®—å’Œå¤‡æ³¨ï¼Œè·å–APIå’Œæ•°æ®åº“è®¾è®¡é¢†åŸŸçš„ä¸“å®¶æ„è§ï¼Œä»¥åŠæ·±å…¥äº†è§£Pythonæ¥åŠ æ·±å¯¹è¯­è¨€çš„äº†è§£çš„æ—¶å€™äº†ã€‚ æ‚¨å¿…é¡»å¯åŠ¨ä¸€ä¸ªé¡¹ç›®ï¼Œä½¿ç”¨ç‰ˆæœ¬ï¼Œç»„ç»‡è‡ªåŠ¨æµ‹è¯•å¹¶ä¸ºç‰¹å®šä»»åŠ¡é€‰æ‹©ç¼–ç¨‹æ ·å¼ã€‚ ç„¶åï¼Œæ‚¨å°†ç»§ç»­ç ”ç©¶æœ‰æ•ˆçš„å‡½æ•°å£°æ˜ï¼Œé€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„å’Œåº“ï¼Œåˆ›å»ºæ— æ•…éšœçš„ç¨‹åºï¼Œç¨‹åºåŒ…å¹¶åœ¨å­—èŠ‚ç çº§åˆ«ä¸Šä¼˜åŒ–ç¨‹åºã€‚ <br><a name="habracut"></a><br><h3> æ‘˜å½•ã€‚ å¹¶è¡Œè¿è¡Œæµ‹è¯• </h3><br> è¿è¡Œæµ‹è¯•å¥—ä»¶å¯èƒ½å¾ˆè€—æ—¶ã€‚ å½“æµ‹è¯•å¥—ä»¶éœ€è¦å‡ åˆ†é’Ÿçš„æ—¶é—´æ‰èƒ½å®Œæˆæ—¶ï¼Œè¿™åœ¨å¤§å‹é¡¹ç›®ä¸­å¾ˆå¸¸è§ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼ŒpytestæŒ‰ç‰¹å®šé¡ºåºé¡ºåºè¿è¡Œæµ‹è¯•ã€‚ <br><br> ç”±äºå¤§å¤šæ•°è®¡ç®—æœºéƒ½å…·æœ‰å¤šæ ¸å¤„ç†å™¨ï¼Œå› æ­¤ï¼Œå¦‚æœæ‚¨å°†æµ‹è¯•åˆ†å¼€ä»¥åœ¨å¤šæ ¸ä¸Šè¿è¡Œï¼Œåˆ™å¯ä»¥åŠ å¿«é€Ÿåº¦ã€‚ <br><br> ä¸ºæ­¤ï¼Œpytestæœ‰ä¸€ä¸ªpytest-xdistæ’ä»¶ï¼Œå¯ä»¥ä½¿ç”¨pipè¿›è¡Œå®‰è£…ã€‚ è¯¥æ’ä»¶ä½¿ç”¨â€“â€“numprocessesï¼ˆç¼©å†™ä¸ºâ€“nï¼‰å‚æ•°æ‰©å±•äº†pytestå‘½ä»¤è¡Œï¼Œè¯¥å‚æ•°å°†ç”¨ä½œå‚æ•°çš„å†…æ ¸æ•°ã€‚ å¯åŠ¨pytest â€“n 4å°†åœ¨å››ä¸ªå¹¶è¡Œè¿›ç¨‹ä¸­è¿è¡Œæµ‹è¯•å¥—ä»¶ï¼Œä»è€Œåœ¨å¯ç”¨å†…æ ¸è´Ÿè½½ä¹‹é—´ä¿æŒå¹³è¡¡ã€‚ <br><br> ç”±äºå†…æ ¸æ•°é‡å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼Œå› æ­¤æ’ä»¶ä¹Ÿæ¥å—autoå…³é”®å­—ä½œä¸ºå€¼ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ç”¨å†…æ ¸æ•°å°†è‡ªåŠ¨è¿”å›ã€‚ <br><br><h3> ä½¿ç”¨å¤¹å…·åˆ›å»ºæµ‹è¯•ä¸­ä½¿ç”¨çš„å¯¹è±¡ </h3><br> åœ¨å•å…ƒæµ‹è¯•ä¸­ï¼Œé€šå¸¸éœ€è¦åœ¨è¿è¡Œæµ‹è¯•ä¹‹å‰å’Œä¹‹åæ‰§è¡Œä¸€ç»„æ ‡å‡†æ“ä½œï¼Œå¹¶ä¸”è¿™äº›è¯´æ˜æ¶‰åŠæŸäº›ç»„ä»¶ã€‚ ä¾‹å¦‚ï¼Œæ‚¨å¯èƒ½éœ€è¦ä¸€ä¸ªå¯¹è±¡æ¥è¡¨è¾¾åº”ç”¨ç¨‹åºé…ç½®çš„çŠ¶æ€ï¼Œå¹¶ä¸”å¿…é¡»åœ¨æ¯æ¬¡æµ‹è¯•ä¹‹å‰å°†å…¶åˆå§‹åŒ–ï¼Œç„¶ååœ¨æ‰§è¡Œåå°†å…¶é‡ç½®ä¸ºåˆå§‹å€¼ã€‚ åŒæ ·ï¼Œå¦‚æœæµ‹è¯•ä¾èµ–äºä¸´æ—¶æ–‡ä»¶ï¼Œåˆ™å¿…é¡»åœ¨æµ‹è¯•ä¹‹å‰åˆ›å»ºæ­¤æ–‡ä»¶ï¼Œç„¶ååœ¨æµ‹è¯•ä¹‹ååˆ é™¤ã€‚ è¿™äº›ç»„ä»¶ç§°ä¸º<i>å›ºå®šè£…ç½®</i> ã€‚ å®ƒä»¬åœ¨æµ‹è¯•ä¹‹å‰å·²å®‰è£…ï¼Œå¹¶åœ¨æ‰§è¡Œåæ¶ˆå¤±ã€‚ <br><br> åœ¨pytestä¸­ï¼Œfixtureè¢«å£°æ˜ä¸ºç®€å•å‡½æ•°ã€‚ å¤¹å…·å‡½æ•°å¿…é¡»è¿”å›æ‰€éœ€çš„å¯¹è±¡ï¼Œä»¥ä¾¿åœ¨æµ‹è¯•ä½¿ç”¨å®ƒçš„ä½ç½®æ—¶å¯ä»¥ä½¿ç”¨è¯¥å¯¹è±¡ã€‚ <br><br> è¿™æ˜¯ä¸€ä¸ªç®€å•çš„å¤¹å…·ç¤ºä¾‹ï¼š <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pytest @pytest.fixture <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">database</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> &lt;some database connection&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_insert</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(database)</span></span></span><span class="hljs-function">:</span></span> database.insert(<span class="hljs-number"><span class="hljs-number">123</span></span>)</code> </pre> <br> åˆ—è¡¨ä¸­åŒ…å«æ•°æ®åº“å‚æ•°çš„ä»»ä½•æµ‹è¯•éƒ½ä¼šè‡ªåŠ¨ä½¿ç”¨æ•°æ®åº“å›ºå®šè£…ç½®ã€‚  test_insertï¼ˆï¼‰å‡½æ•°å°†æ¥æ”¶databaseï¼ˆï¼‰å‡½æ•°çš„ç»“æœä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå¹¶å°†åœ¨è®¤ä¸ºåˆé€‚æ—¶ä½¿ç”¨æ­¤ç»“æœã€‚ é€šè¿‡ä½¿ç”¨å›ºå®šè£…ç½®ï¼Œæ‚¨æ— éœ€é‡å¤å¤šæ¬¡æ•°æ®åº“åˆå§‹åŒ–ä»£ç ã€‚ <br><br> ä»£ç æµ‹è¯•çš„å¦ä¸€ä¸ªå…±åŒç‰¹å¾æ˜¯åœ¨å¤¹å…·æ“ä½œåèƒ½å¤Ÿå»é™¤å¤šä½™çš„ä¸œè¥¿ã€‚ ä¾‹å¦‚ï¼Œå…³é—­æ•°æ®åº“è¿æ¥ã€‚ å°†å¤¹å…·å®ç°ä¸ºç”Ÿæˆå™¨å°†æ·»åŠ ç”¨äºæ¸…ç†å·²éªŒè¯å¯¹è±¡çš„åŠŸèƒ½ï¼ˆæ¸…å•6.5ï¼‰ã€‚ <br><br><blockquote><h4> æ¸…å•6.5ã€‚ æ¸…é™¤å·²éªŒè¯çš„å¯¹è±¡ </h4><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pytest @pytest.fixture <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">database</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> db = &lt;some database connection&gt; <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> db db.close() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_insert</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(database)</span></span></span><span class="hljs-function">:</span></span> database.insert(<span class="hljs-number"><span class="hljs-number">123</span></span>)</code> </pre> </blockquote> ç”±äºæˆ‘ä»¬ä½¿ç”¨äº†yieldå…³é”®å­—å¹¶ä»æ•°æ®åº“ä¸­ç”Ÿæˆäº†ä¸€ä¸ªç”Ÿæˆå™¨ï¼Œæ‰€ä»¥yieldè¯­å¥ä¹‹åçš„ä»£ç ä»…åœ¨æµ‹è¯•ç»“æŸæ—¶æ‰§è¡Œã€‚ è¯¥ä»£ç å°†åœ¨æµ‹è¯•ç»“æŸæ—¶å…³é—­æ•°æ®åº“è¿æ¥ã€‚ <br><br> å¯¹äºæ¯ä¸ªæµ‹è¯•ï¼Œå…³é—­æ•°æ®åº“è¿æ¥å¯èƒ½ä¼šå¯¼è‡´ä¸åˆç†çš„è®¡ç®—èƒ½åŠ›æµªè´¹ï¼Œå› ä¸ºå…¶ä»–æµ‹è¯•å¯èƒ½ä¼šä½¿ç”¨å·²ç»æ‰“å¼€çš„è¿æ¥ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥å°†scopeå‚æ•°ä¼ é€’ç»™ç¯å…·è£…é¥°å™¨ï¼Œå¹¶æŒ‡å®šå…¶èŒƒå›´ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pytest @pytest.fixture(scope=<span class="hljs-string"><span class="hljs-string">"module"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">database</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> db = &lt;some database connection&gt; <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> db db.close() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_insert</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(database)</span></span></span><span class="hljs-function">:</span></span> database.insert(<span class="hljs-number"><span class="hljs-number">123</span></span>)</code> </pre> <br> é€šè¿‡æŒ‡å®šscope =â€œ moduleâ€å‚æ•°ï¼Œæ‚¨å¯ä»¥ä¸ºæ•´ä¸ªæ¨¡å—åˆå§‹åŒ–ä¸€æ¬¡å›ºå®šè£…ç½®ï¼Œç°åœ¨æ‰€æœ‰è¯·æ±‚å®ƒçš„æµ‹è¯•åŠŸèƒ½éƒ½å¯ä»¥ä½¿ç”¨å¼€æ”¾å¼æ•°æ®åº“è¿æ¥ã€‚ <br><br> æ‚¨å¯ä»¥åœ¨æµ‹è¯•ä¹‹å‰æˆ–ä¹‹åè¿è¡Œä¸€äº›å¸¸è§„ä»£ç ï¼Œå°†å›ºå®šè£…ç½®å®šä¹‰ä¸ºä¸autouseå…³é”®å­—ä¸€èµ·è‡ªåŠ¨ä½¿ç”¨ï¼Œè€Œä¸æ˜¯å°†å®ƒä»¬æŒ‡å®šä¸ºæ¯ä¸ªæµ‹è¯•åŠŸèƒ½çš„å‚æ•°ã€‚ ä½¿ç”¨Trueå‚æ•°ï¼ˆå³autouseå…³é”®å­—ï¼‰å¯¹pytest.fixtureï¼ˆï¼‰å‡½æ•°è¿›è¡Œå…·ä½“åŒ–ï¼Œå¯ç¡®ä¿æ¯æ¬¡åœ¨å£°æ˜äº†æ¨¡å—æˆ–ç±»çš„æµ‹è¯•ä¸­è¿è¡Œæµ‹è¯•ä¹‹å‰éƒ½è°ƒç”¨Fixtureã€‚ <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pytest @pytest.fixture(autouse=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">change_user_env</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> curuser = os.environ.get(<span class="hljs-string"><span class="hljs-string">"USER"</span></span>) os.environ[<span class="hljs-string"><span class="hljs-string">"USER"</span></span>] = <span class="hljs-string"><span class="hljs-string">"foobar"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> os.environ[<span class="hljs-string"><span class="hljs-string">"USER"</span></span>] = curuser <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_user</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> os.getenv(<span class="hljs-string"><span class="hljs-string">"USER"</span></span>) == <span class="hljs-string"><span class="hljs-string">"foobar"</span></span>&lt;/source     .  ,    :     ,      ,       . &lt;h3&gt;  &lt;/h3&gt;           ,    ,   ,         .          Gnocchi,    . Gnocchi      &lt;i&gt;storage API&lt;/i&gt;.    Python          .       ,      API   .        ,      (    storage API),  ,       .   ,   &lt;i&gt; &lt;/i&gt;,     ,        .  <span class="hljs-number"><span class="hljs-number">6.6</span></span>          ,    :    mysql,   â€”  postgresql. &lt;blockquote&gt;&lt;h4&gt; <span class="hljs-number"><span class="hljs-number">6.6</span></span>.      &lt;/h4&gt; &lt;source lang=<span class="hljs-string"><span class="hljs-string">"python"</span></span>&gt;<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pytest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> myapp @pytest.fixture(params=[<span class="hljs-string"><span class="hljs-string">"mysql"</span></span>, <span class="hljs-string"><span class="hljs-string">"postgresql"</span></span>]) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">database</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(request)</span></span></span><span class="hljs-function">:</span></span> d = myapp.driver(request.param) d.start() <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> d d.stop() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_insert</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(database)</span></span></span><span class="hljs-function">:</span></span> database.insert(<span class="hljs-string"><span class="hljs-string">"somedata"</span></span>)</code> </pre> é©±åŠ¨ç¨‹åºå›ºå®šè£…ç½®æ¥æ”¶ä¸¤ä¸ªä¸åŒçš„å€¼ä½œä¸ºå‚æ•°-åº”ç”¨ç¨‹åºæ”¯æŒçš„æ•°æ®åº“é©±åŠ¨ç¨‹åºçš„åç§°ã€‚  test_insertè¿è¡Œä¸¤æ¬¡ï¼šä¸€æ¬¡ç”¨äºMySQLæ•°æ®åº“ï¼Œç¬¬äºŒæ¬¡ç”¨äºPostgreSQLæ•°æ®åº“ã€‚ è¿™ä½¿å¾—åœ¨ä¸æ·»åŠ æ–°ä»£ç è¡Œçš„æƒ…å†µä¸‹ï¼Œè½»æ¾è¿›è¡Œç›¸åŒçš„æµ‹è¯•ï¼Œä½†å…·æœ‰ä¸åŒçš„åœºæ™¯ã€‚ <br><br><h3> è™šæ‹Ÿå¯¹è±¡çš„æ‰˜ç®¡æµ‹è¯• </h3><br> è™šæ‹Ÿå¯¹è±¡ï¼ˆæˆ–å­˜æ ¹ï¼Œæ¨¡æ‹Ÿå¯¹è±¡ï¼‰æ˜¯æ¨¡ä»¿çœŸå®åº”ç”¨ç¨‹åºå¯¹è±¡è¡Œä¸ºçš„å¯¹è±¡ï¼Œä½†å¤„äºç‰¹æ®Šçš„å—æ§çŠ¶æ€ã€‚ å®ƒä»¬åœ¨åˆ›å»ºèƒ½å¤Ÿå…¨é¢æè¿°æµ‹è¯•æ¡ä»¶çš„ç¯å¢ƒä¸­æœ€æœ‰ç”¨ã€‚ æ‚¨å¯ä»¥ç”¨è™šæ‹Ÿå¯¹è±¡æ›¿æ¢é™¤æµ‹è¯•å¯¹è±¡ä»¥å¤–çš„æ‰€æœ‰å¯¹è±¡ï¼Œå¹¶éš”ç¦»å®ƒä»¬ï¼Œå¹¶åˆ›å»ºä»£ç æµ‹è¯•ç¯å¢ƒã€‚ <br><br> ä¸€ç§ç”¨ä¾‹æ˜¯åˆ›å»ºä¸€ä¸ªHTTPå®¢æˆ·ç«¯ã€‚ åˆ›å»ºHTTPæœåŠ¡å™¨å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ï¼ˆæˆ–è€…è¯´æ˜¯æå…¶å›°éš¾çš„ï¼‰ï¼Œåœ¨è¯¥æœåŠ¡å™¨ä¸Šå¯ä»¥ä¸ºæ¯ä¸ªå¯èƒ½çš„å€¼è¿è¡Œæ‰€æœ‰æƒ…å†µå’Œæ–¹æ¡ˆã€‚  HTTPå®¢æˆ·ç«¯ç‰¹åˆ«éš¾ä»¥æµ‹è¯•é”™è¯¯æƒ…å†µã€‚ <br><br> æ ‡å‡†åº“æœ‰ä¸€ä¸ªæ¨¡æ‹Ÿå‘½ä»¤æ¥åˆ›å»ºè™šæ‹Ÿå¯¹è±¡ã€‚ ä»Python 3.3å¼€å§‹ï¼Œmockå·²ä¸unittest.mockåº“é›†æˆã€‚ å› æ­¤ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç æ®µåœ¨Python 3.3å’Œæ›´æ—©ç‰ˆæœ¬ä¹‹é—´æä¾›å‘åå…¼å®¹æ€§ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> unittest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mock <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> ImportError: <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mock</code> </pre> <br> æ¨¡æ‹Ÿåº“éå¸¸æ˜“äºä½¿ç”¨ã€‚ å¯ç”¨äºå˜²ç¬‘å¯¹è±¡çš„ä»»ä½•å±æ€§éƒ½æ˜¯åœ¨è¿è¡Œæ—¶åŠ¨æ€åˆ›å»ºçš„ã€‚ å¯ä»¥ä¸ºä»»ä½•å±æ€§åˆ†é…ä»»ä½•å€¼ã€‚ åœ¨æ¸…å•6.7ä¸­ï¼Œæ¨¡æ‹Ÿç”¨äºä¸ºdummyå±æ€§åˆ›å»ºä¸€ä¸ªå“‘å¯¹è±¡ã€‚ <br><blockquote><h4> æ¸…å•6.7ã€‚ è®¿é—®mock.Mockå±æ€§ </h4><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> unittest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mock &gt;&gt;&gt; m = mock.Mock() &gt;&gt;&gt; m.some_attribute = <span class="hljs-string"><span class="hljs-string">"hello world"</span></span> &gt;&gt;&gt; m.some_attribute <span class="hljs-string"><span class="hljs-string">"hello world"</span></span></code> </pre> </blockquote> æ‚¨è¿˜å¯ä»¥ä¸ºå¯å˜å¯¹è±¡åŠ¨æ€åˆ›å»ºä¸€ä¸ªæ–¹æ³•ï¼Œå¦‚æ¸…å•6.8æ‰€ç¤ºï¼Œåœ¨è¯¥æ–¹æ³•ä¸­ï¼Œæ‚¨å°†åˆ›å»ºä¸€ä¸ªå§‹ç»ˆè¿”å›42å¹¶å°†æ‰€éœ€çš„å†…å®¹ä½œä¸ºå‚æ•°çš„è™šæ‹Ÿæ–¹æ³•ã€‚ <br><blockquote><h4> æ¸…å•6.8 ä¸ºå˜²ç¬‘æ¨¡æ‹Ÿå¯¹è±¡åˆ›å»ºæ–¹æ³• </h4><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> unittest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mock &gt;&gt;&gt; m = mock.Mock() &gt;&gt;&gt; m.some_method.return_value = <span class="hljs-number"><span class="hljs-number">42</span></span> &gt;&gt;&gt; m.some_method() <span class="hljs-number"><span class="hljs-number">42</span></span> &gt;&gt;&gt; m.some_method(<span class="hljs-string"><span class="hljs-string">"with"</span></span>, <span class="hljs-string"><span class="hljs-string">"arguments"</span></span>) <span class="hljs-number"><span class="hljs-number">42</span></span></code> </pre> </blockquote> ç°åœ¨åªæœ‰ä¸¤è¡Œï¼Œå¹¶ä¸”mock.Mockå¯¹è±¡ç°åœ¨å…·æœ‰some_methodï¼ˆï¼‰æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›42ã€‚å®ƒæ¥å—ä»»ä½•ç±»å‹çš„å‚æ•°ï¼Œè€Œæ²¡æœ‰éªŒè¯è¯¥å‚æ•°æ˜¯ä»€ä¹ˆã€‚ <br><br> åŠ¨æ€ç”Ÿæˆçš„æ–¹æ³•ä¹Ÿå¯èƒ½å…·æœ‰ï¼ˆæ•…æ„ï¼‰å‰¯ä½œç”¨ã€‚ ä¸ºäº†ä¸ä»…ä»…æ˜¯è¿”å›å€¼çš„æ ·æ¿æ–¹æ³•ï¼Œå¯ä»¥å°†å®ƒä»¬å®šä¹‰ä¸ºæ‰§è¡Œæœ‰ç”¨çš„ä»£ç ã€‚ <br><br> æ¸…å•6.9åˆ›å»ºäº†ä¸€ä¸ªå…·æœ‰å‰¯ä½œç”¨çš„è™šæ‹Ÿæ–¹æ³•-å®ƒæ˜¾ç¤ºå­—ç¬¦ä¸²â€œ hello worldâ€ã€‚ <br><blockquote><h4> æ¸…å•6.9ã€‚ åˆ›å»ºå¸¦æœ‰å‰¯ä½œç”¨çš„æ¨¡æ‹Ÿå¯¹è±¡çš„æ–¹æ³• </h4><br><pre> <code class="python hljs"> &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> unittest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mock &gt;&gt;&gt; m = mock.Mock() &gt;&gt;&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">print_hello</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> ... print(<span class="hljs-string"><span class="hljs-string">"hello world!"</span></span>) ... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">43</span></span> ... â¶ &gt;&gt;&gt; m.some_method.side_effect = print_hello &gt;&gt;&gt; m.some_method() hello world! <span class="hljs-number"><span class="hljs-number">43</span></span> â· &gt;&gt;&gt; m.some_method.call_count <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> </blockquote> æˆ‘ä»¬å°†æ•´ä¸ªå‡½æ•°åˆ†é…ç»™some_methodâ¶å±æ€§ã€‚ ä»æŠ€æœ¯ä¸Šè®²ï¼Œç”±äºæ‚¨å¯ä»¥åœ¨è™šæ‹Ÿå¯¹è±¡ä¸­åŒ…æ‹¬æµ‹è¯•æ‰€éœ€çš„ä»»ä½•ä»£ç ï¼Œå› æ­¤ï¼Œè¿™å…è®¸æ‚¨åœ¨æµ‹è¯•ä¸­å®ç°æ›´å¤æ‚çš„æ–¹æ¡ˆã€‚ æ¥ä¸‹æ¥ï¼Œæ‚¨éœ€è¦å°†æ­¤å¯¹è±¡ä¼ é€’ç»™æœŸæœ›å®ƒçš„å‡½æ•°ã€‚ <br><br>  â·call_countå±æ€§æ˜¯ä¸€ç§æ£€æŸ¥æ–¹æ³•è¢«è°ƒç”¨æ¬¡æ•°çš„ç®€ä¾¿æ–¹æ³•ã€‚ <br><br> æ¨¡æ‹Ÿåº“ä½¿ç”¨â€œåŠ¨ä½œæ£€æŸ¥â€æ¨¡å¼ï¼šè¿™æ„å‘³ç€åœ¨æµ‹è¯•åï¼Œæ‚¨éœ€è¦ç¡®ä¿æ­£ç¡®æ‰§è¡Œäº†ç”±å‡äººæ›¿æ¢çš„åŠ¨ä½œã€‚ æ¸…å•6.10å°†assertï¼ˆï¼‰æ–¹æ³•åº”ç”¨äºè™šæ‹Ÿå¯¹è±¡ä»¥æ‰§è¡Œè¿™äº›æ£€æŸ¥ã€‚ <br><blockquote><h4> æ¸…å•6.10 é€šè¯éªŒè¯æ–¹å¼ </h4><br><pre> <code class="python hljs"> &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> unittest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mock &gt;&gt;&gt; m = mock.Mock() â¶ &gt;&gt;&gt; m.some_method(<span class="hljs-string"><span class="hljs-string">'foo'</span></span>, <span class="hljs-string"><span class="hljs-string">'bar'</span></span>) &lt;Mock name=<span class="hljs-string"><span class="hljs-string">'mock.some_method()'</span></span> id=<span class="hljs-string"><span class="hljs-string">'26144272'</span></span>&gt; â· &gt;&gt;&gt; m.some_method.assert_called_once_with(<span class="hljs-string"><span class="hljs-string">'foo'</span></span>, <span class="hljs-string"><span class="hljs-string">'bar'</span></span>) &gt;&gt;&gt; m.some_method.assert_called_once_with(<span class="hljs-string"><span class="hljs-string">'foo'</span></span>, â¸mock.ANY) &gt;&gt;&gt; m.some_method.assert_called_once_with(<span class="hljs-string"><span class="hljs-string">'foo'</span></span>, <span class="hljs-string"><span class="hljs-string">'baz'</span></span>) Traceback (most recent call last): File <span class="hljs-string"><span class="hljs-string">"&lt;stdin&gt;"</span></span>, line <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> &lt;module&gt; File <span class="hljs-string"><span class="hljs-string">"/usr/lib/python2.7/dist-packages/mock.py"</span></span>, line <span class="hljs-number"><span class="hljs-number">846</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> assert_cal led_once_with <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.assert_called_with(*args, **kwargs) File <span class="hljs-string"><span class="hljs-string">"/usr/lib/python2.7/dist-packages/mock.py"</span></span>, line <span class="hljs-number"><span class="hljs-number">835</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> assert_cal led_with <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> AssertionError(msg) AssertionError: Expected call: some_method(<span class="hljs-string"><span class="hljs-string">'foo'</span></span>, <span class="hljs-string"><span class="hljs-string">'baz'</span></span>) Actual call: some_method(<span class="hljs-string"><span class="hljs-string">'foo'</span></span>, <span class="hljs-string"><span class="hljs-string">'bar'</span></span>)</code> </pre> </blockquote> æˆ‘ä»¬é€šè¿‡è°ƒç”¨â¶æ–¹æ³•åˆ›å»ºäº†å¸¦æœ‰fooå’Œbarå‚æ•°ä½œä¸ºæµ‹è¯•çš„æ–¹æ³•ã€‚ æµ‹è¯•å¯¹ä¼ªå¯¹è±¡çš„è°ƒç”¨çš„ä¸€ç§ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨assert_drawnï¼ˆï¼‰æ–¹æ³•ï¼Œä¾‹å¦‚assert_drawn_once_withï¼ˆï¼‰â·ã€‚ å¯¹äºè¿™äº›æ–¹æ³•ï¼Œæ‚¨éœ€è¦åœ¨è°ƒç”¨è™šæ‹Ÿæ–¹æ³•æ—¶ä¼ é€’å¸Œæœ›ä½¿ç”¨çš„å€¼ã€‚ å¦‚æœä¼ é€’çš„å€¼ä¸ä½¿ç”¨çš„å€¼ä¸åŒï¼Œåˆ™æ¨¡æ‹Ÿç¨‹åºä¼šå¼•å‘AssertionErrorå¼‚å¸¸ã€‚ å¦‚æœæ‚¨ä¸çŸ¥é“å¯ä»¥ä¼ é€’ä»€ä¹ˆå‚æ•°ï¼Œè¯·ä½¿ç”¨mock.ANYä½œä¸ºâ¸çš„å€¼ã€‚ å®ƒå°†æ›¿æ¢ä¼ é€’ç»™dummyæ–¹æ³•çš„æ‰€æœ‰å‚æ•°ã€‚ <br><br> æ¨¡æ‹Ÿåº“è¿˜å¯ä»¥ç”¨äºæ›¿æ¢å¤–éƒ¨æ¨¡å—ä¸­çš„å‡½æ•°ï¼Œæ–¹æ³•æˆ–å¯¹è±¡ã€‚ åœ¨æ¸…å•6.11ä¸­ï¼Œæˆ‘ä»¬ç”¨è‡ªå·±çš„ä¼ªå‡½æ•°æ›¿æ¢äº†os.unlinkï¼ˆï¼‰å‡½æ•°ã€‚ <br><blockquote><h4> æ¸…å•6.11 ä½¿ç”¨å˜²ç¬‘ </h4><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> unittest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mock &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os &gt;&gt;&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fake_os_unlink</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(path)</span></span></span><span class="hljs-function">:</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> IOError(<span class="hljs-string"><span class="hljs-string">"Testing!"</span></span>) ... &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> mock.patch(<span class="hljs-string"><span class="hljs-string">'os.unlink'</span></span>, fake_os_unlink): ... os.unlink(<span class="hljs-string"><span class="hljs-string">'foobar'</span></span>) ... Traceback (most recent call last): File <span class="hljs-string"><span class="hljs-string">"&lt;stdin&gt;"</span></span>, line <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> &lt;module&gt; File <span class="hljs-string"><span class="hljs-string">"&lt;stdin&gt;"</span></span>, line <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> fake_os_unlink IOError: Testing!</code> </pre> </blockquote> å½“ç”¨ä½œä¸Šä¸‹æ–‡ç®¡ç†å™¨æ—¶ï¼Œmock.patchï¼ˆï¼‰å°†ç›®æ ‡å‡½æ•°æ›¿æ¢ä¸ºæˆ‘ä»¬é€‰æ‹©çš„ç›®æ ‡å‡½æ•°ã€‚ è¿™æ˜¯å¿…éœ€çš„ï¼Œä»¥ä¾¿åœ¨ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œçš„ä»£ç ä½¿ç”¨æ›´æ­£çš„æ–¹æ³•ã€‚ ä½¿ç”¨å˜²ç¬‘ï¼ˆã€‚ï¼‰æ–¹æ³•ï¼Œæ‚¨å¯ä»¥ä¿®æ”¹å¤–éƒ¨ä»£ç çš„ä»»ä½•éƒ¨åˆ†ï¼Œä»¥ä½¿å…¶èƒ½å¤Ÿæµ‹è¯•åº”ç”¨ç¨‹åºçš„æ‰€æœ‰æ¡ä»¶çš„æ–¹å¼å·¥ä½œï¼ˆæ¸…å•6.12ï¼‰ã€‚ <br><blockquote><h4> æ¸…å•6.12 ä½¿ç”¨mock.patchï¼ˆï¼‰æµ‹è¯•è®¸å¤šè¡Œä¸º </h4><br><pre> <code class="python hljs"> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> unittest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mock <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pytest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> requests <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WhereIsPythonError</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Exception)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> â¶ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">is_python_still_a_programming_language</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: r = requests.get(<span class="hljs-string"><span class="hljs-string">"http://python.org"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> IOError: <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> r.status_code == <span class="hljs-number"><span class="hljs-number">200</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'Python is a programming language'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> r.content <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> WhereIsPythonError(<span class="hljs-string"><span class="hljs-string">"Something bad happened"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_fake_get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(status_code, content)</span></span></span><span class="hljs-function">:</span></span> m = mock.Mock() m.status_code = status_code m.content = content <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fake_get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(url)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> m <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fake_get <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">raise_get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(url)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> IOError(<span class="hljs-string"><span class="hljs-string">"Unable to fetch url %s"</span></span> % url) â· @mock.patch(<span class="hljs-string"><span class="hljs-string">'requests.get'</span></span>, get_fake_get( <span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-string"><span class="hljs-string">'Python is a programming language for sure'</span></span>)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_python_is</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> is_python_still_a_programming_language() <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> @mock.patch(<span class="hljs-string"><span class="hljs-string">'requests.get'</span></span>, get_fake_get( <span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-string"><span class="hljs-string">'Python is no more a programming language'</span></span>)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_python_is_not</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> is_python_still_a_programming_language() <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> @mock.patch(<span class="hljs-string"><span class="hljs-string">'requests.get'</span></span>, get_fake_get(<span class="hljs-number"><span class="hljs-number">404</span></span>, <span class="hljs-string"><span class="hljs-string">'Whatever'</span></span>)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_bad_status_code</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> pytest.raises(WhereIsPythonError): is_python_still_a_programming_language() @mock.patch(<span class="hljs-string"><span class="hljs-string">'requests.get'</span></span>, raise_get) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_ioerror</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> pytest.raises(WhereIsPythonError): is_python_still_a_programming_language()</code> </pre> </blockquote><br><br> æ¸…å•6.12å®ç°äº†ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œè¯¥ç”¨ä¾‹æŸ¥æ‰¾<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">python.orgä¸Š</a> <i>çš„ç¼–ç¨‹è¯­è¨€</i>å­—ç¬¦ä¸²æ¥æŸ¥æ‰¾<i>Pythonçš„</i>æ‰€æœ‰å®ä¾‹ã€‚ åœ¨æµ‹è¯•ä¸­ä¸ä¼šåœ¨æ‰€é€‰ç½‘é¡µä¸Šæ‰¾ä¸åˆ°ä»»ä½•ç»™å®šçš„è¡Œçš„é€‰é¡¹ã€‚ è¦è·å¾—å¦å®šçš„ç»“æœï¼Œæ‚¨éœ€è¦æ›´æ”¹é¡µé¢ï¼Œä½†è¿™ä¸èƒ½å®Œæˆã€‚ ä½†æ˜¯ï¼Œåœ¨æ¨¡æ‹Ÿçš„å¸®åŠ©ä¸‹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æŠ€å·§æ¥æ›´æ”¹è¯·æ±‚çš„è¡Œä¸ºï¼Œä»¥ä½¿å…¶è¿”å›å¸¦æœ‰è™šæ‹Ÿé¡µé¢çš„è™šæ‹Ÿå“åº”ï¼Œè¯¥é¡µé¢ä¸åŒ…å«ç»™å®šçš„å­—ç¬¦ä¸²ã€‚ è¿™å°†å…è®¸æ‚¨æµ‹è¯•<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">python.org</a>ä¸åŒ…å«ç»™å®šå­—ç¬¦ä¸²çš„å¦å®šæƒ…å†µï¼Œå¹¶ç¡®ä¿ç¨‹åºæ­£ç¡®å¤„ç†äº†è¿™ç§æƒ…å†µã€‚ <br><br> æœ¬ç¤ºä¾‹ä½¿ç”¨äº†mock.patchï¼ˆï¼‰è£…é¥°å™¨ç‰ˆæœ¬ã€‚ è™šæ‹Ÿå¯¹è±¡çš„è¡Œä¸ºä¸ä¼šæ”¹å˜ï¼Œå¹¶ä¸”åœ¨æµ‹è¯•åŠŸèƒ½çš„ä¸Šä¸‹æ–‡ä¸­è®¾ç½®ç¤ºä¾‹æ›´åŠ å®¹æ˜“ã€‚ <br><br> ä½¿ç”¨è™šæ‹Ÿå¯¹è±¡å°†å¸®åŠ©æ¨¡æ‹Ÿä»»ä½•é—®é¢˜ï¼šæœåŠ¡å™¨è¿”å›404é”™è¯¯ï¼ŒI / Oé”™è¯¯æˆ–ç½‘ç»œå»¶è¿Ÿé”™è¯¯ã€‚ æˆ‘ä»¬å¯ä»¥ç¡®ä¿ä»£ç åœ¨æ¯ç§æƒ…å†µä¸‹éƒ½è¿”å›æ­£ç¡®çš„å€¼æˆ–å¼•å‘æ­£ç¡®çš„å¼‚å¸¸ï¼Œä»è€Œä¿è¯äº†ä»£ç çš„é¢„æœŸè¡Œä¸ºã€‚ <br><br><h3> ç¡®å®šæ¶µç›–èŒƒå›´çš„æœªç»æµ‹è¯•çš„ä»£ç  </h3><br> è¦†ç›–ç‡å·¥å…·æ˜¯å¯¹å•å…ƒæµ‹è¯•çš„ä¸€ä¸ªé‡è¦è¡¥å……[ä»£ç è¦†ç›–ç‡æ˜¯æµ‹è¯•ä¸­ä½¿ç”¨çš„ä¸€ç§åº¦é‡ã€‚ æ˜¾ç¤ºåœ¨æµ‹è¯•è¿‡ç¨‹ä¸­æ‰§è¡Œçš„ç¨‹åºæºä»£ç çš„ç™¾åˆ†æ¯”<i>ã€‚</i>  ]ï¼ŒæŸ¥æ‰¾æœªæµ‹è¯•çš„ä»£ç æ®µã€‚ å®ƒä½¿ç”¨ä»£ç åˆ†æå’Œè·Ÿè¸ªå·¥å…·æ¥è¯†åˆ«å·²æ‰§è¡Œçš„è¡Œã€‚ åœ¨å•å…ƒæµ‹è¯•ä¸­ï¼Œå®ƒå¯ä»¥æ­ç¤ºä»£ç çš„å“ªäº›éƒ¨åˆ†è¢«é‡ç”¨ï¼Œå“ªäº›éƒ¨åˆ†æ ¹æœ¬æ²¡æœ‰ä½¿ç”¨ã€‚ åˆ›å»ºæµ‹è¯•æ˜¯å¿…è¦çš„ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ‰¾å‡ºæ‚¨å¿˜è®°ç”¨æµ‹è¯•è¦†ç›–çš„ä»£ç çš„å“ªä¸€éƒ¨åˆ†ï¼Œä½¿æ­¤è¿‡ç¨‹æ›´åŠ æœ‰è¶£ã€‚ <br><br> é€šè¿‡pipå®‰è£…coverageæ¨¡å—ï¼Œä»¥ä¾¿å¯ä»¥åœ¨æ‚¨çš„å¤–å£³ä¸­ä½¿ç”¨å®ƒã€‚ <br><br><blockquote><h4> æ³¨æ„ </h4><br> å¦‚æœé€šè¿‡æ“ä½œç³»ç»Ÿçš„å®‰è£…ç¨‹åºå®‰è£…äº†è¯¥æ¨¡å—ï¼Œåˆ™è¯¥å‘½ä»¤ä¹Ÿå¯ä»¥ç§°ä¸ºpython-coverageã€‚ ä¾‹å¦‚Debian OSã€‚ </blockquote><br><br> ç¦»çº¿ä½¿ç”¨è¦†ç›–éå¸¸ç®€å•ã€‚ å®ƒæ˜¾ç¤ºäº†ç¨‹åºä¸­æ°¸è¿œä¸ä¼šå¯åŠ¨å¹¶å˜æˆâ€œæ­»é‡â€çš„éƒ¨åˆ†-è¿™æ ·çš„ä»£ç ï¼Œæ‚¨å¿…é¡»åœ¨ä¸æ›´æ”¹ç¨‹åºåŠŸèƒ½çš„æƒ…å†µä¸‹å°†å…¶åˆ é™¤ã€‚ æœ¬ç« å‰é¢è®¨è®ºçš„æ‰€æœ‰æµ‹è¯•å·¥å…·éƒ½ä¸coverageé›†æˆåœ¨ä¸€èµ·ã€‚ <br><br> ä½¿ç”¨pytestæ—¶ï¼Œè¯·é€šè¿‡pip install pytest-pycovå®‰è£…pytest-covæ’ä»¶ï¼Œå¹¶æ·»åŠ ä¸€äº›å¼€å…³ä»¥ç”Ÿæˆæœªæµ‹è¯•ä»£ç çš„è¯¦ç»†è¾“å‡ºï¼ˆæ¸…å•6.13ï¼‰ã€‚ <br><blockquote><h4> æ¸…å•6.13 ä½¿ç”¨pytestå’Œcoverage </h4><br><pre> <code class="python hljs">$ pytest --cov=gnocchiclient gnocchiclient/tests/unit ---------- coverage: platform darwin, python <span class="hljs-number"><span class="hljs-number">3.6</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>-final<span class="hljs-number"><span class="hljs-number">-0</span></span> ----------- Name Stmts Miss Branch BrPart Cover --------------------------- gnocchiclient/__init__.py <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>% gnocchiclient/auth.py <span class="hljs-number"><span class="hljs-number">51</span></span> <span class="hljs-number"><span class="hljs-number">23</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">49</span></span>% gnocchiclient/benchmark.py <span class="hljs-number"><span class="hljs-number">175</span></span> <span class="hljs-number"><span class="hljs-number">175</span></span> <span class="hljs-number"><span class="hljs-number">36</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>% --snip-- --------------------------- TOTAL <span class="hljs-number"><span class="hljs-number">2040</span></span> <span class="hljs-number"><span class="hljs-number">1868</span></span> <span class="hljs-number"><span class="hljs-number">424</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>% === passed <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">5.00</span></span> seconds ===</code> </pre> </blockquote>  --cové€‰é¡¹å¯åœ¨æµ‹è¯•ç»“æŸæ—¶å¯ç”¨è¦†ç›–ç‡æŠ¥å‘Šçš„è¾“å‡ºã€‚ æ‚¨å¿…é¡»å°†è½¯ä»¶åŒ…åç§°ä½œä¸ºå‚æ•°ä¼ é€’ï¼Œä»¥ä¾¿æ’ä»¶æ­£ç¡®è¿‡æ»¤æŠ¥å‘Šã€‚ è¾“å‡ºå°†åŒ…å«å°šæœªæ‰§è¡Œçš„ä»£ç è¡Œï¼Œè¿™æ„å‘³ç€å®ƒä»¬å°šæœªç»è¿‡æµ‹è¯•ã€‚ å‰©ä¸‹çš„å°±æ˜¯æ‰“å¼€ç¼–è¾‘å™¨å¹¶ä¸ºæ­¤ä»£ç ç¼–å†™æµ‹è¯•ã€‚ <br><br>  Coverageæ¨¡å—ç”šè‡³æ›´å¥½-å®ƒä½¿æ‚¨å¯ä»¥ç”ŸæˆHTMLæ ¼å¼çš„æ¸…æ™°æŠ¥å‘Šã€‚ åªéœ€æ·»åŠ -cov-report-htmlï¼ŒHTMLé¡µé¢å°†å‡ºç°åœ¨è¿è¡Œå‘½ä»¤çš„<i>htmlcov</i>ç›®å½•ä¸­ã€‚ æ¯ä¸ªé¡µé¢å°†æ˜¾ç¤ºæºä»£ç çš„å“ªäº›éƒ¨åˆ†æ­£åœ¨è¿è¡Œæˆ–æœªè¿è¡Œã€‚ <br><br> å¦‚æœæ‚¨æƒ³èµ°å¾—æ›´è¿œï¼Œè¯·ä½¿ç”¨â€“-cover-fail-under-COVER_MIN_PERCENTAGEï¼Œå¦‚æœæœªè¦†ç›–æœ€ä½ç™¾åˆ†æ¯”çš„ä»£ç ï¼Œè¿™å°†å¯¼è‡´æµ‹è¯•å¥—ä»¶å¤±è´¥ã€‚ å°½ç®¡è¦†ç›–ç‡å¾ˆå¤§æ˜¯ä¸€ä¸ªä¸é”™çš„ç›®æ ‡ï¼Œå¹¶ä¸”æµ‹è¯•å·¥å…·å¯ç”¨äºè·å–æœ‰å…³æµ‹è¯•è¦†ç›–ç‡çŠ¶æ€çš„ä¿¡æ¯ï¼Œä½†è¯¥ç™¾åˆ†æ¯”æœ¬èº«å¹¶ä¸æ˜¯å¾ˆæœ‰ç”¨ã€‚ å›¾6.1æ˜¾ç¤ºäº†è¦†ç›–ç‡æŠ¥å‘Šç¤ºä¾‹ï¼Œå…¶ä¸­æ˜¾ç¤ºäº†è¦†ç›–ç‡ç™¾åˆ†æ¯”ã€‚ <br><br> ä¾‹å¦‚ï¼Œç”¨100ï¼…çš„æµ‹è¯•è¦†ç›–ä»£ç æ˜¯ä¸€ä¸ªå€¼å¾—çš„ç›®æ ‡ï¼Œä½†è¿™å¹¶ä¸ä¸€å®šæ„å‘³ç€ä»£ç å·²ç»è¿‡å…¨é¢æµ‹è¯•ã€‚ è¯¥å€¼ä»…è¡¨ç¤ºç¨‹åºä¸­æ‰€æœ‰ä»£ç è¡Œå‡å·²æ»¡è¶³ï¼Œä½†å¹¶ä¸è¡¨ç¤ºæ‰€æœ‰æ¡ä»¶å‡å·²æµ‹è¯•ã€‚ <br><br> å€¼å¾—ä½¿ç”¨è¦†ç›–ç‡ä¿¡æ¯æ¥æ‰©å±•æµ‹è¯•å¥—ä»¶å¹¶ä¸ºæœªè¿è¡Œçš„ä»£ç åˆ›å»ºå®ƒä»¬ã€‚ è¿™æ ·å¯ä»¥ç®€åŒ–é¡¹ç›®æ”¯æŒå¹¶æé«˜æ•´ä½“ä»£ç è´¨é‡ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/d_/af/vl/d_afvlajlx_9ctds7yfu7ef_2ds.png" alt="å›¾ç‰‡"></div><br><br><h3> å…³äºä½œè€… </h3><br>  <i>Julien Danju</i>å…¥ä¾µå…è´¹è½¯ä»¶å·²æœ‰20å¹´ä¹‹ä¹…ï¼Œå¹¶ä¸”å·²ç»å¼€å‘Pythonç¨‹åºå·²æœ‰è¿‘12å¹´çš„æ—¶é—´ã€‚ ä»–ç›®å‰é¢†å¯¼åŸºäºOpenStackçš„åˆ†å¸ƒå¼äº‘å¹³å°çš„è®¾è®¡å›¢é˜Ÿï¼Œè¯¥å¹³å°æ‹¥æœ‰ç°æœ‰çš„æœ€å¤§çš„Pythonå¼€æºæ•°æ®åº“ï¼Œå¤§çº¦æœ‰ä¸¤ç™¾äº”åä¸‡è¡Œä»£ç ã€‚ åœ¨å¼€å‘äº‘æœåŠ¡ä¹‹å‰ï¼ŒJulienåˆ›å»ºäº†çª—å£ç®¡ç†å™¨å¹¶ä¸ºè®¸å¤šé¡¹ç›®çš„å¼€å‘åšå‡ºäº†è´¡çŒ®ï¼Œä¾‹å¦‚Debianå’ŒGNU Emacsã€‚ <br><br><h3> å…³äºç§‘å­¦ç¼–è¾‘ </h3><br>  <i>Mike Driscoll</i>ä»äº‹Pythonç¼–ç¨‹å·²æœ‰åå¤šå¹´äº†ã€‚ å¾ˆé•¿ä¸€æ®µæ—¶é—´ï¼Œä»–åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">The Mouse vs.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Python</a> ã€‚ æ’°å†™å¤šæœ¬Pythonä¹¦ç±ï¼šPython 101ï¼ŒPythonè®¿è°ˆå’ŒReportLabï¼šä½¿ç”¨Pythonè¿›è¡ŒPDFå¤„ç†ã€‚ æ‚¨å¯ä»¥åœ¨Twitterå’ŒGitHubä¸Šæ‰¾åˆ°Mikeï¼š@driscollisã€‚ <br><br>  Â»è¿™æœ¬ä¹¦çš„æ›´å¤šä¿¡æ¯å¯ä»¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨å‡ºç‰ˆå•†çš„ç½‘ç«™ä¸Šæ‰¾åˆ°</a> <br>  Â» <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç›®å½•</a> <br>  Â» <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ‘˜å½•</a> <br><br> å°è´©ä¼˜æƒ åˆ¸25ï¼…ä¼˜æƒ -Python <br><br> æ”¯ä»˜çº¸è´¨ç‰ˆæœ¬çš„ä¹¦åï¼Œå°±ä¼šé€šè¿‡ç”µå­é‚®ä»¶å‘é€ç”µå­ä¹¦ã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN466027/">https://habr.com/ru/post/zh-CN466027/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN466001/index.html">â€œæµåŠ¨çš„â€é£æ°´ï¼Œå¦åˆ™æˆ‘ä»¬ä¼šæ­£ç¡®å…¥ç¡ï¼ˆå’–å•¡ï¼ŒèŸ‘è‚å’Œå“ˆå¸ƒé›·çš„ä¸å®½å®¹ï¼‰</a></li>
<li><a href="../zh-CN466015/index.html">æœ‰å…³è®¡ç®—ä¸­çš„ä¸‰è§’å­¦çš„æ›´å¤šä¿¡æ¯</a></li>
<li><a href="../zh-CN466017/index.html">Livy-Hadoop Spark Air Airflow Pythoné“¾ä¸­ç¼ºå°‘çš„é“¾æ¥</a></li>
<li><a href="../zh-CN466019/index.html">ABBYY Mobile Web Captureï¼šåœ¨æ™ºèƒ½æ‰‹æœºçš„æµè§ˆå™¨ä¸­ç›´æ¥æ˜¾ç¤ºé«˜è´¨é‡çš„æ–‡æ¡£ç…§ç‰‡</a></li>
<li><a href="../zh-CN466021/index.html">æˆ‘æ˜¯å¦‚ä½•æ•™Yandex.Aliceè°ˆè®ºæ€§ç©å…·çš„</a></li>
<li><a href="../zh-CN466029/index.html">å¦‚ä½•å°†é‡å­è®¡ç®—æœºå˜æˆå®Œç¾çš„éšæœºæ•°ç”Ÿæˆå™¨</a></li>
<li><a href="../zh-CN466031/index.html">DeepMindçš„å²è¯—ä»»åŠ¡ï¼Œæ—¨åœ¨è§£å†³æœ€å¤æ‚çš„ç§‘å­¦é—®é¢˜</a></li>
<li><a href="../zh-CN466033/index.html">å¦‚ä½•è®©å›¢é˜Ÿå‚ä¸å¯»æ‰¾åˆ›æ„å¹¶è·å¾—æ¯”åˆ›æ„æ›´å¤šçš„ä¸œè¥¿</a></li>
<li><a href="../zh-CN466039/index.html">ç”¨äºç”µå­å•†åŠ¡çš„PHPåº“ï¼šä¸ATOLå’ŒPaytureä¸€èµ·ä½¿ç”¨ï¼Œè§£æGS1ä»£ç å’Œå…¶ä»–ä»»åŠ¡</a></li>
<li><a href="../zh-CN466041/index.html">Facebookå¼€å‘è€…åœˆçš„ç¬¬ä¸€ä¸ªç¦»çº¿æ´»åŠ¨ï¼šè«æ–¯ç§‘ç¤¾åŒº-å¯åŠ¨æ´»åŠ¨</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>