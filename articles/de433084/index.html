<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🦑 🔡 🙌🏻 Offene Lektion "Feature Engineering am Beispiel des klassischen Titanic-Datensatzes" ✊🏿 📈 😡</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo nochmal! 

 Im Dezember werden wir mit dem Training für die nächste Data Scientist-Gruppe beginnen , daher gibt es immer mehr offene Lektionen u...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Offene Lektion "Feature Engineering am Beispiel des klassischen Titanic-Datensatzes"</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/433084/">  Hallo nochmal! <br><br>  Im Dezember werden wir mit dem Training für die nächste <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Data Scientist-Gruppe beginnen</a> , daher gibt es immer mehr offene Lektionen und andere Aktivitäten.  Neulich fand beispielsweise ein Webinar unter dem langen Namen „Feature Engineering am Beispiel des klassischen Titanic-Datensatzes“ statt.  Es wurde von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Alexander Sizov</a> , einem erfahrenen Entwickler, Ph.D., einem Experten für maschinelles / tiefes Lernen und Teilnehmer an verschiedenen kommerziellen internationalen Projekten im Zusammenhang mit künstlicher Intelligenz und Datenanalyse, durchgeführt. <br><br>  Eine offene Lektion dauerte ungefähr anderthalb Stunden.  Während des Webinars sprach der Lehrer über die Auswahl von Funktionen, die Transformation von Quelldaten (Codierung, Skalierung), das Einstellen von Parametern, das Trainieren des Modells und vieles mehr.  Während des Unterrichts wurde den Teilnehmern ein Jupyter-Notizbuch gezeigt.  Für die Arbeit verwendeten wir offene Daten von der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kaggle-</a> Plattform (ein klassischer Datensatz über die Titanic, von dem viele beginnen, sich mit Data Science vertraut zu machen).  Im Folgenden bieten wir ein Video und eine Abschrift des vergangenen Ereignisses an. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hier können</a> Sie die Präsentation und die Codes in einem Jupiter-Laptop abrufen. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/tOAAwpK2O80" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><a name="habracut"></a><br>  <b>Funktionsauswahl</b> <b><br></b> <br>  Das Thema wurde gewählt, obwohl klassisch, aber immer noch ein wenig düster.  Insbesondere war es notwendig, das Problem der binären Klassifizierung zu lösen und anhand der verfügbaren Daten vorherzusagen, ob der Passagier überleben wird oder nicht.  Die Daten selbst wurden in zwei Stichproben Training und Test aufgeteilt.  Die Schlüsselvariable ist Überleben (überlebt / nicht überlebt; 0 = Nein, 1 = Ja). <br><br>  Trainingsdaten eingeben: <br><br><ol><li>  Ticketklasse </li><li>  Alter und Geschlecht des Passagiers; </li><li>  Familienstand (ob Verwandte an Bord sind); </li><li>  Ticketpreis; </li><li>  Kabinennummer; </li><li>  Einschiffungshafen. </li></ol><br>  Wie Sie sehen können, sind die Variablentypen unterschiedlich: numerisch, Text.  Aus diesem Kaleidoskop musste ein Datensatz für das bevorstehende Modelltraining erstellt werden. <br><br>  Wir fassen zusammen: <br><br><ul><li>  train.csv - Trainingssatz - Trainingsdatensatz.  Die Antwort ist in ihnen bekannt - Überleben - ein Binärzeichen 0 (nicht überlebt) / 1 (überlebt); </li><li>  test.csv - Testsatz - Testdatensatz.  Die Antwort ist unbekannt.  Dies ist ein Beispiel, das an die Kaggle-Plattform gesendet werden muss, um die Modellqualitätsmetrik zu berechnen. </li><li>  gender_submission.csv ist ein Beispiel für das Format der Daten, die an kaggle gesendet werden sollen. </li></ul><br>  Arbeitsalgorithmus <br><br><ol><li>  Die Arbeit erfolgte schrittweise: </li><li>  Analyse von Daten aus train.csv. </li><li>  Umgang mit fehlenden Werten. </li><li>  Skalieren. </li><li>  Codierung kategorialer Merkmale. </li><li>  Erstellen eines Modells und Auswählen von Parametern, Auswählen des besten Modells für die konvertierten Daten aus train.csv. </li><li>  Fixierung und Modell der Transformationsmethode. </li>
<li>  Anwenden der gleichen Konvertierungen auf test.csv mithilfe der Pipeline. </li><li>  Anwendung des Modells auf test.csv. </li><li>  Speichern der Anwendungsergebnisdatei im selben Format wie in gender_submission.csv. </li><li>  Senden von Ergebnissen an die Kaggle-Plattform. </li></ol><br>  <b>Der praktische Teil des Webinars</b> <br><br>  Das erste, was getan werden musste, war, den Datensatz zu lesen und unsere Daten auf dem Bildschirm anzuzeigen: <br><br><img src="https://habrastorage.org/webt/eu/7p/vm/eu7pvmx66rypokyjafuw8kmyn3k.png"><br><br>  Für die Datenanalyse wurde eine wenig bekannte, aber recht nützliche Profilbibliothek verwendet: <br> <code>pandas_profiling.ProfileReport(df_train)</code> <br> <br>  <b>Mehr zur Profilerstellung</b> <br><br>  Diese Bibliothek erledigt alles, was a priori möglich ist, ohne die Details der Daten zu kennen.  Zeigen Sie beispielsweise Statistiken zu Daten an (wie viele Variablen und welcher Typ sie sind, wie viele Zeilen, fehlende Werte usw.).  Darüber hinaus werden separate Statistiken für jede Variable mit einem Minimum und einem Maximum, einem Verteilungsdiagramm und anderen Parametern angegeben. <br><br>  Wie Sie wissen, müssen Sie sich mit dem Prozess, den wir simulieren möchten, befassen, um ein gutes Modell zu erstellen, und die wichtigsten Attribute verstehen.  Darüber hinaus ist in unseren Daten nicht immer alles enthalten, was benötigt wird, und genauer gesagt, fast nie ist in ihnen alles Notwendige enthalten, was unseren Prozess vollständig bestimmt und bestimmt.  In der Regel müssen wir immer etwas kombinieren und möglicherweise zusätzliche Funktionen hinzufügen, die nicht im Datensatz enthalten sind (z. B. die Wettervorhersage).  Um den Prozess zu verstehen, benötigen wir eine Datenanalyse, die mithilfe der Profilbibliothek durchgeführt werden kann. <br><br>  <b>Fehlende Werte</b> <br><br>  Der nächste Schritt besteht darin, das Problem fehlender Werte zu lösen, da die Daten in den meisten Fällen nicht vollständig gefüllt sind. <br>  Für dieses Problem stehen folgende Lösungen zur Verfügung: <br><br><ul><li>  Löschen Sie Zeilen mit fehlenden Werten (denken Sie daran, dass Sie einige wichtige Werte verlieren können). </li><li>  ein Zeichen löschen (relevant, wenn zu wenig Daten darauf sind); </li><li>  Ersetzen Sie fehlende Werte durch etwas anderes (Median, Durchschnitt ...). </li></ul><br>  Ein Beispiel für eine einfache Konvertierung mit der Fillna-Methode, bei der die Werte der Medianvariablen nur den nicht gefüllten Zellen zugewiesen werden: <br><br><img src="https://habrastorage.org/webt/sj/ir/yl/sjirylzgnphmwoba3e2jnnicflc.png"><br><br>  Darüber hinaus zeigte der Lehrer Beispiele für die Verwendung von Imputer und Pipeline. <br><br>  <b>Feature-Skalierung</b> <br><br>  Die Funktionsweise des Modells und die endgültige Entscheidung hängen von der Größe der Merkmale ab.  Tatsache ist, dass es nicht so ist, dass ein Merkmal mit einem größeren Maßstab wichtiger ist als ein Merkmal mit einem kleineren Maßstab.  Aus diesem Grund muss das Modell Features senden, die identisch skaliert sind, dh das gleiche Gewicht für das Modell haben. <br><br>  Es gibt verschiedene Skalierungstechniken. Aufgrund des Formats der offenen Lektion konnten wir jedoch nur zwei davon genauer betrachten: <br><br><img src="https://habrastorage.org/webt/jj/jm/h_/jjjmh_mkrlg5n73lo9l5nabgl7q.png"><br><br>  <b>Merkmalskombinationen</b> <br><br>  Durch die Kombination vorhandener Features mithilfe von arithmetischen Operationen (Summe, Multiplikation, Division) können Sie jedes Feature erhalten, das das Modell effizienter macht.  Dies ist nicht immer erfolgreich, und wir wissen nicht, welche Kombination den gewünschten Effekt erzielt, aber die Praxis zeigt, dass es sinnvoll ist, es zu versuchen.  Es ist praktisch, Feature-Transformationen mithilfe der Pipeline anzuwenden. <br><br>  <b>Codierung</b> <br><br>  Wir haben also Daten verschiedener Typen: numerisch und Text.  Derzeit können die meisten Modelle auf dem Markt nicht mit Textdaten arbeiten.  Infolgedessen müssen alle kategorialen Zeichen (Textzeichen) in eine numerische Darstellung konvertiert werden, für die die Codierung verwendet wird. <br><br>  <b>Etikettencodierung</b> .  Dies ist ein Mechanismus, der im Rahmen vieler Bibliotheken implementiert ist und aufgerufen und angewendet werden kann: <br><br><img src="https://habrastorage.org/webt/tf/xd/kh/tfxdkh3eypfrqjuihl4w_60vfzq.png"><br><br>  Die Etikettencodierung weist jedem eindeutigen Wert eine eindeutige Kennung zu.  Minus - wir führen die Reihenfolge in eine bestimmte Variable ein, die nicht geordnet wurde, was nicht gut ist. <br><br>  <b>OneHotEncoder.</b>  Die eindeutigen Werte der Textvariablen werden in Form von Spalten erweitert, die zu den Quelldaten hinzugefügt werden, wobei jede Spalte eine binäre Variable in Form von 0 und 1 ist. Dieser Ansatz ist frei von Fehlern bei der Etikettencodierung, hat jedoch das Minus: Wenn viele eindeutige Werte vorhanden sind, fügen wir zu viele Spalten hinzu und in einigen Fällen ist die Methode einfach nicht anwendbar (der Datensatz wächst zu stark). <br><br>  <b>Modelltraining</b> <br><br>  Nach dem Ausführen der obigen Schritte wird eine endgültige Pipeline mit einer Reihe aller erforderlichen Operationen kompiliert.  Jetzt reicht es aus, den Quelldatensatz zu nehmen und die resultierende Pipeline mithilfe der Operation fit_transform auf diese Daten anzuwenden: <br> <code>x_train = vec.fit_transform(df_train)</code> <br> <br>  Als Ergebnis erhalten wir den x_train-Datensatz, der für die Verwendung im Modell bereit ist.  Das einzige, was Sie tun müssen, ist, den Wert unserer Zielvariablen zu trennen, damit wir das Training durchführen können. <br><br>  Wählen Sie als nächstes das Modell aus.  Im Rahmen des Webinars schlug der Lehrer eine einfache logistische Regression vor.  Das Modell wurde unter Verwendung der Anpassungsoperation trainiert, was zu einem Modell in Form einer logistischen Regression mit bestimmten Parametern führte: <br><br><img src="https://habrastorage.org/webt/xs/tc/dc/xstcdche3jydmlahruszn6txahi.png"><br><br>  In der Praxis werden jedoch normalerweise mehrere Modelle verwendet, die am effektivsten zu sein scheinen.  Die endgültige Lösung ist häufig eine Kombination dieser Modelle unter Verwendung von Stapeltechniken und anderen Ansätzen für Ensemble-Modelle (unter Verwendung mehrerer Modelle innerhalb desselben Hybridmodells). <br><br>  Nach dem Training kann das Modell auf Testdaten angewendet werden, wobei die Qualität im Rahmen einer bestimmten Metrik bewertet wird.  In unserem Fall betrug die Qualität innerhalb des Genauigkeitscores 0,8: <br><br><img src="https://habrastorage.org/webt/ka/ut/dj/kautdjopfjqa1dbgkii10wptcfs.png"><br><br>  Dies bedeutet, dass anhand der erhaltenen Daten die Variable in 80% der Fälle korrekt vorhergesagt wird.  Nachdem wir die Trainingsergebnisse erhalten haben, können wir entweder das Modell verbessern (wenn die Genauigkeit nicht zufriedenstellend ist) oder direkt mit der Prognose fortfahren. <br><br>  Dies war das Hauptthema des Unterrichts, aber der Lehrer sprach in verschiedenen Aufgaben ausführlicher über die Merkmale des Modells und beantwortete Fragen des Publikums.  Wenn Sie also nichts verpassen möchten, sehen Sie sich das vollständige Webinar an, wenn Sie an diesem Thema interessiert sind. <br><br>  Wie immer warten wir auf Ihre Kommentare und Fragen, die Sie hier hinterlassen oder <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Alexander</a> stellen können, indem Sie an einem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Tag der offenen Tür</a> zu ihm gehen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">.</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de433084/">https://habr.com/ru/post/de433084/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de433072/index.html">So hacken Sie den Kopierschutz der Sega Dreamcast-Konsole</a></li>
<li><a href="../de433074/index.html">In einem Android-Projekt zu Kotlin wechseln: Tipps und Tricks</a></li>
<li><a href="../de433076/index.html">Wie wir unsere Android Gallery-Bibliothek zum Anzeigen von Medieninhalten erstellt haben</a></li>
<li><a href="../de433078/index.html">Wir schreiben Handelsroboter mit dem grafischen Framework von StockSharp. Teil 2</a></li>
<li><a href="../de433082/index.html">Das Pumpen der Konten anderer Personen ist in Südkorea zu einer Straftat geworden</a></li>
<li><a href="../de433086/index.html">Tinkoff und alles, alles, alles: IoT, Analyse und Überwachung für Banken</a></li>
<li><a href="../de433088/index.html">Wie gefällt es Ihnen, Elon Musk: BMW und Porsche haben eine Aufladung entwickelt, die 100 km Fahrt in 3 Minuten ermöglicht</a></li>
<li><a href="../de433090/index.html">Oracle Bitmap-Indextechniken</a></li>
<li><a href="../de433092/index.html">Level 80 CG-Modellierung: Realistische fotorealistische Charaktere in Unreal</a></li>
<li><a href="../de433094/index.html">Numerische Modellierung in einem großen Industrieunternehmen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>