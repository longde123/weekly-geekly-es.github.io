<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚û°Ô∏è üë©üèø‚Äçüöí ü§∞üèø V√©rification de l'encapsuleur OpenCvSharp pour OpenCV avec PVS-Studio üßñüèø üî¶ üö£üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="OpenCV est une biblioth√®que open source d'algorithmes de vision par ordinateur et de traitement d'images et d'algorithmes num√©riques √† usage g√©n√©ral. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>V√©rification de l'encapsuleur OpenCvSharp pour OpenCV avec PVS-Studio</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/473478/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/mr/0s/oi/mr0soiovipbs1ma0roktme3nj1i.png" alt="Figure 2"></div><br>  OpenCV est une biblioth√®que open source d'algorithmes de vision par ordinateur et de traitement d'images et d'algorithmes num√©riques √† usage g√©n√©ral.  La biblioth√®que est bien connue des d√©veloppeurs C ++.  Outre C ++, il existe √©galement des versions pour Python, Java, Ruby, Matlab, Lua et d'autres langages.  Comme C #, qui est le langage dans lequel je me sp√©cialise, ne figure pas sur cette liste, j'ai choisi OpenCvSharp, un wrapper C # d'OpenCV, pour le v√©rifier avec PVS-Studio.  Les r√©sultats de cette v√©rification sont discut√©s dans cet article. <br><a name="habracut"></a><br><h2>  Pr√©sentation </h2><br>  Avant de faire partie de l'√©quipe PVS-Studio, j'avais particip√© √† la fabrication de robots √† pr√©senter lors d'expositions.  Mes t√¢ches comprenaient les travaux de r√©paration les plus √©l√©mentaires (les pannes majeures ont √©t√© g√©r√©es par une autre personne) ainsi que le d√©veloppement de logiciels et d'utilitaires de toutes sortes. <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/s9/sk/p-/s9skp-nztgw-u2nt8j0dfuvae3m.png" alt="Figure 1"></div><br>  <i>Moi, fatigu√© et nouveau en ville, avec un robot KIKI fra√Æchement d√©ball√©.</i> <br><br>  Au fait, la partie d√©veloppement √©tait assez dr√¥le.  Chaque fois que l'un de nous a eu une id√©e d'une nouvelle fa√ßon de surprendre les visiteurs de l'exposition, nous l'avons √©voqu√©e et si tout le monde l'aimait, nous nous mettions au travail.  Une fois, il nous est venu √† l'esprit de cr√©er un robot capable de reconna√Ætre un visage humain et de r√©pondre par un discours de bienvenue. <br><br>  J'ai cherch√© sur Google une biblioth√®que pour mes besoins et suis tomb√© sur OpenCV, une biblioth√®que d'algorithmes de vision par ordinateur.  Mais j'ai √©t√© d√©√ßu tr√®s vite en comprenant que OpenCV √©tait impl√©ment√© en C ++.  Ma connaissance du C ++, que j'avais √©tudi√©e √† l'universit√©, n'√©tait √©videmment pas suffisante.  J'ai donc googl√© un peu plus et trouv√© OpenCvSharp, un wrapper de la biblioth√®que pour C #, qui est le langage dans lequel je me sp√©cialise.  Cela fait environ six mois depuis lors, le programme a longtemps √©t√© √©crit et utilis√©, et maintenant j'ai finalement d√©cid√© de jeter un ≈ìil "sous le capot" d'OpenCvSharp et de scanner son code source avec l'analyseur statique PVS-Studio. <br><br><h2>  Le projet en cours d'analyse </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">OpenCvSharp</a> est un wrapper d'OpenCV pour une utilisation dans les projets C #.  Soit dit en passant, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">nous avons d√©j√† v√©rifi√©</a> OpenCV dans le pass√©.  Les points forts d'OpenCvSharp sont la grande collection d'√©chantillons de code, la prise en charge multiplateforme (il s'ex√©cute sur n'importe quelle plate-forme prise en charge par Mono) et une installation facile. <br><br>  L'encapsuleur est un petit projet d'environ 112 200 lignes de code C #.  1,2% d'entre eux sont des commentaires qui, je dois dire, sont √©trangement peu nombreux.  D'un autre c√¥t√©, il y a pas mal de bugs pour un projet aussi petit.  J'ai choisi plus de 20 exemples pour cet article, mais l'analyseur en a trouv√© beaucoup d'autres, qui ne sont ni int√©ressants ni √©vidents. <br><br><h2>  PVS-Studio </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PVS-Studio</a> est un outil pour d√©tecter les bogues et les vuln√©rabilit√©s potentielles dans le code source des programmes √©crits en C, C ++, C # et Java.  Il fonctionne sur Windows, Linux et macOS.  Outre le code inaccessible, les erreurs de programmation et les fautes de frappe, PVS-Studio, comme cela a d√©j√† √©t√© mentionn√©, est capable de d√©tecter les probl√®mes de s√©curit√© potentiels.  Par cons√©quent, il peut √™tre consid√©r√© comme un outil SAST (Static Application Security Testing). <br><br><h2>  Les avertissements les plus int√©ressants </h2><br>  Ce qui rend la m√©thode <i>WriteableBitmapConverter</i> sp√©ciale, c'est qu'elle a d√©clench√© quatre avertissements du m√™me type √† la fois: <br><br><ul><li>  V3005 La variable 'optimumChannels [PixelFormats.Indexed1]' est assign√©e √† elle-m√™me.  WriteableBitmapConverter.cs 22 </li><li>  V3005 La variable 'optimumChannels [PixelFormats.Indexed8]' est assign√©e √† elle-m√™me.  WriteableBitmapConverter.cs 23 </li><li>  V3005 La variable 'optimumTypes [PixelFormats.Indexed1]' est assign√©e √† elle-m√™me.  WriteableBitmapConverter.cs 50 </li><li>  V3005 La variable 'optimumTypes [PixelFormats.Indexed8]' est assign√©e √† elle-m√™me.  WriteableBitmapConverter.cs 51 </li></ul><br><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteableBitmapConverter</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { optimumChannels = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary &lt;PixelFormat, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;(); optimumChannels[PixelFormats.Indexed1] = <span class="hljs-comment"><span class="hljs-comment">// &lt;= optimumChannels[PixelFormats.Indexed8] = // &lt;= optimumChannels[PixelFormats.Gray2] = optimumChannels[PixelFormats.Gray4] = optimumChannels[PixelFormats.Gray8] = optimumChannels[PixelFormats.Gray16] = optimumChannels[PixelFormats.Gray32Float] = optimumChannels[PixelFormats.Indexed1] = // &lt;= optimumChannels[PixelFormats.Indexed2] = optimumChannels[PixelFormats.Indexed4] = optimumChannels[PixelFormats.Indexed8] = // &lt;= .... optimumTypes = new Dictionary &lt;PixelFormat, MatType&gt;(); optimumTypes[PixelFormats.Indexed1] = // &lt;= optimumTypes[PixelFormats.Indexed8] = // &lt;= optimumTypes[PixelFormats.Gray2] = optimumTypes[PixelFormats.Gray4] = optimumTypes[PixelFormats.Gray8] = optimumTypes[PixelFormats.Indexed1] = // &lt;= optimumTypes[PixelFormats.Indexed2] = optimumTypes[PixelFormats.Indexed4] = optimumTypes[PixelFormats.Indexed8] = // &lt;= optimumTypes[PixelFormats.BlackWhite] = .... } .... public static class PixelFormats { .... public static PixelFormat Indexed8 { get; } .... public static PixelFormat Indexed1 { get; } .... }</span></span></code> </pre> <br>  La classe <i>PixelFormats</i> est d√©finie dans l'espace de noms <i>System.Windows.Media</i> et est une collection de diff√©rents formats de pixels.  L'analyseur souligne que les √©l√©ments <i>optimumChannels [PixelFormats.Indexed1]</i> et <i>optimumChannels [PixelFormats.Indexed8] se</i> voient attribuer une deuxi√®me fois des valeurs dans la m√©thode <i>WriteableBitmapConverter</i> , ce qui n'a aucun sens.  On ne sait pas si c'est juste une faute de frappe ou si le programmeur voulait dire autre chose.  Soit dit en passant, cet extrait est un exemple frappant de la fa√ßon dont les analyseurs statiques peuvent √™tre utiles: en regardant un tas de lignes similaires, vous √™tes moins concentr√© - il n'est pas √©tonnant que les fautes de frappe restent inaper√ßues malgr√© la r√©vision du code.  Les analyseurs statiques, cependant, n'ont pas de difficult√© √† maintenir leur attention et n'ont pas besoin de repos, ils peuvent donc attraper des bugs comme √ßa sans effort. <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/1g/ok/vg/1gokvgep_oiqjqsqy9btoh3nncg.png" alt="Figure 5"></div><br>  <i>Ressentez la puissance de l'analyse statique.</i> <br><br>  <b>Message de diagnostic PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3021</a> Il existe deux instructions 'if' avec des expressions conditionnelles identiques.  La premi√®re instruction ¬´if¬ª contient la m√©thode return.  Cela signifie que la deuxi√®me instruction ¬´if¬ª est insens√©e InputArray.cs 394 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> MatType </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EstimateType</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Type t</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (t == <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Vec2b)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> MatType.CV_8UC2; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (t == <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Vec3b)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> MatType.CV_8UC3; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (t == <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Vec4b)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> MatType.CV_8UC4; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (t == <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Vec6b)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> MatType.CV_8UC(<span class="hljs-number"><span class="hljs-number">6</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (t == <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Vec2s)) <span class="hljs-comment"><span class="hljs-comment">// &lt;= return MatType.CV_16SC2; .... if (t == typeof(Vec2s)) // &lt;= return MatType.CV_32SC2; .... }</span></span></code> </pre> <br>  Ce bug est quelque peu similaire au pr√©c√©dent.  Le d√©veloppeur v√©rifie deux fois la m√™me condition.  Cela n'a pas de sens ici car la branche then de l'instruction "duplicate" <i>if</i> ne s'ex√©cutera jamais car: <br><br><ul><li>  si la premi√®re condition est vraie, la m√©thode retournera; </li><li>  si la premi√®re condition est fausse, la seconde sera fausse aussi parce que la variable v√©rifi√©e, <i>t</i> , ne change pas entre les deux v√©rifications. </li></ul><br>  Ce code doit √™tre r√©vis√©;  il est tr√®s probable que la deuxi√®me copie de <i>Vec2s</i> √©tait en fait cens√©e √™tre une autre variable. <br><br>  <b>Message de diagnostic PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3010</a> La valeur de retour de la fonction 'ToString' doit √™tre utilis√©e.  ImgProcTest.cs 80 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> RectanglesIntersectTypes </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RotatedRectangleIntersection</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">RotatedRect rect1, RotatedRect rect2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">out</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Point2f[] intersectingRegion</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> intersectingRegionVec = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> VectorOfPoint2f()) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ret = NativeMethods .imgproc_rotatedRectangleIntersection_vector( rect1, rect2, intersectingRegionVec.CvPtr); intersectingRegion = intersectingRegionVec.ToArray(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (RectanglesIntersectTypes) ret; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RotatedRectangleIntersectionVector</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rr1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RotatedRect(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Point2f(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Size2f(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>), <span class="hljs-number"><span class="hljs-number">45</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rr2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RotatedRect(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Point2f(<span class="hljs-number"><span class="hljs-number">130</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Size2f(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>); Cv2.RotatedRectangleIntersection(rr1, rr2, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> intersectingRegion); .... intersectingRegion.ToString(); }</code> </pre> <br>  La m√©thode <i>RotatedRectangleIntersection</i> est accessible via le param√®tre <i>intersectingRegion</i> et renvoie un tableau d'√©l√©ments de type <i>Point2f</i> .  Une fois que <i>intersectingRegion</i> a √©t√© rempli de valeurs, la m√©thode <i>ToString ()</i> est appel√©e sur le tableau.  Cela n'affecte en rien les √©l√©ments du tableau et aucun travail utile n'est effectu√© dans la derni√®re ligne, il serait donc juste de supposer que le d√©veloppeur a simplement oubli√© de supprimer cette pi√®ce. <br><br>  <b>Messages de diagnostic PVS-Studio:</b> <br><br><ul><li>  V3021 Il existe deux instructions 'if' avec des expressions conditionnelles identiques.  La premi√®re instruction ¬´if¬ª contient la m√©thode return.  Cela signifie que la deuxi√®me instruction ¬´if¬ª est insens√©e Cv2_calib3d.cs 1370 </li><li>  V3022 L'expression 'objectPoints == null' est toujours fausse.  Cv2_calib3d.cs 1372 </li></ul><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CalibrateCamera</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (objectPoints == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-keyword"><span class="hljs-keyword">nameof</span></span>(objectPoints)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (objectPoints == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-keyword"><span class="hljs-keyword">nameof</span></span>(objectPoints)); .... }</code> </pre> <br>  Nous avons clon√© du code ici, d'o√π les deux avertissements.  Le premier dit que les deux instructions <i>if</i> v√©rifient la m√™me condition.  Si cette condition est vraie, la m√©thode retournera dans la branche alors de la premi√®re instruction <i>if</i> .  Par cons√©quent, la deuxi√®me condition sera toujours fausse, ce que nous dit le deuxi√®me avertissement.  Il semble que le programmeur ait clon√© ce fragment √† l'aide du copier-coller, mais a oubli√© de le modifier. <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/cy/db/s1/cydbs1dussvael3m4ihcmwdfw4y.png" alt="Figure 6"></div><br><br>  <i>Copier-coller mignon.</i> <br><br>  Autres avertissements de ce type: <br><br><ul><li>  V3021 Il existe deux instructions 'if' avec des expressions conditionnelles identiques.  La premi√®re instruction ¬´if¬ª contient la m√©thode return.  Cela signifie que la deuxi√®me instruction ¬´si¬ª est insens√©e Cv2_calib3d.cs 1444 </li><li>  V3022 L'expression 'objectPoints == null' est toujours fausse.  Cv2_calib3d.cs 1446 </li></ul><br>  <b>Message de diagnostic PVS-Studio: l'</b> expression <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3022</a> 'label == MarkerValue' est toujours fausse.  Labeller.cs 135 <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">internal</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Labeller</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> MarkerValue = <span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Perform</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Mat img, CvBlobs blobs</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> label = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> lastLabel = <span class="hljs-number"><span class="hljs-number">0</span></span>; CvBlob lastBlob = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> y = <span class="hljs-number"><span class="hljs-number">0</span></span>; y &lt; h; y++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x &lt; w; x++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (imgIn[x + y * step] == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> labeled = labels[y, x] != <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (....) { labeled = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-comment"><span class="hljs-comment">// Label contour. label++; if (label == MarkerValue) // &lt;= throw new Exception(); .... } .... } .... } } }</span></span></code> </pre> <br>  Une variable nomm√©e <i>label</i> est cr√©√©e et initialis√©e √† 0. Si une certaine condition est vraie, elle sera incr√©ment√©e d'une unit√©.  De plus, cette variable n'est jamais d√©cr√©ment√©e dans cet extrait.  Par cons√©quent, le v√©rifier pour la constante -1, comme dans la ligne point√©e par l'analyseur, n'a aucun sens. <br><br>  <b>Message de diagnostic PVS-Studio:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3038</a> L'argument a √©t√© transmis √† la m√©thode plusieurs fois.  Il est possible que d'autres arguments soient pass√©s √† la place.  Cv2_photo.cs 124 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FastNlMeansDenoisingMulti</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... NativeMethods.photo_fastNlMeansDenoisingMulti( srcImgPtrs, srcImgPtrs.Length, dst.CvPtr, imgToDenoiseIndex, templateWindowSize, h, templateWindowSize, searchWindowSize); .... }</code> </pre> <br>  Pour comprendre ce que l'analyseur nous dit, jetons un coup d'≈ìil aux param√®tres de la m√©thode <i>photo_fastNlMeansDenoisingMulti</i> : <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">extern</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">photo_fastNlMeansDenoisingMulti</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> IntPtr[] srcImgs, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> srcImgsLength, IntPtr dst, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> imgToDenoiseIndex, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> temporalWindowSize, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> h, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> templateWindowSize, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> searchWindowSize</span></span></span><span class="hljs-function">)</span></span></code> </pre> <br>  Simplifions-le encore plus pour le rendre compl√®tement simple.  Comparez ces lignes: <br><br><pre> <code class="cs hljs">NativeMethods.photo_fastNlMeansDenoisingMulti( .... templateWindowSize, .... templateWindowSize, ....); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">extern</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">photo_fastNlMeansDenoisingMulti</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> .... </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> temporalWindowSize, .... </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> templateWindowSize, ....</span></span></span><span class="hljs-function">)</span></span></code> </pre> <br>  La variable <i>templateWindowSize</i> est d√©clar√©e deux fois, mais la premi√®re fois qu'elle est mentionn√©e doit en fait √™tre la d√©claration de <i>temporalWindowSize</i> .  Une autre chose que l'analyseur n'a pas aim√© est que la valeur de <i>temporalWindowSize</i> n'est pas du tout utilis√©e dans la m√©thode <i>photo_fastNlMeansDenoisingMulti</i> .  Cela pourrait √™tre une d√©cision consciente, mais je regarderais de plus pr√®s ce code si j'√©tais l'auteur. <br><br>  Autres avertissements de ce type: <br><br><ul><li>  V3038 L'argument a √©t√© pass√© plusieurs fois √† la m√©thode.  Il est possible que d'autres arguments soient pass√©s √† la place.  Cv2_photo.cs 149 </li><li>  V3038 L'argument a √©t√© pass√© plusieurs fois √† la m√©thode.  Il est possible que d'autres arguments soient pass√©s √† la place.  Cv2_photo.cs 180 </li><li>  V3038 L'argument a √©t√© pass√© plusieurs fois √† la m√©thode.  Il est possible que d'autres arguments soient pass√©s √† la place.  Cv2_photo.cs 205 </li></ul><br>  L'exemple suivant est quelque peu similaire au pr√©c√©dent. <br><br>  <b>Message de diagnostic PVS-Studio:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3066</a> Ordre incorrect possible des arguments pass√©s √† la m√©thode 'calib3d_Rodrigues_MatToVec': 'matrixM.CvPtr' et 'vectorM.CvPtr'.  Cv2_calib3d.cs 86 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Rodrigues</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params">[,] matrix, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">out</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] vector, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">out</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params">[,] jacobian</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> jacobianM = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Mat&lt;<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>&gt;()) { NativeMethods.calib3d_Rodrigues_MatToVec (matrixM.CvPtr, vectorM.CvPtr, jacobianM.CvPtr); .... } }</code> </pre> <br>  Regardons les param√®tres de la m√©thode <i>calib3d_Rodrigues_MatToVec</i> : <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">extern</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calib3d_Rodrigues_MatToVec</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> IntPtr vector, IntPtr matrix, IntPtr jacobian</span></span></span><span class="hljs-function">)</span></span></code> </pre> <br>  Il semble que la m√©thode <i>calib3d_Rodrigues_MatToVec</i> soit appel√©e avec les arguments <i>matrixM.CvPtr</i> et <i>vectorM.CvPtr</i> √©chang√©s accidentellement.  Les auteurs doivent v√©rifier cet extrait: il peut y avoir une erreur qui emp√™che les calculs corrects. <br><br>  <b>Message de diagnostic PVS-Studio:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3063</a> Une partie de l'expression conditionnelle est toujours fausse si elle est √©valu√©e: data == null.  Mat.cs 3539 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CheckArgumentsForConvert</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-keyword"><span class="hljs-keyword">nameof</span></span>(data)); MatType t = Type(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data == <span class="hljs-literal"><span class="hljs-literal">null</span></span> || (data.Length * dataDimension) <span class="hljs-comment"><span class="hljs-comment">// &lt;= (data.Length * dataDimension) % t.Channels != 0) .... }</span></span></code> </pre> <br>  L'analyseur signale que la deuxi√®me v√©rification des <i>donn√©es == null</i> ne sera jamais <i>vraie</i> car si les <i>donn√©es</i> sont √©gales √† <i>null</i> dans la premi√®re condition, une exception sera lev√©e et l'ex√©cution n'atteindra jamais la deuxi√®me v√©rification. <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/c1/b1/xf/c1b1xfih5imz4n4cifsucaqzrrw.png" alt="Figure 7"></div><br>  <i>Je sais que tu es fatigu√©, mais nous avons presque fini.</i> <br><br>  <b>Message de diagnostic PVS-Studio:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3127</a> Deux fragments de code similaires ont √©t√© trouv√©s.  Il s'agit peut-√™tre d'une faute de frappe et la variable 'window' devrait √™tre utilis√©e √† la place de 'src2' Cv2_imgproc.cs 1547 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Point2d </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PhaseCorrelateRes</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (src1 == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-keyword"><span class="hljs-keyword">nameof</span></span>(src1)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (src2 == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-keyword"><span class="hljs-keyword">nameof</span></span>(src2)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (window == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-keyword"><span class="hljs-keyword">nameof</span></span>(src2)); <span class="hljs-comment"><span class="hljs-comment">// &lt;= .... }</span></span></code> </pre> <br>  L'analyseur a rep√©r√© une faute de frappe dans cet extrait.  Les variables sont v√©rifi√©es pour <i>null</i> et, si elles sont vraies, chaque v√©rification l√®ve une exception.  Cependant, cela ne fonctionne pas tout √† fait correctement pour la variable de <i>fen√™tre</i> .  Si sa valeur est √©gale √† <i>null</i> , une exception correspondante est √©galement lev√©e mais avec le mauvais texte.  Il ne sera pas question de <i>fen√™tre</i> ;  ce sera plut√¥t <i>src2</i> .  La condition devrait apparemment √™tre r√©vis√©e comme suit: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (window == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-keyword"><span class="hljs-keyword">nameof</span></span>(window));</code> </pre> <br>  <b>Message de diagnostic PVS-Studio:</b> V3142 Code inaccessible d√©tect√©.  Il est possible qu'une erreur soit pr√©sente.  MatOfT.cs 873 <br><br>  Maintenant, juste pour un changement, examinons le cas o√π l'analyseur est techniquement correct √† propos du code inaccessible, mais il n'y a en fait aucune erreur.  C'est un avertissement qui peut √™tre appel√© √† la fois vrai et faux en m√™me temps. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> new Mat&lt;TElem&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SubMat</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">params</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Range[] ranges</span></span></span><span class="hljs-function">)</span></span> { Mat result = <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.SubMat(ranges); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Wrap(result); }</code> </pre> <br>  L'analyseur nous indique que l'instruction de <i>retour</i> est inaccessible.  Regardons le corps de la m√©thode <i>SubMat</i> pour voir si l'analyseur dit la v√©rit√©. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Mat </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SubMat</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">params</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Range[] ranges</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NotImplementedException(); <span class="hljs-comment"><span class="hljs-comment">/* if (ranges == null) throw new ArgumentNullException(); ThrowIfDisposed(); CvSlice[] slices = new CvSlice[ranges.Length]; for (int i = 0; i &lt; ranges.Length; i++) { slices[i] = ranges[i]; } IntPtr retPtr = NativeMethods.core_Mat_subMat1(ptr, ranges.Length, ranges); Mat retVal = new Mat(retPtr); return retVal;*/</span></span> }</code> </pre> <br>  Comme vous pouvez le voir, la fonction est actuellement incompl√®te et g√©n√©rera toujours une exception.  L'analyseur est absolument correct en soulignant le code inaccessible - mais ce n'est pas un v√©ritable bug. <br><br>  Les trois d√©fauts suivants sont du m√™me type, mais ils sont tellement cool que je n'ai pas pu m'emp√™cher d'inclure les trois. <br><br>  <b>Message de diagnostic PVS-Studio: l'</b> expression <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3022</a> 'String.IsNullOrEmpty ("winName")' est toujours fausse.  Cv2_highgui.cs 46 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DestroyWindow</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> winName</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (String.IsNullOrEmpty(<span class="hljs-string"><span class="hljs-string">"winName"</span></span>)) .... }</code> </pre> <br>  <b>Message de diagnostic PVS-Studio: l'</b> expression <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3022</a> 'string.IsNullOrEmpty ("fileName")' est toujours fausse.  FrameSource.cs 37 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> FrameSource </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateFrameSource_Video</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fileName</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrEmpty(<span class="hljs-string"><span class="hljs-string">"fileName"</span></span>)) .... }</code> </pre> <br>  <b>Message de diagnostic PVS-Studio: l'</b> expression <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3022</a> 'string.IsNullOrEmpty ("fileName")' est toujours fausse.  FrameSource.cs 53 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> FrameSource </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateFrameSource_Video_CUDA</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fileName</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrEmpty(<span class="hljs-string"><span class="hljs-string">"fileName"</span></span>)) .... }</code> </pre> <br>  Parfois, les avertissements <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3022</a> (√† propos d'expressions toujours vraies / fausses) pointent vers des bogues vraiment √©tranges ou dr√¥les.  Les trois exemples ci-dessus contiennent la m√™me erreur.  La m√©thode a un param√®tre de type <i>cha√Æne</i> dont la valeur doit √™tre v√©rifi√©e.  Ce qui est v√©rifi√© √† la place, cependant, est un litt√©ral de cha√Æne dont le texte est le nom de la variable, c'est-√†-dire le nom de la variable entre guillemets. <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/mk/rr/fm/mkrrfmqeimdl5l_osrff2p-ime4.png" alt="Figure 18"></div><br>  Le programmeur doit avoir √©crit une fois un bloc de code d√©fectueux, puis clon√© par copier-coller. <br><br><h2>  Conclusion </h2><br>  Les d√©veloppeurs d'OpenCvSharp ont fait un travail important et important et, en tant qu'utilisateur de leur biblioth√®que, j'en suis totalement reconnaissant.  Merci les gars! <br><br>  Mais maintenant que je fais partie de l'√©quipe PVS-Studio et que j'ai vu le code de la biblioth√®que, je dois dire que l'aspect qualit√© n'a pas √©t√© pris en compte.  Le projet ne ressemble pas √† un contr√¥le r√©gulier avec des analyseurs statiques, et de nombreux bogues sont apparemment corrig√©s √† l'aide de techniques plus co√ªteuses (telles que les tests ou les commentaires des utilisateurs), et certains bogues continuent de vivre dans le code et ce sont eux que nous capturons avec notre analyseur.  Ce sujet est abord√© plus en d√©tail dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ce petit billet</a> sur la philosophie de l'analyse statique. <br><br>  √âtant donn√© qu'OpenCvSharp est open-source et disponible gratuitement sur GitHub, ses auteurs peuvent utiliser l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">une des options de licence gratuites</a> pour PVS-Studio pour commencer √† l'utiliser r√©guli√®rement. <br><br>  Merci d'avoir lu.  N'h√©sitez pas √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">t√©l√©charger</a> une copie d'essai de PVS-Studio pour v√©rifier vos propres projets. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr473478/">https://habr.com/ru/post/fr473478/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr473460/index.html">A la question des math√©matiques</a></li>
<li><a href="../fr473462/index.html">Semaine de la s√©curit√© 44: NordVPN, TorGuard et Half Hack</a></li>
<li><a href="../fr473468/index.html">Comprendre le th√©or√®me de Bayes</a></li>
<li><a href="../fr473470/index.html">GitLab 12.4 avec une am√©lioration de la demande de fusion et des d√©pendances de l'API d'audit</a></li>
<li><a href="../fr473476/index.html">V√©rification de l'encapsuleur OpenCvSharp sur OpenCV avec PVS-Studio</a></li>
<li><a href="../fr473482/index.html">Les succ√®s de la campagne saoudienne, Halloween-PR et un peu sur les campagnes publicitaires de Japan Airlines</a></li>
<li><a href="../fr473484/index.html">Cours C ++ au centre CS, deuxi√®me partie</a></li>
<li><a href="../fr473488/index.html">Navigation multiplateforme: pourquoi NavController a vaincu angular / router dans Ionic 4</a></li>
<li><a href="../fr473490/index.html">Pourquoi les meilleurs physiciens adorent la th√©orie des cordes</a></li>
<li><a href="../fr473500/index.html">Application sur TSD et communication avec 1C: Enterprise 8.3 via HTTP-Service. Partie 1 (Choix d'une m√©thode d'√©change. Description de l'API)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>