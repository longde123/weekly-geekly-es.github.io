<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéè üïã ‚òùÔ∏è Knative - une plate-forme bas√©e sur k8s en tant que service avec prise en charge sans serveur üíÜüèæ üë©üèª‚Äçüè≠ üé™</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kubernetes est sans aucun doute devenu la plate-forme dominante pour le d√©ploiement de conteneurs. Il offre la possibilit√© de g√©rer presque tout en ut...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Knative - une plate-forme bas√©e sur k8s en tant que service avec prise en charge sans serveur</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/southbridge/blog/475630/"><p><img src="https://habrastorage.org/webt/4k/yp/89/4kyp89-_aofexlkgyzwoiiekmbq.png"></p><br><p>  Kubernetes est sans aucun doute devenu la plate-forme dominante pour le d√©ploiement de conteneurs.  Il offre la possibilit√© de g√©rer presque tout en utilisant ses API et ses contr√¥leurs utilisateur qui √©tendent son API via les ressources utilisateur. </p><br><p>  Cependant, l'utilisateur doit encore prendre des d√©cisions d√©taill√©es sur la fa√ßon de d√©ployer, configurer, g√©rer et faire √©voluer les applications.  √Ä la discr√©tion de l'utilisateur, des questions demeurent sur la mise √† l'√©chelle de l'application, la protection, le passage du trafic.  Cela distingue Kubernetes des ¬´plates-formes en tant que service¬ª (PaaS) conventionnelles, telles que Cloud Foundry et Heroku. </p><br><p>  Les plates-formes ont une interface utilisateur simplifi√©e, ax√©e sur les d√©veloppeurs d'applications qui sont le plus souvent impliqu√©s dans la personnalisation d'applications individuelles.  Le routage, le d√©ploiement et les m√©triques transparentes pour l'utilisateur sont g√©r√©s par le syst√®me PaaS sous-jacent. </p><a name="habracut"></a><br><p> Le flux de travail de livraison source est g√©r√© par PaaS en cr√©ant une image de conteneur personnalis√©e, en la d√©ployant, en configurant une nouvelle route et un sous-domaine DNS pour le trafic entrant.  Tout cela est d√©clench√© par la commande <code>git push</code> . </p><br><p>  Kubernetes (intentionnellement) ne fournit que les blocs de construction de base pour de telles plates-formes, donnant √† la communaut√© la possibilit√© de faire ce travail par ses propres moyens.  Comme l'a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">d√©clar√© Kelsey Hightower</a> : </p><br><blockquote>  Kubernetes est une plate-forme de cr√©ation de plates-formes.  La meilleure position pour commencer, mais pas pour terminer. </blockquote><p>  En cons√©quence, nous voyons un tas d'assemblages Kubernetes, ainsi que des soci√©t√©s d'h√©bergement qui essaient de cr√©er PaaS pour Kubernetes, par exemple, OpenShift et Rancher.  Dans le contexte du march√© en croissance du Kube-PaaS, Knative, cr√©√© en juillet 2018 par Google et Pivotal, fait son entr√©e sur le ring. </p><br><p>  Knative √©tait une collaboration entre Google et Pivotal, avec peu de collaboration d'autres soci√©t√©s telles que IBM, RedHat et Solo.im.  Il offre des fonctionnalit√©s PaaS similaires pour Kubernetes avec une prise en charge d'applications informatiques sans serveur de premi√®re classe.  Contrairement aux assemblys Kubernetes, Knative est install√© en tant que module compl√©mentaire √† tout cluster Kubernetes compatible et est configur√© via les ressources utilisateur. </p><br><h2 id="chto-takoe-knative">  Qu'est-ce que Knative? </h2><br><p>  Knative est d√©crit comme ¬´une plate-forme bas√©e sur Kubernetes pour fournir et g√©rer les charges de travail avec l'informatique sans serveur moderne¬ª.  En se d√©clarant √™tre une telle plate-forme, Knative met automatiquement √† l'√©chelle automatiquement les conteneurs proportionnellement aux requ√™tes HTTP simultan√©es.  Les services inutilis√©s sont finalement mis √† l'√©chelle √† z√©ro, offrant une mise √† l'√©chelle √† la demande dans le style de l'informatique sans serveur. </p><br><p>  Knative se compose d'un ensemble de contr√¥leurs install√©s dans n'importe quel cluster Kubernetes et offrant les fonctionnalit√©s suivantes: </p><br><ul><li>  assemblage d'applications conteneuris√©es √† partir du code source (fourni par le composant <em>Build</em> ), </li><li>  fournir l'acc√®s au trafic entrant aux applications (fourni par le composant <em>Serveur</em> ), </li><li>  livraison et mise √† l'√©chelle automatique des applications √† la demande (√©galement fournies par le composant <em>Serving</em> ), </li><li>  d√©termination des sources d'√©v√©nements conduisant au lancement des applications (fournies par le composant <em>Eventing</em> ). </li></ul><br><p>  Un composant cl√© est le service, qui fournit la livraison, la mise √† l'√©chelle automatique et le contr√¥le du trafic pour les applications g√©r√©es.  Apr√®s l'installation de Knative, l'acc√®s complet √† l'API Kubernetes est toujours maintenu, ce qui permet aux utilisateurs de g√©rer les applications de la mani√®re <em>habituelle</em> , et sert √©galement √† d√©boguer les services Knative en travaillant avec les m√™mes primitives d'API que ces services utilisent (modules, services, etc.). </p><br><p>  Le service automatise √©galement le routage du trafic bleu-vert, assurant la s√©paration du trafic entre les nouvelles et les anciennes versions de l'application lorsque l'utilisateur fournit une version mise √† jour de l'application. </p><br><p>  Knative lui-m√™me d√©pend de l'installation d'un contr√¥leur d'entr√©e compatible.  Au moment de la r√©daction, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Gloo API Gateway</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Istio Service Mesh sont</a> pris en charge.  Il configurera l'entr√©e disponible pour acheminer le trafic vers les applications pilot√©es par Knative. </p><br><p>  Istio Service Mesh peut devenir une grande d√©pendance pour les utilisateurs de Knative qui souhaitent l'essayer sans installer le panneau de configuration Istio, car Knative ne d√©pend que de la passerelle. </p><br><p>  Pour cette raison, la plupart des utilisateurs pr√©f√®rent Gloo comme passerelle vers Knative, qui fournit un ensemble similaire de fonctionnalit√©s avec Istio (si nous parlons de l'objectif d'utiliser uniquement Knative), ainsi que d'utiliser beaucoup moins de ressources et de r√©duire les co√ªts d'exploitation. </p><br><p>  V√©rifions Knative en action sur le stand.  J'utiliserai un cluster fra√Æchement install√© fonctionnant dans GKE: </p><br><pre> <code class="plaintext hljs">kubectl get namespace NAME STATUS AGE default Active 21h kube-public Active 21h kube-system Active 21h</code> </pre> <br><p>  Nous proc√©dons √† l'installation de Knative et Gloo.  Cela peut √™tre fait dans n'importe quel ordre: </p><br><pre> <code class="plaintext hljs">#  Knative-Serving kubectl apply -f \ https://github.com/knative/serving/releases/download/v0.8.0/serving-core.yaml namespace/knative-serving created # ... #  Gloo kubectl apply -f \ https://github.com/solo-io/gloo/releases/download/v0.18.22/gloo-knative.yaml namespace/gloo-system created # ...</code> </pre> <br><p>  V√©rifiez que tous les pods sont √† l'√©tat "En cours d'ex√©cution": </p><br><pre> <code class="plaintext hljs">kubectl get pod -n knative-serving NAME READY STATUS RESTARTS AGE activator-5dd55958cc-fkp7r 1/1 Running 0 7m32s autoscaler-fd66459b7-7d5s2 1/1 Running 0 7m31s autoscaler-hpa-85b5667df4-mdjch 1/1 Running 0 7m32s controller-85c8bb7ffd-nj9cs 1/1 Running 0 7m29s webhook-5bd79b5c8b-7czrm 1/1 Running 0 7m29s kubectl get pod -n gloo-system NAME READY STATUS RESTARTS AGE discovery-69548c8475-fvh7q 1/1 Running 0 44s gloo-5b6954d7c7-7rfk9 1/1 Running 0 45s ingress-6c46cdf6f6-jwj7m 1/1 Running 0 44s knative-external-proxy-7dd7665869-x9xkg 1/1 Running 0 44s knative-internal-proxy-7775476875-9xvdg 1/1 Running 0 44s</code> </pre> <br><p>  Gloo est pr√™t pour le routage, cr√©ons un service Knative √©volutif automatiquement (appelons-le kservice) et dirigez-le vers lui. </p><br><p>  Les services Knative offrent un moyen plus simple de fournir des applications √† Kubernetes - par rapport au mod√®le r√©gulier Deployment + Service + Ingress.  Nous allons travailler avec un tel exemple: </p><br><pre> <code class="plaintext hljs">apiVersion: serving.knative.dev/v1alpha1 kind: Service metadata: name: helloworld-go namespace: default spec: template: spec: containers: - image: gcr.io/knative-samples/helloworld-go env: - name: TARGET Value: Knative user</code> </pre> <br><p>  J'ai copi√© ceci dans un fichier, puis l'ai appliqu√© √† mon cluster Kubernetes de cette fa√ßon: </p><br><pre> <code class="plaintext hljs">kubectl apply -f ksvc.yaml -n default</code> </pre> <br><p>  Nous pouvons voir les ressources cr√©√©es par Knative dans le cluster apr√®s la livraison de notre kservice ¬´helloworld-go¬ª: </p><br><pre> <code class="plaintext hljs">kubectl get pod -n default NAME READY STATUS RESTARTS AGE helloworld-go-fjp75-deployment-678b965ccb-sfpn8 2/2 Running 0 68s</code> </pre> <br><p>  Le pod avec notre image ¬´helloworld-go¬ª d√©marre lorsque vous d√©ployez kservice.  S'il n'y a pas de trafic, le nombre de pods sera r√©duit √† z√©ro.  Et vice versa, si le nombre de demandes simultan√©es d√©passe une certaine valeur de seuil personnalis√©e, le nombre de pods augmentera. </p><br><pre> <code class="plaintext hljs">kubectl get ingresses.networking.internal.knative.dev -n default NAME READY REASON helloworld-go True</code> </pre> <br><p>  Knative configure son entr√©e √† l'aide d'une ressource sp√©ciale ¬´entr√©e¬ª dans l'API interne Knative.  Gloo utilise cette API comme configuration pour exposer les propri√©t√©s inh√©rentes √† PaaS, y compris le mod√®le de d√©ploiement bleu-vert, TLS automatique, les d√©lais d'expiration et d'autres fonctionnalit√©s de routage avanc√©es. </p><br><p>  Apr√®s un certain temps, nous voyons que nos pods ont disparu (car il n'y avait pas de trafic entrant): </p><br><pre> <code class="plaintext hljs">kubectl get pod -n default No resources found. kubectl get deployment -n default NAME DESIRED CURRENT UP-TO-DATE AVAILABLE AGE helloworld-go-fjp75-deployment 0 0 0 0 9m46s</code> </pre> <br><p>  Enfin, nous essaierons de les contacter.  Obtenir des URL pour Knative Proxy est facile et facile avec <code>glooctl</code> : </p><br><pre> <code class="plaintext hljs">glooctl proxy url --name knative-external-proxy http://35.190.151.188:80</code> </pre> <br><p>  Sans <code>glooctl</code> install√©, <code>glooctl</code> pouvez espionner l'adresse et le port dans le service kube: </p><br><pre> <code class="plaintext hljs">kubectl get svc -n gloo-system knative-external-proxy NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE knative-external-proxy LoadBalancer 10.16.11.157 35.190.151.188 80:32168/TCP,443:30729/TCP 77m</code> </pre> <br><p>  Ex√©cutez un peu de donn√©es avec cURL: </p><br><pre> <code class="plaintext hljs">curl -H "Host: helloworld-go.default.example.com" http://35.190.151.188 Hello Knative user!</code> </pre> <br><p>  Knative fournit des d√©veloppeurs quasi-PaaS en plus de la bo√Æte de Kubernetes, en utilisant la passerelle API hautes performances et compl√®te de Gloo.  Cette note n'a que l√©g√®rement touch√© le nombre important de fonctionnalit√©s Knative disponibles pour la personnalisation, ainsi que des fonctionnalit√©s suppl√©mentaires.  De m√™me avec Gloo! </p><br><p>  Malgr√© le fait que Knative soit encore un projet jeune, son √©quipe publie de nouvelles versions toutes les six semaines, la mise en ≈ìuvre de fonctions avanc√©es a commenc√©, par exemple, le d√©ploiement automatique de TLS, la mise √† l'√©chelle automatique du panneau de contr√¥le.  Il est tr√®s probable qu'en raison de la coop√©ration entre de nombreuses soci√©t√©s de cloud computing, ainsi que de la base de la nouvelle offre Cloud Run de Google, Knative devienne la principale option pour organiser l'informatique sans serveur et le PaaS dans Kubernetes.  Suivez l'actualit√©! </p><br><p>  <em>Depuis SouthBridge</em> <br>  L'avis des lecteurs est important pour nous, nous vous demandons donc de participer √† une petite enqu√™te li√©e aux futurs articles sur Knative, Kubernetes, l'informatique sans serveur: </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr475630/">https://habr.com/ru/post/fr475630/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr475614/index.html">Automatisation pour les plus petits. Deuxi√®me partie. Conception du r√©seau</a></li>
<li><a href="../fr475618/index.html">Comment √©crire un contrat Python intelligent sur le r√©seau Ontology. Partie 2: API de stockage</a></li>
<li><a href="../fr475622/index.html">Extension d'UObject dans Unreal Engine 4</a></li>
<li><a href="../fr475624/index.html">PHP-Watcher: un outil qui simplifie le d√©veloppement d'applications √† longue dur√©e de vie</a></li>
<li><a href="../fr475626/index.html">Les autotests peuvent-ils remplacer une personne √† la recherche de vuln√©rabilit√©s: entretien avec Alexandra Svatikova</a></li>
<li><a href="../fr475636/index.html">Incr√©menter les √©l√©ments vectoriels</a></li>
<li><a href="../fr475640/index.html">Si vous cr√©ez quelque chose, √©vitez le calendrier du responsable.</a></li>
<li><a href="../fr475642/index.html">M√©canisme de tas uniquement de tuples dans PostgreSQL</a></li>
<li><a href="../fr475646/index.html">Yuri Ryabtsev: ¬´La premi√®re interception d'un missile balistique est un √©v√©nement √† peu pr√®s √©gal au vol de Gagarine¬ª</a></li>
<li><a href="../fr475652/index.html">Comment nous avons d√©velopp√© une application mobile sur l'OS Aurora (Sailfish Mobile OS RUS)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>