<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßóüèæ ü§¥üèæ üóÇÔ∏è #BigGun. O cron√≥grafo "frame" mais simples do Arduino (medi√ß√£o da velocidade da bala) ü§∂ ‚ö±Ô∏è üë©üèª‚Äçü§ù‚Äçüë®üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Eletricamente, o design do sensor consiste apenas em condutores. Elementar. 


 Sem cintas - em princ√≠pio - estes s√£o dois "bot√µes" do terra √†s portas...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>#BigGun. O cron√≥grafo "frame" mais simples do Arduino (medi√ß√£o da velocidade da bala)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/414745/"><p><img src="https://habrastorage.org/getpro/habr/post_images/893/5b0/6a8/8935b06a8686a88a1e1d9a216abf0a9b.jpg" alt="est√∫pido - ela √© uma bala!"></p><br><p>  Eletricamente, o design do sensor consiste apenas em condutores.  Elementar. </p><br><p> Sem cintas - em princ√≠pio - estes s√£o dois "bot√µes" do terra √†s portas 2 e 3, mais simples que um receptor detector! </p><a name="habracut"></a><br><p><img src="https://habrastorage.org/getpro/habr/post_images/639/25c/65c/63925c65c475ca05acb6110558093184.jpg" alt="o dispositivo foi montado sob a cobertura da noite - para o calor do ver√£o ;-)"></p><br><p>  Uma pequena digress√£o na hist√≥ria (em it√°lico) - estou <em>envolvida em armas pneum√°ticas h√° mais de 20 anos e, durante todo esse tempo, usei o m√©todo do p√™ndulo bal√≠stico para medir a velocidade de uma bala.</em> <em><br></em>  <em>Mas a espingarda apareceu - energia contra magnum 4,5 mm calibre - 100 vezes !!!</em>  <em>mais - n√£o use o mesmo logon em suspens√µes!</em> </p><br><p>  Naquela √©poca, eu j√° havia sido apresentado ao uso do Arduino para fins pac√≠ficos._ </p><br><p>  A base foi tomada pelo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">design de Mikhail Shevchenko</a> em dois pares de sensores √≥pticos. </p><br><p>  Ele fez uma op√ß√£o montada no cano, mas o retrocesso de pneum√°ticos de mola mesmo depois de v√°rios disparos destruiu os LEDs. </p><br><p>  Tentei montar um monstro de quadro universal com muitos sensores √≥pticos - FAIL. </p><br><p>  Decidindo simplificar, cheguei √† constru√ß√£o descrita, n√£o h√° mais para onde ir ;-) </p><br><p>  O princ√≠pio dos sensores foi emprestado dos criadores do programa Airspeed (originalmente dos anos 90). </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/c76/18e/e28/c7618ee28f7247d4c56643d5e9f43417.gif" alt="dispositivo sensor"></p><br><p>  Basta adicionar um microcontrolador (a precis√£o √© uma ordem de magnitude maior)! </p><br><p>  Ou seja, quando funcionou, parece que sim! </p><br><p>  Diferentemente das placas de som, eu tinha que operar n√£o com um sinal anal√≥gico, mas com uma transi√ß√£o de 1 para 0 l√≥gico. </p><br><p>  A sorte foi precedida por muitos experimentos - 2 op√ß√µes para a estrutura, 3 tipos de "cintas" el√©tricas e 4 esbo√ßos de edi√ß√£o (programas). </p><br><p>  Puxar a tens√£o para os pinos digitais (PULLUP) acabou sendo a solu√ß√£o mais vital e est√°vel! </p><br><p>  Como resultado, a probabilidade de cometer um erro ao repetir esse esquema √© escassa! </p><br><p>  Tudo, n√£o h√° tempo para explicar mais, os sensores podem ser montados simplesmente olhando as fotos. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/78e/af4/1c5/78eaf41c5fcf0ed5380085bcc3e4a2af.jpg" alt="dispositivo montado e pronto para uso"></p><br><p>  Ent√£o, come√ßamos o jogo da FIFA - os materiais iniciais s√£o um bloco de madeira de 15x10x5cm, dois peda√ßos de folha de pl√°stico de 15x15cm, com 2,5 mm de espessura. </p><br><p>  Em uma espessura maior do quadro, os sensores podem n√£o funcionar, em uma espessura menor, eles podem ser encurtados por uma brisa. </p><br><p>  Voc√™ pode pegar papel√£o ondulado de 3 mm, balsa ou at√© fazer molduras com r√©guas comuns! </p><br><p>  A principal coisa a lembrar - 4mm de espessura - j√° √© muito, deixa de funcionar √†s seis! </p><br><p>  O tamanho da "janela" na estrutura - 9x9cm (originalmente dez) √© pequeno? </p><br><p>  <strong>Se voc√™ n√£o consegue entrar no top dez, no sentido literal e figurativo, √© muito cedo para falar sobre a necessidade de um cron√¥metro!</strong> </p><br><p>  Em seguida, recortamos peda√ßos de papel alum√≠nio 11x14 cm e, usando um l√°pis adesivo comum, prenda cuidadosamente as molduras dos dois lados. </p><br><p>  Fixamos o √∫ltimo na base (barra) para que a dist√¢ncia entre eles seja de 10 cm (a base do cron√≥grafo embutida no desenho). </p><br><p>  Ao mesmo tempo, o pr√≥prio feixe j√° deve ter 100 mm.  para a espessura de um quadro (de fato, a madeira resultante da secagem no pr√≥prio armaz√©m diminui de tamanho ;-) </p><br><p>  As arma√ß√µes em forma de U s√£o feitas por raz√µes de "reutiliza√ß√£o" de um "conjunto" de papel alum√≠nio - ap√≥s cada disparo com uma r√©gua, desenhamos entre pares de placas para abrir o contato na √°rea dos buracos de bala. </p><br><p>  Por conveni√™ncia e simplicidade de garantir o contato com a pel√≠cula, foram feitos clipes baseados em prendedores de roupa: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/c8e/15d/8f0/c8e15d8f0a3b59ede268fa42bb74f24d.jpg" alt="materiais √† m√£o entram em jogo - at√© prendedores de roupa foram √∫teis!"></p><br><p>  Tomei um par tran√ßado multicore como condutores - estanhei todas as extremidades (lembramos que cobre e alum√≠nio n√£o est√£o diretamente conectados!) </p><br><p>  Ent√£o n√≥s descobrimos isso. </p><br><p>  Agora vamos para o microcontrolador - tudo estava depurando no arduino Uno (Atmega-328) 16Mhz + LCD Keypad Shield. </p><br><p>  Ent√£o, o texto do esbo√ßo (programa): </p><br><pre><code class="hljs pgsql">//   #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;LiquidCrystal.h&gt; //!    -     !!! LiquidCrystal lcd(<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>); // : //  unsigned <span class="hljs-type"><span class="hljs-type">int</span></span> data = <span class="hljs-number"><span class="hljs-number">0</span></span>; //     <span class="hljs-keyword"><span class="hljs-keyword">volatile</span></span> unsigned long <span class="hljs-type"><span class="hljs-type">int</span></span> time1 = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">volatile</span></span> unsigned long <span class="hljs-type"><span class="hljs-type">int</span></span> time2 = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-type"><span class="hljs-type">void</span></span> setup() { //     LCD lcd.<span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>(<span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>); //      attachInterrupt(<span class="hljs-number"><span class="hljs-number">0</span></span>, sensor_1, FALLING); attachInterrupt(<span class="hljs-number"><span class="hljs-number">1</span></span>, sensor_2, FALLING); //     -  pinMode(<span class="hljs-number"><span class="hljs-number">2</span></span>, INPUT_PULLUP); pinMode(<span class="hljs-number"><span class="hljs-number">3</span></span>, INPUT_PULLUP); } <span class="hljs-type"><span class="hljs-type">void</span></span> <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span>() { lcd.setCursor(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.print("CHRON 100mm base"); //    nogood: //    -  -     #   CHRON <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( digitalRead(<span class="hljs-number"><span class="hljs-number">2</span></span>) == LOW ) { lcd.setCursor(<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.print("#"); goto nogood; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { lcd.setCursor(<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.print(" "); } //    -  -     #   base <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( digitalRead(<span class="hljs-number"><span class="hljs-number">3</span></span>) == LOW ) { lcd.setCursor(<span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.print("#"); goto nogood; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { lcd.setCursor(<span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.print(" "); } lcd.setCursor(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); lcd.print("Speed "); lcd.setCursor(<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); lcd.print(data); lcd.setCursor(<span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); lcd.print("M/S"); delay(<span class="hljs-number"><span class="hljs-number">100</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ( time1 == <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; time2 == <span class="hljs-number"><span class="hljs-number">0</span></span> ) ; delay(<span class="hljs-number"><span class="hljs-number">100</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( time1 != <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; time2 != <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; time2 &gt; time1 ) { data = <span class="hljs-number"><span class="hljs-number">0.1</span></span> / ((time2 - time1) / <span class="hljs-number"><span class="hljs-number">1000000.0</span></span>); // v = s / t } // <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println(data) //      -       LiquidCrystal (lcd), //   - <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println -      Arduino IDE lcd.setCursor(<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); lcd.print(data); time1 = <span class="hljs-number"><span class="hljs-number">0</span></span>; time2 = <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-type"><span class="hljs-type">void</span></span> sensor_1() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( time1 == <span class="hljs-number"><span class="hljs-number">0</span></span> ) { time1 = micros(); } } <span class="hljs-type"><span class="hljs-type">void</span></span> sensor_2() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( time2 == <span class="hljs-number"><span class="hljs-number">0</span></span> ) { time2 = micros(); } }</code> </pre> <br><p>  Em resumo, o princ√≠pio de opera√ß√£o - o comando PULLUP nos pinos 2,3 ativa a tens√£o de pull-up (com resistores internos de 20 a 50 kOhm) <br>  Um per√≠odo de bala produz um curto-circuito detectado por interrup√ß√µes (sensor FALLING), como os comandos mais r√°pidos do arduino. <br>  Sabendo a diferen√ßa hor√°ria e a dist√¢ncia entre os sensores, a velocidade da bala √© calculada. </p><br><p>  <strong>IMPORTANTE ordem dos sensores - o primeiro - ao pino 2!</strong> </p><br><p>  S√≥ isso. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b7e/351/16f/b7e35116fc831a155f66b249129106ba.jpg"></p><br><p>  Algu√©m objetar√° que a energia √© gasta em romper a folha, e a velocidade real da bala ser√° maior! </p><br><p>  No come√ßo, tudo parecia ser assim! </p><br><p>  Em compara√ß√£o com a velocidade medida h√° um ano e meio por um dispositivo com sensores √≥pticos (280m / s) - o dispositivo na l√¢mina produziu 260! </p><br><p>  Energeticamente - s√£o 22 Joules vs 19!  - perda imediatamente treshki! </p><br><p>  Mas assim que reduzi a base para 100 mm, a ‚Äúfolha‚Äù come√ßou a mostrar o resultado correto - por que - um mist√©rio! </p><br><p>  As balas usaram um Luman FT 0.56gram, dispositivos baseados no mesmo microcontrolador, a base em ambos os casos √© de 100mm, um rifle </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/21e/9d2/e5c/21e9d2e5c1856c4b809f080339430fe4.jpg" alt="Diana-54 airking"></p><br><p>  <strong>Agora, sobre a estabilidade das leituras - de 5 disparos, a ‚Äúeje√ß√£o‚Äù √© apenas uma de cada vez, o n√∫mero das outras - concorda.</strong> </p><br><p>  Sim, e por fim, pergunte - por que na era da eletr√¥nica reinventar a roda? </p><br><p>  Tudo √© muito simples - a resposta √© uma espingarda! </p><br><p>  Ao medir a velocidade de uma cobran√ßa em uma partida - n√£o h√° problema - qualquer dispositivo serve! </p><br><p>  Mas √† dist√¢ncia, o tiro tem a capacidade de dispersar (o alvo padr√£o para verificar seixos √© 75x75cm). </p><br><p>  E agora imagine a op√ß√£o de medir a velocidade de carga a 35 metros - se mesmo um dispositivo chin√™s por US $ 50 for dividido, ser√° um insulto. </p><br><p>  A sa√≠da √© ‚Äúreservar‚Äù a caixa e os sensores (placas de 40 mm s√£o suficientes) ou usar as descart√°veis. </p><br><p>  H√° o que e por que medir - n√£o muito longe √© a introdu√ß√£o da proibi√ß√£o da ca√ßa ao chumbo em corpos d'√°gua (depois da Europa), ser√° necess√°rio usar granalha de a√ßo, nas lojas haver√° filas para esses cartuchos (ou um pre√ßo alto). </p><br><p>  Ao fazer a coleta autom√°tica de cartuchos, n√£o quero usar os m√©todos antiquados para avaliar a efic√°cia de inserir uma t√°bua de pinho seca. </p><br><p>  <strong>Tiros bem direcionados para voc√™ e para os ca√ßadores - nem Pooh, nem Pena!</strong> </p><br><p>  <em>At√© nos encontrarmos novamente em Habr, Andrey.</em> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt414745/">https://habr.com/ru/post/pt414745/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt414735/index.html">Marca de TI. O que falar com as pessoas em confer√™ncias</a></li>
<li><a href="../pt414737/index.html">"Eles n√£o esperaram de onde": o Yahoo ser√° multado em 250 mil libras por violar as regras antigas de trabalho com a PD</a></li>
<li><a href="../pt414739/index.html">go-critical: o analisador est√°tico mais teimoso do Go</a></li>
<li><a href="../pt414741/index.html">Voc√™ mesmo provedor VDS</a></li>
<li><a href="../pt414743/index.html">Localiza√ß√£o: Case Slack</a></li>
<li><a href="../pt414747/index.html">CNS, drogas e rock and roll: uma hist√≥ria sobre um dispositivo que nos fez beber, n√£o dormir e n√£o piscar</a></li>
<li><a href="../pt414749/index.html">Conjunto de sysadmin cavalheiro</a></li>
<li><a href="../pt414751/index.html">Domesticando o WSUS com Ansible e mais</a></li>
<li><a href="../pt414753/index.html">Barramento PCIe: as limita√ß√µes f√≠sicas afetam a taxa de transfer√™ncia?</a></li>
<li><a href="../pt414755/index.html">Hackathon √© a solu√ß√£o para o problema</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>