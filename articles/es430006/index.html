<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©‚Äçüè≠ üëª üë©üèª‚Äçüîß Proyecto de ciencia de datos desde la investigaci√≥n hasta la implementaci√≥n utilizando Talking Hat como ejemplo üßëüèª‚Äçü§ù‚Äçüßëüèª üë©üèΩ‚Äçü§ù‚Äçüë®üèª üòñ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hace un mes, Lenta lanz√≥ un concurso en el que el mismo Talking Hat de Harry Potter identifica a los participantes que tienen acceso a la red social a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Proyecto de ciencia de datos desde la investigaci√≥n hasta la implementaci√≥n utilizando Talking Hat como ejemplo</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ods/blog/430006/"><p><img src="https://habrastorage.org/webt/4h/il/lk/4hillkjrgatenqqix3nypmyn8vm.png"></p><br><p>  Hace un mes, Lenta lanz√≥ un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">concurso</a> en el que el mismo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Talking Hat</a> de Harry Potter identifica a los participantes que tienen acceso a la red social a una de las cuatro facultades.  La competencia se realiz√≥ bien, los nombres que suenan de manera diferente est√°n determinados por diferentes facultades, y los nombres y apellidos similares en ingl√©s y ruso se distribuyen de manera similar.  No s√© si la distribuci√≥n depende solo de los nombres y apellidos, y si el n√∫mero de amigos u otros factores se tiene en cuenta de alguna manera, pero esta competencia sugiri√≥ la idea de este art√≠culo: tratar de entrenar a un clasificador desde cero, lo que permitir√° que los usuarios se distribuyan a diferentes facultades. </p><a name="habracut"></a><br><p>  En este art√≠culo, haremos un modelo ML simple que distribuya a las personas a los departamentos de Harry Potter dependiendo de su nombre y apellido, despu√©s de haber pasado por un peque√±o proceso de investigaci√≥n siguiendo la metodolog√≠a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CRISP</a> .  A saber nosotros: </p><br><ul><li>  Formulamos el problema; </li><li>  Investigamos posibles enfoques para su soluci√≥n y formulamos requisitos de datos (M√©todos de soluci√≥n y datos); </li><li>  Recopilaremos los datos necesarios (m√©todos de soluci√≥n y datos); </li><li>  Estudiaremos el conjunto de datos recopilados (Investigaci√≥n exploratoria); </li><li>  Extraer caracter√≠sticas de datos sin procesar (Feature Engineering); </li><li>  Ense√±emos un modelo de aprendizaje autom√°tico (evaluaci√≥n del modelo); </li><li>  Compare los resultados obtenidos, eval√∫e la calidad de las soluciones y, si es necesario, repita los p√°rrafos 2-6; </li><li>  Empacamos la soluci√≥n en un servicio que se puede usar (Producci√≥n). </li></ul><br><p><img src="https://habrastorage.org/webt/6l/pf/oa/6lpfoa17u8pxjkf7wke7pm19-h0.png"></p><br><p>  Esta tarea puede parecer trivial, por lo que impondremos una restricci√≥n adicional en todo el proceso (para que tome menos de 2 horas) y en este art√≠culo (para que su tiempo de lectura sea inferior a 15 minutos). </p><br><p>  Si ya est√° inmerso en el hermoso y maravilloso mundo de la Ciencia de Datos y no ve a Kagglite constantemente, o (Dios no quiera) medir la duraci√≥n de su Hadup durante las reuniones con colegas, lo m√°s probable es que el art√≠culo le parezca simple y sin inter√©s.  Adem√°s: la calidad de los modelos finales no es el valor principal de este art√≠culo.  Te lo hemos advertido.  Vamos </p><br><p>  Un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">repositorio de github</a> con el c√≥digo utilizado en el art√≠culo tambi√©n est√° disponible para lectores curiosos.  En caso de errores, abra PR. </p><br><h2 id="formuliruem-zadachu">  Formulamos el problema </h2><br><p>  Es posible resolver un problema que no tiene criterios de decisi√≥n claros durante un tiempo infinitamente largo, por lo que decidiremos de inmediato que queremos obtener una soluci√≥n que nos permita obtener la respuesta "Gryffindor", "Ravenclaw", "Hufflepuff" o "Slytherin" en respuesta a la l√≠nea ingresada. </p><br><p>  De hecho, queremos obtener una caja negra: </p><br><pre><code class="plaintext hljs">" " =&gt; [?] =&gt; Griffindor</code> </pre> <br><p>  El sombrero negro original distribu√≠a j√≥venes magos a los departamentos dependiendo de su naturaleza y cualidades personales.  Dado que los datos sobre el car√°cter y la personalidad de acuerdo con las condiciones de la tarea no est√°n disponibles para nosotros, utilizaremos el nombre y el apellido del participante, recordando que en este caso debemos distribuir los caracteres del libro entre los departamentos que corresponden a sus departamentos nativos del libro.  Y los potteromanos definitivamente estar√≠an molestos si nuestra decisi√≥n distribuyera a Harry a Hufflepuff o Ravenclaw (pero deber√≠a enviar a Harry a Gryffindor y Slytherin con la misma probabilidad de transmitir el esp√≠ritu del libro). </p><br><p>  Como estamos hablando de probabilidades, formalizamos el problema en t√©rminos matem√°ticos m√°s rigurosos.  Desde el punto de vista de Data Science, resolvemos el problema de clasificaci√≥n, es decir, asignar a un objeto (l√≠nea, en forma de nombre y apellido) una determinada clase (de hecho, es solo una etiqueta o etiqueta, que puede ser un n√∫mero o 4 variables que tienen un valor s√≠ / no )  Entendemos que al menos en el caso de Harry ser√° correcto dar 2 respuestas: Gryffindor y Slytherin, por lo que ser√≠a mejor no predecir la facultad espec√≠fica que define el sombrero, sino la probabilidad de que una persona sea asignada a esta facultad, por lo que nuestra decisi√≥n se tomar√° en tipo de alguna funci√≥n </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;lt;</mo><mi>N</mi><mi>a</mi><mi>m</mi><mi>e</mi><mo>&amp;gt;&amp;lt;</mo><mi>S</mi><mi>u</mi><mi>r</mi><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mo>&amp;gt;</mo><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>g</mi><mi>r</mi><mi>i</mi><mi>f</mi><mi>f</mi><mi>i</mi><mi>n</mi><mi>d</mi><mi>o</mi><mi>r</mi></mrow></msub><mo>;</mo><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>r</mi><mi>a</mi><mi>v</mi><mi>e</mi><mi>n</mi><mi>c</mi><mi>l</mi><mi>a</mi><mi>w</mi></mrow></msub><mo>;</mo><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>h</mi><mi>u</mi><mi>f</mi><mi>f</mi><mi>l</mi><mi>p</mi><mi>u</mi><mi>f</mi><mi>f</mi></mrow></msub><mo>;</mo><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>s</mi><mi>l</mi><mi>i</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>i</mi><mi>n</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="73.311ex" height="2.78ex" viewBox="0 -832 31564.4 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-66" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-28" x="550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-3C" x="940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-4E" x="1996" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-61" x="2884" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6D" x="3414" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-65" x="4292" y="0"></use><g transform="translate(5037,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-3E"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-3C" x="778" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-53" x="6871" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-75" x="7517" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-72" x="8089" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6E" x="8541" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-61" x="9141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6D" x="9671" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-65" x="10549" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-3E" x="11294" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-29" x="12072" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-3D" x="12739" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-28" x="13796" y="0"></use><g transform="translate(14185,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-50" x="0" y="0"></use><g transform="translate(642,-155)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-67" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-72" x="480" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-69" x="932" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-66" x="1277" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-66" x="1827" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-69" x="2378" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6E" x="2724" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-64" x="3324" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6F" x="3848" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-72" x="4333" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-3B" x="18311" y="0"></use><g transform="translate(18756,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-50" x="0" y="0"></use><g transform="translate(642,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-61" x="451" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-76" x="981" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-65" x="1466" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6E" x="1932" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-63" x="2533" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6C" x="2967" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-61" x="3265" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-77" x="3795" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-3B" x="22689" y="0"></use><g transform="translate(23134,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-50" x="0" y="0"></use><g transform="translate(642,-155)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-68" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-75" x="576" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-66" x="1149" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-66" x="1699" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6C" x="2250" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-70" x="2548" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-75" x="3052" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-66" x="3624" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-66" x="4175" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-3B" x="27218" y="0"></use><g transform="translate(27663,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-50" x="0" y="0"></use><g transform="translate(642,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6C" x="469" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-69" x="768" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-74" x="1113" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-68" x="1475" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-65" x="2051" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-72" x="2518" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-69" x="2969" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6E" x="3315" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-29" x="31174" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mo>&lt;</mo><mi>N</mi><mi>a</mi><mi>m</mi><mi>e</mi><mo>&gt;&lt;</mo><mi>S</mi><mi>u</mi><mi>r</mi><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mo>&gt;</mo><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mi>g</mi><mi>r</mi><mi>i</mi><mi>f</mi><mi>f</mi><mi>i</mi><mi>n</mi><mi>d</mi><mi>o</mi><mi>r</mi></mrow></msub><mo>;</mo><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi><mi>a</mi><mi>v</mi><mi>e</mi><mi>n</mi><mi>c</mi><mi>l</mi><mi>a</mi><mi>w</mi></mrow></msub><mo>;</mo><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>u</mi><mi>f</mi><mi>f</mi><mi>l</mi><mi>p</mi><mi>u</mi><mi>f</mi><mi>f</mi></mrow></msub><mo>;</mo><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mi>s</mi><mi>l</mi><mi>i</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>i</mi><mi>n</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> f (<Name> <Surname>) = (P_ {griffindor}; P_ {ravenclaw}; P_ {hufflpuff}; P_ {slitherin}) </script></p><br><h3 id="metriki-i-ocenka-kachestva">  Evaluaci√≥n de m√©tricas y calidad </h3><br><p>  La tarea y el objetivo est√°n formulados, <del>  Ahora pensaremos c√≥mo resolverlo </del>  pero eso no es todo.  Para comenzar el estudio, debe ingresar m√©tricas de calidad.  En otras palabras, para determinar c√≥mo compararemos 2 soluciones diferentes entre s√≠. </p><br><p>  Todo en la vida es bueno y simple: entendemos intuitivamente que un detector de correo no deseado debe pasar un m√≠nimo de correo no deseado a los mensajes entrantes, as√≠ como pasar un m√°ximo de las letras necesarias y ciertamente no debe enviar las cartas necesarias al correo no deseado. </p><br><p>  En realidad, todo es m√°s complicado y la confirmaci√≥n de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">esto es una</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gran</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">cantidad de</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culos</a> que explican c√≥mo y qu√© m√©tricas se utilizan.  La pr√°ctica ayuda a entender esto mejor, pero este es un tema tan voluminoso que prometemos escribir una publicaci√≥n separada sobre √©l y hacer una mesa abierta para que todos puedan jugar y comprender en la pr√°ctica c√≥mo difiere esto. </p><br><p>  El hogar "pero escojamos lo mejor" para nosotros ser√° <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ROC AUC</a> .  Esto es exactamente lo que queremos de la m√©trica en este caso: cuanto menos falsos positivos y m√°s precisa la predicci√≥n real, mayor es el AUC de ROC. </p><br><p>  Para un modelo ROC ideal, AUC es 1, para un modelo aleatorio ideal que define clases <em>absolutamente al azar</em> - 0.5. </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>R</mi><mi>O</mi><mi>C</mi><mtext>&amp;#xA0;</mtext><mi>A</mi><mi>U</mi><mi>C</mi><mtext>&amp;#xA0;</mtext><mi>e</mi><mi>n</mi><mo stretchy=&quot;false&quot;>[</mo><mn>0.5</mn><mo>;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.697ex" height="2.66ex" viewBox="0 -832 8911.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-52" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-4F" x="759" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-43" x="1523" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-41" x="2533" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-55" x="3284" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-43" x="4051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-65" x="5062" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6E" x="5528" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-5B" x="6129" y="0"></use><g transform="translate(6407,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-35" x="779" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-3B" x="7687" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-31" x="8132" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-5D" x="8632" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>R</mi><mi>O</mi><mi>C</mi><mtext>&nbsp;</mtext><mi>A</mi><mi>U</mi><mi>C</mi><mtext>&nbsp;</mtext><mi>e</mi><mi>n</mi><mo stretchy="false">[</mo><mn>0.5</mn><mo>;</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> ROC \ AUC \ en [0.5; 1] </script></p><br><h2 id="algoritmy">  Algoritmos </h2><br><p>  Nuestra caja negra debe tener en cuenta la distribuci√≥n de los h√©roes de los libros, tomar un nombre y apellido diferentes como entrada y dar el resultado.  Para resolver el problema de clasificaci√≥n, puede usar diferentes algoritmos de aprendizaje autom√°tico: </p><br><p>  redes neuronales, m√°quinas de factorizaci√≥n, regresi√≥n lineal o, por ejemplo, SVM. </p><br><p>  Contrariamente a la creencia popular, Data Science no se limita solo a redes neuronales, y para popularizar esta idea, en este art√≠culo, las redes neuronales se dejan <em>como un ejercicio para un lector curioso</em> .  Aquellos que no tomaron un solo curso en an√°lisis de datos (especialmente el subjetivamente <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">mejor</a> del SDO), o simplemente leyeron <em>n</em> noticias sobre aprendizaje autom√°tico o IA, que ahora se publican incluso en las revistas de pescadores aficionados, deben haber conocido los nombres de grupos generales de algoritmos : embolsado, refuerzo, m√©todo de vector de soporte (SVM), regresi√≥n lineal.  Son ellos los que usaremos para resolver nuestro problema. </p><br><p>  Y para ser m√°s precisos, comparamos: </p><br><ul><li>  Regresi√≥n lineal </li><li>  Impulso (XGboost, LightGBM) </li><li>  Decidir √°rboles (estrictamente hablando, este es el mismo impulso, pero lo sacaremos por separado: √Årboles adicionales) </li><li>  Ensacado (bosque aleatorio) </li><li>  SVM </li></ul><br><p>  Podemos resolver el problema de distribuir a cada estudiante de Hogwarts a una de las facultades definiendo la facultad que le corresponde, pero estrictamente hablando, esta tarea <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">se reduce</a> a resolver el problema de determinar si cada clase pertenece individualmente.  Por lo tanto, en el marco de este art√≠culo nos fijamos el objetivo de obtener 4 modelos, uno para cada facultad. </p><br><h2 id="dannye">  Datos </h2><br><p>  Encontrar el conjunto de datos adecuado para la capacitaci√≥n y, lo que es m√°s importante, legal para usarlo con el prop√≥sito correcto, es una de las tareas m√°s complejas y que requieren mucho tiempo en Data Science.  Para nuestra tarea, tomaremos los datos de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">wikia en</a> todo el mundo de Harry Potter.  Por ejemplo, en este enlace puedes encontrar todos los personajes que estudiaron en la facultad de Gryffindor.  Es importante que en este caso utilicemos los datos para fines no comerciales, por lo tanto, no violamos la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">licencia de</a> este sitio. </p><br><p><img src="https://habrastorage.org/webt/ff/f8/4e/fff84efaafg_yqwbhuhbfyz17k0.jpeg"></p><br><p>  Para aquellos que piensan que los Data Scientists son muy buenos, ir√© a Data Scientists y me dejar√© ense√±arles, les recordamos que hay un paso como limpiar y preparar datos.  Los datos descargados se deben moderar manualmente para eliminar, por ejemplo, "El S√©ptimo Prefecto de Gryffindor" y eliminar la "Chica desconocida de Gryffindor" de forma semiautom√°tica.  En el trabajo real, una parte proporcionalmente grande de la tarea siempre est√° asociada con la preparaci√≥n, limpieza y restauraci√≥n de valores perdidos en el conjunto de datos. </p><br><p>  Un poco de ctrl + c &amp; ctrl + v y en la salida obtenemos 4 archivos de texto, que contienen los nombres de los caracteres en 2 idiomas: ingl√©s y ruso. </p><br><h2 id="izuchaem-sobrannye-dannye--eda-exploratory-data-analysis">  Estudiamos los datos recopilados (EDA, An√°lisis Exploratorio de Datos) </h2><br><p>  Para esta etapa, tenemos 4 archivos que contienen los nombres de estudiantes de facultades, veremos con m√°s detalle: </p><br><pre> <code class="bash hljs">$ ls ../input griffindor.txt hufflpuff.txt ravenclaw.txt slitherin.txt</code> </pre> <br><p>  Cada archivo contiene 1 nombre y apellido (si corresponde) del alumno por l√≠nea: </p><br><pre> <code class="bash hljs">$ wc -l ../input/*.txt 250 ../input/griffindor.txt 167 ../input/hufflpuff.txt 180 ../input/ravenclaw.txt 254 ../input/slitherin.txt 851 total</code> </pre> <br><p>  Los datos recopilados son de la forma: </p><br><pre> <code class="bash hljs">$ cat ../input/griffindor.txt | head -3 &amp;&amp; cat ../input/griffindor.txt | tail -3      Charlie Stainforth Melanie Stanmore Stewart</code> </pre> <br><p>  Toda nuestra idea se basa en el supuesto de que hay algo similar en los nombres y apellidos que nuestra caja negra (o sombrero negro) puede aprender a distinguir. </p><br><p>  El algoritmo puede alimentar las l√≠neas tal cual, pero el resultado no ser√° bueno, porque los modelos b√°sicos no podr√°n comprender de forma independiente c√≥mo "Draco" difiere de "Harry", por lo que tendremos que extraer signos de nuestros nombres y apellidos. </p><br><h3 id="podgotovka-dannyh-feature-engineering">  Preparaci√≥n de datos (ingenier√≠a de caracter√≠sticas) </h3><br><p>  <strong>Los signos</strong> (o caracter√≠sticas, de la <strong>caracter√≠stica caracter√≠stica en</strong> <em>ingl√©s</em> ) son las propiedades distintivas de un objeto.  La cantidad de veces que una persona cambi√≥ de trabajo durante el a√±o pasado, la cantidad de dedos en su mano izquierda, la capacidad del motor, si el millaje del autom√≥vil excede los 100,000 km o no.  Todo tipo de clasificaciones de signos fueron inventadas por un gran n√∫mero, no hay ni puede haber un solo sistema a este respecto, por lo que daremos ejemplos de qu√© signos pueden ser: </p><br><ol><li>  N√∫mero racional </li><li>  Categor√≠a (hasta 12, 12-18 o 18+) </li><li>  Valor binario (devolvi√≥ el primer pr√©stamo o no) </li><li>  Fecha, color, acciones, etc. </li></ol><br><p>  <strong>La b√∫squeda</strong> (o formaci√≥n) de <strong>caracter√≠sticas</strong> (en <em>ingl√©s</em> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Feature Engineering</a> ) a menudo se destaca como una etapa separada de investigaci√≥n o el trabajo de un especialista en an√°lisis de datos.  De hecho, el sentido com√∫n, la experiencia y las pruebas de hip√≥tesis ayudan en el proceso mismo.  Adivinar los signos correctos de inmediato es una combinaci√≥n de mano completa, conocimiento fundamental y suerte.  A veces hay chamanismo, pero el enfoque general es muy simple: debe hacer lo que le viene a la mente y luego verificar si fue posible mejorar la soluci√≥n agregando un nuevo atributo.  Por ejemplo, como una se√±al para nuestra tarea, podemos tomar el n√∫mero de chisporroteos en el nombre. </p><br><p>  En la primera versi√≥n (porque el estudio real de Data Science, como obra maestra, nunca se puede completar) de nuestro modelo, utilizaremos las siguientes caracter√≠sticas para el nombre y el apellido: </p><br><ol><li>  1 y la √∫ltima letra de la palabra - vocal o consonante </li><li>  Vocales dobles y consonantes </li><li>  N√∫mero de vocales, consonantes, sordas, sonoras </li><li>  Longitud del nombre, longitud del apellido </li><li>  ... </li></ol><br><p>  Para hacer esto, tomaremos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">este</a> repositorio como base y agregaremos una clase para que pueda usarse para letras latinas.  Esto nos dar√° la oportunidad de determinar c√≥mo suena cada letra. </p><br><pre> <code class="python hljs">&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> Phonetic <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> RussianLetter, EnglishLetter &gt;&gt; RussianLetter(<span class="hljs-string"><span class="hljs-string">''</span></span>).classify() {<span class="hljs-string"><span class="hljs-string">'consonant'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-string"><span class="hljs-string">'deaf'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'hard'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'mark'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'paired'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'shock'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'soft'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'sonorus'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-string"><span class="hljs-string">'vowel'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>} &gt;&gt; EnglishLetter(<span class="hljs-string"><span class="hljs-string">'d'</span></span>).classify() {<span class="hljs-string"><span class="hljs-string">'consonant'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-string"><span class="hljs-string">'deaf'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'hard'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-string"><span class="hljs-string">'mark'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'paired'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'shock'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'soft'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'sonorus'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-string"><span class="hljs-string">'vowel'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>}</code> </pre> <br><p>  Ahora podemos definir funciones simples para calcular estad√≠sticas, por ejemplo: </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">starts_with_letter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(word, letter_type=</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'vowel'</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""   ,    . :param word:  :param letter_type: 'vowel'  'consonant'.   . :return: Boolean """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(word) == <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Letter(word[<span class="hljs-number"><span class="hljs-number">0</span></span>]).classify()[letter_type] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">count_letter_type</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(word)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""       . :param word:  :param debug:    :return: :obj:`dict` of :obj:`str` =&gt; :int:count """</span></span> count = { <span class="hljs-string"><span class="hljs-string">'consonant'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'deaf'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'hard'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'mark'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'paired'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'shock'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'soft'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'sonorus'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'vowel'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> letter <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> word: classes = Letter(letter).classify() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> key <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> count.keys(): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> classes[key]: count[key] += <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> count</code> </pre> <br><p>  Usando estas funciones, ya podemos obtener los primeros signos: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> feature_engineering <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * &gt;&gt; print(<span class="hljs-string"><span class="hljs-string">"  (¬´¬ª): "</span></span>, len(<span class="hljs-string"><span class="hljs-string">""</span></span>))   (¬´¬ª): <span class="hljs-number"><span class="hljs-number">5</span></span> &gt;&gt; print(<span class="hljs-string"><span class="hljs-string">" (¬´¬ª)   : "</span></span>, starts_with_letter(<span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'vowel'</span></span>))  (¬´¬ª)   : <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> &gt;&gt; print(<span class="hljs-string"><span class="hljs-string">" (¬´¬ª)   : "</span></span>, starts_with_letter(<span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'consonant'</span></span>))  (¬´¬ª)   : <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> &gt;&gt; count_Harry = count_letter_type(<span class="hljs-string"><span class="hljs-string">""</span></span>) &gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"     (¬´¬ª): "</span></span>, count_Harry[<span class="hljs-string"><span class="hljs-string">'paired'</span></span>])      (¬´¬ª): <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br><p>  Estrictamente hablando, con la ayuda de estas funciones podemos obtener una representaci√≥n vectorial de la cadena, es decir, obtenemos la asignaci√≥n: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;lt;</mo><mi>N</mi><mi>o</mi><mi>m</mi><mi>b</mi><mi>r</mi><mi>e</mi><mo>&amp;gt;&amp;lt;</mo><mi>S</mi><mi>u</mi><mi>r</mi><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mo>&amp;gt;</mo><mo stretchy=&quot;false&quot;>)</mo><mo>=&amp;gt;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>g</mi><mi>i</mi><mi>t</mi><mi>u</mi><msub><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mi>o</mi><mi>m</mi><mi>b</mi><mi>r</mi><mi>e</mi></mrow></msub><mo>,</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>g</mi><mi>i</mi><mi>t</mi><mi>u</mi><msub><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>a</mi><mi>p</mi><mi>e</mi><mi>l</mi><mi>l</mi><mi>i</mi><mi>d</mi><mi>o</mi></mrow></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFA;</mo></mrow><mi>m</mi><mi>e</mi><mi>r</mi><mi>o</mi><mi>d</mi><mi>e</mi><msub><mtext>&amp;#xA0;</mtext><mi>v</mi></msub><mi>o</mi><mi>w</mi><mi>e</mi><mi>l</mi><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>a</mi><mi>p</mi><mi>e</mi><mi>l</mi><mi>l</mi><mi>i</mi><mi>d</mi><mi>o</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="95.531ex" height="2.78ex" viewBox="0 -832 41131.3 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-66" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-28" x="550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-3C" x="940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-4E" x="1996" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6F" x="2884" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6D" x="3370" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-62" x="4248" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-72" x="4678" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-65" x="5129" y="0"></use><g transform="translate(5874,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-3E"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-3C" x="778" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-53" x="7708" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-75" x="8354" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-72" x="8926" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6E" x="9378" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-61" x="9978" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6D" x="10508" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-65" x="11386" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-3E" x="12131" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-29" x="12909" y="0"></use><g transform="translate(13576,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-3D"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-3E" x="778" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-28" x="15411" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6C" x="15801" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6F" x="16099" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6E" x="16585" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-67" x="17185" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-69" x="17666" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-74" x="18011" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-75" x="18373" y="0"></use><g transform="translate(18945,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-64" x="0" y="0"></use><g transform="translate(520,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6F" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6D" x="1086" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-62" x="1964" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-72" x="2394" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-65" x="2845" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-2C" x="21908" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6C" x="22353" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6F" x="22651" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6E" x="23137" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-67" x="23737" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-69" x="24218" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-74" x="24563" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-75" x="24925" y="0"></use><g transform="translate(25497,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-64" x="0" y="0"></use><g transform="translate(520,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-70" x="529" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-65" x="1033" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6C" x="1499" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6C" x="1798" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-69" x="2096" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-64" x="2442" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6F" x="2965" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-2C" x="28558" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-2E" x="29003" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-2E" x="29448" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-2E" x="29893" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-2C" x="30339" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6E" x="30784" y="0"></use><g transform="translate(31384,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">√∫</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6D" x="31799" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-65" x="32678" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-72" x="33144" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6F" x="33596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-64" x="34081" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-65" x="34605" y="0"></use><g transform="translate(35071,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-76" x="353" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6F" x="35765" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-77" x="36250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-65" x="36967" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6C" x="37433" y="0"></use><g transform="translate(37732,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-73" x="0" y="0"></use><g transform="translate(469,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-70" x="529" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-65" x="1033" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6C" x="1499" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6C" x="1798" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-69" x="2096" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-64" x="2442" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMATHI-6F" x="2965" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhgKS4Hzt-RoS71lazDGN7Z-VNlECg#MJMAIN-29" x="40741" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mo>&lt;</mo><mi>N</mi><mi>o</mi><mi>m</mi><mi>b</mi><mi>r</mi><mi>e</mi><mo>&gt;&lt;</mo><mi>S</mi><mi>u</mi><mi>r</mi><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mo>&gt;</mo><mo stretchy="false">)</mo><mo>=&gt;</mo><mo stretchy="false">(</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>g</mi><mi>i</mi><mi>t</mi><mi>u</mi><msub><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>o</mi><mi>m</mi><mi>b</mi><mi>r</mi><mi>e</mi></mrow></msub><mo>,</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>g</mi><mi>i</mi><mi>t</mi><mi>u</mi><msub><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>p</mi><mi>e</mi><mi>l</mi><mi>l</mi><mi>i</mi><mi>d</mi><mi>o</mi></mrow></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mo>√∫</mo></mrow><mi>m</mi><mi>e</mi><mi>r</mi><mi>o</mi><mi>d</mi><mi>e</mi><msub><mtext>&nbsp;</mtext><mi>v</mi></msub><mi>o</mi><mi>w</mi><mi>e</mi><mi>l</mi><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>p</mi><mi>e</mi><mi>l</mi><mi>l</mi><mi>i</mi><mi>d</mi><mi>o</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> f (<Nombre> <Surname>) => (longitud_ {nombre}, longitud_ {apellido}, ..., n√∫mero de \ _vowels_ {apellido}) </script></p><br><p>  Ahora podemos presentar nuestros datos en forma de un conjunto de datos que se puede ingresar al algoritmo de aprendizaje autom√°tico: </p><br><pre> <code class="python hljs">&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> data_loaders <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> load_processed_data &gt;&gt; hogwarts_df = load_processed_data() &gt;&gt; hogwarts_df.head()</code> </pre> <br><p><img src="https://habrastorage.org/webt/5-/-e/4g/5--e4gvhmdhe00fxjhwqnxzdajk.png"></p><br><p>  Adem√°s, como resultado, obtenemos los siguientes s√≠ntomas para cada estudiante: </p><br><pre> <code class="python hljs">&gt;&gt; hogwarts_df[hogwarts_df.columns].dtypes</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Se√±ales recibidas</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">name object surname object is_english bool name_starts_with_vowel bool name_starts_with_consonant bool name_ends_with_vowel bool name_ends_with_consonant bool name_length int64 name_vowels_count int64 name_double_vowels_count int64 name_consonant_count int64 name_double_consonant_count int64 name_paired_count int64 name_deaf_count int64 name_sonorus_count int64 surname_starts_with_vowel bool surname_starts_with_consonant bool surname_ends_with_vowel bool surname_ends_with_consonant bool surname_length int64 surname_vowels_count int64 surname_double_vowels_count int64 surname_consonant_count int64 surname_double_consonant_count int64 surname_paired_count int64 surname_deaf_count int64 surname_sonorus_count int64 is_griffindor int64 is_hufflpuff int64 is_ravenclaw int64 is_slitherin int64 dtype: object</code> </pre> </div></div><br><p>  Las √∫ltimas 4 columnas est√°n orientadas: contienen informaci√≥n sobre en qu√© facultad est√° inscrito un estudiante. </p><br><h2 id="obuchenie-algoritmov">  Entrenamiento de algoritmos </h2><br><p>  En pocas palabras, los algoritmos se entrenan como las personas: cometen errores y aprenden de ellos.  Para comprender cu√°nto cometieron un error, los algoritmos usan funciones de <strong>error</strong> (funciones de p√©rdida, funci√≥n de <strong>p√©rdida en</strong> <em>ingl√©s</em> ). </p><br><p>  Como regla general, el proceso de aprendizaje es muy simple y consta de varios pasos: </p><br><ol><li>  Haz una predicci√≥n. </li><li>  Califica el error. </li><li>  Corregir los par√°metros del modelo. </li><li>  Repita 1-3 hasta que se alcance el objetivo, el proceso se detenga o finalicen los datos. </li><li><p>  Califique la calidad del modelo resultante. </p><br><p>  En la pr√°ctica, por supuesto, todo es un poco m√°s complicado.  Por ejemplo, existe el fen√≥meno del <strong>sobreajuste</strong> : el algoritmo puede recordar literalmente qu√© caracter√≠sticas corresponden a la respuesta y, por lo tanto, empeorar el resultado para objetos que no son similares a aquellos en los que fue entrenado.  Para evitar esto, hay varias t√©cnicas y hacks. </p><br></li></ol><br><p>  Como se mencion√≥ anteriormente, resolveremos 4 problemas: uno para cada facultad.  Por lo tanto, prepararemos datos para Slytherin: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  ,     - : &gt;&gt; data_full = hogwarts_df.drop( [ 'name', 'surname', 'is_griffindor', 'is_hufflpuff', 'is_ravenclaw' ], axis=1).copy() #    ,   : &gt;&gt; X_data = data_full.drop('is_slitherin', axis=1) #     ,   1    &gt;&gt; y = data_full.is_slitherin</span></span></code> </pre> <br><p>  Mientras aprende, el algoritmo compara constantemente sus resultados con datos reales, ya que esta parte del conjunto de datos se asigna para validaci√≥n.  La regla del buen tono tambi√©n se considera para evaluar el resultado del algoritmo en datos individuales que el algoritmo no vio en absoluto.  Por lo tanto, ahora dividimos la muestra en la proporci√≥n de 70/30 y entrenamos el primer algoritmo: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.cross_validation <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_test_split <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.ensemble <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> RandomForestClassifier <span class="hljs-comment"><span class="hljs-comment">#      &gt;&gt; seed = 7 #    &gt;&gt; test_size = 0.3 &gt;&gt; X_train, X_test, y_train, y_test = train_test_split(X_data, y, test_size=test_size, random_state=seed) &gt;&gt; rfc = RandomForestClassifier() &gt;&gt; rfc_model = rfc.fit(X_train, y_train)</span></span></code> </pre> <br><p>  Listo  Ahora, si env√≠a datos a la entrada de este modelo, producir√° un resultado.  Esto es divertido, as√≠ que antes de nada verificaremos si la modelo en Harry reconoce al Slytherin.  Para hacer esto, primero prepare las funciones para obtener la predicci√≥n del algoritmo: </p><br><div class="spoiler">  <b class="spoiler_title">Ver c√≥digo</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> data_loaders <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> parse_line_to_hogwarts_df <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_single_student_features</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""      :param name: string     :return: pd.DataFrame     """</span></span> featurized_person_df = parse_line_to_hogwarts_df(name) person_df = pd.DataFrame(featurized_person_df, columns=[ <span class="hljs-string"><span class="hljs-string">'name'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname'</span></span>, <span class="hljs-string"><span class="hljs-string">'is_english'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_starts_with_vowel'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_starts_with_consonant'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_ends_with_vowel'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_ends_with_consonant'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_length'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_vowels_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_double_vowels_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_consonant_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_double_consonant_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_paired_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_deaf_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_sonorus_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_starts_with_vowel'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_starts_with_consonant'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_ends_with_vowel'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_ends_with_consonant'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_length'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_vowels_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_double_vowels_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_consonant_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_double_consonant_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_paired_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_deaf_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_sonorus_count'</span></span>, ], index=[<span class="hljs-number"><span class="hljs-number">0</span></span>] ) featurized_person = person_df.drop( [<span class="hljs-string"><span class="hljs-string">'name'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname'</span></span>], axis = <span class="hljs-number"><span class="hljs-number">1</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> featurized_person <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_predictions_vector</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(model, person)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""    :param model:   :param person: string   :return: list    """</span></span> encoded_person = get_single_student_features(person) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> model.predict_proba(encoded_person)[<span class="hljs-number"><span class="hljs-number">0</span></span>]</code> </pre> </div></div><br><p>  Ahora configuremos un peque√±o conjunto de datos de prueba para considerar los resultados del algoritmo. </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">score_testing_dataset</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(model)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""      . :param model:   """</span></span> testing_dataset = [ <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"Kirill Malev"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"Harry Potter"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>,<span class="hljs-string"><span class="hljs-string">"Severus Snape"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"Tom Riddle"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"Salazar Slytherin"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> name <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> testing_dataset: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"{} ‚Äî {}"</span></span>.format(name, get_predictions_vector(model, name)[<span class="hljs-number"><span class="hljs-number">1</span></span>])) score_testing_dataset(rfc_model)</code> </pre> <br><pre> <code class="plaintext hljs">  ‚Äî 0.5 Kirill Malev ‚Äî 0.5   ‚Äî 0.0 Harry Potter ‚Äî 0.0   ‚Äî 0.75   ‚Äî 0.9 Severus Snape ‚Äî 0.5   ‚Äî 0.2 Tom Riddle ‚Äî 0.5   ‚Äî 0.2 Salazar Slytherin ‚Äî 0.3</code> </pre> <br><p>  Los resultados fueron dudosos.  Incluso el fundador de la facultad no estar√≠a en su facultad, seg√∫n este modelo.  Por lo tanto, debe evaluar la calidad estricta: mire las m√©tricas que le preguntamos al principio: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.metrics <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> accuracy_score, roc_auc_score, classification_report predictions = rfc_model.predict(X_test) print(<span class="hljs-string"><span class="hljs-string">"Classification report: "</span></span>) print(classification_report(y_test, predictions)) print(<span class="hljs-string"><span class="hljs-string">"Accuracy for Random Forest Model: %.2f"</span></span> % (accuracy_score(y_test, predictions) * <span class="hljs-number"><span class="hljs-number">100</span></span>)) print(<span class="hljs-string"><span class="hljs-string">"ROC AUC from first Random Forest Model: %.2f"</span></span> % (roc_auc_score(y_test, predictions)))</code> </pre> <br><pre> <code class="plaintext hljs">Classification report: precision recall f1-score support 0 0.66 0.88 0.75 168 1 0.38 0.15 0.21 89 avg / total 0.56 0.62 0.56 257 Accuracy for Random Forest Model: 62.26 ROC AUC from first Random Forest Model: 0.51</code> </pre> <br><p>  No es sorprendente que los resultados fueran tan dudosos: el AUC ROC de aproximadamente 0,51 sugiere que el modelo predice un poco mejor que un lanzamiento de moneda. </p><br><h2 id="testirovanie-poluchennyh-rezultatov-metriki-kachestva">  Probar los resultados.  M√©tricas de calidad </h2><br><p>  Usando un ejemplo anterior, observamos c√≥mo se entrena 1 algoritmo que admite interfaces sklearn.  El resto se entrena exactamente de la misma manera, por lo que solo podemos entrenar todos los algoritmos y elegir el mejor en cada caso. </p><br><p><img src="https://habrastorage.org/webt/ff/i0/fq/ffi0fqqs7gbi3aczbucvusrw2qi.jpeg"></p><br><p>  Esto no es complicado, para cada algoritmo entrenamos 1 con configuraciones est√°ndar, y tambi√©n entrenamos un conjunto completo, clasificando a trav√©s de varias opciones que afectan la calidad del algoritmo.  Esta etapa se llama Model Tuning u Hyperparameter Optimization y su esencia es muy simple: se selecciona el conjunto de configuraciones que da el mejor resultado. </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> model_training <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_classifiers <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> data_loaders <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> load_processed_data <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> warnings warnings.filterwarnings(<span class="hljs-string"><span class="hljs-string">'ignore'</span></span>) <span class="hljs-comment"><span class="hljs-comment">#   hogwarts_df = load_processed_data() #     data_full = hogwarts_df.drop( [ 'name', 'surname', 'is_griffindor', 'is_hufflpuff', 'is_ravenclaw' ], axis=1).copy() X_data = data_full.drop('is_slitherin', axis=1) y = data_full.is_slitherin #    slitherin_models = train_classifiers(data_full, X_data, y) score_testing_dataset(slitherin_models[5])</span></span></code> </pre> <br><pre> <code class="plaintext hljs">  ‚Äî 0.09437856871661066 Kirill Malev ‚Äî 0.20820536334902712   ‚Äî 0.07550095601699099 Harry Potter ‚Äî 0.07683794773639624   ‚Äî 0.9414529336862744   ‚Äî 0.9293671807790949 Severus Snape ‚Äî 0.6576783576162999   ‚Äî 0.18577792617672767 Tom Riddle ‚Äî 0.8351835484058869   ‚Äî 0.25930925139546795 Salazar Slytherin ‚Äî 0.24008788903854789</code> </pre> <br><p>  Los n√∫meros en esta versi√≥n se ven subjetivamente mejor que en el pasado, pero a√∫n no son lo suficientemente buenos para un perfeccionista interno.  Por lo tanto, bajaremos un nivel m√°s profundo y volveremos al sentido del producto de nuestra tarea: necesitamos predecir la facultad m√°s probable, a la cual el h√©roe ser√° determinado por el sombrero de distribuci√≥n.  Esto significa que necesitas entrenar modelos para cada una de las facultades. </p><br><p><img src="https://habrastorage.org/webt/hc/ag/ci/hcagciojsjdzpglovd1xabohtym.jpeg"></p><br><pre> <code class="python hljs">&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> model_training <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_all_models <span class="hljs-comment"><span class="hljs-comment">#      &gt;&gt; slitherin_models, griffindor_models, ravenclaw_models, hufflpuff_models = \ train_all_models()</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Larga conclusi√≥n de resultados y resultados de regresi√≥n multinomial</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">SVM Default Report Accuracy for SVM Default: 73.93 ROC AUC for SVM Default: 0.53 Tuned SVM Report Accuracy for Tuned SVM: 72.37 ROC AUC for Tuned SVM: 0.50 KNN Default Report Accuracy for KNN Default: 70.04 ROC AUC for KNN Default: 0.58 Tuned KNN Report Accuracy for Tuned KNN: 69.65 ROC AUC for Tuned KNN: 0.58 XGBoost Default Report Accuracy for XGBoost Default: 70.43 ROC AUC for XGBoost Default: 0.54 Tuned XGBoost Report Accuracy for Tuned XGBoost: 68.09 ROC AUC for Tuned XGBoost: 0.56 Random Forest Default Report Accuracy for Random Forest Default: 73.93 ROC AUC for Random Forest Default: 0.62 Tuned Random Forest Report Accuracy for Tuned Random Forest: 74.32 ROC AUC for Tuned Random Forest: 0.54 Extra Trees Default Report Accuracy for Extra Trees Default: 69.26 ROC AUC for Extra Trees Default: 0.57 Tuned Extra Trees Report Accuracy for Tuned Extra Trees: 73.54 ROC AUC for Tuned Extra Trees: 0.55 LGBM Default Report Accuracy for LGBM Default: 70.82 ROC AUC for LGBM Default: 0.62 Tuned LGBM Report Accuracy for Tuned LGBM: 74.71 ROC AUC for Tuned LGBM: 0.53 RGF Default Report Accuracy for RGF Default: 70.43 ROC AUC for RGF Default: 0.58 Tuned RGF Report Accuracy for Tuned RGF: 71.60 ROC AUC for Tuned RGF: 0.60 FRGF Default Report Accuracy for FRGF Default: 68.87 ROC AUC for FRGF Default: 0.59 Tuned FRGF Report Accuracy for Tuned FRGF: 69.26 ROC AUC for Tuned FRGF: 0.59 SVM Default Report Accuracy for SVM Default: 70.43 ROC AUC for SVM Default: 0.50 Tuned SVM Report Accuracy for Tuned SVM: 71.60 ROC AUC for Tuned SVM: 0.50 KNN Default Report Accuracy for KNN Default: 63.04 ROC AUC for KNN Default: 0.49 Tuned KNN Report Accuracy for Tuned KNN: 65.76 ROC AUC for Tuned KNN: 0.50 XGBoost Default Report Accuracy for XGBoost Default: 69.65 ROC AUC for XGBoost Default: 0.54 Tuned XGBoost Report Accuracy for Tuned XGBoost: 68.09 ROC AUC for Tuned XGBoost: 0.50 Random Forest Default Report Accuracy for Random Forest Default: 66.15 ROC AUC for Random Forest Default: 0.51 Tuned Random Forest Report Accuracy for Tuned Random Forest: 70.43 ROC AUC for Tuned Random Forest: 0.50 Extra Trees Default Report Accuracy for Extra Trees Default: 64.20 ROC AUC for Extra Trees Default: 0.49 Tuned Extra Trees Report Accuracy for Tuned Extra Trees: 70.82 ROC AUC for Tuned Extra Trees: 0.51 LGBM Default Report Accuracy for LGBM Default: 67.70 ROC AUC for LGBM Default: 0.56 Tuned LGBM Report Accuracy for Tuned LGBM: 70.82 ROC AUC for Tuned LGBM: 0.50 RGF Default Report Accuracy for RGF Default: 66.54 ROC AUC for RGF Default: 0.52 Tuned RGF Report Accuracy for Tuned RGF: 65.76 ROC AUC for Tuned RGF: 0.53 FRGF Default Report Accuracy for FRGF Default: 65.76 ROC AUC for FRGF Default: 0.53 Tuned FRGF Report Accuracy for Tuned FRGF: 69.65 ROC AUC for Tuned FRGF: 0.52 SVM Default Report Accuracy for SVM Default: 74.32 ROC AUC for SVM Default: 0.50 Tuned SVM Report Accuracy for Tuned SVM: 74.71 ROC AUC for Tuned SVM: 0.51 KNN Default Report Accuracy for KNN Default: 69.26 ROC AUC for KNN Default: 0.48 Tuned KNN Report Accuracy for Tuned KNN: 73.15 ROC AUC for Tuned KNN: 0.49 XGBoost Default Report Accuracy for XGBoost Default: 72.76 ROC AUC for XGBoost Default: 0.49 Tuned XGBoost Report Accuracy for Tuned XGBoost: 74.32 ROC AUC for Tuned XGBoost: 0.50 Random Forest Default Report Accuracy for Random Forest Default: 73.93 ROC AUC for Random Forest Default: 0.52 Tuned Random Forest Report Accuracy for Tuned Random Forest: 74.32 ROC AUC for Tuned Random Forest: 0.50 Extra Trees Default Report Accuracy for Extra Trees Default: 73.93 ROC AUC for Extra Trees Default: 0.52 Tuned Extra Trees Report Accuracy for Tuned Extra Trees: 73.93 ROC AUC for Tuned Extra Trees: 0.50 LGBM Default Report Accuracy for LGBM Default: 73.54 ROC AUC for LGBM Default: 0.52 Tuned LGBM Report Accuracy for Tuned LGBM: 74.32 ROC AUC for Tuned LGBM: 0.50 RGF Default Report Accuracy for RGF Default: 73.54 ROC AUC for RGF Default: 0.51 Tuned RGF Report Accuracy for Tuned RGF: 73.93 ROC AUC for Tuned RGF: 0.50 FRGF Default Report Accuracy for FRGF Default: 73.93 ROC AUC for FRGF Default: 0.53 Tuned FRGF Report Accuracy for Tuned FRGF: 73.93 ROC AUC for Tuned FRGF: 0.50 SVM Default Report Accuracy for SVM Default: 80.54 ROC AUC for SVM Default: 0.50 Tuned SVM Report Accuracy for Tuned SVM: 80.93 ROC AUC for Tuned SVM: 0.52 KNN Default Report Accuracy for KNN Default: 78.60 ROC AUC for KNN Default: 0.50 Tuned KNN Report Accuracy for Tuned KNN: 80.16 ROC AUC for Tuned KNN: 0.51 XGBoost Default Report Accuracy for XGBoost Default: 80.54 ROC AUC for XGBoost Default: 0.50 Tuned XGBoost Report Accuracy for Tuned XGBoost: 77.04 ROC AUC for Tuned XGBoost: 0.52 Random Forest Default Report Accuracy for Random Forest Default: 77.43 ROC AUC for Random Forest Default: 0.49 Tuned Random Forest Report Accuracy for Tuned Random Forest: 80.54 ROC AUC for Tuned Random Forest: 0.50 Extra Trees Default Report Accuracy for Extra Trees Default: 76.26 ROC AUC for Extra Trees Default: 0.48 Tuned Extra Trees Report Accuracy for Tuned Extra Trees: 78.60 ROC AUC for Tuned Extra Trees: 0.50 LGBM Default Report Accuracy for LGBM Default: 75.49 ROC AUC for LGBM Default: 0.51 Tuned LGBM Report Accuracy for Tuned LGBM: 80.54 ROC AUC for Tuned LGBM: 0.50 RGF Default Report Accuracy for RGF Default: 78.99 ROC AUC for RGF Default: 0.52 Tuned RGF Report Accuracy for Tuned RGF: 75.88 ROC AUC for Tuned RGF: 0.55 FRGF Default Report Accuracy for FRGF Default: 76.65 ROC AUC for FRGF Default: 0.50 #   ,       </code> </pre> <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.linear_model <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> LogisticRegression clf = LogisticRegression(random_state=<span class="hljs-number"><span class="hljs-number">0</span></span>, solver=<span class="hljs-string"><span class="hljs-string">'lbfgs'</span></span>, multi_class=<span class="hljs-string"><span class="hljs-string">'multinomial'</span></span>) hogwarts_df = load_processed_data_multi() <span class="hljs-comment"><span class="hljs-comment">#     data_full = hogwarts_df.drop( [ 'name', 'surname', ], axis=1).copy() X_data = data_full.drop('faculty', axis=1) y = data_full.faculty clf.fit(X_data, y) score_testing_dataset(clf)</span></span></code> </pre> <br><pre> <code class="plaintext hljs">  ‚Äî [0.3602361 0.16166944 0.16771712 0.31037733] Kirill Malev ‚Äî [0.47473072 0.16051924 0.13511385 0.22963619]   ‚Äî [0.38697926 0.19330242 0.17451052 0.2452078 ] Harry Potter ‚Äî [0.40245098 0.16410043 0.16023278 0.27321581]   ‚Äî [0.13197025 0.16438855 0.17739254 0.52624866]   ‚Äî [0.17170203 0.1205678 0.14341742 0.56431275] Severus Snape ‚Äî [0.15558044 0.21589378 0.17370406 0.45482172]   ‚Äî [0.39301231 0.07397324 0.1212741 0.41174035] Tom Riddle ‚Äî [0.26623969 0.14194379 0.1728505 0.41896601]   ‚Äî [0.24843037 0.21632736 0.21532696 0.3199153 ] Salazar Slytherin ‚Äî [0.09359144 0.26735897 0.2742305 0.36481909]</code> </pre> <br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Y confusion_matrix: </font></font></p><br><pre> <code class="python hljs">confusion_matrix(clf.predict(X_data), y)</code> </pre> <br><pre> <code class="plaintext hljs">array([[144, 68, 64, 78], [ 8, 9, 8, 6], [ 22, 18, 31, 20], [ 77, 73, 78, 151]])</code> </pre> </div></div><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_predctions_vector</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(models, person)</span></span></span><span class="hljs-function">:</span></span> predictions = [get_predictions_vector (model, person)[<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> model <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> models] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-string"><span class="hljs-string">'slitherin'</span></span>: predictions[<span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-string"><span class="hljs-string">'griffindor'</span></span>: predictions[<span class="hljs-number"><span class="hljs-number">1</span></span>], <span class="hljs-string"><span class="hljs-string">'ravenclaw'</span></span>: predictions[<span class="hljs-number"><span class="hljs-number">2</span></span>], <span class="hljs-string"><span class="hljs-string">'hufflpuff'</span></span>: predictions[<span class="hljs-number"><span class="hljs-number">3</span></span>] } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">score_testing_dataset</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(models)</span></span></span><span class="hljs-function">:</span></span> testing_dataset = [ <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"Kirill Malev"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"Harry Potter"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>,<span class="hljs-string"><span class="hljs-string">"Severus Snape"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"Tom Riddle"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"Salazar Slytherin"</span></span>] data = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> name <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> testing_dataset: predictions = get_predctions_vector(models, name) predictions[<span class="hljs-string"><span class="hljs-string">'name'</span></span>] = name data.append(predictions) scoring_df = pd.DataFrame(data, columns=[<span class="hljs-string"><span class="hljs-string">'name'</span></span>, <span class="hljs-string"><span class="hljs-string">'slitherin'</span></span>, <span class="hljs-string"><span class="hljs-string">'griffindor'</span></span>, <span class="hljs-string"><span class="hljs-string">'hufflpuff'</span></span>, <span class="hljs-string"><span class="hljs-string">'ravenclaw'</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> scoring_df <span class="hljs-comment"><span class="hljs-comment"># Data Science ‚Äî    ,       top_models = [ slitherin_models[3], griffindor_models[3], ravenclaw_models[3], hufflpuff_models[3] ] score_testing_dataset(top_models)</span></span></code> </pre> <br><pre> <code class="plaintext hljs"> name slitherin griffindor hufflpuff ravenclaw 0   0.349084 0.266909 0.110311 0.091045 1 Kirill Malev 0.289914 0.376122 0.384986 0.103056 2   0.338258 0.400841 0.016668 0.124825 3 Harry Potter 0.245377 0.357934 0.026287 0.154592 4   0.917423 0.126997 0.176640 0.096570 5   0.969693 0.106384 0.150146 0.082195 6 Severus Snape 0.663732 0.259189 0.290252 0.074148 7   0.268466 0.579401 0.007900 0.083195 8 Tom Riddle 0.639731 0.541184 0.084395 0.156245 9   0.653595 0.147506 0.172940 0.137134 10 Salazar Slytherin 0.647399 0.169964 0.095450 0.26126</code> </pre> <br><p><img src="https://habrastorage.org/webt/kc/pq/r7/kcpqr7dw_t-yudtoda54qj1su3o.jpeg"></p><br><p>     , <del>     </del>   .    ROC AUC  ,  0.5.    ,   : </p><br><ul><li>   ; </li><li>    ; </li><li>    ,        ; </li><li>      ,     ; </li><li>  ,            ,   . </li></ul><br><p>            ,    ,   ,   ,          XGBoost      CV ,       . </p><br><p>  Importante! ,       70% .     ,    4          . </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> model_training <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_production_models <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> xgboost <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> XGBClassifier best_models = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range (<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>): best_models.append(XGBClassifier(base_score=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, booster=<span class="hljs-string"><span class="hljs-string">'gbtree'</span></span>, colsample_bylevel=<span class="hljs-number"><span class="hljs-number">1</span></span>, colsample_bytree=<span class="hljs-number"><span class="hljs-number">0.7</span></span>, gamma=<span class="hljs-number"><span class="hljs-number">0</span></span>, learning_rate=<span class="hljs-number"><span class="hljs-number">0.05</span></span>, max_delta_step=<span class="hljs-number"><span class="hljs-number">0</span></span>, max_depth=<span class="hljs-number"><span class="hljs-number">6</span></span>, min_child_weight=<span class="hljs-number"><span class="hljs-number">11</span></span>, missing=<span class="hljs-number"><span class="hljs-number">-999</span></span>, n_estimators=<span class="hljs-number"><span class="hljs-number">1000</span></span>, n_jobs=<span class="hljs-number"><span class="hljs-number">1</span></span>, nthread=<span class="hljs-number"><span class="hljs-number">4</span></span>, objective=<span class="hljs-string"><span class="hljs-string">'binary:logistic'</span></span>, random_state=<span class="hljs-number"><span class="hljs-number">0</span></span>, reg_alpha=<span class="hljs-number"><span class="hljs-number">0</span></span>, reg_lambda=<span class="hljs-number"><span class="hljs-number">1</span></span>, scale_pos_weight=<span class="hljs-number"><span class="hljs-number">1</span></span>, seed=<span class="hljs-number"><span class="hljs-number">1337</span></span>, silent=<span class="hljs-number"><span class="hljs-number">1</span></span>, subsample=<span class="hljs-number"><span class="hljs-number">0.8</span></span>)) slitherin_model, griffindor_model, ravenclaw_model, hufflpuff_model = \ train_production_models(best_models) top_models = slitherin_model, griffindor_model, ravenclaw_model, hufflpuff_model score_testing_dataset(top_models)</code> </pre> <br><pre> <code class="plaintext hljs">name slitherin griffindor hufflpuff ravenclaw 0   0.273713 0.372337 0.065923 0.279577 1 Kirill Malev 0.401603 0.761467 0.111068 0.023902 2   0.031540 0.616535 0.196342 0.217829 3 Harry Potter 0.183760 0.422733 0.119393 0.173184 4   0.945895 0.021788 0.209820 0.019449 5   0.950932 0.088979 0.084131 0.012575 6 Severus Snape 0.634035 0.088230 0.249871 0.036682 7   0.426440 0.431351 0.028444 0.083636 8 Tom Riddle 0.816804 0.136530 0.069564 0.035500 9   0.409634 0.213925 0.028631 0.252723 10 Salazar Slytherin 0.824590 0.067910 0.111147 0.085710</code> </pre> <br><p>      ,  ,   . </p><br><p>    ,           ,     .   . </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pickle pickle.dump(slitherin_model, open(<span class="hljs-string"><span class="hljs-string">"../output/slitherin.xgbm"</span></span>, <span class="hljs-string"><span class="hljs-string">"wb"</span></span>)) pickle.dump(griffindor_model, open(<span class="hljs-string"><span class="hljs-string">"../output/griffindor.xgbm"</span></span>, <span class="hljs-string"><span class="hljs-string">"wb"</span></span>)) pickle.dump(ravenclaw_model, open(<span class="hljs-string"><span class="hljs-string">"../output/ravenclaw.xgbm"</span></span>, <span class="hljs-string"><span class="hljs-string">"wb"</span></span>)) pickle.dump(hufflpuff_model, open(<span class="hljs-string"><span class="hljs-string">"../output/hufflpuff.xgbm"</span></span>, <span class="hljs-string"><span class="hljs-string">"wb"</span></span>))</code> </pre> <br><h2 id="prodakshn">  </h2><br><p>           ,     .   ,     , ,       . </p><br><p>           ,  ,      .        ,       .  ,   Data Scientist ‚Äî       -. </p><br><p>     : </p><br><ul><li>     ; </li><li>     json-       json; </li><li>            . </li></ul><br><p> ,     docker-,           python-.  ,           flask. </p><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> print_function <span class="hljs-comment"><span class="hljs-comment"># In python 2.7 import os import subprocess import json import re from flask import Flask, request, jsonify from inspect import getmembers, ismethod import numpy as npb import pandas as pd import math import os import pickle import xgboost as xgb import sys from letter import Letter from talking_hat import * from sklearn.ensemble import RandomForestClassifier import warnings def prod_predict_classes_for_name (full_name): featurized_person = parse_line_to_hogwarts_df(full_name) person_df = pd.DataFrame(featurized_person, columns=[ 'name', 'surname', 'is_english', 'name_starts_with_vowel', 'name_starts_with_consonant', 'name_ends_with_vowel', 'name_ends_with_consonant', 'name_length', 'name_vowels_count', 'name_double_vowels_count', 'name_consonant_count', 'name_double_consonant_count', 'name_paired_count', 'name_deaf_count', 'name_sonorus_count', 'surname_starts_with_vowel', 'surname_starts_with_consonant', 'surname_ends_with_vowel', 'surname_ends_with_consonant', 'surname_length', 'surname_vowels_count', 'surname_double_vowels_count', 'surname_consonant_count', 'surname_double_consonant_count', 'surname_paired_count', 'surname_deaf_count', 'surname_sonorus_count', ], index=[0] ) slitherin_model = pickle.load(open("models/slitherin.xgbm", "rb")) griffindor_model = pickle.load(open("models/griffindor.xgbm", "rb")) ravenclaw_model = pickle.load(open("models/ravenclaw.xgbm", "rb")) hufflpuff_model = pickle.load(open("models/hufflpuff.xgbm", "rb")) predictions = get_predctions_vector([ slitherin_model, griffindor_model, ravenclaw_model, hufflpuff_model ], person_df.drop(['name', 'surname'], axis=1)) return { 'slitherin': float(predictions[0][1]), 'griffindor': float(predictions[1][1]), 'ravenclaw': float(predictions[2][1]), 'hufflpuff': float(predictions[3][1]) } def predict(params): fullname = params['fullname'] print(params) return prod_predict_classes_for_name(fullname) def create_app(): app = Flask(__name__) functions_list = [predict] @app.route('/&lt;func_name&gt;', methods=['POST']) def api_root(func_name): for function in functions_list: if function.__name__ == func_name: try: json_req_data = request.get_json() if json_req_data: res = function(json_req_data) else: return jsonify({"error": "error in receiving the json input"}) except Exception as e: data = { "error": "error while running the function" } if hasattr(e, 'message'): data['message'] = e.message elif len(e.args) &gt;= 1: data['message'] = e.args[0] return jsonify(data) return jsonify({"success": True, "result": res}) output_string = 'function: %s not found' % func_name return jsonify({"error": output_string}) return app if __name__ == '__main__': app = create_app() app.run(host='0.0.0.0')</span></span></code> </pre> </div></div><br><p> Dockerfile: </p><br><pre> <code class="bash hljs">FROM datmo/python-base:cpu-py35 <span class="hljs-comment"><span class="hljs-comment">#  python3-wheel,        RUN apt-get update; apt-get install -y python3-pip python3-numpy python3-scipy python3-wheel ADD requirements.txt / RUN pip3 install -r /requirements.txt RUN mkdir /code;mkdir /code/models COPY ./python_api.py ./talking_hat.py ./letter.py ./request.py /code/ COPY ./models/* /code/models/ WORKDIR /code CMD python3 /code/python_api.py</span></span></code> </pre> <br><p>    : </p><br><pre> <code class="bash hljs">docker build -t talking_hat . &amp;&amp; docker rm talking_hat &amp;&amp; docker run --name talking_hat -p 5000:5000 talking_hat</code> </pre> <br><h2 id="testirovanie-prodakshn-modeli">    </h2><br><p>     ‚Äî            .  ,         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://">Apache Benchmark</a> .      ,      .  ‚Äî  . </p><br><pre> <code class="bash hljs">$ ab -p data.json -T application/json -c 50 -n 10000 http://0.0.0.0:5000/predict</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"> ab</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">This is ApacheBench, Version 2.3 &lt;$Revision: 1807734 $&gt; Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/ Licensed to The Apache Software Foundation, http://www.apache.org/ Benchmarking 0.0.0.0 (be patient) Completed 1000 requests Completed 2000 requests Completed 3000 requests Completed 4000 requests Completed 5000 requests Completed 6000 requests Completed 7000 requests Completed 8000 requests Completed 9000 requests Completed 10000 requests Finished 10000 requests Server Software: Werkzeug/0.14.1 Server Hostname: 0.0.0.0 Server Port: 5000 Document Path: /predict Document Length: 141 bytes Concurrency Level: 50 Time taken for tests: 238.552 seconds Complete requests: 10000 Failed requests: 0 Total transferred: 2880000 bytes Total body sent: 1800000 HTML transferred: 1410000 bytes Requests per second: 41.92 [#/sec] (mean) Time per request: 1192.758 [ms] (mean) Time per request: 23.855 [ms] (mean, across all concurrent requests) Transfer rate: 11.79 [Kbytes/sec] received 7.37 kb/s sent 19.16 kb/s total Connection Times (ms) min mean[+/-sd] median max Connect: 0 0 0.1 0 3 Processing: 199 1191 352.5 1128 3352 Waiting: 198 1190 352.5 1127 3351 Total: 202 1191 352.5 1128 3352 Percentage of the requests served within a certain time (ms) 50% 1128 66% 1277 75% 1378 80% 1451 90% 1668 95% 1860 98% 2096 99% 2260 100% 3352 (longest request)</code> </pre> </div></div><br><p>     ,      : </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">prod_predict_classes_for_name</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(full_name)</span></span></span><span class="hljs-function">:</span></span> &lt;...&gt; predictions = get_predctions_vector([ app.slitherin_model, app.griffindor_model, app.ravenclaw_model, app.hufflpuff_model ], person_df.drop([<span class="hljs-string"><span class="hljs-string">'name'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname'</span></span>], axis=<span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-string"><span class="hljs-string">'slitherin'</span></span>: float(predictions[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>]), <span class="hljs-string"><span class="hljs-string">'griffindor'</span></span>: float(predictions[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>]), <span class="hljs-string"><span class="hljs-string">'ravenclaw'</span></span>: float(predictions[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>]), <span class="hljs-string"><span class="hljs-string">'hufflpuff'</span></span>: float(predictions[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>]) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create_app</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> &lt;...&gt; <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> app.app_context(): app.slitherin_model = pickle.load(open(<span class="hljs-string"><span class="hljs-string">"models/slitherin.xgbm"</span></span>, <span class="hljs-string"><span class="hljs-string">"rb"</span></span>)) app.griffindor_model = pickle.load(open(<span class="hljs-string"><span class="hljs-string">"models/griffindor.xgbm"</span></span>, <span class="hljs-string"><span class="hljs-string">"rb"</span></span>)) app.ravenclaw_model = pickle.load(open(<span class="hljs-string"><span class="hljs-string">"models/ravenclaw.xgbm"</span></span>, <span class="hljs-string"><span class="hljs-string">"rb"</span></span>)) app.hufflpuff_model = pickle.load(open(<span class="hljs-string"><span class="hljs-string">"models/hufflpuff.xgbm"</span></span>, <span class="hljs-string"><span class="hljs-string">"rb"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> app</code> </pre> <br><p>    : </p><br><pre> <code class="bash hljs">$ docker build -t talking_hat . &amp;&amp; docker rm talking_hat &amp;&amp; docker run --name talking_hat -p 5000:5000 talking_hat $ ab -p data.json -T application/json -c 50 -n 10000 http://0.0.0.0:5000/predict</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"> ab</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">This is ApacheBench, Version 2.3 &lt;$Revision: 1807734 $&gt; Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/ Licensed to The Apache Software Foundation, http://www.apache.org/ Benchmarking 0.0.0.0 (be patient) Completed 1000 requests Completed 2000 requests Completed 3000 requests Completed 4000 requests Completed 5000 requests Completed 6000 requests Completed 7000 requests Completed 8000 requests Completed 9000 requests Completed 10000 requests Finished 10000 requests Server Software: Werkzeug/0.14.1 Server Hostname: 0.0.0.0 Server Port: 5000 Document Path: /predict Document Length: 141 bytes Concurrency Level: 50 Time taken for tests: 219.812 seconds Complete requests: 10000 Failed requests: 3 (Connect: 0, Receive: 0, Length: 3, Exceptions: 0) Total transferred: 2879997 bytes Total body sent: 1800000 HTML transferred: 1409997 bytes Requests per second: 45.49 [#/sec] (mean) Time per request: 1099.062 [ms] (mean) Time per request: 21.981 [ms] (mean, across all concurrent requests) Transfer rate: 12.79 [Kbytes/sec] received 8.00 kb/s sent 20.79 kb/s total Connection Times (ms) min mean[+/-sd] median max Connect: 0 0 0.1 0 2 Processing: 235 1098 335.2 1035 3464 Waiting: 235 1097 335.2 1034 3462 Total: 238 1098 335.2 1035 3464 Percentage of the requests served within a certain time (ms) 50% 1035 66% 1176 75% 1278 80% 1349 90% 1541 95% 1736 98% 1967 99% 2141 100% 3464 (longest request)</code> </pre> </div></div><br><p> .   .         ,          . </p><br><h2 id="zaklyuchenie">  Conclusi√≥n </h2><br><p>            ,             .       -     . </p><br><p> ,     : </p><br><ul><li>    feature engineering-     ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> </a>  ),  , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Soundex</a>     . </li><li>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a>   PyTorch        .       ,        ,         . </li><li>     flask   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Quart</a> ,        ,          . </li><li>    -  -,     . </li></ul><br><p>      ,           ,     .   ,  ! </p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Este art√≠culo no habr√≠a sido publicado sin la comunidad Open Data Science, que re√∫ne a un gran n√∫mero de expertos de habla rusa en el campo del an√°lisis de datos. </font></font></p><cut></cut></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es430006/">https://habr.com/ru/post/es430006/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es429996/index.html">Administrador de red en la nube</a></li>
<li><a href="../es429998/index.html">Formas cient√≠ficas para mejorar la atenci√≥n: nootr√≥picos, neurointerfaces y estimulaci√≥n el√©ctrica</a></li>
<li><a href="../es430000/index.html">El √∫ltimo de los mohicanos. El CEO m√°s antiguo de Fortune 500 pone todo en la ca√≠da de los tel√©fonos inteligentes</a></li>
<li><a href="../es430002/index.html">Red Hat Enterprise Linux 8 Beta: al mismo tiempo que el mundo</a></li>
<li><a href="../es430004/index.html">Rastreador GPS no certificado de China. ¬øEs legal en Rusia?</a></li>
<li><a href="../es430008/index.html">Ugears: caballos, vela y otros entretenimientos reales.</a></li>
<li><a href="../es430010/index.html">Lecci√≥n abierta "C√≥mo no: anti-ejemplos en el an√°lisis de procesos de negocio"</a></li>
<li><a href="../es430014/index.html">Clases selladas. Sem√°ntica vs rendimiento</a></li>
<li><a href="../es430016/index.html">Los cient√≠ficos confunden confusamente que todav√≠a no conocen la magnitud exacta de la interacci√≥n gravitacional</a></li>
<li><a href="../es430024/index.html">C√≥mo un accidente a√©reo puede mejorar el an√°lisis de TI</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>