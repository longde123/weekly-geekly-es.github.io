<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ùï ‚õ≤Ô∏è üßëüèº‚Äçü§ù‚Äçüßëüèº Entwicklung eines Chat-Bots mit einer bestimmten Pers√∂nlichkeit. Vortrag in Yandex üí® üé∑ üëµüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ein wichtiges Merkmal maschineller Lernaufgaben ist, dass mit verschiedenen Methoden gleich gute Ergebnisse erzielt werden k√∂nnen. Dies macht ML-Wettb...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Entwicklung eines Chat-Bots mit einer bestimmten Pers√∂nlichkeit. Vortrag in Yandex</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/422717/">  Ein wichtiges Merkmal maschineller Lernaufgaben ist, dass mit verschiedenen Methoden gleich gute Ergebnisse erzielt werden k√∂nnen.  Dies macht ML-Wettbewerbe aufregend: Selbst wenn Sie andere Kompetenzen als einen offensichtlich starken Gegner haben, k√∂nnen Sie trotzdem gewinnen.  Die Teams von Tensorborne und Neurobotics hatten fast die gleichen Chancen, den DeepHack-Hackathon zu gewinnen, und belegten schlie√ülich die ersten beiden Pl√§tze.  W√§hrend des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Yandex-Trainings</a> machten Vertreter beider Teams einen umfangreichen Bericht.  Bei der Dekodierung finden Sie eine detaillierte Analyse der L√∂sungen und Tipps f√ºr beginnende Wettbewerber. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/qSehSTWMXaY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><blockquote>  Und nat√ºrlich einen Hackathonurlaub machen.  Wenn Sie an einem w√∂chentlichen Hackathon teilnehmen und gleichzeitig arbeiten, ist das schlecht.  Sie kommen um 19 Uhr an, nachdem Sie ein wenig gearbeitet haben, setzen sich und kompilieren Docker mit TensorFlow, Keras, so dass alles auf einigen Remote-Servern beginnt, auf die Sie nicht einmal Zugriff haben.  Irgendwann in zwei N√§chten erkranken Sie an Katharsis, und das funktioniert bei Ihnen - ohne Docker, ohne alles, weil Sie verstanden haben, dass es m√∂glich ist und so. </blockquote><br><a name="habracut"></a>  Vitaly Davydov: <br>  - Hallo allerseits!  Wir h√§tten zwei Berichte haben sollen, aber wir haben beschlossen, sie zu einem gro√üen zusammenzufassen, weil wir √ºber den ersten und zweiten Platz im DeepHack-Wettbewerb sprechen.  Wir vertreten zwei Teams.  Unser Tensorborne-Team belegte den 2. Platz und das Team von Gregory Neurobotics den ersten Platz. <br><br><img src="https://habrastorage.org/webt/hp/da/wx/hpdawx6cghpeiebf6nkmnxwieno.jpeg"><br>  Der Bericht wird aus drei Hauptteilen bestehen.  Im Intro werde ich √ºber die Geschichte von DeepHack sprechen, was es ist, was die Metriken waren usw. Als n√§chstes werden die Jungs √ºber L√∂sungen sprechen, √ºber welche Probleme, Beispiele usw. <br><br>  Bevor wir √ºber DeepHack sprechen, sollte angemerkt werden, dass es sich um eine kleine Teilmenge eines anderen sehr gro√üen globalen Wettbewerbs handelt, ConvAI2, der Facebook im vergangenen Jahr gestartet hat.  Dieses Jahr ist die zweite Iteration.  Irgendwann sponserte Facebook das Moskauer Institut f√ºr Physik und Technologie, und der DeepHack-Wettbewerb wurde auf der Grundlage des PhysTech-Labors ins Leben gerufen. <br><br><img src="https://habrastorage.org/webt/k7/de/a-/k7dea-py5v-x3gr47seesnhpfge.jpeg"><br>  Lesen Sie mehr √ºber ConvAI.  Welches Problem versucht er zu l√∂sen?  Er ist spezialisiert auf interaktive Systeme.  Das Problem bei Dialogsystemen besteht darin, dass es kein einziges Bewertungsinstrument gibt, ein Bewertungsinstrument, um die Qualit√§t von Dialogen zu verstehen.  Diese Sache ist von Person zu Person sehr subjektiv: Jemand mag das Gespr√§ch, jemand nicht.  Die allgemeine globale Aufgabe von ConvAI besteht darin, eine gemeinsame einheitliche Metrik f√ºr die Bewertung von Dialogen zu erstellen, die noch nicht verf√ºgbar ist.  Preis - 20.000 USD f√ºr AWS Mechanical Turk.  Dies sind keine Kredite an Amazon, sondern nur Kredite an Mechanical Turk, was in der Tat ein Analogon zu Yandex.Tolki ist.  Dies ist ein Crowdsourcing-Service, mit dem Sie Markups f√ºr Daten erstellen k√∂nnen. <br><br>  Die Aufgabe, die auf ConvAI basiert, besteht darin, einen Chit-Chat-Bot zu erstellen, mit dem Sie eine Art Dialog f√ºhren k√∂nnen.  Sie w√§hlten drei Metriken: Ratlosigkeit, Treffer @ 1 und F1.  Als n√§chstes werde ich die Tabelle zeigen, die zum Zeitpunkt unserer Einreichung war. <br><br>  Die Bewertung, mit der sie dies versuchten, durchlief drei Phasen.  Die erste Phase sind automatische Metriken, dann die Bewertung von AWS Mechanical Turk und der Live-Chat mit Freiwilligen. <br><br>  Da ConvAI von Facebook gesponsert wird, bewirbt er seine Bibliothek aktiv f√ºr die Erstellung von ParlAI-Konversationssystemen.  Es ist ziemlich kompliziert, aber ich denke, alle Teilnehmer haben diese Bibliothek benutzt.  Wir haben uns schon seit einiger Zeit damit besch√§ftigt, es ist zum Beispiel nicht mit Python 3.6 kompatibel und es gibt eine Reihe von Problemen damit. <br><br><img src="https://habrastorage.org/webt/yp/xk/ew/ypxkewtucztkiznh_vqrienqxoe.jpeg"><br><br>  In diesen wenigen Zeilen k√∂nnen Sie sehen, welche Positionen wir zum Zeitpunkt der Einreichung besetzt haben.  Im Allgemeinen ist ConvAI in dem Sinne seltsam organisiert, dass es drei Metriken gibt und es nicht sehr klar ist, wie das Ranking in dieser Tabelle verl√§uft.  Es ist ersichtlich, dass f√ºr einige Metriken einige Teams h√∂her und f√ºr andere niedriger sind.  Die Organisation der gesamten ConvAI war etwas seltsam. <br><br>  Es gibt jedoch drei grundlegende Basislinien.  Um sich f√ºr DeepHack zu qualifizieren, musste diese Basislinie gebrochen werden, und die 10 besten Teams schafften es bis ins Finale.  Im Geheimen m√∂chte ich sagen, dass nur 8 Teams Entscheidungen gesendet haben und alle das Finale erreicht haben.  Es war nicht sehr schwierig. <br><br><img src="https://habrastorage.org/webt/vb/ra/mg/vbramgip1a-tkhp33opnd0nxiic.jpeg"><br><br>  Die Aufgabe von DeepHack war etwas verst√§ndlicher und unkomplizierter.  Wir mussten erneut einen Sprechroboter bauen, der jedoch eine bestimmte Pers√∂nlichkeit emuliert.  Das hei√üt, der Roboter erhielt eine Beschreibung einer Person am Eingang, und w√§hrend eines Gespr√§chs mit ihm musste er sie offenbaren.  Der Preis war sehr interessant - eine Reise zum NIPS in diesem Herbst, die voll gesponsert wird. <br><br>  Die Metrik war im Gegensatz zu ConvAI bereits anders.  Es gab zwei Metriken, und die Gesamtmetrik wird zwischen den beiden gewichtet.  Die erste Metrik ist die Gesamtqualit√§t, eine Einsch√§tzung, wie angemessen der Bot reagiert hat, wie interessant es war, mit ihm zu kommunizieren, ob er M√ºll geschrieben hat usw. Die zweite Metrik ist Rollenspiel, entweder 0 oder 1. Es bedeutet Ist der Bot auf die Beschreibung gekommen, die er erhalten hat?  Die Person, die mit dem Bot kommuniziert, sieht die Beschreibung nicht.  Die Auswertung fand in Telegram statt, dh es gab einen einzelnen Telegramm-Bot, und als der Benutzer anfing, mit ihm zu kommunizieren, kam er ehrlich gesagt zu einem zuf√§lligen Bot aus allen Einsendungen.  Yandex und MIPT haben dort anscheinend ein wenig Verkehr gesch√ºttet, und soweit ich mich erinnere, gab es ungef√§hr zehntausend Dialoge. <br><br>  Ich habe bereits √ºber die Qualifikationsrunde gesprochen.  Das Finale war Vollzeit.  Es fand w√§hrend sieben Arbeitstagen am Moskauer Institut f√ºr Physik und Technologie statt, ein Cluster wurde bereitgestellt, ein Ort, an dem wir sa√üen und arbeiteten.  Die Bewertung erfolgte tats√§chlich jeden Tag, und das Endergebnis, die Bewertung des Bots am Ende, wurde auf diese Weise berechnet.  Der Wettbewerb begann am Montag, die erste Einreichung erfolgte am Dienstag und die Bewertung fand am n√§chsten Tag statt.  Die L√∂sung, die Sie am Dienstag ver√∂ffentlicht haben, wurde am Mittwoch mit einem Gewicht von 1,5 bewertet.  Was Sie am Mittwoch gesendet haben - mit einem Gewicht von 1,4 usw. <br><br><img src="https://habrastorage.org/webt/1x/4m/mc/1x4mmcu5p_2jo49ppvjceah0yhc.jpeg"><br><br>  √úber den Datensatz, den Facebook f√ºr das Training zur Verf√ºgung gestellt hat.  Es hei√üt Persona-Chat und beschreibt zwei Pers√∂nlichkeiten und eine Reihe von Dialogen.  Es gibt eine Beschreibung der ersten und der zweiten Person.  Bei der Beschreibung des Dialogs versuchen sie, sich gegenseitig zu offenbaren.  Das ist alles was gegeben wurde.  Wie immer war es jedoch im Wettbewerb nicht verboten, andere Datens√§tze von Drittanbietern zu verwenden. <br><br><img src="https://habrastorage.org/webt/my/jx/hn/myjxhn7rt6krkci69o_vqwtpguq.jpeg"><br><br>  Ein Beispiel f√ºr den Dialog unseres Teams.  Wenn Sie sorgf√§ltig lesen, ist es klar, dass der resultierende Bot ziemlich angemessen funktioniert und ganz richtig antwortet. <br><br>  Gregory wird √ºber den ersten Platz sprechen. <br><br>  Grigory Rashkov: <br>  - Ich m√∂chte √ºber unsere Erfahrungen bei der Teilnahme am Wettbewerb, unsere Strategie und unsere Entscheidung sprechen. <br><br><img src="https://habrastorage.org/webt/rc/an/5v/rcan5v9ajugvnsojkpgrgactbv4.jpeg"><br><br>  Erstens ist die Besonderheit des Wettbewerbs, dass es eine lange Dauer ist, wir hatten nicht zwei Tage wie bei einem gew√∂hnlichen Hackathon, sondern f√ºnf Tage, f√ºr die wir viele Entscheidungen treffen konnten. <br><br><img src="https://habrastorage.org/webt/v_/t7/4_/v_t74_uw45cd7shzhtaog-frdnu.jpeg"><br><br>  Sehr subjektive Einsch√§tzungen, da insbesondere v√∂llig unterschiedliche Personen mit ihren Kriterien bewertet wurden, sagte der Hackathon-Organisator Mikhail Bubtsev, dass er die Frage nicht so beantwortete, wenn er √ºberhaupt erraten w√ºrde, √ºber welches Profil er sprach, aber der Bot irgendwann seinem Profil widersprach Wie geschrieben steht, hat er ein anderes Profil gew√§hlt, auch wenn er wusste, worum es ging. <br><br>  Und der dritte ist der Mangel an Validierung.  Die Teilnehmer konnten keine kleine √Ñnderung vornehmen und erhielten sofort Feedback. <br><br>  Wie in allen Horrorfilmen hat sich unser Team gleich zu Beginn entschieden, sich zu trennen.  Die erste Gruppe befasste sich mit unserer Hauptl√∂sung basierend auf dem Wasserstein-GAN, die zweite Gruppe mit dem Bot, dem Admin-Panel des Bots basierend auf der Basislinie.  Weil wir am ersten und zweiten Tag etwas schicken mussten. <br><br><img src="https://habrastorage.org/webt/za/ij/6e/zaij6evz4_vpbuepprwokz1pylq.jpeg"><br><h5>  <sub><sup><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Link von der Folie</a></sup></sub> </h5><br>  Kurz zur Basislinie: Seq2Seq plus Aufmerksamkeit, die leicht an diese spezielle Aufgabe angepasst ist.  Wie genau?  Eine Phrase wird an die Eingabe gesendet, die Einbettung wird von GloVe √ºbernommen, aber dann wird die Darstellung jeder Phrase als gewichtete Einbettung weiter betrachtet.  Gewichte werden basierend auf der inversen Frequenz des Wortes ausgew√§hlt.  Je seltener ein Wort vorkommt, desto mehr Gewicht bringt es. <br><br><img src="https://habrastorage.org/webt/t_/go/g_/t_gog_ke6ovdcl7sblmigcnxdcm.jpeg"><br><h5>  <sub><sup><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Link von der Folie</a></sup></sub> </h5><br>  Dies ist notwendig, um die Einzigartigkeit dieser Eigenschaften widerzuspiegeln.  Es ging alles um eine Menge, eine Matrix, eine Maske wurde auf der Basis dieser Menge und eines verborgenen Zustands erstellt, dann wurde diese Maske der Menge √ºberlagert, ein Kontext wurde erhalten und dann wurde sie durch Nichtlinearit√§t verbunden und dem Decodereingang zugef√ºhrt. <br><br><img src="https://habrastorage.org/webt/en/x-/ht/enx-htbfplt1is1kptc43ir_jh8.jpeg"><br><br>  F√ºr den ersten Tag haben wir unsere Entscheidung noch nicht geschrieben, wir mussten etwas senden, also haben wir einen Agenten geschrieben, der auf der Basislinie basiert, aber uns die Aufgabe gestellt, uns irgendwie von der grauen Masse der Agenten abzuheben.  Dazu haben wir einfache Heuristiken verwendet, unser Bot war der erste, der einen Dialog begann, und er hat in diesem Satz ein L√§cheln verwendet.  Und es hat funktioniert. <br><br><img src="https://habrastorage.org/webt/iv/om/qv/ivomqvl3tvsedmrb0bnj7dyqg40.jpeg"><br>  Nat√ºrlich wurden am n√§chsten Tag alle Bots zuerst erstellt und alle hatten Emoticons.  Am zweiten Tag arbeiteten die Bewohner von Vilabaggio weiter mit der GAN zusammen, die Bewohner von Vilaribo versuchten andere Heuristiken. <br><br><img src="https://habrastorage.org/webt/qe/pw/w-/qepww-mi4akk5qpehjzs2lmxjn4.jpeg"><br><br>  Infolgedessen verbesserte sich die Punktzahl f√ºr die Qualit√§t des Dialogs leicht, aber wir wurden von der Person √ºbertroffen.  Dies sind die Ergebnisse des dritten Tages, es waren nur noch zwei Tage √ºbrig.  Wir haben verstanden, dass es nicht genug Zeit f√ºr uns w√§re, ein GAN zu schreiben und es normal zu testen, da es schon lange studiert hat und wir viele Hyperparameter ausw√§hlen m√ºssen.  Deshalb haben wir uns entschlossen, zur Basislinie zu wechseln, weil es so gut funktioniert. <br><br><img src="https://habrastorage.org/webt/a3/m5/cw/a3m5cw5nw_wfsgc9tk9kaxskxi4.jpeg"><br>  Unsere Aufgabe war es, die Erkennung des Benutzerprofils zu verbessern.  Wir haben eine solche Heuristik vorgeschlagen.  Was war das Problem?  Der Benutzer sprach gl√ºcklich mit dem Bot und fragte, welche Art von Arbeit er habe, welche Hobbys er habe, welche Art von Auto er fahre. Der Bot antwortete all dies gut, weil der Bot im Allgemeinen gut reagierte.  Infolgedessen sah der Benutzer am Ende des Dialogs zwei Profile, die nichts mit dem zu tun hatten, was sich im Dialog befand, einfach weil dort andere Dinge angezeigt wurden als die, die der Benutzer fragte.  Aus diesem Grund haben wir beschlossen, dass es notwendig ist, Informationen aus dem Profil herauszugeben. <br><br>  Wie geht das am logischsten?  Wenn eine Person irgendwelche Interessen hat, wird sie wahrscheinlich dar√ºber sprechen und nach gemeinsamen Interessen suchen.  Aus diesem Grund haben wir beschlossen, dass der Bot an einigen Stellen anhand seines Profils Fragen stellt.  Es gab einen interessanten Effekt, dass der Generator, der einfach nach den Sprachregeln von G geschrieben wurde, eine Tatsache A aus dem Profil verwendet. Als Ergebnis wird G (A) in den Dialog eingegeben, all dies wird an den Speicher des Bots gesendet und das n√§chste Mal, wenn das Modell Informationen generiert, Wenn Sie sowohl vom Profil als auch von diesem Dialog ausgehen, dh mit gr√∂√üerer Wahrscheinlichkeit etwas sagen, das mit dem Profil zusammenh√§ngt. <br><br><img src="https://habrastorage.org/webt/t0/vu/xu/t0vuxufzqe-c-whihwkby1isxpe.jpeg"><br><br>  Wie sah es in der Realit√§t aus?  Der Bot im Profil sagt, dass er von Poesie begeistert ist, und fragt dann w√§hrend des Gespr√§chs, ob ich Poesie mag.  Ich sage ja, und weiter nach seinem Modell sagt nicht der Generator, den wir nach den Regeln gebaut haben, dass er gerne Gedichte schreibt.  So konzentrierte sich der Bot auf sein Profil und es funktionierte. <br><br><img src="https://habrastorage.org/webt/ls/tt/ku/lsttkui4jcn6v60olkqym-vbnvy.jpeg"><br><br>  Wir kehrten wieder auf den ersten Platz zur√ºck.  Der letzte Tag blieb.  Wir haben festgestellt, dass wir dennoch als Dialog verlieren. <br><br><img src="https://habrastorage.org/webt/cz/yz/wl/czyzwlynpgq0fl-k5e_ntgwzhbo.jpeg"><br>  Wir haben mehrere weitere L√∂sungen genutzt.  Erstens verwendeten sie Paraphrase, analysierten, was andere Leute sagten, weil die Organisatoren diese Datenbank angelegt hatten, und stellten fest, dass viele Leute, die mit dem Bot kommunizieren, nicht ganz korrekt sind. <br><br><img src="https://habrastorage.org/webt/qy/tn/j-/qytnj-tpdkh8tsrza2iwwjpydgq.jpeg"><br><h5>  <sub><sup><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Link von der Folie</a></sup></sub> </h5><br>  Es gibt ein interessantes lokales Minimum am Bot: Es reagiert sehr gut auf Beleidigungen, er stimmt ihnen zu, und um dies zu beheben, haben wir uns entschlossen, den Kaggle-Wettbewerb f√ºr den Analysator f√ºr toxische Kommentare zu verwenden. Wir haben einen sehr einfachen Klassifikator geschrieben, ebenfalls mit RNN-Aufmerksamkeit.  In diesem Datensatz √ºberlappten sich die folgenden Klassen: Beleidigungen, Bedrohungen ... Aus diesem Grund haben wir beschlossen, das Modell, das sprechen wird, nicht separat zu unterrichten, da ein solches Problem aufgetreten ist, das jedoch nicht sehr h√§ufig auftrat.  Deshalb haben wir gerade eine Art Gag geschrieben, auf den der Bot geantwortet hat, und alle waren gl√ºcklich. <br><br><img src="https://habrastorage.org/webt/gc/vh/by/gcvhbyftcrlzu-f3sqzmkdenews.jpeg"><br>  Zus√§tzlich haben wir Paraphrase verwendet, um die Sprache unseres Bots zu bereichern.  Dies war auch nicht sehr schwierig. Wir haben die W√∂rter aus der Phrase durch Synonyme ersetzt, die resultierenden n-Gramme in der Phrase betrachtet, so dass sie sich nicht wesentlich von den urspr√ºnglichen unterscheiden, und dann die Kombination ausgew√§hlt, die f√ºr die Phrase mit der gr√∂√üten Wahrscheinlichkeit am besten geeignet ist. <br><br><img src="https://habrastorage.org/webt/of/je/dm/ofjedmtylm9iyyx76jwudzg6zxw.jpeg"><br><br>  Als Beispiel f√ºr das, was passiert ist, sagt der Bot hier, dass er gerne Musik h√∂rt, dass es Spa√ü im Profil macht, dass es durch "Gef√§llt mir" bei uns ersetzt wurde.  Wir sind uns nicht sicher, ob das Modell selbst oder unser Paraphraser es generiert hat, aber dieses Ding hat bestanden.  Eine weitere Bemerkung, dass es unm√∂glich war, nur Daten aus dem Profil zu senden.  Dort wurden Pentagramme verglichen.  Wenn die Pentagramme mit Ihrer Bemerkung und Ihrem Profil √ºbereinstimmten, dann passierte dieser Satz einfach nicht, die Organisatoren arrangierten ihn.  Au√üerdem haben wir unter anderem ein Smiley-W√∂rterbuch hinzugef√ºgt. <br><br><img src="https://habrastorage.org/webt/xk/5z/tx/xk5ztxz1m61eiqhjk0cm9tgcef4.jpeg"><br><br>  Im zweiten Beispiel haben wir viele L√§cheln.  Dann gab es Heuristiken, als der Bot auf Ihr Verhalten reagierte, dass Sie lange nicht darauf geschrieben haben.  Paraphraser arbeitete auch hier und es gab ein gutes Ergebnis. <br><img src="https://habrastorage.org/webt/hk/sg/uj/hksgujdi_dp2pt0uny6qhme2saw.jpeg"><br>  Die Qualit√§t des Dialogs war die beste, auch die Qualit√§t, die Rolle zu spielen. <br><br>  Wir haben versucht, das Modell dazu zu bringen, eine Reihe von Optionen zu generieren, und wir haben sie mit dem Profil verglichen.  Aber es schien mir, dass in diesem Fall der Bot schlechter funktioniert, wir konnten keine Validierung durchf√ºhren, nur subjektive Bewertungen in zwei oder drei Gespr√§chen.  Deshalb haben sie beschlossen, so etwas nicht zu setzen, weil das Profil bereits gut erkannt wurde. <br><br>  Dann haben wir eine L√∂sung f√ºr das inverse Problem geschrieben, das zweite Modell, das das gew√ºnschte Profil aus dem Dialog ausgew√§hlt hat.  Wir wollten es zun√§chst f√ºr das Training verwenden, um die Verlustfunktion daraus abzulesen und weiter im Netz zu verteilen.  Aber das k√∂nnte den Sprecher selbst verschlechtern, also beschlossen sie, es nicht so auszudr√ºcken.  Wir haben auch dar√ºber nachgedacht, dieses Ding f√ºr das Verhalten des Bots zu verwenden, aber wir hatten keine Zeit, alles zu testen, und beschlossen, dieses Ding abzulehnen.  Dar√ºber hinaus haben wir beschlossen, Emoticons basierend auf der emotionalen F√§rbung der Phrase zu platzieren, ein Modell zu schreiben, aber keinen geeigneten Datensatz zu finden, und diejenigen, die verwendet wurden, sind nicht wenig dar√ºber. <br><br><img src="https://habrastorage.org/webt/-l/yu/xq/-lyuxqic47g_15ubzyeedifcwza.jpeg"><br>  Unser Team. <br><br>  Auch wenn Ihr Hauptmodell, auf das Sie hoffen, es nicht schreiben kann oder ein schlechtes Ergebnis liefert, geben Sie nicht sofort auf, Sie m√ºssen einige einfachere Dinge ausprobieren, was ganz nat√ºrlich ist.  Und zweitens lohnt es sich manchmal, zu beobachten, was Ihrem Modell fehlt, und √ºber bestimmte Aufgaben nachzudenken, diese zu zerlegen und bestimmte Problembereiche zu l√∂sen, was wir getan haben.  Vielen Dank f√ºr Ihre Aufmerksamkeit. <br><br>  Sergey Kolesnikov: <br>  - Mein Name ist Sergey Kolesnikov, ich werde die Entscheidung von Tensorborne vertreten. <br><br><img src="https://habrastorage.org/webt/0t/mb/o8/0tmbo89jriohlxqgahftrd4zi2y.jpeg"><br><br>  Wir haben uns einen sch√∂nen Namen ausgedacht, sind zum Wettbewerb gegangen, haben uns viele verschiedene St√ºcke ausgedacht, um danach zwei Artikel zu ver√∂ffentlichen, haben aber den Hackathon nicht gewonnen.  Daher hei√üt es: "Wie man den Hackathon nicht gewinnt, aber trotzdem die verdammten zwei Artikel ver√∂ffentlicht."  Akademiker, Sir. <br><br>  Die Merkmale des Wettbewerbs, an dem wir teilgenommen haben, haben unsere Motivation √ºbertroffen.  Aufgrund der Tatsache, dass die Bewertung t√§glich durchgef√ºhrt wurde, mussten die Pakete auch t√§glich erstellt werden, und die endg√ºltige Belohnung wurde, wie wir es in RL m√∂gen, durch diskontierte Summierung bestimmt.  All dies f√ºhrte dazu, dass wir jeden Tag mindestens etwas senden mussten, damit es funktionierte, und wir bekamen zumindest eine Art Punktzahl.  Infolgedessen ist es wirklich zu dem gewachsen, was Sie wollen - Sie wollen nicht, aber Sie mussten rudern. <br><br><img src="https://habrastorage.org/webt/4l/uf/qk/4lufqkldav6-3iemerr1lxqd8rk.jpeg"><br><br>  Was hatten wir?  Vorschau f√ºr die ganze Woche. <br><br>  Trotz der Tatsache, dass der Hackathon sagte, dass er w√∂chentlich war, wurde alles in vier Tagen entschieden, was f√ºr diese Aufgabe ConvAI nicht genug zu sein scheint. <br><br>  Anfangs waren wir zu f√ºnft, alle gute akademische Absolventen oder so Fiztekh, also kamen wir am Montag und warfen viele Vorschl√§ge, Ideen, die Sie ausprobieren k√∂nnen, und welche Deep-Learning-Modelle Sie ausprobieren sollten.  Wir haben zwar nicht mit GAN experimentiert, weil wir bereits mit ihnen f√ºr Texte experimentiert haben und dies nicht funktioniert. Deshalb haben wir etwas Einfacheres genommen, au√üerdem gab es sehr √§hnliche Wettbewerbe und wir hatten Pretrain-Modelle.  Am Dienstag konnten wir sogar etwas √ºber Deep Learning starten, ML war wo immer m√∂glich, wir haben wundervolle Docker mit GPU-Unterst√ºtzung und andere Dinge f√ºr Tensorflow und Keras gestartet, wir m√ºssen daf√ºr eine separate Medaille vergeben, da dies nicht so trivial ist wie ich m√∂chte. <br><br>  Nach den Ergebnissen vom Dienstag waren sie vielversprechend, und wir beschlossen, unsere ML mit kleinen Heuristiken und dergleichen leicht zu verbessern, und scheiterten auf dem siebten Platz.  Aber dank unserer Teamkollegen hat jemand ElasticSearch gefunden und ausprobiert.  Es gab einen sehr unangenehmen Moment, in dem ElasticSearch einwandfrei funktionierte und DL-Modelle und ML usw. etwas weniger robust waren.  Das Ende des Wettbewerbs war nahe.  Und wie der Vorredner feststellte, haben wir uns entschlossen, in die Richtung zu paddeln, die funktioniert.  Wir haben ElasticSearch, kleine Heuristiken, genommen und fanden das gut genug und wirklich gut genug, weil wir den zweiten Platz belegt haben. <br><br><img src="https://habrastorage.org/webt/yf/4p/2a/yf4p2avf9hrxd-dyy3bkgely3a0.jpeg"><br><br>  Weitere Details.  Tats√§chlich gab es mehrere DL-L√∂sungen.  Die erste DL-L√∂sung war recht einfach.  Wer erinnert sich, im Jahr vor dem letzten oder letzten Jahr gab es einen Quora-Paraphrase-Erkennungswettbewerb, und dieses Jahr gab es einen Wettbewerb von Yandex f√ºr Alice, um Dialoge und mehr zu erstellen.  M√∂glicherweise stellen Sie fest, dass die Aufgaben dort sehr eng sind.  Im ersten musste gesagt werden, ob diese beiden S√§tze Paraphrasen waren, und im zweiten musste der Dialog fortgesetzt werden.  Wir dachten, da wir Dialogsysteme entwickeln, lassen Sie uns den Dialog auch gut fortsetzen.  Und es hat perfekt funktioniert, der Dialog mit Quora war sehr pers√∂nlich. <br><br>  Im Grunde sah alles so aus, als h√§tten wir einen Encoder, normalerweise trainieren wir alle auf unseren √ºblichen RNNs und vorzugsweise LSTM mit Aufmerksamkeit und anderen Dingen.  Und dann haben wir standardm√§√üig entweder den auf der Folie unten dargestellten Cosaine-Einbettungsverlust oder einen anderen Einbettungsverlust vom Typ Tripler-Verlust verwendet oder etwas anderes, das Paraphrase oder Antworten auf einen bestimmten Dialog einbettet, und keine Paraphrase-Verz√∂gerungen usw.  Dies war die erste L√∂sung, es war auf Tensorflow, Keras, es war fertig, wir haben es versucht und es war ziemlich gut. <br><br>  Eine andere L√∂sung wurde an einem Tag zwei Hackathons am Abend geboren.  Es gibt einen wunderbaren Jeremy Howard, er f√∂rdert DL und ML f√ºr alle, er hat zwei wundervolle Kurse, die Sie in diesen Kurs und mehr einf√ºhren, und f√ºr diesen Kurs hat er sein FastAI geschrieben.  All dies funktioniert auf PyTorch und schreibt PyTorch in vielerlei Hinsicht sogar neu. Dies ist einer der Minuspunkte dieser Bibliothek.  Aber von den Pluspunkten her hat Jeremy wenig mit NLP zu tun. In diesem Jahr ver√∂ffentlichten sie im M√§rz einen Artikel mit einem anderen Studenten, in dem sie LSTM in allen Best Practices des wunderbaren FastAI schulten, mit vielen Tricks, die er in seinem Kurs f√∂rdert, und SOTA praktisch erhielten f√ºr alles. <br><br>  Da ich ein kleiner Evangelist von PyTorch bin, konnte ich dieses Modell immer noch von FastAI entwurzeln, es, wie Sie bereits sagen k√∂nnen, in mein PyTorch-Framework packen und sogar das Ganze f√ºr diese Aufgabe trainieren.  Grunds√§tzlich hatten wir einen bestimmten Dialogkontext. Selbst wenn wir mehrere S√§tze hatten, verketten Sie ihn einfach zu einem kr√§ftigen Satz.  Und dann hatten wir eine Antwort, einen Vorschlag.          FastAI,  Universal Language Model ‚Äî    ‚Äî Encoder. <br><br>     , , ,   1   ,     seq2seq.        .           ,     ,     FastAI ‚Äî Concat poolling.   ?         seq2seq,    attention.   maxpool  minpool     ,         ,      . <br><br>   ,      ,       ,     ,     maxpool  minpool,   .     ,     ‚Äî    H, Hc  Ha.       ,   feedforward ,    .  ,     ,   ,  ,  metric learning.         ‚Äî CosineEmbedding Loss,    PyTorch. <br><br>           ,  loss         .   ,  contrastive loss,    ,       .     ,        . <br><br>   DL-. ElasticSearch,   . <br><br><img src="https://habrastorage.org/webt/yf/4p/2a/yf4p2avf9hrxd-dyy3bkgely3a0.jpeg"><br><br>    ?   ,   -  ElasticSearch  . -         - Persona Dataset  ,   ,   Facebook,  ,   ,    - .      -    .        ,     ,  ,  ,        ,  Persona Dataset      ,      Amazon Mechanical Turk     ,   . <br><br>         ElasticSearch,            ,    .  ,   Persona Dataset    ,   , 10 . ,        . , , ,   ,     . <br><br>   - .        ,    Persona     ,  ,     ,  ,    ,    evaluation.    heuristic solutions. <br><br> ,   ,   ,          ,   .    .    ,  ,   ,     ,    ,     .    . <br><br>       ‚Äî    .        ,        ‚Äî    -,      -,   ,   . <br><br>      dirty hack.    ,         ,        .       .   ‚Äî    ,       . <br><br><img src="https://habrastorage.org/webt/yy/9p/fw/yy9pfw8lc-tssoygftcrfsatfxy.jpeg"><br><br>  ?        ,   -DL-       ,   DL,    .   ,    ,    ,   .          .  ,   -,     ,  ,   .  ,   ,     .     .  ,  ,    .    DL        ,  ElasticSearch  . <br><br>  ,     personality score.  ,  -,     0,25‚Äì0,3 ,       .   ,    ,   -    . <br><br><img src="https://habrastorage.org/webt/av/rt/t7/avrtt73yerc1ckh6tyv3swowuzk.jpeg"><br><br> .     ‚Äî           ,   ,  ,       Docker ElasticSearch,       .   ,  .  .     .     Also, try to guess‚Ä¶  ,    ‚Äî , funny you.  ,     general,  .    ,     ,    . <br><br> ,  ,       .            . ,          ‚Äî    ,         ,  .  ,     Docker,      . <br><br><img src="https://habrastorage.org/webt/jj/zy/9r/jjzy9r5zcnzogxejadhvfhehoyg.jpeg"><br><br>         ? ConvAI   ,     NIPS,       -  . <br><br> -, ElasticSearch   . ,    ,   .   ,      ,  ElasticSearch   . ,   DL. <br><br> -,     DL-. :       ,     ,     ,     .    ,  , , ,    . <br><br>    ,     .   ,        .     ,      .    ‚Äî    pre-trained- ( ‚Äî . .), .  . <br><br> ,   proposals   ,    RL bandits     .     ,  .     ‚Äî      .  ,    . ,    ,        ,  ,     toxic-     .   . <br><br>         ‚Äî   .         ,       DeepHacks    .   NLP,    DeepHack    , , ¬´ ¬ª.  ,  .     .      , , ,   ,         ,     . <br><br>   ‚Äî       .        distributed-       ,       .   ,       DeepHack.     -   .   .  ,     ,    ,        ,     . <br><br>   ! .      pre-trained-.   , , . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und nat√ºrlich einen Hackathonurlaub machen. </font><font style="vertical-align: inherit;">Wenn Sie an einem w√∂chentlichen Hackathon teilnehmen und gleichzeitig arbeiten, ist das schlecht. </font><font style="vertical-align: inherit;">Sie kommen um 19 Uhr an, nachdem Sie ein wenig gearbeitet haben, setzen sich und kompilieren Docker mit TensorFlow, Keras, so dass alles auf einigen Remote-Servern beginnt, auf die Sie nicht einmal Zugriff haben. </font><font style="vertical-align: inherit;">Irgendwann in zwei N√§chten erkranken Sie an Katharsis, und das funktioniert bei Ihnen - ohne Docker, ohne alles, weil Sie verstanden haben, dass dies m√∂glich ist und so. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es scheint, dass Sie, wenn Sie an einem gro√üen Wettbewerb teilnehmen, etwas mehr Zeit daf√ºr einplanen, als wie viel Sie in einer Woche nicht schlafen k√∂nnen, und teilnehmen. </font><font style="vertical-align: inherit;">Geh und gewinne.</font></font> Vielen Dank! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de422717/">https://habr.com/ru/post/de422717/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de422705/index.html">Das Buch √ºber "Paragraph" √ºber Habr√©. In einem neuen Kapitel geht es um kooperative Programmierer: Beta</a></li>
<li><a href="../de422709/index.html">Wissenschaftler haben einen Teil des menschlichen Gehirns gefunden, der f√ºr die Tonh√∂he unserer Sprache verantwortlich ist</a></li>
<li><a href="../de422711/index.html">Wochenendlesung: Cloud- und IT-Infrastrukturressourcen</a></li>
<li><a href="../de422713/index.html">Die Zusammenfassung interessanter Materialien f√ºr den mobilen Entwickler # 269 (vom 3. bis 9. September)</a></li>
<li><a href="../de422715/index.html">Nichtdiskriminierung ist der Kernwert von Open Source</a></li>
<li><a href="../de422719/index.html">Angreifer haben Tausende von MikroTik-Routern kompromittiert, um ein Botnetz zu erstellen</a></li>
<li><a href="../de422721/index.html">KivyMD - das Leben geht weiter</a></li>
<li><a href="../de422723/index.html">GAN lehrte, Gesichter mit realistischer Textur und Geometrie zu erstellen</a></li>
<li><a href="../de422725/index.html">390k. Websites mit ge√∂ffnetem .git-Ordner</a></li>
<li><a href="../de422729/index.html">Wie kann ein Cloud-Anbieter Softwarelizenzen verwalten und welche Blockchain-L√∂sungen k√∂nnen hier bereitgestellt werden?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>