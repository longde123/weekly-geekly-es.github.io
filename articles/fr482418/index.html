<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ›¬ ğŸš² ğŸ’ Introduction au langage de requÃªte Cypher ğŸ’º ğŸ¤ŸğŸ½ ğŸ‘¨â€ğŸ‘§â€ğŸ‘§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Le langage de requÃªte Cypher a Ã©tÃ© initialement dÃ©veloppÃ© spÃ©cifiquement pour le SGBD graphique Neo4j . L'objectif de Cypher est de fournir un langage...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Introduction au langage de requÃªte Cypher</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482418/"><p>  Le langage de requÃªte <em>Cypher a</em> Ã©tÃ© initialement dÃ©veloppÃ© spÃ©cifiquement pour le SGBD <a href="https://neo4j.com/" rel="nofollow">graphique Neo4j</a> .  L'objectif de Cypher est de fournir un langage de requÃªte de base de donnÃ©es SQL lisible par l'homme pour les bases de donnÃ©es graphiques.  Aujourd'hui, Cypher est supportÃ© par plusieurs SGBD graphiques.  <a href="http://www.opencypher.org/" rel="nofollow">OpenCypher a</a> Ã©tÃ© crÃ©Ã© pour standardiser Cypher. </p><br><p>  Les bases de l'utilisation du SGBD Neo4j sont dÃ©crites dans l'article <a href="https://habr.com/ru/post/470541/">Notions de base de l'utilisation de Neo4j dans un navigateur</a> . </p><br><p>  Pour se familiariser avec Cypher, considÃ©rons un exemple d'arbre gÃ©nÃ©alogique empruntÃ© au manuel Prolog classique de I. Bratko.  Cet exemple montre comment ajouter des nÅ“uds et des liens Ã  un graphique, comment leur attribuer des Ã©tiquettes et des attributs et comment poser des questions. </p><br><p><img src="https://habrastorage.org/webt/ix/__/op/ix__op6ei5llgpwdtzrnpcv5xd4.png" alt="Arbre gÃ©nÃ©alogique dans Neo4j, vue Ã©ditÃ©e"></p><a name="habracut"></a><br><p>  Alors, laissez-nous avoir un arbre gÃ©nÃ©alogique montrÃ© dans l'image ci-dessous. </p><br><p><img src="https://habrastorage.org/webt/zy/zf/v4/zyzfv4aasw-sokctup7s3vq4csi.png" alt="Arbre gÃ©nÃ©alogique"></p><br><p>  Voyons comment former le graphe correspondant dans Cypher: </p><br><pre><code class="plaintext hljs">CREATE (pam:Person {name: "Pam"}), (tom:Person {name: "Tom"}), (kate:Person {name: "Kate"}), (mary:Person {name: "Mary"}), (bob:Person {name: "Bob"}), (liz:Person {name: "Liz"}), (dick:Person {name: "Dick"}), (ann:Person {name: "Ann"}), (pat:Person {name: "Pat"}), (jack:Person {name: "Jack"}), (jim:Person {name: "Jim"}), (joli:Person {name: "Joli"}), (pam)-[:PARENT]-&gt;(bob), (tom)-[:PARENT]-&gt;(bob), (tom)-[:PARENT]-&gt;(liz), (kate)-[:PARENT]-&gt;(liz), (mary)-[:PARENT]-&gt;(ann), (bob)-[:PARENT]-&gt;(ann), (bob)-[:PARENT]-&gt;(pat), (dick)-[:PARENT]-&gt;(jim), (ann)-[:PARENT]-&gt;(jim), (pat)-[:PARENT]-&gt;(joli), (jack)-[:PARENT]-&gt;(joli)</code> </pre> <br><p>  Une demande CREATE pour ajouter des donnÃ©es Ã  un SGBD graphique se compose de deux parties: ajouter des nÅ“uds et ajouter des liens entre eux.  Chaque nÅ“ud Ã  ajouter se voit attribuer un nom dans le cadre de cette demande, qui est ensuite utilisÃ© pour crÃ©er des liens.  Les nÅ“uds et les communications peuvent stocker des documents.  Dans notre cas, les nÅ“uds contiennent des documents avec les champs de nom et les liens de document ne contiennent pas.  Les nÅ“uds et les liens peuvent Ã©galement Ãªtre Ã©tiquetÃ©s.  Dans notre cas, les nÅ“uds se voient attribuer le label Personne et les liens sont PARENTS.  L'Ã©tiquette dans les demandes est mise en Ã©vidence par deux points avant son nom. </p><br><p>  Ainsi, Neo4j nous a dit que: <code>Added 12 labels, created 12 nodes, set 12 properties, created 11 relationships, completed after 9 ms.</code> </p><br><p>  Voyons ce que nous avons: </p><br><pre> <code class="plaintext hljs">MATCH (p:Person) RETURN p</code> </pre> <br><p><img src="https://habrastorage.org/webt/ch/gc/ya/chgcyawfcxryshb6p1xdjtf7fp8.png" alt="Arbre gÃ©nÃ©alogique Ã  Neo4j"></p><br><p>  Personne ne nous interdit de modifier l'apparence du graphique rÃ©sultant: </p><br><p><img src="https://habrastorage.org/webt/ix/__/op/ix__op6ei5llgpwdtzrnpcv5xd4.png" alt="Arbre gÃ©nÃ©alogique dans Neo4j, vue Ã©ditÃ©e"></p><br><p>  Que peut-on faire avec Ã§a?  Vous pouvez vÃ©rifier que, par exemple, Pam est <br>  Parent de Bob: </p><br><pre> <code class="plaintext hljs">MATCH ans = (:Person {name: "Pam"})-[:PARENT]-&gt;(:Person {name: "Bob"}) RETURN ans</code> </pre> <br><p>  Nous obtenons le sous-graphique correspondant: </p><br><p><img src="https://habrastorage.org/webt/dj/jq/o_/djjqo_tukevpbd1viu8smouuume.png" alt="Pam est le parent de Bob"></p><br><p>  Cependant, ce n'est pas exactement ce dont nous avons besoin.  Modifiez la demande: </p><br><pre> <code class="plaintext hljs">MATCH ans = (:Person {name: "Pam"})-[:PARENT]-&gt;(:Person {name: "Bob"}) RETURN ans IS NOT NULL</code> </pre> <br><p>  Maintenant, en rÃ©ponse, nous devenons <code>true</code> .  Et si nous demandons: </p><br><pre> <code class="plaintext hljs">MATCH ans = (:Person {name: "Pam"})-[:PARENT]-&gt;(:Person {name: "Liz"}) RETURN ans IS NOT NULL</code> </pre> <br><p>  Nous nâ€™obtiendrons rien ... Ici, vous devez ajouter le mot <code>OPTIONAL</code> , puis si <br>  le rÃ©sultat sera vide, puis <code>false</code> sera retournÃ©: </p><br><pre> <code class="plaintext hljs">OPTIONAL MATCH ans = (:Person {name: "Pam"})-[:PARENT]-&gt;(:Person {name: "Liz"}) RETURN ans IS NOT NULL</code> </pre> <br><p>  Maintenant, nous obtenons la rÃ©ponse attendue <code>false</code> . </p><br><p>  Ensuite, vous pouvez voir qui est le parent avec qui: </p><br><pre> <code class="plaintext hljs">MATCH (p1:Person)-[:PARENT]-&gt;(p2:Person) RETURN p1, p2</code> </pre> <br><p>  Ouvrez l'onglet de rÃ©sultat avec <code>Text</code> et voyez un tableau avec deux colonnes: </p><br><pre> <code class="plaintext hljs">â•’â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¤â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•• â”‚"p1" â”‚"p2" â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡ â”‚{"name":"Pam"} â”‚{"name":"Bob"} â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚{"name":"Tom"} â”‚{"name":"Bob"} â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚{"name":"Tom"} â”‚{"name":"Liz"} â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚{"name":"Kate"}â”‚{"name":"Liz"} â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚{"name":"Mary"}â”‚{"name":"Ann"} â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚{"name":"Bob"} â”‚{"name":"Ann"} â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚{"name":"Bob"} â”‚{"name":"Pat"} â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚{"name":"Dick"}â”‚{"name":"Jim"} â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚{"name":"Ann"} â”‚{"name":"Jim"} â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚{"name":"Pat"} â”‚{"name":"Joli"}â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚{"name":"Jack"}â”‚{"name":"Joli"}â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code> </pre> <br><p>  Que pouvons-nous apprendre d'autre?  Par exemple, qui est le parent d'un membre spÃ©cifique du genre, par exemple, pour Bob: </p><br><pre> <code class="plaintext hljs">MATCH (parent:Person)-[:PARENT]-&gt;(:Person {name: "Bob"}) RETURN parent.name</code> </pre> <br><pre> <code class="plaintext hljs">â•’â•â•â•â•â•â•â•â•â•â•â•â•â•â•• â”‚"parent.name"â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡ â”‚"Tom" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Pam" â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code> </pre> <br><p>  Ici, comme rÃ©ponse, nous ne demandons pas le nÅ“ud entier, mais seulement son attribut spÃ©cifique. </p><br><p>  Nous pouvons Ã©galement dÃ©couvrir qui sont les enfants de Bob: </p><br><pre> <code class="plaintext hljs">MATCH (:Person {name: "Bob"})-[:PARENT]-&gt;(child:Person) RETURN child.name</code> </pre> <br><pre> <code class="plaintext hljs">â•’â•â•â•â•â•â•â•â•â•â•â•â•â•• â”‚"child.name"â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡ â”‚"Ann" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Pat" â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code> </pre> <br><p>  On peut aussi demander qui a des enfants: </p><br><pre> <code class="plaintext hljs">MATCH (parent:Person)-[:PARENT]-&gt;(:Person) RETURN parent.name</code> </pre> <br><pre> <code class="plaintext hljs">â•’â•â•â•â•â•â•â•â•â•â•â•â•â•â•• â”‚"parent.name"â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡ â”‚"Pam" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Tom" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Tom" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Kate" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Mary" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Bob" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Bob" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Dick" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Ann" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Pat" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Jack" â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code> </pre> <br><p>  Hmm, Tom et Bob se sont rencontrÃ©s deux fois, corrigez-le: </p><br><pre> <code class="plaintext hljs">MATCH (parent:Person)-[:PARENT]-&gt;(:Person) RETURN DISTINCT parent.name</code> </pre> <br><p>  Nous avons ajoutÃ© le mot <code>DISTINCT</code> au rÃ©sultat de retour de la requÃªte, ce qui signifie <br>  similaire Ã  celui de SQL. </p><br><pre> <code class="plaintext hljs">â•’â•â•â•â•â•â•â•â•â•â•â•â•â•â•• â”‚"parent.name"â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡ â”‚"Pam" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Tom" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Kate" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Mary" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Bob" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Dick" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Ann" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Pat" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Jack" â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code> </pre> <br><p>  Vous pouvez Ã©galement remarquer que Neo4j nous renvoie les parents dans l'ordre dans lequel ils ont Ã©tÃ© entrÃ©s dans la demande <code>CREATE</code> . </p><br><p>  Demandons maintenant qui est grand-pÃ¨re ou grand-mÃ¨re: </p><br><pre> <code class="plaintext hljs">MATCH (grandparent:Person)-[:PARENT]-&gt;()-[:PARENT]-&gt;(:Person) RETURN DISTINCT grandparent.name</code> </pre> <br><p>  GÃ©nial, c'est tout: </p><br><pre> <code class="plaintext hljs">â•’â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•• â”‚"grandparent.name"â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡ â”‚"Tom" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Pam" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Bob" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Mary" â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code> </pre> <br><p>  Dans le modÃ¨le de requÃªte, nous avons utilisÃ© un nÅ“ud sans nom intermÃ©diaire <code>()</code> et deux relations de type <code>PARENT</code> . </p><br><p>  Nous dÃ©couvrons maintenant qui est le pÃ¨re.  Le pÃ¨re est un homme qui a un enfant.  Ainsi, nous manquons de donnÃ©es sur qui est l'homme.  Par consÃ©quent, pour dÃ©terminer qui est une mÃ¨re, vous devez savoir qui est une femme.  Ajoutez les informations pertinentes Ã  notre base de donnÃ©es.  Pour ce faire, nous allons attribuer les Ã©tiquettes <code>Male</code> et <code>Female</code> aux nÅ“uds existants. </p><br><pre> <code class="plaintext hljs">MATCH (p:Person) WHERE p.name IN ["Tom", "Dick", "Bob", "Jim", "Jack"] SET p:Male</code> </pre> <br><pre> <code class="plaintext hljs">MATCH (p:Person) WHERE p.name IN ["Pam", "Kate", "Mary", "Liz", "Ann", "Pat", "Joli"] SET p:Female</code> </pre> <br><p>  Expliquons ce que nous avons fait ici: nous avons sÃ©lectionnÃ© tous les nÅ“uds Ã©tiquetÃ©s <code>Person</code> , les avons vÃ©rifiÃ©s <br>  la propriÃ©tÃ© de <code>name</code> fonction de la liste donnÃ©e spÃ©cifiÃ©e entre crochets et affectÃ©e respectivement aux nÅ“uds correspondants l'Ã©tiquette <code>Male</code> ou <code>Female</code> . </p><br><p>  VÃ©rifier: </p><br><pre> <code class="plaintext hljs">MATCH (p:Person) WHERE p:Male RETURN p.name</code> </pre> <br><pre> <code class="plaintext hljs">â•’â•â•â•â•â•â•â•â•â•• â”‚"p.name"â”‚ â•â•â•â•â•â•â•â•â•â•¡ â”‚"Tom" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Bob" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Dick" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Jack" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Jim" â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code> </pre> <br><pre> <code class="plaintext hljs">MATCH (p:Person) WHERE p:Female RETURN p.name</code> </pre> <br><pre> <code class="plaintext hljs">â•’â•â•â•â•â•â•â•â•â•• â”‚"p.name"â”‚ â•â•â•â•â•â•â•â•â•â•¡ â”‚"Pam" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Kate" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Mary" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Liz" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Ann" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Pat" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Joli" â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code> </pre> <br><p>  Nous avons demandÃ© Ã  tous les nÅ“uds Ã©tiquetÃ©s <code>Person</code> , qui a Ã©galement une Ã©tiquette de <code>Male</code> ou de <code>Female</code> , respectivement.  Mais nous pourrions rendre nos demandes un peu diffÃ©rentes: </p><br><pre> <code class="plaintext hljs">MATCH (p:Person:Male) RETURN p.name MATCH (p:Person:Female) RETURN p.name</code> </pre> <br><p>  Reprenons notre graphique: </p><br><p><img src="https://habrastorage.org/webt/zc/nn/pj/zcnnpj6ynprgddwmbdhoh3ubjp8.png" alt="Arbre gÃ©nÃ©alogique avec des Ã©tiquettes Homme et Femme"></p><br><p>  Le navigateur Neo4j a peint les nÅ“uds de deux couleurs diffÃ©rentes selon les marques de Male et <br>  Femme </p><br><p>  Ok, maintenant nous pouvons interroger tous les pÃ¨res de la base de donnÃ©es: </p><br><pre> <code class="plaintext hljs">MATCH (p:Person:Male)-[:PARENT]-&gt;(:Person) RETURN DISTINCT p.name</code> </pre> <br><pre> <code class="plaintext hljs">â•’â•â•â•â•â•â•â•â•â•• â”‚"p.name"â”‚ â•â•â•â•â•â•â•â•â•â•¡ â”‚"Tom" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Bob" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Dick" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Jack" â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code> </pre> <br><p>  Et les mÃ¨res: </p><br><pre> <code class="plaintext hljs">MATCH (p:Person:Female)-[:PARENT]-&gt;(:Person) RETURN DISTINCT p.name</code> </pre> <br><pre> <code class="plaintext hljs">â•’â•â•â•â•â•â•â•â•â•• â”‚"p.name"â”‚ â•â•â•â•â•â•â•â•â•â•¡ â”‚"Pam" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Kate" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Mary" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Ann" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Pat" â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code> </pre> <br><p>  Formulons maintenant une relation frÃ¨re et sÅ“ur.  X est frÃ¨re de Y, <br>  s'il est un homme, et pour X et Y il y a au moins un parent commun.  De mÃªme pour <br>  relation soeur. </p><br><p>  FrÃ¨re Attitude sur Cypher: </p><br><pre> <code class="plaintext hljs">MATCH (brother:Person:Male)&lt;-[:PARENT]-()-[:PARENT]-&gt;(p:Person) RETURN brother.name, p.name</code> </pre> <br><pre> <code class="plaintext hljs">â•’â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¤â•â•â•â•â•â•â•â•â•• â”‚"brother.name"â”‚"p.name"â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡ â”‚"Bob" â”‚"Liz" â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code> </pre> <br><p>  Attitude des soeurs sur Cypher: </p><br><pre> <code class="plaintext hljs">MATCH (sister:Person:Female)&lt;-[:PARENT]-()-[:PARENT]-&gt;(p:Person) RETURN sister.name, p.name</code> </pre> <br><pre> <code class="plaintext hljs">â•’â•â•â•â•â•â•â•â•â•â•â•â•â•â•¤â•â•â•â•â•â•â•â•â•• â”‚"sister.name"â”‚"p.name"â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡ â”‚"Liz" â”‚"Bob" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Ann" â”‚"Pat" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Pat" â”‚"Ann" â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code> </pre> <br><p>  Ainsi, nous pouvons dÃ©couvrir qui est le parent et qui est aussi le grand-pÃ¨re ou la grand-mÃ¨re.  Mais qu'en est-il des ancÃªtres les plus Ã©loignÃ©s?  Avec des arriÃ¨re-grands-pÃ¨res, arriÃ¨re-arriÃ¨re-grands-pÃ¨res, etc.?  Nous n'Ã©crirons pas de rÃ¨gle correspondante pour chacun de ces cas, et ce sera chaque fois plus problÃ©matique.  En fait, tout est simple: X est un ancÃªtre pour Y s'il est un ancÃªtre pour un parent Y. Cypher fournit un modÃ¨le <code>*</code> qui vous permet d'exiger une sÃ©quence de relations de n'importe quelle longueur: </p><br><pre> <code class="plaintext hljs">MATCH (p:Person)-[*]-&gt;(s:Person) RETURN DISTINCT p.name, s.name</code> </pre> <br><p>  Il y a vraiment un problÃ¨me: ce seront les connexions.  Ajoutez une rÃ©fÃ©rence au lien <code>PARENT</code> : </p><br><pre> <code class="plaintext hljs">MATCH (p:Person)-[:PARENT*]-&gt;(s:Person) RETURN DISTINCT p.name, s.name</code> </pre> <br><p>  Afin de ne pas augmenter la longueur de l'article, on retrouve tous les ancÃªtres de <code>Joli</code> : </p><br><pre> <code class="plaintext hljs">MATCH (p:Person)-[:PARENT*]-&gt;(:Person {name: "Joli"}) RETURN DISTINCT p.name</code> </pre> <br><pre> <code class="plaintext hljs">â•’â•â•â•â•â•â•â•â•â•• â”‚"p.name"â”‚ â•â•â•â•â•â•â•â•â•â•¡ â”‚"Jack" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Pat" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Bob" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Pam" â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚"Tom" â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code> </pre> <br><p>  Envisagez une rÃ¨gle plus complexe pour savoir qui est liÃ© Ã  qui. <br>  PremiÃ¨rement, les parents sont des ancÃªtres et des descendants, par exemple un fils et une mÃ¨re, une grand-mÃ¨re et un petit-fils.  DeuxiÃ¨mement, les parents sont des frÃ¨res et sÅ“urs, y compris des cousins, des cousins â€‹â€‹au deuxiÃ¨me degrÃ©, etc., ce qui, en termes d'ancÃªtres, signifie qu'ils ont un ancÃªtre commun.  Et troisiÃ¨mement, les parents qui ont des descendants communs, par exemple le mari et la femme, sont considÃ©rÃ©s comme des parents. </p><br><p>  Sur Cypher, vous devez utiliser <code>UNION</code> pour de nombreux modÃ¨les: </p><br><pre> <code class="plaintext hljs">MATCH (r1:Person)-[:PARENT*]-(r2:Person) RETURN DISTINCT r1.name, r2.name UNION MATCH (r1:Person)&lt;-[:PARENT*]-(:Person)-[:PARENT*]-&gt;(r2:Person) RETURN DISTINCT r1.name, r2.name UNION MATCH (r1:Person)-[:PARENT*]-&gt;(:Person)&lt;-[:PARENT*]-(r2:Person) RETURN DISTINCT r1.name, r2.name</code> </pre> <br><p>  Ici, dans la premiÃ¨re rÃ¨gle, des connexions sont utilisÃ©es, dont la direction n'a pas d'importance pour nous.  Une telle connexion est indiquÃ©e sans flÃ¨che, juste un tiret <code>-</code> .  Les deuxiÃ¨me et troisiÃ¨me rÃ¨gles sont Ã©crites de maniÃ¨re Ã©vidente et familiÃ¨re. </p><br><p>  Nous ne prÃ©senterons pas le rÃ©sultat de la requÃªte totale ici, nous dirons seulement que les paires de parents trouvÃ©es sont 132, ce qui est cohÃ©rent avec la valeur calculÃ©e comme le nombre de paires ordonnÃ©es Ã  partir de 12. Nous pourrions Ã©galement spÃ©cifier cette requÃªte en remplaÃ§ant l'occurrence de la variable <code>r1</code> ou <code>r2</code> par <code>(:Person {name: "Liz"})</code> par exemple, cependant, dans notre cas, cela n'a pas beaucoup de sens, car toutes les personnes dans notre base de donnÃ©es sont Ã©videmment des parents. </p><br><p>  Ceci conclut notre discussion sur l'identification des relations entre les personnes dans notre base de donnÃ©es. </p><br><p>  Enfin, rÃ©flÃ©chissez Ã  la faÃ§on de supprimer les nÅ“uds et les liens. </p><br><p>  Pour supprimer toutes nos personnes, vous pouvez exÃ©cuter la demande: </p><br><pre> <code class="plaintext hljs">MATCH (p:Person) DELETE p</code> </pre> <br><p>  Cependant, Neo4j nous dira que vous ne pouvez pas supprimer les nÅ“uds qui ont des liens. <br>  Par consÃ©quent, nous supprimons d'abord les liens, puis rÃ©pÃ©tons la suppression des nÅ“uds: </p><br><pre> <code class="plaintext hljs">MATCH (p1:Person)-[r]-&gt;(p2:Person) DELETE r</code> </pre> <br><p>  Ce que nous avons fait maintenant: a comparÃ© deux personnes entre lesquelles il existe une connexion, a nommÃ© cette connexion comme <code>r</code> , puis l'a supprimÃ©e. </p><br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  L'article montre comment utiliser les capacitÃ©s du langage de requÃªte Cypher Ã  l'aide d'un exemple simple de graphe social.  En particulier, nous avons examinÃ© comment ajouter des nÅ“uds et des liens avec une seule requÃªte, comment rechercher des donnÃ©es connexes, y compris avec des liens indirects, et comment attribuer des Ã©tiquettes aux nÅ“uds.  Vous trouverez plus d'informations sur Cypher sur les liens ci-dessous.  Un bon point de dÃ©part est la "Neo4j Cypher Refcard". </p><br><p>  Neo4j est loin d'Ãªtre le seul SGBD graphique.  Parmi les autres plus populaires, citons <a href="https://www.cayley.io/" rel="nofollow">Cayley</a> , <a href="https://dgraph.io/" rel="nofollow">Dgraph</a> avec langage de requÃªte GraphQL, <a href="https://www.arangodb.com/" rel="nofollow">ArangoDB multimodÃ¨le</a> et <a href="http://orientdb.com/" rel="nofollow">OrientDB</a> .  Un intÃ©rÃªt particulier peut Ãªtre <a href="https://www.blazegraph.com/" rel="nofollow">Blazegraph</a> avec le support de RDF et SPARQL. </p><br><h2 id="ssylki">  Les rÃ©fÃ©rences </h2><br><ul><li>  <a href="https://neo4j.com/developer/cypher-query-language/" rel="nofollow">Neo4j: une introduction Ã  Cypher</a> </li><li>  <a href="https://neo4j.com/docs/cypher-refcard/current/" rel="nofollow">Neo4j Cypher Refcard</a> </li><li>  <a href="http://www.opencypher.org/" rel="nofollow">openCypher</a> </li></ul><br><h2 id="bibliografiya">  Bibliographie </h2><br><ul><li>  Robinson Jan, Weber Jim, Eifrem Emil.  Bases de donnÃ©es graphiques.  De nouvelles fonctionnalitÃ©s <br>  pour travailler avec des donnÃ©es connexes / Per.  de l'anglais  - 2e Ã©d.  - M.: DMK-Press, <br>  2016 - 256 s. </li><li>  Bratko I. Programmation en langage Prolog pour l'intelligence artificielle: <br>  trans.  de l'anglais  - M.: Mir, 1990 .-- 560 p.: Malade. </li></ul><br><h2 id="posleslovie">  Postface </h2><br><p>  L'auteur de l'article ne connaÃ®t que deux sociÃ©tÃ©s (toutes deux de Saint-PÃ©tersbourg) qui utilisent des SGBD graphiques pour leurs produits.  Mais je voudrais savoir combien d'entreprises de lecteurs de cet article les utilisent dans leur dÃ©veloppement.  Par consÃ©quent, je propose de participer Ã  l'enquÃªte.  Ã‰crivez Ã©galement sur votre expÃ©rience dans les commentaires, il sera trÃ¨s intÃ©ressant de le savoir. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr482418/">https://habr.com/ru/post/fr482418/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr482400/index.html">Une sÃ©lection de faits statistiques amusants # 2</a></li>
<li><a href="../fr482402/index.html">ModÃ¨le d'usine. Exemple d'application dans Unity</a></li>
<li><a href="../fr482404/index.html">MnÃ©moniques: explorer des mÃ©thodes pour augmenter la mÃ©moire cÃ©rÃ©brale</a></li>
<li><a href="../fr482406/index.html">Meilleurs livres DLC pour la sÃ©rie de science-fiction moderne</a></li>
<li><a href="../fr482410/index.html">Contemplation de la grande ressemblance fractale</a></li>
<li><a href="../fr482420/index.html">JavaFX - pas encore mort</a></li>
<li><a href="../fr482428/index.html">Dotnetru. 2019. RÃ©sultats</a></li>
<li><a href="../fr482430/index.html">L'Ã©tude n'est pas une loterie, les mesures mentent</a></li>
<li><a href="../fr482432/index.html">L'informatique dans le systÃ¨me scolaire</a></li>
<li><a href="../fr482434/index.html">Stockage AERODISK sur les processeurs Elbrus 8C domestiques</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>