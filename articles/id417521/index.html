<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤸 🏢 👉🏼 Tinjau sertifikat SSL untuk pencabutan 👩🏽‍💼 👆🏿 🔉</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Saat ini, salah satu aspek terpenting dari transfer informasi yang aman adalah enkripsi. Data yang dikirimkan dari klien ke server dienkripsi mengguna...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tinjau sertifikat SSL untuk pencabutan</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/417521/"> Saat ini, salah satu aspek terpenting dari transfer informasi yang aman adalah enkripsi.  Data yang dikirimkan dari klien ke server dienkripsi menggunakan sertifikat SSL.  Sertifikat adalah kunci publik yang disertifikasi oleh otoritas sertifikasi. <br><br>  Semua sertifikat SSL, sebagai suatu peraturan, dikeluarkan untuk periode terbatas, setelah itu habis masa berlakunya dan harus diterbitkan kembali.  Namun, ada kalanya sertifikat dapat dicabut sebelum tanggal kedaluwarsa.  Ada banyak alasan untuk mencabut sertifikat SSL, yang paling umum adalah bahwa kunci pribadi hilang atau dikompromikan, data pendaftaran perusahaan berubah, dll. <br><a name="habracut"></a><br>  Ada 2 cara alternatif untuk memeriksa apakah sertifikat SSL ada dalam daftar pencabutan: <br><br><ul><li>  CRL (Daftar Pencabutan Sertifikat) - memeriksa keberadaan nomor seri sertifikat dalam daftar pencabutan. </li><li>  OCSP (Online Certificate Status Protocol) - sertifikat dikirim ke server khusus, di mana statusnya diperiksa. </li></ul><br>  Mari kita lihat kedua metode ini secara lebih rinci menggunakan konsol Ubuntu.  Dan sebagai contoh, mari kita periksa sertifikat untuk domain habr.com untuk ditinjau. <br><br><h2>  CRL </h2><br>  Unduh sertifikat domain yang kami minati: <br><br><pre><code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> -n | openssl s_client -connect habr.com:443 -servername habr.com 2&gt;&amp;1 | sed -ne <span class="hljs-string"><span class="hljs-string">'/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p'</span></span> &gt; /tmp/habr.com.crt</code> </pre> <br>  <i>Terima kasih kepada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link">legioner</a> untuk petunjuk untuk menambahkan parameter <b>-servername</b> - perlu untuk pemilihan sertifikat yang benar jika ada beberapa (SNI) yang diinstal pada alamat IP yang sama.</i> <br><br>  Kami melihat detail sertifikat: <br><br><pre> <code class="bash hljs">openssl x509 -noout -text -<span class="hljs-keyword"><span class="hljs-keyword">in</span></span> /tmp/habr.com.crt</code> </pre> <br>  Di sini kita tertarik pada bagian "Poin Distribusi CRL X509v3" item "Nama Lengkap". <br><br>  Unduh daftar CLR dari tautan ini: <br><br><pre> <code class="bash hljs">wget http://crl.comodoca.com/COMODORSADomainValidationSecureServerCA.crl</code> </pre> <br>  Kami memilih nomor seri sertifikat: <br><br><pre> <code class="bash hljs">openssl x509 -<span class="hljs-keyword"><span class="hljs-keyword">in</span></span> /tmp/habr.com.crt -noout -serial</code> </pre> <br>  Kami melihat apakah nomor ini ada dalam daftar CRL: <br><br><pre> <code class="bash hljs">openssl crl -inform DER -text -<span class="hljs-keyword"><span class="hljs-keyword">in</span></span> COMODORSADomainValidationSecureServerCA.crl | grep <span class="hljs-string"><span class="hljs-string">"90E58B0601C3AD98F07AEE092041C437"</span></span></code> </pre> <br>  Jika tidak ada yang ditemukan, maka sertifikat tidak dicabut. <br><br><h2>  OCSP </h2><br>  Kami akan menampilkan sertifikat domain yang menarik bagi kami dan rantai sertifikat perantara: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> -n | openssl s_client -connect habr.com:443 -showcerts</code> </pre> <br>  Simpan sertifikat domain dan sertifikat perantara (kode di antara baris ----- BEGIN CERTIFICATE ----- dan ----- END CERTIFICATE -----) ke dalam file: <br><br><pre> <code class="bash hljs">/tmp/habr.com.crt /tmp/intermediate.crt</code> </pre> <br>  Tentukan server OCSP: <br><br><pre> <code class="bash hljs">openssl x509 -<span class="hljs-keyword"><span class="hljs-keyword">in</span></span> /tmp/habr.com.crt -noout -ocsp_uri</code> </pre> <br>  Kami akan mengirimkan permintaan ke server OCSP untuk memeriksa sertifikat untuk pencabutan: <br><br><pre> <code class="bash hljs">openssl ocsp -url http://ocsp.comodoca.com -issuer /tmp/intermediate.crt -cert /tmp/habr.com.crt -text</code> </pre> <br>  Jika semuanya ditentukan dengan benar, maka server OCSP harus mengembalikan informasi pada sertifikat. <br><br>  Inilah baris terakhir yang menarik: <br><br><pre> <code class="bash hljs">Response verify OK /tmp/habr.com.crt: good</code> </pre> <br>  Tidak adanya sertifikat dalam daftar yang dicabut ditunjukkan oleh nilai "baik", jika sertifikat dicabut, nilainya akan "dicabut". <br><br><h2>  Otomasi </h2><br>  Memeriksa sertifikat SSL secara manual untuk pencabutan tidak selalu mudah, sehingga proses verifikasi dapat dilakukan secara otomatis. <br><br>  Untuk melakukan ini, kami mengambil skrip ssl-check-revoc.sh yang sudah jadi dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Github</a> , yang memeriksa sertifikat menggunakan metode CRL: <br><br><pre> <code class="bash hljs">wget https://raw.githubusercontent.com/o-pod/security/master/ssl-check-revoc.sh</code> </pre> <br>  Selanjutnya, buat skrip dapat dieksekusi: <br><br><pre> <code class="bash hljs">chmod a+x ssl-check-revoc.sh</code> </pre> <br>  Sekarang Anda dapat memeriksa sertifikat yang sudah diinstal untuk domain dan yang disimpan secara lokal dalam file (opsi -f): <br><br><pre> <code class="bash hljs">./ssl-check-revoc.sh habr.com -v</code> </pre> <br><h2>  Zabbix </h2><br>  Skrip ssl-check-revoc.sh dapat memeriksa sertifikat tidak hanya dari konsol, tetapi juga cukup cocok sebagai pemeriksa untuk Zabbix, oleh karena itu semua pekerjaan kotor melacak sertifikat yang masuk ke daftar pencabutan dapat dipercayakan ke sistem pemantauan. <br><br>  Kita masuk ke konfigurasi Zabbix /etc/zabbix/zabbix_server.conf dan lihat di mana skrip untuk pemeriksaan eksternal berada: <br><br><pre> <code class="bash hljs">ExternalScripts=/etc/zabbix/externalscripts</code> </pre> <br>  Kami menyalin skrip kami ke direktori ini dan memulai ulang Zabbix: <br><br><pre> <code class="bash hljs">sudo cp ssl-check-revoc.sh /etc/zabbix/externalscripts/ sudo systemctl restart zabbix-server</code> </pre> <br>  Kami masuk ke antarmuka web dan membuat templat (Konfigurasi &gt;&gt; Templat &gt;&gt; Buat templat).  Untuk nama templat, tentukan “Memeriksa SSL Templat”.  Kemudian, di dalam templat, buat item "Sertifikat SSL dalam Daftar Pencabutan" (Item), tentukan "ssl-check-revoc.sh [{HOST.NAME}]" sebagai kunci, dengan jenis centangnya adalah "Pemeriksaan eksternal".  Interval inspeksi dapat diatur sesuai kebijaksanaan Anda, tergantung pada kekritisan proyek. <br><br><img src="https://habrastorage.org/webt/ri/bz/q5/ribzq54aziyxrbfwa4etpes4wwe.png"><br><br>  Anda juga membutuhkan dua pemicu: <br><br>  1. Untuk memberi sinyal pencabutan sertifikat, "Sertifikat untuk domain {HOST.NAME} ada dalam daftar pencabutan" <br>  Ekspresi: "{Memeriksa SSL Kustom Template: ssl-check-revoc.sh [{HOST.NAME}]. Terakhir ()} = 1" <br><br><img src="https://habrastorage.org/webt/o_/ta/i4/o_tai4c8vt_ek4cs5crhfeejgiw.png"><br><br>  2. Untuk memberi sinyal kesalahan jika terjadi kesalahan (misalnya, ada masalah dengan server CLR, dll.) "Kesalahan untuk memeriksa sertifikat untuk domain {HOST.NAME}" <br>  Ekspresi: "{Memeriksa SSL Kustom Template: ssl-check-revoc.sh [{HOST.NAME}]. Terakhir ()} = 2" <br><br><img src="https://habrastorage.org/webt/dg/gf/go/dggfgoiofirncbwpaj1rqkvu808.png"><br><br>  Jangan lupa di tindakan (Konfigurasi &gt;&gt; Tindakan) untuk mengonfigurasi metode pemberitahuan jika terjadi pemicu. <br><br>  Sekarang tinggal membuat host, sertifikat yang akan kami periksa secara teratur (Konfigurasi &gt;&gt; Host &gt;&gt; Buat host).  Pada tab Templat, tautkan templat Memeriksa SSL templat kami. <br><br><img src="https://habrastorage.org/webt/9n/wm/_8/9nwm_87gtjw7kkrjp4jpq27pxhe.png"><br><br>  Dan itu dia!  Anda dapat tidur nyenyak: jika sertifikat SSL domain Anda dengan alasan apa pun termasuk dalam daftar yang dicabut, Zabbix akan segera memberi tahu Anda. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id417521/">https://habr.com/ru/post/id417521/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id417509/index.html">Kiat & trik Kubernetes: mempercepat bootstrap dari database besar</a></li>
<li><a href="../id417511/index.html">Intel Mengakuisisi eASIC - Pengembang ASIC Struktural</a></li>
<li><a href="../id417513/index.html">Analog dengan Python dan JavaScript. Bagian dua</a></li>
<li><a href="../id417515/index.html">Apa yang saya pelajari dengan membuat 100 game dalam 5 tahun</a></li>
<li><a href="../id417517/index.html">Halaman sejarah Intel. Foto Kronik dan Kuis</a></li>
<li><a href="../id417527/index.html">Kami mengembangkan Udang: kami mengontrol permintaan paralel, kami masuk melalui spdlog dan banyak lagi ...</a></li>
<li><a href="../id417529/index.html">Tiga tren teknologi yang mengubah perdagangan dan konsumen</a></li>
<li><a href="../id417531/index.html">Bagaimana kami menang di SmartMailHack 2</a></li>
<li><a href="../id417533/index.html">Notepad pada Windows menerima pembaruan signifikan pertama dalam dua dekade</a></li>
<li><a href="../id417535/index.html">Apakah pengembangan CUBA merupakan langkah besar dari Spring?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>