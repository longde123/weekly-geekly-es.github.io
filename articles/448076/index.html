<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙍🏾 📝 🍴 Sistema simple de simulación Go 🧜🏿 🍘 🚑</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduccion 
 La simulación es un método para realizar experimentos, el sistema real estudiado es reemplazado por un modelo. En dicho modelo, puede p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sistema simple de simulación Go</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/448076/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/pu/9e/eg/pu9eeg4seokrai0jac-5y9ojk1s.png" width="200" height="100"></div><br><br><h2>  Introduccion </h2><br>  La simulación es un método para realizar experimentos, el sistema real estudiado es reemplazado por un modelo.  En dicho modelo, puede perder situaciones individuales y muchas de ellas.  Las estadísticas recopiladas pueden ayudar a sacar conclusiones acerca de los procesos en el sistema, así como también esbozar las rutas de optimización. <br><a name="habracut"></a><br>  El modelado de simulación a menudo se considera como un tipo de pruebas experimentales, pero al mismo tiempo es menos costoso, le permite cambiar rápidamente los parámetros y observar el sistema simulado en dinámica. <br><br>  Ya alrededor de medio siglo en el modelado de simulación, se han utilizado modelos de computadora.  Se han creado muchos programas y marcos diferentes para su desarrollo, entre los cuales, en mi opinión, los más desarrollados son las herramientas para modelar sistemas de colas (QS).  Uno de los programas más conocidos y simples para la simulación de QS - GPSS World (Sistema de simulación de propósito general - un sistema de modelado de propósito general) se puede encontrar con más detalle en los enlaces <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[1]</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[2]</a> . <br><br>  El concepto de este programa fue la base del marco de simulación en Go. <br><br><h2>  Simulación en GPSS </h2><br>  Un modelo en GPSS es una secuencia de bloques (comandos) que describe los objetos simulados entre los que se mueven las transacciones.  Cuando una transacción ingresa al bloque, se generan eventos que conducen a un cambio en el estado del objeto modelado o a un cambio en el estado / parámetros de la transacción. <br><br>  Los bloques principales del orden de diez: GENERAR, TERMINAR, ASIGNAR, ASEGURAR, LIBERAR, COLA, AVANZAR, SALIR, INICIAR.  Hay alrededor de tres docenas de bloques en total.  Los bloques tienen parámetros, que pueden ser números, nombres de funciones, etiquetas en el programa de simulación, nombres de variables.  Se pueden encontrar más detalles sobre los bloques, por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aquí</a> . <br><br>  Los objetos en GPSS tienen un conjunto de atributos numéricos estándar (NAV) y atributos lógicos estándar (ALS).  Por ejemplo, para una cola, uno de los NAV es la longitud actual, y un ejemplo de ALS para algunos equipos será VERDADERO u ocupado (FALSO). <br>  En algunas versiones de GPSS hay una visualización del proceso de modelado, pero a menudo está ausente.  En función de los resultados de la simulación, se genera un informe en GPSS, que indica el NAV y ALS para todos los objetos. <br><br><h2>  Ir a la implementación </h2><br>  Implementación en Go es el desarrollo de un conjunto de objetos similares en función a los bloques GPSS.  El primero fue Pipeline creado: el objeto dentro del cual se realiza la simulación. <br><br>  Basado en un <code>map</code> contiene una lista de componentes para describir el sistema simulado.  Dado que, durante la simulación, las transacciones deben pasar por una secuencia de bloques en un orden estricto, en el método de agregar componentes de <code>Append</code> , se implementó el procedimiento de agregar con indicación simultánea de los destinos de las transacciones.  El nombre del componente se utiliza como clave de <code>map</code> , por lo que cada componente debe tener un nombre único. <br><br>  Después de agregar todos los componentes, puede iniciar la simulación utilizando el método de <code>Start</code> .  En su interior, se implementa un bypass cíclico de todos los componentes durante un tiempo de simulación determinado.  Al final de la simulación, puede imprimir un informe que contenga NAV y ALS. <br><br>  El segundo elemento importante son los componentes reales para describir la simulación.  Se implementaron los siguientes: Generador - genera transacciones, Avanzado - crea demoras en la ruta de la transacción, Cola - colas de transacciones, Instalación - un dispositivo que es capturado exclusivamente por la transacción por un tiempo, Agujero - un "agujero" en el que las transacciones fallan al final de la ruta.  Por supuesto, este conjunto no es suficiente para crear modelos de simulación complejos, sino suficiente para resolver la solución y compararla con los resultados del GPSS.  Todos los componentes implementan la interfaz IBaseObj, que cubre la funcionalidad mínima requerida. <br><br>  Cada componente tiene una cola de transacciones.  Directamente como una cola, se usa solo en la cola, para otros componentes es solo un repositorio.  La cola se implementa en función del <code>map</code> .  En el proceso de modelado, los componentes pasan a su vez y verifican la preparación (cumplimiento de una determinada condición) de la transacción para su transmisión al siguiente componente.  La transferencia se realiza a través del método <code>AppendTransact</code> del siguiente componente.  Si la transferencia es exitosa, la transacción se elimina de la cola, respectivamente, el siguiente componente la toma a su vez.  Dado que se definen varios destinatarios para cada componente, si no fue posible enviar una transacción a un destinatario, intentamos enviarla a otro. <br><br>  Para generar variables aleatorias al determinar el tiempo de aparición de la transacción y crear retrasos, se utilizan las funciones PRNG en Go. <br><br>  Dado que al modelar, al mismo tiempo, puede haber muchas transacciones que se mueven entre diferentes componentes, surgió la idea de usar gorutinas dentro de los componentes.  La canalización, que pasa a través de los componentes, inicia el controlador <code>HandleTransacts</code> para cada uno de ellos, dentro del cual se crea la rutina.  Una vez que se han completado todas las rutinas, el contador de tiempo del modelo se incrementa y se llama <code>HandleTransacts</code> . <br><br>  El último objeto clave es la transacción en sí.  Tiene un identificador, hora de nacimiento y muerte, el propietario (en qué componente se encuentra ahora), una serie de parámetros para calcular el NAV y el NAV. <br><br>  En la fig.  1 es un diagrama estructural de la interacción de los principales objetos del marco durante el modelado. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ht/yc/x2/htycx2yszz-c_ljrthrmu5w0xdg.jpeg" width="400" height="200"></div><br>  <b>Fig.</b>  <b>1. Diagrama estructural generalizado de la interacción de los objetos principales en la simulación.</b> <br><br><h2>  Ejemplo de simulación </h2><br>  Suponga que necesita simular el trabajo de un peluquero.  Este es un famoso ejemplo de GPSS.  Los visitantes van al azar, con una frecuencia de 18 ± 6 minutos, su número no se conoce de antemano.  Tenemos un peluquero, él pasa 16 ± 4 minutos en un corte de pelo.  Entonces, ¿a cuántas personas cortará por un día de trabajo?  ¿Cuántas personas estarán en la fila?  ¿Cuál es el tiempo promedio que toma un corte de pelo y cuánto tiempo esperan las personas en la fila?  Muchas preguntas y una simulación simple.  El diagrama de bloques en la Fig.  2) <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/1a/bb/sf/1abbsf7qcec5fugytkwjydq28mm.jpeg" width="300" height="150"></div><br>  <b>Fig.</b>  <b>2. El esquema estructural de modelar una peluquería</b> <br><br>  El código para construir el modelo será el siguiente. <br><br><pre> <code class="go hljs">barbershop := NewPipeline(<span class="hljs-string"><span class="hljs-string">"Barbershop"</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span>) <span class="hljs-comment"><span class="hljs-comment">//   clients := NewGenerator("Clients", 18, 6, 0, 0, nil) //   chairs := NewQueue("Chairs") //  master := NewFacility("Master", 16, 4) //  hole := NewHole("Out") //  barbershop.Append(clients, chairs) //       barbershop.Append(chairs, master) //      barbershop.Append(master, hole) //     barbershop.Append(hole) //        barbershop.Start(480) //    &lt;-barbershop.Done //   barbershop.PrintReport()</span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">Los resultados de la simulación se pueden encontrar aquí.</b> <div class="spoiler_text">  Nombre de la tubería "Barbershop" <br>  Tiempo de simulación 480 <br>  Nombre del objeto "Sillas" <br>  Contenido máximo 1 <br>  Total entradas 26 <br>  Cero entradas 11 <br>  Porcentaje cero entradas 42.31% <br>  En la cola 0 <br>  Tiempo promedio / trans 2.58 <br>  Tiempo medio / trans sin cero entradas 4.47 <br><br>  Nombre del objeto "Clientes" <br>  26 generados <br><br>  Nombre del objeto "Maestro" <br>  Avance promedio 16.46 <br>  Utilización promedio 89.17 <br>  Número de entradas 26.00 <br>  Transacción 26 en las instalaciones <br><br>  Nombre del objeto "Fuera" <br>  Mata a 25 <br>  Avance promedio 16.56 <br>  Vida media 19.44 <br></div></div><br>  Sirvió a 25 clientes, el 26 al momento de la finalización de la simulación todavía estaba en la silla del maestro.  La cola no era más de 1 persona, 11 personas no esperaron (pase cero) e inmediatamente se cortaron el pelo.  En promedio, las personas pasaron 2.58 minutos en la cola, y de los que estaban esperando (no un pase cero), 4.47 minutos.  El 89.17% de su tiempo, un peluquero, intensamente cortado. <br><br>  Por supuesto, si realiza otra simulación, los resultados cambiarán.  Pero durante una serie de simulaciones, el nivel general de la carga del asistente y el número de clientes atendidos serán visibles.  Una simulación similar en GPSS produce resultados similares. <br><br>  Otro ejemplo.  Hay una oficina, tiene 10 empleados y un baño.  La gente quiere ir al baño cada 90 ± 60 minutos, ir al baño durante 5 ± 3 minutos, ir al baño durante 15 ± 10 minutos, volver a la oficina durante 5 ± 3 minutos.  Realizaremos la simulación durante 9 horas (8 horas de trabajo + 1 hora de almuerzo), en la fig.  3 es un diagrama estructural. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ni/ef/qf/niefqf8bfmmuojr1xlo3jqjwe_e.jpeg"></div><br>  <b>Fig.</b>  <b>3. Diagrama estructural del modelo de empleo del inodoro: a la izquierda con un inodoro, a la derecha con dos</b> <br><br>  A la izquierda hay un modelo con un inodoro, a la derecha con dos.  El siguiente es el código del modelo. <br><br><pre> <code class="go hljs">waterclosetsim := NewPipeline(<span class="hljs-string"><span class="hljs-string">"Water Closet Simulation"</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>) office := NewGenerator(<span class="hljs-string"><span class="hljs-string">"Office"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) wantToToilet:= NewAdvance(<span class="hljs-string"><span class="hljs-string">"Wanted to use the toilet"</span></span>, <span class="hljs-number"><span class="hljs-number">90</span></span>, <span class="hljs-number"><span class="hljs-number">60</span></span>) pathToWC := NewAdvance(<span class="hljs-string"><span class="hljs-string">"Path to WC"</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) queue := NewQueue(<span class="hljs-string"><span class="hljs-string">"Queue to the WC"</span></span>) pathFromWC := NewAdvance(<span class="hljs-string"><span class="hljs-string">"Path from WC"</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) wc := NewFacility(<span class="hljs-string"><span class="hljs-string">"WC"</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) pathToOffice:= NewAdvance(<span class="hljs-string"><span class="hljs-string">"Path from WC"</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) waterclosetsim.Append(office, wantToToilet) waterclosetsim.Append(wantToToilet, pathToWC) waterclosetsim.Append(pathToWC, queue) waterclosetsim.Append(queue, wc) waterclosetsim.Append(wc, pathFromWC) waterclosetsim.Append(pathFromWC, wantToToilet) waterclosetsim.Start(<span class="hljs-number"><span class="hljs-number">540</span></span>) &lt;-waterclosetsim.Done waterclosetsim.PrintReport()</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Los resultados de la simulación son los siguientes.</b> <div class="spoiler_text">  Nombre de la tubería "Simulación de inodoro" <br>  Tiempo de simulación 540 <br>  Nombre del objeto "Oficina" <br>  Generado 10 <br><br>  Nombre del objeto "Ruta desde WC" <br>  Avance promedio 5.77 <br><br>  Nombre del objeto "Path to WC" <br>  Avance promedio 5.22 <br><br>  Nombre del objeto "Queue to the WC" <br>  Contenido máximo 4 <br>  Entradas totales 36 <br>  Cero entradas 8 <br>  Porcentaje cero entradas 22.22% <br>  Contenido actual 4 <br>  Contenido promedio 1.78 <br>  Tiempo promedio / trans 24.11 <br>  Tiempo promedio / trans sin cero entradas 31.00 <br><br>  Nombre del objeto "WC" <br>  Avance promedio 14.69 <br>  Utilización media 87.04 <br>  Número de entradas 32.00 <br>  Transacción 2 en las instalaciones <br><br>  Nombre del objeto "Quería usar el baño" <br>  Avance promedio 95.85 <br></div></div><br>  Había hasta 4 personas en la fila, 8 veces una persona se metió inmediatamente en el inodoro, durante el día laboral el inodoro se usó al 87.04%.  Lo más significativo, en mi opinión, es que las personas esperan aproximadamente media hora (31 minutos) en la fila para ir al baño.  Quizás esto se deba al hecho de que solo hay un inodoro, y quizás al hecho de que, en promedio, las personas se sientan en él durante 14,69 minutos. <br><br>  Después de agregar otro baño, vi que la cola se redujo a 3 personas, 29 veces las personas entraron inmediatamente al baño.  Pero lo más importante, la expectativa disminuyó casi tres veces. <br><br><h2>  Conclusión </h2><br>  El marco creado en la rodilla es bastante simple y aún limitado.  Planea aumentar su funcionalidad al nivel de GPSS.  El valor práctico del marco es la capacidad de ensamblar rápida y fácilmente un modelo de simulación en Go y obtener resultados. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">El código está publicado en GitHub</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/448076/">https://habr.com/ru/post/448076/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../448060/index.html">Escribir un cliente NTP simple</a></li>
<li><a href="../448068/index.html">Científicos estadounidenses han enseñado a los robots a usar herramientas auxiliares</a></li>
<li><a href="../448070/index.html">Sustitución de importaciones en la práctica. Parte 3. Sistemas operativos</a></li>
<li><a href="../448072/index.html">La comprensión de las uniones está rota. Definitivamente, esta no es la intersección de los círculos, sinceramente</a></li>
<li><a href="../448074/index.html">ALU con 12 transistores (en realidad no)</a></li>
<li><a href="../448078/index.html">En la estimación autorregresiva de la densidad espectral de una señal estacionaria</a></li>
<li><a href="../448080/index.html">Jugador de fútbol robo de principiantes. Competiciones en MIPT. Android y Arduino y Bluetooth</a></li>
<li><a href="../448082/index.html">[Antes del lunes] Síndrome de ojo seco</a></li>
<li><a href="../448084/index.html">Foto de un agujero negro: ¿será útil?</a></li>
<li><a href="../448088/index.html">Producción de motores de plasma en Rusia.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>